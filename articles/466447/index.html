<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëü üéµ üôç ¬øPara qu√© deber√≠amos construir un CDN? ü•£ üé∞ üßöüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola habr En este art√≠culo construiremos nuestro propio CDN. ¬øPor qu√© no usar soluciones preparadas? Debido a que el sitio del autor es completamente ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øPara qu√© deber√≠amos construir un CDN?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/466447/"> Hola habr  En este art√≠culo construiremos nuestro propio CDN.  ¬øPor qu√© no usar soluciones preparadas?  Debido a que el sitio del autor es completamente est√°tico, hecho en Jekyll, con im√°genes grandes que deben ser entregadas lo m√°s r√°pido posible.  El servidor no debe estar en cach√©, debe almacenar todo el sitio, admitir HTTP / 2 y Brotli, y el mismo certificado debe estar instalado en todos los servidores. <br><br>  Tambi√©n lo haremos todo en IIS que se ejecuta en Windows Server 2019 Core. <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/jd/-8/bh/jd-8bhr2bkenojiyts1op3nxdr0.jpeg"></a> </div><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Brevemente sobre la implementaci√≥n</font> </h2><br>  En los nodos finales, administraremos los medios integrados en el sistema operativo, necesitaremos: <br><br><ol><li>  Directorio Activo </li><li>  Dfs </li><li>  IIS </li><li>  Winacme </li><li>  RSAT </li></ol><br>  Opcional, pero recomendado: <br><br><ol><li>  Centro de administraci√≥n de Windows </li></ol><br>  En sitios con sitios, solo se necesitan IIS y DFS, se requiere Active Directory, se requiere para DFS, que sincronizar√° el contenido del sitio entre servidores.  Se necesita RSAT para administrar los componentes y se necesita el Centro de administraci√≥n de Windows para editar el registro.  Esto tambi√©n se puede hacer a trav√©s de Powershell, que tambi√©n discutir√©. <br><br>  El dominio del autor se llama ***. ***. Wtf (no se alarme), y los servidores son nombrados por los centros de datos y tienen los nombres de la forma cache-zur1, cahe-ru, etc.  AD se implementa y los servidores est√°n conectados a √©l.  Ahora en orden. <br><br><h2>  <font color="#3AC1EF">Selecci√≥n de puntos</font> </h2><br>  RUVDS tiene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">8 centros de datos</a> : 3 en Europa y 5 en Rusia.  Mi elecci√≥n recay√≥ en Rucloud en Mosc√∫ y LD8 (el de Londres).  Rucloud porque casi no es diferente del M9, y a trav√©s de Londres hay un cable transcontinental a los Estados Unidos, por lo que en Europa es imprescindible.  Para una distribuci√≥n m√°s estricta en Europa, puede elegir Suiza o Alemania; esto, en general, puede detenerse. <br><br><h2>  <font color="#3AC1EF">Elegir un DNS GeoIP</font> </h2><br>  Si el cliente llama al sitio, ¬øc√≥mo entender qu√© servidor debe transmitirle los datos?  Usando DNS, por supuesto.  Es decir, dependiendo de la direcci√≥n IP de la persona que se dirigi√≥ al DNS, se dar√° una respuesta relevante. <br><br>  Podemos usar nuestro propio DNS (BIND con un complemento para Maxmind) o una soluci√≥n llave en mano (Route53).  Una suscripci√≥n a las bases de datos Maxmind GeoIP cuesta $ 25 por mes, y Route53 cuesta $ 0.50 por zona de dominio, m√°s un centavo si va por un mill√≥n de solicitudes.  Adem√°s, crear otro punto de fortalecimiento de los ataques DDoS es lo √∫ltimo, por lo que mi elecci√≥n recay√≥ en Route53. <br><br>  Este art√≠culo trata sobre CDN para Europa;  si necesita un CDN para Rusia, entonces la elecci√≥n hacia su propio DNS es obvia, porque Route53 proporciona enrutamiento por pa√≠s, no por ciudad. <br>  Microsoft tiene servicios similares (Azure Traffic Manager). <br><br><h2>  <font color="#3AC1EF">1. Instalar IIS</font> </h2><br>  <b>1.1.</b>  <b>Instalaci√≥n de IIS</b> <br><br>  Instalamos los componentes b√°sicos de IIS, el componente de soporte para certificados centralizados y en el servidor principal soporte adicional para administraci√≥n remota.  Este componente es necesario solo para un servidor: no podr√° administrar otros servidores cuando habilite configuraciones compartidas, incluso si se ha configurado la administraci√≥n remota. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f09/d98/c66/f09d98c6665d1e5106436c0fd9fc258d.png"><br><br>  V√≠a Powershell: <br><br><pre><code class="plaintext hljs">Install-WindowsFeature Web-Server, Web-CertProvider</code> </pre> <br>  En el servidor principal, debe instalar adicionalmente: <br><br><pre> <code class="plaintext hljs">Install-WindowsFeature Web-Mgmt-Service</code> </pre> <br>  <b>1.1.1 Encienda el control remoto</b> <br><br>  Para que podamos administrar de forma remota el servidor IIS, necesitamos elevar el Servicio de administraci√≥n remota de IIS.  En el servidor principal, inicie el servicio: <br><br><pre> <code class="plaintext hljs">start-service WMSVC set-service -Name WMSVC -StartupType Automatic</code> </pre> <br>  Y ahora incluimos la capacidad de administrar como tal a trav√©s del registro. <br><br><pre> <code class="plaintext hljs">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WebManagement\Server</code> </pre> <br>  La forma m√°s f√°cil de administrar el registro, por supuesto, es a trav√©s del Centro de administraci√≥n de Windows. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fd/9cb/7b1/8fd9cb7b19b7523283885d61564eb920.png"><br><br>  Pero esto tambi√©n se puede hacer a trav√©s de Powershell: <br><br><pre> <code class="plaintext hljs">Set-Itemproperty -path "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WebManagement\Server" -Name "EnableRemoteManagement" -value "1"</code> </pre> <br>  En Windows Server 2012 y 2016, la regla del firewall no aumenta por s√≠ sola; debe editar el firewall. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c7/13e/d35/8c713ed356d5418549cdc602c62e3161.png"><br><br><pre> <code class="plaintext hljs">Set-NetFirewallRule -Name IIS-WebServerRole-WMSVC-In-TCP -Enabled True</code> </pre> <br>  Compruebe si ha aumentado: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/929/121/aa3/929121aa33cdffa49494d791b583da7f.png"><br><br><pre> <code class="plaintext hljs">Test-NetConnection 8.8.8.8 -port 8172</code> </pre> <br>  Tres ediciones en tres lugares diferentes y ahora podemos conectarnos a trav√©s del administrador de IIS a nuestro servidor utilizando otro servidor con un escritorio.  Esto fue solo para la conveniencia de la gesti√≥n posterior. <br><br>  <b>1.2 Cortamos la centralizaci√≥n de configuraciones</b> <br><br>  No hay botones para instalar configuraciones centralizadas y certificados en el Administrador de IIS, solo est√°n en el administrador del servidor local, por lo que para Server Core tendr√° que hacer todo a trav√©s de Powershell. <br><br>  La centralizaci√≥n de configuraciones y certificados se realiza a trav√©s de SMB.  Por lo tanto, hice dos usuarios privados de sus derechos (por separado para configuraciones y por separado para certificados) que tienen acceso de lectura solo a su carpeta y los nombraron certadmin y configadmin. <br><br>  Es aconsejable que los usuarios sean locales en el servidor principal: si su controlador de dominio muere, las aplicaciones que se aferran a la configuraci√≥n y los certificados a trav√©s de SMB en nombre del usuario de dominio morir√°n.  El uso de usuarios locales elimina esta situaci√≥n. <br><br>  <b>1.2.1 Crear una carpeta compartida</b> <br><br>  Deben almacenarse dos carpetas p√∫blicas en uno de los servidores, de donde obtenemos la configuraci√≥n y los certificados.  Como la ruta a la carpeta compartida, tomamos la ruta predeterminada a las configuraciones de IIS: <br><br><pre> <code class="plaintext hljs">New-SmbShare -ReadAccess configadmin@**.**wtf -Path C:\windows\System32\Inetsrv\Config -Name sharedconfigs</code> </pre> <br>  Y para los certificados podemos elegir cualquiera.  Los puse en una carpeta con IIS. <br><br><pre> <code class="plaintext hljs">New-SmbShare -Path C:\inetpub\centralizedcerts -Name sharedconfigs -ReadAccess configadmin</code> </pre> <br>  <b>1.2.2 Conectamos nodos a configuraciones</b> <br><br>  La configuraci√≥n debe hacerse solo para aquellos servidores que leer√°n esta configuraci√≥n.  Mi servidor principal con el nombre cache-ru ser√° el jefe, as√≠ que configur√© los otros dos. <br>  Ingrese la contrase√±a del usuario que tiene acceso a la carpeta: <br><br><pre> <code class="plaintext hljs">$pass = Read-Host -AsSecureString Enable-IISSharedConfig -PhysicalPath \\cache-ru.**.**wtf\SharedConfig -UserName configadmin@**.**wtf -Password $pass -DontCopyRemoteKeys</code> </pre> <br>  Inmediatamente despu√©s de ingresar una nueva sesi√≥n debe abrirse.  Para verificar que todo funcion√≥, puede abrir RSAT ‚Üí Administraci√≥n de equipos ‚Üí Carpetas compartidas ‚Üí Sesiones.  Veremos las sesiones de usuario y la direcci√≥n IP del servidor, que bajo este usuario lee la carpeta compartida.  En el lado del cliente, el cmdlet lo verifica: <br><br><pre> <code class="plaintext hljs">Get-IISSharedConfig</code> </pre> <br>  As√≠ me pareci√≥ a m√≠: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/459/bc9/857/459bc9857540abe84a63229992b7d3dd.png"><br><br>  <b>1.2.2 Conectar nodos a certificados</b> <br><br>  La siguiente l√≠nea solo se puede ingresar directamente, ya que tiene una conexi√≥n directa al escritorio que ejecuta el Servidor con una GUI, no funciona en Server Core. <br><br><pre> <code class="plaintext hljs">$pass = Read-Host -AsSecureString Enable-IISCentralCertProvider -CertStoreLocation \\cache-ru.**.**wtf\centralizedcerts -UserName certadmin@**.**wtf -Password $pass</code> </pre> <br>  Si intenta ingresarlo a trav√©s de Winrm, ver√° el siguiente resultado: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/85f/e1b/c76/85fe1bc7691f4a7c4765560e4d62a2f8.png"><br><br>  Para hacer esto de forma remota, debe editar el registro.  ¬°Qu√© conveniente!  Volamos en: <br><br><pre> <code class="plaintext hljs">HKLM:\SOFTWARE\Microsoft\IIS\CentralCertProvider\</code> </pre> <br>  Cree un DWORD de 32 bits "Habilitado" con el par√°metro "1": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/06c/ba1/e1e/06cba1e1e6dd5af05cc7f9d0279e138f.png"><br><br><pre> <code class="plaintext hljs">Set-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\IIS\CentralCertProvider\ -Name Enabled -Value 1</code> </pre> <br>  Luego creamos el valor de cadena CertStoreLocation con el par√°metro \\ cache-ru. **. ** wtf \ centralizedcerts: <br><br><pre> <code class="plaintext hljs">Set-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\IIS\CentralCertProvider\ -Name CertStoreLocation -Value &lt;a href="about:blank"&gt;\\cache-ru.**.**wtf\centralizedcerts&lt;/a&gt;</code> </pre> <br>  Para verificar si todo est√° en orden, utilizamos: <br><br><pre> <code class="plaintext hljs">Get-IISCentralCertProvider</code> </pre> <br>  La salida deber√≠a ser as√≠: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c8b/dd6/48d/c8bdd648d8d5f147c8bd28d1bad9cfc0.png"><br><br>  Y solo despu√©s de eso entramos: <br><br><pre> <code class="plaintext hljs">$pass = Read-Host -AsSecureString Set-IISCentralCertProvider -UserName certadmin@**.**wtf -Password $pass</code> </pre> <br>  Verifique nuevamente: <br><br><pre> <code class="plaintext hljs">Get-IISCentralCertProvider</code> </pre> <br>  Todo fuera de la caja se llama.  A diferencia de las configuraciones comunes, los certificados centralizados no crean una sesi√≥n SMB activa. <br><br>  <b>1.2.3 Brotli</b> <br><br>  En cada servidor, descargue y ejecute el archivo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">compresi√≥n IIS</a> <br><br><pre> <code class="plaintext hljs">Start-Process .\iiscompression_amd64.msi -ArgumentList /quiet</code> </pre> <br>  Ya hemos compartido las configuraciones, por lo que debe configurar algo en un solo lugar.  Usando el Administrador de IIS, vamos al editor de configuraci√≥n en el servidor principal. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/489/874/4db/4898744dbe1eea52b6bfe3c92ea5a1ad.png"><br><br><pre> <code class="plaintext hljs">system.webServer/httpCompression</code> </pre> <br>  Y establezca StaticCompressionLevel en 11 para Brotli y 9 para Gzip, esto es lo m√°ximo que pueden hacer. <br><br>  <b>1.2.4 MIME y encabezados</b> <br><br>  Fuera de la caja, IIS no transmite el encabezado de codificaci√≥n, por lo que el alfabeto cir√≠lico se convierte en runas.  Tambi√©n en MIME no hay entrada de formato webp que deba agregarse. <br><br>  <b>1.</b> Vaya al despachador ‚Üí MIME.  Busque .HTML y modifique su tipo a: text / html;  charset = utf-8 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4c/bef/017/e4cbef017ae044d8720535ff9bdea63a.png"><br><br>  <b>2.</b> No se olvide de Webp: debe agregar este MIME manualmente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07a/b62/aec/07ab62aecf03ee9b4a32ecd4044d7a42.png"><br><br><h2>  <font color="#3AC1EF">2. Emitimos un certificado</font> </h2><br>  Usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Winacme</a> .  Primero, debe vincular los dominios al sitio; esto se puede hacer a trav√©s del Administrador de IIS.  Al crear una CDN, no seleccione la verificaci√≥n de host, ya que  Los problemas comienzan inmediatamente con la confirmaci√≥n de la propiedad del dominio, nuestra elecci√≥n es la verificaci√≥n por registro TXT.  Tendr√° que conducir manualmente la ruta a la carpeta con los certificados, as√≠ como copiar manualmente el registro del desaf√≠o.  Ahora, lleva aire a tu pecho. <br><br>  Para no imprimir todo manualmente, habilite RDP en Server Core con el siguiente comando: <br><br><pre> <code class="plaintext hljs">cscript C:\Windows\System32\Scregedit.wsf /ar 0</code> </pre> <br>  As√≠ es como se ve RDP en Server Core: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/856/2ea/478/8562ea478872a08964c125a8b997eae6.png"><br><br>  Despu√©s del desaf√≠o, los certificados caen en la carpeta que se especific√≥ en Winacme.  Winacme coloca la tarea en el planificador para renovar el certificado.  Instalado y olvidado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f20/8e3/d33/f208e3d33f61e407a19e1ff53e14ecde.png"><br><br>  Bueno, cuando terminamos, podemos desactivar RDP: instalamos Server Core por una buena raz√≥n, descubrimos muchos matices. <br><br><pre> <code class="plaintext hljs">cscript C:\Windows\System32\Scregedit.wsf /ar 1</code> </pre> <br><h2>  <font color="#3AC1EF">3. Certificado de Bindim a los nodos</font> </h2><br>  Ahora necesita configurar otros dos nodos para que HTTPS finalmente funcione.  En este momento, en el servidor donde se almacenan los certificados, HTTPS ya se est√° ejecutando.  Para que el resto comience a trabajar en HTTPS, bueno, en general, esto se hace a trav√©s de netsh. <br><br>  Como estamos acostumbrados, nos conectamos a Windows Server Core a trav√©s de RDP para ejecutar este complemento.  No mire el sitio en Microsoft, especialmente en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta</a> gu√≠a.  Los pasos en √©l se describen incorrectamente. <br><br>  Usando netsh http show sslcert, en el nodo maestro necesita obtener el appid, que ingresamos como se describe a continuaci√≥n: <br><br><pre> <code class="plaintext hljs">netsh http add sslcert ccs=443 appid= '{4dc3e181-e14b-4a21-b022-59fc669b0914}'</code> </pre> <br>  El valor de appid debe estar entre comillas, de lo contrario no funcionar√°. <br><br><h2>  <font color="#3AC1EF">4. Instalar DFS</font> </h2><br>  No sincronice certificados y configuraciones a trav√©s de DFS, se inventaron herramientas especializadas por una raz√≥n.  Lo intent√© y result√≥ mal, por alguna raz√≥n poco clara, las configuraciones en los servidores que tomaron la configuraci√≥n simplemente dejaron de leer los cambios, aunque por primera vez todo funcion√≥.  No descubr√≠ la causa del fallo y decid√≠ hacerlo de manera diferente. <br><br>  La configuraci√≥n adicional se realiza exclusivamente a trav√©s de RSAT, los cmdlets que se especifican en la documentaci√≥n solo funcionan en Windows Server con una GUI.  No es posible implementar la replicaci√≥n DFS utilizando Server Core exclusivamente.  Necesita otro servidor con una GUI o una computadora con Windows 10 Pro con RSAT instalado, unido al dominio. <br><br>  <b>2.1.</b>  <b>Instalar</b> <br><br>  En cada servidor necesita instalar la replicaci√≥n DFS: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebf/999/b17/ebf999b179089dd87a346406bfe6a09d.png"><br><br><pre> <code class="plaintext hljs">Install-WindowsFeature FS-DFS-Replication, FS-DFS-Namespace</code> </pre> <br>  <b>2.2.</b>  <b>Hacer un nuevo grupo de replicaci√≥n</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/53b/3e2/9d6/53b3e29d6aee1c0e9f9a6b4e8f5ea06e.png"><br><br>  Primero debe llamar a nuestro grupo de replicaci√≥n. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/14d/7ce/a23/14d7cea23a3bd08b1aec745ed40c0fb3.png"><br><br>  Elija la topolog√≠a a su gusto.  Personalmente, ser√° m√°s conveniente para m√≠ agregar contenido a un lugar, as√≠ que elijo una estrella. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2fb/a17/e99/2fba17e99d83b3bec4940c5517c2a690.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a2/6e4/508/7a26e4508dfe041bc25c5cf008120ec2.png"><br><br>  Uno de los servidores debe ser el principal, es a partir de √©l que comienza la replicaci√≥n.  Si carga archivos a los oyentes, el archivo cargado no se replica. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d36/298/12a/d3629812afb96964a66db8a1c7682513.png"><br><br>  Como carpeta para la replicaci√≥n, eleg√≠ la carpeta predeterminada con sitios: <br><br><pre> <code class="plaintext hljs">C:\inetpub\wwwroot</code> </pre> <br>  Esta carpeta es la ruta al directorio de este primer servidor en particular.  Puede replicar el contenido de esta carpeta en cualquier lugar, independientemente de la ruta. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d10/e94/f5e/d10e94f5e3e48d88ddcc3a5cb97ff5a4.png"><br><br>  Dentro de un grupo, podemos replicar varias carpetas, y en el futuro podemos expandir su lista si es necesario. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ccc/ae9/649/cccae9649e5b0145fb38a6cd59d73490.png"><br><br>  Terminado <br><br><h2>  <font color="#3AC1EF">5. Prueba de rendimiento</font> </h2><br>  Para comprender cu√°nto ganaron realmente los visitantes del sitio, debe tomar medidas.  Se realizar√°n desde dos puntos.  PC del autor en Mosc√∫ y servidor virtual en Frankfurt.  Los tres puntos se probar√°n por separado.  Aqu√≠ hay un resumen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d26/12c/04a/d2612c04abedc5d8eb796cbeeaaf31f7.png"><br><br>  Entramos en Devtools y observamos la cascada.  En promedio en un hospital, un CDN reducir√° aproximadamente 200 milisegundos antes de que un sitio est√© completamente cargado.  La imagen, el objeto m√°s grande de la p√°gina, se carga tan pronto como ingresa a la ventana gr√°fica, as√≠ que preste atenci√≥n a la l√≠nea vertical azul.  CDN aceler√≥ los estilos y scripts HTML + puros en 10-15 milisegundos, y la imagen se carg√≥ 220 milisegundos m√°s r√°pido, esta es una diferencia muy significativa. <br><br><div class="spoiler">  <b class="spoiler_title">Mosc√∫ - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/12b/5e5/8a9/12b5e58a9665f6901f073c0eba3f2678.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Londres - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/03e/435/b93/03e435b93de7b098fbd98afdacc0c8f4.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Z√∫rich - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/1f2/474/cfb/1f2474cfba94d72d5482cb9a0ba0c679.png"></div></div><br>  Tambi√©n med√≠ la velocidad de Jekyll en un host local: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/514/976/285/514976285849bbf746909644173302ba.png"><br><br>  Nos dirigimos a la casa de la luz y vemos resultados extra√±os: <br><br><div class="spoiler">  <b class="spoiler_title">Mosc√∫ - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/f2b/516/abb/f2b516abbaeb5ea7ec29c39585719d38.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Londres - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/9ab/9d8/38c/9ab9d838cd9c67792381c0741ef81a27.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Z√∫rich - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/12e/500/00b/12e50000b52c228beb3f08367fbbf00d.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Localhost - Jekyll:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/3eb/449/599/3eb449599c0eee7698301470b48ea67b.png"></div></div><br>  En este sint√©tico, un servidor que aterriza en lugares distantes evita al host local.  Pero por que? <br>  Por diversi√≥n, eliminemos Google Fonts y transfi√©ralos a nuestros servidores. <br><br><div class="spoiler">  <b class="spoiler_title">Mosc√∫ - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/457/082/7cb/4570827cb685795120f645da992ebcf8.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Londres - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/f90/fbd/2ad/f90fbd2ad39d80e6b246faf348fee577.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Z√∫rich - Mosc√∫:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/d45/2f0/530/d452f0530f2d1d914aba53649cff763d.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Localhost - Jekyll:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/bc2/6a1/f27/bc26a1f275f6d3626de02d96b436c186.png"></div></div><br>  Resultados entre centros de datos alineados.  Pero todav√≠a no explica nada.  Rehice las pruebas varias veces, los resultados son absolutamente f√©rreos y reproducibles en cualquier momento. <br><br>  Ahora usaremos un VPS con dos n√∫cleos y 4 gigabytes de RAM ubicados en Frankfurt y veremos qu√© dice.  Cascadas <br><br><div class="spoiler">  <b class="spoiler_title">Mosc√∫ - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/025/d40/dd7/025d40dd7962e7e312a6978cff91cabd.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Londres - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/961/e9f/acf/961e9facf3d0a4654654f3541c7093a6.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Zurich - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/d5a/81e/399/d5a81e399de00ca9f3a451d09379f6cd.png"></div></div><br>  Aqu√≠, con el punto correcto, el ahorro de tiempo solo en estilos y HTML ascendi√≥ a 200 milisegundos.  Es decir, en el caso de un cliente de Frankfurt, el sitio simplemente ser√° m√°s r√°pido en 200 milisegundos.  Esto tambi√©n se refleja en la casa de la luz.  En tales casos, CDN acelerar√° no solo la tienda en l√≠nea, sino tambi√©n un blog f√°cil. <br><br><div class="spoiler">  <b class="spoiler_title">Mosc√∫ - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/e4d/e88/785/e4de88785e56ed3102cef5ade05f8462.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Londres - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/042/b1c/071/042b1c0716f7e44b2f2dfc0b3955a68f.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Zurich - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/db1/ae1/de5/db1ae1de5ebfd5be8c3af5e6822a4376.png"></div></div><br>  Ahora encienda Google Fonts y mire la casa de la luz nuevamente. <br><br><div class="spoiler">  <b class="spoiler_title">Mosc√∫ - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/87d/ae6/281/87dae6281e2510fa35ee4aecd45079f0.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Londres - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/025/ec2/d7d/025ec2d7d6982b39261551f927167ad2.png"></div></div><br><div class="spoiler">  <b class="spoiler_title">Zurich - Frankfurt:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/802/f0c/073/802f0c073e6fa0f445dda60d7823da00.png"></div></div><br>  Desafortunadamente, ya no tengo puntos para realizar pruebas, as√≠ que terminar√©. <br><br><h2>  <font color="#3AC1EF">Conclusiones</font> </h2><br><ul><li>  CDN para generar todas las estad√≠sticas es necesario, especialmente cuando se trata de im√°genes pesadas o secuencias de comandos largas. </li><li>  Usar fuentes de Google es posible y necesario, en escenarios pesados ‚Äã‚Äãrealmente acelera el sitio. </li><li>  El servidor principal, si decide hacer todo esto en Windows, es recomendable tener una GUI. </li><li>  Los usuarios que tomar√°n las configuraciones del servidor principal son mejor locales: en caso de una falla del controlador de dominio, los nodos pueden perder la conexi√≥n con las configuraciones y los certificados, y el grupo de aplicaciones se detendr√°, porque  no podr√° leer una configuraci√≥n. </li></ul><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/it/t5/3p/itt53pns2iucwylb3bwn1fmmtnu.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/466447/">https://habr.com/ru/post/466447/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../466437/index.html">Entrenamiento Cisco 200-125 CCNA v3.0. D√≠a 43. Protocolos de enrutamiento Vector de distancia y estado de enlace</a></li>
<li><a href="../466439/index.html">Compru√©belo usted mismo: ¬øcu√°ntas preguntas puede responder ChGK?</a></li>
<li><a href="../466441/index.html">C√≥digo de error de Python: 10 errores m√°s comunes que cometen los desarrolladores</a></li>
<li><a href="../466443/index.html">ShIoTiny y el mundo: sensores anal√≥gicos o ADC para los m√°s peque√±os</a></li>
<li><a href="../466445/index.html">Ataques entre fideicomisos entre dominios</a></li>
<li><a href="../466449/index.html">Entrenamiento Cisco 200-125 CCNA v3.0. D√≠a 44. Introducci√≥n a OSPF</a></li>
<li><a href="../466451/index.html">Leer_No puedes_lanzar</a></li>
<li><a href="../466453/index.html">Entrenamiento Cisco 200-125 CCNA v3.0. D√≠a 45. Configurando OSPF</a></li>
<li><a href="../466455/index.html">Servicios, microservicios y programaci√≥n orientada a lotes.</a></li>
<li><a href="../466457/index.html">Agricultura y paneles solares: estrategia de beneficio mutuo para ingenieros y agricultores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>