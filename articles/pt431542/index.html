<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò± üîÑ üßóüèª Desenvolvimento e manuten√ß√£o eficazes de pap√©is Ansible üëäüèΩ ‚ùÑÔ∏è üë®‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Ansible √© um sistema que resolve v√°rias tarefas de automa√ß√£o, incluindo projetos de configura√ß√£o, backup e implanta√ß√£o. √â agrad√°vel usar o sistema p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento e manuten√ß√£o eficazes de pap√©is Ansible</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/431542/">  O Ansible √© um sistema que resolve v√°rias tarefas de automa√ß√£o, incluindo projetos de configura√ß√£o, backup e implanta√ß√£o.  √â agrad√°vel usar o sistema para escrever scripts de automa√ß√£o de um ambiente simples para um projeto grande.  Nos scripts, os playbooks desempenham um papel importante e os playbooks estruturados desempenham pap√©is. <br><br>  <b>Ansible n√£o √© uma p√≠lula m√°gica</b> e s√≥ ajuda a princ√≠pio.  Quando um projeto cresce, fica dif√≠cil manter um n√∫mero expandido de fun√ß√µes.  O mecanismo de entrega cont√≠nua de fun√ß√µes ajuda a resolver o problema. <br><br>  Apenas sobre isso, a decodifica√ß√£o do relat√≥rio de <b>Alexander Kharkevich</b> no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DevOps Conf Russia</a> .  No relat√≥rio: desenvolvimento de fun√ß√µes Ansible por meio do IC, um mecanismo para desenvolver fun√ß√µes e fun√ß√µes p√∫blicas com execu√ß√µes de teste em uma infraestrutura privada.  E n√£o h√° conclus√£o no relat√≥rio. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/IzJsBUPXfkE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br>  <strong>Sobre o palestrante</strong> : Alexander Kharkevich ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">kharkevich</a> ) engenheiro de sistemas s√™nior da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">EPAM Systems</a> . <br><br>  Vamos come√ßar com uma r√°pida vis√£o geral. <br><br><h2>  Sobre Ansible </h2><br>  Ansible √© um sistema de gerenciamento de configura√ß√£o.  Est√° escrito em Python, modelado por Junja, e o YAML √© usado como DSL.  Gerenciado atrav√©s da Ansible Tower - WebUI para gerenciar e monitorar o desempenho do sistema. <br><br>  O Ansible apareceu em 2012, ap√≥s 3 anos que a Red Hat comprou o projeto inteiro e, dois anos depois, lan√ßou o AWX - Project Open Source vers√£o do Ansible Tower. <br><br><h3>  Instala√ß√£o <br></h3><br>  Para usar o Ansible, voc√™ precisa fazer duas coisas simples. <br><br>  No primeiro est√°gio, compile um arquivo de invent√°rio no caso de uma infraestrutura est√°tica. <br><br><img src="https://habrastorage.org/webt/aq/je/io/aqjeioemtokyygau_kxfiil-zt8.png"><br><br>  O segundo √© escrever um manual que traga o sistema ao estado esperado. <br><br><img src="https://habrastorage.org/webt/ul/hs/cy/ulhscyxyzzl9198e7lqq_ykm7sm.png"><br><br>  Freq√ºentemente, temos um desejo irresist√≠vel de escrever automa√ß√£o, que pode ser reutilizada novamente.  A automa√ß√£o √© um bom desejo, e os caras da Ansible criaram um conceito interessante - o papel. <br><br><h3>  Fun√ß√£o <br></h3><br>  Essa √© uma entidade estruturada que levar√° o sistema ao estado esperado com a capacidade de reutilizar a automa√ß√£o. <br><br><img src="https://habrastorage.org/webt/gj/sx/ra/gjsxrakzsho--s_ireyx8_isiqc.png"><br><br>  Por exemplo, podemos escrever uma fun√ß√£o para o Oracle Java: pegue um Playbook, coloque uma fun√ß√£o e aplique-a ao sistema de destino.  A sa√≠da obter√° o Java instalado. <br><br><img src="https://habrastorage.org/webt/tz/9k/us/tz9kuse6fl9sljuokqkmmljbgd4.png"><br><br><h3>  Como imaginamos trabalhar com fun√ß√µes <br></h3><br>  Como o Ansible tem pap√©is maravilhosos, pensamos que agora assumir√≠amos e escrever√≠amos muitos, muitos pap√©is para todas as ocasi√µes, brincar√≠amos e reutiliz√°vamos para reduzir a quantidade de trabalho. <br><img src="https://habrastorage.org/webt/va/vb/1v/vavb1vsgfwficbv2gop8l_hepoe.png"><br><br>  Pensamos em escrever pap√©is bonitos e inteligentes ... <br><br><img src="https://habrastorage.org/webt/rh/hn/sb/rhhnsb_hqwfb-fg3rcdonuzoaqq.png"><br><br>  Mas a vida acabou sendo mais complicada. <br><br><h3>  Como se viu, na verdade <br></h3><br>  Quando mais de uma pessoa trabalha para escrever ou melhorar um papel, todos escrevem em um s√≥ lugar e surgem surpresas desagrad√°veis: o papel n√£o se comporta como o pretendido originalmente pelo autor. <br><br>  √â bom quando aplicado at√© o fim, mas isso nem sempre acontece.  √Äs vezes, uma fun√ß√£o √© executada com √™xito, mas no sistema de destino isso n√£o afeta de maneira alguma como originalmente desejado. <br><img src="https://habrastorage.org/webt/am/nb/3p/amnb3pp-ggmxzah5glc96ih-npk.png"><br><br>  Como resultado, surgem constru√ß√µes terr√≠veis, tentativas de transferir o bash para o Ansible e enviar tudo isso sob o gerenciamento de configura√ß√£o.  Encontramos esse fen√¥meno e ficamos tristes. <br><br><img src="https://habrastorage.org/webt/-s/j0/zl/-sj0zlcvwj2-hrx2oc57cobvefs.png"><br><br>  Pensando, descobrimos que em nosso gerenciamento de configura√ß√£o existe algum tipo de c√≥digo, o que significa que as pr√°ticas que se aplicam ao gerenciamento de c√≥digo no Ciclo de Vida de Desenvolvimento de Sistemas tamb√©m s√£o aplic√°veis ‚Äã‚Äãno Ansible. <br><br><ul><li>  Colete as melhores pr√°ticas. </li><li>  Aplique an√°lise est√°tica, fiapos. </li><li>  Para testar. </li><li>  Para fazer overclock, entrar no Gerenciamento de vers√£o. </li></ul><br>  Decidimos implementar a pr√°tica em casa e fomos imediatamente procurar ferramentas adequadas. <br><br><h3>  As ferramentas </h3><br>  Do ponto de vista dos sistemas de controle de vers√£o e integra√ß√£o cont√≠nua, existem dezenas de solu√ß√µes dispon√≠veis e um zool√≥gico de testes com muitos ramos. <br><br><img src="https://habrastorage.org/webt/xf/u4/2j/xfu42jvysu1pqqzfvext2fdrtxe.png"><br><br>  Do ponto de vista do gerenciamento de vers√µes no Ansible, n√£o existem muitas solu√ß√µes: marcar no Git ou marcar no Git e fazer upload no Galaxy. <br><br>  Existem muitas abordagens para ferramentas de teste, cada uma usando o que elas gostam.  Solu√ß√µes populares usando KitchenCI, InSpec, Serverspec. <br><br>  Nossa alma n√£o mentiu para pegar o Ansible escrito em Python e misturar ferramentas do mundo Ruby.  Portanto, tendo descartado tudo o que n√£o √© nativo do mundo Python, obtivemos a seguinte imagem. <br><br><img src="https://habrastorage.org/webt/xm/qp/1a/xmqp1afvaqz-cggr3as5_w6dzpq.png"><br><br>  N√≥s usamos: <br><br><ul><li>  Para gerenciamento de configura√ß√£o - GitHub e GitLab.  O GitLab est√° assistindo diretamente no GitHub.  Por que fez isso, vou contar mais tarde. </li><li>  Para a CI, levamos Travis para a parte p√∫blica e GitLab Runner para a parte privada. </li><li>  Mol√©cula de teste. </li><li>  Inicie no GitHub e adicione ao Ansible Galaxy. </li></ul><br>  Nosso ciclo de desenvolvimento com essas ferramentas se tornou mais divertido. <br><img src="https://habrastorage.org/webt/ho/o0/un/hoo0unaafdbv6-hp46qvbkt3hyi.png"><br><br><h2>  Mol√©cula <br></h2><br>  Essa ferramenta ajuda a testar completamente o papel ans√≠vel.  Para fazer isso, ele tem tudo: <br><br><ul><li>  Integra√ß√£o com o YAML lint e o Ansible lint para verificar as fun√ß√µes quanto √† conformidade com nossos requisitos. </li><li>  Infraestrutura de teste para execu√ß√£o de testes funcionais. </li><li>  Os drivers da mol√©cula s√£o onde a Molecule est√° implantando nossa bancada de testes.  Tudo √© suportado: Azure, Delegado, Docker, EC2, GCE, LXC, LXD, Openstack, Vagrant. </li><li>  Ainda existe uma coisa √∫til e simples: delega√ß√£o.  Isso significa que a Molecule n√£o √© respons√°vel pela implanta√ß√£o da bancada de testes e o desenvolvedor deve escrever um Playbook para elevar a bancada de testes.  Se voc√™ possui uma nuvem super-privada, delegue a cria√ß√£o e a remo√ß√£o de m√°quinas de teste, e o pr√≥prio Molecule adicionar√° tudo dentro. </li></ul><br><img src="https://habrastorage.org/webt/l6/b0/ke/l6b0ke6b7sthgz-xxbuqgoqzvlw.png"><br><br><h3>  Matriz de teste <br></h3><br>  Considere a matriz de teste em etapas.  Existem 11 etapas no total, mas serei breve. <br><br><h4>  No. 1. Fiapos <br></h4><br>  Eles executam o YAML lint e o Ansible lint e encontram algo. <br><br><img src="https://habrastorage.org/webt/g_/e6/hx/g_e6hxlk44ca411fabcnbamtkmy.png"><br><br>  No exemplo acima, o lint jura que o shell n√£o deve ser chamado apenas em Ansible, mas deve ser corrigido, vinculando-se a algo. <br><br><h4>  No. 2. Destruir </h4><br>  A mol√©cula se livra de tudo o que resta ap√≥s testes anteriores. <br><br>  H√° momentos em que uma corrida passou, um campo de treinamento se desenrolou e os testes foram conclu√≠dos.  O suporte deve ser limpo no final, mas a for√ßa maior interveio e n√£o houve limpeza.  Para tais situa√ß√µes, a mol√©cula foge destr√≥i e limpa o ambiente dos res√≠duos. <br><br><img src="https://habrastorage.org/webt/j2/j2/cn/j2j2cnjnsheyah-w-lbspdbtq1w.png"><br><br><h4>  No. 3. Depend√™ncia <br></h4><br>  Pegamos o arquivo requirements.yml e adicionamos as depend√™ncias de nossa fun√ß√£o em outras fun√ß√µes.  Por exemplo, uma refer√™ncia ao fato de que a fun√ß√£o n√£o ser√° decolada sem o Java instalado no sistema: <br><br><pre><code class="xml hljs">--- - src: lean_delivery.java version: 1.4</code> </pre> <br>  A mol√©cula entende isso e executar√° o script: <br><br><ul><li>  Vai Galaxy ou Git </li><li>  Vai perceber que √© necess√°rio resolver depend√™ncias; </li><li>  Vai para o Galaxy novamente; </li><li>  downloads; </li><li>  ir√° expandir. </li></ul><br><img src="https://habrastorage.org/webt/w1/lc/i1/w1lci1qzqoqsvtqgkutu0ukxmyy.png"><br><br><h4>  No. 4. Sintaxe <br></h4><br>  O pr√≥ximo passo √© a verifica√ß√£o de sintaxe.  mas n√£o sua fun√ß√£o, mas o Playbook de teste que voc√™ adiciona ao Molecule.  Tamb√©m h√° erros de sintaxe nesta etapa. <br><br>  O slide mostra que o papel ansible √© chamado de 'kibana' e, no Playbook de teste, √© chamado ansible-role-kibana.  O sistema diz: "Tudo ficaria bem e voc√™ pode cri√°-lo aqui, mas n√£o o farei porque os nomes n√£o correspondem!" <br><br><img src="https://habrastorage.org/webt/_l/sk/ze/_lskze2oxulkdibbjzvlqftvmtu.png"><br><br><h4>  No. 5. Criar <br></h4><br>  Nesta fase, indicamos o driver com o qual o site de teste est√° implantado.  Aponte o Google - ele criar√° m√°quinas de teste no Google Cloud. <br><br>  Podemos escrever no arquivo molecule.yml o que queremos.  Vamos ver como fica em um exemplo para o Docker. <br><br><img src="https://habrastorage.org/webt/y5/se/vh/y5sevh4mpxt6gxsvkwbvhkvc7ry.png"><br><br><ul><li>  Estou especificando as imagens do docker para serem puxadas para cima. </li><li>  Eu indico como agrup√°-los para que um arquivo de invent√°rio seja formado. </li></ul><br>  Eu quero ter duas imagens do docker: uma para o tipo RHEL e a segunda para o Debian, para ter certeza de que, durante o teste, tudo ficar√° bem com o RHEL e o Debian. <br><br><h4>  No. 6. Prepare <br></h4><br>  Esta √© uma etapa de prepara√ß√£o preliminar para o ambiente de execu√ß√£o de teste. <br><br>  Parece que tudo aumentou, mas √†s vezes voc√™ precisa executar algumas configura√ß√µes adicionais.  No caso de teste dentro de um Docker elevado no Debian ou Ubuntu, voc√™ precisa instalar um segundo Python, o que geralmente acontece. <br><br><h4>  No. 7. Convergir <br></h4><br>  O est√°gio da primeira grande execu√ß√£o da fun√ß√£o dentro da inst√¢ncia, para garantir que ela chegue ao fim, seja executado, e o Ansible confirma que est√° tudo bem. <br><br><img src="https://habrastorage.org/webt/7v/my/du/7vmydu7hzixdur-0yvrxv7t_oqa.png"><br><br><ul><li>  Mol√©cula refere-se a Ansible. </li><li>  Ansible implantado em um site de teste. </li><li>  Funciona. </li><li>  Est√° tudo bem! </li></ul><br><h4>  No. 8. Idempot√™ncia <br></h4><br>  O teste de idempot√™ncia √© simples e se parece com isso. <br><br><img src="https://habrastorage.org/webt/nc/yi/kd/ncyikd7lhq6ojlpm_rg9fbv581k.png"><br><br><ul><li>  A primeira vez que a fun√ß√£o √© executada na etapa anterior. </li><li>  Ansible relata quantas altera√ß√µes foram feitas. </li><li>  Reinicia a mesma fun√ß√£o. </li><li>  Verifica se o sistema foi levado ao estado esperado, mas n√£o h√° altera√ß√µes no segundo aluguel. </li></ul><br>  Como resultado, entendemos que nosso papel n√£o age destrutivamente. <br><br>  Esse est√°gio causou dor para os caras com quem trabalho.  Eles tentaram contornar o problema para derrotar o teste de idempot√™ncia.  A mol√©cula pode controlar os est√°gios pelos quais passa, e a primeira coisa que eles fizeram foi desativar a verifica√ß√£o de idempot√™ncia. <br><br><img src="https://habrastorage.org/webt/0k/wg/jn/0kwgjnxvnxh7aekrwrahmoj3w2a.png"><br><br>  Pegamos apag√µes e nos vencemos por isso, mas os engenheiros s√£o inteligentes e foram mais fundo.  Os desenvolvedores decidiram dizer que este passo no Ansible n√£o muda nada. <br><br>  Embora, de fato, algum tipo de equipe apare√ßa aqui.  Ansible tomar√° e <br>  sobrescrever√° o arquivo, mas ao mesmo tempo tudo parecer√° idempotente. <br><br><img src="https://habrastorage.org/webt/2j/x4/ay/2jx4aycosp5ster62dawq2xzzfg.png"><br><br>  Quando esse truque tamb√©m foi descoberto, a imagem come√ßou a ficar assim. <br><br><img src="https://habrastorage.org/webt/bf/sp/ia/bfspiakbmggjxuxn-hsblzntjzu.png"><br><br>  Bom - o script foi executado com o nome padr√£o e √© idempotente. <br><br><h4>  No. 9. Efeito lateral <br></h4><br>  No pr√≥ximo est√°gio, os efeitos colaterais s√£o sobrepostos.  N√£o √© necess√°rio fazer isso, mas √© conveniente quando voc√™ testar pap√©is de difus√£o complexos que dependem um do outro. <br><br>  Por exemplo, levante a pilha ELK e, em seguida, Elasticsearch em um cluster.  No est√°gio side_effect, adicione dados de teste e remova alguns n√≥s do cluster.  O local do teste est√° pronto para os testes funcionais que ocorrem na pr√≥xima etapa. <br><br><h4>  N√∫mero 10. Verifique <br></h4><br>  Testando a infraestrutura. <br><br><img src="https://habrastorage.org/webt/xe/uu/qj/xeuuqjywe_arafmkfl3tu0nmdte.png"><br><br>  Acima est√° um exemplo de um teste muito simples.  Verificamos se temos o pacote Docker Community Edition instalado, se o Ubuntu estiver instalado, a vers√£o correta e o servi√ßo em execu√ß√£o. <br><br>  Nesta fase do lan√ßamento de testes funcionais, tudo pode ser bastante complicado. <br><br>  Provavelmente, o melhor exemplo seria, no caso da pilha ELK, se fizermos uma solicita√ß√£o em alguma solicita√ß√£o do Elasticsearch para alguns dados de teste e, como sabemos os dados de teste, ele nos responder√°.  N√£o verificaremos se todos os componentes instalados est√£o montados, mas veremos que o Elasticsearch est√° instalado, em execu√ß√£o e fornece exatamente o que voc√™ precisa na pesquisa. <br><br><img src="https://habrastorage.org/webt/--/bl/_v/--bl_vqbdgl6raurbgf0of-hkly.png"><br><br>  Quando os testes funcionais s√£o executados, parece bonito, percorre todo o invent√°rio e o sistema nos diz que est√° tudo bem conosco.  Novamente, os testes ser√£o executados se os escrevermos. <br><br><h4>  No. 11. Destruir <br></h4><br>  Realizamos testes, existe um relat√≥rio de alguma forma e agora removemos todo o lixo atr√°s de n√≥s. <br><br><h3>  Automa√ß√£o <br></h3><br>  A mol√©cula √© uma √≥tima ferramenta.  Agora, a coisa mais simples permanece - conectar um sistema de integra√ß√£o cont√≠nua a ele, a fim de aproveitar o teste autom√°tico de nossas fun√ß√µes, o que fizemos. <br><br><img src="https://habrastorage.org/webt/hx/f6/w8/hxf6w8ahonr80pjg-d1-oquzqcm.png"><br><br>  Como em outros lugares, existem v√°rios recursos. <br><br>  Algumas das fun√ß√µes que escrevemos para automatizar algo s√£o boas, mas n√£o podemos testar o sistema usando o Travis, porque as fun√ß√µes implantam produtos que n√£o podemos compartilhar por motivos de licenciamento. <br><br>  Por exemplo, voc√™ tem uma implanta√ß√£o automatizada de um banco de dados Oracle.  Se voc√™ colocar a base do instalador em um arquivo, os advogados da empresa entrar√£o em contato com voc√™ e jurar√£o muito.  Para que todos vivam em paz e n√£o jurem, decidimos fazer o seguinte. <br><br><ul><li>  O GitLab, em uma de suas vers√µes mais recentes, aprendeu a executar o CI para reposit√≥rios de terceiros. </li><li>  A fun√ß√£o est√° no p√∫blico GitHub, o mesmo p√∫blico GitLab.com est√° conectado a ele, no qual indicamos: "Prezado GitLab, colete o IC para o reposit√≥rio externo". </li><li>  Os corredores particulares s√£o aparafusados ‚Äã‚Äãao GitLab, em um per√≠metro fechado, e eles j√° t√™m acesso ao bin√°rio, que eles podem implantar. </li></ul><br>  De fato, o papel est√° publicamente, os dados tamb√©m, e n√£o estamos enganando ningu√©m - executamos testes reais com ferramentas reais. <br><br>  Vamos dar uma olhada nas etapas de como se parece em Travis. <br><br><h4>  Travis <br></h4><br><img src="https://habrastorage.org/webt/s4/86/d6/s486d6rvzntt55xkmllygy5db5i.png"><br><br>  Os passos: <br><br><ul><li>  Na primeira etapa, na 8¬™ linha, dizemos ao Travis que n√£o queremos apenas inici√°-lo, mas tamb√©m usamos o servi√ßo Docker para que o Docker esteja dispon√≠vel no Travis. </li><li>  Em seguida, na 10¬™ linha, adotamos nossas regras de fiapos.  N√£o apenas usamos as regras Ansible lint padr√£o, mas tamb√©m escrevemos as nossas. </li><li>  Na linha 15, chamamos primeiro o lint para economizar tempo na execu√ß√£o da matriz de teste.  Se algo n√£o est√° escrito de acordo com as regras e o fiapo n√£o o encontra, ent√£o ele vai para o in√≠cio e deixa um relat√≥rio.  Um desenvolvedor que confirma, repara sua confirma√ß√£o ou descarta as altera√ß√µes.  Quando for reparado, deixe-o vir, e continuaremos a continuar o teste. </li></ul><br><h4>  IC p√∫blico <br></h4><br>  O IC p√∫blico parece elementar. <br><br><img src="https://habrastorage.org/webt/tc/am/vt/tcamvta_zifwuzwes75yw5tnk64.png"><br><br>  Do GitHub, uma flecha para Travis, dentro da qual vivem Molecule e Docker. <br><br><h4>  IC privado <br></h4><br>  Para a parte privada do GitLab, tudo √© o mesmo. <br><br><img src="https://habrastorage.org/webt/zs/3_/zc/zs3_zc-hg2mkaitiuji_cquv9yg.png"><br><br>  No per√≠metro privado, corremos um corredor, e a imagem parece mais divertida. <br><br><img src="https://habrastorage.org/webt/jj/t4/yq/jjt4yq5oizqkseowdueobidaato.png"><br><br>  O c√≥digo passa do GitHub para o GitLab, em algum lugar executado por um corredor privado que pode obter servi√ßos externos, por exemplo, algo na Amazon. <br><br>  Um pouco de digress√£o.  Iniciar e implantar um ambiente de teste na Amazon n√£o deseja ser portado, porque voc√™ precisa de chaves.  Criar mecanismos para public√°-los, mas ao mesmo tempo n√£o se tornar a pr√≥xima plataforma de inicializa√ß√£o para minera√ß√£o - essa √© uma tarefa n√£o trivial.  Portanto, n√£o resolvemos, mas levamos o corredor em privado para n√£o minerar bitcoins da Amazon. <br><br>  Mesmo aqui, √©ramos um pouco pregui√ßosos e fizemos o seguinte.  N√≥s do EPAM temos nossa pr√≥pria nuvem privada e √© h√≠brida.  Isso significa que muitas nuvens p√∫blicas s√£o acess√≠veis a partir da nuvem interna, como regi√µes.  Voc√™ n√£o pode escrever mil testes, mas brinque com as regi√µes e diga: "Agora teste de acordo com este cen√°rio de teste para a regi√£o da AWS, EPAM Cloud, Azure". <br><br><h3>  Gal√°xia Ansible <br></h3><br>  Chegamos ao final, nosso papel √© verde, bonito, vamos public√°-lo no Galaxy. <br><br><img src="https://habrastorage.org/webt/0q/zw/tw/0qzwtww1t3m0qoyvlgkzgpptg9u.png"><br><br>  Esta √© uma opera√ß√£o simples: <br><br><ul><li>  A chamada do webhook que est√° em Travis. </li><li>  Nesse caso, o Travis ser√° acionado, o IC ser√° executado novamente. </li><li>  Ligue para o webhook. </li><li>  A nova vers√£o crescer√° com sucesso no Galaxy. </li></ul><br>  H√° um recurso - se voc√™ n√£o marcar um papel, n√£o marcar, n√£o atribuir uma vers√£o a ele, o Galaxy sempre estar√° sem uma vers√£o.  Assim que outro desenvolvedor quiser instal√°-lo pessoalmente atrav√©s da instala√ß√£o do Ansible Galaxy, ele remover√° a fun√ß√£o que est√° no ramo mestre ou em outro ramo por padr√£o.  Por padr√£o, a ramifica√ß√£o nem sempre √© est√°vel, o que √© inconveniente. <br><br><blockquote>  Se voc√™ publicar algo no Galaxy, n√£o se esque√ßa de marc√°-lo corretamente, para que haja vers√µes e tudo tenha sido legal. <br></blockquote><br><h3>  Padr√µes <br></h3><br>  Estou compartilhando um pequeno truque: para n√£o copiar e colar toda vez que escrevemos uma nova fun√ß√£o, decidimos criar modelos e um reposit√≥rio separado no qual colocamos o modelo para escrever rapidamente fun√ß√µes do zero. <br><br>  O modelo possui configura√ß√µes padr√£o para Ansible lint e GitHub issue_template.  Tudo est√° em dom√≠nio p√∫blico; portanto, issue_template de uma forma bonita tamb√©m era bonito para emitir solicita√ß√µes de recebimento ou relat√≥rios de erros.  Adicionamos modelos para Gitignore, Gitlab-ci e uma licen√ßa para o mesmo reposit√≥rio. <br><br><img src="https://habrastorage.org/webt/eb/4m/ta/eb4mta07gv_dgxqszmdkpobnfzq.png"><br><br>  Por padr√£o, publicamos sob a licen√ßa Apache 2.0.  Se voc√™ quiser vir at√© n√≥s e reutilizar os modelos, poder√° retirar tudo, criar um reposit√≥rio fechado e n√£o explicar nada a ningu√©m.  Obrigado Apache. <br><br>  Temos v√°rias op√ß√µes de teste para que voc√™ possa rapidamente iniciar e iniciar tudo. <br><br><h2>  Sum√°rio <br></h2><br>  N√£o haver√° conclus√£o; em vez disso, existem links para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">meu GitHub</a> , meu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">perfil Galaxy</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub Lean Delivery</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ansible Galaxy</a> .  Usando os links, voc√™ pode ver como tudo funciona.  Todos os exemplos est√£o dispon√≠veis gratuitamente. <br><br><blockquote>  A pr√≥xima <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">confer√™ncia do DevOps</a> ser√° realizada em maio. <br><br>  Enquanto aguardamos o evento, assine o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">canal</a> e a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">newsletter</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">YouTube</a> .  O canal ser√° reabastecido com registros dos melhores relat√≥rios e, na lista de discuss√£o, haver√° sele√ß√µes de materiais √∫teis, transcri√ß√µes e not√≠cias de DevOps. <br><br>  Inscreva-se, ser√° interessante :) <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt431542/">https://habr.com/ru/post/pt431542/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt431532/index.html">Memristores constitu√≠dos por partes de 2 nm de espessura</a></li>
<li><a href="../pt431534/index.html">Identidades de problemas entre desenvolvedores</a></li>
<li><a href="../pt431536/index.html">Ceph. Anatomia do desastre</a></li>
<li><a href="../pt431538/index.html">Case Rate & Goods e Mobio: aumento gradual em todos os indicadores</a></li>
<li><a href="../pt431540/index.html">Pacotes e gerenciadores de pacotes para k8s</a></li>
<li><a href="../pt431544/index.html">Leve DevOps para as massas</a></li>
<li><a href="../pt431546/index.html">Por que estamos dizendo OK?</a></li>
<li><a href="../pt431548/index.html">Solar Dozor - O que h√° por tr√°s das estrelas?</a></li>
<li><a href="../pt431550/index.html">Moldagem por Inje√ß√£o de Filme (IMD): Como Funciona</a></li>
<li><a href="../pt431554/index.html">Facebook como contador de um medidor el√©trico antigo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>