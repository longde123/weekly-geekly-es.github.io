<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¨ üë®‚Äçüëß‚Äçüëß üî∂ Mundo dos v√≠rus do MS-DOS üìá ü§Ωüèª üèÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este post √© uma vers√£o em texto da minha palestra no 35¬∫ Chaos Computer Congress no final de 2018. 

 E, portanto, devo admitir que o MS-DOS est√° um p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mundo dos v√≠rus do MS-DOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/edison/blog/440086/"><img src="https://habrastorage.org/getpro/habr/post_images/b72/62e/c62/b7262ec62c4ef1c84e30a166db2801ed.gif" alt="imagem"><br><br>  Este post √© uma vers√£o em texto da minha <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">palestra</a> no 35¬∫ Chaos Computer Congress no final de 2018. <br><br>  E, portanto, devo admitir que o MS-DOS est√° um pouco indignado, apesar do malware do MS-DOS sempre me fascinar at√© certo ponto, mas primeiro devemos perguntar: "O que √© o DOS?" <br><br><ul><li>  O DOS √© uma vers√£o do CP / M, outro sistema operacional muito antigo. </li><li>  A fam√≠lia DOS abrange uma ampla variedade de fornecedores, simplesmente porque √© DOS n√£o significa que ser√° executada em uma CPU 8086 ou superior. </li><li>  Alguns desses provedores de DOS t√™m compatibilidade com API, o que significa que alguns deles usam malware! </li></ul><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/xr/et/uz/xretuzunpjloadbgzif-gsekqo4.jpeg" alt="imagem"><br><br>  <b>V√≠deo de desempenho:</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xgS1M4e_9_E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" title="EDISON Software - desenvolvimento web"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="EDISON Software - desenvolvimento web"></a> <br clear="right">  A postagem foi escrita com o suporte da EDISON Software, que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">desenvolve um aplicativo para uma operadora m√≥vel virtual</a> e est√° envolvida no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">desenvolvimento e manuten√ß√£o de sites em Python</a> . </blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/328/83d/c0d/32883dc0d675c3b77af3bfe1f550ebcc.png" alt="imagem"><br><br>  Mas, de fato, a maioria de nossas mem√≥rias da era DOS √© a est√©tica de como os computadores da √©poca eram: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbf/8c9/ebd/fbf8c9ebdbfe3b6061d80745c60dc7e5.jpg" alt="imagem"><br><br>  Esta √© a era da ‚Äúcomputa√ß√£o bege‚Äù e do teclado Modelo M, que pode ser famoso ou infame, dependendo se voc√™ gosta ou n√£o do teclado barulhento. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ef/c07/8a6/9efc078a6a2e5848807a3d2b3611096a.png" alt="imagem"><br><br>  Alguns de n√≥s podem ter mem√≥rias de uso do DOS, e alguns ainda podem usar o DOS! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a36/117/004/a36117004fac6d309590fe6cd6a81be0.png" alt="imagem"><br><br>  Por exemplo, h√° rumores de que George R. Martin, que escreveu The Game of Thrones, tenha usado o Wordstar no DOS para escrever um livro! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/796/730/bf8/796730bf815f1e8d6b47f7f464648017.png" alt="imagem"><br><br>  Tamb√©m n√£o podemos perder o QBASIC, pois para muitos isso seria o primeiro conhecimento em programa√ß√£o! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca5/6cc/58a/ca56cc58aa88ca31d21e23e4e9d7e4e0.gif" alt="imagem"><br><br>  Mas √†s vezes a vida usando o DOS n√£o era t√£o boa, √†s vezes voc√™ usava o DOS e coisas assim aconteciam subitamente.  Neste exemplo, uma pequena melodia √© tocada durante a impress√£o, portanto, essa pode ser uma situa√ß√£o muito embara√ßosa em um ambiente de escrit√≥rio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf3/d02/d61/bf3d02d61b4ee6dd7a6d9bd3598e0942.gif" alt="imagem"><br><br>  Alguns deles s√£o mais "fofos"; nesse caso, por exemplo, uma ambul√¢ncia desenhada por s√≠mbolos ascii passa e, em seguida, o programa que voc√™ deseja abrir inicia, na pior das hip√≥teses, com pequenos inconvenientes. <br><br>  Gra√ßas a v√°rios arquivistas de malware executando o nome VX Heavens, temos um bom arquivo hist√≥rico de malware do DOS, ou pelo menos at√© a pol√≠cia ucraniana invadir o site: <br><blockquote>  Na sexta-feira, 23 de mar√ßo, o servidor foi apreendido pela pol√≠cia em conex√£o com uma investiga√ß√£o criminal (artigo 361-1 do C√≥digo Penal da Ucr√¢nia - criando malware com a finalidade de vend√™-lo ou distribu√≠-lo) com base nas instru√ß√µes de algu√©m.  sobre "colocar software malicioso de acesso gratuito projetado para hackers n√£o autorizados de computadores, sistemas automatizados, redes de computadores". </blockquote><br>  Felizmente, sites populares de torrent ainda t√™m c√≥pias do banco de dados do site que podem nos fornecer um excelente conjunto de dados: <br><br><pre><code class="plaintext hljs">$ tar -tvf viruses-20070914.tar | wc -l 66714 $ ls -alh viruses-20070914.tar 6.6G viruses-20070914.tar</code> </pre> <br>  No entanto, para come√ßar a estudar essas amostras, precisamos primeiro entender o fluxo de distribui√ß√£o t√≠pico dessas amostras, uma vez que esses programas funcionaram na era pr√©-Internet: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b9/968/2ad/8b99682ad85c8c3b236952ae835869aa.png" alt="imagem"><br><br>  Depois de receber o arquivo infectado no sistema e execut√°-lo, o programa malicioso pesquisar√° ou instalar√° ativamente os interceptadores de chamadas do sistema para os programas executados.  Ele costuma fazer isso de maneira sutil e invis√≠vel para evitar a detec√ß√£o.  A import√¢ncia da sutileza √© importante porque, para distribuir esse programa mal-intencionado, voc√™ deve transferi-lo para outro sistema usando uma m√≠dia (disquete) ou fazer o download para outro ponto de distribui√ß√£o, como o BBS. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a8/bf9/57d/7a8bf957dcced5f67116861d7aa87460.png" alt="imagem"><br><br>  Em tempo de execu√ß√£o, o malware tem duas op√ß√µes;  ele pode permanecer oculto e infectar novos arquivos ou exibir uma carga √∫til. <br><br>  Algumas cargas s√£o muito bonitas!  O exemplo abaixo usa fun√ß√µes incomuns, como 256 cores: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f60/ca9/f79/f60ca9f7987b2e5204fb08a0fbf8c32e.gif" alt="imagem"><br><br>  Ou este que brinca com seu buffer de tela: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b72/62e/c62/b7262ec62c4ef1c84e30a166db2801ed.gif" alt="imagem"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/898/f25/b51/898f25b5140151ecebe8494e39c6797d.png" alt="imagem"><br><br>  No entanto, na maioria das vezes, o malware permanece silencioso e tenta encontrar arquivos para infec√ß√£o.  A infec√ß√£o da maioria dos arquivos √© muito simples, por exemplo, se voc√™ visualizar o arquivo COM como uma longa fita de c√≥digo de m√°quina: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4eb/b47/cde/4ebb47cde9f6329fdaf04dd6c648056d.png" alt="imagem"><br><br>  Ent√£o, ‚Äútudo o que voc√™ precisa fazer‚Äù √© inserir o JMP no in√≠cio do programa e adicionar dados ao final do programa.  Ser√° algo parecido com isto: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6a/eee/16b/c6aeee16b8813e731be734b0c81bdb5d.png" alt="imagem"><br><br>  Algum c√≥digo era mais inteligente e encontrou ‚Äúespa√ßo vazio‚Äù no arquivo bin√°rio e se escreveu l√°, o que impedia o aumento do tamanho do arquivo bin√°rio, o que possivelmente significava que o antiv√≠rus poderia usar a bandeira vermelha. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/898/f25/b51/898f25b5140151ecebe8494e39c6797d.png" alt="imagem"><br><br>  No entanto, anteriormente, eu tamb√©m mencionei interceptar chamadas do sistema.  Apesar do tempo de execu√ß√£o do MS-DOS ser muito simples e praticamente desprotegido (voc√™ pode carregar trivialmente o Linux a partir de um arquivo COM).  Ele ainda cont√©m a API completa para que os aplicativos n√£o precisem ter sua pr√≥pria implementa√ß√£o de sistema de arquivos.  Aqui est√£o alguns recursos do syscalls: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/503/b94/031/503b94031afdf70ab966327bb6a83ef5.png" alt="imagem"><br><br>  Eles trabalham causando uma interrup√ß√£o do software, na qual o programa solicita que o processador mude para outra se√ß√£o da mem√≥ria do sistema para processar algo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db8/424/17c/db842417cb90c6059bfeb0e92cf7bdf9.png" alt="imagem"><br><br>  No entanto, o MS-DOS tamb√©m oferece a capacidade de adicionar / modificar essas chamadas (usando outra chamada), permitindo expandir o sistema para que novos drivers possam carregar em tempo de execu√ß√£o.  No entanto, tamb√©m √© um local ideal para adicionar intercepta√ß√µes de malware: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e5/051/5f4/7e50515f49434bd39a96c29be41aa253.png" alt="imagem"><br><br>  Foi um truque bem usado, porque voc√™ pode interceptar a chamada "Abrir arquivo" e us√°-la para detectar novos arquivos execut√°veis ‚Äã‚Äãno sistema ... e infect√°-los. <br><br>  Como um exemplo r√°pido de como eles s√£o usados, vejamos um programa simples Hello World: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/ee5/abb/07eee5abbb7f150ad322aca95a1491b0.png" alt="imagem"><br><br>  Como podemos ver, existem duas chamadas do tipo <code>int</code> .  Usamos <code>21h</code> (h = hex) como o n√∫mero de chamada principal do sistema e podemos especificar qual a√ß√£o queremos que o MS-DOS execute com base no valor de <code>Ah</code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b3/e30/ea8/2b3e30ea8878b81233d5387df02d3cf5.png" alt="imagem"><br><br>  Nesse caso, o programa faz uma chamada para imprimir a linha e sai com o c√≥digo de retorno 0 (indefinido). <br><br>  Como mencionado anteriormente.  Quando voc√™ chama int 21h, o processador central procura na tabela IVT para onde ir; nesse manipulador, muitas vezes h√° um segmento como um roteador que roteia v√°rias chamadas principais; no caso do Int 21h, ele direciona para v√°rias fun√ß√µes com base no valor ah.  Assim que chegarmos ao local, o manipulador de chamadas real lidar√° com a tarefa e, em seguida, executar√° iret para retornar ao programa principal, geralmente deixando registros dos resultados da chamada: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b22/a7c/b66/b22a7cb66a3449cb811537c121b96db2.gif" alt="imagem"><br><br>  Ent√£o  Se quisermos ver todas as chamadas do sistema iniciadas pelo programa, podemos definir um ponto de interrup√ß√£o no in√≠cio do manipulador de interrup√ß√µes e verificar o que √© ah: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/437/8a0/dab/4378a0dabeddb413b66d3985f7a07ae4.png" alt="imagem"><br><br>  Fazemos isso porque o manipulador de interrup√ß√£o est√° sempre em um local fixo no MS-DOS (isso √© muito anterior √† era ASLR e ASLR do Kernel) e a localiza√ß√£o do programa n√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c56/630/3df/c566303dfe33c0822630fdd2a7e6e4e5.png" alt="imagem"><br><br>  Quando o lan√ßamos, podemos ver os desafios criados por esse padr√£o.  Enquanto podemos ver na tela que ele acabou de imprimir uma notifica√ß√£o sobre o arquivo Goat (Goat √© um arquivo projetado para infectar, como uma cabra sacrificial).  Tamb√©m vemos que este programa faz mais do que apenas imprimir uma linha.  Ele verifica a vers√£o do DOS (provavelmente para verificar a compatibilidade) e, em seguida, abre, l√™ e grava dados! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc8/e68/30d/fc8e6830de63466825df85f1e98be417.png" alt="imagem"><br><br>  Isso √© interessante!  Mas gostar√≠amos de saber mais sobre o que o sistema chama destacado em vermelho, pois eles devem ter entrada para coisas como nomes de arquivos e dados para gravar em arquivos / sa√≠da na tela. <br><br>  Para fazer isso, precisamos olhar para outros registros durante o syscall: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f55/e53/9a4/f55e539a4af8d544409dadf05f181005.png" alt="imagem"><br><br>  Usando "Imprimir String" como um exemplo simples, podemos ver como √© o uso: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/223/3cf/9f5/2233cf9f5a0fe096b71c9f7e38d81602.png" alt="imagem"><br><br>  O que √© o DS: DX?  Por que existem dois registros aqui e como obtemos dados deles? <br><br>  Para fazer isso, precisamos entender um pouco mais sobre o processador 8086. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e61/fc6/160/e61fc6160d49dcee4568635340b860dd.png" alt="imagem"><br><br>  O processador 8086 √© uma CPU de 16 bits, mas com endere√ßamento de mem√≥ria de 20 bits.  Isso significa que o processador pode armazenar apenas valores que indicam 64 KB; esse √© um problema quando a capacidade da mem√≥ria √© de at√© 1 MB. <br><br>  Para contornar isso, precisamos entender os registros de segmenta√ß√£o: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d5/6e0/263/0d56e02639206a885d4899036a1bbf6e.png" alt="imagem"><br><br>  O processador 8086 possui 4 registros de segmenta√ß√£o dos quais precisamos cuidar: <br><br><ul><li>  CS - segmento de c√≥digo </li><li>  DS - segmento de dados </li><li>  SS - segmento de pilha </li><li>  ES - um segmento adicional (caso voc√™ precise de mais um para contornar diferentes situa√ß√µes) </li></ul><br>  Existem v√°rios outros registradores de uso geral que evitam o uso excessivo de mem√≥ria e permitem passar par√¢metros para outras fun√ß√µes. <br>  A segmenta√ß√£o registra o trabalho alterando o bloco na RAM: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/ff2/bca/5cdff2bca72f3d038fb3830bb38ff6c2.gif" alt="imagem"><br><br>  Isso permite que a CPU de 16 bits veja todos os 20 bits de RAM, garantindo que para cada valor de DS o bloco seja compensado por 16 bytes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84a/9d8/7be/84a9d87be1242165bd3aa45cd06c6039.png" alt="imagem"><br><br>  Nesse caso, a chamada DS √© usada como um ponteiro dentro da janela de 16 bits em rela√ß√£o ao local da linha.  Em seguida, a impressora de linha digitalizar√° at√© encontrar o caractere $ e, em seguida, para.  Isso √© semelhante a outros sistemas que usam bytes nulos em vez de $. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4e2/5a9/f0b/4e25a9f0b1b0d7cfaab1d6795eaaf6ed.gif" alt="imagem"><br><br>  Com a idade do ISA x86, pouco mudou, em vez de o tamanho do bit do processador ter aumentado, os mesmos registros se tornaram maiores. <br><br>  Portanto, com esse conhecimento, podemos criar uma lista de "tarefas" para rastrear esses programas: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/832/a32/910/832a329105d030ee51a56a372d671302.png" alt="imagem"><br><br>  Com essa configura√ß√£o, podemos jogar v√°rios computadores grandes no problema por v√°rias horas e coletar os resultados! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ddd/6c3/5c2/ddd6c35c2e4bab73fd088dde763ee470.png" alt="imagem"><br><br>  E n√≥s temos ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f4/3b4/0f9/1f43b40f9e7f8b1bffff55bc8fc6ab70.png" alt="imagem"><br><br>  Nada disso. <br><br>  Isso √© decepcionante. <br><br>  Queimamos pelo menos um hamsters no valor de energia e quase n√£o recebemos ativa√ß√µes legais!  <i>(Xs como traduzir isso)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d69/69d/be2/d6969dbe2ff5f0c7629b1f9e594e6c3a.png" alt="imagem"><br><br>  Se olharmos para algumas amostras, veremos uma arma de fuma√ßa aqui.  Uma amostra decente de amostras verifica a data ou a hora. <br><br>  Se olharmos para a documenta√ß√£o dessas chamadas, veremos que a chamada do sistema retorna valores na forma de registros para o programa: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/186/a75/265186a7562b336b45e194bf82e3b02a.png" alt="imagem"><br><br>  Para que possamos for√ß√°-los brutalmente!  Tudo o que precisamos fazer √© algo como isto: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0aa/556/5fe/0aa5565fe29e9008f8607305f53bf28b.png" alt="imagem"><br><br>  Mas h√° um problema com esse m√©todo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce5/bf3/7b6/ce5bf37b6d1c0aaccbed58e064c4ece5.png" alt="imagem"><br><br>  A etapa de testar o exemplo leva cerca de 15 segundos, pois usa o processo completo de emula√ß√£o do qemu e pode levar at√© 15 segundos para executar o programa completamente na m√°quina virtual.  Como o DOS n√£o possui recursos de economia de energia, isso significa que, quando o DOS est√° no modo de espera, ele fica em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ciclo ocupado</a> <br><br>  Portanto, podemos analisar esse problema de maneira diferente, observando qual c√≥digo ser√° executado ap√≥s a solicita√ß√£o de data / hora. <br><br>  Como nosso rastreador est√° no manipulador de interrup√ß√µes, n√£o sabemos da caixa onde o programa est√° localizado: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/435/1eb/4cf/4351eb4cfd0effcf312e0f8154e5a29b.png" alt="imagem"><br><br>  Para fazer isso, precisamos olhar para a pilha onde os registros de CS e IP nos aguardam! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f8/a73/a94/0f8a73a9432e23d64675fefd7f504e5e.png" alt="imagem"><br><br>  Assim que pegarmos esses dois registros da pilha, podemos us√°-los para obter o c√≥digo de retorno, para que nossa lista de verifica√ß√£o fique assim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/837/d44/cdf/837d44cdf7fbb940b4428cd2e2871f54.png" alt="imagem"><br><br>  Depois de fazer isso e repetir o teste do conjunto de dados, veremos como √© a parte do c√≥digo de retorno! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45a/ee0/71e/45aee071eb023929029044227939d0d7.png" alt="imagem"><br><br>  Aqui est√° uma amostra de um.  Aqui vemos que √© feita uma compara√ß√£o para DL e 0x1e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/186/a75/265186a7562b336b45e194bf82e3b02a.png" alt="imagem"><br><br>  Se olharmos para a nossa documenta√ß√£o, veremos que a DL √© o dia do m√™s, ou seja, podemos analisar os tr√™s principais c√≥digos de opera√ß√£o da seguinte maneira: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/12f/220/4fc12f220ff2d17566087e726398e728.png" alt="imagem"><br><br>  Poder√≠amos analisar manualmente tudo isso, mas existem muitas dessas amostras que verificam o tempo, em torno de 4700: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b1/25f/720/1b125f720508620f525c3d3535ca8cbb.png" alt="imagem"><br><br>  Ent√£o, em vez disso, precisamos fazer outra coisa.  Precisamos escrever algo ... Precisamos escrever ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22c/383/5a1/22c3835a1387f950080cee18fb0da8ef.png" alt="imagem"><br><br>  O pior emulador x86 do mundo, chamado BenX86, √© um emulador projetado especificamente para nossas necessidades e nada mais: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/561/58b/66c/56158b66ca09d37e7dc64194df98d623.png" alt="imagem"><br><br>  Mas ele tem algumas vantagens em sua velocidade. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d05/4e9/540/d054e954038188ec32e684b3a6ccad95.png" alt="imagem"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/1e8/dd6/77c1e8dd6527f6105236b2e5b6d61fa0.png" alt="imagem"><br><br>  Adicionamos 10.000 testes de execu√ß√£o diferentes com base nos caminhos que encontramos usando for√ßa bruta usando BenX86.  Ent√£o, terminarei com algumas das minhas descobertas favoritas ativadas no tempo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b9/308/b5d/1b9308b5d968a59433bff7c9448e1ed2.gif" alt="imagem"><br><br>  Esse padr√£o √© ativado no dia de ano novo e desliga o sistema depois que uma sauda√ß√£o √© exibida.  Pode ser bom se voc√™ estiver preso no escrit√≥rio durante o ano novo, ou pode ser ruim se realmente precisar fazer algo no dia de ano novo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/40d/b3a/0be/40db3a0be86fb2dd6891c9836001343b.png" alt="imagem"><br><br>  Este exemplo me surpreendeu muito.  Ele √© ativado no in√≠cio de 1995 e informa o usu√°rio sobre todos os arquivos infectados que ele infectou e remove o v√≠rus (excluindo a transi√ß√£o no in√≠cio) e, em seguida, n√£o faz mais nada.  Embora, por algum motivo, diga que voc√™ deve comprar a McAfee, essa mensagem obviamente n√£o est√° desatualizada. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/201/094/384/20109438477e51765809aa938551d027.png" alt="imagem"><br><br>  Isso, francamente, realmente me confunde: em 8 de novembro de qualquer ano, ele transformar√° todos os zero no sistema em pequenos glifos de "√≥dio".  Realmente me incomoda se voc√™ sabe por que precisa, me avise ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/802/2ba/081/8022ba0819bf2177c6a856a626fb4976.gif" alt="imagem"><br><br>  Este √© provavelmente o meu pesadelo quando, ap√≥s iniciar qualquer programa, ele exibe uma mensagem de que ela n√£o pode comer sua unidade principal.  Seria incrivelmente perturbador ver do nada. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/381/f69/768/381f697681914f2412955bb3c73d46a0.png" alt="imagem"><br><br>  Em conclus√£o, temos o que √© a vers√£o do Navy Seal Copypasta do malware do DOS.  N√£o tenho certeza de que este autor n√£o goste de Aladdin, mas fa√ßa o que fizer, voc√™ √© uma pessoa. <br><br>  Se voc√™ estiver interessado no c√≥digo que foi executado neste artigo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lancei meu kit de ferramentas no github</a> , sem qualquer garantia.  Se voc√™ deseja criar esse c√≥digo por conta pr√≥pria, precisar√° trabalhar para garantir que ele funcione com a instala√ß√£o do MS-DOS (corrigindo um ponto de interrup√ß√£o do manipulador) <br><br>  No entanto, se voc√™ apenas olhar para ver o que vi enquanto olhava para este projeto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">arquivei a</a> interface da web aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dosv.benjojo.co.uk</a> <br><br>  At√© breve! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440086/">https://habr.com/ru/post/pt440086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440072/index.html">Demo AresDB: ferramenta de an√°lise em tempo real de fonte aberta baseada em GPU do Uber</a></li>
<li><a href="../pt440074/index.html">Roskomos considera incorreto comparar os motores Raptor Ilona Mask e RD-180</a></li>
<li><a href="../pt440076/index.html">Tradu√ß√£o e interpreta√ß√£o de publicidade do ingl√™s para o russo</a></li>
<li><a href="../pt440078/index.html">Dispositivo compilador r√°pido. Parte 4</a></li>
<li><a href="../pt440084/index.html">10 bilh√µes de exporta√ß√µes de software √© insignificante</a></li>
<li><a href="../pt440088/index.html">bobaflu - acess√≥rios de programa√ß√£o no flutter</a></li>
<li><a href="../pt440090/index.html">Como funcionam os indicadores t√©cnicos no mercado de a√ß√µes?</a></li>
<li><a href="../pt440092/index.html">Uma investiga√ß√£o matem√°tica de como falsas elei√ß√µes para governador em Primorye em 16 de setembro de 2018</a></li>
<li><a href="../pt440094/index.html">Jardins florescendo em Marte permanecem um sonho: o projeto Mars One faliu</a></li>
<li><a href="../pt440096/index.html">Vulnerabilidade ao RunC que afeta o Kubernetes, Docker e Containerd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>