<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘ğŸ½ ğŸ’· ğŸ”š Cara membuat aplikasi Bereaksi lebih cepat dengan negara hosting bersama ğŸ¥‰ ğŸ‘‚ğŸ» ğŸš</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini tentang colocation negara , yaitu tentang penempatan bersama negara , istilah ini masih bisa diterjemahkan sebagai colocation negara atau ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara membuat aplikasi Bereaksi lebih cepat dengan negara hosting bersama</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485032/"><p>  <em>Artikel ini tentang <strong>colocation negara</strong> , yaitu tentang <strong>penempatan bersama negara</strong> , istilah ini masih bisa diterjemahkan sebagai <strong>colocation negara</strong> atau <strong>colocation negara</strong> .</em> </p><br><p>  Salah satu alasan utama untuk memperlambat aplikasi Bereaksi adalah keadaan globalnya.  Saya akan menunjukkan ini dengan contoh aplikasi yang sangat sederhana, setelah itu saya akan memberikan contoh lebih dekat dengan kehidupan nyata. </p><br><p>  Berikut ini adalah aplikasi sederhana untuk memasukkan nama untuk anjing tersebut (jika jendelanya tidak berfungsi, <a href="https://uy9h3.csb.app/">inilah tautannya</a> ): </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> Jika Anda bermain dengan aplikasi ini, Anda akan segera menemukan bahwa itu bekerja sangat lambat.  Saat berinteraksi dengan bidang input apa pun, ada masalah kinerja yang nyata.  Dalam situasi seperti itu, Anda bisa menggunakan lifebuoy dalam bentuk <code>React.memo</code> dan membungkusnya dengan semua komponen dengan render lambat.  Tapi mari kita coba selesaikan masalah ini secara berbeda. </p><br><p>  Berikut adalah kode untuk aplikasi ini: </p><a name="habracut"></a><br><pre> <code class="xml hljs">function sleep(time) { const done = Date.now() + time while (done &gt; Date.now()) { // ... } } //      // -       function SlowComponent({time, onChange}) { sleep(time) return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> Wow, that was{' '} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> onChange(Number(e.target.value))} /&gt; ms slow <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function DogName({time, dog, onChange}) { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> onChange(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function App() { //   " " (global state) const [dog, setDog] = React.useState('') const [time, setTime] = React.useState(200) return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogName</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setDog}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SlowComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setTime}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Jika Anda belum membaca artikel tentang <a href="https://kentcdodds.com/blog/colocation">Colocation</a> (co-location), saya sarankan Anda membacanya.  Mengetahui bahwa hosting bersama dapat membuatnya lebih mudah untuk bekerja dengan aplikasi kita, mari gunakan prinsip ini ketika bekerja dengan negara. </p><br><p>  Perhatikan kode aplikasi kita, yaitu status <code>time</code> - digunakan oleh setiap komponen aplikasi kita, oleh karena itu diangkat ( <a href="https://ru.reactjs.org/docs/lifting-state-up.html">mengangkat - menaikkan status</a> ) ke komponen <code>App</code> (komponen yang membungkus seluruh aplikasi kita).  Namun, status "dog" ( <code>dog</code> dan <code>setDog</code> ) hanya digunakan oleh satu komponen, tidak diperlukan dalam komponen <code>App</code> , jadi mari kita pindahkan ke komponen <code>DogName</code> : </p><br><pre> <code class="xml hljs">function DogName({time}) { // <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag">    </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">const</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">setDog</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">React.useState(</span></span></span><span class="hljs-tag">'') // &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span><span class="hljs-tag">   </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">return</span></span></span><span class="hljs-tag"> ( &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> setDog(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function App() { //   " " (global state) const [time, setTime] = React.useState(200) return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogName</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> /&gt;</span></span> // <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag">    &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SlowComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setTime}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Dan inilah hasil kami (jika jendela tidak berfungsi, <a href="https://9nqld.csb.app/">tautkan</a> ): </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Wow!  Memasukkan nama sekarang bekerja JAUH lebih cepat.  Selain itu, komponen menjadi lebih mudah dirawat berkat lokasi bersama.  Tetapi mengapa itu bekerja lebih cepat? </p><br><p>  Mereka mengatakan bahwa cara terbaik untuk melakukan sesuatu dengan cepat adalah melakukan sesedikit mungkin hal.  Inilah yang terjadi di sini.  Ketika kami mengelola keadaan yang terletak di bagian paling atas dari pohon komponen, setiap pembaruan dari keadaan ini akan membatalkan seluruh pohon.  Reaksi tidak tahu apa yang telah berubah, karena ini, ia harus memeriksa semua komponen untuk melihat apakah mereka memerlukan pembaruan DOM.  Proses ini tidak gratis dan menghabiskan sumber daya (terutama jika Anda memiliki komponen yang sengaja lambat).  Tetapi jika Anda memindahkan status serendah mungkin di pohon komponen, seperti yang kami lakukan dengan status <code>dog</code> dan komponen <code>DogName</code> , maka Bereaksi akan melakukan lebih sedikit pemeriksaan.  React tidak akan memeriksa komponen <code>SlowComponent</code> (yang sengaja kami buat lambat), karena React tahu bahwa komponen ini masih tidak dapat mempengaruhi output. </p><br><p>  Singkatnya, sebelumnya, ketika mengubah nama anjing, setiap komponen diperiksa untuk perubahan (dirender ulang).  Dan setelah perubahan yang kami lakukan pada kode, React mulai memeriksa hanya komponen <code>DogName</code> .  Ini telah menyebabkan peningkatan nyata dalam produktivitas! </p><br><h2 id="v-realnoy-zhizni">  Dalam kehidupan nyata </h2><br><p>  Saya melihat bahwa para pengembang menempatkan repositori global Redux atau dalam konteks global apa yang seharusnya tidak bersifat global.  <code>DogName</code> seperti <code>DogName</code> dari contoh di atas sering merupakan tempat di mana masalah kinerja terjadi.  Saya sering melihat bahwa masalah ini memanifestasikan dirinya ketika berinteraksi dengan mouse (misalnya, ketika menampilkan tooltip di atas grafik atau di atas tabel data). </p><br><p>  Salah satu solusi untuk masalah ini adalah "membatalkan" interaksi pengguna (yaitu, kami menunggu sampai pengguna berhenti mengetik, dan kemudian kami menerapkan pembaruan status).  Kadang-kadang, ini adalah yang terbaik yang bisa kita lakukan, tetapi itu dapat menyebabkan pengalaman pengguna yang buruk (mode bersamaan di masa depan harus meminimalkan kebutuhan untuk melakukan <a href="https://youtu.be/nLF0n9SACd4%3Ft%3D181">ini</a> . <a href="https://youtu.be/nLF0n9SACd4%3Ft%3D181">Lihat demo ini dari Dan Abramov</a> ). </p><br><p>  Solusi lain yang sering digunakan pengembang adalah menggunakan salah satu rendering penyelamatan React, misalnya <code>React.memo</code> .  Ini akan bekerja dengan sangat baik dalam contoh kita yang dibuat-buat, karena memungkinkan Bereaksi untuk melompati rendering ulang <code>SlowComponent</code> , tetapi dalam praktiknya aplikasi mungkin menderita karena "kematian dari ribuan pemotongan," karena dalam aplikasi nyata perlambatan biasanya bukan karena satu lambat komponen, dan karena kerja yang tidak cepat dari banyak komponen, jadi Anda harus menggunakan <code>React.memo</code> mana-mana.  Setelah melakukan ini, Anda harus mulai menggunakan <code>useMemo</code> dan <code>useCallback</code> , jika tidak semua pekerjaan yang Anda masukkan ke <code>React.memo</code> akan sia-sia.  Tindakan ini dapat memecahkan masalah, tetapi mereka secara signifikan meningkatkan kompleksitas kode Anda dan, pada kenyataannya, mereka masih kurang efektif daripada berbagi status, karena Bereaksi harus melalui setiap komponen (mulai dari atas) untuk menentukan apakah perlu dirender lagi. </p><br><p>  Jika Anda ingin bermain <a href="https://codesandbox.io/s/colocate-state-ts1x9">-</a> main dengan contoh yang sedikit kurang masuk akal, <a href="https://codesandbox.io/s/colocate-state-ts1x9">buka codesandbox di sini</a> . </p><br><h2 id="chto-takoe-sovmestnoe-razmeschenie-sostoyaniy">  Apa itu co-location? </h2><br><p>  Prinsip negara <a href="https://kentcdodds.com/blog/colocation">penempatan gabungan</a> : </p><br><blockquote>  Kode harus ditempatkan sedekat mungkin ke tempat yang terkait. </blockquote><p>  Jadi, untuk mematuhi prinsip ini, keadaan <code>dog</code> kita harus berada <em>di</em> dalam komponen <code>DogName</code> : </p><br><pre> <code class="xml hljs">function DogName({time}) { const [dog, setDog] = React.useState('') return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> setDog(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Tetapi bagaimana jika kita memecah komponen ini menjadi beberapa komponen?  Kemana negara harus pergi?  Jawabannya sama: "sedekat mungkin dengan tempat yang terkait," dan itu akan menjadi <strong>komponen induk terdekat</strong> yang <strong>terdekat</strong> .  Sebagai contoh, mari kita <code>DogName</code> komponen <code>DogName</code> <code>input</code> dan <code>p</code> ditampilkan dalam komponen yang berbeda: </p><br><pre> <code class="xml hljs">function DogName({time}) { const [dog, setDog] = React.useState('') return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogInput</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setDog}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogFavoriteNumberDisplay</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function DogInput({dog, onChange}) { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> onChange(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/&gt;</span></span> ) } function DogFavoriteNumberDisplay({time, dog}) { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Kami tidak dapat memindahkan status ke komponen <code>DogInput</code> , karena komponen <code>DogFavoriteNumberDisplay</code> juga memerlukan akses ke keadaan, jadi kami pindah dari bawah ke atas pohon komponen hingga kami menemukan induk yang sama dari dua komponen ini dan mengatur manajemen negara di dalamnya. </p><br><p>  Semua ini berlaku untuk situasi ketika Anda perlu mengontrol keadaan puluhan komponen pada layar tertentu aplikasi Anda.  Anda bahkan dapat memindahkan ini ke konteks untuk menghindari <a href="https://kentcdodds.com/blog/prop-drilling">pengeboran prop</a> jika Anda mau.  Tetapi jaga konteks ini sedekat mungkin dengan tempat tempatnya, dan kemudian Anda akan terus mempertahankan kinerja yang baik (dan kegunaan kode) yang disediakan oleh berbagi.  Ingatlah bahwa Anda tidak perlu menempatkan <em>semua</em> konteks di tingkat atas aplikasi Bereaksi Anda.  Simpan mereka di tempat yang paling masuk akal. </p><br><p>  Ini adalah ide utama dari posting saya yang lain, <a href="https://kentcdodds.com/blog/application-state-management-with-react">Application State Management with React</a> .  Jaga status Anda sedekat mungkin ke tempat di mana mereka digunakan, ini akan meningkatkan kinerja dan kegunaan kode.  Dengan pendekatan ini, satu-satunya hal yang mungkin akan memperburuk kinerja aplikasi Anda adalah interaksi yang kompleks dengan elemen antarmuka. </p><br><h2 id="tak-chto-ispolzovat-konteksty-ili-redux">  Jadi apa yang harus digunakan, konteks atau Redux? </h2><br><p>  Jika Anda membaca <a href="https://kentcdodds.com/blog/optimize-react-re-renders">"Satu trik sederhana untuk mengoptimalkan React renders"</a> , maka Anda tahu bahwa Anda dapat memastikan bahwa hanya komponen-komponen yang menggunakan status yang diubah yang diperbarui.  Dengan cara ini Anda bisa mengatasi masalah ini.  Tetapi orang-orang masih menghadapi masalah kinerja saat menggunakan Editor.  Masalahnya adalah <a href="https://react-redux.js.org/using-react-redux/connect-mapstate">bahwa React-Redux mengharapkan Anda untuk mengikuti rekomendasinya untuk menghindari rendering komponen yang tidak perlu</a> .  Selalu ada kemungkinan kesalahan, Anda dapat secara tidak sengaja mengonfigurasi komponen sehingga komponen tersebut mulai terlalu sering dirender ketika status global lainnya berubah.  Dan semakin besar aplikasi Anda, semakin banyak efek negatifnya, terutama jika Anda menambahkan terlalu banyak status ke Editor. </p><br><p>  Ada beberapa metode yang dapat membantu Anda menghindari masalah-masalah ini, misalnya, menggunakan <a href="https://blog.isquaredsoftware.com/2018/11/react-redux-history-implementation/"><code>memoized Reselect     mapState</code></a> , atau baca <a href="https://redux.js.org/faq">dokumentasi Editor untuk informasi lebih lanjut tentang meningkatkan kinerja aplikasi</a> . </p><br><p>  Perlu dicatat bahwa penempatan bersama dapat diterapkan bersama dengan Editor.  Cukup gunakan Editor hanya untuk negara-negara global, dan untuk semua yang lain, gunakan co-location.  Ada <a href="https://redux.js.org/faq/organizing-state">beberapa aturan yang berguna di</a> FAQ Editor <a href="https://redux.js.org/faq/organizing-state">untuk membantu Anda memutuskan apakah negara harus berfungsi di Editor atau harus tetap dalam komponen</a> . </p><br><p>  By the way, jika Anda membagi negara Anda menjadi domain (menggunakan beberapa konteks tergantung pada domain), maka masalahnya akan kurang diucapkan. </p><br><p>  Tetapi faktanya tetap: co-location dari negara mengurangi masalah kinerja dan menyederhanakan pemeliharaan kode. </p><br><h2 id="prinimaem-reshenie-o-tom-kuda-pomestit-sostoyanie">  Putuskan di mana menempatkan negara </h2><br><p>  Pohon Keputusan: </p><br><p><img src="https://habrastorage.org/webt/oj/z8/pt/ojz8ptwezz3qmxqicorsrsh1bku.jpeg" alt="di mana-to-put-state"></p><br><p>  Versi teks, jika tidak ada cara untuk melihat gambar: </p><br><ul><li>  1 Kami mulai mengembangkan aplikasi.  Pergi ke 2 </li><li>  2 Status dalam komponen.  Pergi ke 3 </li><li>  3 Apakah kondisi <strong>hanya</strong> digunakan <strong>oleh</strong> komponen ini? <br><ul><li>  Hah?  Kami pergi ke 4 </li><li>  Tidak  Apakah keadaan ini hanya <strong>membutuhkan</strong> <em>satu</em> komponen anak? </li><li>  Hah?  Pindahkan ke komponen anak ini (gunakan co-location).  Kami pergi ke 3. </li><li>  Tidak  Apakah keadaan ini memerlukan komponen orang tua atau tetangga ("persaudaraan", yaitu anak-anak dari komponen orang tua yang sama)? <br><ul><li>  Hah?  Pindahkan status di atas ke komponen induk.  Pergi ke 3 </li><li>  Tidak  Kami pergi ke 4 </li></ul></li></ul></li><li>  4 Tinggalkan apa adanya.  Pergi ke 5 </li><li>  5 Apakah ada masalah dengan pengeboran prop? <br><ul><li>  Hah?  Kami memindahkan negara ini ke penyedia konteks dan membuat penyedia ini dalam komponen di mana negara dikelola.  Pergi ke 6 </li><li>  Tidak  Pergi ke 6 </li></ul></li><li>  6 Kami mengirim aplikasi.  Ketika persyaratan baru muncul, buka 1 </li></ul><br><p>  Adalah penting bahwa proses ini menjadi bagian dari proses refactoring / pemeliharaan aplikasi reguler Anda.  Jika kondisi Anda tidak dinaikkan ke tempat seharusnya, maka kondisi ini akan berhenti bekerja dengan benar dan Anda akan melihatnya.  Namun, jika Anda tidak mengikuti metode co-location negara, dan tidak menurunkan status lebih rendah dalam hierarki komponen, maka aplikasi Anda akan terus berfungsi.  Karena itu, Anda tidak akan segera melihat masalah kinerja dan pengelolaan yang secara bertahap akan menumpuk. </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Secara umum, pengembang cukup mengerti kapan perlu menaikkan status ("lifting state") saat diperlukan, tetapi kami tidak mengerti dengan baik kapan kondisi perlu diturunkan.  Saya sarankan Anda melihat kode aplikasi Anda dan berpikir tentang di mana negara dapat dihilangkan dengan menerapkan prinsip "co-location".  Tanyakan pada diri sendiri, "Apakah saya memerlukan status <code>isOpen</code> dari jendela modal di Editor?"  (jawabannya kemungkinan besar tidak). </p><br><p>  Gunakan prinsip co-location, dan kode Anda akan menjadi lebih mudah dan lebih cepat. </p><br><p>  Semoga beruntung </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id485032/">https://habr.com/ru/post/id485032/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id485022/index.html">Playme Sigma: DVR Fungsional dan Terjangkau</a></li>
<li><a href="../id485024/index.html">Apa yang ada di bawah kap optimasi pengoptimalan GraalVM?</a></li>
<li><a href="../id485026/index.html">Peluang Georgia untuk para profesional TI</a></li>
<li><a href="../id485028/index.html">CRM 2020</a></li>
<li><a href="../id485030/index.html">8 biaya IEO teratas dan kapitalisasi mereka sekarang</a></li>
<li><a href="../id485034/index.html">Mengotomatiskan pembuatan proyek Qt pada Windows di Travis CI</a></li>
<li><a href="../id485036/index.html">Mengapa saya perlu dukungan instrumental untuk pagination utama</a></li>
<li><a href="../id485042/index.html">Karena dukungan 5G wajib, smartphone dengan Snapdragon 865 akan lebih buruk pada tahun 2020</a></li>
<li><a href="../id485044/index.html">Kami membongkar jam digital dari pesawat ruang angkasa Soyuz</a></li>
<li><a href="../id485046/index.html">Bagaimana Merencanakan Strategi Produk Unggulan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>