<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚰 ⏰ 🤙🏾 Estufa inteligente em Telegram 👩🏾‍🤝‍👩🏽 👃🏼 🛀🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Boa tarde Em nosso site, há uma estufa. Seu principal problema é o superaquecimento em clima quente, como projetado principalmente para a primavera da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Estufa inteligente em Telegram</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/400499/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boa tarde </font><font style="vertical-align: inherit;">Em nosso site, há uma estufa. </font><font style="vertical-align: inherit;">Seu principal problema é o superaquecimento em clima quente, como </font><font style="vertical-align: inherit;">projetado principalmente para a primavera da Sibéria. </font><font style="vertical-align: inherit;">A única saída é abrir / fechar constantemente portas e janelas para manter a temperatura. </font><font style="vertical-align: inherit;">Mas isso nem sempre é possível. </font><font style="vertical-align: inherit;">E se isso não for feito, a temperatura aumentará para +50 graus, o que claramente não é bom. </font><font style="vertical-align: inherit;">E à noite tudo pode ser congelado. </font><font style="vertical-align: inherit;">E assim começou sua automação.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/dad/e37/ae3/dade37ae3afba69377f7d7ac53a94b3b.jpg" alt="image"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, compramos um Raspberry Pi 2. Depois de lidar com isso, conectamos o sensor DS18B20 para este </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Em seguida, foram compradas duas janelas de carros usados. Como todos os motores de corrente contínua, eles se movem de acordo com a polaridade. Portanto, conectamos dois relés a cada mecanismo: um para abertura e outro para fechamento. Já conectamos esses relés através de transistores às próprias portas GPIO. E alimentamos tudo isso com uma bateria de 12V. Além disso, para não queimar os motores, os interruptores de limite foram instalados nas posições extremas da janela e, se a janela for aberta / fechada, a rede ficará completamente destruída. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/976/39f/9d2/97639f9d24e51af037d3baca1200359e.jpg" alt="image"><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/1ec/ed9/824/1eced98242cb39b2a74d3d8babb31a19.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E para comunicação, usamos o adaptador WiFi TP-LINK com a avançada antena Double Square para uma recepção confiável do </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WIFI vizinho</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roteador WIFI doméstico, localizado a uma distância de 40 metros. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a7a/c93/db7/a7ac93db7ed2017891be1ded712e1e25.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora estamos escrevendo um programa para controlar essas unidades. </font><font style="vertical-align: inherit;">O Python foi escolhido porque possui suporte normal para portas Raspberry Pi e especificamente GPIO. </font><font style="vertical-align: inherit;">Para abrir a janela, precisamos aplicar + 3.3V ao transistor, que ativa o relé, e ele começará a abrir a janela. </font><font style="vertical-align: inherit;">Para fechá-lo, fazemos o mesmo, apenas neste caso nosso relé está conectado em frente ao inversor. </font><font style="vertical-align: inherit;">Mas no Raspberry, simplesmente aplicamos corrente a uma porta ou à outra. </font><font style="vertical-align: inherit;">Decidimos que, se a temperatura for superior a 26, abriremos a janela por 1 segundo. </font><font style="vertical-align: inherit;">Então esperamos 3 minutos. </font><font style="vertical-align: inherit;">Se estiver quente novamente, abra a segunda janela dentro de um segundo. </font><font style="vertical-align: inherit;">Estamos aguardando novamente por 3 minutos e faça-o novamente. </font><font style="vertical-align: inherit;">O mesmo com o fechamento, somente aqui a temperatura deve estar abaixo de 24 graus. </font><font style="vertical-align: inherit;">E aqui está o código:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp.py</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RPi.GPIO <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GPIO
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime

GPIO.setmode(GPIO.BOARD)
GPIO.cleanup()
GPIO.setup(<span class="hljs-number"><span class="hljs-number">31</span></span>, GPIO.OUT)
GPIO.setup(<span class="hljs-number"><span class="hljs-number">33</span></span>, GPIO.OUT)
GPIO.setup(<span class="hljs-number"><span class="hljs-number">35</span></span>, GPIO.OUT)
GPIO.setup(<span class="hljs-number"><span class="hljs-number">37</span></span>, GPIO.OUT)

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gettemp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.path.isdir(<span class="hljs-string"><span class="hljs-string">"id "</span></span>): <span class="hljs-comment"><span class="hljs-comment">#  ,   </span></span>
    tfile2=open(<span class="hljs-string"><span class="hljs-string">"/sys/bus/w1/devices/id "</span></span>)
    ttext2=tfile2.read()
    tfile2.close()
    temp2=ttext2.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">" "</span></span>)[<span class="hljs-number"><span class="hljs-number">9</span></span>]
    t2=float(temp2[<span class="hljs-number"><span class="hljs-number">2</span></span>:])/<span class="hljs-number"><span class="hljs-number">1000</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> t2
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-comment"><span class="hljs-comment"># ,   </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'File not found'</span></span>)
    t2==<span class="hljs-number"><span class="hljs-number">24</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t2

t2=<span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-comment"><span class="hljs-comment">#    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:  
t2=gettemp()
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    t2&lt;<span class="hljs-number"><span class="hljs-number">24</span></span>: <span class="hljs-comment"><span class="hljs-comment">#   24,      </span></span>
 
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)

  <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span>  t2&gt;<span class="hljs-number"><span class="hljs-number">26</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  26,      </span></span>
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-comment"><span class="hljs-comment">#   </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"none1"</span></span>)
  time.sleep(<span class="hljs-number"><span class="hljs-number">180</span></span>)<span class="hljs-comment"><span class="hljs-comment"># 3 </span></span>

<span class="hljs-comment"><span class="hljs-comment">#  </span></span>
t2=gettemp()

<span class="hljs-comment"><span class="hljs-comment">#   ,    .</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    t2&lt;<span class="hljs-number"><span class="hljs-number">24</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)

  <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span>  t2&gt;<span class="hljs-number"><span class="hljs-number">26</span></span>:
  
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
     

  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"none2"</span></span>)


<span class="hljs-comment"><span class="hljs-comment">#  3 </span></span>
  time.sleep(<span class="hljs-number"><span class="hljs-number">180</span></span>)
</code></pre><br>
</div></div><br>
<br>
<b>     ,    .</b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de instalar o Apache na distribuição Raspbian, não conseguimos acessar a página da Internet por um mês. O que simplesmente não fez. Configure portas, abra-as, nada ajudou. Além disso, tudo funcionou na rede local. Então aprendemos a triste verdade: estamos por trás do NAT. E nossa operadora não fornece serviços IP dedicados (Olá para funcionários da Região de Telecomunicações). Classificadas através de várias soluções alternativas, mas nada resultou disso. Tentei fazer uma interface web na hospedagem, mas também preciso de IP para sincronizar o banco de dados. O broker do IPv6 já estava fechado até então. E fazer uma VPN é caro, porque você quer tudo de graça. E então eles decidiram usar o bot do Telegram. Como se viu, ele tem dois modos: pesquisa constante do servidor e envio de mensagens diretamente para nós. A primeira opção foi adequada, porque não exige um endereço IP. Revirando a Internet, encontrei uma biblioteca:pytelegrambotapi. E comece a escrever código. É verdade que houve problemas. A biblioteca do MySQL mal encontrada se recusou a escrever no banco de dados, mas leu tudo normalmente. Eu tive que fazer uma muleta: transferir dados para um arquivo armazenado na RAM, depois executar um script bash que lê os dados e os armazena no banco de dados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nós criamos o arquivo config.ini, o jogamos lá:</font></font><br>
<br>
<pre><code class="hljs pgsql">[mysql]<font></font>
host = localhost<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">database</span></span> = telegram
<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = root
<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = secret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não se esqueça de substituir os dados pelos seus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie um arquivo python_mysql_dbconfig.py com o seguinte conteúdo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> configparser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser<font></font>
 <font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_db_config</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(filename=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'config.ini'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, section=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'mysql'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span>
    <span class="hljs-string"><span class="hljs-string">""" Read database configuration file and return a dictionary object
    :param filename: name of the configuration file
    :param section: section of database configuration
    :return: a dictionary of database parameters
    """</span></span>
    <span class="hljs-comment"><span class="hljs-comment"># create parser and read ini configuration file</span></span><font></font>
    parser = ConfigParser()<font></font>
    parser.read(filename)<font></font>
 <font></font>
    <span class="hljs-comment"><span class="hljs-comment"># get section, default to mysql</span></span><font></font>
    db = {}<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> parser.has_section(section):<font></font>
        items = parser.items(section)<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items:<font></font>
            db[item[<span class="hljs-number"><span class="hljs-number">0</span></span>]] = item[<span class="hljs-number"><span class="hljs-number">1</span></span>]
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
        <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">'{0} not found in the {1} file'</span></span>.format(section, filename))<font></font>
 <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Também precisamos criar o arquivo python_mysql_connect2.py, com este conteúdo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.connector <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MySQLConnection, Error
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> python_mysql_dbconfig <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> read_db_config<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    <span class="hljs-string"><span class="hljs-string">""" Connect to MySQL database """</span></span><font></font>
<font></font>
    db_config = read_db_config()<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:<font></font>
        print(<span class="hljs-string"><span class="hljs-string">'Connecting to MySQL database...'</span></span>)<font></font>
        conn = MySQLConnection(**db_config)<font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> conn.is_connected():<font></font>
            print(<span class="hljs-string"><span class="hljs-string">'connection established.'</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:<font></font>
            print(<span class="hljs-string"><span class="hljs-string">'connection failed.'</span></span>)<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> error:<font></font>
        print(error)<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>:<font></font>
        conn.close()<font></font>
        print(<span class="hljs-string"><span class="hljs-string">'Connection closed.'</span></span>)<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>:<font></font>
    connect()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, temos tudo preparado para trabalhar com o banco de dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos desviar um pouco do banco de dados e prosseguir diretamente para a comunicação com o bot. </font><font style="vertical-align: inherit;">Bem, como sempre, escreva @BotFather e pegue um token dele. </font><font style="vertical-align: inherit;">Crie o arquivo config.py e escreva duas linhas nele:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*-</span></span>
token = <span class="hljs-string"><span class="hljs-string">' '</span></span>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu decidi implementar três funções no bot:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtendo temperatura</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tirando instantâneos</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de janelas</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Com o primeiro, tudo é simples, mediante solicitação, lemos o arquivo de temperatura e o enviamos ao usuário. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com fotos mais difíceis. Estou usando o utilitário Motion. Em seus parâmetros, peça para colocar fotos em uma pasta na RAM, bem, digamos a cada 30 segundos. E criamos arquivos com nomes idênticos, e eles simplesmente se substituem. E então, mediante solicitação, enviamos o arquivo para o usuário.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, o terceiro módulo mais complexo: gerenciamento de janelas. </font><font style="vertical-align: inherit;">Minha principal tarefa: a automação funcionar, mas se necessário, podemos desativá-la. </font><font style="vertical-align: inherit;">Eu fiz assim. </font><font style="vertical-align: inherit;">Criou outro arquivo na RAM. </font><font style="vertical-align: inherit;">Quando enviamos uma solicitação para abrir / fechar, abrir levemente, fechar a janela ou ativar / desativar a automação, o bot grava o número do comando nesse arquivo. </font><font style="vertical-align: inherit;">A cada cinco segundos, o programa de gerenciamento de janelas lê esse arquivo e, se reconhece o comando, o executa. </font><font style="vertical-align: inherit;">Após a execução, ele grava no mesmo arquivo que tudo correu bem. </font><font style="vertical-align: inherit;">O bot lê o arquivo novamente e nos notifica que o comando foi concluído. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, agora o código fonte. </font><font style="vertical-align: inherit;">Primeiro, o mesmo programa para abrir janelas, refeito apenas para um bot (temp.py):</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp.py</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RPi.GPIO <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GPIO
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime

GPIO.setmode(GPIO.BOARD)
GPIO.cleanup()
GPIO.setup(<span class="hljs-number"><span class="hljs-number">31</span></span>, GPIO.OUT)
GPIO.setup(<span class="hljs-number"><span class="hljs-number">33</span></span>, GPIO.OUT)
GPIO.setup(<span class="hljs-number"><span class="hljs-number">35</span></span>, GPIO.OUT)
GPIO.setup(<span class="hljs-number"><span class="hljs-number">37</span></span>, GPIO.OUT)

<span class="hljs-comment"><span class="hljs-comment">#  ,    </span></span>
f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
f.write(<span class="hljs-string"><span class="hljs-string">'OK'</span></span>)
f.close()

<span class="hljs-comment"><span class="hljs-comment">#,   </span></span>
f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/pos'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
f.write(<span class="hljs-string"><span class="hljs-string">'1'</span></span>)
f.close()

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gettemp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.path.isdir(<span class="hljs-string"><span class="hljs-string">"/sys/bus/w1/devices/id "</span></span>): <span class="hljs-comment"><span class="hljs-comment">#  ,   </span></span>
    tfile2=open(<span class="hljs-string"><span class="hljs-string">"/sys/bus/w1/devices/id /w1_slave"</span></span>)
    ttext2=tfile2.read()
    tfile2.close()
    temp2=ttext2.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">" "</span></span>)[<span class="hljs-number"><span class="hljs-number">9</span></span>]
    t2=float(temp2[<span class="hljs-number"><span class="hljs-number">2</span></span>:])/<span class="hljs-number"><span class="hljs-number">1000</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> t2
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-comment"><span class="hljs-comment"># ,   </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'File not found'</span></span>)
    t2==<span class="hljs-number"><span class="hljs-number">24</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t2

<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
i=<span class="hljs-number"><span class="hljs-number">1</span></span>
<span class="hljs-comment"><span class="hljs-comment"># </span></span>
t2=<span class="hljs-number"><span class="hljs-number">24</span></span>

<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">info</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
    com = f.read()
    f.close()
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> com

<span class="hljs-comment"><span class="hljs-comment"># ,   </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ans</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
    f.write(<span class="hljs-string"><span class="hljs-string">'OK'</span></span>)
    f.close()
    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"OK"</span></span>)

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    c = info()
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> c==<span class="hljs-string"><span class="hljs-string">"10"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">3</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"11"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"12"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">3</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"13"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"20"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">3</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"21"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">3</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"22"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"23"</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"30"</span></span>:
        <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> i
        i=<span class="hljs-number"><span class="hljs-number">0</span></span>
        ans()
        f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/pos'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
        f.write(<span class="hljs-string"><span class="hljs-string">'0'</span></span>)
        f.close()
        print(<span class="hljs-string"><span class="hljs-string">'30'</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> i
        i=<span class="hljs-number"><span class="hljs-number">0</span></span>
        ans()
    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> c==<span class="hljs-string"><span class="hljs-string">"31"</span></span>:
        f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/pos'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
        f.write(<span class="hljs-string"><span class="hljs-string">'1'</span></span>)
        f.close()
        print(<span class="hljs-string"><span class="hljs-string">'31'</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> i
        i=<span class="hljs-number"><span class="hljs-number">1</span></span>
        ans()
        
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:

<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
 rob()

<span class="hljs-comment"><span class="hljs-comment">#,   </span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i==<span class="hljs-number"><span class="hljs-number">1</span></span>:

  gettemp()

  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    t2&lt;<span class="hljs-number"><span class="hljs-number">24</span></span>:
 
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)

  <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span>  t2&gt;<span class="hljs-number"><span class="hljs-number">26</span></span>:

        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open1"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)

  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"none1"</span></span>)
       
  <span class="hljs-comment"><span class="hljs-comment"># 3 ,       </span></span>
  j=<span class="hljs-number"><span class="hljs-number">0</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(j&lt;<span class="hljs-number"><span class="hljs-number">36</span></span>):
      rob()
      time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)
      j=j+<span class="hljs-number"><span class="hljs-number">1</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i==<span class="hljs-number"><span class="hljs-number">0</span></span>:
          <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>
  gettemp()

  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    t2&lt;<span class="hljs-number"><span class="hljs-number">24</span></span>:
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"close2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)
       
  <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span>  t2&gt;<span class="hljs-number"><span class="hljs-number">26</span></span>:
  
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"open2"</span></span>)
        time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
        GPIO.output(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)

  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:

        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"none2"</span></span>)

  j=<span class="hljs-number"><span class="hljs-number">0</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(j&lt;<span class="hljs-number"><span class="hljs-number">36</span></span>):
      rob()
      time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)
      j=j+<span class="hljs-number"><span class="hljs-number">1</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i==<span class="hljs-number"><span class="hljs-number">0</span></span>:
          <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>
</code></pre><br>
<br>
</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas agora vamos falar sobre o bot em si. Como eu disse, eu uso a biblioteca PyTelegramBotApi. Se você recorrer à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentação do GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , poderá entender que o bot usa manipuladores para processar comandos. Handler é um evento em nosso programa que define uma ação. No nosso caso, esta é uma frase específica na mensagem. E ação é tudo o que podemos fazer em python. Nesse caso, enviaremos ao usuário algumas informações ou gravaremos comandos para o Windows em um arquivo. Basicamente, nosso programa consiste nesses mesmos manipuladores e no comando de pesquisa do servidor.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas também escrevi e adicionei mais uma coisa interessante: o bloco de autorização. </font><font style="vertical-align: inherit;">Bem, como o nome indica, ele é feito para proteger nossa estufa de acesso não autorizado. </font><font style="vertical-align: inherit;">Funciona simplesmente. </font><font style="vertical-align: inherit;">A primeira vez que você se conecta ao bot, ele solicita uma senha. </font><font style="vertical-align: inherit;">Se o inserirmos corretamente, o bot nos adicionará ao banco de dados e, nas próximas conexões, não precisamos mais efetuar login. </font><font style="vertical-align: inherit;">O bot nos reconhece usando o chat-id. </font><font style="vertical-align: inherit;">Armazenamos o id do chat do último usuário em uma variável para não puxar o banco de dados o tempo todo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora crie o arquivo daba.py e escreva isto:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">daba.py</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.connector <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MySQLConnection, Error
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> python_mysql_dbconfig <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> read_db_config
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getkey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#   </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:
        dbconfig = read_db_config()
        conn = MySQLConnection(**dbconfig)
        cursor = conn.cursor()
        cursor.execute(<span class="hljs-string"><span class="hljs-string">"SELECT key2 FROM tkey where id=0"</span></span>)

        row = cursor.fetchone()

        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> row
        print(row)
  

    <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e:
        print(e)

    <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>:
        cursor.close()
        conn.close()
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    ( )</span></span>
    stime=time.time()
    query = <span class="hljs-string"><span class="hljs-string">"INSERT INTO uptime(datetime, also) "</span></span> \
    <span class="hljs-string"><span class="hljs-string">"VALUES(now(), 20)"</span></span>
    args=(stime)
    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:
        dbconfig = read_db_config()
        conn = MySQLConnection(**dbconfig)
        cursor = conn.cursor()
        cursor.execute(query)

        row = cursor.fetchone()

        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(row)
        print(row)
  

    <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e:
        print(e)

    <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>:
        cursor.close()
        conn.close()
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(idi)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#   id   </span></span>
    query=<span class="hljs-string"><span class="hljs-string">"SELECT accecpt FROM users WHERE chatid ='"</span></span>+str(idi)+<span class="hljs-string"><span class="hljs-string">"'"</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:
        dbconfig = read_db_config()
        conn = MySQLConnection(**dbconfig)
        cursor = conn.cursor()
        cursor.execute(query)

        row = cursor.fetchone()
        <span class="hljs-comment"><span class="hljs-comment">#print (str(row))</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> str(row)==<span class="hljs-string"><span class="hljs-string">"None"</span></span>:
            <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;
            <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
            <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>;

  

    <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e:
        print(e)

    <span class="hljs-comment"><span class="hljs-comment">#finally:</span></span>
        <span class="hljs-comment"><span class="hljs-comment">#cursor.close()</span></span>
        <span class="hljs-comment"><span class="hljs-comment">#conn.close()</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newuser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(idi)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    </span></span>
    query = (<span class="hljs-string"><span class="hljs-string">"INSERT INTO users SET `chatid`='12345'"</span></span>)
    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:
        dbconfig = read_db_config()
        conn = MySQLConnection(**dbconfig)
        cursor = conn.cursor()
        cursor.execute(query)

        row = cursor.fetchone()

        print(row)
  

    <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e:
        print(e)
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(e)

    <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>:
        cursor.close()
        conn.close()

<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>:
    query_with_fetchone()
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, vamos fazer alguns scripts auxiliares imediatamente. </font><font style="vertical-align: inherit;">Crie um arquivo newuser.sh e escreva para ele:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta"><span class="hljs-meta">#!/bin/bash</span></span><font></font>
a=`cat /mnt/raw/user`<font></font>
cat /dev/null &gt; /mnt/raw/user<font></font>
<font></font>
mysql -u root -pkoshak &lt;&lt; EOF<font></font>
use telegram;<font></font>
INSERT INTO users(chatid) VALUES(<span class="hljs-string"><span class="hljs-string">'$a'</span></span>);<font></font>
EOF<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E crie dois scripts para iniciar o bot e o programa windows:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta"><span class="hljs-meta">#!/bin/bash</span></span><font></font>
i=0<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> [ <span class="hljs-variable"><span class="hljs-variable">$i</span></span> = 0 ]
<span class="hljs-keyword"><span class="hljs-keyword">do</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> New python<font></font>
sleep 5<font></font>
python3 bot.py<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">done</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E mais um:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta"><span class="hljs-meta">#!/bin/bash</span></span><font></font>
i=0<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> [ <span class="hljs-variable"><span class="hljs-variable">$i</span></span> = 0 ]
<span class="hljs-keyword"><span class="hljs-keyword">do</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> New python<font></font>
sleep 5<font></font>
python3 temp.py<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">done</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 "Por que estamos fazendo isso?" </font><font style="vertical-align: inherit;">você pergunta. </font><font style="vertical-align: inherit;">E aqui o fato é que, às vezes, devido a uma conexão à Internet instável ou a um erro no servidor Telegram, o programa pode falhar. </font><font style="vertical-align: inherit;">E o script o conduz em um ciclo eterno: ele voou - começou depois de 5 segundos novamente. </font><font style="vertical-align: inherit;">E para janelas eu fiz isso para todos os bombeiros: de repente, por causa de um mau funcionamento, o programa irá falhar, mas não estamos na estufa, voltaremos e teremos sopa de tomate ou sorvete de tomate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, e agora o mais importante é o próprio script bot:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bot.py</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*-</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> config
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telebot
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> telebot <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> types
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> daba <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> getkey
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> daba <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sendup
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> daba <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> getid
<span class="hljs-comment"><span class="hljs-comment">#from daba import newuser</span></span>
<span class="hljs-comment"><span class="hljs-comment">#from temp import tep</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/user'</span></span>, <span class="hljs-string"><span class="hljs-string">'tw'</span></span>, encoding=<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>)
f.close()

<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> par
par=<span class="hljs-number"><span class="hljs-number">0</span></span>

<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> a
a=<span class="hljs-string"><span class="hljs-string">"  .    /auth []"</span></span>

<span class="hljs-comment"><span class="hljs-comment">#  </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_temp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.path.isdir(<span class="hljs-string"><span class="hljs-string">"/sys/bus/w1/devices/id "</span></span>):

    tfile2=open(<span class="hljs-string"><span class="hljs-string">"/sys/bus/w1/devices/id /w1_slave"</span></span>)
    ttext2=tfile2.read()
    tfile2.close()
    temp2=ttext2.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">" "</span></span>)[<span class="hljs-number"><span class="hljs-number">9</span></span>]
    t2=float(temp2[<span class="hljs-number"><span class="hljs-number">2</span></span>:])/<span class="hljs-number"><span class="hljs-number">1000</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t2

  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
    <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'File not found'</span></span>)
  
<span class="hljs-comment"><span class="hljs-comment">#</span></span>
keyword=str(getkey())[<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">-3</span></span>]

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
bot = telebot.TeleBot(config.token)
<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (sendup())
<span class="hljs-comment"><span class="hljs-comment">#  </span></span>

<span class="hljs-comment"><span class="hljs-comment">######################### ##########################################</span></span>
markup2 = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">1</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
markdown = types.ReplyKeyboardHide() <span class="hljs-comment"><span class="hljs-comment">#</span></span>
itembtn5 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">' '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  5</span></span>
markup2.add(itembtn5) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-comment"><span class="hljs-comment">######################### ##########################################</span></span>


<span class="hljs-comment"><span class="hljs-comment">#########################  ##########################################</span></span>
markup = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">3</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
itembtn1 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'  '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  1</span></span>
itembtn4 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'  '</span></span>)
itembtn2 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'  '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  2</span></span>
markup.add(itembtn1, itembtn4, itembtn2) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-comment"><span class="hljs-comment">#########################  ##########################################</span></span>


<span class="hljs-comment"><span class="hljs-comment">######################### ##########################################</span></span>

markup3 = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">2</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
itembtn10 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  10</span></span>
itembtn11 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️  '</span></span>)
itembtn12 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">' '</span></span>)
markup3.add(itembtn10, itembtn11, itembtn12) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>

markup4 = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">2</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
itembtn13 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  13</span></span>
markup4.add(itembtn13, itembtn11, itembtn12) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>

markup5 = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">2</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
itembtn14 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'  '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  14</span></span>
itembtn15 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'  '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  15</span></span>
itembtn16 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️ '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  16</span></span>
markup5.add(itembtn14, itembtn15, itembtn16) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>

markup6 = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">2</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
itembtn17 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  17</span></span>
itembtn18 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  18</span></span>
itembtn19 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  19</span></span>
itembtn20 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-comment"><span class="hljs-comment"># 20</span></span>
itembtn21 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️ '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  21</span></span>
markup6.add(itembtn17, itembtn18, itembtn19, itembtn20, itembtn21) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>

markup7 = types.ReplyKeyboardMarkup(row_width=<span class="hljs-number"><span class="hljs-number">2</span></span>, resize_keyboard=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-comment"><span class="hljs-comment">#, ,     </span></span>
itembtn22 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  22</span></span>
itembtn23 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'️   '</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  23</span></span>
itembtn24 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-comment"><span class="hljs-comment"># 24</span></span>
itembtn25 = types.KeyboardButton(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-comment"><span class="hljs-comment"># 25</span></span>
markup7.add(itembtn22, itembtn23, itembtn24, itembtn25, itembtn21) <span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-comment"><span class="hljs-comment">######################### ##########################################</span></span>
bot.send_message(<span class="hljs-number"><span class="hljs-number">45215125</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)<span class="hljs-comment"><span class="hljs-comment">#   chat-id</span></span>


    
<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/pos'</span></span>)
    com = f.read()
    f.close()
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> com

<span class="hljs-comment"><span class="hljs-comment">#</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">avtor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(idi)</span></span></span><span class="hljs-function">:</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> par<span class="hljs-comment"><span class="hljs-comment">#      </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> par==idi:
            <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:<span class="hljs-comment"><span class="hljs-comment">#    ,    ,  0</span></span>
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> getid(str(idi))==<span class="hljs-number"><span class="hljs-number">20</span></span>:
                par=idi<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
                <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>
            <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:<span class="hljs-comment"><span class="hljs-comment">#     </span></span>
                bot.send_message(idi, <span class="hljs-string"><span class="hljs-string">"  .    /auth []"</span></span>, reply_markup=markup2)
                <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>    
        


<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp=" ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
    bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">" /auth []"</span></span>)

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(commands=['auth'])</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> message.text[<span class="hljs-number"><span class="hljs-number">6</span></span>:]==keyword:<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> getid(str(message.chat.id))==<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-comment"><span class="hljs-comment">#    ,         20</span></span>
        bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">"  "</span></span>)
      <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
        <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> par
        bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>, reply_markup=markup)
        par=message.chat.id
        <span class="hljs-comment"><span class="hljs-comment"># chat-id   </span></span>
        f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/user'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
        f.write(str(message.chat.id))
        f.close()
        os.system(<span class="hljs-string"><span class="hljs-string">'newuser.sh'</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (par)
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
        bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (keyword)
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.text[<span class="hljs-number"><span class="hljs-number">6</span></span>:])
        <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id)


<span class="hljs-comment"><span class="hljs-comment">#  /start</span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(commands=['start'])</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
     <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> par
     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)!=<span class="hljs-number"><span class="hljs-number">0</span></span>:
         <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (par)
         bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">"   .    /auth []"</span></span>, reply_markup=markup2)
     <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:
	     bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">"   .  /help,  ,    ."</span></span>)



<span class="hljs-comment"><span class="hljs-comment">#   - /help</span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(commands=['help'])</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">help</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
     mas=<span class="hljs-string"><span class="hljs-string">'       . \n    ,    :  \n   - /help \n       :)'</span></span>
     bot.send_message(message.chat.id, mas, reply_markup=markup)
     <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id, message.text)

	
 
<span class="hljs-comment"><span class="hljs-comment">#     </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(commands=['show'])</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
     mas=<span class="hljs-string"><span class="hljs-string">' '</span></span>
     bot.send_message(message.chat.id, mas, reply_markup=markup)
     <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id, message.text)



<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="  ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">temp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
     tp=get_temp()
     mas=<span class="hljs-string"><span class="hljs-string">'    : '</span></span>+str(tp)+<span class="hljs-string"><span class="hljs-string">'°C'</span></span>
     bot.send_message(message.chat.id, mas)
     <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id, message.text)
    

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="  ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">photo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> 
     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>: 
         path=<span class="hljs-string"><span class="hljs-string">'/mnt/raw/photo/foto.jpg'</span></span> <span class="hljs-comment"><span class="hljs-comment">#    </span></span>
         <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:
             f = open(path, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  - </span></span>
             bot.send_photo(message.chat.id, f) <span class="hljs-comment"><span class="hljs-comment"># </span></span>
             <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id, message.text)
         <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>:
             bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">"  :("</span></span>)


<span class="hljs-comment"><span class="hljs-comment">#   </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="  ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"window"</span></span>)
       <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (pos())
       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> str(pos())[<span class="hljs-number"><span class="hljs-number">0</span></span>]==<span class="hljs-string"><span class="hljs-string">'1'</span></span>:
           bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>, reply_markup=markup3)<span class="hljs-comment"><span class="hljs-comment">#  ,      « »</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: 
           bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>, reply_markup=markup4)<span class="hljs-comment"><span class="hljs-comment">#     </span></span>

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp=" ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup)

<span class="hljs-comment"><span class="hljs-comment"># </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)<span class="hljs-comment"><span class="hljs-comment"># </span></span>
       f.write(<span class="hljs-string"><span class="hljs-string">'30'</span></span>)<span class="hljs-comment"><span class="hljs-comment">#   ,     30</span></span>
       f.close()<span class="hljs-comment"><span class="hljs-comment"># </span></span>
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span><span class="hljs-comment"><span class="hljs-comment">#  </span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:<span class="hljs-comment"><span class="hljs-comment">#  </span></span>
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)<span class="hljs-comment"><span class="hljs-comment"># 5 </span></span>
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)<span class="hljs-comment"><span class="hljs-comment"># </span></span>
           k = f.read()<span class="hljs-comment"><span class="hljs-comment"># </span></span>
           f.close()<span class="hljs-comment"><span class="hljs-comment">#</span></span>
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup4)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'31'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup3)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️  ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup5)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️ ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> str(pos())[<span class="hljs-number"><span class="hljs-number">0</span></span>]==<span class="hljs-string"><span class="hljs-string">'1'</span></span>:
           bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>, reply_markup=markup3)
       <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: 
           bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>, reply_markup=markup4)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️ ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup5)

<span class="hljs-comment"><span class="hljs-comment">#  </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="  ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup6)
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="  ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup7)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'11'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup6)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'10'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup6)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'13'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup6)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'12'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup6)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'21'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup7)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="️   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'20'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup7)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'23'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup7)

<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(regexp="   ")</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windows</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
       f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>)
       f.write(<span class="hljs-string"><span class="hljs-string">'22'</span></span>)
       f.close()
       k=<span class="hljs-string"><span class="hljs-string">"No"</span></span>
       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]!=<span class="hljs-string"><span class="hljs-string">"OK"</span></span>:
           time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)           
           f = open(<span class="hljs-string"><span class="hljs-string">'/mnt/raw/wind'</span></span>)
           k = f.read()
           f.close()
           print(k[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>])
       bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">""</span></span>,  reply_markup=markup7)

<span class="hljs-comment"><span class="hljs-comment">#  ,   </span></span>
<span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(content_types=["text"])</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">repeat_all_messages</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> avtor(message.chat.id)==<span class="hljs-number"><span class="hljs-number">0</span></span>:
         bot.send_message(message.chat.id, <span class="hljs-string"><span class="hljs-string">"    .  /help,    "</span></span>)
         <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message.chat.id, message.text)

<span class="hljs-comment"><span class="hljs-comment">#     </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>:
        bot.polling()</code></pre><br>
<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não se esqueça de indicar aqui a identificação do sensor, a identificação do bate-papo e o caminho para a seção na RAM. </font><font style="vertical-align: inherit;">Agora temos quase tudo pronto. </font><font style="vertical-align: inherit;">Nós baixamos esse </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">despejo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e enchemos o banco de dados em nosso servidor, e não se esqueça de montar a partição na RAM, acho que 10 MB é suficiente para o pescoço. </font><font style="vertical-align: inherit;">Lançamos dois de nossos scripts iniciais e nos alegramos. </font><font style="vertical-align: inherit;">A senha padrão é telbot. </font><font style="vertical-align: inherit;">Altere-o na tabela tkey do banco de dados.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informação por SMS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mesmo aconteceu com o SMS informando em caso de superaquecimento. </font><font style="vertical-align: inherit;">Crie o arquivo sms.py:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sms.py</font></font></b><div class="spoiler_text"><pre><code class="hljs python"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python</span></span>
<span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf8 -*-</span></span>
 
<span class="hljs-string"><span class="hljs-string">"""   .. t_aleksandr_v@inbox.ru 17.02.2015 """</span></span>
 
<span class="hljs-string"><span class="hljs-string">"""        sms.ru """</span></span>
<span class="hljs-string"><span class="hljs-string">"""   :"""</span></span>
 
<span class="hljs-string"><span class="hljs-string">""" -i  --idsender - id   sms.ru"""</span></span>
<span class="hljs-string"><span class="hljs-string">""" -t  --to -      79219996660"""</span></span>
<span class="hljs-string"><span class="hljs-string">""" -s  --subject -    """</span></span>
 
 
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> urllib2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urlopen
<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> optparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> OptionParser
 
 
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendsms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(idsender,subject,to)</span></span></span><span class="hljs-function">:</span></span>
 
    subject = subject.replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"+"</span></span>)
    url=<span class="hljs-string"><span class="hljs-string">"http://sms.ru/sms/send?api_id=%s&amp;text=%s&amp;to=%s"</span></span> %(idsender,subject,to)
    res=urlopen(url)
 
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>:
 
    parser = OptionParser()
 
    parser.add_option(<span class="hljs-string"><span class="hljs-string">"-i"</span></span>, <span class="hljs-string"><span class="hljs-string">"-- "</span></span>, dest=<span class="hljs-string"><span class="hljs-string">"idsender"</span></span>, default=<span class="hljs-string"><span class="hljs-string">" "</span></span>, help=<span class="hljs-string"><span class="hljs-string">"ID user on sms.ru"</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">"IDSENDER"</span></span>)
    parser.add_option(<span class="hljs-string"><span class="hljs-string">"-t"</span></span>, <span class="hljs-string"><span class="hljs-string">"-- "</span></span>, dest=<span class="hljs-string"><span class="hljs-string">"to"</span></span>, default=<span class="hljs-string"><span class="hljs-string">" "</span></span>, help=<span class="hljs-string"><span class="hljs-string">"to telephone number"</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">"TO"</span></span>)
    parser.add_option(<span class="hljs-string"><span class="hljs-string">"-s"</span></span>, <span class="hljs-string"><span class="hljs-string">"--temperatyra 32"</span></span>, dest=<span class="hljs-string"><span class="hljs-string">"subject"</span></span>, default=<span class="hljs-string"><span class="hljs-string">"Jara tut, otkroy okno"</span></span>, help=<span class="hljs-string"><span class="hljs-string">"Name of subject"</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">"SUBJECT"</span></span>)
 
    (options, args) = parser.parse_args()
 
    sendsms(options.idsender,options.subject,options.to)</code></pre><br>
<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Registramos no sms.ru e pegamos a chave da API na seção para programadores. </font><font style="vertical-align: inherit;">Além disso, não esqueça de indicar o seu número de telefone no script. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No programa de gerenciamento de janelas, declaramos uma variável:</font></font><br>
<br>
<pre><code class="hljs">Vr=0</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, insira este código no loop perpétuo:</font></font><br>
<br>
<pre><code class="hljs pgsql">d = datetime.today()<font></font>
V = d.strftime(<span class="hljs-string"><span class="hljs-string">'%H'</span></span>)<font></font>
V = <span class="hljs-type"><span class="hljs-type">int</span></span>(V)
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    (t2&gt;<span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Vr!=V): <font></font>
        print (V)<font></font>
        Vr=V<font></font>
        os.<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>(<span class="hljs-string"><span class="hljs-string">'/home/samba/sms.py'</span></span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No momento, a temperatura limite é 32, o SMS será enviado em caso de alta temperatura uma vez por hora, até cair. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> planeja para o futuro instalar um aquecedor controlado e fazer a rega automática. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obrigado a todos que leram até o fim.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt400499/">https://habr.com/ru/post/pt400499/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt400489/index.html">MediaTek apresenta o chipset MT2533D: a mais recente tecnologia para fones de ouvido, fones de ouvido e alto-falantes inteligentes</a></li>
<li><a href="../pt400491/index.html">Eu odeio quando alguém me trata</a></li>
<li><a href="../pt400493/index.html">Sobre o uso do sistema cognitivo IBM Watson Analytics para analisar dados de desempenho cardíaco</a></li>
<li><a href="../pt400495/index.html">A escolha entre programação visual e de texto para crianças</a></li>
<li><a href="../pt400497/index.html">A onda vai além do horizonte: a linha de comunicação de relé de rádio troposférico soviético "Norte"</a></li>
<li><a href="../pt400501/index.html">Um asteróide descoberto há apenas dois dias voou perto da Terra</a></li>
<li><a href="../pt400503/index.html">Piadas de oito bits 3</a></li>
<li><a href="../pt400505/index.html">Como se levantar e bocejar para obter um investimento? Dicas do mercado Jedi Venture</a></li>
<li><a href="../pt400507/index.html">Pentágono testou com sucesso enxame de 103 drones</a></li>
<li><a href="../pt400509/index.html">Dificuldades encontradas na criação de clubes de robótica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>