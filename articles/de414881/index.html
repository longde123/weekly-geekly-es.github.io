<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåüèæ üë≤üèø üñêüèª Ein bisschen Backstage VK üßôüèΩ ‚ôëÔ∏è üî™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Erwartung des sibirischen HighLoad ++ sprachen wir mit einem unserer Redner, Yuri Nasretdinov, und fragten ihn, ob er gut an VKontakte arbeite, w√§h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ein bisschen Backstage VK</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/414881/"> In Erwartung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sibirischen HighLoad ++</a> sprachen wir mit einem unserer Redner, Yuri Nasretdinov, und fragten ihn, ob er gut an VKontakte arbeite, w√§hrend wir gleichzeitig den Schleier der Geheimhaltung √ºber der internen K√ºche des sozialen Netzwerks √∂ffneten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd8/bf5/262/dd8bf526210478b0312431ee75a96903.jpg"><br><br>  Im Rahmen der Konferenz wird Yuri dar√ºber sprechen, wie ein soziales Netzwerk Daten von Zehntausenden von Servern in ClickHouse einf√ºgt, die wir gerade in der aktuellen Konversation angesprochen haben. <br><a name="habracut"></a><br>  <b>- Bitte erz√§hlen Sie uns von Ihrer Arbeit.</b> <br><br>  Zur Zeit arbeite ich an VK.  Richtig, nicht so lange - seit Anfang dieses Jahres.  Ich besch√§ftige mich mit Videoinfrastruktur und Standortinfrastruktur.  Die Seite ist haupts√§chlich in PHP geschrieben und ich entwickle Dienste und Dienstprogramme in PHP und Go. <br><br>  <b>- Was hat Sie dazu veranlasst, bei VK zu arbeiten?</b> <br><br>  Ich wurde eingeladen, bei VK zu arbeiten.  Und ich dachte - warum nicht?  VKontakte ist die am h√∂chsten geladene Site in Russland und eine der gr√∂√üten Sites im gesamten Internet.  Ich war immer daran interessiert, an einem so gro√üen Projekt zu arbeiten - an der Entwicklung der Website und der mobilen Anwendung teilzunehmen.  Vielleicht sogar ihre Entwicklung beeinflussen, irgendwie verbessern.  Dies ist wahrscheinlich der motivierendste Faktor - VKontakte, den jeder kennt und nutzt.  Und es ist sehr angenehm, an einem solchen Produkt zu arbeiten, um es besser zu machen. <br><br>  <b>- Mussten Sie sich vorher mit etwas √§hnlichem befassen?</b> <br><br>  Ja, ich habe ungef√§hr f√ºnf Jahre in einer √§hnlichen Position bei Badoo gearbeitet - in der Infrastrukturentwicklung.  Die Last in VK ist jedoch um eine Gr√∂√üenordnung gr√∂√üer. <br><br>  <b>- Hatten Sie Probleme beim Wechsel zu VK?</b> <br><br>  Das B√ºro von VKontakte befindet sich in St. Petersburg.  Und vorher lebte ich in den Vororten, also musste ich umziehen.  Der Umzug selbst war recht einfach - das Unternehmen hilft.  Aber in St. Petersburg ist es im Winter sehr kalt.  Dies war wahrscheinlich das Schwierigste. <br><br>  <b>- Es gibt kein Gef√ºhl, dass das Leben irgendwo auf der Moskauer Ringstra√üe geblieben ist?</b> <br><br>  Anfangs schien es mir wirklich so, obwohl ich zuvor neben Moskau auch in anderen St√§dten Russlands gewesen war.  Tats√§chlich mag ich St. Petersburg, wahrscheinlich sogar mehr als Moskau.  Er ist ruhiger - weniger Leute, sie haben es nicht eilig, und das ist sch√∂n. <br><br>  <b>- Und was war f√ºr Sie aus Sicht der in der Arbeit verwendeten Technologien grundlegend neu?</b> <br><br>  VKontakte ist sehr gro√ü, es gibt hier wirklich einige Nuancen, die ich vorher noch nicht gesehen habe.  Zum Beispiel gibt es in Badoo praktisch keine sehr beliebten Profile, die ein erheblicher Prozentsatz der Menschen besucht.  VKontakte hat es, da es eine Reihe interessanter Tools gibt, mit denen Sie sehr beliebte Konten schnell skalieren k√∂nnen. <br><br>  Dar√ºber hinaus unterscheidet sich VKontakte darin, dass aus historischen Gr√ºnden fast alles hier ist.  Im Gegensatz zu Badoo, das haupts√§chlich MySQL und Memcache (plus seine Dienste) verwendet, verwendet VKontakte seine eigenen Datenbanken und sogar seine eigene Version von Memcache.  VK-Entwickler k√∂nnten es sich leisten, hocheffizientere Dienste (vor dem Hintergrund desselben MySQL) zu erstellen, die in so gro√üem Umfang gut funktionieren.  Die meisten fertigen Tools ohne Datei k√∂nnen nicht in einer Infrastruktur verwendet werden, die Zehntausende von Servern wie VKs umfasst. Dies f√ºhrt zu erheblichen Schwierigkeiten. <br><br>  <b>- War es schwierig, schnell in solche "internen" Werkzeuge einzudringen?</b> <br><br>  Ich arbeite in der Infrastrukturabteilung, und hier gibt es nicht viele ungew√∂hnliche Dinge.  Grunds√§tzlich ist dies ein noch standardm√§√üigerer Stack als der, mit dem ich zuvor gearbeitet habe.  Wenn ich zum Beispiel in einer Abteilung arbeiten w√ºrde, die sich mit Back-End-Funktionen befasst, w√§re nat√ºrlich n√ºtzliches Wissen dar√ºber vorhanden, wie das Highload-System im Grunde aufgebaut ist, aber keine spezifischen Details.  In solchen Situationen helfen Seiten f√ºr neue Mitarbeiter, Beschreibungen interner Mechanismen. <br><br>  Grunds√§tzlich wurde ein konkreter Teil der VK-Infrastruktur von Pavel Durov zusammen mit der Dokumentation in Open Source ver√∂ffentlicht.  Jeder kann es lesen, lesen, wie alles funktioniert.  Aber nat√ºrlich ist es viel einfacher, dies im Zusammenhang mit der internen Verwendung wahrzunehmen.  Sie kommen und beginnen, Aufgaben zu erledigen, und lernen nach und nach, was zur L√∂sung dieser Aufgaben erforderlich ist.  Sehen Sie, wie es bereits gemacht wird, und machen Sie dasselbe.  Und das ist genug.  Selbst wenn Sie die gesamte Dokumentation der VK-Infrastruktur lesen, bis Sie sie verwenden, werden Sie h√∂chstwahrscheinlich nicht verstehen, wie alles im Detail funktioniert. <br><br>  Ich stelle fest, dass alle oben genannten Punkte f√ºr meine Abteilung gelten (in anderen F√§llen kann dies anders sein). <br><br>  <b>- Haben Sie eine Spezialisierung in VK?</b>  <b>An welchen Aufgaben haben Sie teilgenommen?</b> <br><br>  Es gibt keine Spezialisierung als solche.  Ich mache was aktuell ben√∂tigt wird. <br>  Ich arbeite in einer Abteilung, deren Aktivit√§ten verschiedene Teile der Infrastruktur sozialer Netzwerke betreffen, und dies ist ein riesiges Projekt (es braucht viel Zeit, um das VK-Ger√§t vollst√§ndig zu verstehen). <br><br>  Zum Beispiel habe ich an einem teilweisen Upgrade auf PHP7 teilgenommen.  Dies gilt grunds√§tzlich f√ºr die gesamte Website, gleichzeitig jedoch nicht f√ºr bestimmte Details. <br><br>  Ein weiteres Beispiel ist das Problem beim Sammeln von Protokollen, f√ºr deren L√∂sung wir ClickHouse verwendet haben.  Ich werde dar√ºber in HighLoad ++ sprechen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02b/ab0/b88/02bab0b88c3afe4212bb71fdfbc17ed8.jpg"><br><br>  <b>- Geben wir einen kleinen Spoiler - was war das Merkmal dieses Problems?</b> <br><br>  Der Haken war eine Kombination aus zwei Faktoren: Einerseits haben wir viele Protokolle geschrieben, und andererseits m√ºssen wir sie schnell durchsehen. <br><br>  Das vorhandene System konnte tats√§chlich keine gro√üen Datenmengen speichern und gab schnell nur die neuesten Informationen weiter.  Um die Geschichte zu erhalten, mussten Sie sehr schwere Abfragen manuell ausf√ºhren. <br><br>  <b>- Leser k√∂nnten interessiert sein, warum die Spalte ClickHouse f√ºr die L√∂sung verwendet wurde?</b> <br><br>  Spalte - wegen der Besonderheiten der Arbeit.  Bei der Suche nach Informationen in den Protokollen m√ºssen wir h√§ufig nach Server oder Benutzer filtern.  Wenn Sie vom Datentr√§ger lesen, k√∂nnen Sie mit einer Spaltendatenbank das Lesen um ein Vielfaches beschleunigen (vor dem Hintergrund der Zeile). Dies wird erreicht, indem nur die erforderlichen Spalten gelesen und die bitweise Komprimierung effizienter gestaltet werden.  Dar√ºber hinaus parallelisiert ClickHouse Abfragen √ºber die Kernel hinweg gut.  Das hei√üt,  Im Gegensatz zu klassischen Datenbanken kann eine einzelne Abfrage sogar f√ºr einen gesamten Cluster ausgef√ºhrt werden, wobei fast alle Ressourcen sowohl des Prozessors als auch der Festplatte verwendet werden.  Solche Datenbanken, insbesondere freie, sind nicht sehr zahlreich, wenn √ºberhaupt.  ClickHouse hat sich f√ºr das Speichern von Protokollen sehr gut bew√§hrt. <br><br>  Ich stelle auch fest, dass ClickHouse vor meiner Ankunft von VK-Administratoren in einer ziemlich hochspezialisierten Aufgabe verwendet wurde - als Back-End-Tool f√ºr Grafana.  Dies ist ein Datenerfassungs- und Grafiksystem f√ºr Server.  Zwar wurden nur wenige Server mit ClickHouse bereitgestellt, das hei√üt, es stand Programmierern tats√§chlich nicht zur Verf√ºgung. <br><br>  Nachdem die Entscheidung getroffen wurde, ClickHouse zum Speichern von Protokollen zu verwenden, half ich, die entsprechende Infrastruktur so zu erstellen, dass sie f√ºr alle bequem und verst√§ndlich war. <br><br>  <b>- Verwenden VK L√∂sungen von Drittanbietern in einer erheblichen Menge (zus√§tzlich zu den oben genannten)?</b> <br><br>  Nat√ºrlich benutzt.  Zum Beispiel Linux, auf dem sich das alles dreht.  Untersch√§tzen Sie nicht den Anteil der Arbeit, die das Betriebssystem f√ºr uns leistet. <br><br>  Seltsamerweise wird PHP verwendet.  Wir haben eine propriet√§re Engine namens KittenPHP, die PHP in C ++ √ºbersetzt, aber f√ºr eine Reihe von Aufgaben, einschlie√ülich der Produktion, wird auch regul√§res PHP verwendet. <br><br>  Wird von Nginx verwendet.  Bis jetzt ist MySQL an einigen Stellen involviert, aber nach und nach lehnen wir es ab - wir verwenden eine selbst geschriebene Datenbank. <br><br>  <b>- Und wie ist der Entwicklungsprozess aufgebaut?</b> <br><br>  Ich sehe keine gro√üen Unterschiede zwischen Prozessen in VK und dem, was in der Branche akzeptiert wird.  Wir haben einen Bug-Tracker, Abteilungen, die sich mit unterschiedlichen Funktionen befassen und f√ºr ihren Teil des Projekts verantwortlich sind.  Es gibt Sprints, die f√ºr Komponenten usw. verantwortlich sind. <br><br>  <b>- Kann anstelle der Ergebnisse angegeben werden, in welche Richtung sich die Abteilung entwickelt, in der Sie arbeiten?</b> <br><br>  Soweit ich wei√ü, bestand die Abteilung, in der ich jetzt arbeite, vor 1-2 Personen. <br>  Und wir haben vor nicht allzu langer Zeit begonnen, uns mit der Infrastruktur in der Form zu befassen, in der sie jetzt durchgef√ºhrt wird (wahrscheinlich sieht es nach DevOps aus).  Daher ist es zu fr√ºh, um √ºber Pl√§ne zu sprechen - wir l√∂sen bestehende Probleme und haben bisher genug Arbeit.  Und dann werden wir sehen. <br><br><hr><br>  Yuri wird Ihnen in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">seinem Vortrag</a> auf der Siberian HighLoad ++ vom 25. bis 26. Juni mehr √ºber VK-Interna erz√§hlen, indem er ClickHouse und andere Details verwendet.  Diese Berichte werden Sie sicherlich auch interessieren: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Echtzeit-Datenreplikation von MySQL zu ClickHouse f√ºr eine reibungslose Migration von Analysen von MySQL zu ClickHouse</a> (Vladislav Klimenko, Valery Panov) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein wenig rangieren lernen</a> (Andrey Aksenov) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Entwicklung von Tools und Services in Badoo: unsere Auswahlkriterien und was daraus wurde</a> (Anton Turetsky) </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414881/">https://habr.com/ru/post/de414881/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414871/index.html">Der Staubsturm auf dem Mars erreichte das planetare Ausma√ü, sogar die Neugier war betroffen</a></li>
<li><a href="../de414873/index.html">IDisposable - dass deine Mutter nicht √ºber die Freigabe von Ressourcen gesprochen hat. Teil 1</a></li>
<li><a href="../de414875/index.html">Kubernetes Containerd-Integration ersetzt Docker f√ºr die Produktion</a></li>
<li><a href="../de414877/index.html">Ein ungew√∂hnliches Objektiv f√ºr eine normale Kamera oder wie man aufh√∂rt, √ºber den Fokus nachzudenken</a></li>
<li><a href="../de414879/index.html">Warum 2 Extruder in einem 3D-Drucker?</a></li>
<li><a href="../de414883/index.html">Erinnerungen klangen neu: BBC hat das Soundarchiv des RemArc-Projekts aktualisiert</a></li>
<li><a href="../de414885/index.html">Wir besch√§ftigen uns mit Fehlern und ‚ÄûKr√ºcken‚Äú im einheitlichen staatlichen Register der juristischen Personen - dem staatlichen Register der juristischen Personen</a></li>
<li><a href="../de414887/index.html">Erstellen eines Katzenhakens in Unity. Teil 1</a></li>
<li><a href="../de414889/index.html">Wenn digitale Agenturen IaaS ben√∂tigen</a></li>
<li><a href="../de414891/index.html">Entwicklergewohnheiten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>