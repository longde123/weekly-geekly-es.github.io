<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ ‚û°Ô∏è üöã G√©n√©ration de code d'OpenAPI v3 (aka Swagger 3) vers TypeScript et pas seulement ‚õµÔ∏è üêõ üë®üèæ‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a deux ans, j'ai commenc√© le d√©veloppement  un de plus  un g√©n√©rateur de code gratuit de la sp√©cification OpenAPI v3 √† TypeScript (il est disponi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>G√©n√©ration de code d'OpenAPI v3 (aka Swagger 3) vers TypeScript et pas seulement</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483628/"><p>  Il y a deux ans, j'ai commenc√© le d√©veloppement <del>  un de plus </del>  un g√©n√©rateur de code gratuit de la <a href="https://swagger.io/docs/specification/about/">sp√©cification OpenAPI</a> v3 √† TypeScript (il <a href="https://github.com/koshevy/codegena">est disponible sur Github</a> ).  Au d√©part, je me suis fix√© pour objectif de g√©n√©rer efficacement des types de donn√©es primitifs et complexes en TypeScript, en tenant compte de diverses fonctionnalit√©s du <a href="https://json-schema.org/">sch√©ma JSON</a> , telles que <a href="https://json-schema.org/understanding-json-schema/reference/combining.html">oneOf / anyOf / allOf</a> , etc.  (La <a href="https://github.com/swagger-api/swagger-codegen">solution native</a> de Swagger a eu quelques probl√®mes avec cela).  Une autre id√©e √©tait d'utiliser des sch√©mas de sp√©cifications pour la validation √† l'avant, √† l'arri√®re et dans d'autres parties du syst√®me. </p><br><p><img src="https://habrastorage.org/webt/hz/cd/u4/hzcdu47rcjbutgqbe6pdb2k46x8.png"></p><a name="habracut"></a><br><p>  Maintenant, le g√©n√©rateur de code est relativement pr√™t - il est au stade <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B8%25D0%25BD%25D0%25B8%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE_%25D0%25B6%25D0%25B8%25D0%25B7%25D0%25BD%25D0%25B5%25D1%2581%25D0%25BF%25D0%25BE%25D1%2581%25D0%25BE%25D0%25B1%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BA%25D1%2582">MVP</a> .  Il a beaucoup de ce qui est n√©cessaire en termes de g√©n√©ration de types de donn√©es, ainsi qu'une biblioth√®que exp√©rimentale pour g√©n√©rer des services frontaux (jusqu'√† pr√©sent pour Angular).  Dans cet article, je veux montrer les d√©veloppements et dire comment ils peuvent vous aider si vous utilisez TypeScript et OpenAPI v3.  En cours de route, je veux partager quelques id√©es et consid√©rations qui ont surgi dans mon processus de travail.  Eh bien, si √ßa vous int√©resse, vous pouvez lire la trame de fond que j'ai cach√©e dans le spoiler afin de ne pas compliquer la lecture de la partie technique. </p><br><h2 id="soderzhanie">  Table des mati√®res </h2><br><ol><li>  <a href="https://habr.com/ru/post/483628/">Contexte</a> </li><li>  <a href="https://habr.com/ru/post/483628/">La description</a> </li><li>  <a href="https://habr.com/ru/post/483628/">Installation et utilisation</a> </li><li>  <a href="https://habr.com/ru/post/483628/">Entra√Ænez-vous √† utiliser un g√©n√©rateur de code</a> </li><li>  <a href="https://habr.com/ru/post/483628/">Utilisation des types de donn√©es g√©n√©r√©s dans les applications</a> </li><li>  <a href="https://habr.com/ru/post/483628/">D√©composition des circuits dans la sp√©cification OAS</a> </li><li>  <a href="https://habr.com/ru/post/483628/">D√©composition imbriqu√©e</a> </li><li>  <a href="https://habr.com/ru/post/483628/">Services g√©n√©r√©s automatiquement pour travailler avec l'API REST</a> <br><ol><li>  <a href="https://habr.com/ru/post/483628/">Pourquoi est-ce n√©cessaire?</a> </li><li>  <a href="https://habr.com/ru/post/483628/">G√©n√©ration de services</a> </li><li>  <a href="https://habr.com/ru/post/483628/">Utilisation des services g√©n√©r√©s</a> </li></ol></li><li>  <a href="https://habr.com/ru/post/483628/">Au lieu d'une postface</a> </li></ol><br><a name="Foreword"></a><br><h2 id="predystoriya">  Contexte </h2><br><div class="spoiler">  <b class="spoiler_title">D√©velopper pour lire (sauter)</b> <div class="spoiler_text"><p>  Tout a commenc√© il y a deux ans - puis j'ai travaill√© dans une entreprise d√©veloppant une plate-forme d'exploration de donn√©es et j'√©tais responsable du frontend (principalement TypeScript + Angular).  Les caract√©ristiques du projet √©taient des structures de donn√©es complexes avec un grand nombre de param√®tres (30 ou plus) et des relations commerciales pas toujours √©videntes entre elles.  L'entreprise se d√©veloppait et l'environnement logiciel subissait des changements assez fr√©quents.  Le frontend devait √™tre bien inform√© dans les nuances, car certains calculs √©taient dupliqu√©s au front et au backend.  Autrement dit, ce fut le cas lorsque l'utilisation d'OpenAPI est plus que appropri√©e.  J'ai trouv√© une p√©riode dans l'entreprise o√π, en quelques mois, l'√©quipe de d√©veloppement a acquis une sp√©cification unique, qui est devenue une base de connaissances commune pour le dos, le devant et m√™me le d√©partement principal, qui √©tait cach√© derri√®re le large dos du backend Web.  La version OpenAPI a √©t√© choisie ¬´pour la croissance¬ª - alors encore assez jeune v3.0 </p><br><p>  Ce n'√©tait plus une sp√©cification dans un ou plusieurs fichiers YML / JSON statiques, et non le r√©sultat d' <a href="https://github.com/zircote/swagger-php">annotateurs</a> , mais toute une biblioth√®que de composants, m√©thodes, mod√®les et propri√©t√©s, organis√©s conform√©ment au concept DDD de la plateforme.  La biblioth√®que √©tait divis√©e en r√©pertoires et fichiers, et un collecteur sp√©cialement organis√© a produit des documents de l'OEA pour chaque domaine.  Une m√©thode exp√©rimentale a √©t√© construite pour le flux de travail, qui pourrait √™tre d√©crite comme Design-First. </p><br><blockquote>  Il y a un <a href="https://habr.com/ru/company/yamoney/blog/347390/">bon article</a> dans le blog de la soci√©t√© Yandex.Money, qui parlait de Design First </blockquote><p>  Design First et la sp√©cification g√©n√©rale ont contribu√© √† la d√©cralisation des connaissances, mais un nouveau probl√®me est apparu - maintenir la pertinence du code.  La sp√©cification d√©crit plusieurs dizaines de m√©thodes et des dizaines (et plus tard des centaines) d'entit√©s.  Mais le code devait √™tre √©crit manuellement: types de donn√©es, services pour travailler avec REST, etc.  Un ou deux sprints avec des histoires parall√®les ont consid√©rablement chang√© l'image;  ajouter de la complexit√© √† la fusion de plusieurs histoires et au facteur humain.  La routine mena√ßait d'√™tre significative, et la solution semblait √©vidente - vous avez besoin de g√©n√©ration de code.  Apr√®s tout, les sp√©cifications de l'OEA contenaient d√©j√† tout le n√©cessaire pour ne pas le retaper manuellement.  Mais ce n'√©tait pas si simple. </p><br><p>  L'interface est √† la toute fin du cycle de production, j'ai donc ressenti des changements plus douloureux que mes coll√®gues des autres d√©partements.  Lors de la conception de l'API REST, l'environnement principal √©tait d√©cisif, et m√™me apr√®s l'approbation de ¬´Design First¬ª, l'inertie est rest√©e;  pour le front end, tout semblait moins √©vident.  En fait, j'ai compris cela d√®s le d√©but et j'ai commenc√© √† sonder le sol √† l'avance - alors que le discours d'une sp√©cification ¬´universelle¬ª ne faisait que commencer.  Il n'a pas √©t√© question d'√©crire votre propre g√©n√©rateur de code;  Je voulais juste trouver quelque chose de pr√™t. </p><br><p>  J'√©tais d√©√ßu.  Il y avait deux probl√®mes: OAS version 3.0, avec le soutien de qui, semble-t-il, personne n'√©tait press√©, et la qualit√© des solutions elles-m√™mes - √† ce moment (je me souviens que c'√©tait il y a deux ans), j'ai r√©ussi √† trouver deux solutions relativement pr√™tes √† l'emploi: <a href="https://github.com/swagger-api/swagger-codegen">de Swagger</a> et de Microsoft (il semble <a href="https://github.com/Azure/autorest">que</a> ).  Dans le premier, la prise en charge d'OAS 3.0 √©tait en version b√™ta profonde.  Le second ne fonctionnait qu'avec la version 2.x, mais il n'y avait pas de pr√©visions sans ambigu√Øt√©.  Soit dit en passant, je n'ai pas pu d√©marrer le g√©n√©rateur de code Microsoft m√™me sur un document de test au format Swagger 2.0.  La solution de Swagger a fonctionn√©, mais un sch√©ma plus ou moins compliqu√© avec des liens $ ref s'est transform√© en une "ERREUR!" Incompr√©hensible, et des d√©pendances r√©cursives l'ont envoy√© dans une boucle infinie.  Il y avait des probl√®mes avec <a href="">les types primitifs</a> .  De plus, je ne comprenais pas tr√®s bien comment travailler avec les services g√©n√©r√©s automatiquement - ils semblaient √™tre faits pour le spectacle, et leur utilisation r√©elle cr√©ait plus de probl√®mes qu'ils n'en r√©solvaient (√† mon avis).  Et enfin, l'int√©gration du fichier JAR dans un CI / CD orient√© NPM √©tait g√™nante: j'ai d√ª t√©l√©charger manuellement l' <a href="https://oss.sonatype.org/content/repositories/snapshots/io/swagger/codegen/v3/swagger-codegen-cli/3.0.15-SNAPSHOT/">instantan√© n√©cessaire</a> , qui semblait peser 13 m√©gaoctets, et faire quelque chose avec.  En g√©n√©ral, j'ai fait une pause et j'ai d√©cid√© de regarder ce qui allait se passer ensuite. </p><br><p>  Apr√®s environ cinq mois, le probl√®me de la g√©n√©ration de code s'est √† nouveau pos√©.  J'ai d√ª r√©√©crire et d√©velopper une partie de l'application Web, et en m√™me temps, je voulais refactoriser les anciens services pour travailler avec l'API REST et les types de donn√©es.  Mais l'√©valuation de la complexit√© n'√©tait pas optimiste: d'une semaine-homme √† deux - et ce uniquement pour les services REST et les descriptions de type.  Je ne dirai pas que cela m'a beaucoup d√©prim√©, mais quand m√™me.  D'un autre c√¥t√©, je n'ai jamais trouv√© de solution pour la g√©n√©ration de code et n'ai pas attendu, et sa mise en ≈ìuvre prendrait √† peine moins de temps.  Autrement dit, il n'y avait aucun doute √† ce sujet: l'avantage est douteux, les risques sont grands.  Personne ne soutiendrait cette id√©e, et je n'ai pas propos√©.  Pendant ce temps, les vacances de mai approchaient et la soci√©t√© me ¬´devait¬ª plusieurs jours pour travailler le week-end.  Pendant deux semaines, je me suis enfui de toutes les exp√©riences de travail en G√©orgie, o√π j'ai v√©cu pendant pr√®s d'un an. </p><br><p>  Entre les f√™tes et les f√™tes, je devais faire quelque chose et j'ai d√©cid√© d'√©crire ma d√©cision.  Travailler dans les caf√©s d'√©t√© pr√®s de Vake Park √©tait √©tonnamment productif, et je suis retourn√© √† Peter avec un g√©n√©rateur de code pr√™t √† l'emploi pour les types de donn√©es.  Puis pendant un mois, j'ai ¬´termin√©¬ª les services le week-end avant qu'il ne soit pr√™t √† travailler. </p><br><p>  D√®s le d√©but, j'ai ouvert le g√©n√©rateur de code, travaillant dessus pendant mon temps libre.  Bien qu'en fait, il ait √©crit pour un projet de travail.  Je ne dirai pas que la r√©vision / rodage s'est d√©roul√©e sans probl√®me;  et je ne dirai pas qu'ils √©taient importants.  Mais √† un moment donn√©, j'ai remarqu√© que j'ai cess√© d'utiliser la documentation Redoc / Swagger: naviguer dans le code √©tait plus pratique, √† condition que le code soit toujours √† jour et comment√©.  Bient√¥t, j'ai ¬´marqu√©¬ª mes r√©alisations, sans les d√©velopper du tout, jusqu'√† ce qu'un coll√®gue (maintenant il y a six mois que je quitte pour une autre entreprise) me conseille de les prendre plus au s√©rieux (il a aussi trouv√© le nom). </p><br><blockquote>  Je n'avais pas assez de temps libre, et plusieurs mois il m'a fallu pour finaliser en arri√®re plan: <a href="https://stackblitz.com/edit/codegena-playground">aire de jeux</a> , application test, r√©organisation du projet.  Maintenant, je suis pr√™t √† recevoir des commentaires. </blockquote></div></div><br><a name="Description"></a><br><h2 id="opisanie">  La description </h2><br><p> √Ä l'heure actuelle, la solution pour la g√©n√©ration de code comprend trois biblioth√®ques NPM int√©gr√©es dans @codegena <code>@codegena</code> et situ√©es dans un <a href="https://github.com/koshevy/codegena">mono-r√©f√©rentiel</a> commun: </p><br><div class="scrollable-table"><table><thead><tr><th>  La biblioth√®que </th><th>  La description </th></tr></thead><tbody><tr><td>  @ codegena / oapi3ts </td><td>  La biblioth√®que de base est un convertisseur d'OAS3 en descriptions de types de donn√©es (ne prend d√©sormais en charge que TypeScript) </td></tr><tr><td>  @ codegena / ng-api-service </td><td>  Extension pour les services angulaires </td></tr><tr><td>  @ codegena / oapi3ts-cli </td><td>  Shell pour une utilisation pratique dans les scripts CLI </td></tr></tbody></table></div><br><a name="SetupAndUsing"></a><br><h3 id="ustanovka-i-ispolzovanie">  Installation et utilisation </h3><br><p>  L'option la plus pratique consiste √† utiliser dans les scripts NodeJS ex√©cut√©s √† partir de la CLI.  Vous devez d'abord installer les d√©pendances: </p><br><pre> <code class="plaintext hljs">npm i @codegena/oapi3ts, @codegena/ng-api-service, @codegena/oapi3ts-cli</code> </pre> <br><p>  Ensuite, cr√©ez un fichier js (par exemple <code>update-typings.js</code> ) avec le code: </p><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cliLib = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@codegena/oapi3ts-cli'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cliApp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> cliLib.CliApplication; cliApp.createTypings(); <span class="hljs-comment"><span class="hljs-comment">// cliApp.createServices('angular'); // optional</span></span></code> </pre> <br><p>  Et lancez-le en passant trois param√®tres: </p><br><pre> <code class="plaintext hljs">node ./update-typings.js --srcPath ./specs/todo-app-spec.json --destPath ./src/lib --separatedFiles true</code> </pre> <br><p>  Dans <code>destPath</code> aura des fichiers g√©n√©r√©s et, en fait, le contenu de <a href="https://github.com/koshevy/codegena/tree/master/libs/todo-app-scheme/src/lib">ce r√©pertoire</a> dans le r√©f√©rentiel du projet est cr√©√© de la m√™me mani√®re.  <a href="">Voici le script de g√©n√©ration</a> , et <a href="">voici</a> <a href="">comment</a> il s'ex√©cute dans les scripts NPM.  Cependant, si vous le souhaitez, vous pouvez l'utiliser m√™me dans le navigateur, comme cela se fait dans le <a href="https://codegena-playground.stackblitz.io/">Playground</a> . </p><br><a name="CodegenerationUsingPractice"></a><br><h2 id="praktika-ispolzovanie-kodogeneratora">  Entra√Ænez-vous √† utiliser un g√©n√©rateur de code </h2><br><p>  Ensuite, je veux parler de ce que nous obtiendrons en cons√©quence: quelle est l'id√©e de la fa√ßon dont cela nous aidera.  Une aide visuelle sera le code de l'application de d√©monstration.  Il se compose de deux parties: un backend (sur le framework <a href="https://nestjs.com/">NestJS</a> ) et un frontend (sur <a href="https://angular.io/">Angular</a> ).  Si vous le souhaitez, vous pouvez m√™me l' <a href="https://github.com/koshevy/codegena/tree/5367749623826d270fb652e32fa394c023751877">ex√©cuter localement</a> . </p><br><blockquote>  M√™me si vous n'√™tes pas familier avec Angular et / ou NestJS, cela ne devrait pas poser de probl√®me: les exemples de code qui seront fournis devraient √™tre compris par la plupart des d√©veloppeurs TypeScript. </blockquote><p>  Bien que l'application soit simplifi√©e au maximum (par exemple, le backend stocke les donn√©es dans une session et non dans la base de donn√©es), j'ai essay√© de recr√©er le flux de donn√©es et les fonctionnalit√©s de la hi√©rarchie des types de donn√©es inh√©rentes √† l'application r√©elle.  Il est pr√™t √† 80-85%, mais la ¬´finition¬ª peut √™tre retard√©e, mais pour l'instant il est plus important de parler de ce qui existe d√©j√†. </p><br><a name="UsingGeneratedDataTypes"></a><br><h2 id="ispolzovanie-generiruemyh-tipov-dannyh-v-prilozheniyah">  Utilisation des types de donn√©es g√©n√©r√©s dans les applications </h2><br><p>  Supposons que nous ayons une sp√©cification OpenAPI (par exemple, <a href="">celle-ci</a> ) avec laquelle nous devons travailler.  Peu importe que nous cr√©ons quelque chose √† partir de z√©ro ou que nous prenions en charge, il y a une chose importante que nous sommes le plus susceptibles de commencer - la saisie.  Nous commencerons soit √† d√©crire les types de donn√©es de base, soit √† y apporter des modifications.  La plupart des programmeurs le font afin de faciliter leur d√©veloppement futur.  Vous n'avez donc pas √† vous pencher √† nouveau sur la documentation, gardez √† l'esprit les listes de param√®tres;  et vous pouvez √™tre s√ªr que l'EDI et / ou le compilateur remarqueront une faute de frappe. </p><br><p>  Notre sp√©cification peut inclure ou non la section <a href="">components.schems</a> .  Mais dans tous les cas, il d√©crira des ensembles de param√®tres, demandes et r√©ponses - et nous pouvons l'utiliser.  Prenons un exemple: </p><br><pre> <code class="javascript hljs">@Controller(<span class="hljs-string"><span class="hljs-string">'group'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... @Put(':groupId') rewriteGroup( @Param(ParseQueryPipe) { groupId }: RewriteGroupParameters, @Body() body: RewriteGroupRequest, @Session() session ): RewriteGroupResponse&lt;HttpStatus.OK&gt; { return this.appService .setSession(session) .rewriteGroup(groupId, body); } // ... }</span></span></code> </pre> <br><p>  Il s'agit d'un fragment de <a href="">contr√¥leur</a> pour la structure NestJS avec des param√®tres ( <code>RewriteGroupParameters</code> ), un corps de demande ( <code>RewriteGroupRequest</code> ) et un corps de r√©ponse ( <code>RewriteGroupResponse&lt;T&gt;</code> ) <code>RewriteGroupResponse&lt;T&gt;</code> .  D√©j√† dans ce fragment de code, nous pouvons voir les avantages de la frappe: </p><br><ul><li>  Si nous confondons le nom du param√®tre <code>groupId</code> d√©truit, en sp√©cifiant <code>groupId</code> place, nous obtenons imm√©diatement une erreur dans l'√©diteur. <br><img src="https://habrastorage.org/webt/1z/2q/0c/1z2q0cstw2lv3vncwmgi8gkxfa0.png"></li><li>  Si la <a href="">m√©thode this.appService.rewriteGroup (groupId, body)</a> a des param√®tres typ√©s, nous pouvons contr√¥ler l'exactitude du param√®tre de <code>body</code> transmis.  Et si le format des donn√©es d'entr√©e de la m√©thode du contr√¥leur ou de la m√©thode de service change, nous le saurons imm√©diatement.  √Ä l'avenir, je note que la m√©thode d'entr√©e de la m√©thode de service a un type de donn√©es diff√©rent de <code>RewriteGroupRequest</code> , mais dans notre cas, ils seront identiques les uns aux autres.  Cependant, si tout √† coup la m√©thode de service est modifi√©e et commence √† accepter <code>ToDoGroup</code> au lieu de <code>ToDoGroupBlank</code> , l'EDI et le compilateur afficheront imm√©diatement les emplacements des √©carts: <br><img src="https://habrastorage.org/webt/wo/cq/rr/wocqrrks2gtcthaq_wghrhlbbta.png"></li><li>  De la m√™me mani√®re, nous pouvons contr√¥ler la conformit√© du r√©sultat retourn√©.  Si la sp√©cification de l'√©tat d'une r√©ponse r√©ussie change et devient <code>202</code> au lieu de <code>200</code> , nous le d√©couvrirons √©galement, car <code>RewriteGroupResponse</code> est <a href="">un g√©n√©rique avec un type √©num√©r√©</a> : <br><img src="https://habrastorage.org/webt/pt/io/ss/ptiossjjfhihchrlwdlydrrkft4.png"></li></ul><br><p>  Voyons maintenant <a href="">un exemple de l'application frontale</a> qui fonctionne avec <a href="">une autre m√©thode API</a> : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initSelectedGroupData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(truth: ComponentTruth)</span></span></span><span class="hljs-function">: Observable&lt;ComponentTruth&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getGroupsService.request(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, { isComplete: <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, withItems: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }).pipe( pickResponseBody&lt;GetGroupsResponse&lt;<span class="hljs-number"><span class="hljs-number">200</span></span>&gt;&gt;(<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>), switchMap&lt;ToDoGroup[], Observable&lt;ComponentTruth&gt;&gt;( groups =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadItemsOfSelectedGroups({ ...truth, groups }) ) ); }</code> </pre> <br><p>  N'allons pas de l'avant et analysons l'op√©rateur <code>pickResponseBody</code> personnalis√© <code>pickResponseBody</code> , mais concentrons-nous sur le raffinement du type <code>GetGroupsResponse</code> .  Nous l'utilisons dans une cha√Æne d'op√©rateurs RxJS, et l'op√©rateur qui le suit a un raffinement d'entr√©e de <code>ToDoGroup[]</code> .  Si ce code fonctionne, les types de donn√©es indiqu√©s correspondent les uns aux autres.  Ici, nous pouvons √©galement contr√¥ler la correspondance de type, et si le format de r√©ponse dans notre API change soudainement, cela n'√©chappera pas √† notre attention: </p><br><p><img src="https://habrastorage.org/webt/ci/hr/7c/cihr7csbo5kqn9fqkreoij7kuxk.png"></p><br><p>  Et bien s√ªr, les param√®tres d'appel de <code>this.getGroupsService.request</code> √©galement saisis.  Mais c'est le sujet des services g√©n√©r√©s. </p><br><blockquote>  Dans les exemples ci-dessus, nous voyons que le typage des demandes, des r√©ponses et des param√®tres peut √™tre utilis√© dans diverses parties du syst√®me - frontend, backend, etc.  Si le backend et le frontend sont dans le m√™me mono-r√©f√©rentiel et ont un √©co-environnement compatible, ils peuvent utiliser la m√™me <a href="https://github.com/koshevy/codegena/tree/5367749623826d270fb652e32fa394c023751877/libs/todo-app-scheme">biblioth√®que partag√©e</a> avec le code g√©n√©r√©.  Mais m√™me si le backend et le frontend sont pris en charge par des √©quipes diff√©rentes et n'ont rien en commun √† l'exception de la sp√©cification publique OAS, il leur sera toujours plus facile de synchroniser leur code. </blockquote><br><a name="DecompositionInOAS"></a><br><h2 id="dekompoziciya-shem-vnutri-oas-specifikacii">  D√©composition des circuits dans la sp√©cification OAS </h2><br><p>  Dans les exemples pr√©c√©dents, vous avez probablement pr√™t√© attention aux <code>ToDoGroup</code> <code>ToDoGroupBlank</code> , <code>ToDoGroup</code> , avec lesquelles <code>RewriteGroupResponse</code> et <code>GetGroupsResponse</code> .  En fait, <code>RewriteGroupResponse</code> n'est qu'un alias g√©n√©rique pour <code>ToDoGroup</code> , <code>HttpErrorBadRequest</code> , etc.  Il est facile de deviner que <a href="">ToDoGroup</a> et <a href="">HttpErrorBadRequest</a> sont les sch√©mas de la section de sp√©cification <a href="">components.schemas</a> r√©f√©renc√©e par le <a href="">point de terminaison rewriteGroup</a> (directement ou par l' <a href="">interm√©diaire d'interm√©diaires</a> ): </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"responses"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"200"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Todo group saved"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"content"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"application/json"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"schema"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/ToDoGroup"</span></span> } } } }, <span class="hljs-attr"><span class="hljs-attr">"400"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/responses/errorBadRequest"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"404"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/responses/errorGroupNotFound"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"409"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/responses/errorConflict"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"500"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/responses/errorServer"</span></span> } }</code> </pre><br><p>  Il s'agit de la d√©composition habituelle des structures de donn√©es, et son principe est le m√™me que dans d'autres langages de programmation.  Les composants, √† leur tour, peuvent √©galement √™tre d√©compos√©s: reportez-vous √† d'autres composants (y compris de mani√®re r√©cursive), utilisez une combinaison et d'autres fonctionnalit√©s du sch√©ma JSON.  Mais quelle que soit la complexit√©, ils doivent √™tre correctement convertis en descriptions des types de donn√©es.  Je veux montrer comment vous pouvez utiliser la d√©composition dans OpenAPI et √† quoi ressemblera le code g√©n√©r√©. </p><br><blockquote>  Les composants d'une sp√©cification OAS bien con√ßue chevaucheront le mod√®le DDD des applications l'utilisant.  Mais m√™me si la sp√©cification est imparfaite, vous pouvez vous y fier en cr√©ant votre propre mod√®le de donn√©es.  Cela vous donnera plus de contr√¥le sur la correspondance de vos types de donn√©es avec les types de donn√©es des sous-syst√®mes int√©gr√©s. </blockquote><p>  Puisque notre application est une liste de t√¢ches, l'essentiel est la t√¢che.  Il est logique de le mettre dans les composants en premier lieu, car  d'autres entit√©s et points de terminaison y seront en quelque sorte connect√©s.  Mais avant cela, vous devez comprendre deux choses: </p><br><ul><li>  Nous d√©crivons non seulement l'abstraction, mais aussi les r√®gles de validation, et plus elles sont pr√©cises et sans ambigu√Øt√©, mieux c'est. </li><li>  Comme toute entit√© stock√©e dans une base de donn√©es, une t√¢che a deux types de propri√©t√©s: service et entr√©e par l'utilisateur. </li></ul><br><p>  Il s'av√®re que, selon le sc√©nario d'utilisation, nous avons deux structures de donn√©es: la t√¢che que l'utilisateur vient de cr√©er et la t√¢che qui est d√©j√† stock√©e dans la base de donn√©es.  Dans le second cas, il a un UID unique, une date de cr√©ation, de modification, etc., et ces donn√©es doivent √™tre affect√©es au backend.  J'ai d√©crit deux entit√©s ( <code>ToDoTaskBlank</code> et <code>ToDoTask</code> ) de telle mani√®re que la premi√®re est un sous-ensemble de la seconde: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"components"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"ToDoTaskBlank"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Base part of data of item in todo's group"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Data about group item needed for creation of it"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"groupUid"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"An unique id of group that item belongs to"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/Uid"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Short brief of task to be done"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minLength"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"maxLength"</span></span>: <span class="hljs-number"><span class="hljs-number">64</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detailed description and context of the task. Allowed using of Common Markdown."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: [<span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-string"><span class="hljs-string">"null"</span></span>], <span class="hljs-attr"><span class="hljs-attr">"minLength"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"maxLength"</span></span>: <span class="hljs-number"><span class="hljs-number">1024</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"isDone"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Status of task: is done or not"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"boolean"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"example"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"position"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Position of a task in group. Allows to track changing of state of a concrete item, including changing od position."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"number"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-number"><span class="hljs-number">4096</span></span>, <span class="hljs-attr"><span class="hljs-attr">"example"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"attachments"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"array"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Any material attached to the task: may be screenshots, photos, pdf- or doc- documents on something else"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/AttachmentMeta"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"maxItems"</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-attr"><span class="hljs-attr">"example"</span></span>: [] } }, <span class="hljs-attr"><span class="hljs-attr">"required"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"isDone"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"example"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"isDone"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Book soccer field"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The complainant agreed and recruited more members to play soccer."</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"ToDoTask"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Item in todo's group"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Describe data structure of an item in group of tasks"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"allOf"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/ToDoTaskBlank"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"uid"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"An unique id of task"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/Uid"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readOnly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"dateCreated"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date/time (ISO) when task was created"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"date-time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readOnly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"example"</span></span>: <span class="hljs-string"><span class="hljs-string">"2019-11-17T11:20:51.555Z"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"dateChanged"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date/time (ISO) when task was changed last time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"date-time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readOnly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"example"</span></span>: <span class="hljs-string"><span class="hljs-string">"2019-11-17T11:20:51.555Z"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"required"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"dateChanged"</span></span>, <span class="hljs-string"><span class="hljs-string">"dateCreated"</span></span>, <span class="hljs-string"><span class="hljs-string">"position"</span></span>, <span class="hljs-string"><span class="hljs-string">"uid"</span></span> ] } ] } }</code> </pre> <br><p>  En sortie, nous obtenons deux interfaces TypeScript, et la <a href="">premi√®re</a> sera h√©rit√©e par la <a href="">seconde</a> : </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** * ## Base part of data of item in todo's group * Data about group item needed for creation of it */</span></span> export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoTaskBlank</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... imagine there are ToDoTaskBlank properties } /** * ## Item in todo's group * Describe data structure of an item in group of tasks */ export interface ToDoTask extends ToDoTaskBlank { /** * ## UID of element * An unique id of task */ readonly uid: string; /** * Date/time (ISO) when task was created */ readonly dateCreated: string; /** * Date/time (ISO) when task was changed last time */ readonly dateChanged: string; // ... imagine there are ToDoTaskBlank properties }</span></span></code> </pre> <br><p>  Nous avons maintenant les descriptions de base de l'entit√© Task, et nous nous y r√©f√©rons <strong>dans le code de notre application</strong> comme cela a √©t√© fait dans l' <a href="">application de d√©monstration</a> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ToDoTask, ToDoTaskBlank, } from <span class="hljs-string"><span class="hljs-string">'@our-npm-scope/our-generated-lib'</span></span>; export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoTaskTeaser</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoTask</span></span></span><span class="hljs-class"> </span></span>{ isInvalid?: <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Means this task just created, has temporary uid * and not saved yet. */</span></span> isJustCreated?: <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Means this task is saving now. */</span></span> isPending?: <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Previous uid of task temporary assigned until * it gets saved and gets new UID from backend. */</span></span> prevTempUid?: string; }</code> </pre> <br><p>  Dans cet exemple, nous avons d√©crit une nouvelle entit√©, ajoutant √† <code>ToDoTask</code> les propri√©t√©s qui nous manquent du c√¥t√© de l'application frontale.  En fait, nous avons √©largi le mod√®le de donn√©es r√©sultant en tenant compte des sp√©cificit√©s locales.  Autour de ce mod√®le, un ensemble d' <a href="">outils locaux</a> et quelque chose comme un DTO primitif se d√©veloppent progressivement: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downgradeTeaserToTask</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> taskTeaser: ToDoTaskTeaser </span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToDoTask</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> task = { ...taskTeaser }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!task.description || !task.description.trim()) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.description; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { task.description = task.description.trim(); } <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.isJustCreated; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.isPending; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.prevTempUid; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> task; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downgradeTeaserToTaskBlank</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> taskTeaser: ToDoTaskTeaser </span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToDoTaskBlank</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> task = downgradeTeaserToTask(taskTeaser) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> any; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.dateChanged; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.dateCreated; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> task.uid; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> task; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Quelqu'un pr√©f√®re rendre le mod√®le de donn√©es plus int√©gral et utiliser des classes.</b> <div class="spoiler_text"><pre> <code class="java hljs">export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoTaskTeaser</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoTask</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ‚Ä¶ imagine, definitions from ToDoTask are here constructor( task: ToDoTask, public isInvalid?: boolean, public isJustCreated?: boolean, public isPending?: boolean, public prevTempUid?: string ) { Object.assign(this, task); } downgradeTeaserToTask(): ToDoTask { const task = {...this}; if (!task.description || !task.description.trim()) { delete task.description; } else { task.description = task.description.trim(); } delete task.isJustCreated; delete task.isPending; delete task.prevTempUid; return task; } downgradeTeaserToTaskBlank(): ToDoTaskBlank { // ‚Ä¶ some code } }</span></span></code> </pre> </div></div><br><p>  Mais c'est une question de style, de pertinence et de d√©veloppement de l'architecture de l'application.  En g√©n√©ral, quelle que soit l'approche, nous pouvons compter sur un mod√®le de donn√©es de base et avoir plus de contr√¥le sur la conformit√© du typage.  Donc, si pour une raison quelconque, l' <code>uid</code> de <code>ToDoTask</code> devient un nombre, nous conna√Ætrons toutes les parties du code qui n√©cessitent une mise √† jour: </p><br><p><img src="https://habrastorage.org/webt/cc/7g/yz/cc7gyzy0tc4oh5zpomvjy09endw.png"></p><br><a name="NestedDecomposition"></a><br><h2 id="vlozhennaya-dekompoziciya">  D√©composition imbriqu√©e </h2><br><p>  Nous avons donc maintenant l'interface <code>ToDoTask</code> et nous pouvons la r√©f√©rencer.  De m√™me, nous d√©crirons <a href="">ToDoTaskGroup</a> et <a href="">ToDoTaskGroupBlank</a> , et ils contiendront des propri√©t√©s de types <code>ToDoTask</code> et <code>ToDoTaskBlank</code> , respectivement.  Mais maintenant, nous allons diviser le ¬´groupe de t√¢ches¬ª en deux, et non trois, composants: pour plus de clart√©, nous allons d√©crire le delta dans <a href="">ToDoGroupExtendedData</a> .  Je veux donc d√©montrer une approche dans laquelle un composant est cr√©√© √† partir des deux autres: </p><br><pre> <code class="plaintext hljs">"ToDoGroup": { "allOf": [ { "$ref": "#/components/schemas/ToDoGroupBlank" }, { "$ref": "#/components/schemas/ToDoGroupExtendedData" } ] }</code> </pre> <br><p>  Apr√®s avoir commenc√© la g√©n√©ration de code, nous obtenons une construction TypeScript l√©g√®rement diff√©rente: </p><br><pre> <code class="java hljs">export type ToDoGroup = ToDoGroupBlank &amp; <span class="hljs-comment"><span class="hljs-comment">// Data needed for group creation ToDoGroupExtendedData; // Extended data has to be obtained after first save</span></span></code> </pre> <br><p>  Puisque <code>ToDoGroup</code> n'a pas son propre ¬´corps¬ª, le g√©n√©rateur de code a pr√©f√©r√© le transformer en une union d'interfaces.  Cependant, si vous ajoutez la troisi√®me partie avec votre propre sch√©ma (anonyme), le r√©sultat sera une interface avec deux anc√™tres (mais il vaut mieux ne pas le faire).  Et notons que la propri√©t√© <code>items</code> de l'interface <code>ToDoGroupBlank</code> typ√©e comme un tableau de <code>ToDoTaskBlank</code> et est red√©finie dans <code>ToDoGroupBlank</code> sur <code>ToDoTask</code> .  Ainsi, le g√©n√©rateur de code est capable de transf√©rer les nuances plut√¥t complexes de d√©composition du sch√©ma JSON vers TypeScipt. </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* tslint:disable */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ToDoTaskBlank } from <span class="hljs-string"><span class="hljs-string">'./to-do-task-blank'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * ## Base part of data of group * Data needed for group creation */</span></span> export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoGroupBlank</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... items?: Array&lt;ToDoTaskBlank&gt;; // ... }</span></span></code> </pre> <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* tslint:disable */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ToDoTask } from <span class="hljs-string"><span class="hljs-string">'./to-do-task'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * ## Extended data of group * Extended data has to be obtained after first save */</span></span> export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToDoGroupExtendedData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... items: Array&lt;ToDoTask&gt;; }</span></span></code> </pre><br><p>  Et bien s√ªr, dans <code>ToDoTask</code> / <code>ToDoTaskBlank</code> nous pouvons √©galement utiliser la d√©composition.  Vous avez peut-√™tre remarqu√© que la propri√©t√© <code>attachments</code> est d√©crite comme un tableau d'√©l√©ments de type <a href="">AttachmentMeta</a> .  Et ce composant est d√©crit comme suit: </p><br><pre> <code class="java hljs"><span class="hljs-string"><span class="hljs-string">"AttachmentMeta"</span></span>: { <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Common meta data model of any type of attachment"</span></span>, <span class="hljs-string"><span class="hljs-string">"oneOf"</span></span>: [ {<span class="hljs-string"><span class="hljs-string">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/AttachmentMetaImage"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/AttachmentMetaDocument"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"$ref"</span></span>: <span class="hljs-string"><span class="hljs-string">"#/components/schemas/ExternalResource"</span></span>} ] }</code> </pre> <br><p>  Autrement dit, ce composant fait r√©f√©rence √† d'autres composants.  Puisqu'il n'a pas son propre sch√©ma, le g√©n√©rateur de code n'en fait pas un type de donn√©es s√©par√© afin de ne pas multiplier les entit√©s, mais transforme une description anonyme du type √©num√©r√©: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Any material attached to the task: may be screenshots, photos, pdf- or doc- * documents on something else */</span></span> attachments?: Array&lt; | AttachmentMetaImage <span class="hljs-comment"><span class="hljs-comment">// Meta data of image attached to task | AttachmentMetaDocument // Meta data of document attached to task | string // Link to any external resource &gt;;</span></span></code> </pre> <br><p>  Dans le m√™me temps, pour les composants <code>AttachmentMetaImage</code> et <code>AttachmentMetaDocument</code> , des interfaces non anonymes sont d√©crites qui sont import√©es dans les fichiers qui les utilisent: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AttachmentMetaDocument } from <span class="hljs-string"><span class="hljs-string">'./attachment-meta-document'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AttachmentMetaImage } from <span class="hljs-string"><span class="hljs-string">'./attachment-meta-image'</span></span>;</code> </pre> <br><p>  Mais m√™me dans <a href="">AttachmentMetaImage,</a> nous pouvons trouver un lien vers une autre interface <a href="">ImageOptions</a> rendue, qui est utilis√©e deux fois, y compris √† l'int√©rieur d'une interface anonyme (le r√©sultat de la conversion de <a href="">additionalProperties</a> ): </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* tslint:disable */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ImageOptions } from <span class="hljs-string"><span class="hljs-string">'./image-options'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Meta data of image attached to task */</span></span> export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AttachmentMetaImage</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... /** * Possible thumbnails of uploaded image */ thumbs?: { [key: string]: { /** * Link to any external resource */ url?: string; imageOptions?: ImageOptions; }; }; // ... imageOptions: ImageOptions; }</span></span></code> </pre> <br><p>  Ainsi, sur la <code>ToDoTask</code> <code>ToDoGroup</code> <code>ToDoTask</code> ou <code>ToDoGroup</code> , nous int√©grons en fait plusieurs entit√©s dans le code et une cha√Æne de leurs connexions commerciales, ce qui nous donne plus de contr√¥le sur les changements dans le sur-syst√®me qui vont au-del√† de notre code.  Bien s√ªr, cela n'a pas de sens dans tous les cas.  Mais si vous utilisez OpenAPI, vous pouvez avoir un petit bonus suppl√©mentaire, en plus de la documentation r√©elle. </p><br><a name="ServiceGeneration"></a><br><h2 id="avtogeneraciya-servisov-dlya-raboty-s-rest-api">  Services g√©n√©r√©s automatiquement pour travailler avec l'API REST </h2><br><a name="WhyItNeccessary"></a><br><h3 id="zachem-eto-nuzhno">  Pourquoi est-ce n√©cessaire? </h3><br><p>  Si nous prenons une application frontale statistique moyenne qui fonctionne avec une API REST plus ou moins complexe, une partie consid√©rable de son code sera constitu√©e de services (ou simplement de fonctions) pour acc√©der √† l'API.  Ils comprendront: </p><br><ul><li>  Mappages d'URL et de param√®tres </li><li>  Validation des param√®tres, demande et r√©ponse </li><li>  Extraction de donn√©es et traitement d'urgence </li></ul><br><p>  Il est d√©sagr√©able que, √† bien des √©gards, cela soit typique et ne contienne aucune logique unique.  Supposons un exemple - comme un aper√ßu g√©n√©ral, le travail avec l'API peut √™tre construit: </p><br><div class="spoiler">  <b class="spoiler_title">Un exemple sch√©matique simplifi√© de travail avec l'API REST</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'lodash'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Observable, fromFetch, throwError } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { switchMap } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/operators'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Definitions const URLS = { 'getTasksOfGroup': `${env.REST_API_BASE_URL}/tasks/\${groupId}`, // ... other urls ... }; const URL_TEMPLATES = _.mapValues(urls, url =&gt; _.template(url)); interface GetTaskConditions { isDone?: true | false; offset?: number; limit?: number; } interface ErrorReponse { error: boolean; message?: string; } // Helpers // I taken this snippet from StackOverflow only for example function encodeData(data) { return Object.keys(data).map(function(key) { return [key, data[key]].map(encodeURIComponent).join("="); }).join("&amp;"); } // REST API functions // our REST API working function example function getTasksFromServer(groupUid: string, conditions: GetTaskConditions = {}): Observable&lt;Response&gt; { if (!groupUid) { return throwError(new Error('You should specify "groupUid"!')); } if (!_.isString(groupUid)) { return throwError(new Error('`groupUid` should be string!')); } if (_.isBoolean(conditions.isDone)) { // ... applying of conditions.isDone } else if (conditions.isDone !== undefined) { return throwError(new Error('`isDone` should be "true", "false" or should\'t be set!'!)); } if (offset) { // ... check of `offset` and applying or error throwing } if (limit) { // ... check of `limit` and applying or error throwing } const url = [ URL_TEMPLATES['getTasksOfGroup']({groupUid}), ...(conditions ? [encodeData(conditions)] : []) ]; return fromFetch(url); } // Using of REST API working functions function getRemainedTasks(groupUid: number): Observable&lt;ToDoTask[] | ErrorReponse&gt; { return getTasksFromServer(groupUid, {isDone: false}).pipe( switchMap(response =&gt; { if (response.ok) { // OK return data return response.json(); } else { // Server is returning a status requiring the client to try something else. return of({ error: true, message: `Error ${response.status}` }); } }), catchError(err =&gt; { // Network or other error, handle appropriately console.error(err); return of({ error: true, message: err.message }) }) ); }</span></span></code> </pre> </div></div><br><p>  Vous pouvez utiliser une abstraction de haut niveau pour travailler avec REST - selon la pile utilis√©e, elle peut √™tre: <a href="https://github.com/axios/axios">Axios</a> , <a href="http">Angular HttpClient</a> , ou toute autre solution similaire.  Mais tr√®s probablement, votre code co√Øncidera essentiellement avec cet exemple.  Il comprendra certainement: </p><br><ul><li>  Services ou fonctions pour acc√©der √† des points de terminaison sp√©cifiques (fonction <code>getTasksFromServer</code> dans notre exemple) </li><li>  Morceaux de code qui traitent le r√©sultat (fonction <code>getRemainedTasks</code> ) </li></ul><br><p>  Dans une application du monde r√©el, ce code sera plus compliqu√©: la sp√©cification de l'application de d√©monstration <a href="">d√©crit 5-6 options de r√©ponse</a> .  Souvent, l'API REST est con√ßue de telle mani√®re que chaque √©tat de r√©ponse du serveur doit √™tre g√©r√© en cons√©quence.  Mais m√™me la v√©rification des donn√©es d'entr√©e a tendance √† devenir plus difficile lors du d√©veloppement de l'application: plus il faut de temps pour prendre en charge et traiter les r√©visions d'erreurs, plus vous voulez en savoir sur les goulots d'√©tranglement dans la circulation des donn√©es dans l'application. </p><br><blockquote>  Des erreurs peuvent se produire au niveau de chaque n≈ìud d'accueil de composants logiciels, dont la d√©tection intempestive (ainsi que la recherche de probl√®mes difficiles √† diagnostiquer) peut √™tre tr√®s co√ªteuse pour les entreprises.  Par cons√©quent, il y aura des v√©rifications de clarification suppl√©mentaires.  √Ä mesure que la base de code augmente et que le nombre de cas couverts, la complexit√© des modifications augmente.  Mais les affaires sont un changement constant et il n'y a pas moyen de les contourner.  Par cons√©quent, nous devons nous soucier de la fa√ßon dont nous apporterons des modifications √† l'avance. </blockquote><p>  Pour en revenir √† la rubrique OpenAPI, nous notons que dans les sp√©cifications de l'OEA, il peut y avoir suffisamment d'informations pour: </p><br><ul><li>  D√©crire tous les points finaux n√©cessaires sous forme de fonctions ou de services </li><li>  Associez-les aux types de donn√©es souhait√©s. </li><li>   URL      </li><li>         </li></ul><br><p>         ‚Äî <strong></strong> .    ,     ,     /  ‚Äî 5, 10  200,            .  ,      ,   : , , , RxJS- <a href="">pickResponseBody</a> ,            ,     - ;  <a href="">tapResponse</a> ,    side-effect (tap)   HTTP-.     ,     -   .    ,       ,    . </p><br><blockquote> ,     ‚Äî   -,      .      ,       ,  ,   ""  /     API     "-"  "" .    -   ,        "" (    ),     . </blockquote><p>   ,          REST API   Angular.         ,      ,        /.      . ,      ,    .  ,      , ..      . </p><br><a name="HowToGenerateServices"></a><br><h3 id="generaciya-servisov">   </h3><br><p>   " <a href="https://habr.com/ru/post/483628/">  </a> "      .   Angular-,       <code>update-typings.js</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cliLib = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@codegena/oapi3ts-cli'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cliApp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> cliLib.CliApplication; cliApp.createTypings(); cliApp.createServices(<span class="hljs-string"><span class="hljs-string">'angular'</span></span>);</code> </pre> <br><p>             ,   Angular-    API   .    , -   - ,     <a href="https://github.com/koshevy/codegena/tree/master/libs/todo-app-scheme/src/lib/services"> </a> .     ,    <a href="">RewriteGroupService</a> .    <a href="">ApiService</a> ,        ,   ,   -: </p><br><div class="spoiler"> <b class="spoiler_title">-  </b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Typings for this API method import { RewriteGroupParameters, RewriteGroupResponse, RewriteGroupRequest } from '../typings'; // Schemas import { schema as domainSchema } from './schema.b4c655ec1635af1be28bd6'; /** * Service for angular based on ApiAgent solution. * Provides assured request to API method with implicit * validation and common errors handling scheme. */ @Injectable() export class RewriteGroupService extends ApiService&lt; RewriteGroupResponse, RewriteGroupRequest, RewriteGroupParameters &gt; { protected get method(): 'PUT' { return 'PUT'; } /** * Path template, example: `/some/path/{id}`. */ protected get pathTemplate(): string { return '/group/{groupId}'; } /** * Parameters in a query. */ protected get queryParams(): string[] { return ['forceSave']; } // ... }</span></span></code> </pre> </div></div><br><p> , <a href="">   JSON Schema</a>  ,   .    <a href=""> </a> ,        ,       : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { schema as domainSchema } from <span class="hljs-string"><span class="hljs-string">'./schema.b4c655ec1635af1be28bd6'</span></span>;</code> </pre> <br><blockquote> ,     <code>schema.b4c655ec1635af1be28bd6.ts</code>       ,  <a href="">  </a>  ,  . </blockquote><br><a name="UsingOfGeneratedServices"></a><br><h3 id="ispolzovanie-generiruemyh-servisov">    </h3><br><p>       ,   Angular-. </p><br><div class="spoiler"> <b class="spoiler_title">    Angular-</b> <div class="spoiler_text"><p>      <code>ApiModule</code>       : </p><br><pre> <code class="plaintext hljs">import { ApiModule, API_ERROR_HANDLER } from '@codegena/ng-api-service'; import { CreateGroupItemService, GetGroupsService, GetGroupItemsService, UpdateFewItemsService } from '@codegena/todo-app-scheme'; @NgModule({ imports: [ ApiModule, // ... ], providers: [ RewriteGroupService, { provide: API_ERROR_HANDLER, useClass: ApiErrorHandlerService }, // ... ], // ... }) export class TodoAppModule { }</code> </pre> </div></div><br><p>    ,     [])( <a href="https://angular.io/guide/dependency-injection">https://angular.io/guide/dependency-injection</a> ): </p><br><pre> <code class="plaintext hljs">@Injectable() export class TodoTasksStore { constructor( protected createGroupItemService: CreateGroupItemService, protected getGroupsService: GetGroupsService, protected getGroupItemsService: GetGroupItemsService, protected updateFewItemsService: UpdateFewItemsService ) {} }</code> </pre> <br><p>         ‚Äî  ,       <a href="">request</a> ,        : </p><br><pre> <code class="plaintext hljs">return this.getGroupsService.request(null, { isComplete: null, withItems: false }).pipe( pickResponseBody&lt;GetGroupsResponse&lt;200&gt;&gt;(200, null, true), switchMap&lt;ToDoGroup[], Observable&lt;ComponentTruth&gt;&gt;( groups =&gt; this.loadItemsOfSelectedGroups({ ...truth, groups }) ) );</code> </pre> <br><p>  <code>request</code>   <code>Observable&lt;HttpResponse&lt;R&gt; | HttpEvent&lt;R&gt;&gt;</code> ,   ,        . ,     ,      . ,  ,      ,     .     RxJS- <code>pickResponseBody</code> . </p><br><p>  ,    ,    ,   .         API,    .        .   ,     : </p><br><p><img src="https://habrastorage.org/webt/3y/xe/dy/3yxedy51z7su99butzrk2dvunnq.png"></p><br><p>      .   JSON Schema     .       ,   ""      - .   ,      <a href="https://sentry.io/welcome/">Sentry</a>  <a href="https://www.elastic.co/products/kibana">Kibana</a> ,   .       .  ,      ,      . </p><br><blockquote>  ,             .  ,      :) </blockquote><br><a name="AfterWord"></a><br><h2 id="vmesto-poslesloviya">  Au lieu d'une postface </h2><br><p>   ,       .       -,   "    "    ‚Äî   .  ,  ,   ,   . </p><br><p>     ‚Äî    ,  - /    (   ).      ,  ‚Äî   . </p><br><p>  Merci d'avoir lu. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr483628/">https://habr.com/ru/post/fr483628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr483610/index.html">Un automate est-il un √©v√©nement?</a></li>
<li><a href="../fr483612/index.html">Un conducteur de Tesla condamn√© √† une amende pour s'√™tre bross√© les dents pendant qu'il conduisait sur un pilote automatique</a></li>
<li><a href="../fr483614/index.html">M√©thodes de lutte contre le vol dans un club de robotique</a></li>
<li><a href="../fr483616/index.html">Projet Lacmus: comment la vision par ordinateur aide √† sauver des personnes perdues</a></li>
<li><a href="../fr483626/index.html">Comment d√©crire un job 100 gitlab en 100 lignes sur Jsonnet</a></li>
<li><a href="../fr483630/index.html">The Ember Times - Num√©ro 130</a></li>
<li><a href="../fr483634/index.html">Propri√©t√©s de largeur / hauteur Min et Max en CSS</a></li>
<li><a href="../fr483646/index.html">Hack The Box - Proc√©dure pas √† pas Bitlab. Faible obfuscation JS, GIT et applications Windows invers√©es</a></li>
<li><a href="../fr483648/index.html">Offshore pour les entreprises informatiques en G√©orgie: hacks et pi√®ges de la vie</a></li>
<li><a href="../fr483650/index.html">Cosmodromes plus proches de l'√©quateur - Cosmodrome tropical de Wenchang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>