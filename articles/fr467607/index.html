<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤑 🤾🏻 💜 Confession de haineux docker 🖐🏿 👨‍👧‍👧 💆🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je dois avouer. Je déteste le docker. De toute mon âme. C'est le pire logiciel que j'ai vu au cours des 10 dernières années. 


 D'une part, je respec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Confession de haineux docker</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467607/"><p> Je dois avouer.  Je déteste le docker.  De toute mon âme.  C'est le pire logiciel que j'ai vu au cours des 10 dernières années. </p><br><p>  D'une part, je respecte vraiment l'entreprise du même nom.  Les gars de Docker Inc.  conteneurisation vraiment popularisée.  Maintenant, seuls les paresseux ne la connaissent pas.  D'un autre côté, ils n'ont rien inventé de fondamentalement nouveau - la conteneurisation existait depuis plus de 30 ans au moment où Docker a «tiré» (à partir de chroot, souvenez-vous des prisons et des zones, et enfin des espaces de noms et des groupes de contrôle). </p><br><p>  Cool ce docker accélère vraiment le développement à plusieurs reprises.  Si vous le conduisez correctement, même sans perte de qualité.  Dans tous les cas, docker est là, vous ne pouvez pas vous en éloigner et vous devez l'utiliser. </p><br><p>  Mais pourquoi ce produit avec un logo de baleine évoque-t-il des émotions aussi diverses?  Ci-dessous, je vais énumérer les moments à partir desquels ils bombardent.  Il est possible que le lecteur soit en désaccord ou, au contraire, trouve des choses qu'il ne connaissait pas et trouveraient intéressantes. </p><br><p>  <strong>Avertissement:</strong> <em>tout ce qui est écrit ci-dessous est l'opinion personnelle de l'auteur et peut refléter la réalité ou ne pas refléter la réalité.</em>  <em>Le matériel est strictement provocateur et l'objectif principal n'est pas d'humilier ou d'offenser qui que ce soit, mais plutôt de faire tourner la tête et de réaliser les profondeurs (c).</em> </p><a name="habracut"></a><br><h4 id="docker-i-fayrvoll">  docker et pare-feu </h4><br><p>  Lors de la création de conteneurs sur des réseaux pontés, Docker ajoute ses propres règles de pare-feu sur le système.  Cela conduit à des effets très intéressants.  Tout d'abord, il devient tout simplement impossible de réinitialiser les chaînes de netfilter (cela peut se produire lorsque vous réappliquez vos règles), car  après cela, les conteneurs docker sont cassés et le démon docker doit être redémarré.  De plus, la signification des utilitaires iptables-save / restore est perdue, car  en fait, ils enregistrent les règles, mais pas celles qui en ont besoin - vous devez filtrer leur sortie.  Une autre tâche très intéressante consiste à combiner docker et tout ce qui tente de gérer indépendamment le pare-feu - que ce soit un client / serveur VPN ou un système de gestion de configuration qui veille avec vigilance à ce que les règles correspondent à ce que l'administrateur système a décrit. </p><br><p>  Jusqu'à récemment, il n'y avait aucun moyen de contrôler de manière fiable et répétitive l'accès réseau au conteneur via le pare-feu, mais les développeurs ont ajouté une chaîne DOCKER-USER distincte, mais pour être honnête, cela n'a aucun sens. </p><br><p>      :     ,    ,    — . ,   INPUT        ,       NAT (    CentOS     <code>docker run ... -p XX:YY</code>)</p><br>
<p>, , ,    —    docker-      , ,             . ,     , ..        docker'.</p><br>
<h4 id="docker-i-seti">docker  </h4><br>
<p>  docker-  docker-bridge docker0,    ,        -  .   (!)       DNS .          ( <code>docker network create</code>   docker-compose).  .          172.16.0.0/12.   ,            ,         .    —      .  ,    bip ,  docker-compose   , ..      .</p><br>
<p>         -p  --publish,    network host mode —     5%  ,   …       :-)     - ,  docker         NAT.</p><br>
<h4 id="docker----eto-ne-pro-sovmestimost">docker —    </h4><br>
<p>,         ,     ?      .  —    ""  aufs,     overlay2, ..     .   —    .      volume  image,    -   .       ,          overlay2 .     docker info .</p><br>
<p>  — !      -       -.    (        ) —   .   ,           -.</p><br>
<h4 id="docker-hub---eto-pomoyka">docker hub —  </h4><br>
<p>Docker Inc.              — Docker Hub.       ,   .     ,    (      ).   ,   ?   ,      ,  -   .    —        root'     .     ,  ,        .   —  ,        ,        .</p><br>
<p>            —   .         ,   —      .  ,      - (  ,      ).    —        ,    .        —              — python, ruby, node.js.     golang     java —      .</p><br>
<p>   ?   —  ,     —   —        registry  -.         (    ,    ,     ,       ,      k8s).</p><br>
<h4 id="putanica-s-terminami-i-s-klyuchami-komandnoy-stroki">       </h4><br>
<p>registry vs repository, bind mount vs volume (     <code>docker run ... -v</code>,      ), tag vs image name, EXPOSE vs expose vs ports,   volumes (, ...).  .  ,  , ..           .      ,        , ..     ,    .</p><br>
<h4 id="poryadok-zapuska"> </h4><br>
<p>  — docker      . .   .      .     .   systemd unit' (,      —  -     ),    bash.</p><br>
<p>,   docker-compose. ,       .  depends_on,       — , ..        (   docker-compose up)   ,    .   ,         (     2.4 docker-compose).</p><br>
<h4 id="formaty-docker-compose"> docker-compose</h4><br>
<p> docker-compose            —  <code>2.*</code>  <code>3.*</code>.    .   3.*   docker swarm           .        .</p><br>
<h4 id="ustanovka"></h4><br>
<p> 100500   docker  docker-compose.      .   ,  -       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">docker</a>,   Docker Inc.    .   ""    <a href="">docker.io</a>  docker-ce. , , ,        .  Docker</p><br>
<p>  ,      ,    docker  Ubuntu  snap.   -    .    .     ,   docker     .</p><br>
<p>docker-compose —           pip —        . -,    docker-compose             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>). -,    python  (!   ),  docker-compose    (,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> —    , ,      ).  —     — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   .  </a>  (      —  md5sum).</p><br>
<h4 id="docker-i-bezopasnost">docker  </h4><br>
<p>  docker    —  ,     . , docker     agile-    :    .  ,      .   — ,     -   root    . ,       :</p><br>
<p><code>docker run --rm -it -v /:/rootfs ubuntu bash</code></p><br>
<p>,           .    ,   .          (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>),           . </p><br>
<p>   ,   ,    bind mount (   -),     .         ,     ,   ,      ,     hot reload'   . ,   —   bind mount      <code>docker run ... -v ...</code>   root      .      bind mount (<code>docker run ... --mount ...</code>),  ,            .  ? ,   :-)     —   volume (     <code>/var/lib/docker/volumes</code></p><br>
<p>  ,       docker          . ,    ,  CVE    .</p><br>
<h4 id="docker-i-ne-linuks">docker  -</h4><br>
<p>        linux-kind  .   , .. docker      namespaces  cgroups  .     ?  ,   Mac  Windows     docker  Docker Desktop   ,       volume     ( , ..   ).    ,  .</p><br>
<h4 id="docker-i-izolyaciya">docker  </h4><br>
<p>   100%    .       iops,    . ,  , —  ,    .       ,      ,      .     —  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dentry</a></p><br>
<h4 id="docker-i-logirovanie">docker  </h4><br>
<p>  docker  json-file .       <code>/var/lib/containers/&lt;hash&gt;/&lt;hash&gt;-json.log</code>       .         ,    ?  .         " "  <br>
   — journald,     docker logs (    !?).    —    ,     Docker-EE,        ?<br>
  —          ?    .  ,  ,    .</p><br>
<h4 id="docker-i-alternativy">docker  </h4><br>
<p>   .  , docker   .     ,      systemd-nspawn.                   —    ,    Vagrant, VirtualBox  lxc/lxd,    .  docker   ,     kubernetes —        containerd,   .</p><br>
<h4 id="prochee"></h4><br>
<p>    :      docker-compose —   YAML     docker-compose-    ?    docker swarm (kubernetes    ) —     .    Docker Inc.     (     ),      (*)     ,     .       .</p><br>
<h4 id="the-end">The END</h4><br>
<p>   ?        — docker —  .    ,         .       .   docker —       .      , , cri-o/<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">podman</a>/buildah,        .    FireCracker,        (   )       (       ).</p><br>
<p>        ,                 .</p><br>
<p>(*) —     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">docker-template</a>, multi-stage   docker build, buildkit          ,         —       .</p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467607/">https://habr.com/ru/post/fr467607/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467593/index.html">(Sans objet, réparé) Remarque. Comment Tele2 partage l'accès au compte personnel des nouveaux abonnés</a></li>
<li><a href="../fr467595/index.html">Voyager à travers le centre de données Selectel. Dinosaure en feu, VMware, C2F5H et le loup-garou invisible</a></li>
<li><a href="../fr467597/index.html">Personnalisation des directives de produit Big Data avec Vowpal Wabbit</a></li>
<li><a href="../fr467599/index.html">Rendu graphique 3D avec OpenGL</a></li>
<li><a href="../fr467605/index.html">Tout ce dont vous avez besoin est une URL</a></li>
<li><a href="../fr467609/index.html">Création d'une application mobile sur React Native</a></li>
<li><a href="../fr467611/index.html">Algorithmes de détection de contour d'image</a></li>
<li><a href="../fr467615/index.html">Comment créer un wrapper Python et ne pas devenir fou</a></li>
<li><a href="../fr467617/index.html">Kaspresso: le framework d'autotest que vous attendiez</a></li>
<li><a href="../fr467619/index.html">Les pichets Aquafor sont un bon exemple de la façon dont les filtres pour le traitement de l'eau ne peuvent pas être conçus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>