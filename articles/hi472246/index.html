<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП╜тАНтЬИя╕П ЁЯС╡ЁЯП╛ ЁЯША React + IndexDb + рдСрдЯреЛ-рдЕрдкрдбреЗрдЯ = рд▓рдЧрднрдЧ AsyncRedux ЁЯЪз ЁЯЪ┤ЁЯП┐ ЁЯд╛ЁЯП╝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рдореИрдВ рдЖрдкрдХреЛ рдХрджрдо рд╕реЗ рдХрджрдо рдмрддрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ ReactJS рдореЗрдВ рд▓рд┐рдЦреА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП IndexDB (рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЬреЛ рдХрд┐рд╕реА рднреА рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдмрдирд╛рдпрд╛ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>React + IndexDb + рдСрдЯреЛ-рдЕрдкрдбреЗрдЯ = рд▓рдЧрднрдЧ AsyncRedux</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472246/"><img width="300" align="right" src="https://habrastorage.org/webt/ak/5r/t4/ak5rt4e4mavxwvxlaidpfgiie0g.jpeg">  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рдореИрдВ рдЖрдкрдХреЛ рдХрджрдо рд╕реЗ рдХрджрдо рдмрддрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ ReactJS рдореЗрдВ рд▓рд┐рдЦреА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП IndexDB (рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЬреЛ рдХрд┐рд╕реА рднреА рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ) рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реИред  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЖрдк рдЗрдВрдбреЗрдХреНрд╕рдбреАрдмреА рд╕реЗ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрд╕рд╛рдиреА рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">Redux рд╕реНрдЯреЛрд░ рдореЗрдВ рдерд╛</a> ред <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">IndexDB</a> рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">рдЙрдиреНрдореБрдЦ</a> DBMS рд╣реИ, рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рдУрд░ рд╕рдВрд░рдЪрд┐рдд рдбреЗрдЯрд╛ рдХреА рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЫреЛрдЯреА рд░рд╛рд╢рд┐ (рдЗрдХрд╛рдЗрдпреЛрдВ рдФрд░ рдореЗрдЧрд╛рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рджрд╕рд┐рдпреЛрдВ) рдХреЗ рдЕрд╕реНрдерд╛рдпреА рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдЙрдкрдХрд░рдг рд╣реИред  рдЬрд┐рд╕ рдорд╛рдирдХ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдореБрдЭреЗ IndexDB рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, рдЙрд╕рдореЗрдВ рдЧреНрд░рд╛рд╣рдХ рдкрдХреНрд╖ рдкрд░ рд╡реНрдпрд╛рдкрд╛рд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдбреЗрдЯрд╛ (рджреЗрд╢реЛрдВ, рд╢рд╣рд░реЛрдВ, рдХреЛрдб рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдореБрджреНрд░рд╛рдПрдВ, рдЖрджрд┐) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдЗрдб рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдХреЙрдкреА рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рдХреЗрд╡рд▓ рд╕рд░реНрд╡рд░ (рдпрд╛ рд╕рдВрдкреВрд░реНрдг - рд╡реЗ рдЫреЛрдЯреЗ рд╣реИрдВ) рд╕реЗ рдЗрди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рд╕реЗ рдЕрдкрдбреЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╡рд┐рдВрдбреЛ рдЦреЛрд▓рддреЗ рд╣реИрдВ рддреЛ рдРрд╕рд╛ рди рдХрд░реЗрдВред <br><a name="habracut"></a><br>  IndexDB рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреИрд░-рдорд╛рдирдХ, рдмрд╣реБрдд рд╡рд┐рд╡рд╛рджрд╛рд╕реНрдкрдж, рд▓реЗрдХрд┐рди рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рд╣реИрдВ: <br><br><ul><li>  <b>рд╕рднреА</b> рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╢рд┐рдВрдЧ рдХрд░рдирд╛ рддрд╛рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рд╛рдЗрдб рдкрд░ рд╡реНрдпрд╛рдкрдХ рдЫрдВрдЯрд╛рдИ рдФрд░ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ </li><li>  Redux рд╕реНрдЯреЛрд░ рдХреЗ рдмрдЬрд╛рдп IndexDB рдореЗрдВ рдЖрд╡реЗрджрди рдХреА рд╕реНрдерд┐рддрд┐ </li></ul><br>  IndexDB рдФрд░ Redux Store рдХреЗ рдмреАрдЪ рддреАрди рдкреНрд░рдореБрдЦ рдЕрдВрддрд░ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ: <br><br><ol><li>  IndexDB рдПрдХ рдмрд╛рд╣рд░реА рд╕рдВрдЧреНрд░рд╣рдг рд╣реИ рдЬрд┐рд╕реЗ рдкреГрд╖реНрда рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддреЗ рд╕рдордп рд╕рд╛рдлрд╝ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рдХрдИ рдЦреБрд▓реЗ рдЯреИрдм рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рд╣реИ (рдЬреЛ рдХрднреА-рдХрднреА рдХреБрдЫ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ) </li><li>  IndexDB рдПрдХ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ DBMS рд╣реИред  рд╕рднреА рдСрдкрд░реЗрд╢рди - рдЦреЛрд▓рдирд╛, рдкрдврд╝рдирд╛, рд▓рд┐рдЦрдирд╛, рдЦреЛрдЬрдирд╛ - рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХред </li><li>  IndexDB JSON рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд (рддреБрдЪреНрдЫ рддрд░реАрдХреЗ рд╕реЗ) рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕реНрдиреИрдкрд╢реЙрдЯ рдмрдирд╛рдиреЗ, рдбреАрдмрдЧ рдХрд░рдиреЗ рдореЗрдВ рдЖрд╕рд╛рдиреА рдФрд░ рдЕрддреАрдд рдореЗрдВ рдпрд╛рддреНрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Redux рд╕реЗ рдорд╕реНрддрд┐рд╖реНрдХ-рдЪрд╛рд▓рд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </li></ol><br><h2>  рдЪрд░рдг 0: рдХрд╛рд░реНрдп рд╕реВрдЪреА </h2><br>  рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд╛рд░реНрдпреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдХреЗ рд╕рд╛рде рдПрдХ рдХреНрд▓рд╛рд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдгред  рд╡рд░реНрддрдорд╛рди рдФрд░ рдПрдХрдорд╛рддреНрд░ рдШрдЯрдХ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд░рд╛рдЬреНрдп рдХреЗ рднрдВрдбрд╛рд░рдг рдХреЗ рд╕рд╛рде рднрд┐рдиреНрдирддрд╛ <br><br><div class="spoiler">  <b class="spoiler_title">рдХрд┐рд╕реА рдХрд╛рд░реНрдп рд╕реВрдЪреА рдШрдЯрдХ рдХреЗ рдШрдЯрдХ рд░рд╛рдЬреНрдп рдореЗрдВ рд╕реВрдЪреА рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Button'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> counter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'common/counter'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Form <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Table <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Table'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step0</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'Sample task'</span></span> }, ], }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ ...state.tasks, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: state.newTaskText } ], <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, } ) ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDeleteF = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">idToDelete</span></span></span><span class="hljs-function"> =&gt;</span></span> () =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: state.tasks.filter( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> { id } </span></span></span><span class="hljs-function">) =&gt;</span></span> id !== idToDelete ), } ) ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleNewTaskTextChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> { target: { value } } </span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: value || <span class="hljs-string"><span class="hljs-string">''</span></span>, } ); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bordered</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">hover</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">striped</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">#</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Text</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">th</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { this.state.tasks.map( task =&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{task.id}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{task.id}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{task.text}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleDeleteF(</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">task.id</span></span></span></span><span class="xml"><span class="hljs-tag"> )} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"danger"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"+1"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Form.Control</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleNewTaskTextChange}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"  "</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.newTaskText</span></span></span></span><span class="xml"><span class="hljs-tag"> || ''} /&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleAdd}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">; } }</span></span></code> </pre>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) </div></div><br>  рдЕрдм рддрдХ, рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕рд╛рде рд╕рднреА рдСрдкрд░реЗрд╢рди рд╕рд┐рдВрдХреНрд░реЛрдирд╕ рд╣реИрдВред  рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░реНрдп рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдореЗрдВ 3 рд╕реЗрдХрдВрдб рд▓рдЧрддреЗ рд╣реИрдВ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдмрд╕ 3 рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдлреНрд░реАрдЬ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред  рдмреЗрд╢рдХ, рдЬрдм рд╣рдо рдЕрдкрдиреА рдпрд╛рджрджрд╛рд╢реНрдд рдореЗрдВ рд╕рдм рдХреБрдЫ рд░рдЦрддреЗ рд╣реИрдВ, рд╣рдо рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рд╕реЛрдЪ рд╕рдХрддреЗред  рдЬрдм рд╣рдо рдХрд┐рд╕реА рд╕рд░реНрд╡рд░ рдпрд╛ рдХрд┐рд╕реА рд╕реНрдерд╛рдиреАрдп рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдХреЗ рд╕реБрдВрджрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде-рд╕рд╛рде рджреЗрдЦрднрд╛рд▓ рднреА рдХрд░рдиреА рд╣реЛрдЧреАред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рддрддреНрд╡реЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдпрд╛ рд╣рдЯрд╛рдиреЗ рдХреЗ рджреМрд░рд╛рди рдПрдХ рддрд╛рд▓рд┐рдХрд╛ (рдпрд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рддрддреНрд╡реЛрдВ) рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдирд╛ред <br><br>  рднрд╡рд┐рд╖реНрдп рдореЗрдВ UI рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЛ рдирд╣реАрдВ рджреЛрд╣рд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдХрд╛рд░реНрдпрд╕реВрдЪреА рдШрдЯрдХ рдореЗрдВ рд░рдЦреЗрдВрдЧреЗ, рдЬрд┐рд╕рдХрд╛ рдПрдХрдорд╛рддреНрд░ рдХрд╛рд░реНрдп рдХрд╛рд░реНрдп рд╕реВрдЪреА рдХрд╛ HTML рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ред  рдЙрд╕реА рд╕рдордп, рд╣рдо рд╕рд╛рдорд╛рдиреНрдп рдмрдЯрди рдХреЛ рдмреВрдЯрд╕реНрдЯреНрд░реИрдк рдмрдЯрди рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЖрд╡рд░рдг рдХреЗ рд╕рд╛рде рдмрджрд▓ рджреЗрдВрдЧреЗ, рдЬреЛ рдмрдЯрди рдХреЛ рддрдм рддрдХ рдЕрд╡рд░реБрджреНрдз рдХрд░реЗрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рдмрдЯрди рд╣реИрдВрдбрд▓рд░ рдЕрдкрдиреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдкреВрд░рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рдпрд╣ рд╣реИрдВрдбрд▓рд░ рдПрдХ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рд╣реЛред <br><br><div class="spoiler">  <b class="spoiler_title">рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдХрд╛рд░реНрдп рд╕реВрдЪреА рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдШрдЯрдХ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> counter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'common/counter'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TaskList <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../common/TaskList'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step01</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">'Sample task'</span></span> }, ] }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newTaskText</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: [ ...state.tasks, { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ], } ) ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDelete = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">idToDelete</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: state.tasks.filter( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> { id } </span></span></span><span class="hljs-function">) =&gt;</span></span> id !== idToDelete ), } ) ); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;&gt; &lt;h1&gt;      &lt;/h1&gt; &lt;h2&gt;       &lt;/h2&gt; &lt;TaskList onAdd={this.handleAdd} onDelete={this.handleDelete} tasks={this.state.tasks} /&gt; &lt;/&gt;; } }</code> </pre>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) </div></div><br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рдШрдЯрдХ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЬреЛ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдирдпрд╛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЙрд░реНрдо рд╣реЛрддрд╛ рд╣реИ</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./AutoDisableButtonWithSpinner'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Form <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Table <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap/Table'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TaskList</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">newTaskAdding</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">newTaskText</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">newTaskAdding</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   ,     await this.props.onAdd( this.state.newTaskText ); this.setState( { newTaskText: '' } ); } finally { this.setState( { newTaskAdding: false } ); } }; this.handleDeleteF = idToDelete =&gt; async() =&gt; await this.props.onDelete( idToDelete ); this.handleNewTaskTextChange = ( { target: { value } } ) =&gt; this.setState( { newTaskText: value || '', } ); } render() { return &lt;Table bordered hover striped&gt; &lt;thead&gt;&lt;tr&gt; &lt;th&gt;#&lt;/th&gt;&lt;th&gt;Text&lt;/th&gt;&lt;th /&gt; &lt;/tr&gt;&lt;/thead&gt; &lt;tbody&gt; { this.props.tasks.map( task =&gt; &lt;tr key={task.id}&gt; &lt;td&gt;{task.id}&lt;/td&gt; &lt;td&gt;{task.text}&lt;/td&gt; &lt;td&gt;&lt;Button onClick={this.handleDeleteF( task.id )} type="button" variant="danger"&gt;&lt;/Button&gt;&lt;/td&gt; &lt;/tr&gt; ) } &lt;tr key="+1"&gt; &lt;td /&gt; &lt;td&gt;&lt;Form.Control disabled={this.state.newTaskAdding} onChange={this.handleNewTaskTextChange} placeholder="  " type="text" value={this.state.newTaskText || ''} /&gt;&lt;/td&gt; &lt;td&gt;&lt;Button onClick={this.handleAdd} type="button" variant="primary"&gt;&lt;/Button&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/Table&gt;; } }</span></span></code> </pre>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) </div></div><br>  рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдирдореВрдирд╛ рдХреЛрдб рдореЗрдВ рдЖрдк рдХреАрд╡рд░реНрдб async / рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  Async / рдкреНрд░рддреАрдХреНрд╖рд╛рд░рдд рдирд┐рд░реНрдорд╛рдг рдХреЛрдб рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд╛рджреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдкреНрд░рддреАрдХреНрд╖рд┐рдд рдХреАрд╡рд░реНрдб рдЖрдкрдХреЛ рдкреНрд░реЛрдорд┐рд╕ рд▓реМрдЯрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдПрдХ рдирд┐рдпрдорд┐рдд рдлрд╝рдВрдХреНрд╢рди рдерд╛ (рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рддрдм () рдореЗрдВ рдкрд░рд┐рдгрд╛рдо рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ)ред  рдмреЗрд╢рдХ, рдПрдХ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдЬрд╛рджреБрдИ рд░реВрдк рд╕реЗ рдПрдХ рд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдореЗрдВ рдирд╣реАрдВ рдмрджрд▓рддрд╛ рд╣реИ, рдФрд░, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рд╖реНрдкрд╛рджрди рдереНрд░реЗрдб рдХреЛ рдмрд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рд╡реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рддрдм рдХреЛрдб рдЕрдзрд┐рдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдФрд░ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд▓реВрдк рдореЗрдВ рдФрд░ рдХреЛрд╢рд┐рд╢ / рдкрдХрдбрд╝рдиреЗ / рдЕрдВрдд рдореЗрдВ рдирд┐рд░реНрдорд╛рдг рджреЛрдиреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="" rel="nofollow"><code> TaskList</code></a> рди рдХреЗрд╡рд▓ <a href="" rel="nofollow"><code> TaskList</code></a> рд╣реИрдВрдбрд▓рд░ рдХреЛ <a href="" rel="nofollow">рдХреЙрд▓</a> рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ <code>await</code> рдХреАрд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдпрджрд┐ рд╣реИрдВрдбрд▓рд░ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдХреБрдЫ рднреА рдирд╣реАрдВ рд▓реМрдЯрд╛рдПрдЧрд╛, рдпрд╛ <code>Promise</code> рдЕрд▓рд╛рд╡рд╛ рдХрд┐рд╕реА рднреА рдореВрд▓реНрдп рдХреЛ рд╡рд╛рдкрд╕ рдХрд░реЗрдЧрд╛, рддреЛ <code>TaskList</code> рдШрдЯрдХ рдмрд╕ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╕реЗ <code>handleAdd</code> рд╡рд┐рдзрд┐ рдХреЛ рдЬрд╛рд░реА рд░рдЦреЗрдЧрд╛ред  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╣реИрдВрдбрд▓рд░ <code>Promise</code> рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рдпрджрд┐ рд╣реИрдВрдбрд▓рд░ рдХреЛ рдПрдХ async рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ), рддреЛ <code>TaskList</code> рд╣реИрдВрдбрд▓рд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдХрд░реЗрдЧрд╛, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╣реА <code>newTaskAdding</code> рдФрд░ <code>newTaskText</code> рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░реЗрдЧрд╛ред <br><br><h2>  рдЪрд░рдг 1: рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдШрдЯрдХ рдореЗрдВ IndexDB рдЬреЛрдбрд╝реЗрдВ </h2><br>  рдЕрдкрдиреЗ рдХрд╛рдо рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ рд╣рдо рдПрдХ рд╕рд░рд▓ рдШрдЯрдХ рд▓рд┐рдЦреЗрдВрдЧреЗ рдЬреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ: <br><br><ul><li>  рддреБрдЪреНрдЫ рддреНрд░реБрдЯрд┐ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд╕рд╛рде рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЦреЛрд▓рдиреЗ </li><li>  рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ </li><li>  рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдЗрдЯрдо рдЬреЛрдбрд╝рдирд╛ </li></ul><br>  рдкрд╣рд▓рд╛ рд╕рдмрд╕реЗ "рдЧреИрд░-рддреБрдЪреНрдЫ" рд╣реИ - 5 рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рд░реВрдк рдореЗрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреЛрдИ рд░реЙрдХреЗрдЯ рд╕рд╛рдЗрдВрд╕ рдирд╣реАрдВ: <br><br><div class="spoiler">  <b class="spoiler_title">OpenDatabasePromise () - рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдЦреЛрд▓реЗрдВ</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openDatabasePromise</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> keyPath </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> resolve, reject </span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dbOpenRequest = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.indexedDB.open( DB_NAME, <span class="hljs-string"><span class="hljs-string">'1.0.0'</span></span> ); dbOpenRequest.onblocked = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { reject( <span class="hljs-string"><span class="hljs-string">'    ,    , '</span></span> + <span class="hljs-string"><span class="hljs-string">'      .'</span></span> ); }; dbOpenRequest.onerror = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( <span class="hljs-string"><span class="hljs-string">'Unable to open indexedDB '</span></span> + DB_NAME ); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( err ); reject( <span class="hljs-string"><span class="hljs-string">'   ,       .'</span></span> + <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> err.message ? </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' : '</span></span></span></span><span class="hljs-function"><span class="hljs-params"> + err.message : </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">) ); }; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dbOpenRequest</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onupgradeneeded</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> db = event.target.result; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { db.deleteObjectStore( OBJECT_STORE_NAME ); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> ( err ) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( err ); } db.createObjectStore( OBJECT_STORE_NAME, { keyPath } ); }; dbOpenRequest.onsuccess = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.info( <span class="hljs-string"><span class="hljs-string">'Successfully open indexedDB connection to '</span></span> + DB_NAME ); resolve( dbOpenRequest.result ); }; dbOpenRequest.onerror = reject; } ); }</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">getAllPromise / getPromise / putPromise - рдкреНрд░реЛрдкрд░ рдореЗрдВ рд░реИрдкрд░ IndexDb рдХреЙрд▓</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    ObjectStore,   IDBRequest //     Promise function wrap( methodName ) { return function() { const [ objectStore, ...etc ] = arguments; return new Promise( ( resolve, reject ) =&gt; { const request = objectStore[ methodName ]( ...etc ); request.onsuccess = () =&gt; resolve( request.result ); request.onerror = reject; } ); }; } const deletePromise = wrap( 'delete' ); const getAllPromise = wrap( 'getAll' ); const getPromise = wrap( 'get' ); const putPromise = wrap( 'put' ); }</span></span></code> </pre></div></div><br>  рдпрд╣ рд╕рдм рдПрдХ рд╕рд╛рде рдПрдХ IndexedDbRepository рд╡рд░реНрдЧ рдореЗрдВ рд▓рд╛рдирд╛ <br><br><div class="spoiler">  <b class="spoiler_title">IndexedDbRepository - IDBDatabase рдХреЗ рдЖрд╕рдкрд╛рд╕ рдЖрд╡рд░рдг</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DB_NAME = <span class="hljs-string"><span class="hljs-string">'objectStore'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> OBJECT_STORE_NAME = <span class="hljs-string"><span class="hljs-string">'objectStore'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexedDbRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>( keyPath ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.keyPath = keyPath; <span class="hljs-comment"><span class="hljs-comment">//     async //      this.openDatabasePromise = this._openDatabase(); } async _openDatabase( keyPath ) { try { this.dbConnection = await openDatabasePromise( keyPath ); } catch ( error ) { this.error = error; throw error; } } async _tx( txMode, callback ) { await this.openDatabasePromise; // await db connection const transaction = this.dbConnection.transaction( [ OBJECT_STORE_NAME ], txMode ); const objectStore = transaction.objectStore( OBJECT_STORE_NAME ); return await callback( objectStore ); } async findAll() { return this._tx( 'readonly', objectStore =&gt; getAllPromise( objectStore ) ); } async findById( key ) { return this._tx( 'readonly', objectStore =&gt; getPromise( objectStore, key ) ); } async deleteById( key ) { return this._tx( 'readwrite', objectStore =&gt; deletePromise( objectStore, key ) ); } async save( item ) { return this._tx( 'readwrite', objectStore =&gt; putPromise( objectStore, item ) ); } }</span></span></code> </pre>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) </div></div><br>  рдЕрдм рдЖрдк IndexDB рдХреЛ рдХреЛрдб рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-comment"><span class="hljs-comment">// ,     await db.save( { id: 42, text: 'Task text' } ); const item = await db.findById( 42 ); const items = await db.findAll();</span></span></code> </pre><br>  рдЗрд╕ "рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА" рдХреЛ рд╣рдорд╛рд░реЗ рдШрдЯрдХ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВред  рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдирд┐рдпрдореЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрдореНрдкреЛрдиреЗрдВрдЯрдбрд┐рдорд╛рдЙрдВрдЯ () рд╡рд┐рдзрд┐ рдореЗрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> IndexedDbRepository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../common/IndexedDbRepository'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-comment"><span class="hljs-comment">//     this.repository.findAll().then( tasks =&gt; this.setState( { tasks } ) ); }</span></span></code> </pre><br>  рд╕реИрджреНрдзрд╛рдВрддрд┐рдХ рд░реВрдк рд╕реЗ, ComponentsDidMount <code>componentDidMount()</code> рдлрд╝рдВрдХреНрд╢рди рдХреЛ async рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдлрд┐рд░ async / рдкреНрд░рддреАрдХреНрд╖рд╛ рдирд┐рд░реНрдорд╛рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рддрдм () рдХреЗ рдмрдЬрд╛рдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА <code>componentDidMount()</code> "рд╣рдорд╛рд░рд╛" рдлрд╝рдВрдХреНрд╢рди рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рд░рд┐рдПрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдХреМрди рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ 17.x рд▓рд╛рдЗрдмреНрд░реЗрд░реА <code>undefined</code> рдмрдЬрд╛рдп <code>Promise</code> рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреЗ рдкреНрд░рдпрд╛рд╕ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░реЗрдЧреА? <br><br>  рдЕрдм рдирд┐рд░реНрдорд╛рддрд╛ рдореЗрдВ, рдЗрд╕реЗ рдЦрд╛рд▓реА рд╕рд░рдгреА (рдпрд╛ рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд░рдгреА) рдХреЗ рд╕рд╛рде рднрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдЗрд╕реЗ рд╢реВрдиреНрдп рд╕реЗ рднрд░ рджреЗрдВрдЧреЗред  рдФрд░ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рдореЗрдВ, рдпрд╣ рдбреЗрдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕ рдЕрд╢рдХреНрдд рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░реЗрдЧрд╛ред  рдЬреЛ рд▓реЛрдЧ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЗрд╕реЗ рдЕрд▓рдЧ рдЭрдВрдбреЗ рдореЗрдВ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рдВрд╕реНрдерд╛рдУрдВ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХреНрдпреЛрдВ рдХрд░рддреЗ рд╣реИрдВ? <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> } <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> render() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.tasks === <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;&gt;&lt;Spinner animation="border" aria-hidden="true" as="span" role="status" /&gt;&lt;span&gt;  ...&lt;/span&gt;&lt;/&gt;; /* ... */ }</code> </pre><br>  рдпрд╣ <code>handleAdd</code> рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдиреА рд╣реБрдИ рд╣реИ / <code>handleDelete</code> : <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( newTaskText ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.save( { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.findAll() } ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDelete = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( idToDelete ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.deleteById( idToDelete ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.findAll() } ); }; }</code> </pre><br>  рджреЛрдиреЛрдВ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рд╣рдо рдкрд╣рд▓реЗ рдПрдХ рдЖрдЗрдЯрдо рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдпрд╛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреА рдУрд░ рдореБрдбрд╝рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рд╣рдо рд╡рд░реНрддрдорд╛рди рдШрдЯрдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рд╕реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдПрдХ рдирдИ рд╕реВрдЪреА рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВред  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕реЗрдЯрд╕реНрдЯреИрдЯ () рдкрд░ рдХреЙрд▓ рдПрдХ рдХреЗ рдмрд╛рдж рдПрдХ рдЬрд╛рдПрдЧреАред  рд▓реЗрдХрд┐рди рд╣реИрдВрдбрд▓рд░ рдХреА рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рдкреНрд░рддреАрдХреНрд╖рд┐рдд рдХреАрд╡рд░реНрдб рджреВрд╕рд░реА рд╕реЗрдЯрд╕реНрдЯреИрдЯ () рдХреЙрд▓ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж рд╣реА рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░реЙрдорд┐рд╕ () рд╡рд┐рдзрд┐ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><h2>  рдЪрд░рдг 2. рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рд╕реБрдиреЗрдВ </h2><br>  рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рдореЗрдВ рдПрдХ рдмрдбрд╝рд╛ рджреЛрд╖ рдпрд╣ рд╣реИ рдХрд┐, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдореЗрдВ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИред  рджреВрд╕рд░реЗ, рдпрджрд┐ рдПрдХ рдШрдЯрдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рджреВрд╕рд░реЗ рдШрдЯрдХ рдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рддрдм рддрдХ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд░рд╛рдЬреНрдп рдХреЛ рдлрд┐рд░ рд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред <br><br>  рдЗрд╕рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирдП рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрдирд░ рдШрдЯрдХ рдХреЛ рдкреЗрд╢ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕реЗ рджреЛ рдХрд╛рдо рдХрд░рдиреЗ рджреЗрдВрдЧреЗред  рдпрд╣ рдШрдЯрдХ, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗ рд╕рдХреЗрдЧрд╛ред  рджреВрд╕рд░реЗ, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрдирд░ рдЙрд╕ рдШрдЯрдХ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдиреЗ рдЗрд╕реЗ рдЗрди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдмрдирд╛рдпрд╛ рдерд╛ред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, IndexedDbRepository рдореЗрдВ рд╣реИрдВрдбрд▓рд░реНрд╕ рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдЬреЛрдбрд╝рдирд╛: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexedDbRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>( keyPath ) { <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamp = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> addListener( listener ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.add( listener ); } onChange() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamp++; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.forEach( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">listener</span></span></span><span class="hljs-function"> =&gt;</span></span> listener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamp ) ); } removeListener( listener ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.delete( listener ); } }</code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br>  рд╣рдо рд╣реИрдВрдбрд▓рд░ рдХреЛ рдПрдХ рд╕реНрдЯрд╛рдВрдк рдкрд╛рд╕ рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рд╣рд░ рдХреЙрд▓ рдХреЗ рд╕рд╛рде onChange () рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдЧрд╛ред  рдФрд░ рд╣рдо _tx рд╡рд┐рдзрд┐ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд░реАрдб рд░рд╛рдЗрдЯ рдореЛрдб рдХреЗ рд╕рд╛рде рд▓реЗрдирджреЗрди рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓ рдХреЗ рд▓рд┐рдП onChange <code>onChange()</code> рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдП: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> _tx( txMode, callback ) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.openDatabasePromise; <span class="hljs-comment"><span class="hljs-comment">// await db connection try { const transaction = this.dbConnection.transaction( [ OBJECT_STORE_NAME ], txMode ); const objectStore = transaction.objectStore( OBJECT_STORE_NAME ); return await callback( objectStore ); } finally { if ( txMode === 'readwrite' ) this.onChange(); // notify listeners } }</span></span></code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br>  рдЕрдЧрд░ рд╣рдо рдЕрднреА рднреА <code>then()</code> / <code>catch()</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░реЙрдорд┐рд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдпрд╛ рддреЛ <code>onChange()</code> рдХреЛ рдХреЙрд▓ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдпрд╛ рдкреНрд░реЛрдорд┐рд╕ () рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рдкреЙрд▓реАрдлрд╝рд┐рд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ <code>final()</code> рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, async / рдкреНрд░рддреАрдХреНрд╖рд╛ рдЖрдкрдХреЛ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдФрд░ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдХреЛрдб рдХреЗ рдпрд╣ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред <br><br>  рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрд░реНрди рдШрдЯрдХ рд╕реНрд╡рдпрдВ рдПрдХ рдИрд╡реЗрдВрдЯ рд╢реНрд░реЛрддрд╛ рдХреЛ рдХрдВрдкреЛрдиреЗрдВрдЯрдбрд┐рдорд╛рдЙрдВрдЯ рдФрд░ рдХрдВрдкреЛрдиреЗрдВрдЯрд╡рд┐рд▓рд╛рдЙрдиреНрдорд╛рдЙрдВрдЯ рддрд░реАрдХреЛрдВ рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИ: <br><br><div class="spoiler">  <b class="spoiler_title">рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрдирд░ рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> IndexedDbRepository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./IndexedDbRepository'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryListener</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repositoryStamp</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onChange( repositoryStamp ); } componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentDidUpdate() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentWillUnmount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.unsubscribe(); } subscribe() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { repository } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( repository <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> IndexedDbRepository &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository !== repository ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository.removeListener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener ); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository = repository; repository.addListener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener ); } } unsubscribe( ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository.removeListener( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repositoryListener ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevRepository = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.children || <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } }</code> </pre>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) </div></div><br>  рдЕрдм, рд╣рдо рдЕрдкрдиреЗ рдореБрдЦреНрдп рдШрдЯрдХ рдореЗрдВ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВрдЧреЗ, рдФрд░, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">DRY рд╕рд┐рджреНрдзрд╛рдВрдд рджреНрд╡рд╛рд░рд╛</a> рдирд┐рд░реНрджреЗрд╢рд┐рдд, рд╣рдо <code>handleAdd</code> / <code>handleDelete</code> рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдХреЛрдб рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleAdd = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( newTaskText ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.save( { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleDelete = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>( idToDelete ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.deleteById( idToDelete ); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepositoryChanged = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository.findAll() } ); }; } componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepositoryChanged(); <span class="hljs-comment"><span class="hljs-comment">// initial load }</span></span></code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br>  рдФрд░ рд╣рдо рдХрдиреЗрдХреНрдЯреЗрдб рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрд░реНрди рд╕реЗ рд╣реИрдВрдбреНрд░рд┐рдкреЗрдЯрд░реАрдЪрд╛рд░реНрдЬ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЙрд▓ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ: <br><br><pre> <code class="javascript hljs"> render() { <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleRepoChanged}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.repository}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TaskList</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onAdd</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleAdd}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onDelete</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleDelete}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">tasks</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.tasks}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">; }</span></span></code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br><h2>  рдЪрд░рдг 3. рдбреЗрдЯрд╛ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рдЙрд╕рдХреЗ рдЕрджреНрдпрддрди рдХреЛ рдПрдХ рдЕрд▓рдЧ рдШрдЯрдХ рдореЗрдВ рдирд┐рдХрд╛рд▓реЗрдВ </h2><br>  рд╣рдордиреЗ рдПрдХ рдШрдЯрдХ рд▓рд┐рдЦрд╛ рд╣реИ рдЬреЛ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдбреЗрдЯрд╛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЖрдк 100+ рдШрдЯрдХреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдмрдбрд╝реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ <b>рдкреНрд░рддреНрдпреЗрдХ</b> рдШрдЯрдХ рдЬреЛ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЙрд╕реЗ рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: <br><br><ul><li>  рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рднрдВрдбрд╛рд░ рдПрдХрд▓ рдмрд┐рдВрджреБ рд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ </li><li>  ComponentsDidMount <code>componentDidMount()</code> рд╡рд┐рдзрд┐ рдореЗрдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдбреЗрдЯрд╛ рд▓реЛрдбрд┐рдВрдЧ рдкреНрд░рджрд╛рди рдХрд░реЗрдВ </li><li>  <code>RepositoryListener</code> рдШрдЯрдХ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ, рдЬреЛ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдкреБрдирдГ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВрдбрд▓рд░ рдХреЙрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </li></ul><br>  рдХреНрдпрд╛ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХреНрд░рд┐рдпрд╛рдПрдВ рд╣реИрдВ?  рдРрд╕рд╛ рдирд╣реАрдВ рд▓рдЧрддрд╛ред  рдФрд░ рдЕрдЧрд░ рдХреБрдЫ рднреВрд▓ рдЧрдпрд╛ рд╣реИ?  рдХреЙрдкреА рдкреЗрд╕реНрдЯ рдХреЗ рд╕рд╛рде рдЦреЛ рдЬрд╛рдУ? <br><br>  рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рд╣рдо рдПрдХ рдмрд╛рд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдирд┐рдпрдо рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдФрд░ рдХреБрдЫ рдЬрд╛рджреБрдИ рдЗрди рддрд░реАрдХреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╣рдореЗрдВ рдбреЗрдЯрд╛ рджреЗрддрд╛ рд╣реИ, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдмрджрд▓рддрд╛ рд╣реИ, рдФрд░ рдвреЗрд░ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЗрд╕реЗ рдХрдиреЗрдХреНрдЯ рднреА рдХрд░ рд╕рдХрддрд╛ рд╣реИ рднрдВрдбрд╛рд░ред <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doFindAllTasks = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> repo </span></span></span><span class="hljs-function">) =&gt;</span></span> repo.findAll(); <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> &lt;DataProvider doCalc={ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doFindAllTasks }&gt; {(data) =&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">...   -,   data...</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/DataProvider&gt;</span></span></code> </pre><br>  рдЗрд╕ рдШрдЯрдХ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╣реА рд╕рдордп рд╣реИ рдХрд┐ doFindAllTasks () рд╡рд╛рджрд╛ рд╣реИред  рдЕрдкрдиреЗ рдХрд╛рдо рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдЕрд▓рдЧ рдШрдЯрдХ рдмрдирд╛рдПрдВрдЧреЗ, рдЬреЛ рдПрдХ рдкрд░рд┐рдХрд▓рд┐рдд рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рд╡рдВрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдФрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рджреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ: <br><br><div class="spoiler">  <b class="spoiler_title">PromiseComponent рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PromiseComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentDidUpdate( ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subscribe(); } componentWillUnmount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.unsubscribe(); } subscribe() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { cleanOnPromiseChange, promise } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( promise <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise !== promise ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( cleanOnPromiseChange ) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise = promise; promise.then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise === promise ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, value } ); } } ) .catch( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise === promise ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( { error, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ); } } ); } } unsubscribe( ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prevPromise = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { children, fallback } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { error, value } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( error !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> error; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( value === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> || value === <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fallback || <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> children( value ); } }</code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br></div></div><br>  рдЗрд╕рдХреЗ рддрд░реНрдХ рдФрд░ рдЖрдВрддрд░рд┐рдХ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдпрд╣ рдШрдЯрдХ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрдирд░ рдХреЗ рд╕рдорд╛рди рд╣реИред  рдХреНрдпреЛрдВрдХрд┐ рджреЛрдиреЛрдВ рдПрдХ рдФрд░ рджреВрд╕рд░реЗ рдХреЛ "рд╕рд╛рдЗрди" рдХрд░рдирд╛, рдШрдЯрдирд╛рдУрдВ рдХреЛ "рд╕реБрдирдирд╛" рдФрд░ рдХрд┐рд╕реА рддрд░рд╣ рдЙрдиреНрд╣реЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдФрд░ рдпрд╣ рднреА рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдЬрд┐рдирдХреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдЖрдкрдХреЛ рд╕реБрдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рд╡реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдмрд╣реБрдд рд╣реА рдЬрд╛рджреБрдИ рдШрдЯрдХ DataProvider рдЕрдм рддрдХ рдмрд╣реБрдд рд╕рд░рд▓ рджрд┐рдЦрддрд╛ рд╣реИ: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> repository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./RepositoryHolder'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataProvider</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepoChanged = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forceUpdate(); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleRepoChanged}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{repository}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromiseComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">promise</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.props.doCalc(</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag"> )}&gt;</span></span></span><span class="xml"> {data =&gt; this.props.children( data )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromiseComponent</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } }</code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╣рдордиреЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА (рдФрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рд┐рдВрдЧреНрд▓реЛрдирдЯрди рд░рд┐рдкреЛрдЬрд┐рдЯрд░реАрд╣реЛрд▓реНрдбрд░, рдЬреЛ рдЕрдм рдЖрдпрд╛рдд рдореЗрдВ рд╣реИ) рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛, рдЬрд┐рд╕реЗ doCalc рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╣рдореЗрдВ рдХрд╛рд░реНрдп рдбреЗрдЯрд╛ рдХреЛ рдЗрд╕ .props.children рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛, рдФрд░ рдЗрд╕рд▓рд┐рдП, рдХрд╛рд░реНрдпреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рддреИрдпрд╛рд░ рдХрд░реЗрдВред  рд╕рд┐рдВрдЧрд▓реЗрдВрдЯрди рднреА рд╕рд░рд▓ рджрд┐рдЦрддрд╛ рд╣реИ: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> repository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IndexedDbRepository( <span class="hljs-string"><span class="hljs-string">'id'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> repository;</code> </pre><br>  рдЕрдм DataProvider рдХреЙрд▓ рдХреЗ рд╕рд╛рде рдореБрдЦреНрдп рдХреЙрд▓ рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЙрд▓ рдХреЛ рдмрджрд▓реЗрдВ: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> repository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./RepositoryHolder'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.doFindAllTasks = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repository</span></span></span><span class="hljs-function"> =&gt;</span></span> repository.findAll(); <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;DataProvider doCalc={this.doFindAllTasks} fallback={&lt;&gt;&lt;Spinner animation="border" aria-hidden="true" as="span" role="status" /&gt;&lt;span&gt;  ...&lt;/span&gt;&lt;/&gt;}&gt; { tasks =&gt; &lt;TaskList onAdd={this.handleAdd} onDelete={this.handleDelete} tasks={tasks} /&gt; } &lt;/DataProvider&gt;; } }</code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br>  рдпрд╣ рд░реБрдХ рд╕рдХрддрд╛ рдерд╛ред  рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдирд┐рдХрд▓рд╛: рд╣рдо рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдо рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдПрдХ рдЕрд▓рдЧ рдШрдЯрдХ рдЗрд╕ рдбреЗрдЯрд╛ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдкреНрддрд┐ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЕрджреНрдпрддрди рднреА рдХрд░рддрд╛ рд╣реИред  рд╡рд╕реНрддреБрддрдГ рдЫреЛрдЯреА-рдЫреЛрдЯреА рдмрд╛рддреЗрдВ рдереАрдВ: <br><br><ul><li>  рдкреНрд░рддреНрдпреЗрдХ рдбреЗрдЯрд╛ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП, рдХреЛрдб рдореЗрдВ рдХрд╣реАрдВ (рд▓реЗрдХрд┐рди <code>render()</code> рд╡рд┐рдзрд┐ рдореЗрдВ рдирд╣реАрдВ <code>render()</code> рдЖрдкрдХреЛ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдбреЗрдЯрд╛рдкреНрд░реЛрд╡рд╛рдЗрдбрд░ рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВ </li><li>  DataProvider рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рднрд╛рд╡рдирд╛ рдореЗрдВ рдорд╣рд╛рди рдФрд░ рдХрд╛рдлреА рд╣реИ, рд▓реЗрдХрд┐рди JSX рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ рдмрд╣реБрдд рдмрджрд╕реВрд░рдд рд╣реИред  рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрдИ рдШрдЯрдХ рд╣реИрдВ, рддреЛ рд╡рд┐рднрд┐рдиреНрди DataProviders рдХреЗ рдШреЛрдВрд╕рд▓реЗ рдХреЗ рд╢рд┐рдХрд╛рд░ рдХреЗ рджреЛ рдпрд╛ рддреАрди рд╕реНрддрд░ рдЖрдкрдХреЛ рдмрд╣реБрдд рднреНрд░рдорд┐рдд рдХрд░реЗрдВрдЧреЗред </li><li>  рдпрд╣ рджреБрдЦрдж рд╣реИ рдХрд┐ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдПрдХ рдШрдЯрдХ (рдбреЗрдЯрд╛рдкреНрд░реЛрдЗрдбрд░) рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЙрдирдХрд╛ рдкрд░рд┐рд╡рд░реНрддрди рджреВрд╕рд░реЗ (рдореБрдЦреНрдп рдШрдЯрдХ) рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдореИрдВ рдЙрд╕реА рддрдВрддреНрд░ рдХреЗ рд╕рд╛рде рдЗрд╕рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ред </li></ul><br><h2>  рдЪрд░рдг 4. рдХрдиреЗрдХреНрдЯ () </h2><br>  рд╢реАрд░реНрд╖рдХ рдХреЗ рд╢реАрд░реНрд╖рдХ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛-рд░рд┐рдбреНрдпреВрдХреНрд╕ рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдореИрдВ рдмрд╛рдХреА рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рджреЗрдЧрд╛: рдпрд╣ рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐, рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕рд╛рде рдмрдЪреНрдЪреЛрдВ () рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдбреЗрдЯрд╛рдкреНрд░реЛрд╡рд╛рдЗрдбрд░ рд╕реЗрд╡рд╛ рдШрдЯрдХ рдирд┐рдпрдореЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╣рдорд╛рд░реЗ рдШрдЯрдХ рдХреЗ рдЧреБрдгреЛрдВ рдХреЛ рднрд░ рджреЗрдЧрд╛ред  рдФрд░ рдЕрдЧрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдХреБрдЫ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдмрд╕ рдорд╛рдирдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рддрдВрддреНрд░ рдХреЗ рд╕рд╛рде рдЧреБрдгреЛрдВ рдХреЛ рдмрджрд▓ рджреЗрдЧрд╛ред <br><br>  рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо рд╣рд╛рдпрд░ рдСрд░реНрдбрд░ рдХрдВрдкреЛрдиреЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реИ, рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдПрдХ рдШрдЯрдХ рд╡рд░реНрдЧ рдХреЛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдФрд░, рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдШрдЯрдХ рджреЗрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдп рдЬреЛ рд╣рдо рд▓рд┐рдЦрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реЛрдЧрд╛: <br><br><ul><li>  рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдШрдЯрдХ рд╡рд░реНрдЧ рд▓реЗрдВ рдЬрд╣рд╛рдВ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╣реИ </li><li>  рдирд┐рдпрдореЛрдВ рдХрд╛ рдПрдХ рд╕реЗрдЯ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбреЗрдЯрд╛ рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рдФрд░ рдЗрд╕реЗ рдХрд┐рд╕ рдЧреБрдгреЛрдВ рдореЗрдВ рдбрд╛рд▓реЗрдВ </li><li>  рдЗрд╕рдХреЗ рдЙрдкрдпреЛрдЧ рдореЗрдВ, рдпрд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛-рд░рд┐рдбрдХреНрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ () рдлрд╝рдВрдХреНрд╢рди рдХреЗ</a> рд╕рдорд╛рди рд╣реЛрдЧрд╛ред </li></ul><br>  рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЙрд▓ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapRepoToProps = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repository</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">tasks</span></span>: repository.findAll(), } ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapRepoToActions = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">repository</span></span></span><span class="hljs-function"> =&gt;</span></span> ( { <span class="hljs-attr"><span class="hljs-attr">doAdd</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> newTaskText </span></span></span><span class="hljs-function">) =&gt;</span></span> repository.save( { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: counter(), <span class="hljs-attr"><span class="hljs-attr">text</span></span>: newTaskText } ), <span class="hljs-attr"><span class="hljs-attr">doDelete</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> idToDelete </span></span></span><span class="hljs-function">) =&gt;</span></span> repository.deleteById( idToDelete ), } ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Step4Connected = connect( mapRepoToProps, mapRepoToActions )( Step4 );</code> </pre><br>  рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐рдпрд╛рдБ <code>Step4</code> рдШрдЯрдХ рдХреЗ рдЧреБрдг рдирд╛рдо рдФрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рдиреЛрдВ рдХреЗ рдмреАрдЪ рдореИрдкрд┐рдВрдЧ рдХреЛ <code>Step4</code> рд╣реИрдВред  рдЗрд╕рдХреЗ рдмрд╛рдж рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдореИрдкрд┐рдВрдЧ рдЖрддреА рд╣реИ: рдпрджрд┐ <code>Step4</code> рдШрдЯрдХ рдХреЗ рднреАрддрд░ <code>this.props.doDelete(...)</code> <code>this.props.doAdd(...)</code> рдпрд╛ <code>this.props.doDelete(...)</code> рдХреЛ рдХреЙрд▓ <code>Step4</code> рд╣реИрдВ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ред  рдФрд░ рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐ рд╕рдм рдХреБрдЫ рдПрдХ рд╕рд╛рде рд▓рд╛рддреА рд╣реИ рдФрд░ рдХрдиреЗрдХреНрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рддреА рд╣реИред  рдкрд░рд┐рдгрд╛рдо рдПрдХ рдирдпрд╛ рдШрдЯрдХ рд╣реИ (рдпрд╣реА рд╡рдЬрд╣ рд╣реИ рдХрд┐ рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рд╣рд╛рдпрд░ рдСрд░реНрдбрд░ рдХрдВрдкреЛрдиреЗрдВрдЯ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ)ред  рдФрд░ рд╣рдо рдЕрдм рдореВрд▓ Step4 рдШрдЯрдХ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдирд┐рд░реНрдпрд╛рдд рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдЖрд╡рд░рдг: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step4</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Step4Connected = connect( <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> )( Step4 ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> Step4Connected;</code> </pre><br>  рдФрд░ рдЯрд╛рд╕реНрдХрд▓рд┐рд╕реНрдЯ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХрд╛ рдШрдЯрдХ рдЕрдм рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЖрд╡рд░рдг рдХреА рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Step4</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.tasks === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.tasks === <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? &lt;&gt;&lt;Spinner animation="border" aria-hidden="true" as="span" role="status" /&gt;&lt;span&gt;  ...&lt;/span&gt;&lt;/&gt; : &lt;TaskList onAdd={this.props.doAdd} onDelete={this.props.doDelete} tasks={this.props.tasks} /&gt;; } }</code> </pre><br>  ( <a href="" rel="nofollow">рдЬреАрдереВрдм рд╕реЛрд░реНрд╕ рдХреЛрдб</a> ) <br><br>  рдФрд░ рд╡рд╣ рдпрд╣ рд╣реИред  рдХреЛрдИ рдирд┐рд░реНрдорд╛рддрд╛, рдХреЛрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реИрдВрдбрд▓рд░ рдирд╣реАрдВ - рдШрдЯрдХ рдХреЗ рдкреНрд░реЙрдкрд░ рдореЗрдВ рдХрдиреЗрдХреНрдЯ () рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕рдм рдХреБрдЫ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред <br><br>  рдпрд╣ рджреЗрдЦрдирд╛ рдмрд╛рдХреА рд╣реИ рдХрд┐ рдХрдиреЗрдХреНрдЯ () рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреИрд╕реЗ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><div class="spoiler">  <b class="spoiler_title">рдХрдиреЗрдХреНрдЯ () рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> repository <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./RepositoryHolder'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Connected</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>( ...arguments ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleRepoChanged = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forceUpdate(); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { childClass, childProps, mapRepoToProps, mapRepoToActions } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> promises = mapRepoToProps( repository, childProps ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actions = mapRepoToActions( repository, childProps ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleRepoChanged}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">repository</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{repository}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromisesComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">promises</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{promises}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { values =&gt; React.createElement( childClass, { ...childProps, ...values, ...actions, } )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">PromisesComponent</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">RepositoryListener</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> mapRepoToProps, mapRepoToActions </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">childClass</span></span></span><span class="hljs-function"> =&gt;</span></span> props =&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Connected</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">childClass</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{childClass}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">childProps</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mapRepoToActions</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mapRepoToActions}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mapRepoToProps</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mapRepoToProps}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; }</span></span></code> </pre>  ( <a href="" rel="nofollow">рдЬреАрдереБрдм рд╕реНрд░реЛрдд рдХреЛрдб</a> ) </div></div><br>  рдХреЛрдб рднреА рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд▓рдЧрддрд╛ рд╣реИ ... рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрджрд┐ рдЖрдк рдбрд╛рдЗрд╡рд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рд╡рд╛рд▓ рдЙрдареЗрдВрдЧреЗред  рдЖрдкрдХреЛ рдЕрдВрдд рд╕реЗ рдкрдврд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред  рдпрд╣ рд╡рд╣рд╛рдБ рд╣реИ рдХрд┐ <code>connect()</code> рдлрд╝рдВрдХреНрд╢рди рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИред  рдпрд╣ рджреЛ рдкреИрд░рд╛рдореАрдЯрд░ рд▓реЗрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╡рд╛рдкрд╕ рд▓реМрдЯрддрд╛ рд╣реИ ... рдлрд┐рд░ рд╕реЗ рдПрдХ рдлрд╝рдВрдХреНрд╢рди?  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдирд╣реАрдВред  <code>props =&gt; &lt;Connected...</code> рдХрд╛ рдЕрдВрддрд┐рдо рдирд┐рд░реНрдорд╛рдг <code>props =&gt; &lt;Connected...</code> рди рдХреЗрд╡рд▓ рдПрдХ рдлрд╝рдВрдХреНрд╢рди, рдмрд▓реНрдХрд┐ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдШрдЯрдХ рджреЗрддрд╛ рд╣реИ</a> ред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЬрдм рд╣рдо рдПрдХ рдкреЗрдбрд╝ рдореЗрдВ рдХрдиреЗрдХреНрдЯреЗрдбрд╕реНрдЯреЗрдк 4 рдХреЛ рдПрдореНрдмреЗрдб рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛: </font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореВрд▓ -&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдирд╛рдо рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдШрдЯрдХ -&gt; рдХрдиреЗрдХреНрдЯ -&gt; рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рд▓рд┐рд╕реНрдЯрдирд░ -&gt; рдкреНрд░реЛрдорд┐рд╕рдХрдВрдкреЛрдиреЗрдВрдЯ -&gt; рд╕реНрдЯреЗрдк 4</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 рдЗрдВрдЯрд░рдореАрдбрд┐рдПрдЯ рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдХрдИ, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдЕрдкрдирд╛ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред рдПрдХ рдЕрдирд╛рдо рдШрдЯрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рджрд┐рдП рдЧрдП рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>connect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдиреЗрд╕реНрдЯреЗрдб рдШрдЯрдХ рдХрд╛ рд╡рд░реНрдЧ, рдЧреБрдг рдЬреЛ рдШрдЯрдХ рдХреЛ рддрдм рд╣реА рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм (рдкреНрд░реЙрдореНрдкреНрд╕) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдШрдЯрдХ рдХреЛ рдкрд╛рд╕ рдХрд░ рджреЗрддрд╛ рд╣реИ </font></font><code>Connect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдШрдЯрдХ </font></font><code>Connect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рд░рд┐рдд рдорд╛рдкрджрдВрдбреЛрдВ </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдкрдВрдХреНрддрд┐ рдХреБрдВрдЬрд┐рдпреЛрдВ рдФрд░ рд╡рд╛рджрд╛ рдореВрд▓реНрдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд╡рд╕реНрддреБ) </font><font style="vertical-align: inherit;">рд╕реЗ рдПрдХ рд╕реЗрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><code>PromisesComponent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореВрд▓реНрдпреЛрдВ рдХреА рдЧрдгрдирд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рдХрдиреЗрдХреНрдЯ рдШрдЯрдХ рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬ рд░рд╣рд╛ рд╣реИ, рдЬреЛ рдореВрд▓ рд╣рд╕реНрддрд╛рдВрддрд░рд┐рдд рдЧреБрдгреЛрдВ (рдкреНрд░реЙрдкреНрд╕), рдкрд░рд┐рдХрд▓рд┐рдд рдЧреБрдгреЛрдВ (рдореВрд▓реНрдпреЛрдВ) рдФрд░ рдЧреБрдг-рдХреНрд░рд┐рдпрд╛рдУрдВ (рдХреНрд░рд┐рдпрд╛рдУрдВ) рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ рдЙрдиреНрд╣реЗрдВ рдШрдЯрдХ </font></font><code>Step4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдПрдХ рдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ </font></font><code>React.createElement(...)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рддрдХ </font><font style="vertical-align: inherit;">рдкрд╣реБрдВрдЪрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЦреИрд░, рдШрдЯрдХ</font></font><code>RepositoryListener</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдШрдЯрдХ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдЕрдЧрд░ рдХреБрдЫ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ рддреЛ рдкреНрд░реЙрдорд┐рд╕ рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирддреАрдЬрддрди, рдпрджрд┐ рдХреЛрдИ рднреА рдШрдЯрдХ рдЗрдВрдбреЗрдХреНрд╕рдбрдм рд╕реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЙрд╕рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛ рдХрд┐ рд╡рд╣ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЬреЛрдбрд╝реЗ, </font></font><code>connect()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдФрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдЧреБрдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдмреАрдЪ рдореИрдкрд┐рдВрдЧ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ, рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рд┐рд░рджрд░реНрдж рдХреЗ рдХрд░реЗрдВред</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд░рдг 5. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ vlsergey / react-indexdb-repo</font></font></a> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, рд╣рдо рдпрд╣ рд╕рдм рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЕрдиреНрдп рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЗрд╕реЗ рдЕрдкрдиреА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдХрджрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдерд╛:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рдЗрдмреНрд░реЗрд░реА </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ vlsergey / рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛-рд╡рд╛рджрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдпрд╛рдж рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рде PromiseComponent рдФрд░ PromisesComponent рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди (рддрд╛рдХрд┐ рдкрд░рд┐рд╡рд░реНрддрди рд╣рдорд╛рд░реЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рди рд╣реЛрдВ) UI "рдЯреНрд╡рд┐рдЪ" рдХрдо</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рдЗрдмреНрд░реЗрд░реА </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ vlsergey / рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛-indexdb-рд░реЗрдкреЛ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди IndexedDbRepository, рдХрдиреЗрдХреНрдЯ () рдФрд░ рдХреБрдЫ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╡рд░реНрдЧреЛрдВ рдореЗрдВ рдХрд╛рд░реНрдп</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯрд╛рд╕реНрдХ рд▓рд┐рд╕реНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг</font></font></a> </li></ul><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд┐рд╕реА рдирд┐рд╖реНрдХрд░реНрд╖ рдХреЗ рдмрдЬрд╛рдп: рдХреНрдпрд╛ рдмрдЪрд╛ рд╣реИ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рдФрджреНрдпреЛрдЧрд┐рдХ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА, рд╕реАрдорд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдордд рднреВрд▓рдирд╛:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрд╢рд╛ рдмрджрд▓рддреЗ рдЧреБрдгреЛрдВ рд╕реЗ рдирдП рд╡рд╛рджреЗ рдирд╣реАрдВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рд╕рдВрд╕реНрдорд░рдг рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдзреНрд╡рдЬ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рд╡рд╣ рдЬрдЧрд╣ рд╣реИ рдЬрд╣рд╛рдБ IndexedDbRepository рд╕реЗ рд╕реНрдЯрд╛рдореНрдк рдХрд╛рдо рдореЗрдВ рдЖрддрд╛ рд╣реИ (рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреБрдЫ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЛрдб рдмреЗрдорд╛рдиреА рд▓рдЧ рд░рд╣рд╛ рдерд╛)ред</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдпрд╛рдд рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднрдВрдбрд╛рд░ рдХреЛ рдЬреЛрдбрд╝рдирд╛, рднрд▓реЗ рд╣реА рдПрдХ рд╣реА рд╕реНрдерд╛рди рдкрд░ рд╣реЛ, рдЧрд▓рдд рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдВрджрд░реНрднреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдУрд░ рджреЗрдЦрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред</font></font></li><li>     ,     IndexedDB      . </li><li>            :     .     .   IndexDB      ┬л┬╗   ,    тАФ       . </li><li>  ,  IndexDB    Redux Storage.      IndexDB    ,            . </li></ul><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">Online-</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi472246/">https://habr.com/ru/post/hi472246/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi472230/index.html">рдПрдордПрд▓ рдХреЗ рд▓рд┐рдП рдЪрд┐рдкреНрд╕ - рдирдП рдЙрддреНрдкрд╛рджреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi472232/index.html">ZX-Poly рдХреЗ рд▓рд┐рдП "рдХрд▓рд░ рдПрдХреНрд╕рдЯреЗрдВрдбрд░ рд╕реЗ ZX- рд╕реНрдкреЗрдХреНрдЯреНрд░рдо"</a></li>
<li><a href="../hi472234/index.html">Cryptocurrency: рдХреНрдпрд╛ рдпрд╣ рдЕрднреА рднреА рдПрдХ рдлреНрд░реАрд▓рд╛рдбрд░, рдпрд╛ рдПрдХ рд╕рд╛рдереА рд╣реИ?</a></li>
<li><a href="../hi472240/index.html">Gamification рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред рдпрд╣ рдХреНрдпрд╛ рд╣реИ, рдХреНрдпреЛрдВ рдФрд░ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ? рдбреЗрд╡рд▓рдкрд░ рджреЗрдЦреЛ</a></li>
<li><a href="../hi472242/index.html">рд╣рдордиреЗ рджрд╕ рдмрд╛рд░ рдЯреЛрдХрд┐рдпреЛ рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЛ рддреЗрдЬ рдХрд┐рдпрд╛ рд╣реИ</a></li>
<li><a href="../hi472248/index.html">рд╣рдордиреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЖрдИрдЯреА-рдкреНрд▓реИрдиреЗрдЯ рдлрд╝рд╛рдЗрдирд▓ рдХрд╛ рд╡рд┐рд▓рдп рдХреИрд╕реЗ рдХрд┐рдпрд╛</a></li>
<li><a href="../hi472252/index.html">21 рд╕реЗ 28 рдЕрдХреНрдЯреВрдмрд░ рддрдХ рдорд╛рд╕реНрдХреЛ рдореЗрдВ рдбрд┐рдЬрд┐рдЯрд▓ рдХрд╛рд░реНрдпрдХреНрд░рдо</a></li>
<li><a href="../hi472254/index.html">21 рд╕реЗ 28 рдЕрдХреНрдЯреВрдмрд░ рддрдХ рд╕реЗрдВрдЯ рдкреАрдЯрд░реНрд╕рдмрд░реНрдЧ рдореЗрдВ рдбрд┐рдЬрд┐рдЯрд▓ рдХрд╛рд░реНрдпрдХреНрд░рдо</a></li>
<li><a href="../hi472258/index.html">"рд╕реАрдЦрдирд╛ рдХреИрд╕реЗ рд╕реАрдЦреЗрдВ" - рдорд╛рдЗрдВрдбрдлреБрд▓рдиреЗрд╕ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░реЗрдВ</a></li>
<li><a href="../hi472262/index.html">рдореЛрдмрд╛рдЗрд▓ # 318 рдбреЗрд╡рд▓рдкрд░ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрд╛рдЪрди (14 рдЕрдХреНрдЯреВрдмрд░ рдХреЛ)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>