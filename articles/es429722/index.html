<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèº üçî üö¥üèª C√≥mo realizamos el pago a trav√©s de Google Pay en Yandex.Cash [actualizado] üéí üòã üö∂üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cuando Google Pay apareci√≥ por primera vez en Rusia, abr√≠ una cuenta, agregu√© una tarjeta all√≠ y me di cuenta de que no pod√≠a hacer nada m√°s. No hab√≠a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo realizamos el pago a trav√©s de Google Pay en Yandex.Cash [actualizado]</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yamoney/blog/429722/"><p><img src="https://habrastorage.org/webt/6k/db/_a/6kdb_a7azfmyavd09vcd4zgd0sy.gif"></p><br><p>  Cuando Google Pay apareci√≥ por primera vez en Rusia, abr√≠ una cuenta, agregu√© una tarjeta all√≠ y me di cuenta de que no pod√≠a hacer nada m√°s.  No hab√≠a NFC en mi tel√©fono, tampoco hab√≠a nada que pagar en Internet, bueno, est√° bien, no me molesta.  Al final, siempre fue posible extraer d√≠gitos de la tarjeta con las manos o extraerlos del almac√©n de contrase√±as del navegador. </p><br><p>  Luego vi c√≥mo las diferentes personas que hac√≠an cola frente a m√≠ pagaban con un tel√©fono inteligente;  luego vi anuncios y descuentos por usar Google Pay en todas partes, pero a√∫n as√≠ no pod√≠a aprovecharlo: segu√≠ con un tel√©fono sin NFC. </p><br><p>  Y ahora ha llegado.  Ahora puedo pagar a trav√©s de Google Pay desde cualquier dispositivo en sitios que est√©n conectados a Yandex.Cash (y hay muchos de ellos).  Te dir√© c√≥mo sucedi√≥ y qu√© problemas t√©cnicos tuvieron que resolver nuestros desarrolladores;  Hay muchas cosas interesantes en el frente y en el backend. </p><a name="habracut"></a><br><h2 id="prosto-dobav-api">  Solo agrega API </h2><br><p>  "Compa√±eros desarrolladores, ¬øqu√© fue tan dif√≠cil?" <br>  - S√≠, acabamos de agregar una biblioteca de Google en sus muelles. </p><br><p>  Este fue el primer minuto de mi conversaci√≥n acerca de agregar Google Pay con los desarrolladores del cajero (incluyendo 55 segundos de silencio inc√≥modo).  Pero luego no me sorprendi√≥, y descubrimos algunas cosas interesantes. </p><br><h2 id="google-pay-menyaet-process-oplaty-kartoy">  Google Pay cambia el proceso de pago con tarjeta </h2><br><p>  Ahora, a trav√©s del Cajero, puede pagar con cualquier tarjeta de cr√©dito, incluso en el extranjero.  Al igual que cualquier pago con tarjeta en l√≠nea, no siempre es conveniente: a veces debe ir a su billetera, manejar n√∫meros en la oscuridad y verificar que nada se estropee en ning√∫n lado.  Para hacer la vida m√°s f√°cil, puede iniciar sesi√≥n en Yandex y pagar con tarjetas atadas. </p><br><p>  Implementamos un esquema en el cual los pagos con tarjeta a trav√©s del Cajero se unificaron y se documentaron bien.  Si elimina todas las complejidades del enrutamiento y los matices de seguridad, el esquema se ve as√≠: </p><br><ol><li>  El usuario selecciona los productos, realiza un pedido y cambia al formulario de pago Yandex.Cash.  All√≠ puede ingresar los detalles de cualquier tarjeta o iniciar sesi√≥n en Yandex para ver tambi√©n sus tarjetas vinculadas. </li><li>  Los datos sobre el m√©todo de pago seleccionado se env√≠an al back-end para la tokenizaci√≥n.  El navegador recibe el token de la tarjeta e intenta usarlo para el pago. </li><li>  Si todo est√° en orden, el backend le pide al banco que bloquee el monto de la tarjeta, realiza un pago y devuelve su estado.  En base a esto, el navegador redirige a la p√°gina de √©xito o muestra un mensaje de error. </li></ol><br><p>  En diferentes etapas, existen diferentes condiciones para finalizar el proceso (tokens no v√°lidos, cuentas vac√≠as o desconectar Internet), pero la l√≥gica sigue siendo la misma.  Y en este caso, puede renderizar completamente la p√°gina en el servidor, pero discutiremos las dificultades con esto a continuaci√≥n. </p><br><p>  Para Google Pay, necesita algunos pasos intermedios m√°s. </p><br><p> En primer lugar, entre elegir un m√©todo de pago y la tokenizaci√≥n hay una llamada a la API de Google; esto es necesario para verificar si el dispositivo admite pagos a trav√©s de Google Pay.  Despu√©s de hacer clic en el bot√≥n "Pagar", aparece la interfaz web de Google Pay, donde el usuario inicia sesi√≥n, selecciona una de las tarjetas agregadas o ingresa los detalles de una nueva tarjeta. </p><br><p>  En segundo lugar, hay otro c√≠rculo de seguridad de Google.  El navegador no recibe los detalles directamente; recibe un criptograma que, a su vez, va al backend para la tokenizaci√≥n.  All√≠ se descifra con claves de Google, y luego vea el paso 3. </p><br><p>  Naturalmente, cada paso adicional (incluso siguiendo estrictamente la documentaci√≥n) es un tiempo adicional de desarrollo y prueba.  Es a√∫n m√°s agradable que el comerciante no tenga que hacer pr√°cticamente nada: es f√°cil conectar pagos a trav√©s de Google Pay a cualquier sitio que tenga un formulario de pago Yandex.Cash.  Los detalles se encuentran <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el sitio web del Cajero</a> . </p><br><p>  Tambi√©n se encontr√≥ una historia interesante en la interfaz: se trata de b√∫squeda creativa, evidencia y UX. </p><br><h2 id="knopka-google-pay-na-platyozhnoy-stranice">  Bot√≥n Google Pay en una p√°gina de pago </h2><br><p>  La p√°gina de pago del cajero est√° completamente ensamblada en el servidor: recibe datos del servidor, lo ejecuta a trav√©s del motor de plantillas y le proporciona al navegador c√≥digos HTML, CSS y JavaScript listos.  Por lo tanto, la p√°gina se dibuja m√°s r√°pido, cuando todos los datos est√°n listos y todo el contenido din√°mico funciona a trav√©s de JS en el cliente. </p><br><p>  La dificultad es que solo es posible determinar si la cuenta de Google del cliente ha agregado medios de pago a trav√©s de la biblioteca del cliente de Google.  Por lo tanto, la l√≥gica que dibuja parte de la p√°gina con el bot√≥n de pago tuvo que implementarse en el cliente.  La soluci√≥n t√©cnica se encontr√≥ despu√©s de una breve b√∫squeda. </p><br><p>  En el backend, debe verificar si la tienda ha habilitado el pago a trav√©s de Google Pay; si es as√≠, en el motor de plantillas agregamos el enlace CDN a la biblioteca de Google Pay a la p√°gina y le damos al navegador una se√±al de que necesita descargar datos utilizando este m√©todo de pago. </p><br><p>  En el cliente, debe verificar si hay una se√±al necesaria, y si es as√≠, llamar al m√©todo de verificaci√≥n si los pagos a trav√©s de Google Pay son compatibles con este dispositivo.  Si todo est√° bien, le mostramos al usuario otro bot√≥n.  Como resultado, la p√°gina todav√≠a se representa en el servidor, pero ahora estamos haciendo un par de solicitudes adicionales a otro servicio. </p><br><p>  Simplemente result√≥ que este servicio a veces no responde. </p><br><h2 id="celyy-mesyac-ni-edinogo-razryva">  ¬°Un mes entero, ni un solo descanso! </h2><br><p>  Esta historia trata sobre nuestro departamento de UX: c√≥mo buscaban una forma de dibujar un bot√≥n de Google Pay, pero al mismo tiempo no interferir con la interacci√≥n del usuario con el formulario. </p><br><p>  El primer pensamiento es colgar el giro en toda la p√°gina y esperar una respuesta de Google. <br><img src="https://habrastorage.org/webt/3-/s4/qq/3-s4qqcc8uhnu3ixhm5zauw5mvi.gif"></p><br><p>  Pero si espera una respuesta de Google, entonces no tiene sentido el procesamiento del servidor (el usuario a√∫n no puede interactuar con la p√°gina hasta que obtengamos los datos del cliente), y comenzamos a depender de un servicio de terceros.  Si hay un problema con Internet, Google est√° bloqueado o es inaccesible, entonces el usuario no podr√° usar la p√°gina, aunque nada le impide ingresar el n√∫mero de tarjeta. </p><br><p>  Los dise√±adores hicieron varias opciones m√°s, pero por varias razones no encajaron, y los requisitos para los dise√±os cambiaron gradualmente. <br><img src="https://habrastorage.org/webt/ze/v1/h2/zev1h24kwsmdjprhdvfal-wrruc.gif"><br>  <em>Tiempos de aproximaci√≥n</em> </p><br><p><img src="https://habrastorage.org/webt/ex/e9/lv/exe9lvhkdomxaje4sjrbzfi8v84.gif"><br>  <em>Enfoque dos</em> </p><br><p>  Como resultado, hab√≠a tres requisitos principales: </p><br><ol><li>  El usuario debe poder pagar independientemente de si el servicio de terceros responder√° y durante cu√°nto tiempo lo har√°.  El servicio no deber√≠a ser m√°s lento. </li><li>  Necesita escalabilidad.  Cuando se agrega el pago de Apple o Samsung, esto no deber√≠a afectar la velocidad y la capacidad de trabajar con los campos de entrada de una tarjeta bancaria. </li><li>  La soluci√≥n no deber√≠a tener demasiada animaci√≥n / din√°mica.  Si el usuario comienza a ingresar datos, y en este momento se carga el bot√≥n Google Pay y algo cambia, es posible que el usuario no entienda qu√© sucedi√≥ y por qu√©. </li></ol><br><p>  En base a ellos, apareci√≥ el dise√±o final del formulario de pago.  Organiz√≥ seg√∫n todos los criterios: escalable, no bloquea la entrada de una tarjeta bancaria, y al recibir datos de la tarjeta bancaria no hay animaci√≥n innecesaria. </p><br><p><img src="https://habrastorage.org/webt/6k/db/_a/6kdb_a7azfmyavd09vcd4zgd0sy.gif"></p><br><h2 id="a-chto-tam-so-smartfonami-bez-nfc">  ¬øQu√© pasa con los tel√©fonos inteligentes sin NFC? </h2><br><p>  Para el pago a trav√©s de Google Pay en tiendas sin conexi√≥n, todav√≠a se necesita NFC, no hay opciones. </p><br><p>  NFC no es necesario en l√≠nea.  Todos los navegadores de escritorio funcionan bien con Google Pay.  Hay algunos matices con los tel√©fonos inteligentes: Google tiene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">varios requisitos</a> para un dispositivo con Google Pay.  Aqu√≠ hay una lista de lo que no est√° permitido: </p><br><ol><li>  Use un tel√©fono con Android 4.4.3 o anterior; </li><li>  Instalar la versi√≥n de Android para desarrolladores; </li><li>  Hacer root, desbloquear el gestor de arranque o instalar firmware no oficial; </li><li>  Utilice Samsung MyKnox; </li><li>  Use un dispositivo de Google no verificado. </li></ol><br><p>  En otros casos, los pagos a trav√©s de Google Pay en Internet deber√≠an funcionar bien, pero, probablemente, nadie conoce todas las excepciones. </p><br><h3 id="surovye-biznes-vyvody-esli-vy-uzhe-polzuetes-yandekskassoy">  Conclusiones comerciales dif√≠ciles si ya usa Yandex.Cash </h3><br><p>  Para permitir la aceptaci√≥n de pagos a trav√©s de Google Pay, escriba al administrador de su cuenta.  Despu√©s de un tiempo, el bot√≥n aparecer√° por s√≠ solo, y puede pasar el tiempo de los desarrolladores en otra cosa. </p><br><p>  La conversi√≥n aumentar√°: seg√∫n un estudio de Mediascope, el 36,3% de los usuarios pagan sin contacto.  La propia investigaci√≥n de Yandex.Money mostr√≥ que el 43% de los titulares de tarjetas los usan para pagos sin contacto.  Adem√°s, hay bastantes personas con Android entre los usuarios de Android: no necesitar√°n ingresar el c√≥digo de seguridad 3-D. <br></p><br><h3 id="surovye-biznes-vyvody-esli-vy-eschyo-ne-polzuetes-yandekskassoy">  Conclusiones comerciales dif√≠ciles, si a√∫n no est√° utilizando Yandex.Cash </h3><br><p>  Con√©ctese con urgencia, ¬øpor qu√© sacar algo? </p><br><p>  <strong>Otras historias sobre lo que es bueno en Kassa</strong> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Diez personas en 90 mil sitios: c√≥mo no volverse loco</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estoy cansado de aceptar pagos a trav√©s de WebView.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Que hago</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo protegemos las rese√±as, compras y viajes de los estafadores</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es429722/">https://habr.com/ru/post/es429722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429712/index.html">Introducci√≥n a React Hooks</a></li>
<li><a href="../es429714/index.html">¬øM√°s f√°cil que MQTT? MQTT / UDP</a></li>
<li><a href="../es429716/index.html">Los 5 mejores juegos de PC para aprender ingl√©s</a></li>
<li><a href="../es429718/index.html">¬°Quiero todo de una vez! Estudiamos el RAM HyperX Predator DDR4 RGB, con una frecuencia de 4000 MHz</a></li>
<li><a href="../es429720/index.html">C√≥mo un desarrollador novato para sobrevivir en una entrevista y no volverse loco en el trabajo</a></li>
<li><a href="../es429724/index.html">Revisi√≥n √∫til 28 libros que influyeron en mi pensamiento, inspiraron o mejoraron</a></li>
<li><a href="../es429728/index.html">Arquitectura moderna de MVI basada en Kotlin</a></li>
<li><a href="../es429732/index.html">Vas a odiar esto o una historia sobre lo bien que deber√≠a verse el c√≥digo</a></li>
<li><a href="../es429734/index.html">El sue√±o de volar con un sesgo el√©ctrico.</a></li>
<li><a href="../es429736/index.html">Hogweed de Sosnowski. En MO introdujo multas por distribuci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>