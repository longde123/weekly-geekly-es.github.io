<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЪК ЁЯУ╜я╕П ЁЯСРЁЯП╗ рдпреВрдирд┐рдЯреА 3 рдбреА рдХреЗ рд▓рд┐рдП рд╡рд┐рдЬреБрдЕрд▓ рд▓реЙрдЬрд┐рдХ рдПрдбрд┐рдЯрд░ред рднрд╛рдЧ реи тШЭЁЯП┐ ЁЯд╣ЁЯП╗ ЁЯЦЦ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкрд░рд┐рдЪрдп 
 рдирдорд╕реНрдХрд╛рд░ рдкреНрд░рд┐рдп рдкрд╛рдардХреЛрдВ, рдЖрдЬ рдХреЗ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдпреВрдирд┐рдЯреА 3 рдбреА рдХреЗ рд▓рд┐рдП рд╡рд┐рдЬреБрдЕрд▓ рд▓реЙрдЬрд┐рдХ рдПрдбрд┐рдЯрд░ рдХреЗ рдХрд░реНрдиреЗрд▓ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЗ рд╡рд┐рд╖рдп рдкрд░ рдкреНрд░рдХрд╛рд╢ рдбрд╛рд▓рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ ред рдпрд╣ рд╢реНрд░реГ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдпреВрдирд┐рдЯреА 3 рдбреА рдХреЗ рд▓рд┐рдП рд╡рд┐рдЬреБрдЕрд▓ рд▓реЙрдЬрд┐рдХ рдПрдбрд┐рдЯрд░ред рднрд╛рдЧ реи</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466187/"><h2>  рдкрд░рд┐рдЪрдп </h2><br>  рдирдорд╕реНрдХрд╛рд░ рдкреНрд░рд┐рдп рдкрд╛рдардХреЛрдВ, рдЖрдЬ рдХреЗ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ <b>рдпреВрдирд┐рдЯреА 3 рдбреА рдХреЗ</b> рд▓рд┐рдП рд╡рд┐рдЬреБрдЕрд▓ рд▓реЙрдЬрд┐рдХ рдПрдбрд┐рдЯрд░ рдХреЗ рдХрд░реНрдиреЗрд▓ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЗ рд╡рд┐рд╖рдп рдкрд░ рдкреНрд░рдХрд╛рд╢ <b>рдбрд╛рд▓рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛</b> ред  рдпрд╣ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рджреВрд╕рд░рд╛ рднрд╛рдЧ рд╣реИред  рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдБ</a> рдкрд┐рдЫрд▓реЗ рдПрдХ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред  рддреЛ рд╣рдо рдХрд┐рд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗ?  рд╡рд┐рдЬрд╝реБрдЕрд▓ рдПрдбрд┐рдЯрд░ рдХреЛрд░ рдХреЛрд░ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рд▓реЙрдЬрд┐рдХ рдбреЗрдЯрд╛ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ, рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдмрджрд▓реЗ рдореЗрдВ, рдХрд░реНрдиреЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, <b>ScriptableObject</b> , рддрд░реНрдХ рдШрдЯрдХреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдзрд╛рд░ рд╡рд░реНрдЧ рдХреЗ рд░реВрдк рдореЗрдВред  рдЖрдЗрдП рдЗрди рд╕рднреА рдкрд╣рд▓реБрдУрдВ рдкрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред <br><br>  рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рд▓реЗрдЦ: <br><br>  тЖТ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпреВрдирд┐рдЯреА 3 рдбреА рдХреЗ рд▓рд┐рдП рд╡рд┐рдЬреБрдЕрд▓ рд▓реЙрдЬрд┐рдХ рдПрдбрд┐рдЯрд░ред</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 1</a> <br><a name="habracut"></a><br><h2>  ScriptableObject рдХреНрдпреЛрдВ рд╣реИ? </h2><br>  рд╡рд┐рдХрд╛рд╕ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдореИрдВрдиреЗ рдПрдХ рд▓рдВрдмреЗ рд╕рдордп рдХреЗ рд▓рд┐рдП рд╕реЛрдЪрд╛ рдерд╛ рдХрд┐ рдЖрд╕рдкрд╛рд╕ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИред  рдкрд╣рд▓реЗ рд░реВрдк рдореЗрдВ - рдпрд╣ <b>рдореЛрдиреЛрд╣реЗрд╡рд┐рдпрд░</b> рдерд╛, рд▓реЗрдХрд┐рди рдореБрдЭреЗ рдЗрд╕ рд╡рд┐рдЪрд╛рд░ рдХреЛ рдЫреЛрдбрд╝рдирд╛ рдкрдбрд╝рд╛, рдХреНрдпреЛрдВрдХрд┐ рдЗрди рд▓рд┐рдкрд┐рдпреЛрдВ рдХреЛ <b>рдЧреЗрдордСрдмрдЬреЗрдХреНрдЯ</b> рдкрд░ рдШрдЯрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд▓рдЯрдХрд╛ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЕрдЧрд▓рд╛ рдЪрд░рдг рдЖрдкрдХреА рдЕрдкрдиреА рдХрдХреНрд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдерд╛, рдЬреЛ <b>рдпреВрдирд┐рдЯреАрдЬрд╛рдЗрди рдХрд╛</b> рд╡рдВрд╢рдЬ рдирд╣реАрдВ рд╣реИред <b>рд╡рд┐рд╢реЗрд╖рдг</b> ред  рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рдХрд▓реНрдк рдЬрдбрд╝ рдирд╣реАрдВ рд▓реЗрддрд╛ рдерд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдХрд╛рдлреА рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд╕рд╛рде рдШрд╕реАрдЯрд╛ рдЧрдпрд╛, рдЗрд╕рдХреЗ рдзрд╛рд░рд╛рд╡рд╛рд╣рд┐рдХ, рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░, рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣рдХрд░реНрддрд╛, рдЖрджрд┐ рдХреЛ рд▓рд┐рдЦрддреЗ рд╣реБрдП, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдПрдХрдорд╛рддреНрд░ рдЙрдЪрд┐рдд рддрд░реАрдХрд╛ рдерд╛ <b>рд╕реНрдХреНрд░рд┐рдкреНрдЯреЗрдмрд▓</b> <b>рдСрдмрдЬреЗрдХреНрдЯ</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рдЬрд┐рд╕рдХрд╛ рдЬреАрд╡рди рдЪрдХреНрд░ <b>рдореЛрдиреЛрдмреЗрд╣реЗрд╡рд┐рдпрд░ рдХреЗ</b> рд╕рдорд╛рди рд╣реИ, рдпрджрд┐ рдирд┐рд░реНрдорд╛рдг <b>рдЬрдм</b> рдЕрдиреБрдкреНрд░рдпреЛрдЧ <b>ScriptableObject.CreateInstance рдХреЗ</b> рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрд╕ рдореБрджреНрджреЗ рдХреЛ <b>JsonUtility</b> (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЕрдм рдпрд╣ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИ) рдФрд░ <b>рдПрдХрддрд╛</b> рдирд┐рд░реАрдХреНрд╖рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><h2>  рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ </h2><br>  рдиреАрдЪреЗ рдПрдХ рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рдЖрд░реЗрдЦ рд╣реИ рдЬрд┐рд╕рдореЗрдВ <b>uViLEd</b> рдХреЛрд░ <b>рд╢рд╛рдорд┐рд▓ рд╣реИ</b> ред <br><br><img src="https://habrastorage.org/webt/xd/o-/kp/xdo-kp-skmrrvbfw0jy33l3r02o.png" alt="рдЫрд╡рд┐"><br><br>  рдЖрдЗрдП рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдкрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред <br><br><h3>  рдирд┐рдпрдВрддреНрд░рдХ </h3><br>  рдирд┐рдпрдВрддреНрд░рдХ рдХрд░реНрдиреЗрд▓ рдХрд╛ рдореБрдЦреНрдп рддрддреНрд╡ рд╣реИ, рдЬреЛ рдПрдХ <b>рдореЛрдиреЛрдмреАрд╡рд░</b> рд╕реНрдХреНрд░рд┐рдкреНрдЯ (рдкреВрд░реЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ) рд╣реИред  рдирд┐рдпрдВрддреНрд░рдХ рд╡рд░реНрдЧ рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рд╣реИ рдФрд░ рддрд░реНрдХ рдХреЗ рд╕рднреА рдШрдЯрдХреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реБрд▓рдн рд╣реИред  рдпрд╣ рд╡рд░реНрдЧ рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ: <br><br><ol><li>  рд╕реНрдЯреЛрд░реНрд╕ <b>рдпреВрдирд┐рдЯреА</b> рдСрдмреНрдЬреЗрдХреНрдЯ рд▓рд┐рдВрдХ </li><li>  рджреГрд╢реНрдп рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рддрд░реНрдХ рджреЗрддрд╛ рд╣реИ </li><li>  рдмрд╛рд╣рд░реА рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рддрд░реНрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ </li><li>  рдШрдЯрдХреЛрдВ рдореЗрдВ <b>рдореЛрдиреЛ</b> рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </li></ol><br><div class="spoiler">  <b class="spoiler_title">рдирд┐рдпрдВрддреНрд░рдХ рд╡рд░реНрдЧ рдЖрдзрд╛рд░ рдХреЛрдб</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicController</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> LogicController _instance; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> LogicController Instance { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { _instance = _instance ?? FindObjectOfType&lt;LogicController&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _instance; } } [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SceneLogicData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TextAsset BinaryData =&gt; _data; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Id =&gt; _id; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _id; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextAsset _data; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SceneLogicData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, TextAsset binaryData</span></span></span><span class="hljs-function">)</span></span> { _id = id; _data = binaryData; Name = name; } } [HideInInspector] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;SceneLogicData&gt; SceneLogicList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;SceneLogicData&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _instance = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sceneLogic <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> SceneLogicList) { RunLogicInternal(LogicStorage.Load(sceneLogic.BinaryData)); } } } }</code> </pre> <br></div></div><br>  <b>рдиреЛрдЯ</b> : рдкреНрд░рддреНрдпреЗрдХ рджреГрд╢реНрдп рдХрд╛ рдЕрдкрдирд╛ рдирд┐рдпрдВрддреНрд░рдХ рдФрд░ рддрд░реНрдХ рдХрд╛ рдЕрдкрдирд╛ рд╕реЗрдЯ рд╣реИред <br>  <b>рдиреЛрдЯ</b> : рд▓реЛрдбрд┐рдВрдЧ рд▓реЙрдЬрд┐рдХ рдбреЗрдЯрд╛ рдФрд░ рдЗрд╕рдХреЗ рд▓реЙрдиреНрдЪ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрд░ рдЕрд▓рдЧ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреАред <br><br><h3>  UViLEd рдХрд░реНрдиреЗрд▓ рдХреЗ рдореБрдЦреНрдп рддрддреНрд╡ </h3><br><h4>  рдЕрдВрдЧ </h4><br>  рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдореИрдВрдиреЗ рдкрд╣рд▓реЗ рд╣реА рдХрд╣рд╛ рдХрд┐ рдШрдЯрдХ <b>ScriptableObject рд╣реИ</b> ред  рд╕рднреА рдШрдЯрдХ <b>LogicComponent</b> рд╡рд░реНрдЧ рдХреЗ рд╡рдВрд╢рдЬ рд╣реИрдВ, рдЬреЛ рдмрджрд▓реЗ рдореЗрдВ рд╕рд░рд▓ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicComponent</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> MonoBehaviour coroutineHost =&gt; _logicHost; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MonoBehaviour _logicHost; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Constructor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } } }</code> </pre><br>  рдпрд╣рд╛рдБ, <b>coroutineHost</b> рдПрдХ рд▓реЙрдЬрд┐рдХ рдХрдВрдЯреНрд░реЛрд▓рд░ рдХрд╛ рдПрдХ рд▓рд┐рдВрдХ рд╣реИ, рдЬрд┐рд╕реЗ рд╕рд┐рд░реНрдл рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдирд╛рдо рдХрд╛ рдЕрд░реНрде рд╣реИ, рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ред  <b>рдПрдХрддрд╛</b> рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдореМрдЬреВрдж рдЕрдиреНрдп рдХреЛрдб рд╕реЗ рдШрдЯрдХреЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЕрдореВрд░реНрдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрд╡рд╢реНрдпрдХ рд╣реИред <br><br><h4>  рдЪрд░ </h4><br>  рдЪрд░, рдЬреИрд╕рд╛ рдХрд┐ рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рдШрдЯрдХ рд╣реИрдВ, рдЙрдирдХреЗ рд▓рд┐рдП рдХреЛрдб рдиреАрдЪреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рдЪрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Variable</span></span> : <span class="hljs-title"><span class="hljs-title">LogicComponent</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Variable</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; : <span class="hljs-title"><span class="hljs-title">Variable</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Changed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Set</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">T newValue</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> Changed OnChanged; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> Set OnSet; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> T Value { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _value; }<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> changed = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_value == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> != <span class="hljs-literal"><span class="hljs-literal">null</span></span> || (_value != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !_value.Equals(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>))) { changed = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } _value = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (changed) { OnChanged?.Invoke(); } OnSet?.Invoke(_value); } } [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> T _value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDestroy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(OnSet != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eventHandler <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> OnSet.GetInvocationList()) { OnSet -= (Set)eventHandler; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(OnChanged != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eventHandler <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> OnChanged.GetInvocationList()) { OnChanged -= (Changed)eventHandler; } } } } }</code> </pre><br></div></div><br>  рдпрд╣рд╛рдВ <b>рдЪрд░</b> рд╕рднреА рдЪрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдореВрд▓ рд╕рд╛рд░ рд╡рд░реНрдЧ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рд╕рд╛рдорд╛рдиреНрдп рдШрдЯрдХреЛрдВ рд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рдореБрдЦреНрдп рд╡рд░реНрдЧ <b>рд╕рд╛рдорд╛рдиреНрдп рд╣реИ</b> , рдЬреЛ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрд╡рдпрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдореВрд▓реНрдп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдФрд░ рдЗрд╕реЗ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдУрдВ рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред <br><br><h4>  рд╕рдВрдЪрд╛рд░ </h4><br>  рдХрдиреЗрдХреНрд╢рди рдХреНрдпрд╛ рд╣реИрдВ, рдореИрдВрдиреЗ рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдмрддрд╛рдпрд╛ рдерд╛ред  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдпрд╣ рдПрдХ рдЖрднрд╛рд╕реА рдЗрдХрд╛рдИ рд╣реИ рдЬреЛ рдШрдЯрдХреЛрдВ рдХреЛ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рддрд░реНрдХ рдЪрд░ рднреА рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдХрдиреЗрдХреНрд╢рди рдирд░рдо рд╣реИ рдФрд░ рдХреЛрдб рдореЗрдВ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред  рд╕рднреА рд╕рдВрдЪрд╛рд░ рдЖрд░рдВрднреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдмрдирддреЗ рд╣реИрдВ (рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдиреАрдЪреЗ рдкрдврд╝реЗрдВ)ред  рдЙрди рд╡рд░реНрдЧреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬреЛ рдЖрдкрдХреЛ рд╕рдВрдмрдВрдз рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">INPUT_POINT</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Action&lt;T&gt; Handler; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">INPUT_POINT</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Action Handler; } }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдмрд╛рд╣рд░ рдирд┐рдХрд▓реЗрдВ рдмрд┐рдВрджреБ</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OUTPUT_POINT</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Action&lt;T&gt;&gt; _linkedInputPoints = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Action&lt;T&gt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">T param</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _linkedInputPoints) { handler(param); } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OUTPUT_POINT</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Action&gt; _linkedInputPoints = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Action&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _linkedInputPoints) { handler(); } } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдЪрд░ рд╕рдВрджрд░реНрдн</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VARIABLE_LINK</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> T Value { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> =&gt; _variable.Value; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> =&gt; _variable.Value = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Variable&lt;T&gt; _variableProperty { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> =&gt; _variable; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _variable = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; VariableWasSet = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; InitializeEventHandlers(); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> VariableWasSet { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Variable&lt;T&gt; _variable; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Variable&lt;T&gt;.Set _automaticSetHandler; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Variable&lt;T&gt;.Changed _automaticChangedHandler; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddSetEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Variable&lt;T&gt;.Set handler</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VariableWasSet) { _variable.OnSet += handler; }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _automaticSetHandler = handler; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveSetEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Variable&lt;T&gt;.Set handler</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VariableWasSet) { _variable.OnSet -= handler; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddChangedEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Variable&lt;T&gt;.Changed handler</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VariableWasSet) { _variable.OnChanged += handler; }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _automaticChangedHandler = handler; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveChangedEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Variable&lt;T&gt;.Changed handler</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VariableWasSet) { _variable.OnChanged -= handler; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeEventHandlers</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_automaticSetHandler != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _variable.OnSet += _automaticSetHandler; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_automaticChangedHandler != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _variable.OnChanged += _automaticChangedHandler; } } } }</code> </pre><br></div></div><br>  <b>рдиреЛрдЯ</b> : рдпрд╣рд╛рдВ рдпрд╣ рдПрдХ рдмрд┐рдВрджреБ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рдШрдЯрдирд╛рдУрдВ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдФрд░ рдПрдХ рдЪрд░ рдХреЗ рдореВрд▓реНрдп рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╣реИрдВрдбрд▓рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓ рддрдм рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдЙрдиреНрд╣реЗрдВ <b>рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░</b> рд╡рд┐рдзрд┐ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЙрд╕ рд╕рдордп рдЪрд░ рдХреЗ рд╕рдВрджрд░реНрдн рдЕрднреА рддрдХ рд╕реЗрдЯ рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рдереЗред <br><br><h3>  рддрд░реНрдХ рд╕реЗ рдХрд╛рдо рд▓реЛ </h3><br><h4>  рднрдВрдбрд╛рд░рдг </h4><br>  рджреГрд╢реНрдп рддрд░реНрдХ рд╕рдВрдкрд╛рджрдХ рдкрд░ рдкрд╣рд▓реЗ рд▓реЗрдЦ рдореЗрдВ, рдпрд╣ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХрд┐ рддрд░реНрдХ рдЪрд░, рдШрдЯрдХреЛрдВ рдФрд░ рдЙрдирдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзреЛрдВ рдХрд╛ рдПрдХ рд╕рдореВрд╣ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicStorage</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Id = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> SceneName = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ComponentsStorage Components = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ComponentsStorage(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> LinksStorage Links = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinksStorage(); } }</code> </pre><br>  рдпрд╣ рд╡рд░реНрдЧ рдЬрд╛рд╣рд┐рд░рд╛ рддреМрд░ рдкрд░ рдХреНрд░рдорд┐рдХ рд╣реИ, рд▓реЗрдХрд┐рди <b>рдПрдХрддрд╛ рдХреЗ</b> <b>JsonUtility</b> рдХреЛ рдХреНрд░рдорд╛рдВрдХрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдПрдХ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк <b>рдмрд╛рдЗрдЯреНрд╕</b> рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдРрд╕рд╛ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ?  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдореБрдЦреНрдп рдХрд╛рд░рдг рд╕реБрд░рдХреНрд╖рд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд, рдХрд┐рд╕реА рдмрд╛рд╣рд░реА рд╕реНрд░реЛрдд рд╕реЗ рддрд░реНрдХ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд▓рд┐рдП, рдбреЗрдЯрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдмрд╛рдЗрдЯ рд╕рд░рдгреА рдХреЛ <b>рдбрд┐рд╕реЗрдиреНрдЯрд▓рд╛рдЗрдЬрд╝</b> рдХрд░рдирд╛ рдУрдкрди <b>рдЬреЛрдВрд╕ рдХреА</b> рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реИред <br><br>  рдЪрд▓реЛ <b>ComponentsStrorage</b> рдФрд░ <b>LinksStorage рд╡рд░реНрдЧреЛрдВ рдкрд░</b> рдПрдХ рдХрд░реАрдм рд╕реЗ <b>рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ</b> ред  рд╕рд┐рд╕реНрдЯрдо рд╡реИрд╢реНрд╡рд┐рдХ рдбреЗрдЯрд╛ рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдПрдХ <b>GUID</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдиреАрдЪреЗ рдХреНрд▓рд╛рд╕ рдХреЛрдб рд╣реИ, рдЬреЛ рдбреЗрдЯрд╛ рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ рдЖрдзрд╛рд░ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Identifier</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Identifier</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(Id)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; Id = System.Guid.NewGuid().ToString(); } } }</code> </pre><br>  рдЕрдм <b>ComponentsStorage</b> рд╡рд░реНрдЧ рдХреЗ рдХреЛрдб рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдирд╛рдо рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, рддрд░реНрдХ рдХреЗ рдШрдЯрдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicStorage</span></span> { [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ComponentsStorage</span></span> { [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ComponentData</span></span> : <span class="hljs-title"><span class="hljs-title">Identifier</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Type = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Assembly = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> JsonData = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;ComponentData&gt; Items = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;ComponentData&gt;(); } }</code> </pre><br>  рдХрдХреНрд╖рд╛ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ: <br><br><ol><li>  рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ ( <b>GUID</b> рд╕реНрдЯреНрд░рд┐рдВрдЧ) <b>рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛</b> рдореЗрдВ рдкрд╛рдпрд╛ рдЧрдпрд╛ </li><li>  рдирд╛рдо рдЯрд╛рдЗрдк рдХрд░реЗрдВ </li><li>  рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХрд╛ рдирд╛рдо рдЬрд┐рд╕рдореЗрдВ рдШрдЯрдХ рдкреНрд░рдХрд╛рд░ рд╕реНрдерд┐рдд рд╣реИ </li><li>  рдХреНрд░рдордмрджреНрдз рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде <b>рдЬрд╕рди</b> рд╕реНрдЯреНрд░рд┐рдВрдЧ ( <b>JsonUtility.ToJson рдХрд╛</b> рдкрд░рд┐рдгрд╛рдо) </li><li>  рдШрдЯрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ (рд░рд╛рдЬреНрдп) рдзреНрд╡рдЬ </li></ol><br>  рдЕрдм рд╣рдо <b>LinksStorage</b> рд╡рд░реНрдЧ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВред  рдпрд╣ рд╡рд░реНрдЧ рдШрдЯрдХреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзреЛрдВ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдЪрд░ рдХреЗ рд╕рдВрджрд░реНрднреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicStorage</span></span> { [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LinksStorage</span></span> { [Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LinkData</span></span> : <span class="hljs-title"><span class="hljs-title">Identifier</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsVariable; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> SourceComponent = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> TargetComponent = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> OutputPoint = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> InputPoint = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> VariableName = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CallOrder = <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;LinkData&gt; Items = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;LinkData&gt;(); } }</code> </pre><br>  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЗрд╕ рд╡рд░реНрдЧ рдореЗрдВ рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рд▓рд┐рдВрдХ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд╣реИ: <br><br><ol><li>  рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд▓рд┐рдВрдХ рдПрдХ рдЪрд░ рдХрд╛ рд╕рдВрджрд░реНрдн рд╣реИ </li><li>  рд▓рд┐рдВрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдзреНрд╡рдЬ </li><li>  рдЖрдЙрдЯрдкреБрдЯ рдкреНрд╡рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдШрдЯрдХ рдХреА рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ ( <b>GUID</b> рд╕реНрдЯреНрд░рд┐рдВрдЧ) </li><li>  рдкреНрд░рд╡реЗрд╢-рдмрд┐рдВрджреБ рдШрдЯрдХ рдХрд╛ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ ( <b>GUID</b> рд╕реНрдЯреНрд░рд┐рдВрдЧ) </li><li>  рд╕рдВрдЪрд╛рд░ рд╕реНрд░реЛрдд рдШрдЯрдХ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдмрд┐рдВрджреБ рдХрд╛ рдирд╛рдо </li><li>  рд▓рдХреНрд╖реНрдп рд╕рдВрдЪрд╛рд░ рдШрдЯрдХ рдХреЗ рдЗрдирдкреБрдЯ рдмрд┐рдВрджреБ рдХрд╛ рдирд╛рдо </li><li>  рдЪрд░ рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рд╕ рдлрд╝реАрд▓реНрдб рдирд╛рдо </li><li>  рд╕рдВрдЪрд╛рд░ рдХреЙрд▓ рдЖрджреЗрд╢ </li></ol><br><h4>  рднрдВрдбрд╛рд░ рд╕реЗ рднрд╛рдЧреЛ </h4><br>  рдХреЛрдб рдХреЗ рд╡рд┐рд╡рд░рдгреЛрдВ рдореЗрдВ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдореИрдВ рдпрд╣ рдмрддрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рдирд┐рдпрдВрддреНрд░рдХ рддрд░реНрдХ рдХреЛ рдХреИрд╕реЗ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рдЕрдиреБрдХреНрд░рдо рдХреЗ рд╡рд┐рд╡рд░рдг рдкрд░ рдзреНрдпрд╛рди рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ: <br><br><ol><li>  рдХрдВрдЯреНрд░реЛрд▓рд░ рдЕрд╡реЗрдХ рд╡рд┐рдзрд┐ рдореЗрдВ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддрд╛ рд╣реИ </li><li>  рджреГрд╢реНрдп рд▓реЙрдЬрд┐рдХреНрд╕ рдХреА рд╕реВрдЪреА рдПрдХ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдлрд╝рд╛рдЗрд▓ рд╕реЗ рддрд░реНрдХ рдбреЗрдЯрд╛ рдХреЛ <b>рдирд╖реНрдЯ рдХрд░ рджреЗрддреА рд╣реИ</b> ( <b>рдЯреЗрдХреНрд╕реНрдЯрдПрд╕реЗрдЯ</b> ) </li><li>  рдкреНрд░рддреНрдпреЗрдХ рддрд░реНрдХ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ: <br><ul><li>  рдШрдЯрдХ рдирд┐рд░реНрдорд╛рдг </li><li>  <b>CallOrder</b> рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдВрдХ <b>рдХреНрд░рдорд┐рдд рдХрд░рдирд╛</b> </li><li>  рд▓рд┐рдВрдХ рдФрд░ рдЪрд░ рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдХрд░рдирд╛ </li><li>  <b>ExecuteOrder</b> рджреНрд╡рд╛рд░рд╛ <b>рдореЛрдиреЛ</b> рдШрдЯрдХ рдШрдЯрдХ рдХреЛ <b>рдЫрд╛рдБрдЯрдирд╛</b> </li></ul><br></li></ol><br>  рдЖрдЗрдП рдЗрд╕ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдкрд╣рд▓реВ рдкрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдХреНрд░рдорд╛рдВрдХрди рдФрд░ deserialization</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Serialization</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Serialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binaryFormatter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryFormatter(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Directory.Exists(path)) { Directory.CreateDirectory(path); } <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileStream(Path.Combine(path, fileName), FileMode.OpenOrCreate)) { binaryFormatter.Serialize(fs, data); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Deserialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TextAsset textAsset</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binaryFormatter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryFormatter(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> memoryStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemoryStream(textAsset.bytes)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> binaryFormatter.Deserialize(memoryStream); } } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдЯреЗрдХреНрд╕реНрдЯ рдПрд╕реЗрдЯ (рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓) рд╕реЗ рд▓реЙрдЬрд┐рдХ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдирд╛</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">uViLEd.Core</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicStorage</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> LogicStorage </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TextAsset textAsset</span></span></span><span class="hljs-function">)</span></span> =&gt; Serialization.Deserialize(textAsset) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> LogicStorage; } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рд▓реЙрдЬрд┐рдХ рд▓реЙрдиреНрдЪ</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunLogicInternal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LogicStorage logicStorage</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> instances = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, LogicComponent&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> componentData <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicStorage.Components.Items) { CreateComponent(componentData, instances); } logicStorage.Links.Items.Sort(SortingLinks); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkData <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicStorage.Links.Items) { CreateLink(linkData, instances); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> monoMethods <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _monoBehaviourMethods.Values) { monoMethods.Sort(SortingMonoMethods); } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдШрдЯрдХ рдирд┐рд░реНрдорд╛рдг</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LogicStorage.ComponentsStorage.ComponentData componentData, IDictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, LogicComponent&gt; instances, IList&lt;IDisposable&gt; disposableInstance, IDictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, List&lt;MonoMethodData&gt;&gt; monoMethods</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!componentData.IsActive) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> componentType = AssemblyHelper.GetAssemblyType(componentData.Assembly, componentData.Type); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> componentInstance = ScriptableObject.CreateInstance(componentType) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> LogicComponent; JsonUtility.FromJsonOverwrite(componentData.JsonData, componentInstance); componentInstance.name = componentData.InstanceName; componentType.GetFieldRecursive(_LOGIC_HOST_STR).SetValue(componentInstance, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> MonoBehaviour); componentInstance.Constructor(); instances.Add(componentData.Id, componentInstance); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(componentInstance <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> IDisposable) { disposableInstance.Add((IDisposable)componentInstance); } SearchMonoBehaviourMethod(componentInstance, monoMethods); }</code> </pre><br>  рддреЛ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ: <br><br><ol><li>  рдШрдЯрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдзреНрд╡рдЬ рдХреА рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рддреА рд╣реИ </li><li>  рд╡рд┐рдзрд╛рдирд╕рднрд╛ рд╕реЗ рдШрдЯрдХ рдХрд╛ рдкреНрд░рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ </li><li>  рдПрдХ рдШрдЯрдХ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рдХрд╛рд░ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ </li><li>  <b>JSON</b> рд╕реЗ рдШрдЯрдХ рдкреИрд░рд╛рдореАрдЯрд░ deserialization </li><li>  рд▓рд┐рдВрдХ <b>coroutineHost</b> рдореЗрдВ рд╕реЗрдЯ рд╣реИ </li><li>  <b>рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░</b> рд╡рд┐рдзрд┐ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </li><li>  рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдШрдЯрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╕рд╣реЗрдЬреА рдЬрд╛рддреА рд╣реИ </li><li>  рдпрджрд┐ рдШрдЯрдХ рдЖрдИрдбреАрд╕реЙрдлрд╝реЗрд░рд┐рдпрд▓ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рд╕рдВрдмрдВрдзрд┐рдд рд╕реВрдЪреА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </li><li>  рдШрдЯрдХ рдореЗрдВ <b>рдореЛрдиреЛ</b> рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ </li></ol><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рд▓рд┐рдВрдХ рдмрдирд╛рдирд╛</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateLink</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LogicStorage.LinksStorage.LinkData linkData, Dictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, LogicComponent&gt; instances</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!linkData.IsActive) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sourceComponent = instances.ContainsKey(linkData.SourceComponent) ? instances[linkData.SourceComponent] : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sourceComponent == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> targetComponent = instances.ContainsKey(linkData.TargetComponent) ? instances[linkData.TargetComponent] : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (targetComponent == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (linkData.IsVariable) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> variableLinkFieldInfo = sourceComponent.GetType().GetField(linkData.variableName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (variableLinkFieldInfo != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> variableLinkFieldValue = variableLinkFieldInfo.GetValue(sourceComponent); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> variableLinkVariablePropertyInfo = variableLinkFieldInfo.FieldType.GetProperty(_VARIABLE_PROPERTY_STR, BindingFlags.NonPublic | BindingFlags.Instance); variableLinkVariablePropertyInfo.SetValue(variableLinkFieldValue, targetComponent, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> handlerValue; MethodInfo methodListAdd; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> linkedInputPointsFieldValue; Type outputPointType; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> outputPoint; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputPointParse = sourceComponent <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IOutputPointParse; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointParse = targetComponent <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IInputPointParse; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputPointParse != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputPoints = outputPointParse.GetOutputPoints(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputPoints.ContainsKey(linkData.OutputPoint)) { outputPoint = outputPoints[linkData.OutputPoint]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputPoint <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> FieldInfo) { outputPoint = sourceComponent.GetType().GetField(linkData.OutputPoint).GetValue(sourceComponent); } outputPointType = outputPoint.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkedInputPointsFieldInfo = outputPointType.GetField(_LINKED_INPUT_POINTS_STR, BindingFlags.NonPublic | BindingFlags.Instance); linkedInputPointsFieldValue = linkedInputPointsFieldInfo.GetValue(outputPoint); methodListAdd = linkedInputPointsFieldInfo.FieldType.GetMethod(_ADD_STR); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputPointFieldInfo = sourceComponent.GetType().GetField(linkData.OutputPoint); outputPoint = outputPointFieldInfo.GetValue(sourceComponent); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputPoint != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { outputPointType = outputPoint.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkedInputPointsFieldInfo = outputPointFieldInfo.FieldType.GetField(_LINKED_INPUT_POINTS_STR, BindingFlags.NonPublic | BindingFlags.Instance); linkedInputPointsFieldValue = linkedInputPointsFieldInfo.GetValue(outputPoint); methodListAdd = linkedInputPointsFieldInfo.FieldType.GetMethod(_ADD_STR); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputPointParse != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPoints = inputPointParse.GetInputPoints(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputPoints.ContainsKey(linkData.InputPoint)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPoint = inputPoints[linkData.InputPoint]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputPoint <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> FieldInfo) { inputPoint = targetComponent.GetType().GetField(linkData.InputPoint).GetValue(targetComponent); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointType = inputPoint.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointHandlerFieldInfo = inputPointType.GetField(_HANDLER_STR); handlerValue = inputPointHandlerFieldInfo.GetValue(inputPoint); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointFieldInfo = targetComponent.GetType().GetField(linkData.InputPoint); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointFieldValue = inputPointFieldInfo.GetValue(targetComponent); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputPointFieldValue != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointHandlerFieldInfo = inputPointFieldInfo.FieldType.GetField(_HANDLER_STR); handlerValue = inputPointHandlerFieldInfo.GetValue(inputPointFieldValue); } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handlerParsedAction = GetParsedHandler(handlerValue, outputPoint); methodListAdd.Invoke(linkedInputPointsFieldValue, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] { handlerParsedAction }); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetParsedHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> handlerValue, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> outputPoint</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputPointType = handlerValue.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputPointType = outputPoint.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputPointType.IsGenericType) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramType = inputPointType.GetGenericArguments()[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (paramType == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>) &amp;&amp; outputPointType.IsGenericType) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parsingActionMethod = outputPointType.GetMethod(_PARSING_ACTION_OBJECT_STR, BindingFlags.NonPublic | BindingFlags.Instance); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parsingActionMethod.Invoke(outputPoint, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] { handlerValue }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> handlerValue; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputPointType.IsGenericType) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parsingActionMethod = outputPointType.GetMethod(_PARSING_ACTION_EMPTY_STR, BindingFlags.NonPublic | BindingFlags.Instance); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parsingActionMethod.Invoke(outputPoint, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] { handlerValue }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> handlerValue; } } }</code> </pre> <br>  рдкреВрд░реЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕рдмрд╕реЗ рдЖрдВрддрд░рд┐рдХ рдХреНрд╖рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ, рдПрдХ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдирд╛, рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: <br><br><ol><li>  рд╕рдВрдЪрд╛рд░ рдЧрддрд┐рд╡рд┐рдзрд┐ рдзреНрд╡рдЬ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ </li><li>  рдирд┐рд░реНрдорд┐рдд рдШрдЯрдХреЛрдВ рдХреА рдЕрд╕реНрдерд╛рдпреА рд╕реВрдЪреА рдореЗрдВ рдЦреЛрдЬ рдХреА рдЬрд╛рддреА рд╣реИ, рдХрдиреЗрдХреНрд╢рди рдХреЗ рд╕реНрд░реЛрдд рдШрдЯрдХ рдФрд░ рд▓рдХреНрд╖реНрдп рдШрдЯрдХ </li><li>  рдХрдиреЗрдХреНрд╢рди рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ: <br><ul><li>  рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдкреНрд░рдХрд╛рд░ рдПрдХ рдЪрд░ рдХрд╛ рд╕рдВрджрд░реНрдн рд╣реИ, рддреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╡рд╢реНрдпрдХ рдорд╛рди рд╕реЗрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ </li><li>  рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рддреЛ рдЖрдЙрдЯрдкреБрдЯ рдФрд░ рдЗрдирдкреБрдЯ рдмрд┐рдВрджреБрдУрдВ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдорд╛рди рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдкреНрд░рддрд┐рдмрд┐рдВрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </li></ul><br></li><li>  рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ рдЬрд╛рдБрдЪ рд▓реЗрдВ рдХрд┐ рдХреНрдпрд╛ рдШрдЯрдХ <b>IInputPointParse</b> рдФрд░ <b>IOutputPointParse рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдЗрдирд╣реЗрд░рд┐рдЯ рдХрд░рддрд╛ рд╣реИ</b> ред </li><li>  рдкрд┐рдЫрд▓реЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╕реНрд░реЛрдд рдШрдЯрдХ рдореЗрдВ <b>рд▓рд┐рдВрдХреНрдбрдЗрдирдкреБрдЯ рдкреЙрдЗрдВрдЯ рдкреЙрдЗрдВрдЯ</b> рдФрд░ рд▓рдХреНрд╖реНрдп рдШрдЯрдХ рдореЗрдВ рд╣реИрдВрдбрд▓рд░ рд╡рд┐рдзрд┐ рдкреНрд░рддрд┐рдмрд┐рдВрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИред </li><li>  рдореЗрдердб рд╣реИрдВрдбрд▓рд░реНрд╕ <b>рдореЗрдердбрдЗрдиреНрдлреЛ</b> рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддреЗ рд╣реБрдП рдореЗрдердб рдХреЙрд▓ рдХреЛ <b>рдкреНрд░рд╛рдкреНрдд</b> рдХрд░рддреЗ рд╣реИрдВред <b>рдЗрдирд╡реЛрдХ</b> рдХреЛ рдПрдХ рд╕рд╛рдзрд╛рд░рдг <code>Action&lt;T&gt;</code> рдХреЙрд▓ рдореЗрдВ <b>рдмрджрд▓реЗрдВ</b> ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреНрд░рддрд┐рдмрд┐рдВрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╕ рддрд░рд╣ рдХреА рд▓рд┐рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рд╣реИ, рдЗрд╕рд▓рд┐рдП, <code>OUTPUT_POINT&lt;T&gt;</code> рд╡рд░реНрдЧ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ <code>OUTPUT_POINT&lt;T&gt;</code> рдЧрдП рд╣реИрдВ рдЬреЛ <code>OUTPUT_POINT&lt;T&gt;</code> рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред  рдЗрд╕ рд╡рд░реНрдЧ рдХреЗ рдЧреИрд░- <b>рд╕рд╛рдорд╛рдиреНрдп</b> рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рддрд░рд╣ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Action&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParsingActionEmpty</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action action</span></span></span><span class="hljs-function">)</span></span> { Action&lt;T&gt; parsedAction = (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) =&gt; action(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parsedAction; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Action&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParsingActionObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; action</span></span></span><span class="hljs-function">)</span></span> { Action&lt;T&gt; parsedAction = (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) =&gt; action(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parsedAction; } }</code> </pre> <br>  рдкрд╣рд▓реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рддрдм рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдЗрдирдкреБрдЯ рдмрд┐рдВрджреБ рдХрд┐рд╕реА рднреА рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдЗрдирдкреБрдЯ рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдХреНрд░рдорд╢рдГ рджреВрд╕рд░реА рд╡рд┐рдзрд┐ред <br><br></li><li>  рдкреНрд░рддрд┐рдмрд┐рдВрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, <b>рдПрдХреНрд╢рди</b> рд╣реИрдВрдбрд▓рд░ рдХрд╛ рд▓рд┐рдВрдХ <b>рд▓рд┐рдВрдХреНрдбрдЗрдирдкреБрдЯ рдкреЙрдЗрдВрдЯреНрд╕</b> рдлрд╝реАрд▓реНрдб рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреЛ, рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдПрдХ рд╕реВрдЪреА рд╣реИ) </li></ol><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдореЛрдиреЛ рдореЗрдердбреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SearchMonoBehaviourMethod</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LogicComponent component, IDictionary&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, List&lt;MonoMethodData&gt;&gt; monoBehaviourMethods</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> type = component.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> methods = type.GetMethods(BindingFlags.Public | BindingFlags.Static | BindingFlags.NonPublic | BindingFlags.Instance); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> method <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> methods) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_monoMethods.Keys.Contains(method.Name)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> priorityAttributes = method.GetCustomAttributes(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(ExecuteOrderAttribute), <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> priority = (priorityAttributes.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) ? ((ExecuteOrderAttribute)priorityAttributes[<span class="hljs-number"><span class="hljs-number">0</span></span>]).Order : <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; monoBehaviourMethods[method.Name].Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MonoMethodData(method, component, priority, _monoMethods[method.Name])); } } }</code> </pre> <br>  рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рдзрд┐ рдХреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдЧ рдХреЗ рд▓рд┐рдВрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рд╡рд░реНрдЧ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ <b>рдХрд╛рд░реНрдп</b> рдХреЛ рд╕рдВрджрд░реНрдн рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рд╛рдорд╛рдиреНрдп <b>MethodInfo.Invoke</b> рдХреА рддреБрд▓рдирд╛ рдореЗрдВ <b>рдореЛрдиреЛ</b> рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдХреЙрд▓ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рддреНрд╡рд░рдг рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MonoMethodData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Order { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Action _monoMethodWrapper; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Action&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; _monoMethodParamWrapper; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MonoMethodData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">MethodInfo method, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> target, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> order, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> withParam</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!withParam) { _monoMethodWrapper = (Action)Delegate.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Action), target, method.Name); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _monoMethodParamWrapper = (Action&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;)Delegate.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Action&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;), target, method.Name); } Order = order; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Call</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt;_monoMethodWrapper(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Call</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param</span></span></span><span class="hljs-function">)</span></span> =&gt; _monoMethodParamWrapper(param); }</code> </pre> <br>  <b>рдиреЛрдЯ</b> : <b>рдмреВрд▓</b> рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде <b>рдХреЙрд▓</b> рд╡рд┐рдзрд┐ рдХреЛ рдУрд╡рд░рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <b>рдореЛрдиреЛрдкреНрд▓реЗ</b> рдЬреИрд╕реЗ <b>рдПрдкреНрд▓рд┐рдХреЗрд╢рдирдкреЙрдЬрд╝</b> рдЖрджрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ <br></div></div><br><h4>  рдмрд╛рд╣рд░реА рдЯреНрд░рд┐рдЧрд░ рддрд░реНрдХ </h4><br>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдСрдкрд░реЗрд╢рди рдХреЗ рджреМрд░рд╛рди рд▓реЙрдЬрд┐рдХ рдХрд╛ рдмрд╛рд╣рд░реА рд▓реЙрдиреНрдЪ рдПрдХ рд▓реЙрдиреНрдЪ рд╣реИ, рдЗрд╕ рддрд░рд╣ рдХреЗ рд▓реЙрдЬрд┐рдХ рд╕реАрди рдореЗрдВ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдХреЛрдИ рд▓рд┐рдВрдХ рдирд╣реАрдВ рд╣реИред  рдЗрд╕реЗ рдмрдВрдбрд▓ рд╕реЗ, рдпрд╛ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, <b>рдореЛрдиреЛ рдХреЗ</b> рддрд░реАрдХреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдЕрдкрд╡рд╛рдж рдХреЗ рд╕рд╛рде, рдмрд╛рд╣рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рджреГрд╢реНрдп рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдмрд╣реБрдд рдЕрд▓рдЧ рдирд╣реАрдВ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рдмрд╛рд╣рд░реА (рдЖрд╕реНрдердЧрд┐рдд) рддрд░реНрдХ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunLogicExternal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LogicStorage logicStorage</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> instances = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, LogicComponent&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> runMonoMethods = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, List&lt;MonoMethodData&gt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> monoMethodName <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _monoMethods.Keys) { runMonoMethods.Add(monoMethodName, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;MonoMethodData&gt;()); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> componentData <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicStorage.Components.Items) { CreateComponent(componentData, instances, _disposableInstances, runMonoMethods); } logicStorage.Links.Items.Sort(SortingLinks); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkData <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicStorage.Links.Items) { CreateLink(linkData, instances); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> monoMethods <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> runMonoMethods.Values) { monoMethods.Sort(SortingMonoMethods); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (runMonoMethods.ContainsKey(_START_STR)) { CallMonoBehaviourMethod(_START_STR, runMonoMethods, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> monoMethodName <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> runMonoMethods.Keys) { _monoBehaviourMethods[monoMethodName].AddRange(runMonoMethods[monoMethodName]); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> monoMethods <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _monoBehaviourMethods.Values) { monoMethods.Sort(SortingMonoMethods); } }</code> </pre> <br></div></div><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, <b>рдореЛрдиреЛ</b> рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХреЗ рд╕рднреА рд╕рдВрджрд░реНрдн рд╕реНрдерд╛рдиреАрдп рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╕реНрдЯрд╛рд░реНрдЯ рддрд░реАрдХреЗ рд▓реЙрдиреНрдЪ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдЕрдиреНрдп рд╕рднреА рддрд░реАрдХреЛрдВ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><h4>  рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рддрд░реНрдХ рдЪрд▓ рд░рд╣рд╛ рд╣реИ </h4><br>  рдЖрд╡реЗрджрди рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рджреМрд░рд╛рди, рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдХреЗ рд▓рд┐рдП рдХреБрдЫ рддрд░реНрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рдЬрдм рддрдХ рдпрд╣ рдЕрдкрдирд╛ рдХрд╛рд░реНрдп рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рдкрд┐рдЫрд▓реЗ рд▓реЙрдЬрд┐рдХ рдЯреНрд░рд┐рдЧрд░рд┐рдВрдЧ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рджреГрд╢реНрдп рдХреЗ рдкреВрд░реЗ рдЬреАрд╡рди рдореЗрдВ рддрд░реНрдХ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рддрд░реНрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдШрдЯрдХреЛрдВ рдХреЗ рд▓рд┐рдВрдХ рдФрд░ рдЗрд╕ рддрд░рд╣ рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдХрд╛рдо рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рд╣рдЯрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдореЗрдореЛрд░реА рд╕рд╛рдлрд╝ рд╣реЛ рдЬрд╛рддреА рд╣реИред <br><br>  рд▓реЙрдЬрд┐рдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдбреЗрдЯрд╛ рд╡реЗрдпрд░рд╣рд╛рдЙрд╕ рдХреНрд▓рд╛рд╕ рдХреЛрдб: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">InstanceLogicData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;LogicComponent&gt; ComponentInstances = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;LogicComponent&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IDictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, List&lt;MonoMethodData&gt;&gt; MonoBehaviourMethods = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, List&lt;MonoMethodData&gt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IList&lt;IDisposable&gt; DisposableInstances = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;IDisposable&gt;(); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рд▓реЙрдЬрд┐рдХ рд▓реЙрдиреНрдЪ рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдкрд╣рд▓реЗ рдмрддрд╛рдП рдЧрдП рдмрд╛рд╣рд░реА рд▓реЙрдиреНрдЪ рдХреЗ рд╕рдорд╛рди рд╣реИред</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunLogicInstance</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LogicStorage logicStorage, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = Guid.NewGuid().ToString(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logicInstanceData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InstanceLogicData(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> instances = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, LogicComponent&gt;(); _logicInstances.Add(id, logicInstanceData); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> componentData <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicStorage.Components.Items) { CreateComponent(componentData, instances, logicInstanceData.DisposableInstances, logicInstanceData.MonoBehaviourMethods); } logicStorage.Links.Items.Sort(SortingLinks); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkData <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicStorage.Links.Items) { CreateLink(linkData, instances); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> monoMethods <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicInstanceData.MonoBehaviourMethods.Values) { monoMethods.Sort(SortingMonoMethods); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id; }</code> </pre> <br></div></div><br>  рдпрд╣ рдХреЛрдб рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рддрд░реНрдХ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдЧ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рддрд░реНрдХ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рд╕реНрдЯреЙрдк рдФрд░ рд╕реНрдкрд╖реНрдЯ рдореЗрдореЛрд░реА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StopLogicInstance</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> instanceId</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_logicInstances.ContainsKey(instanceId)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logicInstance = _logicInstances[instanceId]; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> disposableInstance <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicInstance.DisposableInstances) { disposableInstance.Dispose(); } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> componentInstance <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicInstance.ComponentInstances) { Destroy(componentInstance); } logicInstance.ComponentInstances.Clear(); logicInstance.DisposableInstances.Clear(); logicInstance.MonoBehaviourMethods.Clear(); _logicInstances.Remove(instanceId); }</code> </pre> <br></div></div><br><h4>  рджреГрд╢реНрдп рдХреЛ рд╢рд╛рдВрдд рдХрд░рдирд╛ рдФрд░ рд╕реНрдореГрддрд┐ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдирд╛ </h4><br>  <b>ScriptableObject.CreateInstance рдХреЗ</b> рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рд░рдирд┐рдВрдЧ рд╕реАрди рдореЗрдВ <b>ScriptableObject рдмрдирд╛рддреЗ рд╕рдордп</b> , рдЙрджрд╛рд╣рд░рдг <b>MonoBeviourour</b> рдХреЗ рд╕рдорд╛рди <b>рд╣реЛрддрд╛ рд╣реИ</b> , рдЕрд░реНрдерд╛рдд, рдЬрдм рджреГрд╢реНрдп рд╕реЗ рдЙрддрд╛рд░рдирд╛ рд╣реЛ, рддреЛ <b>OnDadroy</b> рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдореЗрдореЛрд░реА рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬреИрд╕рд╛ рдХрд┐ рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдХрд╣рд╛ рдЧрдпрд╛ рдерд╛, рдПрдХ рдШрдЯрдХ <b>рдЖрдИрдбреАрд╕рд┐рд╕реЛрдкреНрд▓реЙрд░реА</b> рдХреЛ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЗрд╕реЗ <b>рдСрди-рдбрд┐рд╕реЗрдмрд▓</b> рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕рд╛рдл рдХрд░рддрд╛ рд╣реВрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDisable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> disposable <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _disposableInstances) { disposable.Dispose(); } _disposableInstances.Clear(); _monoBehaviourMethods.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> logicInstance <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _logicInstances.Values) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> disposableInstance <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> logicInstance.DisposableInstances) { disposableInstance.Dispose(); } logicInstance.DisposableInstances.Clear(); logicInstance.ComponentInstances.Clear(); logicInstance.MonoBehaviourMethods.Clear(); } _logicInstances.Clear(); _instance = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  <b>рдиреЛрдЯ</b> : рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрджрд┐ рджреГрд╢реНрдп рдЙрддрд╛рд░рдиреЗ рдХреЗ рд╕рдордп рддрд░реНрдХ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореМрдЬреВрдж рд╣реИрдВ, рддреЛ рдЙрдирдореЗрдВ рд╕рдлрд╛рдИ рд╣реЛрддреА рд╣реИред <br><br><h3>  рдПрдХрддрд╛ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛ рдФрд░ рд╕рдорд╛рдзрд╛рди </h3><br>  рджреГрд╢реНрдп рд╕рдВрдкрд╛рджрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд▓реЗрдЦ рдХреЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдореИрдВрдиреЗ рджреГрд╢реНрдп рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд▓рд┐рдВрдХ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреА рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛, рдЬреЛ рдХреНрд░рдордмрджреНрдз рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрдерддрд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред  рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рд╣рд░ рдмрд╛рд░ рджреГрд╢реНрдп рд▓реЙрдиреНрдЪ рд╣реЛрдиреЗ рдкрд░ рджреГрд╢реНрдп рд╡рд╕реНрддреБрдУрдВ рдХреА рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдЕрд▓рдЧ рд╣реЛрддреА рд╣реИред  рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдПрдХрдорд╛рддреНрд░ рд╡рд┐рдХрд▓реНрдк рд╣реИ - рдпрд╣ рджреГрд╢реНрдп рдореЗрдВ рд▓рд┐рдВрдХ рдХреЗ рднрдВрдбрд╛рд░рдг рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдпреЛрдЬрди рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд┐рд╢реЗрд╖ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдФрд░ рдПрдХ рд░реИрдкрд░ рдХреНрд▓рд╛рд╕ рдХреЛ рд▓реЙрдЬрд┐рдХ рдХрдВрдЯреНрд░реЛрд▓рд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЙрдЬрд┐рдХ рдШрдЯрдХ <b>рдпреВрдирд┐рдЯреА</b> рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд╕рдВрджрд░реНрдн рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рд╕рдВрд╕рд╛рдзрди, рдкреНрд░реАрдлрд╝реИрдм рдФрд░ рдЕрдиреНрдп рдкрд░рд┐рд╕рдВрдкрддреНрддрд┐рдпрд╛рдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Serializable</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ObjectLinkData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Id =&gt; _id; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> UnityEngine.Object Obj =&gt; _obj; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _id = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UnityEngine.Object _obj; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ObjectLinkData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, UnityEngine.Object obj</span></span></span><span class="hljs-function">)</span></span> { _id = id; _obj = obj; } } [SerializeField] [HideInInspector] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;ObjectLinkData&gt; _objectLinks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;ObjectLinkData&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> UnityEngine.<span class="hljs-function"><span class="hljs-function">Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkData = _objectLinks.Find(link =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Compare(link.Id, id, StringComparison.Ordinal) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> linkData?.Obj; }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣рд╛рдВ: </font></font><br><br><ol><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдИрдбреА</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд╕рдВрдкрддреНрддрд┐ рдпрд╛ рджреГрд╢реНрдп рд╡рд╕реНрддреБ рдХрд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдУрдмреНрдЬ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд╕рдВрдкрддреНрддрд┐ рдпрд╛ рджреГрд╢реНрдп рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ</font></font></li></ol><br></div></div><br>    ,  . <br><br><div class="spoiler"> <b class="spoiler_title">  -   Unity</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Serializable</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VLObject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Id =&gt; _id; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> UnityEngine.Object Obj { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_obj == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !_objNotFound) { _obj = Core.LogicController.Instance.GetObject(Id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_obj == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _objNotFound = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _obj; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UnityEngine.Object _obj; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _objNotFound; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VLObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VLObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">UnityEngine.Object obj</span></span></span><span class="hljs-function">)</span></span> { _obj = obj; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> T Get&lt;T&gt;() <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T : UnityEngine.Object { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> T; } }</code> </pre><br> <b></b> :  <b>_objNotFound</b> ,        ,     . <br></div></div><br><h2>  </h2><br> ,  ,       .       ,   ,           , ..       <b>Unity</b> .   <b>Update</b>  <b>MonoBehaviour</b>   <b>uViLEd</b>      - ,     ,      1000   .    тАФ    ,          ,    (  <b>Android</b>  <b>iOS</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рдЕрдВрддрд░ рдмрдбрд╝рд╛ рд╣реИред </font><font style="vertical-align: inherit;">70 рдШрдЯрдХреЛрдВ рдФрд░ рд▓рдЧрднрдЧ 150 рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рддрд░реНрдХ рдореЗрдВ (рдЪрд░реЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рд╕рд╣рд┐рдд), рд╕рдВрдЦреНрдпрд╛рдПрдБ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдереАрдВ:</font></font><br><br><ol><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдВрдбреНрд░реЙрдЗрдб</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рдмрд╣реБрдд рдФрд╕рдд рджрд░реНрдЬреЗ рдХрд╛ рдореАрдбрд┐рдпрд╛рдЯреЗрдХ 8-рдХреЛрд░) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдЖрд╡реЗрджрди рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ - ~ тАЛтАЛ750ms </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдЪрд▓ рд░рд╣реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рджреГрд╢реНрдп рдЪрд▓ рд░рд╣рд╛ рд╣реИ ~ 250ms</font></font><br></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iOS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (iPhone 5s) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ - ~ тАЛтАЛ100ms </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рд░рдирд┐рдВрдЧ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рджреГрд╢реНрдп рдЪрд▓ рд░рд╣рд╛ рд╣реИ ~ 50ms</font></font><br></li></ol><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UViLEd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд┐рд╕реНрдЯрдо </font><b><font style="vertical-align: inherit;">рдХрд╛</font></b><font style="vertical-align: inherit;"> рдХрд░реНрдиреЗрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ </font><font style="vertical-align: inherit;">рдХрд╛рдлреА рд╕рд░рд▓ рдФрд░ рд╕реАрдзрд╛ рд╣реИ, рдЗрд╕реЗ рд╡рд┐рдЬрд╝реБрдЕрд▓ рдПрдбрд┐рдЯрд░ рд╕реЗ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЙрдЪрд┐рдд рдирд╣реАрдВ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдореИрдВ рдпрд╣ рдирд╣реАрдВ рдЫреЛрдбрд╝рддрд╛ рдХрд┐ рдХреБрдЫ рд╕рдорд╛рдзрд╛рди рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╕рд╛рдмрд┐рдд рд╣реЛрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рднреА, рдпрд╣ рд▓реЗрдЦ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕рдордЭ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдЕрдВрддрд┐рдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕рд╛ рд╕реНрд╡рдпрдВ рд╕рдВрдкрд╛рджрдХ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдЕрдВрддрд┐рдо рдЕрдВрддрд┐рдо рднрд╛рдЧ, рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдШрдЯрдирд╛рдкреВрд░реНрдг рд╣реЛрдЧрд╛, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдкрд┐рдд рд╣реЛрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреБрдирд╢реНрдЪ: рд▓реЗрдЦ рдХрд╛ рд▓реЗрдЦрди рдмрд╣реБрдд рд▓рдВрдмрд╛ рдерд╛, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдореИрдВ рдорд╛рдлреА рдорд╛рдБрдЧрддрд╛ рд╣реВрдБред </font><font style="vertical-align: inherit;">рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдореИрдВрдиреЗ рдПрдХ рдмрд╛рд░ рдореЗрдВ рд╕рднреА рд╢реЗрд╖ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЛ рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ, рд▓реЗрдХрд┐рди рдПрдХрддрд╛ 3 рдбреА рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рд░рд┐рд╣рд╛рдИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдорд╣рддреНрд╡рдкреВрд░реНрдг (рд╕реБрдЦрдж рдФрд░ рдРрд╕рд╛ рдирд╣реАрдВ) рдЭрдЯрдХреЗ, рдпреЛрдЬрдирд╛рдУрдВ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тЖТ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпреВрдирд┐рдЯреА 3 рдбреА рдХреЗ рд▓рд┐рдП рд╡рд┐рдЬреБрдЕрд▓ рд▓реЙрдЬрд┐рдХ рдПрдбрд┐рдЯрд░ред</font></font></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 1</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi466187/">https://habr.com/ru/post/hi466187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi466169/index.html">JetBrains рд╕реЗ рдХрд╛рдордХрд╛рдЬреА рдЫрд╛рддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рдкреЗрд╢рдХрд╢</a></li>
<li><a href="../hi466171/index.html">JUG.EKB рдХреЗ рд▓рд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдкрд╛рдВрдЪ рдХрд╛рд░рдг</a></li>
<li><a href="../hi466179/index.html">рд╕реБрдзрд╛рд░: рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдФрд░ JSONSchema - рдЕрдзрд┐рдХрддрдо рд▓рдЪреАрд▓рд╛рдкрди</a></li>
<li><a href="../hi466181/index.html">рд╕реА (рд╕реА рдПрдкреАрдЖрдИ) рд╕реЗ рдЕрдЬрдЧрд░</a></li>
<li><a href="../hi466183/index.html">ClickHouse рдореЗрдВ рд╕реНрдорд╛рд░реНрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо</a></li>
<li><a href="../hi466191/index.html">рд╕рдВрдпреБрдХреНрдд рд░рд╛рдЬреНрдп рдЕрдореЗрд░рд┐рдХрд╛ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рддрдЯрд╕реНрдерддрд╛ рдХреА рд▓рдбрд╝рд╛рдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореБрдЦреНрдп рдмрд╛рдд рдШрдЯрдирд╛рдУрдВ рдХреА рдХрд╛рд▓рдХреНрд░рдо рдФрд░ рдорд╛рдорд▓реЛрдВ рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рд╣реИ</a></li>
<li><a href="../hi466193/index.html">рдЖрд░рдПрд╕рдПрд╕ рдлрд╝реАрдб рд╕реЗ рдХрд╕реНрдЯрдо MailChimp рдСрдЯреЛ-рдлреАрдб</a></li>
<li><a href="../hi466195/index.html">рдкреАрд╡реАрдПрд╕-рд╕реНрдЯреВрдбрд┐рдпреЛ 7.04</a></li>
<li><a href="../hi466197/index.html">рдкреАрд╡реАрдПрд╕-рд╕реНрдЯреВрдбрд┐рдпреЛ 7.04</a></li>
<li><a href="../hi466199/index.html">PostgreSQL рдореЗрдВ рддрд╛рд▓реЗ: 4. рдореЗрдореЛрд░реА рдореЗрдВ рддрд╛рд▓реЗ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>