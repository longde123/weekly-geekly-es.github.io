<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õîÔ∏è üëêüèæ üëç Architecture de m√©ta-serveur de tir en ligne mobile Tacticool üë©üèø‚Äç‚úàÔ∏è üë®‚Äçüè´ üå°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un autre entretien avec Pixonic DevGAMM Talks - cette fois de nos coll√®gues de PanzerDog. L'ing√©nieur logiciel en chef de la soci√©t√© Pavel Platto a d√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Architecture de m√©ta-serveur de tir en ligne mobile Tacticool</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/426875/">  Un autre entretien avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pixonic DevGAMM Talks</a> - cette fois de nos coll√®gues de PanzerDog.  L'ing√©nieur logiciel en chef de la soci√©t√© Pavel Platto a d√©mont√© le m√©ta-serveur du jeu avec une architecture orient√©e services, a expliqu√© quelles solutions et technologies ont √©t√© choisies, ce qu'elles ont fait et comment elles ont √©volu√©, et quelles difficult√©s elles ont d√ª affronter.  Le texte du rapport, des diapositives et des liens vers d'autres discours du mitap, comme toujours, sous la coupe. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/JcuOHUzXXHw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  Tout d'abord, je veux montrer une petite bande-annonce de notre jeu: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yIpGvbbMCn4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <br>  Le rapport comprendra 3 parties.  Dans le premier, je parlerai des technologies que nous avons choisies et pourquoi, dans le second - comment notre m√©ta-serveur est organis√©, et dans le troisi√®me, je parlerai des diverses infrastructures de support que nous utilisons, et comment nous avons mis en ≈ìuvre la mise √† jour sans temps d'arr√™t . <br><br><img src="https://habrastorage.org/webt/-s/fg/tz/-sfgtzhre4ij6b0n9-b_r0cako4.png"><br>  <i>Pile technologique</i> <br><br>  Le m√©ta serveur est h√©berg√© sur Amazon et √©crit en Elixir.  Il s'agit d'un langage de programmation fonctionnel avec un mod√®le de calcul acteur.  Comme nous n'avons pas d'Ops, les programmeurs sont impliqu√©s dans l'op√©ration, et la plupart de l'infrastructure est d√©crite comme du code utilisant HashiCorp Terraform. <br><br>  Tacticool est actuellement en version b√™ta ouverte, le m√©ta-serveur est en d√©veloppement depuis un peu plus d'un an et fonctionne depuis pr√®s d'un an.  Voyons comment tout a commenc√©. <br><br><img src="https://habrastorage.org/webt/zs/a0/fa/zsa0favmdahf0gdsnt0-goxhrnq.png"><br><br>  Lorsque j'ai rejoint l'entreprise, nous avions d√©j√† impl√©ment√© des fonctionnalit√©s de base sous la forme d'un monolithe sur un mix C / C ++ et un stockage PostageSQL.  Cette mise en ≈ìuvre a rencontr√© certains probl√®mes. <br><br>  Tout d'abord, en raison du faible niveau de C, il y avait pas mal de bugs insaisissables.  Par exemple, pour certains joueurs, le matchmaking se bloque en raison d'une mise √† z√©ro incorrecte du tableau avant sa r√©utilisation.  Bien s√ªr, trouver la relation entre ces deux √©v√©nements √©tait assez difficile.  Et puisque l'√©tat de plusieurs threads a √©t√© universellement modifi√© dans le code, les conditions de course n'√©taient pas sans. <br><br>  Le traitement parall√®le d'un grand nombre de t√¢ches √©tait √©galement hors de question, car le serveur a d√©marr√© au d√©but d'une dizaine de processus de travail, bloqu√©s par des requ√™tes vers Amazon ou la base de donn√©es.  Et m√™me si nous oublions ces demandes de blocage, le service a commenc√© √† s'effondrer sur quelques centaines de connexions qui n'ont effectu√© aucune op√©ration √† l'exception du ping.  De plus, le service n'a pas pu √™tre mis √† l'√©chelle horizontalement. <br><br>  Apr√®s quelques semaines pass√©es √† trouver et √† corriger les bogues les plus critiques, nous avons d√©cid√© qu'il √©tait plus facile de tout r√©√©crire √† partir de z√©ro que d'essayer de corriger toutes les lacunes de la solution actuelle. <br><br>  Et lorsque vous partez de z√©ro, il est logique d'essayer de choisir une langue qui vous aidera √† √©viter certains des probl√®mes pr√©c√©dents.  Nous avions trois candidats: <br><br><ul><li>  C #; </li><li>  Allez; </li><li>  √âlixir. </li></ul><br><img src="https://habrastorage.org/webt/_f/vt/q5/_fvtq51jwvlo2uuquqy-4vwsnhw.png"><br><br>  C # figurait sur la liste des ¬´connaissances¬ª,  le client et le serveur de jeu sont √©crits en Unity, et la plupart de l'exp√©rience de l'√©quipe √©tait avec ce langage de programmation.  Go et Elixir ont √©t√© pris en compte car ce sont des langages modernes et assez populaires cr√©√©s pour d√©velopper des applications serveur. <br><br>  Les probl√®mes de l'it√©ration pr√©c√©dente nous ont aid√©s √† d√©terminer les crit√®res d'√©valuation des candidats. <br><br>  Le premier crit√®re √©tait la commodit√© de travailler avec des op√©rations asynchrones.  En C #, le travail pratique avec les op√©rations asynchrones n'apparaissait pas du premier coup.  Cela a conduit au fait que nous avons un ¬´zoo¬ª de solutions qui, √† mon avis, sont encore un peu en retrait.  Dans Go et Elixir, ce probl√®me a √©t√© pris en compte lors de la conception de ces langages, ils utilisent tous les deux des threads l√©gers (dans Go ce sont des goroutines, dans Elixir ce sont des processus).  Ces flux ont une surcharge beaucoup plus petite que les threads syst√®me, et comme nous pouvons les cr√©er par dizaines et centaines de milliers, nous ne sommes pas f√¢ch√©s de les bloquer. <br><br>  Le deuxi√®me crit√®re √©tait la capacit√© de travailler avec des processus comp√©titifs.  C # pr√™t √† l'emploi n'offre rien d'autre que des pools de threads et de la m√©moire partag√©e, dont l'acc√®s doit √™tre prot√©g√© √† l'aide de diverses primitives de synchronisation.  Go a un mod√®le moins sujet aux erreurs sous la forme de goroutines et de canaux.  Elixir, quant √† lui, propose un mod√®le d'acteur sans m√©moire partag√©e avec messagerie.  Le manque de m√©moire partag√©e a permis de mettre en ≈ìuvre des technologies utiles pour un environnement d'ex√©cution comp√©titif lors de l'ex√©cution, telles que le multit√¢che √† emporter honn√™te et la collecte des ordures sans interruption dans le monde. <br><br>  Le troisi√®me crit√®re √©tait la disponibilit√© d'outils pour travailler avec des types de donn√©es immuables.  Toute mon exp√©rience de d√©veloppement a montr√© qu'une partie assez importante des bogues est associ√©e √† des modifications de donn√©es incorrectes.  Il existe une solution √† cela il y a longtemps - des types de donn√©es immuables.  En C #, ces types de donn√©es peuvent √™tre cr√©√©s, mais au prix d'une tonne de passe-partout.  Dans Go, ce n'est pas possible du tout.  Et dans Elixir, tous les types de donn√©es sont immuables. <br><br>  Et le dernier crit√®re √©tait le nombre de sp√©cialistes.  Ici, les r√©sultats sont √©vidents.  Au final, nous avons opt√© pour Elixir. <br><br>  Avec le choix de l'h√©bergement, tout √©tait beaucoup plus simple.  Nous avons d√©j√† h√©berg√© des serveurs de jeux dans Amazon GameLift, en outre, Amazon propose un grand nombre de services qui nous permettraient de r√©duire le temps de d√©veloppement. <br><br><img src="https://habrastorage.org/webt/f2/zm/jn/f2zmjnyjejb3ffw0vhs69hvqjoi.png"><br><br>  Nous nous sommes compl√®tement abandonn√©s au cloud et ne d√©ployons nous-m√™mes aucune solution tierce - bases de donn√©es, files d'attente de messages - tout cela est g√©r√© par Amazon pour nous.  √Ä mon avis, c'est la seule solution pour une petite √©quipe qui veut d√©velopper un jeu en ligne, et non l'infrastructure pour cela. <br><br>  Nous avons compris le choix des technologies, passons au fonctionnement du m√©ta-serveur. <br><br><img src="https://habrastorage.org/webt/q1/jy/m8/q1jym8itnftw6e3tqyvsbqh-uva.png"><br><br>  En g√©n√©ral: les clients se connectent √† l'√©quilibreur de charge d'Amazon via des connexions de socket Web;  l'√©quilibreur diffuse ces connexions entre plusieurs instances frontales, le frontal envoie des requ√™tes client aux backends.  Mais le front-end et le back-end communiquent indirectement, via des files d'attente de messages.  Il existe une file d'attente distincte pour chaque type de message, et le frontend, par le type de message, d√©termine o√π l'√©crire, et les backends √©coutent ces files d'attente. <br><br>  Pour que le backend puisse envoyer une r√©ponse √† la demande au client, ou une sorte d'√©v√©nement, chaque frontend a une file d'attente distincte (sp√©cialement allou√©e pour cela).  Et dans chaque demande, le backend re√ßoit un identifiant de frontend pour d√©terminer dans quelle file d'attente la r√©ponse doit √™tre √©crite.  S'il doit envoyer un √©v√©nement, il appelle la base de donn√©es pour savoir √† quelle instance frontend le client est connect√©. <br><br>  Avec le sch√©ma g√©n√©ral, passons aux d√©tails. <br><br><img src="https://habrastorage.org/webt/xe/rr/u-/xerru-5vn3tx-dwqbylflu18mrm.png"><br><br>  Tout d'abord, je parlerai de certaines caract√©ristiques de l'interaction client-serveur.  Nous utilisons notre protocole binaire car il est assez efficace et permet d'√©conomiser du trafic.  Deuxi√®mement, pour toutes les op√©rations avec un compte qui le modifient, le serveur n'envoie pas ces modifications au client, mais la version compl√®te (mise √† jour) de ce compte.  C'est un peu moins efficace, mais cela ne prend pas beaucoup d'espace de toute fa√ßon et simplifie consid√©rablement notre vie √† la fois sur le client et sur le serveur.  De plus, le frontend garantit que le client n'ex√©cute pas plus d'une demande √† la fois.  Cela vous permet d'attraper des bogues sur le client, par exemple, lorsqu'il passe √† un autre √©cran avant que le joueur ne voie le r√©sultat de l'op√©ration pr√©c√©dente. <br><br>  Maintenant, un peu sur la fa√ßon dont le frontend est organis√©. <br><br><img src="https://habrastorage.org/webt/te/-k/ff/te-kffgzvatzj_3tjwcus5lvpdk.png"><br><br>  Un frontend est essentiellement un serveur Web qui √©coute les connexions de socket Web.  Pour chaque session, deux processus sont cr√©√©s.  Le premier processus sert la connexion de socket Web elle-m√™me, et le second est une machine d'√©tat qui d√©crit l'√©tat actuel du client.  Sur la base de cet √©tat, il d√©termine la validit√© des demandes du client.  Par exemple, presque toutes les demandes ne peuvent pas √™tre trait√©es tant que l'autorisation n'est pas termin√©e.  Puisqu'il n'y a aucun √©tat sur le frontend en dehors de ces sessions, il est tr√®s facile d'ajouter de nouvelles instances frontend, mais il est un peu plus difficile de supprimer les anciennes.  Avant la d√©sinstallation, vous devez laisser tous les clients terminer leurs demandes en cours et leur demander de se reconnecter √† une autre instance. <br><br>  Maintenant, √† quoi ressemble le backend.  √Ä l'heure actuelle, il se compose de cinq services. <br><br><img src="https://habrastorage.org/webt/qh/cj/x4/qhcjx4ckmzg8lcqpriouhi8rnee.png"><br><br>  Le premier traite de tout ce qui concerne les comptes - des achats de devises dans le jeu √† la r√©alisation de qu√™tes.  Le second fonctionne avec tout ce qui concerne les matchs - il interagit directement avec GameLift et les serveurs de jeux.  Le troisi√®me service consiste √† acheter de l'argent r√©el.  Le quatri√®me et le cinqui√®me sont responsables des interactions sociales - l'un pour les amis, l'autre pour un jeu de soci√©t√©. <br><br>  Chacun des services backend d'un point de vue architectural est absolument identique.  Il s'agit d'un ensemble de pipelines, chacun traitant un type de message.  Le pipeline comprend deux √©l√©ments: le producteur et le consommateur. <br><br><img src="https://habrastorage.org/webt/ym/di/eh/ymdiehrcngon3im1my2d8nbbgsk.png"><br><br>  La seule t√¢che du producteur est de lire les messages de la file d'attente.  Par cons√©quent, il est mis en ≈ìuvre sous une forme compl√®tement g√©n√©rale et pour chaque pipeline, nous n'avons qu'√† indiquer le nombre de producteurs, la file d'attente √† lire et le nombre de consommateurs que chaque producteur servira.  Le consommateur, d'autre part, est impl√©ment√© s√©par√©ment pour chaque pipeline et est un module avec la seule fonction obligatoire qui accepte un message, effectue tout le travail n√©cessaire et renvoie une liste de messages qui doivent √™tre envoy√©s √† d'autres services au client ou au serveur de jeu.  Le producteur met √©galement en place une contre-pression afin qu'avec une forte augmentation du nombre de messages il n'y ait pas de surcharge, et ne demande pas plus de messages qu'il n'a de consommateurs gratuits. <br><br>  Les services principaux ne contiennent aucun √©tat, il nous est donc facile d'ajouter et de supprimer d'anciennes instances.  La seule chose √† faire avant de supprimer est de demander aux producteurs d'arr√™ter de lire les nouveaux messages et de donner aux consommateurs un peu de temps pour terminer le traitement des messages actifs. <br><br>  Comment l'interaction avec GameLift se produit-elle?  GameLift se compose de plusieurs composants.  Parmi ceux que nous utilisons, il s'agit d'un entremetteur FlexMatch, une file d'attente de placement qui d√©termine dans quelle r√©gion particuli√®re h√©berger une session de jeu avec ces joueurs, et les flottes elles-m√™mes, compos√©es de serveurs de jeu. <br><br><img src="https://habrastorage.org/webt/c8/ge/5h/c8ge5huiowlmu5q7b9izd4sew4y.png"><br><br>  Comment se passe cette interaction?  Meta ne communique directement qu'avec le marieur, lui envoie des demandes pour trouver le match.  Et il notifie la m√©ta de tous les √©v√©nements pendant le matchmaking via les m√™mes files d'attente de messages.  Et d√®s qu'il trouve un groupe de joueurs appropri√© pour commencer le match, il envoie une demande √† la file d'attente de placement, qui √† son tour s√©lectionne un serveur pour eux. <br><br>  L'interaction de la m√©ta avec le serveur de jeu est extr√™mement simple.  Le serveur de jeu a besoin d'informations sur les comptes, les robots et une carte, et la m√©ta envoie toutes ces informations √† la file d'attente cr√©√©e sp√©cifiquement pour cette correspondance dans un seul message. <br><br><img src="https://habrastorage.org/webt/vv/zo/y5/vvzoy5ycub5em-qiovlo911pg0k.png"><br><br>  Et le serveur de jeu, lors de l'activation, commence √† √©couter cette file d'attente et re√ßoit toutes les donn√©es dont il a besoin.  √Ä la fin du match, il envoie ses r√©sultats √† la file d'attente g√©n√©rale que la m√©ta √©coute. <br><br>  Passons maintenant √† l'infrastructure suppl√©mentaire que nous utilisons. <br><br><img src="https://habrastorage.org/webt/l-/st/nu/l-stnuybsqrbk_be4fhlgrsdgpa.png"><br><br>  Le d√©ploiement de services est assez simple.  Ils fonctionnent tous dans des conteneurs Docker et nous utilisons Amazon ECS pour l'orchestration.  Il est beaucoup plus simple que Kubernetes, bien s√ªr, moins sophistiqu√©, mais il effectue les t√¢ches dont nous avons besoin.  √Ä savoir: les services de mise √† l'√©chelle et les versions glissantes, lorsque nous devons remplir une sorte de correction de bogue. <br><br>  Et le dernier service que nous utilisons √©galement est AWS Fargate.  Cela nous √©vite d'avoir √† g√©rer de mani√®re ind√©pendante le cluster de machines sur lequel nos conteneurs Docker fonctionnent. <br><br><img src="https://habrastorage.org/webt/q1/xl/8m/q1xl8mppdukmbjoezzm6pzlbl9k.png"><br><br>  En tant que stockage principal, nous utilisons DynamoDB.  Tout d'abord, nous l'avons choisi car il est tr√®s simple d'utilisation et de mise √† l'√©chelle.  Nous utilisons √©galement Redis comme stockage suppl√©mentaire via le service g√©r√© Amazon ElasiCache.  Nous l'utilisons pour la t√¢che globale de classement des joueurs et pour la mise en cache des informations de base sur les comptes dans les situations o√π nous devons renvoyer imm√©diatement des donn√©es sur des centaines de comptes de jeu au client (par exemple, dans le m√™me tableau de classement ou dans la liste d'amis). <br><br>  Pour stocker des configurations, des m√©canismes de m√©ta-gameplay, des descriptions d'armes, de h√©ros, etc.  nous utilisons un fichier JSON que nous attachons aux images des services qui en ont besoin.  Parce qu'il est beaucoup plus facile pour nous de d√©ployer une nouvelle version du service avec des donn√©es mises √† jour (si un bogue a √©t√© d√©couvert) que de prendre une d√©cision qui mettra √† jour dynamiquement ces donn√©es √† partir d'un stockage externe pendant l'ex√©cution. <br><br>  Pour la journalisation et la surveillance, nous utilisons plusieurs services. <br><br><img src="https://habrastorage.org/webt/lh/ub/3u/lhub3urulc1urcn8omuxprcn0rg.png"><br><br>  Commen√ßons par CloudWatch.  Il s'agit d'un service de surveillance dans lequel les m√©triques de tous les services Amazon affluent.  Par cons√©quent, nous avons d√©cid√© d'envoyer les m√©triques de notre serveur m√©ta l√† aussi.  Et pour la journalisation, nous utilisons une approche commune √† la fois sur le client et sur le serveur de jeu et sur le m√©ta-serveur.  Nous envoyons tous les journaux au service amazonien Kinesis Firehose, qui les transf√®re √† son tour √† Elasticseach et S3. <br><br>  Dans Elasticseach, nous ne stockons que des donn√©es relativement r√©centes et avec l'aide de Kibana, nous recherchons les erreurs, r√©solvons certaines des t√¢ches d'analyse de jeu et cr√©ons des tableaux de bord op√©rationnels, par exemple, avec un calendrier CCU et le nombre de nouvelles installations.  S3 contient toutes les donn√©es historiques et nous les utilisons via le service Athena, qui fournit une interface SQL en plus des donn√©es dans S3. <br><br>  Maintenant, un peu sur la fa√ßon dont nous utilisons Terraform. <br><br><img src="https://habrastorage.org/webt/o8/jj/-q/o8jj-qfa1hsyq1qposebwbof4dc.png"><br><br>  Terraform est un outil qui vous permet de d√©crire de mani√®re d√©clarative l'infrastructure et, en cas de changement de description, il d√©termine automatiquement les actions que vous devez entreprendre pour mettre votre infrastructure √† jour.  Ainsi, ayant une seule description, nous obtenons un environnement presque identique pour la mise en sc√®ne et la production.  De plus, ces environnements sont compl√®tement isol√©s, car ils sont d√©ploy√©s sous diff√©rents comptes.  Le seul inconv√©nient significatif de Terraform pour nous est le support incomplet de GameLift. <br><br>  Je parlerai √©galement de la fa√ßon dont nous avons mis en ≈ìuvre la mise √† jour sans interruption. <br><br><img src="https://habrastorage.org/webt/_l/ge/va/_lgevakn50wndn5tvfipi1_ujam.png"><br><br>  Lorsque nous publions des mises √† jour, nous collectons une copie de la plupart des ressources: services, files d'attente de messages, certaines √©tiquettes dans la base de donn√©es.  Et les joueurs qui t√©l√©chargent la nouvelle version du jeu se connecteront √† ce cluster mis √† jour.  Mais les joueurs qui n'ont pas encore mis √† jour peuvent continuer √† jouer pendant un certain temps sur l'ancienne version du jeu, en se connectant √† l'ancien cluster. <br><br>  Comment nous l'avons mis en ≈ìuvre.  Tout d'abord, en utilisant le moteur de module dans Terraform.  Nous avons allou√© un module dans lequel nous avons d√©crit toutes les ressources versionn√©es.  Et ces modules peuvent √™tre import√©s plusieurs fois, avec diff√©rents param√®tres.  En cons√©quence, pour chaque version, nous importons ce module, en indiquant le num√©ro de cette version.  L'absence de sch√©ma dans DynamoDB nous a √©galement aid√©s, ce qui permet d'effectuer des migrations de donn√©es non pas lors de la mise √† jour, mais de les reporter pour chaque compte jusqu'√† ce que son propri√©taire se connecte √† la nouvelle version du jeu.  Et dans l'√©quilibreur, nous indiquons simplement pour chaque version de la r√®gle afin qu'il sache o√π acheminer les joueurs avec diff√©rentes versions. <br><br>  Enfin, quelques choses que nous avons apprises.  Tout d'abord, la configuration de l'ensemble de l'infrastructure doit √™tre automatis√©e.  C'est-√†-dire  nous avons mis en place certaines choses avec nos mains pendant un certain temps, mais t√¥t ou tard, nous avons fait une erreur dans les param√®tres, √† cause de laquelle il y avait des fakaps. <br><br><img src="https://habrastorage.org/webt/5i/3n/7f/5i3n7fuurk18kiak_krk6jy8w8s.png"><br><br>  Et la derni√®re chose - vous devez avoir une r√©plique ou une copie de sauvegarde pour chaque √©l√©ment de votre infrastructure.  Et si vous ne le faites pas pour quelque chose, alors cette chose particuli√®re nous d√©cevra jamais. <br><br><h3>  Questions du public </h3><br>  <b>- Mais cela ne vous d√©range pas que la mise √† l'√©chelle automatique puisse trop coller √† cause d'une sorte d'erreur et vous obtiendrez beaucoup d'argent?</b> <br><br>  - Pour la mise √† l'√©chelle automatique, des limites sont toujours d√©finies.  Nous ne fixerons pas de limite trop importante pour ne pas tomber pour beaucoup d'argent.  C'est la principale solution + surveillance.  Vous pouvez d√©finir des alertes si quelque chose est trop fort. <br><br>  <b>- Quelles sont vos limites actuelles?</b>  <b>Par rapport √† l'infrastructure actuelle en pourcentage.</b> <br><br>  - Nous avons maintenant une phase de test b√™ta ouvert dans 11 pays, donc ce n'est pas un si gros CCU √† √©valuer d'une mani√®re ou d'une autre.  Maintenant, l'infrastructure est trop surprovisionn√©e pour le nombre de personnes que nous avons. <br><br>  <b>- Et il n'y a pas encore de limites?</b> <br><br>  - Oui, c'est juste qu'ils sont 10 √† 100 fois plus que notre CCU.  Ne faites pas moins. <br><br>  <b>- Vous avez dit que vous aviez des lignes entre le front et le backend - c'est tr√®s inhabituel.</b>  <b>Pourquoi pas directement?</b> <br><br>  - Nous voulions que les services sans √©tat impl√©mentent facilement le m√©canisme de sauvegarde, afin que le service ne demande pas plus de messages qu'il n'en a de gestionnaires gratuits.  En outre, par exemple, lorsqu'un gestionnaire √©choue, la file d'attente transmet le m√™me message √† un autre gestionnaire - elle r√©ussira peut-√™tre. <br><br>  <b>- La file d'attente persiste-t-elle d'une mani√®re ou d'une autre?</b> <br><br>  - Oui.  Il s'agit d'un service SQS amazonien. <br><br>  <b>- Concernant les files d'attente: combien de canaux sont cr√©√©s pendant le jeu?</b>  <b>Avez-vous un certain nombre de cha√Ænes pour chaque match?</b> <br><br>  - Il cr√©e relativement peu.  La plupart des files d'attente, telles que les files d'attente de demandes, sont statiques.  Il y a une file d'attente de demandes d'autorisation, il y a une file d'attente pour le d√©but du match.  Parmi les files d'attente cr√©√©es dynamiquement, nous n'avons que des files d'attente pour chaque frontend (cela cr√©e des messages entrants pour les clients au d√©marrage) et pour chaque correspondance, nous cr√©ons une file d'attente.  Dans ce service, cela ne co√ªte presque rien, ils ont toute demande factur√©e de la m√™me mani√®re.  C'est-√†-dire  toute demande √† SQS (cr√©er une file d'attente, en lire quelque chose) co√ªte la m√™me chose et en m√™me temps nous ne supprimons pas ces files d'attente pour les enregistrer, elles seront supprim√©es plus tard.  Et le fait qu'ils existent ne nous co√ªte rien. <br><br>  <b>- Dans cette architecture, cela ne sera pas une limite pour vous?</b> <br><br>  - Non. <br><br><h3>  Plus d'entretiens avec Pixonic DevGAMM Talks </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Utiliser Consul pour faire √©voluer les services avec √©tat</a> (Ivan Bubnov, DevOps chez BIT.GAMES); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CICD: d√©ploiement transparent sur des syst√®mes de cluster distribu√©s sans temps d'arr√™t</a> (Egor Panov, administrateur syst√®me Pixonic); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La pratique de l'utilisation du mod√®le d'acteur dans la plateforme backend du jeu Quake Champions</a> (Roman Rogozin, d√©veloppeur backend Saber Interactive); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment ECS, C # Job System et SRP changent l'approche de l'architecture</a> (Valentin Simonov, Field Engineer chez Unity); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Principe KISS en d√©veloppement</a> (Konstantin Gladyshev, Lead Game Programmer chez 1C Game Studios); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Logique de jeu g√©n√©rale sur le client et le serveur</a> (Anton Grigoriev, directeur technique adjoint chez Pixonic). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Concombre dans le cloud: utilisation des scripts BDD pour les tests de</a> r√©sistance des produits (Anton Kosyakin, chef de produit technique sur la plate-forme ALICE). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426875/">https://habr.com/ru/post/fr426875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426861/index.html">Une nouvelle chasse √† la mati√®re noire prend place sous la montagne</a></li>
<li><a href="../fr426863/index.html">Disponible sur les quaternions et leurs avantages</a></li>
<li><a href="../fr426865/index.html">Une conception claire du tableau de bord pour un syst√®me de gestion des annonces sophistiqu√©</a></li>
<li><a href="../fr426869/index.html">Comment mener efficacement des vid√©oconf√©rences avec des clients √©trangers</a></li>
<li><a href="../fr426873/index.html">Contr√¥le automatique √† l'aide de l'acc√®s √† distance au registre Windows</a></li>
<li><a href="../fr426879/index.html">Mise en place d'un syst√®me de restriction √©lectrique pour les projets utilisant des interfaces haut d√©bit</a></li>
<li><a href="../fr426881/index.html">Lancement de programmes de d√©veloppement en ligne</a></li>
<li><a href="../fr426889/index.html">Comment participer √† des comp√©titions d'apprentissage automatique. Conf√©rence √† Yandex</a></li>
<li><a href="../fr426891/index.html">Exploration de processus SAP ou comment comprendre vos processus m√©tier</a></li>
<li><a href="../fr426893/index.html">Comment lancer une application iOS via React Native</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>