<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèª üññ üëÜ Perversiones curiosas del mundo de TI - 4 üå§Ô∏è üë®üèΩ‚Äçüíº üêè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El Daily WTF ha estado recopilando historias divertidas, salvajes y / o tristes del mundo de TI durante 15 a√±os. Traduje varias historias que me parec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Perversiones curiosas del mundo de TI - 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446714/"><div style="text-align:center;"><img src="https://ic.pics.livejournal.com/egor_23/73280836/1707368/1707368_1000.jpg" alt="imagen"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El Daily WTF</a> ha estado recopilando historias divertidas, salvajes y / o tristes del mundo de TI durante 15 a√±os.  Traduje varias historias que me parecieron interesantes.  Todos los nombres de compa√±√≠as y nombres han sido cambiados.  Los problemas anteriores se pueden encontrar bajo la etiqueta " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">perversiones curiosas</a> ". <br><br><h2>  La primera historia  Fin <s>de</s> mes </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[Original]</a> <br><br>  Si le pregunta a un ingeniero de dise√±o si es seguro cruzar un puente, estar√° encantado de decirle qu√© tan confiables son los puentes, c√≥mo funcionan las matem√°ticas en ellos, qu√© tan lejos hemos llegado en materia de seguridad en la construcci√≥n.  Despu√©s de hablar con √©l, tendr√° la impresi√≥n de que ni un solo puente en la Tierra se desmoronar√°.  Pero si le pregunta al ingeniero de desarrollo de software sobre los bancos, lo m√°s probable es que se horrorice, y con una probabilidad del 50/50 se convencer√° de invertir todo el dinero en bitcoin.  Los bancos son conocidos por sus malas decisiones al crear software, no porque estas decisiones sean desagradables, sino porque la mayor√≠a de las personas asumen que los bancos son m√°s precisos y cuidadosos con la seguridad. <br><br>  <b>Kato</b> trabaja en Inibank, donde se utiliza un producto comercial llamado T24 como n√∫cleo del sistema bancario.  El sistema T24 es utilizado por cientos de bancos en todo el mundo.  Se puede personalizar para una amplia gama de soluciones bancarias.  Como con la mayor√≠a de los paquetes personalizados.  Hay programadores que se especializan en escribir c√≥digo para √©l y consultores que ayudan a los bancos con actualizaciones importantes. <br><a name="habracut"></a><br>  El personal de Inibank estaba ocupado, por lo que el banco invit√≥ a un consultor a participar en un proyecto especial.  Al final de la jornada laboral, el banco realiz√≥ el proceso de finalizaci√≥n, que es necesario para que todo el dinero vaya a donde fue dirigido, se recalculen todos los datos de salida necesarios y se ejecuten todos los informes requeridos.  En los bancos, este proceso tambi√©n cambia la fecha del sistema al siguiente d√≠a h√°bil.  Es por eso que cuando realiza operaciones bancarias en l√≠nea el domingo, ni una sola transacci√≥n comienza a procesarse hasta el lunes por la ma√±ana.  El consultor tuvo que crear un nuevo informe que se ejecutar√≠a durante el proceso de finalizaci√≥n e inclu√≠a un procesamiento adicional si la fecha correspond√≠a al final del mes. <br><br>  Kato le mostr√≥ al nuevo consultor c√≥mo el banco establece los informes al final del d√≠a.  ‚ÄúVea, tenemos variables globales para el d√≠a h√°bil anterior, para hoy y para el d√≠a h√°bil siguiente.  Tienen el formato YYMMDD para facilitar el trabajo ". <br><br>  "S√≠, s√≠, lo tengo.  Lo entiendo  ¬øEn qu√© formato est√°n? <br><br>  "... Uhh ... solo puedo suponer que este es el a√±o, mes y d√≠a". <br><br>  "S√≠, s√≠, est√° bien.  Genial  Luego me pongo a trabajar. <br><br>  Despu√©s de esta conversaci√≥n, Kato tuvo un mal presentimiento sobre esto.  pero trat√≥ de deshacerse de √©l.  El consultor dijo que todo est√° listo y listo.  √âl sabe exactamente lo que est√° haciendo, ¬øverdad?  Kato se lo quit√≥ de la cabeza y dej√≥ de preocuparse hasta que lleg√≥ el momento de revisar el c√≥digo y encontr√≥ esa perla: <br><br><pre> <code class="hljs pgsql">TH.DATE = R.DATES(EB.DAT.NEXT.WORKING.DAY)[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>]:"01" <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> CDT(<span class="hljs-string"><span class="hljs-string">'ES00'</span></span>,TH.DATE,"-1C") WTODAY = OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DY") : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DM"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DD"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> TH.DATE EQ WTODAY <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span></code> </pre> <br>  Explica brevemente lo que sucede aqu√≠: <br><br><ol><li>  Tome el siguiente d√≠a h√°bil y cambie el d√≠a a 01 para obtener el primer d√≠a del mes. </li><li>  Cambiamos esta fecha restando 1 d√≠a calendario en el calendario de Espa√±a. </li><li>  Tomamos la fecha del servidor y la traducimos al formato AAAAMMDD, llamando al comando Fecha tres veces. </li><li>  Si la fecha calculada en el paso 2 es igual a la fecha calculada en el paso 3, inicie el proceso. </li></ol><br>  Bueno, en realidad ... funciona.  En su mayor parte  A menos que por alguna raz√≥n, el final del d√≠a no ocurra despu√©s de la medianoche del pen√∫ltimo d√≠a del mes, y esto no es tan raro.  En este caso, el c√≥digo pensar√° err√≥neamente que este es el √∫ltimo d√≠a del mes y comenzar√° a crear el informe.  Lo que va bien con otro problema: si sucede lo mismo el √∫ltimo d√≠a del mes, la creaci√≥n del informe no comenzar√° por error.  Y el mejor error: si el √∫ltimo d√≠a del mes result√≥ ser domingo, entonces el calendario del servidor nunca se instalar√° en √©l, ya que omite los d√≠as no laborables. <br><br>  Hablando de d√≠as no laborables: dado que Inibank se encuentra en los EE. UU., No hay raz√≥n para usar el calendario de Espa√±a.  S√≠, los meses y las semanas ser√°n los mismos, pero en el calendario de software espa√±ol debe especificar los d√≠as festivos en los EE. UU., De lo contrario, el programa continuar√° funcionando.  Finalmente, como si todo esto no fuera suficiente, la llamada de fecha triple significa que puede haber desacuerdos al comenzar exactamente a la medianoche: el mes se solicita antes de la medianoche y el d√≠a despu√©s. <br><br>  Kato agreg√≥ un comentario, sugiriendo una forma de cambiar el c√≥digo: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IF</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TODAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LAST</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WORKING</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">THEN</span></span></code> </pre> <br>  Cinco minutos despu√©s, el consultor fue a su escritorio.  "¬øQu√© significa esta edici√≥n?" <br><br>  Kato no estaba de humor para discutir en ese momento.  ‚ÄúTu c√≥digo est√° roto, amigo.  Todo esto no es necesario ". <br><br>  ‚ÄúYa veo, ya veo.  En realidad, esto es solo un procedimiento operativo est√°ndar para nuestra industria.  Bueno, est√° bien ". <br><br>  Kato lo dudaba mucho, pero simplemente se encogi√≥ de hombros.  ‚ÄúEntonces la industria est√° equivocada.  Le expliqu√© todo en el comentario ". <br><br>  "S√≠.  Si, lo lei.  Pero lo volver√© a leer.  Y desapareci√≥ tan repentinamente como apareci√≥. <br><br>  Se hicieron modificaciones, Kato aprob√≥ el c√≥digo y el consultor desapareci√≥ en la niebla. <br><br>  A veces, acostado en la cama por la noche, Kato se preguntaba: ¬øel asesor realmente entend√≠a lo que hab√≠a hecho mal, o simplemente accedi√≥ a mirar, recibi√≥ su cheque y continu√≥ escribiendo en alg√∫n lugar un c√≥digo terrible por un precio dos veces el salario de Kato?  En aquellos bancos donde no hay empleados que puedan verificar el c√≥digo. <br><br>  Pero no invierta todo el dinero en bitcoin.  Es a√∫n peor all√≠. <br><br><h2>  La segunda historia.  ¬øC√≥mo se hace esto? </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[Original]</a> <br><br>  A la gente le encanta comer hot dogs hasta que descubran c√≥mo cocinan.  La mayor√≠a no pregunta, porque no quieren saber y contin√∫an comiendo hot dogs.  Al desarrollar software, a veces <em>tenemos que</em> preguntar.  No solo para resolver problemas, sino tambi√©n porque algunos programadores temen que el software en sus autom√≥viles, que viajan a lo largo de la carretera a una velocidad de 100 km / h, est√© ensamblado a partir de cintas y palos.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Toda nuestra industria se desempe√±a mal con sus tareas</a> . <br><br>  <strong>Brett</strong> trabaj√≥ como analista de sistemas en el MedStitute Medical Research Center.  MedStitute utiliz√≥ un software propietario llamado MedTech para almacenar y analizar datos.  A los m√©dicos e investigadores les gustaron los resultados de MedTech, pero su colega Brett Tyree sab√≠a c√≥mo se crearon. <br><br>  El software no ten√≠a acceso al backend, y todo el proceso de desarrollo tuvo lugar en la GUI del "mouse programable".  Parece que esta interfaz fue escrita por una persona que estudi√≥ programaci√≥n en sitios web de copiar y pegar de los a√±os 90, examin√≥ diez minutos <em>de Jurassic Park</em> y busc√≥ respuestas a StackOverflow hasta que se pudo compilar algo.  El "lenguaje de programaci√≥n" tambi√©n mostr√≥ un nivel similar de consideraci√≥n en la filosof√≠a de dise√±o.  Cada uno <code>if</code> <em>debe</em> haber tenido <code>else</code> .  Algunos m√≥dulos utilizaron valores booleanos, otros devolvieron cadenas vac√≠as para indicar valores falsos.  De la documentaci√≥n no estaba claro en qu√© situaci√≥n ocurri√≥ uno u otro.  De hecho, cada <code>if</code> convirti√≥ en tres declaraciones. <br><br>  Brett necesitaba comenzar un nuevo estudio.  Se bas√≥ en un conjunto simple de estad√≠sticas y pacientes agrupados utilizando una variable aleatoria.  Brett busc√≥ en la lista una variable que pudiera asignarse al azar, pero no lo consider√≥ necesario.  Sugiri√≥ que cometi√≥ un error y retrocedi√≥ algunas pantallas para verificar su nombre copi√°ndolo para una b√∫squeda.  Brett regres√≥ a la lista de variables aleatorias.  Ella no estaba all√≠.  Ech√≥ un vistazo m√°s de cerca a la lista y not√≥ que la lista de variables aleatorias conten√≠a datos de campos de opci√≥n m√∫ltiple.  El campo que necesitaba aleatorizar se basaba en un campo calculado. <br><br>  Brett sab√≠a que Tyree estaba trabajando en otro proyecto que se aleatoriz√≥ por campo calculado, por lo que lo contact√≥ en Slack.  ‚Äú¬øC√≥mo codificaste esta variable aleatoria?  ¬øMedtech evita que esto suceda? <br><br>  "Estoy hablando de conferencias, te llamar√© m√°s tarde", escribi√≥ Tyree. <br><br>  Unos minutos m√°s tarde, Tyree llam√≥ a Brett. <br><br>  ‚ÄúNecesitas comenzar con dos campos.  Digamos  llam√©mosles <code>$variable_choice</code> , es decir, una pregunta de opci√≥n m√∫ltiple, y <code>$variable_calced</code> , es decir, su campo calculado.  Cuando desea crear una variable que realiza una selecci√≥n aleatoria basada en un campo calculado, le dice a Medtech que esta variable aleatoria se basa en <code>$variable_choice</code> .  Luego elimina <code>$variable_choice</code> y cambia el nombre de <code>$variable_calced</code> a <code>$variable_choice</code> ‚Äù <br><br>  ‚ÄúDetente, ¬øel sistema te permite hacer esto, pero no te permite aleatorizar los campos calculados de ninguna otra manera?  ¬øY ella no lo comprueba? " <br><br>  "Espero que nada cambie, y ella no comienza a verificar esto hasta la finalizaci√≥n de mi proyecto", respondi√≥ Tyree. <br><br>  ‚ÄúEste estudio deber√≠a llevarse a cabo durante diez a√±os.  ¬øY su finalizaci√≥n exitosa depende de si los desarrolladores consideran que este truco es un error? <br><br>  ‚ÄúLogr√© encontrar solo esa soluci√≥n.  Av√≠same si encuentras algo mejor. <br><br>  Brett no satisfizo tal truco, y volvi√≥ a estudiar la documentaci√≥n.  Encontr√≥ una soluci√≥n "mejor": puede crear un campo de opci√≥n m√∫ltiple de solo lectura con el √∫nico valor predeterminado: el valor del campo calculado.  Desafortunadamente, el usuario podr√≠a cambiar la lista inadvertidamente respondiendo una pregunta de opci√≥n m√∫ltiple <em>antes de</em> calcular el valor del campo calculado. <br><br>  Al final, lo √∫nico que le quedaba a Brett era tomar un descanso, ir a la cafeter√≠a y comprar un par de perritos calientes. <br><br><h2>  La tercera historia.  Portabilidad y hardware </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[Original]</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/2cb/0c2/52e2cb0c2e0b8465a1b713aa60dfd474.jpg"></div><br>  Hace muchas lunas, cuando las PC ten√≠an cajas de metal pesado y pl√°stico, se le pidi√≥ a <b>Matt</b> y su colega que evaluaran el paquete de software para la pr√≥xima operaci√≥n del departamento de ventas.  Desafortunadamente, √©l y su colega trabajaron en diferentes oficinas dentro de la misma ciudad.  En esa √©poca, todav√≠a no exist√≠an herramientas efectivas de colaboraci√≥n en l√≠nea, por lo que Matt regularmente ten√≠a que viajar a otra oficina, llev√°ndose una PC con √©l.  Esto significaba que cada vez que era necesario desconectar los cables perif√©ricos del caso 473, llevar la computadora por los pasillos y bajar las escaleras, tomar un autob√∫s para llegar a otra oficina, en la que hizo todo esto en el orden inverso.  A veces, la organizaci√≥n incorrecta de la mano de obra oblig√≥ a esta pareja a trabajar los fines de semana, lo que significa que llevan m√°quinas de trabajo a casa. <br><br>  En el proceso, el disco duro de 20 MB en la computadora de Matt se desbord√≥.  Desde su oficina, envi√≥ una solicitud al departamento de TI.  Para completar la solicitud, se design√≥ al t√©cnico de Gary, quien despu√©s de un tiempo apareci√≥ en el cubo de Matt, sosteniendo un nuevo disco duro y un destornillador.  Gary envi√≥ a Matt a tomar un caf√© para concentrarse en su "paciente".  Despu√©s de una peque√±a cirug√≠a, la PC de Matt se encendi√≥ y trabaj√≥ con un disco duro grande. <br><br>  El d√≠a antes de la fecha l√≠mite del proyecto, Matt casi complet√≥ su parte del trabajo.  Solo ten√≠a que hacer algunas adiciones a su informe, y luego copiarlo en disquetes y enviarlo al departamento de ventas.  Devolvi√≥ su PC al cubo y conect√≥ los cables, encendi√≥ la alimentaci√≥n y escuch√≥ un estallido.  La PC estaba muerta y no mostraba signos de vida. <br><br>  Despu√©s de una llamada de p√°nico al departamento de TI, Gary apareci√≥ nuevamente en su oficina con un destornillador.  Al abrir la carcasa de la PC, inmediatamente grit√≥: ‚Äú¬°Espera un minuto!  ¬øArrastraste una computadora a alguna parte? <br><br>  Matt frunci√≥ el ce√±o.  "Bueno, s√≠.  ¬øEsa es la cosa? <br><br>  "S√≠, por supuesto!  ¬°No deber√≠as haber hecho eso! Gary comenz√≥ a maldecir.  "¬°El disco duro comenz√≥ a pasar el rato y acort√≥ todo dentro!" <br><br>  Matt se inclin√≥ sobre Gary para ver por s√≠ mismo el interior de la computadora.  Inmediatamente se dio cuenta de que el nuevo disco duro estaba "fijado" a cinta. <br><br>  ‚Äú¬°Para!  ¬°Que <i>no</i> deber√≠as haber hecho esto!  Matt se√±al√≥ un trozo de cinta adhesiva.  "¬øDeber√≠a contactar a su supervisor por si acaso?" <br><br>  La cara de Gary frunci√≥ el ce√±o.  "¬°No me dan los cierres necesarios! <br><br>  "¬°Entonces encuentra al que los tiene!" <br><br>  Dado el plazo inminente, con el permiso del jefe, Matt transfiri√≥ su solicitud a√∫n m√°s.  Casi inmediatamente, la cinta adhesiva fue reemplazada por hardware genuino.  Nunca entendi√≥ <i>por qu√©</i> los empleados del departamento de TI no ten√≠an acceso al equipo necesario;  sugiri√≥ que era una idea brillante de un idiota ahorrar dinero.  Matt solo pod√≠a adivinar qu√© otras improvisaciones desesperadas hicieron funcionar su infraestructura de TI y cu√°nto tiempo pasar√≠an desapercibidas si su PC no se romp√≠a. <br><br><h2>  La cuarta historia.  As√≠ es como PL / SQL afecta su cerebro. </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[Original]</a> <br><br>  El campe√≥n eterno entre las decisiones m√°s extra√±as y sin √©xito seguir√° siendo para siempre <em>Oracle</em> .  Hoy nos fijamos en un peque√±o c√≥digo PL / SQL. <br><br>  PL / SQL es un lenguaje extra√±o, una mezcla de SQL y lenguaje interactivo (de procedimiento) con lenguaje orientado a objetos pegado a un lado.  La sintaxis es excelentemente capaz de crear la impresi√≥n de que se desarroll√≥ en la d√©cada de 1970, y cada nueva funci√≥n o cambio de idioma contin√∫a esta tradici√≥n. <br><br>  La estructura de cada m√≥dulo de c√≥digo PL / SQL est√° basada en <em>bloques</em> .  Cada bloque es un espacio de nombres independiente.  En resumen, su anatom√≠a se ve as√≠: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">-- variable declarations go here BEGIN -- code goes here EXCEPTIONS -- exception handling code goes here, using WHEN clauses END;</span></span></code> </pre> <br>  Si est√° escribiendo un procedimiento almacenado o un controlador de eventos, reemplace la palabra clave <code>DECLARE</code> con <code>CREATE [OR REPLACE]</code> .  Tambi√©n puede anidar bloques dentro de otros bloques, por lo que a menudo puede ver el c√≥digo estructurado de esta manera: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">--stuff BEGIN --actions END; --more actions END;</span></span></code> </pre> <br>  S√≠, bastante r√°pido comienza a ser confuso.  Y s√≠, si desea proporcionar un manejo de errores al menos aproximadamente estructurado, <em>debe</em> comenzar a colocar bloques entre s√≠. <br><br>  El idioma y la base de datos tienen otras caracter√≠sticas divertidas.  Antes de la versi√≥n 12c, no ten√≠an un tipo de columna <code>IDENTITY</code> .  En versiones anteriores, ten√≠a que usar el objeto <code>SEQUENCE</code> y escribir procedimientos o controladores de eventos que realizaran numeraci√≥n autom√°tica forzada.  Normalmente, el operador <code>SELECT INTO‚Ä¶</code> se usaba para asignar un valor a una variable.  Bonificaci√≥n: Oracle SQL <em>siempre</em> requiere que se especifique una tabla en la instrucci√≥n <code>FROM</code> , por lo que debe usar una tabla <code>dual</code> inventada, como esta: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE_AUTONUMBER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> myseq.nextval <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :new.id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre> <br>  <code>:new</code> en este contexto indica la l√≠nea para la que estamos numerando autom√°ticamente.  En versiones anteriores de Oracle, esta era la forma "habitual" de crear columnas con numeraci√≥n autom√°tica.  <strong>Benoit</strong> descubri√≥ otra forma, un poco menos com√∫n, de hacer la misma operaci√≥n: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1_TRIGGER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> pl_error_id table1.error_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; CURSOR get_seq IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> table1_seq.nextval <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> get_seq; FETCH get_seq INTO pl_error_id; IF get_seq%NOTFOUND THEN raise_application_error(-20001, 'Sequence TABLE1_SEQ does not exist'); CLOSE get_seq; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; CLOSE get_seq; :new.error_id := pl_error_id; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> table1_trigger;</code> </pre> <br>  Est√°n pasando muchas cosas aqu√≠.  Primero, observe que la secci√≥n <code>DECLARE</code> contiene la instrucci√≥n <code>CURSOR</code> .  Los cursores le permiten recorrer en iteraci√≥n los registros.  Son muy caros y en el mundo de Oracle es un recurso que necesita ser liberado. <br><br>  Este controlador de eventos (activador) utiliza un bloque anidado sin ning√∫n motivo.  Tambi√©n utiliza la variable adicional <code>pl_error_id</code> , que se puede prescindir. <br><br>  Pero la parte realmente extra√±a es el bloque <code>IF get_seq%NOTFOUND</code> .  Todo es bastante simple: comprueba la condici√≥n de que el cursor no devuelva una cadena.  Para este cursor, esto no puede suceder ni siquiera en <em>teor√≠a</em> , por lo que las operaciones internas nunca se realizan.  Una secuencia siempre devuelve un valor.  Y esto es <em>bueno</em> , dado el c√≥digo que va m√°s all√°. <br><br>  <code>raise_application_error</code> es un an√°logo de throw en Oracle.  Esta declaraci√≥n sube la pila de bloques ejecutables hasta que encuentra la secci√≥n <code>EXCEPTIONS</code> para manejar el error.  Observe que cerramos el cursor <em>despu√©s de</em> esta declaraci√≥n; es decir, <em>nunca</em> cerramos el cursor.  Los cursores, como se mencion√≥ anteriormente, son caros, y Oracle solo permite que se use un n√∫mero limitado de ellos. <br><br>  Aqu√≠ vemos un extra√±o ejemplo de c√≥mo un desarrollador intenta defenderse de un error que no puede suceder, de una manera que conducir√° a nuevos errores con el tiempo. <br><br><h2>  La quinta historia.  Inicios de sesi√≥n encriptados dobles </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[Original]</a> <br><br>  Crear autenticaci√≥n para la API web es una tarea <em>dif√≠cil</em> , pero tiene <em>muchas</em> soluciones bien establecidas.  Lo m√°s dif√≠cil es elegir una de las diversas opciones, despu√©s de lo cual es suficiente simplemente agregar un componente. <br><br>  Cuando se implementa correctamente, el sistema no depende del tipo de cliente.  Puedo acceder al servicio a trav√©s de un navegador, en un cliente pesado o a trav√©s de cURL.  Si se implementa incorrectamente, obtienes lo que le pas√≥ a <strong>Amira</strong> . <br><br>  Ella resolvi√≥ el problema de extraer las estad√≠sticas que necesitaba del backend, pero no pudo descubrir el m√©todo de autenticaci√≥n.  Por lo tanto, estudi√≥ el c√≥digo de front-end para comprender c√≥mo se realiza la autenticaci√≥n: <br><br><pre> <code class="javascript hljs">crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(<span class="hljs-string"><span class="hljs-string">'&lt;removed&gt;'</span></span>); challenge = <span class="hljs-string"><span class="hljs-string">"&lt;removed&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doChallengeResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&amp;/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%26'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\\+/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%2B'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = crypt.encrypt(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.response.value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.submit(); }</code> </pre> <br>  Por un lado, puedo suponer que este c√≥digo es muy antiguo, dado el <code>document.loginForm</code> utilizado para las interacciones con elementos DOM.  Por otro lado, <code>JSEncrypt</code> se lanz√≥ por primera vez en 2013, lo que nos da la barra de edad m√°xima. <br><br>  Transmitimos los par√°metros de acceso al backend enviando el formulario, que, seg√∫n el desarrollador del c√≥digo, requiere limpieza: se reemplazan todos <code>&amp;</code> <code>+</code> en la contrase√±a, pero ... esto no es necesario, porque el formulario debe cumplir con la solicitud <code>POST</code> y, adem√°s, <em>ciframos los datos</em> . <br><br>  Aqu√≠ est√° lo que pienso.  El c√≥digo <em>es en realidad</em> bastante antiguo.  El desarrollador lo copi√≥ de una publicaci√≥n en StackOverflow alrededor de 2005, que no utilizaba el cifrado ni el <code>POST</code> formularios a trav√©s de <code>POST</code> .  A√±o tras a√±o, se le agregaron peque√±os cambios.  pero el mecanismo subyacente nunca ha cambiado. <br><br>  Amira revis√≥ el historial y descubri√≥ que el cifrado no se usaba en la versi√≥n anterior.      <code>challenge</code> ,    MD5,     <em></em>  ,     ,       . <br><br>     :   ,     ,         ,     ,    cURL      -.          ,    <em>    SSL/TLS</em> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/446714/">https://habr.com/ru/post/446714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446702/index.html">Y otro auricular extra√±o, para dormir</a></li>
<li><a href="../446706/index.html">Consultas paralelas en PostgreSQL</a></li>
<li><a href="../446708/index.html">Comparaci√≥n de sistemas de comunicaci√≥n espacial.</a></li>
<li><a href="../446710/index.html">Cuatro historias reales de trabajo con arquitectura de microservicios: informe del mitap de Backend United 3: Kholodets</a></li>
<li><a href="../446712/index.html">HTTPS no siempre es tan seguro como parece. Vulnerabilidades encontradas en el 5.5% de los sitios HTTPS</a></li>
<li><a href="../446716/index.html">Conciencia y argumento del fin del mundo</a></li>
<li><a href="../446718/index.html">Revisi√≥n de los informes m√°s interesantes de CodeFest 2019: versi√≥n de True Engineering</a></li>
<li><a href="../446722/index.html">Las pruebas mostrar√°n: c√≥mo prepararse para la implementaci√≥n de Cisco ISE y comprender qu√© caracter√≠sticas del sistema necesita</a></li>
<li><a href="../446724/index.html">C√≥mo los desarrolladores de iOS est√°n buscando subir la apuesta con la computaci√≥n en la nube</a></li>
<li><a href="../446726/index.html">Aprendizaje profundo en computaci√≥n de flujo √≥ptico</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>