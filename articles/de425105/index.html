<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÄ ü§≥üèª üßìüèæ Intel ME Manufacturing Mode - eine versteckte Bedrohung oder was steckt hinter der Sicherheitsanf√§lligkeit CVE-2018-4251 im MacBook? üßò ü§£ üëÉüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Prinzip ‚Äû Sicherheit durch Dunkelheit ‚Äú wird seit mehreren Jahren von Experten kritisiert. Dies hindert jedoch gro√üe Elektronikhersteller unter de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Intel ME Manufacturing Mode - eine versteckte Bedrohung oder was steckt hinter der Sicherheitsanf√§lligkeit CVE-2018-4251 im MacBook?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/425105/"><img src="https://habrastorage.org/webt/mk/ba/-i/mkba-izexq1vhigp76l3sbepw50.png"><br><br>  Das Prinzip ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sicherheit durch Dunkelheit</a> ‚Äú wird seit mehreren Jahren von Experten kritisiert. Dies hindert jedoch gro√üe Elektronikhersteller unter dem Vorwand des Schutzes des geistigen Eigentums nicht daran, die Unterzeichnung von Geheimhaltungsvereinbarungen zu fordern, um technische Unterlagen zu erhalten.  Die Situation verschlechtert sich aufgrund der zunehmenden Komplexit√§t von Mikroschaltungen und der Integration verschiedener propriet√§rer Firmware in diese.  Dies macht es tats√§chlich unm√∂glich, solche Plattformen f√ºr unabh√§ngige Forscher zu analysieren, was sowohl normale Benutzer als auch Ger√§tehersteller gef√§hrdet. <br><br>  Ein Beispiel ist die Intel Management Engine (Intel ME) -Technologie sowie deren Versionen f√ºr Server- (Intel SPS) und mobile (Intel TXE) Plattformen (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[5]</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[6]</a> f√ºr weitere Informationen zu dieser Technologie. In diesem Artikel werden wir darauf eingehen Wie Sie undokumentierte Befehle verwenden (wenn der Begriff "dokumentiert" allgemein f√ºr Intel ME gilt), k√∂nnen Sie den SPI-Flash-Speicher √ºberschreiben und das schlimmste Szenario implementieren - die lokale Ausnutzung einer Sicherheitsanf√§lligkeit in ME (INTEL-SA-00086). Die Wurzel dieses Problems war der undokumentierte Betriebsmodus von Intel ME - Herstellungsmodus. <a name="habracut"></a><br><br><h2>  Was ist der Herstellungsmodus? </h2><br>  Intel ME Manufacturing Mode - Servicemodus zum Konfigurieren, Konfigurieren und Testen der endg√ºltigen Plattform in der Produktionsphase;  Es muss ausgeschaltet sein, bevor das Ger√§t in den Verkauf geht und an den Benutzer versendet wird.  Weder dieser Modus noch seine potenziellen Risiken sind in der √∂ffentlichen Dokumentation von Intel beschrieben.  Ein gew√∂hnlicher Benutzer kann es nicht selbst ausschalten, da das Dienstprogramm zur Verwaltung √ºber das Intel ME System Tools-Paket nicht offiziell verf√ºgbar ist.  Beachten Sie, dass kein Softwareschutz den Benutzer sch√ºtzen kann, wenn dieser Modus aktiviert ist, oder ihn zumindest dar√ºber benachrichtigen kann.  Selbst das Chipsec-Dienstprogramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[2]</a> , das speziell zur Erkennung von Chipsatz- und Prozessorkonfigurationsfehlern auf UEFI-Firmware-Ebene entwickelt wurde (insbesondere falsche Konfiguration der Zugriffsrechte auf SPI-Flash-Regionen), wei√ü nichts √ºber den Intel-Fertigungsmodus. <br><br>  In diesem Modus k√∂nnen Sie kritische Plattformparameter einstellen, die im einmaligen Schreibspeicher (FUSES) gespeichert sind.  Ein Beispiel f√ºr solche Parameter, die in FUSES ‚Äûverkabelt‚Äú sind, sind BootGuard-Parameter (Modus, Richtlinien, Pr√ºfsumme f√ºr Schl√ºssel f√ºr digitale Signaturen f√ºr ACM- und UEFI-Module).  Einige von ihnen hei√üen FPF (Field Programmable Fuses).  Die Liste der FPFs, die in FUSES geschrieben werden k√∂nnen (unvollst√§ndig, tats√§chlich k√∂nnen einige FPFs nicht direkt festgelegt werden), kann √ºber das Dienstprogramm FPT (Flash Programming Tool) aus dem Intel ME System Tools-Paket abgerufen werden. <br><br><img src="https://habrastorage.org/webt/vy/lm/wt/vylmwtru_w7skhyv8wjp_r8bw-e.png"><br><br>  <i>Abb. 1: Das Ergebnis der Option ‚ÄìFPFs des FPT-Dienstprogramms</i> <br><br>  Es ist zu beachten, dass FPFs nur einen Teil des gesamten FUSE-Arrays ausmachen und der gr√∂√üte Teil dieses Speichers von Intel selbst zum Speichern vieler Plattformparameter verwendet wird.  Ein Teil des Speicherplatzes dieses Arrays wird beispielsweise als IP-Sicherungen bezeichnet und dient zum Speichern der Konfigurationsparameter einzelner Hardwaremodule (Intelligent Property).  Das spezielle DFx-Aggregator-Ger√§t speichert in FUSE ein Zeichen daf√ºr, ob die Plattform seriell oder testweise ist. <br><br>  Zus√§tzlich zu FPF kann der Ger√§tehersteller im Fertigungsmodus Intel ME-Firmware-Parameter einstellen, die im internen Firmware-Dateisystem MFS auf SPI-Flash-Medien gespeichert sind.  Diese Parameter k√∂nnen im Falle einer Neuprogrammierung des SPI-Blitzes ge√§ndert werden.  Sie werden als CVARs (Configurable NVARs, Named Variables) bezeichnet. <br><br>  F√ºr die Installation von CVARs ist das Intel ME-Firmware-Modul mca_server verantwortlich.  MCA ist die Abk√ºrzung f√ºr Manufacture-Line Configuration Architecture, die gebr√§uchliche Bezeichnung f√ºr den Plattformkonfigurationsprozess w√§hrend der Fertigungsphase.  CVARs k√∂nnen wie FPFs mithilfe von FPTs definiert und gelesen werden. <br><br><img src="https://habrastorage.org/webt/yb/m_/4r/ybm_4ruf778k-z4hfdufqjsyuxq.png"><br><br>  <i>Abbildung 2. Liste der vom FPT-Dienstprogramm f√ºr die Broxton P-Plattform ausgegebenen CVARs</i> <br><br>  Die Liste der CVARs variiert je nach Plattform und Intel ME-Firmware-Version.  Bei Chips√§tzen, die die Intel AMT-Technologie unterst√ºtzen, ist eine dieser Variablen das Kennwort f√ºr die Eingabe der MEBx (ME BIOS Extension). <br><br>  Die Installation von FPFs und fast allen CVARs-Variablen ist nur m√∂glich, wenn die Intel ME-Firmware im Fertigungsmodus ausgef√ºhrt wird.  Der Installationsprozess der FPFs selbst ist in zwei Phasen unterteilt: Festlegen von FPFs (die im tempor√§ren Speicher gespeichert sind) und √úbertragen von FPFs auf ein Array von Sicherungen.  Gleichzeitig ist die erste Stufe nur im Manufitting-Modus m√∂glich, und das eigentliche ‚ÄûBrennen‚Äú erfolgt automatisch nach Verlassen des Fertigungsmodus, wenn der Hersteller w√§hrend des Betriebs in diesem Modus FPF-Werte eingestellt hat und gleichzeitig der entsprechende Bereich nie im Fusionsarray aufgezeichnet wurde.  Wenn das System im Fertigungsmodus arbeitet, werden die FPF-Variablen daher h√∂chstwahrscheinlich nicht initialisiert. <br><br>  Ein Zeichen f√ºr die Deaktivierung des Fertigungsmodus ist in der Datei / home / mca / eom auf MFS gespeichert. Wenn Sie also SPI-Flash mit Firmware mit dem Basisdateisystem neu schreiben (weitere Informationen siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[9]</a> ), kann die Plattform im Fertigungsmodus wieder funktionieren (FUSES k√∂nnen jedoch nicht √ºberschrieben werden). . <br><br><h2>  √ñffentlicher OEM-Schl√ºssel </h2><br>  Das Verfahren zum Konfigurieren von Intel-Plattformen ist daher recht komplex und besteht aus mehreren Schritten.  Wenn der Ger√§tehersteller die Reihenfolge verletzt oder ge√§ndert hat, ist die Plattform einem ernsthaften Risiko ausgesetzt.  Selbst wenn der Herstellungsmodus abgeschlossen w√§re, k√∂nnte der Hersteller keine FUSES schreiben, was es einem Angreifer erm√∂glichen w√ºrde, dies f√ºr ihn zu tun. Er notiert seine Werte anstelle des Schl√ºssels zum Signieren des Bootcodes von BootGuard (ACM) - und UEFI-Modulen und erlaubt der Plattform, nur mit ihrem Schadcode zu booten laufend.  Dies f√ºhrt zu einem unwiederbringlichen Verlust an Ausr√ºstung, da der betr√ºgerische Schl√ºssel f√ºr immer im permanenten Speicher registriert wird (Details zu diesem Angriff finden Sie in der Studie zum Schutz von Rootkits: Intel BootGuard von Alexander Ermolov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[8]</a> ). <br><br>  In neuen Systemen (Apollo Lake, Gemini Lake, Cannon Point) in FPF wird nicht nur der Schl√ºssel f√ºr BootGuard gespeichert, sondern auch der √∂ffentliche OEM-Schl√ºssel (oder besser SHA-256 vom √∂ffentlichen RSA-OEM-Schl√ºssel), auf dem mehrere ME-Schutzmechanismen basieren.  In einem speziellen SPI-Flash-Bereich namens Signed Master Image Profile (SMIP) werden beispielsweise die herstellerspezifischen PCH-B√§nder (PCH-Hardwarekonfiguration) gespeichert.  Dieser Abschnitt ist mit einem Schl√ºssel signiert, SHA-256, von dem aus eine spezielle Datei auf SPI-Flash abgelegt wird.  Diese Datei hei√üt oem.key und befindet sich im Abschnitt FTPR. Sie enth√§lt verschiedene √∂ffentliche Schl√ºssel, die vom OEM zum Signieren einer Vielzahl von Daten bereitgestellt werden.  Hier ist die vollst√§ndige Liste der Datens√§tze, die vom Hersteller jeweils auf einem eindeutigen Schl√ºssel f√ºr die Cannon Point-Plattform signiert sind: <br><br><img src="https://habrastorage.org/webt/82/cu/nv/82cunvku9stjop0mwasr983sb9i.png"><br><br>  <i>Abbildung 3. Liste der signierten OEM-CNP-Plattformdaten</i> <br><br>  Die Datei oem.key selbst wird vom gemeinsam genutzten OEM-Stammschl√ºssel signiert, dessen Hash-Menge in FPFs aufgezeichnet werden muss. <br><br><img src="https://habrastorage.org/webt/13/3j/2a/133j2ab9jyihflrux_pqznov7r8.png"><br><br>  <i>Abbildung 4. OEM-Signierung</i> <br><br><h2>  Schreibsperre im ME-Bereich umgehen </h2><br>  Bis vor kurzem (vor Intel Apollo Lake) befand sich die Intel ME-Firmware in einer separaten SPI-Region, die √ºber unabh√§ngige Zugriffsrechte f√ºr CPU, GBE und ME verf√ºgte.  Mit der korrekten Konfiguration der Zugriffsattribute seitens der CPU (Hauptsystem) war es daher weder m√∂glich, ME-Firmware zu lesen noch zu schreiben.  Moderne Intel-Chipsatz-SPI-Controller verf√ºgen jedoch √ºber einen speziellen Master Grant-Mechanismus.  Diese Technologie weist jedem SPI-Master einen genau definierten Teil des SPI-Flashs zu. Dieser Master besitzt seine Region, unabh√§ngig von den im SPI-Deskriptor angegebenen Zugriffsrechten.  Jeder Meister hat die M√∂glichkeit, einem anderen Meister nach Belieben Zugang (zum Lesen oder Schreiben) zu seiner (und nur zu seiner) Region zu gew√§hren. <br><br><img src="https://habrastorage.org/webt/zk/rb/2q/zkrb2q_edrdhx2akun6qlvvctay.png"><br><br>  <i>Abbildung 5. Intel-Dokumentationsauszug, der den SPI Master Grant beschreibt</i> <br><br>  Selbst wenn der Host ein Verbot des Zugriffs des Hosts auf die ME SPI-Region festlegt, kann ME dennoch Zugriff auf seine Daten gew√§hren.  Unserer Meinung nach wurde dies durchgef√ºhrt, um die Aktualisierung der Intel ME-Firmware unter Umgehung des Standardalgorithmus zu erm√∂glichen. <br><br><h2>  Host ME Region Flash Protection Override </h2><br>  In der Intel ME-Firmware ist ein spezieller HECI-Befehl implementiert, mit dem Sie den Schreibzugriff von der CPU auf die SPI ME-Region √∂ffnen k√∂nnen.  Es hei√üt HMR FPO (Host ME Region Flash Protection Override).  In einer unserer fr√ºheren Studien haben wir diesen Befehl ausf√ºhrlich beschrieben [5].  Sie hat mehrere Funktionen. <br><br>  Nach Erhalt des HMR-FPO-Befehls √∂ffnet die Firmware <i><b>erst nach einem</b></i> Neustart den Zugriff auf ihre Region.  Das ME selbst bietet auch Schutz: Der Befehl wird nur w√§hrend der Ausf√ºhrungsperiode des UEFI-BIOS bis zum sogenannten EOP-Moment (End of Post) akzeptiert.  EOP ist ein weiterer HECI-Befehl, den das UEFI-BIOS sendet, bevor die Steuerung an das Betriebssystem (ExitBootServices) √ºbertragen wird.  In einigen BIOS-Setups finden Sie eine Option, mit der der Befehl HMRFPO an das EOP gesendet werden kann. <br><br><img src="https://habrastorage.org/webt/ig/mx/0x/igmx0x3qbpm8pgwwki1tv_bpe80.png"><br><br>  <i>Abbildung 6. √ñffnen der ME-Region im BIOS</i> <br><br>  Nach dem Empfang des EOP ignoriert die ME-Firmware das HMR-FPO und gibt den entsprechenden Status zur√ºck.  <b>Dies geschieht jedoch erst nach Abschluss des Fertigungsmodus</b> .  Daher akzeptiert die ME-Firmware im Fertigungsmodus <b>jederzeit</b> HMR-FPO <b>, unabh√§ngig vom Ende der Ver√∂ffentlichung</b> .  Wenn der Hersteller den Herstellungsmodus nicht geschlossen hat, kann ein Angreifer (formal erfordert dies Administratorrechte, aber selbst der Betriebssystemkern kann die ME-Firmware zun√§chst nicht √ºberschreiben) die ME-Firmware jederzeit √§ndern.  In diesem Stadium kann der Angreifer beispielsweise das ME-Image √ºberschreiben, um die Sicherheitsanf√§lligkeit INTEL-SA-00086 auszunutzen.  Dies macht einen Neustart erforderlich, ist jedoch auf fast allen Plattformen au√üer dem MacBook kein Hindernis.  <b>Auf Apple-Computern gibt es eine zus√§tzliche √úberpr√ºfung in UEFI, die zum Zeitpunkt des Starts durchgef√ºhrt wird und den Start des Systems blockiert, wenn die ME-Region mit HMRFPO ge√∂ffnet wird.</b>  Wie wir sp√§ter zeigen werden, wird dieser Schutzmechanismus jedoch √ºberwunden, wenn die ME-Firmware im Herstellungsmodus arbeitet. <br><br><h2>  Neustart von ME ohne Neustart der Haupt-CPU </h2><br>  In modernen Computern gibt es mehrere Optionen zum Neustarten der Plattform.  Darunter sind dokumentiert: globaler Neustart und Neustart nur der Haupt-CPU (ohne ME neu zu starten).  Wenn es jedoch eine M√∂glichkeit gibt, die ME neu zu starten, <b>ohne</b> die Haupt-CPU neu zu starten (nachdem auch der HMRFPO-Befehl ausgef√ºhrt wurde), wird der Zugriff auf die Region ge√∂ffnet und das Hauptsystem funktioniert weiterhin. <br><br><img src="https://habrastorage.org/webt/u3/af/7t/u3af7trk0vcnkhg-rcoo-rxo2h8.png"><br><br>  <i>Abbildung 7. Starten Sie die Typsteuerung neu</i> <br><br>  Bei der Untersuchung der internen ME-Firmware-Module haben wir festgestellt, dass es einen HECI-Befehl ( <b>‚Äû80 06 00 07 00 00 0b 00 00 00 03 00‚Äú</b> , weitere Einzelheiten zum Senden von Befehlen siehe [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5</a> ]) gibt, der nur neu <b>gestartet werden kann</b> (!). Der Intel ME-Kernel, die im Fertigungsmodus auch nach EOP jederzeit gesendet werden kann. <br><br><img src="https://habrastorage.org/webt/md/j6/xq/mdj6xqacvwhhwpfhdllxkchsobe.png"><br><br>  <i>Abbildung 8. Disassembler-Liste einer Funktion, die ME HECI-Reload-Befehle verarbeitet</i> <br><br>  <b>Somit √∂ffnet der Angreifer, nachdem er diese beiden HECI-Befehle gesendet hat, die ME-Region und kann dort alle Daten schreiben, ohne die Plattform neu zu starten</b> .  In diesem Fall spielt es keine Rolle, was der SPI-Deskriptor enth√§lt, dh die korrekten Schutzattribute der SPI-Regionen sch√ºtzen die ME-Firmware nicht vor √Ñnderungen, wenn das System im Fertigungsmodus arbeitet. <br><br><h2>  Fallstudie: Sicherheitsanf√§lligkeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CVE-2018-4251</a> </h2><br>  Wir haben mehrere Plattformen verschiedener Hersteller analysiert.  Unter ihnen waren Lenovo Laptops und Apple MacBook Pr¬Æ.  Bei den untersuchten Computern aus der Yoga und ThinkPad-Reihe fanden wir keine Probleme im Zusammenhang mit dem Herstellungsmodus, aber <b>Apple-Laptops, die auf Intel-Chips√§tzen basieren, arbeiten im Herstellungsmodus</b> .  Nach dem √úbertragen dieser Informationen an Apple wurde dieser Fehler (CVE-2018-4251) im MacOS High Sierra 10.13.5-Betriebssystemupdate behoben. <br><br><h2>  Lokaler Betrieb INTEL-SA-00086 </h2><br>  Mit der Sicherheitsanf√§lligkeit CVE-2018-4251 konnte ein Angreifer also alte Versionen der ME-Firmware schreiben, die die Sicherheitsanf√§lligkeit INTEL-SA-00086 enthielt, und gleichzeitig ben√∂tigte er weder einen SPI-Programmierer noch Zugriff auf den HDA_SDO-Jumper (d. H. Physischen Zugriff).  Somit wird der gef√§hrlichste - lokale - Vektor dieser Sicherheitsanf√§lligkeit erkannt (die Ausf√ºhrung von beliebigem Code in der ME-Firmware).  Es ist bemerkenswert, dass Intel in den Erl√§uterungen zum INTEL-SA-00086-Sicherheitsbulletin den offenen Fertigungsmodus nicht als Mittel zur lokalen Ausnutzung dieser Sicherheitsanf√§lligkeit ohne physischen Zugriff erw√§hnt, sondern nur, dass eine lokale Ausnutzung nur m√∂glich ist, wenn der Zugriff auf die SPI-Regionen falsch konfiguriert ist das ist nicht wahr  Um die Benutzer zu sch√ºtzen, haben wir uns entschlossen zu beschreiben, wie die Verf√ºgbarkeit des Fertigungsmodus √ºberpr√ºft und deaktiviert wird. <br><br><h2>  Wie Sie sich sch√ºtzen k√∂nnen </h2><br>  Das Paket von Systemdienstprogrammen f√ºr Entwickler von Ger√§ten, die auf Chips√§tzen und Intel-Prozessoren basieren (Intel System Tools), enth√§lt das MEInfo-Dienstprogramm (TXEInfo, SPSInfo f√ºr mobile bzw. Serverplattformen), mit dem erweiterte Diagnoseinformationen zum aktuellen Status der Management Engine-Firmware und erhalten werden die gesamte Plattform als Ganzes.  Wir haben diesen Nutzen in einer unserer fr√ºheren Studien zur Deaktivierung von ME und des undokumentierten HAP-Modus (High Assurance Platform) demonstriert [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6</a> ].  Dieses Dienstprogramm, das mit dem Flag ‚ÄìFWSTS aufgerufen wird, bietet eine detaillierte Beschreibung der HECI-Statusregister und meldet den Status des Fertigungsmodus (das 4. Bit des FWSTS-Statusregisters wird gesetzt, um anzuzeigen, dass der Fertigungsmodus aktiv ist). <br><br><img src="https://habrastorage.org/webt/g8/o0/uz/g8o0uzpd71issucllayfbxrd8rq.png"><br><br>  <i>Abbildung 9. Beispielausgabe des Dienstprogramms MEInfo</i> <br><br>  Wir haben auch ein Programm [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">7</a> ] entwickelt, mit dem Sie den Status des Fertigungsmodus √ºberpr√ºfen k√∂nnen, wenn der Benutzer aus irgendeinem Grund keinen Zugriff auf Intel ME System Tools hat. <br><br><img src="https://habrastorage.org/webt/nf/wh/ln/nfwhlnhef2gt6wgk1wi45g50h_w.png"><br><br>  <i>Abbildung 10. Ein Beispiel f√ºr das mmdetect-Skript</i> <br><br>  Es stellt sich die Frage, wie der Fertigungsmodus unabh√§ngig abgeschlossen werden kann, wenn sich herausstellt, dass der Hersteller dies nicht getan hat.  Um den Fertigungsmodus abzuschlie√üen, verf√ºgt das FPT-Dienstprogramm √ºber die spezielle Option ‚ÄìCLOSEMNF, mit der Sie neben dem Hauptzweck auch die empfohlenen Zugriffsrechte f√ºr die SPI-Flash-Regionen im Deskriptor festlegen k√∂nnen. <br><br><img src="https://habrastorage.org/webt/k-/k_/cc/k-k_ccj8vtqnp0p7pbn6rzhe00o.png"><br><br>  <i>Abbildung 11. Ergebnis des FTP-Dienstprogramms mit der Option ‚ÄìCLOSEMNF</i> <br><br>  In diesem Beispiel haben wir den NO-Parameter der Option ‚ÄìCLOSEMNF verwendet, um die Plattform nicht neu zu starten. Dies wird standardm√§√üig unmittelbar nach Abschluss des Fertigungsmodus ausgef√ºhrt. <br><br><h2>  Fazit </h2><br>  Unsere Untersuchungen zeigen, dass das Problem mit dem Intel ME-Firmware-Herstellungsmodus besteht und selbst gro√üe Hersteller wie Apple Fehler bei der Konfiguration von Intel-Plattformen machen k√∂nnen.  Am schlimmsten ist, dass es zu diesem Thema keine √∂ffentlichen Informationen gibt und den Endbenutzern nicht einmal ein derart ernstes Problem bekannt ist, das zum Verlust vertraulicher Informationen, zur Entstehung nicht entfernbarer Rootkits und zur unwiderruflichen Stilllegung von Ger√§ten f√ºhren kann. <br><br>  Dar√ºber hinaus besteht der Verdacht, dass die M√∂glichkeit, ME neu zu starten, ohne die Haupt-CPU neu zu starten, aufgrund der nicht synchronen BIOS / UEFI- und ME-Zust√§nde zu anderen Sicherheitsproblemen f√ºhren kann. <br><br>  <b>Autoren:</b> Mark Ermolov und Maxim Goryachiy <br><br>  [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kritisches Firmware-Update der Intel Management Engine, Intel-SA-00086</a> <br>  [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub - Chipsec / Chipsec: Framework zur Bewertung der Plattformsicherheit</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schnelle, sichere und flexible OpenSource-Firmware, Coreboot</a> <br>  [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mark Ermolov, Maxim Goryachy, Wie Sie der alleinige Eigent√ºmer Ihres PCs werden, PHDays VI, 2016</a> <br>  [6] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mark Ermolov, Maxim Goryachy, Deaktivieren von Intel ME 11 √ºber den undokumentierten Modus, Blog von Positive Technologies</a> <br>  [7] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tools zur Erkennung des Intel ME-Fertigungsmodus</a> <br>  [8] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alexander Ermolov, Schutz von Rootkits: Intel BootGuard</a> <br>  [9] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dmitry Sklyarov, Intel ME: Flash-Dateisystem.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erkl√§rt</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de425105/">https://habr.com/ru/post/de425105/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de425093/index.html">IoT-L√∂sungen f√ºr Wohnungsbau und kommunale Dienste: Was werden intelligente Z√§hler sein und wer sollte sie warten?</a></li>
<li><a href="../de425095/index.html">Offenes Webinar "Spiel" 2048 "</a></li>
<li><a href="../de425099/index.html">Was ich verstanden habe und auf welche Probleme ich beim Erstellen eines Hacker News-Klons gesto√üen bin</a></li>
<li><a href="../de425101/index.html">Docker + Laravel = ‚ù§</a></li>
<li><a href="../de425103/index.html">Stoppen Sie Google Predators bei der Verfolgung Ihrer Kinder</a></li>
<li><a href="../de425107/index.html">Fintech Digest: Probleme der Biometrie auf Mobilger√§ten, Leasing von Samsung-Handys, Wertpapiere in der Blockchain</a></li>
<li><a href="../de425109/index.html">Das Buch ‚ÄûJava in der Cloud. Fr√ºhlingsstiefel, Fr√ºhlingswolke, Wolkengie√üerei ¬ª</a></li>
<li><a href="../de425111/index.html">Werbetricks, die Sie Geld und Ansehen kosten k√∂nnen</a></li>
<li><a href="../de425113/index.html">"Digitale Typografie" oder meine Erfahrung in der mobilen Digitalisierung von B√ºchern</a></li>
<li><a href="../de425115/index.html">Ausgereifte DevOps: Griechische Trag√∂die in drei Akten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>