<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🔬 😸 🧚🏽 Guide complet de configuration des en-têtes HTTP pour la sécurité ⛲️ 🚶🏿 🐙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les entreprises qui vendent des cartes de pointage de sécurité sont en augmentation, leur influence dans les ventes aux entreprises augmente. De plus,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Guide complet de configuration des en-têtes HTTP pour la sécurité</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/471746/"><p><img src="https://habrastorage.org/webt/df/rj/xf/dfrjxfp4ydkkf7al1royc4wnufs.jpeg"></p><br><p>  Les entreprises qui vendent des cartes de pointage de sécurité sont en augmentation, leur influence dans les ventes aux entreprises augmente.  De plus, il y a ceux qui sont confus par la faible cote de sécurité des vendeurs, et ceux qui au moins une fois, en regardant la cote, ont refusé d'acheter - j'ai parlé avec de telles personnes. </p><br><p>  J'ai regardé comment ces entreprises calculent les performances de sécurité d'autres entreprises.  Il s'est avéré qu'ils envisageaient une combinaison d'utilisation de l'en-tête HTTP pour la sécurité et la réputation des adresses IP. </p><br><p>  La réputation d'une adresse IP est basée sur des informations de liste noire et de liste de spammeurs combinées à des informations sur le propriétaire de l'adresse IP publique.  En principe, il doit être propre si votre entreprise n'envoie pas de spam et est en mesure d'identifier et d'arrêter rapidement une mise en œuvre malveillante.  L'utilisation de l'en-tête de sécurité HTTP est calculée de la même manière que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'Observatoire de Mozilla</a> fonctionne. </p><br><p>  Ainsi, la notation de la plupart des entreprises est principalement déterminée par les rubriques figurant sur les sites Web publics de sécurité. </p><a name="habracut"></a><br><p>  Définir correctement le titre n'est pas long (aucune vérification sérieuse n'est requise), mais cela améliorera la sécurité du site et aidera à ne pas perdre des clients pour qui la sécurité n'est pas une expression vide de sens </p><br><p>  Je doute de la valeur de la méthodologie de vérification mentionnée; de ​​plus, le prix du service est exorbitant.  Il est peu probable que les fournisseurs de ce service soient en mesure de déterminer la sécurité d'une ressource avec la précision indiquée.  Cependant, la situation souligne une fois de plus combien il est important de s'asseoir et de prendre le temps d'activer et de configurer les titres corrects. </p><br><p> Dans cet article, je parlerai des en-têtes les plus fréquemment vérifiés, pour chacun, je conseillerai les valeurs de sécurité et donnerai un exemple de paramètres.  À la fin, je donnerai des exemples de paramètres pour les applications courantes et les serveurs Web. </p><br><h2 id="vazhnye-zagolovki-dlya-bezopasnosti">  En-têtes de sécurité importants </h2><br><h3 id="content-security-policy">  Contenu-Sécurité-Politique </h3><br><p>  Le CSP est utilisé pour empêcher les scripts intersites - en déterminant quelles ressources peuvent être téléchargées.  De la liste entière, cette rubrique prendra plus de temps que d'autres pour créer et soutenir correctement, et encore plus d'autres sont à risque.  Lorsque vous développez un CSP, vérifiez-le attentivement - si vous bloquez soudainement la source que vous utilisez, puis interrompez les fonctionnalités de votre propre site. </p><br><p>  Pour la version préliminaire, vous pouvez utiliser un merveilleux outil - une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">extension pour le navigateur Mozilla, Laboratory CSP</a> .  Installez-le dans un navigateur, étudiez attentivement le site pour lequel vous souhaitez créer un CSP, puis utilisez le CSP généré sur votre site.  Idéalement, vous devez toujours retravailler JavaScript afin de pouvoir supprimer la directive en ligne non sécurisée. </p><br><p>  Le CSP peut sembler compliqué et déroutant, donc si vous voulez approfondir le sujet, visitez le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site officiel</a> . </p><br><p>  Vous pouvez préconfigurer CSP comme ceci (sur un site de combat, cela nécessitera très probablement de nombreuses modifications).  Ajoutez des domaines à chaque section de votre site. </p><br><pre><code class="plaintext hljs"># Default to only allow content from the current site # Allow images from current site and imgur.com # Don't allow objects such as Flash and Java # Only allow scripts from the current site # Only allow styles from the current site # Only allow frames from the current site # Restrict URL's in the &lt;base&gt; tag to current site # Allow forms to submit only to the current site Content-Security-Policy: default-src 'self'; img-src 'self' https://i.imgur.com; object-src 'none'; script-src 'self'; style-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self';</code> </pre> <br><h3 id="strict-transport-security">  Strict-transport-security </h3><br><p>  Cet en-tête indique au navigateur que vous ne pouvez accéder au site qu'en utilisant le protocole HTTPS - activez-le toujours si HTTPS est activé sur votre site.  Incluez-le sur tous les sous-domaines utilisés, le cas échéant. </p><br><pre> <code class="plaintext hljs">Strict-Transport-Security: max-age=3600; includeSubDomains</code> </pre> <br><h3 id="x-content-type-options">  Options de type de contenu X </h3><br><p>  Grâce à cet en-tête, les navigateurs adhèrent aux types MIME installés par l'application, ce qui permet d'éviter certaines attaques de script intersites. </p><br><p>  Il réduit également le risque de comportement d'application inattendu lorsque le navigateur «devine» de manière incorrecte le type de contenu sur le site - par exemple, si le développeur désigne une page «HTML» et que le navigateur voit JavaScript et essaie de rendre la page en conséquence.  De plus, grâce à cet en-tête, le navigateur conserve toujours les types MIME installés par le serveur. </p><br><pre> <code class="plaintext hljs">X-Content-Type-Options: nosniff</code> </pre> <br><h3 id="cache-control">  Contrôle du cache </h3><br><p>  Celui-ci sera plus pauvre que les autres, car pour différents types de contenu, vous aurez probablement besoin de politiques de mise en cache différentes. </p><br><p>  Aucune information sensible, telle que la page d'un utilisateur ou la page de paiement d'un produit, ne doit être mise en cache.  L'une des raisons à cela est qu'un autre utilisateur d'ordinateur n'appuie pas sur le bouton de retour, ne lit pas l'historique et ne voit pas les données personnelles d'un autre utilisateur. </p><br><p>  Cependant, vous pouvez et devez mettre en cache les pages rarement mises à jour, telles que les ressources statiques (images, fichiers CSS et JS).  La mise en cache peut être configurée page par page ou en utilisant l'expression régulière dans les paramètres du serveur. </p><br><pre> <code class="plaintext hljs"># Don't cache by default Header set Cache-Control no-cache # Cache static assets for 1 day &lt;filesMatch ".(css|jpg|jpeg|png|gif|js|ico)$"&gt; Header set Cache-Control "max-age=86400, public" &lt;/filesMatch&gt;</code> </pre> <br><h3 id="expires">  Expire </h3><br><p>  Cet en-tête définit l'heure à laquelle la demande en cours est mise en cache.  Il est ignoré si l'en-tête max-age Cache-Control est activé, nous ne l'activons donc que dans le cas où un simple scanner le vérifierait - à l'exclusion des contrôles de mise en cache. </p><br><p>  Nous supposons que pour des raisons de sécurité, le navigateur ne met rien en cache, donc la date dans l'en-tête sera toujours dans le passé. </p><br><pre> <code class="plaintext hljs">Expires: 0</code> </pre> <br><h3 id="x-frame-options">  X-frame-options </h3><br><p>  Cet en-tête permet l'affichage du site dans un iFrame. </p><br><p>  En plaçant votre site Web dans une iFrame, une ressource malveillante a la possibilité d'effectuer une attaque de détournement de clic - en lançant une sorte de JavaScript qui incite l'utilisateur à cliquer sur l'iFrame, puis commence à interagir avec la ressource à partir de son nom d'utilisateur (c'est-à-dire qu'une personne clique sur un lien ou un bouton malveillant sans même le savoir!). </p><br><p>  Cet en-tête doit toujours être configuré pour échouer, à l'exception si vous utilisez intentionnellement des trames.  Ensuite, l'en-tête doit être défini sur la même source.  Si vous utilisez des cadres avec un site différent par défaut, ajoutez le domaine tiers à la liste blanche. </p><br><p>  Il convient également de noter que cet en-tête est remplacé par la directive frame-ancestors CSP.  Je recommande de l'activer pour l'instant, mais juste pour fermer les outils de vérification des en-têtes, ils s'en débarrasseront très probablement à l'avenir. </p><br><pre> <code class="plaintext hljs">X-Frame-Options: deny</code> </pre> <br><h3 id="access-control-allow-origin">  Access-Control-Allow-Origin </h3><br><p>  Cet en-tête indique au navigateur quel code externe de quels sites tiers a le droit de faire des requêtes sur une page spécifique.  Les paramètres par défaut sont généralement corrects, mais vous pouvez les modifier si nécessaire. </p><br><p>  Par exemple, le site A contient une sorte de JavaScript qui souhaite faire une demande au site B. Le site B doit répondre à cette demande - si l'en-tête permet au site A de faire une demande.  Si vous devez configurer plusieurs sources, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consultez les détails sur la page MDN</a> . </p><br><p>  Ici, vous pouvez être un peu confus, j'ai donc fait un diagramme - pour illustrer le fonctionnement de cet en-tête: </p><br><p><img src="https://habrastorage.org/webt/97/g9/iy/97g9iyhqou03xiinwuind3gqwbs.png"><br>  <em>Flux de données avec Access-Control-Allow-Origin</em> </p><br><pre> <code class="plaintext hljs">Access-Control-Allow-Origin: http://www.one.site.com</code> </pre> <br><h3 id="set-cookie">  Définir un cookie </h3><br><p>  Assurez-vous que vos cookies sont définis uniquement via le protocole HTTPS (avec cryptage) et qu'ils ne sont pas accessibles via JavaScript.  Ces fichiers ne peuvent être envoyés que si votre site prend également en charge HTTPS, comme il se doit.  Vous devez toujours définir ces drapeaux: </p><br><ul><li>  Sécurisé </li><li>  HTTP uniquement </li></ul><br><p>  Exemple de définition de cookie: </p><br><pre> <code class="plaintext hljs">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly</code> </pre> <br><p>  En savoir plus dans l'excellente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation des cookies de Mozilla</a> . </p><br><h3 id="x-xss-protection">  Protection X-XSS </h3><br><p>  Cet en-tête indique au navigateur d'interrompre les attaques de script intersites détectées.  En l'allumant, vous ne prenez pas beaucoup de risques, mais testez-le avant de le lancer dans l'environnement de production. </p><br><pre> <code class="plaintext hljs">X-XSS-Protection: 1; mode=block</code> </pre> <br><h3 id="primer-nastroek-veb-servera">  Exemple de paramètres de serveur Web </h3><br><p>  En général, dans les paramètres du serveur, il est préférable d'ajouter des en-têtes à l'ensemble du site.  Les cookies sont une exception, car ils sont définis dans l'application elle-même. </p><br><p>  Je vous conseille, avant d'ajouter des en-têtes au site, vérifiez d'abord avec l'Observatoire ou regardez manuellement dans les en-têtes - vérifiez ceux qui sont déjà installés.  Certains moteurs de site et de serveur installeront tout par eux-mêmes, alors implémentez simplement les en-têtes dont vous avez besoin ou modifiez ceux qui en ont besoin. </p><br><h3 id="konfiguraciya-apache">  Configuration d'Apache </h3><br><p>  Exemple de configuration Apache en .htaccess: </p><br><pre> <code class="plaintext hljs">&lt;IfModule mod_headers.c&gt; ## CSP Header set Content-Security-Policy: default-src 'self'; img-src 'self' https://i.imgur.com; object-src 'none'; script-src 'self'; style-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self'; ## General Security Headers Header set X-XSS-Protection: 1; mode=block Header set Access-Control-Allow-Origin: http://www.one.site.com Header set X-Frame-Options: deny Header set X-Content-Type-Options: nosniff Header set Strict-Transport-Security: max-age=3600; includeSubDomains ## Caching rules # Don't cache by default Header set Cache-Control no-cache Header set Expires: 0 # Cache static assets for 1 day &lt;filesMatch ".(ico|css|js|gif|jpeg|jpg|png|svg|woff|ttf|eot)$"&gt; Header set Cache-Control "max-age=86400, public" &lt;/filesMatch&gt; &lt;/IfModule&gt;</code> </pre> <br><h3 id="konfiguraciya-nginx">  Configuration de Nginx </h3><br><pre> <code class="plaintext hljs">## CSP add_header Content-Security-Policy: default-src 'self'; img-src 'self' https://i.imgur.com; object-src 'none'; script-src 'self'; style-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self'; ## General Security Headers add_header X-XSS-Protection: 1; mode=block; add_header Access-Control-Allow-Origin: http://www.one.site.com; add_header X-Frame-Options: deny; add_header X-Content-Type-Options: nosniff; add_header Strict-Transport-Security: max-age=3600; includeSubDomains; ## Caching rules # Don't cache by default add_header Cache-Control no-cache; add_header Expires: 0; # Cache static assets for 1 day location ~* \.(?:ico|css|js|gif|jpe?g|png|svg|woff|ttf|eot)$ { try_files $uri @rewriteapp; add_header Cache-Control "max-age=86400, public"; }</code> </pre> <br><h3 id="nastroyka-zagolovka-urovnya-prilozheniya">  Paramètre d'en-tête au niveau de l'application </h3><br><p>  Si vous n'avez pas accès au serveur Web ou si les exigences de définition des en-têtes sont complexes, vous devrez probablement les configurer dans l'application elle-même.  Habituellement, pour l'ensemble du site, cela se fait à l'aide d'un middleware ou sur la base d'un paramètre unique d'en-têtes pour chaque demande. </p><br><p>  Par souci de concision, j'ai inclus une seule rubrique dans chaque exemple.  Vous ajoutez de la même manière tout ce qui est nécessaire. </p><br><p>  Noeud et express: </p><br><p>  Ajouter un chemin de montage global: </p><br><pre> <code class="plaintext hljs">app.use(function(req, res, next) { res.header('X-XSS-Protection', 1; mode=block); next(); });</code> </pre> <br><h3 id="java-i-spring">  Java et Spring </h3><br><p>  J'ai peu d'expérience avec Spring, mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Baeldung</a> a un excellent guide sur la configuration des en-têtes au printemps. </p><br><h3 id="php">  Php </h3><br><p>  Je ne connais pas les différents environnements PHP.  Recherchez le middleware pour les requêtes.  Pour une seule demande, tout est simple. </p><br><pre> <code class="plaintext hljs">header("X-XSS-Protection: 1; mode=block");</code> </pre> <br><h3 id="python--django">  Python / Django </h3><br><p>  Django comprend <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un middleware de sécurité</a> personnalisable qui fera tout cela pour vous.  Activez-les d'abord. </p><br><p>  Les réponses de certaines pages peuvent être interprétées comme un dictionnaire.  Django a une façon spéciale de travailler avec la mise en cache, et si vous souhaitez configurer les en-têtes de mise en cache de cette manière, vous devez vous familiariser avec celle-ci. </p><br><pre> <code class="plaintext hljs">response = HttpResponse() response["X-XSS-Protection"] = "1; mode=block"</code> </pre> <br><h3 id="vyvody">  Conclusions </h3><br><p>  La configuration des en-têtes est un processus relativement simple et rapide, mais il augmente le niveau de sécurité du site - en termes de protection des données, des scripts intersites et du détournement de clics. </p><br><p>  À l'avenir, vous vous protégerez de l'échec des transactions, car votre cote de sécurité restera au niveau.  La pratique de l'évaluer sur la base des paramètres que j'ai examinés prend de l'ampleur et il me semble que son rôle dans les années à venir dans le domaine de la vente ne fera que s'intensifier. </p><br><p>  Faites-moi savoir si j'ai manqué un titre important! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr471746/">https://habr.com/ru/post/fr471746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr471736/index.html">Capteur Ethernet sans contact</a></li>
<li><a href="../fr471738/index.html">Une courte histoire sur la façon dont la commodité tire parfois dans le genou</a></li>
<li><a href="../fr471740/index.html">Service de cache intelligent basé sur ZeroMQ et Tarantool</a></li>
<li><a href="../fr471742/index.html">Sberbank AI Journey. Comment nous avons appris à un réseau de neurones à passer un examen</a></li>
<li><a href="../fr471744/index.html">Tarantool Data Grid: architecture et fonctionnalités</a></li>
<li><a href="../fr471748/index.html">Optimisation en pharmacie: ce que nous avons fait avec les mathématiques</a></li>
<li><a href="../fr471750/index.html">La gestion des accès privilégiés en tant que tâche prioritaire dans la sécurité des informations (par exemple, Fudo PAM)</a></li>
<li><a href="../fr471756/index.html">Comment le serveur démarre</a></li>
<li><a href="../fr471758/index.html">Comment traduire du texte dans une autre langue?</a></li>
<li><a href="../fr471760/index.html">Edward Snowden: The Battlefield - Cryptage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>