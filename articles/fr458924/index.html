<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ñ∂Ô∏è üöø üë®üèΩ‚ÄçüöÄ Les accidents vous aident √† apprendre üßëüèæ üå≠ „ÄΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours des 3 derni√®res ann√©es, plus d'un millier d'incidents √† des degr√©s divers d'√©pop√©e se sont produits √† Contour. Les raisons sont diff√©rentes: ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Les accidents vous aident √† apprendre</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/458924/">  Au cours des 3 derni√®res ann√©es, plus d'un millier d'incidents √† des degr√©s divers d'√©pop√©e se sont produits √† Contour.  Les raisons sont diff√©rentes: par exemple, 36% sont caus√©s par une lib√©ration de mauvaise qualit√© et 14% - en raison de la maintenance du fer dans le centre de donn√©es.  D'o√π viennent les statistiques?  Apr√®s chaque incident, un rapport est r√©dig√© - post mortem.  Ils sont r√©dig√©s par les ing√©nieurs de service qui ont r√©pondu √† la notification de l'accident et ont √©t√© les premiers √† en comprendre les causes.  Les autopsies sont analys√©es, identifi√©es et √©limin√©es les causes des incidents, de sorte qu'√† l'avenir de tels incidents ne se produisent pas.  Mais cela n'a pas toujours √©t√© le cas. <br><br>  <strong>Alexey Kirpichnikov</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">BeeVee</a> ) programme sur Yandex depuis 2008.  Les embouteillages, travaill√© sur des projets sportifs sp√©ciaux, √©tait un chef d'√©quipe du backend Yandex.Taxi.  Depuis 2014, il est engag√© dans le DevOps et l'infrastructure √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kontur</a> - il d√©veloppe des outils qui facilitent la vie des d√©veloppeurs des √©quipes produits.  L'id√©e d'√©crire et d'analyser des sujets post-mortem est apparue il y a cinq ans, et pendant ce temps, les sujets post-mortem ont √©t√© envahis par des mod√®les, un glossaire, des m√©mos, des captures d'√©cran et des analyses.  Mais ce n'est pas le plus difficile - <strong>il a √©t√© plus difficile de surmonter l'inertie, les craintes et l'incompr√©hension de la signification des rapports d'incident chez les ing√©nieurs</strong> .  Ce qui est finalement arriv√© et quel avantage irr√©parable les ¬´analyses de canap√©¬ª peuvent faire, c'est de d√©chiffrer le rapport d'Alexey. <br><br><img src="https://habrastorage.org/webt/ur/pv/rw/urpvrwxzfruc7xv3b7vzpmn-eqc.jpeg"><br>  <i>Veuillez noter - sous les pieds de table de diff√©rentes longueurs, il y a des livres ¬´Metrics¬ª, ¬´Tests¬ª et ¬´Deploy¬ª.</i> <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tuSZq4rW8TQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  √Ä Kontur, apr√®s l'embauche, ils donnent un ensemble de souvenirs: un stylo, une tasse, un cahier.  Je suis arriv√©e chez SKB Kontur dans une nouvelle √©quipe d'infrastructure il y a 5 ans, lorsque l'entreprise a eu 25 ans. <br><br><img src="https://habrastorage.org/webt/5l/-o/ov/5l-oovwyznszo5q4di-2zjn4cp0.jpeg"><br><br>  Le contour de ces temps, et maintenant aussi, est une entreprise de produits dans laquelle plusieurs dizaines de produits ont d√©velopp√© le m√™me nombre d'√©quipes, ind√©pendantes les unes des autres en termes de choix de technologies et d'outils. <br><br>  √Ä cette √©poque, j'ai lu pour la premi√®re fois ¬´Project '' Phoenix ''¬ª et j'ai √©t√© inspir√© par les id√©es nouvelles des pratiques DevOps.  J'ai commenc√© √† √©crire mes id√©es d'am√©liorations dans un cahier, et maintenant c'est un artefact avec des taches de caf√© et des documents historiques. <br><br><ul><li>  ¬´ <strong>Surveillance!</strong>  Mettons Grafana, collectons des m√©triques et construisons des graphiques.  Nous comprendrons mieux ce qui se passe en production. "  Pour 2014, il s'agit d'une nouvelle id√©e assez fra√Æche et d'une pratique DevOps solide. ¬ª </li><li>  " <strong>Crash automatique!"</strong>  Combien de fichiers zip peuvent √™tre t√©l√©charg√©s dans le dossier partag√©, d√©compressez-les sur le serveur et ex√©cutez exe dans le planificateur de t√¢ches sous Windows?  "Introduisons un syst√®me de d√©ploiement industriel et publions des versions √† travers lui, CI!" </li><li>  ¬´ <strong>Autopsie</strong> !  S'il y a une sorte d'accident dans la production, essayons tous de comprendre ce que c'√©tait, de trouver la raison, d'√©crire un rapport et de changer notre d√©veloppement, nos tests, nos processus CI afin qu'il n'y ait plus de tels incidents √† l'avenir ¬ª </li></ul><br>  Depuis 5 ans, nous progressons dans tous ces domaines.  Nous avons notre propre syst√®me d'alerte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Moira</a> , un syst√®me d'orchestration des applications et un tas d'outils.  Mais de tout ce qui pr√©c√®de, la <strong>r√©daction de rapports d'incident s'est av√©r√©e √™tre la pratique d'ing√©nierie la plus difficile √† mettre en ≈ìuvre</strong> .  Les ing√©nieurs adorent toutes sortes d'outils - attachez une sorte de syst√®me d'h√©bergement ou de CI, scriptez quelque chose, automatisez et ils n'aiment pas √©crire de rapports, bien que cette pratique soit d'une grande utilit√©. <br><br>  Je vais vous dire comment nous avons mis en ≈ìuvre des syst√®mes post-mortem et quels avantages nous en tirons.  Peut-√™tre que notre r√¢teau aidera √† aller plus vite et √† remplir moins de c√¥nes.  Avant de commencer √† parler d'autopsie, nous comprendrons la d√©finition. <br><br><h2>  Qu'est-ce qu'un incident? </h2><br>  Lequel de ces incidents est l'incident? <br><br><ul><li>  Exemple n ¬∞ 1.  Sur une plateforme de blog avec un million d'utilisateurs, √† la suite d'une sorte d'erreur, toutes les entr√©es d'un utilisateur sont perdues. </li><li>  Exemple n ¬∞ 2.  Le service pour les employ√©s de bureau fonctionne les jours de semaine de 9 √† 6, et √† d'autres moments, il n'y a pas d'utilisateurs.  Le service n'√©tait pas disponible dans la nuit du samedi au dimanche pendant deux heures cons√©cutives, personne ne l'a remarqu√©. </li><li>  Exemple n ¬∞ 3.  Grafana avec des mesures de production a chut√© de 15 minutes.  En production, rien ne s'est cass√©, mais les graphismes n'√©taient pas disponibles. </li></ul><br>  Pour comprendre ce qu'est cette fakapy, nous nous tournons vers l'exp√©rience des gourous - Google, Atlassian, PagerDuty.  Les gourous savent comment pr√©parer les √©quipes, les ing√©nieurs de garde et comment r√©diger des rapports pour les comprendre.  Leurs guides en ligne ont des d√©finitions d'incidents. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©finition</a> de PagerDuty. <br><blockquote>  Un incident est toute interruption ou d√©gradation non planifi√©e d'un service qui affecte la disponibilit√© du service pour les utilisateurs.  Un incident grave est un incident qui n√©cessite une r√©ponse coordonn√©e de plusieurs √©quipes. </blockquote><br>  Cela semble logique, mais la d√©finition est vague.  En pratique, cela aide peu √† comprendre ce qu'est un incident et ce qui ne l'est pas. <br><br>  Le livre sur l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ing√©nierie de la fiabilit√© des sites</a> de Google a des crit√®res clairs: <br><br><ul><li>  Les utilisateurs ont remarqu√© la d√©gradation du service. </li><li>  Toutes les donn√©es ont √©t√© perdues. </li><li>  Il a fallu l'intervention de l'ing√©nieur de garde, par exemple, pour annuler manuellement la lib√©ration. </li><li>  La r√©solution du probl√®me a pris trop de temps.  Si un probl√®me a √©t√© r√©solu en 2 heures, puis qu'une semaine a √©t√© consacr√©e √† ce probl√®me - il s'agit d'un incident qui n√©cessite une enqu√™te. </li><li>  La surveillance n'a pas fonctionn√©.  Par exemple, vous avez d√©couvert un probl√®me des utilisateurs. </li></ul><br>  Contour n'a pas de d√©finition publi√©e d'un fakap, mais nous avons formul√© nos crit√®res pour d√©terminer ce qui est un incident. <br><br>  <strong>Les utilisateurs externes ou internes ont constat√© une d√©gradation du service</strong> .  L'exemple n ¬∞ 3 avec Grafana, qui gisait, est un incident clair.  La production n'a pas cass√© et les utilisateurs externes ne l'ont pas remarqu√©, mais malgr√© cela, pour Contour c'est un fakap, car les outils internes ne fonctionnaient pas. <br><br>  <strong>Chance</strong> .  Dans l'exemple n ¬∞ 2, le service des employ√©s de bureau a dur√© 2 heures la nuit - il a eu de la chance qu'il tombe la nuit.  La prochaine fois, ce sera peut-√™tre malchanceux, et donc l'incident de nuit doit √©galement √™tre jug√©, comme s'il s'√©tait produit pendant la journ√©e. <br><br>  <strong>L'incident concerne plusieurs √©quipes</strong> .  Nous prenons cette d√©finition de PagerDuty.  L'analyse d'un incident est une bonne raison pour que plusieurs √©quipes travaillent ensemble.  La culture ¬´De notre c√¥t√©, la balle a vol√©, mais quelque chose s'est cass√© pour vous - c'est de votre faute¬ª est √©radiqu√©e par une analyse conjointe. <br><br>  <strong>Au moins un ing√©nieur consid√®re cela comme un incident</strong> .  La d√©finition la plus vague, mais aussi la plus importante.  Une r√®gle simple: si l'ing√©nieur estime que le rapport vaut la peine, alors il vaut le rapport.  Si cela vous fait peur que les ing√©nieurs commencent √† r√©diger des rapports pour n'importe qui et appellent toute petite chose un accident, ce n'est pas le cas.  <strong>Les ing√©nieurs sont des gens raisonnables, faites-leur confiance.</strong> <br><br>  Avec la d√©finition et les diff√©rents types de dommages tri√©s.  Passons √† la fa√ßon de b√©n√©ficier des incidents. <br><br><h2>  √Ä quoi sert le fakap? </h2><br>  Les instructions simples que je donnerai plus loin, vous pouvez postuler vous-m√™me, sans m√™me parcourir l'article jusqu'au bout.  Mais lisez toujours jusqu'√† la fin. <br><br><h3>  Instruction classique </h3><br>  Trouvez d'abord les coupables.  Faites ensuite le travail ¬´p√©dagogique¬ª avec les ing√©nieurs. <br><br><ul><li>  Demandez √† √™tre plus prudent la prochaine fois. </li><li>  Si cela ne vous aide pas, envoyez-le √† des cours de recyclage.  Peut-√™tre y apprendront-ils √† √™tre plus prudents. </li><li>  Si cela ne vous aide pas, supprimez les auteurs de travailler avec des parties critiques du syst√®me.  Arr√™tez de laisser les d√©veloppeurs en production s'ils g√¢chent l√†-bas. </li><li>  Si rien n'y fait, licenciez les mauvais et engagez des comp√©tents. </li></ul><br><blockquote>  Si l'instruction vous agace, c'est une bonne nouvelle. </blockquote><br>  Cette approche est consid√©r√©e comme traditionnelle pour les soci√©t√©s classiques √† orientation verticale avec un patron qui gronde tout le monde et peut le licencier.  L'un des fondements du mouvement DevOps et de l'id√©ologie DevOps est le d√©part d'organisations verticalement int√©gr√©es vers des organisations horizontales, avec une plus grande confiance dans les employ√©s. <br><br>  J'illustrerai ce changement de paradigme avec des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instructions de</a> John Alspaw, l'un des leaders du mouvement DevOps, qui travaillait auparavant pour CTO √† Etsy.  L'instruction est tir√©e de son article canonique de 2013, Blameless Post Mortem and a Just Culture. <br><br>  Demandez aux ing√©nieurs: <br><br><ul><li>  quels √©v√©nements ils ont observ√©s; </li><li>  quand et quelles mesures ont √©t√© prises; </li><li>  quel r√©sultat √©tait attendu de ces actions; </li><li>  de quelles hypoth√®ses provenaient; </li><li>  tel que compris par la s√©quence des √©v√©nements qui se sont produits. </li></ul><br><blockquote>  Les ing√©nieurs doivent √™tre interrog√©s sans menace de punition. </blockquote><br>  C'est l'essentiel de la recommandation de John. <br><br>  La menace de punition: recyclage, √©limination de la production ou licenciement, motive les gens √† mentir.  Et la v√©rit√© est importante pour nous.  Rapport d'incident - c'est le lien de r√©troaction tr√®s manquant dans le processus de d√©veloppement et de mise en production de fonctionnalit√©s. <br><br>  Dans l'ancien paradigme, les d√©veloppeurs ont d√©velopp√©, jet√© le vaisseau par-dessus la cl√¥ture aux ing√©nieurs d'exploitation et ils ont essay√© de le faire fonctionner.  Ils sont ennuy√©s par toute mise √† jour, car elle peut tout casser, et les ing√©nieurs ont tout commenc√© avec tant de difficult√©. <br><br><img src="https://habrastorage.org/webt/vu/l6/lo/vul6locumgejop93bd_wec32vgu.jpeg"><br><br><blockquote>  Le processus de r√©troaction permet de changer le processus, l'infrastructure, les outils et l'approche de d√©veloppement afin qu'il y ait moins de plantages en production. </blockquote><br>  Cela convaincra les chefs d'√©quipe et les responsables du d√©veloppement de l'utilit√© de l'autopsie.  Mais le probl√®me est qu'il est difficile d'amener les ing√©nieurs √† faire ce qu'ils pensent inutile et inutile.  Nous avons une culture d'ing√©nierie dans notre entreprise, et je ne peux pas simplement venir, agiter le d√©cret du PDG et exiger que tout le monde √©crive post-mortem.  Je dois en convaincre les ing√©nieurs. <br><br><img src="https://habrastorage.org/webt/r_/bx/z6/r_bxz6wh5wxshbqejunizuaspxk.jpeg"><br><br>  Comment ¬´vendre¬ª l'id√©e d'ing√©nieurs post-mortem aux ing√©nieurs?  Pour contourner les objections, pour montrer pourquoi l'autopsie est cool, pour d√©montrer l'avantage des rapports, que ce n'est pas seulement une d√©sinscription, si seulement le patron est derri√®re. <br><br><h2>  Objection n ¬∞ 1: une fois </h2><br>  C'est le premier probl√®me de l'ing√©nieur qui d√©monte le fakap - la guerre se terminera, alors nous parlerons!  Lorsqu'un fakap se produit, je veux le r√©parer rapidement, mais je ne veux pas √©crire des rapports incompr√©hensibles et longs. <br><br>  Pour r√©soudre le probl√®me, il y a un hack de vie, comment √©crire quelque chose de bien lors d'un accident.  Il a √©t√© popularis√© par Artemy Lebedev: <br><blockquote>  ¬´Il existe une mani√®re simple d'organiser le temps - la m√©thode de la¬´ jeepeg progressive ¬ª.  √Ä tout instant, tout projet est pr√™t √† 100%, bien qu'il puisse √™tre 4% plus d√©velopp√©.  Selon le temps disponible, le projet peut √™tre √©labor√© jusqu'√† un pixel, ou il peut √™tre laiss√© au stade de l'esquisse conceptuelle. ¬ª </blockquote><br>  Je vais illustrer la m√©thode progressive jeepeg en utilisant une image.  Sur un Internet lent, une image n'est pas t√©l√©charg√©e imm√©diatement, mais par √©tapes. <br><br><img src="https://habrastorage.org/webt/ug/af/nu/ugafnukcgr0qse0ffzyd1_og898.jpeg"><br><br>  Lors d'un incendie, vous n'avez pas besoin de r√©diger un rapport cool et long.  Cela vous suffit dans le coin sup√©rieur gauche.  Il suffit de marquer les choses qui seront difficiles √† r√©cup√©rer de la m√©moire.  N'essayez pas d'√©crire un texte litt√©raire coh√©rent √† un moment o√π tout est cass√© en production. <br><br><blockquote>  Effectuez une action simple - notez la chronologie des √©v√©nements. </blockquote><br><h3>  Chronologie </h3><br>  La chronologie est alors tr√®s difficile √† restaurer, si elle n'est pas enregistr√©e imm√©diatement.  Un exemple d'enregistrement d'un vrai post-mortem dans le circuit. <br><br><pre><code class="plaintext hljs">15.01.18 17:25 YEKT    PrefixSearch  50   . ,     .</code> </pre> <br>  Il s'agit d'une observation horodat√©e courte et simple.  Selon cette chronologie, plus tard, il est facile de restaurer la s√©quence des √©v√©nements et de trouver la cause de la panne.  Mais si vous n'enregistrez rien directement pendant un incendie, il sera difficile, voire impossible, de restaurer les √©v√©nements ult√©rieurement. <br><br><h3>  Captures d'√©cran </h3><br>  Une chose pratique, surtout lorsque vous travaillez avec un site Web ou une application de bureau.  La situation est parfois difficile √† d√©crire avec des mots, et une capture d'√©cran n'est qu'un clic d'une touche de raccourci. <br><br><img src="https://habrastorage.org/webt/a5/vw/ek/a5vwektoqktqkzwwatkfkirlbdk.jpeg"><br><br>  La premi√®re objection a fonctionn√©.  Enregistrement d'un minimum d'informations, un petit rapport lors de l'incident n'est pas difficile et ne prend pas un temps pr√©cieux.  Lorsque tout est termin√©, il doit √™tre compl√©t√© et ex√©cut√© dans un document compr√©hensible et coh√©rent. <br><br><h2>  Objection n ¬∞ 2: la paresse </h2><br>  Vous n'avez pas dormi pendant deux jours et avez corrig√© un grave accident, en retard fatal dans toutes les t√¢ches que vous alliez accomplir cette semaine.  Mais il s'av√®re que quelque chose d'autre doit √™tre fait, mais le feu a d√©j√† √©t√© √©teint!  En ce moment, une paresse inimaginable se rattrape. <br><br>  Pour vaincre compl√®tement le probl√®me ne fonctionnera pas.  Mais vous pouvez faciliter votre travail √† l'avance. <br><br><h3>  Motif </h3><br>  C‚Äôest d‚Äôabord et avant tout.  Il y a une grande crainte d'un document vide qui doit √™tre rempli de texte significatif.  C'est beaucoup plus facile si le mod√®le est pr√©par√©.  Il se compose g√©n√©ralement de sections et de questions.  Nous entrons les r√©ponses aux questions dans chaque section, et le mod√®le est rempli. <br><br>  Les mod√®les de rapport d'incident sont volumineux.  Lisez-les en d√©tail avec le gourou.  Tous les documents et livres auxquels je fais r√©f√©rence contiennent des mod√®les d'incident utilis√©s par les entreprises.  D'apr√®s notre exp√©rience, je peux ajouter ce qui suit. <br><br><h3>  Cr√©er un m√©mo avec des exemples </h3><br>  Notre mod√®le comporte une section ¬´Dommages¬ª avec des sous-sections. <br><br>  <strong>Section "√âvaluation qualitative".</strong>  Il d√©crit ce que l'ing√©nieur voit devant lui lorsqu'il remplit cette partie du mod√®le: <br><br><ul><li>  quelle fonctionnalit√© n'a pas fonctionn√©, combien de temps et pour qui; </li><li>  s'il y a eu perte ou corruption de donn√©es. </li></ul><br>  Ayant atteint cet endroit dans le mod√®le, l'ing√©nieur √©crit: "Il y a un million d'utilisateurs sur notre plateforme de blog, nous avons perdu toutes les entr√©es de l'un d'eux."  C'est beaucoup plus facile que d'√©crire un essai √† partir de z√©ro, comme dans une le√ßon de litt√©rature. <br><br>  <strong>Section "Quantification":</strong> <br><br><ul><li>  combien de demandes ont disparu; </li><li>  combien de latence a augment√© dans les m√©triques d'application et d'application client; </li><li>  combien d'appels sont perdus; </li><li>  Taille de la file d'attente du support technique utilisateur pour le probl√®me. </li></ul><br>  Un ensemble de ces questions est le mod√®le. <br><br>  Un exemple de l'un des mod√®les compl√©t√©s. <br><br><img src="https://habrastorage.org/webt/kv/4o/yq/kv4oyqs_2ukhu-o1hdrxgtc01s8.jpeg"><br><br><h3>  Ajouter un glossaire </h3><br>  Un autre hack de vie pour les rapports d'accident, que je n'ai pas vu dans le livre avec le gourou.  Lors de la r√©daction d'un rapport, il est pratique d'utiliser des termes que vous connaissez bien.  Par exemple, si je travaille avec Graphite, dans lequel les m√©triques sont stock√©es, je sais bien ce qu'est un ¬´relais¬ª.  Mais l'ing√©nieur qui lira le rapport dans un an peut ne pas √™tre familier avec le terme.  Il est peu probable qu'il soit en mesure de lire le rapport, qui se compose de mots inconnus.  D'un autre c√¥t√©, si chaque terme et d√©finition est constamment m√¢ch√© dans le rapport, la paresse ne fera que l'effrayer et le rapport ne sera pas termin√©. <br><br><blockquote>  R√©digez un petit glossaire d√©crivant tous les termes utilis√©s dans le rapport. </blockquote><br><img src="https://habrastorage.org/webt/it/fm/6z/itfm6zuhzxdahe90n6fqvaifhz0.jpeg"><br><br><h3>  Copiez tous les artefacts </h3><br>  Si vous attachez des artefacts au rapport: des instantan√©s dans Grafana, l'historique des messages dans le chat, dans lequel l'incident a √©t√© analys√© avec d'autres ing√©nieurs, faites des copies.  Les m√©triques ont la possibilit√© de ¬´pourrir¬ª et les chats changent.  Il y a un an, vous √©tiez √† Slack, maintenant dans Telegram - le lien de discussion est obsol√®te et ne fonctionne pas, et les mesures de r√©tention vont tomber - elles sont stock√©es pendant un an. <br><br><blockquote>  Copiez les artefacts - ce hack de vie facilite la r√©daction de rapports. </blockquote><br><h2>  Objection n ¬∞ 3: personne ne lira </h2><br>  La plus grande et incompr√©hensible question pos√©e par les ing√©nieurs est: "Qui lira ces rapports?"  Supposons que j'ai surmont√© la paresse et √©crit une chronologie des √©v√©nements pendant l'accident.  Il a ensuite rassembl√© ses forces et a ajout√© un rapport de plusieurs pages sur ce qui s'est pass√© et les causes de l'accident.  Mais s'il n'y a aucune compr√©hension de qui lira tout cela et qui en b√©n√©ficiera, il n'y a pas de d√©sir de remplir des rapports. <br><br><blockquote>  L'autopsie est une r√©troaction dans le processus d'am√©lioration continue des processus de d√©veloppement. </blockquote><br>  Dans tout livre de gourou, par exemple, dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">manuel sur les incidents d'Atlassian</a> , il est √©crit qu'en fonction des r√©sultats de chaque autopsie, il est n√©cessaire: <br><br><ul><li>  formuler des t√¢ches en d√©veloppement; </li><li>  cr√©er des t√¢ches dans le bugtracker √† partir desquelles vos d√©veloppeurs les prendront; </li><li>  mettre des liens de l'autopsie √† ces t√¢ches. </li></ul><br>  <strong>Le feedback est clos</strong> : voici un post-mortem, ici des <strong>actions</strong> : des t√¢ches qui doivent √™tre accomplies pour que l'accident ne se reproduise plus.  Les t√¢ches tombent dans l'arri√©r√© de l'√©quipe, l'√©quipe les d√©veloppe, d√©ploie - encore une fois le fakap et l'autopsie.  La roue du samsara s'est ferm√©e. <br><br>  C'est sur quoi tous les gourous convergent.  Il n'y a rien √† contester - les avantages sont √©vidents. <br><br>  Un exemple de t√¢ches d'√©l√©ments d'action d'un post-mortem r√©el. <br><br><img src="https://habrastorage.org/webt/bi/rh/-u/birh-ug-du80xmxqt3eqvdrdst8.jpeg"><br><br>  Mais chez Kontur, nous avons ajout√© un analyste √† cela. <br><br><h2>  Analyse de canap√© </h2><br>  Nous avions l'habitude d'analyser l'incident isol√©ment.  L'√©chec s'est produit de lui-m√™me dans une √©quipe, dans un syst√®me d'h√©bergement - quelque chose s'est cass√©, nous l'avons corrig√©. <br><br>  Mais il y a de nombreux incidents.  Au cours des trois derni√®res ann√©es, plus de 1 000 rapports d'incidents se sont accumul√©s dans le circuit.  Je voudrais savoir s'il est possible de b√©n√©ficier de toute la masse des rapports accumul√©s, et pas seulement de chacun individuellement.  Est-il possible sur leur base de calculer les statistiques du syst√®me et de voir ce qu'il faut am√©liorer dans le syst√®me dans son ensemble. <br><br>  Une √©quipe d'infrastructure sp√©ciale travaille √† Kontur, qui est engag√©e dans l'analyse de l'autopsie et publie les r√©sultats et les conclusions sur la base de la masse enti√®re des rapports accumul√©s.  Nous appelons cela ¬´l'analyse de canap√©¬ª.  Je vais vous donner des fragments d'un des articles de l'√©quipe, qui est publi√© sur notre r√©seau interne pour les employ√©s. <br><br>  Qu'analysons-nous dans l'analyse de canap√©? <br><br><h3>  Dur√©e du Fakap </h3><br><br><img src="https://habrastorage.org/webt/2b/yq/wz/2byqwzifhia0nzxypk0eqmqrdh8.jpeg"><br><br>  <em>Dans le diagramme, en plus de la derni√®re colonne, o√π l'heure est inconnue, il y a deux pics plus √©vidents.</em> <br><br>  <strong>Dur√©e de l'ordre d'une heure</strong> - barres orange et rouges.  La plupart de ce temps a √©t√© consacr√© √† transmettre des informations sur ce qui s'est pass√©, de l'ing√©nieur qui a remarqu√© l'accident √† l'ing√©nieur qui sait comment le r√©parer.  <strong>Le probl√®me est la communication</strong> . <br><br>  Si nous r√©parons nos outils afin que l'ing√©nieur qui r√©sout le probl√®me re√ßoive plus rapidement les informations, la dur√©e des fakaps et les d√©g√¢ts qui en d√©coulent seront consid√©rablement r√©duits.  C'est quelque chose que nous ne reconna√Ætrions pas en examinant un fakap individuellement. <br><br>  <strong>Dur√©e environ 12 heures</strong> - une colonne jaune.  L'explication du fait qu'il existe de nombreux fakaps qui durent plus de 12 heures est simple: ils ont lanc√© la sortie le soir, et le matin, les utilisateurs sont venus et tout s'est cass√©.  La conclusion de ce qu'il faut faire pour r√©duire le nombre de ces fakaps est √©vidente. <br><br><h3>  Dommages de qualit√© </h3><br><img src="https://habrastorage.org/webt/js/l0/i9/jsl0i9hoqlos7n2uloqh0nnki_y.jpeg"><br><br>  Les dommages qualitatifs sont divis√©s en plusieurs cat√©gories.  Le top 3 comprend: <br><br><ul><li>  inaccessibilit√©, erreurs; </li><li>  freins, latence accrue; </li><li>  comportement incorrect visible. </li></ul><br>  Selon l'analyse, la grande majorit√© de ces erreurs.  D'une part, c'est une bonne nouvelle.  Trois types d'erreurs les plus courantes sont faciles √† d√©tecter - nous ajustons les mesures √† la latence et au nombre d'erreurs, et remarquons rapidement de telles choses. <br><br>  La mauvaise nouvelle, c'est qu'il y a la plupart de ces erreurs.  Ce sont de simples erreurs techniques, ce qui signifie que nous pourrions am√©liorer quelque chose dans les tests de pipeline, effectuer plus de tests de r√©sistance et am√©liorer le syst√®me de surveillance. <br><br><h3>  D√©clencheurs </h3><br>  C'est ce qui a directement conduit √† la panne, c'est-√†-dire non pas la cause premi√®re de l'accident, mais la ¬´derni√®re goutte¬ª: les b√ªches ont rempli le disque et √† cause de cela, tout s'est cass√©, mis en libert√© - tout a explos√©. <br><br><img src="https://habrastorage.org/webt/vi/u5/iy/viu5iyoxhj_ykvpg9itnr-7qy0u.jpeg"><br><br>  En premier lieu, la ¬´mise √† jour de l'installation¬ª.  Cette raison nous permet de comprendre o√π nous, en tant qu'√©quipe d'infrastructure, devons investir.  Par exemple, pour am√©liorer le syst√®me de d√©ploiement et introduire un d√©ploiement canari.  C'est le point d'effort qui aura le plus d'impact sur la qualit√© de nos syst√®mes. <br><br><blockquote>  C'est le point de toutes les analyses - pour comprendre o√π une petite √©quipe d'infrastructure devrait investir d√®s maintenant dans des conditions de ressources limit√©es. </blockquote><br>  Quoi am√©liorer - alerte ou d√©ploiement?  Que faire - l'h√©bergement ou la beaut√© des graphiques? <br><br>  Voici un autre bon aper√ßu.  En deuxi√®me position, ¬´la cause est inconnue¬ª.  Il s'agit d'un indicateur de mauvaise communication des rapports d'incident. <br><br><h3>  "Pilules" possibles </h3><br>  Cela permet une solution technique simple pour r√©duire le nombre d'accidents d'un certain type.  Par exemple, nous savons que les choses les plus importantes qui r√©duisent le nombre de fakaps sont les notifications du syst√®me de surveillance.  S'il y avait plus d'alertes dans la surveillance de ces √©v√©nements, combien d'incidents pourrions-nous √©viter?  Le pourcentage indique combien: <br><br><ul><li>  sur le nombre d'erreurs HTTP du client - 10%; </li><li>  sur l'apparition de nouveaux types d'erreurs dans les journaux: installation, param√®tres de notification - 8%; </li><li>  sur les ressources syst√®me: CPU, m√©moire, disque, threads, GC - 6%. </li></ul><br>  Si l'alerte √©tait correctement configur√©e et que l'ing√©nieur souhait√© recevait une notification √† temps, 24% des incidents ne se produiraient pas ou auraient une dur√©e beaucoup plus courte.  Cette conclusion peut √™tre tir√©e sur la base de l'analyse de l'ensemble des incidents. <br><br>  Ici, je vais de nouveau annoncer notre syst√®me d'alerte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Moira</a> , qui est situ√© en Open Source. <br><br><img src="https://habrastorage.org/webt/fz/yu/tb/fzyutbmpcgj2xnarmqhxwnqbrjk.jpeg"><br><br>  Si vous disposez de Graphite, vous pouvez le t√©l√©charger et l'utiliser.  J'esp√®re qu'il y aura moins d'incidents. <br><br><h3>  Recommandations </h3><br>  Recommandations organisationnelles que l'√©quipe peut suivre, et aussi r√©duire le nombre d'accidents.  Notre top 3. <br><br><ul><li>  <strong>La similitude des sites de test et de combat</strong> .  5% des incidents sont survenus du fait que le site d'essai n'√©tait pas assez similaire au site de combat. </li><li>  <strong>Compatibilit√© descendante dans les versions</strong> .  La version a √©t√© d√©gonfl√©e, n'√©tait pas r√©trocompatible avec la pr√©c√©dente, des migrations de donn√©es sont survenues - 4% des erreurs. </li><li>  <strong>Refus des lib√©rations nocturnes</strong> .  Si vous cessez de diffuser des rejets qui cassent, le soir, 4% des incidents dispara√Ætront. </li></ul><br>  Je souligne qu'il ne s'agit pas d'une instruction, mais d'une histoire sur la fa√ßon dont nous avons collect√© des analyses.  Vos analyses peuvent √™tre diff√©rentes. <br><br><h2>  Comment √©crire </h2><br>  Si vous r√©alisez que l'analyse des incidents est une bonne chose et que vous devez r√©diger des rapports, je vais vous dire comment proc√©der. <br><br><h3>  Post-mortem et t√¢ches dans un outil de suivi des bogues </h3><br>  Dans le bugtracker, contrairement √† Google Docs ou Wiki, il existe des champs fixes pour lesquels vous pouvez d√©finir un ensemble de valeurs.  Cela facilite l'analyse des statistiques graphiques ult√©rieurement. <br><br>  Dans le livre SRE, Google fournit un mod√®le dans Google Docs dans lequel ils √©crivent des rapports dans leur document interne.  Je ne peux pas imaginer comment nous pouvons collecter les analyses que nous collectons √† partir de documents Google non structur√©s. <br><br>  Nous √©crivons des rapports dans le m√™me traqueur de bogues que les t√¢ches principales, car nous pouvons connecter la t√¢che avec l'autopsie.  Examinons l'autopsie et voyons imm√©diatement quelles t√¢ches sont ferm√©es, lesquelles ne le sont pas et lesquelles restent √† faire. <br><br><h3>  Cr√©er des champs sp√©ciaux </h3><br>  J'ai d√©j√† parl√© de domaines sp√©ciaux.  Nous avons ce qui suit. <br><br><ul><li>  Le d√©but et la fin du fakap peuvent √™tre analys√©s automatiquement.  Si vous mettez des horodatages lisibles par machine, vous pouvez tracer la dur√©e du fakap. </li><li>  Le d√©but et la fin de l'enqu√™te. </li><li>  D√©clencheur  Configurez une liste d√©roulante de d√©clencheurs, c'est plus pratique. </li><li>  Comme indiqu√©. </li><li>  Dommages quantitatifs et qualitatifs. </li><li>  √âquipes et services concern√©s. </li></ul><br>  Toutes les donn√©es de champs sp√©ciaux vous permettent de comprendre le fonctionnement de votre infrastructure. <br><br>  Un exemple de notre rapport d'incident termin√©. <br><br><img src="https://habrastorage.org/webt/2r/dk/c3/2rdkc3flemuokdisdblhr6ls0cg.jpeg"><br><br>  Les champs de la colonne de droite sont simplement remplis gr√¢ce √† la s√©lection dans les listes d√©roulantes. <br><br><h3>  Rassemblez une √©quipe d'ing√©nieurs soucieux de la qualit√© </h3><br>  Pour obtenir des rapports qui vous aideront √† comprendre comment d√©velopper votre infrastructure, vous aurez besoin de personnes soucieuses de la qualit√© de vos services.  Ce ne seront pas n√©cessairement des ing√©nieurs qui se consacreront uniquement √† l'analyse √† temps plein √† l'autopsie.  Il est important que ces personnes soient tr√®s pr√©occup√©es par ce qui se passe.  De temps en temps, ils se rassemblent, analysent toute la masse des incidents, √©crivent de gros articles et apportent des avantages - fermez le cercle de r√©troaction. <br><br>  Notre √©quipe s'appelle Q-team - du mot "Qualit√©".  Il compte 3 personnes - l'un des ing√©nieurs les plus talentueux de l'entreprise qui travaillent dans les infrastructures. <br><br><h2>  Total </h2><br>  <strong>Lisez le gourou - les</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">articles de John Allspaw</a> et les livres sur la gestion des incidents: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Site Reliability Engineering</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PagerDuty Post-Mortem Process</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Atlassian Incident Handbook</a> . <br><br>  Et quand vous venez travailler demain, faites <strong>les premiers pas</strong> : <br><br><ul><li>  d√©marrer un projet de fakaps dans le bugtracker dans lequel vous effectuez des t√¢ches; </li><li>  prenez n'importe quel mod√®le - n'essayez pas d'√©crire le v√¥tre, de prendre le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">n√¥tre</a> ou de Google dans SRE; </li><li>  quand quelque chose explose, √©crivez. </li></ul><br>  Au moment o√π vous r√©digez les premier, deuxi√®me et troisi√®me rapports, vous n'aurez pas de belles analyses avec des colonnes multicolores.  Mais apr√®s un an ou deux, lorsque les donn√©es se sont accumul√©es, vous regardez en arri√®re et vous remerciez pour la premi√®re √©tape. <br><br><blockquote>  Nous esp√©rons que vous vous souviendrez et remercierez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alexei</a> pour l'histoire d'une telle exp√©rience.  Et nous, √† notre tour, essaierons de collecter de nouveaux rapports utiles dans le programme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevOpsConf</a> , des recommandations √† partir desquelles vous pourrez vous adresser et postuler.  La conf√©rence se tiendra du 30 au 1 <strong>septembre 2019</strong> , jusqu'au 20 ao√ªt, nous attendons toujours les candidatures des supporters de DevOps, mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">12</a> ont d√©j√† √©t√© approuv√©es, c'est-√†-dire que la concurrence sera plus √©lev√©e plus pr√®s de la date limite. <br><br>  Si vous souhaitez partager votre exp√©rience, d√©cidez-vous et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">envoyez vos r√©sum√©s</a> .  Si vous souhaitez recevoir les actualit√©s du programme - abonnez-vous √† notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">newsletter</a> et √† notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Æne de t√©l√©grammes</a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr458924/">https://habr.com/ru/post/fr458924/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr458914/index.html">Ce que vous devez savoir (pas) pour cr√©er des jeux sur Unity</a></li>
<li><a href="../fr458916/index.html">Sous le capot de React. Nous √©crivons notre impl√©mentation √† partir de z√©ro</a></li>
<li><a href="../fr458918/index.html">Ce que vous pouvez apprendre de la conception de jeux hyper-occasionnels</a></li>
<li><a href="../fr458920/index.html">Conf√©rence pour les fans de DevOps</a></li>
<li><a href="../fr458922/index.html">Comment passer d'ESXi √† KVM / LXD et ne pas perdre la t√™te</a></li>
<li><a href="../fr458926/index.html">La trag√©die ne vient pas seule</a></li>
<li><a href="../fr458928/index.html">XLNet vs BERT</a></li>
<li><a href="../fr458930/index.html">Comment les √©tudiants de Perm se sont rendus en finale du championnat international d'analyse de donn√©es Data Mining Cup 2019</a></li>
<li><a href="../fr458932/index.html">Yota - ou comment tout savoir</a></li>
<li><a href="../fr458934/index.html">D√©ploiement d'applications sur plusieurs clusters Kubernetes avec Helm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>