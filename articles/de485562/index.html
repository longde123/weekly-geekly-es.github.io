<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🚀 📩 🚮 Surfen im Internet mit einem Gamepad (Javascript) 🚔 🆒 👂🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wenn Sie am Tisch sitzen, verwenden Sie Maus und Tastatur auf der Couch - am wahrscheinlichsten das Touchpad eines Laptops oder den Touchscreen eines ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Surfen im Internet mit einem Gamepad (Javascript)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485562/"><p><img src="https://habrastorage.org/webt/ep/vg/pu/epvgpuyawysxaiqnq7p0vkfv_9y.jpeg"></p><br><p>  Wenn Sie am Tisch sitzen, verwenden Sie Maus und Tastatur auf der Couch - am wahrscheinlichsten das Touchpad eines Laptops oder den Touchscreen eines Tablets.  Sie können sogar Leap Motion verwenden und Ihren Computer mit Gesten steuern.  Wie Sie bereits verstanden haben, gibt es viele Möglichkeiten, im Internet zu surfen und Ihren Computer zu verwalten.  Ein Gamepad kann eines davon sein. </p><br><p>  In diesem Artikel werde ich mit Ihnen teilen, wie: </p><br><ul><li>  Verbinden Sie das Gamepad mit dem Browser </li><li>  Hören Sie sich Gamepad-Ereignisse an </li><li>  Kontrollieren Sie den Fokus auf Seitenelemente mit einem Gamepad </li><li>  Feedback in Form von Vibration geben </li></ul><br><p> Schließen Sie Ihr Gamepad über USB oder Bluetooth an und legen Sie los. </p><a name="habracut"></a><br><h3 id="geympad-api">  Gamepad API </h3><br><p>  Dem HTML 5-Standard wurde <a href="https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API" rel="nofollow">ein API-Gamepad</a> hinzugefügt, das die Verwendung von Gamepads in einem Browser ermöglicht.  In Kombination mit einem Element kann diese API verwendet werden, um Spiele zu erstellen, die ein Gamepad unterstützen.  Daher können Benutzer Spiele mit dem Gamepad direkt im Browser spielen, was sehr cool ist.  Die API kann aber nicht nur für Spiele verwendet werden.  Niemand hindert Sie daran, ein Eingabegerät in Form eines Gamepads für ganz andere Zwecke zu erstellen. <br></p><blockquote>  <a href="https://dev.caniuse.com/gamepad" rel="nofollow">Die Gamepad-API wird gut unterstützt</a> , befindet sich jedoch noch im Entwurfsstadium.  Möglicherweise wird sich in Zukunft etwas ändern, gelöscht oder hinzugefügt. </blockquote><br><h3 id="podklyuchaem-geympad">  Wir verbinden ein Gamepad </h3><br><p>  Wenn das Gamepad über USB oder Bluetooth eine Verbindung zum Computer herstellt, können zwei Ereignisse verwendet werden, um Verbindungen herzustellen und zu trennen: </p><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'gamepadconnected'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// , -   console.log(event) }); window.addEventListener('gamepaddisconnected', function(event) { // , -   });</span></span></code> </pre> <br><p>  Das Gamepad funktioniert erst, nachdem Sie die Taste gedrückt haben (ca. Translate Any oder Start).  Tatsache ist, dass dies die Sicherheit / Privatsphäre des Browsers ist.  Daher ist es notwendig, über die Benutzeroberfläche nachzudenken, um den Benutzer über die Notwendigkeit zu informieren, eine Taste zu drücken, um mit der Arbeit zu beginnen. </p><br><p>  Die Gamepad-Ereignisse in der Konsole lauten wie folgt: </p><br><p><img src="https://habrastorage.org/webt/qy/yh/dh/qyyhdhijlimo1vb57vykhhamo1a.png"></p><br><h3 id="raskladka-geympada-knopki-i-osi">  Gamepad-Layout: Schaltflächen und Achsen </h3><br><p>  Wie Sie sehen, enthält das Ereignisprotokoll eine Reihe von Schaltflächen (0 - 16) und Achsen (Achsen 0 - 3).  Aber woher weißt du, wie sich die Knöpfe hinter der Nummer verstecken?  Gamepads haben je nach Marke unterschiedliche Layouts.  Deshalb sollten Sie im Internet nach Informationen suchen.  In diesem Fall verbinden wir das Xbox One-Gamepad und es hat folgendes Layout: </p><br><p><img src="https://habrastorage.org/webt/ha/hr/hb/hahrhbrn2u26e-q6idtlyxbbbgy.png"></p><br><h3 id="slushaem-nazhatie-klavishi">  Hören Sie den Tastenanschlag </h3><br><p>  Bei der Entwicklung von Schnittstellen können Sie <code>.addEventListener()</code> , um ein Ereignis <code>.addEventListener()</code> Tastendruck hinzuzufügen.  In diesem Fall ist dies nicht möglich, da die Schaltflächen auf der Steuerung keine Ereignisse erzeugen.  Und wie Sie dem obigen Protokoll entnehmen können, müssen Sie das <code>pressed</code> Feld manuell prüfen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> xBoxButtonB = gamepad.buttons[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (xBoxButtonB.pressed) { doSomethingOnButtonPress(); }</code> </pre> <br><p>  Da wir die Überprüfung ständig durchführen möchten, müssen wir alles in eine Schleife packen.  Beispiel mit <code>requestAnimationFrame</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rAF = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.mozRequestAnimationFrame || <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.requestAnimationFrame; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'gamepadconnected'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ updateLoop(); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateLoop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    rAF(updateLoop); }</span></span></code> </pre> <br><h3 id="navigaciya-mezhdu-elementami">  Navigation zwischen Elementen </h3><br><p>  Um das Gamepad zum Navigieren auf der Webseite zu verwenden, müssen Sie die Tastatur simulieren.  Aber zuerst müssen Sie alle Elemente auf der Seite abrufen, die fokussiert werden können. <br>  Mit dem folgenden Selektor können Sie alle diese Elemente abrufen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> focusableElements = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll( <span class="hljs-string"><span class="hljs-string">'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'</span></span> );</code> </pre> <br><h3 id="dvigaem-fokus-programmno">  Fokus programmatisch verschieben </h3><br><p>  Um sich auf das Element zu konzentrieren, durchlaufen wir die <code>NodeList</code> und konzentrieren uns mit der Methode <code>element.focus()</code> auf das aktuelle Element. </p><br><p>  Dieses Beispiel zeigt, wie Sie den Fokus von Element zu Element springen können: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> current; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateLoop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gamepad = navigator.getGamepads()[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gamepadBumperL = gamepad.buttons[<span class="hljs-number"><span class="hljs-number">4</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gamepadBumperR = gamepad.buttons[<span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gamepadBumperL.pressed) { prevItem(current) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gamepadBumperR.pressed) { nextItem(current) } setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> rAF(updateLoop), <span class="hljs-number"><span class="hljs-number">100</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prevItem</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">index</span></span></span><span class="hljs-function">) </span></span>{ current = (index - <span class="hljs-number"><span class="hljs-number">1</span></span>) % focusableElements.length focusableElements[current].focus() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextItem</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">index</span></span></span><span class="hljs-function">) </span></span>{ current = (index + <span class="hljs-number"><span class="hljs-number">1</span></span>) % focusableElements.length focusableElements[current].focus() }</code> </pre> <br><p>  <code>setTimeout</code> auf die Verwendung der Funktion <code>setTimeout</code> .  Es wird verwendet, um <code>requestAnimationFrame</code> auf 100 Millisekunden zu beschränken.  Ohne dies kann ein einziger Klick auf eine Taste mehrere Gamepad-Ereignisse erzeugen, da es kein uns bekanntes onClick gibt und es physisch unmöglich ist, eine Taste in einer Millisekunde zu drücken und loszulassen. </p><br><h3 id="klikaem-po-elementam">  Klicken Sie auf die Elemente </h3><br><p>  Sie können mit der <code>click()</code> -Methode auf Elemente <code>click()</code> : </p><br><pre> <code class="javascript hljs">clickItem(index) { focusableElements[index].click(); }</code> </pre> <br><h3 id="dobavlyaem-fidbek-ispolzuya-vibraciyu">  Fügen Sie Feedback mithilfe von Vibration hinzu </h3><br><p>  Moderne Gamepads können vibrieren.  Diese Vibrationen werden für die Rückmeldung an den Benutzer verwendet, normalerweise in Spielen.  Sie können aber auch versuchen, Feedback von Webelementen auf der Seite zu geben. </p><br><p>  Gamepads sind häufig mit zwei starken und schwachen Elektromotoren ausgestattet: </p><br><p><img src="https://habrastorage.org/webt/iv/pz/el/ivpzel0b1cyoxyujsfqgofbqeve.png"></p><br><p>  Wir können diese Motoren über einen Browser mit <code>vibrationActuator</code> steuern. <br>  Um eine Vibration zu erzeugen, können wir die Methode <code>playEffect()</code> verwenden: </p><br><pre> <code class="javascript hljs">gamepad.vibrationActuator.playEffect(<span class="hljs-string"><span class="hljs-string">'dual-rumble'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">startDelay</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-comment"><span class="hljs-comment">// Add a delay in milliseconds duration: 1000, // Total duration in milliseconds weakMagnitude: 0.5, // intensity (0-1) of the small ERM strongMagnitude: 1 // intesity (0-1) of the bigger ERM });</span></span></code> </pre> <br><p>  Wenn Sie Motoren für Vibrationen verwenden, beachten Sie, dass ein großer Motor mehr Zeit zum Beschleunigen benötigt.  Daher ist es für kurzfristige Reaktionen besser, einen kleinen Motor zu verwenden. </p><br><p><img src="https://habrastorage.org/webt/td/hq/5n/tdhq5nmlxnfoqkeemtj4cf3yrkc.png"></p><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>  In diesem Beispiel haben wir die Grundfunktionen der Gamepad-API und deren Verwendung zur Navigation im Internet untersucht. </p><br><p>  <a href="https://github.com/voorhoede/demo-navigate-with-gamepad" rel="nofollow">GitHub-</a> Code und Demo finden Sie <a href="https://demo-navigate-with-gamepad.netlify.com/" rel="nofollow">hier</a> . </p><br><h3 id="poleznye-ssylki">  Nützliche Links </h3><br><p>  <a href="https://html5gamepad.com/" rel="nofollow">html5gamepad.com</a> - Gamepad-Checker-Tool <br>  <a href="https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API" rel="nofollow">Gamepad API auf MDN</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de485562/">https://habr.com/ru/post/de485562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de485550/index.html">Gibt es ein Leben jenseits der Moskauer Ringstraße? Wie wir Entwickler suchen und vorbereiten</a></li>
<li><a href="../de485552/index.html">Eine andere Möglichkeit, die Zeit und die Build-Nummer für Java zu verfolgen</a></li>
<li><a href="../de485554/index.html">Ziele und Hauptergebnisse (OKR) - Unsere Erfahrung mit der schrittweisen Implementierung</a></li>
<li><a href="../de485556/index.html">Es dauerte 12 Jahre, um einen Abschnitt der Drosophila-Hirnkarte zu erstellen, die Bemühungen von 250 Menschen und 40 Millionen US-Dollar</a></li>
<li><a href="../de485558/index.html">Keine Mücken! Übersicht der Mücke "Phyto-Munition"</a></li>
<li><a href="../de485564/index.html">Reverse Engineering des Ngrok v2-Protokolls</a></li>
<li><a href="../de485570/index.html">Zusammenstellung von Routen für ILV-Listen und Bedrohung seriöser Dienste</a></li>
<li><a href="../de485576/index.html">Funktionen zum Herstellen einer Verbindung zwischen Teilnehmern in einem Peer-to-Peer-Netzwerkspiel</a></li>
<li><a href="../de485578/index.html">Mahjong mit Kindern: für was, wann und wie</a></li>
<li><a href="../de485582/index.html">Paul Graham: „Ein Investor als Tierherde“ (2013)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>