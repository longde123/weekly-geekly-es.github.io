<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÇüèΩ üë®üèø‚Äçüéì üåñ Experiencia de desarrollo de SPA en VueJS + Nuxt üêù üíπ üë©üèª‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nuestra empresa se dedica principalmente al desarrollo de tiendas en l√≠nea y queremos compartir nuestra experiencia en el desarrollo de un proyecto en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Experiencia de desarrollo de SPA en VueJS + Nuxt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414137/">  Nuestra empresa se dedica principalmente al desarrollo de tiendas en l√≠nea y queremos compartir nuestra experiencia en el desarrollo de un proyecto en un grupo de VueJS + Nuxt + Laravel. <br><a name="habracut"></a><br>  El art√≠culo discutir√° c√≥mo decidimos implementar la tienda en l√≠nea como un SPA: c√≥mo llegamos a esto, dificultades, facilidad. <br><br>  El sitio que se discutir√° es una tienda en l√≠nea casi cl√°sica con un cat√°logo, filtros, b√∫squeda, cesta, cuenta personal, es decir  Casi todo lo que puede estar en la tienda.  El proyecto tiene una l√≥gica, precios y mapeo diferentes para personas jur√≠dicas y particulares. <br><br><h4>  Por qu√© SPA </h4><br>  Antes del proyecto actual, nuestra experiencia en el desarrollo de aplicaciones de una sola p√°gina consist√≠a en solo unos pocos proyectos internos.  Y en muchos sentidos, el SPA para nosotros fue, en cierto sentido, un caballo oscuro. <br><br>  No hubo una comprensi√≥n clara de los problemas asociados con el crecimiento del proyecto, su seo-promoci√≥n y estabilidad, cuando, como experiencia y procesos de larga duraci√≥n en la creaci√≥n de sitios ordinarios, no plantearon ninguna pregunta para resolver estos problemas. <br><br>  La elecci√≥n del enfoque provoc√≥ un debate bastante acalorado en nuestra empresa, se completaron tanto las escalas como los argumentos y la decisi√≥n fue muy dif√≠cil.  Nuestros desarrolladores decidieron recopilar un prototipo de varias p√°ginas del proyecto y ver qu√© dificultades surgir√≠an con cada enfoque.  Este enfoque nos ayud√≥ con la soluci√≥n final.  Los prototipos ayudaron a demostrar que administrar el estado del sitio (cat√°logo, canasta, pago, etc.) es mucho m√°s c√≥modo y causa menos problemas en la versi√≥n SPA.  La velocidad de desarrollo e interacci√≥n entre las m√°quinas de escribir y los programadores ha aumentado significativamente debido al hecho de que no es necesario transferir el dise√±o, solo agregue l√≥gica a los componentes listos para usar.  Los problemas que podemos encontrar tambi√©n se hicieron m√°s claros y esto provoc√≥ nuevas acciones.  Antes de nosotros estaba la elecci√≥n de la tecnolog√≠a. <br><br>  Fuera de la ventana es el verano de 2017. En Twitter y en medio, las disputas no disminuyen, lo cual es a√∫n mejor, ver o reaccionar.  Nuestra oficina no pas√≥ esta tendencia.  Los desarrolladores tambi√©n se dividieron en dos campos, cada uno con sus propios argumentos.  Antes de eso, cada uno de nosotros ya hab√≠a trabajado con ambas tecnolog√≠as. <br>  Alguien se ha acercado a jsx, alguien prefiere el html o pug m√°s familiar, alguien cree que la inmutabilidad ayuda a monitorear y controlar mejor el estado de la aplicaci√≥n, para alguien esto parece una complicaci√≥n excesiva.  Por otro lado, cada marco nos da la oportunidad de crear componentes de un solo archivo, y para ambos ya hay bibliotecas bastante estables con un conjunto de todas las funciones necesarias para nosotros (SSR, gesti√≥n de estado global, enrutamiento, gesti√≥n de metadatos).  Para reaccionar es nextjs, y para vue es nuxtjs.  Nuxt en el momento de la selecci√≥n todav√≠a estaba en beta, pero bastante estable.  Porque  El proceso de desarrollo se construy√≥ de tal manera que inicialmente tenemos un dise√±o, y luego construimos la parte del backend y transferimos el dise√±o de las p√°ginas a la interfaz, la elecci√≥n del marco fue bastante simple.  Elegimos vue y nuxtjs, porque  Se decidi√≥ crear el sitio y lanzar la API en paralelo.  Con este enfoque, es conveniente componer componentes de inmediato y agregarles l√≥gica.  Nuestros dise√±adores de dise√±o adoptaron un enfoque m√°s cercano para crear su html habitual. <br><br><h4>  Un poco sobre backend </h4><br>  En t√©rminos de soluciones de servidor y, en general, la elecci√≥n de tecnolog√≠as para construir el backend, tomamos el camino m√°s familiar.  El lenguaje fue elegido php, para lo cual utilizamos el marco laravel.  Todo gira en nginx.  Como soluci√≥n de base de datos tenemos mysql. <br><br><h4>  Inicio del desarrollo, paquetes usados ‚Äã‚Äãy problemas. </h4><br>  Nuxt proporciona paquetes completamente satisfactorios para que podamos administrar el estado de la aplicaci√≥n (vuex) y el enrutamiento (vue-router).  Por lo tanto, comenzar a ensamblar el proyecto y ajustar la l√≥gica a los componentes podr√≠a comenzar de inmediato y luego, seg√∫n sea necesario, buscar los paquetes que necesitamos.  En primer lugar, por supuesto, necesitaba una soluci√≥n para comunicarme con la parte del backend.  Para hacer esto, se eligi√≥ axios, el est√°ndar ya para todos, y el envoltorio nuxt-axios-module sobre √©l.  Tambi√©n ayudamos de inmediato al proyecto a que no se pierda en el entorno y se ejecute en cada entorno con la configuraci√≥n deseada: seleccione dotenv y el contenedor nuxt-dotenv-module.  Para comenzar el desarrollo, esto es suficiente y el proceso de dise√±o ha comenzado. <br><br>  La primera pausa ocurri√≥ cuando fue necesario agregar un control deslizante de imagen al dise√±o.  "¬øD√≥nde est√° mi slick-slider, quiero jquery" se escuch√≥ desde el lado del dise√±o de la habitaci√≥n.  Una revisi√≥n r√°pida de las soluciones preparadas revel√≥ varios controles deslizantes adecuados para nosotros.  Pero casi todos arrastraron una dependencia en forma de jquery, que no quer√≠a agregar al paquete terminado, aumentando as√≠ su tama√±o.  Algunos paquetes no admit√≠an la representaci√≥n del servidor, lo que tambi√©n era importante para nosotros.  Como resultado, la elecci√≥n recay√≥ en el impresionante swiper, que cumpli√≥ plenamente con nuestros requisitos e incluso un poco m√°s.  Despu√©s de que el control deslizante se atornillara, nuestros dise√±adores de dise√±o permanecieron perdidos durante mucho tiempo.  ‚ÄúEso es todo, ¬øtengo que hacer algo m√°s?  ¬øSolo especifique una lista de im√°genes y funciona? <br><br>  Luego vino la elecci√≥n del componente para seleccionar las fechas.  Hubo mas suerte  Se encontr√≥ r√°pidamente una envoltura para nuestro querido flatpickr.  Todo lo que quedaba era darle un poco de estilo. <br><br>  En varios lugares del sitio hay un mapa.  Pero porque  no necesit√°bamos detalles y elaboraci√≥n perfectos del mapa, no hab√≠a elecci√≥n entre los servicios.  Sin embargo, en el momento del desarrollo, e incluso ahora, no hay soluciones que cubran idealmente todas nuestras necesidades.  En base a todos los pros y los contras, se eligieron google maps y el contenedor vue2-google-maps.  El paquete es lo suficientemente grande y genera muchos innecesarios para nosotros, pero resuelve bien sus problemas. <br><br>  En algunas formas, tenemos campos para ingresar al tel√©fono.  El usuario debe ayudar a ingresar al tel√©fono, ya que hay demasiadas opciones para el formato, y luego trabajar en el futuro con los datos ingresados ‚Äã‚Äãen un solo formato es m√°s f√°cil.  Por lo tanto, necesitas una m√°scara.  Quer√≠a usar la ya conocida m√°scara de texto, y aqu√≠ tuvimos suerte, ya ten√≠an una soluci√≥n para vue: vue-text-mask. <br><br>  Estos paquetes cubrieron casi todos nuestros requisitos.  Todo lo que quedaba era rastrear los clics fuera del componente, lo que ayud√≥ a vue-click-outside.  Implementamos el desplazamiento r√°pido de la p√°gina usando vue-backtotop.  Para trabajar con fechas, usa momento. <br><br><h4>  El tama√±o final del paquete y de d√≥nde vino 1 megabyte </h4><br>  Debe tenerse en cuenta que un criterio importante al elegir los paquetes fue su peso. <br><br>  En el medio del proyecto, decidimos analizar el proyecto final y ver las dimensiones del ensamblaje.  Los resultados fueron, por decirlo suavemente, sorprendentes.  El tama√±o de la pandilla app.js era de poco m√°s de 950kb gzip.  El equipo de an√°lisis de npm run nos trajo una hermosa gr√°fica con el tama√±o de todos los m√≥dulos, de la cual nos dimos cuenta de que algunos m√≥dulos extraen dependencias innecesarias en forma de jquery, lodash, etc.  Tuvieron que rechazar estos paquetes y encontrar una alternativa a ellos.  Actualmente, el tama√±o del paquete completo es 480kb gzip. <br><br><img src="https://habrastorage.org/webt/d9/q5/wo/d9q5woogma0yygvlzimwhk8eu6w.png"><br><br>  Est√© atento a las dependencias y verifique peri√≥dicamente el tama√±o de su aplicaci√≥n. <br><br><h4>  P√°gina de carga inicial y datos obtenidos por api </h4><br>  Nuxt ofrece una oportunidad conveniente para llenar la tienda con datos en el lado del servidor antes de cargar el cliente.  Para esto, se utiliza la acci√≥n nuxtServerInit.  Se ve as√≠ para nosotros: <br><br><img src="https://habrastorage.org/webt/bs/1t/yc/bs1tycfomfmwwuq8mbegz8movug.png"><br><br>  Dado que utilizamos categor√≠as y algunas otras entidades en varios componentes a la vez, fue m√°s conveniente para nosotros obtenerlos de inmediato y ponerlos en la tienda. <br><br>  Pero aqu√≠ hay un problema con el tama√±o json que obtienes.  Como el servidor env√≠a todos los datos recibidos al cliente para la representaci√≥n inicial, el tama√±o html puede ser demasiado grande.  Nos encontramos con esto cuando en categor√≠as comenzamos a transferir im√°genes, descripciones y otros campos que no eran necesarios para nosotros en todas las p√°ginas que pertenecen a cada categor√≠a.  El tama√±o de json estaba por encima de 2mb.  Afortunadamente, esto se puede solucionar f√°cilmente eliminando campos innecesarios de los datos que proporciona el servidor. <br><br><h4>  Fugas de memoria </h4><br>  Despu√©s de un tiempo, la aplicaci√≥n en nuestro servidor de prueba, comenzamos a observar un aumento antinatural en el consumo de memoria.  pm2 ocup√≥ hasta el 90% de toda la memoria del servidor y la aplicaci√≥n se bloque√≥ peri√≥dicamente.  En la p√°gina de github, nuxt ya colg√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">algunos problemas</a> con el mismo problema. <br><br>  El problema surgi√≥ cuando realizamos varias solicitudes en el m√©todo asyncData de nuestras p√°ginas. <br><br><img src="https://habrastorage.org/webt/6c/1j/pr/6c1jprerb-bhjbaekqpft8xqmig.png"><br><br>  Afortunadamente, los desarrolladores de nuxt resolvieron r√°pidamente este problema, y ‚Äã‚Äãactualmente el proceso consume alrededor de 40 MB de memoria. <br><br><h4>  Problemas interesantes y sus soluciones. </h4><br>  <b>Art√≠culos componentes</b> <br>  En el panel de control del sitio, es posible agregar art√≠culos e insertar varios bloques en el contenido del art√≠culo, por ejemplo, un bloque con productos. <br><br><img src="https://habrastorage.org/webt/09/tj/vz/09tjvzsjrrxk5sux44dhsxrvxty.png"><br><br>  El HTML que proviene del servidor se parece a esto: <br><br><img src="https://habrastorage.org/webt/q_/-r/kx/q_-rkxht2vmhwby6ckddpwn3pqk.png"><br><br>  $ product-4 indica que el componente Product.vue con el identificador 4 debe estar en lugar de este puntero.Vue nos brinda amplias posibilidades para renderizar el componente utilizando el m√©todo de renderizado.  Primero, buscamos todas las referencias a punteros a componentes en el html que ha llegado y obtenemos por API los datos necesarios para mostrar este componente.  Luego, dividimos todo el html en un √°rbol.  La biblioteca del himalaya nos ayud√≥ con esto.  Y luego recopilamos html de nuevo reemplazando punteros con componentes listos para usar. <br><br>  ... Y no hab√≠a suficiente fuerza para escribir un art√≠culo) Comenzaron a escribir el art√≠culo en el verano de 2017 durante el desarrollo del proyecto, y ya es verano de 2018 en el patio, el proyecto se lanz√≥ y el art√≠culo no se ha publicado. <br>  Por lo tanto, publicamos lo que hemos reunido, pero todav√≠a tenemos muchos temas y observaciones interesantes. <br>  Si ser√° interesante, escribe, dale me gusta)) Bueno, ¬øqu√© m√°s ser√≠a interesante escuchar, que te perdiste? <br><br>  Quiero decir que el proyecto ha estado funcionando durante aproximadamente 4 meses.  No hubo problemas especiales con √©l, y la velocidad del sitio es impresionante y lo distingue de otras tiendas. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es414137/">https://habr.com/ru/post/es414137/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414127/index.html">Instale 3CX en un hosting por 2,99 euros / mes. en 10 minutos</a></li>
<li><a href="../es414129/index.html">M√°ster en Inform√°tica Te√≥rica en la Universidad Estatal de San Petersburgo</a></li>
<li><a href="../es414131/index.html">El efecto de la frecuencia de la se√±al en la energ√≠a de los enlaces de radio en el espacio libre</a></li>
<li><a href="../es414133/index.html">Dise√±o de juego de rompecabezas con el ejemplo de In The Shadows</a></li>
<li><a href="../es414135/index.html">C√≥mo portar un juego a PSVita mejor√≥ el rendimiento general</a></li>
<li><a href="../es414139/index.html">Lanzamiento del proxy MTProto no oficial en Python, caracter√≠sticas del protocolo</a></li>
<li><a href="../es414141/index.html">7 reglas para dise√±ar placas de circuito impreso</a></li>
<li><a href="../es414149/index.html">Las razones del mal sonido de la mayor√≠a de los tel√©fonos inteligentes Android</a></li>
<li><a href="../es414151/index.html">Fintech-digest: los bancos informar√°n da√±os por ataques de hackers, Western Union se niega a trabajar con criptomonedas</a></li>
<li><a href="../es414155/index.html">Sistemas de eventos en Unity3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>