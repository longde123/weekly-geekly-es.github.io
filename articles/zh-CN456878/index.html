<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙋 🧙🏻 🥢 我们自己做一个闪烁辐射计。 第1部分，硬件 ◾️ 👃🏻 🍖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在上一篇文章中，我在工作中展示了一些自制的闪烁辐射计。 该设备引起了公众的兴趣，与此相关的是本文从内部描述了辐射计。 


 这是什么，为什么 
 绝大多数袖珍型剂量计和辐射计都是基于盖革计数器的仪器。 这种类型的检测器具有其优点，其主要优点是简单和低成本，但也有许多缺点。 首先，这是伽马射线配准的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>我们自己做一个闪烁辐射计。 第1部分，硬件</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456878/"> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上一篇文章中，</a>我在工作中展示了一些自制的闪烁辐射计。 该设备引起了公众的兴趣，与此相关的是本文从内部描述了辐射计。 <br><br><div style="text-align:center;"><img width="50%" src="https://habrastorage.org/webt/qj/h9/-u/qjh9-uoln8w3rzdv26mm2jzrcqu.jpeg"></div><a name="habracut"></a><br><h4> 这是什么，为什么 </h4><br> 绝大多数袖珍型剂量计和辐射计都是基于盖革计数器的仪器。 这种类型的检测器具有其优点，其主要优点是简单和低成本，但也有许多缺点。 首先，这是伽马射线配准的效率非常低，并且完全缺乏有关其能量的信息。 盖革（Geiger）计数器只能捕获几百个伽马射线，而低能闪烁探测器的效率几乎为100％。 结果，在自然背景和探测器尺寸相同的情况下，当盖革计数器每分钟仅发出10-15个脉冲时，闪烁器会发出相同数量的脉冲，但<i>每秒</i> 。 因此，为了至少对剂量率有一些了解，我们必须使用盖革（Geiger）计数器在一组脉冲上花费至少一分钟，而使用闪烁器则可以每秒接收到有关辐射情况的信息。 因此，闪烁探测器首先为我们提供了对微弱放射源的反应速度。 <br><br> 另外，闪烁检测器具有比例特性。 粒子能量越高，检测器输出处的脉冲幅度越大。 这是为了什么 首先，这就是我们如何获得有关什么是辐射源的信息。 每个放射性同位素都有其自身的伽马辐射特征能量（或一组能量）。 伽马能谱法就是基于此的。 在此设备中，每个量子的平均吸收能量将显示在屏幕上（尚未完成）。 <br> 其次，如果我们仅计算冲量而没有考虑能量，那么我们会得到一个不愉快的东西，即“僵硬的举动”。 假设我们已经校准了铯137辐射计。 然后他们在一个被241241感染的地方。 铯137量子的能量为667 keV，美国为59 keV，即少了一个数量级。 因此，在检测器捕获的粒子数量相同的情况下（因此，从设备获得的读数相同），吸收的剂量会少一个数量级。 即，测量将是错误的。 为了使辐射计能够正确测量不同能量（即<i>剂量计</i> ）下的<i>剂量</i> ，必须考虑每个配准量子的能量。 <br><br><div style="text-align:center;"><img width="60%" src="https://habrastorage.org/webt/4z/xv/fh/4zxvfht8dlj0aaampaiqirumalo.jpeg"></div><br> 便携式闪烁辐射计-剂量计已经投放市场很长时间了。 但是在大多数情况下，这些是非常昂贵的专业设备。 我只知道一种面向家庭和业余使用的设备-这是KB Radar生产的Atom Fast。 其余的-Polimaster设备，一些外国公司-非常昂贵。 <br><br> 在此设备中，我希望获得以下信息： <br><br><ul><li> 无需参考具有自己显示屏的智能手机或其他设备的自主工作（与Atom Fast不同）； </li><li> 尝试进行功率补偿； </li><li> 从可参考制图的角度自动在可移动媒体上记录测量结果； </li><li> 文化外观，并不是特别赋予各种猎犬和看门人自制的血统。 </li></ul><br> 结果，获得了所描述的装置。 尚未完成，仍然有足够的工作，尤其是在软件方面。 <br><br><h4> 主要功能 </h4><br> 辐射计以两种模式之一运行：搜索和测量。 在搜索模式下，设备的读数每秒更新一次，而除了数字形式的读数外，还以图形显示。 在搜索模式下，不会注意错误；在此模式下，设备主要是指示器。 屏幕显示：当前剂量率，以每秒脉冲数（CPS）计的计数率，以及最后一分钟的平均剂量率以及在打开设备或复位后累积的积分剂量。 相反，在测量模式下，由操作员设置测量时间（通过按“ Enter”按钮开始然后结束测量），并且将计算出的误差与测量值一起显示在屏幕上，并在其“地下室”中显示最后几条的小日志。测量。 此外，在测量模式下，首次尝试考虑量子能量并补偿“刚度笔划”。 测量模式正在深入构建中，并且尚未使用给定的固件版本。 <br><br> 无论使用哪种模式，都将继续第二秒的测量周期，并将结果保存到RAM中。 尤其是由于这个原因，当切换到搜索模式时，该图将显示在设备处于测量模式时以及进入菜单等期间的读数。 无论使用哪种模式，超出阈值的警报都将起作用。 <br><br> 后者有三个阈值。 传统的第一和第二个-是根据操作员的要求通过菜单设置的，当它们被下一个第二计数周期的结果触发时，会发出声音信号。 除了它们，还有一个自适应阈值。 它会自动设置为每分钟的平均水平，从中设置为1、2或3 sigma（可以在设置中选择）。 如果在下一个周期中发生在此阈值上的操作，则将下一个周期的值取自上一个周期的值，以便在缓慢但稳定地增加辐射的情况下获得稳定的警报。 随后，将实施警报日志，但到目前为止还没有。 <br><br> 尚未实现将测量结果保存到microSD卡，其连接器安装在辐射计板上。 它还提供了GPS模块的连接，将来也要使用。 <br><br> 切换模式和某些设置的快速更改是通过“热键”完成的，其余操作-使用菜单。 如上所述，进入菜单不会停止测量过程。 <br><br><h4> 设备总体规划 </h4><br> 辐射计安装在尺寸为122x77x25 mm的标准“芯片和倾角”外壳Gainta G1389G中。 上部面板上有一个3.5英寸彩色LCD显示器，分辨率为480x320像素。NextionNX4832T035 HMI模块用作显示器，它与传统显示器的区别在于它自己的微控制器，该微控制器包含一个现成的用于显示界面元素的程序，但是我们只需要发送即可命令来显示，删除或更改它们-例如，更改一个或另一个数字，在图表上绘制另一个点或更改一个或另一个题词的颜色，显示屏下方是五个按钮的键盘。  GNSS接收器还有剩余空间，闪烁探测器位于上端。 <br><br><div style="text-align:center;"><img width="80%" src="https://habrastorage.org/webt/qp/9d/wo/qp9dwouqqw837oxu8itor67-2iu.jpeg"></div><br>  <i>红色数字表示：1-显示模块，2-键盘，3-检测器，4-模拟板，6-系统板。</i> <i><br></i> <br> 设备的电子电路（不包括显示器和导航接收器以及键盘在内）组装在两个印刷电路板上。 首先，组装设备的模拟部分，再进行其他组装：带捆扎的微​​控制器，电源电路及其开关，电池充电和检测器的高压源。 <br><br><h4> 检测器 </h4><br>  activated活化的碘化铯闪烁晶体用作辐射计中的检测器。 这种晶体具有放射致发光的特性-带电粒子和高能光子（X射线和伽马射线范围）激发其中的辉光，并以短约微秒的闪光形式发出光-闪烁。 该闪光太弱，以至于肉眼看不见或无法以通常的方式检测到。 光电管，光电二极管和光敏电阻对此不敏感。 为了评估灾难的规模，我将引用以下数据。 <br><br> 完全吸收在CsI（Tl）晶体中的能量为1 MeV的伽马射线产生大约40,000光子绿光。 让我们尝试用光电二极管捕获这种光。 假设它们都装在一个光电二极管上（实际上，如果只有一半装在它上面，这是不现实的，而且很好）。 假设我们有一个理想的光电二极管，其量子输出为100％。 这意味着每个光子将在光电二极管的结构中创建一个电子空穴对。 对于动量，我们得到40,000个光电子。 众所周知，该脉冲持续1μs。 因此，在一秒钟内，我们将有4∙10 <sup>10个</sup>光电子。 电子电荷为1.6∙10 <sup>-19</sup> C，电荷4∙10 <sup>10的</sup>光电子为6.4∙10 <sup>-9</sup> C，也就是说，闪烁闪光将在我们的光电二极管中引起的电流强度仅为几纳安！ 而且，如果您还记得并非所有的光子也都到达光电二极管，并且其量子产率也不是100％……此外，兆电子伏特是相当坚硬的伽马辐射的能量，很高兴看到更低的能量。 通常，光电二极管在这里实际上不适合我们。 相反，它们是合适的-但难度很大。 <br><br> 通常使用光电倍增器（现在使用）来捕获这种微弱的光脉冲。 在它们中，从光电阴极上敲除的每个光电子在倍增极系统上倍增，获得数百万倍的增益，其阳极的电流脉冲不再是纳米的，而是毫安的，并且记录这样的脉冲不再困难。 但是PMT是坚固的易碎玻璃圆柱体，功率为千伏，此外还要求高稳定性。 通常，它在袖珍设备中的表现不佳。 <br><br> 幸运的是，现在有可以与PMT竞争的半导体光电探测器。 谁说雪崩光电二极管？ 是的，几乎是他们。 尽管雪崩二极管由于载流子的雪崩倍增而具有光电流的内部放大，但是只有雪崩二极管具有许多技术问题，这些技术问题不允许制造直径至少为几毫米的敏感区域。 此外，经典雪崩二极管的雪崩放大系数仅为10-200，没有复杂的花样，与PMT的百万倍放大特性相比，它是微不足道的。 最近在市场上出现的Si-PMT或SiPM中消除了雪崩光电二极管的所有这些缺点。 它们本质上是在预击穿模式下工作的许多雪崩光电二极管的矩阵，其中单个光子能够引发雪崩击穿的发展。 此模式类似于盖革计数器的操作。 每个单元都有其自己的消隐方案，由于该方案，雪崩击穿立即停止，并且该单元再次准备注册新的光子。 所有单元（具有其淬灭方案）在Si-PMT晶体上并联连接，并且将流经它们的电流脉冲相加，以使平均电流与晶体的照度成比例。 而且，使用这种硅PMT非常简单-只需向其施加反向偏置即可-通过几千欧姆的电阻向其施加约28-29 V的电压，并从中获取信号。 不再需要-既不需要千伏电源，也不需要倍增电极的分压器。  Si-PMT本身是一个尺寸为3x3或6x6 mm的小硅方格。 顺便说一句，如果您从它消除反向偏置或将其降低到几伏，它的工作原理就像普通的光电二极管。 <br><br><div style="text-align:center;"><img width="40%" src="https://habrastorage.org/webt/z6/wb/nu/z6wbnuaixbonzr-lunbvzc7avmg.png"></div><br> 因此，我们的检测器使用Si-PMT和CsI（Tl）晶体，在它们之间应用了一层光学润滑剂以消除晶体和光电检测器窗口之间的气隙。 并且在晶体和Si-PMT的顶部覆盖着一层薄薄的氟塑料薄膜，称为FUM胶带。 该涂层具有很高的漫反射率。 检测器顶部覆盖有铝带，可防止外界光线和密封-碘化铯晶体极易溶于水，进入检测器的水分极少，会破坏它。 幸运的是，与它的“相对”碘化钠不同，CsI实际上不具有吸湿性，也就是说，它不会从空气中吸收水分。 碘化钠晶体只能在绝对干燥的惰性气体环境中进行处理，并放置在高密封的容器中，就好像有必要在其中形成超高真空一样，而在普通空气中，它们只会在我们眼前模糊。 反之亦然，单晶形式的碘化铯可以很容易地在空气中处理（例如，用普通的钢锯锯成金属，再用皮肤打磨），仅避免了痕量的液态水，并记住该晶体含有剧毒的al。 但是，由于毒性很小，急性（而非慢性！）的毒性将由碘而不是th来决定。 <br><br> 我不会就检测器的自我制造提出建议，因为我没有处理它（完成的检测器是由开发人员和制造商<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">KBRadar</a>提供给我的，以换取一些对电子工程师有价值的工件），我只会给出其参数。 它们是：晶体尺寸为8x8x50 mm，爱尔兰公司SensL（现在是On Semi部门）的Si-PMT MicroFC 30035作为光电探测器。 可以在网上找到各种制造技巧。 随着尺寸的稍微增加，您可以在小尺寸（10x40、18x30 mm等）的“本机”包装中使用标准CsI（Tl）或NaI（Tl）晶体。 但是，输出窗口的尺寸越大，尺寸为3x3 mm的光电检测器的工作性能越差，因此我强烈建议您使用较大（且价格更高）的MicroFC 60035，并且输出窗口的直径较大。建议使用。 除了外壳（WLCSP-16），这对于家庭焊接来说是完全不可消化的，它们的噪音也几乎更高。 <br><blockquote>  CsI（Tl）晶体的加工如下。 在所有样品中，侧面均无光泽。 末端的研磨首先在薄砂纸上进行，然后在丝绸上进行。 为了更好地研磨，使用在乙醇中稀释的氧化铈。 当研磨玻璃时，获得了透明性。 如果有必要将晶体减薄为大厚度，则只需用浸入水中的细线将其锯开即可。 然后以相同的顺序进行处理。 <br><br>  （Gorbunov V.I.，Kuleshov V.K.关于为产品的缺陷检查选择闪烁体的最佳尺寸的问题，// Izv。Tomsk Polytechnic Institute。1965. V.138。S.42-48。） <br></blockquote><br><h4> 模拟部分 </h4><br><img src="https://habrastorage.org/webt/uj/s5/e2/ujs5e2ncmks99c7i1uoxktifnps.png"><br><br> 其方案如上图所示。 它由以下主要节点组成： <br><br><ul><li> 输入电路； </li><li> 比较器 </li><li> 峰值检测器。 </li></ul><br> 检测器连接到XP1输入连接器。  Si-PMT的阴极-引脚3（HV），阳极-引脚1（DET）和引脚2（GND）分别连接有检测器的金属屏蔽层-其包装材料由铝胶带制成。 <br><br> 输入电路由检波器R2的负载电阻和限流电阻R1组成，如果检波器本身未正确连接，则会在意外提供反向偏置电压过高或错误地提供反极性电压等故障时试图保护检波器。 它们与硅PMT的电容（约900 pF）一起形成电压脉冲，其上升时间约为1μs，下降时间约为15μs。 在施加到比较器的输入之前，信号先经过470 pF电容器，该电容器通过直流电流使电路去耦，并与分压器R3R5R6的输入电阻一起将脉冲缩短至2-3μs。 <br><br>  LMV7239微电路用作比较器，在低差分输入电压下将低功耗与相当高的速度（&lt;100 ns）结合在一起。 分压器R3R5R6与积分电路R4C3一起形成“浮动”阈值电压，使比较器对检测器的暗电流有些不敏感，并且输入电流随温度变化。 比较器的灵敏度通过在数十欧姆范围内选择电阻R5来控制。 在比较器的输出端形成一个负极性的矩形脉冲。 由于检测器的噪声，该脉冲的后沿可能会轻微地发出嘎嘎声，但是尝试通过引入迟滞来消除这种反弹现象导致灵敏度降低，并且通常会导致更差的结果。 该脉冲为峰值检测器提供门控，并被馈送到数字部分，在数字部分产生微控制器的中断。 <br><br>  DA2集成计时器（实际上是LMC555CM，仅是CMOS版本的555计时器）上的单触发在比较器输出的脉冲输出边沿产生10μs持续时间的脉冲（正极性）（由R7C6时序链设置）。 使用DD1（SOT23-5封装中的单个TinyLogic反相器）对该脉冲进行反相，并施加到DD2键，在没有输入脉冲的情况下，它会使峰值检测器电容器C12短路。 在脉冲到达的瞬间，短路会以指示的10 µs消除。 <br><br> 峰值检测器是根据经典的同相电路构造的。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该方案的缺点是众所周知的，但是在该实施例中，出现了一件有趣的事情。事实是，在预料到脉冲的情况下，DA2.1的反馈环路会断开，并且输入脉冲到达时的运放应处于过载状态，其输出会花费大量时间，并且脉冲之前的放大器状态根本无法确定（从中得出所有结论）这种峰值检测器的缺点）。另一方面，前一时刻同相输入端的电压接近于零，电容器短路，因此反相输入端的电压也为零。在脉冲到达的时刻，运放的输出此时处于短路模式，并且来自运放的保护电路通过内部反馈电路覆盖运放，从而限制了输出电流！因此，放大器输出级不再处于限制模式，但事实证明，它被迫进入线性模式，从该模式可以轻松快速地退出。结果，这种峰值检测器的工作速度比通过短路电容器C12在脉冲结束时将其重置的速度快得多。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该电路正常工作的条件是检测器信号中没有恒定的分量，这立即使运算放大器处于过载模式，并且大量电流将流过二极管和短路的电容器（但是，受上述内置反馈电路的限制，因此不会烧毁）。因此，输入端是隔离电容器C9。如果电容器R8突然充电，电阻R8便对该电容器放电（否则，电容器无处放电-DA2的输入阻抗接近千兆）。在他不在的情况下，当电路正常工作一会儿后会观察到有趣的窍门，然后突然停止，并在一段时间后恢复工作。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">峰值检测器电容器的参数通常直接取决于其工作的性能。通常，他们需要使用非极性薄膜，通常是氟塑料，因为需要低吸收和低泄漏。在这里，由于它在没有脉冲的情况下不断短路（这抑制了吸收效应）以及电荷存储时间仅为10μs的事实而减轻了对它的要求，因此，尺寸为1206的高质量陶瓷电容器（必定具有NP0类型的电介质）在这里是相当适用的。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在DA2微电路的第二个运算放大器上组装了一个具有高输入电阻的缓冲器，该缓冲器允许从峰值检测器的电容器中去除电压而无需对其放电，该放大由电阻R9和R10给出。</font></font><br><br><div style="text-align:center;"><img width="60%" src="https://habrastorage.org/webt/y7/j_/dl/y7j_dlhv35lhusnptfshpgfeyfg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当从输入端的检测器接收到脉冲时，该电路会在TRIG输出处产生一个持续时间为2-4μs的零电平脉冲，并在持续时间为10μs的接近矩形脉冲处产生一个电平，该电平与从输出SP处的检测器接收到的脉冲幅度成比例。对于这10μs的大部分时间，电压电平保持恒定，这使得可以使用微控制器的内置ADC对其进行多次测量，并且TRIG信号必须首先“唤醒” MC并启动中断处理程序，在该中断处理程序中进行此测量（以及脉冲计数）已实施。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了操作，电路需要两个电源电压：3.3-5 V用于电路操作，以及28-29 V的“高”电压，用于偏置检测器。电流消耗约为2.5 mA。根据“高压”电路，电流消耗取决于检测器负载，在背景辐射水平下为几微安。使用表面安装将其组装在尺寸为64x22 mm的印刷电路板上。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组装后，一切都应该立即工作，但是在检查时，您需要记住，TRIG输出是非常高速的比较器输出，能够产生强大的干扰。</font><font style="vertical-align: inherit;">由于它们的原因，当用长的非屏蔽导体连接（例如，连接到示波器）时，所有东西都会被激发。</font><font style="vertical-align: inherit;">出于同样的原因，在我开发的开发板上，该信号以高频“振铃”的形式从信号拾取到TRIG信号。</font><font style="vertical-align: inherit;">组装完成的设备时，必须以最小长度的线束将电路板连接至系统板，在其中应将TRIG和SP线分别屏蔽，例如，使用接地的镍镍布接地。</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 主机板 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 以下主要节点位于其上： </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 电源及其开关电路，包括电池充电电路； </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 微控制器及其工作所需的一切； </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 键盘，显示器，SD卡等的辅助电路 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 下图显示了电源方案（我很抱歉没有将其他方案带到标准中，而直接取自Eagle）。 </font></font><br><br><img src="https://habrastorage.org/webt/gi/dx/rg/gidxrgbeospmec3wrlqzq58mfsq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该设备由连接到连接器X1的单节锂离子电池供电。我使用了2.3 Ah *的锂聚合物电池“ Robiton”，原则上，任何来自智能手机等的电池都可以。达到类似的能力。在DA1上，内置了一个充电器，可通过USB端口工作。在这里，没有任何功能，所有内容都在LTC4054-4.2的数据表上。通过使用MK端口将电阻器R4的输出电路吸引到公共线，可以将充电电流从350 mA增加到700 mA。这样就必须这样做，以免超出USB端口允许的500 mA，同时如果设备连接到网络适配器，则可以使电池更快地充电。 MK使用DA2得知电池已耗尽，并关闭了设备，R5R6C3分压器使您可以测量其上的电压（在MK的模拟输入之一上缠绕）。来自DA1的CHRG线允许MK根据棘手的算法控制充电器的状态：当不充电时，其为零，在充电过程中出现一个单位，很容易被吸引到零，而在充满电时，即使在几公斤的负载下，它也不再被吸引并保持为一。除了昂贵的原始LTC4054-4.2，还可以使用DA代替DA1，也可以使用其来自ST-STC4054的克隆。我告诫不要将中国的LTC4054与Aliexpress一起使用：它们要么根本不工作，要么就不能正常工作，这会杀死电池并造成爆炸危险。正是由于这个原因，我拒绝使用“流行的” TP4056：原件很长时间没有生产，无法获得，但是克隆要么没有预充电，然后电压差为4.2 V-几乎是一个伏特，然后将热保护器连根拔起……一般，我拥有的该微电路的唯一正常工作的副本是放在一条小围巾上，该围巾为我曾经购买的锂充电。但这很可惜：她对这些模式进行了更简单的说明，并且最大充电电流更大，并且通过SO-8腹部散热要比通过SOT-23-5端子散热更好。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VT1VD1R7电路断开负载与电池的连接，并在其上出现电压时将其切换为USB端口供电，以免干扰DA1以正确维持充电模式并检测其耗尽。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接下来是转换器，以获取正确的电源电压。 DA3微电路将电池电压提高到5 V，显示器由它们供电，这增加了转换器的电压，从而为检测器提供了28 V的电压，并通过线性稳压器-一个模拟板。 MK可以通过在POWER_ON线上设置零来偿还所有这些消耗者。 DA6开关分别使显示空白。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了获得高电压，在DA5上组装了一个升压转换器。已选择LM2731 DC-DC转换器的最高电压版本。最初，应该使用中国MT3608，该电路在该电路中更加经济，但在输出电压为28-29 V时显示出非常低的可靠性（实际上，根据数据表，其最大允许输出电压为28 V，因此不足为奇）。设置电路的此部分时，应牢记，当分压器（R12R13）的下臂断开时，输出电压跳升至50-60 V，将电容器C20击倒，这有造成眼睛伤害的危险（它们会爆炸！）！而且，如果R11意外短路，FB输入（DA5的引脚3）将烧毁，效果相同（此外，您还必须更换芯片）。在这方面，应密切注意调谐电阻的质量和正确的安装。需要一个输出滤波器来抑制此转换输出的纹波。转换器由锡丝网封闭，锡丝网的边缘焊接到板上的土填埋场。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如实践所示，可以代替DA3来安装类似于DA6的开关，并对其板进行校正（因此，您不需要扼流圈和二极管，也不需要两个电阻R9和R10）。</font><font style="vertical-align: inherit;">这将使该设备更加经济。</font><font style="vertical-align: inherit;">然后，DA4稳定器无需安装在3.3 V电压下，而应安装在3.0 V电压下，以便在整个电池放电范围内使模拟电源稳定。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DA7转换器始终处于工作状态，包括在关闭设备时一直提供3.3 V MK的功率。在空闲状态下，它仅消耗几十微安的电流，因此，关闭的设备几乎不会为2.3 Ah的电池放电。</font><font style="vertical-align: inherit;">不幸的是，STM32L151没有用于为RTC供电的单独输入，这就是为什么我必须做出这样的决定（否则我会使开关复杂化）的原因。</font></font><br><br><img src="https://habrastorage.org/webt/dn/co/ot/dncootnvdgigasbfknafqpetn58.png"><br><div style="text-align:center;"><img width="60%" src="https://habrastorage.org/webt/lk/59/vz/lk59vz_km8wsoj5l0aaj7odcfri.png"></div><br> 这是系统板电路的其余部分。 <br><br> 该系统的核心是MK STM32L151CBT6A（与不带索引A的模拟产品不同，它的RAM是32kB的两倍）。 他的几乎所有48个发现都涉及到。  PA9和PA10除外，它们也是第一个USART的RxD和TxD，以防万一我为它们制造了接触垫，这些垫将来很容易焊接。 其中的功能是一个稍微棘手的系统，用于确定CHRG DA1输出的状态，其中包括来自PB14的上拉，当您需要确定电池是在充电还是已经在充电，并且高音扬声器通过DD2逆变器同相连接时。 我的错误如图所示：当MK切换到STANDBY模式时，此逆变器的输入悬空，这会导致大量的额外消耗，甚至产生电能。 在这里，您需要通过一个100公斤电阻将该输入拉至地。 您应该注意石英谐振器的质量，尤其是ZQ1。 使用标准的12 pF时钟石英，控制器的时钟将无法正常工作，您将不得不寻找负载能力为7 pF的稀缺石英。 对于ZQ2 MK来说，它更忠诚，但是随着第一个出现的中国石英的出现，您可能会发现开始不足或工作频率错误。 不幸的是，STM32Lxx系列（是她）对石英的质量要求很高。 <br><br> 键盘以相当标准的方式连接-端口线由外部电阻R17-R21拉至电源，并通过按钮压至地面。 为了抑制颤动，在键盘板上，RC链与按钮平行焊接。 当您使用DD3逆变器按“打开”按钮时，会产生一个高电平信号，该信号将馈送到WKUP输入，并在处于STANDBY状态时唤醒MK。 为防止意外开机干扰，已安装R22C23链。 键盘线连接到连续的端口线，这使您可以在单个端口读取命令中读取它。 <br> 由于此MK中没有SDIO控制器，因此将microSD卡以SPI模式连接。  USB端口通过DP和DM线中的两个电阻以最简单的方式连接。  STM32 MK本身在静电方面非常“橡木”，并且辐射计不会有其他外部通讯（SWD固件除外），因此您不能针对过电压进行认真的端口保护。 <br><br>  MK的电源电路摘自数据表，没有任何功能。 调整为L6电感器时，我依次添加了一个100 ohm电阻器，这大大减小了VDDA上的电压波动。 通过将C30的电容并联焊接（在同一位置）另一个电容器0.01 C，可以将C30的电容增加到1F。 <br><br> 接通电源后，3.3 V电源立即开始工作，为MK供电。 其他电源已关闭。 启动MC并初始化外围设备后，它将升高POWER_ON线路（端口PA15），启动5 V电源，并为模拟部分和高压电源供电。 要打开显示器的电源，您需要升高DISP_ON线（PA8），以类似方式打开卫星导航模块，然后升高GPS_EN线（PA1），但是与显示器不同的是，它没有特殊的电源开关，因此使用了接收机本身的电源控制输入（应该是）。 仅在断开设备电源后，显示屏才会关闭。 <br><br> 来自模拟模块的计数脉冲（TRIG）发送到PB0线，导致下降沿中断。 携带有关粒子能量（SP）信息的脉冲被馈送到ADC的第21个通道。 该脉冲的“搁置”持续时间（电平保持不变）几乎为10μs，这使您可以在MC“唤醒”并进入中断后进行几次ADC转换。 电阻器R34消除“振铃”。 <br><br> 主板尺寸为64x80 mm，旨在安装大多数大小为0603的电阻器和电容器。除了MK的电源电路中的三个电容器和构成电池分压器以进行测量的两个电阻器之外，大多数元件都安装在一侧。 <br><br><h4> 组装和调试技巧 </h4><br> 如果组装正确，模拟板将立即开始工作。 在原始版本中，板上没有R8和C9元件，没有它们，电路可以在发生器中正常工作，但是SP输出的脉冲幅度是随机的，并且与输入的脉冲幅度无关。 这些元素的引入纠正了这种情况。 <br><br> 如果设备的模拟部分被激励，则只有一个难题-屏蔽TRIG线并最小化连接电缆的长度。 与检测器的连接也应最短且屏蔽。 <br><br>  R5必须通过在最大工作温度下对Si-PMT的暗噪声没有比较器反应的情况下，由检测器与a 241可靠地传递脉冲来选择。 <br><br> 模拟板必须彻底彻底冲洗干净，以免流过微量的助焊剂，尤其是在峰值检测器区域，并且必须充分干燥然后在150°C的温度下加热。 即使是千兆字节的绝缘电阻，也会大大恶化其工作并使它变得不稳定。 <br><br> 从电源开始构建系统板。 首先，收集一个3.3 V电源并确保其正常工作。 然后-一个5 V电源（不要忘了暂时将POWER_ON与+ 3.3 V总线连接），然后是一个高压电源。 首次接通电源之前，请将R13设置在图中的上方位置，并且在设置电压之前不要焊接C20。 将高压电源上的电压设置为28 V，并在充电过程中监控电池电压，以确保充电器能够正常工作。 在检查了所有电源母线上的性能和正确的电压之后，您可以焊接MK及其相关的所有细节。 要检查MK，建议在其中写入并闪烁一些Blink。 不要忘记闪烁和显示。 <br><br> 校准过程将在下一期中介绍。 <br><br><h4>  * * * </h4><br> 这只是本文的第一部分。 第二部分将描述软件部分和校准过程。 同时，对于那些无法等待<i>讲义的人</i> 。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可以从此链接的Google云端硬盘下载</a>带有电路图和PCB布局的Eagle文件以及MK固件和显示的当前稳定版本<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> 在此固件中，仅搜索模式有效，并且当前型号代替菜单。 我尚未准备好发布功能更强大的固件。 <br><br> 请注意：本文图中的模拟板电路与Eagle项目中的位置标记不一致，而且我没有在手术板上用解剖刀安装R8和C9元件（根据本文的示意图）。 <br><br> 电路板的布线专为工厂制造，LUT等而设计。 它必须被回收（这会伤害很多通孔）。 是的，我有一些现成的板。 如果有人需要，请写下个人协议。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN456878/">https://habr.com/ru/post/zh-CN456878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN456866/index.html">他们何时从Internet进行“ cheburnet”制作：项目概述</a></li>
<li><a href="../zh-CN456868/index.html">V16 Update 2 Beta中的新3CX SBC远程连接管理器</a></li>
<li><a href="../zh-CN456870/index.html">如何在没有投机的情况下赚钱：5家高分红公司</a></li>
<li><a href="../zh-CN456872/index.html">在边境检查电子设备-是否需要或侵犯人权？</a></li>
<li><a href="../zh-CN456876/index.html">ISTQB认证：优点和功能</a></li>
<li><a href="../zh-CN456880/index.html">为什么Math.Round从Try .NET中的浏览器打开打印窗口</a></li>
<li><a href="../zh-CN456886/index.html">ASO清单：如何一无所获</a></li>
<li><a href="../zh-CN456888/index.html">卫星如何在地球大气层中融化</a></li>
<li><a href="../zh-CN456890/index.html">STM32上的红外遥控器</a></li>
<li><a href="../zh-CN456892/index.html">如何查找Web应用程序漏洞：比较八种流行的扫描仪</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>