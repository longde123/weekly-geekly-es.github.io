<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤜🏼 ✌🏿 👕 Tugas nomor 2. Penentuan struktur populasi 😺 🎩 👢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami melanjutkan siklus tugas, di mana kami berbicara tentang cara bekerja dengan data genetik. Tugas pertama "Cari tahu jenis kelamin dan tingkat hub...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tugas nomor 2. Penentuan struktur populasi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/atlasbiomed/blog/481334/">  Kami melanjutkan siklus tugas, di mana kami berbicara tentang cara bekerja dengan data genetik.  <a href="https://habr.com/ru/company/atlasbiomed/blog/480954/">Tugas</a> pertama "Cari tahu jenis kelamin dan tingkat hubungan" sudah bisa diselesaikan dan kirimkan jawaban kepada kami.  Hari ini kami menerbitkan yang kedua. <br><br>  Hadiah utama adalah <a href="http://atlas.ru/wgs">Genom Lengkap</a> . <br><br><img src="https://habrastorage.org/webt/uf/xm/xq/ufxmxqeydxoc64hwkqueabage44.png"><br><a name="habracut"></a><br>  Kami sebelumnya telah membagikan informasi dan tautan bermanfaat yang mungkin berguna untuk bekerja dengan data bioinformatika.  Kami menyarankan Anda membaca artikel sebelumnya terlebih dahulu jika Anda melewatkannya: <br>  <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">Apa genom lengkap dan mengapa itu diperlukan</a> <br>  <a href="https://habr.com/ru/company/atlasbiomed/blog/480954/">Tugas nomor 1.</a>  <a href="https://habr.com/ru/company/atlasbiomed/blog/480954/">Cari tahu jenis kelamin dan tingkat hubungan.</a> <br><br><h4>  Penafian </h4><br>  Bekerja dengan data genetik dilakukan pada sistem Unix (Linux, macOS), karena beberapa perintah dan perangkat lunak tidak tersedia di Windows.  Oleh karena itu, untuk pengguna Windows, salah satu solusi paling sederhana adalah menyewa mesin virtual Linux. <br><br>  Semua operasi yang dijelaskan di bawah ini dilakukan pada baris perintah - terminal.  Sebelum Anda mulai, pelajari cara bekerja di terminal yang menjalankan OS Anda dan gunakan perintah, karena beberapa di antaranya berpotensi membahayakan OS dan data Anda. <br><br><h2>  Perangkat Lunak yang Diperlukan </h2><br>  Kami telah mengumpulkan <a href="https://cloud.yandex.ru/marketplace/products/f2e5v4acgtukhi31n6o4">gambar mesin virtual</a> (VM) dengan semua perangkat lunak yang diperlukan di Yandex.Cloud.  Petunjuk untuk mengatur VM dan menginstal perangkat lunak dapat ditemukan di <a href="https://habr.com/ru/company/atlasbiomed/blog/480954/">artikel</a> sebelumnya dengan Tugas No. 1. <br><br>  Kali ini, Anda perlu membangun plot sebar dua dimensi menggunakan data yang diperoleh dengan metode analisis komponen utama.  Kami sarankan Anda untuk membuat diagram ini menggunakan perangkat lunak apa pun yang sesuai untuk Anda: Excel, Google Sheets, Python, R, dan lainnya. <br><br>  Untuk menyelesaikan tugas, Anda memerlukan paket perangkat lunak Plink 1.9.  Jika Anda belum menginstalnya (dan belum menyelesaikan Tugas No. 1), baca artikel sebelumnya.  Berisi instruksi instalasi.  Untuk berpartisipasi dalam kompetisi Tahun Baru 2019, semua tugas harus diselesaikan! <br><br><h2>  Perhatikan </h2><br>  Principal component analysis (PCA) adalah salah satu algoritma pembelajaran mesin tanpa guru ketika mesin secara mandiri mencari pola dalam data.  Dalam genetika, PCA memungkinkan pengelompokan sampel sesuai dengan data genotyping dalam ruang dimensi N (biasanya dua dimensi), di mana komponen utama yang diperoleh paling akurat menjelaskan variabilitas data genetik dari sampel ke sampel. <br><br>  Ketika melakukan analisis seperti itu, sampel dari satu populasi biasanya membentuk sebuah cluster, ukuran dan kehalusan batas yang bergantung pada kesamaan sampel dalam populasi tertentu.  Algoritma ini kemungkinan untuk mengidentifikasi sampel dari populasi yang berbeda dalam kelompok yang berbeda.  Dan sampel dari populasi dekat yang termasuk dalam superpopulasi yang sama, misalnya, EAS - Asia Timur, seperti pada Gambar 1, akan diidentifikasi secara dekat satu sama lain atau bahkan dalam cluster yang berpotongan. <br><br><img src="https://habrastorage.org/webt/yr/rt/bg/yrrtbgj6tct9huih0rg5gww63xc.png"><br>  <b>Gambar 1</b>  Silsilah sampel yang digunakan dalam VCF (kuadrat sesuai dengan jenis kelamin laki-laki, lingkaran ke perempuan).  Garis putus-putus sesuai dengan hubungan urutan kedua yang tidak ditentukan. <br><br>  Analisis serupa digunakan untuk menentukan populasi dengan genotipe.  Untuk ini, diperlukan dataset referensi, yang terdiri dari sampel dengan asal yang sudah diketahui.  Kesimpulan tentang populasi dapat dibuat oleh kelompok sampel mana yang diketahui paling dekat dengan data yang diteliti. <br><br>  Untuk menyederhanakan, esensi dari analisis PCA adalah bahwa jarak berpasangan antara titik-titik dalam ruang multidimensi diketahui, dan titik-titik ini harus ditempatkan dalam ruang dimensi yang lebih kecil sehingga jarak berpasangan yang baru minimal berbeda dari yang asli.  Reduksi dimensi menyederhanakan analisis data, tetapi semakin kita menguranginya, semakin kuat jarak baru antara titik-titik berbeda dari aslinya.  Oleh karena itu, tugas analisis PCA juga melibatkan menemukan kompromi antara akurasi dan kemudahan analisis.  Semuanya seperti dalam hidup. <br><blockquote>  Perwujudan paling sederhana dari implementasi PCA pada data genetik didasarkan pada identitas beberapa alel, yang dapat dibagi menjadi dua subtipe: IBS (identitas berdasarkan negara) dan IBD (identitas berdasarkan keturunan).  IBS berarti identitas alel tertentu dalam dua orang, tetapi tidak selalu menyiratkan fakta adanya hubungan di antara mereka.  IBD, sebaliknya, berbicara tentang identitas alel karena keberadaan leluhur yang sama dan, karenanya, kekerabatan. <br></blockquote>  Alel IBD adalah alel IBS yang jelas, sedangkan yang sebaliknya tidak benar.  Namun, harus diingat bahwa pada suatu saat kita berasal dari nenek moyang yang sama, sehingga beberapa alel mungkin IBD.  Dalam analisis PCA di bawah ini, hanya konsep IBS yang digunakan, meskipun dalam analisis yang lebih kompleks itu memperhitungkan tes signifikansi statistik, batasan fenotipik, ukuran cluster, usia dan jenis kelamin orang tersebut, serta informasi tambahan tentang struktur populasi. <br><br>  Semakin besar jumlah alel yang berbeda dalam dua sampel, semakin sedikit mereka mirip dan semakin jauh mereka dari satu sama lain.  Nilai IBS untuk sampel tersebut akan rendah.  Tetapi untuk orang tua dan anak-anak mereka, IBS akan sangat tinggi. <br><br>  Mengetahui nilai-nilai IBS untuk setiap pasangan gambar dalam dataset, Anda dapat melakukan analisis PCA untuk melihat bagaimana mereka berkerumun. <br><blockquote>  Tes genetik Atlas menggunakan algoritma yang jauh lebih canggih untuk menentukan perwakilan populasi dalam data genotipe. </blockquote><br><h2>  Data yang digunakan </h2><br>  Kami mengingatkan Anda bahwa manual ini menggunakan data terbuka yang dipilih secara khusus dari proyek <a href="https://www.internationalgenome.org/">1000 Genome</a> .  Untuk analisis, dipilih 10 sampel dengan informasi genotipe ~ 85 juta variasi, yang diperoleh dengan menganalisis data NGS yang selaras dengan versi genom GRCh37.  Hubungan keluarga dan populasi sampel ini ditunjukkan pada Gambar 1. <br><br><h2>  Membangun kelompok populasi </h2><br>  Gunakan tiga file dalam format Plink yang diperoleh sebelumnya di Tugas No. 1: <br><br><pre><code class="bash hljs">CEI.1kg.2019.demo.subset.bed CEI.1kg.2019.demo.subset.bim CEI.1kg.2019.demo.subset.fam</code> </pre> <br>  Tentukan jarak berpasangan antara semua 10 sampel dalam dataset pelatihan dan gambar PCA berdasarkan IBS (identitas berdasarkan negara).  Ini dapat dilakukan sebagai berikut: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     plink --bfile CEI.1kg.2019.demo.subset --genome --out CEI.1kg.2019.demo.subset.similarities plink --bfile CEI.1kg.2019.demo.subset --read-genome CEI.1kg.2019.demo.subset.similarities.genome --cluster --mds-plot 10 --out CEI.1kg.2019.demo.subset.clustering</span></span></code> </pre><br>  Parameter <code>—genome</code> hanya bertanggung jawab untuk perhitungan berpasangan IBS / IBD antara semua sampel dalam dataset.  Parameter " <code>—read-genome</code> " adalah matriks jarak berpasangan yang diperoleh sebelumnya, dan parameter " <code>—cluster —mds-plot</code> 10 bertanggung jawab untuk analisis PCA dan output dari hasilnya ke tabel 10 komponen utama pertama.  Bahkan, ini adalah koordinat masing-masing sampel dalam ruang 10-dimensi. <br><br>  Perintah terakhir akan membuat 4 file di folder: <br><br><pre> <code class="bash hljs">CEI.1kg.2019.demo.subset.clustering.cluster1 CEI.1kg.2019.demo.subset.clustering.cluster2 CEI.1kg.2019.demo.subset.clustering.cluster3 CEI.1kg.2019.demo.subset.clustering.mds</code> </pre> <br>  Kami akan membutuhkan dua file terakhir dari daftar. <br><br>  Gambar 2 menunjukkan bagaimana file yang diterima pada dataset pelatihan MDS terlihat.  Bidang FID (Family ID) dan IID (Individual ID) sesuai dengan keluarga dan pengidentifikasi sampel individu.  Fields C1 - C10 berisi nilai masing-masing dari sepuluh komponen utama untuk setiap sampel, di mana komponen C1 secara maksimal menjelaskan variabilitas data genetik sampel yang dianalisis, dan C10 minimal. <br><br><img src="https://habrastorage.org/webt/s5/sh/zc/s5shzc0vpldskqc_moq-d7tb8gq.png"><br>  <b>Gambar 2</b>  File MDS dengan nilai 10 komponen utama untuk setiap sampel. <br><br>  Ketika membangun diagram sebar menggunakan dua komponen (dalam ruang dua dimensi), seseorang dapat mendeteksi cluster yang sesuai dengan populasi sampel.  Gambar 3 menunjukkan plot pencar untuk pasangan komponen utama C1xC2, C2xC3 dan C1xC3.  Ketika membandingkan cluster yang diperoleh dengan afiliasi populasi referensi (Gambar 1), pasangan dari dua komponen pertama C1 - C2 menunjukkan akurasi tertinggi (100%), dengan benar memisahkan semua sampel sesuai dengan afiliasi populasi mereka yang dinyatakan dalam proyek 1000 Genom.  Namun, selalu masuk akal untuk membandingkan hasil yang diperoleh untuk beberapa pasang komponen karena kemungkinan tumpang tindih atau pemisahan cluster nyata. <br><br><img src="https://habrastorage.org/webt/v8/yc/el/v8ycelaiugjchmto4lfw7i6cxom.png"><br>  <b>Gambar 3</b>  Plot pencar lokasi sampel untuk pasangan komponen utama;  lokasi marker sedikit diubah untuk mencegah mereka tumpang tindih. <br><br>  Membangun diagram 3D menggunakan tiga komponen utama pertama juga dapat membantu menentukan pengelompokan, tetapi tidak selalu.  Sebagai contoh, membangun diagram seperti itu untuk data pada Gambar 3 memungkinkan kita untuk mengidentifikasi 4 cluster di mana sampel dari populasi PUR dan KHV dikelompokkan menurut populasi, dan sampel dari populasi CDX dibagi menjadi dua kelompok (Gambar 4).  Ini juga terlihat pada Gambar 3 dalam koordinat C2xC3 dan C1xC3. <br><br><img src="https://habrastorage.org/webt/a2/xd/fp/a2xdfp3goe8xy1mw6csz8lx0-wo.png"><br>  <b>Gambar 4</b>  Plot pencar untuk tiga komponen utama. <br><br>  Hasil analisis yang saling bertentangan tersebut dapat dijelaskan oleh sejumlah kecil sampel, karena nilai-nilai komponen utama dari masing-masing sampel berbeda untuk ukuran dan komposisi data yang berbeda, dan ketika sampel tambahan dari populasi yang berbeda dimasukkan, hasil pengelompokan dapat berubah.  Kesalahan juga berpotensi terjadi saat membuat dataset dan memberikan data referensi tentang populasi sampel, namun, dalam proyek 1000 Genom, kemungkinan situasi seperti itu cukup rendah. <br><br>  File MDS tidak menggunakan tab atau koma sebagai pembatas, jadi sesuaikan formatnya untuk kenyamanan.  Gunakan <code>tab</code> atau <code>csv</code> sebagai argumen kedua: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     convert_plink_delimiter.sh CEI.1kg.2019.demo.subset.clustering.mds tab</span></span></code> </pre> <br>  Tim akan membuat file <code>CEI.1kg.2019.demo.subset.clustering.mds.tab</code> , yang dapat Anda unduh dan buat bagan <code>CEI.1kg.2019.demo.subset.clustering.mds.tab</code> yang mirip dengan yang ditunjukkan pada Gambar 3. Bandingkan hasilnya, mereka harus identik dengan yang ditunjukkan di atas. <br><br><h2>  Membangun pohon pengelompokan </h2><br>  Anda juga dapat mengevaluasi pengelompokan sampel menggunakan pohon biner, yang mewakili informasi pengelompokan tentang sampel dalam bentuk diskrit.  Informasi tentang pohon ini terkandung dalam file <code>CEI.1kg.2019.demo.subset.clustering.cluster3</code> (Gambar 5). <br><br><img src="https://habrastorage.org/webt/el/fx/2k/elfx2k3mv8ytgihjuukqvkvn5iy.png"><br>  <b>Gambar 5</b>  Perkiraan konten file <code>.cluster3</code> yang menjelaskan proses pengelompokan sampel bertahap dari 1 kluster ke N, di mana N adalah jumlah sampel. <br><br>  Dua kolom pertama dari file ini berisi FID dan IID.  Afiliasi cluster dijelaskan oleh semua orang.  File ini harus dibaca dari kanan ke kiri dalam kolom dengan penambahan satu kolom: pada awalnya, semua sampel milik satu kluster “0” - kolom paling kanan.  Ketika dibagi menjadi dua kluster (pada langkah kedua, pada kolom kedua), dua kluster muncul: “0” dan “1”, di mana kluster “0” berisi sampel HG00731, HG00732 dan HG00733, dan kluster “1” berisi sisanya.  Ilustrasi partisi seperti itu ditunjukkan pada Gambar 6. <br><br>  Dari pohon, dapat disimpulkan bahwa sampel milik populasi (Gambar 1).  Selain itu, konstruksi pohon ini memungkinkan kita untuk menentukan kedekatan populasi individu, yaitu, terjadinya populasi CDX dan KHV dalam satu superpopulasi EAS (sudah pada langkah pertama pemisahan superpopulasi EAS dan AMR dipisahkan dalam dua cabang yang ada).  Juga, konstruksi pohon pengelompokan dapat membantu untuk memperbaiki hasil ambigu dari visualisasi sampel pada komponen utama. <br><br><img src="https://habrastorage.org/webt/fx/5c/iz/fx5cizxhgspb1vshakxyfyi2or4.png"><br>  <b>Gambar 6</b>  Binary clustering tree untuk dataset pelatihan 10 sampel: di sebelah kanan adalah isi dari file <code>CEI.1kg.2019.demo.subset.clustering.cluster3</code> (dari kanan ke kiri dalam file, identik dari atas ke bawah pada gambar). <br><br><h2>  Tugas kedua dari kompetisi </h2><br>  Gunakan dataset uji dari 12 sampel <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> dan contoh di atas (Gambar 5) untuk membangun pohon pengelompokan biner dari file <code>.cluster3</code> Anda <code>.cluster3</code> dan lampirkan pada solusi.  Menganalisis pohon yang dihasilkan dan menarik kesimpulan tentang jumlah populasi super yang disajikan dalam dataset uji. <br><br>  Tentukan pengelompokan populasi dari 12 sampel dari dataset uji dengan menganalisis komponen utama C1, C2 dan C3 dengan mempertimbangkan pohon yang dibangun dan mengindikasikan ini pada silsilah yang dibangun pada Masalah No. 1, membatasi blok populasi individu (mirip dengan Gambar 1).  Sampel yang tidak menunjukkan adanya kekerabatan dalam Soal No. 1 harus ditempatkan dengan cara yang sama di dalam blok yang diperoleh dalam diagram tanpa menghubungkannya dengan garis dengan sampel lain.  Jangan lupa lampirkan plot pencar yang Anda buat. <br><br>  Respons <a href="">harus dikirim</a> ke email <a href="">wgs@atlas.ru</a> hingga 26 Desember hingga 23:59.  Tugas lain akan segera diterbitkan, dan hasil akhir untuk tugas akan muncul pada 28 Desember.  Pemenang akan menerima tes Genom Lengkap, dan tempat kedua dan ketiga akan menerima tes genetik Atlas.  Akan ada hadiah khusus dari <a href="https://cloud.yandex.ru/">Yandex.Cloud</a> .  Karyawan Atlas lama dan saat ini tidak berpartisipasi dalam kompetisi;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481334/">https://habr.com/ru/post/id481334/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481324/index.html">Tren desain logo pada tahun 2020</a></li>
<li><a href="../id481326/index.html">Apa itu Flutter dan mengapa Anda harus mempelajarinya pada tahun 2020</a></li>
<li><a href="../id481328/index.html">BlitzTeam tentang klaim pribadi dari kelompok Siprus Wargaming seharga $ 1.690.000</a></li>
<li><a href="../id481330/index.html">Yang ketiga tidak berlebihan: bagaimana kami mengurangi rantai daftar produk dengan menambahkan tautan lain ke dalamnya</a></li>
<li><a href="../id481332/index.html">Pengumuman buku "Pembelajaran Mesin Tanpa Kata-Kata Tambahan"</a></li>
<li><a href="../id481336/index.html">Bagaimana orang dilacak oleh kumpulan data "anonim"</a></li>
<li><a href="../id481338/index.html">Memanfaatkan kerentanan xss</a></li>
<li><a href="../id481340/index.html">7 hari, 15 insinyur dan 600 server: Yandex.Money pindah ke pusat data baru</a></li>
<li><a href="../id481342/index.html">Polling Jumat: Berbicara Tentang Bahasa</a></li>
<li><a href="../id481344/index.html">Rencana Tim Platform IntelliJ untuk 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>