<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐹 💗 🤓 Tip & Trik Forensik Digital: Cara Menemukan Koneksi VPN Aktif di Memory Dump 👃🏻 🎄 📚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kadang-kadang Anda dapat menemukan kasus ketika penyerang cyber menggunakan VPN untuk membuat saluran yang andal antara server C2 dan infrastruktur TI...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tip & Trik Forensik Digital: Cara Menemukan Koneksi VPN Aktif di Memory Dump</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442590/"> Kadang-kadang Anda dapat menemukan kasus ketika penyerang cyber menggunakan VPN untuk membuat saluran yang andal antara server C2 dan infrastruktur TI yang terinfeksi.  Dan, seperti yang dikatakan para pakar Ancaman Intelijen, penyerang sering menggunakan alat koneksi Windows VPN asli dan file <b>.pbk</b> (buku telepon) Windows.  Mari kita cari tahu bagaimana kita bisa mendeteksinya menggunakan dump memori. <br><br>  Apa itu file <b>.pbk</b> dan bagaimana tampilannya?  Ini hanya file teks dengan banyak parameter berbeda yang digunakan ketika koneksi VPN sedang dibangun. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e9/373/ccc/7e9373ccc8baca179bdc4970ecedac9a.jpg" alt="gambar"><br><br><a name="habracut"></a><br>  File buku telepon dapat dieksekusi dengan klik dua kali atau melalui skrip cmd / bat (atau tentu saja dari konsol perintah).  Tetapi ada dua alat yang berbeda yang digunakan untuk cara pertama dan kedua: <b>rasdial</b> dan <b>rasphone</b> .  Oleh karena itu kita dapat menggunakan dua cara berbeda dalam proses forensik digital.  Di awal dari kedua cara tersebut, kita harus menggunakan alat volatilitas untuk mendapatkan dan memeriksa daftar proses: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b11/89d/9bb/b1189d9bb7443e3891484afde7935325.jpg" alt="gambar"><br><br>  Jika proses <b>rasphone</b> terdeteksi, ada kemungkinan menggunakan buku telepon dengan klik dua kali dari sesi RDP misalnya.  Informasi bermanfaat apa yang dapat kami temukan di sini?  Mari buka file dump ini di FTK Imager dan coba cari parameter .pbk.  Saya menggunakan <b>"PhoneNumber ="</b> untuk kasus ini. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfe/0c9/ecb/dfe0c9ecb547ad2048110a0c7ecd7458.jpg" alt="gambar"><br><br>  Di sini Anda melihat alamat jarak jauh untuk koneksi VPN ini dan nomor port.  <b>vpn566928222.opengw.net:995</b> Dari titik ini kita dapat mendeteksi nama layanan koneksi saat ini dalam RAM, menggunakan nomor port dan perintah volatilitas netscan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a19/a6c/8a4/a19a6c8a4195441e4a408f07d0653f4c.jpg" alt="gambar"><br><br>  Jika sistem yang dibuang masih hidup, Anda dapat mematikan proses ini atau melanjutkan penelitian.  Tentu saja Anda harus tahu lebih banyak tentang alamat IP jarak jauh: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c1/a4e/9ff/1c1a4e9ff89f7942e05170162784b120.jpg" alt="gambar"><br><br>  Sepertinya server VPN anonim gratis dan ada banyak dari mereka di Internet.  Dan ini pertanyaan - aplikasi apa yang menggunakan koneksi VPN ini di stasiun yang terinfeksi? <br><br>  Saya tahu bahwa VPN adalah koneksi ke jaringan pribadi lain dan workstation saya sudah mendapat alamat IP lain dalam subnet asing.  Subnet lokal saya adalah <b>192.168.145.0/24</b> tetapi ada beberapa layanan dengan alamat IP lokal yang berbeda (10.211.1.0/24) dalam hasil netscan volatilitas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bee/1ed/e1c/bee1ede1cee3458d97dcf96bbab6380c.jpg" alt="gambar"><br><br>  Beberapa IP tujuan adalah untuk layanan Microsoft dan satu layanan mencurigakan yang terhubung dengan Sberbank_Antifraud ke 149.154.167.220 - ini adalah IP kumpulan Telegram Messenger. Jadi, sekarang Anda dapat mulai menyelidiki bagaimana proses ini muncul pada mesin ini. <br><br>  Oke, cara lain adalah tentang koneksi VPN berbasis cmd / bat dengan file .pbk. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb4/001/1df/fb40011dfef0a03c3d860467b4ee9244.jpg" alt="gambar"><br><br>  Tidak seperti rasphone, proses <b>rasdial</b> adalah penanda untuk koneksi VPN berbasis baris perintah atau skrip.  Mari kita periksa sintaks rasd di sini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ss64.com/nt/rasdial.html</a> dan coba cari <b>/ PHONEBOOK:</b> parameter dalam dump memori menggunakan FTK Imager: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fab/a81/488/faba81488b3e6a954471389aa7efc4d9.jpg" alt="gambar"><br><br>  Voila!  Kami telah menemukan path lengkap ke file buku telepon (jadi, jika dihapus, Anda dapat mencoba mengukirnya), nama skrip .cmd dan <b>login / kata sandi</b> ("vpn", "vpn") untuk koneksi "extVPN" ! <br><br>  Langkah selanjutnya sama dengan cara rasphone: mencari parameter "PhoneNumber =", menemukan sesi VPN dan layanan yang mencurigakan dengan meninggalkan alamat IP lokal. <br><br>  Sekali lagi terima kasih atas perhatiannya!  Saya akan segera kembali dengan barang bagus baru! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442590/">https://habr.com/ru/post/id442590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442580/index.html">Binary format reverse engineering menggunakan Korg .SNG file sebagai contoh</a></li>
<li><a href="../id442582/index.html">Bagaimana kami mencoba mobbing</a></li>
<li><a href="../id442584/index.html">Dokumen di gedung: sedikit kegembiraan otomatisasi pada contoh Menara Kegelapan</a></li>
<li><a href="../id442586/index.html">Kerentanan dalam Telegram memungkinkan untuk mem-bypass kata sandi kode lokal dengan panjang berapa pun</a></li>
<li><a href="../id442588/index.html">Ajukan pertanyaan kepada penulis Lua</a></li>
<li><a href="../id442592/index.html">Menggunakan Akun Joomla dalam Proyek Django</a></li>
<li><a href="../id442594/index.html">Apakah Anda akan memantau segalanya untuk saya? Ya</a></li>
<li><a href="../id442596/index.html">Soundtrack untuk game: humaniora juga menangis</a></li>
<li><a href="../id442598/index.html">Apakah Headhunter dibutuhkan?</a></li>
<li><a href="../id442600/index.html">Sistem otomasi rumah saya</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>