<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš¹ âœ‚ï¸ ğŸ‘©ğŸ¼â€ğŸ« Bagaimana mengintegrasikan ReactJS ke dalam 1C-Bitrix dengan pembuatan templat secara otomatis di back-end menggunakan contoh jaringan Globus ğŸ¸ ğŸ ğŸ‰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tahun ini, ReactJS pertama kali diluncurkan untuk toko online rantai hypermarket Globus. Proyek ini menarik karena memperluas kemampuan platform Bitri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana mengintegrasikan ReactJS ke dalam 1C-Bitrix dengan pembuatan templat secara otomatis di back-end menggunakan contoh jaringan Globus</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421531/"> Tahun ini, ReactJS pertama kali diluncurkan untuk toko online rantai hypermarket Globus.  Proyek ini menarik karena memperluas kemampuan platform Bitrix dan pada saat yang sama mempertahankan kemampuan untuk menghasilkan halaman untuk mesin pencari dan tidak berantakan dengan duplikasi kode dan tata letak.  Pada artikel ini, kita berbicara tentang bagaimana menghubungkan komponen Bitrix dengan komponen ReactJS menggunakan modul v8js untuk php dan menyimpan bagian depan utama situs. <br><a name="habracut"></a><br><h3>  Mengapa ini dibutuhkan? </h3><br>  Awalnya, logika situs web toko online dibangun di perpustakaan Marionette.js.  Beberapa tahun yang lalu, logika ini terbayar, tetapi seiring berjalannya waktu, persyaratan bisnis untuk fungsionalitas ujung-depan tumbuh sedemikian rupa sehingga setiap penyempurnaan disertai dengan kesulitan serius.  Karena beban tinggi, kecepatan bagian depan menurun dan meninggalkan banyak yang diinginkan.  Untuk mengatasi masalah ini, kami memilih ReactJS, tetapi ada masalah dengan rendering halaman ke back-end dan kemudian menghubungkan bagian halaman untuk bereaksi komponen.  Pada saat yang sama, tujuan kami adalah transisi bertahap ke ReactJS, karena  perubahan dramatis dapat menyebabkan desain ulang lengkap depan. Akibatnya, pilihan jatuh pada komponen-komponen berikut: <br><br><ul><li>  Kartu Produk; </li><li>  Keranjang mini; </li><li>  Menu </li></ul><br>  Kesulitan utama dalam mentransfer keranjang mini dan kartu produk ke ReactJS adalah sinkronisasi instan dari jumlah barang di kedua komponen, yaitu  jika 3 kg wortel ada di keranjang, maka di blok untuk menambahkan barang ke keranjang (pemetik) 3 kg harus ditampilkan, dan ketika jumlah barang dalam keranjang mini berubah, perubahan harus terjadi di pemetik dan sebaliknya.  Juga, itu perlu untuk menyamakan lag permintaan back-end sehingga antarmuka bekerja secepat mungkin. <br><br><img src="https://habrastorage.org/webt/zs/0-/4t/zs0-4tm2cptsxb_ertod4wohimm.png">  " <br><br>  Kompleksitas tambahan adalah kekhususan toko (ritel makanan), di mana ada konsep barang tertimbang.  Ini adalah produk yang dianggap dalam kg, tetapi pengguna membelinya dalam potongan-potongan, misalnya semangka, yang tidak dapat dibeli sebagian oleh klien, hanya secara keseluruhan.  Produk seperti itu bagi pengguna harus ditampilkan dalam jumlah keping, tetapi pada Back-end dianggap dalam kilogram. <br><br><h3>  Bagaimana Anda memecahkan masalah? </h3><br>  Agar tidak menduplikasi tata letak komponen dalam template dari 1C-Bitrix dan sistem Bereaksi, diputuskan untuk menempatkannya pada komponen Bereaksi.  Nama komponen dalam Bereaksi harus bertepatan dengan templat komponen sistem 1C-Bitrix.  Untuk menerapkan gagasan tersebut, kami menggunakan: <br><br><ul><li>  Modul V8js untuk php; </li><li>  reactjs / react-php-v8js; </li><li>  paket web. </li></ul><br>  Item pertama adalah modul v8js, yang seharusnya mengubah komponen reaksi kita menjadi tata letak statis di lingkungan php. <br><br>  Berikut ini adalah perpustakaan kecil dari React Community, yang merupakan pembungkus untuk inisialisasi React yang lebih mudah di lingkungan js dari modul v8js. <br><br>  Dan tentu saja webpack, di mana tanpanya.  Sehubungan dengan babel, ini memungkinkan Anda untuk menggunakan templat jsx dan standar es6 untuk menulis kode.  Semua contoh akan disajikan dalam sintaksis ES6.  Ini cukup sederhana, tetapi jika tidak segera dipahami, maka Anda harus menyegarkan ingatan Anda untuk itu. <br><br>  <i>Modul V8js untuk php.</i> <br><br>  Modul ini adalah ekstensi untuk php, yang memungkinkan Anda untuk menggunakan Javascript Engine V8 untuk mengeksekusi kode js di php.  Pemasangannya cukup sederhana, seperti ekstensi PECL biasa.  Yang utama adalah yang Anda miliki di perpustakaan sistem Anda dan file header V8. <br><br>  <i>Paket web</i> <br><br>  Untuk membangun pustaka komponen reaksi dan reaksi, kami menggunakan webpack.  File rakitan untuk bagian depan dan belakang sedikit berbeda.  Kita akan ke 3 file: <br><br><ul><li>  initialize.js -&gt; app.js - aplikasi untuk bagian depan; </li><li>  reactServer.js -&gt; reactBuild.js - bereaksi pustaka untuk sisi server; </li><li>  components.js -&gt; reactComponents.js - kumpulan komponen reaksi. </li></ul><br>  Perbedaan utama antara perakitan untuk rendering server adalah bahwa semua pustaka dan komponen harus dimasukkan ke objek global dan pustaka terhubung melalui fungsi yang diperlukan.  Arahan impor karena alasan tertentu tidak berfungsi. <br><br>  Semua file sumber ada di direktori local / templates / &lt;template name&gt; / src / <br><br><img src="https://habrastorage.org/webt/gg/vz/ck/ggvzckbgtq4g4jl9ftrgkr5ipnu.png"><br><br>  Akar dari proyek ini adalah webpack.config.js - pengaturan. <br><br><img src="https://habrastorage.org/webt/fd/2j/yk/fd2jykgbdtcbpwfjn11goi5s8xq.png"><br><br>  Isi file rakitan dapat ditemukan di akhir artikel. <br><br>  Npm dan paket-paket berikut harus diinstal: <br><br><ul><li>  Babel; </li><li>  babel-cli; </li><li>  paket web </li><li>  bereaksi </li><li>  reaksi-dom; </li><li>  garis bawah // opsional. </li></ul><br>  Perakitan dilakukan dengan menjalankan perintah: <br>  $ webpack <br><br>  <i>Kustomisasi mesin template bitrix</i> <br><br>  Untuk mendaftarkan mesin khusus dalam sistem 1C-Bitrix, Anda perlu menambahkan pengaturannya ke variabel global $ arCustomTemplateEngines.  Pada kunci Anda perlu menentukan kode mesin Anda.  Kami menggunakan "JSX".  Dalam nilai yang Anda butuhkan untuk menentukan ekstensi file templat, fungsi rendering templat.  Dianjurkan untuk menentukan jenis di bawah nilai 100, sehingga prioritas mesin kami di atas standar. <br><br>  Buat kelas JSXEngine dengan metode berikut: <br><br><ul><li>  setEngine - mendaftarkan templat; </li><li>  init - inisialisasi v8js melalui bungkus perpustakaan reactjs / react-php-v8js; </li><li>  mengeksekusi - fungsi rendering template </li></ul><br>  dan fungsi wrapper untuk merender template _JSXEngineExecute, karena  Sistem 1C-Bitrix memerlukan pendaftaran fungsi tertentu. <br><br>  Agar tidak menginisialisasi setiap kali instance Bereaksi, letakkan di variabel statis dan tambahkan metode inisialisasi. <br><br>  Antarmuka khusus diimplementasikan di kelas ReactJS dari pustaka reactjs / react-php-v8js untuk membuat komponen reaksi.  Konstruktor kelas mengambil dua parameter sebagai input, yang harus berisi kode js dari modul reaksi dan semua komponen reaksi yang digunakan dalam proyek yang dikumpulkan melalui webpack.  Setelah inisialisasi, kita dapat membuatnya.  Untuk melakukan ini, panggil metode setComponent menginstal komponen dengan parameter nama komponen dan array alat peraga.  Setelah itu, metode getMarkup akan menampilkan konten komponen, dan getJS akan menampilkan kode js untuk mengikat komponen di depan.  Metode getJS membutuhkan pengidentifikasi blok html di mana komponen terletak di parameter.  Untuk melakukan ini, kami menerapkan template sederhana untuk membungkus komponen yang diberikan dalam blok html.  Pengaturan blok itu sendiri ditransfer ke file json, yang ditempatkan di templat komponen sistem 1C-Bitrix.  Pengaturan disimpan dalam format json. <br><br><img src="https://habrastorage.org/webt/t7/fd/r3/t7fdr30zlxslwvouggmryh6bvgu.png"><br><br><img src="https://habrastorage.org/webt/6g/ng/op/6gngopga5l-r10z4zfqzkjjgmbw.jpeg"><br><br>  <i>Transfer komponen ke templat baru</i> <br><br>  Kami akan menunjukkan terjemahan komponen ke Bereaksi menggunakan contoh komponen menu standar.  Tata letak komponen telah diintegrasikan ke dalam mesin templat standar.  Bereaksi merekomendasikan kebijakan untuk memecah fungsionalitas menjadi komponen.  Apalagi komponennya bisa sangat kecil.  Hingga tag hyperlink.  Kami tidak akan memecah menu kami ke hal-hal sepele seperti itu, tetapi kami akan membuat dekomposisi kecil. <br><br>  Menu kami menggunakan bersarang hingga 3 tingkat.  Oleh karena itu, logis untuk memecah fungsionalitas menu menjadi 3 komponen reaksi, masing-masing per level.  Jika Anda perhatikan dengan teliti, Anda akan melihat bahwa item menu dari tingkat kedua diatur dalam dua kolom.  Fungsi ini harus ditempatkan di komponen tambahan. <br><br><img src="https://habrastorage.org/webt/y1/uy/fo/y1uyfohp9vilnly4xun9zkfe5pm.png"><br><br>  Jadi, kami memiliki 4 komponen.  Mari kita tempatkan mereka di file TopMenu.js, SubMenuLevel2.js, SubMenuLevel3.js, TwoColumnItem.js di direktori src / components (lihat kode untuk komponen lain di akhir): <br><br><img src="https://habrastorage.org/webt/nt/80/bj/nt80bjgwhznbqv9ckuiursphqyw.png"><br><br>  Agar templat kami berfungsi, Anda perlu membuat templat untuk komponen menu sistem 1C-Bitrix.  Nama templat harus sesuai dengan nama komponen reaksi.  Di dalam template Anda perlu menempatkan file dengan ekstensi yang sesuai dengan pengaturan mesin kami.  Di dalam file Anda perlu menentukan node html di mana komponen reaksi kami akan diberikan. <br><br><h3>  Hasil </h3><br>  Solusi ini memungkinkan Anda untuk menggunakan komponen reaksi di sisi back-end dan di sisi front-end.  Dengan demikian, logika menampilkan fungsi disimpan di satu tempat, yang sangat memudahkan dukungan proyek. <br><br>  Kecepatan rendering halaman awal meningkat hampir 1s.  Karena  Sekarang Anda tidak perlu menggambar ulang elemen rumah tempat komponen berada.  ReactJ mengambilnya dengan cepat.  Juga, kedipan elemen pada perangkat lemah menghilang. <br><br>  Di masa depan, rencana untuk beralih ke rendering komponen di sisi back-end melalui layanan berbasis node.js dan menerapkan aplikasi halaman tunggal sambil mempertahankan kemampuan untuk menghasilkan halaman untuk SEO. <br><br><h3>  Aplikasi </h3><br>  inisialisasi.js <br><br><img src="https://habrastorage.org/webt/s_/n2/mz/s_n2mz7lilpjjdadeg0ppctjlmk.png"><br><br>  components.js <br><br><img src="https://habrastorage.org/webt/gs/eo/m7/gseom7029c7ams6zdvaojkl894c.png"><br><br>  reactServer.js <br><br><img src="https://habrastorage.org/webt/bh/ne/ln/bhnelnigqxydigkiafpmoccwvwm.png"><br><br>  SubMenuLevel2.js <br><br><img src="https://habrastorage.org/webt/ep/7t/xa/ep7txacqkwh--ep9lealiucgves.png"><br><br>  SubMenuLevel3.js <br><br><img src="https://habrastorage.org/webt/8l/bo/oq/8lbooq9g6y2ivrt_sr7pti6eyzc.png"><br><br>  TwoColumnItems.js <br><br><img src="https://habrastorage.org/webt/lv/5s/bk/lv5sbkebar6j_yvdjwjv3s01nca.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id421531/">https://habr.com/ru/post/id421531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id421521/index.html">Monster setelah liburan: AMD Threadripper 2990WX 32-Core dan 2950X 16-Core (bagian 3 - tes)</a></li>
<li><a href="../id421523/index.html">Unity: mengenal Objek Skrip</a></li>
<li><a href="../id421525/index.html">Sedikit tentang perbedaan antara tuan rumah Rusia dan asing</a></li>
<li><a href="../id421527/index.html">Siaran peluncuran proyek "Server di awan"</a></li>
<li><a href="../id421529/index.html">Netflix, Uber, Google dan Anda di MBLT DEV 2018</a></li>
<li><a href="../id421533/index.html">Memilih bahasa pemrograman: 3 tips dari seorang programmer dari Apple</a></li>
<li><a href="../id421535/index.html">Petualangan - Elektronik. Di ayunan bersayap di dunia IT</a></li>
<li><a href="../id421537/index.html">Fungsi Tingkat Tinggi di JS: Kursus Petarung Muda</a></li>
<li><a href="../id421543/index.html">Kloning kartu tanpa kontak menggunakan aplikasi seluler</a></li>
<li><a href="../id421545/index.html">Ulasan PocketBook 616 - dompet 2018 paling hemat dengan fungsi backlight</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>