<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèΩ üöµ üí≤ Sberbank o all√≠ y de regreso üë≤üèª üëàüèæ üë©üèæ‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="CAP√çTULO 1. Invitados inesperados 
 Todo comenz√≥ esa desafortunada ma√±ana cuando Project Manager anunci√≥ que los plazos de implementaci√≥n del proyecto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sberbank o all√≠ y de regreso</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451188/"><img src="https://habrastorage.org/webt/si/bq/2u/sibq2unjy0i1yoy_7sa0qljphae.jpeg"><br><br><h2>  CAP√çTULO 1. Invitados inesperados </h2><br>  Todo comenz√≥ esa desafortunada ma√±ana cuando Project Manager anunci√≥ que los plazos de implementaci√≥n del proyecto deber√≠an reducirse r√°pida y decisivamente en un mes.  M√°s precisamente, el proyecto deber√≠a estar listo en 4 d√≠as.  No, nuestro PO no es una bestia, y no se parece en absoluto a un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">b√∫ho</a> (tal vez solo un poco como un cuervo), simplemente sucedi√≥.  Bueno, si es necesario, es necesario, especialmente porque al equipo (y yo soy el desarrollador l√≠der del equipo "C") se le prometi√≥ algo sabroso.  El reloj y el calendario eran jueves, 11:00, para el lunes, el proyecto deber√≠a estar listo. <br><br>  Para empezar, ¬øqu√© estamos haciendo?  Nos dedicamos a la automatizaci√≥n de cines: control autom√°tico y remoto de equipos, automatizaci√≥n de proyecci√≥n de pel√≠culas, monitoreo, paneles de video y ahora tambi√©n terminales para la venta de boletos y bares.  Espec√≠ficamente, el √∫ltimo p√°rrafo est√° dedicado a este art√≠culo. <br><a name="habracut"></a><br>  El proyecto en s√≠, que tuvo que completarse antes del lunes, es una especie de capa entre el servidor principal de Scala y el terminal de pago de hierro VeriFone VX 820 (de hecho, hay m√°s terminales, pero solo t√≥malo como ejemplo).  Est√° claro que nadie nos dar√° transacciones a trav√©s de √©l as√≠, por lo tanto, se utilizan las utilidades y bibliotecas de Sberbank / Arcus y UCS.  Por lo tanto, el esquema de trabajo deber√≠a ser el siguiente: <br><br><img src="https://habrastorage.org/webt/ak/k4/do/akk4do9scie61w_tobeuwpk6liu.png"><br><br>  Exteriormente, se ve as√≠: <br><br><img src="https://habrastorage.org/webt/oh/ul/ts/ohultstzocyw8za06mbxqwmnrma.jpeg"><br><br>  Adem√°s, este subsistema debe usarse en cajas registradoras est√°ndar que todos vieron en cualquier sala de cine en los cajeros. <br><br>  Seg√∫n la tradici√≥n interna, llamamos a cada proyecto de nuestro equipo un nombre de la mitolog√≠a n√≥rdica antigua, para este subsistema se eligi√≥ el nombre Gefjon: el nombre de la diosa de la fertilidad y la fertilidad (un buen nombre para un servidor de pago, ¬øno es as√≠? Bueno, la leyenda sobre los toros que cortan la isla encaja idealmente con la arquitectura actual, cortar el trabajo con equipos de un lenguaje de alto nivel). <br><br>  El formato de los mensajes entrantes y salientes es un servidor HTTP con una carga JSON.  Este es el compromiso √≥ptimo entre Scala, que es dif√≠cil pasar a aislar datos binarios de flujos de socket y C, que es dif√≠cil subir a transferir objetos a trav√©s de la red.  No hay muchas operaciones posibles que necesiten ser operadas: pago, cancelaci√≥n, devoluci√≥n, varios tipos de informes, abrir el men√∫ de servicio y hacer ping.  No se ve nada complicado.  Como hay tres sistemas bancarios (y se espera una reposici√≥n posterior de la familia), se decidi√≥ dividir el proyecto en componentes: <br><br><img src="https://habrastorage.org/webt/rk/vm/sc/rkvmscw9ret9atfnts-nezxtaqg.png"><br><br>  Los bloques verdes son los que ten√≠amos que hacer, los azules son los que no se pueden cambiar y que proporciona el banco. <br><br>  Dado que los principales problemas surgieron solo con el software de Sberbank, el art√≠culo en su conjunto estar√° dedicado a las trampas, que contamos con nuestro barco. <br><br><h2>  CAP√çTULO 2. Cordero asado </h2><br><img src="https://habrastorage.org/webt/zr/-d/ez/zr-dez83p56hekuceyiiqka2rdi.jpeg"><br>  (foto: heaclub.ru) <br><br>  ... se parece a esto.  El c√≥digo para ese prototipo, que fue escrito hace unos meses para dejar en claro a todas las personas superiores que podemos trabajar con aplicaciones bancarias, se ve√≠a casi igual. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[BUF_KB * <span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * null; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * grep; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> _WIN32_WINNT char * ptr; null = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"nul"</span></span></span><span class="hljs-meta">; grep = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"findstr"</span></span></span><span class="hljs-meta">; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> null = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/dev/null"</span></span></span><span class="hljs-meta">; grep = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"grep"</span></span></span><span class="hljs-meta">; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> sprintf(buf, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"%s %"</span></span></span><span class="hljs-meta">PRIi32</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"= %sops.ini &gt;%s 2&gt;%s || "</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"echo %"</span></span></span><span class="hljs-meta">PRIi32</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"=9,6,PINPAD_TEST &gt;&gt; %sops.ini"</span></span></span><span class="hljs-meta">, grep, TERM_ARCUS_TEST_PINPAD, TERM_PATH, null, null, TERM_ARCUS_TEST_PINPAD, TERM_PATH); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> _WIN32_WINNT ptr = buf; while (*ptr) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (*ptr == </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'/'</span></span></span><span class="hljs-meta">) *ptr = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'\\'</span></span></span><span class="hljs-meta">; ptr++; } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre> <br>  Est√° claro que esto no era adecuado para la versi√≥n de producci√≥n, por lo que era esencialmente necesario escribir todo de nuevo. <br><br>  Cada banco que proporciona bibliotecas para trabajar con el terminal generalmente proporciona dos opciones de conexi√≥n: a trav√©s de las funciones de la biblioteca (.so / .dll) o mediante una utilidad preparada que solo necesita pasar dos valores: el tipo de operaci√≥n y la cantidad (cuando sea necesario).  En teor√≠a, nada complicado, solo algo <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buffer[<span class="hljs-number"><span class="hljs-number">100</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buffer, <span class="hljs-string"><span class="hljs-string">"%d %d"</span></span>, atoi(argv[<span class="hljs-number"><span class="hljs-number">1</span></span>]), atoi(argv[<span class="hljs-number"><span class="hljs-number">2</span></span>])); system(buffer);</code> </pre> <br>  El resultado de la operaci√≥n se colocar√° en el archivo "e", y la verificaci√≥n de deslizamiento en el archivo "p".  Simplemente env√≠e estos archivos a stdout con conversi√≥n a JSON, para que el servidor HTTP los env√≠e como carga √∫til sin pensar en lo que hay all√≠. <br><br>  Pero este art√≠culo no habr√≠a sido publicado si todo hubiera sido tan simple. <br><br><h2>  CAP√çTULO 4. A trav√©s de la monta√±a y debajo de la monta√±a. </h2><br>  La versi√≥n inicial de la implementaci√≥n fue una simple llamada de aplicaci√≥n: el servidor HTTP llam√≥ al contenedor requerido con par√°metros unificados (por ejemplo, el informe X es 4), y la utilidad, por ejemplo gfj_pilot, lanz√≥ sb_pilot con el par√°metro requerido para esta operaci√≥n (por ejemplo, el informe X es 9) .  Luego, la utilidad de envoltura ley√≥ el resultado de la operaci√≥n del archivo electr√≥nico (por ejemplo, 2000 - "pago rechazado, repita la operaci√≥n") y lo convirti√≥ en un error universal (por ejemplo 3 - "Error al leer o procesar la tarjeta / cuenta, repita la operaci√≥n").  Despu√©s de eso, el archivo "p" se convirti√≥ a base64 para evitar que se rompa el formato y se envi√≥ junto con el resultado a stdout como JSON. <br><br>  Todo esto funcion√≥ perfectamente hasta que en un buen momento nos informaron que ... <br><br>  ... esto no funciona en Windows. <br><br><img src="https://habrastorage.org/webt/yp/44/t_/yp44t_qwokissyt75mayl71mcdm.jpeg"><br><br>  Bueno, m√°s precisamente, Windows no tiene problemas (excepto que el deslizamiento se genera en la codificaci√≥n Cp-1251 y la consola funciona en CP866).  El archivo "e" simplemente no se gener√≥.  Lanz√≥ una utilidad bancaria directamente: <br><br><pre> <code class="plaintext hljs">C:\banks\sber\sb_pilot&gt;dir    C   .   : B401-6B9D   C:\banks\sber\sb_pilot 04.02.2019 12:28 &lt;DIR&gt; . 04.02.2019 12:28 &lt;DIR&gt; .. 31.01.2019 17:12 10 832 F12X24.BIN 31.01.2019 17:12 128 000 gate.dll 31.01.2019 17:12 72 192 loadparm.exe 31.01.2019 17:12 36 204 OPT0.R 31.01.2019 17:12 20 716 OPT1.R 31.01.2019 17:12 1 806 OPT3.R 31.01.2019 17:12 388 608 pilot_nt.dll 31.01.2019 23:06 463 pinpad.ini 31.01.2019 17:12 91 136 posScheduler.exe 31.01.2019 17:12 418 printers.ini 01.02.2019 16:51 91 646 sbkernel1902.log 31.01.2019 17:12 653 312 sbrf.dll 31.01.2019 17:12 840 192 SBRFCOM.dll 31.01.2019 17:12 3 142 656 sb_kernel.dll 01.02.2019 16:51 9 SESS.D 01.02.2019 16:51 715 SPLC.D 31.01.2019 17:12 72 192 upwin.exe 20  5 659 718  2  37 567 004 672   #    (1)  10  (1000 ) C:\banks\sber\sb_pilot&gt;loadparm.exe 1 1000 C:\banks\sber\sb_pilot&gt;dir    C   .   : B401-6B9D   C:\banks\sber\sb_pilot 04.02.2019 12:28 &lt;DIR&gt; . 04.02.2019 12:28 &lt;DIR&gt; .. 04.02.2019 12:28 216 commerr.log 31.01.2019 17:12 10 832 F12X24.BIN 31.01.2019 17:12 128 000 gate.dll 31.01.2019 17:12 72 192 loadparm.exe 31.01.2019 17:12 36 204 OPT0.R 31.01.2019 17:12 20 716 OPT1.R 31.01.2019 17:12 1 806 OPT3.R 01.02.2019 18:51 1 349 p 31.01.2019 17:12 388 608 pilot_nt.dll 31.01.2019 23:06 463 pinpad.ini 31.01.2019 17:12 91 136 posScheduler.exe 31.01.2019 17:12 418 printers.ini 04.02.2019 12:28 92 218 sbkernel1902.log 31.01.2019 17:12 653 312 sbrf.dll 31.01.2019 17:12 840 192 SBRFCOM.dll 31.01.2019 17:12 3 142 656 sb_kernel.dll 01.02.2019 16:51 9 SESS.D 01.02.2019 16:51 715 SPLC.D 31.01.2019 17:12 72 192 upwin.exe 19  5 659 029  2  37 567 008 768   C:\banks\sber\sb_pilot&gt;</code> </pre> <br>  De hecho, no hay un archivo "e".  Piedra hacia Sberbank # 1.  Estamos escribiendo una carta a Sberbank (posteriormente recibimos una respuesta de que deber√≠a ser as√≠), y dado que no hay tiempo para la correspondencia y tenemos que comenzar ahora, estamos buscando soluciones para obtener el resultado. <br><br><pre> <code class="plaintext hljs">04.02 12:28:55 SBKRNL: Failed to open device \\.\COM1, err 2 04.02 12:28:56 SBKRNL: Failed to open device \\.\COM1, err 2 04.02 12:28:56 SBKRNL: Result = 0 04.02 12:28:56 GATE: unlock:'00000054' 04.02 12:28:56 GATE: lock:'00000054' 'UPOSWINMUTEX2' 04.02 12:28:56 GATE: unlock:'00000054' 04.02 12:28:56 LOADPARM: Unloading GATE.DLL... 04.02 12:28:56 GATE: SB_KERNEL.DLL is unloaded 04.02 12:28:56 LOADPARM: GATE.DLL unloaded</code> </pre> <br>  S√≠, el resultado se puede obtener del registro sbkernel.log.  Inconvenientemente, adem√°s no hay un hash de mapa para luego atornillar "Gracias" de Sberbank.  No bueno <br><br>  Deber√° conectarse a la biblioteca pilot_nt.dll e importar funciones desde ella.  Todo estar√≠a bien, pero ... Una piedra hacia Sberbank # 2: no existe tal biblioteca en Linux, tendr√° que crear dos aplicaciones diferentes para diferentes plataformas: para Linux, llame a la utilidad sb_pilot (similar a loadparm.exe, por cierto piedra # 3 para un nombre de utilidad diferente en diferentes plataformas ), en Windows, con√©ctese a la biblioteca pilot_nt.dll. <br><br><h2>  CAP√çTULO 5. Acertijos en la oscuridad </h2><br>  A las 19:00 horas. <br><br>  Sberbank es una gran empresa, la mayor√≠a de las soluciones de software se producen de acuerdo con GOST y documentos formales.  Entramos en el cat√°logo que Sberbank suministra con las bibliotecas: <br><br><pre> <code class="plaintext hljs">Sberbank$ ls -l Docs  30160 drwx------ 2 alex alex 4096  17 19:31 FAQ -rw-rw-r-- 1 alex alex 3398465  9 2018   UPOS    ().docx -rw-rw-r-- 1 alex alex 1182078  9 2018   UPOS  .docx -rw-rw-r-- 1 alex alex 853504  9 2018   .doc drwx------ 3 alex alex 4096  31 17:11     -rw-rw-r-- 1 alex alex 5280787  9 2018    POS-.docx -rw-rw-r-- 1 alex alex 1149640  9 2018  .docx drwx------ 2 alex alex 4096  28 2018  UPOS drwx------ 2 alex alex 4096  28 2018    -rw-rw-r-- 1 alex alex 3451601  9 2018     ().docx -rw-rw-r-- 1 alex alex 1956196  9 2018   .docx -rw-rw-r-- 1 alex alex 1043161  9 2018       ()_().docx -rw-rw-r-- 1 alex alex 4348157  9 2018  POS-.docx -rw-rw-r-- 1 alex alex 3970267  9 2018   .docx drwx------ 3 alex alex 4096  28 2018   -rw-rw-r-- 1 alex alex 2644702  9 2018    POS-.docx drwx------ 2 alex alex 4096  28 2018   -rw-rw-r-- 1 alex alex 1558211  9 2018   .png</code> </pre> <br>  Mucho bien, pero solo nos interesa el directorio para desarrolladores: <br><br><pre> <code class="plaintext hljs">Sberbank$ ls -l Docs/\ \ \ /  8704 -rw-rw-r-- 1 alex alex 47105  9 2018 1C.docx -rw-rw-r-- 1 alex alex 1824  9 2018 cardtype.h -rw-rw-r-- 1 alex alex 2590378  9 2018 cr_ttk_protocol_ru.rtf -rw-rw-r-- 1 alex alex 208  9 2018 deprtmnt.h -rw-rw-r-- 1 alex alex 16681  9 2018 errors.h drwx------ 6 alex alex 4096  28 2018 examples -rw-rw-r-- 1 alex alex 58575  9 2018 gate.h -rw-rw-r-- 1 alex alex 4218  9 2018 paramsln.h -rw-rw-r-- 1 alex alex 61693  9 2018 pilot_nt.h -rw-rw-r-- 1 alex alex 28160  9 2018 ReadTrack2.doc -rw-rw-r-- 1 alex alex 7417  9 2018 sbkernel.h -rw-rw-r-- 1 alex alex 144896  9 2018 sb_pilot.doc -rw-rw-r-- 1 alex alex 3525323  9 2018     ole- sbrf.dll.rtf -rw-rw-r-- 1 alex alex 46683  9 2018      gate.dll.chi -rw-rw-r-- 1 alex alex 255414  9 2018      gate.dll.chm -rw-rw-r-- 1 alex alex 814653  9 2018      gate.dll.pdf -rw-rw-r-- 1 alex alex 41618  9 2018      pilot_nt.chi -rw-rw-r-- 1 alex alex 241716  9 2018      pilot_nt.chm -rw-rw-r-- 1 alex alex 968753  9 2018      pilot_nt.pdf -rw-rw-r-- 1 alex alex 81  9 2018  .txt</code> </pre> <br>  Una gran cantidad de papel usado, por si acaso, vuelva a leer pilot_nt, del cual aprendemos lo siguiente: <br><blockquote>  Tabla 1. Sistema operativo sb_pilot compatible. <br><div class="scrollable-table"><table><tbody><tr><th>  OS </th><th>  Capacidad </th><th>  Nombre del m√≥dulo </th></tr><tr><td>  Ventanas </td><td>  32 </td><td>  sb_pilot.exe </td></tr><tr><td>  Linux </td><td>  32 </td><td>  sb_pilot </td></tr><tr><td>  Dos </td><td>  16 </td><td>  sb_pilot.exe </td></tr></tbody></table></div></blockquote><br>  Resulta que la utilidad para Windows todav√≠a deber√≠a llamarse sb_pilot.  Bueno, una piedra hacia Sberbank # 4 por la inconsistencia de su propia documentaci√≥n. <br><blockquote>  Transferencia de los resultados del programa. <br><br>  Al final del programa, se forman dos archivos de texto: el archivo de intercambio y el archivo de verificaci√≥n. <br><br>  El primero se llama e y est√° destinado a pasar par√°metros del funcionamiento perfecto al programa de llamada.  La primera l√≠nea de este archivo contiene el c√≥digo del resultado de la operaci√≥n y un texto separado por comas que explica el mensaje de texto.  El c√≥digo 0 significa pago exitoso, cualquier otro valor: rechazo o incapacidad para realizar el pago. </blockquote><br><br><img src="https://habrastorage.org/webt/c8/7f/m2/c87fm26nwcdjtfol6m0vamuvk8e.jpeg"><br><br>  Perezosamente tiramos una piedra m√°s y comenzamos a estudiar la documentaci√≥n para conectar la biblioteca directamente. <br><blockquote>  <b>El procedimiento para llamar a funciones de biblioteca</b> <br><br>  Al pagar (devolver) compras con tarjeta de cr√©dito, el programa de efectivo debe llamar a la funci√≥n card_authorize () de la biblioteca de Sberbank completando los campos TType y Amount y especificando valores cero en los campos restantes.  Al final de la funci√≥n, debe analizar el campo RCode.  Si contiene el valor "0" o "00", la autorizaci√≥n se considera completada con √©xito, de lo contrario se rechaza.  Adem√°s, debe verificar el valor del campo Verificar. <br><br>  Si no es NULL, debe enviarse para imprimir (en modo no fiscal) y luego <br>  eliminar llamando a la funci√≥n GlobalFree ().  Al cerrar un turno, el programa de efectivo debe llamar a la funci√≥n close_day () de la biblioteca Sberbank completando el campo TType = 7 y especificando valores cero en los campos restantes.  Al final de la funci√≥n, verifique el valor del campo Verificar. <br><br>  Si el campo Verificar no es NULL, debe enviarse para imprimir (en modo no fiscal) y luego eliminarse llamando a la funci√≥n GlobaFree (). </blockquote>  Suena f√°cil, incluso se proporciona un archivo de encabezado.  Bueno, con√©ctalo, compila y ... <br><br><pre> <code class="cpp hljs">$ cat main.c &amp;&amp; i686-w64-mingw32-gcc main.c -o main.a <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"pilot_nt.h"</span></span></span><span class="hljs-meta"> int main(void) { return 0; } In file included from main.c:1:0: pilot_nt.h:525:3: </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">: unknown type name </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'auth_answer'</span></span></span><span class="hljs-meta"> auth_answer ans; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/**&lt; [in, out]                            .   . ::auth_answer */</span></span></span><span class="hljs-meta"> ^ pilot_nt.h:544:3: </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">: unknown type name </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'auth_answer'</span></span></span><span class="hljs-meta"> auth_answer ans; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/**&lt; [in, out]                            .   . ::auth_answer */</span></span></span><span class="hljs-meta"> ^ pilot_nt.h:567:3: </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">: unknown type name </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'auth_answer'</span></span></span><span class="hljs-meta"> auth_answer ans; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/**&lt; [in, out]                            .   . ::auth_answer */</span></span></span><span class="hljs-meta"> ^ pilot_nt.h:590:3: </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">: unknown type name </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'auth_answer'</span></span></span><span class="hljs-meta"> auth_answer ans; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/**&lt; [in, out]                            .   . ::auth_answer */</span></span></span><span class="hljs-meta"> ^ pilot_nt.h:627:3: </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">: unknown type name </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'auth_answer'</span></span></span><span class="hljs-meta"> auth_answer ans; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/**&lt; [in, out]                            .   . ::auth_answer */</span></span></span><span class="hljs-meta"> ^ pilot_nt.h:668:3: </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">: unknown type name </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'auth_answer'</span></span></span><span class="hljs-meta"> auth_answer ans; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/**&lt; [in, out]                            .   . ::auth_answer */</span></span></span></span></code> </pre> <br>  Ummm ... que?  Abra pilot_nt.h: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> __cplusplus extern </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"C"</span></span></span><span class="hljs-meta">{ #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;...&gt; /** *    * ,         . */ struct auth_answer{ int TType; /**&lt; [in]  .  ::OpetationTypes */ unsigned long Amount; /**&lt; [in]    */ char RCode[3]; /**&lt; [out]    */ char AMessage[16]; /**&lt; [out]    */ int CType; /**&lt; [in,out]   */ char* Check; /**&lt; [out]  ,   GlobalFree    */ }; &lt;...&gt; struct auth_answer7{ auth_answer auth_answ; /**&lt; [in, out]   . . ::auth_answer */ &lt;---- THIS char AuthCode[MAX_AUTHCODE]; /**&lt; [out]  . 7 . */ char CardID [CARD_ID_LEN]; /**&lt; [out]  . 25 . */ int SberOwnCard; /**&lt; [out]     */ };</span></span></span></span></code> </pre> <br>  Inmediatamente, sin mirar la piedra para comentarios en ruso en la codificaci√≥n CP1251. <br><br>  Bueno, la piedra m√°s seria: queridos desarrolladores de C ++.  Si escribe "C" externa, esto significa que el compilador de C debe compilar el c√≥digo dentro del bloque.  Si NO ha realizado un `typedef` de una estructura, cada vez que lo mencione como referencia de tipo, debe escribir la palabra clave` struct`. <br><br>  Parchee el archivo para desarrolladores, sustituyendo la palabra `struct` donde sea necesario.  Vinculaci√≥n a la biblioteca `pilot_nt.dll`.  Victoria, no?  Lanzamos nuestra aplicaci√≥n. <br><br><h2>  CAP√çTULO 6. Del fuego a las llamas </h2><br>  Bueno, lo entiendes, ¬øverdad?  La aplicaci√≥n simplemente falla.  Hasta el principal.  Medite, agregue el an√°logo NIH de la funci√≥n errno para Windows: GetLastError (piedra # 3 hacia Microsoft, las dos primeras son para codificaciones). <br><br><pre> <code class="plaintext hljs">C:\banks\sber\WIN&gt;sb_pilot.exe 1 1000 E: !g_sblibrary (0xc0000096)</code> </pre> <br>  0xc0000096?  ¬øNo deber√≠a GetLastError devolver un c√≥digo de error adecuado? <br><blockquote>  Para obtener una lista completa de los c√≥digos de error proporcionados por el sistema operativo, consulte C√≥digos de error del sistema. </blockquote>  S√≠, abre el art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> : <br><blockquote>  Los siguientes temas proporcionan listas de c√≥digos de error del sistema.  Estos valores se definen en el archivo de encabezado WinError.h. <br><br><ul><li>  C√≥digos de error del sistema (0-499) (0x0-0x1f3) </li><li>  C√≥digos de error del sistema (500-999) (0x1f4-0x3e7) </li><li>  C√≥digos de error del sistema (1000-1299) (0x3e8-0x513) </li><li>  C√≥digos de error del sistema (1300-1699) (0x514-0x6a3) </li><li>  C√≥digos de error del sistema (1700-3999) (0x6a4-0xf9f) </li><li>  C√≥digos de error del sistema (4000-5999) (0xfa0-0x176f) </li><li>  C√≥digos de error del sistema (6000-8199) (0x1770-0x2007) </li><li>  C√≥digos de error del sistema (8200-8999) (0x2008-0x2327) </li><li>  C√≥digos de error del sistema (9000-11999) (0x2328-0x2edf) </li><li>  C√≥digos de error del sistema (12000-15999) (0x2ee0-0x3e7f) </li></ul></blockquote>  Ok, tenemos un error indocumentado, tiramos una piedra y abrimos el omnisciente google: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">forum.vingrad.ru/forum/topic-346194/kw-dll-loadlibrary-%D0%BE%D1%82%D0%BB%D0%B0%D0%B4%D0%BA%D0%B0.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bbs.csdn.net/topics/80078275</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">forums.codeguru.com/showthread.php?179566-0xC0000096-Privileged-Instruction</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.unknowncheats.me/forum/general-programming-and-reversing/97763-privileged-instruction-error.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cboard.cprogramming.com/windows-programming/146130-prallel-port-programming.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">computer-programming-forum.com/82-mfc/dc2481c0ecead2f2.htm</a> </li></ul><br>  La esencia del error es que alguna subrutina usa una de las instrucciones <br><br><ul><li>  _inp () </li><li>  _inpw () </li><li>  _inpd () </li><li>  _outp () </li><li>  _outpw () </li><li>  _outpd () </li></ul><br>  Su uso est√° prohibido en los n√∫cleos NT, ya que intentan trabajar directamente con el puerto paralelo.  Aparentemente, este c√≥digo se llama en el inicializador de la biblioteca, es decir  la biblioteca en el inicio quiere sondear los puertos en busca de dispositivos, pero el n√∫cleo NT requiere trabajar a trav√©s del controlador. <br><br>  Situaci√≥n desesperada? <br><br><h2>  CAP√çTULO 8. Ara√±as y moscas </h2><br>  10 p.m.  Por si acaso, surge la idea de verificar que esto no se deba al hecho de que usamos compilaci√≥n cruzada con Linux usando mingw.  Al mismo tiempo, entendemos que Sberbank ofrece solo una aplicaci√≥n de 32 bits, por lo que no funcionar√° con una aplicaci√≥n de 64 bits, est√° bien, pero a√∫n as√≠ lanzaremos una piedra hacia Sberbank para la versi√≥n de solo 32 en 2019. <br><br>  <b>Dado</b> : instalado en virtualbox windows 7; <br>  <b>Requerido</b> : Instale Visual Studio y copie MVP. <br><br>  Vamos al sitio web de Microsoft, descargamos Visual Studio 2017. Tomamos la licencia comunitaria, ya que la tomamos para verificaci√≥n, para los negocios, la licencia se comprar√° si despega. <br>  Descarga unos cientos de megabytes y ... <br><br>  Vemos que nuestra versi√≥n del sistema operativo (Windows 7) no es compatible. <br><br>  Ok, vamos a todo tipo de sitios obscenos, estamos buscando Visual Studio 2008, descargamos unos cientos de megabytes nuevamente y ... <br><br>  Obtenemos el archivo iso. <br><br>  Bien, intentemos instalar Daemon Tools 10 (ya que esta es la versi√≥n que ofrece el sitio) para insertar este disco virtual. <br><br>  Ejecute el binario descargado.  Error de encendido, requiere .NET Framework 4.5, descargar, instalar. <br>  Iniciamos el binario descargado, la instalaci√≥n ha comenzado, el gestor de arranque dice que necesita 4.5.2, descargar, instalar. <br>  Iniciamos el binario descargado, la instalaci√≥n ha comenzado, el gestor de arranque dice que no ir√° a ning√∫n lado hasta que instalemos la actualizaci√≥n de seguridad KB3033929, la descarguemos, la instalemos. <br><br>  Y recibimos una bofetada de Microsoft como mensaje: <br><br><img src="https://habrastorage.org/webt/r6/qe/de/r6qedenl5w3dez4ysscvod8rmjw.png"><br><br>  Lanzamos violentamente una piedra muy afilada hacia Microsoft, descargamos las antiguas herramientas Daemon de torrents, desempaquetamos con √©xito Visual Studio, instalamos, finalmente (00:00) compilamos MVP, obtenemos el mismo error.  Bueno, hab√≠a una buena versi√≥n, pero no creci√≥ juntos. <br><br><h2>  CAP√çTULO 11. En el umbral </h2><br>  Estamos escribiendo al segundo programador, que en este momento completa con urgencia el servidor y el procedimiento de registro.  √âl recuerda que hay un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">repositorio</a> git que se conecta a esta biblioteca en NT y funciona con √©l. <br><br>  Mirando sospechosamente el repositorio, desc√°rguelo, comp√≠lelo y ejec√∫telo.  Funciona <br><br><img src="https://habrastorage.org/webt/mt/gl/q-/mtglq-c68eyegv74wjnzjvpmddi.png"><br><br>  Observamos el c√≥digo a√∫n m√°s sospechosamente.  El c√≥digo es id√©ntico, excepto que est√° escrito en C ++ y no en C. <br>  Entendemos que el lenguaje no tiene nada que ver con eso.  Observamos las bibliotecas del Sberbank, que extrae el c√≥digo. <br>  Vemos el √∫ltimo compromiso. <br><br>  Y aqu√≠ estamos esperando otra sorpresa. <br><br>  Resulta que las versiones de la biblioteca Sberbank pueden ser diferentes.  La √∫ltima confirmaci√≥n aumenta la versi√≥n del 23 al 27.  Copie la versi√≥n del gita a su computadora de prueba - ¬°FUNCIONA! <br><br>  Verificamos todos los archivos enviados por Sberbank, comparamos las versiones y construimos una tableta: <br><div class="scrollable-table"><table><tbody><tr><th>  Versi√≥n </th><th>  Trabajos </th></tr><tr><td>  26.0.15 - B√°sico </td><td>  no </td></tr><tr><td>  27.4.12 - Desde el repositorio </td><td>  si </td></tr><tr><td>  23.0.13 - Desde el repositorio </td><td>  si </td></tr><tr><td>  29.0.9 - Lo √∫ltimo de Sat </td><td>  si </td></tr><tr><td>  23.0.13 - Con un parche para el sistema Cryptor </td><td>  si </td></tr></tbody></table></div><br>  Genial, ahora vamos a sanar.  En aquellos sistemas donde cuesta 26, actualice a 29 o 27 y todo despegar√°. <br>  Lanzamos la piedra # 9 hacia Sberbank por romper el comportamiento en los sistemas NT. <br><br><h2>  CAP√çTULO 12. Lo que les esperaba dentro </h2><br>  ¬øNo hay suficiente e file?  No importa, tomamos encabezados parcheados, enlazamos din√°micamente a la biblioteca para devolver un error correctamente, escribimos un c√≥digo que simplemente escribe el c√≥digo de retorno de la funci√≥n en el archivo "e", llamemos al biner sb_pilot.exe y ... <br><br>  Para trabajar, funciona. <br><br>  Esa es solo la versi√≥n para el sistema "Cryptor" no crea un archivo "p". <br><br>  <i>Observamos con tristeza la sangre que gotea sobre los nudillos y la abolladura en la pared.</i> <br><br>  Para empezar, ¬øqu√© es el sistema Cryptor? <br><br>  Cryptera es una empresa danesa que produce equipos de cifrado / equipos de seguridad / claves, etc. Creo que todos vieron una de las copias de sus productos: <br><br><img src="https://habrastorage.org/webt/pb/dz/85/pbdz85atzxiscdkdkq0z97ahhsm.png"><br><br>  Entonces, Sberbank usa su m√≥dulo criptogr√°fico para pinpads y lanza una biblioteca especial "parcheada", en la cual, como ya entendimos, el archivo "p" no se crea.  Escribimos a Sberbank sobre esto y en unos d√≠as obtendremos la respuesta de que "bajo el sistema original, se crear√° el archivo" p ", pero bajo el parche a Cryptor no lo har√°".  Les daremos la piedra n. ¬∞ 10 en unos d√≠as, porque necesita trabajar ahora. <br><br>  Afortunadamente o desafortunadamente, las funciones que utilizamos para realizar operaciones devuelven la estructura ya mencionada: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auth_answer</span></span></span><span class="hljs-class">{</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TType; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]  .  ::OpetationTypes */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Amount; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> RCode[<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> AMessage[<span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CType; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in,out]   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* Check; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]  ,   GlobalFree    */</span></span> };</code> </pre> <br>  Oh, bien, el cheque ya est√° all√≠, podemos guardarlo en un archivo nosotros mismos o imprimirlo inmediatamente en JSON ... <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"%s\n"</span></span>, answer.Check);</code> </pre> <br>  Y la aplicaci√≥n se bloquea debido al acceso a un puntero no v√°lido. <br><br><h2>  CAP√çTULO 14. Fuego y agua. </h2><br>  4 a.m.  Realizamos Seth Bandha Sarvangasana para calmarnos y leemos cuidadosamente el manual: <br><blockquote>  imagen [fuera] del cheque, GlobalFree debe liberarla en el programa de llamadas </blockquote>  ¬øQu√© nos da esto?  Mucho  En primer lugar, dado que el puntero debe limpiarse con GlobalFree, se solucion√≥ con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GlobalAlloc</a> .  Por lo tanto, no produce un puntero a la memoria, como lo fue en la versi√≥n de 16 bits, sino un n√∫mero de objeto con el tipo sem√°ntico declarado HGLOBAL, que se puede alimentar en la funci√≥n GlobalSize para obtener el tama√±o del bloque asignado y GlobalLock para bloquear un trozo de memoria, pero para obtener el puntero original.  Por cierto, piedra # 6 hacia Microsoft para NIH malloc y gratis, que est√°n en la biblioteca est√°ndar. <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"%s\n"</span></span>, GlobalLock(answer.Check));</code> </pre> <br>  Y a√∫n as√≠ obtener una gota.  Bien, ¬øqu√© muestra GlobalSize?  Cero?  De alguna manera extra√±o. <br><br>  Verificamos otras funciones que tambi√©n deber√≠an dar un desliz: vemos la misma imagen. <br><br>  Solo se me ocurre que puedo generar un recibo por mi cuenta de acuerdo con los datos que puede proporcionar la funci√≥n de pago m√°s genial (s√≠, Sberbank tiene funciones llamadas card_authorize2..14, no arrojar√© una piedra por ello): <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auth_answer14</span></span></span><span class="hljs-class"> {</span></span> auth_answer ans; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in, out]   . . ::auth_answer */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> AuthCode[MAX_AUTHCODE]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]  . 7 . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> CardID[CARD_ID_LEN]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]  . 25 .     ,   6   4,    '*'.*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ErrorCode; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]  . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> TransDate[TRANSDATE_LEN]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]     */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TransNumber; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    . , .    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SberOwnCard; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]     */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> Hash[CARD_HASH_LEN]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in, out]  SHA1   ,   ASCII     . 40 .*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> Track3[CARD_TRACK3_LEN]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]   */</span></span> DWORD RequestID; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in,out]   .  PCI DSS .*/</span></span> DWORD Department; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]     0  14-, .      0xFFFFFFFF,          .        ,      4191. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> RRN[MAX_REFNUM]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in,out]   ,  .    ,     .   12-  .       (   pilot_nt.dll),     ‚Äì  (     ;     ,   ).*/</span></span> DWORD CurrencyCode; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]    (810, 643, 840, 978  ..) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> CardEntryMode; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    ('D'-., 'M'- , 'C'-, 'E'- EMV, 'R'- magstripe, 'F'-fallback)*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> CardName[MAX_CARD_NAME_LEN]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> AID[MAX_AID_ASCII_LEN]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out] Application ID   (   ASCIIZ-)*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> FullErrorText[MAX_FULL_ERROR_TEXT]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]     */</span></span> DWORD GoodsPrice; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]    ,  (34.99-&gt;3499)*/</span></span> DWORD GoodsVolume; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]  ,  .  (30.234-&gt;30234)*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> GoodsCode[MAX_GOODS_CODE+<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]     .*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> GoodsName[MAX_GOODS_NAME]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]     . !   auth_answer14         gate.dll TGoodsData.     */</span></span> }; <span class="hljs-comment"><span class="hljs-comment">/** @brief     * @param[in] track2      .  NULL,     . * @param[in,out] auth_answer . ::auth_answer14 * @param[in,out] payinfo     * @return int  . */</span></span> <span class="hljs-function"><span class="hljs-function">PILOT_NT_API </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">card_authorize14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *track2, struct auth_answer14 *auth_answer, struct payment_info_item *payinfo )</span></span></span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estamos tratando de seleccionar los campos ... Descubrimos que solo una cosa nos separ√≥ de la felicidad: Apellido y Nombre del titular de la tarjeta. </font><font style="vertical-align: inherit;">Sin ellos, un resbal√≥n no se considera </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">legal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detalles: identificador de un cajero autom√°tico, terminal electr√≥nico u otro medio t√©cnico destinado a transacciones con tarjetas de pago; </font><font style="vertical-align: inherit;">tipo de operaci√≥n; </font><font style="vertical-align: inherit;">fecha de transacci√≥n; </font><font style="vertical-align: inherit;">monto de la transacci√≥n; </font><font style="vertical-align: inherit;">moneda de transacci√≥n; </font><font style="vertical-align: inherit;">c√≥digo de autorizaci√≥n del monto de la comisi√≥n; </font><font style="vertical-align: inherit;">Detalles de la tarjeta de pago.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es una pena, pero formar un boleto legal con los datos que tenemos no funcionar√°. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos a profundizar en la documentaci√≥n nuevamente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encontramos el ejemplo que Sberbank ofrece en el directorio "ejemplos"</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Authorization completion finished with code '"</span></span> &lt;&lt; result &lt;&lt; <span class="hljs-string"><span class="hljs-string">"'"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-function">ofstream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CHEQUE_FILENAME)</span></span></span></span>; file &lt;&lt; argument.auth_answ.Check; file.close(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argument.auth_answ.Check) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Cheque saved to file "</span></span> &lt;&lt; CHEQUE_FILENAME &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-comment"><span class="hljs-comment">//GlobaFree(argument.auth_answ.Check); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplemente muestra el texto ubicado en el puntero. </font><font style="vertical-align: inherit;">Pero ya hemos visto que no funciona as√≠ ... Por si acaso, recopilaremos su ejemplo y lo ejecutaremos. </font><font style="vertical-align: inherit;">Salida en la l√≠nea `file &lt;&lt; argumento.auth_answ.Check;`, bueno, Sberbank, sostenga la piedra # 11 para ejemplos que no funcionan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7 a.m. </font><font style="vertical-align: inherit;">Ya puede escribir a los desarrolladores de otro contenedor que se escribi√≥ en Delphi hace varios a√±os. </font><font style="vertical-align: inherit;">Recibimos la respuesta de que todo funciona para ellos. </font><font style="vertical-align: inherit;">Estamos buscando la base de su envoltorio y encontramos en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><pre> <code class="cpp hljs">TAuthAnswer = packed record TType: integer; Amount: UINT; <span class="hljs-comment"><span class="hljs-comment">// IN     Rcode: array [0 .. 2] of AnsiChar; AMessage: array [0 .. 15] of AnsiChar; CType: integer; Check: PAnsiChar; end; Result := Func(nil, @FAuthAnswer); FLastError := Result; FCheque := PAnsiChar(FAuthAnswer.Check);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conversi√≥n simple de tipo a puntero sin llamadas a funciones. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comenzamos a sospechar de los esp√≠ritus malignos.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CAP√çTULO 17. Tormenta el√©ctrica estall√≥ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La gente comienza a regresar a la oficina, asintiendo con simpat√≠a. </font><font style="vertical-align: inherit;">PO no parece muy feliz de saber las √∫ltimas noticias. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ recuerdo un detalle. </font><font style="vertical-align: inherit;">Cuando mostramos los campos de la estructura # 14 para ver sus valores, se cort√≥ un byte de cada l√≠nea. </font><font style="vertical-align: inherit;">Por un lado, por otro</font></font><br><blockquote>  Atencion<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la estructura auth_answer14, el nombre del producto es un car√°cter m√°s corto que en gate.dll TGoodsData. </font><font style="vertical-align: inherit;">Solucione este error como est√°ndar</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tal vez todav√≠a est√° conectado con ... Una </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terrible suposici√≥n aparece en el cerebro como un rayo. </font><font style="vertical-align: inherit;">Declarar la estructura como</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> __</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attribute__</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">packed</span></span></span><span class="hljs-class">)) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TType; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]  .  ::OpetationTypes */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Amount; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> RCode[<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> AMessage[<span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CType; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [in,out]   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* Check; <span class="hljs-comment"><span class="hljs-comment">/**&lt; [out]  ,   GlobalFree    */</span></span> };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y ... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nada cambia. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tama√±o fijo = 0, Bloqueo fijo = NULL. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dolor </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decaimiento </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Involuntariamente, busca con los ojos una viga c√≥moda en el techo, de modo que pueda soportar el peso. Despu√©s de tantas horas sin parar de codificar y estudiar la documentaci√≥n, filas delgadas de bytes flotan ante nuestros ojos. Pero, ¬øqu√© pasa si imprimimos bytes que generalmente se devuelven?</font></font><br><br><pre> <code class="cpp hljs"> u32 i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(answ); i++) { <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"%02x "</span></span>, *((u8 *)&amp;answ + i)); } <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); C:\banks\sber\sb_pilot&gt;sb_pilot.exe <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> e8 <span class="hljs-number"><span class="hljs-number">03</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> ce e4 ee e1 f0 e5 ed ee <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> f8 <span class="hljs-number"><span class="hljs-number">6</span></span>c <span class="hljs-number"><span class="hljs-number">7</span></span>a <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`30 00 00 ce` - lo que significa que Sberbank todav√≠a usa estructuras empaquetadas. </font><font style="vertical-align: inherit;">Pero no hay una palabra sobre esto en los encabezados. </font><font style="vertical-align: inherit;">Por lo tanto, los ejemplos no funcionan, por lo tanto, es imposible obtener un puntero al texto al final, porque se rompe debido a un cambio de 1 byte. </font><font style="vertical-align: inherit;">¬°Piedra enorme y espinosa hacia Sberbank! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y entonces un matiz maaaalenky me llam√≥ la atenci√≥n. </font><font style="vertical-align: inherit;">4 + 4 + 3 + 16 + 4 + 4 = 35. Y aqu√≠ hay 36 bytes, Obelix. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si hay 36 bytes, entonces el compilador sigue alineando la estructura. </font><font style="vertical-align: inherit;">Entonces, entre RCode y AMessage, todav√≠a se inserta un byte adicional.</font></font> Pero por que?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬°Despu√©s de todo, indicamos `__packed__`! </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CAP√çTULO 18. El viaje de regreso </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las razones por las que la alineaci√≥n todav√≠a est√° activa aparecieron en 2012: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=52991</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Solo se corrigi√≥ un error en GCC 8 (¬°una piedra para 6 a√±os de errores!), Que a√∫n no se puede actualizar. </font><font style="vertical-align: inherit;">Afortunadamente, hay una soluci√≥n alternativa:</font></font><br><br><pre> <code class="cpp hljs">-mno-ms-bitfields</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora no analizaremos el mecanismo de operaci√≥n de esta bandera, solo pasala al compilador: </font></font><br><br><img src="https://habrastorage.org/webt/ve/tr/d4/vetrd4m4rsdhmkyxkgrvxbkepko.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Slip! </font><font style="vertical-align: inherit;">Querida! </font><font style="vertical-align: inherit;">Te extra√±√©, ni siquiera jurar√© por el krakozyabry, ya le tir√© una piedra. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y finalmente, le damos a Microsoft una piedra, porque GlobalSize / Lock da ceros a punteros inv√°lidos.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CAP√çTULO 19. √öltimo cap√≠tulo </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para minimizar el n√∫mero de ifdefs para la capa sb_pilot, escribimos una aplicaci√≥n separada que imita completamente la versi√≥n de linux de sb_pilot. </font><font style="vertical-align: inherit;">Por lo tanto, dejando el c√≥digo de capa n. ¬∞ 1 igual, dejando solo una condici√≥n:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(BXI_OS_GLX) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GFJ_PILOT_EXECUTABLE </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"./sb_pilot"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> defined(BXI_OS_WIN) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GFJ_PILOT_EXECUTABLE </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"./sb_pilot.exe"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre> <br><img src="https://habrastorage.org/webt/wo/eu/2g/woeu2gk8m1mvtibiepfxwiijrbo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resultados de la batalla: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sberbank: 12 piedras </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft: 7 piedras </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CCG: 1 piedra </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Logro-recolecci√≥n en nuestro tablero de comando: </font></font><br><br><img src="https://habrastorage.org/webt/ko/im/3y/koim3ykfftmlltegcqh_rkdkgxc.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451188/">https://habr.com/ru/post/451188/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451178/index.html">Prueba de choque de aterrizaje del paraca√≠das del drag√≥n de la tripulaci√≥n</a></li>
<li><a href="../451180/index.html">PCB reemplaza dos motores lineales</a></li>
<li><a href="../451182/index.html">C√≥mo los tama√±os de las matrices C se convirtieron en parte de la interfaz binaria de la biblioteca</a></li>
<li><a href="../451184/index.html">Proyecto Blue Origin Blue Moon: Gente en la Luna para 2024</a></li>
<li><a href="../451186/index.html">El repositorio de LINSTOR y su integraci√≥n con OpenNebula</a></li>
<li><a href="../451196/index.html">Separaci√≥n de perfiles de clientes y aut√≥nomos.</a></li>
<li><a href="../451198/index.html">El papel de la realidad aumentada y la realidad virtual en la NBA</a></li>
<li><a href="../451200/index.html">Obtenci√≥n autom√°tica de certificados SSL por Let's Encrypt usando DNS-01 challenge y AWS</a></li>
<li><a href="../451204/index.html">Editores de texto gratuitos para colaboraci√≥n</a></li>
<li><a href="../451206/index.html">¬øQu√© est√° pasando con los repositorios RDF en este momento?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>