<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿‍🤝‍🧑🏼 🦑 📯 Teste de carga com gafanhoto 👨‍👨‍👧‍👧 👨‍🏭 👩🏻‍✈️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O teste de carga não é tão procurado e difundido quanto outros tipos de teste - não existem tantas ferramentas que permitem a realização de tais teste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teste de carga com gafanhoto</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/infopulse/blog/430502/">  O teste de carga não é tão procurado e difundido quanto outros tipos de teste - não existem tantas ferramentas que permitem a realização de tais testes, mas geralmente simples e conveniente podem ser contados com os dedos de uma mão. <br><br>  Quando se trata de teste de desempenho - antes de tudo, todos pensam no JMeter - é sem dúvida a ferramenta mais famosa com o maior número de plugins.  Eu nunca gostei do JMeter por causa de sua interface não óbvia e alto limite de entrada, assim que for necessário testar um aplicativo que não seja o Hello World. <br><br>  E agora, inspirado pelo sucesso dos testes em dois projetos diferentes, decidi compartilhar informações sobre um software relativamente simples e conveniente - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Locust</a> <br><br>  Para quem tem preguiça de gravar, gravei um vídeo: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZYKIyyY1qvY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><h2>  O que é isso </h2><br>  Ferramenta de código aberto que permite especificar cenários de carregamento com código Python que suporta carregamento distribuído e, como afirmam os autores, foi usada para testes de estresse do Battlelog para a série de jogos Battlefild (imediatamente cativante) <br><br>  Dos profissionais: <br><br><ul><li>  documentação simples, incluindo exemplo de copiar e colar.  Você pode começar a testar, mesmo com quase nenhuma habilidade de programação. </li><li>  "Under the hood" usa a biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">solicitações</a> (HTTP para pessoas).  Sua documentação pode ser usada como uma folha de dicas e testes de débito estendidos </li><li>  Suporte para Python - eu gosto da linguagem </li><li>  O parágrafo anterior fornece uma plataforma cruzada para a execução de testes </li><li>  Servidor Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Flask</a> próprio para exibição dos resultados dos testes </li></ul><br>  Dos menos: <br><br><ul><li>  Sem captura e repetição - todas as mãos </li><li>  O resultado do parágrafo anterior - você precisa de um cérebro.  Como no Postman, você precisa entender como o HTTP funciona. </li><li>  Necessidades mínimas de programação necessárias </li><li>  Modelo de carga linear - que incomoda imediatamente os fãs para gerar usuários "de acordo com Gauss" </li></ul><br><h2>  Processo de teste </h2><br>  Qualquer teste é uma tarefa complexa que requer planejamento, preparação, monitoramento da implementação e análise de resultados.  Durante o teste de estresse, se possível, é possível e necessário coletar todos os dados possíveis que podem afetar o resultado: <br><br><ul><li>  Hardware do servidor (CPU, RAM, ROM) </li><li>  Software de servidor (SO, versão do servidor, JAVA, .NET etc.), o banco de dados e a quantidade de dados em si, os logs do servidor e do aplicativo de teste </li><li>  Largura de banda da rede </li><li>  A presença de servidores proxy, balanceadores de carga e proteção DDOS </li><li>  Carregar dados de teste (número de usuários, tempo médio de resposta, número de solicitações por segundo) </li></ul><br>  Os exemplos descritos abaixo podem ser classificados como teste de carga funcional de caixa preta.  Mesmo sem saber nada sobre o aplicativo em teste e sem acesso aos logs, podemos medir seu desempenho. <br><br><h2>  Antes de começar </h2><br>  Para testar os testes de carga na prática, implantei um servidor Web localmente simples <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/typicode/json-server</a> .  Vou dar quase todos os exemplos a seguir para ele.  Tirei os dados do servidor de um exemplo online implantado - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://jsonplaceholder.typicode.com/</a> <br>  Para executá-lo, o nodeJS é necessário. <br><br>  <b>Spoiler óbvio</b> : como nos testes de segurança - é melhor realizar experimentos com testes de estresse em gatos localmente, sem carregar serviços on-line, para que você não seja banido <br><br>  Para começar, o Python também é necessário - em todos os exemplos, usarei a versão 3.6, bem como as próprias gafanhotos (no momento da redação, versão 0.9.0).  Pode ser instalado com o comando <br><br><pre><code class="bash hljs">python -m pip install locustio</code> </pre> <br>  Os detalhes da instalação podem ser encontrados na documentação oficial. <br><br><h2>  Analisando um Exemplo </h2><br>  Em seguida, precisamos de um arquivo de teste.  Peguei um exemplo da documentação, pois é muito simples e direto: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.post(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.post(<span class="hljs-string"><span class="hljs-string">"/logout"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> l.client.get(<span class="hljs-string"><span class="hljs-string">"/profile"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> tasks = {index: <span class="hljs-number"><span class="hljs-number">2</span></span>, profile: <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> login(self) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> logout(self) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">5000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">9000</span></span></code> </pre> <br>  Isso é tudo!  Isso é realmente o suficiente para iniciar o teste!  Vejamos um exemplo antes de começarmos. <br><br>  Ignorando as importações, no início, vemos duas funções quase idênticas de login e logout, consistindo em uma linha.  <b>l.client</b> - um objeto de sessão HTTP com o qual criaremos uma carga.  Usamos o método POST, que é quase idêntico ao da biblioteca de solicitações.  Quase - porque neste exemplo, estamos passando como o primeiro argumento, não um URL completo, mas apenas parte dele - um serviço específico. <br><br>  O segundo argumento passa os dados - e não posso deixar de notar que é muito conveniente usar dicionários Python, que são automaticamente convertidos em json <br><br>  Você também pode observar que não processamos o resultado da solicitação de forma alguma - se for bem-sucedida, os resultados (por exemplo, cookies) serão salvos nesta sessão.  Se ocorrer um erro, ele será gravado e adicionado às estatísticas sobre a carga. <br><br>  Se quisermos saber se escrevemos a solicitação corretamente, sempre podemos verificar da seguinte forma: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> r response=r.post(base_url+<span class="hljs-string"><span class="hljs-string">"/login"</span></span>,{<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>,<span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) print(response.status_code)</code> </pre> <br>  Eu adicionei apenas a variável <b>base_url</b> , que deve conter o endereço completo do recurso que está sendo testado. <br><br>  As próximas funções são consultas, que criarão uma carga.  Novamente, não precisamos processar a resposta do servidor - os resultados irão imediatamente para as estatísticas. <br><br>  A seguir é a classe <b>UserBehavior</b> (o nome da classe pode ser qualquer um).  Como o nome indica, ele descreverá o comportamento de um usuário esférico no vácuo do aplicativo em teste.  Passamos para a propriedade de <b>tarefas</b> um dicionário de métodos que o usuário chamará e sua frequência de chamadas.  Agora, apesar de não sabermos qual função e em que ordem cada usuário chamará - eles são selecionados aleatoriamente, garantimos que a função de <b>índice</b> seja chamada em média 2 vezes mais frequentemente que a função de <b>perfil</b> . <br><br>  Além do comportamento, a classe pai TaskSet permite especificar 4 funções que podem ser executadas antes e depois dos testes.  A ordem das chamadas será a seguinte: <br><br><ol><li>  <b>setup</b> - é chamado 1 vez no início do <b>UserBehavior (TaskSet)</b> - não está no exemplo </li><li>  <b>on_start</b> - chamado 1 vez por cada novo usuário da carga na inicialização </li><li>  <b>tarefas</b> - execução das próprias tarefas </li><li>  <b>on_stop</b> - chamado uma vez por cada usuário quando o teste termina de funcionar </li><li>  <b>desmontagem</b> - é chamado uma vez quando o <b>TaskSet</b> sai - também não está no exemplo </li></ol><br>  Vale ressaltar aqui que existem 2 maneiras de declarar o comportamento do usuário: o primeiro já está indicado no exemplo acima - as funções são anunciadas antecipadamente.  A segunda maneira é declarar métodos diretamente dentro da classe <b>UserBehavior</b> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.post(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.post(<span class="hljs-string"><span class="hljs-string">"/logout"</span></span>, {<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ellen_key"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"education"</span></span>}) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/profile"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">5000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">9000</span></span></code> </pre> <br>  Neste exemplo, as funções do usuário e a frequência da chamada são definidas usando a anotação da <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">tarefa</a></b> .  Funcionalmente, nada mudou. <br><br>  A última classe do exemplo é <b>WebsiteUser</b> (o nome da classe pode ser qualquer um).  Nesta classe, definimos o modelo de comportamento do usuário <b>UserBehavior</b> *** +, bem como os tempos mínimo e máximo de espera entre as chamadas para tarefas individuais de cada usuário.  Para deixar mais claro, veja como visualizá-lo: <br><br><img src="https://habrastorage.org/webt/mv/ss/7j/mvss7jfvob_tufawwbx-41w6i8y.png"><br><br><h2>  Introdução </h2><br>  Execute o servidor, cujo desempenho iremos testar: <br><br><pre> <code class="bash hljs">json-server --watch sample_server/db.json</code> </pre> <br>  Também modificamos o arquivo de exemplo para que ele possa testar o serviço, remover o logon e logout, definir o comportamento do usuário: <br><br><ol><li>  Abra a página principal 1 vez no início dos trabalhos </li><li>  Obtenha uma lista de todas as postagens x2 </li><li>  Escreva um comentário no primeiro post x1 </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">posts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/posts"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">comment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> data = { <span class="hljs-string"><span class="hljs-string">"postId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"my comment"</span></span>, <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"test@user.habr"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"Author is cool. Some text. Hello world!"</span></span> } self.client.post(<span class="hljs-string"><span class="hljs-string">"/comments"</span></span>, data) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">1000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre><br>  Para iniciar no prompt de comando, execute o comando <br><br><pre> <code class="bash hljs">locust -f my_locust_file.py --host=http://localhost:3000</code> </pre> <br>  onde host é o endereço do recurso testado.  É a ele que os endereços dos serviços indicados no teste serão adicionados. <br><br>  Se não houver erros no teste, o servidor de carregamento será iniciado e estará disponível em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // localhost: 8089 /</a> <br><br><img src="https://habrastorage.org/webt/p9/km/lc/p9kmlc3hqgi3_gupjrvkhduhl2a.png"><br><br>  Como você pode ver, o servidor que testaremos é indicado aqui - é nesta URL que os endereços dos serviços do arquivo de teste serão adicionados. <br><br>  Também aqui podemos indicar o número de usuários para a carga e seu crescimento por segundo. <br>  No botão, iniciamos o carregamento! <br><br><img src="https://habrastorage.org/webt/di/d8/xt/did8xtea9mlpfzzxwlfq1lcofne.png"><br><br><h2>  Resultados </h2><br>  Após um certo tempo, paramos o teste e observamos os primeiros resultados: <br><br><ol><li>  Como esperado, cada um dos 10 usuários criados no início foi para a página principal </li><li>  A lista de postagens foi aberta em média duas vezes mais do que um comentário foi escrito </li><li>  Há um tempo de resposta médio e mediano para cada operação, o número de operações por segundo já é um dado útil, mesmo que agora o pegue e compare com o resultado esperado dos requisitos </li></ol><br>  Na segunda guia, você pode ver os gráficos de carga em tempo real.  Se o servidor travar a uma determinada carga ou se seu comportamento mudar, isso será imediatamente visível no gráfico. <br><br><img src="https://habrastorage.org/webt/qm/ym/pd/qmympdj2picpcms6mkdb7eonenu.png"><br><br>  Na terceira guia, você pode ver os erros - no meu caso, este é um erro do cliente.  Mas se o servidor retornar um erro 4XX ou 5XX, seu texto será escrito aqui <br>  Se ocorrer um erro no código do seu texto, ele cairá na guia Exceções.  Até agora, tenho o erro mais comum relacionado ao uso do comando print () no código - essa não é a melhor maneira de registrar :) <br><br>  Na última guia, você pode baixar todos os resultados dos testes no formato csv <br><br>  Esses resultados são relevantes?  Vamos descobrir.  Na maioria das vezes, os requisitos de desempenho (se houver algum) são mais ou menos assim: o tempo médio de carregamento da página (resposta do servidor) deve ser menor que N segundos com uma carga de M usuários.  Na verdade, não especificando o que os usuários devem fazer.  E eu gosto de gafanhotos por isso - ele cria a atividade de um número específico de usuários que executam aleatoriamente as ações esperadas que eles esperam dos usuários. <br><br>  Se precisarmos realizar uma referência - para medir o comportamento do sistema em diferentes cargas, podemos criar várias classes de comportamento e realizar vários testes em diferentes cargas. <br><br>  Isso é o suficiente para começar.  Se você gostou do artigo, pretendo escrever sobre: <br><br><ul><li>  cenários de teste complexos nos quais os resultados de uma etapa são usados ​​nas seguintes </li><li>  processamento de resposta do servidor, como  pode estar errado mesmo que o HTTP 200 OK tenha chegado </li><li>  dificuldades óbvias que podem ser encontradas e como contorná-las </li><li>  testando sem usar a interface do usuário </li><li>  teste de carga distribuída </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt430502/">https://habr.com/ru/post/pt430502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt430492/index.html">Stick de computação neural da Intel. Mente artificial em uma unidade flash USB - 2</a></li>
<li><a href="../pt430494/index.html">Monitor de Tráfego InfoWatch. À beira de bugs e recursos</a></li>
<li><a href="../pt430496/index.html">NB-IoT: como funciona? Parte 1</a></li>
<li><a href="../pt430498/index.html">Ignore o controle de conta de usuário (UAC) imitando diretórios confiáveis</a></li>
<li><a href="../pt430500/index.html">Evitando o caos da base de conhecimento corporativo: nossa experiência de confluência</a></li>
<li><a href="../pt430504/index.html">Métodos de pensamento júnior e racional</a></li>
<li><a href="../pt430506/index.html">Arte escura da ressurreição: como recuperar dados de mídia danificada</a></li>
<li><a href="../pt430508/index.html">DevOps: o que é realmente</a></li>
<li><a href="../pt430510/index.html">Como escrever um código que todos entenderão?</a></li>
<li><a href="../pt430512/index.html">Como vivem os freelancers: não trabalhe com clientes oniscientes e permita-se procrastinar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>