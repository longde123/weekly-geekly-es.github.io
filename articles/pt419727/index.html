<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üññüèæ üë®üèº‚Äçüé® üíÜüèΩ Harbor - um registro para cont√™ineres Docker prontos para uso üßîüèª üï∏Ô∏è üë©üèæ‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em 31 de julho, o CNCF anunciou a aceita√ß√£o de um novo projeto Open Source, descrito como um ‚Äúregistro de nuvem (nuvem nativa)‚Äù, em sua caixa de areia...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Harbor - um registro para cont√™ineres Docker prontos para uso</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/419727/">  Em 31 de julho, o CNCF <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">anunciou</a> a aceita√ß√£o de um novo projeto Open Source, descrito como um ‚Äúregistro de nuvem (nuvem nativa)‚Äù, em sua caixa de areia (ou seja, no est√°gio inicial de suporte), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Harbour</a> .  Em seu site, eles nos explicam que o produto foi criado para gerenciar imagens de cont√™ineres do Docker em um ambiente seguro. <br><br><img src="https://habrastorage.org/webt/to/ed/6i/toed6ijlvl_n0r90t6rgvmzbixa.png"><br><br>  Parece que j√° existe um Docker Registry (ou, digamos, Quay do CoreOS), mas √© √≥bvio que novas solu√ß√µes n√£o aparecem e n√£o amadurecem para aplicativos de produ√ß√£o exatamente assim - especialmente solu√ß√µes de c√≥digo aberto ... e, mais ainda, caindo em CNCF.  Este artigo de revis√£o destina-se a esclarecer as raz√µes da apar√™ncia do Harbour, seus principais recursos e caracter√≠sticas. <a name="habracut"></a><br><br><h2>  Primeiro foco da Harbour: rede e empresa </h2><br>  A hist√≥ria do projeto come√ßa em 2016, em mar√ßo do qual ocorreu o primeiro lan√ßamento p√∫blico - 0.1.0.  Por tr√°s de sua cria√ß√£o, estavam os engenheiros da <b>VMware</b> que descreveram o projeto como um "servidor de registro de classe empresarial", que, com base no desenvolvimento do Docker, "expande os recursos do Docker Registry, adicionando mais recursos, normalmente exigidos pela empresa". <br><br>  Naquela √©poca, a √™nfase estava mais na possibilidade de usar esse registro na empresa, em particular, potencialmente melhorar a produtividade armazenando imagens na rede corporativa: ‚Äú[Harbor] √© muito √∫til para usu√°rios de cont√™ineres que n√£o possuem uma boa conex√£o com a Internet.  Por exemplo, o Harbor aumenta a produtividade dos desenvolvedores chineses, eliminando a dificuldade de baixar imagens da Internet p√∫blica ‚Äù <i>(do <a href="">README ao Harbor 0.1.0</a> )</i> . <br><br>  <i><b>Nota</b> : A orienta√ß√£o da Harbor para a China, confirmada pela presen√ßa de localiza√ß√£o adequada desde os primeiros lan√ßamentos, n√£o foi acidental: a cria√ß√£o do projeto foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">iniciada pela</a> divis√£o chinesa da empresa (VMware China R&amp;D).</i> <br><br>  O que se tornou uma ocorr√™ncia di√°ria para o ecossistema nativo da nuvem, o Harbor foi <b>escrito no idioma Go</b> desde o in√≠cio e licenciado sob os termos da Apache License 2.0.  Se falarmos sobre os recursos funcionais do projeto, no primeiro lan√ßamento os autores estabeleceram alguns recursos relevantes para este dia, como: <br><br><ul><li>  controle de acesso baseado em <b>fun√ß√£o</b> ( <b>RBAC</b> , que permite organizar usu√°rios e reposit√≥rios na forma de "projetos" e conceder direitos diferentes √†s imagens dentro desses projetos), al√©m de suporte a LDAP e AD para autentica√ß√£o do usu√°rio; </li><li>  <b>Interface de usu√°rio baseada na Web</b> para visualizar reposit√≥rios, pesquisando-os, gerenciando projetos; </li><li>  <b>auditoria de</b> todas as opera√ß√µes; </li><li>  <b>API REST</b> para gerenciamento. </li></ul><br><img src="https://habrastorage.org/webt/jj/jw/gx/jjjwgxrboqn0rq3tpcut7_ydbqc.png"><br>  <i>Gerenciamento de projetos no Harbor Web UI</i> <br><br><h2>  Harbor Evolution: Seguran√ßa </h2><br>  Em 2017, a VMware encontrou um aplicativo l√≥gico para seu novo projeto - integra√ß√£o com outras solu√ß√µes da empresa para cont√™ineres.  Em particular, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>vSphere Integrated Containers</b></a> (VIC), que, n√£o sendo um PaaS (Plataforma como Servi√ßo) ou CaaS (Containers como Servi√ßo), estava desenvolvendo ativamente, oferecia algum tipo de base para trabalhar com cont√™ineres.  Hoje, por exemplo, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vSphere Integrated Containers Engine</a> , que √© o tempo de execu√ß√£o do cont√™iner do vSphere, cresceu a partir deles.  E aqui est√° como o engenheiro de solu√ß√µes VMware (Nate Reid) descreveu a VIC naquele momento: <br><br><blockquote>  <i>‚ÄúA VIC pega a estrutura de um √∫nico host Docker e a dimensiona para v√°rios hosts ESXi.</i>  <i>Sua arquitetura proposta para orquestra√ß√£o √© semelhante a Swarm, Kubernetes (K8s) e Mesos.</i>  <i>No entanto, existem algumas nuances e n√£o h√° tarefa de substituir todos esses produtos.</i>  <i>A VIC fornece uma rede para cont√™ineres, permite que voc√™ obtenha seus nomes, oferece RBAC, um painel de controle HTML5 (Admiral; leia mais sobre isso em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nossa revis√£o da GUI do Docker</a> - <b>aprox. Transl.</b> ), Um registro de n√≠vel corporativo (Harbor), muitos comandos semelhantes do Docker, Integra√ß√£o com ferramentas vSphere.</i>  <i>[..]</i> <i><br><br></i>  <i>Se voc√™ precisar do suporte √† orquestra√ß√£o Kubernetes e / ou dos recursos de CI / CD baseados em VMware IaaS da VMware, verifique o VMware PKS e / ou o Pivotal Cloud Foundry.</i>  <i>Essas j√° s√£o solu√ß√µes CaaS e PaaS. ‚Äù</i> </blockquote><br>  Ao mesmo tempo, a quest√£o da <b>seguran√ßa das imagens do Docker</b> est√° se tornando cada vez mais relevante.  No in√≠cio de 2018, os engenheiros da empresa irm√£ da Pivotal para a VMware <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">citam</a> um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estudo</a> segundo o qual mesmo as vers√µes mais recentes de imagens postadas no Docker Hub (da comunidade e do oficial) cont√™m in√∫meras vulnerabilidades (uma m√©dia de 70 por imagem). <br><br>  Foi ent√£o que a Harbor apareceu com sua nova miss√£o orientada para a seguran√ßa, e j√° no ‚Äúsolo‚Äù acima mencionado do CaaS - no <b>Pivotal Container Service (PKS)</b> : <br><br><blockquote>  <i>‚ÄúEsse [vulnerabilidades e outros problemas de seguran√ßa nas imagens do Docker] √© a raz√£o pela qual inclu√≠mos tantos complementos √∫teis que tornam o PKS confi√°vel e seguro!‚Äù</i>  <i>[..]</i> <i><br><br></i>  <i>Como o Kubernetes sozinho n√£o lida com esses problemas [gerenciamento seguro de imagem], trabalhamos com os amigos da VMware para incluir o Harbor no PKS. ‚Äù</i> </blockquote><br>  O que √© t√£o seguro adicionado ao Harbor (al√©m do RBAC e da auditoria j√° implementada no projeto)?  Duas dire√ß√µes principais s√£o indicadas: <br><br><ol><li>  <b>Verifica√ß√£o de vulnerabilidade</b>  Para fazer isso, o Harbor implementa o CVE a partir de bancos de dados conhecidos (NIST NVD, Ubuntu CVE Tracker, Red Hat Security Data, etc.) e verifica automaticamente cada imagem de cont√™iner em busca de sua presen√ßa ao executar opera√ß√µes de push e pull.  Se uma vulnerabilidade for encontrada, as opera√ß√µes ser√£o canceladas dependendo das configura√ß√µes de seguran√ßa e a pr√≥pria imagem ser√° marcada, o que ficar√° vis√≠vel para o administrador do registro.  Para aproveitar essa oportunidade, Harbour se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">integra</a> ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Clair</b></a> do CoreOS. </li><li>  <b>A assinatura das imagens</b> .  Ele tamb√©m usa as conquistas de outro projeto - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Not√°rio</b></a> <i>(mencionamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste artigo</a> )</i> , que faz uma assinatura ao enviar imagens e depois valida essas assinaturas a cada solicita√ß√£o. </li></ol><br>  A aplica√ß√£o geral do Harbor no PKS √© a seguinte: <br><br><img src="https://habrastorage.org/webt/va/2s/cz/va2sczdfs6gzhomzofl4gb3mioi.png"><br><br><h2>  Porto hoje </h2><br>  Portanto, oferecendo um registro de imagens de cont√™iner para uso local e fornecendo seguran√ßa em v√°rios aspectos do trabalho com eles, hoje o Harbor evoluiu para a seguinte arquitetura, que aparentemente combina fun√ß√µes de outros projetos de c√≥digo aberto: <br><br><img src="https://habrastorage.org/webt/5w/5i/lx/5w5ilxohbp2zf-6l5suz8fdieec.png"><br><br>  Al√©m do j√° mencionado Docker Registry, Clair e Notary, que implementam os principais recursos do Harbor, voc√™ tamb√©m pode ver dois DBMSs nesse esquema: <br><br><ol><li>  PostgreSQL ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">anteriormente</a> MySQL / MariaDB estava aqui), que √© usado para armazenar metadados sobre projetos, usu√°rios e seus pap√©is, imagens; </li><li>  Redis - para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">armazenar sess√µes</a> . </li></ol><br><img src="https://habrastorage.org/webt/gt/zm/lx/gtzmlxpeuwevt1bugxmhqa4s2h4.jpeg"><br>  <i>Bancos de dados em Harbour Architecture</i> <br><br>  Voc√™ tamb√©m pode <i>encontrar alguns detalhes</i> sobre o dispositivo interno geral do Harbor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nesta p√°gina wiki</a> , que est√° vinculada √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o oficial do</a> projeto <i>(no entanto, h√° uma suspeita de que alguns detalhes da arquitetura possam estar desatualizados em alguns lugares)</i> .  L√° voc√™ tamb√©m pode encontrar links para instru√ß√µes de <a href="">instala√ß√£o do Harbor</a> e sua <a href="">implanta√ß√£o no Kubernetes</a> .  Este √∫ltimo, no entanto, √© declarado obsoleto (com base em vers√µes mais antigas, n√£o suporta Clair e Notary) e, em vez disso, prop√µe-se usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Helm-chart</a> . <br><br>  A vers√£o atual do Harbor √© a <a href="">v1.5.2</a> , lan√ßada no final de julho.  Os requisitos para a m√°quina Linux na qual a vers√£o mais recente do registro est√° instalada s√£o o Docker vers√£o 17.03.0-ce (ou superior) e o Docker Compose 1.10.0+, al√©m de Python e OpenSSL. <br><br>  <b>O suporte para gr√°ficos Helm</b> parece uma inova√ß√£o muito interessante para a vers√£o futura do Harbor (a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v1.6.0-rc1</a> j√° foi lan√ßada): ‚ÄúO Harbor, a partir da vers√£o 1.6.0, se tornar√° um registro nativo da nuvem composto que suportar√° o gerenciamento de imagens e o gerenciamento de gr√°ficos‚Äù .  Outros <a href="">planos de desenvolvimento</a> incluem o suporte do OAuth 2.0 para autentica√ß√£o do usu√°rio, a capacidade de implantar em v√°rios sites para toler√¢ncia a falhas e balanceamento de carga, coletando estat√≠sticas em reposit√≥rios e um utilit√°rio para migrar para o Harbor. <br><br><h2>  Em vez de uma conclus√£o </h2><br>  Harbor √© um exemplo de um projeto bem-sucedido do mundo moderno da nuvem, que conseguiu encontrar seu nicho e se estabelecer, integrando os recursos de outras ferramentas de c√≥digo aberto.  A evid√™ncia de seu sucesso n√£o √© apenas a inclus√£o do CNCF na lista de projetos, mas tamb√©m mais de 5.000 estrelas no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> e uma comunidade bastante ativa de desenvolvedores. <br><br><h2>  PS </h2><br>  Leia tamb√©m em nosso blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Guia do CNCF para solu√ß√µes de c√≥digo aberto (e mais) para nativos da nuvem</a> "; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OPA e SPIFFE - Dois novos projetos no CNCF para seguran√ßa de aplicativos em nuvem</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Quatro vers√µes do CNCF 1.0 e principais an√∫ncios sobre o Kubernetes com o KubeCon 2017</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gerenciador de Pacotes para Kubernetes - Elmo: Passado, Presente, Futuro</a> ‚Äù; </li><li>  "O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CNCF ofereceu uma nuvem gratuita para projetos de c√≥digo aberto para DevOps / microsservi√ßos</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estat√≠sticas sobre sistemas operacionais b√°sicos em imagens no Docker Hub</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt419727/">https://habr.com/ru/post/pt419727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt419715/index.html">Voc√™ n√£o sabe trabalhar com transa√ß√µes</a></li>
<li><a href="../pt419717/index.html">Projetando uma arquitetura de aplicativo incorporado</a></li>
<li><a href="../pt419719/index.html">[bookmark] 23 recomenda√ß√µes para proteger aplicativos Node.js.</a></li>
<li><a href="../pt419721/index.html">Biomarcadores de envelhecimento. Fragilidade do painel. Parte 1</a></li>
<li><a href="../pt419725/index.html">Dardos, dados e moedas: algoritmos de distribui√ß√£o discreta</a></li>
<li><a href="../pt419729/index.html">Evento de caridade ‚ÄúD√™ asas √†s crian√ßas‚Äù</a></li>
<li><a href="../pt419731/index.html">Mini-revis√£o da impressora 3D de fotopol√≠mero dent√°rio MoonRay S</a></li>
<li><a href="../pt419733/index.html">Git acontece! 6 erros comuns do Git e como corrigi-los</a></li>
<li><a href="../pt419735/index.html">Examinando o sinal I / Q com SDR usando o Adobe Audition</a></li>
<li><a href="../pt419743/index.html">O que h√° de errado com artigos populares dizendo que foo √© mais r√°pido que o bar?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>