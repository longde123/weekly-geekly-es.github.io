<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>   Smart Home: control por voz en tres pasos. Frambuesa + HomeKit げ  叼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Queridos amigos! 

 Decidimos compartir con ustedes una soluci贸n preparada de presupuesto, esperamos que aprecie nuestros esfuerzos. La soluci贸n est谩 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart Home: control por voz en tres pasos. Frambuesa + HomeKit</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476540/">  Queridos amigos! <br><br>  Decidimos compartir con ustedes una soluci贸n preparada de presupuesto, esperamos que aprecie nuestros esfuerzos.  La soluci贸n est谩 probada, funcionando.  En el archivo adjunto, puede descargar todos los archivos y configuraciones del programa.  Damos todo gratis. <br><br>  Una casa inteligente para el cliente es b谩sicamente un "juguete" que puedes presumir ante tus amigos, 隆pero estos juegos no valen la pena los peque帽os esfuerzos de los integradores! <br><br>  Se tratar谩 de algunos problemas y soluciones relacionadas espec铆ficamente con la iluminaci贸n de la casa, como una unidad integral de la "casa inteligente". <br><br>  <b>Problema 1:</b> Si el sistema est谩 centralizado, entonces, en caso de falla del controlador central, el programa no puede controlar el rel茅 de luz. <br><br>  <b>Soluci贸n</b> : utilice m贸dulos de control distribuido con l贸gica interna, en nuestra experiencia uno de los dispositivos m谩s probados en esto es el rel茅 programable PR200 fabricado por OWEN.  Recomendamos usar la versi贸n 220v, como  los interruptores dom茅sticos est谩n dise帽ados espec铆ficamente para este voltaje y habr谩 menos problemas con la "unidad" l贸gica en la entrada digital. <br><br><img src="https://sun9-34.userapi.com/c858324/v858324590/e2770/z4ovfGWcOog.jpg" alt="imagen"><br><br>  Este dispositivo tiene 8 canales (rel茅s) que se pueden programar utilizando l贸gica interna (como un sistema distribuido), adem谩s se conectan m贸dulos de expansi贸n adicionales de 2 piezas.  8 canales cada uno, pero existe el riesgo de quedarse sin m谩s luminarias controladas cuando el PR200 falla (8 canales versus 24), si planea ahorrar, 隆piense! <br><br><img src="https://sun9-24.userapi.com/c858324/v858324590/e2781/5Bbfamak_2o.jpg" alt="imagen"><br><br>  A pesar del hecho de que el programa parece simple, fuimos a 茅l durante varios a帽os sin culpa nuestra, la compa帽铆a Aries relativamente recientemente (despu茅s de la aparici贸n de PR200) agreg贸 la capacidad de administrar una variable de red tanto desde el exterior como desde el interior. <br><a name="habracut"></a><br>  M谩s sobre el programa: <br><br>  I8 es una entrada digital con 8 interruptores en una casa o habitaci贸n <br><br>  RTRIG - detector frontal, necesario para la formaci贸n de un solo impulso (por ciclo de programa) <br><br>  TO INT: se podr铆a prescindir de la conversi贸n de Bool a INT, pero la variable de red Slave en Owen Logic no admite bool. <br><br>  XOR: exclusivo o, si est谩 en una entrada 1, luego la salida 1, si ambas entradas aplican 1, la salida se restablecer谩, el elemento principal del programa que decide encender o apagar la luz presionando el interruptor. <br><br>  Relay8 es una variable de red de entrada y salida, como dije anteriormente, recientemente podemos usar estas dos variables con un registro Modbus (direcci贸n), esto nos permite guardar el estado necesario tanto en el exterior como en el interior sin usar diferentes disparadores.  Estas variables de red tienen memoria no vol谩til, por lo que cuando salta el voltaje, la iluminaci贸n volver谩 a su 煤ltimo estado. <br><br>  TO BOOL: convierte el valor INT a BOOL, porque el rel茅 de salida tiene el estado Falso / Verdadero. <br><br>  <b>Paso 1</b> : el programa para 8 canales se puede descargar desde el enlace al final del art铆culo y cargarlo en un rel茅 programable, no olvide cambiar la plataforma de destino para su versi贸n de PR200 / 110, de lo contrario, el dispositivo no parpadear谩. <br><br>  <b>Problema 2:</b> los interruptores dom茅sticos est谩ndar tienen el estado activado o desactivado, lo que contradice fundamentalmente la l贸gica del control de la iluminaci贸n en una casa inteligente, necesitamos botones sin fijar (con resortes). <br><br>  <b>Soluci贸n 1:</b> use botones listos para usar sin fijar, que est谩n disponibles para la mayor铆a de los fabricantes de interruptores como Shneider, Biticino, ABB, etc. (soluci贸n recomendada, aunque los botones est茅n en la misma posici贸n y las luces encendidas y apagadas, se ve est茅ticamente hermosa) <br><br>  <b>Soluci贸n 2:</b> Capture PR200 / 110 un cambio en el estado de entrada cuando use un interruptor dom茅stico t铆pico con un pestillo y luego env铆e un impulso al programa que se descarg贸 anteriormente, si la luz estaba encendida, se apagar谩 y viceversa (no recomendado, porque despu茅s de un tiempo todos los botones estar谩n apagados mezclado arriba y abajo) <br><br>  <b>Problema 3: el</b> nivel superior de la mayor铆a de los fabricantes de sistemas dom茅sticos inteligentes no alcanza la perfecci贸n est茅tica y funcional. <br><br>  Soluci贸n: utilizamos HomeKit de Apple, que: es funcional, conveniente y tiene control por voz. <br><br>  <b>Paso 2:</b> acople PR200 / 110 con HomeKit <br><br>  Para hacer esto, se requieren las siguientes herramientas: <br><br>  Soluci贸n recomendada para demostraciones: <br><br>  Raspberry Pi 2/3/4 y al convertidor usb rs485 (por ejemplo, con Alliexpress) <br><br><img src="https://sun9-44.userapi.com/c858324/v858324590/e283a/4-udUu3_Ycg.jpg" alt="imagen"><br><br>  La soluci贸n recomendada para instalaciones basadas en el m贸dulo Raspberry CM3 + en dise帽o industrial con 2 dos puertos RS485 incorporados: <br><br><img src="https://antexcloud.ru/wp-content/uploads/AntexGate-.jpg" alt="imagen"><br><br>  Conecte su dispositivo basado en Raspberry a la red el茅ctrica y dom茅stica, preferiblemente con un cable de conexi贸n, y no a trav茅s de wifi. <br><br>  Conecte el puerto RS485 de su dispositivo y el PR200 / 110. <br><br>  Luego, determine la direcci贸n IP que emiti贸 su enrutador y con茅ctese a trav茅s de SSh, por ejemplo, a trav茅s del programa PUTTY (de forma predeterminada, el nombre de usuario es pi password raspberry) <br><br>  Instale el software de nodo rojo para acoplar el protocolo HomeKit en el nivel superior y Modbus Rtu en el nivel inferior, consulte las instrucciones de instalaci贸n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu铆</a> . <br><br>  No olvide hacer su servicio de nodo rojo para el inicio. <br><br>  Instale HomeKit y el paquete modbus para node-red <br><br><pre><code class="plaintext hljs">cd ~/.node-red npm install node-red-contrib-homekit npm install node-red-contrib-modbus sudo reboot</code> </pre> <br>  Estamos esperando el reinicio y vamos al navegador "SU IP": 1880 (por ejemplo, 192.168.1.110:1880) <br><br>  Copiamos la siguiente secuencia (el c贸digo al final del art铆culo) y pegamos el motor de reglas de nodo rojo en la interfaz web <br><br>  Vaya a Men煤 -&gt; importar -&gt; insertar c贸digo de transmisi贸n <br><br><img src="https://sun9-62.userapi.com/c858324/v858324590/e27d5/gX_NP9Tcut0.jpg" alt="imagen"><br><br><img src="https://sun9-62.userapi.com/c858324/v858324590/e27dc/sW2lIvuLXFk.jpg" alt="imagen"><br><br><img src="https://sun9-14.userapi.com/c858324/v858324590/e27ed/2YlXvhSyAvE.jpg" alt="imagen"><br><br>  Debe aplicar la secuencia haciendo clic en el bot贸n Implementar <br><br>  En caso de falla, le recomendamos que especifique correctamente el puerto RS485 en la configuraci贸n Modbus de los complementos "Modbas Request" y "Write Reset FC6" (ejemplo / dev / ttyUSB0). <br><br>  Para mayor autenticidad, reinicie su dispositivo SSH para reiniciar sudo <br><br>  <b>Paso 3</b>  Configurar la aplicaci贸n en su dispositivo Apple es bastante simple. <br><br><img src="https://sun9-11.userapi.com/c858324/v858324590/e281c/tWFcJA_7AW8.jpg" alt="imagen"><br><br>  D茅le un nombre a nuestra casa a voluntad, en nuestro ejemplo PR200 <br><br><img src="https://sun9-25.userapi.com/c858324/v858324590/e2868/21MYun_Ww10.jpg" alt="imagen"><br><br>  Agregar y aceptar usar un accesorio no certificado <br><br><img src="https://sun9-50.userapi.com/c858324/v858324590/e286f/N0JIhEZyKY8.jpg" alt="imagen"><br><br>  Ingresamos el c贸digo de acceso, en nuestro caso 111 11 111, se puede reemplazar en la configuraci贸n de Nodo-rojo en cada uno de los accesorios de HomeKit <br><br><img src="https://sun9-18.userapi.com/c858324/v858324590/e2880/Yx0gxJ739i8.jpg" alt="imagen"><br><br>  Agregamos todas nuestras l谩mparas a las habitaciones, esto se puede hacer m谩s tarde. <br><br>  Le deseamos un uso agradable de un sistema tan econ贸mico pero muy conveniente. <br><br>  Atenci贸n: <br><br>  隆No agitamos el uso comercial del protocolo HomeKit, el desarrollador asume cualquier acci贸n contraria al acuerdo de licencia de APPLE para el uso del protocolo HomeKit! <br><br>  El programa para ARIES PR200 y el script para NodeRed se pueden descargar de forma gratuita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu铆</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/476540/">https://habr.com/ru/post/476540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../476526/index.html">Slurm Basic en Mosc煤. D铆a uno. Una descarga de SocaCola, el micr贸fono fue quitado del presentador y el soporte est谩 esperando</a></li>
<li><a href="../476528/index.html">Arquitecto de software Nuevo curso de OTUS</a></li>
<li><a href="../476532/index.html">Patrones b谩sicos de UI / UX</a></li>
<li><a href="../476534/index.html">C贸mo construir una contabilidad de gesti贸n efectiva y obtener superganancias</a></li>
<li><a href="../476538/index.html">Protocolos de distribuci贸n de claves criptogr谩ficas asim茅tricas: Denning - Sacco, DASS, Wu Lama</a></li>
<li><a href="../476546/index.html">Streaming de WebRTC en la nube en DigitalOcean</a></li>
<li><a href="../476548/index.html">驴Qu茅 tienen en com煤n el overclocking y la reducci贸n de tama帽o?</a></li>
<li><a href="../476550/index.html">Slurm Basic en Mosc煤. D铆a dos Mizaru, Kikazaru, Iwazaru y el soporte t茅cnico siempre est谩n de servicio.</a></li>
<li><a href="../476554/index.html">Transmisi贸n webRTC basada en la nube en DigitalOcean</a></li>
<li><a href="../476556/index.html">Narrativa y "mazmorras": c贸mo un dise帽ador de juegos asocia las ubicaciones con una trama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>