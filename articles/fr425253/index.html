<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíø üë®üèº‚Äçüíª üë©üèª‚Äçüç≥ Nous faisons un projet d'apprentissage automatique en Python. Partie 1 üë©üèø‚Äçüç≥ „äôÔ∏è üå¨Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Traduction d' une visite guid√©e compl√®te d'un projet d'apprentissage automatique en Python: premi√®re partie . 

 Lorsque vous lisez un livre ou √©coute...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous faisons un projet d'apprentissage automatique en Python. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/425253/"><img src="https://habrastorage.org/getpro/habr/post_images/5de/fed/62e/5defed62ea348f6e02365e283415b2fb.png"><br><br>  <i>Traduction d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une visite guid√©e compl√®te d'un projet d'apprentissage automatique en Python: premi√®re partie</a> .</i> <br><br>  Lorsque vous lisez un livre ou √©coutez un cours de formation sur l'analyse des donn√©es, vous avez souvent l'impression que vous √™tes face √† des parties distinctes d'une image qui ne peuvent pas √™tre assembl√©es.  Vous pouvez √™tre effray√© par la perspective de passer √† l'√©tape suivante et de r√©soudre compl√®tement un probl√®me √† l'aide de l'apprentissage automatique, mais avec l'aide de cette s√©rie d'articles, vous gagnerez en confiance dans la capacit√© de r√©soudre tout probl√®me dans le domaine de la science des donn√©es. <br><br>  Afin que vous ayez enfin une image compl√®te dans votre t√™te, nous vous sugg√©rons d'analyser du d√©but √† la fin le projet d'utilisation du machine learning en utilisant des donn√©es r√©elles. <br><a name="habracut"></a><br>  Suivez successivement les √©tapes: <br><br><ol><li>  Nettoyage et formatage des donn√©es. </li><li>  Analyse exploratoire des donn√©es. </li><li>  Conception et s√©lection de fonctionnalit√©s. </li><li>  Comparaison des m√©triques de plusieurs mod√®les d'apprentissage automatique. </li><li>  R√©glage hyperparam√©trique du meilleur mod√®le. </li><li>  √âvaluation du meilleur mod√®le sur un ensemble de donn√©es de test. </li><li>  Interpr√©tation des r√©sultats du mod√®le. </li><li>  Conclusions et travail avec des documents. </li></ol><br>  Vous apprendrez comment les √©tapes s'encha√Ænent et comment les impl√©menter en Python.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'ensemble du projet</a> est disponible sur GitHub, la premi√®re partie se trouve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici.</a>  Dans cet article, nous consid√©rerons les trois premi√®res √©tapes. <br><br><h2>  Description de la t√¢che </h2><br>  Avant d'√©crire du code, vous devez comprendre le probl√®me r√©solu et les donn√©es disponibles.  Dans ce projet, nous travaillerons avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des donn√©es d'efficacit√© √©nerg√©tique</a> accessibles au public <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pour les b√¢timents</a> de New York. <br><br>  Notre objectif: utiliser les donn√©es disponibles pour construire un mod√®le qui pr√©dit le nombre de Energy Star Score pour un b√¢timent particulier, et interpr√©ter les r√©sultats pour trouver des facteurs qui influencent le score final. <br><br>  Les donn√©es incluent d√©j√† le score Energy Star attribu√©, notre t√¢che est donc l'apprentissage automatique avec r√©gression contr√¥l√©e: <br><br><ul><li>  Supervis√©: Nous connaissons les signes et le but, et notre t√¢che est de former un mod√®le qui peut comparer le premier avec le second. </li><li>  R√©gression: le score Energy Star est une variable continue. </li></ul><br>  Notre mod√®le doit √™tre pr√©cis - afin qu'il puisse pr√©dire la valeur du score Energy Star proche de la v√©rit√© - et interpr√©table - afin que nous puissions comprendre ses pr√©dictions.  Connaissant les donn√©es cibles, nous pouvons les utiliser pour prendre des d√©cisions √† mesure que nous approfondissons les donn√©es et cr√©ons le mod√®le. <br><br><h2>  Nettoyage des donn√©es </h2><br>  Tous les ensembles de donn√©es ne sont pas un ensemble d'observations parfaitement assorties, sans anomalies et valeurs manquantes (un indice des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">jeux de donn√©es mtcars</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">iris</a> ).  Dans les donn√©es r√©elles, il y a peu d'ordre, donc avant de commencer l'analyse, vous devez l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">effacer et la mettre</a> dans un format acceptable.  Le nettoyage des donn√©es est une proc√©dure d√©sagr√©able mais obligatoire pour r√©soudre la plupart des t√¢ches d'analyse des donn√©es. <br><br>  Tout d'abord, vous pouvez charger les donn√©es sous la forme d'une trame de donn√©es Pandas et les examiner: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np # <span class="hljs-keyword"><span class="hljs-keyword">Read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> a dataframe data = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/Energy_and_Water_Data_Disclosure_for_Local_Law_84_2017__Data_for_Calendar_Year_2016_.csv'</span></span>) # Display top <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> dataframe data.head()</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/4ac/637/b86/4ac637b8682b2fcacddd155004681a0d.png"><br>  <i>Voil√† √† quoi ressemblent les vraies donn√©es.</i> <br><br>  Ceci est un fragment d'un tableau de 60 colonnes.  M√™me ici, plusieurs probl√®mes sont visibles: nous devons pr√©dire le <code>Energy Star Score</code> , mais nous ne savons pas ce que signifient toutes ces colonnes.  Bien que ce ne soit pas n√©cessairement un probl√®me, car vous pouvez souvent cr√©er un mod√®le pr√©cis sans rien savoir des variables.  Mais l'interpr√©tabilit√© est importante pour nous, nous devons donc trouver la signification d'au moins quelques colonnes. <br><br>  Lorsque nous avons re√ßu ces donn√©es, nous n'avons pas pos√© de questions sur les valeurs, mais nous avons examin√© le nom du fichier: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a86/c00/ab2/a86c00ab2d64629e644e7186c78724f7.png"><br><br>  et a d√©cid√© de rechercher ¬´Local Law 84¬ª.  Nous avons trouv√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette page</a> , qui disait que nous parlons de la loi en vigueur √† New York, selon laquelle les propri√©taires de tous les b√¢timents d'une certaine taille devraient rendre compte de la consommation d'√©nergie.  Une recherche suppl√©mentaire a permis de trouver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">toutes les valeurs de colonne</a> .  Ne n√©gligez donc pas les noms de fichiers, ils peuvent √™tre un bon point de d√©part.  De plus, c'est un rappel que vous ne vous pr√©cipitez pas et ne manquez pas quelque chose d'important! <br><br>  Nous n'√©tudierons pas toutes les colonnes, mais nous traiterons certainement du score Energy Star, qui est d√©crit comme suit: <br><br><blockquote>  Le rang centile est compris entre 1 et 100, qui est calcul√© sur la base des rapports annuels sur la consommation d'√©nergie par les propri√©taires de b√¢timents eux-m√™mes.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le Energy Star Score</a> est une mesure relative utilis√©e pour comparer la performance √©nerg√©tique des b√¢timents. </blockquote><br>  Le premier probl√®me a √©t√© r√©solu, mais le second est rest√© - des valeurs manquantes, marqu√©es comme ¬´Non disponible¬ª.  Il s'agit d'une valeur de cha√Æne en Python, ce qui signifie que m√™me les cha√Ænes avec des nombres seront stock√©es en tant que types de donn√©es d' <code>object</code> , car s'il y a une cha√Æne dans la colonne, Pandas la convertit en une colonne enti√®rement constitu√©e de cha√Æne.  Les types de donn√©es de colonne peuvent √™tre trouv√©s en utilisant la m√©thode <code>dataframe.info()</code> : <br><br><pre> <code class="hljs pgsql"># See the <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> non-missing <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> data.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>()</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/db3/b4d/013/db3b4d013ca25d7e5ac483f0c24fa1e4.png"><br><br>  Certes, certaines colonnes qui contiennent explicitement des nombres (comme ft¬≤) sont stock√©es en tant qu'objets.  Nous ne pouvons pas appliquer l'analyse num√©rique aux valeurs de cha√Æne, nous les convertissons donc en types de donn√©es num√©riques (en particulier <code>float</code> )! <br><br>  Ce code remplace d'abord tous les ¬´Non disponibles¬ª par <i>pas un nombre</i> ( <code>np.nan</code> ), qui peut √™tre interpr√©t√© comme des nombres, puis convertit le contenu de certaines colonnes en un type <code>float</code> : <br><br><pre> <code class="hljs pgsql"># Replace <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> occurrences <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> Available <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> a number data = data.replace({<span class="hljs-string"><span class="hljs-string">'Not Available'</span></span>: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>}) # Iterate through the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> list(data.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>): # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> that should be <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'ft¬≤'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'kBtu'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'Metric Tons CO2e'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'kWh'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'therms'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'gal'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'Score'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col): # Convert the data <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> data[col] = data[col].astype(<span class="hljs-type"><span class="hljs-type">float</span></span>)</code> </pre> <br>  Lorsque les valeurs dans les colonnes correspondantes avec nous deviennent des nombres, nous pouvons commencer √† examiner les donn√©es. <br><br><h4>  Donn√©es manquantes et anormales </h4><br>  Outre les types de donn√©es incorrects, l'un des probl√®mes les plus courants est l'absence de valeurs.  Ils peuvent √™tre absents pour diverses raisons et avant de former le mod√®le, ces valeurs doivent √™tre remplies ou supprim√©es.  Tout d'abord, d√©couvrons combien de valeurs nous avons dans chaque colonne (le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code est ici</a> ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b0/5da/a40/0b05daa40ba77acca25ed859856759f2.png"><br>  <i>Pour cr√©er une table, une fonction d'une branche sur <u>StackOverflow a √©t√© utilis√©e</u> .</i> <br><br>  Les informations doivent toujours √™tre supprim√©es avec prudence, et s'il existe de nombreuses valeurs dans la colonne, cela ne profitera probablement pas √† notre mod√®le.  Le seuil apr√®s lequel il est pr√©f√©rable de jeter les colonnes d√©pend de votre t√¢che ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">voici une discussion</a> ), et dans notre projet, nous supprimerons les colonnes qui sont plus de la moiti√© vides. <br><br>  √Ä ce stade √©galement, il est pr√©f√©rable de supprimer les valeurs anormales.  Ils peuvent se produire en raison de fautes de frappe lors de la saisie de donn√©es ou en raison d'erreurs dans les unit√©s de mesure, ou ils peuvent √™tre corrects, mais des valeurs extr√™mes.  Dans ce cas, nous supprimerons les valeurs "extra", guid√©es par la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©finition des anomalies extr√™mes</a> : <br><br><ul><li>  Sous le premier quartile se trouve une plage interquartile de 3 ‚àó. </li><li>  Au-dessus du troisi√®me quartile + 3 ‚àó intervalle interquartile. </li></ul><br>  Le code qui supprime les colonnes et les anomalies est r√©pertori√© sur le Bloc-notes sur Github.  √Ä la fin du processus de nettoyage des donn√©es et de la suppression des anomalies, nous avons plus de 11 000 b√¢timents et 49 panneaux. <br><br><h2>  Analyse exploratoire des donn√©es </h2><br>  L'√©tape ennuyeuse mais n√©cessaire du nettoyage des donn√©es est termin√©e, vous pouvez aller √† l'√©tude!  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'analyse des donn√©es exploratoires</a> (RAD) est un processus √† dur√©e illimit√©e au cours duquel nous calculons des statistiques et recherchons des tendances, des anomalies, des mod√®les ou des relations dans les donn√©es. <br><br>  En bref, RAD est une tentative de comprendre ce que les donn√©es peuvent nous dire.  Habituellement, l'analyse commence par une revue superficielle, puis nous trouvons des fragments int√©ressants et les analysons plus en d√©tail.  Les r√©sultats peuvent √™tre int√©ressants en soi, ou ils peuvent contribuer au choix du mod√®le, aidant √† d√©cider quelles fonctionnalit√©s nous utiliserons. <br><br><h4>  Graphes √† variable unique </h4><br>  Notre objectif est de pr√©dire la valeur du score Energy Star (renomm√© notre <code>score</code> dans nos donn√©es), il est donc logique de commencer par examiner la distribution de cette variable.  Un histogramme est un moyen simple mais efficace de visualiser la distribution d'une seule variable, et il peut √™tre facilement construit √† l'aide de <code>matplotlib</code> . <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt # Histogram <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the Energy Star Score plt.style.use(<span class="hljs-string"><span class="hljs-string">'fivethirtyeight'</span></span>) plt.hist(data[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].dropna(), bins = <span class="hljs-number"><span class="hljs-number">100</span></span>, edgecolor = <span class="hljs-string"><span class="hljs-string">'k'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Score'</span></span>); plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Number of Buildings'</span></span>); plt.title(<span class="hljs-string"><span class="hljs-string">'Energy Star Score Distribution'</span></span>);</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/f82/bf3/84a/f82bf384af1bd0c407f1e680d0b47263.png"><br><br>  √áa a l'air suspect!  Le score Energy Star est un centile, vous devez donc vous attendre √† une distribution uniforme lorsque chaque point est attribu√© au m√™me nombre de b√¢timents.  Cependant, un nombre disproportionnellement √©lev√© de b√¢timents a obtenu les r√©sultats les plus √©lev√©s et les plus bas (pour le Energy Star Score, le plus grand est le mieux). <br><br>  Si nous regardons √† nouveau la d√©finition de ce score, nous verrons qu'il est calcul√© sur la base de ¬´rapports remplis ind√©pendamment par les propri√©taires d'immeubles¬ª, ce qui peut expliquer l'exc√®s de tr√®s grandes valeurs.  Demander aux propri√©taires de b√¢timents de d√©clarer leur consommation d'√©nergie, c'est comme demander aux √©tudiants de d√©clarer leurs notes aux examens.  Ce n'est donc peut-√™tre pas le crit√®re le plus objectif pour √©valuer l'efficacit√© √©nerg√©tique d'un bien immobilier. <br><br>  Si nous avions une quantit√© illimit√©e de temps, nous pourrions d√©couvrir pourquoi tant de b√¢timents ont obtenu des points tr√®s √©lev√©s et tr√®s bas.  Pour ce faire, il faudrait choisir les b√¢timents appropri√©s et les analyser soigneusement.  Mais nous devons seulement apprendre √† pr√©dire les scores et ne pas d√©velopper une m√©thode d'√©valuation plus pr√©cise.  Vous pouvez noter que les points ont une distribution suspecte, mais nous nous concentrerons sur les pr√©visions. <br><br><h4>  Recherche de relation </h4><br>  La partie principale de l'AHFR est la recherche de la relation entre les signes et notre objectif.  Les variables en corr√©lation avec lui sont utiles pour une utilisation dans le mod√®le, car elles peuvent √™tre utilis√©es pour la pr√©vision.  Une fa√ßon d'√©tudier l'effet d'une variable cat√©gorielle (qui ne prend qu'un ensemble limit√© de valeurs) sur l'objectif est de tracer la densit√© √† l'aide de la biblioth√®que Seaborn. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le graphique de densit√© peut √™tre consid√©r√© comme un histogramme liss√©</a> car il montre la distribution d'une seule variable.  Vous pouvez coloriser des classes individuelles sur le graphique pour voir comment une variable cat√©gorielle modifie la distribution.  Ce code trace le graphique de densit√© Energy Star Score, color√© selon le type de b√¢timent (pour une liste de b√¢timents de plus de 100 dimensions): <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> a list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> buildings <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> more than <span class="hljs-number"><span class="hljs-number">100</span></span> measurements <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = data.dropna(subset=[<span class="hljs-string"><span class="hljs-string">'score'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">types</span></span>[<span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>].value_counts() <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = list(<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) # Plot <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> distribution <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> scores <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building categories figsize(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) # Plot <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> building <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b_type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">types</span></span>: # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the building <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> subset = data[data[<span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>] == b_type] # Density plot <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> Energy Star Scores sns.kdeplot(subset[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].dropna(), label = b_type, shade = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.8</span></span>); # label the plot plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Energy Star Score'</span></span>, size = <span class="hljs-number"><span class="hljs-number">20</span></span>); plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Density'</span></span>, size = <span class="hljs-number"><span class="hljs-number">20</span></span>); plt.title(<span class="hljs-string"><span class="hljs-string">'Density Plot of Energy Star Scores by Building Type'</span></span>, size = <span class="hljs-number"><span class="hljs-number">28</span></span>);</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/23a/718/fd3/23a718fd3139123b609e2521ffe46e3c.png"><br><br>  Comme vous pouvez le voir, le type de b√¢timent affecte consid√©rablement le nombre de points.  Les immeubles de bureaux ont g√©n√©ralement un score plus √©lev√© et les h√¥tels plus bas.  Vous devez donc inclure le type de b√¢timent dans le mod√®le, car ce signe affecte notre objectif.  En tant que variable cat√©gorielle, nous devons effectuer un codage √† chaud du type de b√¢timent. <br><br>  Un graphique similaire peut √™tre utilis√© pour estimer le score Energy Star par quartier de ville: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/224/c69/820/224c69820a5c0362f804e37ae7d5de55.png"><br><br>  La zone n'affecte pas autant le score que le type de b√¢timent.  N√©anmoins, nous l'inclurons dans le mod√®le, car il existe une l√©g√®re diff√©rence entre les r√©gions. <br><br>  Pour calculer la relation entre les variables, vous pouvez utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le coefficient de corr√©lation de Pearson</a> .  Il s'agit d'une mesure de l'intensit√© et de la direction d'une relation lin√©aire entre deux variables.  Une valeur de +1 signifie une relation positive parfaitement lin√©aire et -1 signifie une relation n√©gative parfaitement lin√©aire.  Voici quelques exemples de valeurs de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">coefficient de corr√©lation</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pearson</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b3/455/654/0b34556548ab206112024fb0e8f69c01.png"><br><br>  Bien que ce coefficient ne puisse pas refl√©ter les d√©pendances non lin√©aires, il est possible de commencer par lui pour √©valuer les relations des variables.  Dans Pandas, vous pouvez facilement calculer les corr√©lations entre toutes les colonnes d'une trame de donn√©es: <br><br><pre> <code class="hljs pgsql"># Find <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> correlations <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the score <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> sort correlations_data = data.corr()[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].sort_values()</code> </pre> <br>  Les corr√©lations les plus n√©gatives avec l'objectif: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b62/181/178/b62181178669962fccf7caa472d9e2e8.png"><br><br>  et le plus positif: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/598/47f/14a/59847f14a4d8afe1ce8ff237c5d3fa36.png"><br><br>  Il existe plusieurs fortes corr√©lations n√©gatives entre les attributs et l'objectif, et les plus importants d'entre eux appartiennent √† diff√©rentes cat√©gories d'IUE (les m√©thodes de calcul de ces indicateurs diff√®rent l√©g√®rement).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">EUI (Energy Use Intensity</a> ) est la quantit√© d'√©nergie consomm√©e par un b√¢timent divis√©e par un pied carr√© de surface.  Cette valeur sp√©cifique est utilis√©e pour √©valuer l'efficacit√© √©nerg√©tique, et plus elle est petite, mieux c'est.  La logique sugg√®re que ces corr√©lations sont justifi√©es: si l'EUI augmente, alors le Energy Star Score devrait diminuer. <br><br><h4>  Graphiques √† deux variables </h4><br>  Nous utilisons des nuages ‚Äã‚Äãde points pour visualiser les relations entre deux variables continues.  Vous pouvez ajouter des informations suppl√©mentaires aux couleurs des points, par exemple une variable cat√©gorielle.  La relation entre l'Energy Star Score et l'IUE est illustr√©e ci-dessous, les couleurs indiquent diff√©rents types de b√¢timents: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/974/204/7de/9742047ded29c74a9a8e6df9bf6396d1.png"><br><br>  Ce graphique vous permet de visualiser un coefficient de corr√©lation de -0,7.  √Ä mesure que l'IUE diminue, le score Energy Star augmente, cette relation est observ√©e dans diff√©rents types de b√¢timents. <br><br>  Notre dernier tableau de recherche s'appelle le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">trac√© des paires</a> .  C'est un excellent outil pour voir les relations entre diff√©rentes paires de variables et la distribution de variables uniques.  Nous utiliserons la biblioth√®que Seaborn et la fonction PairGrid pour cr√©er un diagramme de paires avec un diagramme de dispersion dans le triangle sup√©rieur, avec un histogramme diagonal, un diagramme de densit√© de noyau bidimensionnel et des coefficients de corr√©lation dans le triangle inf√©rieur. <br><br><pre> <code class="hljs pgsql"># Extract the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> plot plot_data = features[[<span class="hljs-string"><span class="hljs-string">'score'</span></span>, <span class="hljs-string"><span class="hljs-string">'Site EUI (kBtu/ft¬≤)'</span></span>, <span class="hljs-string"><span class="hljs-string">'Weather Normalized Source EUI (kBtu/ft¬≤)'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_Total GHG Emissions (Metric Tons CO2e)'</span></span>]] # Replace the inf <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nan</span></span> plot_data = plot_data.replace({np.inf: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>, -np.inf: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>}) # <span class="hljs-keyword"><span class="hljs-keyword">Rename</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> plot_data = plot_data.<span class="hljs-keyword"><span class="hljs-keyword">rename</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> = {<span class="hljs-string"><span class="hljs-string">'Site EUI (kBtu/ft¬≤)'</span></span>: <span class="hljs-string"><span class="hljs-string">'Site EUI'</span></span>, <span class="hljs-string"><span class="hljs-string">'Weather Normalized Source EUI (kBtu/ft¬≤)'</span></span>: <span class="hljs-string"><span class="hljs-string">'Weather Norm EUI'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_Total GHG Emissions (Metric Tons CO2e)'</span></span>: <span class="hljs-string"><span class="hljs-string">'log GHG Emissions'</span></span>}) # <span class="hljs-keyword"><span class="hljs-keyword">Drop</span></span> na <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> plot_data = plot_data.dropna() # <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> calculate correlation coefficient <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> two <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> def corr_func(x, y, **kwargs): r = np.corrcoef(x, y)[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] ax = plt.gca() ax.annotate("r = {:.2f}".format(r), xy=(<span class="hljs-number"><span class="hljs-number">.2</span></span>, <span class="hljs-number"><span class="hljs-number">.8</span></span>), xycoords=ax.transAxes, size = <span class="hljs-number"><span class="hljs-number">20</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> the pairgrid <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> grid = sns.PairGrid(data = plot_data, size = <span class="hljs-number"><span class="hljs-number">3</span></span>) # Upper <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a scatter plot grid.map_upper(plt.scatter, color = <span class="hljs-string"><span class="hljs-string">'red'</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.6</span></span>) # Diagonal <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a histogram grid.map_diag(plt.hist, color = <span class="hljs-string"><span class="hljs-string">'red'</span></span>, edgecolor = <span class="hljs-string"><span class="hljs-string">'black'</span></span>) # Bottom <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> correlation <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> density plot grid.map_lower(corr_func); grid.map_lower(sns.kdeplot, cmap = plt.cm.Reds) # Title <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> entire plot plt.suptitle(<span class="hljs-string"><span class="hljs-string">'Pairs Plot of Energy Data'</span></span>, size = <span class="hljs-number"><span class="hljs-number">36</span></span>, y = <span class="hljs-number"><span class="hljs-number">1.02</span></span>);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/5fa/4cc/94f/5fa4cc94f9b91df5ad4fda37aa3ae1f0.png"><br><br>  Pour voir la relation des variables, recherchez l'intersection des lignes et des colonnes.  Supposons que vous vouliez regarder la corr√©lation entre la <code>Weather Norm EUI</code> et le <code>score</code> , alors nous recherchons la s√©rie <code>Weather Norm EUI</code> et la colonne de <code>score</code> , √† l'intersection de laquelle il existe un coefficient de corr√©lation de -0,67.  Ces graphiques ont non seulement l'air cool, mais aident √©galement √† choisir les variables pour le mod√®le. <br><br><h2>  Conception et s√©lection de fonctionnalit√©s </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La conception et la s√©lection de fonctionnalit√©s</a> apportent souvent le meilleur rendement en termes de temps consacr√© √† l'apprentissage automatique.  Nous donnons d'abord les d√©finitions: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Construction de caract√©ristiques:</a> processus d'extraction ou de cr√©ation de nouvelles caract√©ristiques √† partir de donn√©es brutes.  Pour utiliser des variables dans le mod√®le, vous devrez peut-√™tre les transformer, par exemple, prendre le logarithme naturel, ou extraire la racine carr√©e, ou appliquer un codage √† chaud des variables cat√©gorielles.  La conception caract√©ristique peut √™tre consid√©r√©e comme cr√©ant des fonctionnalit√©s suppl√©mentaires √† partir de donn√©es brutes. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">S√©lection des fonctionnalit√©s:</a> processus de s√©lection des fonctionnalit√©s les plus pertinentes √† partir des donn√©es, au cours duquel nous supprimons certaines fonctionnalit√©s pour aider le mod√®le √† mieux g√©n√©raliser les nouvelles donn√©es afin d'obtenir un mod√®le plus interpr√©table.  Le choix des signes peut √™tre consid√©r√© comme la suppression du ¬´superflu¬ª afin qu'il ne reste que les plus importants. </li></ul><br>  Le mod√®le d'apprentissage automatique ne peut apprendre que des donn√©es que nous fournissons, il est donc extr√™mement important de s'assurer que nous incluons toutes les informations pertinentes pour notre t√¢che.  Si vous ne fournissez pas au mod√®le les donn√©es correctes, il ne pourra pas apprendre et ne produira pas de pr√©visions pr√©cises! <br><br>  Nous ferons ce qui suit: <br><br><ul><li>  Applicable aux variables cat√©gorielles (trimestre et type de propri√©t√©) codage unique. </li><li>  Ajoutez le logarithme naturel de toutes les variables num√©riques. </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un codage √† chaud est</a> n√©cessaire pour inclure des variables cat√©gorielles dans le mod√®le.  L'algorithme d'apprentissage automatique ne pourra pas comprendre le type de "bureau", donc si le b√¢timent est un bureau, on lui attribuera un signe de 1, et sinon un bureau, alors 0. <br><br>  L'ajout d'entit√©s transform√©es aidera le mod√®le √† en savoir plus sur les relations non lin√©aires au sein des donn√©es.  Dans l'analyse des donn√©es, il est normal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d'extraire des racines carr√©es, de prendre des logarithmes naturels ou de transformer les signes d'une mani√®re ou d'une autre</a> , cela d√©pend de la t√¢che sp√©cifique ou de votre connaissance des meilleures techniques.  Dans ce cas, nous ajouterons le logarithme naturel de tous les signes num√©riques. <br><br>  Ce code s√©lectionne les signes num√©riques, calcule leurs logarithmes, s√©lectionne deux signes cat√©goriels, leur applique un codage √† chaud et combine les deux ensembles en un seul.  √Ä en juger par la description, beaucoup de travail reste √† faire, mais dans Pandas, tout est assez simple! <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Copy</span></span> the original data features = data.<span class="hljs-keyword"><span class="hljs-keyword">copy</span></span>() # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> numeric_subset = data.select_dtypes(<span class="hljs-string"><span class="hljs-string">'number'</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> numeric_subset.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>: # Skip the Energy Star Score <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> col == <span class="hljs-string"><span class="hljs-string">'score'</span></span>: next <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: numeric_subset[<span class="hljs-string"><span class="hljs-string">'log_'</span></span> + col] = np.log(numeric_subset[col]) # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the categorical <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> categorical_subset = data[[<span class="hljs-string"><span class="hljs-string">'Borough'</span></span>, <span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>]] # One hot encode categorical_subset = pd.get_dummies(categorical_subset) # <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> the two dataframes <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> concat # Make sure <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> use axis = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">perform</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> bind features = pd.concat([numeric_subset, categorical_subset], axis = <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Nous avons maintenant plus de 11 000 observations (b√¢timents) avec 110 colonnes (balises).  Tous les signes ne seront pas utiles pour pr√©dire le score Energy Star, nous allons donc reprendre la s√©lection des signes et supprimer certaines des variables. <br><br><h4>  S√©lection des fonctionnalit√©s </h4><br>  Bon nombre des 110 panneaux disponibles sont redondants car ils sont fortement corr√©l√©s les uns aux autres.  Par exemple, voici un graphique de l'IUE et du site normalis√© par temps EUI, avec un coefficient de corr√©lation de 0,997. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ab/c4f/ad8/4abc4fad887ef202d8d40961a8b02c34.png"><br><br>  Les signes fortement corr√©l√©s sont appel√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">colin√©aires</a> .  La suppression d'une variable dans de telles paires d'attributs aide souvent le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mod√®le √† se g√©n√©raliser et √† √™tre plus interpr√©table</a> .  Veuillez noter que nous parlons de la corr√©lation de certains signes avec d'autres, et non de la corr√©lation avec l'objectif, ce qui n'aiderait que notre mod√®le! <br><br>  Il existe un certain nombre de m√©thodes pour calculer la colin√©arit√© des caract√©ristiques, et l'une des plus populaires est le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">facteur d'inflation de</a> la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">variance</a> .  Nous utiliserons le coefficient de corr√©lation pour rechercher et supprimer des entit√©s colin√©aires.  Nous rejetons une paire de signes si le coefficient de corr√©lation entre eux est sup√©rieur √† 0,6.  Le code est dans le bloc-notes (et en r√©ponse √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Stack Overflow</a> ). <br><br>  Cette valeur semble arbitraire, mais en fait j'ai essay√© diff√©rents seuils, et ce qui pr√©c√®de m'a permis de cr√©er le meilleur mod√®le.  L'apprentissage automatique est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">empirique</a> et doit souvent exp√©rimenter pour trouver la meilleure solution.  Apr√®s la s√©lection, nous avons 64 attributs et un objectif. <br><br><pre> <code class="hljs pgsql"># Remove <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> na <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> features = features.dropna(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, how = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) print(features.shape) (<span class="hljs-number"><span class="hljs-number">11319</span></span>, <span class="hljs-number"><span class="hljs-number">65</span></span>)</code> </pre> <br><h2>  Choisissez un niveau de base </h2><br>  Nous avons effac√© les donn√©es, effectu√© une analyse exploratoire et construit les panneaux.  Et avant de proc√©der √† la cr√©ation du mod√®le, vous devez s√©lectionner le niveau de base initial (base na√Øve) - une sorte d'hypoth√®se avec laquelle nous comparerons les r√©sultats des mod√®les.  S'ils tombent en dessous du niveau de base, nous supposerons que l'apprentissage automatique n'est pas applicable pour cette t√¢che, ou qu'une approche diff√©rente doit √™tre essay√©e. <br><br>  Pour les t√¢ches de r√©gression, en tant que niveau de base, il est raisonnable de deviner la valeur m√©diane de l'objectif sur l'ensemble d'entra√Ænement pour tous les exemples de l'ensemble de test.  Ces kits d√©finissent une barri√®re relativement faible pour tous les mod√®les. <br><br>  En tant que mesure, nous prenons l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">erreur absolue moyenne (mae)</a> dans les pr√©visions.  Il existe de nombreuses autres m√©triques pour les r√©gressions, mais j'aime les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conseils</a> pour choisir une m√©trique et l'utiliser pour √©valuer les mod√®les.  Et l'erreur absolue moyenne est facile √† calculer et √† interpr√©ter. <br><br>  Avant de calculer le niveau de base, vous devez diviser les donn√©es en ensembles de formation et de test: <br><br><ol><li>  Un ensemble d'attributs de formation est ce que nous fournissons √† notre mod√®le avec les r√©ponses pendant la formation.  Le mod√®le doit apprendre √† correspondre aux caract√©ristiques de l'objectif. </li><li>  Un ensemble de fonctionnalit√©s de test est utilis√© pour √©valuer le mod√®le form√©.  Lorsqu'elle traite la suite de tests, elle ne voit pas les bonnes r√©ponses et doit pr√©voir uniquement en fonction des fonctionnalit√©s disponibles.  Nous connaissons les r√©ponses pour les donn√©es de test et pouvons comparer les r√©sultats des pr√©visions avec eux. </li></ol><br>  Pour la formation, nous utilisons 70% des donn√©es et pour les tests - 30%: <br><br><pre> <code class="hljs pgsql"># Split <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> <span class="hljs-number"><span class="hljs-number">70</span></span>% training <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span>% testing <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> X, X_test, y, y_test = train_test_split(features, targets, test_size = <span class="hljs-number"><span class="hljs-number">0.3</span></span>, random_state = <span class="hljs-number"><span class="hljs-number">42</span></span>)</code> </pre> <br>  Maintenant, nous calculons l'indicateur pour le niveau de base initial: <br><br><pre> <code class="hljs vhdl"># <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> calculate mean absolute <span class="hljs-literal"><span class="hljs-literal">error</span></span> def mae(y_true, y_pred): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.mean(<span class="hljs-keyword"><span class="hljs-keyword">abs</span></span>(y_true - y_pred)) baseline_guess = np.median(y) print(<span class="hljs-symbol"><span class="hljs-symbol">'The</span></span> baseline guess <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a score <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> %<span class="hljs-number"><span class="hljs-number">0.2</span></span>f' % baseline_guess) print(<span class="hljs-string"><span class="hljs-string">"Baseline Performance on the test set: MAE = %0.4f"</span></span> % mae(y_test, baseline_guess))</code> </pre> <br>  <b>La supposition de base est un score de 66,00</b> <b><br></b>  <b>Performances de base sur l'ensemble de test: MAE = 24,5164</b> <br><br>  L'erreur absolue moyenne sur l'ensemble de test √©tait d'environ 25 points.  Puisque nous √©valuons dans la plage de 1 √† 100, l'erreur est de 25% - une barri√®re plut√¥t faible pour le mod√®le! <br><br><h2>  Conclusion </h2><br>  Dans cet article, vous √™tes pass√©s par les trois premi√®res √©tapes de la r√©solution d'un probl√®me √† l'aide de l'apprentissage automatique.  Apr√®s avoir d√©fini la t√¢che, nous: <br><br><ol><li>  Donn√©es brutes effac√©es et format√©es. </li><li>  R√©alisation d'une analyse exploratoire pour √©tudier les donn√©es disponibles. </li><li>  Nous avons d√©velopp√© un ensemble de fonctionnalit√©s que nous utiliserons pour nos mod√®les. </li></ol><br> ,    ,       . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scikit-Learn</a>    ,        . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425253/">https://habr.com/ru/post/fr425253/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425243/index.html">Le manuel de John Willis</a></li>
<li><a href="../fr425245/index.html">Annonce de RamblerFront & # 6</a></li>
<li><a href="../fr425247/index.html">Crowdsourcing dans les tests</a></li>
<li><a href="../fr425249/index.html">Comment est la connaissance du LLP √† l'Universit√© ITMO: le cours "Programmation de bas niveau"</a></li>
<li><a href="../fr425251/index.html">LoJax: le premier rootkit UEFI connu utilis√© dans une campagne malveillante</a></li>
<li><a href="../fr425255/index.html">Algorithme de compression sans perte Broo et codage delta, comparaison avec Xdelta3. D√©veloppement de projets √† domicile</a></li>
<li><a href="../fr425259/index.html">Sauvegarder votre site en utilisant git et Makefile</a></li>
<li><a href="../fr425261/index.html">Les certificats EV sont morts</a></li>
<li><a href="../fr425263/index.html">Le festival iFEST se tiendra √† Nijni Novgorod</a></li>
<li><a href="../fr425265/index.html">R√®gles de d√©veloppement chez Yandex.Health</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>