<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∑ üßìüèΩ üéÖüèæ SQL Rompecabezas entretenidos üßïüèæ üí≤ üë®üèº‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! 

 Durante m√°s de 3 a√±os he ense√±ado SQL en varios centros de capacitaci√≥n, y una de mis observaciones es que los estudiantes dominan y com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SQL Rompecabezas entretenidos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461567/"> Hola Habr! <br><br>  Durante m√°s de 3 a√±os he ense√±ado SQL en varios centros de capacitaci√≥n, y una de mis observaciones es que los estudiantes dominan y comprenden SQL mejor si establecen una tarea, y no solo hablan sobre las posibilidades y los fundamentos te√≥ricos. <br><br>  En este art√≠culo compartir√© con ustedes mi lista de tareas que les doy a los estudiantes como tarea y sobre las cuales realizamos varios tipos de tormentas de ideas, lo que conduce a una comprensi√≥n profunda y clara de SQL. <br><br><img src="https://habrastorage.org/webt/gr/ue/1m/grue1mys5l7b9rieubqlrxu5jfo.png"><br><br>  SQL (Àà…õsÀàkjuÀà…õl; lenguaje de consulta estructurado en ingl√©s) es un lenguaje de programaci√≥n declarativo utilizado para crear, modificar y administrar datos en una base de datos relacional administrada por un sistema de administraci√≥n de bases de datos apropiado.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Aprende m√°s</a> <br><br>  Puede leer sobre SQL de varias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">fuentes</a> . <br>  Este art√≠culo no tiene la intenci√≥n de ense√±arle SQL desde cero. <br><a name="habracut"></a><br>  Entonces vamos. <br><br>  Utilizaremos el conocido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">esquema de recursos humanos</a> en Oracle con sus tablas ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">m√°s</a> ): <br><br><img src="https://habrastorage.org/webt/lw/4k/mm/lw4kmmf6abadgz5cdtaf2jsggyu.gif"><br>  Observo que solo consideraremos las tareas SELECT.  No hay problemas con DML y DDL. <br><br><h2>  Las tareas </h2><br>  <b>Restricci√≥n y clasificaci√≥n de datos</b> <br><br>  Mesa de empleados.  Obtenga una lista con informaci√≥n sobre todos los empleados <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees</code> </pre> <br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados llamados 'David' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name = <span class="hljs-string"><span class="hljs-string">'David'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados con job_id igual a 'IT_PROG' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id = <span class="hljs-string"><span class="hljs-string">'IT_PROG'</span></span></code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados del departamento 50 (departamento_id) con salario (salario), m√°s de 4000 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> salary &gt; <span class="hljs-number"><span class="hljs-number">4000</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados del departamento 20 y 30 (departamento_id) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> department_id = <span class="hljs-number"><span class="hljs-number">30</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuya √∫ltima letra en el nombre es 'a' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%a'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados del departamento 50 y 80 (departamento_id) que tienen una bonificaci√≥n (el valor en la columna comisi√≥n_pct no est√° vac√≠o) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (department_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> department_id = <span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> commission_pct <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo nombre contiene al menos 2 letras 'n' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%n%n%'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo nombre tiene m√°s de 4 letras <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%_____%'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo salario est√° en el rango de 8000 a 9000 (inclusive) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">8000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">9000</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo nombre contiene el car√°cter '%' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%\%%'</span></span> ESCAPE <span class="hljs-string"><span class="hljs-string">'\';</span></span></code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los administradores de ID <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de empleados con sus puestos en el formato: Donald (sh_clerk) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name || <span class="hljs-string"><span class="hljs-string">'('</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span> (job_id) || <span class="hljs-string"><span class="hljs-string">')'</span></span> employee <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br><br>  <b>Uso de funciones de una sola fila para personalizar la salida</b> <br><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo nombre tiene m√°s de 10 letras <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados que tienen la letra 'b' en su nombre (sin distinci√≥n entre may√∫sculas y min√∫sculas) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span> (first_name), <span class="hljs-string"><span class="hljs-string">'b'</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo nombre contiene al menos 2 letras 'a' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span> (first_name),<span class="hljs-string"><span class="hljs-string">'a'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo salario es un m√∫ltiplo de 1000 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MOD</span></span> (salary, <span class="hljs-number"><span class="hljs-number">1000</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga el primer n√∫mero de 3 d√≠gitos del n√∫mero de tel√©fono del empleado si su n√∫mero tiene el formato XXXX.XXX.XXXX <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> phone_number, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (phone_number, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) new_phone_number <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> phone_number <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'___.___.____'</span></span>;</code> </pre><br></div></div><br>  Mesa de departamentos.  Obtenga la primera palabra del nombre del departamento para aquellos con m√°s de una palabra en el nombre <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (department_name, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (department_name, <span class="hljs-string"><span class="hljs-string">' '</span></span>)<span class="hljs-number"><span class="hljs-number">-1</span></span>) first_word <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (department_name, <span class="hljs-string"><span class="hljs-string">' '</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga los nombres de los empleados sin la primera y la √∫ltima letra del nombre <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) - <span class="hljs-number"><span class="hljs-number">2</span></span>) new_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuya √∫ltima letra en el nombre es 'm' y un nombre largo mayor que 5 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">-1</span></span>) = <span class="hljs-string"><span class="hljs-string">'m'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span>(first_name)&gt;<span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre><br></div></div><br>  Mesa doble  Obtener el pr√≥ximo viernes <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> NEXT_DAY (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-string"><span class="hljs-string">'FRIDAY'</span></span>) next_friday <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados que han trabajado en la empresa durante m√°s de 17 a√±os. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> MONTHS_BETWEEN (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, hire_date) / <span class="hljs-number"><span class="hljs-number">12</span></span> &gt; <span class="hljs-number"><span class="hljs-number">17</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados cuyo √∫ltimo d√≠gito del n√∫mero de tel√©fono es impar y consta de 3 n√∫meros separados por un punto <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MOD</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (phone_number, <span class="hljs-number"><span class="hljs-number">-1</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (phone_number,<span class="hljs-string"><span class="hljs-string">'.'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (phone_number,<span class="hljs-string"><span class="hljs-string">'.'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados que tienen al menos 3 caracteres en el valor de job_id despu√©s del signo '_', pero este valor despu√©s de '_' no es igual a 'CLERK' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (job_id, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (job_id, <span class="hljs-string"><span class="hljs-string">'_'</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (job_id, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span> (job_id, <span class="hljs-string"><span class="hljs-string">'_'</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>) != <span class="hljs-string"><span class="hljs-string">'CLERK'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados reemplazando todos los '.' En el valor PHONE_NUMBER.  en '-' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> phone_number, <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> (phone_number, <span class="hljs-string"><span class="hljs-string">'.'</span></span>, <span class="hljs-string"><span class="hljs-string">'-'</span></span>) new_phone_number <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br><br>  <b>Uso de funciones de conversi√≥n y expresiones condicionales</b> <br><br>  Mesa de empleados.  Obtenga una lista de todos los empleados que vinieron a trabajar el primer d√≠a del mes (cualquiera) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'DD'</span></span>) = <span class="hljs-string"><span class="hljs-string">'01'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados que vinieron a trabajar en 2008 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'2008'</span></span>;</code> </pre><br></div></div><br>  Mesa DUAL.  Muestra la fecha de ma√±ana en el formato: ma√±ana es el segundo d√≠a de enero <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-string"><span class="hljs-string">'fm""Tomorrow is ""Ddspth ""day of"" Month'</span></span>) info <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados y la fecha en que todos vinieron a trabajar en el formato: 21 de junio de 2007 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'fmddth ""of"" Month, YYYY'</span></span>) hire_date <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de empleados con mayores salarios en un 20%.  Mostrar salario con signo de d√≥lar <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, TO_CHAR (salary + salary * <span class="hljs-number"><span class="hljs-number">0.20</span></span>, <span class="hljs-string"><span class="hljs-string">'fm$999,999.00'</span></span>) new_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados que vienen a trabajar en febrero de 2007. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> hire_date <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01.02.2007'</span></span>, <span class="hljs-string"><span class="hljs-string">'DD.MM.YYYY'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LAST_DAY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01.02.2007'</span></span>, <span class="hljs-string"><span class="hljs-string">'DD.MM.YYYY'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> to_char(hire_date,<span class="hljs-string"><span class="hljs-string">'MM.YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'02.2007'</span></span>;</code> </pre><br></div></div><br>  Mesa DUAL.  Saca la fecha actual, + segundo, + minuto, + hora, + d√≠a, + mes, + a√±o <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">now</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">24</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span>) plus_second, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">24</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span>) plus_minute, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">24</span></span> plus_hour, <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> plus_day, ADD_MONTHS (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) plus_month, ADD_MONTHS (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) plus_year <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados con salarios completos (salario + comisi√≥n_pct (%)) en el formato: $ 24,000.00 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, salary, TO_CHAR (salary + salary * NVL (commission_pct, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-string"><span class="hljs-string">'fm$99,999.00'</span></span>) full_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de todos los empleados e informaci√≥n sobre la disponibilidad de bonos salariales (S√≠ / No) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, commission_pct, NVL2 (commission_pct, <span class="hljs-string"><span class="hljs-string">'Yes'</span></span>, <span class="hljs-string"><span class="hljs-string">'No'</span></span>) has_bonus <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga el nivel de salario de cada empleado: Menos de 5000 se considera Nivel bajo, Mayor o igual a 5000 y menos de 10000 se considera Nivel normal, Mayor o igual a 10000 se considera Nivel alto <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, salary, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> salary &lt; <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Low'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> salary &gt;= <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> salary &lt; <span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Normal'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> salary &gt;= <span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'High'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">'Unknown'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> salary_level <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees;</code> </pre><br></div></div><br>  Tabla de pa√≠ses  Para cada pa√≠s, muestre la regi√≥n en la que se encuentra: 1-Europa, 2-Am√©rica, 3-Asia, 4-√Åfrica (sin unirse) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> country_name country, <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span> (region_id, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'Europe'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'America'</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'Asia'</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">'Africa'</span></span>, <span class="hljs-string"><span class="hljs-string">'Unknown'</span></span>) region <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> countries; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> country_name country, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> region_id <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Europe'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'America'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Asia'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'Africa'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">'Unknown'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> region <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> countries;</code> </pre><br></div></div><br><br>  <b>Informe de datos agregados utilizando las funciones de grupo</b> <br><br>  Mesa de empleados.  Obtenga un informe sobre department_id con un salario m√≠nimo y m√°ximo, con una fecha de llegada temprana y tard√≠a al trabajo y con el n√∫mero de empleados.  Ordenar por n√∫mero de empleados (descendente) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id, <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (salary) min_salary, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (salary) max_salary, <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (hire_date) min_hire_date, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (hire_date) max_hire_Date, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">count</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  ¬øCu√°ntos empleados cuyos nombres comienzan con la misma letra?  Ordenar por cantidad.  Mostrar solo donde la cantidad es mayor que 1 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) first_char, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (first_name, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  ¬øCu√°ntos empleados que trabajan en el mismo departamento y reciben el mismo salario? <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id, salary, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id, salary <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga un informe de cu√°ntos empleados fueron contratados cada d√≠a de la semana.  Ordenar por cantidad <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (hire_Date, <span class="hljs-string"><span class="hljs-string">'Day'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> TO_CHAR (hire_Date, <span class="hljs-string"><span class="hljs-string">'Day'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga un informe de cu√°ntos empleados fueron contratados por a√±o.  Ordenar por cantidad <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">year</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>);</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga la cantidad de departamentos en los que hay empleados <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*)) department_count <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de departamento_id con m√°s de 30 empleados <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">30</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de department_id y un salario promedio redondeado para los empleados de cada departamento. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id, <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary)) avg_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id;</code> </pre><br></div></div><br>  Tabla de pa√≠ses  Obtenga una lista de region_id la suma de todas las letras de todos los country_name en los que m√°s de 60 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> region_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> countries <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> region_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (country_name)) &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de departamento_id en el que trabajan los empleados de varios (&gt; 1) trabajo_id <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> job_id) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de manager_id cuyo n√∫mero de subordinados es m√°s de 5 y la suma de todos los salarios de sus subordinados es m√°s de 50,000 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (salary) &gt; <span class="hljs-number"><span class="hljs-number">50000</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de manager_id para el cual el salario promedio de todos sus subordinados est√° en el rango de 6000 a 9000 que no reciben bonificaciones (Commission_pct est√° vac√≠o) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> manager_id, <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary) avg_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> commission_pct <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary) <span class="hljs-keyword"><span class="hljs-keyword">BETWEEN</span></span> <span class="hljs-number"><span class="hljs-number">6000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-number"><span class="hljs-number">9000</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga el salario m√°ximo de todos los empleados job_id que terminen en la palabra 'CLERK' <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (salary) max_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id <span class="hljs-keyword"><span class="hljs-keyword">LIKE</span></span> <span class="hljs-string"><span class="hljs-string">'%CLERK'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (salary) max_salary <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span> (job_id, <span class="hljs-number"><span class="hljs-number">-5</span></span>) = <span class="hljs-string"><span class="hljs-string">'CLERK'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga el salario m√°ximo entre todos los salarios promedio en el departamento <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_id;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga la cantidad de empleados con la misma cantidad de letras en el nombre.  Al mismo tiempo, muestre solo aquellos con una longitud de nombre de m√°s de 5 y la cantidad de empleados con ese nombre es mayor de 20. Ordenar por longitud de nombre <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name), <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name); <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name), <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name);</code> </pre><br></div></div><br><br>  <b>Visualizaci√≥n de datos de varias tablas mediante combinaciones</b> <br><br>  Tabla de empleados, departamentos, ubicaciones, pa√≠ses, regiones.  Obtenga una lista de regiones y la cantidad de empleados en cada regi√≥n <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> region_name, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries c <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (l.country_id = c.country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions r <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (c.region_id = r.region_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> region_name;</code> </pre><br></div></div><br>  Tabla de empleados, departamentos, ubicaciones, pa√≠ses, regiones.  Obtenga informaci√≥n detallada sobre cada empleado: <br>  Nombre, Apellido, Departamento, Trabajo, Calle, Pa√≠s, Regi√≥n <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> First_name, Last_name, Department_name, Job_id, street_address, Country_name, Region_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries c <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (l.country_id = c.country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions r <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (c.region_id = r.region_id);</code> </pre><br></div></div><br>  Mesa de empleados.  Mostrar a todos los gerentes que tienen m√°s de 6 empleados <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> man.first_name, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> man.first_name <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">6</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Mostrar a todos los empleados que no informan a nadie <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> emp.first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> man.FIRST_NAME <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Tabla de empleados, Job_history.  La tabla de empleados almacena todos los empleados.  La tabla Job_history almacena los empleados que abandonaron la empresa.  Obtenga un informe sobre todos los empleados y su estado en la empresa (trabaja o dej√≥ la empresa con la fecha de salida) <br>  Un ejemplo: <br>  nombre_nombre |  estado <br>  Jennifer |  Abandon√≥ la empresa al 31 de diciembre de 2006. <br>  Clara |  Actualmente trabajando <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, NVL2 ( end_date, TO_CHAR (end_date, <span class="hljs-string"><span class="hljs-string">'fm""Left the company at"" DD ""of"" Month, YYYY'</span></span>), <span class="hljs-string"><span class="hljs-string">'Currently Working'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> job_history j <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.employee_id = j.employee_id);</code> </pre><br></div></div><br>  Tabla de empleados, departamentos, ubicaciones, pa√≠ses, regiones.  Obtenga una lista de empleados que viven en Europa (region_name) <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (region_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> region_name = <span class="hljs-string"><span class="hljs-string">'Europe'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> countries c <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (l.country_id = c.country_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> regions r <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (c.region_id = r.region_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> region_name = <span class="hljs-string"><span class="hljs-string">'Europe'</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados, Departamentos.  Mostrar todos los departamentos con m√°s de 30 empleados. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name, <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> department_name <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) &gt; <span class="hljs-number"><span class="hljs-number">30</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados, Departamentos.  Mostrar a todos los empleados que no est√°n en ning√∫n departamento <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> d.department_name <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados, Departamentos.  Mostrar todos los departamentos sin un solo empleado <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">RIGHT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> first_name <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados.  Mostrar a todos los empleados que no tienen subordinados <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> man.first_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">RIGHT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> emp.FIRST_NAME <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;</code> </pre><br></div></div><br>  Tabla Empleados, Trabajos, Departamentos.  Mostrar a los empleados en el formato: Nombre, T√≠tulo del trabajo, Nombre del departamento. <br>  Un ejemplo: <br>  Primer nombre |  Job_title |  Nombre_departamental <br>  Donald |  Env√≠o |  Secretario de env√≠o <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, job_title, department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> jobs j <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.job_id = j.job_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.department_id = e.department_id);</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de los empleados cuyos gerentes obtuvieron un trabajo en 2005, pero al mismo tiempo, estos mismos empleados obtuvieron un trabajo antes de 2005 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> emp.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (man.hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'2005'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> emp.hire_date &lt; <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01012005'</span></span>, <span class="hljs-string"><span class="hljs-string">'DDMMYYYY'</span></span>);</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de los empleados cuyos gerentes obtuvieron un trabajo en el mes de enero de cualquier a√±o y la duraci√≥n del t√≠tulo de trabajo de estos empleados es de m√°s de 15 caracteres. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> emp.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees emp <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> employees man <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.manager_id = man.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> jobs j <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (emp.job_id = j.job_id) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (man.hire_date, <span class="hljs-string"><span class="hljs-string">'MM'</span></span>) = <span class="hljs-string"><span class="hljs-string">'01'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (j.job_title) &gt; <span class="hljs-number"><span class="hljs-number">15</span></span>;</code> </pre><br></div></div><br><br>  <b>Uso de subconsultas para resolver consultas</b> <br><br>  Mesa de empleados.  Obtenga una lista de empleados con el nombre m√°s largo. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name) = (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (first_name)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees);</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de empleados con un salario mayor que el salario promedio de todos los empleados. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary &gt; (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (salary) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees);</code> </pre><br></div></div><br>  Tabla de empleados, departamentos, ubicaciones.  Obtenga una ciudad en la que los empleados ganen menos en total. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> city <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> city <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (salary) = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SUM</span></span> (salary)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> departments d <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (e.department_id = d.department_id) <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> locations l <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (d.location_id = l.location_id) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> city);</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de empleados cuyo gerente recibe un salario de m√°s de 15,000. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary &gt; <span class="hljs-number"><span class="hljs-number">15000</span></span>)</code> </pre><br></div></div><br>  Mesa de empleados, Departamentos.  Mostrar todos los departamentos sin un solo empleado <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>);</code> </pre><br></div></div><br>  Mesa de empleados.  Mostrar a todos los empleados que no son gerentes <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)</code> </pre><br></div></div><br>  Mesa de empleados.  Mostrar a todos los gerentes que tienen m√°s de 6 empleados <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span> (*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id = e.employee_id) &gt; <span class="hljs-number"><span class="hljs-number">6</span></span>;</code> </pre><br></div></div><br>  Mesa de empleados, Departamentos.  Mostrar a los empleados que trabajan en el departamento de TI. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_name = <span class="hljs-string"><span class="hljs-string">'IT'</span></span>);</code> </pre><br></div></div><br>  Tabla Empleados, Trabajos, Departamentos.  Mostrar a los empleados en el formato: Nombre, T√≠tulo del trabajo, Nombre del departamento. <br>  Un ejemplo: <br>  Primer nombre |  Job_title |  Nombre_departamental <br>  Donald |  Env√≠o |  Secretario de env√≠o <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> first_name, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> job_title <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> jobs <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id = e.job_id) job_title, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> departments <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = e.department_id) department_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e;</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de los empleados cuyos gerentes obtuvieron un trabajo en 2005, pero al mismo tiempo, estos mismos empleados obtuvieron un trabajo antes de 2005 <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'YYYY'</span></span>) = <span class="hljs-string"><span class="hljs-string">'2005'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> hire_date &lt; <span class="hljs-keyword"><span class="hljs-keyword">TO_DATE</span></span> (<span class="hljs-string"><span class="hljs-string">'01012005'</span></span>, <span class="hljs-string"><span class="hljs-string">'DDMMYYYY'</span></span>);</code> </pre><br></div></div><br>  Mesa de empleados.  Obtenga una lista de los empleados cuyos gerentes obtuvieron un trabajo en el mes de enero de cualquier a√±o y la duraci√≥n del t√≠tulo de trabajo de estos empleados es de m√°s de 15 caracteres. <br><div class="spoiler">  <b class="spoiler_title">Soluci√≥n</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees e <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> manager_id <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TO_CHAR (hire_date, <span class="hljs-string"><span class="hljs-string">'MM'</span></span>) = <span class="hljs-string"><span class="hljs-string">'01'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LENGTH</span></span> (job_title) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> jobs <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> job_id = e.job_id) &gt; <span class="hljs-number"><span class="hljs-number">15</span></span>;</code> </pre><br></div></div><br><br>  <b>Eso es todo por ahora.</b> <br><br>  Espero que las tareas hayan sido interesantes y fascinantes. <br>  Si es posible, completar√© esta lista de tareas. <br>  Tambi√©n me complacer√° cualquier comentario y sugerencia. <br><br>  PD: Si a alguien se le ocurre una tarea SELECT interesante, escriba los comentarios y agr√©guelos a la lista. <br><br>  Gracias </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/461567/">https://habr.com/ru/post/461567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461553/index.html">Experiencia en la automatizaci√≥n de pruebas visuales de regresi√≥n en Java + Selenium Webdriver + aShot</a></li>
<li><a href="../461555/index.html">Visualizaciones de hojas de c√°lculo de Google</a></li>
<li><a href="../461561/index.html">Temporizador Arduino</a></li>
<li><a href="../461563/index.html">Sable l√°ser de vapor de cobre casero - Parte 3 Final</a></li>
<li><a href="../461565/index.html">Los 5 mandamientos del desarrollador de TypeScript</a></li>
<li><a href="../461569/index.html">Nota para el front-end: qu√© verificar antes de probar</a></li>
<li><a href="../461571/index.html">SVG en la vida real. Informe Yandex</a></li>
<li><a href="../461575/index.html">Creaci√≥n de una PBX basada en la nube 3CX en cualquier alojamiento compatible con Openstack</a></li>
<li><a href="../461577/index.html">Parte 5/2 Edif. 1: Crossroads of RocketChip Avenue y pista de instrumentaci√≥n resbaladiza</a></li>
<li><a href="../461579/index.html">WebMoney presenta nuevas billeteras WMP y cambia las reglas del juego</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>