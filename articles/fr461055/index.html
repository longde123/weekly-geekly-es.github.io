<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶â üòÜ üêÅ Rekko Challenge 2019: comment c'√©tait üå¨Ô∏è üë©üèª‚Äçüéì üôèüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il n'y a pas si longtemps, un concours de syst√®mes de recommandation du cin√©ma en ligne Okko - Rekko Challenge 2019 a eu lieu sur la plateforme Booste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekko Challenge 2019: comment c'√©tait</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/461055/"><img src="https://habrastorage.org/webt/hb/u7/gu/hbu7guq0ic25zumfxsf5bbipkcq.png"><br><br>  Il n'y a pas si longtemps, un concours de syst√®mes de recommandation du cin√©ma en ligne Okko - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rekko Challenge 2019</a> a eu lieu sur la plateforme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Boosters</a> .  Pour moi, c'√©tait la premi√®re exp√©rience de participer √† une comp√©tition avec un classement (auparavant, je n'essayais la force que dans un hackathon).  La t√¢che est int√©ressante et famili√®re de la pratique, il y a un fonds de prix, ce qui signifie qu'il √©tait logique de participer.  En cons√©quence, j'ai pris la 14e place, pour laquelle les organisateurs ont √©mis un T-shirt comm√©moratif.  Nice  Je vous remercie <br><br>  Dans cet article, je vais vous plonger bri√®vement dans la t√¢che, parler des hypoth√®ses avanc√©es par moi, ainsi que comment faire glisser la concurrence dans les syst√®mes de recommandation et entrer dans le top 15 sans exp√©rience d'empilement, ce qui sera particuli√®rement utile pour ceux qui ne participeront qu'√† des concours. <br><a name="habracut"></a><br><h3>  Syst√®mes de recommandation </h3><br>  L'objectif principal des syst√®mes de recommandation est de donner √† l'utilisateur ce qu'il <s>veut</s> acheter (malheureusement, une telle vue hypertrophi√©e nous est impos√©e par une application commerciale). <br>  Il existe diff√©rentes d√©clarations de t√¢ches (classement, recherche de t√¢ches similaires, pr√©diction d'un √©l√©ment sp√©cifique) et, en cons√©quence, des moyens de les r√©soudre.  Eh bien, nous aimons tous la variabilit√© des choix, qui est fournie par un ensemble de plusieurs solutions potentielles √† chaque probl√®me.  Diff√©rentes approches sont bien d√©crites dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anatomie des syst√®mes de recommandation</a> .  Bien s√ªr, personne n'a annul√© le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">th√©or√®me de</a> la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NFL</a> , ce qui signifie que dans le probl√®me concurrentiel, nous pouvons essayer diff√©rents algorithmes. <br><br><h3>  √ânonc√© du probl√®me </h3><br>  En savoir plus sur la t√¢che et les donn√©es dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article des</a> organisateurs.  TL; DR je d√©crirai ici le minimum n√©cessaire pour comprendre le contexte. <br><br>  L'ensemble de donn√©es contient un peu plus de dix mille films avec des attributs anonymis√©s.  Les options suivantes sont disponibles sous forme de matrices d'interaction utilisateur-√©l√©ment: <br><br><ul><li>  transactions - contient des informations sur les utilisateurs qui ach√®tent du contenu / louent / consultent par abonnement; </li><li>  √©valuations - √©valuations des films par les utilisateurs; </li><li>  signets - l'√©v√©nement d'ajout d'un film aux signets. </li></ul><br>  Toutes les informations sont prises sur une certaine p√©riode de temps, qui est pr√©sent√©e dans des unit√©s arbitraires li√©es au r√©el. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>t</mi><mi>s</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.146ex" height="2.66ex" viewBox="0 -832 5660.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-73" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-3D" x="1108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-66" x="2165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-28" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-74" x="3105" y="0"></use><g transform="translate(3466,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-61" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6C" x="1447" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-29" x="5270" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mi>s</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> ts = f (ts_ {real}) </script></p><br>  Le contenu avait l'ensemble d'attributs suivant: <br><br><img src="https://habrastorage.org/webt/14/hj/uu/14hjuuoannzvkwpal7n7xwqyvyk.png"><br><br>  Vous pouvez les lire en d√©tail dans l'article des organisateurs, mais je veux faire imm√©diatement attention √† ce qui a attir√© mon attention: le param√®tre ¬´attributs¬ª.  Il contenait un sac d'attributs cat√©goriques avec une cardinalit√© d'environ 36 000.  Il y avait en moyenne 15 valeurs par film.  √Ä premi√®re vue, seuls les attributs les plus √©l√©mentaires qui d√©crivent le contenu sont chiffr√©s dans ces valeurs: acteurs, r√©alisateurs, pays, abonnements ou collections auxquels appartient le film. <br><br>  Il est n√©cessaire de pr√©voir 20 films que les utilisateurs de test regarderont au cours des deux prochains mois.  Les utilisateurs de test sont 50 000 des 500 000 utilisateurs.  Au classement, ils sont divis√©s par deux: 25 000 chacun en public / priv√©. <br><br><h3>  M√©trique </h3><br>  Les organisateurs ont choisi Mean Normalize Average Precision sur 20 √©l√©ments (MNAP @ 20) comme m√©trique.  La principale diff√©rence avec le MAP habituel est que pour les utilisateurs qui n'ont pas regard√© 20 films pendant la p√©riode de test, le rationnement ne se produit pas sur k, mais sur la valeur r√©elle des films regard√©s. <br><br><img src="https://habrastorage.org/webt/tk/xt/fn/tkxtfnagqxtookssvkg8rjiicqg.png"><br><br>  En savoir plus et voir le code en Cython <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici.</a> <br><br><h3>  Validation </h3><br>  Arriver √† la solution du probl√®me.  Tout d'abord, il fallait d√©cider ce qui √©tait valid√©.  √âtant donn√© que nous devons pr√©voir les films √† l'avenir, nous ne pouvons pas effectuer une ventilation simple par utilisateur.  √âtant donn√© que le temps est anonymis√©, j'ai d√ª au moins commencer √† le d√©chiffrer au moins approximativement.  Pour ce faire, j'ai pris plusieurs utilisateurs, fait un planning des transactions et r√©v√©l√© une certaine saisonnalit√©.  On a suppos√© que c'√©tait quotidien, et connaissant la diff√©rence de temps entre les jours, nous pouvons calculer pour quelle p√©riode les donn√©es ont √©t√© t√©l√©charg√©es.  Il s'est av√©r√© qu'il s'agissait de transactions pendant 6 mois.  Cela a √©t√© confirm√© plus tard dans la cha√Æne de t√©l√©gramme o√π le concours a √©t√© discut√©. <br><br><img src="https://habrastorage.org/webt/ba/3_/67/ba3_67yp9-znxb9b_uoeummo6li.png"><br><br>  Le graphique ci-dessus montre la fr√©quence horaire des transactions en utilisant des donn√©es d'un mois √† titre d'exemple.  Trois pics importants chaque semaine sont similaires aux vendredis, samedis et dimanches soirs. <br><br>  Par cons√©quent, nous avons six mois de visionnage et des films doivent √™tre pr√©vus pour les deux prochains.  Nous utiliserons le dernier tiers de la dur√©e d'√©chantillonnage de la formation comme ensemble de donn√©es de validation. <br><br><img src="https://habrastorage.org/webt/mu/uy/cm/muuycmuqlah95etk4kqmdrbpygo.jpeg"><br><br>  Les quelques soumissions suivantes ont montr√© que la r√©partition √©tait bien choisie et que la vitesse de validation locale √©tait en excellente corr√©lation avec le classement. <br><br><h3>  Tentative de deanonymisation des donn√©es </h3><br>  Pour commencer, j'ai d√©cid√© d'essayer de d√©sanonymiser tous les films, pour que: <br><br><ul><li>  g√©n√©rer un tas de signes par m√©ta-informations du contenu.  Au moins, les personnes suivantes me viennent √† l'esprit: genres, distribution, entr√©e dans les abonnements, description textuelle, etc.; </li><li>  jeter dans le four des interactions du c√¥t√© pour r√©duire la parcimonie de la matrice.  Oui, les r√®gles de concurrence n'interdisent pas l'utilisation de donn√©es externes.  Bien s√ªr, il n'y avait aucun espoir de correspondance avec des ensembles de donn√©es ouverts, mais personne n'a annul√© l'analyse des portails russes. </li></ul><br>  Il semble que ce soit une motivation logique qui, selon mes attentes, allait devenir une solution phare. <br><br>  Tout d'abord, j'ai d√©cid√© d'analyser le site Web Okko et de retirer tous les films avec leurs propri√©t√©s (classement, dur√©e, restrictions d'√¢ge et autres).  Eh bien, comment analyser - tout s'est av√©r√© √™tre assez simple, dans ce cas, vous pouvez utiliser l'API: <br><br><img src="https://habrastorage.org/webt/c6/i8/8s/c6i88s9db6wj9nl7aqvysuappt8.png"><br><br>  Apr√®s √™tre entr√© dans le catalogue et avoir choisi un genre ou un abonnement sp√©cifique, il vous suffisait d'entrer dans l'un des √©l√©ments.  En r√©ponse √† la demande ci-dessus, toute la gamme de films du genre / abonnement avec tous les attributs tombe.  Tr√®s confortable :) <br><br><div class="spoiler">  <b class="spoiler_title">Ainsi, les attributs d'un √©l√©ment de la structure semblaient</b> <div class="spoiler_text"><pre><code class="json hljs"><span class="hljs-string"><span class="hljs-string">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"c2f98ef4-2eb5-4bfd-b765-b96589d4c470"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SERIAL"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalName"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"covers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"basicCovers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"      ,    ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"worldReleaseDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1558731600000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessType"</span></span>: <span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessDescription"</span></span>: <span class="hljs-string"><span class="hljs-string">"16+    16 "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"duration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trailers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"kinopoiskRating"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"okkoRating"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"imdbRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"staraja-gvardija"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"has3d"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasFullHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasUltraHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasDolby"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSound51"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasMultiAudio"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSubtitles"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inSubscription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inNovelty"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWindow"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"releaseType"</span></span>: <span class="hljs-string"><span class="hljs-string">"RELEASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackTimeMark"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"products"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"PURCHASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumptionMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fromConsumptionMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"qualities"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Q_FULL_HD"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"fromQuality"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currencyCode"</span></span>: <span class="hljs-string"><span class="hljs-string">"RUB"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"priceCategory"</span></span>: <span class="hljs-string"><span class="hljs-string">"679"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1554670800000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"endDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscription"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"offer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalPrice"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, ... ], <span class="hljs-attr"><span class="hljs-attr">"emptyReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"licenses"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"assets"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"genres"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"GENRE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"countries"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3b9706f4-a681-47fb-918e-182ea9dfef0b"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"COUNTRY"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"russia"</span></span> } } ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"subscriptions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"promoText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"innerColor"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"updateRateDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contentCountDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"copyright"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionEndDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionActivateDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"stickerText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fullSeasonPriceText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"purchaseDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"expireDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastWatchedChildId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bookmarkDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"userRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumeDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastStartingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"watchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWatchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> <br></div></div><br>  Il reste √† parcourir tous les genres, √† analyser JSON, puis √† autoriser les doublons, puisqu'un film peut appartenir √† plusieurs genres / abonnements. <br><br>  Oui, ici j'ai eu de la chance et j'ai gagn√© beaucoup de temps.  Si ce n'est pas votre cas et que vous devez analyser le contenu html, il existe des articles sur le hub qui peuvent vous aider, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  ¬´Le truc, c'est le chapeau, pensai-je, nous ne pouvons que le retenir.¬ª  ¬´Le fait est le chapeau¬ª, ai-je r√©alis√© le lendemain: les donn√©es n'√©taient pas absolument identiques.  √Ä ce sujet ci-dessous. <br><br>  Premi√®rement, la taille du catalogue √©tait significativement diff√©rente: dans l'ensemble de donn√©es - 10 200, collect√©es sur le site - 8870. Cela d√©coule de l'historicit√© de l'ensemble de donn√©es: il n'a √©t√© t√©l√©charg√© que ce qui se trouve sur le site maintenant, et les donn√©es de concurrence pour 2018.  Certains films sont devenus indisponibles.  Oups <br><br>  Deuxi√®mement, parmi les attributs potentiels de la correspondance, l'intuition persistante concernait uniquement les √©l√©ments suivants: <br><br>  <i>feature5</i> - limite d'√¢ge.  C'√©tait assez facile √† comprendre.  La cardinalit√© de l'attribut est de 5 valeurs flottantes uniques et ¬´-1¬ª.  Parmi les donn√©es collect√©es, l'attribut ¬´ageAccessType¬ª a √©t√© trouv√© avec juste une cardinalit√© de 5. Le mappage ressemblait √† ceci: <br><br><pre> <code class="python hljs">catalogue.age_rating = catalogue.age_rating.map({<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.4496666915</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.5927161087</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">0.6547073468</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0.6804096966000001</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>})</code> </pre><br>  <i>feature2</i> - classement de film converti √† partir de la recherche de film.  Initialement, au stade de l'EDA, l'id√©e que nous avons affaire √† une notation a √©t√© pr√©sent√©e par la corr√©lation du param√®tre avec le nombre total de vues.  Par la suite, la croyance que cette √©valuation provenait d'une recherche de films a confirm√© la pr√©sence du param√®tre ¬´kinopoiskRating¬ª dans les donn√©es du site. <br><br>  Un pas de plus vers le match!  Il reste maintenant √† trouver un moyen d'inverser la conversion du param√®tre <i>feature2</i> pr√©sent√© sous une forme anonyme. <br><br>  Voici √† quoi ressemble la distribution des valeurs dans <i>feature2</i> : <br><br><img src="https://habrastorage.org/webt/pq/pl/_d/pqpl_d1lpm0xed8limzxedbevfa.png"><br><br>  Et donc la distribution des valeurs des param√®tres <i>kinopoiskRating</i> : <br><br><img src="https://habrastorage.org/webt/wn/6a/np/wn6anpuxtav5ghzgq4tdme0lji8.png"><br><br>  Lorsque j'ai montr√© ces images √† mon coll√®gue Sasha, il a imm√©diatement vu qu'il s'agissait d'un degr√© de trois.  Trois math√©maticiens ne sont pas respect√©s, mais le nombre Pi est tr√®s pair.  En cons√©quence, cela s'est av√©r√© comme ceci: <br><br><img src="https://habrastorage.org/webt/tw/tt/4u/twtt4uravymgxe1lhxj2d9ydqly.png"><br><br>  Il semble que ce soit tout, mais pas tout √† fait.  Nous voyons des distributions identiques, mais les valeurs nominales et la quantit√© ne convergent toujours pas.  Si nous connaissions un certain nombre d'exemples de comparaison, il ne resterait plus qu'√† approximer une fonction lin√©aire pour trouver le facteur.  Mais nous ne les avions pas. <br><br>  Soit dit en passant, n'est pas le mot le plus appropri√©.  Nous avons besoin d'une solution avec une erreur presque √©gale √† z√©ro.  La pr√©cision des donn√©es collect√©es est de 2 caract√®res apr√®s le s√©parateur.  Si vous consid√©rez qu'il y a beaucoup de films avec une note de 6.xx et qu'il y a des films avec la m√™me note, alors vous devriez vous battre pour la pr√©cision ici. <br><br>  Que pouvez-vous essayer d'autre?  Vous pouvez vous fier aux valeurs minimales et maximales et utiliser MinMaxScaler, mais le manque de fiabilit√© de cette m√©thode soul√®ve imm√©diatement des doutes.  Permettez-moi de vous rappeler que le nombre de films n'a pas co√Øncid√© au d√©part, et notre jeu de donn√©es est historique, et l'√©tat actuel sur le site.  C'est-√†-dire  il n'y a aucune garantie que les films avec les cotes minimales et maximales dans les deux groupes sont identiques (il s'est av√©r√© qu'ils avaient une limite d'√¢ge diff√©rente, et la dur√©e ne correspondait pas au mot ¬´compl√®tement¬ª), ainsi que la fr√©quence de mise √† jour OKKO dans API de classement de recherche de films changeant quotidiennement <br><br>  Il est donc devenu clair que j'avais besoin de plus d'attributs pour l'appariement. <br><br>  <b>Quoi d'autre est int√©ressant?</b> <br><br>  <i>feature1</i> est une sorte de date.  En th√©orie, pour les dates, les organisateurs ont promis la pr√©servation de la s√©paration des √©tats, ce qui impliquait une fonction lin√©aire.  En g√©n√©ral, la transformation aurait d√ª √™tre identique √† l'attribut <i>ts</i> pour les matrices d'interaction.  Si vous regardez la distribution des films par fonction_1 ... <br><br><img src="https://habrastorage.org/webt/q2/94/dn/q294dngcpjgbfdgxcpwsrsv-1lu.png"><br><br>  ... puis l'hypoth√®se de la date de sortie du film est imm√©diatement balay√©e.  L'intuition sugg√®re que le nombre de films produits par l'industrie devrait augmenter avec le temps.  Ceci est confirm√© ci-dessous. <br><br>  Il y a 14 attributs dans les donn√©es que nous avons re√ßues du site.  En fait, malheureusement, les valeurs n'√©taient contenues que pour les √©l√©ments suivants: <br><br><img src="https://habrastorage.org/webt/wg/bw/64/wgbw64outbnbatpbee2vt5ge8y0.png"><br><br><img src="https://habrastorage.org/webt/5t/ba/pw/5tbapwosxnjwma2wxnznoj3ntfm.png"><br><br><img src="https://habrastorage.org/webt/rj/l8/jb/rjl8jbpximeqbwahvzmrdbummm4.png"><br><br>  Aucun des exemples ci-dessus n'est similaire √† <i>feature_1</i> .  Eh bien, il n'y avait plus d'id√©es de comparaison, et il semble que toute cette agitation avec cette t√¢che ait √©t√© vaine.  Bien s√ªr, j'ai entendu parler de concours, o√π les gars ont annot√© les donn√©es manuellement, mais pas quand il s'agit de centaines et de milliers de copies. <br><br><h3>  Solution </h3><br>  <b>1. Mod√®les simples</b> <br><br>  R√©alisant que tout n'est pas si simple, j'ai commenc√© √† travailler humblement avec ce qui est.  Pour commencer, je voulais commencer par un simple.  J'ai essay√© plusieurs solutions souvent utilis√©es dans l'industrie, √† savoir: le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">filtrage collaboratif</a> (dans notre cas bas√© sur les items) et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">factorisation des matrices</a> . <br><br>  La communaut√© utilise largement quelques biblioth√®ques python adapt√©es √† ces t√¢ches: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">implicite</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LightFM</a> .  Le premier est capable de factoriser bas√© sur ALS, ainsi que sur le filtrage collaboratif du plus proche voisin avec plusieurs options pour pr√©traiter la matrice article-article.  Le second a deux facteurs distinctifs: <br><br><ul><li>  La factorisation est bas√©e sur SGD, ce qui permet d'utiliser des fonctions de perte bas√©es sur l'√©chantillonnage, y compris <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WARP</a> . </li><li>  Il utilise une approche hybride, combinant des informations sur les attributs utilisateur et les √©l√©ments du mod√®le de telle sorte que le vecteur latent de l'utilisateur soit la somme des vecteurs latents de ses attributs.  Et de m√™me pour les articles.  Cette approche devient extr√™mement pratique en cas de probl√®me de d√©marrage √† froid pour l'utilisateur / l'article. </li></ul><br>  Nous n'avions aucun attribut utilisateur (√† part la possibilit√© de les afficher en fonction de l'interaction avec les films), j'ai donc utilis√© uniquement les attributs des √©l√©ments. <br><br>  Au total, 6 r√©glages sont all√©s √©num√©rer les param√®tres.  Une combinaison de trois matrices a √©t√© utilis√©e comme matrice d'interaction, o√π les √©valuations ont √©t√© converties en binaire.  R√©sultats comparatifs avec les meilleurs hyperparam√®tres pour chaque param√®tre dans le tableau ci-dessous. <br><div class="scrollable-table"><table><tbody><tr><td>  <b>Mod√®le</b> </td><td>  <b>Test MNAP @ 20</b> </td></tr><tr><td>  SLA implicite </td><td>  0,02646 </td></tr><tr><td>  Cosinus implicite kNN CF </td><td>  <b>0,03170</b> </td></tr><tr><td>  TFIDF kNN CF implicite </td><td>  0,03113 </td></tr><tr><td>  LightFM (sans caract√©ristiques de l'article), perte de BPR </td><td>  0,02567 </td></tr><tr><td>  LightFM (sans caract√©ristiques de l'article), perte WARP </td><td>  0,02632 </td></tr><tr><td>  LightFM avec caract√©ristiques de l'objet, perte WARP </td><td>  0,02635 </td></tr></tbody></table></div><br>  Comme vous pouvez le voir, le filtrage collaboratif classique s'est r√©v√©l√© bien meilleur que les autres mod√®les.  Pas parfait, mais beaucoup n'est pas exig√© de la ligne de base.  Soumettre avec cette configuration a donn√© 0,03048 sur le classement public.  Je ne me souviens pas de la position √† ce moment-l√†, mais au moment de la cl√¥ture de la comp√©tition, cette soumission aurait certainement atteint le top 80 et fourni une m√©daille de bronze. <br><br>  <b>2. Bonjour Boosting</b> <br><br>  Quoi de mieux qu'un mod√®le?  Correct: plusieurs mod√®les. <br><br>  Par cons√©quent, l'option suivante √©tait l'ensemble ou, dans le contexte des recommandations, un mod√®le de classement du deuxi√®me niveau.  En guise d'approche, j'ai pris <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article des gars d'Avito.  Il semble cuire strictement selon la recette, en remuant et en assaisonnant p√©riodiquement avec les attributs des films.  La seule d√©viation √©tait le nombre de candidats: j'ai pris le top 200 de LightFM, car  avec 500 000 utilisateurs, plus simplement ne correspondait pas √† la m√©moire. <br><br>  En cons√©quence, la vitesse que j'ai obtenue lors de la validation √©tait pire que sur un mod√®le. <br><br>  Apr√®s plusieurs jours d'exp√©rimentation, la r√©alisation est venue que rien ne fonctionnait et que rien ne fonctionnerait tout seul.  Ou je ne sais pas comment le faire cuire (spoiler: la bonne deuxi√®me r√©ponse).  Qu'est-ce que je fais mal?  Deux raisons me sont venues √† l'esprit: <br><br><ul><li>  D'une part, prendre les 200 premiers du mod√®le de premier niveau est judicieux du point de vue de la g√©n√©ration d'√©chantillons ¬´durs n√©gatifs¬ª, c'est-√†-dire  ces films qui sont √©galement pertinents pour l'utilisateur, mais pas regard√©s par lui.  En revanche, certains de ces films peuvent √™tre visionn√©s pendant la p√©riode de test, et nous pr√©sentons ces exemples comme n√©gatifs.  Ensuite, j'ai d√©cid√© de r√©duire les risques de ce fait, en rev√©rifiant l'hypoth√®se avec l'exp√©rience suivante: j'ai pris tous les exemples positifs + al√©atoires pour l'√©chantillon d'apprentissage.  La vitesse sur l'√©chantillon d'essai ne s'est pas am√©lior√©e.  Ici, il est n√©cessaire de pr√©ciser que dans l'√©chantillonnage du test, il y avait √©galement des pr√©dictions sup√©rieures du mod√®le de premier niveau, car sur le classement, personne ne me dira tous les exemples positifs. </li><li>  Sur les 10 200 films disponibles dans le catalogue, seuls 8 296 films ont fait des interactions.  Pr√®s de 2 000 films ont √©t√© priv√©s de l'attention des utilisateurs, en partie parce qu'ils n'√©taient pas disponibles √† l'achat / √† la location / dans le cadre d'un abonnement.  Les gars du chat ont demand√© si des films inaccessibles pourraient devenir disponibles pendant la p√©riode de test.  La r√©ponse √©tait oui.  Il est d√©finitivement impossible de les jeter.  Ainsi, j'ai sugg√©r√© que pr√®s de 2 000 films suppl√©mentaires seront disponibles dans les 2 prochains mois.  Sinon, pourquoi les jeter dans l'ensemble de donn√©es? </li></ul><br>  <b>3. Neurones</b> <br><br>  Dans le paragraphe pr√©c√©dent, la question a √©t√© pos√©e: comment travailler avec des films pour lesquels il n'y a aucune interaction?  Oui, nous rappelons les caract√©ristiques des objets dans LightFM, mais comme nous nous en souvenons, elles ne sont pas entr√©es.  Quoi d'autre?  Neurones! <br><br>  L'arsenal open source poss√®de quelques biblioth√®ques de haut niveau assez populaires pour travailler avec des syst√®mes de recommandation: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spotlight</a> de Maciej Kula (auteur de LightFM) et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TensorRec</a> .  Le premier sous le capot PyTorch, le second - Tensorflow. <br><br>  Spotlight peut prendre en compte des ensembles de donn√©es implicites / explicites avec des neurones et des s√©quences de mod√®les.  Dans le m√™me temps, dans la factorisation ¬´pr√™te √† l'emploi¬ª, il n'y a aucun moyen d'ajouter des fonctionnalit√©s utilisateur / article, alors laissez-la tomber. <br><br>  TensorRec, en revanche, ne sait que factoriser et est un cadre int√©ressant: <br><br><ul><li>  graphique de repr√©sentation - une m√©thode de transformation (elle peut √™tre d√©finie diff√©rente pour l'utilisateur / l'√©l√©ment) des donn√©es d'entr√©e dans l'incorporation, en fonction des calculs dans le graphique de pr√©diction.  Le choix se compose de couches avec diff√©rentes options d'activation.  Il est √©galement possible d'utiliser une classe abstraite et de coller dans une transformation personnalis√©e, consistant en une s√©quence de couches de k√©ros. </li><li>  Le graphique de pr√©diction vous permet de s√©lectionner l'op√©ration √† la fin: votre produit scalaire pr√©f√©r√©, la distance euclidienne et le cosinus. </li><li>  perte - il y a aussi beaucoup de choix.  Nous avons √©t√© satisfaits de l'impl√©mentation de WMRB (essentiellement le m√™me WARP, ne sait apprendre que le batch et le distribu√©) </li></ul><br>  Plus important encore, TensorRec est capable de travailler avec des fonctionnalit√©s contextuelles, et en effet l'auteur admet qu'il a √©t√© √† l'origine inspir√© par l'id√©e de LightFM.  Voyons voir.  Nous prenons les interactions (uniquement les transactions) et les fonctionnalit√©s des articles. <br><br>  Nous envoyons √† la recherche de diff√©rentes configurations et attendons.  Par rapport √† LightFM, la formation et la validation prennent beaucoup de temps. <br><br>  De plus, deux inconv√©nients ont d√ª √™tre rencontr√©s: <br><br><ol><li>  Depuis la modification du drapeau d√©taill√©, la m√©thode <i>fit</i> n'a rien chang√© et aucun rappel n'a √©t√© fourni pour vous.  J'ai d√ª √©crire une fonction qui a √©t√© form√©e en interne √† une √©poque en utilisant la m√©thode <i>fit_partial</i> , puis <i>j'ai</i> ex√©cut√© la validation pour le train et le test (dans les deux cas, des √©chantillons ont √©t√© utilis√©s pour acc√©l√©rer le processus). </li><li>  En g√©n√©ral, l'auteur du framework est un grand gars et utilise tf.SparseTensor partout.  Cependant, il vaut la peine de comprendre qu'en tant que pr√©diction, y compris pour la validation, vous obtenez le r√©sultat en tant que vecteur dense avec la longueur n_items pour chaque utilisateur.  Deux conseils en d√©coulent: faire un cycle pour g√©n√©rer des pr√©dictions avec des lots (la m√©thode de la biblioth√®que n'a pas un tel param√®tre) avec un filtrage top-k et pr√©parer les bandes avec de la RAM. </li></ol><br>  En fin de compte, sur la meilleure option de configuration, j'ai r√©ussi √† presser 0,02869 sur mon √©chantillon de test.  Il y avait quelque chose de similaire √† LB. <br><br>  Eh bien, qu'est-ce que j'esp√©rais?  Que l'ajout de la non-lin√©arit√© aux fonctionnalit√©s de l'√©l√©ment donnera une double augmentation de la m√©trique?  C'est na√Øf. <br><br>  <b>4. Beck cette t√¢che</b> <br><br>  Alors attendez un instant.  Il semble que j'ai de nouveau jongl√© avec des neurones.  Quelle hypoth√®se avais-je envie de tester lors de mon entr√©e en activit√©?  L'hypoth√®se √©tait la suivante: ¬´Au cours des 2 prochains mois de la s√©lection diff√©r√©e, pr√®s de 2 000 nouveaux films seront vus au classement.  Certains d'entre eux auront une large part de vues. ¬ª <br><br>  Vous pouvez donc le v√©rifier en 2 √©tapes: <br><br><ol><li>  Ce serait bien de voir combien de films nous avons ajout√©s dans la p√©riode de test honn√™tement divis√©e par nous concernant le train.  Si nous ne prenons que les vues, alors les ¬´nouveaux¬ª films ne sont que 240 (!).  L'hypoth√®se a imm√©diatement trembl√©.  Il semble que l'achat de nouveau contenu ne puisse pas diff√©rer de ce montant d'une p√©riode √† l'autre. </li><li>  Nous finissons.  Nous avons la possibilit√© de former le mod√®le √† utiliser uniquement la pr√©sentation bas√©e sur les caract√©ristiques des √©l√©ments (dans LightFM, par exemple, cela se fait par d√©faut, si nous n'avons pas pr√©rempli la matrice d'attributs avec la matrice d'identit√©).  De plus, pour infreness on ne peut se soumettre qu'√† ce mod√®le (!) Nos films inaccessibles et jamais vus.  De ces r√©sultats, nous soumettons et obtenons 0,0000136. </li></ol><br>  Bingo!  Cela signifie que vous pouvez arr√™ter d'extraire la s√©mantique des attributs de film.  Soit dit en passant, plus tard, au DataFest, des gars d'OKKO ont d√©clar√© que la plupart du contenu inaccessible n'√©tait que de vieux films. <br><br>  Vous devez essayer quelque chose de nouveau et de nouveau - un ancien bien oubli√©.  Dans notre cas, pas compl√®tement oubli√©, mais ce qui s'est pass√© il y a quelques jours.  Filtrage collaboratif? <br><br>  <b>5. R√©glez la ligne de base</b> <br><br>  Comment puis-je aider la base de r√©f√©rence des FC? <br><br>  <b>Id√©e num√©ro 1</b> <br><br>  Sur Internet, j'ai trouv√© une pr√©sentation sur l'utilisation du test du rapport de vraisemblance pour filtrer les films mineurs. <br><br>  Ci-dessous, je vais laisser mon code python pour calculer le score LLR, que j'ai d√ª √©crire sur mon genou pour tester cette id√©e. <br><br><div class="spoiler">  <b class="spoiler_title">Calcul LLR</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.sparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csr_matrix <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tqdm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tqdm <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LLR</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interaction_matrix, interaction_matrix_2=None)</span></span></span><span class="hljs-function">:</span></span> interactions, lack_of_interactions = self.make_two_tables(interaction_matrix) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> interaction_matrix_2 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: interactions_2, lack_of_interactions_2 = self.make_two_tables(interaction_matrix_2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: interactions_2, lack_of_interactions_2 = interactions, lack_of_interactions self.num_items = interaction_matrix.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] self.llr_matrix = np.zeros((self.num_items, self.num_items)) <span class="hljs-comment"><span class="hljs-comment"># k11 - item-item co-occurrence self.k_11 = np.dot(interactions, interactions_2.T) # k12 - how many times row elements was bought without column elements self.k_12 = np.dot(interactions, lack_of_interactions_2.T) # k21 - how many times column elements was bought without row elements self.k_21 = np.dot(lack_of_interactions, interactions_2.T) # k22 - how many times elements was not bought together self.k_22 = np.dot(lack_of_interactions, lack_of_interactions_2.T) def make_two_tables(self, interaction_matrix): interactions = interaction_matrix if type(interactions) == csr_matrix: interactions = interactions.todense() interactions = np.array(interactions.astype(bool).T) lack_of_interactions = ~interactions interactions = np.array(interactions, dtype=np.float32) lack_of_interactions = np.array(lack_of_interactions, dtype=np.float32) return interactions, lack_of_interactions def entropy(self, k): N = np.sum(k) return np.nansum((k / N + (k == 0)) * np.log(k / N)) def get_LLR(self, item_1, item_2): k = np.array([[self.k_11[item_1, item_2], self.k_12[item_1, item_2]], [self.k_21[item_1, item_2], self.k_22[item_1, item_2]]]) LLR = 2 * np.sum(k) * (self.entropy(k) - self.entropy(np.sum(k, axis=0)) - self.entropy(np.sum(k, axis=1))) return LLR def compute_llr_matrix(self): for item_1 in range(self.num_items): for item_2 in range(item_1, self.num_items): self.llr_matrix[item_1, item_2] = self.get_LLR(item_1, item_2) if item_1 != item_2: self.llr_matrix[item_2, item_1] = self.llr_matrix[item_1, item_2] def get_top_n(self, n=100, mask=False): filtered_matrix = self.llr_matrix.copy() for i in tqdm(range(filtered_matrix.shape[0])): ind = np.argpartition(filtered_matrix[i], -n)[-n:] filtered_matrix[i][[x for x in range(filtered_matrix.shape[0]) if x not in ind]] = 0 if mask: return filtered_matrix != 0 else: return filtered_matrix</span></span></code> </pre><br></div></div><br>  Par cons√©quent, la matrice r√©sultante peut √™tre utilis√©e comme masque pour ne laisser que les interactions les plus importantes et il y a deux options: utiliser le seuil ou laisser les √©l√©ments top-k avec la valeur la plus √©lev√©e.  De la m√™me mani√®re, la combinaison de plusieurs influences sur un achat en une seule vitesse est utilis√©e pour classer les articles, en d'autres termes, le test montre √† quel point il est important, par exemple, d'ajouter des favoris concernant une √©ventuelle conversion en achat.  Cela semble prometteur, mais l'utilisation a montr√© que le filtrage utilisant le score LLR donne une augmentation tr√®s miniature, et la combinaison de plusieurs scores ne fait qu'aggraver le r√©sultat.  Apparemment, la m√©thode n'est pas pour ces donn√©es.  Parmi les avantages, je peux seulement noter que, tout en trouvant comment mettre en ≈ìuvre cette id√©e, j'ai d√ª creuser dans l'implicite sous le capot. <br><br>  Un exemple d'application implicite de cette logique personnalis√©e sera laiss√© sous le chat. <br><br><div class="spoiler">  <b class="spoiler_title">Modification de la matrice en implicite</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   LLR scores.     n_items * n_items. llr = LLR(train_csr, train_csr) llr.compute_llr_matrix() #     id, ,      llr_based_mask = llr.get_top_n(n=500, mask=True) #     ,  - CosineRecommender. model = CosineRecommender(K=10200) model.fit(train_csr.T) # model.similarity -   co-occurrence (  Cosine - ).        . masked_matrix = np.array(model.similarity.todense()) * llr_based_mask #  fit()  scorer     model.similarity. #     . model.scorer = NearestNeighboursScorer(csr_matrix(masked_matrix)) #      :   recommend   . test_predict = {} for id_ in tqdm(np.unique(test_csr.nonzero()[0])): test_predict[id_] = model.recommend(id_, train_csr, filter_already_liked_items=True, N=20) #   tuples (item_id, score),   id  . test_predict_ids = {k: [x[0] for x in v] for k, v in test_predict.items()} #       / ,     ,   Cython.</span></span></code> </pre> <br></div></div><br>  <b>Id√©e num√©ro 2</b> <br><br>  Une autre id√©e est venue qui pourrait am√©liorer les pr√©visions sur le filtrage collaboratif simple.  L'industrie utilise souvent une sorte de fonction d'amortissement pour les anciennes estimations, mais nous avons un cas pas si simple.  Probablement, vous devez en quelque sorte prendre en compte 2 cas possibles: <br><br><ol><li>  Les utilisateurs qui regardent le service sont pour la plupart nouveaux </li><li>  "Examinateurs."  Autrement dit, ceux qui sont venus relativement r√©cemment et peuvent regarder des films auparavant populaires. </li></ol><br>  Ainsi, il est possible de diviser automatiquement le composant collaboratif en deux groupes diff√©rents.  Pour ce faire, j'ai invent√© une fonction qui, au lieu de valeurs implicites d√©finies sur ¬´1¬ª ou ¬´0¬ª √† l'intersection de l'utilisateur et du film, une valeur montrant √† quel point ce film est important dans l'historique de visualisation de l'utilisateur. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3B1;</mo></mrow><mo>&amp;#x2217;</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3B2;</mo></mrow><mo>&amp;#x2217;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x394;</mo></mrow><mi>W</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.449ex" height="2.66ex" viewBox="0 -832 23873.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6F" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6E" x="919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-66" x="1519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-69" x="2070" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-61" x="2415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6E" x="2945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-63" x="3545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-65" x="3979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-28" x="4445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-66" x="4835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-69" x="5385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6C" x="5731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6D" x="6029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-29" x="6908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-3D" x="7575" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-3B1" x="8631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-2217" x="9494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-53" x="10217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-74" x="10862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-61" x="11224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-72" x="11753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-74" x="12205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-54" x="12566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-69" x="13271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6D" x="13616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-65" x="14495" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-2B" x="15183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-3B2" x="16184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-2217" x="16973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMAIN-394" x="17695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-57" x="18529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-61" x="19577" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-74" x="20107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-63" x="20468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-68" x="20902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-54" x="21478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-69" x="22183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-6D" x="22528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhgvL3LOaRnGjCVeLoiFzRPaNZbLOw#MJMATHI-65" x="23407" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo stretchy="false">(</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>Œ±</mo></mrow><mo>‚àó</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>Œ≤</mo></mrow><mo>‚àó</mo><mrow class="MJX-TeXAtom-ORD"><mo>Œî</mo></mrow><mi>W</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> confiance (film) = Œ± * StartTime + Œ≤ * ŒîWatchTime </script></p><br>  o√π <i>StartTime</i> est la date de sortie du film et <i>ŒîWatchTime</i> est la diff√©rence entre la date de sortie et la date que l'utilisateur a regard√©e, et <i>Œ±</i> et <i>Œ≤</i> sont des hyperparam√®tres. <br><br>  Ici, le premier terme est charg√© d'augmenter la vitesse des films r√©cemment sortis, et le second est de prendre en compte la d√©pendance des utilisateurs aux vieux films.  Si un film est sorti il ‚Äã‚Äãy a longtemps et que l'utilisateur l'a imm√©diatement achet√©, alors aujourd'hui, ce fait ne devrait pas √™tre beaucoup pris en compte.  S'il s'agit d'une nouveaut√©, nous devons la recommander √† un plus grand nombre d'utilisateurs qui regardent √©galement de nouveaux articles.  Si le film est assez ancien et que l'utilisateur ne l'a regard√© que maintenant, cela peut √©galement √™tre important pour ceux comme lui. <br><br>  Il reste un peu - pour trier les coefficients <i>Œ±</i> et <i>Œ≤</i> .  Partez pour la nuit et le travail est fait.  Il n'y avait aucune hypoth√®se sur la plage du tout, elle √©tait donc initialement grande et voici les r√©sultats d'une recherche optimale locale. <br><br><img src="https://habrastorage.org/webt/ej/iy/qk/ejiyqkpfmhz43nlifcd3o_zv40o.png"><br><br>  En utilisant cette id√©e, un mod√®le simple sur une matrice a donn√© une vitesse de 0,03627 sur la validation locale et de 0,03685 sur le LB public, ce qui ressemble imm√©diatement √† un bon coup de pouce par rapport aux r√©sultats pr√©c√©dents.  √Ä cette √©poque, cela m'a amen√© au top 20. <br><br>  <b>Id√©e num√©ro 3</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'id√©e finale √©tait que les vieux films que l'utilisateur avait regard√©s pendant longtemps pouvaient √™tre ignor√©s du tout. </font><font style="vertical-align: inherit;">Cette m√©thode de d√©pistage de la mucoviscidose est souvent appel√©e √©lagage. </font><font style="vertical-align: inherit;">Passons en revue plusieurs valeurs et testons l'hypoth√®se: </font></font><br><br><img src="https://habrastorage.org/webt/pk/xd/uk/pkxduk8vw3eyyojevyibbesixbi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'av√®re que pour les utilisateurs ayant une longue histoire, il est logique de ne laisser que les 25 derni√®res interactions. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au total, en travaillant avec les donn√©es, nous avons atteint une vitesse de 0,040312 sur l'√©chantillon de test local, et la soumission avec ces param√®tres a donn√© le r√©sultat en 0,03870 et 0,03990 sur les parties publiques / priv√©es, respectivement, et m'a fourni la 14e place et un t-shirt.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Segments reconnus </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'ex√©cution de projets dans le cahier jupyter est un travail ingrat. </font><font style="vertical-align: inherit;">Vous √™tes constamment perdu dans votre code, qui est dispers√© sur plusieurs cahiers. </font><font style="vertical-align: inherit;">Et le suivi des r√©sultats uniquement dans les cellules de sortie est compl√®tement dangereux en termes de reproductibilit√©. </font><font style="vertical-align: inherit;">Par cons√©quent, les data -entistes s'en sortent autant qu'ils le peuvent. </font><font style="vertical-align: inherit;">Mes coll√®gues et moi avons cr√©√© notre cadre de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">science des donn√©es de d√©coupe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Oc√©an. </font><font style="vertical-align: inherit;">Il s'agit d'un outil de cr√©ation de structure et de gestion de projet. </font><font style="vertical-align: inherit;">Vous pouvez lire ses avantages dans notre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">En grande partie gr√¢ce √† la bonne approche de la s√©paration des exp√©riences, je n'ai pas perdu la t√™te et je ne me suis pas tromp√© lors des tests d'hypoth√®ses.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le secret du succ√®s (pas le mien) </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme il est devenu connu imm√©diatement apr√®s l'ouverture de la partie priv√©e du classement, presque tous les gars avec des solutions de pointe ont utilis√© des mod√®les simples au premier niveau et des fonctionnalit√©s suppl√©mentaires au second. Comme je l'ai compris plus tard, ma perforation dans cette exp√©rience √©tait principalement un moyen de diviser l'√©chantillon lors de la formation du mod√®le de deuxi√®me niveau. J'ai essay√© ceci: </font></font><br><br><img src="https://habrastorage.org/webt/vq/c1/ds/vqc1dsjoq63esgrlttp3v9-ky2g.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©alisant que c'√©tait stupide, j'ai commenc√© √† chercher des m√©thodes assez sophistiqu√©es, comme celle-ci: </font></font><br><br><img src="https://habrastorage.org/webt/p3/im/w3/p3imw3yj1ip5bvqorv_uexldawu.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, j'ai trouv√© le bon chemin sur la diapositive de la pr√©sentation d'Evgeny Smirnov, qui a pris la 2e place. Il s'agissait d'une scission des utilisateurs dans la partie test du mod√®le de premier niveau. Cela semble banal, mais cette id√©e ne m'est pas venue √† l'esprit.</font></font><br><br><img src="https://habrastorage.org/webt/i9/rs/gw/i9rsgwcjimnuhjbgqcpmlyaj2rk.jpeg"><br><br><h3>  Conclusion </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les concours sont des concours. </font><font style="vertical-align: inherit;">Les mod√®les lourds donnent vraiment plus de pr√©cision, surtout si vous pouvez les faire cuire. </font><font style="vertical-align: inherit;">Cette exp√©rience sera-t-elle utile? </font><font style="vertical-align: inherit;">Au lieu d'une r√©ponse, je dirai qu'apr√®s la fin du concours, les organisateurs ont jet√© un spoiler - un graphique d'importance des fonctionnalit√©s du mod√®le de produit, selon lequel il est √©vident qu'ils utilisent la m√™me approche ¬´r√©ussie¬ª en production. </font><font style="vertical-align: inherit;">Il s'av√®re qu'ils coulent √©galement dans la prod. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'av√®re que pour moi l'exp√©rience de participation a √©t√© vraiment utile professionnellement. </font><font style="vertical-align: inherit;">Merci d'avoir lu l'article; </font><font style="vertical-align: inherit;">Les questions, suggestions et commentaires sont les bienvenus.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr461055/">https://habr.com/ru/post/fr461055/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr461045/index.html">Obtenez un extrait de Rosreestr via FSIS USRN et python. Partie 1</a></li>
<li><a href="../fr461047/index.html">√âcrire ou ne pas √©crire. Lettres aux autorit√©s lors des √©v√©nements</a></li>
<li><a href="../fr461049/index.html">ONYX BOOX Faust - Celui qui cherche n'est pas oblig√© d'errer</a></li>
<li><a href="../fr461051/index.html">Top 10 des erreurs les plus courantes que j'ai rencontr√©es dans les projets Go</a></li>
<li><a href="../fr461053/index.html">Nous connectons des cartes en ligne au navigateur sur le smartphone. Partie 2 - Cartes vectorielles</a></li>
<li><a href="../fr461057/index.html">Cha√Ænes de t√©l√©gramme sur le d√©veloppement de jeux</a></li>
<li><a href="../fr461059/index.html">√âcrire une application Android pour les fans de films - Partie 1 (Prototypage)</a></li>
<li><a href="../fr461061/index.html">Alliages de magn√©sium, fronti√®res jumelles et s√©gr√©gation</a></li>
<li><a href="../fr461063/index.html">Interaction de R avec des bases de donn√©es sur l'exemple de Microsoft SQL Server et d'autres SGBD</a></li>
<li><a href="../fr461067/index.html">Les 65 principales questions SQL des entretiens d'embauche auxquelles vous devriez vous pr√©parer en 2019. Partie I</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>