<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ñ üè´ üì§ 3. Elastic Stack: Sicherheitsprotokollanalyse. Dashboards ü¶Ñ üë∑ ü§Ωüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In den vorherigen Artikeln haben wir uns ein wenig mit dem Elk-Stack und dem Einrichten der Logstash-Konfigurationsdatei f√ºr den Log-Parser vertraut g...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>3. Elastic Stack: Sicherheitsprotokollanalyse. Dashboards</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/482054/"><img src="https://habrastorage.org/webt/1h/r_/da/1hr_dazcr60epg8j9trtakaflhq.png"><br><br>  In den vorherigen Artikeln haben wir uns ein wenig mit dem Elk-Stack und dem Einrichten der Logstash-Konfigurationsdatei f√ºr den Log-Parser vertraut gemacht. In diesem Artikel werden wir uns mit den wichtigsten Aspekten der Analyse befassen, was Sie vom System aus sehen m√∂chten und wof√ºr alles erstellt wurde - dies sind Diagramme und Tabellen, die zu <b>Dashboards zusammengefasst wurden</b> .  Heute werden wir uns das <b>Kibana-</b> Visualisierungssystem genauer ansehen, √ºberlegen, wie Diagramme und Tabellen erstellt werden, und als Ergebnis ein einfaches Dashboard auf der Grundlage der Protokolle der Check Point-Firewall erstellen. <br><a name="habracut"></a><br>  Der erste Schritt bei der Arbeit mit Kibana ist die Erstellung eines Indexmusters. Logischerweise ist dies eine Datenbank mit Indizes, die nach einem bestimmten Prinzip vereinheitlicht sind.  Dies ist nat√ºrlich nur eine Einstellung, damit Kibana bequemer gleichzeitig nach Informationen zu allen Indizes sucht.  Sie wird durch Abgleichen der Zeichenfolge angegeben, z. B. ‚Äûcheckpoint- *‚Äú und des Namens des Index.  Zum Beispiel passt "checkpoint-2019.12.05" zum Muster, aber nur "checkpoint" ist nicht mehr da.  Es ist erw√§hnenswert, dass Sie nicht gleichzeitig nach Informationen zu verschiedenen Indexmustern suchen k√∂nnen. Etwas sp√§ter in den folgenden Artikeln werden wir feststellen, dass API-Anforderungen entweder √ºber den Namen des Index oder nur √ºber eine Zeile des Musters erfolgen. Das Bild kann angeklickt werden: <br><br> <a href=""><img src="https://habrastorage.org/webt/64/nm/tb/64nmtbsfwl-qfysx5n6km6iwr3m.png"></a> <br><br>  Danach √ºberpr√ºfen wir im Discover-Men√º, ob alle Protokolle indiziert sind und der richtige Parser konfiguriert ist.  Wenn Inkonsistenzen festgestellt werden, z. B. wenn der Datentyp von einer Zeichenfolge in eine Ganzzahl ge√§ndert wird, m√ºssen Sie die Logstash-Konfigurationsdatei bearbeiten. Infolgedessen werden neue Protokolle korrekt aufgezeichnet.  Damit die alten Protokolle vor der √Ñnderung die gew√ºnschte Form annehmen, hilft nur der Neuindizierungsprozess. In nachfolgenden Artikeln wird dieser Vorgang ausf√ºhrlicher behandelt.  Stellen Sie sicher, dass alles in Ordnung ist und das Bild anklickbar ist: <br><br> <a href=""><img src="https://habrastorage.org/webt/y1/-h/jk/y1-hjkcxrtdpuufzqxqdpqhlvha.png"></a> <br><br>  Die Protokolle waren vorhanden, dh Sie k√∂nnen mit dem Erstellen von Dashboards beginnen.  Basierend auf den Dashboard-Analysen von Sicherheitsprodukten k√∂nnen Sie den Status der Informationssicherheit in der Organisation verstehen, die Sicherheitsanf√§lligkeiten in der aktuellen Richtlinie klar erkennen und M√∂glichkeiten zur Beseitigung dieser Sicherheitsanf√§lligkeiten weiterentwickeln.  Lassen Sie uns ein kleines Dashboard mit verschiedenen Visualisierungstools erstellen.  Das Dashboard besteht aus 5 Komponenten: <br><br><ol><li>  Tabelle zur Berechnung der Gesamtzahl der Protokolle nach Blades </li><li>  IPS-kritische Signaturtabelle </li><li>  Kreisdiagramm f√ºr Bedrohungsschutzereignisse </li><li>  Diagramm der am h√§ufigsten besuchten Websites </li><li>  Diagramm zur Verwendung der gef√§hrlichsten Anwendungen </li></ol><br>  Um Visualisierungsformen zu erstellen, m√ºssen Sie im Men√º <b>Visualisieren</b> die gew√ºnschte Form ausw√§hlen, die erstellt werden soll.  Gehen wir in Ordnung. <br><br><h3>  Tabelle zur Berechnung der Gesamtzahl der Protokolle nach Blades </h3><br>  W√§hlen Sie dazu die <b>Datentabellenform</b> aus, ziehen Sie sie in das Snap-In, um Diagramme zu erstellen, und legen Sie die Formeinstellungen links und rechts in den aktuellen Einstellungen fest.  Zun√§chst werde ich zeigen, wie die fertige Tabelle aussehen wird. Anschlie√üend werden die Einstellungen durchgegangen. Das Bild kann angeklickt werden: <br><br> <a href=""><img src="https://habrastorage.org/webt/h6/qh/zs/h6qhzsfawr4qslqtdfybm3zvzsw.png"></a> <br><br>  Detailliertere Formeinstellungen, das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/pe/2j/d2/pe2jd28os3xkfs70wi9jl--0kcc.png"></a> <br><br>  Lassen Sie uns die Einstellungen analysieren. <br><br>  Die <b>Metrik ist</b> anf√§nglich konfiguriert. Dies ist der Wert, mit dem alle Felder aggregiert werden.  Metriken werden basierend auf den Werten berechnet, die auf die eine oder andere Weise aus den Dokumenten extrahiert wurden.  Werte werden normalerweise aus Dokumentfeldern extrahiert, k√∂nnen aber auch mithilfe von Skripten generiert werden.  In diesem Fall geben Sie <b>Aggregation: Count</b> (die Gesamtzahl der Protokolle) ein. <br><br>  Danach teilen wir die Tabelle in Segmente (Felder) auf, nach denen die Metrik betrachtet wird.  Buckets Tuning f√ºhrt diese Funktion aus, die wiederum aus 2 Tuning-Optionen besteht: <br><br><ol><li>  Zeilen teilen - Spalten hinzuf√ºgen und anschlie√üend die Tabelle in Zeilen teilen </li><li>  split table - Aufteilung in mehrere Tabellen nach den Werten eines bestimmten Feldes. </li></ol><br>  In <b>Buckets</b> k√∂nnen Sie mehrere Unterteilungen hinzuf√ºgen, um mehrere Spalten oder Tabellen zu erstellen. Die Einschr√§nkungen sind hier eher logisch.  In der Aggregation k√∂nnen Sie ausw√§hlen, nach welcher Methode die Segmentierung erfolgen soll: IPv4-Bereich, Datumsbereich, Begriffe usw.  Die unterhaltsamste Auswahl sind die <b>Terms</b> und <b>Significant Terms</b> . Die Aufteilung in Segmente erfolgt nach den Werten eines bestimmten Indexfeldes, die Differenz zwischen ihnen ist die Anzahl der zur√ºckgegebenen Werte und deren Anzeige.  Da die Tabelle durch den Namen der Blades geteilt werden soll, w√§hlen Sie das Feld <b>product.keyword aus</b> und legen Sie die Gr√∂√üe in H√∂he von 25 zur√ºckgegebenen Werten fest. <br><br>  Anstelle von Zeichenfolgen verwendet elasticsearch zwei Datentypen - <b>text</b> und <b>keyword</b> .  Wenn Sie eine Volltextsuche durchf√ºhren m√∂chten, m√ºssen Sie den Texttyp verwenden, was sehr praktisch ist, wenn Sie Ihren Suchdienst schreiben. Sie suchen beispielsweise nach einer Erw√§hnung eines Wortes in einem bestimmten Feldwert (Text).  Wenn Sie nur eine genaue √úbereinstimmung w√ºnschen, sollten Sie den Keyword-Typ verwenden.  Der Keyword-Datentyp sollte auch f√ºr Felder verwendet werden, die sortiert oder aggregiert werden m√ºssen, in unserem Fall also. <br><br>  Als Ergebnis berechnet Elasticsearch die Anzahl der Protokolle f√ºr eine bestimmte Zeit mit der Aggregation nach Wert im Produktfeld.  In der benutzerdefinierten Beschriftung legen wir den Namen der Spalte fest, die in der Tabelle angezeigt wird, legen die Zeit fest, f√ºr die die Protokolle gesammelt werden, beginnen mit dem Zeichnen - Kibana sendet eine Anfrage an elasticsearch, wartet auf eine Antwort und visualisiert dann die empfangenen Daten.  Der Tisch ist fertig! <br><br><h3>  Kreisdiagramm f√ºr Bedrohungsschutzereignisse </h3><br>  Von besonderem Interesse ist die Information, und wie viele in der aktuellen Sicherheitsrichtlinie generell in Prozent Reaktionen auf Informationssicherheitsvorf√§lle <b>erkennen</b> und <b>verhindern</b> .  F√ºr diesen Fall ist ein Kreisdiagramm gut geeignet.  W√§hlen Sie in Visualisieren - <b>Kreisdiagramm</b> .  Auch in der Metrik setzen wir die Aggregation nach der Anzahl der Protokolle.  Setzen Sie in Buckets Terms =&gt; action. <br><br>  Anscheinend ist alles in Ordnung, aber als Ergebnis werden die Werte f√ºr alle Blades angezeigt. Sie m√ºssen nur nach den Blades filtern, die als Teil der Bedrohungsverh√ºtung funktionieren.  Daher m√ºssen wir den <b>Filter</b> so konfigurieren, dass nur auf den Blades, die f√ºr Sicherheitsvorf√§lle verantwortlich sind, nach Informationen gesucht wird - Produkt: ("Anti-Bot" ODER "New Anti-Virus" ODER "DDoS Protector" ODER "SmartDefense" ODER "Threat Emulation").  Das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/te/1p/wo/te1pwo7es8c1nnssm5tuhtdfxog.png"></a> <br><br>  Und detailliertere Einstellungen, das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/20/yf/xs/20yfxs1tflzd3ja05bulm9s8pco.png"></a> <br><br><h3>  IPS-Ereignistabelle </h3><br>  Unter dem Gesichtspunkt der Informationssicherheit ist es au√üerdem sehr wichtig, Ereignisse auf den <b>IPS-</b> und <b>Threat Emulation-</b> Blades anzuzeigen und zu √ºberpr√ºfen, die <b>von der</b> aktuellen Richtlinie <b>nicht blockiert werden</b> , um anschlie√üend entweder die Signatur zu √§ndern, um zu verhindern, dass Datenverkehr g√ºltig ist, oder die Signatur nicht zu √ºberpr√ºfen.  Wir erstellen die Tabelle wie im ersten Beispiel, nur mit dem Unterschied, dass wir mehrere Spalten erstellen: protections.keyword, severity.keyword, product.keyword, originsicname.keyword.  Stellen Sie sicher, dass Sie den Filter so konfigurieren, dass nur auf den Blades, die f√ºr Sicherheitsvorf√§lle verantwortlich sind, nach Informationen gesucht wird - Produkt: (‚ÄûSmartDefense‚Äú ODER ‚ÄûThreat Emulation‚Äú).  Das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/gu/pt/q_/guptq_dmmsig3ueo2xoahhgh_ts.png"></a> <br><br>  Detailliertere Einstellungen, das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/7h/va/ma/7hvamanbqtsl3vvkbk_r_wgpu4e.png"></a> <br><br><h3>  Diagramme f√ºr die beliebtesten besuchten Websites </h3><br>  Dazu erstellen Sie eine Form - <b>vertikale Leiste</b> .  Wir verwenden auch die Metrikanzahl (die Y-Achse) und auf der X-Achse verwenden wir den Namen der besuchten Sites als appi_name als Werte.  Hier gibt es einen kleinen Trick: Wenn Sie die Einstellungen in der aktuellen Version ausf√ºhren, werden alle Sites in der Grafik in einer Farbe markiert. Um sie farblich hervorzuheben, verwenden wir eine zus√§tzliche Einstellung: "Serie teilen", mit der Sie die fertige Spalte in einige weitere Werte aufteilen k√∂nnen nat√ºrlich aus dem ausgew√§hlten bereich!  Diese Unterteilung kann entweder als eine mehrfarbige Spalte gem√§√ü den Werten im Stapelmodus oder im normalen Modus verwendet werden, um mehrere Spalten gem√§√ü einem bestimmten Wert von der X-Achse aus zu erstellen. In diesem Fall verwenden wir denselben Wert wie die X-Achse macht es m√∂glich, alle Spalten mehrfarbig zu gestalten, von oben rechts werden sie durch Farben angezeigt.  In dem von uns eingestellten Filter - Produkt: "URL Filtering" ist das Bild anklickbar, um nur Informationen zu besuchten Seiten zu sehen: <br><br> <a href=""><img src="https://habrastorage.org/webt/mm/7z/eu/mm7zeuhxbi7mycsbe9iwhfvj-pi.png"></a> <br><br>  Einstellungen: <br><br> <a href=""><img src="https://habrastorage.org/webt/ab/fq/s8/abfqs80dexym6ks4kt_ktyzzzzk.png"></a> <br><br><h3>  Tabelle zur Verwendung der gef√§hrlichsten Anwendungen </h3><br>  Dazu erstellen Sie eine Form - vertikale Leiste.  Wir verwenden auch die Metrikanzahl (die Y-Achse) und auf der X-Achse verwenden wir den Namen der verwendeten Anwendungen, "appi_name", als Werte.  Das wichtigste ist die Filteraufgabe - Produkt: "Application Control" UND app_risk: (4 ODER 5 ODER 3) UND Aktion: "accept".  Wir filtern die Protokolle nach dem Application Control Blade. Wir verwenden nur Sites, die als Sites mit dem Risiko "Kritisch", "Hoch", "Mittel" eingestuft sind, und nur, wenn der Zugriff auf diese Sites zul√§ssig ist.  Das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/2q/nz/82/2qnz82z39bhtf-eohfvqcfqae-0.png"></a> <br><br>  Einstellungen, anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/pb/aj/6s/pbaj6sk3l1qbc8cgluy4yiaj1qy.png"></a> <br><br><h3>  Dashboard </h3><br>  Das Anzeigen und Erstellen von Dashboards befindet sich in einem separaten Men√ºelement - <b>Dashboard</b> .  Hier ist alles einfach, es wird ein neues Dashboard erstellt, es wird eine Visualisierung hinzugef√ºgt, alles wird an seinen Platz gestellt! <br><br>  Wir erstellen ein Dashboard, nach dem es m√∂glich sein wird, die Grundsituation des IS-Status in der Organisation zu verstehen, nat√ºrlich nur auf der Check Point-Ebene, das Bild ist anklickbar: <br><br> <a href=""><img src="https://habrastorage.org/webt/ct/9p/lv/ct9plv4cwbpt6ammjhqmn6x76fe.png"></a> <br><br>  Anhand dieser Grafiken k√∂nnen wir nachvollziehen, welche kritischen Signaturen in der Firewall nicht blockiert sind, wohin Benutzer gehen und welche Anwendungen am gef√§hrlichsten sind. <br><br><h3>  Fazit </h3><br>  Wir haben die M√∂glichkeiten der grundlegenden Visualisierung in Kibana untersucht und ein Dashboard erstellt, aber dies ist nur ein kleiner Teil.  Im weiteren Verlauf werden wir die Konfiguration von Maps separat betrachten, mit dem Elasticsearch-System arbeiten, API-Anforderungen, Automatisierung und vieles mehr kennenlernen! <br><br>  Also bleibt dran ( <a href="https://t.me/tssolution">Telegramm</a> , <a href="https://www.facebook.com/groups/tssolution.info/">Facebook</a> , <a href="https://vk.com/ts_solution">VK</a> , <a href="https://tssolution.ru/blog">TS Solution Blog</a> ), <a href="https://zen.yandex.ru/id/5c7d2162fa818600ae386a52">Yandex.Zen</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482054/">https://habr.com/ru/post/de482054/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482040/index.html">Enth√§lt Profiling-Programme in C ++</a></li>
<li><a href="../de482042/index.html">Arbeiten mit der Newtonsoft.Json-Bibliothek anhand eines realen Beispiels. Teil 2</a></li>
<li><a href="../de482044/index.html">10 Best Practices zum Sichern von Docker-Images. Teil 2</a></li>
<li><a href="../de482050/index.html">Jedi Convolution Network Reduction-Technik - Beschneiden</a></li>
<li><a href="../de482052/index.html">Neujahrs-Datensatz 2019: offenes Tonw√∂rterbuch der russischen Sprache</a></li>
<li><a href="../de482058/index.html">Raubtier oder Beute? Wer sch√ºtzt die Zertifizierungsstellen?</a></li>
<li><a href="../de482060/index.html">Access Control Mandate Model (MAC): √úbersicht und Anwendungsapplikationen</a></li>
<li><a href="../de482064/index.html">Einfache Entwicklung mehrsprachiger Websites auf CMS Umbraco 8</a></li>
<li><a href="../de482066/index.html">Ersetzen Sie User Story durch Job Story</a></li>
<li><a href="../de482068/index.html">Muss ich ein RAID-Array aus SSD erstellen und welche Controller werden daf√ºr ben√∂tigt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>