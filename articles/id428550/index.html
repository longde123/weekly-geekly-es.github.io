<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛸️ 👾 👩🏻‍💼 Sebuah inverter dengan sinus murni dalam 15 menit atau "power electronics - untuk semua orang" 👩🏾‍🏫 💉 👨🏻‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apa itu elektronika daya? Tanpa ragu - ini adalah seluruh dunia! Modern dan penuh kenyamanan. Banyak orang membayangkan elektronika daya sebagai sesua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sebuah inverter dengan sinus murni dalam 15 menit atau "power electronics - untuk semua orang"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428550/">  Apa itu elektronika daya?  Tanpa ragu - ini adalah seluruh dunia!  Modern dan penuh kenyamanan.  Banyak orang membayangkan elektronika daya sebagai sesuatu yang "ajaib" dan jauh, tetapi melihat-lihat - hampir semua yang mengelilingi kita berisi konverter daya: catu daya laptop, lampu LED, UPS, berbagai regulator, penstabil tegangan, dan pengukur frekuensi (JIKA) ) di ventilasi atau lift dan banyak lagi.  Sebagian besar peralatan ini membuat hidup kita nyaman dan aman. <br><br>  Karena beberapa alasan, pengembangan elektronika daya adalah salah satu bidang elektronika yang paling sulit - harga kesalahannya sangat tinggi, sementara pengembangan konverter daya selalu menarik perhatian pecinta, pekerja DIY, dan bukan hanya.  Tentunya Anda ingin membangun catu daya yang kuat untuk proyek Anda?  Atau mungkin UPS online untuk beberapa kW dan tidak bangkrut?  Atau mungkin chastotnik di bengkel? <br><br>  Hari ini saya akan berbicara tentang proyek kecil saya yang terbuka, atau lebih tepatnya tentang bagiannya, yang akan memungkinkan siapa saja yang ingin melangkah ke dunia pengembangan elektronika daya dan pada saat yang sama tetap hidup.  Sebagai demonstrasi kemungkinan, saya akan menunjukkan cara memasang inverter tegangan dari 12V DC ke 230V AC dengan output sinus dalam 15 menit.  Penasaran?  Ayo pergi! <br><br><img src="https://habrastorage.org/webt/na/rx/gk/narxgkn5e_6tiuqmfysesuukoug.jpeg"><br><a name="habracut"></a><br><br><h2>  Alasan Proyek </h2><br>  Dalam beberapa tahun terakhir, pengembangan konverter daya telah menyumbang sekitar 90% dari pesanan saya, biaya tenaga kerja utama pergi terutama untuk pengembangan perangkat lunak dan prototipe, perancangan sirkuit + penelusuran papan akhir dari total biaya biasanya tidak lebih dari 10-15%.  Di sinilah pemahaman bahwa proses prototyping, yang meliputi pengembangan perangkat lunak, perlu dikurangi dan dioptimalkan. <br><br>  Setidaknya ada dua jalan keluar seperti biasa: membeli debugging siap pakai, misalnya, dari Texas Instrumets atau Infineon, tetapi mereka biasanya disesuaikan untuk tugas dan biaya spesifik dari $ 500 hingga $ 5.000, tidak ada jaminan bahwa akan ada urutan yang sama dan investasi ini dengan probabilitas tinggi mudah. tidak akan membayar. <br>  Opsi kedua adalah melakukannya sendiri, tetapi melakukannya secara menyeluruh hampir sama dengan meluncurkan "+1 revisi besi", yang akan menghasilkan biaya tambahan bagi pelanggan.  Jika tidak dilakukan secara menyeluruh, maka seperti biasa semuanya akan ingus dan di suatu tempat sesuatu akan jatuh dan sampai tata letak, komponen dan waktu. <br>  Setelah beberapa waktu, saya memperhatikan solusi yang paling jelas.  Sangat sederhana dan jelas bahwa untuk waktu yang lama saya bertanya-tanya mengapa TI atau Infineon yang sama belum melakukan ini.  Sekarang saya akan menceritakan tentang "pencerahan" saya. <br><br>  Mari kita lihat beberapa topologi konverter daya yang paling populer: <br><br><img src="https://habrastorage.org/webt/d8/_c/0v/d8_c0v8ih8ydkihocalqkrqc2xw.png"><br><img src="https://habrastorage.org/webt/gt/hy/fn/gthyfnx_nnsjohhak7ls4xjszny.png"><br><img src="https://habrastorage.org/webt/bk/ag/qq/bkagqqyzbrqjntnfuxsrrvuxpyy.png"><br><img src="https://habrastorage.org/webt/0y/w0/xp/0yw0xpwofk5jjf47usbdrwglyfy.png"><br><img src="https://habrastorage.org/webt/-c/mz/z_/-cmzz_9skvlq8ux30pjluy0zkvi.png"><br><br>  Sekarang perhatikan baik-baik lagi.  Saya melukis secara khusus tanpa pengikat, hanya komponen kunci untuk membuatnya lebih jelas.  Apa kesamaan topologi ini?  Hal pertama yang menarik perhatian Anda adalah serangkaian poin umum: <br><ul><li>  Semua topologi termasuk komponen utama - kapasitor, transistor dan induktansi (induktor atau transformator).  Ini adalah 3 paus elektronik daya; </li><li>  Transistor dihidupkan di mana-mana sama dan membentuk apa yang disebut "setengah jembatan".  Hampir semua topologi konverter dibangun darinya; </li><li>  Pilihan untuk mengaktifkan coupler setengah jembatan + kapasitor tidak berubah pada semua topologi.  Jenis induktansi dan opsi untuk mengaktifkan setengah jembatan berubah. </li></ul><br><br>  Dari sini kita dapat menyimpulkan bahwa memiliki modul standar tertentu dalam bentuk setengah jembatan + kapasitor digabungkan, Anda dapat membangun konverter apa pun dengan menambahkan hanya induktor atau transformator yang diperlukan.  Oleh karena itu, solusi yang jelas untuk menyederhanakan prototipe adalah pembuatan modul seperti itu: <br><img src="https://habrastorage.org/webt/vx/d6/ec/vxd6ec8swnwqef7v6uhkljsysek.png"><br><br><h2>  Pertarungan antara yang baik dan yang jahat </h2><br>  Sayangnya, jumlah jam yang terbatas per hari dan kemalasan dangkal mendikte kondisi mereka.  Saya sampai pada kebutuhan untuk membuat modul ini setahun yang lalu, tetapi implementasinya terus ditransfer di bawah slogan - <i>"Saya pasti akan melakukannya akhir pekan depan!"</i>  . <br><br>  Mungkin idenya akan tetap ada di rak, jika tidak untuk 2 acara.  Pertama, 2 pelanggan datang kepada saya dalam satu bulan dan semua orang menginginkan konverter yang kompleks dan menarik untuk diterapkan, dan yang paling penting mereka siap membayar dengan sangat baik.  Walaupun mempertimbangkan bahwa ia berasal dari Eropa, itu mungkin menjadi murah bagi mereka)) Kedua proyek itu menarik bagi saya, misalnya, salah satunya adalah "regulator tegangan tiga fase dengan isolasi galvanik (sic!)," Yaitu, 3 fase PFC + 3 jembatan konverter (fase bergeser) + penyearah sinkron + inverter 3 fase.  Semua ini pada SiC dan sangat kompak.  Secara umum, saya menerima 2 pesanan besar, masing-masing ~ 800 jam kerja dan jangka waktu 6 bulan.  Akibatnya, saya "terpaksa" mencari cara untuk mengoptimalkan. <br><br>  Kedua, orang-orang dari perusahaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PCBway</a> tiba-tiba menulis surat kepada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saya</a> , mungkin banyak yang memesan papan dari mereka, dan menawarkan untuk bekerja sama.  Mereka sangat aktif mendukung proyek perangkat keras terbuka, yaitu inisiatif dari CERN - Open Source Hardware.  Kerja sama ini sederhana, dapat dimengerti oleh kedua belah pihak - mereka menyediakan saya dengan papan gratis untuk proyek-proyek saya, dan saya membukanya, dan meletakkannya di situs web mereka, di tempat lain sudah berdasarkan permintaan.  Bagi saya itu menjadi motivasi tambahan, dan yang paling penting, hati nurani saya jelas, karena  Saya telah memesan papan untuk prototipe selama beberapa tahun, dan untuk produksi massal, saya memberi tahu teman dan mitra tentang mereka.  Sekarang, untuk ini, saya juga punya roti dalam bentuk papan gratis untuk proyek-proyek kecil, Anda sering dapat menulis di hub <br><br>  Dan kemudian es pecah, diputuskan untuk membuat tidak hanya modul yang dijelaskan sebelumnya, tetapi seluruh rangkaian pengembang elektronik daya dan membuatnya terbuka dan dapat diakses oleh semua orang. <br><br><h2>  Struktur proyek </h2><br>  Pada awal artikel, saya menyebutkan bahwa saya akan memberi tahu Anda hanya satu bagian hari ini - ini adalah <b>modul kekuatan setengah jembatan</b> .  Itu saja memungkinkan Anda untuk membuat konverter dengan hanya memasang di sirkuit kontrol, misalnya, debugging STM32-Discovery, Arduino, TMS320, TL494 atau apa pun yang Anda miliki di sana.  Tidak ada ikatan dengan platform atau MK sama sekali. <br><br>  Hanya ini bukan keseluruhan proyek, tetapi bagian)) Apa terdiri dari konverter daya jadi?  Pertama-tama, unit daya membutuhkan modul kontrol tertentu agar berfungsi, untuk memahami apa yang terjadi, Anda memerlukan indikasi, dan untuk memahami apa yang terjadi dari jarak yang aman, Anda juga memerlukan antarmuka, misalnya, Modbus RTU atau CAN. <br><br>  Akibatnya, struktur umum proyek terlihat seperti ini: <br><br> <a href=""><img src="https://habrastorage.org/webt/oh/tj/ix/ohtjixc8dimubg0tr7mbjym_aqc.png"></a> <br><br>  Mungkin di masa depan saya juga akan menulis sebuah program untuk menghitung transformer dan tersedak, baik konvensional maupun planar.  Sejauh ini.  Berbagai bagian diagram dalam bentuk konsep telah diimplementasikan dan dijalankan dalam dua proyek, setelah modifikasi kecil, artikel juga akan ditulis pada mereka dan kode sumber akan tersedia. <br><br><h2>  Modul Daya Setengah Jembatan </h2><br>  Sekarang saatnya untuk melihat lebih dekat pahlawan hari ini.  Modul ini universal dan memungkinkan Anda untuk bekerja dengan transistor Mosfet dan IGBT, baik sakelar tegangan rendah dan tegangan tinggi hingga 1200V. <br><br>  <u>Fitur Modul:</u> <br><ul><li>  Isolasi galvanis dari sisi kontrol (digital) daya.  Tegangan rusak isolasi 3 kV; </li><li>  Kunci atas dan bawah bersifat independen, masing-masing memiliki driver galvanis terisolasi dan dc / dc terisolasi galvanis; </li><li>  Pengemudi modern dari Infineon - 1EDC60I12AHXUMA1 diterapkan.  Arus pulsa buka / tutup adalah 6A / 10A.  Frekuensi maksimum - 1 MHz (diuji hingga 1,5 MHz secara stabil); </li><li>  Perlindungan perangkat keras saat ini: shunt + op-amp + komparator + optocoupler; </li><li>  Arus maksimum adalah 20A.  Itu tidak dibatasi oleh kunci, tetapi oleh ukuran radiator dan ketebalan poligon tembaga. </li></ul><br><br>  Revisi pertama modul muncul di artikel, itu sepenuhnya operasional, tetapi akan ada revisi kedua, di mana cacat desain murni akan dihilangkan dan konektor akan diganti dengan yang lebih nyaman.  Setelah menyelesaikan dokumentasi, dia melempar gerber ke PCBway dan setelah 6 hari kurir mengetuk pintu saya dan memberi saya pesona: <br><br> <a href=""><img src="https://habrastorage.org/webt/bj/dw/lt/bjdwlt-ijg3_gdxfx0wfkwggk18.jpeg"></a> <br><br>  Seminggu kemudian, <s>anjing</s> - <s>anjing itu</s> akhirnya membawa komponen dari satu toko domestik yang indah.  Akibatnya, semuanya dipasang: <br><br> <a href=""><img src="https://habrastorage.org/webt/kw/mv/cg/kwmvcghxvdiimkk9ili2zqfnorg.jpeg"></a> <br><br> <a href=""><img src="https://habrastorage.org/webt/ea/dg/cz/eadgczqqlkscl5n89r7ynnvyivm.jpeg"></a> <br><br>  Sebelum melanjutkan, mari kita lihat diagram sirkuit modul.  Anda dapat mengunduhnya di sini - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PDF</a> . <br><br>  Tidak ada yang rumit atau ajaib.  Setengah jembatan yang biasa: 2 kunci di bagian bawah, 2 di bagian atas, Anda bisa menyolder satu per satu.  Pengemudi, seperti yang ditulis di atas dari keluarga 1ED, sangat jahat dan abadi.  Di mana-mana pada daya ada indikasi, termasuk + 12V pada keluaran dc / dc.  Perlindungan diterapkan pada elemen logika AND, jika arus terlampaui, komparator akan menghasilkan + 3.3V, mereka akan menerangi optocoupler dan itu akan menarik salah satu input DAN ke tanah, yang berarti pembentukan log.0 dan sinyal PWM dari driver akan hilang.  DAN dengan 3 input telah digunakan secara khusus, dalam revisi berikutnya saya berencana untuk membuat perlindungan terhadap overheating oleh radiator dan memulai sinyal kesalahan di sana juga.  Semua sumber akan ada di akhir artikel. <br><br><h2>  Kami merakit tata letak inverter </h2><br>  Saya sudah lama berpikir tentang cara mendemonstrasikan pengoperasian modul, sehingga tidak akan terlalu membosankan, berguna, dan tidak terlalu sulit, siapa pun dapat mengulanginya.  Oleh karena itu, saya berhenti di inverter tegangan, mereka digunakan untuk bekerja dengan panel surya, jika sesuatu berbau di sisi tegangan rendah, itu tidak menakutkan, tetapi di sisi tegangan tinggi, tepat ketika Anda menyalakannya, jangan taruh tangan Anda di dalamnya. <br><br>  Inverter itu sendiri sangat sederhana, omong-omong, Energi PETA terpaku begitu saja, berikut adalah contoh implementasi komersial dari ide ini.  Tugas inverter adalah membentuk variabel sinusoidal dengan frekuensi 50 Hz dari tegangan 12V DC, karena dengan ini transformator konvensional pada 50 Hz digunakan untuk bekerja.  Saya menggunakan beberapa jenis Soviet, seperti OSM, pabrik berliku 220V dan digunakan sebagai sekunder, dan ~ 8V primer luka dengan bus tembaga.  Ini terlihat seperti ini: <br><br> <a href=""><img src="https://habrastorage.org/webt/xf/6c/js/xf6cjsweiig-ter1invjtnfslci.jpeg"></a> <br><br>  Dan monster ini hanya 400 watt!  Berat transformator adalah sekitar 5-7 kg, menurut sensasi, jika Anda menjatuhkannya di kaki Anda, maka mereka pasti tidak akan dibawa ke tentara.  Sebenarnya, ini adalah minus dari inverter dengan transformator "besi", mereka besar dan berat.  Nilai tambah mereka adalah inverter ini sangat sederhana, tidak memerlukan pengalaman untuk membuat, dan tentu saja harganya murah. <br><br>  Sekarang mari kita sambungkan modul dan transformator.  Bahkan, modul untuk pengembang harus disajikan hanya sebagai "kotak hitam" yang memiliki input 2 PWM dan 3 output daya: VCC, GND dan output setengah jembatan itu sendiri. <br><br><img src="https://habrastorage.org/webt/yt/4f/l5/yt4fl55ueuuzkxi2ytlanqt_z58.png"><br><br>  Sekarang, dari "kotak hitam" ini, mari kita menggambar inverter kami: <br><br><img src="https://habrastorage.org/webt/ht/ar/pu/htarpuz2ma1w3bduxmbpculsxia.png"><br><br>  Ya, hanya butuh 3 elemen eksternal: filter transformator + LC.  Untuk yang terakhir, saya membuat choke hanya dengan melilitkan kawat dari modul ke transformator ke cincin bahan Kool Mu, ukuran R32 dengan permeabilitas 60, dan induktansi sekitar 10 μH.  Tentu saja, throttle harus dihitung, tetapi kita perlu 15 menit)) Secara umum, jika Anda mengendarai sesuatu seperti itu pada 400 W, maka Anda memerlukan cincin ukuran R46 (ini adalah diameter luar).  Kapasitansi - 1-10 uF film, ini sudah cukup.  Bahkan, Anda tidak dapat mengatur kapasitor sebagai ekonomi, karena kapasitas belitan transformator sehat ... secara umum, Cina dan PETA melakukan hal itu)) Induktor terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/b0/wl/zy/b0wlzyrj0gxbmarg2rz5kuppdoc.jpeg"><br><br>  Masih melempar beban uji pada output, saya punya beberapa lampu LED 20 W (tidak ada yang tepat di tangan), mereka sendiri makan 24 W, namun, efisiensi.  Juga, arus rangkaian terbuka transformator adalah sekitar 1A.  Dengan baterai akan memakan sekitar 5A.  Akibatnya, kami memiliki pendirian: <br><br> <a href=""><img src="https://habrastorage.org/webt/3s/w2/q2/3sw2q2qvocpryrps6vj4ynvwavo.jpeg"></a> <br><br>  Selain itu, tata letaknya menggunakan baterai Delta HR12-17, masing-masing, pada 12V dan dengan kapasitas 17 A * h.  Kami akan mengontrol konverter dari papan debug STM32F469-Discovery. <br><br><h2>  Kode </h2><br>  Awalnya, itu direncanakan untuk menggunakan STM32VL-Disco saya, yang diterima di pameran pada tahun 2010, untuk kontrol, tetapi kebetulan pada tata letak ini bahwa ia ditakdirkan untuk mati ketika semua kode ditulis dan tata letak diluncurkan.  Saya lupa tentang probe osiloskop dan menggabungkan 2 bumi, amin.  Akibatnya, semuanya ditulis ulang pada STM32F469NIH6, debugging inilah yang siap digunakan, jadi akan ada 2 proyek: untuk F100 dan untuk F469, keduanya diperiksa.  Proyek ini dibangun untuk TrueSTUDIO, versi gerhana dari ST. <br><br><div class="spoiler">  <b class="spoiler_title">Kode Alas Kaki</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/********************************************* Sinus table **********************************************************/</span></span></span><span class="hljs-meta"> uint16_t sinData[240] = {0,13,26,39,52,65,78,91,104,117,130,143,156,169,182,195,207,220,233,246,258,271,284,296,309,321,333,346,358,370, 382,394,406,418,430,442,453,465,477,488,500,511,522,533,544,555,566,577,587,598,608,619,629,639,649,659,669,678,688,697, 707,716,725,734,743,751,760,768,777,785,793,801,809,816,824,831,838,845,852,859,866,872,878,884,891,896,902,908,913,918, 923,928,933,938,942,946,951,955,958,962,965,969,972,975,978,980,983,985,987,989,991,993,994,995,996,997,998,999,999,999, 999,999,999,998,997,996,995,994,993,991,989,987,985,983,980,978,975,972,969,965,962,958,955,951,946,942,938,933,928,923, 918,913,908,902,896,891,884,878,872,866,859,852,845,838,831,824,816,809,801,793,785,777,768,760,751,743,734,725,716,707, 697,688,678,669,659,649,639,629,619,608,598,587,577,566,555,544,533,522,511,500,488,477,465,453,442,430,418,406,394,382, 370,358,346,333,321,309,296,284,271,258,246,233,220,207,195,182,169,156,143,130,117,104,91,78,65,52,39,26,13,0}; uint16_t sinStep; uint8_t sinStatus; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/******************************************** Used functions ********************************************************/</span></span></span><span class="hljs-meta"> void StartInitClock (void) { RCC-&gt;CR |= RCC_CR_HSEON; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Enable HSE while (!(RCC-&gt;CR &amp; RCC_CR_HSERDY)); FLASH-&gt;ACR |= FLASH_ACR_LATENCY_5WS; RCC-&gt;PLLCFGR = 0x00; RCC-&gt;PLLCFGR |= RCC_PLLCFGR_PLLM_3; // Div for HSE = 8 RCC-&gt;PLLCFGR |= RCC_PLLCFGR_PLLN_4 | RCC_PLLCFGR_PLLN_5 | RCC_PLLCFGR_PLLN_6 | RCC_PLLCFGR_PLLN_7; // PLL mult x240 RCC-&gt;PLLCFGR |= RCC_PLLCFGR_PLLSRC; // Source HSE RCC-&gt;CR |= RCC_CR_PLLON; while((RCC-&gt;CR &amp; RCC_CR_PLLRDY) == 0){} RCC-&gt;CFGR &amp;= ~RCC_CFGR_SW; RCC-&gt;CFGR |= RCC_CFGR_SW_PLL; // Select source SYSCLK = PLL while((RCC-&gt;CFGR &amp; RCC_CFGR_SWS) != RCC_CFGR_SWS_1) {} // Wait till PLL is used RCC-&gt;CR |= RCC_CR_PLLSAION; while ((RCC-&gt;CR &amp; RCC_CR_PLLSAIRDY) == 0) {} } void EnableOutputMCO (void) { RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOAEN; // Enable clock port A GPIOA-&gt;MODER &amp;= ~GPIO_MODER_MODER8; GPIOA-&gt;MODER |= GPIO_MODER_MODER8_1; // Alternative PP GPIOA-&gt;OSPEEDR |= GPIO_OSPEEDER_OSPEEDR8; // Very high speed RCC-&gt;CFGR |= RCC_CFGR_MCO1; // Source PLL RCC-&gt;CFGR &amp;= ~RCC_CFGR_MCO1PRE; // Div = 1 } void InitIndicatorLED (void) { /* * LED1 - PG6 * LED2 - PD4 * LED3 - PD5 * LED4 - PK3 */ RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOGEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIODEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOKEN; GPIOG-&gt;MODER &amp;= ~GPIO_MODER_MODER6; GPIOG-&gt;MODER |= GPIO_MODER_MODER6_0; // Output PP GPIOD-&gt;MODER &amp;= ~GPIO_MODER_MODER4; GPIOD-&gt;MODER |= GPIO_MODER_MODER4_0; // Output PP GPIOD-&gt;MODER &amp;= ~GPIO_MODER_MODER5; GPIOD-&gt;MODER |= GPIO_MODER_MODER5_0; // Output PP GPIOK-&gt;MODER &amp;= ~GPIO_MODER_MODER3; GPIOK-&gt;MODER |= GPIO_MODER_MODER3_0; // Output PP } void EnableIndicatorLED (void) { GPIOG-&gt;BSRR |= GPIO_BSRR_BR_6; GPIOD-&gt;BSRR |= GPIO_BSRR_BR_4; GPIOD-&gt;BSRR |= GPIO_BSRR_BR_5; GPIOK-&gt;BSRR |= GPIO_BSRR_BR_3; } void InitLowPWM (void) { /* * TIM1-CH1 - PA8 * TIM1-CH1N - PB13 */ RCC-&gt;APB2ENR |= RCC_APB2ENR_TIM1EN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOAEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOBEN; /*********** GPIO **********/ GPIOA-&gt;MODER &amp;= ~GPIO_MODER_MODER8; GPIOA-&gt;MODER |= GPIO_MODER_MODER8_1; // Alternative output PP GPIOA-&gt;AFR[1] |= GPIO_AFRH_AFRH0_0; // Select TIM1-CH1 GPIOB-&gt;MODER &amp;= ~GPIO_MODER_MODER13; GPIOB-&gt;MODER |= GPIO_MODER_MODER13_1; // Alternative output PP GPIOB-&gt;AFR[1] |= GPIO_AFRH_AFRH5_0; // Select TIM1-CH1N /*********** Timer *********/ TIM1-&gt;PSC = 2400-1; // div for clock: F = SYSCLK / [PSC + 1] TIM1-&gt;ARR = 1000; // count to 1000 TIM1-&gt;CR1 &amp;= ~TIM_CR1_CKD; // div for dead-time: Tdts = 1/Fosc = 41.6 ns TIM1-&gt;CCR1 = 500; // duty cycle 50% TIM1-&gt;CCER |= TIM_CCER_CC1E | TIM_CCER_CC1NE; // enable PWM complementary out to PB15 and to PA10 TIM1-&gt;CCER &amp;= ~TIM_CCER_CC1NP; // active high level: 0 - high, 1 - low TIM1-&gt;CCMR1 &amp;= ~TIM_CCMR1_OC1M; TIM1-&gt;CCMR1 |= TIM_CCMR1_OC1M_2 | TIM_CCMR1_OC1M_1; // positiv PWM1_CH3 and PWM1_CH3N TIM1-&gt;BDTR &amp;= ~TIM_BDTR_DTG; // clear register TIM1-&gt;BDTR |= TIM_BDTR_DTG_2 | TIM_BDTR_DTG_1 | TIM_BDTR_DTG_0; // value dead-time: = 31*Tdts = 32*41,6ns = 1.29us TIM1-&gt;BDTR |= TIM_BDTR_MOE | TIM_BDTR_AOE; // enable generation output and dead-time TIM1-&gt;CR1 &amp;= ~TIM_CR1_DIR; // count up: 0 - up, 1 - down TIM1-&gt;CR1 &amp;= ~TIM_CR1_CMS; // aligned on the front signal: 00 - front; 01, 10, 11 - center TIM1-&gt;CR1 |= TIM_CR1_CEN; // start count } void InitSinusPWM (void) { /* * TIM3-CH1 - PB4 * TIM3-CH2 - PC7 */ RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM3EN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOBEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOCEN; /*********** GPIO **********/ GPIOB-&gt;MODER &amp;= ~GPIO_MODER_MODER4; GPIOB-&gt;MODER |= GPIO_MODER_MODER4_1; // Alternative output PP GPIOB-&gt;AFR[0] |= GPIO_AFRL_AFRL4_1; // Select TIM3-CH1 GPIOC-&gt;MODER &amp;= ~GPIO_MODER_MODER7; GPIOC-&gt;MODER |= GPIO_MODER_MODER7_1; // Alternative output PP GPIOC-&gt;AFR[0] |= GPIO_AFRL_AFRL7_1; // Select TIM3-CH2 /*********** Timer *********/ TIM3-&gt;PSC = 5-1; // div for clock: F = SYSCLK / [PSC + 1] TIM3-&gt;ARR = 1000; // count to 1000 TIM3-&gt;CCR1 = 0; // duty cycle 0% TIM3-&gt;CCR2 = 0; // duty cycle 0% TIM3-&gt;CCER |= TIM_CCER_CC1E; // enable PWM out to PA8 TIM3-&gt;CCER &amp;= ~TIM_CCER_CC1P; // active high level: 0 - high, 1 - low TIM3-&gt;CCER |= TIM_CCER_CC2E; // enable PWM complementary out to PA9 TIM3-&gt;CCER &amp;= ~TIM_CCER_CC1P; // active high level: 0 - high, 1 - low TIM3-&gt;CCMR1 &amp;= ~(TIM_CCMR1_OC1M | TIM_CCMR1_OC2M); TIM3-&gt;CCMR1 |= TIM_CCMR1_OC1M_2 | TIM_CCMR1_OC1M_1 | TIM_CCMR1_OC2M_2 | TIM_CCMR1_OC2M_1; // positiv PWM1_CH1 and PWM1_CH2 TIM3-&gt;CR1 &amp;= ~TIM_CR1_DIR; // count up: 0 - up, 1 - down TIM3-&gt;CR1 &amp;= ~TIM_CR1_CMS; // aligned on the front signal: 00 - front; 01, 10, 11 - center TIM3-&gt;CR1 |= TIM_CR1_CEN; // start count } void InitStepSinus (void) { RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM6EN; // enable clock for basic TIM6 TIM6-&gt;PSC = 5-1; // div, frequency 24 kHz TIM6-&gt;ARR = 1000; // count to 1000 TIM6-&gt;DIER |= TIM_DIER_UIE; // enable interrupt for timer TIM6-&gt;CR1 |= TIM_CR1_CEN; // start count NVIC_EnableIRQ(TIM6_DAC_IRQn); // enable interrupt TIM6_DAC_IRQn } /************************************* Main code *********************************************/ int main (void) { StartInitClock(); // EnableOutputMCO(); InitIndicatorLED(); InitLowPWM(); InitSinusPWM(); InitStepSinus(); EnableIndicatorLED(); while(1) { } } /****************************** Interrupts ******************************************************/ void TIM6_DAC_IRQHandler (void) { TIM6-&gt;SR &amp;= ~TIM_SR_UIF; if (sinStatus == 0) {TIM3-&gt;CCR1 = sinData[sinStep];} if (sinStatus == 1) {TIM3-&gt;CCR2 = sinData[sinStep];} sinStep++; if (sinStep &gt;= 240) { sinStep = 0; sinStatus = sinStatus ? 0 : 1; } }</span></span></span></span></code> </pre> <br></div></div><br>  Secara umum, dalam artikel lain, ia menjelaskan secara rinci dan jelas bagaimana menghasilkan sinyal sinusoidal, cara menulis kode, dan sebagainya.  Anda bisa membacanya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Sudahkah Anda membaca?  Ingin mengumpulkan?  Simpan proyek: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proyek untuk F469</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proyek untuk F100</a> </li></ul><br>  Kami menjalankan kode, mempersenjatai diri dengan osiloskop dan melanjutkan.  Pertama-tama, kami memeriksa keberadaan sinyal pada input driver, seharusnya seperti ini: <br><br><img src="https://habrastorage.org/webt/nd/gc/5f/ndgc5fcjhtwnxk_oxdwnanbwtkq.png"><br><br>  Perlu dicatat bahwa saya memberikan 2 sinyal menggambar sinus pada setengah jembatan (modul), dan 50 Hz pada 2 sinyal.  Selain itu, satu diagonal adalah "merah + kuning", dan yang lainnya adalah "biru + hijau".  Dalam artikel yang saya berikan di atas, ini ditulis secara rinci, jika Anda tiba-tiba tidak mengerti.  Sekarang, ketika sinyal datang, kami memakai setengah jembatan + 12V dan GND dari catu daya laboratorium.  Segera baterai tidak menyarankan, jika Anda membuat kesalahan di suatu tempat, maka ada sesuatu yang dapat terbakar.  Perlindungan di papan menghemat dari arus berlebih, tetapi tidak dari tiang tembok yang jelas, ketika plus dan minus tercampur, tetapi teknisi lab menghemat.  12V dan 1A cukup untuk tes.  Kami mengambil probe osiloskop, kabel pembumiannya ke output setengah-jembatan pertama, dan probe itu sendiri ke output setengah-jembatan lainnya, dan harus ada gambar seperti itu: <br><br><img src="https://habrastorage.org/webt/px/6j/fk/px6jfknnkrrf4y_l09t-_h9csfk.png"><br><br>  Di mana sinus yang Anda tanyakan?  Faktanya adalah bahwa resistansi input osiloskop besar dan itu bukan merupakan beban, sehingga arus tidak mengalir dan tidak ada tempat untuk mendapatkan sinus.  Tambahkan beban, saya membuat beban 90 Ohm dari 10 resistor Ohm hanya dengan menyalakan 9 buah secara seri.  Kami mengaitkan muatan ke output setengah jembatan dan melihat gambar berikut: <br><br><img src="https://habrastorage.org/webt/a1/ro/7b/a1ro7ba6mmxhagnpiyau1mjstqo.png"><br><br>  Apakah Anda memiliki yang sama?  Jadi sudah waktunya untuk menghubungkan induktor, transformator, memuat dan mencoba memulai.  <b>Achtung!</b>  <b>Anda tidak dapat menghidupkan model ini tanpa memuat, karena saat idle, output bisa mencapai 350 ... 380V.</b>  <b>Sehingga ini tidak perlu memuat atau OS.</b>  Kami tidak akan memiliki yang terakhir, ini adalah topik artikel terpisah, Anda dapat, sebagai pilihan, kencangkan P-controller paling sederhana, Anda sudah memiliki templat proyek. <br><br><h2>  Inklusi </h2><br>  Setelah dinyalakan, kita mendapatkan output sekitar 230V, outputnya pasti tidak stabil dan akan mengapung 230V + -30V, untuk tes akan berjalan, di artikel lain kita akan menyelesaikan tata letak saat saya memutuskan untuk berbicara tentang P dan PI controller dan implementasinya. <br><br>  Sekarang Anda dapat menikmati hasil pekerjaan, dan jika perlu, letakkan semuanya dalam sebuah kotak dan bahkan menerapkannya di pertanian atau di negara untuk memberi Anda cahaya dan fasilitas lainnya. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Te0OhTMt0Tk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Anda mungkin melihat penundaan antara "klik", yaitu menyalakan Discovery dan menyalakan lampu - ini adalah waktu yang dihabiskan MK untuk inisialisasi.  Penundaan ini dapat dikurangi dengan menulis satu digit ke register sekaligus, daripada membagi entri register menjadi beberapa baris.  Saya menghancurkannya hanya untuk ilustrasi.  Meskipun ini tidak menakutkan, dengan kode HAL, penundaannya 3 kali lebih lama dan orang-orang hidup dengannya)) <br><br>  Sampai saya lupa, sumber proyek: <br><br><ul><li>  Diagram skematis - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PDF</a> </li><li>  BOM - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Excel</a> </li><li>  File Gerber - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RAR</a> </li></ul><br><br>  Tetap untuk melihat bagaimana dengan suhu di papan tulis, jika ada titik-titik panas tertentu.  5-6A tentu saja tidak cukup, tetapi jika ada kesalahan saat ini atau beberapa kesalahan serius, maka ini cukup untuk mengubah papan menjadi ketel: <br><br><img src="https://habrastorage.org/webt/xz/fp/ln/xzfplnlxfklygc-vjabjtpws1em.png"><br><br>  Seperti yang Anda lihat, elemen terpanas adalah modul dc / dc untuk isolasi galvanik, yaitu 2 watt, memanas hingga 34 derajat, yah, juga shunt.  Transistor dan radiator itu sendiri memiliki suhu sekitar setelah 30 menit pengoperasian konverter)) <br><br><h2>  Terima kasih dan rencananya </h2><br>  Dalam waktu dekat saya berencana untuk menulis tentang papan DSP dan mengelolanya bukan dari penemuan debugging, tetapi dari modul "khusus".  Papan revisi ke-2 datang kepadanya dari PCBway yang sama, saya menunggu komponen dan segera menulis. <br><br>  Saya harap Anda menikmati artikel dan ide itu sendiri.  Di masa depan, pada modul yang sama saya akan menunjukkan cara merakit chastotnik, mppt controller, atau mungkin sesuatu yang menarik.  Jika Anda memiliki pertanyaan, jangan ragu untuk bertanya di komentar atau di PM, jika Anda tiba-tiba tidak memiliki akun lengkap, saya akan mencoba menjawab semua pertanyaan. <br><br>  Sekarang beberapa berkat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PCBway</a> , sebenarnya sangat bagus bahwa mereka mendukung mesin open source.  Segera, pembuat perangkat keras bahkan dapat mengejar ketinggalan dengan penulis perangkat lunak dalam hal jumlah dan kualitas proyek sumber terbuka. <br><br><img src="https://habrastorage.org/webt/hm/pu/px/hmpupxkj9ov6-oum1vvnqmi0oqu.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id428550/">https://habr.com/ru/post/id428550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id428540/index.html">Uji klinis telah menunjukkan penurunan lebih dari setengahnya penyakit Alzheimer</a></li>
<li><a href="../id428542/index.html">Turis di Uni Eropa akan diperiksa menggunakan AI</a></li>
<li><a href="../id428544/index.html">Kerentanan dalam Bluetooth membuka peluang untuk serangan pada titik akses nirkabel</a></li>
<li><a href="../id428546/index.html">Tiga tahun teknologi. dukungan, 152 fasilitas kesehatan, 3740 pcs</a></li>
<li><a href="../id428548/index.html">Pemrograman Berorientasi Aspek, Pegas AOP</a></li>
<li><a href="../id428552/index.html">Algoritma: Cara menemukan permutasi leksikografis berikutnya</a></li>
<li><a href="../id428556/index.html">"Lingkungan produksi berada di luar kendali Anda": Rian Lewis menguji proyek-proyek blockchain</a></li>
<li><a href="../id428558/index.html">Bagaimana saya membuat wizard untuk WordPress dari kemalasan saya yang dalam</a></li>
<li><a href="../id428560/index.html">Pengumuman hari Jumat yang tidak dijadwalkan</a></li>
<li><a href="../id428562/index.html">Droidcon London. Bagaimana itu?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>