<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐พ ๐๏ธ ๐ ุซุนุจุงู ูู ุตูุฏูู ุงูุจุฑูุฏ ููุงุฐุง ููุนู F # ๐คท๐พ ๐ด๐ผ ๐๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุง ูู ูู ูุฐุงุ 


 ูู ุดูุก ุนู ุงูุซุนุจุงู. ูุชุฐูุฑ ุงูุฌููุน ูุง ูู ุงูุซุนุจุงู: ุซุนุจุงู ูุชุญุฑู ูู ุญูู ูุณุชุทูู. ูุฌุฏ ุงูุทุนุงู - ูููู ูู ุงูุทูู ุ ูุฌุฏ ููุณู ุฃู ุนูู ุญุงูุฉ ุงูุญูู - ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุซุนุจุงู ูู ุตูุฏูู ุงูุจุฑูุฏ ููุงุฐุง ููุนู F #</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424861/" style=";text-align:right;direction:rtl"><h4 id="o-chem-eto-vse" style=";text-align:right;direction:rtl">  ูุง ูู ูู ูุฐุงุ </h4><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุนู ุงูุซุนุจุงู.  ูุชุฐูุฑ ุงูุฌููุน ูุง ูู ุงูุซุนุจุงู: ุซุนุจุงู ูุชุญุฑู ูู ุญูู ูุณุชุทูู.  ูุฌุฏ ุงูุทุนุงู - ูููู ูู ุงูุทูู ุ ูุฌุฏ ููุณู ุฃู ุนูู ุญุงูุฉ ุงูุญูู - ูููุช.  ููููู ูููุณุชุฎุฏู ุฅุฑุณุงู ุฃูุงูุฑ ููุท: ูุณุงุฑ ุ ูููู ุ ุฃุนูู ุ ุฃุณูู. <br>  ูุฑุฑุช ุฃู ุฃุถูู ุจุนุถ ุงูุฅุฌุฑุงุกุงุช ููุง ูุฃุฌุนู ุงูุฃูุนู ุชูุฑุจ ูู ุจููู.  ููู ูุฐุง ุนูู ุงูููุซููู! </p><br><p style=";text-align:right;direction:rtl"> ูุฐูู ุ <code>MailboxProcessor</code> ุงูููู ูุซุงู ุงูุซุนุจุงู ููุชุญุฏุซ ุนู ููููุฉ ุจูุงุก ูููุฐุฌ ููุซู ุจุงุณุชุฎุฏุงู <code>MailboxProcessor</code> ูู ุงูููุชุจุฉ ุงูููุงุณูุฉ ุ ููุง ูู ุงูููุงุท ุงูุชู ูุฌุจ ุงูุจุญุซ ุนููุง ุ ูุงููุฎุงุทุฑ ุงูุชู ูููู ุฃู ุชุชููุนูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุดูุฑุฉ ุงูููุชูุจุฉ ููุง ููุณุช ูุซุงููุฉ ุ ููุฏ ุชูุชูู ุจุนุถ ุงููุจุงุฏุฆ ุ ููุฏ ุชููู ุฃูุถู ูู ูุชุงุจุชูุง.  ูููู ุฅุฐุง ููุช ูุจุชุฏุฆูุง ูุชุฑุบุจ ูู ุงูุชุนุงูู ูุน ุตูุงุฏูู ุงูุจุฑูุฏ - ุขูู ุฃู ุชุณุงุนุฏู ูุฐู ุงูููุงูุฉ. <br>  ุฅุฐุง ููุช ุชุนุฑู ูู ุดูุก ุนู ุตูุงุฏูู ุงูุจุฑูุฏ ุจุฏููู ุ ููุฏ ุชุดุนุฑ ุจุงูููู ููุง. </p><br><h4 id="pochemu-aktory" style=";text-align:right;direction:rtl">  ููุงุฐุง ุงูููุซูููุ </h4><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุงูููุงุฑุณุฉ.  ูุฑุฃุช ุนู ูููุฐุฌ ุงูููุซููู ุ ุดุงูุฏุช ุงูููุฏูู ุ ุฃุญุจุจุช ูู ุดูุก ุ ููููู ูู ุฃุฌุฑุจู ุจููุณู.  ุงูุขู ุฌุฑุจุชู. <br>  ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃููู ุงุฎุชุฑุช ุงูุชูููููุฌูุง ูู ุฃุฌู ุงูุชูููููุฌูุง ุ ุฅูุง ุฃู ุงูููููู ูุงู ูุงุฌุญูุง ุฌุฏูุง ูู ูุฐู ุงููููุฉ. </p><br><h4 id="pochemu-mailboxprocessor-a-ne-naprimer-akkanet" style=";text-align:right;direction:rtl">  ููุงุฐุง MailboxProcessor ูููุณ Akka.net ุนูู ุณุจูู ุงููุซุงูุ </h4><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ <code>MailboxProcessor</code> ุ ููุงู ุงุณู <code>MailboxProcessor</code> ูู ุงููุญุทุฉ ุงููุฏุงุฑูุฉ ุจูุงุณุทุฉ ุงูุนุตุงููุฑ ุ <code>MailboxProcessor</code> ุฃุจุณุท ุจูุซูุฑ ุ ููู ุฌุฒุก ูู ุงูููุชุจุฉ ุงูููุงุณูุฉ ุ ูุฐูู ูุง ุชุญุชุงุฌ ุฅูู ุชูุตูู ุฃู ุญุฒู. </p><a name="habracut"></a><br><h4 id="o-meylboks-processorah-i-soputsvuyuschem-boylerpleyte" style=";text-align:right;direction:rtl">  ุญูู ูุนุงูุฌุงุช ุนูุจุฉ ุงูุจุฑูุฏ ูุฃููุงุญ ูุฑุฌุนูุฉ ุฐุงุช ุตูุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุงูููุทุฉ ุจุณูุทุฉ.  ูุญุชูู ุตูุฏูู ุงูุจุฑูุฏ ุงูููุฌูุฏ ูู ุงูุฏุงุฎู ุนูู ุญููุฉ ุฑุณุงูุฉ ูุจุนุถ ุงูุญุงูุงุช.  ุณุชููู ุญููุฉ ุฑุณุงูุชู ุจุชุญุฏูุซ ูุฐู ุงูุญุงูุฉ ููููุง ููุฑุณุงูุฉ ุงูุฌุฏูุฏุฉ ุงูุชู ุชุตู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin">let actor = MailboxProcessor.Start(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> inbox -&gt; // ,    //   . inbox --    MailboxProcessor let rec messageLoop oldState = async { //   let! msg = inbox.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Receive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-comment"><span class="hljs-comment">//    let newState = updateState oldState msg //      return! messageLoop newState } //       .    --     messageLoop (0,0) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฑุฌู ููุงุญุธุฉ ุฃู <code>messageLoop</code> ุนูุฏู ุ ููู ุงูููุงูุฉ ูุฌุจ ุงุณุชุฏุนุงุคู ูุฑุฉ ุฃุฎุฑู ุ ูุฅูุง ุณูุชู ูุนุงูุฌุฉ ุฑุณุงูุฉ ูุงุญุฏุฉ ููุท ุ ูุจุนุฏ ุฐูู ุณูููุช ูุฐุง ุงูููุซู.  <code>messageLoop</code> ูุชุฒุงูู ุฃูุถูุง ุ ููุชู ุฅุฌุฑุงุก ูู ุชูุฑุงุฑ ูุงุญู ุนูุฏ ุชููู ุฑุณุงูุฉ ุฌุฏูุฏุฉ: <code>let! msg = inbox.Receive()</code>  <code>let! msg = inbox.Receive()</code> . <br>  ูุจุงูุชุงูู ุ ููุชูู ุงูุญูู ุงูููุทูู ุจุงููุงูู ุฅูู ูุธููุฉ <code>updateState</code> ุ ููุง ูุนูู ุฃูู ูุฅูุดุงุก ุตูุฏูู ุจุฑูุฏ ูููุนุงูุฌ ุ ูููููุง ุฅูุดุงุก ูุธููุฉ ูููุดุฆ ุชูุจู ูุธููุฉ ุชุญุฏูุซ ุงูุญุงูุฉ ูุญุงูุฉ ุงูุตูุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs haskell">//   applyMessage       //      (fun inbox -&gt; ...) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> buildActor applyMessage zeroState = <span class="hljs-type"><span class="hljs-type">MailboxProcessor</span></span>.<span class="hljs-type"><span class="hljs-type">Start</span></span>(fun inbox -&gt; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rec</span></span> loop state = async{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span>! msg = inbox.<span class="hljs-type"><span class="hljs-type">Receive</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newState = applyMessage state msg return! loop newState } loop zeroState )</code> </pre><br><p style=";text-align:right;direction:rtl">  ุฑุงุฆุน!  ุงูุขู ูุญู ูุณูุง ุจุญุงุฌุฉ ูููุฑุงูุจุฉ ุจุงุณุชูุฑุงุฑ ุญุชู ูุง ููุณู <code>return! loop newState</code>  <code>return! loop newState</code> .  ููุง ุชุนูู ุ ูููู ุงูููุซู ุจุชุฎุฒูู ุงูุฏููุฉ ุ ูููู ุงูุขู ููุณ ูู ุงููุงุถุญ ุชูุงููุง ููููุฉ ุงูุญุตูู ุนูู ูุฐู ุงูุญุงูุฉ ูู ุงูุฎุงุฑุฌ.  ูุญุชูู ุตูุฏูู ุงูุจุฑูุฏ ุงูุฎุงุต ุจุงููุนุงูุฌ ุนูู ุทุฑููุฉ <code>PostAndReply</code> ุ ูุงูุชู ุชุฃุฎุฐ ูุธููุฉ <code>AsyncReplyChannel&lt;'Reply&gt; -&gt; 'Msg</code> ููุณุงููุฉ.  ูู ุงูุจุฏุงูุฉ ูุงุฏูู ุฅูู ุฐููู - ูู ุบูุฑ ุงููุงุถุญ ุชูุงููุง ูู ุฃูู ุชุญุตู ุนูู ูุฐู ุงููุธููุฉ.  ูููู ูู ุงููุงูุน ุ ุชุจูู ุฃู ูู ุดูุก ุฃุจุณุท: ูุฌุจ ุฃู ูุชู ุชุบููู ุฌููุน ุงูุฑุณุงุฆู ูู ุบูุงู DU ุ ูุฃููุง ูุญุตู ุงูุขู ุนูู ุนูููุชูู ุนูู ููุซููุง: ุฃุฑุณู ุงูุฑุณุงูุฉ ููุณูุง ูุงุทูุจ ุงูุญุงูุฉ ุงูุญุงููุฉ.  ุฅููู ูุง ูุจุฏู ุนููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/     . /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ Mail&lt;_,_&gt;   ,  Post &amp; Get --  . /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ F#       , /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   compare &amp; equals . /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/         --   . /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   [&lt;Struct&gt;] .       type Mail&lt;'msg, 'state&gt; = | Post of 'msg | Get of AsyncReplyChannel&lt;'state&gt;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุจุฏู ูุธููุฉ ุงููููุดุฆ ูุฏููุง ุงูุขู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs erlang-repl">let buildActor applyMessage zeroState = MailboxProcessor.Start(fun inbox -&gt; let rec loop state = async{ let! msg = inbox.Receive() //    ,     // .    -- ,     //     . //     --      //    .      ! match msg with | Post msg -&gt; let newState = applyMessage state msg return! loop newState | Get channel -&gt; channel.Reply state return! loop state } loop zeroState )</code> </pre><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ููุนูู ูุน ุตูุฏูู ุงูุจุฑูุฏ ุ ูุญุชุงุฌ ุฅูู ูู ุฌููุน ุฑุณุงุฆููุง ูู ูุฐุง <code>Mail.Post</code> .  ููู ูุง ุชูุชุจ ูุฐุง ูู ูู ูุฑุฉ ุ ูู ุงูุฃูุถู ููู ูู ุชุทุจูู ุตุบูุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs coffeescript"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span> Mailbox = let buildAgent applyMessage zeroState = MailboxProcessor.Start(fun inbox -&gt; let rec <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> state = async{ let! msg = inbox.Receive() match msg with | Post msg -&gt; let newState = applyMessage state msg <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>! <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> newState | Get channel -&gt; channel.Reply state <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>! <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> state } <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> zeroState ) let post (agent: MailboxProcessor&lt;_&gt;) msg = Post msg |&gt; agent.Post let getState (agent: MailboxProcessor&lt;_&gt;) = agent.PostAndReply Get let getStateAsync (agent: MailboxProcessor&lt;_&gt;) = agent.PostAndAsyncReply Get <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   Single Case Discriminated Union. <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> MailboxProcessor   API.      , <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  -  ,  ,      <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   .       ,     <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>        . type MailAgent&lt;<span class="hljs-string"><span class="hljs-string">'msg, '</span></span>state&gt; = MailAgent <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> address:string * mailbox:MailboxProcessor&lt;Mail&lt;<span class="hljs-string"><span class="hljs-string">'msg, '</span></span>state&gt;&gt; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     API with member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Post msg = <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>            let (MailAgent (address,<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> Mailbox.post <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> msg member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.GetState() = let (MailAgent (address,<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> Mailbox.getState <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.GetStateAsync() = let (MailAgent (address,<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> Mailbox.getStateAsync <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Address = let (MailAgent (address, _)) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> address member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Dispose() = let (MailAgent (_, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> (this:&gt;IDisposable).Dispose() interface IDisposable with member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Dispose() = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Dispose()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณุฃุฎุจุฑู ูุง <code>address:string</code> ุจุนุฏ ุฐูู ุจูููู ุ ูููู ุงูุขู ูุฏููุง ููุญุฉ ูุฑุฌุนูุฉ ุฌุงูุฒุฉ. </p><br><h4 id="sobstvenno-zmeyka" style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ุงูุฃูุนู </h4><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฃูุนู ููุฌุฏ ุซุนุจุงู ุ ูุณุชุฎุฏู ุจุฃูุงูุฑู ุ ุญูู ูุงูุชูุงู ููุชุธู ููุฅุทุงุฑ ุงูุชุงูู. <br>  ููุง ูู ูุฐุง ูุนูุง ูููุฒู ุชูุทูุฎู ูู ูุจู ููุซูููุง. <br>  ูุงู ุงูุชุฎุทูุท ุงูุฃููู ููุง ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุซู ูุน ุฌูุงุฒ ุชูููุช.  ููุจู ุฑุณุงุฆู ุงูุจุฏุก / ุงูุฅููุงู / ุงูุฅููุงู ุงููุคูุช.  ูู ูููู ุซุงููุฉ ุ ูุฑุณู ุฑุณุงูุฉ <code>Flush</code> ุฅูู ููุซู <code>Flush</code> .  ูุฎุฒู <code>System.Timers.Timer</code> ูุฏููุฉ </li><li style=";text-align:right;direction:rtl">  ูุฑู ุงูููุซู.  ูุณุชูุจู ุฑุณุงุฆู ูู ุงููุณุชุฎุฏู <code>Move Up/Down/Left/Right</code> ุ <code>AddPerk Speed/Attack</code> (ูุนู ุ ูููู <code>AddPerk Speed/Attack</code> ุฃู ูุฒุญู ุจุณุฑุนุฉ ูููุงุฌู ุงูุฃูุบุงุฏ) ู <code>Flush</code> ูู ุงููุคูุช.  ูููู ุจุชุฎุฒูู ูุงุฆูุฉ ูู ุงูุฃูุงูุฑ ูุฏููุฉ ุ ููุชู ุฅุนุงุฏุฉ ุชุนููู ูุฐู ุงููุงุฆูุฉ ูุน ุชุฏูู. </li><li style=";text-align:right;direction:rtl">  ุงูููุซู ูู ุซุนุจุงู.  ูููู ุจุชุฎุฒูู ุญุงูุฉ ุงูุซุนุจุงู - ุงูุงูุชูุงุฒุงุช ูุงูุทูู ูุงูุงุชุฌุงู ูุงูุงูุญูุงุกุงุช ูุงูุฅุญุฏุงุซูุงุช. <br>  ููุจู ูุงุฆูุฉ ุงูุฑุณุงุฆู ูู ููุซู ุงูุฃูุงูุฑ ุ ูุฑุณุงูุฉ <code>Tick</code> (ูุชุญุฑูู ุฎููุฉ ุงูุฃูุนู 1 ุฅูู ุงูุฃูุงู) ุ <code>GrowUp</code> ูู ููุซู ุงูุญูู ุนูุฏูุง ูุนุซุฑ ุนูู ุงูุทุนุงู. </li><li style=";text-align:right;direction:rtl">  ููุซู ุงูููุฏุงู.  ูููู ุจุชุฎุฒูู ุฎุฑูุทุฉ ุงูุฎูุงูุง ุ ููุฃุฎุฐ ุญุงูุฉ ุงูุซุนุจุงู ูู ุฑุณุงูุฉ ููุฑุณู ุงูุฅุญุฏุงุซูุงุช ุนูู ุตูุฑุฉ ููุฌูุฏุฉ.  ููุง ูุฑุณู <code>GrowUp</code> ููุซู ุงูุฃูุนู ูุฃูุฑ <code>Stop</code> ุฅูู ุงููุคูุช ุฅุฐุง ุงูุชูุช ุงููุนุจุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑู ุ ุญุชู ูุน ูุฌูุฏ ูุฐุง ุงูุนุฏุฏ ุงูุตุบูุฑ ูู ุงูููุงูุงุช ุ ูุฅู ุฎุฑูุทุฉ ุงูุฑุณุงูุฉ ุบูุฑ ุชุงููุฉ ุจุงููุนู.  ููุฏ ูุดุฃุช ุจุงููุนู ุตุนูุจุงุช ูู ูุฐู ุงููุฑุญูุฉ: ุงูุญูููุฉ ูู ุฃู F # ุจุดูู ุงูุชุฑุงุถู ูุง ูุณูุญ ุจุงูุชุจุนูุงุช ุงูุฏูุฑูุฉ.  ูู ุงูุณุทุฑ ุงูุญุงูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ููููู ููุท ุงุณุชุฎุฏุงู ุงูุฑูุฒ ุงูููุชูุจ ุฃุนูุงู ุ ูููุทุจู ุงูุดูุก ููุณู ุนูู ุงููููุงุช ูู ุงููุดุฑูุน.  ูุฐุง ููุณ ุฎุทุฃ ุ ููููู ููุฒุฉ ุ ูุฃูุง ุฃุญุจ ุฐูู ูุซูุฑูุง ุ ูุฃูู ูุณุงุนุฏ ูู ุงูุญูุงุธ ุนูู ุงูุดูุฑุฉ ูุธููุฉ ุ ูููู ูุงุฐุง ุชูุนู ุนูุฏูุง ุชููู ุงูุฑูุงุจุท ุงูุฏูุฑูุฉ ูุทููุจุฉ ุญุณุจ ุงูุชุตูููุ  ุจุงูุทุจุน ุ ููููู ุงุณุชุฎุฏุงู <code>rec namespace</code> - ุซู ุฏุงุฎู ููู ูุงุญุฏ ููููู ุงูุฑุฌูุน ุฅูู ูู ุดูุก ููุฌูุฏ ูู ูุฐุง ุงูููู ุ ูุงูุฐู ุงุณุชุฎุฏูุชู. <br>  ูู ุงููุชููุน ุฃู ูุชุนุทู ุงูุฑูุฒ ุ ูููู ูุจุฏู ุฃูู ุงูุฎูุงุฑ ุงููุญูุฏ.  ูุนููุช. </p><br><h4 id="problema-vneshnego-mira" style=";text-align:right;direction:rtl">  ูุดููุฉ ุงูุนุงูู ุงูุฎุงุฑุฌู </h4><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ูุนูู ุทุงููุง ุฃู ูุธุงู ุงูููุซููู ุจุฃูููู ูุนุฒูู ุนู ุงูุนุงูู ุงูุฎุงุฑุฌู ุ ููู ุฃูู ุฅูุง ุจุนุฑุถ ุงูุฎุทูุท ูู ูุญุฏุฉ ุงูุชุญูู.  ุนูุฏูุง ุญุงู ุงูููุช ูุชุทุจูู ุงูุชุจุนูุฉ ูู ุดูู ูุธููุฉ <code>updateUI</code> ุ ูุงูุชู ูุงู ูู ุงูููุชุฑุถ ุฃู ุชุนูุฏ <code>updateUI</code> ููู ุนูุงูุฉ ุ ูู ุฃุชููู ูู ุญู ูุฐู ุงููุดููุฉ ูู ุงูุชูููุฐ ุงูุญุงูู.  ูุง ูุจูุญุฉ ููุง ุฌูููุฉ - ูุณุชุญูู.  ุซู ุชุฐูุฑุช akku - ุจุนุฏ ูู ุดูุก ุ ููููู ุฅูุดุงุก ููุซููู ุนูู ุทูู ุงูุทุฑูู ุ ููุฏ ูุตูุช ุฌููุน ููุซูู ูู ูุฑุญูุฉ ุงูุชุฌููุน. <br>  ุงูุญู ูุงุถุญ - ุงุณุชุฎุฏู akku!  ูุง ุ ุจุงูุทุจุน ุ ูุง ูุฒุงู Akka ูุจุงูุบุฉ ูู ุงูุฅูุฑุงุท ุ ููููู ูุฑุฑุช ุฃู ุฃูุนู ุจุนุถ ุงูููุงุท ูู ููุงู - ุฃู ุฅูุดุงุก ูุธุงู ูู ุงูููุซููู ููููู ููู ุฅุถุงูุฉ ุฌูุงุช ูุงุนูุฉ ุฌุฏูุฏุฉ ุฏููุงูููููุง ูุงูุงุณุชุนูุงู ุนู ุงูููุซููู ุงูุญุงูููู ุนูู ุงูุนููุงู. <br>  ูุธุฑูุง ูุฃูู ูุชู ุงูุขู ุฅุถุงูุฉ ุงูููุซููู ูุญุฐููู ูู ููุช ุงูุชุดุบูู ุ ูููู ูุชู ุงูุญุตูู ุนูููู ุนู ุทุฑูู ุงูุนููุงู ุจุฏูุงู ูู ุงูุฑุงุจุท ุงููุจุงุดุฑ ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุชูุฏูู ุณููุงุฑูู ุญูุซ ูุง ูุจุฏู ุงูุนููุงู ูู ุฃู ููุงู ููุง ูููู ุงููุงุนู ููู.  ุจุงุชุจุงุน ูุซุงู ุฌูุนูุฉ ุงููุญุงุณุจูู ุงููุงูููููู ุงููุนุชูุฏูู ููุณูุง ุ ุฃุถูุช ูุฑุจุนูุง ููุฃุญุฑู ุงูููุชุฉ ุ ูููุช ุจุชุตูููู ูู ุฎูุงู DUs ุงูููุถูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Agent&lt;_,_&gt; --  ,   ,     <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     ,      . <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      ,    --    Box (mailagent), <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,       ,   ,   , <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>       Deadbox.      MailAgent,  . <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>           . <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    --    . type Agent&lt;<span class="hljs-string"><span class="hljs-string">'message,'</span></span>state&gt; = | Box <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> MailAgent&lt;<span class="hljs-string"><span class="hljs-string">'message,'</span></span>state&gt; | DeadBox <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> string * MailAgent&lt;string * obj, Map&lt;string,obj list&gt;&gt; with member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Post msg = match <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> with | Box box -&gt; box.Post msg | DeadBox (address, deadbox) -&gt; (address, box msg) |&gt; deadbox.Post interface IDisposable with member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Dispose() = match <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> with | Box agent -&gt; agent.Dispose() | DeadBox (_,agent) -&gt; agent.Dispose()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงููุธุงู ููุณู ูุจุฏู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    .     --    . type MailboxNetwork() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> = <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      .   ! [&lt;DefaultValue&gt;] val mutable agentRegister: ConcurrentDictionary&lt;string, obj&gt; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.agentRegister &lt;- ConcurrentDictionary&lt;string, obj&gt;() <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      , <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    Map --     let deadLettersFn deadLetters (address:string, msg:obj) = printfn <span class="hljs-string"><span class="hljs-string">"Deadletter: %s-%A"</span></span> address msg match Map.tryFind address deadLetters with <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   | None -&gt; Map.add address [msg] deadLetters <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   --   | Some letters -&gt; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  --      Map.remove address deadLetters |&gt; Map.add address (msg::letters) let deadLettersAgent() = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"deadLetters"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Map.empty |&gt; Mailbox.buildAgent deadLettersFn)</span></span></span><span class="hljs-function"> |&gt; MailAgent member this.DeadLetters = deadLettersAgent</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> // -     ,      member this.Box&lt;'message,'state&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(address)</span></span></span><span class="hljs-function"> = match this.agentRegister.TryGetValue address with | </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">, agent)</span></span></span><span class="hljs-function"> when </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(agent :? MailAgent&lt;</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'message,'</span></span></span></span><span class="hljs-function"><span class="hljs-params">state&gt;)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,       ,   let agent = agent :?&gt; MailAgent&lt;<span class="hljs-string"><span class="hljs-string">'message, '</span></span>state&gt; Box agent | _ -&gt; DeadBox (address, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.DeadLetters) <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  --    member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.KillBox address = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.agentRegister.TryRemove(address) |&gt; ignore member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.RespawnBox (agent: MailAgent&lt;<span class="hljs-string"><span class="hljs-string">'a,'</span></span>b&gt;) = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.KillBox agent.Address <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.agentRegister.TryAdd (agent.Address, agent) |&gt; ignore interface IDisposable with member <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Dispose() = <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> agent <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.agentRegister.Values <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> match agent with | :? IDisposable <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> agent -&gt; agent.Dispose() | _ -&gt; ()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ูู ุงูููุงู ุงูุฐู ุฌุงุก ููู ููุณ <code>address:string</code> ุ ุงูุชู ูุชุจุช ุนููุง ุฃุนูุงู ุ ูู ูุชูุงูู ุงููุฏูู.  ููุฑุฉ ุฃุฎุฑู ูุฌุญุช ุ ุฃุตุจุญ ุงูุงุนุชูุงุฏ ุงูุฎุงุฑุฌู ุงูุขู ุณูููุง ูููุตูู ุฅูู ุญูุซ ุชุฑูุฏ.  ูุจูุช ูุธุงุฆู ุงููููุดุฆูู ููููุซููู ุงูุขู ูุธุงู ุงูููุซููู ูุญุฌุฌ ูุญุตูุช ุนูู ุงูุนูุงููู ุงูุถุฑูุฑูุฉ ูู ููุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs haskell"> //    - (  )   - <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameAgent (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) = mailboxNetwork.<span class="hljs-type"><span class="hljs-type">Box</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Command</span></span> list, <span class="hljs-type"><span class="hljs-type">GameState</span></span>&gt;(gameAddress) //    message loop           <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> commandAgentFn (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) commands msg = <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameAgent = gameAgent mailboxNetwork match msg with | <span class="hljs-type"><span class="hljs-type">Cmd</span></span> cmd -&gt; cmd::commands | <span class="hljs-type"><span class="hljs-type">Flush</span></span> -&gt; commands |&gt; gameAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> []</code> </pre><br><h4 id="medlenno" style=";text-align:right;direction:rtl">  ุจุจุทุก </h4><br><p style=";text-align:right;direction:rtl">  ูุฃุณุจุงุจ ูุงุถุญุฉ ุ ุฃุซูุงุก ุชุตุญูุญ ุงูุฃุฎุทุงุก ุ ููุช ุจุชุนููู ุงููุนุจุฉ ุนูู ุณุฑุนุฉ ููุฎูุถุฉ: ูุงู ุงูุชุฃุฎูุฑ ุจูู ุงููุฑุงุฏ ุฃูุซุฑ ูู 500 ูููู ุซุงููุฉ.  ุฅุฐุง ููุช ุจุชูููู ุงูุชุฃุฎูุฑ ุฅูู 200 ุ ููุฏ ุจุฏุฃุช ุงูุฑุณุงุฆู ุชุตู ูู ููุช ูุชุฃุฎุฑ ุ ูุนููุช ูุฑู ูู ุงููุณุชุฎุฏู ูุน ุงูุชุฃุฎูุฑ ุ ููุง ุฃูุณุฏ ุงููุนุจุฉ ุจุฃููููุง.  ููุงู ุฐุจุงุจุฉ ุฅุถุงููุฉ ูู ุงููุฑูู ูู ุญูููุฉ ุฃู ุงููุคูุช ุชููู ุฃูุฑ ุงูุฅููุงู ูู ุญุงูุฉ ุงูุฎุณุงุฑุฉ ุนุฏุฉ ูุฑุงุช.  ุจุงููุณุจุฉ ูููุณุชุฎุฏู ุ ูู ูุธูุฑ ูุฐุง ุจุฃู ุดูู ูู ุงูุฃุดูุงู ุ ูููู ูุน ุฐูู ุ ูุงู ููุงู ููุน ูู ุงูุฃุฎุทุงุก. <br>  ูุงูุช ุงูุญูููุฉ ุบูุฑ ุงูุณุงุฑุฉ ูู ุฃู ุงูููุซููู ุ ุจุงูุทุจุน ุ ุฑุงุฆุนูู ุจุดูู ูุฑูุญ ุ ูููู ููุงููุงุช ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ ุฃุณุฑุน ุจูุซูุฑ.  ูุฐูู ุ ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ุชุฎุฒูู ุงูุซุนุจุงู ููุณู ูู ููุซู ูููุตู ูุงู ููุงุณุจูุง ูู ูุฌูุฉ ูุธุฑ ุชูุธูู ุงูุฑูุฒ ุ ูุงู ุนููู ุงูุชุฎูู ุนู ูุฐู ุงูููุฑุฉ ุจุงุณู ุงูุณุฑุนุฉ ุ ูุฃูู ูุณุงุนุฉ ูุงุญุฏุฉ ูู ุงููุนุจุฉ ูุงูุช ุงูุฑุณุงุฆู ุดุฏูุฏุฉ ููุบุงูุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฑุณู ุงููุณุชุฎุฏู ุนุฏุฏูุง ุนุดูุงุฆููุง ูู ุงูุฃูุงูุฑ ูุจุงุดุฑุฉ ุฅูู ููุซู ุงูุฃูุฑ. </li><li style=";text-align:right;direction:rtl">  ูุฑุณู ุงููุคูุช ุนูุงูุฉ ุฅูู ููุซู ุงููุฑูู ุ ููู ุงูุชูููุฐ ุงููุจูุฑ ุฃูุถูุง ุฅูู ููุซู ุงูุซุนุจุงู ุจุญูุซ ูููู ุงูุซุนุจุงู ุฅูู ุงูุฎููุฉ ุงูุชุงููุฉ </li><li style=";text-align:right;direction:rtl">  ูุฑุณู ููุซู ุงูุฃูุฑ ูุงุฆูุฉ ุฃูุงูุฑ ููุซุนุจุงู ุนูุฏูุง ุชุฃุชู ุงูุฑุณุงูุฉ ุงูููุงุจูุฉ ูู ุงููุคูุช. </li><li style=";text-align:right;direction:rtl">  ูููู ููุซู ุงูุฃูุนู ุ ุจุนุฏ ุชุญุฏูุซ ุญุงูุชู ููููุง ููุฑุณุงูุชูู ุงูุนูููุชูู ุ ุจุฅุฑุณุงู ุงูุญุงูุฉ ุฅูู ุงูููุซู ุงูููุฏุงูู. </li><li style=";text-align:right;direction:rtl">  ุงูููุซู ุงูููุฏุงูู ูุนูุฏ ุฑุณู ูู ุดูุก.  ุฅุฐุง ูุฌุฏุช ุงูุซุนุจุงู ุทุนุงููุง ุ ูุฅูู ูุฑุณู ุฑุณุงูุฉ <code>GrowUp</code> ุฅูู ููุซู ุงูุซุนุจุงู ุ ูุจุนุฏ ุฐูู ูุฑุณู ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ ุฅูู ุงูููุซู ุงูููุฏุงูู. </li></ol><br><p style=";text-align:right;direction:rtl">  ูููู ูุฐุง ููุงู ุฏูุฑุฉ ุณุงุนุฉ ูุงุญุฏุฉ ุ ููู ููุณุช ูุงููุฉ ุ ูุน ูุฑุงุนุงุฉ ุงูุชุฒุงูู ูู ุฃุญุดุงุก <code>MailboxProcessor</code> .  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุงูุชุทุจูู ุงูุญุงูู ุ ูุฑุณู ุงููููุช ุงูุฑุณุงูุฉ ุงูุชุงููุฉ ูู n ูููู ุซุงููุฉ ุ ุจุบุถ ุงููุธุฑ ุนู ุฃู ุดูุก ุ ูุฐูู ุฅุฐุง ูู ูุตู ุฅูู ุงูุฅุฌุฑุงุก ูุฑุฉ ูุงุญุฏุฉ ุ ุชุจุฏุฃ ุงูุฑุณุงุฆู ูู ุงูุชุฑุงูู ุ ููุฒุฏุงุฏ ุงููุถุน ุณูุกูุง.  ุณูููู ูู ุงูุฃูุถู "ุชูุณูุน" ูุฐุง ุงูุฅุฌุฑุงุก ุงูุฎุงุต ุ ููุนุงูุฌุฉ ูู ูุง ุชุฑุงูู ุ ูุงููุถู ูุฏูุง. </p><br><h4 id="finalnaya-versiya" style=";text-align:right;direction:rtl">  ุงููุณุฎุฉ ุงูููุงุฆูุฉ </h4><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงุถุญ ุฃู ูุฎุทุท ุงูุฑุณุงุฆู ูุญุชุงุฌ ุฅูู ุชุจุณูุท ุ ูู ุญูู ุฃูู ูู ุงููุฑุบูุจ ููู ููุบุงูุฉ ุชุฑู ุงูุดูุฑุฉ ุจุณูุทุฉ ููููู ุงููุตูู ุฅูููุง ูุฏุฑ ุงูุฅููุงู - ุจุดูู ูุณุจู ุ ูุง ุฃุฑูุฏ ุฃู ุฃุถุน ูู ุดูุก ูู ููุซู ุฅูู ูุงุญุฏ ุ ููู ุซู ูุง ููุฌุฏ ุงููุซูุฑ ูู ุงููุนูู ูู ุงูููุซููู. <br>  ูุฐูู ุ ุจุงููุธุฑ ุฅูู ูุงุฆูุฉ ุงูููุซููู ุ ุฃุฏุฑูุช ุฃูู ูู ุงูุฃูุถู ุงูุชุถุญูุฉ ุจููุซู ุงูุฃูุนู ุฃููุงู.  ููุงู ุญุงุฌุฉ ุฅูู ุฌูุงุฒ ุถุจุท ุงูููุช ุ ููุง ููุฒู ูุฌูุฏ ูุฎุฒู ูุคูุช ูุฃูุงูุฑ ุงููุณุชุฎุฏู ูู ุฃุฌู ุชุฌููุนูุง ูู ุงูููุช ุงููุนูู ุ ูููู ุตุจูุง ูุฑุฉ ูุงุญุฏุฉ ููุท ููู ูุจุถุฉ ุ ููุง ุชูุฌุฏ ุญุงุฌุฉ ููุถูุนูุฉ ูุฅุจูุงุก ุงูุซุนุจุงู ูู ููุซู ูููุตู ุ ููุฏ ุชู ุฐูู ููุท ูู ุฃุฌู ุงูุฑุงุญุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุฎูุงู ุนูุฏู ูุน ุงูููุซู ุงูููุฏุงูู ุ ุณูููู ูู ุงููููู ูุนุงูุฌุฉ ุงูุจุฑูุงูุฌ ุงููุตู <code>GrowUp</code> ุฏูู ุชุฃุฎูุฑ.  ุฑุณุงูุฉ <code>Tick</code> ููุซุนุจุงู ูุง ูุนูู ููุง ุฃูุถูุง ุ ูุฃูู ุนูุฏูุง ูุชููู ุฑุณุงูุฉ ูู ููุซู ุงููุฑูู ุ ููุฐุง ูุนูู ุจุงููุนู ุฃู ููุงู ููุฒูุง ุฌุฏูุฏูุง.  ุฅุถุงูุฉ ุฅูู ุฐูู ุชูุฏุฏ ุงูุถุฑุจ ูู ุญุงูุฉ ุงูุชุฃุฎูุฑ ุ ูุฏููุง ุงูุชุบููุฑุงุช ุงูุชุงููุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููู ุจุฅุฒุงูุฉ ุฑุณุงุฆู <code>Tick</code> &amp; <code>GrowUp</code> . </li><li style=";text-align:right;direction:rtl">  ูุญูู ููุซู ุงูุซุนุจุงู ูู ุงูููุซู ุงูููุฏุงูู - ุณูุฎุฒู ุงูุขู "tapla" ูุฐู ุงูุฏูู. </li><li style=";text-align:right;direction:rtl">  ูููู ุจุฅุฒุงูุฉ <code>System.Timers.Timer</code> ูู ููุซู ุงููุคูุช.  ุจุฏูุงู ูู ุฐูู ุ ุณูููู ูุฎุทุท ุงูุนูู ููุง ููู: ุนูุฏูุง ูุชููู ุฃูุฑ <code>Start</code> ุ ูุฑุณู <code>Flush</code> ููุซู ุงููุฑูู.  ูุฑุณู ูุงุฆูุฉ ุจุงูุฃูุงูุฑ ุฅูู ุงูุญูู + ููุซู ุงูุฃูุนู ุ ูุนุงูุฌ ุงูููุซู ุงูุฃุฎูุฑ ูู ูุฐุง ููุฑุณู ุฑุณุงูุฉ <code>Next</code> ุฅูู ุงููุคูุช ุ ูุจุงูุชุงูู ูุทูุจ ุนูุงูุฉ ุฌุฏูุฏุฉ ููู.  ุงููุคูุช ุ ุจุนุฏ ุงุณุชูุงูู <code>Next</code> ููุชุธุฑ <code>Thread.Sleep(delay)</code> ููุจุฏุฃ ุงูุฏุงุฆุฑุฉ ุจุฃููููุง ูู ุฌุฏูุฏ.  ูู ุดูุก ุจุณูุท. </li></ol><br><p style=";text-align:right;direction:rtl">  ูุชูุฎูุต. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงูุชุทุจูู ุงูุณุงุจู ุ ูุงู 500 ูููู ุซุงููุฉ ูู ุงูุญุฏ ุงูุฃุฏูู ุงููุณููุญ ุจู ููุชุฃุฎูุฑ.  ูู ุงูุชุฃุฎูุฑ ุงูุญุงูู ุ ููููู ุฅุฒุงูุชู ุชูุงููุง - ุณูุชุทูุจ ุงูููุซู ุงูููุฏุงูู ููุฒูุง ุฌุฏูุฏูุง ุนูุฏูุง ูููู ุฌุงูุฒูุง.  ูู ูุนุฏ ูู ุงููููู ุฌูุน ุงูุฑุณุงุฆู ุงูุฃูููุฉ ูู ุงูุฅุฌุฑุงุกุงุช ุงูุณุงุจูุฉ. </li><li style=";text-align:right;direction:rtl">  ุฎุฑูุทุฉ ุงููุฑุงุณูุฉ ูุจุณุทุฉ ุฅูู ุญุฏ ูุจูุฑ - ุจุฏูุงู ูู ุฑุณู ุจูุงูู ูุนูุฏ ุ ูุฏููุง ุฃุจุณุท ุญููุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฐุง ุงูุชุจุณูุท ุญู ุงูุฎูู ุนูุฏูุง <code>Stop</code> ุงููุคูุช ุนุฏุฉ ูุฑุงุช ูู ุญุงูุฉ ุงูููุฏ. </li><li style=";text-align:right;direction:rtl">  ุชู ุชุฎููุถ ูุงุฆูุฉ ุงูุฑุณุงุฆู.  ููุฏ ุฃูู - ุดุฑ ุฃูู! </li></ul><br><p style=";text-align:right;direction:rtl">  ูุจุฏู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs haskell"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> [&lt;<span class="hljs-type"><span class="hljs-type">Literal</span></span>&gt;] commandAddress = <span class="hljs-string"><span class="hljs-string">"command"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> [&lt;<span class="hljs-type"><span class="hljs-type">Literal</span></span>&gt;] timerAddress = <span class="hljs-string"><span class="hljs-string">"timer"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> [&lt;<span class="hljs-type"><span class="hljs-type">Literal</span></span>&gt;] gameAddress = <span class="hljs-string"><span class="hljs-string">"game"</span></span> // -     <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> commandAgent (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) = mailboxNetwork.<span class="hljs-type"><span class="hljs-type">Box</span></span>&lt;<span class="hljs-type"><span class="hljs-type">CommandMessage</span></span>, <span class="hljs-type"><span class="hljs-type">Command</span></span> list&gt;(commandAddress) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> timerAgent (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) = mailboxNetwork.<span class="hljs-type"><span class="hljs-type">Box</span></span>&lt;<span class="hljs-type"><span class="hljs-type">TimerCommand</span></span>, <span class="hljs-type"><span class="hljs-type">TimerState</span></span>&gt;(timerAddress) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameAgent (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) = mailboxNetwork.<span class="hljs-type"><span class="hljs-type">Box</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Command</span></span> list, <span class="hljs-type"><span class="hljs-type">GameState</span></span>&gt;(gameAddress) // message loop   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameAgentFn (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) updateUi gameState cmd = <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> timerAgent = timerAgent mailboxNetwork //    match gameState.gameFrame with //     | <span class="hljs-type"><span class="hljs-type">Frame</span></span> field -&gt; //       <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameState = <span class="hljs-type"><span class="hljs-type">Game</span></span>.updateGameState gameState cmd timerAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> <span class="hljs-type"><span class="hljs-type">Next</span></span> //    updateUi gameState //     gameState // ! | <span class="hljs-type"><span class="hljs-type">End</span></span> (<span class="hljs-type"><span class="hljs-type">Win</span></span> _) -&gt; timerAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> <span class="hljs-type"><span class="hljs-type">PauseOrResume</span></span> <span class="hljs-type"><span class="hljs-type">Game</span></span>.updateGameState gameState cmd //        | _ -&gt; timerAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> <span class="hljs-type"><span class="hljs-type">Stop</span></span> //     gameState // message loop   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> commandAgentFn (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) commands msg = <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameAgent = gameAgent mailboxNetwork match msg with | <span class="hljs-type"><span class="hljs-type">Cmd</span></span> cmd -&gt; cmd::commands //       | <span class="hljs-type"><span class="hljs-type">Flush</span></span> -&gt; commands |&gt; gameAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> //     [] // message loop   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> timerAgentFn (mailboxNetwork: <span class="hljs-type"><span class="hljs-type">MailboxNetwork</span></span>) (state: <span class="hljs-type"><span class="hljs-type">TimerState</span></span>) cmd = <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> commandAgent = commandAgent mailboxNetwork match cmd with | <span class="hljs-type"><span class="hljs-type">Start</span></span> -&gt; commandAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> <span class="hljs-type"><span class="hljs-type">Flush</span></span>; {state with active = true} | <span class="hljs-type"><span class="hljs-type">Next</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> state.active <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> //    ,     <span class="hljs-type"><span class="hljs-type">Threading</span></span>.<span class="hljs-type"><span class="hljs-type">Thread</span></span>.<span class="hljs-type"><span class="hljs-type">Sleep</span></span>(state.delay) commandAgent.<span class="hljs-type"><span class="hljs-type">Post</span></span> <span class="hljs-type"><span class="hljs-type">Flush</span></span>; state | <span class="hljs-type"><span class="hljs-type">Stop</span></span> -&gt; printfn <span class="hljs-string"><span class="hljs-string">"Stop received"</span></span>; { state with active = false } | <span class="hljs-type"><span class="hljs-type">PauseOrResume</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> not state.active <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> //     <span class="hljs-comment"><span class="hljs-comment">--   commandAgent.Post Flush { state with active = not state.active } | SetDelay delay -&gt; Threading.Thread.Sleep(delay) if state.active then commandAgent.Post Flush {state with delay = delay}</span></span></code> </pre> <br><h4 id="ssylki" style=";text-align:right;direction:rtl">  ุงููุฑุงุฌุน </h4><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏูุฉ ูุตูุงุฏูู ุงูุจุฑูุฏ</a> </li><li style=";text-align:right;direction:rtl">  <a href="">ูุตุงุฏุฑ ุนูุจุฉ ุงูุจุฑูุฏ ุงูุฃูุซุฑ ูุถููุงู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑููุฒ ุงููุตุฏุฑ ููููุฐุฌ ุงูููุซู</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar424861/">https://habr.com/ru/post/ar424861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar424851/index.html">ูุง ูู ุงูุฎุทุฃ ูู ุชูุธูู ุชูููููุฌูุง ุงููุนูููุงุชุ</a></li>
<li><a href="../ar424853/index.html">ูุตุฉ ูุฑุงูุจ ุนุฑุถ ูุงุญุฏ ุฃุฑุงุฏ ุงูุชุจุงูู ุจูุทู</a></li>
<li><a href="../ar424855/index.html">ุงูุชุนูู ุงูุขูู: ุงูุชุฏุงูุน ูุน ููู ุงูุบุฑูุฉ</a></li>
<li><a href="../ar424857/index.html">ููุฐุช CloudFlare ุฏุนู SNI ุงููุดูุฑ</a></li>
<li><a href="../ar424859/index.html">ุฃุจุณุท ูุนุจุฉ ุงุฑุฏูููู ูุน ุดุงุดุฉ 1602 - ุงูุฌุฒุก ุงูุฃูู</a></li>
<li><a href="../ar424865/index.html">ุงูุชุดู ุฌุฒูุฆุงุช ุงูุชุตููู ุงูุงุจุชุฏุงุฆู</a></li>
<li><a href="../ar424867/index.html">ุชุทููุฑ Hexapod ูู ุงูุตูุฑ (ุงูุฌุฒุก 1) - ุงูุชุตููู</a></li>
<li><a href="../ar424869/index.html">ููู ุฐููุฑุชูู ููุฒุฉ iOS 12 ุงูุฌุฏูุฏุฉ ุจุฃู ุงูููุช ูุฏ ุญุงู ููุดูุงุก</a></li>
<li><a href="../ar424871/index.html">ุฅูููู ููุณู ูุชุณูุง ูุญูุงู ุงูุชูุงุถู ูุน ูุฌูุฉ ุงูุฃูุฑุงู ุงููุงููุฉ ูุงูุจูุฑุตุงุช ุงูุฃูุฑูููุฉ</a></li>
<li><a href="../ar424873/index.html">ูุทุจุงุช HttpClient ูู .NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>