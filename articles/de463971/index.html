<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥¤ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ¼ ğŸ›ŒğŸ½ Pentester Notes: JagdfÃ¤lle ğŸŒ ğŸ‘¸ğŸ¼ ğŸ¯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- Ihr seid cool! Also hat uns noch niemand im Stich gelassen! 
 - Wir haben es versucht. 

 Ja, das Leben von SchwachstellenjÃ¤gern ist voller spezifis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pentester Notes: JagdfÃ¤lle</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/463971/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/re/l-/nd/rel-ndtljsrzvl8wwp1enh1uvsw.jpeg" alt="Bild"></div><br>  <i>- Ihr seid cool!</i>  <i>Also hat uns noch niemand im Stich gelassen!</i> <i><br></i>  <i>- Wir haben es versucht.</i> <br><br>  Ja, das Leben von SchwachstellenjÃ¤gern ist voller spezifischer Komplimente von Kunden und nicht weniger spezifischer Situationen.  Im vergangenen Jahr haben wir mehr als fÃ¼nfzig Penetrationstests in verschiedenen Unternehmen durchgefÃ¼hrt und, wie gesagt, alles gesehen.  Ein Passwort fÃ¼r alle Konten und Systeme, die offene Speicherung von PasswÃ¶rtern in einer Datenbank, die Ãœberreste der Debugging-FunktionalitÃ¤t in einer Kampfumgebung ... Als unsere Kollegen von JSOC CERT mehrere Geschichten Ã¼ber Untersuchungen zu Cyber-VorfÃ¤llen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erzÃ¤hlten</a> , beschlossen wir in der Pentest-Abteilung, die andere Seite der â€Barrikadeâ€œ zu verfolgen und zu zeigen. Â»: Kundeninfrastruktur mit den Augen eines Hackers.  Heute erzÃ¤hlen wir Ihnen von den interessantesten externen Pentests der letzten Zeit, als wir in den internen Bereich des Kunden eindringen mussten und nur eine Liste seiner externen IP-Adressen und Domainnamen hatten. <br><a name="habracut"></a><br><h3>  Odyn </h3><br>  Montag: <br>  - Leute, fÃ¤ngt schneller mit einem Pentest an - du hast nur 3 Wochen Zeit, uns zu hacken.  Aber denken Sie daran, dass Ihre Chancen minimal sind: Sie Ã¼berprÃ¼fen uns jedes Jahr und finden keine Hinweise. <br><br>  Nach 4 Stunden: <br>  "Wir sind schon drinnen." <br>  - Nun ja?  So kann es nicht sein!  Jetzt Ã¼berprÃ¼fen wir die Protokolle ... <br><br>  Freitag: <br>  - Verdammt, wirklich.  Wie so ?!  Aber da die Zeit nicht geklappt hat, suchen Sie vielleicht nach etwas anderem? <br>  - Ja, keine Frage. <br><br>  Und wir begannen zu suchen.  Beim Durchsuchen des Unternehmensumfangs stieÃŸen wir auf einen Host, auf dem sich 4 Webanwendungen drehten, einen FTP-Server und das phpMyAdmin-Admin-Panel.  Die Analyse von Webanwendungen ergab keine kritischen Schwachstellen (z. B. SQL-Injections, XXE, RCE usw.), die uns den Zugriff auf den Server ermÃ¶glichen wÃ¼rden.  Irgendwann wechselten sie zu FTP - und hier war es schon interessanter: Anonymer Zugriff wurde auf dem Server geÃ¶ffnet, aber nur zum Lesen. <br><br><img src="https://habrastorage.org/webt/lt/qr/e_/ltqre_p9rtpvg9bjptbm3rdkoas.jpeg" alt="Bild"><br><br>  Wir haben mehrere Tage lang den Inhalt des Servers untersucht und einige seltsame Zeilen in den Protokollen gefunden - einige falsch eingegebene PasswÃ¶rter fÃ¼r einen der Administratoren der Webanwendung. <br><br><img src="https://habrastorage.org/webt/ct/b4/sg/ctb4sgs3uzd7vbrio_ocne28kle.jpeg" alt="Bild"><br><br>  Aufgrund der falschen Optionen haben wir angenommen, wie das Passwort aussehen soll, und es wurde angezeigt.  Wir haben beschlossen, es fÃ¼r phpMyAdmin zu versuchen, und - oh, ein Wunder - es ist auch aufgetaucht.  Als nÃ¤chstes war es eine kleine Sache - die Shell hochladen, Zugriff auf das interne Netzwerk erhalten, dort FuÃŸ fassen und sich bereits im Inneren entwickeln. <br><br><img src="https://habrastorage.org/webt/jo/_y/_q/jo_y_qwwskq7z10la6ijhcv7hpi.jpeg" alt="Bild"><br><br>  Auf diese Weise ebnet gewÃ¶hnliche Faulheit (und wie kann man sonst die ZurÃ¼ckhaltung bei der Eingabe unterschiedlicher KennwÃ¶rter fÃ¼r jedes Admin-Panel erklÃ¤ren?) Den Weg fÃ¼r Hacker in das interne Netzwerk des Unternehmens. <br><br><h3>  Warum in einer Kampfumgebung debuggen? </h3><br>  Die meisten unserer DurchbrÃ¼che erfolgen Ã¼ber Webanwendungen, und oft stoÃŸen wir auf merkwÃ¼rdige â€Ãœberresteâ€œ von Entwicklungs- und Testzeiten.  Oft finden wir Protokolle, einige Debug-Modi, aber nicht immer mit ihrer Hilfe haben wir es geschafft, RCE (Remote Code Execution) durchzufÃ¼hren. <br><br>  Bei einem unserer Kunden haben wir ein CRM-System entdeckt, fÃ¼r das wir uns entschieden haben, etwas mehr Zeit zu investieren (und das hat sich spÃ¤ter ausgezahlt).  Bei der Analyse der Anwendung fanden wir die Ãœberreste der Tests, die anscheinend in der Entwicklungsphase verwendet wurden.  Die Authentifizierung erfolgte auf sehr wundersame Weise: Nur der Benutzername und die Tatsache, dass ein Parameter mit einem Kennwort Ã¼bergeben wurde, wurden Ã¼berprÃ¼ft.  FÃ¼nf Minuten Suchen und Lesen der Standarddokumentation - und wir haben den Namen des integrierten Superuser-Kontos in der Hand.  Das BefÃ¼llen der Schale war bereits eine Frage der Technologie. <br><br><img src="https://habrastorage.org/webt/1v/x7/eu/1vx7euqw9abtywzmfoxknwfakwe.jpeg" alt="Bild"><br><br>  Ein weiteres Beispiel.  Zu Beginn des Projekts haben wir eine rekursive Bruteforce von Subdomains gestartet und verlassen.  Nach einiger Zeit erschien zu unserer Ãœberraschung eine Subdomain der fÃ¼nften Ebene namens test.debug.application.client.ru, auf der wir eine Webanwendung mit dort installiertem Adminer fanden.  Dies ist eine einfache Datenbankverwaltungsanwendung, in deren Ã¤lteren Versionen Sie bei falscher Konfiguration ohne Kennwort mit einer SQLite-Datenbank interagieren kÃ¶nnen. <br><br>  Die Tatsache, dass diese Datenbank keine Daten enthielt, war nicht wichtig. SchlieÃŸlich kÃ¶nnen Sie in SQLite eine Datenbank auf einem beliebigen Pfad mit einer einfachen Web-Shell erstellen und so den Server bequem verwalten und Befehle von einer Webseite aus ausfÃ¼hren. <br><br>  Es blieb nur die vollstÃ¤ndige Adresse der Webanwendung auf dem Server herauszufinden.  Hier half uns das â€geliebteâ€œ CMS 1C-Bitrix, das uns in einer Fehlermeldung gerne mitteilte, wo es sich befindet.  Dann blieb nur noch die HÃ¼lle zu fÃ¼llen und das Projekt zu beenden. <br><br><img src="https://habrastorage.org/webt/ca/sq/xa/casqxa5eywlhhzzy-c2etsjvkvk.jpeg" alt="Bild"><br><br>  Die Arbeit mit SQLite DB kann hier eingesehen <a href="">werden</a> . <br><br><h3>  Protokolle gefunden?  PasswÃ¶rter als Geschenk! </h3><br>  Ein Kunde hat uns gebeten, einen Pentest einer Webanwendung durchzufÃ¼hren.  In den letzten drei Jahren hielt er Pentests mit einem anderen Team ab und schaffte es wahrscheinlich, einige der LÃ¶cher im Perimeter zu flicken, sodass wir keinen schnellen Erfolg erwarteten. <br><br>  WÃ¤hrend des Fuzzing der Webanwendung haben wir eine Seite gefunden, auf der die Benutzerautorisierung protokolliert wurde.  Die Zeit und die Anmeldung des Benutzers, der sich bei der Anwendung angemeldet hat, wurden im Protokoll angezeigt.  Wir haben ein Skript geschrieben, das diese Seite einige Minuten lang abgefragt, die Antwort analysiert und die in einer Datei gefundenen Anmeldungen notiert hat.  Nach ein paar Tagen konnten wir ungefÃ¤hr hundert Logins sammeln.  Wir haben beschlossen, mit der Auswahl der PasswÃ¶rter zu beginnen. FÃ¼r 5 Anmeldungen wurden sie in der Liste der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">schlechtesten TOP-500-PasswÃ¶rter gefunden</a> . <br><br>  Nachdem wir Zugriff auf die Anwendung erhalten hatten, analysierten wir sie weiter und fanden eine weitere interessante Datei - alle Echtzeit-Datenbankabfragen wurden darin angezeigt.  Mit einem so praktischen Debugging-Tool ist das Suchen nach Schwachstellen und das Ausnutzen der gefundenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">booleschen zeitbasierten SQL-Injection</a> zu einer trivialen Aufgabe geworden. <br><br>  Trotz der Tatsache, dass es bereits 2019 ist, glauben die Leute immer noch, dass das Speichern von PasswÃ¶rtern in einer Datenbank in offener Form eine gute Idee ist.  Wir verwenden dies und haben SQL Injection gefunden und erhalten ein Administratorkonto, mit dem wir die Web-Shell ausfÃ¼llen kÃ¶nnen. Der offene Zugriff auf das interne Netzwerk der Organisation war keine groÃŸe Sache. <br><br><h4>  Schnittmarken </h4><br>  FÃ¼hren Sie zunÃ¤chst regelmÃ¤ÃŸige Penetrationstests durch. Sie helfen Ihnen dabei, dÃ¼nne Stellen zu finden, die Sie in der Entwicklungsphase oder beim Wechsel von Testumgebungen zu Kampfumgebungen mÃ¶glicherweise Ã¼bersehen haben. <br><br>  Zweitens sollten Sie immer den menschlichen Faktor berÃ¼cksichtigen: Menschen sind einfach zu faul, um PasswÃ¶rter zu Ã¤ndern, und sie kÃ¶nnen sogar ein Passwort auf mehreren Websites verwenden.  Ja, Admins sÃ¼ndigen dies auch. <br><br>  Drittens entfernen Sie Debugging-Modi in Kampfumgebungen. <br><br><h3>  PS </h3><br>  Im Allgemeinen ist der Alltag der Pentest-Abteilung voller â€Unterhaltungenâ€œ, und natÃ¼rlich sind nicht nur externe Tests erforderlich.  Der Kunde mÃ¶chte mÃ¶glicherweise nach Schwachstellen des internen Perimeters (interner Pentest) suchen, die Sicherheit von Web- und Mobilanwendungen sowie WiFi-Netzwerken analysieren oder die Mitarbeiter mithilfe von Social-Engineering-Methoden Ã¼berprÃ¼fen lassen. <br><br>  In unserer Freizeit aus Projekten <s>verstehen</s> wir <s>Zen,</s> suchen nach neuen Schwachstellen, verbessern unsere Werkzeuge und Techniken.  Und wir sind mit einem Bugbounty beschÃ¤ftigt (wo ohne es). <br><br>  In den folgenden BeitrÃ¤gen erfahren Sie mehr Ã¼ber die Vielfalt unserer â€Abenteuerâ€œ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463971/">https://habr.com/ru/post/de463971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463957/index.html">So stellen Sie eine einfach verknÃ¼pfte Interviewliste bereit</a></li>
<li><a href="../de463961/index.html">Eigener Mapper oder ein wenig Ã¼ber ExpressionTrees</a></li>
<li><a href="../de463963/index.html">Gesichtserkennung auf einer Baustelle</a></li>
<li><a href="../de463965/index.html">Gesetzte Anwendung in LaTeX</a></li>
<li><a href="../de463969/index.html">Telegramm Familienbudget</a></li>
<li><a href="../de463975/index.html">Moderne Umgebung fÃ¼r reaktive native Anwendungen</a></li>
<li><a href="../de463981/index.html">Mamas Sohn ist eifersÃ¼chtig: wie man den Alice Award zweimal gewinnt</a></li>
<li><a href="../de463983/index.html">Von 0% bis 70% des Marktes: Wie hat Google Chrome das Internet aufgenommen?</a></li>
<li><a href="../de463985/index.html">Aki Phoenix</a></li>
<li><a href="../de463987/index.html">Anwendungen fÃ¼r E-Books auf dem Android-Betriebssystem. Teil 2. Buchhandlungen und Buchleseranwendungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>