<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙌🏼 👨‍👨‍👧 🤟🏼 Bekerja dengan sensor Hall effect sekarang: ACS758 🧑🏽‍🤝‍🧑🏽 🤔 🚣🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 
 
 Mungkin ada baiknya memperkenalkan diri Anda sedikit - saya seorang insinyur sirkuit reguler yang juga tertarik dalam pemrograman d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bekerja dengan sensor Hall effect sekarang: ACS758</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/397641/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo semuanya! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin ada baiknya memperkenalkan diri Anda sedikit - saya seorang insinyur sirkuit reguler yang juga tertarik dalam pemrograman dan beberapa bidang elektronik lainnya: DSP, FPGA, komunikasi radio dan beberapa lainnya. Baru-baru ini, saya terjun langsung ke penerima SDR. Pada awalnya saya ingin mencurahkan artikel pertama saya (saya harap bukan yang terakhir) untuk beberapa topik yang lebih serius, tetapi bagi banyak orang itu hanya akan menjadi bahan bacaan dan tidak akan membawa manfaat apa pun. Oleh karena itu, topik yang dipilih sangat terspesialisasi dan diterapkan secara eksklusif. Saya juga ingin mencatat bahwa, mungkin, semua artikel dan pertanyaan di dalamnya akan dianggap lebih dari sisi perancang sirkuit, dan bukan dari programmer atau orang lain. Baiklah - ayo pergi!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Belum lama ini, saya memesan desain "Sistem Pemantauan untuk Catu Daya Bangunan Rumah Tinggal", pelanggan terlibat dalam pembangunan rumah di pinggiran kota, sehingga beberapa dari Anda mungkin sudah melihat perangkat saya. Perangkat ini mengukur arus konsumsi pada setiap fase input dan tegangan, secara bersamaan mengirim data melalui saluran radio ke sistem Smart Home yang sudah diinstal + alat ini dapat mengurangi starter pada input ke rumah. Tetapi pembicaraan hari ini bukan tentang dia, tetapi tentang komponennya yang kecil namun sangat penting - sensor saat ini. Dan seperti yang sudah Anda pahami dari judul artikel, ini akan menjadi sensor "non-kontak" saat ini dari Allegro - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACS758-100</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ________________________________________________________________________________________________________________________</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembar data, tentang yang akan saya bicarakan tentang sensor, dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Seperti yang Anda tebak, angka "100" di akhir penandaan adalah arus maksimum yang dapat diukur sensor. Terus terang - Saya ragu tentang hal ini, bagi saya tampaknya kesimpulannya tidak tahan 200A untuk waktu yang lama, meskipun sangat cocok untuk mengukur lonjakan arus. Di perangkat saya, sensor 100A tanpa masalah melewati setidaknya 35A dengan sendirinya + ada puncak konsumsi hingga 60A. </font></font><br>
<br>
<img src="http://s018.radikal.ru/i524/1609/71/d94191a601ce.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 1 - Tampilan sensor ACS758-100 (50/200)</font></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum pindah ke bagian utama artikel, saya sarankan Anda membiasakan diri dengan dua sumber. Jika Anda memiliki pengetahuan dasar tentang elektronik, maka mereka akan menjadi berlebihan dan merasa bebas untuk melewati paragraf ini. Saya menyarankan sisanya untuk membahas perkembangan dan pemahaman umum: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efek Hall. Fenomena dan prinsip operasi</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensor arus modern</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
________________________________________________________________________________________________________________________ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, mari kita mulai dengan yang paling penting, yaitu, penandaan. Saya membeli komponen dalam 90% kasus di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.digikey.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Komponen tiba di Rusia dalam 5-6 hari, mungkin ada semua yang ada di situs, dan juga pencarian parametrik dan dokumentasi yang sangat nyaman. Jadi daftar lengkap sensor dalam keluarga dapat ditemukan di sana berdasarkan permintaan " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACS758</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". Sensor saya dibeli di sana - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACS758LCB-100B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di dalam lembar data, semuanya dicat sesuai dengan tanda, tetapi saya masih memperhatikan titik kunci " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ": </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah batas pengukuran dalam ampere, yaitu, sensor saya dapat mengukur hingga 100A; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " - surat ini layak untuk diperhatikan, mungkin juga ada huruf " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " di tempatnya. Sensor dengan huruf </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mampu mengukur arus bolak-balik, dan sesuai langsung. </font><font style="vertical-align: inherit;">Sensor dengan huruf </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hanya dapat mengukur arus searah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga di awal lembar data ada piring yang sangat baik tentang topik ini: </font></font><br>
<img src="http://s017.radikal.ru/i441/1609/bd/3a7f9f45575c.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 2 - Jenis sensor saat ini dari keluarga ACS758</font></font></i><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Juga, salah satu alasan paling penting untuk menggunakan sensor tersebut adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isolasi galvanik</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Terminal daya 4 dan 5 tidak terhubung secara listrik ke terminal 1,2,3. </font><font style="vertical-align: inherit;">Dalam sensor ini, komunikasi hanya dalam bentuk bidang yang diinduksi.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter penting lainnya muncul dalam tabel ini - ketergantungan tegangan output pada arus. Keindahan dari jenis sensor ini adalah ia memiliki keluaran tegangan, bukan arus, seperti transformator arus klasik, yang sangat nyaman. Misalnya, output sensor dapat dihubungkan langsung ke input ADC dari mikrokontroler dan melakukan pembacaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sensor saya nilai ini adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20 mV / A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini berarti bahwa ketika arus 1A mengalir melalui terminal 4-5 dari sensor, tegangan pada outputnya akan meningkat sebesar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20 mV</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saya pikir logikanya jelas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat berikutnya, apa yang akan menjadi tegangan output? Mengingat bahwa makanan itu "manusia", yaitu, unipolar, maka ketika mengukur AC, harus ada "titik referensi". Pada sensor ini, titik referensi ini adalah 1/2 catu daya (Vcc). Solusi seperti itu sering terjadi dan nyaman. Ketika arus mengalir dalam satu arah, output akan menjadi " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1/2 Vcc + I * 0.02V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", di setengah siklus lainnya, ketika arus mengalir di arah yang berlawanan, tegangan output akan " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1/2 Vcc - I * 0.02V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". Pada output, kita mendapatkan gelombang sinus, di mana "nol" adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 / 2Vcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jika kita mengukur arus searah, maka outputnya adalah " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1/2 Vcc + I * 0.02V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", maka ketika memproses data pada ADC, kita cukup mengurangi komponen konstan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1/2 Vcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan kami bekerja dengan data yang benar, yaitu, dengan sisa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I * 0,02V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang saatnya untuk menguji dalam praktek apa yang saya jelaskan di atas, atau lebih tepatnya, dikurangi dalam lembar data. Untuk bekerja dengan sensor dan memeriksa kemampuannya, saya membangun "mini-stand" ini: </font></font><br>
<br>
<img src="http://s017.radikal.ru/i439/1609/64/ef807894e531.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 3 - Situs untuk menguji sensor saat ini</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pertama-tama, saya memutuskan untuk menerapkan daya ke sensor dan mengukur outputnya untuk memastikan bahwa itu "nol" dia telah mengambil </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1/2 Vcc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Diagram koneksi dapat diambil dalam lembar data, tetapi, hanya ingin berkenalan, saya tidak membuang waktu dan memahat kapasitor filter untuk daya + RC low-pass filter pada Vout pin. Di perangkat nyata, tidak ada tempat tanpa mereka! Saya mendapatkan gambar berikut pada akhirnya: </font></font><br>
<br>
<img src="http://s020.radikal.ru/i710/1609/34/567057bda04a.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 4 - Hasil pengukuran "nol"</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ketika daya diterapkan</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">syal STM32VL-Discovery</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya </font><i><font style="vertical-align: inherit;">,</font></i><font style="vertical-align: inherit;"> saya melihat hasil ini - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.38V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pertanyaan pertama yang muncul: " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa 2.38, dan tidak 2.5 dijelaskan dalam datasheet?</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " Pertanyaan itu menghilang hampir seketika - saya mengukur bus daya untuk debugging, dan ada 4.76-4.77V. Tetapi masalahnya adalah bahwa daya berasal dari USB, sudah ada 5V, setelah USB ada stabilizer linier LM7805, dan ini jelas bukan LDO dengan penurunan 40 mV. Di sini, sekitar 250 mV. Baiklah, ini tidak penting, hal utama yang perlu diketahui adalah "nol" adalah 2.38V. Konstanta inilah yang akan saya kurangi saat memproses data dari ADC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sekarang kita akan melakukan pengukuran pertama, sejauh ini hanya dengan bantuan osiloskop. Saya akan </font><b><font style="vertical-align: inherit;">mengukur</font></b><font style="vertical-align: inherit;"> arus hubung singkat catu daya yang dapat disesuaikan, yaitu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.06A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ini dan ammeter bawaan menunjukkan dan fluka memberikan hasil yang sama. Nah, kami menghubungkan output PSU ke kaki 4 dan 5 dari sensor (saya telah melempar koil di foto) dan melihat apa yang terjadi: </font></font><br>
<br>
<img src="http://s019.radikal.ru/i626/1609/40/ea87d3cbf889.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 5 - Pengukuran arus hubung singkat PSU</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Seperti yang dapat kita lihat, tegangan pada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vout</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meningkat </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari 2,38V menjadi 2,44V</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jika Anda melihat ketergantungan di atas, maka kita harus mendapatkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.38V + 3.06A * 0.02V / A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang sesuai dengan nilai 2.44V. Hasilnya memenuhi harapan, pada arus 3A kami mendapat peningkatan ke "nol" sama dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60 mV</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kesimpulan - sensor berfungsi, Anda sudah dapat bekerja dengannya dengan bantuan MK.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda perlu menghubungkan sensor saat ini dengan salah satu pin ADC pada mikrokontroler STM32F100RBT6. Kerikil itu sendiri sangat biasa-biasa saja, frekuensi sistem hanya 24 MHz, tetapi syal ini telah bertahan banyak dan telah terbukti dengan sendirinya. Saya sudah memilikinya, mungkin, sekitar 5 tahun, karena diterima gratis pada saat ketika ST membagikannya kanan dan kiri.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, karena kebiasaan, saya ingin meletakkan op-amp dengan koefisien setelah sensor. mendapatkan "1", tetapi, melihat diagram struktural, saya menyadari bahwa dia sudah berdiri di dalam. Satu-satunya hal yang perlu dipertimbangkan adalah bahwa pada arus maksimum daya output akan sama dengan catu daya sensor Vcc, yaitu sekitar 5V, dan STM dapat mengukur dari 0 hingga 3,3V, sehingga perlu dalam hal ini untuk meletakkan pembagi tegangan resistif, misalnya, 1: 1,5 atau 1: 2. Arus saya sedikit, jadi saya mengabaikan momen ini sejauh ini. Perangkat pengujian saya terlihat seperti ini: </font></font><br>
<br>
<img src="http://s017.radikal.ru/i401/1609/33/3efd82b449cd.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 6 - Menempatkan "ammeter" kami</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga, untuk memvisualisasikan hasilnya, saya mengacaukan tampilan Cina pada pengontrol ILI9341, manfaatnya ada di tangan, tetapi tangan saya tidak mencapainya sama sekali. </font><font style="vertical-align: inherit;">Untuk menulis perpustakaan lengkap untuknya, dia membunuh beberapa jam dan secangkir kopi, karena datasheetnya sangat informatif, yang jarang untuk kerajinan putra Jackie Chan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda perlu menulis fungsi untuk mengukur Vout menggunakan ADC mikrokontroler. </font><font style="vertical-align: inherit;">Saya tidak akan memberi tahu secara rinci, menurut STM32 sudah ada lautan informasi dan pelajaran. </font><font style="vertical-align: inherit;">Jadi lihat saja:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> get_adc_value()<font></font>
    {<font></font>
    ADC_SoftwareStartConvCmd(ADC1, ENABLE);<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(ADC_GetFlagStatus(ADC1, ADC_FLAG_EOC) == RESET);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ADC_GetConversionValue(ADC1);<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, untuk mendapatkan hasil pengukuran ADC dalam kode yang dapat dieksekusi dari badan utama atau interupsi, Anda perlu menulis yang berikut ini:</font></font><br>
<br>
<pre><code class="cpp hljs"> data_adc = get_adc_value();
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah sebelumnya mendeklarasikan variabel data_adc:</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> data_adc;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, kita mendapatkan variabel data_adc, yang mengambil nilai dari 0 hingga 4095, karena ADC dalam STM32 adalah 12 bit. Selanjutnya, kita perlu mengubah hasil "in beo" menjadi bentuk yang lebih akrab bagi kita, yaitu menjadi ampere. Karena itu, Anda harus terlebih dahulu menghitung harga pembagian. Setelah stabilizer di bus 3.3V, osiloskop saya menunjukkan 3.17V, saya tidak mengerti apa itu terhubung. Oleh karena itu, dengan membagi 3.17V dengan 4095, kita mendapatkan nilai 0,000774V - ini adalah harga pembagian. Artinya, mendapatkan hasil dari ADC, misalnya, 2711, saya cukup melipatgandakannya dengan 0,000774V dan dapatkan 2,09V. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam tugas kami, ketegangan hanyalah "mediator", kami masih perlu mengubahnya menjadi ampere. Untuk melakukan ini, kita perlu mengurangi 2.38B dari hasilnya, dan membagi sisanya dengan 0,02 [B / A]. Hasilnya adalah rumus ini:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> I_out = ((((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)data_adc * presc)<span class="hljs-number"><span class="hljs-number">-2.38</span></span>)/<span class="hljs-number"><span class="hljs-number">0.02</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, saatnya untuk mengisi firmware ke dalam mikrokontroler dan melihat hasilnya: </font></font><br>
<br>
<img src="http://s012.radikal.ru/i320/1609/81/192ff0ef3f85.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 7 - Hasil pengukuran data sensor dan pemrosesan mereka, saya</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mengukur konsumsi sirkuit sendiri seperti terlihat 230 mA. Setelah diukur sama dengan kebetulan yang terverifikasi, ternyata konsumsinya adalah 201 mA. Nah - akurasi dengan satu tempat desimal sudah sangat keren. Saya akan menjelaskan mengapa ... Rentang arus yang diukur adalah 0..100A, yaitu, akurasi hingga 1A adalah 1%, dan akurasi hingga sepersepuluh ampere sudah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,1%!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dan harap dicatat, ini tanpa solusi sirkuit. Aku bahkan terlalu malas untuk menggantung filter Condor untuk makanan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang Anda perlu mengukur arus hubung singkat (hubung singkat) dari sumber listrik saya. Saya memutar pegangan ke posisi maksimum dan mendapatkan gambar berikut: </font><i><font style="vertical-align: inherit;">Gambar 8 - Pengukuran arus hubung</font></i><font style="vertical-align: inherit;"> singkat</font></font><br>
<br>
<img src="http://s011.radikal.ru/i318/1609/4e/1d975e3d764f.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebenarnya bacaan pada sumber itu sendiri dengan ammeternya sendiri: </font></font><br>
<br>
<img src="http://s014.radikal.ru/i328/1609/17/0a3330682a48.jpg" alt="gambar"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 9 - Nilai pada skala BP</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sebenarnya, ia menunjukkan 3.09A, tetapi ketika saya memotret, vitukha dipanaskan dan resistannya meningkat, dan arus, karenanya, turun, tetapi ini tidak sangat menakutkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai kesimpulan, saya bahkan tidak tahu harus berkata apa. </font><font style="vertical-align: inherit;">Saya berharap bahwa artikel saya entah bagaimana akan membantu amatir radio pemula dalam kesulitan mereka. </font><font style="vertical-align: inherit;">Mungkin seseorang akan menyukai bentuk presentasi materi saya, maka saya dapat terus menulis secara berkala tentang bekerja dengan berbagai komponen. </font><font style="vertical-align: inherit;">Anda dapat mengekspresikan keinginan Anda pada topik di komentar, saya akan mencoba mempertimbangkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan tentu saja, saya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melampirkan kode sumber untuk program ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Anda tahu siapa yang butuh perpustakaan untuk bekerja dengan tampilan atau ADC. </font><font style="vertical-align: inherit;">Proyek itu sendiri di Keil 5.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id397641/">https://habr.com/ru/post/id397641/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id397631/index.html">Lingkungan Dyson - untuk apa ini? Bagian III: Penerapan Cincin Dyson dan elemen individual</a></li>
<li><a href="../id397633/index.html">Microsoft menyatukan ahli biologi dan pemrogram kanker</a></li>
<li><a href="../id397635/index.html">Hi-Fi Ingot: Cowon PLENUE S Audio Player</a></li>
<li><a href="../id397637/index.html">Pemantauan pertanian kolektif UPS dengan protokol Megatec di Zabbix</a></li>
<li><a href="../id397639/index.html">Obat Radiasi Darurat</a></li>
<li><a href="../id397643/index.html">Rumah pintar lain, di beberapa bagian. Pencahayaan dekoratif</a></li>
<li><a href="../id397645/index.html">Geohot mengumumkan autopilot "peretasan" seharga $ 999</a></li>
<li><a href="../id397649/index.html">Peluncuran stasiun ruang angkasa Tiongkok Tiangong-2 [terjemahan teks selesai]</a></li>
<li><a href="../id397653/index.html">Perhitungan diterbitkan untuk teori asal mula titik Mordor di kutub utara Charon</a></li>
<li><a href="../id397655/index.html">Inti asli sebagai pertanda unsur-unsur kehidupan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>