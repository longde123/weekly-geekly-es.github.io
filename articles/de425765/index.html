<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë§ üëÖ üåä Einreichungsmechanismus - Spezielle kubanische Magie üèõÔ∏è üì¥ üöà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ansichten oder Ansichten sind eines der Konzepte der CUBA-Plattform, die in der Welt der Web-Frameworks nicht am h√§ufigsten verwendet werden. Um dies ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Einreichungsmechanismus - Spezielle kubanische Magie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/425765/"><p><img src="https://habrastorage.org/webt/ro/89/bc/ro89bcf9p8amjxin9ca0ksoctf8.jpeg" alt="CPAP"></p><br><p>  Ansichten oder Ansichten sind eines der Konzepte der CUBA-Plattform, die in der Welt der Web-Frameworks nicht am h√§ufigsten verwendet werden.  Um dies zu verstehen, m√ºssen Sie sich vor dummen Fehlern sch√ºtzen, wenn die Anwendung aufgrund unvollst√§ndigen Datenladens pl√∂tzlich nicht mehr funktioniert.  Mal sehen, was Darstellungen (Wortspiel beabsichtigt) sind und warum es eigentlich praktisch ist. </p><br><h3 id="problema-nezagruzhennyh-dannyh">  Das Problem der entladenen Daten </h3><br><p>  Nehmen wir einen Themenbereich einfacher und betrachten das Problem anhand seines Beispiels.  Angenommen, wir haben eine <em>Kundenentit√§t</em> , die sich auf eine <em>CustomerType-</em> Entit√§t in einer Eins-zu-Eins-Beziehung bezieht. Mit anderen Worten, der K√§ufer hat einen Link zu einem bestimmten Typ, der dies beschreibt: z. B. "Cash Cow", "Snapper" usw.  Die <em>CustomerType-</em> Entit√§t verf√ºgt √ºber ein Namensattribut, in dem der <em>Typname</em> gespeichert ist. </p><br><p>  Und wahrscheinlich haben alle Neulinge (und sogar fortgeschrittene Benutzer) in CUBA fr√ºher oder sp√§ter diesen Fehler erhalten: </p><br><p><code>IllegalStateException: Cannot get unfetched attribute [type] from detached object com.rtcab.cev.entity.Customer-e703700d-c977-bd8e-1a40-74afd88915af [detached].</code> </p> <br><p><img src="https://habrastorage.org/webt/-x/ss/fm/-xssfm8nzwvf86jcicyrelm5nby.png" alt="In der CUBA-Benutzeroberfl√§che kann kein nicht abgerufener Attributfehler angezeigt werden"></p><br><p>  Gib es zu, du hast es auch mit eigenen Augen gesehen?  Ich - ja, in hundert verschiedenen Situationen.  In diesem Artikel untersuchen wir die Ursache dieses Problems, warum es √ºberhaupt existiert und wie es gel√∂st werden kann. <br>  F√ºr den Anfang eine kleine Einf√ºhrung in das Konzept der Ansichten. </p><br><h3 id="chto-takoe-predstavlenie">  Was ist eine Ansicht? </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eine Ansicht</a> in CUBA ist im Wesentlichen eine Sammlung von Spalten in einer Datenbank, die in einer einzigen Abfrage zusammen geladen werden m√ºssen. </p><a name="habracut"></a><br><p>  Angenommen, wir m√∂chten eine Benutzeroberfl√§che mit einer Kundentabelle erstellen, wobei die erste Spalte der Name des Kunden und die zweite der Typname aus dem Attribut <em>customerType ist</em> (wie im obigen Screenshot).  Es ist logisch anzunehmen, dass in diesem Datenmodell zwei separate Tabellen in der Datenbank vorhanden sind, eine f√ºr die <em>Kundenentit√§t</em> und die andere f√ºr <em>CustomerType</em> .  Die <code>SELECT * from CEV_CUSTOMER</code> gibt nur Daten aus einer Tabelle (Attributname usw.) zur√ºck.  Um Daten auch aus anderen Tabellen zu erhalten, verwenden wir nat√ºrlich JOINs. </p><br><p>  Bei Verwendung klassischer SQL-Abfragen mit JOIN wird die Zuordnungshierarchie (Referenzattribute) aus dem Diagramm in eine flache Liste erweitert. <br>  <em>Anmerkung des √úbersetzers: Mit</em> anderen Worten, die Beziehungen zwischen den Tabellen werden gel√∂scht, und das Ergebnis wird in einem einzelnen Datenarray dargestellt, das die Vereinigung der Tabellen darstellt. </p><br><p>  Im Fall von CUBA wird ORM verwendet, das keine Informationen √ºber Beziehungen zwischen Entit√§ten verliert und das Ergebnis von Abfragen in Form eines integralen Diagramms der angeforderten Daten darstellt.  In diesem Fall wird JPQL, ein Objektanalogon von SQL, als Abfragesprache verwendet. </p><br><p>  Trotzdem m√ºssen die Daten noch irgendwie aus der Datenbank entladen und in ein Entit√§tsdiagramm umgewandelt werden.  Zu diesem Zweck hat der objektrelationale Zuordnungsmechanismus (der JPA ist) zwei Hauptans√§tze f√ºr Abfragen an die Datenbank. </p><br><h3 id="lazy-loading-vs-eager-fetching">  Faules Laden vs.  eifriges holen </h3><br><p>  Lazy Loading und Greedy Loading sind zwei m√∂gliche Strategien, um Daten aus der Datenbank abzurufen.  Der grundlegende Unterschied zwischen den beiden besteht darin, dass die Daten aus den verkn√ºpften Tabellen geladen werden.  Ein kleines Beispiel zum besseren Verst√§ndnis: </p><br><p>  Erinnern Sie sich an die Szene aus dem Buch "Der Hobbit oder Round Trip", in der eine Gruppe von Gnomen in Begleitung von Gandalf und Bilbo versucht, um eine √úbernachtung in Beorns Haus zu bitten?  Gandalf befahl den Zwergen, streng abwechselnd zu erscheinen, und zwar erst, nachdem er Beorn sorgf√§ltig zugestimmt und begonnen hatte, sie einzeln vorzustellen, um den Besitzer nicht durch die Notwendigkeit zu schockieren, 15 G√§ste gleichzeitig unterzubringen. </p><br><p><img src="https://habrastorage.org/webt/ys/pm/ql/yspmqlsytd5vmefxszi9xeqqduc.jpeg" alt="Gandalf und die Zwerge in Beorns Haus"></p><br><p>  Also, Gandalf und die Zwerge in Beorns Haus ... Dies ist wahrscheinlich nicht das erste, was mir einf√§llt, wenn ich √ºber faule und gierige Downloads nachdenke, aber es gibt definitiv √Ñhnlichkeiten.  Gandalf handelte hier mit Bedacht, da er sich der Einschr√§nkungen bewusst war.  Man kann sagen, dass er sich bewusst f√ºr das verz√∂gerte Laden der Gnome entscheidet, da er verstanden hat, dass das gleichzeitige Herunterladen aller Daten f√ºr diese Datenbank zu schwer w√§re.  Nach dem 8. Gnom wechselte Gandalf jedoch zum gierigen Laden und lud ein paar der verbleibenden Gnome, weil er bemerkte, dass zu h√§ufige Zugriffe auf die Datenbank sie nicht weniger nerv√∂s machten. </p><br><p>  Die Moral ist, dass sowohl faules als auch gieriges Laden ihre Vor- und Nachteile haben.  Was in jeder spezifischen Situation anzuwenden ist, entscheiden Sie. </p><br><h3 id="problema-zaprosa-n1">  Problem N + 1 anfordern </h3><br><p>  Das N + 1-Abfrageproblem tritt h√§ufig auf, wenn Sie gedankenlos faul laden, wohin Sie auch gehen.  Schauen wir uns zur Veranschaulichung einen Teil des Grails-Codes an.  Dies bedeutet nicht, dass in Grails alles tr√§ge geladen wird (tats√§chlich w√§hlen Sie die Boot-Methode selbst).  In Grails gibt eine Abfrage an die Datenbank standardm√§√üig Entit√§tsinstanzen mit allen Attributen aus ihrer Tabelle zur√ºck.  Im Wesentlichen wird <code>SELECT * FROM Pet</code> ausgef√ºhrt. </p><br><p>  Wenn Sie tiefer in die Beziehungen zwischen Entit√§ten einsteigen m√∂chten, m√ºssen Sie dies post factum tun.  Hier ist ein Beispiel: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> getPetOwnerNamesForPets(String nameOfPet) { def pets = Pet.findAll(sort:"name") { <span class="hljs-type"><span class="hljs-type">name</span></span> == nameOfPet } def ownerNames = [] pets.<span class="hljs-keyword"><span class="hljs-keyword">each</span></span> { ownerNames &lt;&lt; it.<span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.name } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ownerNames.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(", ") }</code> </pre> <br><p>  Das Diagramm wird hier durch eine einzelne Zeile <code>it.owner.name</code> : <code>it.owner.name</code> .  Eigent√ºmer ist eine Beziehung, die in der urspr√ºnglichen Anforderung ( <code>Pet.findAll</code> ) nicht geladen wurde.  Jedes Mal, wenn diese Zeile aufgerufen wird, f√ºhrt GORM so etwas wie <code>SELECT * FROM Person WHERE id='‚Ä¶'</code> .  Faules Laden mit reinem Wasser. </p><br><p>  Wenn Sie die Gesamtzahl der SQL-Abfragen berechnen, erhalten Sie N (ein Eigent√ºmer f√ºr jeden Aufruf von <code>it.owner</code> ) + 1 (f√ºr das urspr√ºngliche <code>Pet.findAll</code> ).  Wenn Sie tiefer in das Diagramm verwandter Entit√§ten einsteigen m√∂chten, wird Ihre Datenbank wahrscheinlich schnell an ihre Grenzen sto√üen. </p><br><p>  Als Entwickler ist es unwahrscheinlich, dass Sie dies bemerken, da Sie aus Ihrer Sicht nur die Grafik von Objekten umgehen.  Diese versteckte Verschachtelung in einer kurzen Zeile verursacht der Datenbank echte Schmerzen und macht das verz√∂gerte Laden manchmal gef√§hrlich. </p><br><p>  Bei der Entwicklung einer Hobby-Analogie k√∂nnte sich das Problem von N + 1 wie folgt manifestieren: Stellen Sie sich vor, Gandalf kann die Namen von Gnomen nicht in seinem Ged√§chtnis speichern.  Daher muss er, indem er die Zwerge einzeln vorstellt, zu seiner Gruppe zur√ºcktreten und den Zwerg nach seinem Namen fragen.  Mit diesen Informationen kehrt er zu Beorn zur√ºck und vertritt Thorin.  Dann wiederholt er dieses Man√∂ver f√ºr Bifur, Bofur, Fili, Kili, Dori, Nori, Ori, Oin, Gloyn, Balin, Dvalin und Bombur. </p><br><p><img src="https://habrastorage.org/webt/fw/g_/vs/fwg_vscjob0zb0yzrn7dhrj2o_s.jpeg" alt="Zwerge N + 1 Problem"></p><br><p>  Es ist leicht vorstellbar, dass ein solches Szenario wahrscheinlich nicht geboren wird: Welcher Empf√§nger m√∂chte so lange auf die angeforderten Informationen warten?  Daher sollten Sie diesen Ansatz nicht gedankenlos verwenden und sich blind auf die Standardeinstellungen Ihres Persistenz-Mappers verlassen. </p><br><h3 id="reshaem-problemu-zaprosov-n1-s-pomoschyu-cuba-views">  L√∂sen des Problems von N + 1-Abfragen mithilfe von CUBA-Ansichten </h3><br><p>  In CUBA wird das Problem der N + 1-Abfrage h√∂chstwahrscheinlich nie auftreten, da die Plattform entschieden hat, das versteckte verz√∂gerte Laden √ºberhaupt nicht zu verwenden.  Stattdessen f√ºhrte CUBA das Konzept der Repr√§sentation ein.  Ansichten beschreiben, welche Attribute ausgew√§hlt und zusammen mit Entit√§tsinstanzen geladen werden sollen.  So etwas wie </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pet.name, person.name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Pet pet <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> Person person <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> pet.owner == person.id</code> </pre> <br><p>  In der Ansicht werden einerseits die Spalten beschrieben, die aus der Haupttabelle ( <em>Pet</em> ) geladen werden m√ºssen (anstatt alle Attribute √ºber * zu laden), andererseits werden die Spalten beschrieben, die aus c-JOIN-Tabellen geladen werden sollen. </p><br><p>  Sie k√∂nnen sich die CUBA-Ansicht als SQL-Ansicht f√ºr OR-Mapper vorstellen: Das Funktionsprinzip ist ungef√§hr dasselbe. </p><br><p>  In der CUBA-Plattform k√∂nnen Sie keine Abfrage √ºber den DataManager aufrufen, ohne die Ansicht zu verwenden.  Die Dokumentation enth√§lt ein Beispiel: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DataManager dataManager; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Book </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadBookById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UUID bookId)</span></span></span><span class="hljs-function"> </span></span>{ LoadContext&lt;Book&gt; loadContext = LoadContext.create(Book.class) .setId(bookId).setView(<span class="hljs-string"><span class="hljs-string">"book.edit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataManager.load(loadContext); }</code> </pre> <br><p>  Hier m√∂chten wir das Buch anhand seiner ID herunterladen.  Die Methode <code>setView("book.edit")</code> gibt beim Erstellen eines <code>setView("book.edit")</code> , mit welcher Ansicht das Buch aus der Datenbank geladen werden soll.  Falls Sie keine Ansicht √ºbergeben, verwendet der Datenmanager eine der drei Standardansichten, √ºber die jede Entit√§t verf√ºgt: die <em>_local-Ansicht</em> .  Lokal bezieht sich hier auf Attribute, die nicht auf andere Tabellen verweisen, alles ist einfach. </p><br><h3 id="reshenie-problemy-s-illegalstateexception-cherez-views">  L√∂sen des Problems mit IllegalStateException durch Ansichten </h3><br><p>  Nachdem wir das Konzept der Darstellungen ein wenig verstanden haben, kehren wir zum ersten Beispiel vom Anfang des Artikels zur√ºck und versuchen, das Ausl√∂sen einer Ausnahme zu verhindern. </p><br><p>  Die Meldung <em>IllegalStateException: Nicht abgerufenes Attribut [] von getrenntem Objekt kann nicht abgerufen werden</em> bedeutet nur, dass Sie versuchen, ein Attribut anzuzeigen, das nicht in der Ansicht enthalten ist, mit der die Entit√§t geladen wird. </p><br><p>  Wie Sie sehen k√∂nnen, habe ich im Bildschirmdeskriptor die <em>lokale Ansicht verwendet</em> , und dies ist das ganze Problem: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dsContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_local"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[select e from cev$Customer e]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dsContext</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Um den Fehler zu beheben, m√ºssen Sie zuerst den Kundentyp in die Ansicht aufnehmen.  Da wir die Standardansicht von <em>_local</em> nicht √§ndern <em>k√∂nnen</em> , k√∂nnen wir unsere eigene erstellen.  In Studio kann dies beispielsweise wie folgt erfolgen (Rechtsklick auf Entit√§ten&gt; Ansicht erstellen): </p><br><p><img src="https://habrastorage.org/webt/ki/oz/vy/kiozvyydas04xj9ypswst8afvxo.png" alt="Erstellen einer Ansicht in Studio"></p><br><p>  entweder direkt im <a href="">views.xml-</a> Deskriptor unserer Anwendung: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">view</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">extends</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_local"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customer-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_minimal"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">view</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Danach √§ndern wir den Link zur Ansicht im Suchbildschirm wie folgt: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.rtcab.cev.entity.Customer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">view</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customer-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[select e from cev$Customer e]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupDatasource</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Dies l√∂st das Problem vollst√§ndig und jetzt werden die Linkdaten auf dem Kundenbildschirm angezeigt. </p><br><h3 id="predstavlenie-_minimal-i-ponyatie-instance-name">  _Minimale Ansicht und Instanzname </h3><br><p>  Was im Zusammenhang mit Ansichten noch erw√§hnenswert ist, ist die <em>_minimale</em> Ansicht.  Die lokale Ansicht hat eine sehr klare Definition: Sie enth√§lt alle Attribute der Entit√§t, die direkte Attribute der Tabelle sind (die keine Fremdschl√ºssel sind). </p><br><p>  Die Definition einer minimalen Darstellung ist nicht so offensichtlich, aber auch ganz klar. </p><br><p>  CUBA hat das Konzept eines Entit√§tsinstanznamens - Instanzname.  Der <code>toString()</code> entspricht der <code>toString()</code> -Methode in gutem alten Java.  Dies ist eine Zeichenfolgendarstellung einer Entit√§t zur Anzeige auf einer Benutzeroberfl√§che und zur Verwendung in Links.  Der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Instanzname</a> wird mithilfe der Annotation der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NamePattern-</a> Entit√§t festgelegt. </p><br><p>  Es wird folgenderma√üen verwendet: <code>@NamePattern("%s (%s)|name,code")</code> .  Wir haben zwei Ergebnisse: </p><br><h4 id="imya-ekzemplyara-opredelyaet-otobrazhenie-suschnosti-v-ui">  Der Instanzname definiert die Zuordnung der Entit√§t zur Benutzeroberfl√§che </h4><br><p>  Zun√§chst bestimmt der Instanzname, welche und in welcher Reihenfolge in der Benutzeroberfl√§che angezeigt wird, wenn eine Entit√§t auf eine andere Entit√§t verweist (wie <em>Customer</em> auf <em>CustomerType</em> verweist). </p><br><p>  In unserem Fall wird der Kundentyp als Name der <em>CustomerType-</em> Instanz angezeigt, zu der der Code in die Klammern eingef√ºgt wird.  Wenn der Instanzname nicht festgelegt ist, werden der Name der Entit√§tsklasse und die ID der jeweiligen Instanz angezeigt. Stimmen Sie zu, dass dies √ºberhaupt nicht das ist, was der Benutzer sehen m√∂chte.  In den folgenden Vorher- und Nachher-Screenshots finden Sie Beispiele f√ºr beide F√§lle. </p><br><p><img src="https://habrastorage.org/webt/wa/gd/u8/wagdu8lfbckngwhi2swjhgj8mxe.png" alt="Verweis auf eine Entit√§t, f√ºr die kein Instanzname angegeben ist"></p><br><p><img src="https://habrastorage.org/webt/uy/7f/ok/uy7fokvhqcl9m5jx0ui1ju2v4l0.png" alt="Eine Entit√§tsreferenz mit dem angegebenen Instanznamen"></p><br><h4 id="imya-ekzemplyara-opredelyaet-atributy-minimalnogo-predstavleniya">  Der Instanzname definiert minimale Ansichtsattribute </h4><br><p>  Das zweite, was die Annotation von NamePattern beeinflusst, ist: Alle Attribute, die nach dem vertikalen Balken angegeben werden, bilden automatisch eine <em>_minimale</em> Ansicht.  Auf den ersten Blick scheint dies offensichtlich, da die Daten in irgendeiner Form in der Benutzeroberfl√§che angezeigt werden m√ºssen, was bedeutet, dass Sie sie zuerst aus der Datenbank herunterladen m√ºssen.  Obwohl ich ehrlich gesagt selten √ºber diese Tatsache nachdenke. </p><br><p>  Hierbei ist zu beachten, dass die minimale Darstellung im Vergleich zur lokalen m√∂glicherweise Verweise auf andere Entit√§ten enth√§lt.  F√ºr den K√§ufer aus dem obigen Beispiel habe ich beispielsweise einen Instanznamen festgelegt, der ein lokales Attribut der <em>Kundenentit√§t</em> ( <code>name</code> ) und ein Referenzattribut ( <code>type</code> ) enth√§lt: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@NamePattern</span></span>(<span class="hljs-string"><span class="hljs-string">"%s - %s|name,type"</span></span>)</code> </pre> <br><p>  Die Mindestdarstellung kann rekursiv verwendet werden: (Kunde [Instanzname] -&gt; Kundentyp [Instanzname]) </p><br><p>  <em>Anmerkung</em> des <em>√úbersetzers:</em> Seit der Ver√∂ffentlichung des Artikels ist eine andere Systemansicht erschienen - <code>_base</code> view, die alle lokalen Nicht-Systemattribute und Attribute enth√§lt, die in der Annotation @NamePattern angegeben sind (d. <code>_minimal</code> <code>_local</code> <code>_minimal</code> + <code>_local</code> ). </p><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>  Abschlie√üend fassen wir das wichtigste Thema zusammen.  Dank der Ansichten k√∂nnen wir in CUBA explizit angeben, was aus der Datenbank geladen werden soll.  Ansichten bestimmen, was gierig geladen wird, w√§hrend die meisten anderen Frameworks verdeckt faul laden. </p><br><p>  Darstellungen m√∂gen wie ein umst√§ndlicher Mechanismus erscheinen, aber auf lange Sicht rechtfertigen sie sich. </p><br><p>  Ich hoffe, ich habe es geschafft, auf zug√§ngliche Weise zu erkl√§ren, was diese mysteri√∂sen Ansichten tats√§chlich sind.  Nat√ºrlich gibt es fortgeschrittenere Szenarien f√ºr ihre Verwendung sowie Fallstricke bei der Arbeit mit Darstellungen im Allgemeinen und mit minimalen Darstellungen im Besonderen, aber ich werde irgendwie in einem separaten Beitrag dar√ºber schreiben. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de425765/">https://habr.com/ru/post/de425765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de425753/index.html">Google+ RIP</a></li>
<li><a href="../de425755/index.html">Entwicklung: New Generation Messenger (Teil 3). Desktop-Anwendungen</a></li>
<li><a href="../de425759/index.html">Neue Cyborg-Abenteuer in Deutschland</a></li>
<li><a href="../de425761/index.html">DevDay Pro Testing: Aufzeichnen von Berichten</a></li>
<li><a href="../de425763/index.html">PHP Excel Templator (PHP Templating Engine f√ºr Excel) oder wie wir zuvor Hardcode f√ºr Excel geschrieben haben</a></li>
<li><a href="../de425767/index.html">Splunk 7.2 Was ist neu? SmartStore, Lastmanagement und mehr ...</a></li>
<li><a href="../de425769/index.html">Wie man MySQL beibringt, in die Vergangenheit zu schauen</a></li>
<li><a href="../de425771/index.html">Das Prinzip der geringsten Wirkung in der analytischen Mechanik</a></li>
<li><a href="../de425773/index.html">Wie wir Remote-Mitarbeiter steuern</a></li>
<li><a href="../de425775/index.html">Automatisierung der Sexindustrie oder des √∂ffentlichen Dienstes auf Deutsch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>