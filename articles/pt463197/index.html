<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîò üòë üë©üèº‚Äçü§ù‚Äçüë®üèª Blazor + MVVM = Silverlight ataca porque o mal antigo √© invenc√≠vel üè≥Ô∏è‚Äçüåà ‚úåüèº üëçüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! 

 Ent√£o, sim, o net core 3.0 estar√° dispon√≠vel em breve e haver√° um modelo de projeto com o Blazor como um dos padr√µes. O nome da estrutura...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blazor + MVVM = Silverlight ataca porque o mal antigo √© invenc√≠vel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463197/">  Ol√° Habr! <br><br>  Ent√£o, sim, o net core 3.0 estar√° dispon√≠vel em breve e haver√° um modelo de projeto com o Blazor como um dos padr√µes.  O nome da estrutura, na minha opini√£o, √© semelhante ao nome de alguns Pok√©mon.  Blazor entra na batalha!  Eu decidi olhar para que tipo de animal √© e com o que √© comido, ent√£o fiz uma folha de Todo nela.  Bem, no Vue.js tamb√©m, para compara√ß√£o com o assunto, porque, na minha opini√£o, eles s√£o semelhantes ao sistema de componentes em ambos e reatividade, e isso √© tudo.  Mais deusas deuses deuses!  Na verdade, este √© um guia para mentes jovens, n√£o fortes, com pregui√ßa de aprender TypeScript ou JavaScript e que desejam criar bot√µes e entradas no site.  Como naquele meme - "O t√©cnico queria escrever um livro, mas a instru√ß√£o acabou."  Quem est√° interessado nas minhas aventuras no front-end ou descobre que tipo de Blazor voc√™ √© bem-vindo ao gato. <a name="habracut"></a><br><br><h2>  1. Introdu√ß√£o </h2><br>  A Microsoft teve a id√©ia de trabalhar com C # em um navegador e chamou essa id√©ia de Silverlight.  N√£o decolou.  Esses tyrnets eram diferentes dos navegadores.  Por que acho que est√° decolando agora?  Porque agora os assemblies da Web est√£o em todos os navegadores modernos por padr√£o.  N√£o h√° necessidade de instalar uma extens√£o separada.  Outra quest√£o √© o tamanho dos aplicativos.  Se o Vue.js SPA pesar 1,7 megabytes, exatamente o mesmo no Blazor 21 megabytes.  Agora, a Internet se tornou mais r√°pida e confi√°vel do que durante o Silverlight e voc√™ precisa fazer o download do aplicativo uma vez e depois h√° o cache e todo o trabalho.  Em geral, Blazor parecia muito semelhante ao Vue.js.  E assim, como uma homenagem a Silverligtht, WPF e UWP, e apenas por ser t√£o comum entre os afiadores, decidi usar o padr√£o MVVM para o meu projeto.  Ent√£o, para refer√™ncia - geralmente sou um back-end e gostei do Blazor.  Eu aviso os fracos de cora√ß√£o - O design e o layout nos meus exemplos s√£o terr√≠veis e, no projeto com o Vue.js, um front-end experiente pode ver muito govnokod.  Bem, com ortografia e pontua√ß√£o, as coisas tamb√©m s√£o mais ou menos. <br><br><h2>  Refer√™ncias </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Todo exemplo no Vue + Vuex</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Todo exemplo no Blazor</a> <br><br><h2>  Modelos de posicionamento </h2><br><ol><li>  No lado do cliente.  Um SPA padr√£o que pode ser distribu√≠do de v√°rias maneiras.  No meu exemplo, usei um modelo no qual os arquivos do aplicativo s√£o enviados para o servidor do navegador no n√∫cleo do asp.net.  A desvantagem dessa abordagem est√° nos 21 megabytes que voc√™ precisa baixar para o navegador. </li><li>  No lado do servidor.  Tudo acontece no servidor e o DOM finalizado √© passado para o cliente atrav√©s de soquetes.  O navegador n√£o precisa baixar nada no come√ßo, mas, em vez disso, baixe constantemente o DOM atualizado em partes.  Bem, toda a carga no c√≥digo do cliente cai repentinamente no servidor. </li></ol><br>  Pessoalmente, gosto mais da primeira op√ß√£o e pode ser usado em todos os casos em que voc√™ n√£o precisa se preocupar com as convers√µes do usu√°rio.  Por exemplo, esse √© algum tipo de sistema interno de informa√ß√µes da empresa ou uma solu√ß√£o B2B especializada, porque o Blazor faz o download h√° muito tempo pela primeira vez.  Se seus usu√°rios fizerem login constantemente em seu aplicativo, eles n√£o perceber√£o nenhuma diferen√ßa com a vers√£o JS.  Se um usu√°rio clicar em um link de publicidade, basta olhar para que tipo de site existe, provavelmente ele n√£o vai esperar muito tempo para carregar o site e simplesmente sair.  Nesse caso, √© melhor usar a segunda op√ß√£o de canal, ou seja,  Blazor do lado do servidor <br><br><h2>  Cria√ß√£o de projeto </h2><br>  Fa√ßa o download do net core 3.0 <a href="">dotnet.microsoft.com/download/dotnet-core/3.0</a> <br>  Execute o comando no terminal que carregar√° os modelos necess√°rios para voc√™. <br><br><pre><code class="bash hljs">dotnet new -i Microsoft.AspNetCore.Blazor.Templates</code> </pre> <br>  Para criar um lado do servidor <br><br><pre> <code class="bash hljs">dotnet new blazorserverside -o MyWebApp</code> </pre><br>  Para o lado do cliente cujos arquivos ser√£o distribu√≠dos pelo servidor principal do asp.net <br><br><pre> <code class="bash hljs">dotnet new blazorhosted -o MyWebApp</code> </pre><br>  Se voc√™ queria exotismo e de repente decidiu n√£o usar o n√∫cleo do asp.net como servidor, mas outra coisa (voc√™ precisa disso?) Voc√™ pode criar apenas um cliente sem um servidor com este comando. <br><br><pre> <code class="bash hljs">dotnet new blazor -o MyWebApp</code> </pre><br><h2>  Liga√ß√µes </h2><br>  Suporta liga√ß√£o unidirecional e bidirecional.  Portanto, sim, voc√™ n√£o precisa de nenhum OnPropertichanged como no WPF.  Ao alterar o modelo de exibi√ß√£o, o layout muda automaticamente. <br><br><pre> <code class="cs hljs">&lt;label&gt;One way binding:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>=@Text /&gt; &lt;br /&gt; &lt;label&gt;Two way binding:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> @bind=@Text /&gt; &lt;br /&gt; &lt;label&gt;Two way binding         Text   oninput:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> @bind=@Text @bind:<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>=<span class="hljs-string"><span class="hljs-string">"oninput"</span></span> /&gt; <span class="hljs-comment"><span class="hljs-comment">//ViewModel @code{ string Text; async Task InpuValueChanged() { Console.WriteLine("Input value changed"); } }</span></span></code> </pre><br>  E assim, aqui temos um ViewModel (an√¥nimo) que possui um campo de texto. <br><br>  Na primeira entrada, por meio de "value = @ Text", fizemos a liga√ß√£o unidirecional.  Agora, quando alterarmos o texto no c√≥digo, o texto dentro da entrada mudar√° imediatamente.  Somente para que n√£o imprimamos em nossa entrada isso afeta de alguma forma nossa VM.  Na segunda entrada, atrav√©s de "@ bind = @ Text", fizemos a liga√ß√£o bidirecional.  Agora, se escrevermos algo novo em nossa entrada, nossa VM mudar√° imediatamente, e o contr√°rio tamb√©m ser√° verdadeiro, ou seja.  se alterarmos o campo Texto no c√≥digo, nossa entrada exibir√° imediatamente o novo valor.  H√° um MAS - por padr√£o, as altera√ß√µes est√£o vinculadas ao evento onchange de nossa entrada, portanto a VM mudar√° apenas quando concluirmos a entrada.  Na terceira entrada "@bind: event =" oninput "", alteramos o evento para transferir dados da VM para oninput agora, toda vez que imprimimos algum caractere, um novo valor √© imediatamente transferido para a nossa VM.  Voc√™ tamb√©m pode especificar um formato para DateTime, por exemplo, como este. <br><br><pre> <code class="cs hljs">&lt;input @bind=@Today @bind:format=<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd"</span></span> /&gt;</code> </pre> <br><h2>  Ver modelo </h2><br>  Voc√™ pode torn√°-lo an√¥nimo e precisar√° interromp√™-lo dentro do bloco "@code {}" <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> &lt;p&gt;  @UserName &lt;/p&gt; @code{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName{<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} }</code> </pre><br>  ou voc√™ pode coloc√°-lo em um arquivo separado.  Em seguida, ele deve ser herdado do ComponentBase e, na parte superior da p√°gina, especificar um link para nossa VM usando "@inherits" <br><br>  Por exemplo <br><br>  TodoViewModel.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TodoViewModel</span></span>: <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName{<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} }</code> </pre><br>  Todo.razor: <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits MyWebApp.ViewModels.TodoViewModel &lt;p&gt;  @UserName &lt;/p&gt;</code> </pre><br><h2>  Encaminhamento </h2><br>  As rotas √†s quais a p√°gina responder√° s√£o indicadas no in√≠cio da p√°gina usando "@page".  Al√©m disso, pode haver v√°rios.  O primeiro ser√° selecionado exatamente de acordo com a ordem, de cima para baixo.  Por exemplo: <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @page <span class="hljs-string"><span class="hljs-string">"/todo/delete"</span></span> &lt;h1&gt; Hello!&lt;/h1&gt;</code> </pre><br>  Esta p√°gina ser√° aberta em "/ todo" ou "todo / delete" <br><br><h2>  Layouts </h2><br>  Em geral, as coisas que s√£o iguais para v√°rias p√°ginas geralmente s√£o colocadas aqui.  Como uma barra lateral e muito mais. <br><br>  Para usar o layout em primeiro lugar, voc√™ precisa cri√°-lo.  Ele deve ser herdado de LayotComponentBase usando "@inherits".  Por exemplo <br><br><pre> <code class="cs hljs">@inherits LayoutComponentBase &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"sidebar"</span></span>&gt; &lt;NavMenu /&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"main"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"top-row px-4"</span></span>&gt; &lt;a href=<span class="hljs-string"><span class="hljs-string">"http://blazor.net"</span></span> target=<span class="hljs-string"><span class="hljs-string">"_blank"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"ml-md-auto"</span></span>&gt;About&lt;/a&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"content px-4"</span></span>&gt; @Body &lt;/div&gt; &lt;/div&gt;</code> </pre><br>  Em segundo lugar, ele precisa ser importado.  Para fazer isso, no diret√≥rio com as p√°ginas que o usar√£o, voc√™ precisa criar o arquivo _imports.razor e, em seguida, adicionar a linha "@layout" a este arquivo <br><br><pre> <code class="cs hljs">@layout MainLayout @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System</code> </pre><br>  Em terceiro lugar, voc√™ pode indicar na p√°gina qual layout ele usa diretamente <br><br><pre> <code class="cs hljs">@layout MainLayout @page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits BlazorApp.Client.Presentation.TodoViewModel &lt;h3&gt;Todo&lt;/h3&gt;</code> </pre><br>  Em geral, _imports.razor e o uso nele atuam em todas as p√°ginas que est√£o na mesma pasta. <br><br><h2>  Op√ß√µes de Rota </h2><br>  Primeiramente, indique o par√¢metro e seu tipo entre colchetes em nossa rota (sem distin√ß√£o entre mai√∫sculas e min√∫sculas).  Tipos padr√£o s√£o suportados.  Ent√£o, sim, n√£o h√° par√¢metros opcionais, ou seja,  O valor sempre deve ser passado. <br><br>  O valor em si pode ser obtido criando em nosso ViewModel uma propriedade com o mesmo nome que o par√¢metro e com o atributo BTV [Parameter] - executando antes - os dados e eventos nos componentes pai tamb√©m s√£o transmitidos usando o atributo [Parameter] como par√¢metros em cascata.  Eles s√£o transmitidos do componente pai para todos os seus componentes filhos e seus componentes filhos.  Eles s√£o usados ‚Äã‚Äãprincipalmente para estilos, mas √© melhor usar apenas estilos em CSS. Por que n√£o se importar? <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo/delete/{id:guid}"</span></span> &lt;h1&gt; Hello!&lt;/h1&gt; @code{ [Parameter] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Guid Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><h2>  DI </h2><br>  Tudo est√° registrado no Startup.cs, como em um aplicativo principal do asp.net comum.  Nada de novo aqui.  Mas a implementa√ß√£o de depend√™ncias para nossa VM ainda ocorre atrav√©s de propriedades p√∫blicas e n√£o atrav√©s do construtor.  A propriedade s√≥ precisa ser decorada com o atributo [Inject] <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteTodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { [Parameter] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Guid Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ICommandDispatcher CommandDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre><br>  Por padr√£o, existem 3 servi√ßos j√° conectados.  HttpClient - Bem, voc√™ sabe o porqu√™.  IJSRuntime - Chame o c√≥digo JS de C #.  IUriHelper - n√£o √© poss√≠vel redirecionar para outras p√°ginas. <br><br><h2>  Exemplo de aplica√ß√£o </h2><br><h3>  Todo Spreadsheet </h3><br>  TodoTableComponent.razor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//1) &lt;table class="table table-hover"&gt; &lt;thead&gt; &lt;th&gt; &lt;/th&gt; &lt;th&gt;&lt;/th&gt; &lt;th&gt; &lt;/th&gt; &lt;th&gt;&lt;/th&gt; &lt;/thead&gt; &lt;tbody&gt; //2) @foreach (var item in Items) { //3) &lt;tr @onclick=@(()=&gt;ClickRow(item.Id)) class="@(item.Id == Current?"table-primary":null)"&gt; &lt;td&gt;&lt;input type="checkbox" checked="@item.IsComplite" disabled="disabled" /&gt;&lt;/td&gt; &lt;td&gt;@item.Name&lt;/td&gt; &lt;td&gt;@item.Created.ToString("dd.MM.yyyy HH:mm:ss")&lt;/td&gt; &lt;td&gt;&lt;a href="/todo/delete/@item.Id" class="btn btn-danger"&gt;&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; } &lt;/tbody&gt; &lt;/table&gt; @code { //4) [Parameter] private List&lt;BlazorApp.Client.Presentation.TodoDto&gt; Items { get; set; } [Parameter] private EventCallback&lt;UIMouseEventArgs&gt; OnClick { get; set; } [Parameter] private Guid Current { get; set; } private async Task ClickRow(Guid id) { //5 await OnClick.InvokeAsync(CreateArgs(id)); } private ClickTodoEventArgs CreateArgs(Guid id) { return new ClickTodoEventArgs { Id = id }; } //6) public class ClickTodoEventArgs : UIMouseEventArgs { public Guid Id { get; set; } } }</span></span></code> </pre><br><ol><li>  Como esse componente, n√£o precisamos de "@page" e "@layout" porque ele n√£o participar√° do roteamento e usar√° o layout do componente pai </li><li>  O c√≥digo C # come√ßa com o s√≠mbolo @.  Na verdade, o mesmo que no Razor </li><li><pre> <code class="cs hljs">@onclick=@(()=&gt;ClickRow(item.Id))</code> </pre>  Vincula um evento de clique de linha ao m√©todo ClickRow do nosso ViewModel </li><li>  Especifique quais par√¢metros ser√£o transferidos do componente pai ou da p√°gina para a nossa usando o atributo [Parameter] </li><li>  Chamamos a fun√ß√£o de retorno de chamada recebida do componente pai.  Portanto, o componente pai descobre que algum evento ocorreu na crian√ßa.  As fun√ß√µes s√≥ podem ser passadas agrupadas em EventCallback &lt;&gt; EventArgs com par√¢metros.  Uma poss√≠vel lista de EventArgs pode ser encontrada aqui - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">docs.microsoft.com/ru-ru/aspnet/core/blazor/components?view=aspnetcore-3.0#event-handling</a> </li><li>  Como a lista de poss√≠veis tipos de EventArgs √© limitada e precisamos passar uma propriedade de ID adicional para o manipulador de eventos no lado do componente pai, criamos nossa pr√≥pria classe de par√¢metros herdada da base e a passamos para o evento.  Ent√£o, sim - no componente pai, o UIMouseEventArgs regular passar√° para a fun√ß√£o do manipulador de eventos e precisar√° ser convertido para o nosso tipo, por exemplo, usando o operador as </li></ol><br>  Exemplo de uso: <br><br><pre> <code class="cs hljs">&lt;TodoTableComponent Items=@Items OnClick=@Select Current=@(Selected?.Id??Guid.Empty)&gt;&lt;/TodoTableComponent&gt;</code> </pre> <br><h3>  P√°gina de remo√ß√£o de Todo </h3><br>  Nosso ViewModel, tamb√©m conhecido como VM, √© o DeleteTodoViewModel.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteTodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1) [Parameter] private Guid Id { get; set; } //2) [Inject] public ICommandDispatcher CommandDispatcher { get; set; } [Inject] public IQueryDispatcher QueryDispatcher { get; set; } [Inject] public IUriHelper UriHelper { get; set; } //3) public TodoDto Todo { get; set; } protected override async Task OnInitAsync() { var todo = await QueryDispatcher.Execute&lt;GetById,TodoItem&gt;(new GetById(Id)); if (todo != null) Todo = new TodoDto { Id = todo.Id, IsComplite = todo.IsComplite, Name = todo.Name, Created = todo.Created }; await base.OnInitAsync(); } //4) public async Task Delete() { if (Todo != null) await CommandDispatcher.Execute(new Remove(Todo.Id)); Todo = null; //5) UriHelper.NavigateTo("/todo"); } }</span></span></code> </pre><br><ol><li>  O par√¢metro de rota "/ todo / delete / {id: guid}" √© passado para Guid aqui se formos, por exemplo, para localhost / todo / delete / ae434aae44 ... </li><li>  Injete servi√ßos do cont√™iner DI em nossa VM. </li><li>  Apenas uma propriedade da nossa VM.  N√≥s mesmos estabelecemos seu valor, como queremos. </li><li>  Este m√©todo √© chamado automaticamente quando a p√°gina √© inicializada.  Aqui, definimos os valores necess√°rios para as propriedades da nossa VM </li><li>  O m√©todo da nossa VM.  Podemos vincul√°-lo, por exemplo, ao evento de clicar em qualquer bot√£o da nossa Visualiza√ß√£o </li><li>  Indo para outra p√°gina localizada no endere√ßo "/ todo", ou seja,  ela tem no in√≠cio a linha "@page" / todo "" <br>  Nossa vis√£o √© DeleteTodo.razor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//1) @page "/todo/delete/{id:guid}" @using BlazorApp.Client.TodoModule.Presentation @using BlazorApp.Client.Shared; //2) @layout MainLayout //3) @inherits DeleteTodoViewModel &lt;h3&gt; Todo &lt;/h3&gt; @if (Todo != null) { &lt;div class="row"&gt; &lt;div class="col"&gt; &lt;input type="checkbox" checked=@Todo.IsComplite disabled="disabled" /&gt; &lt;br /&gt; &lt;label&gt;@Todo.Name&lt;/label&gt; &lt;br /&gt; //4) &lt;button class="btn btn-danger" onclick=@Delete&gt;&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; } else { &lt;p&gt;&lt;em&gt; Todo  &lt;/em&gt;&lt;/p&gt; }</span></span></code> </pre><br><ol><li>  Indicamos que este pa√≠s estar√° dispon√≠vel no endere√ßo {endere√ßo raiz do nosso site} + "/ todo / delete /" + {algum tipo de guia}.  Por exemplo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">localhost / todo / delete / ae434aae44</a> ... </li><li>  Especifique que nossa p√°gina ser√° renderizada dentro de MainLayout.razor </li><li>  Especifique que nossa p√°gina utilizar√° as propriedades e m√©todos da classe DeleteTodoViewModel </li><li>  Refinamos que, quando voc√™ clica nesse bot√£o, o m√©todo Delete () da nossa VM ser√° chamado </li></ol><br><h3>  Todo Home </h3><br>  TodoViewModel.cs: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ICommandDispatcher CommandDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IQueryDispatcher QueryDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//1) [Required(ErrorMessage = "  Todo")] public string NewTodo { get; set; } public List&lt;TodoDto&gt; Items { get; set; } public TodoDto Selected { get; set; } protected override async Task OnInitAsync() { await LoadTodos(); await base.OnInitAsync(); } public async Task Create() { await CommandDispatcher.Execute(new Add(NewTodo)); await LoadTodos(); NewTodo = string.Empty; } //2) public async Task Select(UIMouseEventArgs args) { //3) var e = args as TodoTableComponent.ClickTodoEventArgs; if (e == null) return; var todo = await QueryDispatcher.Execute&lt;GetById, TodoItem&gt;(new GetById(e.Id)); if (todo == null) { Selected = null; return; } Selected = new TodoDto { Id = todo.Id, IsComplite = todo.IsComplite, Name = todo.Name, Created = todo.Created }; } public void CanselEdit() { Selected = null; } public async Task Update() { await CommandDispatcher.Execute(new Update(Selected.Id, Selected.Name, Selected.IsComplite)); Selected = null; await LoadTodos(); } private async Task LoadTodos() { var todos = await QueryDispatcher.Execute&lt;GetAll, List&lt;TodoItem&gt;&gt;(new GetAll()); Items = todos.Select(t =&gt; new TodoDto { Id = t.Id, IsComplite = t.IsComplite, Name = t.Name, Created = t.Created }) .ToList(); } }</span></span></code> </pre><br><ol><li>  Os atributos de valida√ß√£o padr√£o de System.ComponentModel.DataAnnotations s√£o suportados.  Especificamente, aqui indicamos que esse campo √© obrigat√≥rio e o texto que ser√° exibido se o usu√°rio n√£o especificar um valor na entrada que ser√° associada a esse campo. </li><li>  M√©todo para manipular um evento com um par√¢metro  Este m√©todo manipular√° o evento do componente filho. </li><li>  Lan√ßamos o argumento para o tipo que criamos no componente filho </li></ol><br>  Todo.razor: <br><br><pre> <code class="cs hljs">@layout MainLayout @page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits BlazorApp.Client.Presentation.TodoViewModel &lt;h3&gt;Todo&lt;/h3&gt; &lt;h4&gt;&lt;/h4&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"row"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"col"</span></span>&gt; @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Items == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { &lt;p&gt;&lt;em&gt;...&lt;/em&gt;&lt;/p&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Items.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { &lt;p&gt;&lt;em&gt;   .    .&lt;/em&gt;&lt;/p&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1) &lt;TodoTableComponent Items=@Items OnClick=@Select Current=@(Selected?.Id??Guid.Empty)&gt;&lt;/TodoTableComponent&gt; } &lt;/div&gt; &lt;/div&gt; &lt;br /&gt; &lt;h4&gt; Todo&lt;/h4&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; @if (Items != null) { //2) &lt;EditForm name="addForm" Model=@this OnValidSubmit=@Create&gt; //3) &lt;DataAnnotationsValidator /&gt; //4) &lt;ValidationSummary /&gt; &lt;div class="form-group"&gt; //5) &lt;InputText @bind-Value=@NewTodo /&gt; //6) &lt;ValidationMessage For="@(() =&gt; this. NewTodo)" /&gt; //7) &lt;button type="submit" class="btn btn-primary"&gt;&lt;/button&gt; &lt;/div&gt; &lt;/EditForm&gt; } &lt;/div&gt; &lt;/div&gt; &lt;br /&gt; &lt;h4&gt; Todo&lt;/h4&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; @if (Items != null) { @if (Selected != null) { &lt;EditForm name="editForm" Model=@Selected OnValidSubmit=@Update&gt; &lt;DataAnnotationsValidator /&gt; &lt;ValidationSummary /&gt; &lt;div class="form-group"&gt; &lt;InputCheckbox @bind-Value=@Selected.IsComplite /&gt; &lt;InputText @bind-Value=@Selected.Name /&gt; &lt;button type="submit" class="btn btn-primary"&gt;&lt;/button&gt; &lt;button type="reset" class="btn btn-warning" @onclick=@CanselEdit&gt;&lt;/button&gt; &lt;/div&gt; &lt;/EditForm&gt; } else { &lt;p&gt;&lt;em&gt;     &lt;/em&gt;&lt;/p&gt; } } &lt;/div&gt; &lt;/div&gt;</span></span></code> </pre><br><ol><li>  Chamamos o componente filho e passamos as propriedades e m√©todos da nossa VM como par√¢metros. </li><li>  Componente de formul√°rio interno com valida√ß√£o de dados.  Indicamos que, como modelo, ele usar√° nossa VM e, ao enviar dados v√°lidos, chamar√° o m√©todo Create () </li><li>  A valida√ß√£o ser√° realizada usando atributos de modelo como [Requared], etc. </li><li>  Aqui vou mostrar os erros gerais de valida√ß√£o </li><li>  Criar√° entrada com valida√ß√£o.  A lista de tags poss√≠veis √© InputText, InputTextArea, InputSelect, InputNumber, InputCheckbox, InputDate </li><li>  Erros de valida√ß√£o para a propriedade p√∫blica da sequ√™ncia NewTodo {get; set;} ser√£o exibidos aqui </li><li>  Quando voc√™ clica nesse bot√£o, o evento OnValidSubmit do nosso formul√°rio √© gerado </li></ol><br><h3>  Arquivo Startup.cs </h3><br>  Aqui registramos nossos servi√ßos <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IServiceCollection services</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// LocalStorage  SessionStorage       //    //     Nuget  Blazor.Extensions.Storage services.AddStorage(); services.AddSingleton&lt;ITodoRepository, TodoRepository&gt;(); services.AddSingleton&lt;ICommandDispatcher, CommandDispatcher&gt;(); services.AddSingleton&lt;IQueryDispatcher, QueryDispatcher&gt;(); services.AddSingleton&lt;IQueryHandler&lt;GetAll, List&lt;TodoItem&gt;&gt;, GetAllHandler&gt;(); services.AddSingleton&lt;IQueryHandler&lt;GetById, TodoItem&gt;, GetByIdHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Add&gt;, AddHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Remove&gt;, RemoveHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Update&gt;, UpdateHandler&gt;(); } public void Configure(IComponentsApplicationBuilder app) { //       App.razor //        &lt;app&gt;&lt;/app&gt; app.AddComponent&lt;App&gt;("app"); } }</span></span></code> </pre><br><h2>  Ep√≠logo </h2><br>  Este artigo foi escrito para estimular o apetite e incentivar um estudo mais aprofundado de Blazor.  Espero ter atingido meu objetivo.  Bem, para estudar melhor, recomendo a leitura do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">manual oficial da Microsoft</a> . <br><br><h2>  Agradecimentos </h2><br>  Agradecimentos a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">AndreyNikolin</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">win32nipuh</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">SemenPV</a> pelos erros ortogr√°ficos e gramaticais encontrados no texto. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt463197/">https://habr.com/ru/post/pt463197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt463183/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 13. Configurar VLAN</a></li>
<li><a href="../pt463185/index.html">Qu√£o poderosos terremotos bolivianos descobriram montanhas a uma profundidade de 660 quil√¥metros no subsolo</a></li>
<li><a href="../pt463189/index.html">Sobre o anonimato na Internet, a vida e sua relatividade</a></li>
<li><a href="../pt463193/index.html">Converta imagens em preto e branco em gr√°ficos ASCII usando decomposi√ß√£o de matriz n√£o negativa</a></li>
<li><a href="../pt463195/index.html">O que est√° acontecendo com a Internet Tele2</a></li>
<li><a href="../pt463203/index.html">O pesado fardo do tempo. Relat√≥rio Yandex sobre erros comuns no trabalho com o tempo</a></li>
<li><a href="../pt463205/index.html">Inicialmente inoperante: como sobreviver com um laptop no Windows 10 e uma unidade de 32 gigabytes</a></li>
<li><a href="../pt463207/index.html">Desenvolvimento Chatbot (telegrama + youtube)</a></li>
<li><a href="../pt463213/index.html">Conceitos errados para desenvolvedores iniciantes em C #. Tentando responder a perguntas padr√£o</a></li>
<li><a href="../pt463215/index.html">Engenheiros e arquitetos j√° est√£o projetando assentamentos lunares</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>