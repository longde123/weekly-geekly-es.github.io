<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèø ü§≥üèº üà∂ Entwickeln oder erstellen Sie eine Basis f√ºr Roboter auf der ARDUINO-Plattform, und wir steuern Sensoren und Videos √ºber ein Smartphone an einen Computer üëÉüèΩ üîõ üñïüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="F√ºr liebe Leser von GeekTimes ist der n√§chste (vierte) lang erwartete Artikel dar√ºber, was passieren wird, wenn Sie Arduino, ESP8266 und WI-FI erneut ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwickeln oder erstellen Sie eine Basis f√ºr Roboter auf der ARDUINO-Plattform, und wir steuern Sensoren und Videos √ºber ein Smartphone an einen Computer</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448516/"> F√ºr liebe Leser von GeekTimes ist der n√§chste (vierte) <s>lang erwartete</s> Artikel dar√ºber, was passieren wird, wenn Sie Arduino, ESP8266 und WI-FI erneut mischen, mit einem Android-Smartphone w√ºrzen und √ºber die JAVA-Anwendung streuen. <br><br>  Wir werden √ºber die Roboter aus dem vorletzten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> sprechen, der die Zeit hatte, zumindest ein bisschen schlauer zu werden. <br><br><img src="https://habrastorage.org/webt/dc/uf/us/dcufusp1engi_cqy_pdjltx-qgq.jpeg" alt="Bild"><br><br>  Wen k√ºmmert es, willkommen bei Katze. <br><a name="habracut"></a><br>  Wenn Sie nicht sehr daran interessiert sind, alte Artikel zu lesen, dann war der Punkt, dass zur Steuerung des √ºblichen vierr√§drigen Wagens auf der Arduino-Plattform eine von mir entwickelte drahtlose UART-Br√ºcke hinzugef√ºgt wurde, die auf dem bekannten ESP8266-Modul basiert.  Aus praktischen Gr√ºnden (und im Allgemeinen war dies das Hauptziel) mit demselben ESP habe ich einen Programmierer f√ºr Arduinki geschrieben, mit dem Sie ihn selbst aus der Ferne flashen k√∂nnen. <br><br><img src="https://habrastorage.org/webt/y-/57/pt/y-57pte4rudizc-oitiqraysx7m.png" alt="Bild"><br><br>  Das hei√üt, der Wagen f√§hrt irgendwo weit (aber innerhalb Ihres WI-FI-Netzwerks) (ja, ich schreibe dieses Wort gerne), sendet Daten und empf√§ngt Befehle und kann bei Bedarf auf Bestellung auch das Programm im AVR-Mikrocontroller √§ndern.  Dementsprechend wurde das Programm auf JAVA f√ºr den PC gestartet, mit dem Sie die Kontrolle genie√üen und primitive Telemetrie in Form der zur√ºckgelegten Strecke (Reedschalter und Magnet am Rad) erhalten konnten. <br><br><img src="https://habrastorage.org/webt/yf/r_/nk/yfr_nk3y69gts4z4x4ubodhd7cy.png" alt="Bild"><br><br>  Au√üerdem habe ich im n√§chsten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel erfolgreich</a> mit der Steuerung des Wagens mithilfe eines Smartphones experimentiert - Tasten, Neigungen und sogar Sprache.  Aber als der Wagen in den n√§chsten Raum fuhr, konnte selbst die Stimme ihn nicht zur√ºckgeben (im Gegensatz zur Katze).  Sie ging dorthin, klopfte an W√§nde und M√∂bel, verfing sich in Dr√§hten, schickte aber au√üer Informationen √ºber die zur√ºckgelegte Strecke nichts. <br><br>  Daher entstand sofort die Idee, den zuk√ºnftigen Terminator mit Sinnesorganen auszustatten.  Eine der einfachsten M√∂glichkeiten hierf√ºr ist die Verwendung von Sonar. <br><br><img src="https://habrastorage.org/webt/yj/qh/eg/yjqhegrrkudwtrwdx5nr_ppkywo.png" alt="Bild"><br><br>  Der Algorithmus der Arbeit zur Schande ist einfach, wir starten den Sensor von einer Front und gleichzeitig von einem Mikrocontroller-Z√§hler.  HC-SR04 beginnt Ultraschall in die Ferne zu schie√üen.  Das Antwortsignal vom Sensor √ºber ein anderes Kabel signalisiert das Ende der Entfernungsmessung, und das Zeitintervall zwischen dem Start und der Antwort ist proportional zur gemessenen Entfernung.  Dementsprechend verlangsamen wir in diesem Moment die Theke und sehen, wie viel darin enthalten ist. <br><br>  Die Genauigkeit wird bis zu etwa einem Zentimeter und eine Reichweite von bis zu zwei Metern erreicht.  Er mag keine flauschigen und Wolloberfl√§chen (zum Beispiel eine Katze), auf denen Echosignale unwiderruflich ertrinken. <br><br>  <s>In dem betroffenen Bereich ist der</s> Betrachtungswinkel des HC-SR04 klein. Um zu wissen, was im Rahmen eines Winkels von mindestens 90 Grad vor sich geht, ist Folgendes w√ºnschenswert: <br><br><ol><li>  Schrauben Sie den Sensor an die Servomaschine und schauen Sie in verschiedene Richtungen </li><li>  Setzen Sie einige Sensoren. </li></ol><br>  Zuerst implementierte ich die erste Option, indem ich das Sonar auf ein billiges Servo SG90 stellte und der Wagen in einen Rover verwandelte.  Es war so viel Zeit erforderlich, um mindestens drei Messungen durchzuf√ºhren, dass der Wagen im Grunde genommen mit einem Servo rotierte, sich dann vorsichtig vorw√§rts bewegte, aber nicht sehr weit (und pl√∂tzlich erschien ein Hindernis an der Seite) und wieder den Raum vor sich sp√ºrte.  Trotzdem ist der Ton nicht das Licht f√ºr dich. <br><br>  Deshalb habe ich ohne weiteres drei Sonarsysteme gleichzeitig darauf gesetzt.  Der Karren bekam das Aussehen einer chthonischen Spinne, blieb vor Hindernissen stumpf stehen und rollte sie unterwegs.  Aber das Gehirn am Ende war gerade genug, um nicht in einer freundlichen Umgebung h√§ngen zu bleiben.  Wir mussten weitermachen - zu Autonomie und Fortschritt.  Und hier, ohne andere Sinne, wird Ihnen sogar der Nematodenwurm sagen, dass Sie es nicht tun k√∂nnen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yjUsvUk880o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Dar√ºber hinaus beginnen Enthusiasten normalerweise, verschiedene neue Sensoren wie Gyroskope, Beschleunigungsmesser, Magnetometer und sogar FEUER-Sensoren (all diese namenlosen Chinesen produzieren in Millionen Mengen f√ºr Arduino) an ihren Kreationen zu formen.  Und auch ich h√§tte beinahe diesen rutschigen Weg eingeschlagen, aber meine Meinung rechtzeitig ge√§ndert.  Und ich habe es aus diesem Grund getan.  In der weitesten Perspektive sollte der Roboterroboter eine Vision in Form einer Kamera erhalten und auch verstehen, was er sieht.  Der AVR-Mikrocontroller vom Arduino-Board verabschiedet sich jedoch bereits beim Empfang des Videos von Ihnen, ganz zu schweigen von der Verarbeitung.  Und pl√∂tzlich fiel mein Blick auf das √§ltere GALAXY S7-Smartphone, das bereits vom Leben geschlagen war. <br><br>  Solche Rechenleistung, acht Kerne, 4 Gigabyte Speicher, zwei Kameras, Zugang zum Netzwerk, was braucht man noch, um aus einem Affen eine Person zu machen? <br><br>  Wir brauchen aber nur ein kleines Design, damit unser Smartphone auf einem Wagen ruht und es einfach platziert und entfernt werden kann. <br><br><img src="https://habrastorage.org/webt/l6/ej/gf/l6ejgf5jxwlzkqs21pifxg-wtl8.jpeg" alt="Bild"><br><br>  Dann bin ich auf die Android-Entwicklerseite geklettert, um herauszufinden, welche anderen Funktionen ein normales Smartphone uns bieten kann.  Es stellte sich heraus, dass nicht klein.  Theoretisch kannst du <br><br><div class="spoiler">  <b class="spoiler_title">Greifen Sie auf die folgenden Sensorsensoren zu.</b> <div class="spoiler_text">  TYPE_ACCELEROMETER <br><br>  TYPE_AMBIENT_TEMPERATURE <br><br>  TYPE_GAME_ROTATION_VECTOR <br><br>  GEOMAGNETIC_ROTATION_VECTOR <br><br>  TYPE_GRAVITY <br><br>  TYPE_GYROSCOPE <br><br>  TYPE_GYROSCOPE_UNCALIBRATED <br><br>  TYPE_HEART_BEAT <br><br>  TYPE_HEART_RATE <br><br>  TYPE_LIGHT <br><br>  TYPE_LINEAR_ACCELERATION <br><br>  TYPE_LOW_LATENCY_OFFBODY_DETECT <br><br>  TYPE_MAGNETIC_FIELD <br><br>  TYPE_MAGNETIC_FIELD_UNCALIBRATED <br><br>  TYPE_MOTION_DETECT <br><br>  TYPE_ORIENTATION <br><br>  TYPE_POSE_6DOF <br><br>  TYPE_PRESSURE <br><br>  TYPE_PROXIMITY <br><br>  TYPE_RELATIVE_HUMIDITY <br><br>  TYPE_ROTATION_VECTOR <br><br>  TYPE_SIGNIFICANT_MOTION <br><br>  TYPE_STATIONARY_DETECT <br><br>  TYPE_STEP_COUNTER <br><br>  TYPE_STEP_DETECTOR <br><br></div></div><br>  Wie sie sagen, was gibt es nur!  Und tats√§chlich gab es nicht viel, was f√ºr die GALAXY S7 spezifisch war.  Zum Beispiel ein Feuchtigkeitssensor.  Und die Umgebungstemperatur (obwohl ich verstanden habe, dass sich im Inneren des Geh√§uses die Temperatur des Smartphones selbst anzeigt).  Aber die Druck- und Lichtsensoren waren vorhanden.  Ganz zu schweigen von den Gyroskopen und Beschleunigungsmessern, mit denen Sie Ihre Position im Weltraum leicht bestimmen k√∂nnen. <br><br>  Infolgedessen ist eine Entscheidung ausgereift. Lassen Sie das Smartphone alle Informationen der obersten Ebene empfangen und verarbeiten - Video und all diese verschiedenen Sensoren.  Und die Arduino-Plattform wird sozusagen f√ºr das Unbewusste verantwortlich sein - f√ºr alles, was bereits funktioniert und keine Nacharbeit erfordert, all diese Motoren, Sonare, Reed-Schalter und so weiter. <br><br>  Da es selbst mit UDB schwierig ist, das Programm direkt auf dem Smartphone zu debuggen, habe ich beschlossen, das Ganze auf einen normalen PC zu √ºbertragen und dort zu verarbeiten.  Und dann, wenn es eine funktionierende Version geben wird, werden wir das Gehirn wieder in den Wagen zur√ºckbringen.  Wir m√ºssen klein anfangen, und in der Tat ist es interessant, die √úbertragung von Videos von einem hektischen Wagen zu betrachten. <br><br>  Daten von Sensoren k√∂nnen in einer einfachen Zeile √ºber einen primitiven Client-Server gesendet werden, es gibt √ºberhaupt keine Probleme damit.  Aber mit der √úbertragung des Videos gab es sofort Schwierigkeiten.  Im Allgemeinen ben√∂tigte ich eine Echtzeit-Streaming-√úbertragung von der Smartphone-Kamera zum Anwendungsfenster auf dem Computer.  Das ist f√ºr jetzt.  In Zukunft k√∂nnten nicht nur ich, sondern auch eine Art Mustererkennungssystem auf dieses Bild im Fenster starren.  Zum Beispiel JAVA OpenCV.  Oder vielleicht sogar ein neuronales Netzwerk aus der Cloud: D.  Ich wei√ü nicht, diese Etappe ist noch sehr weit weg.  Aber ich m√∂chte die Welt mit dem ‚ÄûAuge‚Äú eines Roboter-Trucks sehen. <br><br>  Jeder kennt zahlreiche Anwendungen wie eine "mobile Kamera" aus dem Google Store, bei der Sie einen Videostream von der Kamera eines Smartphones abrufen, indem Sie einen Browser mit der gew√ºnschten IP auf dem Computer √∂ffnen.  Daher dachte ich zuerst, dass es nicht schwierig sein w√ºrde, von meinem GALAXY selbst zu √ºbersetzen (was kein schwacher Fehler war), also m√ºssen Sie zuerst √ºberpr√ºfen, wie es mit seinem Empfang auf dem Computer sein wird, da ich irgendwie nur auf JAVA schreiben kann. <br><br>  Wie sich herausstellte, mit JAVA-Videowiedergabe, gelinde gesagt, nicht sehr gut.  Es war einmal im Jahr 1997, als das sogenannte Java Media Framework ver√∂ffentlicht wurde - eine Bibliothek, die die Entwicklung von Programmen erleichtert, die mit Audio und Video von den Entwicklern von JAVA selbst arbeiten.  Aber irgendwann nach 2003 wurde ein gro√üer Bolzen draufgesetzt und seitdem sind es bereits 15 Jahre.  Nach einigen Experimenten gelang es mir, eine Datei im Fenster auszuf√ºhren. Ich kann mich nicht erinnern, welche bereits (es scheint AVI zu sein), aber dieser Anblick sah ziemlich miserabel aus.  Dateien mit anderen Erweiterungen wollten √ºberhaupt nicht ausgef√ºhrt werden, im Extremfall gab es eine Audiospur. <br><br>  Im Internet habe ich zwei weitere alternative Projekte f√ºr die Arbeit mit Videos gefunden: Xuggler und aprica VLCj.  Das erste Projekt war attraktiv in seinen F√§higkeiten, starb aber auch vor langer Zeit, aber das zweite erwies sich als ziemlich lebhaft und interessant in seiner Idee.  Die Jungs nahmen JAVA, den bekannten beliebten VLC-Mediaplayer, und befestigten ihn.  Das hei√üt, aprica verwendet keine selbstgeschriebenen Codecs, sondern vorgefertigte Codecs.  Damit verlieren Sie jede Datei.  Eine kluge Entscheidung, aber Hauptsache, Sie haben diesen VLC-Player bereits auf Ihrem Computer installiert.  Nun, wer hat es nicht?  Die einzige Einschr√§nkung ist jedoch, dass Sie die gleichen Bittiefen von Player und JAVA haben.  Zum Beispiel stellte ich sp√§ter mit √úberraschung fest, dass ich im Gegensatz zu 64-Bit-JAVA immer noch einen 32-Bit-VLC auf meinem Computer hatte.  Und ein halber Lebenstag war vergebens verloren. <br><br>  Caprica-Entwickler versprechen den Nutzern auf ihrer Website viel.  Und alle Dateiformate und Starten in mehreren Fenstern in einer JAVA-Anwendung, Abspielen von Videos von You-Tube, Aufnehmen eines "Live" -Videostreams usw.  Aber die harte Realit√§t hat alles an seinen Platz gebracht.  Nein, sie haben nicht mit Dateien get√§uscht - alles wird abgespielt.  Aber jetzt will das Video von YouTube nicht mehr.  Zuerst konnte ich nicht verstehen warum, aber dann sah ich eine Inschrift im Protokoll, dass es irgendwie unm√∂glich war, irgendwo ein bestimmtes Lua-Skript auszuf√ºhren, und erinnerte mich sofort daran: <br><blockquote>  Dieses "Screen-Scraping" der YouTube-Webseite ist spr√∂de. Wenn YouTube die Struktur seiner Webseiten √§ndert, kann VLC die Streaming-URL manchmal nicht finden. In diesem Fall m√ºssen Sie warten, bis ein Entwickler eine neue LUA bereitstellt Skript und warten Sie, bis eine neue Version von VLC ver√∂ffentlicht wird. </blockquote>  Kurz gesagt, anscheinend hat YouTube die Struktur seiner Webseite ge√§ndert und ich muss auf eine neue Version warten.  Auf der anderen Seite ben√∂tige ich eine "Live" -Videosendung und spiele keine Datei von der Site ab.  Das hei√üt, selbst wenn das Lua-Skript funktionieren w√ºrde, w√ºrde es mir nicht viel helfen. <br><br>  Aber ich habe das versprochene Streaming √ºberhaupt nicht gefunden, obwohl geschrieben stand: <br><br><blockquote>  Netzwerk-Streaming-Server (z. B. ein Netzwerkradiosender oder ein Video-on-Demand-Server); <br>  Netzwerk-Streaming-Client; </blockquote>  Vielleicht ist es eine Wunschliste, oder vielleicht ist es in der kommerziellen Version, es ist schwer zu sagen. <br><br>  Aber die Dateien werden ohne Beschwerden abgespielt, wiederhole ich.  Zum Beispiel k√∂nnen Sie erstellen, hier ist eine solche Unanst√§ndigkeit <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/6yH53kRyHXk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Die Installation des Pakets selbst ist nicht schwierig und wird beispielsweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> sogar ausf√ºhrlich beschrieben.  Zwar habe ich irgendwie ungeschickt Umgebungsvariablen vorgeschrieben, und jetzt startet mein VLC zum ersten Mal mit einer Verz√∂gerung von zehn Sekunden, speichert dann aber das, was im Cache ben√∂tigt wird, und startet sp√§ter in der aktuellen Sitzung ohne Pausen. <br><br>  Anschlie√üend schreiben Sie in Ihrem JAVA-Projekt die erforderlichen Abh√§ngigkeiten vor und k√∂nnen <s>Media Player in JAVA-Fenstern</s> f√ºr die Arbeit verwenden. <br><br>  Nachdem ich den ungef√§hren Arbeitsplan auf der Seite des PCs markiert hatte, kehrte ich zur Quelle der Videodaten zur√ºck, meinem ANDROID-Smartphone. <br><br>  Aber hier hatte ich eine weitere ziemlich gro√üe Entt√§uschung erwartet.  Nachdem ich einige Websites und sogar das Online-ANDROID-Handbuch gescannt hatte, stellte ich fest, dass es unm√∂glich ist, Streaming in Echtzeit mit regul√§ren Mitteln zu organisieren.  Wie in Caprica k√∂nnen Sie nur bereits aufgezeichnete Dateien lesen.  Das hei√üt, die Kamera ist eingeschaltet, MEDIA RECORDER hat mit der Aufnahme begonnen, als sie gestoppt werden musste.  Und wir k√∂nnen erst nach einem Stopp auf Daten (und deren √úbertragung) zugreifen. <br><br>  Ich fand eine Best√§tigung meiner Schlussfolgerungen in einem alten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> .  Es gab wirklich Hinweise darauf, dass es jemandem gelungen ist, Android zu t√§uschen, dass es in eine Datei schreibt, aber tats√§chlich haben sie einen Puffer verschoben.  Aber auf jeden Fall konnte ich, wie bereits zuvor erl√§utert, einen solchen Videostream auf der PC-Seite in der JAVA-Anwendung nicht abfangen. <br><br>  Daher wurde eine einfache, <u>vor√ºbergehende</u> Entscheidung (ich m√∂chte betonen) getroffen, einen Videostream von der Kamera in Teilen f√ºr zwei Sekunden zu senden.  Nat√ºrlich kein Rover, aber der Rover ist schon ziemlich gut. <br><br>  Nachdem ich mich f√ºr diese Entscheidung entschieden hatte, begann ich, die Klassen CAMERA und MEDIA RECORDER zu beherrschen.  Es gibt im Netzwerk einige Codebeispiele zum Starten der Kamera und zum Aufzeichnen von Videodateien, aber aus irgendeinem Grund hat keines von ihnen f√ºr mich funktioniert.  Weder auf dem Emulator noch auf einem realen Ger√§t.  Es stellte sich heraus, dass der Grund in Berechtigungen liegt, dh in Berechtigungen.  Es stellt sich heraus, dass Codebeispiele in jenen Tagen geschrieben wurden, als Android noch frei war und der Programmierer tun konnte, was er wollte, wenn er alle erforderlichen Berechtigungen in das Manifest schrieb.  Aber meine aktuelle Version von OC hat dies nicht zugelassen.  Zuerst mussten Sie dem Benutzer die Erlaubnis geben, die Datei zu schreiben und die Kamera sofort nach dem Start der Anwendung einzuschalten.  Dies kostete mich zus√§tzliche Aktivit√§t, dh Aktivit√§t. <br><br><div class="spoiler">  <b class="spoiler_title">Klasse MainActivity.java</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.Manifest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.pm.PackageManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Camera; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaRecorder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.AsyncTask; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v4.app.ActivityCompat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v4.content.ContextCompat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ Camera camera; MediaRecorder mediaRecorder; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MainActivity m; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> Camera_granted; File videoFile; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ContextCompat.checkSelfPermission(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) ||(ContextCompat.checkSelfPermission(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) ) <span class="hljs-comment"><span class="hljs-comment">//ask for authorisation { ActivityCompat.requestPermissions(MainActivity.this, new String[]{Manifest.permission.CAMERA,Manifest.permission.WRITE_EXTERNAL_STORAGE}, 50); } if ((ContextCompat.checkSelfPermission(MainActivity.this, Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED)&amp; (ContextCompat.checkSelfPermission(MainActivity.this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED)) { Toast.makeText(MainActivity.this,"", Toast.LENGTH_SHORT).show();} m=this; MyTask mt = new MyTask(); mt.execute(); } } class MyTask extends AsyncTask&lt;Void, Void, Void&gt; { @Override protected void onPreExecute() { super.onPreExecute(); } @Override protected Void doInBackground(Void... params) { boolean ready = false; while(!ready) { if ((ContextCompat.checkSelfPermission(MainActivity.m, Manifest.permission.CAMERA) == PackageManager.PERMISSION_GRANTED)&amp; (ContextCompat.checkSelfPermission(MainActivity.m, Manifest.permission.WRITE_EXTERNAL_STORAGE) == PackageManager.PERMISSION_GRANTED)) { System.out.println(" "); ready=true; } } return null; } @Override protected void onPostExecute(Void result) { Toast.makeText(MainActivity.m,"", Toast.LENGTH_SHORT).show(); Intent intent=new Intent(MainActivity.m,CameraActivity.class); //   : MainActivity.m.startActivity(intent); } }</span></span></code> </pre> <br></div></div><br>  Danach lief alles reibungslos und der folgende Arbeitscode erschien.  Die zweite Aktivit√§t der Camera_Activity-Klasse ist f√ºr die Arbeit mit der Kamera und die Aufzeichnung von Videodateien verantwortlich.  Http_server-Klasse f√ºr die Weiterleitung (der Name ist nat√ºrlich falsch, hat sich aber historisch herausgestellt).  Der Code ist einfach, wo immer es eine Erkl√§rung gibt. <br><br><img src="https://habrastorage.org/webt/dv/-z/l1/dv-zl1u_fxzjus5hcacejbzhudc.png"><br><br>  Alles liegt komplett auf dem Github.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> <br><br><div class="spoiler">  <b class="spoiler_title">Camera_Activity</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Camera; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaRecorder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.AsyncTask; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Environment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.annotation.Nullable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.SurfaceHolder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.SurfaceView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.ServerSocket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.SensorEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.SensorEventListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.SensorManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Sensor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> android.hardware.Camera.getNumberOfCameras; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.OutputStreamWriter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.PrintWriter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.Socket; <span class="hljs-comment"><span class="hljs-comment">/** * Created by m on 01.02.2019. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CameraActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SensorEventListener</span></span></span><span class="hljs-class"> </span></span>{ SurfaceView surfaceView; TextView mTextView; Button mStart; Button mStop; Camera camera; MediaRecorder mediaRecorder; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ServerSocket ss; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ServerSocket ss2; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MainActivity m; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> stopCamera=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> File videoFile1; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> File videoFile2; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> File videoFile3; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SensorManager mSensorManager; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sensor mAxeleration, mLight,mRotation,mHumidity,mPressure,mTemperature; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ax; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ay; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> az; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> light; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> z; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> hum; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> press; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> tempr; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String Sensors; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Nullable Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE); <span class="hljs-comment"><span class="hljs-comment">//    mAxeleration = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER); //    mSensorManager.registerListener(this, mAxeleration, SensorManager.SENSOR_DELAY_NORMAL); mLight = mSensorManager.getDefaultSensor(Sensor.TYPE_LIGHT); mSensorManager.registerListener(this, mLight, SensorManager.SENSOR_DELAY_NORMAL); mRotation = mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION); mSensorManager.registerListener(this, mRotation, SensorManager.SENSOR_DELAY_NORMAL); mHumidity = mSensorManager.getDefaultSensor(Sensor.TYPE_LINEAR_ACCELERATION); mSensorManager.registerListener(this, mHumidity, SensorManager.SENSOR_DELAY_NORMAL); mPressure = mSensorManager.getDefaultSensor(Sensor.TYPE_PRESSURE); mSensorManager.registerListener(this, mPressure, SensorManager.SENSOR_DELAY_NORMAL); mTemperature = mSensorManager.getDefaultSensor(Sensor.TYPE_AMBIENT_TEMPERATURE); mSensorManager.registerListener(this, mTemperature, SensorManager.SENSOR_DELAY_NORMAL); setContentView(R.layout.camera); // videoFile = new File(Environment.getExternalStorageDirectory() + File.separator+ Environment.DIRECTORY_DCIM + File.separator + "test.3gp"); videoFile1 = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), "test1.3gp"); videoFile2 = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), "test2.3gp"); videoFile3 = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), "test3.3gp"); // videoFile4 = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), "testOUT.3gp"); // File file = new File(Environment.getExternalStorageDirectory(),VIDEO_PATH_NAME);//   // "touch" the file try { videoFile1.createNewFile(); videoFile2.createNewFile(); videoFile3.createNewFile(); } catch (IOException e) { } mStart = (Button) findViewById(R.id.btnStartRecord); mStop = (Button) findViewById(R.id.btnStopRecord); surfaceView = (SurfaceView) findViewById(R.id.surfaceView); mTextView = (TextView) findViewById(R.id.textView); SurfaceHolder holder = surfaceView.getHolder(); holder.addCallback(new SurfaceHolder.Callback() { @Override public void surfaceCreated(SurfaceHolder holder) { try { camera.setPreviewDisplay(holder); camera.startPreview(); } catch (Exception e) { e.printStackTrace(); } } @Override public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) { } @Override public void surfaceDestroyed(SurfaceHolder holder) { } }); mStart.setOnClickListener(new View.OnClickListener() { public void onClick(View v){ System.out.println("  "); //    WriteVideo WV = new WriteVideo(); WV.start(); mStart.setClickable(false); mStop.setClickable(true); Http_server.File_is_sent=true; new ServerCreation().execute();//      } } ); mStop.setOnClickListener(new View.OnClickListener() { public void onClick(View v){ stopCamera = false; // mTextView.setText(" "); releaseMediaRecorder(); releaseCamera(); mStart.setClickable(true); mStop.setClickable(false); System.out.println("  "); Http_server.File_is_sent=true; } } ); } @Override public void onAccuracyChanged(Sensor sensor, int accuracy) { //    } @Override public void onSensorChanged(SensorEvent event) { //   switch (event.sensor.getType()) { case Sensor.TYPE_ACCELEROMETER: ax = (int)(event.values[0] * 9); // + -  az = (int)(event.values[2] * 9);//  +  -  // System.out.println(" = "+ ax + "  = " + az); break; case Sensor.TYPE_LIGHT: light = event.values[0]; // System.out.println(" = "+ light); break; case Sensor.TYPE_ORIENTATION: x = (int)event.values[0]; y = (int)event.values[1]+90; //  +  -  z = (int)event.values[2]; // + -  // System.out.println("x = "+ x + " y = " + y+ " z= "+ z); break; case Sensor.TYPE_LINEAR_ACCELERATION: hum = event.values[2]; int k = (int)(hum*100); hum = - (double)k;//   ,    /2 // System.out.println(hum); break; case Sensor.TYPE_PRESSURE: press = event.values[0]*760/10.1325; int i = (int) press; press = (double)i/100; // System.out.println(press); break; case Sensor.TYPE_AMBIENT_TEMPERATURE: tempr = event.values[0]; System.out.println(tempr); break; } Sensors = " tangaz_1 "+ az+ " kren_1 " + ax + " tangaz_2 "+ y + " kren_2 " + z + " forvard_accel "+ hum + " light " + light+ " "; // System.out.println(Sensors); } @Override protected void onResume() { super.onResume(); releaseCamera(); releaseMediaRecorder(); int t = getNumberOfCameras(); mTextView.setText(""+t); if(camera == null) { camera = Camera.open(); // camera.unlock(); } else{ } } @Override protected void onPause() { super.onPause(); } @Override protected void onStop() { super.onStop(); releaseCamera(); releaseMediaRecorder(); } private boolean prepareVideoRecorder() { if (mediaRecorder==null) {mediaRecorder = new MediaRecorder();} camera.unlock(); mediaRecorder.setCamera(camera); mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA); switch (count) { case 1: mediaRecorder.setOutputFile(videoFile1.getAbsolutePath()); break; case 2: mediaRecorder.setOutputFile(videoFile2.getAbsolutePath()); break; case 3: mediaRecorder.setOutputFile(videoFile3.getAbsolutePath()); break; } mediaRecorder.setPreviewDisplay(surfaceView.getHolder().getSurface()); mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP); //mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4); mediaRecorder.setVideoSize(640,480); mediaRecorder.setOrientationHint(90);//    ,     mediaRecorder.setVideoFrameRate(30); mediaRecorder.setVideoEncoder(1); try { mediaRecorder.prepare(); } catch (Exception e) { e.printStackTrace(); releaseMediaRecorder(); return false; } return true; } private void releaseMediaRecorder() { if (mediaRecorder != null) { mediaRecorder.release(); mediaRecorder = null; if (camera != null) { // camera.lock();//         } } } public void releaseCamera() { if (camera != null) { // camera.setPreviewCallback(null); // SurfaceView.getHolder().removeCallback(SurfaceView); camera.release(); camera = null; } } private class WriteVideo extends Thread{ public void run () { stopCamera=true; do{ // releaseMediaRecorder(); // releaseCamera(); if(camera == null) { camera = Camera.open(Camera.CameraInfo.CAMERA_FACING_BACK); } System.out.println(""); if (prepareVideoRecorder()) { mediaRecorder.start(); } else { releaseMediaRecorder(); } try { Thread.sleep(2000);//     } catch (Exception e) { } count++; if(count==3){count=1;}// 4 if (mediaRecorder != null) { releaseMediaRecorder(); } System.out.println(""); File f=null; switch (count) { case 1: f = videoFile2;// 3 break; case 2: f = videoFile1;//1 break; case 3: f = videoFile2; break; } try { BufferedInputStream bis = new BufferedInputStream(new FileInputStream(f)); data = new byte[bis.available()]; bis.read(data); bis.close(); }catch (Exception e) { System.out.println(e); } if(Http_server.File_is_sent)//       { System.out.println("  "); new HTTP_Server_Calling().execute(); Http_server.File_is_sent=false; } } while(stopCamera); if (mediaRecorder != null) { System.out.println(""); } } } } class ServerCreation extends AsyncTask&lt;Void, Void, Void&gt; { @Override protected void onPreExecute() { super.onPreExecute(); } @Override protected Void doInBackground(Void... params) { try { CameraActivity.ss = new ServerSocket(40001);//      System.out.println("  "); new Http_server(CameraActivity.ss.accept()); CameraActivity.ss2 = new ServerSocket(40002);//      }catch (Exception e) { System.out.println(e); System.out.println("   "); } new HTTP_Server_Calling2().start(); return null; } @Override protected void onPostExecute(Void result) { } } class HTTP_Server_Calling extends AsyncTask&lt;Void, Void, Void&gt; { @Override protected void onPreExecute() { super.onPreExecute(); } @Override protected Void doInBackground(Void... params) { try { new Http_server(CameraActivity.ss.accept()); } catch (Exception e) { System.out.println(e); } return null; } @Override protected void onPostExecute(Void result) { } } class HTTP_Server_Calling2 extends Thread//           { public void run() { while (CameraActivity.stopCamera) { try { Thread.sleep(500);//      new Http_server_Sensors(CameraActivity.ss2.accept()); } catch (Exception e) { System.out.println(e); } } } } class Http_server extends Thread { public Socket socket; public static volatile boolean File_is_sent=true; Http_server(Socket s) { System.out.println("  "); socket = s; setPriority(MAX_PRIORITY); start(); } public void run() { try { System.out.println("    "); BufferedOutputStream bos = new BufferedOutputStream((socket.getOutputStream())); bos.write(CameraActivity.data); bos.flush(); bos.close(); socket.close(); } catch (Exception e) { System.out.println(e); } File_is_sent = true; } } public class Http_server_Sensors extends Thread { public Socket socket; PrintWriter pw; Http_server_Sensors(Socket s) { socket = s; setPriority(MAX_PRIORITY); start(); } public void run() { try { pw = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()), true);//    System.out.println(CameraActivity.Sensors); pw.println(CameraActivity.Sensors);//  pw.flush(); pw.close(); socket.close(); } catch (Exception e) { System.out.println(e); } } }</span></span></code> </pre><br></div></div><br><br>  Das Wesentliche des Programms nach dem Starten und Einschalten der Kamera ist wie folgt: <br>  schreibe ein Video f√ºr zwei Sekunden in die erste Datei, <br>  Wir schreiben das Video zwei Sekunden lang in die zweite Datei und senden in der Zwischenzeit die erste Datei √ºber TCP-IP √ºber das lokale WIFI an den Computer <br>  Schreiben Sie die erste Datei erneut und senden Sie in der Zwischenzeit die zweite. <br>  usw. <br><br>  Anschlie√üend wird der Zyklus wiederholt, bis die Stopp-Taste gedr√ºckt wird oder der Akku des Smartphones leer ist.  Grunds√§tzlich ist es m√∂glich, ein Analogon des Dr√ºckens von Tasten mit Befehlen von einem Computer auch √ºber TCP zu implementieren, dies ist nicht schwierig. <br><br>  Zuerst bestand der Videopuffer f√ºr alle F√§lle aus drei Dateien im 3GP-Format (wir schreiben die erste, senden die dritte, wir schreiben die zweite, wir senden die erste, wir schreiben die dritte, wir senden die zweite), aber dann stellte sich heraus, dass die beiden Dateien v√∂llig ausreichend sind (Aufzeichnen und Senden nicht st√∂ren). <br><br>  Mit einer Kameraaufl√∂sung von 640 x 480 werden die Dateien irgendwo zwischen 200 und 300 kB erhalten, was f√ºr meinen Router ziemlich schwierig ist.  Ich habe mich noch nicht um den Sound gek√ºmmert, aber dort scheint alles einfach zu sein: Sie installieren die erforderlichen Audio-Encoder, Bitraten, die Anzahl der Kan√§le und dergleichen. <br><br>  Wenig sp√§ter, als ich die Video√ºbertragung debuggte, erg√§nzte ich den Code auch durch die √úbertragung von Informationen von den Sensoren des Smartphones.  Alles wird trivial in einer Zeile √ºbertragen, aber ich konnte es nicht √ºber dieselbe Buchse wie das Video √ºbertragen.  Anscheinend verwenden die Klassen zum √úbertragen einer PrintWriter-Zeichenfolge und zum √úbertragen von Bin√§rdaten BufferedOutputStream unterschiedliche Streams, aber dann haben sie einen Ausgabepuffer, in dem sie sich erfolgreich gegenseitig beschei√üen.  Infolgedessen beginnt das Video zu st√∂ren und zu br√∂ckeln.  Au√üerdem wird die Videodatei alle zwei Sekunden √ºbertragen, und f√ºr Sensoren ist dieses Intervall zu gro√ü.  Daher wurde beschlossen, sie in verschiedenen Sockeln zu verteilen, damit sie sich nicht gegenseitig st√∂ren.  Aus diesem Grund wurde eine neue Klasse Http_server_Sensors angezeigt. <br><br>  Also haben wir den Versand organisiert, jetzt kehren wir wieder zur dunklen Empfangsseite zur√ºck. <br><br>  Wie wir bereits im ersten Beispiel gesehen haben, ist das Abspielen von Videodateien in einer JAVA-Anwendung mit einem VLC-Player jetzt kein Problem mehr.  Die Hauptsache ist, diese Dateien zu bekommen. <br><br>  Das folgende Demo-Programm ist daf√ºr verantwortlich. <br><br><div class="spoiler">  <b class="spoiler_title">Videoplayer</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.BorderLayout; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.ActionEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.ActionListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.WindowAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.WindowEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JButton; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JFrame; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JOptionPane; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.JPanel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.swing.SwingUtilities; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.component.EmbeddedMediaPlayerComponent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.discovery.NativeDiscovery; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.MediaPlayer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uk.co.caprica.vlcj.player.MediaPlayerEventAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.Socket; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VideoPlayer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JFrame frame; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> EmbeddedMediaPlayerComponent mediaPlayerComponent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JButton pauseButton; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JButton rewindButton; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JButton skipButton; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String mr1, mr2; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> playing_finished = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> File_1_play_starting = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> File_1_play_finished = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> File_2_play_starting = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> File_2_play_finished = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//192.168.1.128 public static void main(final String[] args) { new NativeDiscovery().discover(); mr1 = "D:\\test1.3gp"; mr2 = "D:\\test2.3gp"; SwingUtilities.invokeLater(new Runnable() { @Override public void run() { VideoPlayer vp = new VideoPlayer(); vp.mediaPlayerComponent.getMediaPlayer().setPlaySubItems(true); VideoPlayer.playing_finished=false; new Control().start();//   // while (!Http_client.File_ready) { // System.out.println(""); try { Thread.sleep(100); } catch (Exception e) { } } // while (true) { playing_finished = false; } // System.out.println("  1"); } }); } public VideoPlayer() { frame = new JFrame("My First Media Player"); frame.setBounds(100, 100, 600, 400); frame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE); frame.addWindowListener(new WindowAdapter() { @Override public void windowClosing(WindowEvent e) { System.out.println(e); mediaPlayerComponent.release(); System.exit(0); } }); JPanel contentPane = new JPanel(); contentPane.setLayout(new BorderLayout()); mediaPlayerComponent = new EmbeddedMediaPlayerComponent(); contentPane.add(mediaPlayerComponent, BorderLayout.CENTER); frame.setContentPane(contentPane); JPanel controlsPane = new JPanel(); pauseButton = new JButton("Pause"); controlsPane.add(pauseButton); rewindButton = new JButton("Rewind"); controlsPane.add(rewindButton); skipButton = new JButton("Skip"); controlsPane.add(skipButton); contentPane.add(controlsPane, BorderLayout.SOUTH); pauseButton.addActionListener(new ActionListener() { @Override public void actionPerformed(ActionEvent e) { mediaPlayerComponent.getMediaPlayer().pause(); } }); rewindButton.addActionListener(new ActionListener() { @Override public void actionPerformed(ActionEvent e) { mediaPlayerComponent.getMediaPlayer().skip(-10000); } }); skipButton.addActionListener(new ActionListener() { @Override public void actionPerformed(ActionEvent e) { mediaPlayerComponent.getMediaPlayer().skip(10000); } }); mediaPlayerComponent.getMediaPlayer().addMediaPlayerEventListener(new MediaPlayerEventAdapter() { @Override public void playing(MediaPlayer mediaPlayer) { SwingUtilities.invokeLater(new Runnable() { @Override public void run() { frame.setTitle(String.format( "My First Media Player - %s", mediaPlayerComponent.getMediaPlayer() )); } }); } @Override public void finished(MediaPlayer mediaPlayer) { SwingUtilities.invokeLater(new Runnable() { @Override public void run() { playing_finished = true; System.out.println("finished " + playing_finished); //closeWindow(); } }); } @Override public void error(MediaPlayer mediaPlayer) { SwingUtilities.invokeLater(new Runnable() { @Override public void run() { JOptionPane.showMessageDialog( frame, "Failed to play media", "Error", JOptionPane.ERROR_MESSAGE ); closeWindow(); } }); } }); frame.setVisible(true); //mediaPlayerComponent.getMediaPlayer(); } public void start(String mrl) { mediaPlayerComponent.getMediaPlayer().setPlaySubItems(true); mediaPlayerComponent.getMediaPlayer().prepareMedia(mrl); //mediaPlayerComponent.getMediaPlayer().parseMedia(); mediaPlayerComponent.getMediaPlayer().playMedia(mrl); // mediaPlayerComponent. } public void closeWindow() { frame.dispatchEvent(new WindowEvent(frame, WindowEvent.WINDOW_CLOSING)); } } class PlayFile { public static void run(int number) { if (number==1) { VideoPlayer.mediaPlayerComponent.getMediaPlayer().prepareMedia(VideoPlayer.mr1); System.out.println("  1"); VideoPlayer.mediaPlayerComponent.getMediaPlayer().start(); VideoPlayer.mediaPlayerComponent.getMediaPlayer().playMedia(VideoPlayer.mr1); VideoPlayer.File_1_play_starting = true; VideoPlayer.File_1_play_finished = false; while (!VideoPlayer.playing_finished) {//      try { Thread.sleep(1); } catch (Exception e) { } } VideoPlayer.mediaPlayerComponent.getMediaPlayer().stop(); VideoPlayer.playing_finished = false; VideoPlayer.File_1_play_starting = false; VideoPlayer.File_1_play_finished = true; } { try { Thread.sleep(10); } catch (Exception e) { } } if (number==2) { VideoPlayer.mediaPlayerComponent.getMediaPlayer().prepareMedia(VideoPlayer.mr2); System.out.println("  2"); VideoPlayer.mediaPlayerComponent.getMediaPlayer().start(); VideoPlayer.mediaPlayerComponent.getMediaPlayer().playMedia(VideoPlayer.mr2); VideoPlayer.File_2_play_starting = true; VideoPlayer.File_2_play_finished = false; while (!VideoPlayer.playing_finished) { try { Thread.sleep(1); } catch (Exception e) { } } VideoPlayer.mediaPlayerComponent.getMediaPlayer().stop(); VideoPlayer.playing_finished = false; VideoPlayer.File_2_play_starting = false; VideoPlayer.File_2_play_finished = true; } { try { Thread.sleep(10); } catch (Exception e) { } } } } public class Control extends Thread{ public static boolean P_for_play_1=false; public static boolean P_for_play_2=false; public void run() { // new Http_client(1).start(); while (!Http_client.File1_reception_complete) { try { Thread.sleep(1); } catch (Exception e) { } } while (true) { new Http_client(2).start(); PlayFile.run(1); while (!VideoPlayer.File_1_play_finished) { try { Thread.sleep(1); } catch (Exception e) { } } while (!Http_client.File2_reception_complete) { try { Thread.sleep(1); } catch (Exception e) { } } new Http_client(1).start(); PlayFile.run(2); while (!VideoPlayer.File_2_play_finished) { try { Thread.sleep(1); } catch (Exception e) { } } while (!Http_client.File1_reception_complete) { try { Thread.sleep(1); } catch (Exception e) { } } //PlayFile.run(1); } } } public class Http_client extends Thread { public static boolean File1_starts_writing=false; public static boolean File1_reception_complete=false; public static boolean File2_starts_writing=false; public static boolean File2_reception_complete=false; public int Number; public BufferedOutputStream bos; Http_client(int Number) { this.Number = Number; } public void run(){ try { Socket socket= new Socket("192.168.1.128", 40001); // System.out.println(" "); // PrintWriter pw = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()), true); // pw.println("ready");// Greetings with CLIENT // System.out.println(" "); BufferedInputStream bis = new BufferedInputStream(socket.getInputStream()); if (Number ==1) { File1_starts_writing=true; File1_reception_complete=false; System.out.println("  1,    2"); bos = new BufferedOutputStream(new FileOutputStream(VideoPlayer.mr1)); byte[] buffer = new byte[32768]; while (true) { //     int readBytesCount = bis.read(buffer); if (readBytesCount == -1) { //   break; } if (readBytesCount &gt; 0) { //    - ,   bos.write(buffer, 0, readBytesCount); } } System.out.println(" "); System.out.println(" "); bos.flush(); bos.close(); File1_starts_writing=false; File1_reception_complete=true; } if (Number==2) { File2_starts_writing=true; File2_reception_complete=false; System.out.println("  2,    1"); bos = new BufferedOutputStream(new FileOutputStream(VideoPlayer.mr2)); byte[] buffer = new byte[32768]; while (true) { //     int readBytesCount = bis.read(buffer); if (readBytesCount == -1) { //   break; } if (readBytesCount &gt; 0) { //    - ,   bos.write(buffer, 0, readBytesCount); } } System.out.println(" "); System.out.println(" "); bos.flush(); bos.close(); File2_starts_writing=false; File2_reception_complete=true; } socket.close(); // pw.close(); bis.close(); } catch(Exception e){ System.out.println(e); System.out.println("gfgfg"); } try { Thread.sleep(10); } catch (Exception e) { } } }</span></span></code> </pre></div></div><br><br>  Sein Wesen ist einfach.  Ein TCP-Client wird gestartet, der darauf wartet, dass der Server auf dem Smartphone bereit ist.  Nach Erhalt der ersten Datei wird die Wiedergabe sofort gestartet und die zweite Datei wird parallel erwartet.  Ferner wird entweder das Ende des Empfangs der zweiten Datei oder das Ende der Wiedergabe der ersten erwartet.  Das Beste ist nat√ºrlich <s>drei Sterne</s> , wenn die Datei schneller heruntergeladen als abgespielt wird.  Wenn Sie die erste Datei verloren haben, aber die zweite noch nicht erhalten haben, wartet alles ... Wir zeigen einen schwarzen Bildschirm.  Wenn nicht, starten Sie schnell die Wiedergabe der zweiten Datei und laden Sie gleichzeitig die erste erneut herunter. <br>  Ich hatte eine vage Hoffnung, dass die Pause zwischen dem Wechseln der Wiedergabedateien k√ºrzer als die Reaktionszeit des menschlichen Auges sein w√ºrde, aber sie kam nicht zustande.  Gem√ºtlich nat√ºrlich dieser VLC. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/BaY3gD6RBdU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Als Ergebnis erhalten wir eine Art abscheuliches diskontinuierliches Video (der erste Trilobit hat anscheinend die Welt so gesehen), in dem die Sch√§rfe st√§ndig angepasst wird.  Und wir m√ºssen ber√ºcksichtigen, dass das Video auch zwei Sekunden zu sp√§t ist.  Kurz gesagt, in der Produktion empfehle ich nicht, es zu verbreiten.  Aber ich habe einen Mangel an Fisch und Trilobiten, wie sie sagen ... <br><br>  Zusammenfassend k√∂nnen wir das absolut sagen: <br><br>  Das Senden von Videos in Teilen ist im Wesentlichen nicht funktionsf√§hig und kann nur dann n√ºtzlich sein, wenn das Video lang genug ist und Sie keine zweite Reaktion auf das Geschehen ben√∂tigen. <br><br>  Die Video√ºbertragung √ºber TCP-IP ist ebenfalls eine falsche Idee, was auch immer einige Pers√∂nlichkeiten auf Habr √ºber die Daten√ºbertragungsgeschwindigkeit mit diesem Protokoll sagen w√ºrden (das angeblich sogar schneller als UDP ist).  Nat√ºrlich weisen moderne drahtlose Intranets gute Eigenschaften auf, um ein kontinuierliches Handshake von TCP-Servern und -Clients zu gew√§hrleisten, und TCP selbst scheint f√ºr lange Daten aktualisiert worden zu sein, aber die Stecker zwischen dem Abspielen von Videofokussen erscheinen regelm√§√üig in der Demo. <br><br>  Aber zumindest f√ºr die Zukunft tauchten folgende Gedanken auf: <br><br><ol><li>  Frame f√ºr Frame (nicht Video, sondern Fotos) √ºber UDP senden, aber Informationen √ºber TCP steuern, </li><li>  Fahren Sie Fotorahmen √ºber UDP, jedoch mit Synchronisierungssignalen im selben Kanal. </li></ol><br>  Nat√ºrlich gibt es bisher mehr Fragen als Antworten.  Gibt es bei JAVA mit seinem Abstraktionsgrad gen√ºgend Empfangsgeschwindigkeit f√ºr die Arbeit mit dem Netzwerk und den Bildern?  Ist es m√∂glich, 30 normale Aufnahmen pro Sekunde auf dem Niveau zu machen, das mir in Android zug√§nglich ist?  Muss ich sie vor dem Senden ernten, um die Bitrate zu verringern?  Und reicht JAVA dann zum Ein- und Auspacken?  Und wenn pl√∂tzlich etwas klappt, ist es dann m√∂glich, den n√§chsten Schritt zu durchlaufen, um das JAVA OpenCV-Computer-Vision-System hier zu verschrauben?  Selbst ist es nat√ºrlich immer interessant, Streaming-Videos vom Boden aus anzusehen, aber wir sollten das h√∂chste Ziel nicht vergessen - einen Roboterroboter mit der Intelligenz einer Ameise! <br><br>  Aber w√§hrend wir das haben, was wir haben, kehren wir zum aktuellen Einkaufswagen zur√ºck.  Das alte Programm aus dem vorletzten Artikel f√ºr den AVR-Mikrocontroller auf der Arduino-Plattform hat sich nicht wesentlich ge√§ndert, nur die Wahl der Verzweigung wurde hinzugef√ºgt - autonomes Fahren oder vom Bediener gesteuert.  Die Daten, die der Wagen (R√ºckenmark) √ºber WIFI √ºbertr√§gt, sind dieselben - die zur√ºckgelegte Strecke.  Wenig sp√§ter habe ich auch die Temperatur√ºbertragung eines kritischen Elements - des Motortreibers - angebracht.  All dies wird zuerst von UART und bereits beim Eintritt in das Netzwerk √ºber UDP gesendet und empfangen.  Ich gebe nicht den Code, sondern die vollst√§ndige Analyse im vorletzten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel.</a> <br><br><img src="https://habrastorage.org/webt/zh/gb/vz/zhgbvzhttcqg7o_la1sabrmw2gy.png"><br><br>  F√ºr zwei Motoren reicht es (Fahrer) immer noch mehr oder weniger aus, aber mit vier nach einer Weile √ºberhitzt es sich zu einem funktionsunf√§higen Zustand.  Zuerst habe ich versucht, die einfachsten analogen Temperatursensoren zu verwenden, die auf Zenerdioden basieren, wie z. B. den LM335, aber es wurde nichts daraus.  Ich hatte keine Referenzspannungsquelle, kurz ION.        . ,   ‚Äî          -  14500,              ,        (       ¬´¬ª).        -   L3G4200D.  ,  ,       I2C. <br><br>  ,      - ‚Äî   ,   (       ,   ),       ,     (  ),     , .  ,  ,   ,        ,    . <br><br>  ,   JAVA   : <br><br><img src="https://habrastorage.org/webt/do/6y/oe/do6yoema_7rnzm9z38yfijhzv14.png"><br><br>  ,         ,     ,     . <br><br><img src="https://habrastorage.org/webt/hw/ql/tu/hwqltuwvxsplpvdat2pcokifzye.jpeg"><br><br>  ,        ,        ‚Äî  !   ,      ,     . ! <br><br>     . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/AaMWKKeBff8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>    ,   ,    95% .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> <br><br>   ,   (),     (    )   ,      -  (  ‚Äî          ). ,      ,       ,      . <br><br>  -  ,  .   . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de448516/">https://habr.com/ru/post/de448516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de448498/index.html">"Russland 404": Wie viel freies Internet bleibt noch zu leben</a></li>
<li><a href="../de448500/index.html">L√∂sen eines einfachen Crackme f√ºr Sega Mega Drive</a></li>
<li><a href="../de448504/index.html">Sie sammelten f√ºr alle "Habrom" das Nachschlagewerk "Von wem es ausgestellt wurde ..." f√ºr P√§sse. Auf Gesundheit herunterladen</a></li>
<li><a href="../de448506/index.html">Die Matrix ist 20 Jahre alt: Wie Wachowski Cyberpunk machte, der die Agenda f√ºr eine ganze Generation bestimmte</a></li>
<li><a href="../de448510/index.html">Acer im Jahr 2019: Was ist, wenn Sie alle Fliegen von den Gaming-Laptops entfernen?</a></li>
<li><a href="../de448518/index.html">Wie sehe ich ein Schwarzes Loch?</a></li>
<li><a href="../de448522/index.html">Konfigurationsgenerierung f√ºr Nginx, Verlauf einer Pull-Anforderung</a></li>
<li><a href="../de448524/index.html">Zum ersten Mal auf der Welt druckten israelische Wissenschaftler ein lebendiges Herz</a></li>
<li><a href="../de448528/index.html">Kostenloser Wireguard VPN Service unter AWS</a></li>
<li><a href="../de448530/index.html">Wie Megaphone auf Mobilabonnements geschlafen hat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>