<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏈 👉🏻 👃🏻 Netzwerksicherheitsdienste und Pretty-Print-Dienstprogramm 🌖 🎩 📁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Network Security Services ( NSS ) ist eine Reihe von Bibliotheken, die bei der plattformübergreifenden Entwicklung sicherer Client- und Serveranwendun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Netzwerksicherheitsdienste und Pretty-Print-Dienstprogramm</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/406037/"> Network Security Services ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NSS</a> ) ist eine Reihe von Bibliotheken, die bei der plattformübergreifenden Entwicklung sicherer Client- und Serveranwendungen verwendet werden. <br><a name="habracut"></a><br>  Das NSS-Paket bietet wie OpenSSL die Möglichkeit, Befehlszeilenprogramme zum Implementieren verschiedener PKI-Funktionen zu verwenden (Schlüsselgenerierung, Ausstellung von x509v3-Zertifikaten, Arbeiten mit elektronischen Signaturen, TLS-Unterstützung usw.).  Mit einem dieser Dienstprogramme, nämlich Pretty-Print (PP), können Sie den Inhalt des x509 v3-Zertifikats und der elektronischen Signatur (pkcs # 7) usw. bequem anzeigen.  Darüber hinaus kann das Zertifikat sowohl in DER- als auch in PEM-Codierung vorliegen: <br><br><pre><code class="bash hljs">bash-4.3$ pp -h Usage: pp [-t <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>] [-a] [-i input] [-o output] [-w] [-u] Pretty prints a file containing ASN.1 data <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> DER or ascii format. -t <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> Specify input and display <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: public-key (pk), certificate (c), certificate-request (cr), certificate-identity (ci), pkcs7 (p7), crl or name (n). (Use either the long <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> name or the shortcut.) -a Input is <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ascii encoded form (RFC1113) -i input Define an input file to use (default is stdin) -o output Define an output file to use (default is stdout) -w Don<span class="hljs-string"><span class="hljs-string">'t wrap long output lines -u Use UTF-8 (default is to show non-ascii as .) bash-4.3$</span></span></code> </pre> <br>  Darüber hinaus ermöglicht das Vorhandensein des Parameters –u (UTF-8-Codierung) das Anzeigen des Zertifikats in russischer Codierung.  Wenn Sie sich jedoch die Screenshots der GUI zu den Befehlszeilenprogrammen des NSS-Pakets genau ansehen, stellen Sie fest, dass einige der Zertifikatdaten einfach verschwunden sind: <br><br><img src="https://habrastorage.org/web/4a8/3c7/966/4a83c796606742dd8f54b40471c4068d.png" alt="Bild"><br><br>  Die Suche nach den fehlenden Informationen begann.  Das Dienstprogramm "cute print" (mit dem Pretty-print übersetzt wird) zum Anzeigen des Stammzertifikats der Hauptzertifizierungsstelle des Kommunikationsministeriums wurde über die Befehlszeile gestartet: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$pp</span></span> – certificate –u –i _.cer … Subject: <span class="hljs-string"><span class="hljs-string">"CN=   ,INN=007710474375,OGRN=1047702026701,O=    ,STREET="</span></span>125375 . , .  , . 7<span class="hljs-string"><span class="hljs-string">",L=,ST=77 . ,C=RU,E=dit@minsvya z.ru"</span></span> …. $</code> </pre> <br>  Das Ergebnis bestätigte den Datenverlust.  Darüber hinaus erschienen zwei nicht anzeigbare Symbole auf dem Bildschirm (eine seitliche Raute von schwarzer Farbe mit einem Fragezeichen? Innen).  Die Analyse ergab, dass diese nicht anzeigbaren Zeichen die Codes 0xD0 bzw. 0xBE haben: <br><br><img src="https://habrastorage.org/web/c23/ec0/031/c23ec0031a6243e6b4981e9040cd28d6.png" alt="Bild"><br><br>  Der russische Buchstabe "o" verschwand mit einer hexadezimalen Darstellung in der UTF-8-Codierung als 0xD00xBE.  Und die Codes 0xD0 und 0xBE sind unsere nicht anzeigbaren Zeichen.  Und welche Art von Zeichen erschien zwischen diesen Bytes?  Und dies ist ein „hübscher“ Druck - Ausrichtungssymbole des gedruckten Textes. <br><br>  Was ist passiert?  Die Eingabe eines "schönen" Drucks (Datei /nss/cmd/lib/secutil.c, Funktion secu_PrintRawStringQuotesOptional) empfängt Daten in Form von SECITEM, d. H.  Adressen pro Byte-Array und seine Länge: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; si-&gt;len; i++) { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> val = si-&gt;data[i]; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (SECU_GetWrapEnabled() &amp;&amp; column &gt; <span class="hljs-number"><span class="hljs-number">76</span></span>) { SECU_Newline(out); SECU_Indent(out, level); column = level * INDENT_MULT; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (utf8DisplayEnabled) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (val &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) c = <span class="hljs-string"><span class="hljs-string">'.'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> c = val; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { c = printable[val]; } <span class="hljs-built_in"><span class="hljs-built_in">fprintf</span></span>(out, <span class="hljs-string"><span class="hljs-string">"%c"</span></span>, c); column++; }</code> </pre><br>  Und wenn (SECU_GetWrapEnabled () == True) für einen schönen Druck bereitgestellt wird (das PP-Dienstprogramm hat keinen –w-Parameter) und die Anzahl der Bytes in einer Zeile 76 überschreitet (Spalte&gt; 76), dann nach dem nächsten Zeichen eine neue Zeile (SECU_Newline) und die erforderlichen Einrückungen (SECU_Indent) )  Gleichzeitig glaubte keiner der Entwickler, dass bei Verwendung der UTF-8-Codierung (utf8DisplayEnabled) die Schönheit erst nach dem nächsten Zeichen und nicht nach dem Byte induziert werden kann, da das Konzept eines Bytes und eines Zeichens in der UTF-8-Codierung möglicherweise nicht übereinstimmt .  Wenn wir über russische Buchstaben sprechen, wird jeder von ihnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in</a> zwei Bytes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">codiert</a> .  Genau diese Lücke trat bei unserem russischen Buchstaben „o“ (0xD00xBE) auf. <br><br>  Was ist der Ausweg?  In der Funktion secu_PrintRawStringQuotesOptional ist alles sehr einfach genug, um die Zeile zu ersetzen: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (SECU_GetWrapEnabled() &amp;&amp; column &gt; <span class="hljs-number"><span class="hljs-number">76</span></span>) {</code> </pre> <br>  in einer Zeile der folgenden Form: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (SECU_GetWrapEnabled() &amp;&amp; column &gt; <span class="hljs-number"><span class="hljs-number">76</span></span> &amp;&amp; (val &lt;= <span class="hljs-number"><span class="hljs-number">0x7F</span></span> || val == <span class="hljs-number"><span class="hljs-number">0xD0</span></span> || val == <span class="hljs-number"><span class="hljs-number">0xD1</span></span>)) {</code> </pre> <br>  Wenn Sie jetzt das PP-Dienstprogramm neu erstellen und im System installieren, rechtfertigt der "schöne" Druck seinen Namen für die "große, mächtige, wahrheitsgemäße und freie russische Sprache"!  (I. S. Turgenev): <br><br><img src="https://habrastorage.org/web/00d/fd9/333/00dfd9333eac409a81c267dea791796e.png" alt="Bild"><br><br>  Wenn wir über die Schönheit des Druckens sprechen, wäre es möglich, die Silbentrennung nicht nur nach der Anzahl der Zeichen in der Zeile hinzuzufügen, sondern auch nach Leerzeichen, Komma, Doppelpunkt und anderen Zeichen.  Ich spreche nicht von der semantischen Analyse der Übertragung.  Dies ist jedoch bereits ein Bereich der künstlichen Intelligenz. <br><br>  Und schließlich ist dies die zweite entdeckte Ungenauigkeit in den NSS-Dienstprogrammen.  Die erste wurde im Dienstprogramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oidcalc entdeckt</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de406037/">https://habr.com/ru/post/de406037/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de406027/index.html">Rennen 2.0</a></li>
<li><a href="../de406029/index.html">Intel Erfolgsgeschichte</a></li>
<li><a href="../de406031/index.html">Yandex.Market und Sberbank wollen einen russischen Amazonas schaffen. Wie stehen die Chancen des Projekts?</a></li>
<li><a href="../de406033/index.html">Wir verstehen die Teilchenphysik: 8) wie Teilchen mit Feldern interagieren</a></li>
<li><a href="../de406035/index.html">Epson LabelWorks und ein heißer Wasserkocher. Und zusätzlich teilen</a></li>
<li><a href="../de406039/index.html">AMD Ryzen 3 - Jüngerer Bruder mit Charakter</a></li>
<li><a href="../de406041/index.html">Noch vor uns: Entspannen Sie sich in der Samtsaison mit praktischen Geräten</a></li>
<li><a href="../de406043/index.html">Warum die Begrenzung der Blockgrößenbeschränkung für Bitcoin und für segwit2x gefährlich ist</a></li>
<li><a href="../de406045/index.html">Benutzerdefinierte GPS-Antenne, SIM-Chip, Prozessor und 8 MB Speicher: Was macht das Mishiko Smart Dog Collar aus?</a></li>
<li><a href="../de406047/index.html">Überisierung von Abschleppwagen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>