<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ…ğŸ» ğŸ‘¨ğŸ½â€ğŸ¨ â— é€šè¿‡PVS-Studioé™æ€åˆ†æå™¨æ£€æŸ¥.NET Coreåº“æºä»£ç  ğŸ¤º ğŸ“‘ ğŸ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=".NET Coreåº“æ˜¯GitHubä¸Šæœ€å—æ¬¢è¿çš„Cï¼ƒé¡¹ç›®ä¹‹ä¸€ã€‚ ç”±äºå®ƒå·²å¹¿ä¸ºäººçŸ¥å’Œä½¿ç”¨ï¼Œå› æ­¤è¿™ä¸è¶³ä¸ºå¥‡ã€‚ å› æ­¤ï¼Œè¯•å›¾æ­ç¤ºæºä»£ç çš„é»‘æš—è§’è½å˜å¾—æ›´åŠ è¿·äººã€‚ è¿™å°±æ˜¯æˆ‘ä»¬å°†å°è¯•åœ¨PVS-Studioé™æ€åˆ†æä»ªçš„å¸®åŠ©ä¸‹è¿›è¡Œçš„æ“ä½œã€‚ æ‚¨æ€ä¹ˆçœ‹-æˆ‘ä»¬æœ€ç»ˆä¼šå‘ç°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿å—ï¼Ÿ 

 ä¸€å¹´åŠæ¥ï¼Œæˆ‘ä¸€ç›´åœ¨æœç€è¿™ç¯‡æ–‡ç« ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>é€šè¿‡PVS-Studioé™æ€åˆ†æå™¨æ£€æŸ¥.NET Coreåº“æºä»£ç </h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/463535/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/-a/bm/pb/-abmpb2yelga7y1zu59bejm6vgo.png" alt="å›¾ç‰‡19"></div><br>  .NET Coreåº“æ˜¯GitHubä¸Šæœ€å—æ¬¢è¿çš„Cï¼ƒé¡¹ç›®ä¹‹ä¸€ã€‚ ç”±äºå®ƒå·²å¹¿ä¸ºäººçŸ¥å’Œä½¿ç”¨ï¼Œå› æ­¤è¿™ä¸è¶³ä¸ºå¥‡ã€‚ å› æ­¤ï¼Œè¯•å›¾æ­ç¤ºæºä»£ç çš„é»‘æš—è§’è½å˜å¾—æ›´åŠ è¿·äººã€‚ è¿™å°±æ˜¯æˆ‘ä»¬å°†å°è¯•åœ¨PVS-Studioé™æ€åˆ†æä»ªçš„å¸®åŠ©ä¸‹è¿›è¡Œçš„æ“ä½œã€‚ æ‚¨æ€ä¹ˆçœ‹-æˆ‘ä»¬æœ€ç»ˆä¼šå‘ç°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿å—ï¼Ÿ <br><a name="habracut"></a><br> ä¸€å¹´åŠæ¥ï¼Œæˆ‘ä¸€ç›´åœ¨æœç€è¿™ç¯‡æ–‡ç« è¿ˆè¿›ã€‚ åœ¨æŸä¸ªæ—¶å€™ï¼Œæˆ‘è„‘å­é‡Œæµ®ç°å‡ºä¸€ä¸ªæƒ³æ³•ï¼Œ.NET Coreåº“æ˜¯ä¸€ä¸ªèŠ±å“¨çš„ä¸œè¥¿ï¼Œå®ƒçš„æ£€æŸ¥å¾ˆæœ‰å¸Œæœ›ã€‚ æˆ‘å¤šæ¬¡æ£€æŸ¥äº†è¯¥é¡¹ç›®ï¼Œåˆ†æå™¨ä¸æ–­å‘ç°è¶Šæ¥è¶Šå¤šçš„æœ‰è¶£ä»£ç ç‰‡æ®µï¼Œä½†æ˜¯å®ƒå¹¶ä¸ä»…ä»…æ˜¯æ»šåŠ¨è­¦å‘Šåˆ—è¡¨ã€‚ è¿™å°±æ˜¯-ç»ˆäºå‘ç”Ÿäº†ï¼ é¡¹ç›®å·²é€‰ä¸­ï¼Œæ–‡ç« å°±åœ¨æ‚¨çœ¼å‰ã€‚ <br><br><h2> æœ‰å…³é¡¹ç›®å’Œæ£€æŸ¥çš„è¯¦ç»†ä¿¡æ¯ </h2><br> å¦‚æœæ‚¨æ­£åœ¨åŠªåŠ›è¿›è¡Œä»£ç è°ƒæŸ¥-æ‚¨å¯ä»¥çœç•¥æ­¤éƒ¨åˆ†ã€‚ ä½†æ˜¯ï¼Œæˆ‘éå¸¸å¸Œæœ›æ‚¨é˜…è¯»å®ƒï¼Œå› ä¸ºåœ¨è¿™é‡Œæˆ‘å°†å‘æ‚¨ä»‹ç»æœ‰å…³é¡¹ç›®å’Œåˆ†æå™¨çš„æ›´å¤šä¿¡æ¯ï¼Œä»¥åŠè¿›è¡Œåˆ†æå’Œé‡ç°é”™è¯¯çš„æ›´å¤šä¿¡æ¯ã€‚ <br><br><h3> æ£€æŸ¥é¡¹ç›® </h3><br> ä¹Ÿè®¸ï¼Œæˆ‘å¯ä»¥è·³è¿‡è®²ä»€ä¹ˆæ˜¯CoreFXï¼ˆ.NETæ ¸å¿ƒåº“ï¼‰ï¼Œä½†æ˜¯å¦‚æœæ‚¨è¿˜æ²¡æœ‰å¬è¯´ï¼Œè¯·åœ¨ä¸‹é¢è¿›è¡Œæè¿°ã€‚ ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHubä¸Š</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é¡¹ç›®é¡µé¢</a>ç›¸åŒï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨å…¶ä¸­ä¸‹è½½æºä»£ç ã€‚ <br><br> è¯´æ˜ï¼š <i>æ­¤å­˜å‚¨åº“åŒ…å«.NET Coreçš„åº“å®ç°ï¼ˆç§°ä¸ºâ€œ CoreFXâ€ï¼‰ã€‚</i>  <i>å®ƒåŒ…æ‹¬System.Collectionsï¼ŒSystem.IOï¼ŒSystem.Xmlå’Œè®¸å¤šå…¶ä»–ç»„ä»¶ã€‚</i>  <i>ç›¸åº”çš„.NET Coreè¿è¡Œæ—¶å­˜å‚¨åº“ï¼ˆç§°ä¸ºâ€œ CoreCLRâ€ï¼‰åŒ…å«.NET Coreçš„è¿è¡Œæ—¶å®ç°ã€‚</i>  <i>å®ƒåŒ…æ‹¬RyuJITï¼Œ.NET GCå’Œè®¸å¤šå…¶ä»–ç»„ä»¶ã€‚</i>  <i>è¿è¡Œæ—¶ç‰¹å®šçš„åº“ä»£ç ï¼ˆSystem.Private.CoreLibï¼‰ä½äºCoreCLRå­˜å‚¨åº“ä¸­ã€‚</i>  <i>å®ƒéœ€è¦ä¸è¿è¡Œæ—¶ä¸€èµ·æ„å»ºå’Œç‰ˆæœ¬æ§åˆ¶ã€‚</i>  <i>å…¶ä½™CoreFXä¸è¿è¡Œæ—¶å®ç°æ— å…³ï¼Œå¯ä»¥åœ¨ä»»ä½•å…¼å®¹çš„.NETè¿è¡Œæ—¶ï¼ˆä¾‹å¦‚CoreRTï¼‰ä¸Šè¿è¡Œ</i> ã€‚ <br><br>
<h3> äºŒæ‰‹åˆ†æä»ªåŠåˆ†ææ–¹æ³• </h3><br> æˆ‘ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>PVS-Studioé™æ€åˆ†æå™¨</u></a>æ£€æŸ¥äº†ä»£ç ã€‚ ä¸€èˆ¬æ¥è¯´ï¼ŒPVS-Studioä¸ä»…å¯ä»¥åˆ†æCï¼ƒä»£ç ï¼Œè¿˜å¯ä»¥åˆ†æCï¼ŒC ++ï¼ŒJavaã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒCï¼ƒä»£ç åˆ†æä»…åœ¨Windowsä¸‹æœ‰æ•ˆï¼Œè€ŒCï¼ŒC ++ï¼ŒJavaä»£ç åˆ™å¯ä»¥åœ¨Windowsï¼ŒLinuxå’ŒmacOSä¸‹è¿›è¡Œåˆ†æã€‚ <br><br> é€šå¸¸å¯¹äºæ£€æŸ¥Cï¼ƒé¡¹ç›®ï¼Œæˆ‘ä½¿ç”¨Visual Studioçš„PVS-Studioæ’ä»¶ï¼ˆæ”¯æŒ2010-2019ç‰ˆæœ¬ï¼‰ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½æ˜¯æœ€ç®€å•ä¾¿æ·çš„åˆ†ææ–¹æ¡ˆï¼šæ‰“å¼€è§£å†³æ–¹æ¡ˆï¼Œè¿è¡Œåˆ†æï¼Œå¤„ç†è­¦å‘Šåˆ—è¡¨ã€‚ ä½†æ˜¯ï¼Œä½¿ç”¨CoreFXå˜å¾—æ›´åŠ å¤æ‚ã€‚ <br><br> æ£˜æ‰‹çš„éƒ¨åˆ†æ˜¯è¯¥é¡¹ç›®æ²¡æœ‰å•ä¸ª.slnæ–‡ä»¶ï¼Œå› æ­¤æ— æ³•åœ¨Visual Studioä¸­æ‰“å¼€è¯¥æ–‡ä»¶å¹¶ä½¿ç”¨PVS-Studioæ’ä»¶æ‰§è¡Œå®Œæ•´çš„åˆ†æã€‚ è¿™å¯èƒ½æ˜¯ä¸€ä»¶å¥½äº‹-æˆ‘çœŸçš„ä¸çŸ¥é“Visual Studioå¦‚ä½•åº”å¯¹è¿™ç§è§„æ¨¡çš„è§£å†³æ–¹æ¡ˆã€‚ <br><br> ä½†æ˜¯ï¼Œåˆ†ææ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºPVS-Studioå‘è¡Œç‰ˆåŒ…æ‹¬ç”¨äºMSBuildé¡¹ç›®ï¼ˆå’Œ.slnï¼‰çš„åˆ†æå™¨å‘½ä»¤è¡Œç‰ˆæœ¬ã€‚ æˆ‘è¦åšçš„å°±æ˜¯ç¼–å†™ä¸€ä¸ªå°è„šæœ¬ï¼Œè¯¥è„šæœ¬å°†ä¸ºCoreFXç›®å½•ä¸­çš„æ¯ä¸ª.slnè¿è¡Œâ€œ PVS-Studio_Cmd.exeâ€ï¼Œå¹¶å°†ç»“æœä¿å­˜åœ¨å•ç‹¬çš„ç›®å½•ä¸­ï¼ˆç”±åˆ†æå™¨çš„å‘½ä»¤è¡Œæ ‡å¿—æŒ‡å®šï¼‰ ã€‚ <br><br> å¿«ç‚¹ï¼ ç»“æœï¼Œæˆ‘æœ‰ä¸€ä¸ªPandoraç›’å­ï¼Œé‡Œé¢æœ‰ä¸€ç»„å­˜å‚¨ä¸€äº›æœ‰è¶£å†…å®¹çš„æŠ¥å‘Šã€‚ å¦‚æœéœ€è¦ï¼Œå¯ä»¥å°†è¿™äº›æ—¥å¿—ä¸PlogConverterå®ç”¨ç¨‹åºåˆå¹¶ï¼Œä½œä¸ºåˆ†å‘çš„ä¸€éƒ¨åˆ†ã€‚ å¯¹æˆ‘æ¥è¯´ï¼Œä½¿ç”¨å•ç‹¬çš„æ—¥å¿—æ›´åŠ æ–¹ä¾¿ï¼Œå› æ­¤æˆ‘æ²¡æœ‰åˆå¹¶å®ƒä»¬ã€‚ <br><br> åœ¨æè¿°ä¸€äº›é”™è¯¯æ—¶ï¼Œè¯·å‚é˜…docs.microsoft.comå’ŒNuGetè½¯ä»¶åŒ…ä¸­çš„æ–‡æ¡£ï¼Œè¿™äº›æ–‡æ¡£å¯ä»nuget.orgä¸‹è½½ã€‚ æˆ‘è®¤ä¸ºæ–‡æ¡£/è½¯ä»¶åŒ…ä¸­æè¿°çš„ä»£ç å¯èƒ½ä¸æ‰€åˆ†æçš„ä»£ç ç•¥æœ‰ä¸åŒã€‚ ä½†æ˜¯ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ–‡æ¡£æ²¡æœ‰æè¿°å…·æœ‰ç‰¹å®šè¾“å…¥æ•°æ®é›†æ—¶ç”Ÿæˆçš„å¼‚å¸¸ï¼Œä½†æ˜¯æ–°çš„è½¯ä»¶åŒ…ç‰ˆæœ¬å°†åŒ…å«è¿™äº›å¼‚å¸¸ï¼Œè¿™å°†éå¸¸å¥‡æ€ªã€‚ æ‚¨å¿…é¡»æ‰¿è®¤è¿™å°†æ˜¯ä¸€ä¸ªå¯ç–‘çš„æƒŠå–œã€‚ ä½¿ç”¨ä¸è°ƒè¯•åº“ç›¸åŒçš„è¾“å…¥æ•°æ®ï¼Œä»NuGetä¸­é‡ç°åŒ…ä¸­çš„é”™è¯¯ï¼Œè¿™è¡¨æ˜æ­¤é—®é¢˜ä¸æ˜¯æ–°é—®é¢˜ã€‚ æœ€é‡è¦çš„æ˜¯ï¼Œæ‚¨å¯ä»¥â€œè§¦æ‘¸â€å®ƒï¼Œè€Œæ— éœ€ä»æºä»£ç æ„å»ºé¡¹ç›®ã€‚ <br><br> å› æ­¤ï¼Œè€ƒè™‘åˆ°ä»£ç åœ¨ç†è®ºä¸Šå¯èƒ½ä¸åŒæ­¥çš„å¯èƒ½æ€§ï¼Œæˆ‘å‘ç°å¯ä»¥å‚è€ƒdocs.microsoft.comä¸Šç›¸å…³æ–¹æ³•çš„æè¿°å¹¶ä½¿ç”¨nuget.orgä¸­çš„ç¨‹åºåŒ…é‡ç°é—®é¢˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚ <br><br> å¦å¤–ï¼Œæˆ‘æƒ³æŒ‡å‡ºçš„æ˜¯ï¼Œåœ¨æ’°å†™æœ¬æ–‡çš„è¿‡ç¨‹ä¸­ï¼Œç»™å®šé“¾æ¥çš„æè¿°ï¼ŒåŒ…ä¸­çš„ä¿¡æ¯ï¼ˆæ³¨é‡Šï¼‰ï¼ˆåœ¨å…¶ä»–ç‰ˆæœ¬ä¸­ï¼‰å¯èƒ½å·²æ›´æ”¹ã€‚ <br><br><h3> å…¶ä»–æ£€æŸ¥é¡¹ç›® </h3><br> é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæœ¬æ–‡å¹¶ä¸æ˜¯åŒç±»æ–‡ç« ä¸­å”¯ä¸€çš„ã€‚ æˆ‘ä»¬åœ¨é¡¹ç›®æ£€æŸ¥æ–¹é¢å†™å…¶ä»–æ–‡ç« ã€‚ é€šè¿‡æ­¤é“¾æ¥ï¼Œå¯ä»¥æ‰¾åˆ°å·²<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ£€æŸ¥é¡¹ç›®</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ—è¡¨</a> ã€‚ æ­¤å¤–ï¼Œåœ¨æˆ‘ä»¬çš„ç½‘ç«™ä¸Šï¼Œæ‚¨ä¸ä»…å¯ä»¥æ‰¾åˆ°é¡¹ç›®æ£€æŸ¥çš„æ–‡ç« ï¼Œè€Œä¸”è¿˜å¯ä»¥æ‰¾åˆ°æœ‰å…³Cï¼ŒC ++ï¼ŒCï¼ƒï¼ŒJavaçš„å„ç§æŠ€æœ¯æ–‡ç« ï¼Œä»¥åŠä¸€äº›æœ‰è¶£çš„æ³¨é‡Šã€‚ æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>åšå®¢ä¸­</u></a>æ‰¾åˆ°æ‰€æœ‰è¿™äº›å†…å®¹ã€‚ <br><br> æˆ‘çš„åŒäº‹ä»¥å‰å·²ç»åœ¨2015å¹´æ£€æŸ¥è¿‡.NET Coreåº“ã€‚ä»¥å‰çš„åˆ†æç»“æœå¯ä»¥åœ¨ç›¸å…³æ–‡ç« ä¸­æ‰¾åˆ°ï¼šâ€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>.NET Coreåº“çš„åœ£è¯èŠ‚åˆ†æï¼ˆCoreFXï¼‰â€</u></a> ã€‚ <br><br><h2> æ£€æµ‹åˆ°çš„é”™è¯¯ï¼Œå¯ç–‘å’Œæœ‰è¶£çš„ç‰‡æ®µ </h2><br> ä¸å¾€å¸¸ä¸€æ ·ï¼Œå‡ºäºæ›´å¤§çš„å…´è¶£ï¼Œæˆ‘å»ºè®®æ‚¨é¦–å…ˆè‡ªå·±æœç´¢ç»™å®šç‰‡æ®µä¸­çš„é”™è¯¯ï¼Œç„¶åå†é˜…è¯»åˆ†æå™¨æ¶ˆæ¯å’Œé—®é¢˜æè¿°ã€‚ <br><br> ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘å·²ç»ä½¿ç”¨<b>Issue N</b>æ ‡ç­¾å°†å„ä¸ªéƒ¨åˆ†æ¸…æ¥šåœ°åˆ†å¼€äº†-è¿™æ ·ä¸€æ¥ï¼Œæ›´å®¹æ˜“çŸ¥é“ä¸€ä¸ªé”™è¯¯çš„æè¿°åœ¨å“ªé‡Œç»“æŸï¼Œæ¥ç€æ˜¯ä¸‹ä¸€ä¸ªé”™è¯¯ã€‚ æ­¤å¤–ï¼Œå¼•ç”¨ç‰¹å®šç‰‡æ®µä¼šæ›´å®¹æ˜“ã€‚ <br><br>  <b>ç¬¬1æœŸ</b> <br><br><pre><code class="cpp hljs">abstract <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Principal</span></span></span><span class="hljs-class"> :</span></span> IDisposable { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrincipalContext context)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( context.ContextType == ContextType.Machine || _ctx.ContextType == ContextType.Machine) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException( SR.SaveToNotSupportedAgainstMachineStore); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context == null) { Debug.Assert(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.unpersisted == <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException(SR.NullArguments); } .... } .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3095</u></a>åœ¨éªŒè¯æ˜¯å¦ä¸ºnullä¹‹å‰ä½¿ç”¨äº†â€œä¸Šä¸‹æ–‡â€å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š340ï¼Œ346ã€‚Principal.cs 340 <br><br> å¼€å‘äººå‘˜æ˜ç¡®å£°æ˜<i>context</i>å‚æ•°çš„<i>null</i>å€¼æ— æ•ˆï¼Œä»–ä»¬æƒ³é€šè¿‡ä½¿ç”¨<i>InvalidOperationException</i>ç±»å‹çš„å¼‚å¸¸æ¥å¼ºè°ƒè¿™ä¸€ç‚¹ã€‚ ä½†æ˜¯ï¼Œå°±åœ¨å…ˆå‰æ¡ä»¶çš„ä¸Šæ–¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹å¼•ç”¨<i>context</i> - <i>context.ContextType</i>çš„æ— æ¡ä»¶å–æ¶ˆå¼•ç”¨ã€‚ ç»“æœï¼Œå¦‚æœ<i>ä¸Šä¸‹æ–‡</i>å€¼ä¸º<i>nullï¼Œ</i>åˆ™å°†ç”Ÿæˆ<i>NullReferenceException</i>ç±»å‹çš„å¼‚å¸¸ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„<i>InvalidOperationExcetionã€‚</i> <br><br> è®©æˆ‘ä»¬å°è¯•é‡ç°è¯¥é—®é¢˜ã€‚ æˆ‘ä»¬å°†å¯¹åº“<i>System.DirectoryServices.AccountManagementçš„</i>å¼•ç”¨æ·»åŠ åˆ°é¡¹ç›®ï¼Œå¹¶æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š <br><br><pre> <code class="cpp hljs">GroupPrincipal groupPrincipal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GroupPrincipal(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrincipalContext(ContextType.Machine)); groupPrincipal.Save(null);</code> </pre> <br>  <i>GroupPrincipal</i>ç»§æ‰¿è‡ª<i>Principal</i>æŠ½è±¡ç±»ï¼Œè¯¥ç±»å®ç°äº†æˆ‘ä»¬æ„Ÿå…´è¶£çš„<i>Save</i>æ–¹æ³•ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æ‰§è¡Œä»£ç å¹¶æŸ¥çœ‹éœ€è¦è¯æ˜çš„å†…å®¹ã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/290/09a/2cc/29009a2cc3a5408808b9814d48bb0dea.png" alt="å›¾ç‰‡1"></div><br> ä¸ºäº†æ‚¨çš„å…´è¶£ï¼Œæ‚¨å¯ä»¥å°è¯•ä»NuGetä¸‹è½½é€‚å½“çš„ç¨‹åºåŒ…ï¼Œå¹¶ä»¥ç›¸åŒçš„æ–¹å¼é‡å¤è¯¥é—®é¢˜ã€‚ æˆ‘å®‰è£…äº†è½¯ä»¶åŒ…4.5.0ï¼Œå¹¶è·å¾—äº†é¢„æœŸçš„ç»“æœã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3de/891/b4a/3de891b4a4ba8100bb63af19e4455842.png" alt="å›¾ç‰‡2"></div><br>  <b>ç¬¬2æœŸ</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> SearchResultCollection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> findMoreThanOne)</span></span></span><span class="hljs-function"> </span></span>{ searchResult = null; DirectoryEntry clonedRoot = null; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_assertDefaultNamingContext == null) { clonedRoot = SearchRoot.CloneBrowsable(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { clonedRoot = SearchRoot.CloneBrowsable(); } .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3004'then</u></a> 'è¯­å¥ç­‰æ•ˆäº'else'è¯­å¥ã€‚  DirectorySearcher.cs 629 <br><br> æ— è®º<i>_assertDefaultNamingContext == null</i>æ¡ä»¶æ˜¯trueè¿˜æ˜¯falseï¼Œéƒ½å°†æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œå› ä¸º<i>then</i>å’Œ<i>if</i>è¯­å¥çš„<i>å…¶ä»–</i>åˆ†æ”¯å…·æœ‰ç›¸åŒçš„ä¸»ä½“ã€‚ åˆ†æ”¯ä¸­åº”è¯¥æœ‰å¦ä¸€ä¸ªåŠ¨ä½œï¼Œæˆ–è€…æ‚¨å¯ä»¥çœç•¥<i>if</i>è¯­å¥ï¼Œä»¥å…æ··æ·†å¼€å‘äººå‘˜å’Œåˆ†æäººå‘˜ã€‚ <br><br>  <b>ç¬¬3æœŸ</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DirectoryEntry</span></span></span><span class="hljs-class"> :</span></span> Component { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] propertyNames)</span></span></span><span class="hljs-function"> </span></span>{ .... object[] names = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> object[propertyNames.Length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; propertyNames.Length; i++) names[i] = propertyNames[i]; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_propertyCollection != null &amp;&amp; propertyNames != null) .... .... } .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3095</u></a>åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'propertyNames'å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š990ã€1004ã€‚DirectoryEntry.cs 990 <br><br> åŒæ ·ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªå¥‡æ€ªçš„åŠ¨ä½œé¡ºåºã€‚ åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œæœ‰ä¸€ä¸ªcheck <i>propertyNamesï¼= Null</i> ï¼Œå³å¼€å‘äººå‘˜ä»<i>null</i>è¦†ç›–æ–¹æ³•çš„åŸºç¡€ã€‚ ä½†æ˜¯åœ¨ä¸Šé¢ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ­¤å¯èƒ½ä¸ºç©ºçš„å¼•ç”¨<i>-propertyNames.Length</i>å’Œ<i>propertyNames [i]</i>çœ‹åˆ°ä¸€äº›è®¿é—®æ“ä½œã€‚ ç»“æœæ˜¯éå¸¸å¯é¢„æµ‹çš„-å¦‚æœå°†nullå¼•ç”¨ä¼ é€’ç»™æ–¹æ³•ï¼Œåˆ™ä¼šå‘ç”Ÿ<i>NullReferenceExcepption</i>ç±»å‹çš„å¼‚å¸¸ã€‚ <br><br> çœŸæ˜¯å·§åˆï¼  <i>RefreshCache</i>æ˜¯å…¬å…±ç±»ä¸­çš„å…¬å…±æ–¹æ³•ã€‚ å°è¯•é‡ç°è¯¥æ€ä¹ˆåŠï¼Ÿ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†éœ€è¦çš„åº“Systemã€‚Directory <i>ServicesåŒ…å«</i>åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š <br><br><pre> <code class="cpp hljs">DirectoryEntry de = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DirectoryEntry(); de.RefreshCache(null);</code> </pre> <br> æ‰§è¡Œä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœŸæœ›çš„ç»“æœã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d9/040/d0a/2d9040d0ae8d91394c476d6788aa7275.png" alt="å›¾ç‰‡3"></div><br> åªæ˜¯ä¸ºäº†è¸¢çƒï¼Œæ‚¨å¯ä»¥å°è¯•åœ¨NuGetè½¯ä»¶åŒ…çš„å‘è¡Œç‰ˆä¸Šé‡ç°è¯¥é—®é¢˜ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¯¹<i>System.DirectoryServices</i>åŒ…çš„å¼•ç”¨ï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯4.5.0ç‰ˆï¼‰æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶æ‰§è¡Œå·²ç»ç†Ÿæ‚‰çš„ä»£ç ã€‚ ç»“æœå¦‚ä¸‹ã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0d6/31e/309/0d631e3096fa8ba00b41fe10ad1001db.png" alt="å›¾ç‰‡4"></div><br>  <b>ç¬¬4æœŸ</b> <br><br> ç°åœ¨æˆ‘ä»¬ä»ç›¸åçš„è§’åº¦å‡ºå‘-é¦–å…ˆï¼Œæˆ‘ä»¬å°†å°è¯•ç¼–å†™ä½¿ç”¨ç±»å®ä¾‹çš„ä»£ç ï¼Œç„¶åå†å‘å†…çœ‹ã€‚ è®©æˆ‘ä»¬ä»<i>System.Drawing.Common</i>åº“å’ŒåŒåçš„NuGetåŒ…ä¸­å¼•ç”¨<i>System.Drawing.CharacterRange</i>ç»“æ„ã€‚ <br><br> æˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š <br><br><pre> <code class="cpp hljs">CharacterRange range = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CharacterRange(); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> eq = range.Equals(null); Console.WriteLine(eq);</code> </pre> <br> ä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œä¸ºäº†æ…¢è·‘æˆ‘ä»¬çš„è®°å¿†ï¼Œæˆ‘ä»¬å°†è®¿é—®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>docs.microsoft.com</u></a>ä»¥å›æƒ³ä¸€ä¸‹ä»<i>obj.Equalsï¼ˆnullï¼‰</i>è¡¨è¾¾å¼æœŸæœ›çš„è¿”å›å€¼ï¼š <br><br>  <i>å¯¹äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><i>Equalsï¼ˆObjectï¼‰</i></u></a>æ–¹æ³•çš„æ‰€æœ‰å®ç°ï¼Œä»¥ä¸‹è¯­å¥å¿…é¡»ä¸ºtrueã€‚</i>  <i>åœ¨åˆ—è¡¨ä¸­ï¼Œxï¼Œyå’Œzè¡¨ç¤ºä¸ä¸ºnullçš„å¯¹è±¡å¼•ç”¨ã€‚</i> <br><br>  <i>....</i> <br><br>  <b><i>x.Equalsï¼ˆnullï¼‰è¿”å›falseã€‚</i></b> <br><br> æ‚¨æ˜¯å¦è®¤ä¸ºâ€œ Falseâ€å°†æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸­ï¼Ÿ å½“ç„¶ä¸æ˜¯ã€‚ è¿™å¤ªå®¹æ˜“äº†ã€‚  :)å› æ­¤ï¼Œæˆ‘ä»¬æ‰§è¡Œä»£ç å¹¶æŸ¥çœ‹ç»“æœã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e87/159/8f6/e871598f6ca5dacdb4a4fae7b5776520.png" alt="å›¾ç‰‡5"></div><br> å®ƒæ˜¯ä¸Šè¿°ä»£ç ä½¿ç”¨ç‰ˆæœ¬4.5.1çš„NuGet <i>System.Drawing.Common</i>åŒ…çš„è¾“å‡ºã€‚ ä¸‹ä¸€æ­¥æ˜¯ä½¿ç”¨è°ƒè¯•åº“ç‰ˆæœ¬è¿è¡Œç›¸åŒçš„ä»£ç ã€‚ è¿™æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„ï¼š <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e9/f27/f1a/6e9f27f1a78768078fdd940e0a4be0ad.png" alt="å›¾ç‰‡6"></div><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æºä»£ç ï¼Œå°¤å…¶æ˜¯<i>CharacterRange</i>ç»“æ„ä¸­<i>Equals</i>æ–¹æ³•çš„å®ç°å’Œåˆ†æå™¨è­¦å‘Šï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object obj)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj.GetType() != typeof(CharacterRange)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; CharacterRange cr = (CharacterRange)obj; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((_first == cr.First) &amp;&amp; (_length == cr.Length)); }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3115å°†</u></a> â€œ nullâ€ä¼ é€’ç»™â€œ Equalsâ€æ–¹æ³•ä¸åº”å¯¼è‡´â€œ NullReferenceExceptionâ€ã€‚ å­—ç¬¦èŒƒå›´56 <br><br> æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œå¿…é¡»è¯æ˜çš„æ˜¯<i>-obj</i>å‚æ•°å¤„ç†ä¸å½“ã€‚ å› æ­¤ï¼Œåœ¨è°ƒç”¨å®ä¾‹æ–¹æ³•<i>GetType</i>æ—¶ï¼Œæ¡ä»¶è¡¨è¾¾å¼ä¸­ä¼šå‘ç”Ÿ<i>NullReferenceException</i>å¼‚å¸¸<i>ã€‚</i> <br><br>  <b>ç¬¬5æœŸ</b> <br><br> åœ¨æ¢ç´¢è¯¥åº“æ—¶ï¼Œè®©æˆ‘ä»¬è€ƒè™‘å¦ä¸€ä¸ªæœ‰è¶£çš„ç‰‡æ®µ<i>-Iconã€‚Save</i>æ–¹æ³•<i>ã€‚</i> åœ¨ç ”ç©¶ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ–¹æ³•çš„æè¿°ã€‚ <br><br> æ²¡æœ‰è¯¥æ–¹æ³•çš„æè¿°ï¼š <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ffd/fef/402/ffdfef402f77c462c94b9ff284f42e0c.png" alt="å›¾ç‰‡7"></div><br> è®©æˆ‘ä»¬è§£å†³docs.microsoft.com-â€œ <u>Icon.Saveï¼ˆStreamï¼‰æ–¹æ³•</u> â€ã€‚ ä½†æ˜¯ï¼Œå¯¹äºè¾“å…¥æˆ–æœ‰å…³ç”Ÿæˆçš„å¼‚å¸¸çš„ä¿¡æ¯ä¹Ÿæ²¡æœ‰é™åˆ¶ã€‚ <br><br> ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­è¿›è¡Œä»£ç æ£€æŸ¥ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed partial <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Icon</span></span></span><span class="hljs-class"> :</span></span> MarshalByRefObject, ICloneable, IDisposable, ISerializable { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Stream outputStream)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_iconData != null) { outputStream.Write(_iconData, <span class="hljs-number"><span class="hljs-number">0</span></span>, _iconData.Length); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputStream == null) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"dataStream"</span></span>); .... } } .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3095</u></a>åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'outputStream'å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š654ã€672ã€‚Icon.Windows.cs 654 <br><br> åŒæ ·ï¼Œè¿™æ˜¯æˆ‘ä»¬å·²ç»çŸ¥é“çš„æ•…äº‹-å¯èƒ½ä¼šå–æ¶ˆå¼•ç”¨nullå¼•ç”¨ï¼Œå› ä¸ºåœ¨ä¸æ£€æŸ¥<i>nullçš„</i>æƒ…å†µä¸‹å–æ¶ˆå¼•ç”¨æ–¹æ³•çš„å‚æ•°ã€‚ å†æ¬¡ï¼Œæƒ…å†µçš„æˆåŠŸå·§åˆ-ç±»å’Œæ–¹æ³•éƒ½æ˜¯å…¬å¼€çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•é‡ç°è¯¥é—®é¢˜ã€‚ <br><br> æˆ‘ä»¬çš„ä»»åŠ¡å¾ˆç®€å•-å°†ä»£ç æ‰§è¡Œå¸¦åˆ°è¡¨è¾¾å¼<i>outputStream.Writeï¼ˆ_iconDataï¼Œ0ï¼Œ_iconData.Lengthï¼‰;</i> å¹¶åŒæ—¶ä¿å­˜å˜é‡<i>outputStream</i> - <i>nullçš„å€¼</i> ã€‚ æ»¡è¶³æ¡ä»¶<i>_iconDataï¼= Null</i>å°±è¶³å¤Ÿäº†ã€‚ <br><br> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ€ç®€å•çš„å…¬å…±æ„é€ å‡½æ•°ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Icon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName)</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(fileName, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br> å®ƒåªæ˜¯å°†å·¥ä½œå§”æ‰˜ç»™å¦ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Icon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height)</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (FileStream f = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.Read)) { Debug.Assert(f != null, <span class="hljs-string"><span class="hljs-string">"File.OpenRead returned null instead of throwing an exception"</span></span>); _iconData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> byte[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)f.Length]; f.Read(_iconData, <span class="hljs-number"><span class="hljs-number">0</span></span>, _iconData.Length); } Initialize(width, height); }</code> </pre> <br> å°±è¿™æ ·ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ è°ƒç”¨æ­¤æ„é€ å‡½æ•°åï¼Œå¦‚æœæˆ‘ä»¬æˆåŠŸåœ°ä»æ–‡ä»¶ä¸­è¯»å–äº†æ•°æ®å¹¶ä¸”<i>Initialize</i>æ–¹æ³•æ²¡æœ‰å´©æºƒï¼Œåˆ™<i>_iconData</i>å­—æ®µå°†åŒ…å«å¯¹å¯¹è±¡çš„å¼•ç”¨ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚ <br><br> äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»º<i>Icon</i>ç±»çš„å®ä¾‹å¹¶æŒ‡å®šä¸€ä¸ªå®é™…çš„å›¾æ ‡æ–‡ä»¶æ‰èƒ½é‡ç°è¯¥é—®é¢˜ã€‚ ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨<i>Save</i>æ–¹æ³•ï¼Œå¹¶å°†<i>null</i>å€¼ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦åšçš„ã€‚ è¯¥ä»£ç å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs">Icon icon = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Icon(@<span class="hljs-string"><span class="hljs-string">"D:\document.ico"</span></span>); icon.Save(null);</code> </pre> <br> æ‰§è¡Œç»“æœæ˜¯é¢„æœŸçš„ã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b37/fdb/dd1/b37fdbdd1288c054fdaaa0add0ffcfcf.png" alt="å›¾ç‰‡8"></div><br>  <b>ç¬¬6æœŸ</b> <br><br> æˆ‘ä»¬ç»§ç»­è¿›è¡Œå®¡æŸ¥å¹¶ç»§ç»­ã€‚ å°è¯•æ‰¾å‡ºåœ¨<i>æƒ…å†µCimType.UInt32</i>å’Œå…¶ä»–<i>æƒ…å†µä¸‹</i>æ‰§è¡Œçš„æ“ä½œä¹‹é—´çš„3ä¸ªå·®å¼‚ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertToNumericValueAndAddToArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> retFunctionName = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Empty; enumType = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(cimType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.UInt8: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.SInt8: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.SInt16: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.UInt16: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.SInt32: arrayToAdd.Add(System.Convert.ToInt32( numericValue, (IFormatProvider)CultureInfo.InvariantCulture .GetFormat(typeof(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)))); retFunctionName = <span class="hljs-string"><span class="hljs-string">"ToInt32"</span></span>; enumType = <span class="hljs-string"><span class="hljs-string">"System.Int32"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.UInt32: arrayToAdd.Add(System.Convert.ToInt32( numericValue, (IFormatProvider)CultureInfo.InvariantCulture .GetFormat(typeof(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)))); retFunctionName = <span class="hljs-string"><span class="hljs-string">"ToInt32"</span></span>; enumType = <span class="hljs-string"><span class="hljs-string">"System.Int32"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> retFunctionName; }</code> </pre> <br> å½“ç„¶ï¼Œæ²¡æœ‰å·®å¼‚ï¼Œå› ä¸ºåˆ†æä»ªä¼šå‘æˆ‘ä»¬å‘å‡ºè­¦å‘Šã€‚ <br><br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3139</u></a>ä¸¤ä¸ªæˆ–æ›´å¤šæ¡ˆä¾‹åˆ†æ”¯æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚  WMIGenerator.cs 5220 <br><br> å°±ä¸ªäººè€Œè¨€ï¼Œè¿™ç§ä»£ç é£æ ¼ä¸æ˜¯å¾ˆæ¸…æ¥šã€‚ æˆ‘è®¤ä¸ºï¼Œå¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œåˆ™ä¸åº”å°†ç›¸åŒçš„é€»è¾‘åº”ç”¨äºä¸åŒçš„æƒ…å†µã€‚ <br><br>  <b>ç¬¬7æœŸ</b> <br><br>  <i>Microsoft.CSharp</i>åº“ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IList&lt;KeyValuePair&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, object&gt;&gt; QueryDynamicObject(object obj) { .... List&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; names = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;(mo.GetDynamicMemberNames()); names.Sort(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (names != null) { .... } .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3022</u></a>è¡¨è¾¾å¼'namesï¼= Null'å§‹ç»ˆä¸ºtrueã€‚  DynamicDebuggerProxy.cs 426 <br><br> æˆ‘å¯èƒ½ä¼šå¿½ç•¥æ­¤è­¦å‘Šä»¥åŠè¯Šæ–­ç¨‹åº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3022</u></a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3063</u></a>å‘å‡ºçš„è®¸å¤šç±»ä¼¼è­¦å‘Šã€‚ æœ‰å¾ˆå¤šï¼ˆå¾ˆå¤šï¼‰å¥‡æ€ªçš„æ£€æŸ¥ï¼Œä½†è¿™ä¸çŸ¥ä½•æ•…è¿›å…¥äº†æˆ‘çš„çµé­‚ã€‚ ä¹Ÿè®¸åŸå› åœ¨äºå°†æœ¬åœ°<i>åç§°</i>å˜é‡ä¸<i>null</i>è¿›è¡Œæ¯”è¾ƒä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆ<i>ã€‚</i> ä¸ä»…å°†å¼•ç”¨å­˜å‚¨åœ¨æ–°åˆ›å»ºå¯¹è±¡çš„<i>åç§°</i>å˜é‡ä¸­ï¼Œè€Œä¸”è¿˜è°ƒç”¨å®ä¾‹<i>Sort</i>æ–¹æ³•ã€‚ å½“ç„¶ï¼Œè¿™ä¸æ˜¯é”™è¯¯ï¼Œä½†å°±æˆ‘è€Œè¨€ï¼Œå€¼å¾—å…³æ³¨ã€‚ <br><br>  <b>ç¬¬8æœŸ</b> <br><br> å¦ä¸€æ®µæœ‰è¶£çš„ä»£ç ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InsertChildNoGrow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Symbol child)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (sym?.nextSameName != null) { sym = sym.nextSameName; } Debug.Assert(sym != null &amp;&amp; sym.nextSameName == null); sym.nextSameName = child; .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3042</u></a>å¯èƒ½ä¸ºNullReferenceExceptionã€‚  'ï¼Ÿã€‚' å’Œâ€œã€‚â€ è¿ç®—ç¬¦ç”¨äºè®¿é—®'sym'å¯¹è±¡SymbolStore.csçš„æˆå‘˜56 <br><br> çœ‹çœ‹æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚ éµå¾ªä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¸­çš„è‡³å°‘ä¸€ä¸ªæ¡ä»¶ï¼Œå¾ªç¯ç»“æŸï¼š <br><br><ul><li>  <i>sym == null</i> ; </li><li>  <i>sym.nextSameName == null</i> ã€‚ </li></ul><br> ç¬¬äºŒä¸ªæ¡ä»¶æ²¡æœ‰é—®é¢˜ï¼Œå…³äºç¬¬ä¸€ä¸ªæ¡ä»¶ä¸èƒ½è¯´ã€‚ ç”±äº<i>åç§°</i>å®ä¾‹å­—æ®µæ˜¯åœ¨ä¸‹é¢æ— æ¡ä»¶è®¿é—®çš„ï¼Œå¹¶ä¸”å¦‚æœä¸º<i>sym</i> - <i>null</i> ï¼Œåˆ™å°†å‘ç”Ÿ<i>NullReferenceException</i>ç±»å‹çš„å¼‚å¸¸ã€‚ <br><br> ä½ çäº†å— åœ¨<i>Debug.Assert</i>è°ƒç”¨ä¸­ï¼Œæ£€æŸ¥äº†<i>symï¼= Null</i> â€-æœ‰äººå¯èƒ½ä¼šäº‰è®ºã€‚ æ°æ°ç›¸åï¼Œè¿™å°±æ˜¯é‡ç‚¹ï¼ åœ¨å‘å¸ƒç‰ˆæœ¬ä¸­å·¥ä½œæ—¶ï¼Œ <i>Debug.Assert</i>ä¸ä¼šæœ‰ä»»ä½•å¸®åŠ©ï¼Œå¹¶ä¸”åœ¨ä¸Šè¿°æ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬å°†è·å¾—çš„åªæ˜¯<i>NullReferenceException</i> ã€‚ è€Œä¸”ï¼Œæˆ‘å·²ç»åœ¨Microsoft <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>Roslynçš„</u></a>å¦ä¸€ä¸ªé¡¹ç›®ä¸­çœ‹åˆ°äº†ç±»ä¼¼çš„é”™è¯¯ï¼Œåœ¨<i>Debug.Assertä¸­</i>ä¹Ÿå‘ç”Ÿäº†ç±»ä¼¼çš„æƒ…å†µã€‚ è®©æˆ‘ä¸ºç½—æ–¯æ—è½¬ä¸€ä¼šå„¿ã€‚ <br><br> ä½¿ç”¨<i>Microsoft.CodeAnalysis</i>åº“æ—¶å¯èƒ½ä¼šé‡ç°æ­¤é—®é¢˜ï¼Œæˆ–è€…ä½¿ç”¨è¯­æ³•Visualizeræ—¶å¯èƒ½ä¼šåœ¨Visual Studioä¸­é‡ç°è¯¥é—®é¢˜ã€‚ åœ¨Visual Studio 16.1.6 +è¯­æ³•Visualizer 1.0ä¸­ï¼Œä»ç„¶å¯ä»¥é‡ç°æ­¤é—®é¢˜ã€‚ <br><br> è¿™æ®µä»£ç å°±è¶³å¤Ÿäº†ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C1</span></span></span><span class="hljs-class">&lt;T1, T2&gt; {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ T1 val = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (val is null) { } } }</code> </pre> <br> æ­¤å¤–ï¼Œåœ¨Syntax Visualizerä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°<i>ConstantPatternSyntax</i>ç±»å‹çš„è¯­æ³•æ ‘çš„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å¯¹åº”äºä»£ç ä¸­çš„<i>null</i>å¹¶<i>ä¸ºå…¶</i>è¯·æ±‚<i>TypeSymbol</i> ã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/855/b9c/baa/855b9cbaa67c9a5909117d513e154293.png" alt="å›¾ç‰‡9"></div><br> ä¹‹åï¼ŒVisual Studioå°†é‡æ–°å¯åŠ¨ã€‚ å¦‚æœè½¬åˆ°äº‹ä»¶æŸ¥çœ‹å™¨ï¼Œæˆ‘ä»¬å°†åœ¨åº“ä¸­æ‰¾åˆ°ä¸€äº›æœ‰å…³é—®é¢˜çš„ä¿¡æ¯ï¼š <br><br><pre> <code class="cpp hljs">Application: devenv.exe Framework Version: v4<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.30319</span></span> Description: The process was terminated due to an unhandled exception. Exception Info: System.Resources.MissingManifestResourceException at System.Resources.ManifestBasedResourceGroveler .HandleResourceStreamMissing(System.String) at System.Resources.ManifestBasedResourceGroveler.GrovelForResourceSet( System.Globalization.CultureInfo, System.Collections.Generic.Dictionary<span class="hljs-string"><span class="hljs-string">'2 &lt;System.String,System.Resources.ResourceSet&gt;, Boolean, Boolean, System.Threading.StackCrawlMark ByRef) at System.Resources.ResourceManager.InternalGetResourceSet( System.Globalization.CultureInfo, Boolean, Boolean, System.Threading.StackCrawlMark ByRef) at System.Resources.ResourceManager.InternalGetResourceSet( System.Globalization.CultureInfo, Boolean, Boolean) at System.Resources.ResourceManager.GetString(System.String, System.Globalization.CultureInfo) at Roslyn.SyntaxVisualizer.DgmlHelper.My. Resources.Resources.get_SyntaxNodeLabel() ....</span></span></code> </pre> <br> è‡³äºdevenv.exeçš„é—®é¢˜ï¼š <br><br><pre> <code class="cpp hljs">Faulting application name: devenv.exe, version: <span class="hljs-number"><span class="hljs-number">16.1</span></span><span class="hljs-number"><span class="hljs-number">.29102</span></span><span class="hljs-number"><span class="hljs-number">.190</span></span>, time stamp: <span class="hljs-number"><span class="hljs-number">0x5d1c133b</span></span> Faulting <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> name: KERNELBASE.dll, version: <span class="hljs-number"><span class="hljs-number">10.0</span></span><span class="hljs-number"><span class="hljs-number">.18362</span></span><span class="hljs-number"><span class="hljs-number">.145</span></span>, time stamp: <span class="hljs-number"><span class="hljs-number">0xf5733ace</span></span> Exception code: <span class="hljs-number"><span class="hljs-number">0xe0434352</span></span> Fault offset: <span class="hljs-number"><span class="hljs-number">0x001133d2</span></span> ....</code> </pre> <br> ä½¿ç”¨Roslynåº“çš„è°ƒè¯•ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å‘ç”Ÿå¼‚å¸¸çš„åœ°æ–¹ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Conversion </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClassifyImplicitBuiltInConversionSlow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( TypeSymbol source, TypeSymbol destination, ref HashSet&lt;DiagnosticInfo&gt; useSiteDiagnostics)</span></span></span><span class="hljs-function"> </span></span>{ Debug.Assert((object)source != null); Debug.Assert((object)destination != null); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( source.SpecialType == SpecialType.System_Void || destination.SpecialType == SpecialType.System_Void) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Conversion.NoConversion; } .... }</code> </pre> <br> åœ¨è¿™é‡Œï¼Œä¸ä¸Šè¿°.NET Coreåº“ä¸­çš„ä»£ç ç›¸åŒï¼Œå¯¹<i>Debug.Assert</i>è¿›è¡Œäº†æ£€æŸ¥ï¼Œè¿™åœ¨ä½¿ç”¨åº“çš„å‘è¡Œç‰ˆæ—¶<i>æ— æµäºäº‹</i> ã€‚ <br><br>  <b>ç¬¬9æœŸ</b> <br><br> æˆ‘ä»¬åœ¨è¿™é‡Œæœ‰äº›åç¦»ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å›åˆ°.NET Coreåº“ã€‚  <i>System.IO.IsolatedStorage</i>ç¨‹åºåŒ…åŒ…å«ä»¥ä¸‹æœ‰è¶£çš„ä»£ç ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContainsUnknownFiles</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> directory)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (files.Length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> || ( (!IsIdFile(files[<span class="hljs-number"><span class="hljs-number">0</span></span>]) &amp;&amp; !IsInfoFile(files[<span class="hljs-number"><span class="hljs-number">0</span></span>]))) || (files.Length == <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; !IsIdFile(files[<span class="hljs-number"><span class="hljs-number">1</span></span>]) &amp;&amp; !IsInfoFile(files[<span class="hljs-number"><span class="hljs-number">1</span></span>])) ); }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3088</u></a>è¯¥è¡¨è¾¾å¼ç”¨æ‹¬å·æ‹¬èµ·æ¥ä¸¤æ¬¡ï¼šï¼ˆï¼ˆè¡¨è¾¾å¼ï¼‰ï¼‰ã€‚ ä¸éœ€è¦ä¸€å¯¹æ‹¬å·ï¼Œå¦åˆ™ä¼šå‡ºç°æ‰“å°é”™è¯¯ã€‚ å­¤ç«‹çš„StorageFile.cs 839 <br><br> è¯´ä»£ç æ ¼å¼ä»¤äººå›°æƒ‘æ˜¯å¦ä¸€ç§æ— è¯å¯è¯´çš„æ–¹æ³•ã€‚ ç®€çŸ­åœ°çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œæˆ‘ä¼šè¯´ç¬¬ä¸€ä¸ª||çš„å·¦æ“ä½œæ•°ã€‚ æˆ‘é‡åˆ°çš„è¿ç®—ç¬¦æ˜¯<i>files.Length&gt; 2</i> ï¼Œå³è¾¹çš„æ˜¯æ‹¬å·ä¸­çš„ä¸€ä¸ªã€‚ è‡³å°‘ä»£ç æ˜¯è¿™æ ·æ ¼å¼åŒ–çš„ã€‚ åœ¨ä»”ç»†æŸ¥çœ‹ä¹‹åï¼Œæ‚¨å¯ä»¥äº†è§£å¹¶éå¦‚æ­¤ã€‚ å®é™…ä¸Šï¼Œå³æ“ä½œæ•°- <i>ï¼ˆï¼ˆï¼IsIdFileï¼ˆæ–‡ä»¶[0]ï¼‰&amp;&amp;ï¼IsInfoFileï¼ˆæ–‡ä»¶[0]ï¼‰ï¼‰ï¼‰</i> ã€‚ æˆ‘è®¤ä¸ºè¿™æ®µä»£ç éå¸¸ä»¤äººå›°æƒ‘ã€‚ <br><br>  <b>ç¬¬10æœŸ</b> <br><br>  PVS-Studio 7.03å¼•å…¥äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3138</u></a>è¯Šæ–­è§„åˆ™ï¼Œè¯¥è§„åˆ™æœç´¢å†…æ’å­—ç¬¦ä¸²ä¸­çš„é”™è¯¯ã€‚ æ›´ç¡®åˆ‡åœ°è¯´ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­æœ€æœ‰å¯èƒ½å¿…é¡»è¿›è¡Œæ’å€¼ï¼Œä½†æ˜¯ç”±äºç¼ºå°‘<i>$</i>ç¬¦å·ï¼Œå®ƒä»¬ä¸æ˜¯<i>ã€‚</i> åœ¨<i>System.Net</i>åº“ä¸­ï¼Œæˆ‘å‘ç°äº†æ­¤è¯Šæ–­è§„åˆ™çš„ä¸€äº›æœ‰è¶£äº‹ä»¶ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CacheCredential</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SafeFreeCredentials newHandle)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { .... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ExceptionCheck.IsFatal(e)) { NetEventSource.Fail(null, <span class="hljs-string"><span class="hljs-string">"Attempted to throw: {e}"</span></span>); } } }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3138</u></a>å­—ç¬¦ä¸²æ–‡å­—åŒ…å«æ½œåœ¨çš„å†…æ’è¡¨è¾¾å¼ã€‚ è€ƒè™‘æ£€æŸ¥ï¼šeã€‚  SSPIHandleCache.cs 42 <br><br>  <i>Fail</i>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°å¾ˆæœ‰å¯èƒ½å¿…é¡»æ˜¯æ’å€¼å­—ç¬¦ä¸²ï¼Œå…¶ä¸­å°†æ›¿æ¢<i>e</i>å¼‚å¸¸çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚ ä½†æ˜¯ï¼Œç”±äºç¼ºå°‘<i>$</i>ç¬¦å·ï¼Œå› æ­¤æœªæ›¿æ¢ä»»ä½•å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚ <br><br>  <b>ç¬¬11æœŸ</b> <br><br> è¿™æ˜¯å¦ä¸€ä¸ªç±»ä¼¼çš„æƒ…å†µã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> async Task&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; GetDigestTokenForCredential(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NetEventSource.IsEnabled) NetEventSource.Error(digestResponse, <span class="hljs-string"><span class="hljs-string">"Algorithm not supported: {algorithm}"</span></span>); .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3138</u></a>å­—ç¬¦ä¸²æ–‡å­—åŒ…å«æ½œåœ¨çš„å†…æ’è¡¨è¾¾å¼ã€‚ è€ƒè™‘æ£€æŸ¥ï¼šç®—æ³•ã€‚  AuthenticationHelper.Digest.cs 58 <br><br> æƒ…å†µä¸ä¸Šè¿°æƒ…å†µç±»ä¼¼ï¼Œå†æ¬¡ç¼ºå°‘<i>$</i>ç¬¦å·ï¼Œå¯¼è‡´å­—ç¬¦ä¸²ä¸æ­£ç¡®ï¼Œå¹¶è¿›å…¥<i>Error</i>æ–¹æ³•<i>ã€‚</i> <br><br>  <b>ç¬¬åäºŒæœŸ</b> <br><br>  <i>System.Net.Mail</i>ç¨‹åºåŒ…ã€‚ è¯¥æ–¹æ³•å¾ˆå°ï¼Œæˆ‘å°†å…¶å…¨éƒ¨å¼•ç”¨ä»¥ä½¿æœç´¢é”™è¯¯æ›´æœ‰è¶£ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Stream stream)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stream == null) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(nameof(stream)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_streamSet) { _stream.Close(); _stream = null; _streamSet = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } _stream = stream; _streamSet = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; _streamUsedOnce = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; TransferEncoding = TransferEncoding.Base64; }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3008ä¸º</u></a> '_streamSet'å˜é‡è¿ç»­ä¸¤æ¬¡åˆ†é…å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š123ã€119ã€‚MimePart.cs 123 <br><br> å˜é‡<i>_streamSetçš„</i>åŒå€¼åˆ†é…çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼ˆé¦–å…ˆ-åœ¨æ¡ä»¶ä¸‹ï¼Œç„¶å-å¤–éƒ¨ï¼‰ã€‚ é‡ç½®<i>æµ</i>å˜é‡ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ç»“æœï¼Œ <i>_stream</i>ä»å°†å…·æœ‰å€¼<i>stream</i> ï¼Œå¹¶ä¸”<i>_streamSet</i>å°†ä¸º<i>trueã€‚</i> <br><br>  <b>ç¬¬13æœŸ</b> <br><br>  <i>System.Linq.Expressions</i>åº“ä¸­ä¸€ä¸ªæœ‰è¶£çš„ä»£ç ç‰‡æ®µï¼Œå®ƒç«‹å³è§¦å‘2ä¸ªåˆ†æå™¨è­¦å‘Šã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ›´åƒæ˜¯åŠŸèƒ½ï¼Œè€Œä¸æ˜¯é”™è¯¯ã€‚ ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¾ˆä¸å¯»å¸¸... <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// throws NRE when o is null protected static void NullCheck(object o) { if (o == null) { o.GetType(); } }</span></span></code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3010</u></a>éœ€è¦ä½¿ç”¨å‡½æ•°â€œ GetTypeâ€çš„è¿”å›å€¼ã€‚  Instruction.cs 36 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3080</u></a>å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œ oâ€ã€‚  Instruction.cs 36 </li></ul><br> è¿™é‡Œå¯èƒ½æ²¡æœ‰ä»€ä¹ˆå¯è¯„è®ºçš„ã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c9/a88/a22/5c9a88a221d4cd5ba5f4f1d9f74a346b.png" alt="å›¾ç‰‡20"></div><br>  <b>ç¬¬14æœŸ</b> <br><br> è®©æˆ‘ä»¬è€ƒè™‘å¦ä¸€ç§æƒ…å†µï¼Œæˆ‘ä»¬å°†â€œä»å¤–éƒ¨â€å¤„ç†ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç¼–å†™ä»£ç ï¼Œæ£€æµ‹é—®é¢˜ï¼Œç„¶åçœ‹å†…éƒ¨ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨<i>System.Configuration.ConfigurationManager</i>åº“å’ŒåŒåçš„NuGetåŒ…è¿›è¡Œæ£€æŸ¥ã€‚ æˆ‘ä½¿ç”¨äº†4.5.0ç‰ˆæœ¬çš„ç¨‹åºåŒ…ã€‚ æˆ‘ä»¬å°†å¤„ç†<i>System.Configuration.CommaDelimitedStringCollection</i>ç±»ã€‚ <br><br> è®©æˆ‘ä»¬åšä¸€äº›ç®€å•çš„äº‹æƒ…ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæå–å…¶å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼å¹¶è·å–è¯¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç„¶åè¿›è¡Œæ‰“å°ã€‚ ç›¸å…³ä»£ç ï¼š <br><br><pre> <code class="cpp hljs">CommaDelimitedStringCollection collection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CommaDelimitedStringCollection(); Console.WriteLine(collection.ToString().Length);</code> </pre> <br> ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘ä»¬å°†æ£€æŸ¥<i>ToString</i>æ–¹æ³•è¯´æ˜ï¼š <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8dc/544/56d/8dc54456dd1296d89fbe447fac71ac17.png" alt="å›¾ç‰‡11"></div><br> æ²¡ä»€ä¹ˆç‰¹åˆ«çš„-è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚ ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘å°†ç­¾å‡ºdocs.microsoft.com-â€œ <u>CommaDelimitedStringCollection.ToStringæ–¹æ³•</u> â€ã€‚ ä¼¼ä¹è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ã€‚ <br><br> å¥½å§ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œä»£ç ï¼Œaaand ... <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa5/89f/1af/fa589f1afc8ceb9415694e1261e59ab7.png" alt="å›¾ç‰‡12"></div><br> å—¯ï¼ŒæƒŠå–œã€‚ å¥½å§ï¼Œè®©æˆ‘ä»¬å°è¯•å°†ä¸€ä¸ªé¡¹ç›®æ·»åŠ åˆ°é›†åˆä¸­ï¼Œç„¶åè·å–å…¶å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬â€œç»å¯¹å¶ç„¶â€æ·»åŠ ä¸€ä¸ªç©ºå­—ç¬¦ä¸²:)ã€‚ ä»£ç å°†æ›´æ”¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs">CommaDelimitedStringCollection collection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CommaDelimitedStringCollection(); collection.Add(String.Empty); Console.WriteLine(collection.ToString().Length);</code> </pre> <br> æ‰§è¡Œå¹¶æŸ¥çœ‹... <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d37/4bc/d2e/d374bcd2ed23bd048276493ed19d30fe.png" alt="å›¾ç‰‡13"></div><br> åˆæ˜¯ä»€ä¹ˆï¼Ÿï¼ å¥½äº†ï¼Œè®©æˆ‘ä»¬æœ€åè§£å†³<i>CommaDelimitedStringCollection</i>ç±»ä¸­<i>ToString</i>æ–¹æ³•çš„<i>å®ç°</i> ã€‚ ä»£ç å¦‚ä¸‹ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Count &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); foreach (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> str in <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) { ThrowIfContainsDelimiter(str); <span class="hljs-comment"><span class="hljs-comment">// .... sb.Append(str.Trim()); sb.Append(','); } if (sb.Length &gt; 0) sb.Length = sb.Length - 1; return sb.Length == 0 ? null : sb.ToString(); }</span></span></code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3108</u></a>ä¸å»ºè®®ä»â€œ ToStingï¼ˆï¼‰â€æ–¹æ³•è¿”å›â€œ nullâ€ã€‚  StringAttributeCollection.cs 57 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3108</u></a>ä¸å»ºè®®ä»â€œ ToStingï¼ˆï¼‰â€æ–¹æ³•è¿”å›â€œ nullâ€ã€‚  StringAttributeCollection.cs 71 </li></ul><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°2ä¸ªç‰‡æ®µï¼Œå…¶ä¸­å½“å‰çš„<i>ToString</i>å®ç°å¯ä»¥è¿”å›<i>nullã€‚</i> è‡³æ­¤ï¼Œæˆ‘ä»¬å°†å›é¡¾Microsoftå…³äº<i>ToString</i>æ–¹æ³•å®ç°çš„å»ºè®®ã€‚ å› æ­¤ï¼Œè¯·å‚è€ƒdocs.microsoft.com-â€œ Object.ToString <u>æ–¹æ³•</u> â€ï¼š <br><br>  <i>å¯¹ç»§æ‰¿è€…çš„è¯´æ˜.... ToStringï¼ˆï¼‰æ–¹æ³•çš„é‡å†™åº”éµå¾ªä»¥ä¸‹å‡†åˆ™ï¼š</i> <br><br><ul><li>  <i>....</i> </li><li>  <i>æ‚¨çš„ToStringï¼ˆï¼‰é‡å†™ä¸åº”è¿”å›Emptyæˆ–</i> <b><i>ç©º</i></b> <i>å­—ç¬¦ä¸²ã€‚</i> </li><li>  <i>....</i> </li></ul><br> è¿™å°±æ˜¯PVS-Studioè­¦å‘Šçš„åœ°æ–¹ã€‚ ä¸Šé¢ç»™å‡ºçš„ç”¨äºé‡ç°è¯¥é—®é¢˜çš„ä¸¤ä¸ªä»£ç ç‰‡æ®µåˆ†åˆ«å…·æœ‰ä¸åŒçš„é€€å‡ºç‚¹-åˆ†åˆ«æ˜¯ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ª<i>ç©º</i>è¿”å›ç‚¹ã€‚ è®©æˆ‘ä»¬æ·±å…¥ä¸€ç‚¹ã€‚ <br><br> ç¬¬ä¸€ç§æƒ…å†µã€‚  <i>Count</i>æ˜¯<i>StringCollection</i>åŸºç±»çš„å±æ€§ã€‚ ç”±äºæœªæ·»åŠ ä»»ä½•å…ƒç´ ï¼Œ <i>Count == 0</i> ï¼Œæ¡ä»¶<i>Count &lt;= 0</i>ä¸ºtrueï¼Œåˆ™è¿”å›<i>ç©º</i>å€¼ã€‚ <br><br> åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ä¾‹<i>CommaDelimitedStringCollection.Add</i>æ–¹æ³•æ·»åŠ äº†è¯¥å…ƒç´ ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">new</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ ThrowIfReadOnly(); ThrowIfContainsDelimiter(value); _modified = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; base.Add(value.Trim()); }</code> </pre> <br> åœ¨<i>ThrowIf ...</i>æ–¹æ³•ä¸­æ£€æŸ¥æˆåŠŸï¼Œå¹¶ä¸”è¯¥å…ƒç´ å·²æ·»åŠ åˆ°åŸºæœ¬é›†åˆä¸­ã€‚ å› æ­¤ï¼Œ <i>Count</i>å€¼å˜ä¸º1ã€‚ç°åœ¨å›åˆ°<i>ToString</i>æ–¹æ³•ã€‚ è¡¨è¾¾å¼<i>Countçš„</i>å€¼<i>&lt;= 0</i> - <i>false</i> ï¼Œå› æ­¤è¯¥æ–¹æ³•ä¸è¿”å›å¹¶ä¸”ä»£ç æ‰§è¡Œç»§ç»­ã€‚ éå†å†…éƒ¨é›†åˆï¼Œå°†2ä¸ªå…ƒç´ æ·»åŠ åˆ°<i>StringBuilder</i>ç±»å‹çš„å®ä¾‹-ä¸€ä¸ªç©ºå­—ç¬¦ä¸²å’Œä¸€ä¸ªé€—å·ã€‚ ç»“æœï¼Œç»“æœ<i>sb</i>ä»…åŒ…å«ä¸€ä¸ªé€—å·ï¼Œ <i>Length</i>å±æ€§çš„å€¼åˆ†åˆ«ç­‰äº1ã€‚è¡¨è¾¾å¼<i>sb.Length&gt; 0çš„</i>å€¼ä¸º<i>true</i> ï¼Œæ‰§è¡Œäº†<i>sb.Lengthçš„</i>å‡æ³•å’Œå†™æ“ä½œï¼Œç°åœ¨è¯¥å€¼<i>sb.Lengthçš„of</i>ä¸º0ã€‚è¿™å¯¼è‡´ä»¥ä¸‹äº‹å®ï¼šä»è¯¥æ–¹æ³•å†æ¬¡è¿”å›<i>null</i>å€¼ã€‚ <br><br>  <b>ç¬¬åäº”æœŸ</b> <br><br> çªç„¶ä¹‹é—´ï¼Œæˆ‘æ¸´æœ›ä½¿ç”¨<i>System.Configuration.ConfigurationProperty</i>ç±»ã€‚ è®©æˆ‘ä»¬ä»¥å‚æ•°æ•°é‡æœ€å¤šçš„æ„é€ å‡½æ•°ä¸ºä¾‹ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigurationProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, Type type, object defaultValue, TypeConverter typeConverter, ConfigurationValidatorBase validator, ConfigurationPropertyOptions options, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> description)</span></span></span></span>;</code> </pre> <br> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æœ€åä¸€ä¸ªå‚æ•°çš„æè¿°ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// description: // The description of the configuration entity.</span></span></code> </pre> <br> åœ¨docs.microsoft.comçš„æ„é€ å‡½æ•°è¯´æ˜ä¸­ä¹Ÿå†™æœ‰ç›¸åŒçš„å†…å®¹ã€‚ å¥½ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åœ¨æ„é€ å‡½æ•°çš„ä¸»ä½“ä¸­ä½¿ç”¨æ­¤å‚æ•°ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigurationProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...., </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> description)</span></span></span><span class="hljs-function"> </span></span>{ ConstructorInit(name, type, options, validator, typeConverter); SetDefaultValue(defaultValue); }</code> </pre> <br> ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œè¯¥å‚æ•°æœªä½¿ç”¨ã€‚ <br><br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3117</u></a>æœªä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œ descriptionâ€ã€‚  ConfigurationProperty.cs 62 <br><br> ä¹Ÿè®¸ä»£ç ç¼–å†™è€…æœ‰æ„ä¸ä½¿ç”¨å®ƒï¼Œä½†æ˜¯ç›¸å…³å‚æ•°çš„æè¿°å´éå¸¸æ··ä¹±ã€‚ <br><br>  <b>ç¬¬16æœŸ</b> <br><br> è¿™æ˜¯å¦ä¸€ä¸ªç±»ä¼¼çš„ç‰‡æ®µï¼šå°è¯•è‡ªå·±æ‰¾åˆ°é”™è¯¯ï¼Œæˆ‘åœ¨ä¸‹é¢æä¾›äº†æ„é€ å‡½æ•°çš„ä»£ç ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SectionXmlInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configKey, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> definitionConfigPath, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> targetConfigPath, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> subPath, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lineNumber, object streamVersion, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rawXml, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configSource, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configSourceStreamName, object configSourceStreamVersion, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> protectionProviderName, OverrideModeSetting overrideMode, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> skipInChildApps)</span></span></span><span class="hljs-function"> </span></span>{ ConfigKey = configKey; DefinitionConfigPath = definitionConfigPath; TargetConfigPath = targetConfigPath; SubPath = subPath; Filename = filename; LineNumber = lineNumber; StreamVersion = streamVersion; RawXml = rawXml; ConfigSource = configSource; ConfigSourceStreamName = configSourceStreamName; ProtectionProviderName = protectionProviderName; OverrideModeSetting = overrideMode; SkipInChildApps = skipInChildApps; }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3117</u></a>æœªä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œ configSourceStreamVersionâ€ã€‚  SectionXmlInfo.cs 16 <br><br> æœ‰ä¸€ä¸ªé€‚å½“çš„å±æ€§ï¼Œä½†æ˜¯å¦ç‡åœ°è¯´ï¼Œå®ƒçœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼š <br><br><pre> <code class="cpp hljs">internal object ConfigSourceStreamVersion { <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { } }</code> </pre> <br> é€šå¸¸ï¼Œè¯¥ä»£ç çœ‹èµ·æ¥å¯ç–‘ã€‚ ä¹Ÿè®¸ä¿ç•™å‚æ•°/å±æ€§æ˜¯ä¸ºäº†å®ç°å…¼å®¹æ€§ï¼Œä½†è¿™åªæ˜¯æˆ‘çš„çŒœæµ‹ã€‚ <br><br>  <b>ç¬¬17æœŸ</b> <br><br> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹<i>System.Runtime.WindowsRuntime.UI.Xaml</i>åº“ä¸­çš„æœ‰è¶£å†…å®¹ä»¥åŠåŒåç¨‹åºåŒ…ä»£ç ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepeatBehavior</span></span></span><span class="hljs-class"> :</span></span> IFormattable { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> InternalToString(null, null); } .... }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3108</u></a>ä¸å»ºè®®ä»â€œ ToStingï¼ˆï¼‰â€æ–¹æ³•è¿”å›â€œ nullâ€ã€‚  RepeatBehavior.cs 113 <br><br> æˆ‘ä»¬å·²ç»çŸ¥é“çš„ç†Ÿæ‚‰çš„æ•…äº‹<i>-ToString</i>æ–¹æ³•å¯ä»¥è¿”å›<i>null</i>å€¼ã€‚ å› æ­¤ï¼Œè°ƒç”¨è€…ä»£ç çš„ä½œè€…å¯èƒ½ä¼šä¸æ„‰å¿«åœ°æ„Ÿåˆ°æƒŠè®¶ï¼Œè¯¥è°ƒç”¨è€…çš„ä»£ç å‡å®š<i>RepeatBehavior.ToString</i>å§‹ç»ˆè¿”å›énullå¼•ç”¨ã€‚ åŒæ ·ï¼Œå®ƒä¸Microsoftçš„å‡†åˆ™ç›¸æŠµè§¦ã€‚ <br><br> å¾ˆå¥½ï¼Œä½†æ˜¯è¯¥æ–¹æ³•å¹¶ä¸æ¸…æ¥š<i>ToString</i>å¯ä»¥è¿”å›<i>null-</i>æˆ‘ä»¬éœ€è¦æ›´æ·±å…¥åœ°ç ”ç©¶<i>InternalToString</i>æ–¹æ³•ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InternalToString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> format, IFormatProvider formatProvider)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (_Type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RepeatBehaviorType.Forever: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Forever"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RepeatBehaviorType.Count: StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); sb.AppendFormat( formatProvider, <span class="hljs-string"><span class="hljs-string">"{0:"</span></span> + format + <span class="hljs-string"><span class="hljs-string">"}x"</span></span>, _Count); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RepeatBehaviorType.Duration: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Duration.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } }</code> </pre> <br> åˆ†æå™¨æ£€æµ‹åˆ°ï¼Œå¦‚æœ<i>é»˜è®¤</i>åˆ†æ”¯åœ¨<i>switchä¸­</i>æ‰§è¡Œï¼Œ <i>InternalToString</i>å°†è¿”å›<i>ç©º</i>å€¼ã€‚ å› æ­¤ï¼Œ <i>ToString</i>ä¹Ÿå°†è¿”å›<i>null</i> ã€‚ <br><br>  <i>RepeatBehavior</i>æ˜¯ä¸€ä¸ªå…¬å…±ç»“æ„ï¼Œè€Œ<i>ToString</i>æ˜¯ä¸€ä¸ªå…¬å…±æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•åœ¨å®è·µä¸­é‡ç°è¯¥é—®é¢˜ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»º<i>RepeatBehavior</i>å®ä¾‹ï¼Œä»è¯¥å®ä¾‹è°ƒç”¨<i>ToString</i>æ–¹æ³•ï¼ŒåŒæ—¶ä¸è¦é”™è¿‡<i>_Type</i>ä¸å¾—ç­‰äº<i>RepeatBehaviorType.Forever</i> ï¼Œ <i>RepeatBehaviorType.Count</i>æˆ–<i>RepeatBehaviorType.Duration</i> ã€‚ <br><br>  <i>_Type</i>æ˜¯ç§æœ‰å­—æ®µï¼Œå¯ä»¥é€šè¿‡å…¬å…±å±æ€§è¿›è¡Œåˆ†é…ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepeatBehavior</span></span></span><span class="hljs-class"> :</span></span> IFormattable { .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RepeatBehaviorType _Type; .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> RepeatBehaviorType Type { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Type; } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { _Type = value; } } .... }</code> </pre> <br> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ è®©æˆ‘ä»¬ç»§ç»­å‰è¿›ï¼Œçœ‹çœ‹ä»€ä¹ˆæ˜¯<i>RepeatBehaviorType</i>ç±»å‹ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> RepeatBehaviorType { Count, Duration, Forever }</code> </pre> <br> å¦‚æˆ‘ä»¬æ‰€è§ï¼Œ <i>RepeatBehaviorType</i>æ˜¯æšä¸¾ï¼ŒåŒ…å«æ‰€æœ‰ä¸‰ä¸ªå…ƒç´ ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„<i>switch</i>è¡¨è¾¾å¼æ¶µç›–äº†æ‰€æœ‰è¿™ä¸‰ä¸ªå…ƒç´ ã€‚ ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€é»˜è®¤åˆ†æ”¯ä¸å¯è®¿é—®ã€‚ <br><br> è¦é‡ç°è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬å°†å¯¹<i>System.Runtime.WindowsRuntime.UI.Xaml</i>åŒ…çš„å¼•ç”¨æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯4.3.0ç‰ˆæœ¬ï¼‰ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚ <br><br><pre> <code class="cpp hljs">RepeatBehavior behavior = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RepeatBehavior() { Type = (RepeatBehaviorType)<span class="hljs-number"><span class="hljs-number">666</span></span> }; Console.WriteLine(behavior.ToString() is null);</code> </pre> <br>  <i>True</i>åœ¨æ§åˆ¶å°ä¸­æŒ‰é¢„æœŸæ˜¾ç¤ºï¼Œè¿™æ„å‘³ç€<i>ToString</i>è¿”å›<i>null</i> ï¼Œå› ä¸º<i>_Type</i>ä¸ç­‰äº<i>case</i>åˆ†æ”¯ä¸­çš„ä»»ä½•å€¼ï¼Œå¹¶ä¸”<i>é»˜è®¤</i>åˆ†æ”¯å·²æ¥æ”¶æ§ä»¶ã€‚ é‚£å°±æ˜¯æˆ‘ä»¬æƒ³è¦åšçš„ã€‚ <br><br> æˆ‘ä¹Ÿæƒ³æŒ‡å‡ºï¼Œè¯¥æ–¹æ³•çš„æ³¨é‡Šå’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>docs.microsoft.comå‡æœª</u></a>æŒ‡å®šè¯¥æ–¹æ³•å¯ä»¥è¿”å›<i>ç©º</i>å€¼ã€‚ <br><br>  <b>ç¬¬18æœŸ</b> <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ£€æŸ¥<i>System.Private.DataContractSerializationä¸­çš„</i>ä¸€äº›è­¦å‘Šã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CharType</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte None = <span class="hljs-number"><span class="hljs-number">0x00</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte FirstName = <span class="hljs-number"><span class="hljs-number">0x01</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte Name = <span class="hljs-number"><span class="hljs-number">0x02</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte Whitespace = <span class="hljs-number"><span class="hljs-number">0x04</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte Text = <span class="hljs-number"><span class="hljs-number">0x08</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte AttributeText = <span class="hljs-number"><span class="hljs-number">0x10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte SpecialWhitespace = <span class="hljs-number"><span class="hljs-number">0x20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte Comment = <span class="hljs-number"><span class="hljs-number">0x40</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> byte[] s_charType = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> byte[<span class="hljs-number"><span class="hljs-number">256</span></span>] { .... CharType.None, <span class="hljs-comment"><span class="hljs-comment">/* 9 (.) */</span></span> CharType.None| CharType.Comment| CharType.Comment| CharType.Whitespace| CharType.Text| CharType.SpecialWhitespace, <span class="hljs-comment"><span class="hljs-comment">/* A (.) */</span></span> CharType.None| CharType.Comment| CharType.Comment| CharType.Whitespace| CharType.Text| CharType.SpecialWhitespace, <span class="hljs-comment"><span class="hljs-comment">/* B (.) */</span></span> CharType.None, <span class="hljs-comment"><span class="hljs-comment">/* C (.) */</span></span> CharType.None, <span class="hljs-comment"><span class="hljs-comment">/* D (.) */</span></span> CharType.None| CharType.Comment| CharType.Comment| CharType.Whitespace, <span class="hljs-comment"><span class="hljs-comment">/* E (.) */</span></span> CharType.None, .... };</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3001</u></a>åœ¨'|'çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>CharType.Comment</u></a> 'ã€‚ æ“ä½œå‘˜ã€‚  XmlUTF8TextReader.cs 56 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3001</u></a>åœ¨'|'çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>CharType.Comment</u></a> 'ã€‚ æ“ä½œå‘˜ã€‚  XmlUTF8TextReader.cs 58 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3001</u></a>åœ¨'|'çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>CharType.Comment</u></a> 'ã€‚ æ“ä½œå‘˜ã€‚  XmlUTF8TextReader.cs 64 </li></ul><br> åˆ†æå™¨å‘ç°<i>CharType.Comment | CharType.Comment</i>è¡¨è¾¾å¼çš„ç”¨æ³•å¯ç–‘ã€‚ çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œå¦‚<i>ï¼ˆCharType.Comment | CharType.Commentï¼‰== CharType.Comment</i> ã€‚ åˆå§‹åŒ–ä½¿ç”¨<i>CharType.Commentçš„</i>å…¶ä»–æ•°ç»„å…ƒç´ æ—¶ï¼Œæ²¡æœ‰è¿™æ ·çš„é‡å¤ã€‚ <br><br>  <b>ç¬¬19æœŸ</b> <br><br> è®©æˆ‘ä»¬ç»§ç»­ã€‚ è®©æˆ‘ä»¬åœ¨æ–¹æ³•è¯´æ˜å’Œdocs.microsoft.com-â€œ <u>XmlBinaryWriterSession.TryAddï¼ˆXmlDictionaryStringï¼ŒInt32ï¼‰æ–¹æ³•</u> â€ä¸­æ£€æŸ¥æœ‰å…³<i>XmlBinaryWriterSession.TryAdd</i>æ–¹æ³•çš„è¿”å›å€¼çš„ä¿¡æ¯ï¼š <i>è¿”å›ï¼šå¦‚æœå¯ä»¥æ·»åŠ å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚</i>  <i>å¦åˆ™ä¸ºå‡ã€‚</i> <br><br> ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¯¥æ–¹æ³•çš„ä¸»ä½“ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryAdd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XmlDictionaryString value, out </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key)</span></span></span><span class="hljs-function"> </span></span>{ IntArray keys; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == null) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> System.Runtime .Serialization .DiagnosticUtility .ExceptionUtility .ThrowHelperArgumentNull(nameof(value)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_maps.TryGetValue(value.Dictionary, out keys)) { key = (keys[value.Key] - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key != <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// If the key is already set, then something is wrong throw System.Runtime .Serialization .DiagnosticUtility .ExceptionUtility .ThrowHelperError( new InvalidOperationException( SR.XmlKeyAlreadyExists)); } key = Add(value.Value); keys[value.Key] = (key + 1); return true; } key = Add(value.Value); keys = AddKeys(value.Dictionary, value.Key + 1); keys[value.Key] = (key + 1); return true; }</span></span></code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3009</u></a>å¥‡æ€ªçš„æ˜¯ï¼Œæ­¤æ–¹æ³•å§‹ç»ˆè¿”å›ä¸€ä¸ªç›¸åŒçš„â€œ trueâ€å€¼ã€‚  XmlBinaryWriterSession.cs 29 <br><br> è¯¥æ–¹æ³•è¿”å›<i>true</i>æˆ–å¼•å‘å¼‚å¸¸ä¼¼ä¹å¾ˆå¥‡æ€ªï¼Œä½†æ˜¯æ°¸è¿œä¸ä¼šè¿”å›<i>false</i>å€¼ã€‚ <br><br>  <b>ç¬¬20æœŸ</b> <br><br> æˆ‘é‡åˆ°äº†ç±»ä¼¼é—®é¢˜çš„ä»£ç ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ°æ°ç›¸åï¼Œè¯¥æ–¹æ³•å§‹ç»ˆè¿”å›<i>false</i> ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnHandleReference</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (xmlWriter.depth &lt; depthToCheckCyclicReference) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (canContainCyclicReference) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_byValObjectsInScope.Contains(obj)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; _byValObjectsInScope.Push(obj); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3009</u></a>å¥‡æ€ªçš„æ˜¯ï¼Œæ­¤æ–¹æ³•å§‹ç»ˆè¿”å›ä¸€ä¸ªç›¸åŒçš„'false'å€¼ã€‚  XmlObjectSerializerWriteContext.cs 415 <br><br> å¥½å§ï¼Œæˆ‘ä»¬å·²ç»èµ°äº†å¾ˆé•¿ä¸€æ®µè·¯ï¼ å› æ­¤ï¼Œåœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘å»ºè®®æ‚¨ä¼‘æ¯ä¸€ä¼šå„¿ï¼šæŒ¯å¥‹è‚Œè‚‰ï¼Œå››å¤„èµ°èµ°ï¼Œä¼‘æ¯ä¸€ä¸‹çœ¼ç›ï¼Œçœ‹ç€çª—å¤–... <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/008/d6a/92d/008d6a92d6f4cf4066e744e4c857b47d.png" alt="å›¾ç‰‡24"></div><br> æˆ‘å¸Œæœ›åœ¨è¿™ä¸€ç‚¹ä¸Šæ‚¨å†æ¬¡å……æ»¡æ´»åŠ›ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç»§ç»­ã€‚  :) <br><br>  <b>ç¬¬21æœŸ</b> <br><br> è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹<i>System.Security.Cryptography.Algorithms</i>é¡¹ç›®çš„ä¸€äº›å¼•äººå…¥èƒœçš„ç‰‡æ®µã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> override byte[] GenerateMask(byte[] rgbSeed, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cbReturn) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (HashAlgorithm hasher = (HashAlgorithm)CryptoConfig.CreateFromName(_hashNameValue)) { byte[] rgbCounter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> byte[<span class="hljs-number"><span class="hljs-number">4</span></span>]; byte[] rgbT = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> byte[cbReturn]; uint counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ib = <span class="hljs-number"><span class="hljs-number">0</span></span>; ib &lt; rgbT.Length;) { <span class="hljs-comment"><span class="hljs-comment">// Increment counter -- up to 2^32 * sizeof(Hash) Helpers.ConvertIntToByteArray(counter++, rgbCounter); hasher.TransformBlock(rgbSeed, 0, rgbSeed.Length, rgbSeed, 0); hasher.TransformFinalBlock(rgbCounter, 0, 4); byte[] hash = hasher.Hash; hasher.Initialize(); Buffer.BlockCopy(hash, 0, rgbT, ib, Math.Min(rgbT.Length - ib, hash.Length)); ib += hasher.Hash.Length; } return rgbT; } }</span></span></code> </pre> <br>  <b>PVS-Studioè­¦å‘Šï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u>V3080</u></a>å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œå“ˆå¸Œâ€ã€‚  PKCS1MaskGenerationMethod.cs 37 <br><br> åˆ†æå™¨è­¦å‘Šè¯„ä¼°<i>å“ˆå¸Œå™¨</i>æ—¶ï¼Œ <i>å“ˆå¸Œå™¨</i>å˜é‡çš„å€¼å¯ä»¥ä¸º<i>null</i> <i>TransformBlock</i>è¡¨è¾¾å¼ä¼šå¯¼è‡´<i>NullReferenceException</i>ç±»å‹çš„å¼‚å¸¸ã€‚ ç”±äºè¿‡ç¨‹é—´åˆ†æï¼Œè¯¥è­¦å‘Šçš„å‘ç”Ÿæˆä¸ºå¯èƒ½ã€‚ <br><br> å› æ­¤ï¼Œè¦äº†è§£åœ¨è¿™ç§æƒ…å†µä¸‹<i>hasheræ˜¯å¦</i>å¯ä»¥é‡‡ç”¨<i>null</i>å€¼ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<i>CreateFromName</i>æ–¹æ³•ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFromName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CreateFromName(name, null); }</code> </pre> <br> åˆ°ç›®å‰ä¸ºæ­¢æ²¡æœ‰-è®©æˆ‘ä»¬æ›´æ·±å…¥ã€‚ é‡è½½çš„å…·æœ‰ä¸¤ä¸ªå‚æ•°çš„<i>CreateFromName</i>ç‰ˆæœ¬çš„ä¸»ä½“éå¸¸å¤§ï¼Œå› æ­¤æˆ‘å¼•ç”¨äº†ç®€çŸ­ç‰ˆæœ¬ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFromName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, params object[] args)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (retvalType == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cons == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (candidates.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rci == null || typeof(Delegate).IsAssignableFrom(rci.DeclaringType)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> retval; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æ‚¨æ‰€è§ï¼Œè¯¥æ–¹æ³•ä¸­æœ‰å¤šä¸ªå‡ºå£ç‚¹ï¼Œå…¶ä¸­</font><font style="vertical-align: inherit;">æ˜¾å¼è¿”å›</font><font style="vertical-align: inherit;">äº†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚å› æ­¤ï¼Œè‡³å°‘åœ¨ç†è®ºä¸Šï¼Œåœ¨ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œè¯¥è­¦å‘Šè§¦å‘äº†è­¦å‘Šï¼Œ</font><font style="vertical-align: inherit;">å¯èƒ½ä¼šå‘ç”Ÿ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç†è®ºå¾ˆæ£’ï¼Œä½†è®©æˆ‘ä»¬å°è¯•åœ¨å®è·µä¸­é‡ç°é—®é¢˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å†æ¬¡æŸ¥çœ‹åŸå§‹æ–¹æ³•å¹¶æ³¨æ„è¦ç‚¹ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å°†å‡å°‘æ–¹æ³•ä¸­ä¸ç›¸å…³çš„ä»£ç ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PKCS1MaskGenerationMethod</span></span></span><span class="hljs-class"> :</span></span> .... <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 { .... public PKCS1MaskGenerationMethod() // &lt;= 2 { _hashNameValue = DefaultHash; } .... public override byte[] GenerateMask(byte[] rgbSeed, int cbReturn) // &lt;= 3 { using (HashAlgorithm hasher = (HashAlgorithm)CryptoConfig.CreateFromName(_hashNameValue)) // &lt;= 4 { byte[] rgbCounter = new byte[4]; byte[] rgbT = new byte[cbReturn]; // &lt;= 5 uint counter = 0; for (int ib = 0; ib &lt; rgbT.Length;) // &lt;= 6 { .... Helpers.ConvertIntToByteArray(counter++, rgbCounter); // &lt;= 7 hasher.TransformBlock(rgbSeed, 0, rgbSeed.Length, rgbSeed, 0); .... } .... } } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹å…³é”®ç‚¹ï¼š</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1ï¼Œ3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¯¥ç±»å’Œæ–¹æ³•å…·æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¬å…±</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¿é—®ä¿®é¥°ç¬¦ã€‚å› æ­¤ï¼Œå½“æ·»åŠ å¯¹åº“çš„å¼•ç”¨æ—¶ï¼Œæ­¤æ¥å£å¯ç”¨-æˆ‘ä»¬å¯ä»¥å°è¯•é‡ç°æ­¤é—®é¢˜ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¯¥ç±»æ˜¯éæŠ½è±¡å®ä¾‹ï¼Œå…·æœ‰å…¬å…±æ„é€ å‡½æ•°ã€‚åˆ›å»ºå®ä¾‹å°†å¾ˆå®¹æ˜“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒã€‚åœ¨æˆ‘è®¤ä¸ºçš„æŸäº›æƒ…å†µä¸‹ï¼Œç±»æ˜¯æŠ½è±¡çš„ï¼Œå› æ­¤è¦é‡ç°è¯¥é—®é¢˜ï¼Œæˆ‘å¿…é¡»æœç´¢ç»§æ‰¿è€…å’Œè·å–å®ƒä»¬çš„æ–¹æ³•ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å¾—ç”Ÿæˆä»»ä½•å¼‚å¸¸ï¼Œå¹¶ä¸”å¿…é¡»è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œæˆ‘ä»¬ç¨åä¼šå†è®²ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5ã€6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è¯¥çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼å¿…é¡»&gt; 0ï¼ˆä½†æ˜¯ï¼Œåœ¨æˆåŠŸåˆ›å»ºæ•°ç»„çš„é€‚å½“èŒƒå›´å†…ï¼‰ã€‚</font><font style="vertical-align: inherit;">çš„åˆè§„æ€§</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn&gt; 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¡ä»¶æ˜¯éœ€è¦çš„æ¡ä»¶çš„è¿›ä¸€æ­¥çš„æ»¡è¶³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IB &lt;rgbT.Length</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œç¯å›è¾“å…¥åˆ°æ—§ä½“ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helpres.ConvertIntToByteArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…é¡»æ­£å¸¸å·¥ä½œã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†æ»¡è¶³ä¾èµ–äºæ–¹æ³•å‚æ•°çš„æ¡ä»¶ï¼Œä»…ä¼ é€’é€‚å½“çš„å‚æ•°å°±è¶³å¤Ÿäº†ï¼Œä¾‹å¦‚ï¼š</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rgbCeed-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°å­—èŠ‚[] {0ï¼Œ1ï¼Œ2ï¼Œ3};</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -42ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†â€œ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å–æ¶ˆä¿¡ç”¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ </font><i><font style="vertical-align: inherit;">CryptoConfig.CreateFromName</font></i><font style="vertical-align: inherit;">æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿæ›´æ”¹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_hashNameValue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µ</font><font style="vertical-align: inherit;">çš„å€¼</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰äº†å®ƒï¼Œå› ä¸ºè¯¥ç±»ä¸ºæ­¤å­—æ®µå®šä¹‰äº†åŒ…è£…å™¨å±æ€§ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> HashName { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _hashNameValue; } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { _hashNameValue = value ?? DefaultHash; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HashName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¾ç½®ä¸€ä¸ªâ€œåˆæˆâ€å€¼</font><font style="vertical-align: inherit;">ï¼ˆå³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_hashNameValueï¼‰ï¼Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å¯ä»¥</font><font style="vertical-align: inherit;">åœ¨æ ‡è®°çš„ç¬¬ä¸€ä¸ªå‡ºå£ç‚¹</font><font style="vertical-align: inherit;">çš„</font><i><font style="vertical-align: inherit;">CreateFromName</font></i><font style="vertical-align: inherit;">æ–¹æ³•ä¸­</font><font style="vertical-align: inherit;">è·å–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç”±äºè¯¥æ–¹æ³•å¾ˆå¤§ï¼Œå› æ­¤æˆ‘ä¸ä¼šè¯¦ç»†åˆ†æè¯¥æ–¹æ³•ï¼ˆå¸Œæœ›æ‚¨å¯¹æ­¤å®½æ•ï¼‰ã€‚</font><font style="vertical-align: inherit;">ç»“æœï¼Œå¯¼è‡´</font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">å¼‚å¸¸çš„ä»£ç </font><font style="vertical-align: inherit;">å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs">PKCS1MaskGenerationMethod tempObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PKCS1MaskGenerationMethod(); tempObj.HashName = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span>; tempObj.GenerateMask(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> byte[] { <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> }, <span class="hljs-number"><span class="hljs-number">42</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç°åœ¨ï¼Œæˆ‘ä»¬æ·»åŠ å¯¹è°ƒè¯•åº“çš„å¼•ç”¨ï¼Œè¿è¡Œä»£ç å¹¶è·å¾—é¢„æœŸçš„ç»“æœï¼š </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ab/384/8e5/2ab3848e542172cd92a7e03f55bba9fe.png" alt="å›¾ç‰‡10"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åªæ˜¯ä¸ºäº†å¥½ç©ï¼Œæˆ‘å°è¯•ä½¿ç”¨4.3.1ç‰ˆæœ¬çš„NuGetåŒ…æ‰§è¡Œç›¸åŒçš„ä»£ç ã€‚ </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b4/a94/766/7b4a947666444496ca077e7530415c76.png" alt="å›¾ç‰‡14"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•æè¿°ä¸­æ²¡æœ‰æœ‰å…³ç”Ÿæˆçš„å¼‚å¸¸ï¼Œè¾“å‡ºå‚æ•°é™åˆ¶çš„ä¿¡æ¯ã€‚</font><font style="vertical-align: inherit;">Docs.microsoft.com </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKCS1MaskGenerationMethod.GenerateMaskï¼ˆByte []ï¼ŒInt32ï¼‰æ–¹æ³•</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€œä¹ŸæœªæŒ‡å®šã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡ºä¾¿è¯´ä¸€å¥ï¼Œåœ¨æ’°å†™æœ¬æ–‡å¹¶æè¿°é‡ç°é—®é¢˜çš„æ“ä½œé¡ºåºæ—¶ï¼Œæˆ‘å‘ç°äº†å¦å¤–ä¸¤ç§æ–¹æ³•â€œä¸­æ–­â€æ­¤æ–¹æ³•ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼ é€’å¤ªå¤§çš„å€¼ä½œä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°ï¼›</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ä½œä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rgbSeedä¼ é€’ã€‚</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è·å¾—</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OutOfMemoryException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c50/474/7f9/c504747f9a771843da10a128866811dd.png" alt="å›¾ç‰‡15"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œ</font><font style="vertical-align: inherit;">æ‰§è¡Œ</font><i><font style="vertical-align: inherit;">rgbSeed.Length</font></i><font style="vertical-align: inherit;">è¡¨è¾¾å¼</font><font style="vertical-align: inherit;">æ—¶</font><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬å°†è·å¾—</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‡è¦çš„æ˜¯ï¼Œ</font><i><font style="vertical-align: inherit;">å“ˆå¸Œ</font></i><font style="vertical-align: inherit;">å€¼å¿…é¡»ä¸ºénullã€‚</font><font style="vertical-align: inherit;">å¦åˆ™ï¼Œæ§åˆ¶æµå°†ä¸ä¼šåˆ°è¾¾</font><i><font style="vertical-align: inherit;">rgbSeed.Length</font></i><font style="vertical-align: inherit;">ã€‚</font><b><font style="vertical-align: inherit;">ç¬¬22æœŸ</font></b><font style="vertical-align: inherit;">æˆ‘é‡åˆ°äº†ä¸¤ä¸ªç±»ä¼¼çš„åœ°æ–¹ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignatureDescription</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> FormatterAlgorithm { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> DeformatterAlgorithm { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SignatureDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> AsymmetricSignatureDeformatter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDeformatter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( AsymmetricAlgorithm key)</span></span></span><span class="hljs-function"> </span></span>{ AsymmetricSignatureDeformatter item = (AsymmetricSignatureDeformatter) CryptoConfig.CreateFromName(DeformatterAlgorithm); item.SetKey(key); <span class="hljs-comment"><span class="hljs-comment">// &lt;= return item; } public virtual AsymmetricSignatureFormatter CreateFormatter( AsymmetricAlgorithm key) { AsymmetricSignatureFormatter item = (AsymmetricSignatureFormatter) CryptoConfig.CreateFromName(FormatterAlgorithm); item.SetKey(key); // &lt;= return item; } .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚</font><font style="vertical-align: inherit;">è€ƒè™‘æ£€æŸ¥â€œé¡¹ç›®â€ã€‚</font><font style="vertical-align: inherit;">SignatureDescription.cs 31</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚</font><font style="vertical-align: inherit;">è€ƒè™‘æ£€æŸ¥â€œé¡¹ç›®â€ã€‚</font><font style="vertical-align: inherit;">ç­¾åè¯´æ˜.cs 38</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒæ ·ï¼Œåœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FormatterAlgorithm</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeformatterAlgorithm</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±æ€§ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è¿™æ ·çš„å€¼ï¼Œå¯¹äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptoConfig.CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼Œåœ¨</font><i><font style="vertical-align: inherit;">CreateDeformatter</font></i><font style="vertical-align: inherit;">å’Œ</font><i><font style="vertical-align: inherit;">CreateFormatter</font></i><font style="vertical-align: inherit;">æ–¹æ³•ä¸­</font><font style="vertical-align: inherit;">ï¼Œå®ƒä»¬å°†</font><font style="vertical-align: inherit;">è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">ã€‚æ­¤å¤–ï¼Œåœ¨è°ƒç”¨</font><i><font style="vertical-align: inherit;">SetKey</font></i><font style="vertical-align: inherit;">å®ä¾‹æ–¹æ³•æ—¶ï¼Œ</font><font style="vertical-align: inherit;">å°†ç”Ÿæˆ</font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;">å¼‚å¸¸ã€‚åŒæ ·ï¼Œè¯¥é—®é¢˜åœ¨å®è·µä¸­å¾ˆå®¹æ˜“é‡ç°ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs">SignatureDescription signature = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SignatureDescription() { DeformatterAlgorithm = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span>, FormatterAlgorithm = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span> }; signature.CreateDeformatter(null); <span class="hljs-comment"><span class="hljs-comment">// NRE signature.CreateFormatter(null); // NRE</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨è°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateDeformatter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥åŠè°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFormatteræ—¶</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå°†</font><font style="vertical-align: inherit;">å¼•å‘</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹çš„å¼‚å¸¸ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬23æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Private.Xml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ä¸­</font><font style="vertical-align: inherit;">æœ‰è¶£çš„ç‰‡æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteBase64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte[] buffer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_inAttr &amp;&amp; (_inCDataSection || StartCDataSection())) _wrapped.WriteBase64(buffer, index, count); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> _wrapped.WriteBase64(buffer, index, count); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004'then</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'è¯­å¥ç­‰æ•ˆäº'else'è¯­å¥ã€‚</font><font style="vertical-align: inherit;">QueryOutputWriterV1.cs 242 </font><i><font style="vertical-align: inherit;">if</font></i><font style="vertical-align: inherit;">è¯­å¥çš„</font><i><font style="vertical-align: inherit;">then</font></i><font style="vertical-align: inherit;">å’Œ</font><i><font style="vertical-align: inherit;">else</font></i><font style="vertical-align: inherit;">åˆ†æ”¯</font><font style="vertical-align: inherit;">åŒ…å«ç›¸åŒçš„ä»£ç </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çœ‹èµ·æ¥å¾ˆå¥‡æ€ª</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤„æœ‰é”™è¯¯ï¼Œå¹¶ä¸”å¿…é¡»åœ¨å…¶ä¸­ä¸€ä¸ªåˆ†æ”¯ä¸­æ‰§è¡Œå¦ä¸€é¡¹æ“ä½œï¼Œæˆ–è€…</font><font style="vertical-align: inherit;">å¯ä»¥çœç•¥</font><i><font style="vertical-align: inherit;">if</font></i><font style="vertical-align: inherit;">è¯­å¥ã€‚</font><b><font style="vertical-align: inherit;">ç¬¬24æœŸ</font></b></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Depends</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XmlSchemaObject item, ArrayList refs)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content is XmlSchemaSimpleTypeRestriction) { baseType = ((XmlSchemaSimpleTypeRestriction)content).BaseType; baseName = ((XmlSchemaSimpleTypeRestriction)content).BaseTypeName; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content is XmlSchemaSimpleTypeList) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content is XmlSchemaSimpleTypeRestriction) { baseName = ((XmlSchemaSimpleTypeRestriction)content).BaseTypeName; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == typeof(XmlSchemaSimpleTypeUnion)) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3003æ£€æµ‹åˆ°</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨'ifï¼ˆAï¼‰{...} else ifï¼ˆAï¼‰{...}'æ¨¡å¼ã€‚</font><font style="vertical-align: inherit;">å­˜åœ¨é€»è¾‘é”™è¯¯çš„å¯èƒ½æ€§ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š381ï¼Œ396ã€‚ImportContext.cs 381 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if-else-if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åºåˆ—ä¸­ï¼Œæœ‰ä¸¤ä¸ªç›¸ç­‰çš„æ¡ä»¶è¡¨è¾¾å¼- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†…å®¹ä¸ºXmlSchemaSimpleTypeRestriction</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”ï¼Œ</font><font style="vertical-align: inherit;">å„ä¸ªè¯­å¥</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æ”¯çš„</font><font style="vertical-align: inherit;">ä¸»ä½“</font><font style="vertical-align: inherit;">åŒ…å«ä¸€ç»„ä¸åŒçš„è¡¨è¾¾å¼ã€‚</font><font style="vertical-align: inherit;">æ— è®ºå¦‚ä½•ï¼Œç¬¬ä¸€ä¸ªç›¸å…³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æ”¯</font><font style="vertical-align: inherit;">çš„ä¸»ä½“</font><font style="vertical-align: inherit;">å°†è¢«æ‰§è¡Œï¼ˆå¦‚æœæ¡ä»¶è¡¨è¾¾å¼ä¸ºtrueï¼‰ï¼Œæˆ–è€…å¦‚æœç›¸å…³è¡¨è¾¾å¼ä¸ºfalse </font><i><font style="vertical-align: inherit;">åˆ™ä¸</font></i><font style="vertical-align: inherit;">æ‰§è¡Œã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬25æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¸ºäº†ä½¿åœ¨ä¸‹ä¸€ä¸ªæ–¹æ³•ä¸­æœç´¢é”™è¯¯æ›´å¼•äººå…¥èƒœï¼Œæˆ‘å°†å¼•ç”¨æ•´ä¸ªæ­£æ–‡ã€‚ </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchesXmlType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IList&lt;XPathItem&gt; seq, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> indexType)</span></span></span><span class="hljs-function"> </span></span>{ XmlQueryType typBase = GetXmlType(indexType); XmlQueryCardinality card; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (seq.Count) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: card = XmlQueryCardinality.Zero; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: card = XmlQueryCardinality.One; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: card = XmlQueryCardinality.More; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(card &lt;= typBase.Cardinality)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; typBase = typBase.Prime; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; seq.Count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!CreateXmlType(seq[<span class="hljs-number"><span class="hljs-number">0</span></span>]).IsSubtypeOf(typBase)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨å·²åº”ä»˜-æ­å–œï¼</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœä¸æ˜¯ï¼Œè¯·ä½¿ç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-PVS</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Studioè¿›è¡Œæ•‘æ´ï¼š</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;">V3102</font></u></a><font style="vertical-align: inherit;">é€šè¿‡å¾ªç¯å†…çš„å¸¸é‡ç´¢å¼•å¯ç–‘è®¿é—®â€œ seqâ€å¯¹è±¡çš„å…ƒç´ ã€‚ XmlQueryRuntime.cs 738 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨äº</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ªç¯è¢«æ‰§è¡Œæ—¶ï¼Œè¡¨è¾¾</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘&lt;seq.Count</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¢«ç”¨ä½œä¸æ‰€è¿°ä¸€ä¸ªçš„é€€å‡ºæ¡ä»¶ã€‚å®ƒæå‡ºäº†å¼€å‘äººå‘˜è¦ç»•è¿‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åºåˆ—</font><font style="vertical-align: inherit;">çš„æƒ³æ³•</font><font style="vertical-align: inherit;">ã€‚ä½†æ˜¯åœ¨å¾ªç¯ä¸­ï¼Œä½œè€…è®¿é—®åºåˆ—å…ƒç´ ä¸æ˜¯é€šè¿‡ä½¿ç”¨counter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-seq [i]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè€Œæ˜¯ä½¿ç”¨æ•°å­—æ–‡å­—-é›¶ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬26æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹ä¸€ä¸ªé”™è¯¯ä»…é€‚ç”¨äºä¸€å°æ®µä»£ç ï¼Œä½†è¿™åŒæ ·æœ‰è¶£ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ WriteValue(value); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVSçš„å·¥ä½œå®¤é¢„è­¦ï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å¯èƒ½æ— é™é€’å½’å†…â€œWriteValueâ€çš„æ–¹æ³•ã€‚ XmlAttributeCache.cs 166 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥æ–¹æ³•è°ƒç”¨è‡ªèº«ï¼Œå½¢æˆæ²¡æœ‰é€€å‡ºæ¡ä»¶çš„é€’å½’ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬27æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IList&lt;XPathNavigator&gt; DocOrderDistinct(IList&lt;XPathNavigator&gt; seq) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (seq.Count &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> seq; XmlQueryNodeSequence nodeSeq = (XmlQueryNodeSequence)seq; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nodeSeq == null) nodeSeq = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XmlQueryNodeSequence(seq); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> nodeSeq.DocOrderDistinct(_docOrderCmp); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'seq'å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š880ã€884ã€‚XmlQueryRuntime.cs 880 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥æ–¹æ³•å¯ä»¥è·å–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ä½œä¸ºå‚æ•°ã€‚å› æ­¤ï¼Œåœ¨è®¿é—®</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Count</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å±æ€§æ—¶ï¼Œ</font><font style="vertical-align: inherit;">å°†ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚åœ¨å˜é‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodeSeq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹æ–¹</font><font style="vertical-align: inherit;">è¿›è¡Œæ£€æŸ¥ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodeSeq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯é€šè¿‡æ˜¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼ºåˆ¶è½¬æ¢è·å¾—çš„ï¼Œä½†å°šä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¿›è¡Œæ£€æŸ¥ã€‚å¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™ç”±äºå¼‚å¸¸ï¼Œæ§åˆ¶æµå°†æ— æ³•è¿›è¡Œæ­¤æ£€æŸ¥ã€‚å¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ä¸æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç„¶åï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœå¼ºåˆ¶è½¬æ¢å¤±è´¥ï¼Œ</font><font style="vertical-align: inherit;">åˆ™å°†ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidCastException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ï¼›</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœè½¬æ¢æˆåŠŸï¼Œåˆ™</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodeSeq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»å¯¹ä¸æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬28æœŸï¼Œ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘é‡åˆ°äº†4ä¸ªæ„é€ å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«æœªä½¿ç”¨çš„å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ä¹Ÿè®¸ï¼Œå®ƒä»¬æ˜¯å‡ºäºå…¼å®¹æ€§è€ƒè™‘ï¼Œä½†æˆ‘å‘ç°è¿™äº›æœªä½¿ç”¨çš„å‚æ•°æ²¡æœ‰å…¶ä»–æ³¨é‡Šã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœªä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œ securityUrlâ€ã€‚</font><font style="vertical-align: inherit;">XmlSecureResolver.cs 15</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœªä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œ strdataâ€ã€‚</font><font style="vertical-align: inherit;">XmlEntity.cs 18</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œä½ç½®â€ã€‚</font><font style="vertical-align: inherit;">ç¼–è¯‘.cs 58</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œ accessâ€ã€‚</font><font style="vertical-align: inherit;">XmlSerializationILGen.cs 38</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€ä¸ªå¯¹æˆ‘æœ€æ„Ÿå…´è¶£ï¼ˆè‡³å°‘å®ƒè¿›å…¥äº†æœ¬æ–‡çš„è­¦å‘Šåˆ—è¡¨ï¼‰ã€‚</font><font style="vertical-align: inherit;">æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Ÿ</font><font style="vertical-align: inherit;">ä¸çŸ¥é“ </font><font style="vertical-align: inherit;">ä¹Ÿè®¸æ˜¯å®ƒçš„åå­—ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">XmlSecureResolver</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XmlResolver resolver, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> securityUrl)</span></span></span><span class="hljs-function"> </span></span>{ _resolver = resolver; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åªæ˜¯å‡ºäºå…´è¶£ï¼Œæˆ‘æ£€æŸ¥äº†docs.microsoft.comä¸Š</font><font style="vertical-align: inherit;">æœ‰å…³</font><i><font style="vertical-align: inherit;">securityUrl</font></i><font style="vertical-align: inherit;">å‚æ•°çš„</font><font style="vertical-align: inherit;">å†…å®¹</font><font style="vertical-align: inherit;">-â€œ </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XmlSecureResolveræ„é€ å‡½æ•°</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ </font><font style="vertical-align: inherit;">ï¼š</font><i><font style="vertical-align: inherit;">ç”¨äºåˆ›å»ºå°†åº”ç”¨äºåŸºç¡€XmlResolverçš„PermissionSetçš„URLã€‚ XmlSecureResolveråœ¨åŸºç¡€XmlResolverä¸Šè°ƒç”¨GetEntityï¼ˆUriï¼ŒStringï¼ŒTypeï¼‰ä¹‹å‰ï¼Œåœ¨åˆ›å»ºçš„PermissionSetä¸Šè°ƒç”¨PermitOnlyï¼ˆï¼‰ã€‚</font></i><b><font style="vertical-align: inherit;">é—®é¢˜29</font></b><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">System.Private.Uri</font></i><font style="vertical-align: inherit;">åŒ…ä¸­ï¼Œæˆ‘æ‰¾åˆ°äº†è¯¥æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ²¡æœ‰å®Œå…¨éµå¾ªMicrosoftå…³äº</font><i><font style="vertical-align: inherit;">ToString</font></i><font style="vertical-align: inherit;">æ–¹æ³•è¦†ç›–çš„</font><font style="vertical-align: inherit;">å‡†åˆ™</font><font style="vertical-align: inherit;">ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦å›é¡¾é¡µé¢â€œ </font><u><font style="vertical-align: inherit;">Object.ToString Method</font></u><font style="vertical-align: inherit;"> â€ </font><font style="vertical-align: inherit;">ä¸­çš„æç¤ºä¹‹ä¸€</font><font style="vertical-align: inherit;">ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <i><font style="vertical-align: inherit;"></font></i> <br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨çš„ToStringï¼ˆï¼‰é‡å†™ä¸åº”å¼•å‘å¼‚å¸¸</font></font></i></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¢«è¦†ç›–çš„æ–¹æ³•æœ¬èº«çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_username.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; _password.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UriFormatException(SR.net_uri_BadUserPassword); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3108</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å»ºè®®ä»â€œ ToStingï¼ˆï¼‰â€æ–¹æ³•å¼•å‘å¼‚å¸¸ã€‚</font><font style="vertical-align: inherit;">UriBuilder.cs 406 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„ä¸‹é¢çš„ä»£ç é¦–å…ˆè®¾ç½®ä¸€ä¸ªç©ºï¼šå­—ç¬¦ä¸²ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_username</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µå’Œä¸€ä¸ªéç©ºçš„ä¸€ä¸ªå¯¹æ‰€è¿°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_password</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µåˆ†åˆ«é€šè¿‡å±æ€§å…¬å…±</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„ç”¨æˆ·å</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯†ç ã€‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹‹åï¼Œå®ƒå°†è°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">æœ€ç»ˆï¼Œæ­¤ä»£ç å°†è·å¾—å¼‚å¸¸ã€‚</font><font style="vertical-align: inherit;">æ­¤ç±»ä»£ç çš„ç¤ºä¾‹ï¼š</font></font><br><br><pre> <code class="cpp hljs">UriBuilder uriBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UriBuilder() { UserName = String.Empty, Password = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span> }; String stringRepresentation = uriBuilder.ToString(); Console.WriteLine(stringRepresentation);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¼€å‘äººå‘˜ä¼šè¯šå®åœ°è­¦å‘Šè°ƒç”¨å¯èƒ½ä¼šå¯¼è‡´å¼‚å¸¸ã€‚</font><font style="vertical-align: inherit;">åœ¨å¯¹è¯¥æ–¹æ³•çš„æ³¨é‡Šä»¥åŠdocs.microsoft.com-â€œ </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UriBuilder.ToStringæ–¹æ³•</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ </font><font style="vertical-align: inherit;">ä¸­å¯¹æ­¤è¿›è¡Œäº†æè¿°</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬30ç‰ˆ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŸ¥çœ‹åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Data.Common</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ä»£ç </font><font style="vertical-align: inherit;">ä¸Šå‘å¸ƒçš„è­¦å‘Š</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ArrayList _tables; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableName, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ns)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_tables.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (DataTable)_tables[<span class="hljs-number"><span class="hljs-number">0</span></span>]; .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯èƒ½ç´¢å¼•è¶…å‡ºèŒƒå›´ã€‚</font><font style="vertical-align: inherit;">ç´¢å¼•â€œ 0â€æŒ‡å‘â€œ _tablesâ€ç•Œé™ä¹‹å¤–ã€‚</font><font style="vertical-align: inherit;">XMLDiffLoader.cs 277 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ®µä»£ç çœ‹èµ·æ¥å¼‚å¸¸å—ï¼Ÿ</font><font style="vertical-align: inherit;">æ‚¨è®¤ä¸ºæ˜¯ä»€ä¹ˆï¼Ÿ</font><font style="vertical-align: inherit;">ä¸€ç§å¼‚å¸¸çš„æ–¹å¼æ¥ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArgumentOutOfRangeException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ï¼Ÿ</font><font style="vertical-align: inherit;">æˆ‘ä¸ä¼šä¸ºè¿™ç§æ–¹æ³•æ„Ÿåˆ°æƒŠè®¶ã€‚</font><font style="vertical-align: inherit;">æ€»ä½“è€Œè¨€ï¼Œè¿™æ˜¯éå¸¸å¥‡æ€ªå’Œå¯ç–‘çš„ä»£ç ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬31æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal XmlNodeOrder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComparePosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XPathNodePointer other)</span></span></span><span class="hljs-function"> </span></span>{ RealFoliate(); other.RealFoliate(); Debug.Assert(other != null); .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨éªŒè¯æ˜¯å¦ä¸ºç©ºä¹‹å‰ä½¿ç”¨äº†â€œå…¶ä»–â€å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š1095ï¼Œ1096ã€‚XPathNodePointer.cs 1095 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otherï¼= Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug.Assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">çš„å‚æ•°ï¼Œè¿™</font><font style="vertical-align: inherit;">è¡¨æ˜</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ComparePosition</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•å¯ä»¥è·å–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ä½œä¸ºå‚æ•°ã€‚</font><font style="vertical-align: inherit;">è‡³å°‘ï¼Œç›®çš„æ˜¯è¦æŠ“ä½è¿™ç§æƒ…å†µã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯åŒæ—¶ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other.RealFoliate</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ä¾‹æ–¹æ³•</font><font style="vertical-align: inherit;">ä¸Šæ–¹çš„è¡Œ</font><font style="vertical-align: inherit;">è¢«è°ƒç”¨ã€‚</font><font style="vertical-align: inherit;">ç»“æœï¼Œå¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…·æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ï¼Œ</font><font style="vertical-align: inherit;">åˆ™åœ¨é€šè¿‡</font><i><font style="vertical-align: inherit;">Assert</font></i><font style="vertical-align: inherit;">æ£€æŸ¥ä¹‹å‰ï¼Œå°†ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬32æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> PropertyDescriptorCollection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetProperties</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Attribute[] attributes)</span></span></span><span class="hljs-function"> </span></span>{ .... foreach (Attribute attribute in attributes) { Attribute attr = property.Attributes[attribute.GetType()]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (attr == null &amp;&amp; !attribute.IsDefaultAttribute()) || !attr.Match(attribute)) { match = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯èƒ½ä¸ºç©ºçš„å–æ¶ˆå¼•ç”¨ã€‚è€ƒè™‘æ£€æŸ¥â€œ attrâ€ã€‚ DbConnectionStringBuilder.cs 534 </font><i><font style="vertical-align: inherit;">if</font></i><font style="vertical-align: inherit;">è¯­å¥çš„</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¡ä»¶è¡¨è¾¾å¼</font><font style="vertical-align: inherit;">çœ‹èµ·æ¥éå¸¸å¯ç–‘ã€‚</font><i><font style="vertical-align: inherit;">Match</font></i><font style="vertical-align: inherit;">æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•ã€‚æ ¹æ®check </font><i><font style="vertical-align: inherit;">attr == null</font></i><font style="vertical-align: inherit;">ï¼Œ</font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">æ˜¯æ­¤å˜é‡çš„å¯æ¥å—ï¼ˆé¢„æœŸï¼‰å€¼ã€‚å› æ­¤ï¼Œå¦‚æœæ§åˆ¶æµåˆ°è¾¾||çš„æ­£ç¡®æ“ä½œæ•°è¿ç®—ç¬¦ï¼ˆå¦‚æœ</font><i><font style="vertical-align: inherit;">attr</font></i><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">ï¼‰ï¼Œæˆ‘ä»¬å°†è·å¾—</font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œå¼‚å¸¸å‘ç”Ÿçš„æ¡ä»¶å¦‚ä¸‹ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><ol><li> The value of <i>attr</i> â€” <i>null</i> . The right operand of the &amp;&amp; operator is evaluated. </li><li> The value of <i>!attribute.IsDefaultAttribute()</i> â€” <i>false</i> . The overall result of the expression with the &amp;&amp; operator â€” <i>false</i> . </li><li> Since the left operand of the || operator is of the <i>false</i> value, the right operand is evaluated. </li><li> Since <i>attr</i> â€” <i>null</i> , when calling the <i>Match</i> method, an exception is generated. </li></ol><br> <b>Issue 33</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadOldRowData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DataSet ds, ref DataTable table, ref </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pos, XmlReader row)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (table == null) { row.Skip(); <span class="hljs-comment"><span class="hljs-comment">// need to skip this element if we dont know about it, // before returning -1 return -1; } .... if (table == null) throw ExceptionBuilder.DiffgramMissingTable( XmlConvert.DecodeName(row.LocalName)); .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰ä¸¤ä¸ªå¸¦æœ‰ç›¸åŒæ¡ä»¶è¡¨è¾¾å¼çš„'if'è¯­å¥ã€‚ç¬¬ä¸€ä¸ª'if'è¯­å¥åŒ…å«æ–¹æ³•returnã€‚è¿™æ„å‘³ç€ç¬¬äºŒä¸ª'if'è¯­å¥æ˜¯æ¯«æ— æ„ä¹‰çš„XMLDiffLoader.cs301ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰ä¸¤ä¸ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥åŒ…å«ç›¸ç­‰çš„expression- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">table == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ä¸ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç„¶å</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™äº›è¯­å¥çš„åˆ†æ”¯åŒ…å«ä¸åŒçš„åŠ¨ä½œ-åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œä¸è¯¥å€¼çš„æ–¹æ³•é€€å‡º-1ï¼Œåœ¨ç¬¬äºŒä¸ª-ç”Ÿæˆå¼‚å¸¸ã€‚çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥è¡¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡æ²¡æœ‰æ”¹å˜ç”¨äºæ£€æŸ¥ä¹‹é—´ã€‚å› æ­¤ï¼Œä¸ä¼šç”Ÿæˆè€ƒè™‘çš„å¼‚å¸¸ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬34æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»</font><i><font style="vertical-align: inherit;">System.ComponentModel</font></i><font style="vertical-align: inherit;">çœ‹æœ‰è¶£çš„æ–¹æ³•</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ç±»å‹è½¬æ¢å™¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ã€‚å¥½å§ï¼Œè®©æˆ‘ä»¬å…ˆé˜…è¯»æ³¨é‡Šï¼Œå¹¶å¯¹å…¶è¿›è¡Œæè¿°ï¼š</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ä¸­åˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦ã€‚ ï¼ˆåˆ é™¤è™šæ‹Ÿå­—ç¬¦ä¸²ä¸­çš„æœ€åä¸€ä¸ªå­—ç¬¦ï¼‰ã€‚é€€å‡ºæ—¶ï¼Œoutå‚æ•°åŒ…å«å®é™…æ‰§è¡Œæ“ä½œçš„ä½ç½®ã€‚æ­¤ä½ç½®ç›¸å¯¹äºæµ‹è¯•å­—ç¬¦ä¸²ã€‚ MaskedTextResultHintè¾“å‡ºå‚æ•°å¯æä¾›æœ‰å…³æ“ä½œç»“æœçš„æ›´å¤šä¿¡æ¯ã€‚</font></font></i> <font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">æˆåŠŸ</font></i><i><font style="vertical-align: inherit;">è¿”å›</font></i></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font></i> <font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">å¦åˆ™</font></i><i><font style="vertical-align: inherit;">è¿”å›</font></i></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”å›å€¼çš„å…³é”®ç‚¹ï¼šå¦‚æœæ“ä½œæˆåŠŸï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¦åˆ™</font><font style="vertical-align: inherit;">è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®é™…ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Remove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(out </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> testPosition, out MaskedTextResultHint resultHint)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lastAssignedPos == INVALID_INDEX) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// nothing to remove. } .... return true; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥‡æ€ªçš„æ˜¯ï¼Œæ­¤æ–¹æ³•å§‹ç»ˆè¿”å›ä¸€ä¸ªç›¸åŒçš„â€œ trueâ€å€¼ã€‚ MaskedTextProvider.cs 1529 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…ä¸Šï¼Œäº‹å®è¯æ˜è¯¥æ–¹æ³•çš„å”¯ä¸€è¿”å›å€¼ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬35æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_table != null) { .... } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_table.fInitInProgress &amp;&amp; _delayLoadingConstraints != null) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨éªŒè¯ä¸ºç©ºåä½¿ç”¨äº†'_table'å¯¹è±¡ã€‚æ£€æŸ¥çº¿è·¯ï¼š437ï¼Œ423 ConstraintCollection.cs 437 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼_table = NULL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥ä¸è¨€è‡ªæ˜-åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Î³_è¡¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡å¯ä»¥æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å€¼ã€‚è‡³å°‘åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç ä½œè€…å¯ä»¥å¾—åˆ°é‡æ–°ä¿é™©ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬åœ¨ä¸‹é¢é€šè¿‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_table</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤„ç†å®ä¾‹å­—æ®µï¼Œ</font><font style="vertical-align: inherit;">ä½†ä¸æ£€æŸ¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_table .fInitInProgress</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬36æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.Serialization.Formatters</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®</font><font style="vertical-align: inherit;">çš„ä»£ç å‘å‡ºçš„ä¸€äº›è­¦å‘Š</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (memberNameInfo != null) { .... _serWriter.WriteObjectEnd(memberNameInfo, typeNameInfo); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((objectInfo._objectId == _topId) &amp;&amp; (_topName != null)) { _serWriter.WriteObjectEnd(topNameInfo, typeNameInfo); .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ReferenceEquals(objectInfo._objectType, Converter.s_typeofString)) { _serWriter.WriteObjectEnd(typeNameInfo, typeNameInfo); } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°å¤šæ¬¡ä¼ é€’ç»™æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">å¯èƒ½åº”æ”¹ä¸ºä¼ é€’å…¶ä»–å‚æ•°ã€‚</font><font style="vertical-align: inherit;">BinaryObjectWriter.cs 262 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æä»ªçš„é‚£å¥è¯ï¼šè¿·èŒ«çš„å‘¼åæœ€å</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_serWriter.WriteObjectEnd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è®ºæ®ç­‰äºäºŒä¸¤- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typeNameInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å®ƒçœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªé”™å­—ï¼Œä½†æˆ‘ä¸èƒ½è‚¯å®šåœ°è¯´ã€‚</font><font style="vertical-align: inherit;">æˆ‘å†³å®šæ£€æŸ¥ä»€ä¹ˆæ˜¯è¢«è°ƒç”¨æ–¹çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WriteObjectEnd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteObjectEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(NameInfo memberNameInfo, NameInfo typeNameInfo)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¥½å§...ç»§ç»­å‰è¿›ã€‚ </font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬37æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteSerializationHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> headerId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> minorVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> majorVersion)</span></span></span><span class="hljs-function"> </span></span>{ var record = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerializationHeaderRecord( BinaryHeaderEnum.SerializedStreamHeader, topId, headerId, minorVersion, majorVersion); record.Write(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æŸ¥çœ‹æ­¤ä»£ç æ—¶ï¼Œæˆ‘ä¸ä¼šç«‹å³è¯´è¿™é‡Œæœ‰ä»€ä¹ˆé—®é¢˜æˆ–çœ‹èµ·æ¥å¯ç–‘ã€‚ä½†æ˜¯åˆ†æä»ªå¾ˆå¯èƒ½ä¼šè¯´æ˜¯ä»€ä¹ˆã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3066</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¼ é€’ç»™â€œ SerializationHeaderRecordâ€æ„é€ å‡½æ•°çš„å‚æ•°çš„å¯èƒ½é”™è¯¯é¡ºåºï¼šâ€œ minorVersionâ€å’Œâ€œ majorVersionâ€ã€‚ BinaryFormatterWriter.cs 111 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·å‚è§</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SerializationHeaderRecord</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»</font><font style="vertical-align: inherit;">çš„è¢«è°ƒç”¨æ–¹æ„é€ å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SerializationHeaderRecord</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( BinaryHeaderEnum binaryHeaderEnum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> headerId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> majorVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> minorVersion)</span></span></span><span class="hljs-function"> </span></span>{ _binaryHeaderEnum = binaryHeaderEnum; _topId = topId; _headerId = headerId; _majorVersion = majorVersion; _minorVersion = minorVersion; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæ„é€ å‡½æ•°çš„å‚æ•°éµå¾ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">majorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„é¡ºåº</font><font style="vertical-align: inherit;">ï¼›è€Œåœ¨è°ƒç”¨æ„é€ å‡½æ•°æ—¶</font><font style="vertical-align: inherit;">ï¼Œ</font><i><font style="vertical-align: inherit;">å°†æŒ‰</font></i><font style="vertical-align: inherit;">ä»¥ä¸‹é¡ºåºä¼ é€’å®ƒä»¬ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">majorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å¥½åƒæ˜¯é”™å­—ã€‚å¦‚æœæ˜¯æ•…æ„åˆ¶ä½œçš„ï¼ˆå¦‚æœå‘¢ï¼Ÿï¼‰-æˆ‘è®¤ä¸ºè¿™éœ€è¦é™„åŠ è¯„è®ºã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬38æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ObjectManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ISurrogateSelector selector, StreamingContext context, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> checkSecurity, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isCrossAppDomain)</span></span></span><span class="hljs-function"> </span></span>{ _objects = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectHolder[DefaultInitialSize]; _selector = selector; _context = context; _isCrossAppDomain = isCrossAppDomain; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœªä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°'checkSecurity'ã€‚</font><font style="vertical-align: inherit;">ObjectManager.cs 33 </font><font style="vertical-align: inherit;">æ„é€ å‡½æ•°</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checkSecurity</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°æœªå¾—åˆ°ä»»ä½•ä½¿ç”¨ã€‚</font><font style="vertical-align: inherit;">å°šæ— è¯„è®ºã€‚</font><font style="vertical-align: inherit;">æˆ‘æƒ³è¿™æ˜¯ä¸ºäº†å…¼å®¹æ€§ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•ï¼Œåœ¨æœ€è¿‘çš„å®‰å…¨æ€§å¯¹è¯ä¸­ï¼Œå®ƒçœ‹èµ·æ¥å¾ˆæœ‰è¶£ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬39æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™å¯¹æˆ‘æ¥è¯´ä¼¼ä¹æ˜¯ä¸å¯»å¸¸çš„ä»£ç ã€‚</font><font style="vertical-align: inherit;">æ¨¡å¼åœ¨æ‰€æœ‰ä¸‰ä¸ªæ£€æµ‹åˆ°çš„æƒ…å†µä¸‹çœ‹èµ·æ¥éƒ½æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”ä½äºåç§°å’Œå˜é‡åç§°ç›¸åŒçš„æ–¹æ³•ä¸­ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æˆ‘æˆ–è€…æ²¡æœ‰è¶³å¤Ÿçš„æ‚Ÿæ€§æ¥è¾¾åˆ°è¿™ç§é‡å¤çš„ç›®çš„ï¼› </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æˆ–è€…é”™è¯¯æ˜¯é€šè¿‡å¤åˆ¶ç²˜è´´æ–¹æ³•ä¼ æ’­çš„ã€‚ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä»£ç æœ¬èº«ï¼š </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnlargeArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newLength = _values.Length * <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newLength &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newLength == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerializationException(SR.Serialization_TooManyElements); } newLength = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; } FixupHolder[] temp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FixupHolder[newLength]; Array.Copy(_values, <span class="hljs-number"><span class="hljs-number">0</span></span>, temp, <span class="hljs-number"><span class="hljs-number">0</span></span>, _count); _values = temp; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼'newLength == int.MaxValue'å§‹ç»ˆä¸ºfalseã€‚</font><font style="vertical-align: inherit;">ObjectManager.cs 1423</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼'newLength == int.MaxValue'å§‹ç»ˆä¸ºfalseã€‚</font><font style="vertical-align: inherit;">ObjectManager.cs 1511</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼'newLength == int.MaxValue'å§‹ç»ˆä¸ºfalseã€‚</font><font style="vertical-align: inherit;">å¯¹è±¡ç®¡ç†å™¨.cs 1558</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä»–æ–¹æ³•çš„ä¸åŒä¹‹å¤„åœ¨äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸´æ—¶</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°ç»„å…ƒç´ </font><font style="vertical-align: inherit;">çš„ç±»å‹</font><font style="vertical-align: inherit;">ï¼ˆä¸æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FixupHolder</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè€Œæ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">long</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">object</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»ç„¶æ€€ç–‘æ˜¯å¦å­˜åœ¨å¤åˆ¶ç²˜è´´... </font><i><font style="vertical-align: inherit;">System.Data.Odbc</font></i><font style="vertical-align: inherit;">é¡¹ç›®ä¸­çš„</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—®é¢˜40</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç </font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnquoteIdentifier</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrEmpty(quotePrefix) || quotePrefix != <span class="hljs-string"><span class="hljs-string">" "</span></span>) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼'ï¼String.IsNullOrEmptyï¼ˆquotePrefixï¼‰|| quotePrefixï¼=â€œâ€'å§‹ç»ˆä¸ºtrueã€‚ OdbcCommandBuilder.cs 338 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æå™¨å‡å®šç»™å®šè¡¨è¾¾å¼å§‹ç»ˆå…·æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çœŸå®</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚çœŸçš„æ˜¯è¿™æ ·ã€‚ç”šè‡³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefixä¸­çš„</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…å€¼æ˜¯å¤šå°‘ä¹Ÿ</font><i><font style="vertical-align: inherit;">æ²¡å…³ç³»</font></i><font style="vertical-align: inherit;"> -æ¡ä»¶æœ¬èº«å†™å¾—ä¸æ­£ç¡®ã€‚è®©æˆ‘ä»¬æ·±å…¥åˆ°æ­¤ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æœ‰||æ“ä½œè€…ï¼Œæ‰€ä»¥è¡¨è¾¾å¼å€¼å°†æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çœŸ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¦‚æœå·¦ä¾§æˆ–å³ä¾§ï¼ˆæˆ–ä¸¤è€…ï¼‰çš„æ“ä½œæ•°å°†å…·æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çœŸ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚å·¦è¾¹çš„ä¸€å¥è¯å¾ˆæ¸…æ¥šã€‚ä»…å½“å·¦è¾¹çš„ä¸€ä¸ªä¸º</font><i><font style="vertical-align: inherit;">falseæ—¶ï¼Œ</font></i><font style="vertical-align: inherit;">æ‰ä¼šè¯„ä¼°å³è¾¹çš„ä¸€ä¸ª</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»·å€¼ã€‚</font><font style="vertical-align: inherit;">æ„å‘³ç€è¿™ä¸€ç‚¹ï¼Œå¦‚æœè¡¨è¾¾å¼åœ¨é‚£çš„å³æ“ä½œæ•°çš„å€¼æ€»æ˜¯æ–¹å¼ç»„æˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºtrue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æ—¶å€™çš„ä¸€ä¸ªå·¦çš„å€¼æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™æ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ°¸è¿œä¼šçš„æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çœŸ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹é¢çš„ä»£ç ä¸Šé¢çš„ä»ç»“æœæˆ‘ä»¬é‚£çŸ¥é“å¦‚æœæœ‰åˆé€‚çš„æ“ä½œæ•°æ˜¯è¯„ä¼°çš„ä»·å€¼è¡¨è¾¾</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string.IsNullOrEmptyï¼ˆquotePrefixï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºtrue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæ‰€ä»¥ä¸€å¯¹è¿™äº›å£°æ˜çš„æ˜¯çœŸå®çš„ï¼š</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix.Length == 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœè¿™äº›è¯­å¥ä¹‹ä¸€ä¸ºtrueï¼Œåˆ™è¡¨è¾¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefixï¼=â€œâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹Ÿå°†ä¸ºtrueï¼Œæˆ‘ä»¬æƒ³è¯æ˜è¿™ä¸€ç‚¹ã€‚æ„å‘³ç€</font><font style="vertical-align: inherit;">æ— è®º</font><i><font style="vertical-align: inherit;">quotePrefix</font></i><font style="vertical-align: inherit;">å†…å®¹</font><font style="vertical-align: inherit;">å¦‚ä½•ï¼Œ</font><font style="vertical-align: inherit;">æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼å§‹ç»ˆä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><b><font style="vertical-align: inherit;">ç¬¬41æœŸ</font></b><font style="vertical-align: inherit;">è¿”å›å…·æœ‰æœªä½¿ç”¨å‚æ•°çš„æ„é€ å‡½æ•°ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PendingGetConnection</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PendingGetConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dueTime, DbConnection owner, TaskCompletionSource&lt;DbConnectionInternal&gt; completion, DbConnectionOptions userOptions)</span></span></span><span class="hljs-function"> </span></span>{ DueTime = dueTime; Owner = owner; Completion = completion; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> DueTime { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbConnection Owner { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TaskCompletionSource&lt;DbConnectionInternal&gt; Completion { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbConnectionOptions UserOptions { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœªä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°â€œ userOptionsâ€ã€‚</font><font style="vertical-align: inherit;">DbConnectionPool.cs 26 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬ä»åˆ†æå™¨è­¦å‘Šå’Œä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»…ä¸€ä¸ªæ„é€ å‡½æ•°çš„å‚æ•°æœªä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-userOptions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè€Œå¦ä¸€ä¸ªåˆ™ç”¨äºåˆå§‹åŒ–åŒåå±æ€§ã€‚</font><font style="vertical-align: inherit;">ä¼¼ä¹å¼€å‘äººå‘˜å¿˜è®°äº†åˆå§‹åŒ–å±æ€§ä¹‹ä¸€ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬42æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰ä¸€ä¸ªå¯ç–‘çš„ä»£ç ï¼Œæˆ‘ä»¬å·²ç»é‡åˆ°äº†2æ¬¡ã€‚</font><font style="vertical-align: inherit;">æ¨¡å¼æ˜¯ç›¸åŒçš„ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... foreach (DataRow row in schemaTable.Rows) { resultTable.Columns .Add(row[<span class="hljs-string"><span class="hljs-string">"ColumnName"</span></span>] as <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, (Type)row[<span class="hljs-string"><span class="hljs-string">"DataType"</span></span>] as Type); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;">è½¬æ¢</font></u></a><font style="vertical-align: inherit;">è¿‡å¤šã€‚</font><font style="vertical-align: inherit;">è¯¥å¯¹è±¡å·²ç»æ˜¯â€œç±»å‹â€ç±»å‹ã€‚</font><font style="vertical-align: inherit;">dbMetaDataFactory.cs 176</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;">è½¬æ¢</font></u></a><font style="vertical-align: inherit;">è¿‡å¤šã€‚</font><font style="vertical-align: inherit;">è¯¥å¯¹è±¡å·²ç»æ˜¯â€œç±»å‹â€ç±»å‹ã€‚</font><font style="vertical-align: inherit;">OdbcMetaDataFactory.cs 1109</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è¡¨è¾¾å¼</font><i><font style="vertical-align: inherit;">ï¼ˆTypeï¼‰è¡Œ[â€œ DataTypeâ€]</font></i><font style="vertical-align: inherit;">çœ‹èµ·æ¥å¯ç–‘ã€‚é¦–å…ˆï¼Œå°†æ‰§è¡Œæ˜¾å¼è½¬æ¢ï¼Œä¹‹å-é€šè¿‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿ç®—ç¬¦è¿›è¡Œè½¬æ¢ã€‚å¦‚æœå€¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡Œ[â€œ DataTypeâ€]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nullï¼Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ™å®ƒå°†æˆåŠŸåœ°â€œä¼ é€’â€ä¸¤ä¸ªè½¬æ¢ï¼Œå¹¶å°†å…¶ä½œä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">çš„å‚æ•°</font><font style="vertical-align: inherit;">ã€‚å¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡Œ[â€œ DataTypeâ€]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”å›æ— æ³•è½¬æ¢ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å€¼ï¼Œ</font><font style="vertical-align: inherit;">åˆ™å°†åœ¨æ˜¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è½¬æ¢</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœŸé—´ç«‹å³ç”Ÿæˆ</font><i><font style="vertical-align: inherit;">InvalidCastException</font></i><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚æœ€åï¼Œä¸ºä»€ä¹ˆåœ¨è¿™é‡Œéœ€è¦ä¸¤ä¸ªé“¸ä»¶ï¼Ÿé—®é¢˜æ˜¯å¼€æ”¾çš„ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬43æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.InteropServices.RuntimeInformation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> FrameworkDescription { get { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s_frameworkDescription == null) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> versionString = (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>)AppContext.GetData(<span class="hljs-string"><span class="hljs-string">"FX_PRODUCT_VERSION"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (versionString == null) { .... versionString = typeof(object).Assembly .GetCustomAttribute&lt; AssemblyInformationalVersionAttribute&gt;() ?.InformationalVersion; .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> plusIndex = versionString.IndexOf(<span class="hljs-string"><span class="hljs-string">'+'</span></span>); .... } .... } .... } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3105</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡ç©ºæ¡ä»¶è¿ç®—ç¬¦åˆ†é…äº†'versionString'å˜é‡åï¼Œä½¿ç”¨è¯¥å˜é‡ã€‚</font><font style="vertical-align: inherit;">NullReferenceExceptionæ˜¯å¯èƒ½çš„ã€‚</font><font style="vertical-align: inherit;">RuntimeInformation.cs 29 </font><font style="vertical-align: inherit;">å½“è°ƒç”¨</font><i><font style="vertical-align: inherit;">versionString</font></i><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">çš„</font><i><font style="vertical-align: inherit;">IndexOf</font></i><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">æ—¶</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ†æå™¨ä¼šè­¦å‘Š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">å¯èƒ½å­˜åœ¨å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ”¶åˆ°å˜é‡çš„å€¼æ—¶ï¼Œä»£ç ä½œè€…ä½¿ç”¨â€œï¼Ÿâ€ã€‚</font><font style="vertical-align: inherit;">æ“ä½œå‘˜</font><font style="vertical-align: inherit;">åœ¨è®¿é—®</font><i><font style="vertical-align: inherit;">InfromationalVersion</font></i><font style="vertical-align: inherit;">å±æ€§</font><font style="vertical-align: inherit;">æ—¶</font><font style="vertical-align: inherit;">é¿å…</font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;">å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¯€çªæ˜¯ï¼Œå¦‚æœ</font><i><font style="vertical-align: inherit;">GetCustomAttribute &lt;...&gt;</font></i><font style="vertical-align: inherit;">çš„è°ƒç”¨</font><font style="vertical-align: inherit;">è¿”å›</font><i><font style="vertical-align: inherit;">null</font></i></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»ç„¶ä¼šç”Ÿæˆå¼‚å¸¸ï¼Œä½†æ˜¯åœ¨ä¸‹é¢-è°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•æ—¶ï¼Œå› ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versionString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†å…·æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘è¡Œç¬¬44æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è§£å†³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.ComponentModel.Composition</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®å¹¶æµè§ˆå‡ ä¸ªè­¦å‘Šã€‚</font><font style="vertical-align: inherit;">é’ˆå¯¹ä»¥ä¸‹ä»£ç å‘å‡ºäº†ä¸¤ä¸ªè­¦å‘Šï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CanSpecialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... object[] genericParameterConstraints = ....; GenericParameterAttributes[] genericParameterAttributes = ....; <span class="hljs-comment"><span class="hljs-comment">// if no constraints and attributes been specifed, anything can be created if ((genericParameterConstraints == null) &amp;&amp; (genericParameterAttributes == null)) { return true; } if ((genericParameterConstraints != null) &amp;&amp; (genericParameterConstraints.Length != partArity)) { return false; } if ((genericParameterAttributes != null) &amp;&amp; (genericParameterAttributes.Length != partArity)) { return false; } for (int i = 0; i &lt; partArity; i++) { if (!GenericServices.CanSpecialize( specialization[i], (genericParameterConstraints[i] as Type[]). CreateTypeSpecializations(specialization), genericParameterAttributes[i])) { return false; } } return true; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹åï¼Œä½¿ç”¨äº†'genericParameterConstraints'å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š603ã€589ã€‚GenericSpecializationPartCreationInfo.cs 603</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯åï¼Œä½¿ç”¨äº†'genericParameterAttributes'å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š604ã€594ã€‚GenericSpecializationPartCreationInfo.cs 604</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä»£ç ä¸­æœ‰æ£€æŸ¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genericParameterAttributesï¼= Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genericParameterConstraintsï¼= Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å› æ­¤ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™äº›å˜é‡çš„å¯æ¥å—å€¼ï¼Œæˆ‘ä»¬å°†è€ƒè™‘åœ¨å†…ã€‚å¦‚æœä¸¤ä¸ªå˜é‡éƒ½ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ï¼Œæˆ‘ä»¬å°†æ¯«æ— ç–‘é—®åœ°é€€å‡ºè¯¥æ–¹æ³•ã€‚å¦‚æœä¸Šè¿°ä¸¤ä¸ªå˜é‡ä¹‹ä¸€ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬ä¸é€€å‡ºè¯¥æ–¹æ³•æ€ä¹ˆåŠï¼Ÿå¦‚æœå¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µï¼Œå¹¶ä¸”æ‰§è¡Œè¦éå†å¾ªç¯ï¼Œåˆ™å°†è·å¾—</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬45æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è½¬åˆ°è¯¥é¡¹ç›®çš„å¦ä¸€ä¸ªæœ‰è¶£è­¦å‘Šã€‚ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬åšäº›ä¸åŒçš„äº‹æƒ…-é¦–å…ˆï¼Œæˆ‘ä»¬å°†å†æ¬¡ä½¿ç”¨è¯¥ç±»ï¼Œç„¶åæŸ¥çœ‹ä»£ç ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ å¯¹é¡¹ç›®ä¸­æœ€åä¸€ä¸ªå¯ç”¨çš„é¢„å‘è¡Œç‰ˆæœ¬çš„åŒåNuGetåŒ…çš„å¼•ç”¨ï¼ˆæˆ‘å®‰è£…äº†ç‰ˆæœ¬4.6.0-preview6.19303.8çš„åŒ…ï¼‰ã€‚è®©æˆ‘ä»¬ç¼–å†™ç®€å•çš„ä»£ç ï¼Œä¾‹å¦‚ï¼š</font></font><br><br><pre> <code class="cpp hljs">LazyMemberInfo lazyMemberInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LazyMemberInfo(); var eq = lazyMemberInfo.Equals(null); Console.WriteLine(eq);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº†equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ä¸è¯„è®ºï¼Œæˆ‘å¹¶æ²¡æœ‰åœ¨æ‰¾åˆ°.NETæ ¸å¿ƒçš„è¿™ç§æ–¹æ³•æè¿°AT docs.microsoft.comï¼Œåªä¸º.NETæ¡†æ¶ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæˆ‘ä»¬æŸ¥çœ‹å®ƒï¼ˆâ€œ </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LazyMemberInfo.Equalsï¼ˆObjectï¼‰æ–¹æ³•</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ï¼‰-æ— è®ºå®ƒè¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">æˆ‘ä»¬éƒ½ä¸ä¼šçœ‹åˆ°ä»»ä½•ç‰¹åˆ«çš„ä¸œè¥¿</font><font style="vertical-align: inherit;">ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å…³äºç”Ÿæˆçš„å¼‚å¸¸çš„ä¿¡æ¯ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†æ‰§è¡Œä»£ç å¹¶æŸ¥çœ‹ï¼š</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e5/8f7/aa4/8e58f7aa4e5a274751cde57da4d9497f.png" alt="å›¾ç‰‡16"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æˆ‘ä»¬å¯èƒ½ä¼šæœ‰ç‚¹æ‰­æ›²ï¼Œå¹¶ç¼–å†™ä»¥ä¸‹ä»£ç ï¼Œå¹¶è·å¾—æœ‰è¶£çš„è¾“å‡ºï¼š </font></font><br><br><pre> <code class="cpp hljs">LazyMemberInfo lazyMemberInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LazyMemberInfo(); var eq = lazyMemberInfo.Equals(typeof(String)); Console.WriteLine(eq);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä»£ç æ‰§è¡Œçš„ç»“æœã€‚ </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e74/199/292/e74199292d39b2df8a7b205218c9c1fe.png" alt="å›¾ç‰‡17"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰è¶£çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªå¼‚å¸¸éƒ½æ˜¯åœ¨åŒä¸€è¡¨è¾¾å¼ä¸­ç”Ÿæˆçš„ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object obj)</span></span></span><span class="hljs-function"> </span></span>{ LazyMemberInfo that = (LazyMemberInfo)obj; <span class="hljs-comment"><span class="hljs-comment">// Difefrent member types mean different members if (_memberType != that._memberType) { return false; } // if any of the lazy memebers create accessors in a delay-loaded fashion, // we simply compare the creators if ((_accessorsCreator != null) || (that._accessorsCreator != null)) { return object.Equals(_accessorsCreator, that._accessorsCreator); } // we are dealing with explicitly passed accessors in both cases if(_accessors == null || that._accessors == null) { throw new Exception(SR.Diagnostic_InternalExceptionMessage); } return _accessors.SequenceEqual(that._accessors); }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3115å°†</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€œ nullâ€ä¼ é€’ç»™â€œ Equalsâ€æ–¹æ³•ä¸åº”å¯¼è‡´â€œ NullReferenceExceptionâ€ã€‚ LazyMemberInfo.cs 116 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…ä¸Šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†æå™¨èŠ±äº†ç‚¹æ—¶é—´ï¼Œå› ä¸ºå®ƒä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that._memberType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼</font><font style="vertical-align: inherit;">å‘å‡ºäº†è­¦å‘Š</font><font style="vertical-align: inherit;">ã€‚ä½†æ˜¯ï¼Œåœ¨æ‰§è¡Œè¡¨è¾¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆLazyMemberInfoï¼‰obj</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—¶ï¼Œå¼‚å¸¸ä¼šæ›´æ—©å‘ç”Ÿ</font><font style="vertical-align: inherit;">ã€‚æˆ‘ä»¬å·²ç»è®°ä¸‹äº†ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘è®¤ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidCastExceptionéå¸¸</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¸…æ¥š</font><i><font style="vertical-align: inherit;">ã€‚</font></i><font style="vertical-align: inherit;">ä¸ºä»€ä¹ˆä¼š</font><font style="vertical-align: inherit;">ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Ÿäº‹å®æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LazyMemberInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ä¸€ä¸ªç»“æ„ï¼Œå› æ­¤å°†å…¶å–æ¶ˆè£…ç®±ã€‚çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼æ‹†ç®±åŠŸèƒ½ï¼Œåœ¨è½¬å¼¯ï¼Œå¯¼è‡´å‘ç”Ÿ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceExceptionå¼‚å¸¸</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹ã€‚</font><font style="vertical-align: inherit;">æ³¨é‡Šä¸­ä¹Ÿæœ‰ä¸€äº›é”™åˆ«å­—-ä½œè€…å¯èƒ½åº”è¯¥ä¿®å¤å®ƒä»¬ã€‚</font><font style="vertical-align: inherit;">ä½œè€…ä»ç„¶æœ‰æ˜ç¡®çš„å¼‚å¸¸æŠ›å‡ºæ–¹æ³•ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬å››åå…­æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡ºä¾¿è¯´ä¸€å¥ï¼Œæˆ‘</font><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">TriState</font></i><font style="vertical-align: inherit;">ç»“æ„çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Drawing.Common</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸­</font><font style="vertical-align: inherit;">é‡åˆ°äº†ç±»ä¼¼çš„æƒ…å†µ</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object o)</span></span></span><span class="hljs-function"> </span></span>{ TriState state = (TriState)o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _value == state._value; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3115å°†</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€œ nullâ€ä¼ é€’ç»™â€œ Equalsâ€æ–¹æ³•ä¸åº”å¯¼è‡´â€œ NullReferenceExceptionâ€ã€‚</font><font style="vertical-align: inherit;">TriState.cs 53 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—®é¢˜ä¸ä¸Šè¿°æƒ…å†µç›¸åŒã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬47æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Text.Json</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å‡ ä¸ªç‰‡æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜è®°å¾—æˆ‘å†™è¿‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€å®šä¸èƒ½è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å—ï¼Ÿ</font><font style="vertical-align: inherit;">æ˜¯æ—¶å€™å·©å›ºè¿™äº›çŸ¥è¯†äº†ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (TokenType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.None: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.Null: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.True: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>.TrueString; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.False: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>.FalseString; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.Number: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.StartArray: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.StartObject: { <span class="hljs-comment"><span class="hljs-comment">// null parent should have hit the None case Debug.Assert(_parent != null); return _parent.GetRawValueAsString(_idx); } case JsonTokenType.String: return GetString(); case JsonTokenType.Comment: case JsonTokenType.EndArray: case JsonTokenType.EndObject: default: Debug.Fail($"No handler for {nameof(JsonTokenType)}.{TokenType}"); return string.Empty; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹ä¸€çœ‹ï¼Œæ­¤æ–¹æ³•ä¸ä¼šè¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†åˆ†æå™¨ä¼šåå…¶é“è€Œè¡Œä¹‹ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3108</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å»ºè®®ä»â€œ ToStingï¼ˆï¼‰â€æ–¹æ³•è¿”å›â€œ nullâ€ã€‚</font><font style="vertical-align: inherit;">JsonElement.cs 1460 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æå™¨é€šè¿‡è°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetStringï¼ˆï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">æŒ‡å‘è¯¥è¡Œ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ CheckValidInstance(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _parent.GetString(_idx, JsonTokenType.String); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">çš„é‡è½½ç‰ˆæœ¬</font><font style="vertical-align: inherit;">ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, JsonTokenType expectedType)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tokenType == JsonTokenType.Null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æˆ‘ä»¬çœ‹åˆ°è¯¥æ¡ä»¶ä¹‹åï¼Œç«‹å³æ‰§è¡Œè¯¥æ¡ä»¶å°†å¯¼è‡´è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼-æ—¢æ¥è‡ªæ­¤æ–¹æ³•ï¼Œä¹Ÿæ¥è‡ª</font><font style="vertical-align: inherit;">æˆ‘ä»¬æœ€åˆè€ƒè™‘çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬å››åå…«æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦ä¸€ä¸ªæœ‰è¶£çš„ç‰‡æ®µï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal JsonPropertyInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreatePolymorphicProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ JsonPropertyInfo runtimeProperty = CreateProperty(property.DeclaredPropertyType, runtimePropertyType, property.ImplementedPropertyType, property?.PropertyInfo, Type, options); property.CopyRuntimeSettingsTo(runtimeProperty); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> runtimeProperty; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3042</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯èƒ½ä¸ºNullReferenceExceptionã€‚ 'ï¼Ÿã€‚'å’Œâ€œã€‚â€ 179æ“ä½œå‘˜ç”¨äºè®¿é—®â€œå±æ€§â€å¯¹è±¡JsonClassInfo.AddProperty.csçš„æˆå‘˜ã€‚179 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è°ƒç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateProperty</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•æ—¶ï¼Œé€šè¿‡å˜é‡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤šæ¬¡å¼•ç”¨</font><i><font style="vertical-align: inherit;">å±æ€§</font></i><font style="vertical-align: inherit;">ï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">property.DeclaredPropertyType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">property.ImplementedPropertyType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propertyï¼Ÿ.PropertyInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å¦‚æ‚¨æ‰€è§ï¼Œåœ¨ä¸€ç§æƒ…å†µä¸‹ï¼Œä»£ç ä½œè€…ä½¿ç”¨â€œï¼Ÿâ€ã€‚</font></font>æ“ä½œå‘˜ã€‚<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ­¤å¤„ä½ç½®åˆé€‚ï¼Œå¹¶ä¸”</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">property</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ï¼Œåˆ™æ­¤æ“ä½œç¬¦å°†æ²¡æœ‰ä»»ä½•å¸®åŠ©ï¼Œå› ä¸º</font><font style="vertical-align: inherit;">å°†é€šè¿‡ç›´æ¥è®¿é—®ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—®é¢˜49</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Security.Cryptography.Xml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®</font><font style="vertical-align: inherit;">ä¸­æ‰¾åˆ°ä»¥ä¸‹å¯ç–‘ç‰‡æ®µ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å®ƒä»¬å·²ç»é…å¯¹ï¼Œä¸å¤šæ¬¡å…¶ä»–è­¦å‘Šä¸€æ ·ã€‚</font><font style="vertical-align: inherit;">å†æ¬¡ï¼Œä»£ç çœ‹èµ·æ¥åƒå¤åˆ¶ç²˜è´´ï¼Œæ‚¨è‡ªå·±æ¯”è¾ƒã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€ä¸ªç‰‡æ®µï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(StringBuilder strBuilder, DocPosition docPos, AncestralNamespaceContextManager anc)</span></span></span><span class="hljs-function"> </span></span>{ docPos = DocPosition.BeforeRootElement; foreach (XmlNode childNode in ChildNodes) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (childNode.NodeType == XmlNodeType.Element) { CanonicalizationDispatcher.Write( childNode, strBuilder, DocPosition.InRootElement, anc); docPos = DocPosition.AfterRootElement; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CanonicalizationDispatcher.Write(childNode, strBuilder, docPos, anc); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç¬¬äºŒä¸ªç‰‡æ®µã€‚ </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteHash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HashAlgorithm hash, DocPosition docPos, AncestralNamespaceContextManager anc)</span></span></span><span class="hljs-function"> </span></span>{ docPos = DocPosition.BeforeRootElement; foreach (XmlNode childNode in ChildNodes) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (childNode.NodeType == XmlNodeType.Element) { CanonicalizationDispatcher.WriteHash( childNode, hash, DocPosition.InRootElement, anc); docPos = DocPosition.AfterRootElement; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CanonicalizationDispatcher.WriteHash(childNode, hash, docPos, anc); } } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3061</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°'docPos'æ€»æ˜¯åœ¨ä½¿ç”¨å‰åœ¨æ–¹æ³•ä¸»ä½“ä¸­é‡å†™ã€‚</font><font style="vertical-align: inherit;">CanonicalXmlDocument.cs 37</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3061</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°'docPos'æ€»æ˜¯åœ¨ä½¿ç”¨å‰åœ¨æ–¹æ³•ä¸»ä½“ä¸­é‡å†™ã€‚</font><font style="vertical-align: inherit;">CanonicalXmlDocument.cs 54</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™ä¸¤ç§æ–¹æ³•ä¸­ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docPos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°åœ¨ä½¿ç”¨å…¶å€¼ä¹‹å‰</font><i><font style="vertical-align: inherit;">éƒ½ä¼š</font></i><font style="vertical-align: inherit;">è¢«è¦†ç›–ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œç”¨ä½œæ–¹æ³•å‚æ•°çš„å€¼å°†è¢«å¿½ç•¥ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘è¡Œ50ï¼Œ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬è€ƒè™‘å¯¹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Data.SqlClient</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®</font><font style="vertical-align: inherit;">çš„ä»£ç çš„å‡ ä¸ªè­¦å‘Š</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsBOMNeeded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MetaType type, object value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type.NullableType == TdsEnums.SQLXMLTYPE) { Type currentType = value.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == typeof(SqlString)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((SqlString)value).IsNull &amp;&amp; ((((SqlString)value).Value).Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((((SqlString)value).Value[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) != <span class="hljs-number"><span class="hljs-number">0xff</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((currentType == typeof(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>)) &amp;&amp; (((String)value).Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((value != null) &amp;&amp; (((<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>)value)[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) != <span class="hljs-number"><span class="hljs-number">0xff</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == typeof(SqlXml)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((SqlXml)value).IsNull) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == typeof(XmlDataFeed)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Values will eventually converted to unicode string here } } return false; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹ç©ºå€¼è¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨â€œå€¼â€å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š8696ï¼Œ8708ã€‚TdsParser.cs 8696 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æå™¨è¢«æ£€æŸ¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼„ç³Šæ¶‚äº†</font><i><font style="vertical-align: inherit;">ï¼=</font></i><font style="vertical-align: inherit;">åœ¨å…¶ä¸­ä¸€ç§æƒ…å†µä¸‹</font><i><font style="vertical-align: inherit;">ä¸ºç©º</font></i><font style="vertical-align: inherit;">ã€‚å¥½åƒå®ƒåœ¨é‡æ„æœŸé—´ä¸¢å¤±äº†ï¼Œå› ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¢«å¤šæ¬¡å–æ¶ˆå¼•ç”¨ã€‚å¦‚æœ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼-æƒ…å†µä¸å¥½ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬51æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹ä¸€ä¸ªé”™è¯¯æ˜¯æ¥è‡ªæµ‹è¯•ï¼Œä½†å¯¹æˆ‘è€Œè¨€ä¼¼ä¹å¾ˆæœ‰è¶£ï¼Œå› æ­¤æˆ‘å†³å®šå¼•ç”¨å®ƒã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> TDSMessageCollection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateQueryResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"name"</span></span>) &amp;&amp; lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"state"</span></span>) &amp;&amp; lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"databases"</span></span>) &amp;&amp; lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"db_name"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// SELECT [name], [state] FROM [sys].[databases] WHERE [name] = db_name() { // Delegate to current database response responseMessage = _PrepareDatabaseResponse(session); } .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3053</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼è¿‡å¤šã€‚æ£€æŸ¥å­å­—ç¬¦ä¸²â€œåç§°â€å’Œâ€œ db_nameâ€ã€‚ QueryEngine.cs 151 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº‹å®æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­è¡¨è¾¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowerBatchText.Containsï¼ˆâ€œ nameâ€ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowerBatchText.Containsï¼ˆâ€œ db_nameâ€ï¼‰çš„ç»„åˆ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å¤šä½™çš„ã€‚ç¡®å®ï¼Œå¦‚æœæ£€æŸ¥çš„å­—ç¬¦ä¸²åŒ…å«å­å­—ç¬¦ä¸²</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ db_nameâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œé‚£ä¹ˆå®ƒä¹Ÿå°†åŒ…å«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ nameâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­å­—ç¬¦ä¸²ã€‚å¦‚æœå­—ç¬¦ä¸²ä¸åŒ…å«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ nameâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œé‚£ä¹ˆå®ƒä¹Ÿå°†ä¸åŒ…å«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ db_nameâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ç»“æœï¼Œç»“æœæ˜¯æ£€æŸ¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowerBatchText.Containsï¼ˆâ€œåç§°â€ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å¤šä½™çš„ã€‚å¦‚æœæ‰€æ£€æŸ¥çš„å­—ç¬¦ä¸²ä¸åŒ…å«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ nameâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™é™¤éå®ƒå¯ä»¥å‡å°‘è¯„ä¼°è¡¨è¾¾å¼çš„æ•°é‡ï¼Œå¦åˆ™å®ƒæ˜¯å¯ä»¥çš„</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘è¡Œ52é—®é¢˜</font></font></b> <font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">System.Net.Requests</font></i><font style="vertical-align: inherit;">é¡¹ç›®</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„ä»£ç ä¸­çš„å¯ç–‘ç‰‡æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> override PipelineInstruction </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PipelineCallback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PipelineEntry entry, ResponseDescription response, ....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NetEventSource.IsEnabled) NetEventSource.Info(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, $<span class="hljs-string"><span class="hljs-string">"Command:{entry?.Command} Description:{response?.StatusDescription}"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// null response is not expected if (response == null) return PipelineInstruction.Abort; .... if (entry.Command == "OPTS utf8 on\r\n") .... .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éªŒè¯ä¸ºç©ºåä½¿ç”¨äº†â€œå…¥å£â€å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š270ï¼Œ227ã€‚FtpControlStream.cs 270 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç¼–å†™æ’å€¼å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨è¯¸å¦‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entry ?ã€å‘½ä»¤</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å“åº”ä¹‹</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»çš„è¡¨è¾¾å¼</font><font style="vertical-align: inherit;">ã€‚ 'ï¼Ÿã€‚'ä½¿ç”¨è¿ç®—ç¬¦ä»£æ›¿â€œã€‚â€ </font><font style="vertical-align: inherit;">å¦‚æœä»»ä½•ç›¸åº”çš„å‚æ•°å…·æœ‰</font><i><font style="vertical-align: inherit;">ç©º</font></i><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">ï¼Œåˆ™</font><font style="vertical-align: inherit;">è¿ç®—ç¬¦ä¸ä¼šè·å–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¤æŠ€æœ¯æœ‰æ•ˆã€‚æ­¤å¤–ï¼Œæ­£å¦‚æˆ‘ä»¬ä»ä»£ç ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå¯èƒ½</font><font style="vertical-align: inherit;">çš„</font><i><font style="vertical-align: inherit;">å“åº”</font></i><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">è¢«æ‹†åˆ†ï¼ˆå¦‚æœ</font><i><font style="vertical-align: inherit;">response == nullï¼Œ</font></i><font style="vertical-align: inherit;">åˆ™ä»æ–¹æ³•ä¸­é€€å‡ºï¼‰</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œè€Œæ²¡æœ‰ç±»ä¼¼çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¡ç›®ã€‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”²ä½œä¸ºæ—¶ï¼Œå¦‚æœç»“æœçš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¡ç›®</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤–æ²¿ç€ä¸‹é¢çš„ä»£ç è¯„ä¼°æ—¶</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entry.Command</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”±BEçš„å¼‚å¸¸ç”Ÿæˆæ„å¿—ï¼Œä¸€ä¸ªï¼ˆå¸¦çš„ï¼Œä¸ä½¿ç”¨â€œâ€ï¼Ÿ'ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤æ—¶ï¼Œç›¸å½“è¯¦ç»†çš„ä»£ç å®¡æŸ¥æ­£åœ¨ç­‰å¾…æˆ‘ä»¬ï¼Œå› æ­¤æˆ‘å»ºè®®æ‚¨å†ä¼‘æ¯ä¸€ä¸‹-æ”¾æ¾ä¸€ä¸‹ï¼Œå–ç‚¹èŒ¶æˆ–å’–å•¡ã€‚</font><font style="vertical-align: inherit;">ä¹‹åï¼Œæˆ‘å°†åœ¨è¿™é‡Œç»§ç»­ã€‚</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/56a/3fc/f07/56a3fcf075284f021a56249627e518bb.png" alt="å›¾ç‰‡21"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½ å›æ¥äº†å— </font><font style="vertical-align: inherit;">é‚£æˆ‘ä»¬ç»§ç»­å§ã€‚</font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬53æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Collections.Immutable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ä¸­</font><font style="vertical-align: inherit;">æ‰¾åˆ°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¿™æ¬¡æˆ‘ä»¬å°†å¯¹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Collections.Immutable.ImmutableArray &lt;T&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“æ„</font><font style="vertical-align: inherit;">è¿›è¡Œä¸€äº›å®éªŒ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ–¹æ³•</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IStructuralEquatable.Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IStructuralComparable.CompareTo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹æˆ‘ä»¬æ¥è¯´ç‰¹åˆ«æœ‰æ„ä¹‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä»</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IStructuralEquatable.Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">å¼€å§‹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¸‹é¢ç»™å‡ºäº†ä»£ç ï¼Œæˆ‘å»ºè®®æ‚¨å°è¯•è‡ªå·±æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IStructuralEquatable.Equals(object other, IEqualityComparer comparer) { var self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; Array otherArray = other as Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (otherArray == null) { var theirs = other as IImmutableArray; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (theirs != null) { otherArray = theirs.Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> == null &amp;&amp; otherArray == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } } IStructuralEquatable ours = self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ours.Equals(otherArray, comparer); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½ æœ‰äº‹å— </font><font style="vertical-align: inherit;">å¦‚æœæ˜¯-æ­å–œã€‚</font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å°†å…¶éªŒè¯ä¸ºnullåä½¿ç”¨äº†â€œæˆ‘ä»¬çš„â€å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š1212ï¼Œ1204ã€‚ImmutableArray_1.cs 1212 </font><font style="vertical-align: inherit;">é€šè¿‡</font><font style="vertical-align: inherit;">æœ€åä¸€ä¸ª</font><i><font style="vertical-align: inherit;">è¿”å›</font></i><font style="vertical-align: inherit;">è¡¨è¾¾å¼ä¸­</font><font style="vertical-align: inherit;">çš„</font><i><font style="vertical-align: inherit;">ours</font></i><font style="vertical-align: inherit;">å˜é‡</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è°ƒç”¨å®ä¾‹</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ä½¿åˆ†æå™¨æ„Ÿåˆ°å›°æƒ‘</font><font style="vertical-align: inherit;">ï¼Œå› ä¸ºå®ƒæš—ç¤º</font><font style="vertical-align: inherit;">æ­¤å¤„å¯èƒ½å‘ç”Ÿ</font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚åˆ†æä»ªä¸ºä½•å¦‚æ­¤å»ºè®®ï¼Ÿä¸ºäº†æ›´å®¹æ˜“è§£é‡Šï¼Œæˆ‘åœ¨ä¸‹é¢æä¾›äº†ç›¸åŒæ–¹æ³•çš„ç®€åŒ–ä»£ç ç‰‡æ®µã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IStructuralEquatable.Equals(object other, IEqualityComparer comparer) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> == null &amp;&amp; otherArray == null) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> == null) { .... } } } IStructuralEquatable ours = self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ours.Equals(otherArray, comparer); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ€åçš„è¡¨è¾¾å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬çš„</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">çš„å€¼</font><font style="vertical-align: inherit;">æ¥è‡ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¸Šé¢å¤šæ¬¡æ‰§è¡Œäº†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥</font><font style="vertical-align: inherit;">ã€‚è¿™æ„å‘³ç€ï¼Œ</font><font style="vertical-align: inherit;">ä¸</font><i><font style="vertical-align: inherit;">self.array</font></i><font style="vertical-align: inherit;">ç›¸åŒ</font><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">å¯ä»¥ä¸º</font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">ã€‚è‡³å°‘åœ¨ç†è®ºä¸Šã€‚åœ¨å®è·µä¸­å¯ä»¥è¾¾åˆ°è¿™ç§çŠ¶æ€å—ï¼Ÿè®©æˆ‘ä»¬å°è¯•æ‰¾å‡ºç­”æ¡ˆã€‚ä¸ºæ­¤ï¼Œæˆ‘å†æ¬¡å¼•ç”¨å…·æœ‰è®¾ç½®å…³é”®ç‚¹çš„æ–¹æ³•çš„ä¸»ä½“ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IStructuralEquatable.Equals(object other, IEqualityComparer comparer) { var self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 Array otherArray = other as Array; if (otherArray == null) // &lt;= 2 { var theirs = other as IImmutableArray; if (theirs != null) // &lt;= 3 { otherArray = theirs.Array; if (self.array == null &amp;&amp; otherArray == null) { return true; } else if (self.array == null) // &lt;= 4 { return false; } } IStructuralEquatable ours = self.array; // &lt;= 5 return ours.Equals(otherArray, comparer); }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³é”®ç‚¹1. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == this.array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆç”±äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self = this</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚å› æ­¤ï¼Œåœ¨è°ƒç”¨è¯¥æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è·å–æ¡ä»¶</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡ç‚¹2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æˆ‘ä»¬å¯ä»¥å¿½ç•¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¿™å°†æ˜¯è·å¾—æˆ‘ä»¬æƒ³è¦çš„æœ€ç®€å•çš„æ–¹æ³•ã€‚è‹¥è¦å¿½ç•¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬åªéœ€è¦</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦ä¸€ä¸ª</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹æˆ–æ´¾ç”Ÿ</font><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">ï¼Œè€Œä¸åŒ…å«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚è¿™æ ·ï¼Œåœ¨ä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿ç®—ç¬¦ä¹‹åï¼Œå°†åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otherArrayä¸­</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†™å…¥énullå¼•ç”¨ï¼Œ</font><font style="vertical-align: inherit;">è€Œæˆ‘ä»¬å°†å¿½ç•¥ç¬¬ä¸€ä¸ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></i> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡ç‚¹3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¿™ä¸€ç‚¹éœ€è¦æ›´å¤æ‚çš„æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ç»å¯¹éœ€è¦åœ¨ç¬¬äºŒæ¡</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥ï¼ˆå…·æœ‰æ¡ä»¶è¡¨è¾¾å¼â€œ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»–ä»¬çš„ï¼â€çš„é‚£æ¡</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥ï¼‰ä¸­</font><font style="vertical-align: inherit;">é€€å‡º</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ²¡æœ‰å‘ç”Ÿï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç„¶å</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æ”¯å¼€å§‹æ‰§è¡Œï¼Œåˆ™æœ€è‚¯å®šçš„æ˜¯</font><font style="vertical-align: inherit;">ç”±äºå…³é”®ç‚¹4 </font><font style="vertical-align: inherit;">ï¼Œåœ¨æ¡ä»¶</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä¼šè·å¾—æ‰€éœ€</font><font style="vertical-align: inherit;">çš„ç‚¹5ã€‚ä¸ºé¿å…è¾“å…¥å…³é”®ç‚¹çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥3ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä»–</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å€¼ä¸æ‰€è¿°BE </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä»–</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹ä¸€å®šä¸èƒ½å®ç°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IImmutableArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥å£ã€‚</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡ç‚¹5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼è¾¾åˆ°è¿™ä¸€ç‚¹</font><font style="vertical-align: inherit;">ï¼Œåˆ™æ„å‘³ç€æˆ‘ä»¬å·²ç»è¾¾åˆ°äº†ç›®æ ‡ï¼Œå¹¶ä¸”</font><font style="vertical-align: inherit;">å°†ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è·å¾—ä»¥ä¸‹æ•°æ®é›†ï¼Œè¿™äº›æ•°æ®é›†å°†å¼•å¯¼æˆ‘ä»¬åˆ°è¾¾æ‰€éœ€çš„ä½ç½®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¦–å…ˆï¼š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.array-null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬äºŒ-ä»¥ä¸‹ä¹‹ä¸€ï¼š</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä»–</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦ä¸€ä¸ª</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…·æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹æˆ–ä»å…¶æ´¾ç”Ÿçš„ç±»å‹ï¼›</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ²¡æœ‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹æˆ–å®ƒçš„æ´¾ç”Ÿç±»ï¼Œå› æ­¤æ²¡æœ‰å®ç°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IImmutableArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥å£ã€‚</font></font></li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å­—æ®µï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼å£°æ˜ï¼š</font></font><br><br><pre> <code class="cpp hljs">internal T[] <span class="hljs-built_in"><span class="hljs-built_in">array</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”±äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImmutableArray &lt;T&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯ç»“æ„ï¼Œå› æ­¤å®ƒå…·æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼ˆä¸å¸¦å‚æ•°ï¼‰ï¼Œè¯¥é»˜è®¤æ„é€ å‡½æ•°å°†å¯¼è‡´</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°ç»„</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µé»˜è®¤é‡‡ç”¨å€¼ï¼Œè¯¥å€¼ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nullã€‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ«å¿˜äº†æˆ‘ä»¬æ­£åœ¨ç ”ç©¶æ¥å£æ–¹æ³•çš„æ˜¾å¼å®ç°ï¼Œå› æ­¤ï¼Œå¿…é¡»åœ¨è°ƒç”¨ä¹‹å‰å®Œæˆè½¬æ¢ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼æ¥å¤„ç†å¼‚å¸¸ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬æ·»åŠ å¯¹è°ƒè¯•åº“ç‰ˆæœ¬çš„å¼•ç”¨ï¼Œç¼–å†™ä»£ç ï¼Œæ‰§è¡Œå¹¶æŸ¥çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç ç‰‡æ®µ1ã€‚</font></font></b> <br><br><pre> <code class="cpp hljs">var comparer = EqualityComparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;(); ((IStructuralEquatable)immutableArray).Equals(null, comparer);</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç ç‰‡æ®µ2ã€‚</font></font></b> <br><br><pre> <code class="cpp hljs">var comparer = EqualityComparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;(); ((IStructuralEquatable)immutableArray).Equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>[] { }, comparer);</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç ç‰‡æ®µ3ã€‚</font></font></b> <br><br><pre> <code class="cpp hljs">var comparer = EqualityComparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;(); ((IStructuralEquatable)immutableArray).Equals(typeof(Object), comparer);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿™ä¸‰ä¸ªä»£ç æ®µçš„æ‰§è¡Œç»“æœå°†æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯é€šè¿‡ä¸åŒçš„è¾“å…¥é¡¹æ•°æ®å’Œæ‰§è¡Œè·¯å¾„æ‰èƒ½å®ç°ã€‚ </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13a/a3b/e8a/13aa3be8a0b68a646aee130773f2c862.png" alt="å›¾ç‰‡18"></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬54æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨æ²¡æœ‰å¿˜è®°ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§éœ€è¦æŠ¹é»‘çš„æ–¹æ³•ã€‚</font><font style="vertical-align: inherit;">:)ä½†æ˜¯è¿™ä¸€æ¬¡æˆ‘ä»¬ä¸ä¼šè¯¦ç»†ä»‹ç»ã€‚</font><font style="vertical-align: inherit;">è€Œä¸”ï¼Œæˆ‘ä»¬å·²ç»ä»å‰é¢çš„ç¤ºä¾‹ä¸­äº†è§£äº†ä¸€äº›ä¿¡æ¯ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IStructuralComparable.CompareTo(object other, IComparer comparer) { var self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; Array otherArray = other as Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (otherArray == null) { var theirs = other as IImmutableArray; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (theirs != null) { otherArray = theirs.Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> == null &amp;&amp; otherArray == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> == null ^ otherArray == null) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentException( SR.ArrayInitializedStateNotEqual, nameof(other)); } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (otherArray != null) { IStructuralComparable ours = self.<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ours.CompareTo(otherArray, comparer); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } throw new ArgumentException(SR.ArrayLengthsNotEqual, nameof(other)); }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å°†å…¶éªŒè¯ä¸ºnullåä½¿ç”¨äº†â€œæˆ‘ä»¬çš„â€å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š1265ã€1251ã€‚ImmutableArray_1.cs 1265 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æ‚¨æ‰€è§ï¼Œæƒ…å†µä¸å‰é¢çš„ç¤ºä¾‹éå¸¸ç›¸ä¼¼ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ç¼–å†™ä»¥ä¸‹ä»£ç ï¼š</font></font><br><br><pre> <code class="cpp hljs">Object other = ....; var comparer = Comparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;(); ((IStructuralComparable)immutableArray).CompareTo(other, comparer);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å°†å°è¯•æŸ¥æ‰¾ä¸€äº›æ¡ç›®æ•°æ®ä»¥è¾¾åˆ°</font><font style="vertical-align: inherit;">å¯èƒ½å‘ç”Ÿ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹çš„</font><font style="vertical-align: inherit;">å¼‚å¸¸çš„åœ°æ­¥</font><font style="vertical-align: inherit;">ï¼š</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ï¼š</font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">other</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new String [] {}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“æœï¼š</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eef/d77/08a/eefd7708a187f5060f2074e642f18434.png" alt="å›¾ç‰‡22"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡è®¾æ³•æ‰¾å‡ºæ­¤ç±»æ•°æ®ï¼Œæ–¹æ³•ä¸­ä¼šå‘ç”Ÿå¼‚å¸¸ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬55æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Netã€‚HTTP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾¦å¬å™¨é¡¹ç›®ä¸­ï¼Œæˆ‘å¶ç„¶å‘ç°äº†å‡ ä¸ªå¯ç–‘å’Œéå¸¸ç›¸ä¼¼çš„åœ°æ–¹ã€‚</font><font style="vertical-align: inherit;">å†ä¸€æ¬¡ï¼Œæˆ‘å¯¹åœ¨è¿™é‡Œè¿›è¡Œçš„å¤åˆ¶ç²˜è´´æ„Ÿåˆ°éœ‡æƒŠã€‚</font><font style="vertical-align: inherit;">ç”±äºæ¨¡å¼ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬å°†çœ‹ä¸€ä¸ªä»£ç ç¤ºä¾‹ã€‚</font><font style="vertical-align: inherit;">å¯¹äºå…¶ä½™æƒ…å†µï¼Œæˆ‘å°†å¼•ç”¨åˆ†æå™¨è­¦å‘Šã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override IAsyncResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginRead</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte[] buffer, ....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NetEventSource.IsEnabled) { NetEventSource.Enter(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); NetEventSource.Info(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"buffer.Length:"</span></span> + buffer.Length + <span class="hljs-string"><span class="hljs-string">" size:"</span></span> + size + <span class="hljs-string"><span class="hljs-string">" offset:"</span></span> + offset); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer == null) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(nameof(buffer)); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨â€œç¼“å†²åŒºâ€å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š51ï¼Œ53ã€‚HttpRequestStream.cs 51 </font><font style="vertical-align: inherit;">åœ¨æ¡ä»¶</font><i><font style="vertical-align: inherit;">ç¼“å†²åŒº== null</font></i><font style="vertical-align: inherit;">ä¸‹</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArgumentNullException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">æ˜¾ç„¶è¡¨æ˜</font><font style="vertical-align: inherit;">è¯¥å˜é‡çš„</font><i><font style="vertical-align: inherit;">nullå€¼</font></i><font style="vertical-align: inherit;">æ˜¯ä¸å¯æ¥å—çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœ</font><i><font style="vertical-align: inherit;">NetEventSource.IsEnabled</font></i><font style="vertical-align: inherit;">è¡¨è¾¾å¼çš„å€¼ä¸º</font><i><font style="vertical-align: inherit;">true</font></i><font style="vertical-align: inherit;">ä¸”</font><i><font style="vertical-align: inherit;">buffer</font></i><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">ï¼Œåˆ™åœ¨è®¡ç®—</font><i><font style="vertical-align: inherit;">buffer.Length</font></i><font style="vertical-align: inherit;">è¡¨è¾¾å¼æ—¶ï¼Œ</font><font style="vertical-align: inherit;">å°†ç”Ÿæˆ</font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæˆ‘ä»¬ç”šè‡³éƒ½æ— æ³•è¾¾åˆ°</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ</font><i><font style="vertical-align: inherit;">ç¼“å†²åŒº==ç©º</font></i><font style="vertical-align: inherit;">æ£€æŸ¥ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é’ˆå¯¹ä½¿ç”¨ä»¥ä¸‹æ¨¡å¼çš„å…¶ä»–æ–¹æ³•å‘å‡ºçš„PVS-Studioè­¦å‘Šï¼š</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'buffer'å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š49ï¼Œ51ã€‚HttpResponseStream.cs 49</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'buffer'å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">æ£€æŸ¥è¡Œï¼š74ï¼Œ75ã€‚HttpResponseStream.cs 74</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘è¡Œ56</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Transactions.Local</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ä¸­</font><font style="vertical-align: inherit;">ä¹Ÿæœ‰ç±»ä¼¼çš„ä»£ç ç‰‡æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnterState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InternalTransaction tx)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tx._outcomeSource._isoLevel == IsolationLevel.Snapshot) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> TransactionException.CreateInvalidOperationException( TraceSourceType.TraceSourceLtm, SR.CannotPromoteSnapshot, null, tx == null ? Guid.Empty : tx.DistributedTxId); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨éªŒè¯æ˜¯å¦ä¸ºç©ºä¹‹å‰ä½¿ç”¨äº†'tx'å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š3282ï¼Œ3285ã€‚TransactionState.cs 3282 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ï¼Œä½œè€…å¸Œæœ›å¼•å‘</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidOperationException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚åœ¨è°ƒç”¨ç”¨äºåˆ›å»ºå¼‚å¸¸å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œä»£ç ä½œè€…ä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°ï¼Œå°†å…¶æ£€æŸ¥ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥é¿å…</font><font style="vertical-align: inherit;">åœ¨è¯„ä¼°</font><i><font style="vertical-align: inherit;">tx.DistributedTxId</font></i><font style="vertical-align: inherit;">è¡¨è¾¾å¼</font><font style="vertical-align: inherit;">æ—¶</font><font style="vertical-align: inherit;">å‡ºç°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚å…·æœ‰è®½åˆºæ„å‘³çš„æ˜¯ï¼Œæ£€æŸ¥å°†æ— æµäºäº‹ï¼Œå› ä¸ºåœ¨è¯„ä¼°</font><i><font style="vertical-align: inherit;">if</font></i><font style="vertical-align: inherit;">è¯­å¥</font><font style="vertical-align: inherit;">çš„æ¡ä»¶æ—¶</font><font style="vertical-align: inherit;">ï¼Œå®ä¾‹å­—æ®µæ˜¯é€šè¿‡</font><i><font style="vertical-align: inherit;">tx</font></i><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">è®¿é—®çš„</font><font style="vertical-align: inherit;">-</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx._outcomeSource._isoLevel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><i><font style="vertical-align: inherit;">System.Runtime.Caching</font></i><font style="vertical-align: inherit;">é¡¹ç›®ä¸­çš„</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬57æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç </font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetLimit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cacheMemoryLimitMegabytes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> cacheMemoryLimit = cacheMemoryLimitMegabytes; cacheMemoryLimit = cacheMemoryLimit &lt;&lt; MEGABYTE_SHIFT; _memoryLimit = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// never override what the user specifies as the limit; // only call AutoPrivateBytesLimit when the user does not specify one. if (cacheMemoryLimit == 0 &amp;&amp; _memoryLimit == 0) { // Zero means we impose a limit _memoryLimit = EffectiveProcessMemoryLimit; } else if (cacheMemoryLimit != 0 &amp;&amp; _memoryLimit != 0) { // Take the min of "cache memory limit" and // the host's "process memory limit". _memoryLimit = Math.Min(_memoryLimit, cacheMemoryLimit); } else if (cacheMemoryLimit != 0) { // _memoryLimit is 0, but "cache memory limit" // is non-zero, so use it as the limit _memoryLimit = cacheMemoryLimit; } .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¡¨è¾¾å¼'cacheMemoryLimitï¼= 0 &amp;&amp; _memoryLimitï¼= 0'å§‹ç»ˆä¸ºfalseã€‚ CacheMemoryMonitor.cs 250 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœä»”ç»†æŸ¥çœ‹ä»£ç ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä»¥ä¸‹è¡¨è¾¾å¼ä¹‹ä¸€</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-cacheMemoryLimitï¼= 0 &amp;&amp; _memoryLimitï¼= 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†å§‹ç»ˆä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ç”±äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_memoryLimit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å€¼ä¸º0ï¼ˆåœ¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯­å¥</font><font style="vertical-align: inherit;">ä¹‹å‰è®¾ç½®</font><font style="vertical-align: inherit;">ï¼‰ï¼Œå› æ­¤&amp;&amp;è¿ç®—ç¬¦çš„å³æ“ä½œæ•°ä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å› æ­¤ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬58æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»</font><font style="vertical-align: inherit;">ä¸‹é¢</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Diagnostics.TraceSource</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®</font><font style="vertical-align: inherit;">å¼•ç”¨äº†å¯ç–‘çš„ä»£ç ç‰‡æ®µ</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ StackNode n = _stack.Value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n == null) { base.Pop(); } _stack.Value = n.Prev; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n.Value; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å¯¹nullè¿›è¡ŒéªŒè¯åï¼Œä½¿ç”¨äº†'n'å¯¹è±¡ã€‚æ£€æŸ¥è¡Œï¼š115ï¼Œ111ã€‚CorrelationManager.cs 115 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æƒ…å†µã€‚ç”±äºæ£€æŸ¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n == nullï¼Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å‡è®¾</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯æ­¤å±€éƒ¨å˜é‡çš„æœŸæœ›å€¼ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œ</font><font style="vertical-align: inherit;">åˆ™åœ¨è®¿é—®å®ä¾‹å±æ€§</font><i><font style="vertical-align: inherit;">-n.Prev</font></i><font style="vertical-align: inherit;">æ—¶å°†ç”Ÿæˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚å¦‚æœåœ¨è¿™ç§æƒ…å†µä¸‹</font><i><font style="vertical-align: inherit;">n</font></i><font style="vertical-align: inherit;">æ°¸è¿œä¸èƒ½ä¸º</font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;">ï¼Œ</font><i><font style="vertical-align: inherit;">é‚£ä¹ˆ</font></i><font style="vertical-align: inherit;">å°†æ°¸è¿œä¸ä¼šè°ƒç”¨</font><i><font style="vertical-align: inherit;">base.Popï¼ˆï¼‰</font></i><font style="vertical-align: inherit;">ã€‚</font><b><font style="vertical-align: inherit;">å‘è¡Œ59</font></b><font style="vertical-align: inherit;">æ¥è‡ª</font><i><font style="vertical-align: inherit;">System.Drawing.Primitives</font></i><font style="vertical-align: inherit;">çš„æœ‰è¶£ä»£ç ç‰‡æ®µ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®ã€‚</font><font style="vertical-align: inherit;">åŒæ ·ï¼Œæˆ‘å»ºè®®æ‚¨å°è¯•è‡ªå·±å‘ç°é—®é¢˜ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯ä»£ç ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToHtml</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Color c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> colorString = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c.IsEmpty) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> colorString; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ColorUtil.IsSystemColor(c)) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (c.ToKnownColor()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ActiveBorder: colorString = <span class="hljs-string"><span class="hljs-string">"activeborder"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.GradientActiveCaption: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ActiveCaption: colorString = <span class="hljs-string"><span class="hljs-string">"activecaption"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.AppWorkspace: colorString = <span class="hljs-string"><span class="hljs-string">"appworkspace"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Desktop: colorString = <span class="hljs-string"><span class="hljs-string">"background"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Control: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlLight: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlDark: colorString = <span class="hljs-string"><span class="hljs-string">"buttonshadow"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlText: colorString = <span class="hljs-string"><span class="hljs-string">"buttontext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ActiveCaptionText: colorString = <span class="hljs-string"><span class="hljs-string">"captiontext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.GrayText: colorString = <span class="hljs-string"><span class="hljs-string">"graytext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.HotTrack: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Highlight: colorString = <span class="hljs-string"><span class="hljs-string">"highlight"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.MenuHighlight: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.HighlightText: colorString = <span class="hljs-string"><span class="hljs-string">"highlighttext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InactiveBorder: colorString = <span class="hljs-string"><span class="hljs-string">"inactiveborder"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.GradientInactiveCaption: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InactiveCaption: colorString = <span class="hljs-string"><span class="hljs-string">"inactivecaption"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InactiveCaptionText: colorString = <span class="hljs-string"><span class="hljs-string">"inactivecaptiontext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Info: colorString = <span class="hljs-string"><span class="hljs-string">"infobackground"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InfoText: colorString = <span class="hljs-string"><span class="hljs-string">"infotext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.MenuBar: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Menu: colorString = <span class="hljs-string"><span class="hljs-string">"menu"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.MenuText: colorString = <span class="hljs-string"><span class="hljs-string">"menutext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ScrollBar: colorString = <span class="hljs-string"><span class="hljs-string">"scrollbar"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlDarkDark: colorString = <span class="hljs-string"><span class="hljs-string">"threeddarkshadow"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlLightLight: colorString = <span class="hljs-string"><span class="hljs-string">"buttonhighlight"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Window: colorString = <span class="hljs-string"><span class="hljs-string">"window"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.WindowFrame: colorString = <span class="hljs-string"><span class="hljs-string">"windowframe"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.WindowText: colorString = <span class="hljs-string"><span class="hljs-string">"windowtext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c.IsNamedColor) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == Color.LightGray) { <span class="hljs-comment"><span class="hljs-comment">// special case due to mismatch between Html and enum spelling colorString = "LightGrey"; } else { colorString = c.Name; } } else { colorString = "#" + cRToString("X2", null) + cGToString("X2", null) + cBToString("X2", null); } return colorString; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¥½å§ï¼Œå¥½å§ï¼Œåªæ˜¯åœ¨å¼€ç©ç¬‘...è¿˜æ˜¯æ‚¨è¿˜æ‰¾åˆ°äº†ä»€ä¹ˆï¼Ÿ</font><font style="vertical-align: inherit;">æ— è®ºå¦‚ä½•ï¼Œè®©æˆ‘ä»¬å‡å°‘ä»£ç ä»¥æ¸…æ¥šåœ°è¯´æ˜é—®é¢˜ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯çŸ­ä»£ç ç‰ˆæœ¬ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (c.ToKnownColor()) { .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Control: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlLight: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3139</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸¤ä¸ªæˆ–æ›´å¤šæ¡ˆä¾‹åˆ†æ”¯æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚</font><font style="vertical-align: inherit;">ColorTranslator.cs 302 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä¸èƒ½è‚¯å®šåœ°è¯´ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚</font><font style="vertical-align: inherit;">åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œå½“å¼€å‘äººå‘˜æƒ³è¦ä¸ºå¤šä¸ªæšä¸¾æ•°è¿”å›ç›¸åŒçš„å€¼æ—¶ï¼Œä»–ä¼šä¾æ¬¡ä½¿ç”¨å¤šä¸ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤§å°å†™</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘è®¤ä¸ºï¼Œåœ¨æ­¤å¤„å¤åˆ¶ç²˜è´´å¾ˆå®¹æ˜“çŠ¯é”™ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬æ·±å…¥ä¸€ç‚¹ã€‚</font><font style="vertical-align: inherit;">è¦ä»</font><font style="vertical-align: inherit;">åˆ†æçš„</font><i><font style="vertical-align: inherit;">ToHtml</font></i><font style="vertical-align: inherit;">æ–¹æ³•ä¸­</font><font style="vertical-align: inherit;">è·å–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">â€œ buttonfaceâ€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">ï¼Œå¯ä»¥å°†ä»¥ä¸‹å€¼ä¹‹ä¸€ä¼ é€’ç»™å®ƒï¼ˆé¢„æœŸï¼‰ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.Control</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.ControlLight</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœæˆ‘ä»¬æ£€æŸ¥æ¯ç§é¢œè‰²çš„ARGBå€¼ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š </font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.Control</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ255ï¼Œ240ï¼Œ240ï¼Œ240ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.ControlLight-ï¼ˆ255ï¼Œ227ï¼Œ227ï¼Œ227ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæˆ‘ä»¬</font><font style="vertical-align: inherit;">å¯¹æ¥æ”¶åˆ°çš„å€¼ï¼ˆ</font><i><font style="vertical-align: inherit;">â€œ buttonfaceâ€</font></i><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">è°ƒç”¨é€†è½¬æ¢æ–¹æ³•</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FromHtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™å°†è·å¾—</font><font style="vertical-align: inherit;">é¢œè‰²</font><i><font style="vertical-align: inherit;">Controlï¼ˆ</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">255ã€240ã€240ã€240 </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¯ä»¥</font><font style="vertical-align: inherit;">ä»</font><i><font style="vertical-align: inherit;">FromHtml</font></i><font style="vertical-align: inherit;">è·å–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlLight</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¢œè‰²</font><font style="vertical-align: inherit;">å—ï¼Ÿ</font><font style="vertical-align: inherit;">æ˜¯çš„ </font><font style="vertical-align: inherit;">æ­¤æ–¹æ³•åŒ…å«é¢œè‰²è¡¨ï¼Œè¯¥è¡¨æ˜¯æ„æˆé¢œè‰²çš„åŸºç¡€ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼‰ã€‚</font><font style="vertical-align: inherit;">è¯¥è¡¨çš„åˆå§‹åŒ–ç¨‹åºåŒ…å«ä»¥ä¸‹è¡Œï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs">s_htmlSysColorTable[<span class="hljs-string"><span class="hljs-string">"threedhighlight"</span></span>] = ColorUtil.FromKnownColor(KnownColor.ControlLight);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FromHtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿”å›</font><i><font style="vertical-align: inherit;">â€œ threedhighlightâ€</font></i><font style="vertical-align: inherit;">å€¼</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlLightï¼ˆ</font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">255ã€227ã€227ã€227 </font></i><i><font style="vertical-align: inherit;">ï¼‰</font></i><font style="vertical-align: inherit;">é¢œè‰²</font><font style="vertical-align: inherit;">ã€‚æˆ‘è®¤ä¸ºï¼Œè¿™æ­£æ˜¯åœ¨</font><i><font style="vertical-align: inherit;">KnownColor.ControlLightæƒ…å†µä¸‹</font></i><font style="vertical-align: inherit;">åº”è¯¥ä½¿ç”¨çš„å†…å®¹</font><font style="vertical-align: inherit;">ã€‚</font><b><font style="vertical-align: inherit;">å‘è¡Œ60ï¼Œ</font></b><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä»</font><i><font style="vertical-align: inherit;">System.Text.RegularExpressions</font></i><font style="vertical-align: inherit;">é¡¹ç›®ä¸­</font><font style="vertical-align: inherit;">æ£€æŸ¥å‡ºä¸€äº›æœ‰è¶£çš„è­¦å‘Š</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TextposDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ var sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> remaining; sb.Append(runtextpos); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sb.Length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) sb.Append(<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span> - sb.Length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (runtextpos &gt; runtextbeg) sb.Append(RegexCharClass.CharDescription(runtext[runtextpos - <span class="hljs-number"><span class="hljs-number">1</span></span>])); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sb.Append(<span class="hljs-string"><span class="hljs-string">'^'</span></span>); sb.Append(<span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>); remaining = runtextend - runtextpos; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = runtextpos; i &lt; runtextend; i++) { sb.Append(RegexCharClass.CharDescription(runtext[i])); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sb.Length &gt;= <span class="hljs-number"><span class="hljs-number">64</span></span>) { sb.Length = <span class="hljs-number"><span class="hljs-number">61</span></span>; sb.Append(<span class="hljs-string"><span class="hljs-string">"..."</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { sb.Append(<span class="hljs-string"><span class="hljs-string">'$'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.ToString(); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3137</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†é…äº†â€œå‰©ä½™â€å˜é‡ï¼Œä½†åœ¨åŠŸèƒ½ç»“æŸæ—¶æœªä½¿ç”¨ã€‚ RegexRunner.cs 612 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ¬åœ°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰©ä½™</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡ä¸­</font><font style="vertical-align: inherit;">å†™å…¥äº†ä¸€ä¸ªå€¼</font><font style="vertical-align: inherit;">ï¼Œä½†è¯¥æ–¹æ³•ä¸å†ä½¿ç”¨å®ƒã€‚ä¹Ÿè®¸åˆ é™¤äº†ä¸€äº›ä½¿ç”¨å®ƒçš„ä»£ç ï¼Œä½†æ˜¯å˜é‡æœ¬èº«è¢«é—å¿˜äº†ã€‚æˆ–å­˜åœ¨ä¸¥é‡é”™è¯¯ï¼Œå¹¶ä¸”å¿…é¡»ä»¥æŸç§æ–¹å¼ä½¿ç”¨æ­¤å˜é‡ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬61æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddRange</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> first, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> last)</span></span></span><span class="hljs-function"> </span></span>{ _rangelist.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SingleRange(first, last)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_canonical &amp;&amp; _rangelist.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; first &lt;= _rangelist[_rangelist.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].Last) { _canonical = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3063</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ¡ä»¶è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†è¢«è¯„ä¼°ä¸ºï¼š_rangelist.Count&gt;0ã€‚RegexCharClass.cs 523 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ†æå™¨æ­£ç¡®åœ°æŒ‡å‡ºï¼Œè¡¨è¾¾å¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_rangelist.Count&gt; 0çš„ä¸€éƒ¨åˆ†</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†å§‹ç»ˆä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¦‚æœæ‰§è¡Œæ­¤ä»£ç ã€‚å³ä½¿æ­¤åˆ—è¡¨ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_rangelist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡å‘çš„</font><font style="vertical-align: inherit;">åˆ—è¡¨</font><font style="vertical-align: inherit;">ï¼‰ä¸ºç©ºï¼Œåœ¨æ·»åŠ å…ƒç´ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_rangelist.Addï¼ˆ....ï¼‰ä¹‹åï¼Œ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒä¹Ÿä¸ç›¸åŒã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‘è¡Œç¬¬62æœŸ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹</font><i><font style="vertical-align: inherit;">System.Drawing.Common</font></i><font style="vertical-align: inherit;">å’Œ</font><i><font style="vertical-align: inherit;">System.Transactions.Local</font></i><font style="vertical-align: inherit;">é¡¹ç›®</font><font style="vertical-align: inherit;">ä¸­çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯Šæ–­è§„åˆ™</font><font style="vertical-align: inherit;">è­¦å‘Š</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayEnumerator</span></span></span><span class="hljs-class"> :</span></span> IEnumerator { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> object[] _array; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> object _item; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _index; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _startIndex; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _endIndex; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ArrayEnumerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object[] </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">array</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> startIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count)</span></span></span><span class="hljs-function"> </span></span>{ _array = <span class="hljs-built_in"><span class="hljs-built_in">array</span></span>; _startIndex = startIndex; _endIndex = _index + count; _index = _startIndex; } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ„é€ å™¨ä¸­åˆå§‹åŒ–â€œ _indexâ€å­—æ®µä¹‹å‰ï¼Œå¿…é¡»å…ˆä½¿ç”¨è¯¥å­—æ®µã€‚ PrinterSettings.Windows.cs 1679 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆå§‹åŒ–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_endIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µæ—¶ï¼Œ</font><font style="vertical-align: inherit;">å°†ä½¿ç”¨</font><font style="vertical-align: inherit;">å¦ä¸€ä¸ª</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_index</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µï¼Œè¯¥å­—æ®µåœ¨ä½¿ç”¨æ—¶å…·æœ‰æ ‡å‡†å€¼</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">defaultï¼ˆintï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆå³</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_index</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µæ˜¯åˆå§‹åŒ–çš„ä¸‹æ–¹ã€‚å¦‚æœä¸æ˜¯é”™è¯¯</font><font style="vertical-align: inherit;">ï¼Œåˆ™æ­¤è¡¨è¾¾å¼ä¸­åº”çœç•¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_index</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡ï¼Œä»¥å…é€ æˆæ··æ·†ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬63æœŸ</font></font></b> <br><br><pre> <code class="cpp hljs">internal <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransactionTable</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _timerInterval; .... <span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TransactionTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Create a timer that is initially disabled by specifing // an Infinite time to the first interval _timer = new Timer(new TimerCallback(ThreadTimer), null, Timeout.Infinite, _timerInterval); .... // Store the timer interval _timerInterval = 1 &lt;&lt; TransactionTable.timerInternalExponent; .... } }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼š</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ„é€ å™¨ä¸­åˆå§‹åŒ–â€œ _timerIntervalâ€å­—æ®µä¹‹å‰ï¼Œ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;">è¯·å…ˆä½¿ç”¨</font></u></a><font style="vertical-align: inherit;">è¯¥å­—æ®µã€‚ TransactionTable.cs 151 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æƒ…å†µä¸ä»¥ä¸Šç±»ä¼¼ã€‚é¦–å…ˆï¼Œä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_timerInterval</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µ</font><font style="vertical-align: inherit;">çš„å€¼</font><font style="vertical-align: inherit;">ï¼ˆè™½ç„¶å®ƒä»ç„¶æ˜¯</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é»˜è®¤å€¼ï¼ˆintï¼‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰æ¥åˆå§‹åŒ–</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_timerã€‚</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åªæœ‰åœ¨æ­¤ä¹‹åï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_timerInterval</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µæœ¬èº«æ‰ä¼šè¢«åˆå§‹åŒ–ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—®é¢˜64é—®é¢˜</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯Šæ–­è§„åˆ™å‘å‡ºäº†ä¸‹ä¸€ä¸ªè­¦å‘Šï¼Œè¯¥è§„åˆ™ä»åœ¨å¼€å‘ä¸­ã€‚æ²¡æœ‰æ–‡æ¡£æˆ–æœ€ç»ˆä¿¡æ¯ï¼Œä½†æ˜¯åœ¨å®ƒçš„å¸®åŠ©ä¸‹æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†å‡ ä¸ªæœ‰è¶£çš„ç‰‡æ®µã€‚åŒæ ·ï¼Œè¿™äº›ç‰‡æ®µçœ‹èµ·æ¥åƒ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">copy-paste</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå› æ­¤æˆ‘ä»¬å°†ä»…è€ƒè™‘ä¸€ä¸ªä»£ç ç‰‡æ®µã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessNotifyConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... WeakReference reference = (WeakReference)( LdapConnection.s_handleTable[referralFromConnection]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( reference != null &amp;&amp; reference.IsAlive &amp;&amp; null != ((LdapConnection)reference.Target)._ldapHandle) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioè­¦å‘Šï¼ˆå­˜æ ¹ï¼‰ï¼š</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> VXXXX TODO_MESSAGEã€‚ LdapSessionOptions.cs 974 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠ€å·§æ˜¯ï¼Œåœ¨æ£€æŸ¥</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reference.IsAliveä¹‹å</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¯èƒ½ä¼šæ”¶é›†åƒåœ¾ï¼Œè€Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WeakReference</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡å‘</font><font style="vertical-align: inherit;">çš„å¯¹è±¡</font><font style="vertical-align: inherit;">å°†è¢«åƒåœ¾æ”¶é›†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Target</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†è¿”å›</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç©º</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¼ã€‚ç»“æœï¼Œå½“è®¿é—®å®ä¾‹å­—æ®µ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_ldapHandleæ—¶</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">å°†å‘ç”Ÿ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹</font><font style="vertical-align: inherit;">çš„å¼‚å¸¸</font><font style="vertical-align: inherit;">ã€‚ Microsoftè‡ªå·±ä½¿ç”¨æ”¯ç¥¨IsAliveè­¦å‘Šæ­¤é™·é˜±ã€‚ docs.microsoft.com-â€œ </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WeakReference.IsAliveå±æ€§</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€çš„</font><font style="vertical-align: inherit;">å¼•æ–‡</font><font style="vertical-align: inherit;">ï¼š</font></font><i>Because an object could potentially be reclaimed for garbage collection immediately after the IsAlive property returns true, using this property is not recommended unless you are testing only for a false return value.</i> <br><br><h2> Summary on Analysis </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨åˆ†æè¿‡ç¨‹ä¸­æ˜¯å¦æ‰¾åˆ°äº†æ‰€æœ‰è¿™äº›é”™è¯¯å’Œæœ‰è¶£çš„åœ°æ–¹ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼æŸ¥çœ‹åˆ†æç»“æœæ—¶ï¼Œæˆ‘æ­£åœ¨å½»åº•æ£€æŸ¥è­¦å‘Šã€‚éšç€æ•°é‡çš„å¢åŠ ï¼Œè€Œä¸”å¾ˆæ˜¾ç„¶æœ‰è¶³å¤Ÿçš„ç¯‡å¹…æ¥æ’°å†™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘æ­£åœ¨æµè§ˆç»“æœï¼Œè¯•å›¾ä»…é€‰æ‹©å¯¹æˆ‘è€Œè¨€æœ€æœ‰è¶£çš„é‚£äº›ã€‚å½“æˆ‘åˆ°è¾¾æœ€åä¸€ä¸ªï¼ˆæœ€å¤§çš„åŸæœ¨ï¼‰æ—¶ï¼Œæˆ‘åªèƒ½æŸ¥çœ‹è­¦å‘Šï¼Œç›´åˆ°å‘ç°å¼‚å¸¸æƒ…å†µä¸ºæ­¢ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨å››å¤„æŒ–æ˜ï¼Œæˆ‘ç›¸ä¿¡æ‚¨ä¼šæ‰¾åˆ°æ›´å¤šæœ‰è¶£çš„åœ°æ–¹ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œæˆ‘å‡ ä¹å¿½ç•¥äº†æ‰€æœ‰</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3063</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è­¦å‘Šã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼Œå¦‚æœæˆ‘é‡åˆ°è¿‡è¿™æ ·çš„ä»£ç ï¼š</font></font><br><br><pre> <code class="cpp hljs">String str = null; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str == null) ....</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä¼šå¿½ç•¥å®ƒï¼Œå› ä¸ºæˆ‘æƒ³æè¿°è®¸å¤šå…¶ä»–æœ‰è¶£çš„åœ°æ–¹ã€‚è¢«è­¦å‘Šï¼Œå¯¹æœ‰ä¸å®‰å…¨ä½¿ç”¨çš„é”</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lockè¯­å¥</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸é”å®š</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è¿™</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç­‰- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3090</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;ä¸å®‰å…¨äº‹ä»¶è°ƒç”¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-V3083</font></font></u></a> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼›</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹è±¡æ—¶ï¼Œå…¶ç±»å‹éƒ½å®ç°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">äº†IDisposable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†å¯¹äºå…¶ä¸­</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„Dispose</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…³é—­</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å«- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3072</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œå¹¿å‘Šå•†é€‰æ‹©ç›¸ä¼¼çš„è¯Šæ–­ç­‰ç­‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä¹Ÿæ²¡æœ‰æ³¨æ„åˆ°ç”¨æµ‹è¯•ç¼–å†™çš„é—®é¢˜ã€‚è‡³å°‘ï¼Œæˆ‘å°è¯•è¿‡ï¼Œä½†å¯èƒ½ä¼šä¸å°å¿ƒæœç”¨ä¸€äº›ã€‚é™¤äº†å‡ ä¸ªæˆ‘å‘ç°è¶³ä»¥å¼•èµ·äººä»¬æ³¨æ„çš„æœ‰è¶£åœ°æ–¹ã€‚ä½†æ˜¯æµ‹è¯•ä»£ç ä¹Ÿå¯èƒ½åŒ…å«é”™è¯¯ï¼Œç”±äºè¿™äº›é”™è¯¯ï¼Œæµ‹è¯•å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ï¼Œä»æœ‰è®¸å¤šäº‹æƒ…éœ€è¦è°ƒæŸ¥-ä½†æˆ‘æ— æ„æ ‡è®°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰å‘ç°çš„é—®é¢˜</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»£ç çš„è´¨é‡å¯¹æˆ‘æ¥è¯´ä¼¼ä¹å¹¶ä¸å¹³è¡¡ã€‚ä¸€äº›é¡¹ç›®éå¸¸å¹²å‡€ï¼Œå…¶ä»–é¡¹ç›®åŒ…å«å¯ç–‘çš„åœ°æ–¹ã€‚ä¹Ÿè®¸æˆ‘ä»¬å¯èƒ½å¸Œæœ›æœ‰ä¸€ä¸ªå¹²å‡€çš„é¡¹ç›®ï¼Œå°¤å…¶æ˜¯æ¶‰åŠæœ€å¸¸ç”¨çš„åº“ç±»æ—¶ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥è¯´è¯¥ä»£ç è´¨é‡å¾ˆé«˜ï¼Œå› ä¸ºå®ƒçš„æ•°é‡å¾ˆå¤šã€‚ä½†æ˜¯ï¼Œæ­£å¦‚æœ¬æ–‡æ‰€å»ºè®®çš„é‚£æ ·ï¼Œè¿™é‡Œæœ‰ä¸€äº›é˜´æš—çš„è§’è½ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™ä¸ªè§„æ¨¡çš„é¡¹ç›®å¯¹åˆ†æä»ªä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æµ‹è¯•ã€‚</font><font style="vertical-align: inherit;">æˆ‘è®¾æ³•æ‰¾åˆ°äº†ä¸€äº›æˆ‘é€‰æ‹©è¦ç ”ç©¶å’Œçº æ­£çš„é”™è¯¯/æ€ªå¼‚çš„è­¦å‘Šã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œä½œä¸ºåˆ†æçš„ç»“æœï¼Œæˆ‘è®¾æ³•æ‰¾åˆ°äº†å¿…é¡»åœ¨PVS-Studioæœ¬èº«ä¸Šè¿›è¡Œå·¥ä½œçš„åœ°æ–¹ã€‚</font></font><br><br><h2> ç»“è®º </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨é€šè¿‡é˜…è¯»æ•´ç¯‡æ–‡ç« åˆ°è¾¾äº†è¿™ä¸ªåœ°æ–¹-è®©æˆ‘æ¡æ‰‹ï¼</font><font style="vertical-align: inherit;">å¸Œæœ›æˆ‘èƒ½å¤Ÿå‘æ‚¨å±•ç¤ºæœ‰è¶£çš„é”™è¯¯å¹¶è¯æ˜é™æ€åˆ†æçš„å¥½å¤„ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨ä¸ºè‡ªå·±å­¦ä¹ äº†ä¸€äº›æ–°çŸ¥è¯†ï¼Œé‚£å°†ä½¿æ‚¨ç¼–å†™æ›´å¥½çš„ä»£ç -æˆ‘å°†å€åŠ é«˜å…´ã€‚</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ef/dbc/f2d/6efdbcf2d984bef000cf44face04c6a4.png" alt="å›¾ç‰‡23"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ— è®ºå¦‚ä½•ï¼Œé™æ€åˆ†æçš„ä¸€äº›å¸®åŠ©ä¸ä¼šå—åˆ°æŸå®³ï¼Œå› æ­¤å»ºè®®æ‚¨</font><font style="vertical-align: inherit;">åœ¨é¡¹ç›®ä¸Š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°è¯•ä½¿ç”¨PVS-Studio</font></font></u></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶æŸ¥çœ‹ä½¿ç”¨å®ƒå¯ä»¥å‘ç°å“ªäº›æœ‰è¶£çš„åœ°æ–¹ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®ï¼Œæˆ–è€…æ‚¨åªæƒ³åˆ†äº«å‘ç°çš„æœ‰è¶£ç‰‡æ®µï¼Œè¯·éšæ—¶å‘é€ç”µå­é‚®ä»¶è‡³</font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">support@viva64.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font> :) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æœ€å¥½çš„é—®å€™ï¼ </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PS for .NET Coreåº“å¼€å‘äººå‘˜ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éå¸¸æ„Ÿè°¢æ‚¨æ‰€åšçš„ä¸€åˆ‡ï¼</font><font style="vertical-align: inherit;">å¹²å¾—å¥½ï¼</font><font style="vertical-align: inherit;">å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©æ‚¨ä½¿ä»£ç æ›´å¥½ã€‚</font><font style="vertical-align: inherit;">è®°ä½ï¼Œæˆ‘è¿˜æ²¡æœ‰å†™æ‰€æœ‰å¯ç–‘çš„åœ°æ–¹ï¼Œæ‰€ä»¥æ‚¨æœ€å¥½è‡ªå·±ä½¿ç”¨åˆ†æä»ªæ£€æŸ¥é¡¹ç›®ã€‚</font><font style="vertical-align: inherit;">è¿™æ ·ï¼Œæ‚¨å°†èƒ½å¤Ÿè¯¦ç»†è°ƒæŸ¥æ‰€æœ‰è­¦å‘Šã€‚</font><font style="vertical-align: inherit;">è€Œä¸”ï¼Œä½¿ç”¨å®ƒä¼šæ¯”ä½¿ç”¨ç®€å•çš„æ–‡æœ¬æ—¥å¿—/é”™è¯¯åˆ—è¡¨ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘åœ¨è¿™é‡Œæ›´è¯¦ç»†åœ°ä»‹ç»è¿‡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰æ›´æ–¹ä¾¿ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN463535/">https://habr.com/ru/post/zh-CN463535/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN463513/index.html">2019å¹´æœ€ä½³Webå¼€å‘æ¡†æ¶</a></li>
<li><a href="../zh-CN463515/index.html">ä½¿ç”¨HTMS APIæ¥å¤„ç†å…³ç³»ç½‘ç»œæ•°æ®åº“</a></li>
<li><a href="../zh-CN463525/index.html">ç¡’ï¼Œç¡’åŒ–ç‰©ï¼Œç¡’åŒ–ç‰©ï¼Œç¡’åŒ–ç‰©â€¦â€¦è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</a></li>
<li><a href="../zh-CN463527/index.html">å¼¹å‡ºï¼ åœ¨iOSä¸Šè½¬å½•</a></li>
<li><a href="../zh-CN463533/index.html">æ¯ä¸ªå¼€å‘äººå‘˜ä»ä¸€å¼€å§‹å°±åº”è¯¥çŸ¥é“ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN463537/index.html">é€šè¿‡PVS-Studioé™æ€åˆ†æå™¨éªŒè¯.NET Coreåº“çš„æºä»£ç </a></li>
<li><a href="../zh-CN463541/index.html">åŸ¹è®­Cisco 200-125 CCNA v3.0ã€‚ ç¬¬17å¤©ã€‚CCNAè¯¾ç¨‹æ‘˜è¦å’Œè·¯çº¿å›¾</a></li>
<li><a href="../zh-CN463551/index.html">å¦‚ä½•ä¸å‘˜å·¥è”ç³»å¹¶ç»„ç»‡å¤§å‹ITå…¬å¸çš„å·¥ä½œæµç¨‹</a></li>
<li><a href="../zh-CN463553/index.html">â€œä½ æ˜¯è°·æ­Œäººå—ï¼Ÿâ€ æˆ–æˆ‘ä»¬å½•ç”¨æ—¶åšçš„5ä»¶äº‹ï¼ˆä½†ä¸å†ï¼‰</a></li>
<li><a href="../zh-CN463559/index.html">åŸ¹è®­Cisco 200-125 CCNA v3.0ã€‚ ç¬¬18å¤©ã€‚è·¯ç”±åŸºç¡€</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>