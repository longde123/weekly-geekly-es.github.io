<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ù§Ô∏è üß¶ üëÅÔ∏è Menulis obrolan dengan Python dan Django üèÇüèª üë∞üèº üèà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selamat siang teman Untuk mengantisipasi dimulainya kursus Pengembang Web Python, kami biasanya membagikan terjemahan yang bermanfaat kepada Anda. 


...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menulis obrolan dengan Python dan Django</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/475672/">  Selamat siang teman  Untuk mengantisipasi dimulainya kursus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengembang Web Python, kami</a> biasanya membagikan terjemahan yang bermanfaat kepada Anda. <br><br><img src="https://habrastorage.org/webt/lx/tm/i2/lxtmi2b8w8tafidzhcvdl0t2zf0.png"><br><hr><br>  <b><i>Anda melihat panduan di depan Anda yang memberi tahu Anda cara membuat aplikasi obrolan dengan Python, Django, dan React.</i></b> <br><br>  Tidak seperti manual lainnya, saya tidak menggunakan Python dan Django untuk koneksi WebSocket.  Terlepas dari kenyataan bahwa itu terdengar keren dari sudut pandang teknis, itu bekerja agak lamban dan mahal dalam dirinya sendiri, terutama jika Anda memiliki jumlah pengguna yang layak.  Bahasa seperti C ++, Go, dan Elixir melakukan pekerjaan yang jauh lebih baik dari inti obrolan. <a name="habracut"></a><br><br>  Dalam tutorial ini, kita akan menggunakan Stream, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">API obrolan</a> yang menangani koneksi WebSocket dan aspek berat lainnya menggunakan Go, Raft dan RocksDB. <br><br>  Konten: <br><br><ul><li>  Bereaksi antarmuka obrolan demo </li><li>  Instal Django / Python </li><li>  Otorisasi Pengguna </li><li>  Kerangka kerja Django </li><li>  Pembuatan token untuk akses ke server Stream chat </li><li>  Bereaksi Integrasi Otorisasi </li><li>  Mengirim pesan dari server Python </li><li>  Pikiran terakhir </li></ul><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Repositori Github dengan kode dari sebuah artikel</a> </blockquote><br>  Ayo mulai! <br><br><h3>  Langkah 1: Bereaksi Antarmuka Obrolan Demo </h3><br>  Sebelum kita mulai berpikir tentang bagian Python, mari kita gunakan antarmuka sederhana pada Bereaksi sehingga kita memiliki sesuatu yang indah dan visual: <br><br><pre><code class="python hljs">$ yarn <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> add create-react-app $ brew install node &amp;&amp; brew install yarn <span class="hljs-comment"><span class="hljs-comment"># skip if installed $ create-react-app chat-frontend $ cd chat-frontend $ yarn add stream-chat-react</span></span></code> </pre> <br>  Ganti kode di <code>src/App.js</code> dengan yang berikut ini: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Chat, Channel, ChannelHeader, Thread, Window } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat-react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { MessageList, MessageInput } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat-react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { StreamChat } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat-react/dist/css/index.css"</span></span>; const chatClient = new StreamChat(<span class="hljs-string"><span class="hljs-string">"qk4nn7rpcn75"</span></span>); // Demo Stream Key const userToken = <span class="hljs-string"><span class="hljs-string">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiY29vbC1za3ktOSJ9.mhikC6HPqPKoCP4aHHfuH9dFgPQ2Fth5QoRAfolJjC4"</span></span>; // Demo Stream Token chatClient.setUser( { id: <span class="hljs-string"><span class="hljs-string">"cool-sky-9"</span></span>, name: <span class="hljs-string"><span class="hljs-string">"Cool sky"</span></span>, image: <span class="hljs-string"><span class="hljs-string">"https://getstream.io/random_svg/?id=cool-sky-9&amp;name=Cool+sky"</span></span> }, userToken ); const channel = chatClient.channel(<span class="hljs-string"><span class="hljs-string">"messaging"</span></span>, <span class="hljs-string"><span class="hljs-string">"godevs"</span></span>, { // image <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> name are required, however, you can add custom fields image: <span class="hljs-string"><span class="hljs-string">"https://cdn.chrisshort.net/testing-certificate-chains-in-go/GOPHER_MIC_DROP.png"</span></span>, name: <span class="hljs-string"><span class="hljs-string">"Talk about Go"</span></span> }); const App = () =&gt; ( &lt;Chat client={chatClient} theme={<span class="hljs-string"><span class="hljs-string">"messaging light"</span></span>}&gt; &lt;Channel channel={channel}&gt; &lt;Window&gt; &lt;ChannelHeader /&gt; &lt;MessageList /&gt; &lt;MessageInput /&gt; &lt;/Window&gt; &lt;Thread /&gt; &lt;/Channel&gt; &lt;/Chat&gt; ); export default App;</code> </pre> <br>  Sekarang, gunakan perintah <code>yarn start</code> untuk melihat obrolan beraksi! <br><br><h3>  Langkah 2: Instal Django / Python (lewati langkah ini jika Anda sudah memiliki semua yang Anda butuhkan) </h3><br>  Pastikan Anda memiliki Python 3.7 dan sedang berjalan: <br><br><pre> <code class="python hljs">$ brew install python3 $ pip install virtualenv virtualenvwrapper $ export WORKON_HOME=~/Envs $ source /usr/local/bin/virtualenvwrapper.sh $ mkvirtualenv chatexample -p `which python3` $ workon chatexample</code> </pre> <br>  Jika tidak berhasil, coba kode berikut: <br><br><pre> <code class="python hljs">$ python3 -m venv chatexample $ source chatexample/bin/activate</code> </pre><br>  Sekarang Anda berada di lingkungan virtual Anda, Anda akan melihat python 3 saat startup: <br><br><pre> <code class="python hljs">$ python --version</code> </pre> <br>  Untuk membuat proyek baru di Django, gunakan kode berikut: <br><br><pre> <code class="python hljs">$ pip install django $ django-admin startproject mychat</code> </pre> <br>  Dan jalankan aplikasi: <br><br><pre> <code class="python hljs">$ cd mychat $ python manage.py runserver</code> </pre> <br>  Sekarang ketika Anda membuka <code>http://localhost:8000</code> , Anda akan melihat yang berikut: <br><br><img src="https://habrastorage.org/webt/hg/_j/ck/hg_jck6_6dk8lrk5rgrbndoogaw.png"><br><br><h3>  Langkah 3: Otorisasi Pengguna </h3><br>  Langkah selanjutnya adalah mengkonfigurasi otorisasi pengguna di Django. <br><br><pre> <code class="python hljs">$ python manage.py migrate $ python manage.py createsuperuser $ python manage.py runserver</code> </pre> <br>  Pergi ke <code>http://localhost:8000/admin/</code> dan masuk.  Voila! <br><br>  Anda akan melihat tab administrator yang mirip dengan yang di bawah ini: <br><br><img src="https://habrastorage.org/webt/0j/3l/nk/0j3lnkzotw_e8gxwf9fqsqdg0yc.png"><br><br><h3>  Langkah 4: Kerangka Django Rest </h3><br>  Salah satu paket favorit saya untuk mengintegrasikan Bereaksi dengan Django adalah Django Rest Framework.  Untuk membuatnya berfungsi, Anda perlu membuat titik akhir untuk: <br><br><ul><li>  Registrasi pengguna </li><li>  Login pengguna. </li></ul><br>  Kita bisa membuatnya sendiri, namun ada paket bernama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Djoser</a> yang menyelesaikan masalah ini.  Ini akan mengonfigurasi titik akhir API yang diperlukan untuk pendaftaran pengguna, masuk, mengatur ulang kata sandi, dll. <br><br>  Untuk menginstal Djoser, gunakan yang berikut ini: <br><br><pre> <code class="python hljs">$ pip install djangorestframework djoser</code> </pre> <br>  Setelah itu, edit <code>urls.py</code> dan ubah konten file sebagai berikut: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.contrib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> admin <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.urls <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> path, include urlpatterns = [ path(<span class="hljs-string"><span class="hljs-string">'admin/'</span></span>, admin.site.urls), path(<span class="hljs-string"><span class="hljs-string">'auth/'</span></span>, include(<span class="hljs-string"><span class="hljs-string">'djoser.urls'</span></span>)), path(<span class="hljs-string"><span class="hljs-string">'auth/'</span></span>, include(<span class="hljs-string"><span class="hljs-string">'djoser.urls.authtoken'</span></span>)), ]</code> </pre> <br>  Setelah selesai, edit <code>settings.py</code> dan buat perubahan: <br><br><pre> <code class="python hljs">INSTALLED_APPS = [ <span class="hljs-string"><span class="hljs-string">'django.contrib.admin'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.auth'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.contenttypes'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.sessions'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.messages'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.staticfiles'</span></span>, <span class="hljs-string"><span class="hljs-string">'rest_framework'</span></span>, <span class="hljs-string"><span class="hljs-string">'rest_framework.authtoken'</span></span>, <span class="hljs-string"><span class="hljs-string">'djoser'</span></span>, ] REST_FRAMEWORK = { <span class="hljs-string"><span class="hljs-string">'DEFAULT_AUTHENTICATION_CLASSES'</span></span>: ( <span class="hljs-string"><span class="hljs-string">'rest_framework.authentication.TokenAuthentication'</span></span>, ) }</code> </pre><br>  Untuk informasi lebih lanjut tentang titik akhir API yang disediakan Djoser, lihat yang berikut: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://djoser.readthedocs.io/en/latest/sample_usage.html</a> <br><br>  Sekarang mari kita lanjutkan dan uji endpoint pendaftaran: <br><br><pre> <code class="python hljs">$ curl -X POST http://<span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">8000</span></span>/auth/users/ --data <span class="hljs-string"><span class="hljs-string">'username=djoser&amp;password=alpine12'</span></span></code> </pre> <br><h3>  Langkah 5: Hasilkan Token untuk Mengakses Server Streaming Obrolan </h3><br>  Sekarang kita perlu mengonfigurasi tampilan Djoser untuk menghasilkan token Stream.  Jadi mari kita mulai. <br>  Mari kita sedikit mengatur file kita dan membuat folder aplikasi obrolan di proyek kami (pastikan Anda berada di direktori yang benar): <br><br><pre> <code class="python hljs">$ python manage.py startapp auth</code> </pre> <br>  Pasang streaming-obrolan: <br><br><pre> <code class="python hljs">$ pip install stream-chat</code> </pre> <br>  Buat serializer khusus di <code>auth/serializers.py</code> menggunakan logika berikut: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> djoser.serializers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TokenSerializer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rest_framework <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> serializers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> djoser.conf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> settings <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> djoser_settings <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> stream_chat <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StreamChat <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.conf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> settings <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StreamTokenSerializer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TokenSerializer)</span></span></span><span class="hljs-class">:</span></span> stream_token = serializers.SerializerMethodField() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-class">:</span></span> model = djoser_settings.TOKEN_MODEL fields = (<span class="hljs-string"><span class="hljs-string">'auth_token'</span></span>,<span class="hljs-string"><span class="hljs-string">'stream_token'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_stream_token</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, obj)</span></span></span><span class="hljs-function">:</span></span> client = StreamChat(api_key=settings.STREAM_API_KEY, api_secret=settings.STREAM_API_SECRET) token = client.create_token(obj.user.id) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> token</code> </pre> <br>  Terakhir, gunakan serializer khusus untuk memperbarui file <code>settings.py</code> : <br><br><pre> <code class="python hljs">STREAM_API_KEY = YOUR_STREAM_API_KEY <span class="hljs-comment"><span class="hljs-comment"># https://getstream.io/dashboard/ STREAM_API_SECRET = YOUR_STREAM_API_SECRET DJOSER = { 'SERIALIZERS': { 'token': 'auth.serializers.StreamTokenSerializer', } }</span></span></code> </pre> <br>  Mulai ulang migrasi: <br><br><pre> <code class="python hljs">$ python manage.py migrate</code> </pre> <br>  Untuk memverifikasi bahwa itu berfungsi, pergi ke titik akhir menggunakan permintaan POST: <br><br><pre> <code class="python hljs">$ curl -X POST http://<span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">8000</span></span>/auth/token/login/ --data <span class="hljs-string"><span class="hljs-string">'username=djoser&amp;password=alpine12'</span></span></code> </pre> <br>  Kembali harus <code>auth_token</code> dan <code>stream_token</code> . <br><br><h3>  Langkah 6: Integrasikan Otorisasi Bereaksi </h3><br>  Untuk alasan yang jelas, menambahkan otorisasi ke frontend adalah langkah penting.  Dalam kasus kami, ini sangat berguna, karena kami dapat mengekstrak token pengguna dari API (yang berjalan pada Python) dan menggunakannya secara dinamis saat mengirim pesan. <br><br>  Pertama, instal CORS, paket middleware untuk Django: <br><br><pre> <code class="python hljs">$ pip install django-cors-headers</code> </pre> <br>  Kemudian modifikasi file <code>settings.py</code> untuk merujuk ke <code>djors-cors-header</code> : <br><br><pre> <code class="python hljs">INSTALLED_APPS = ( ... <span class="hljs-string"><span class="hljs-string">'corsheaders'</span></span>, ... ) MIDDLEWARE = [ ... <span class="hljs-string"><span class="hljs-string">'corsheaders.middleware.CorsMiddleware'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.middleware.common.CommonMiddleware'</span></span>, ... ]</code> </pre> <br>  Terakhir, tambahkan yang berikut ke file <code>settings.py</code> Anda: <br><br><pre> <code class="python hljs">CORS_ORIGIN_ALLOW_ALL = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Langkah selanjutnya akan membutuhkan beberapa perubahan pada antarmuka Anda.  Untuk memulai, Anda harus memastikan bahwa Anda memiliki semua dependensi yang dipasang melalui benang: <br><br><pre> <code class="python hljs">$ yarn add axios react-dom react-router-dom</code> </pre> <br>  Selanjutnya, buat file-file berikut di direktori <code>src/</code> : <br><br><ul><li>  AuthedRoute.js </li><li>  UnauthedRoute.js </li><li>  denganSession.js </li><li>  Login.js </li><li>  Chat.js </li></ul><br><h4>  App.js </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BrowserRouter <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Router, Switch } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-router-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Chat <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./Chat"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Login <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./Login"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UnauthedRoute <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./UnauthedRoute"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AuthedRoute <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./AuthedRoute"</span></span>; const App = () =&gt; ( &lt;Router&gt; &lt;Switch&gt; &lt;UnauthedRoute path=<span class="hljs-string"><span class="hljs-string">"/auth/login"</span></span> component={Login} /&gt; &lt;AuthedRoute path=<span class="hljs-string"><span class="hljs-string">"/"</span></span> component={Chat} /&gt; &lt;/Switch&gt; &lt;/Router&gt; ); export default App;</code> </pre> <br><h4>  AuthedRoute.js </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Redirect, Route } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-router-dom"</span></span>; const AuthedRoute = ({ component: Component, loading, ...rest }) =&gt; { const isAuthed = Boolean(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">"token"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;Route {...rest} render={props =&gt; loading ? ( &lt;p&gt;Loading...&lt;/p&gt; ) : isAuthed ? ( &lt;Component history={props.history} {...rest} /&gt; ) : ( &lt;Redirect to={{ pathname: <span class="hljs-string"><span class="hljs-string">"/auth/login"</span></span>, state: { next: props.location } }} /&gt; ) } /&gt; ); }; export default AuthedRoute;</code> </pre> <br><h4>  UnauthedRoute.js </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Redirect, Route } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-router-dom"</span></span>; const AuthedRoute = ({ component: Component, loading, ...rest }) =&gt; { const isAuthed = Boolean(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">"token"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;Route {...rest} render={props =&gt; loading ? ( &lt;p&gt;Loading...&lt;/p&gt; ) : !isAuthed ? ( &lt;Component history={props.history} {...rest} /&gt; ) : ( &lt;Redirect to={{ pathname: <span class="hljs-string"><span class="hljs-string">"/"</span></span> }} /&gt; ) } /&gt; ); }; export default AuthedRoute;</code> </pre><br><h4>  denganSession.js </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withRouter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-router"</span></span>; export default (Component, unAuthed = false) =&gt; { const WithSession = ({ user = {}, streamToken, ...props }) =&gt; user.id || unAuthed ? ( &lt;Component userId={user.id} user={user} session={window.streamSession} {...props} /&gt; ) : ( &lt;Component {...props} /&gt; ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> withRouter(WithSession); };</code> </pre> <br><h4>  Login.js </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"axios"</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Login</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(props)</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">super</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(props)</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">state</span></span></span><span class="hljs-class"> = { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loading</span></span></span><span class="hljs-class">:</span></span> false, email: <span class="hljs-string"><span class="hljs-string">""</span></span>, password: <span class="hljs-string"><span class="hljs-string">""</span></span> }; this.initStream = this.initStream.bind(this); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> initStream() { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> this.setState({ loading: true }); const base = <span class="hljs-string"><span class="hljs-string">"http://localhost:8000"</span></span>; const formData = new FormData(); formData.set(<span class="hljs-string"><span class="hljs-string">"username"</span></span>, this.state.email); formData.set(<span class="hljs-string"><span class="hljs-string">"password"</span></span>, this.state.password); const registration = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> axios({ method: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, url: `${base}/auth/users/`, data: formData, config: { headers: { <span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>: <span class="hljs-string"><span class="hljs-string">"multipart/form-data"</span></span> } } }); const authorization = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> axios({ method: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, url: `${base}/auth/token/login/`, data: formData, config: { headers: { <span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>: <span class="hljs-string"><span class="hljs-string">"multipart/form-data"</span></span> } } }); localStorage.setItem(<span class="hljs-string"><span class="hljs-string">"token"</span></span>, authorization.data.stream_token); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> this.setState({ loading: false }); this.props.history.push(<span class="hljs-string"><span class="hljs-string">"/"</span></span>); } handleChange = e =&gt; { this.setState({ [e.target.name]: e.target.value }); }; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div className=<span class="hljs-string"><span class="hljs-string">"login-root"</span></span>&gt; &lt;div className=<span class="hljs-string"><span class="hljs-string">"login-card"</span></span>&gt; &lt;h4&gt;Login&lt;/h4&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> placeholder=<span class="hljs-string"><span class="hljs-string">"Email"</span></span> name=<span class="hljs-string"><span class="hljs-string">"email"</span></span> onChange={e =&gt; this.handleChange(e)} /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"password"</span></span> placeholder=<span class="hljs-string"><span class="hljs-string">"Password"</span></span> name=<span class="hljs-string"><span class="hljs-string">"password"</span></span> onChange={e =&gt; this.handleChange(e)} /&gt; &lt;button onClick={this.initStream}&gt;Submit&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; ); } } export default Login;</code> </pre> <br><h4>  Chat.js </h4><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Chat, Channel, ChannelHeader, Thread, Window } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat-react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { MessageList, MessageInput } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat-react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { StreamChat } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"stream-chat-react/dist/css/index.css"</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(props)</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">super</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(props)</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">client</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StreamChat</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"&lt;YOUR_STREAM_APP_ID&gt;"</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">client</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">setUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">( { id: </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"cool-sky-9"</span></span></span></span><span class="hljs-class"><span class="hljs-params">, name: </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"Cool Sky"</span></span></span></span><span class="hljs-class"><span class="hljs-params">, image: </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"https://getstream.io/random_svg/?id=cool-sky-9&amp;name=Cool+sky"</span></span></span></span><span class="hljs-class"><span class="hljs-params"> }, localStorage.getItem</span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-string">"token"</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> )</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">channel</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">client</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">channel</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"messaging"</span></span></span></span><span class="hljs-class"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"godevs"</span></span></span></span><span class="hljs-class"><span class="hljs-params">, { image: </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"https://cdn.chrisshort.net/testing-certificate-chains-in-go/GOPHER_MIC_DROP.png"</span></span></span></span><span class="hljs-class"><span class="hljs-params">, name: </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"Talk about Go"</span></span></span></span><span class="hljs-class"><span class="hljs-params"> })</span></span></span><span class="hljs-class">; } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">( &lt;Chat client={this.client} theme={</span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"messaging light"</span></span></span></span><span class="hljs-class"><span class="hljs-params">}&gt; &lt;Channel channel={this.channel}&gt; &lt;Window&gt; &lt;ChannelHeader /&gt; &lt;MessageList /&gt; &lt;MessageInput /&gt; &lt;/Window&gt; &lt;Thread /&gt; &lt;/Channel&gt; &lt;/Chat&gt; )</span></span></span><span class="hljs-class">; } } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">export</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">default</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class">;</span></span></code> </pre> <br>  Pastikan untuk mengganti <code>YOUR_STREAM_APP_ID</code> dengan ID aplikasi Stream yang valid, yang dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dasbor</a> . <br><br>  Mulai ulang aplikasi di ujung depan dan Anda akan melihat otorisasi!  Masukkan alamat email dan kata sandi Anda, token akan diminta dan disimpan di penyimpanan lokal. <br><br><h3>  Langkah 7: Mengirim Pesan dari Server Python </h3><br>  Jika Anda tiba-tiba ingin membuat API obrolan menggunakan backend Anda dengan Python, ada perintah khusus yang bisa Anda gunakan. <br><br>  Pastikan aplikasi yang terinstal terlihat seperti ini di <code>settings.py</code> : <br><br><pre> <code class="python hljs">INSTALLED_APPS = [ <span class="hljs-string"><span class="hljs-string">'corsheaders'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.admin'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.auth'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.contenttypes'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.sessions'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.messages'</span></span>, <span class="hljs-string"><span class="hljs-string">'django.contrib.staticfiles'</span></span>, <span class="hljs-string"><span class="hljs-string">'rest_framework'</span></span>, <span class="hljs-string"><span class="hljs-string">'rest_framework.authtoken'</span></span>, <span class="hljs-string"><span class="hljs-string">'djoser'</span></span>, ]</code> </pre> <br>  Selanjutnya, buat direktori obrolan / manajemen / perintah.  Dalam direktori ini, tambahkan file bernama <code>broadcast.py</code> dengan konten berikut: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.core.management.base <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BaseCommand, CommandError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.conf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> settings <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> stream_chat <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StreamChat <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseCommand)</span></span></span><span class="hljs-class">:</span></span> help = <span class="hljs-string"><span class="hljs-string">'Broadcast the message on your channel'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_arguments</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parser)</span></span></span><span class="hljs-function">:</span></span> parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--message'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args, **options)</span></span></span><span class="hljs-function">:</span></span> client = StreamChat(api_key=settings.STREAM_API_KEY, api_secret=settings.STREAM_API_SECRET) client.update_user({<span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"system"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"The Server"</span></span>}) channel = client.channel(<span class="hljs-string"><span class="hljs-string">"messaging"</span></span>, <span class="hljs-string"><span class="hljs-string">"kung-fu"</span></span>) channel.create(<span class="hljs-string"><span class="hljs-string">"system"</span></span>) response = channel.send_message({<span class="hljs-string"><span class="hljs-string">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"AMA about kung-fu"</span></span>}, <span class="hljs-string"><span class="hljs-string">'system'</span></span>) self.stdout.write(self.style.SUCCESS(<span class="hljs-string"><span class="hljs-string">'Successfully posted a message with id "%s"'</span></span> % response[<span class="hljs-string"><span class="hljs-string">'message'</span></span>][<span class="hljs-string"><span class="hljs-string">'id'</span></span>]))</code> </pre> <br>  Anda dapat mencoba mengirim pesan obrolan sebagai berikut: <br><br><pre> <code class="python hljs">$ python manage.py broadcast --message hello</code> </pre> <br>  Dan Anda akan melihat respons ini: <br><br><img src="https://habrastorage.org/webt/h4/bg/hk/h4bghkd6gdpg550-t16l3fsr3ty.png"><br><br><h3>  Pikiran terakhir </h3><br>  Saya harap Anda menikmati tutorial ini tentang membuat aplikasi obrolan dalam Django, Python, dan React! <br><br>  Untuk tur interaktif <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Stream Chat</a> , silakan lihat panduan kami tentang membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">API di situs web Stream</a> .  Jika Anda senang menggali kode untuk komponen Streaming Obrolan Bereaksi, Anda dapat menemukan dokumentasi lengkap di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Jika Anda ingin membuat obrolan di Stream, kami senang menawarkan berbagai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SDK</a> untuk bahasa populer dan kerangka kerja hingga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">iOS</a> terbaru <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">(Swift)</a> . <br><br>  Itu saja.  Sampai jumpa di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">webinar terbuka di Trik Django ORM</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id475672/">https://habr.com/ru/post/id475672/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id475660/index.html">Kata Baru dalam Backpacking: Temui Model Layar Pixel - Pengalaman LED dan Kesan-Kesan Saya</a></li>
<li><a href="../id475662/index.html">Kesalahan paling memalukan dalam karier saya sebagai programmer (saat ini)</a></li>
<li><a href="../id475666/index.html">50 UX Tips dalam Realitas Virtual</a></li>
<li><a href="../id475668/index.html">Terbakar. Pulihkan. Mulai lagi dari awal. Atau tidak?</a></li>
<li><a href="../id475670/index.html">Memperkenalkan Manajer API InterSystems</a></li>
<li><a href="../id475674/index.html">Tentang pasar pekerjaan yang sepenuhnya terpencil tanpa foto dari pantai</a></li>
<li><a href="../id475676/index.html">Didorong Insight-driven: Analisis Lanjut dan Manajemen Siklus Hidup Model Pembelajaran Alat Berat</a></li>
<li><a href="../id475678/index.html">Seperti kita mengajarkan pemasok melek komputer susu</a></li>
<li><a href="../id475684/index.html">@Pythonetc kompilasi, Oktober 2019</a></li>
<li><a href="../id475686/index.html">Kiat dan trik dari saluran Telegram saya @pythonetc, Oktober 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>