<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘« ğŸ“ ğŸ”³ Comment utiliser les interfaces dans Go ğŸ¤¸ğŸ¿ ğŸ‘©ğŸ¼â€ğŸŒ¾ â˜ƒï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans ses temps libres de l'Å“uvre principale, l'auteur du matÃ©riel consulte Go et analyse le code. Naturellement, au cours d'une telle activitÃ©, il lit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment utiliser les interfaces dans Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/411029/"><img src="https://habrastorage.org/webt/3r/a6/gf/3ra6gfzzmia3bmlydkdkqbmpl6a.jpeg"><br><br>  <i>Dans ses temps libres de l'Å“uvre principale, l'auteur du matÃ©riel consulte Go et analyse le code.</i>  <i>Naturellement, au cours d'une telle activitÃ©, il lit beaucoup de code Ã©crit par d'autres personnes.</i>  <i>RÃ©cemment, l'auteur de cet article a l'impression (oui, l'impression, pas de statistiques) que les programmeurs sont plus susceptibles de travailler avec des interfaces de Â«style JavaÂ».</i> <i><br><br></i>  <i>Cet article contient des recommandations de l'auteur sur l'utilisation optimale des interfaces dans Go, basÃ©es sur son expÃ©rience dans l'Ã©criture de code.</i> <br><br>  Dans les exemples de ce billet, nous utiliserons deux packages <code>animal</code> et <code>circus</code> .  Beaucoup de choses dans ce post dÃ©crivent le travail avec du code Ã  la limite de l'utilisation rÃ©guliÃ¨re des packages. <br><br><h3>  Comment ne pas faire </h3><br>  Un phÃ©nomÃ¨ne trÃ¨s courant que j'observe: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> animals <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Animal <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Speaks() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-comment"><span class="hljs-comment">//  Animal type Dog struct{} func (a Dog) Speaks() string { return "woof" }</span></span></code> </pre> <a name="habracut"></a><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> circus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"animals"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a animal.Animal)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.Speaks() }</code> </pre> <br>  C'est ce qu'on appelle l'utilisation d'interfaces de style Java.  Il peut Ãªtre caractÃ©risÃ© par les Ã©tapes suivantes: <br><br><ol><li>  DÃ©finissez une interface. </li><li>  DÃ©finissez un type qui satisfait le comportement de l'interface. </li><li>  DÃ©finissez des mÃ©thodes qui satisfont l'implÃ©mentation de l'interface. </li></ol><br>  En rÃ©sumÃ©, nous avons affaire Ã  des Â«types d'Ã©criture qui satisfont les interfacesÂ».  Ce code a sa propre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">odeur</a> distincte, suggÃ©rant les pensÃ©es suivantes: <br><br><ul><li>  Un seul type satisfait l'interface, sans aucune intention de l'Ã©tendre davantage. </li><li>  Les fonctions prennent gÃ©nÃ©ralement des types concrets au lieu de types d'interface. </li></ul><br><h3>  Comment faire Ã  la place </h3><br>  Les interfaces dans Go encouragent une approche paresseuse, ce qui est bien.  Au lieu d'Ã©crire des types qui satisfont aux interfaces, vous devez Ã©crire des interfaces qui rÃ©pondent Ã  de rÃ©elles exigences pratiques. <br><br>  Ce qui signifie: au lieu de dÃ©finir <code>Animal</code> dans le package <code>animals</code> , dÃ©finissez-le au point d'utilisation, c'est-Ã -dire le package <code>circus</code> <abbr title="Vous pouvez, bien sÃ»r, le dÃ©finir dans une signature de fonction, mais c'est une approche trop bÃ¢clÃ©e">*</abbr> . <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> animals <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Dog <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a Dog)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Speaks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"woof"</span></span> }</code> </pre> <br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> circus <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Speaker <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Speaks() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a Speaker)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.Speaks() }</code> </pre> <br>  Une faÃ§on plus naturelle de procÃ©der est la suivante: <br><br><ol><li>  DÃ©finir les types </li><li>  DÃ©finissez l'interface au point d'utilisation. </li></ol><br>  Cette approche rÃ©duit la dÃ©pendance Ã  l'Ã©gard des composants de l'emballage des <code>animals</code> .  RÃ©duire les dÃ©pendances est le bon moyen de crÃ©er un logiciel tolÃ©rant aux pannes. <br><br><h3>  La loi du lit </h3><br>  Il existe un bon principe pour Ã©crire un bon logiciel.  C'est la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">loi de Postel</a> , qui est souvent formulÃ©e comme suit: <br><blockquote>  "Soyez conservateur sur ce que vous rÃ©fÃ©rez et libÃ©ral sur ce que vous acceptez" </blockquote>  En termes de Go, la loi est: <br><br><blockquote>  "Accepter les interfaces, retourner les structures" </blockquote><br>  Dans l'ensemble, c'est une trÃ¨s bonne rÃ¨gle pour concevoir des choses stables et tolÃ©rantes aux pannes <abbr title="Bien sÃ»r, il y a des nuances que j'omets. Par exemple, dans les cas avec du code contextuel, il sera trÃ¨s utile d'accepter et de donner des interfaces)">*</abbr> .  L'unitÃ© principale de code dans Go est une fonction.  Lors de la conception de fonctions et de mÃ©thodes, il est utile de respecter le modÃ¨le suivant: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">funcName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a INTERFACETYPE)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CONCRETETYPE</span></span></span></span></code> </pre> <br>  Ici, nous acceptons tout ce qui implÃ©mente une interface qui peut Ãªtre n'importe quoi, y compris une interface vide.  Une valeur d'un type spÃ©cifique est suggÃ©rÃ©e.  Bien sÃ»r, limiter ce qui peut Ãªtre logique est logique.  Comme le dit un proverbe Go: <br><br><blockquote>  "L'interface vide ne dit rien", <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rob Pike</a> </blockquote><br>  Par consÃ©quent, il est fortement conseillÃ© d'empÃªcher les fonctions d'accepter l' <code>interface{}</code> . <br><br><h3>  Exemple d'application: imitation </h3><br>  Les cas types constituent un exemple frappant des avantages de l'application de la loi Postel.  Disons que vous avez une fonction qui ressemble Ã  ceci: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Takes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db Database)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span></code> </pre> <br>  Si la <code>Database</code> est une interface, alors dans le code de test, vous pouvez simplement fournir une imitation de l'implÃ©mentation de la <code>Database</code> sans avoir Ã  passer un vÃ©ritable objet DB. <br><br><h3>  Lorsque la dÃ©finition d'une interface Ã  l'avance est acceptable </h3><br>  Pour vous dire la vÃ©ritÃ©, la programmation est un moyen assez libre d'exprimer des idÃ©es.  Il n'y a pas de rÃ¨gles inÃ©branlables.  Bien sÃ»r, vous pouvez toujours dÃ©finir des interfaces Ã  l'avance, sans craindre d'Ãªtre arrÃªtÃ© par la police du code.  Dans le contexte de nombreux packages, si vous connaissez vos fonctions et avez l'intention d'accepter une interface spÃ©cifique au sein du package, faites-le. <br><br>  DÃ©finir une interface dÃ©gage gÃ©nÃ©ralement une ingÃ©nierie excessive, mais il y a des situations dans lesquelles vous devriez Ã©videmment faire exactement cela.  En particulier, les exemples suivants me viennent Ã  l'esprit: <br><br><ul><li>  Interfaces scellÃ©es </li><li>  Types de donnÃ©es abstraits </li><li>  Interfaces rÃ©cursives </li></ul><br>  Ensuite, nous examinons briÃ¨vement chacun d'eux. <br><br><h3>  Interfaces scellÃ©es </h3><br>  Les interfaces scellÃ©es ne peuvent Ãªtre discutÃ©es que dans le contexte de plusieurs packages.  Une interface scellÃ©e est une interface avec des mÃ©thodes non exportÃ©es.  Cela signifie que les utilisateurs en dehors de ce package ne peuvent pas crÃ©er de types qui satisfont cette interface.  Ceci est utile pour Ã©muler un type variant afin de rechercher de maniÃ¨re exhaustive les types satisfaisant l'interface. <br><br>  Si vous avez dÃ©fini quelque chose comme ceci: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Fooer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Foo() sealed() }</code> </pre> <br>  Seul le package dÃ©fini par <code>Fooer</code> peut l'utiliser et en crÃ©er quelque chose de valeur.  Cela vous permet de crÃ©er des opÃ©rateurs de commutateur Ã  force brute pour les types. <br><br>  L'interface scellÃ©e permet Ã©galement aux outils d'analyse de dÃ©tecter facilement toutes les correspondances de motif de non-collision.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le package sumtypes</a> de BurntSushi vise Ã  rÃ©soudre ce problÃ¨me. <br><br><h3>  Types de donnÃ©es abstraits </h3><br>  Un autre cas de dÃ©finition prÃ©alable d'une interface implique la crÃ©ation de types de donnÃ©es abstraits.  Ils peuvent Ãªtre scellÃ©s ou non scellÃ©s. <br><br>  Un bon exemple de ceci est le package de <code>sort</code> , qui fait partie de la bibliothÃ¨que standard.  Il dÃ©finit une collection triable comme suit <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Len â€”    . Len() int // Less      //   i     j. Less(i, j int) bool // Swap     i  j. Swap(i, j int) }</span></span></code> </pre> <br>  Ce morceau de code a bouleversÃ© beaucoup de gens, car si vous voulez utiliser le package de <code>sort</code> , vous devrez implÃ©menter des mÃ©thodes pour l'interface.  Beaucoup n'aiment pas la nÃ©cessitÃ© d'ajouter trois lignes de code supplÃ©mentaires. <br><br>  Cependant, je trouve que c'est une forme trÃ¨s Ã©lÃ©gante de gÃ©nÃ©riques dans Go.  Son utilisation devrait Ãªtre plus souvent encouragÃ©e. <br><br>  Des options de conception alternatives et en mÃªme temps Ã©lÃ©gantes nÃ©cessiteront des types d'ordre supÃ©rieur.  Dans cet article, nous ne les examinerons pas. <br><br><h3>  Interfaces rÃ©cursives </h3><br>  C'est probablement un autre exemple de code avec un stock, mais il y a des moments oÃ¹ il est tout simplement impossible d'Ã©viter de l'utiliser.  Des manipulations simples vous permettent d'obtenir quelque chose comme <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Fooer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Foo() Fooer }</code> </pre> <br>  Un modÃ¨le d'interface rÃ©cursif nÃ©cessitera Ã©videmment sa dÃ©finition Ã  l'avance.  La recommandation de dÃ©finition d'interface de point d'utilisation n'est pas applicable ici. <br><br>  Ce modÃ¨le est utile pour crÃ©er des contextes contenant des travaux ultÃ©rieurs.  Le code chargÃ© par le contexte s'enferme gÃ©nÃ©ralement Ã  l'intÃ©rieur du package avec l'exportation uniquement des contextes (ala le package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tensor</a> ), donc, dans la pratique, je rencontre ce cas pas si souvent.  Je peux vous dire autre chose sur les modÃ¨les contextuels, mais laissez-le pour un autre post. <br><br><h3>  Conclusion </h3><br>  MalgrÃ© le fait que lâ€™une des rubriques de lâ€™article soit Â«Comment ne pas le faireÂ», je nâ€™essaie en aucun cas dâ€™interdire quoi que ce soit.  Je veux plutÃ´t inciter les lecteurs Ã  rÃ©flÃ©chir plus souvent aux conditions frontaliÃ¨res, car c'est dans de tels cas que diverses situations d'urgence surviennent. <br><br>  Je trouve le principe de la dÃ©claration du point d'utilisation extrÃªmement utile.  Du fait de son application dans la pratique, je ne rencontre pas de problÃ¨mes qui se posent si je le nÃ©glige. <br><br>  Cependant, j'Ã©cris aussi occasionnellement des interfaces de style Java.  En rÃ¨gle gÃ©nÃ©rale, cela se produit si, peu de temps avant, j'Ã©crivais beaucoup de code en Java ou en Python.  Le dÃ©sir de trop compliquer et de Â«tout reprÃ©senter sous forme de classesÂ» est parfois trÃ¨s fort, surtout si vous Ã©crivez du code Go aprÃ¨s avoir Ã©crit beaucoup de code orientÃ© objet. <br><br>  Ainsi, ce message sert Ã©galement de rappel Ã  soi-mÃªme Ã  quoi ressemble le chemin pour Ã©crire du code qui ne causera pas de maux de tÃªte par la suite.  En attendant vos commentaires! <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="image"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr411029/">https://habr.com/ru/post/fr411029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr411017/index.html">La solitude du nÃ©. DÃ©veloppement par le vol. Difficile pour vous</a></li>
<li><a href="../fr411019/index.html">Pour quitter la Russie et trouver du travail Ã  l'Ã©tranger: nous nous prÃ©parons pour un entretien en anglais</a></li>
<li><a href="../fr411021/index.html">Sunlike - la nouvelle gÃ©nÃ©ration de lumiÃ¨re LED</a></li>
<li><a href="../fr411023/index.html">AnthropocÃ¨ne africain</a></li>
<li><a href="../fr411027/index.html">Jeux olympiques scolaires: Jedi Sword, Jetpack et Teleport to 2035</a></li>
<li><a href="../fr411031/index.html">Le premier scanner MEG portable au monde</a></li>
<li><a href="../fr411033/index.html">Â«FaireÂ», Â«comprendreÂ», Â«accepterÂ»: synonymes en anglais</a></li>
<li><a href="../fr411035/index.html">Ou peut-Ãªtre que vous dormez maintenant?</a></li>
<li><a href="../fr411037/index.html">Sochi.Camera: comment un fournisseur rÃ©gional a crÃ©Ã© un site de diffusion vidÃ©o avec une visite de 500 000 personnes par mois</a></li>
<li><a href="../fr411039/index.html">Le deuxiÃ¨me contact, ou Ã  la place de l'Ã©pilogue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>