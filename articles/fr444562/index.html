<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüåæ ‚óªÔ∏è üë®üèæ‚Äçüéì Modernisation de GHIDRA. Chargeur pour rhum Sega Mega Drive üì™ üë£ üë®üèæ‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salutations, camarades. Je n'ai pas entendu parler du GHIDRA , qui n'est pas encore open-source, probablement seulement un ing√©nieur invers√© sourd / a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modernisation de GHIDRA. Chargeur pour rhum Sega Mega Drive</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444562/"><p><img src="https://habrastorage.org/webt/_v/rj/sh/_vrjshbx1kl_9rudbdgaly0wd8c.png"></p><br><p> Salutations, camarades.  Je n'ai pas entendu parler du <code>GHIDRA</code> , qui n'est pas encore open-source, probablement seulement un ing√©nieur invers√© sourd / aveugle / muet / sans Internet.  Ses capacit√©s pr√™tes √† l'emploi sont incroyables: d√©compilateurs pour tous les processeurs pris en charge, simple ajout de nouvelles architectures (avec d√©compilation active imm√©diate due √† une conversion comp√©tente en IR), un tas de scripts qui simplifient la vie, la possibilit√© d' <code>Undo</code> / <code>Redo</code> ... Et ce n'est qu'une tr√®s petite partie de toutes les fonctionnalit√©s fournies.  Dire que j'ai √©t√© impressionn√©, c'est ne rien dire. <a name="habracut"></a></p><br><p>  Donc, dans cet article, je voudrais vous dire comment j'ai √©crit mon premier module pour <code>GHIDRA</code> - un chargeur de rhum pour les jeux pour <code>Sega Mega Drive / Genesis</code> .  Pour l'√©crire, il me fallait ... juste quelques heures!  Allons-y. </p><br><div class="spoiler">  <b class="spoiler_title">Mais qu'en est-il de l'IDA?</b> <div class="spoiler_text"><p>  J'ai pass√© quelques jours √† comprendre le processus d'√©criture des t√©l√©chargeurs pour l' <code>IDA</code> .  Il s'agissait alors de la version <code>6.5</code> , semble-t-il, mais √† l'√©poque il y avait beaucoup de probl√®mes avec la documentation du SDK. </p></div></div><br><h2 id="podgotavlivaem-sredu-razrabotki">  Nous pr√©parons l'environnement de d√©veloppement </h2><br><p>  <code>GHIDRA</code> d√©veloppeurs de <code>GHIDRA</code> ont pens√© √† presque tout ( <em>Ilfak</em> , o√π √©tiez-vous avant?).  Et, juste pour simplifier la mise en ≈ìuvre de la nouvelle fonctionnalit√©, ils ont d√©velopp√© un plug-in pour <code>Eclipse</code> - <code>GhidraDev</code> , qui " <em>aide</em> " en fait √† √©crire du code.  Le plugin est int√©gr√© dans l'environnement de d√©veloppement et vous permet de cr√©er des mod√®les de projet pour les scripts, les chargeurs, les modules de processeur et les extensions pour eux, ainsi que d'exporter des modules (si je comprends bien, c'est une sorte d'exportation des donn√©es d'un projet) en quelques clics. </p><br><p>  Pour installer le plugin, t√©l√©chargez <code>Eclipse</code> pour <code>Java</code> , cliquez sur <code>Help</code> -&gt; <code>Install New Software...</code> , puis cliquez sur le bouton <code>Add</code> et ouvrez la bo√Æte de dialogue de s√©lection d'archive avec le plugin √† l'aide du bouton <code>Archive...</code>  L'archive avec <code>GhidraDev</code> se trouve dans le <code>$(GHIDRA)/Extensions/Eclipse/GhidraDev</code> .  S√©lectionnez-le, cliquez sur le bouton <code>Add</code> . </p><br><p><img src="https://habrastorage.org/webt/iq/ox/e3/iqoxe3k8b5www3rqb6i0cy_xadg.png"></p><br><p>  Dans la liste qui appara√Æt, mettez un daw sur <code>Ghidra</code> , cliquez sur <code>Next &gt;</code> , acceptez les accords, cliquez sur <code>Install Anyway</code> (car le plugin n'a pas de signature) et red√©marrez <code>Eclipse</code> . </p><br><p><img src="https://habrastorage.org/webt/h_/5h/_a/h_5h_auzh5po7rvzaaywyvzxz9o.png"></p><br><p>  Au total, un nouvel √©l√©ment <code>GhidraDev</code> appara√Ætra dans le <code>GhidraDev</code> IDE pour la cr√©ation et la distribution pratiques de vos projets (bien s√ªr, vous pouvez √©galement cr√©er via l'assistant habituel pour les nouveaux projets <code>Eclipse</code> ).  De plus, nous avons la possibilit√© de d√©boguer le plug-in ou le script d√©velopp√©. </p><br><p><img src="https://habrastorage.org/webt/ka/3m/tg/ka3mtgmipvkbbmib3bilgamwe44.png"></p><br><div class="spoiler">  <b class="spoiler_title">Et o√π est le d√©bogueur d'application?</b> <div class="spoiler_text"><p>  Ce qui <code>GHIDRA</code> vraiment la situation avec <code>GHIDRA</code> sont les putains d'articles hype rauques contenant presque le m√™me mat√©riel, ce qui, d'ailleurs, n'est pas vrai.  Un exemple?  Oui, s'il vous pla√Æt: </p><br><blockquote>  La version actuelle de l'outil est 9.0.  et l'outil a des options pour inclure des fonctionnalit√©s suppl√©mentaires telles que la cryptanalyse, l'interaction avec OllyDbg, le d√©bogueur Ghidra. </blockquote><p>  Et o√π est tout √ßa?  Non! </p><br><p>  Le deuxi√®me point: l'ouverture.  En fait, il est presque l√†, mais il est pratiquement inexistant.  La <code>GHIDRA</code> contient des codes sources pour les composants qui ont √©t√© √©crits en <code>Java</code> , mais si vous regardez les scripts <code>Gradle</code> , vous pouvez voir qu'il existe des d√©pendances sur un tas de projets externes √† partir de projets secrets <del>  laboratoires </del>  <code>NSA</code> . <br>  Au moment de l'√©criture, il n'y a pas de d√©compilateur et de <code>SLEIGH</code> (c'est un utilitaire pour compiler les descriptions des modules de processeur et les conversions en IR). </p><br><p>  Eh bien, eh bien, je suis distrait par quelque chose. </p></div></div><br><p>  Cr√©ons donc un nouveau projet dans <code>Eclipse</code> . </p><br><h2 id="sozdayom-proekt-zagruzchika">  Cr√©er un projet de chargeur </h2><br><p>  <code>GhidraDev</code> -&gt; <code>New</code> -&gt; <code>Ghidra Module Project...</code> </p><br><p>  Nous indiquons le nom du projet (nous prenons en compte que les mots de type <code>Loader</code> seront coll√©s aux noms de fichiers, et afin de ne pas obtenir quelque chose comme <code>sega_loaderLoader.java</code> , nous les <code>sega_loaderLoader.java</code> en cons√©quence). </p><br><p><img src="https://habrastorage.org/webt/ok/iq/kx/okiqkxnztehs89bnjh3wzen848w.png"></p><br><p>  Cliquez sur <code>Next &gt;</code> .  Ici, nous mettons les griffes devant les cat√©gories dont nous avons besoin.  Dans mon cas, ce n'est qu'un <code>Loader</code> .  Cliquez sur <code>Next &gt;</code> . </p><br><p><img src="https://habrastorage.org/webt/3g/-c/_6/3g-c_6t4e10co47udy8txa7udiq.png"></p><br><p>  Ici, nous indiquons le chemin d'acc√®s au r√©pertoire avec <code></code> .  Cliquez sur <code>Next &gt;</code> . </p><br><p><img src="https://habrastorage.org/webt/9p/j6/kc/9pj6kcva-wqfiggwzf3itwssqm8.png"></p><br><p>  <code>GHIDRA</code> permet d'√©crire des scripts en python (via <code>Jython</code> ).  J'√©crirai en <code>Java</code> , donc je ne mets pas de b√¢ton.  J'appuie sur <code>Finish</code> . </p><br><p><img src="https://habrastorage.org/webt/_d/dr/z5/_ddrz5hnlfc0g-fnztl248er0tw.png"></p><br><h2 id="pishem-kod">  √âcrire un code </h2><br><p>  L'arbre de projet vide semble impressionnant: </p><br><p><img src="https://habrastorage.org/webt/mn/vf/fx/mnvffx-jubdk6uqdcpw5njysqfe.png"></p><br><p>  Tous les fichiers avec du code <code>java</code> trouvent dans la branche <code>/src/main/java</code> : </p><br><p><img src="https://habrastorage.org/webt/xz/sx/6_/xzsx6_dw-avgpgufemblxrnbutm.png"></p><br><h3 id="getname">  getName () </h3><br><p>  Pour commencer, choisissons un nom pour le chargeur de d√©marrage.  La m√©thode <code>getName()</code> renvoie: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Sega Mega Drive / Genesis Loader"</span></span>; }</code> </pre> <br><h3 id="findsupportedloadspecs">  findSupportedLoadSpecs () </h3><br><p>  La m√©thode <code>findSupportedLoadSpecs()</code> d√©cide (sur la base des donn√©es contenues dans le fichier binaire) quel module processeur doit √™tre utilis√© pour le d√©montage (ainsi que dans l' <code>IDA</code> ).  Dans la terminologie <code>GHIDRA</code> cela s'appelle le <code>Compiler Language</code> .  Il comprend: processeur, endianness, bitness et compilateur (si connu). </p><br><p>  Cette m√©thode renvoie une liste des architectures et langages pris en charge.  Si les donn√©es sont au mauvais format, nous renvoyons simplement une liste vide. </p><br><p>  Ainsi, dans le cas de <code>Sega Mega Drive</code> , le mot " <code>SEGA</code> " est le plus souvent pr√©sent √† l'offset <code>0x100</code> t√™te (ce n'est pas une condition pr√©alable, mais il est rempli dans 99% des cas).  Vous devez v√©rifier si cette ligne se trouve dans le fichier import√©.  Pour ce faire, le <code>ByteProvider provider</code> est <code>ByteProvider provider</code> <code>findSupportedLoadSpecs()</code> , avec laquelle nous travaillerons avec le fichier. </p><br><p>  Nous cr√©ons un objet <code>BinaryReader</code> , pour la commodit√© de lire les donn√©es d'un fichier: </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  Le <code>false</code> argument dans ce cas indique l'utilisation de <code>Big Endian</code> lors de la lecture.  Maintenant, lisons la ligne.  Pour ce faire, utilisez la <code>readAsciiString(offset, size)</code> de l'objet <code>reader</code> : </p><br><pre> <code class="java hljs">reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))</code> </pre> <br><p>  Si <code>equals()</code> renvoie <code>true</code> , alors nous avons affaire au rhum Segov, et dans la liste <code>List&lt;LoadSpec&gt; loadSpecs = new ArrayList&lt;&gt;();</code>  il sera possible d'ajouter le Motorola <code>m68k</code> .  Pour ce faire, cr√©ez un nouvel objet de type <code>LoadSpec</code> , dont le constructeur accepte un objet chargeur (dans ce cas, <code>this</code> ), <code>ImageBase</code> , dans lequel la ROM sera charg√©e, un objet de type <code>LanguageCompilerSpecPair</code> et un drapeau - est-ce que <code>LoadSpec</code> parmi les autres de la liste (oui, dans la liste) il peut y avoir plusieurs <code>LoadSpec</code> ). </p><br><p>  Le format constructeur pour <code>LanguageCompilerSpecPair</code> le suivant: </p><br><ol><li>  Le premier argument est <code>languageID</code> , une cha√Æne de la forme " <em>ProcessorName: Endianness: Bits: ExactCpu</em> ".  Dans mon cas, il devrait s'agir de la ligne " <em>68000: BE: 32: MC68020</em> " (malheureusement, exactement le <code>MC68000</code> n'est pas inclus dans la livraison, mais ce n'est pas un tel probl√®me).  <code>ExactCpu</code> peut √™tre <code>default</code> </li><li>  Le deuxi√®me argument, <code>compilerSpecID</code> , pour trouver ce que vous devez sp√©cifier ici, se trouve dans le r√©pertoire avec les descriptions du processeur <code></code> ( <code>$(GHIDRA)/Ghidra/Processors/68000/data/languages</code> ) dans le fichier <code>68000.opinion</code> .  Nous voyons que seul le <code>default</code> est indiqu√© ici.  En fait, nous l'indiquons </li></ol><br><p>  En cons√©quence, nous avons le code suivant (comme vous pouvez le voir, rien de compliqu√© jusqu'√† pr√©sent): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Collection&lt;LoadSpec&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findSupportedLoadSpecs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ List&lt;LoadSpec&gt; loadSpecs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))) { loadSpecs.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoadSpec(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageCompilerSpecPair(<span class="hljs-string"><span class="hljs-string">"68000:BE:32:MC68020"</span></span>, <span class="hljs-string"><span class="hljs-string">"default"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadSpecs; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">La diff√©rence entre IDA et GHIDRA en termes de modules</b> <div class="spoiler_text"><p>  Il y a une diff√©rence, et elle est toujours tr√®s forte.  Dans <code>GHIDRA</code> vous pouvez √©crire un projet qui comprendra diff√©rentes architectures, diff√©rents formats de donn√©es, √™tre un chargeur, un module de processeur, l'expansion de la fonctionnalit√© de d√©compilation et d'autres goodies. </p><br><p>  Dans <code>IDA</code> , il s'agit d'un projet distinct pour chaque type de module compl√©mentaire. </p><br><p>  Combien plus pratique?  √Ä mon avis, chez <code>GHIDRA</code> - parfois! </p></div></div><br><h3 id="load">  charge () </h3><br><p>  Dans cette m√©thode, nous allons cr√©er des segments, traiter les donn√©es d'entr√©e, cr√©er du code et des √©tiquettes pr√©c√©demment connues.  Pour ce faire, les objets suivants sont soumis pour nous aider √† l'entr√©e: </p><br><ol><li>  <code>ByteProvider provider</code> : nous le connaissons d√©j√†.  Utilisation de donn√©es de fichiers binaires </li><li>  <code>LoadSpec loadSpec</code> : sp√©cification de l'architecture s√©lectionn√©e lors de la phase d'importation du fichier √† l'aide de la m√©thode <code>findSupportedLoadSpecs</code> .  Cela est n√©cessaire si, par exemple, nous sommes capables de travailler avec plusieurs formats de donn√©es dans un module.  Pratique </li><li>  <code>List&lt;Option&gt; options</code> : liste des options (y compris personnalis√©es).  Je n'ai pas encore appris √† travailler avec eux </li><li>  <code>Program program</code> : l'objet principal qui donne acc√®s √† toutes les fonctionnalit√©s n√©cessaires: listage, espace d'adressage, segments, √©tiquettes, cr√©ation de tableaux, etc. </li><li>  <code>MemoryConflictHandler handler</code> et <code>TaskMonitor monitor</code> : nous devons rarement travailler directement avec eux (g√©n√©ralement, simplement en passant ces objets √† des m√©thodes pr√™tes √† l'emploi) </li><li>  <code>MessageLog log</code> : enregistreur lui-m√™me </li></ol><br><p>  Donc, pour commencer, cr√©ons des objets qui simplifieront notre travail avec les entit√©s <code>GHIDRA</code> et les donn√©es existantes.  Bien s√ªr, nous aurons certainement besoin de <code>BinaryReader</code> : </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  Ensuite.  Il nous sera tr√®s utile et simplifiera presque tout l'objet de la classe <code>FlatProgramAPI</code> (vous verrez plus loin ce que vous pouvez en faire): </p><br><pre> <code class="java hljs">FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor);</code> </pre> <br><h4 id="zagolovok-roma">  Rubrique rhum </h4><br><p>  Pour commencer, nous d√©terminerons la position d'un rhum Sega ordinaire.  Dans les premiers <code>0x100</code> octets, il y a une table de 64 pointeurs DWORD vers des vecteurs, par exemple: <code>Reset</code> , <code>Trap</code> , <code>DivideByZero</code> , <code>VBLANK</code> et autres. </p><br><p>  Vient ensuite la structure avec le nom des Roms, les r√©gions, les adresses du d√©but et de la fin des blocs <code>ROM</code> et <code>RAM</code> , la case √† cocher (le champ est v√©rifi√© √† la demande des d√©veloppeurs, et non le pr√©fixe) et d'autres informations. </p><br><p>  Cr√©ons des classes <code>java</code> pour travailler avec ces structures, ainsi que pour impl√©menter les types de donn√©es qui seront ajout√©s √† la liste des structures. </p><br><h4 id="vectorstable">  VecteursTable </h4><br><p>  Nous cr√©ons une nouvelle classe <code>VectorsTable</code> et, attention, nous indiquons qu'elle impl√©mente l'interface <code>StructConverter</code> .  Dans cette classe, nous allons stocker les adresses des vecteurs (pour une utilisation future) et leurs noms. </p><br><p><img src="https://habrastorage.org/webt/au/3c/m-/au3cm-qdnrviqcgqtn_asztwbao.png"></p><br><p>  Nous d√©clarons une liste de noms de vecteurs et leur nombre: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_SIZE = <span class="hljs-number"><span class="hljs-number">0x100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_COUNT = VECTORS_SIZE / <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] VECTOR_NAMES = { <span class="hljs-string"><span class="hljs-string">"SSP"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reset"</span></span>, <span class="hljs-string"><span class="hljs-string">"BusErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"AdrErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"InvOpCode"</span></span>, <span class="hljs-string"><span class="hljs-string">"DivBy0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Check"</span></span>, <span class="hljs-string"><span class="hljs-string">"TrapV"</span></span>, <span class="hljs-string"><span class="hljs-string">"GPF"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trace"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv4"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadInt"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv13"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv16"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv17"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadIRQ"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ1"</span></span>, <span class="hljs-string"><span class="hljs-string">"EXT"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ3"</span></span>, <span class="hljs-string"><span class="hljs-string">"HBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ5"</span></span>, <span class="hljs-string"><span class="hljs-string">"VBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap4"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap5"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap6"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap8"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap9"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap13"</span></span>,<span class="hljs-string"><span class="hljs-string">"Trap14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv30"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv31"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv32"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv33"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv34"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv35"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv36"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv37"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv38"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv39"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3A"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3B"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3C"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3D"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3E"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3F"</span></span> };</code> </pre> <br><p>  Nous cr√©ons une classe distincte pour stocker l'adresse et le nom du vecteur: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address address; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Address address, String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.address = address; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> address; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } }</code> </pre> <br><p>  La liste des vecteurs sera stock√©e dans le tableau des <code>vectors</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> VectorFunc[] vectors;</code> </pre> <br><p>  Le constructeur de <code>VectorsTable</code> acceptera: </p><br><ol><li>  <code>FlatProgramAPI fpa</code> pour convertir <code>long</code> adresses <code>long</code> en type de donn√©es d' <code>Address</code> Hydra (en fait, ce type de donn√©es compl√®te la simple valeur num√©rique de l'adresse en la liant √† une autre puce - l'espace d'adressage) </li><li>  <code>BinaryReader reader</code> - lecture des chantiers </li></ol><br><p>  L'objet <code>fpa</code> a une m√©thode <code>toAddr()</code> et le <code>reader</code> a <code>setPointerIndex()</code> et <code>readNextUnsignedInt()</code> .  En principe, rien de plus n'est requis.  Nous obtenons le code: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; VECTORS_COUNT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0</span></span>); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc[VECTORS_COUNT]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { vectors[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc(fpa.toAddr(reader.readNextUnsignedInt()), VECTOR_NAMES[i]); } }</code> </pre> <br><p>  La m√©thode <code>toDataType()</code> , que nous devons remplacer pour impl√©menter la structure, doit renvoyer un objet <code>Structure</code> dans lequel les noms des champs de structure, leurs tailles et commentaires sur chaque champ doivent √™tre d√©clar√©s (vous pouvez utiliser <code>null</code> ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"VectorsTable"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { s.add(POINTER, <span class="hljs-number"><span class="hljs-number">4</span></span>, VECTOR_NAMES[i], <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }</code> </pre> <br><p>  Eh bien, impl√©mentons des m√©thodes pour obtenir chacun des vecteurs, ou la liste enti√®re (un tas de code passe-partout): </p><br><div class="spoiler">  <b class="spoiler_title">Autres m√©thodes</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> VectorFunc[] getVectors() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSSP</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBusErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdrErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">3</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInvOpCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDivBy0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">5</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">6</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrapV</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">7</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">8</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">9</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">10</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">11</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">13</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">12</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">14</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">13</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">14</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">15</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">17</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">16</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">18</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">17</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">19</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">18</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">19</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">21</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">20</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">22</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">21</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">23</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">22</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv17</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">23</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadIRQ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">24</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">26</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">25</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEXT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">27</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">26</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">27</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">29</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">28</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">29</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">30</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">31</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">33</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">32</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">34</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">33</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">35</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">34</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">36</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">35</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">37</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">36</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">38</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">37</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">39</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">38</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">40</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">39</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap8</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">41</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">40</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap9</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">42</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">41</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">43</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">42</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">44</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">43</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">45</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">44</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">45</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">46</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">47</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv30</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">49</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">48</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv31</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">50</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">49</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv32</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">51</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">50</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv33</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">52</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">51</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv34</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">53</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">52</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv35</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">54</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">53</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv36</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">55</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">54</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv37</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">56</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">55</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv38</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">57</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">56</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv39</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">58</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">57</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3A</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">59</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">58</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3B</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">59</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3C</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">61</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">60</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">62</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">61</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3E</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">63</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">62</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3F</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">64</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">63</span></span>]; }</code> </pre> </div></div><br><h4 id="gameheader">  Gameheader </h4><br><p>  Nous ferons de m√™me et cr√©erons une classe <code>GameHeader</code> qui impl√©mente l'interface <code>StructConverter</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Structure de l'en-t√™te du rhum de jeu</b> <div class="spoiler_text"><table><thead><tr><th>  D√©calage de d√©part </th><th>  D√©calage de fin </th><th>  La description </th></tr></thead><tbody><tr><td>  100 $ </td><td>  10 F $ </td><td>  Nom de la console (g√©n√©ralement ¬´SEGA MEGA DRIVE¬ª ou ¬´SEGA GENESIS¬ª) </td></tr><tr><td>  110 $ </td><td>  11 F $ </td><td>  Date de sortie (g√©n√©ralement ¬´¬© XXXX YYYY.MMM¬ª o√π XXXX est le code de l'entreprise, YYYY est l'ann√©e et MMM - mois) </td></tr><tr><td>  120 $ </td><td>  14 F $ </td><td>  Nom domestique </td></tr><tr><td>  150 $ </td><td>  17 F $ </td><td>  Nom international </td></tr><tr><td>  180 $ </td><td>  18D $ </td><td>  Version ('XX YYYYYYYYYYYY' o√π XX est le type de jeu et YY le code du jeu) </td></tr><tr><td>  18E $ </td><td>  18 F $ </td><td>  Somme de contr√¥le </td></tr><tr><td>  190 $ </td><td>  19 F $ </td><td>  Prise en charge des E / S </td></tr><tr><td>  1A0 $ </td><td>  1A3 $ </td><td>  D√©marrage de la ROM </td></tr><tr><td>  1A4 $ </td><td>  1A7 $ </td><td>  Fin de la ROM </td></tr><tr><td>  1A8 $ </td><td>  1AB $ </td><td>  D√©marrage de la RAM (g√©n√©ralement 00FFFF0000 $) </td></tr><tr><td>  1 $ CA </td><td>  1AF $ </td><td>  Fin de la RAM (g√©n√©ralement 00FFFFFF $) </td></tr><tr><td>  1 G $ </td><td>  1 G $ 2 </td><td>  'RA' et $ F8 permettent SRAM </td></tr><tr><td>  1 G $ 3 </td><td>  ---- </td><td>  inutilis√© (20 $) </td></tr><tr><td>  1 G $ 4 </td><td>  1 G $ 7 </td><td>  D√©marrage SRAM (par d√©faut 00200000 $) </td></tr><tr><td>  1 G $ 8 </td><td>  1 milliard de dollars </td><td>  Fin SRAM (par d√©faut $ 0020FFFF) </td></tr><tr><td>  1BC $ </td><td>  1FF $ </td><td>  Notes (non utilis√©es) </td></tr></tbody></table></div></div><br><p>  Nous configurons les champs, v√©rifions une longueur suffisante des donn√©es d'entr√©e, utilisons pour nous deux m√©thodes <code>readNextByteArray()</code> , <code>readNextUnsignedShort()</code> de l'objet <code>reader</code> pour lire les donn√©es et cr√©er une structure.  Le code r√©sultant est le suivant: </p><br><div class="spoiler">  <b class="spoiler_title">Gameheader</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.BinaryReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.StructConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.flatapi.FlatProgramAPI; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.DataType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.Structure; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.StructureDataType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StructConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] consoleName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] releaseDate = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] domesticName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] internationalName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] version = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> checksum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] ioSupport = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address romStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, romEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address ramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] sramCode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> unused = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address sramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, sramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] notes = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FlatProgramAPI fpa; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fpa = fpa; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; <span class="hljs-number"><span class="hljs-number">0x200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0x100</span></span>); consoleName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); releaseDate = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); domesticName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); internationalName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); version = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x0E</span></span>); checksum = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>) reader.readNextUnsignedShort(); ioSupport = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); romStart = fpa.toAddr(reader.readNextUnsignedInt()); romEnd = fpa.toAddr(reader.readNextUnsignedInt()); ramStart = fpa.toAddr(reader.readNextUnsignedInt()); ramEnd = fpa.toAddr(reader.readNextUnsignedInt()); sramCode = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x03</span></span>); unused = reader.readNextByte(); sramStart = fpa.toAddr(reader.readNextUnsignedInt()); sramEnd = fpa.toAddr(reader.readNextUnsignedInt()); notes = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x44</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"GameHeader"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ConsoleName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ReleaseDate"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"DomesticName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"InternationalName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x0E</span></span>, <span class="hljs-string"><span class="hljs-string">"Version"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(WORD, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-string"><span class="hljs-string">"Checksum"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"IoSupport"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-string"><span class="hljs-string">"SramCode"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(BYTE, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-string"><span class="hljs-string">"Unused"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-string"><span class="hljs-string">"Notes"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getConsoleName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> consoleName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getReleaseDate() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> releaseDate; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getDomesticName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> domesticName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getInternationalName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> internationalName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getVersion() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> version; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChecksum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> checksum; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getIoSupport() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioSupport; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramEnd; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getSramCode() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUnused</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unused; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSRAM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramCode == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'R'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0xF8</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getNotes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> notes; } }</code> </pre> </div></div><br><p>  Cr√©ez des objets pour l'en-t√™te: </p><br><pre> <code class="java hljs">vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader);</code> </pre> <br><h4 id="segmenty">  Segments </h4><br><p>  Sega a une carte bien connue des r√©gions de m√©moire, que je ne donnerai peut-√™tre pas ici sous forme de tableau, mais seulement le code qui est utilis√© pour cr√©er les segments. </p><br><p>  Ainsi, l'objet de la classe <code>FlatProgramAPI</code> a une m√©thode <code>createMemoryBlock()</code> , avec laquelle il est pratique de cr√©er des r√©gions de m√©moire.  Il faut les arguments suivants pour entrer: </p><br><ol><li>  <code>name</code> : nom de la r√©gion </li><li>  <code>address</code> : adresse de d√©part de la r√©gion </li><li>  <code>stream</code> : un objet de type <code>InputStream</code> qui sera la base des donn√©es dans la zone m√©moire.  Si vous sp√©cifiez <code>null</code> , une r√©gion non initialis√©e sera cr√©√©e (par exemple, pour <code>68K RAM</code> ou <code>Z80 RAM</code> nous en aurons besoin </li><li>  <code>size</code> : taille de la r√©gion cr√©√©e </li><li>  <code>isOverlay</code> : accepte <code>true</code> ou <code>false</code> et indique que la r√©gion m√©moire est en superposition.  O√π cela est n√©cessaire en plus des ex√©cutables </li></ol><br><p>  Sur la sortie, <code>createMemoryBlock()</code> renvoie un objet de type <code>MemoryBlock</code> , auquel vous pouvez en outre d√©finir des indicateurs de droits d'acc√®s ( <code>Read</code> , <code>Write</code> , <code>Execute</code> ). </p><br><p>  En cons√©quence, nous obtenons une fonction de la forme suivante: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createSegment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, InputStream stream, String name, Address address, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> read, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> write, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> execute)</span></span></span><span class="hljs-function"> </span></span>{ MemoryBlock block = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { block = fpa.createMemoryBlock(name, address, stream, size, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); block.setRead(read); block.setWrite(read); block.setExecute(execute); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"Error creating %s segment"</span></span>, name)); } }</code> </pre> <br><p>  Ici, nous avons √©galement appel√© la m√©thode d' <code>error</code> statique de la classe <code>Msg</code> pour afficher un message d'erreur. </p><br><p>  Un segment contenant du rhum de jeu peut avoir une taille maximale de <code>0x3FFFFF</code> (tout le reste appartiendra d√©j√† √† d'autres r√©gions).  Cr√©ons-le: </p><br><pre> <code class="java hljs">InputStream romStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0</span></span>); createSegment(fpa, romStream, <span class="hljs-string"><span class="hljs-string">"ROM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x000000</span></span>), Math.min(romStream.available(), <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre> <br><p>    <code>InputStream</code>    ,    0. </p><br><p>       ,     ( <code>SegaCD</code>  <code>Sega32X</code> ).        <code>OptionDialog</code> . , <code>showYesNoDialogWithNoAsDefaultButton()</code>      <code>YES</code>  <code>NO</code>   -  <code>NO</code> . </p><br><p>    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega CD segment?"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (romStream.available() &gt; <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>) { InputStream epaStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>); createSegment(fpa, epaStream, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega 32X segment?"</span></span>)) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"32X"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x800000</span></span>), <span class="hljs-number"><span class="hljs-number">0x200000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }</code> </pre> <br><p>      : </p><br><pre> <code class="java hljs">createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z80"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA00000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS1"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span> * <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS2"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z802"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z803"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"FDC"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TMSS"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"VDP"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"RAM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xFF0000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header.hasSRAM()) { Address sramStart = header.getSramStart(); Address sramEnd = header.getSramEnd(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramStart.getOffset() &gt;= <span class="hljs-number"><span class="hljs-number">0x200000</span></span> &amp;&amp; sramEnd.getOffset() &lt;= <span class="hljs-number"><span class="hljs-number">0x20FFFF</span></span> &amp;&amp; sramStart.getOffset() &lt; sramEnd.getOffset()) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SRAM"</span></span>, sramStart, sramEnd.getOffset() - sramStart.getOffset() + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }</code> </pre> <br><h4 id="massivy-metki-i-konkretnye-adresa"> ,     </h4><br><p>       <code>CreateArrayCmd</code> .   ,     : </p><br><ol><li> <code>address</code> : ,      </li><li> <code>numElements</code> :    </li><li> <code>dataType</code> :       </li><li> <code>elementSize</code> :    </li></ol><br><p>        <code>applyTo(program)</code> ,   . </p><br><p>        ,    ,  <code>BYTE</code> , <code>WORD</code> , <code>DWORD</code>  .  ,    <code>FlatProgramAPI</code>   <code>createByte()</code> , <code>createWord()</code> , <code>createDword()</code>  .. </p><br><p>  ,    ,       (,     <code>VDP</code> ).  ,    : </p><br><ol><li>    <code>Program</code>   <code>getSymbolTable()</code> ,       ,   .. </li><li>      <code>createLabel()</code> ,     ,    .      , ,     <code>SourceType.IMPORTED</code>      </li></ol><br><p>          ,   : </p><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedByteArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, ByteDataType.dataType, ByteDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createByte(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create byte. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedWordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, WordDataType.dataType, WordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create word. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedDwordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, DWordDataType.dataType, DWordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createDWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create dword. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="java hljs">createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA04000</span></span>), <span class="hljs-string"><span class="hljs-string">"Z80_YM2612"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_PCBVER"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10002</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10004</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10006</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10008</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10010</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10012</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10014</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10016</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10018</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_RAMMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80BUS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80RES"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_FDC"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TIME"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TMSS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00002</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00004</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00006</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00008</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000A</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000C</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP___CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000E</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP____CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00011</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_PSG"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> </div></div><br><h4 id="primenenie-struktur-zagolovka">    </h4><br><p>           <code>createData()</code>  <code>DataUtilities</code> .       : </p><br><ol><li> <code>program</code> :   <code>Program</code> </li><li> <code>address</code> : ,      </li><li> <code>dataType</code> :   </li><li> <code>dataLength</code> :  .   <code>-1</code>    </li><li> <code>stackPointers</code> :  <code>true</code> ,  -     .  <code>false</code> </li><li> <code>clearDataMode</code> :          ,     (,     ) </li></ol><br><p>    : ..      (,  ),         .      <code>FlatProgramAPI</code>    <code>createFunction()</code> ,       . </p><br><p>                 : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markVectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0</span></span>), vectors.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (VectorFunc func : vectors.getVectors()) { fpa.createFunction(func.getAddress(), func.getName()); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000000"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x100</span></span>), header.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000100"</span></span>); } }</code> </pre> <br><h3 id="zavershaem-metod-load">   load() </h3><br><p>         <code>load()</code>    <code>setMessage()</code>   <code>TaskMonitor</code> ,     . </p><br><pre> <code class="java hljs">monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName()));</code> </pre> <br><p>     ,     : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, LoadSpec loadSpec, List&lt;Option&gt; options, Program program, MemoryConflictHandler handler, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException, IOException </span></span>{ monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName())); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader); createSegments(fpa, provider, program, monitor); markVectorsTable(program, fpa); markHeader(program, fpa); monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Loading done"</span></span>, getName())); }</code> </pre> <br><h3 id="getdefaultoptions-i-validateoptions"> getDefaultOptions  validateOptions </h3><br><p>       ,      </p><br><h2 id="otlazhivaem-rezultaty-nashih-trudov">     </h2><br><p>        <code>Run</code> -&gt; <code>Debug As</code> -&gt; <code>1 Ghidra</code> .   . </p><br><p><img src="https://habrastorage.org/webt/fv/ua/ya/fvuaya-gohpzkoiiflp6v28eily.png"></p><br><h2 id="eksport-distributiva-i-ustanovka-v-ghidra">      GHIDRA </h2><br><p>     ,   -    .       <code>Eclipse</code>   <code>extension.properties</code> ,   : </p><br><pre> <code class="java hljs">description=Loader <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Sega Mega Drive / Genesis ROMs author=Dr. MefistO createdOn=<span class="hljs-number"><span class="hljs-number">20.03</span></span>.2019</code> </pre> <br><p>       <code>GhidraDev</code> -&gt; <code>Export</code> -&gt; <code>Ghidra Module Extension...</code>      : </p><br><p><img src="https://habrastorage.org/webt/4p/d-/4x/4pd-4xgokfhzsbfwdccrnzguqb0.png"></p><br><p><img src="https://habrastorage.org/webt/t2/gs/j3/t2gsj3lpwgtn-lueej69ostsil4.png"></p><br><p><img src="https://habrastorage.org/webt/z3/kn/ik/z3knik478dyvau73nau8j-rhiik.png"></p><br><p>      <code>dist</code>    zip- (-  <code>ghidra_9.0_PUBLIC_20190320_Sega.zip</code> )       <code>GHIDRA</code> . </p><br><p>     .  <code></code> ,  <code>File</code> -&gt; <code>Install Extensions...</code> ,     ,     . ... </p><br><p><img src="https://habrastorage.org/webt/ky/tk/uh/kytkuhf_3pciliw9ihhgthadbrs.png"></p><br><p><img src="https://habrastorage.org/webt/qj/bz/gf/qjbzgfycyjaeghezz_w1rehayo0.png"></p><br><h2 id="ishodniki-i-prochee">    </h2><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github-</a> ,   . </p><br><p>     :   <code>IDA</code>  <code>GHIDRA</code>       .   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr444562/">https://habr.com/ru/post/fr444562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr444552/index.html">TDMS Fairway. Travailler avec expertise</a></li>
<li><a href="../fr444554/index.html">L'API JSON RESTful la plus simple sur Elixir</a></li>
<li><a href="../fr444556/index.html">La couleur de la lune et du soleil de l'espace dans les valeurs de RVB et de temp√©rature de couleur</a></li>
<li><a href="../fr444558/index.html">Quoi de neuf dans CUBA 7</a></li>
<li><a href="../fr444560/index.html">Nous vous invitons √† la conf√©rence ¬´Clouds. Tendances de la mode ‚Äù26 mars 2019</a></li>
<li><a href="../fr444564/index.html">D√©veloppement de produits num√©riques avec des mod√®les mentaux</a></li>
<li><a href="../fr444566/index.html">Sikorsky a organis√© une d√©monstration d'un h√©licopt√®re sans pilote avec un homme √† bord</a></li>
<li><a href="../fr444568/index.html">Top 10 des bugs des projets C ++ trouv√©s en 2018</a></li>
<li><a href="../fr444570/index.html">Top 10 des erreurs dans les projets C ++ pour 2018</a></li>
<li><a href="../fr444572/index.html">LED clignotante</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>