<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöµüèª üë©‚Äç‚öñÔ∏è üåô Redes neurais: implementa√ß√£o da tarefa sobre cogumelos em Tensor Flow e Python ü§∞üèª üë©üèΩ‚Äçü§ù‚Äçüë®üèæ üí≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Tensor Flow √© uma estrutura para criar e trabalhar com redes neurais do Google. Permite que voc√™ abstraia dos detalhes internos do aprendizado de m√°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Redes neurais: implementa√ß√£o da tarefa sobre cogumelos em Tensor Flow e Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419917/">  O Tensor Flow √© uma estrutura para criar e trabalhar com redes neurais do Google.  Permite que voc√™ abstraia dos detalhes internos do aprendizado de m√°quina e se concentre diretamente na solu√ß√£o do seu problema.  Uma coisa muito poderosa, permite criar, treinar e usar redes neurais de qualquer tipo conhecido.  N√£o encontrei um √∫nico texto sens√≠vel sobre Habr√© sobre esse assunto, por isso escrevo o meu.  A seguir, descreveremos a implementa√ß√£o da solu√ß√£o para o problema de cogumelos usando a biblioteca Tensor Flow.  A prop√≥sito, o algoritmo descrito abaixo √© adequado para previs√µes em quase todos os campos.  Por exemplo, a probabilidade de c√¢ncer em uma pessoa no futuro ou de cartas em um oponente no p√¥quer. <a name="habracut"></a><br><br><h3>  Desafio </h3><br>  A ess√™ncia do problema: com base nos par√¢metros de entrada do fungo para determinar sua comestibilidade.  A especificidade √© que esses par√¢metros s√£o categ√≥ricos, n√£o num√©ricos.  Por exemplo, o par√¢metro "formato do chap√©u" pode ser definido como "plano" ou "convexo" ou "em forma de cone".  Conjunto de dados de cogumelo para aprendizado de rede retirado do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio de aprendizado de m√°quina</a> .  Assim, a solu√ß√£o do problema pode ser chamada de um tipo de Ol√° Mundo no campo de aprendizado de m√°quina, juntamente com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">problema das √≠ris</a> , onde os par√¢metros das flores s√£o expressos em valores digitais. <br><br><h3>  C√≥digo fonte </h3><br>  Voc√™ pode baixar todas as fontes do meu reposit√≥rio no Github: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link</a> .  Fa√ßa isso para ver o c√≥digo em a√ß√£o.  Use apenas c√≥digos-fonte, porque todos os recuos e codifica√ß√µes necess√°rios s√£o observados l√°.  Abaixo, todo o processo ser√° discutido em detalhes. <br><br><h3>  Prepara√ß√£o </h3><br>  Sup√µe-se que voc√™ tenha uma instala√ß√£o pr√©-instalada do Tensor Flow.  Caso contr√°rio, voc√™ pode instalar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link</a> . <br><br><h3>  C√≥digo fonte </h3><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-comment"><span class="hljs-comment">#       . #     CSV-    Tensor Flow       .  ,       (0  1) def prepare_data(data_file_name): header = ['class', 'cap_shape', 'cap_surface', #  CSV-   ,     'agaricus-lepiota.name'   'cap_color', 'bruises', 'odor', 'gill_attachment', 'gill_spacing', 'gill_size', 'gill_color', 'stalk_shape', 'stalk_root', 'stalk_surface_above_ring', 'stalk_surface_below_ring', 'stalk_color_above_ring', 'stalk_color_below_ring', 'veil_type', 'veil_color', 'ring_number', 'ring_type', 'spore_print_color', 'population', 'habitat'] df = pd.read_csv(data_file_name, sep=',', names=header) #   "?"      #        df.replace('?', np.nan, inplace=True) df.dropna(inplace=True) #         #  'e'  'p' .       # ,   0  , 1 -    df['class'].replace('p', 0, inplace=True) df['class'].replace('e', 1, inplace=True) #       , #     . Tensor Flow      # .  Pandas    "get_dummies" #      cols_to_transform = header[1:] df = pd.get_dummies(df, columns=cols_to_transform) #      #    -    () #      () df_train, df_test = train_test_split(df, test_size=0.1) #           num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #      csv-, .. #          #  csv,    Tensor Flow df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #     ,    open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read()) #   ,     os.remove("train_temp.csv") os.remove("test_temp.csv") #        Tensor Flow def get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y #        Tensor Flow def get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y #        #    ( : , ) #  ,         def new_samples(): return np.array([[0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1]], dtype=np.int) if __name__ == "__main__": MUSHROOM_DATA_FILE = "agaricus-lepiota.data" #     Tensor Flow, #   CSV- (  ) prepare_data(MUSHROOM_DATA_FILE) #    training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_train.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_test.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) # ,        ( ) feature_columns = [tf.contrib.layers.real_valued_column("", dimension=98)] #   DNN-  10, 20  10    classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=2, model_dir="/tmp/mushroom_model") #   classifier.fit(input_fn=get_train_inputs, steps=2000) #        accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)["accuracy"] print("\n : {0:f}\n".format(accuracy_score)) #         predictions = list(classifier.predict_classes(input_fn=new_samples)) print("   : {}\n" .format(predictions))</span></span></code> </pre> <br><h3>  Fa√ßa o download e prepare dados do reposit√≥rio </h3><br>  Baixaremos os dados para treinamento e teste da rede neural do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio de aprendizado de m√°quina</a> criado especialmente para isso.  Todos os dados s√£o apresentados em dois arquivos: agaricus-lepiota.data e agaricus-lepiota.names.  As primeiras 8124 linhas e 22 colunas.  Uma linha fornece um cogumelo, cada coluna √© um dos 22 par√¢metros do cogumelo na forma de um caractere de redu√ß√£o de toda a palavra de par√¢metro.  A legenda de todos os caracteres est√° no arquivo agarius-lepiota.names. <br><br>  Os dados do reposit√≥rio precisam ser processados ‚Äã‚Äãpara traz√™-los para um formato aceit√°vel para o Tensor Flow.  Primeiro, importamos algumas bibliotecas para o trabalho <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os</code> </pre> <br>  Em seguida, formaremos um cabe√ßalho a partir dos par√¢metros do cogumelo para o Tensor Flow, para que a biblioteca saiba qual coluna no arquivo de dados corresponde a qual par√¢metro.  O chap√©u √© colado ao arquivo de dados.  Formamos na forma de uma matriz, cujos elementos s√£o retirados do arquivo agaricus-lepiota.names. <br><br><pre> <code class="python hljs">header = [<span class="hljs-string"><span class="hljs-string">'class'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_surface'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'bruises'</span></span>, <span class="hljs-string"><span class="hljs-string">'odor'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_attachment'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_spacing'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_size'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_root'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_number'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'spore_print_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'population'</span></span>, <span class="hljs-string"><span class="hljs-string">'habitat'</span></span>] df = pd.read_csv(data_file_name, sep=<span class="hljs-string"><span class="hljs-string">','</span></span>, names=header)</code> </pre> <br>  Agora voc√™ precisa lidar com os dados ausentes.  Nesse caso, o s√≠mbolo "?" √â definido no arquivo agaricus-lepiota.data em vez do par√¢metro.  Existem muitos m√©todos para lidar com esses casos, mas simplesmente excluiremos a linha inteira com pelo menos um par√¢metro ausente. <br><br><pre> <code class="python hljs">df.replace(<span class="hljs-string"><span class="hljs-string">'?'</span></span>, np.nan, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  Em seguida, voc√™ deve substituir manualmente o par√¢metro de comestibilidade simb√≥lica por um digital.  Ou seja, substitua "p" e "e" por 0 e 1. <br><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  E depois disso, voc√™ pode converter o restante dos dados em um d√≠gito.  √â isso que a fun√ß√£o get_dummies da biblioteca do pandas faz. <br><br><pre> <code class="python hljs">cols_to_transform = header[<span class="hljs-number"><span class="hljs-number">1</span></span>:] df = pd.get_dummies(df, columns=cols_to_transform)</code> </pre> <br>  Qualquer rede neural precisa ser treinada.  Al√©m disso, ele tamb√©m precisa ser calibrado para aumentar a precis√£o do trabalho em condi√ß√µes reais.  Para fazer isso, dividiremos nosso conjunto de dados em dois - treinamento e calibra√ß√£o.  O primeiro ser√° maior que o segundo, como deveria ser. <br><br><pre> <code class="python hljs">df_train, df_test = train_test_split(df, test_size=<span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br>  E o √∫ltimo.  O fluxo tensor requer que o n√∫mero de linhas e colunas do arquivo seja indicado no in√≠cio dos arquivos de dados.  Extrairemos essas informa√ß√µes manualmente de nossos conjuntos de dados de treinamento e calibra√ß√£o e, em seguida, gravaremos nos arquivos CSV resultantes. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #     CSV df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #       CSV,      open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read())</span></span></code> </pre> <br>  No final, voc√™ deve obter esses arquivos: <a href="">treinamento</a> e <a href="">calibra√ß√£o</a> . <br><br><h3>  Jogue os dados gerados no fluxo tensor </h3><br>  Agora que baixamos do reposit√≥rio e processamos os arquivos CSV com dados em forma de cogumelo, voc√™ pode envi√°-los ao Tensor Flow para treinamento.  Isso √© feito usando a fun√ß√£o load_csv_with_header () fornecida pela pr√≥pria estrutura: <br><br><pre> <code class="python hljs">training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_train.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_test.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  A fun√ß√£o load_csv_with_header () est√° envolvida na forma√ß√£o de um conjunto de dados de treinamento a partir dos arquivos que coletamos acima.  Al√©m do arquivo de dados, a fun√ß√£o aceita target_dtype como argumento, que √© um tipo de dado previsto no final.  No nosso caso, √© necess√°rio ensinar a rede neural a prever a comestibilidade ou toxicidade do fungo, que pode ser expressa com os valores 1 ou 0. Portanto, no nosso caso, target_dtype √© um valor inteiro.  features_dtype - par√¢metro em que o tipo de par√¢metros aceitos para treinamento est√° definido.  No nosso caso, tamb√©m √© um n√∫mero inteiro (inicialmente eles eram string, mas, como voc√™ se lembra, n√≥s os ultrapassamos em um n√∫mero).  No final, o par√¢metro target_column √© definido, que √© o √≠ndice da coluna com o par√¢metro que a rede neural deve prever.  Ou seja, com o par√¢metro edibility. <br><br><h3>  Criar um objeto classificador de fluxo tensor </h3><br>  Ou seja, um objeto de uma classe diretamente envolvida na previs√£o do resultado.  Em outras palavras, a classe da pr√≥pria rede neural. <br><br><pre> <code class="python hljs">feature_columns = [tf.contrib.layers.real_valued_column(<span class="hljs-string"><span class="hljs-string">""</span></span>, dimension=<span class="hljs-number"><span class="hljs-number">98</span></span>)] classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], n_classes=<span class="hljs-number"><span class="hljs-number">2</span></span>, model_dir=<span class="hljs-string"><span class="hljs-string">"/tmp/mushroom_model"</span></span>)</code> </pre> <br>  O primeiro par√¢metro √© feature_columns.  Estes s√£o os par√¢metros dos cogumelos.  Observe que o valor do par√¢metro √© criado ali mesmo, um pouco mais alto.  L√°, na entrada, o valor do par√¢metro de dimens√£o 98 √© obtido, o que significa 98 par√¢metros diferentes do cogumelo, com exce√ß√£o da comestibilidade. <br><br>  hidden_units - o n√∫mero de neur√¥nios em cada camada da rede neural.  A sele√ß√£o correta do n√∫mero de camadas e neur√¥nios nelas √© algo no n√≠vel da arte no campo do aprendizado de m√°quina.  √â poss√≠vel determinar corretamente esses valores somente ap√≥s a experi√™ncia.  Pegamos esses n√∫meros apenas porque est√£o listados em um dos tutoriais do Tensor Flow.  E eles trabalham. <br><br>  n_classes - o n√∫mero de classes a prever.  Temos dois deles - comest√≠veis e n√£o. <br><br>  model_dir - o caminho onde o modelo treinado da rede neural ser√° salvo.  E no futuro ser√° usado para prever resultados, para n√£o treinar a rede todas as vezes. <br><br><h3>  Treinamento </h3><br>  Para facilitar o trabalho no futuro, criaremos duas fun√ß√µes: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_test_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(test_set.data) y = tf.constant(test_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_train_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(training_set.data) y = tf.constant(training_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y</code> </pre> <br>  Cada fun√ß√£o fornece seu pr√≥prio conjunto de dados de entrada - para treinamento e calibra√ß√£o.  x e y s√£o as constantes do Fluxo Tensor que a estrutura precisa para funcionar.  N√£o entre em detalhes, apenas aceite que essas fun√ß√µes devem ser um intermedi√°rio entre dados e uma rede neural. <br><br>  N√≥s treinamos uma rede: <br><br><pre> <code class="python hljs">classifier.fit(input_fn=get_train_inputs, steps=<span class="hljs-number"><span class="hljs-number">2000</span></span>)</code> </pre> <br>  O primeiro par√¢metro pega os dados de entrada formados logo acima, o segundo - o n√∫mero de etapas do treinamento.  Novamente, o n√∫mero foi usado em um dos manuais do Tensor Flow, e o entendimento dessa configura√ß√£o chegar√° at√© voc√™ com experi√™ncia. <br><br>  Em seguida, calibre a rede treinada.  Isso √© feito usando o conjunto de dados de calibra√ß√£o gerado acima.  O resultado do trabalho ser√° a precis√£o das previs√µes futuras da rede (precision_score). <br><br><pre> <code class="python hljs">accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=<span class="hljs-number"><span class="hljs-number">1</span></span>)[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>] print(<span class="hljs-string"><span class="hljs-string">"\n : {0:f}\n"</span></span>.format(accuracy_score))</code> </pre> <br><h3>  Vamos testar em </h3><br>  Agora a rede neural est√° pronta e voc√™ pode tentar prever com a ajuda da comestibilidade do fungo. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]], dtype=np.int)</code> </pre> <br>  A fun√ß√£o acima fornece os dados de dois cogumelos completamente novos que n√£o estavam presentes no treinamento ou nos conjuntos de calibra√ß√£o (na verdade, eles simplesmente foram retirados deste √∫ltimo).  Imagine, por exemplo, que voc√™ os comprou no mercado e esteja tentando entender se eles podem ser comidos.  O c√≥digo abaixo ir√° definir isso: <br><br><pre> <code class="python hljs">predictions = list(classifier.predict(input_fn=new_samples)) print(<span class="hljs-string"><span class="hljs-string">"   : {}\n"</span></span> .format(predictions))</code> </pre> <br>  O resultado do trabalho deve ser o seguinte: <br><br><pre> <code class="python hljs">   : [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br>  E isso significa que o primeiro cogumelo √© venenoso, o segundo √© completamente comest√≠vel.  Assim, voc√™ pode fazer previs√µes com base em quaisquer dados, sejam cogumelos, pessoas, animais ou qualquer coisa.  √â o suficiente para formar corretamente os dados de entrada.  E prever, por exemplo, a probabilidade de arritmia do paciente no futuro ou o movimento do pre√ßo das a√ß√µes na bolsa de valores. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt419917/">https://habr.com/ru/post/pt419917/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt419905/index.html">Ind√∫stria de lan√ßamento do Reino Unido desperta e estabelece metas - meio s√©culo depois do Black Arrow</a></li>
<li><a href="../pt419907/index.html">Dicas para o lan√ßamento de jogos para dispositivos m√≥veis: Parte 2, Lan√ßamento global</a></li>
<li><a href="../pt419911/index.html">Construindo √≥rbitas de corpos celestes usando Python</a></li>
<li><a href="../pt419913/index.html">IKEA e casa inteligente. Parte 2</a></li>
<li><a href="../pt419915/index.html">Servidor de liga√ß√£o e SSH no initramfs</a></li>
<li><a href="../pt419919/index.html">Controle de vers√£o dentro do SQL Server</a></li>
<li><a href="../pt419921/index.html">Como perder 10 milh√µes de pacotes por segundo</a></li>
<li><a href="../pt419923/index.html">Meu trabalho tempor√°rio, rel√≥gios da placa-m√£e</a></li>
<li><a href="../pt419925/index.html">Controle de vers√£o de arquivos individuais usando o GitHub Gist</a></li>
<li><a href="../pt419927/index.html">Exce√ß√µes [DotNetBook]: arquitetura de sistema de tipos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>