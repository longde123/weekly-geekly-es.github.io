<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👸🏽 🖍️ 🏙️ Sistem pemantauan lain 🌴 👎🏿 👩🏻‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Penjumlahan kecepatan pada 16 modem dari 4 operator seluler. Kecepatan keluar dalam satu aliran - 933,45 Mbps 
 Pendahuluan 


 Hai Artikel ini adalah...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistem pemantauan lain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451778/"><p><img src="https://habrastorage.org/webt/rh/en/cj/rhencjkth5mkrj_l-mo9xe5dewk.png"><br>  <em>Penjumlahan kecepatan pada 16 modem dari 4 operator seluler.</em>  <em>Kecepatan keluar dalam satu aliran - 933,45 Mbps</em> </p><br><h2 id="vvedenie">  Pendahuluan </h2><br><p>  Hai  Artikel ini adalah tentang bagaimana kami menulis sistem pemantauan baru untuk diri kami sendiri.  Ini berbeda dari yang ada oleh kemungkinan akuisisi sinkron frekuensi tinggi metrik dan konsumsi sumber daya yang sangat rendah.  Frekuensi jajak pendapat dapat mencapai 0,1 milidetik dengan akurasi sinkronisasi antara metrik 10 nanodetik.  Semua file biner menempati 6 megabita. </p><a name="habracut"></a><br><h2 id="o-proekte">  Tentang proyek </h2><br><p>  Kami memiliki produk yang agak spesifik.  Kami menghasilkan solusi komprehensif untuk merangkum throughput dan toleransi kesalahan saluran data.  Ini adalah ketika ada beberapa saluran, misalnya, Operator1 (40Mbit / s) + Operator2 (30Mbit / s) + Sesuatu yang lain (5 Mbit / s), hasilnya adalah satu saluran yang stabil dan cepat, kecepatannya akan seperti ini: (40+ 30 + 5) x0.92 = 75x0.92 = 69 Mbps. </p><br><p>  Solusi semacam itu diminati di mana kapasitas setiap saluran tidak mencukupi.  Misalnya, transportasi, pengawasan video waktu-nyata dan sistem streaming video, siaran langsung televisi dan radio, benda luar kota di mana operator telekomunikasi hanya memiliki perwakilan Big Four, dan kecepatan pada satu modem / saluran tidak cukup. <br>  Untuk masing-masing bidang ini, kami memproduksi garis perangkat yang terpisah, namun, bagian perangkat lunaknya hampir sama dan sistem pemantauan berkualitas tinggi adalah salah satu modul utamanya, tanpa implementasi yang benar di mana produk tidak akan mungkin. </p><br><p>  Selama beberapa tahun, kami telah berhasil menciptakan sistem pemantauan cepat, lintas platform, dan ringan multi-level.  Apa yang ingin kami bagikan dengan komunitas yang memiliki reputasi baik. </p><br><h2 id="postanovka-zadachi">  Pernyataan masalah </h2><br><p>  Sistem pemantauan menyediakan metrik untuk dua kelas yang berbeda secara mendasar: metrik waktu-nyata dan yang lainnya.  Sistem pemantauan memiliki persyaratan sebagai berikut: </p><br><ol><li>  Akuisisi sinkron frekuensi tinggi dari metrik waktu-nyata dan transfernya ke sistem kontrol komunikasi tanpa penundaan. <br>  Frekuensi tinggi dan sinkronisasi metrik yang berbeda tidak hanya penting, sangat penting untuk analisis entropi saluran transmisi data.  Jika ada penundaan rata-rata 30 milidetik dalam satu saluran data, maka kesalahan dalam sinkronisasi antara metrik yang tersisa dengan hanya satu milidetik akan menyebabkan penurunan kecepatan saluran yang dihasilkan sekitar 5%.  Jika kita melakukan kesalahan dalam sinkronisasi selama 1 milidetik dalam 4 saluran, penurunan kecepatan dapat dengan mudah turun hingga 30%.  Selain itu, entropi dalam saluran berubah dengan sangat cepat, jadi jika kita mengukurnya kurang dari sekali setiap 0,5 milidetik, pada saluran cepat dengan penundaan kecil kita akan mendapatkan degradasi kecepatan tinggi.  Tentu saja, akurasi tersebut tidak diperlukan untuk semua metrik dan tidak dalam semua kondisi.  Ketika penundaan dalam saluran adalah 500 milidetik, dan kami bekerja dengan itu, kesalahan 1 milidetik hampir tidak akan terlihat.  Juga, untuk metrik sistem pendukung kehidupan, frekuensi pemungutan suara dan sinkronisasi 2 detik sudah cukup bagi kami, namun, sistem pemantauan itu sendiri harus dapat bekerja dengan frekuensi pemungutan suara sangat tinggi dan sinkronisasi metrik sangat presisi. </li><li>  Konsumsi sumber daya minimal dan satu tumpukan. <br>  Perangkat terakhir dapat menjadi kompleks on-board yang kuat yang dapat menganalisis situasi di jalan atau merekam biometrik orang, atau komputer seukuran papan tunggal yang dikenakan oleh tentara pasukan khusus di bawah pelindung tubuh untuk mengirimkan video real-time dalam kondisi komunikasi yang buruk.  Meskipun terdapat beragam arsitektur dan daya komputasi, kami ingin memiliki tumpukan perangkat lunak yang sama. </li><li>  Arsitektur payung <br>  Metrik harus dikumpulkan dan dikumpulkan pada perangkat akhir, memiliki sistem penyimpanan lokal dan visualisasi secara real time dan retrospektif.  Jika komunikasi tersedia, transfer data ke sistem pemantauan pusat.  Ketika tidak ada koneksi, antrian pengiriman harus menumpuk dan tidak mengkonsumsi RAM. </li><li>  API untuk diintegrasikan ke dalam sistem pemantauan pelanggan, karena tidak ada yang membutuhkan banyak sistem pemantauan.  Pelanggan harus mengumpulkan data dari perangkat dan jaringan apa pun dalam satu pemantauan. </li></ol><br><h2 id="chto-poluchilos">  Apa yang terjadi </h2><br><p>  Untuk memuat longrid yang sudah mengesankan, saya tidak akan memberikan contoh dan pengukuran semua sistem pemantauan.  Ini akan menarik artikel lain.  Saya hanya akan mengatakan bahwa kami tidak dapat menemukan sistem pemantauan yang mampu mengambil dua metrik secara bersamaan dengan kesalahan kurang dari 1 milidetik dan yang berfungsi sama efisiennya pada arsitektur ARM dengan 64 MB RAM dan arsitektur x86_64 dengan 32 GB RAM.  Karena itu, kami memutuskan untuk menulis sendiri, yang dapat melakukan hal itu.  Inilah yang kami dapatkan: </p><br><h3 id="summirovanie-propusknoy-sposobnosti-treh-kanalov-dlya-raznoy-topologii-seti">  Menjumlahkan throughput tiga saluran untuk topologi jaringan yang berbeda </h3><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3vPFHz7jFGM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/uEk_kQBbdP0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3 id="vizualizaciya-nekotoryh-klyuchevyh-metrik">  Visualisasi beberapa metrik kunci </h3><br><img src="https://habrastorage.org/webt/pl/as/15/plas151wvh-q69t6tmsmymvmszm.png"><br><img src="https://habrastorage.org/webt/8m/ta/hg/8mtahgdrualo8qowqadujgt14um.png"><br><img src="https://habrastorage.org/webt/gc/ft/3e/gcft3eah06vwztovobq_i_8bby8.png"><br><img src="https://habrastorage.org/webt/pc/mf/ke/pcmfkew11pujz3ktrss1dup0yko.png"><br><h2 id="arhitektura">  Arsitektur </h2><br><p>  Sebagai bahasa pemrograman utama, baik di perangkat maupun di pusat data, kami menggunakan Golang.  Dia sangat menyederhanakan hidupnya dengan menerapkan multitasking dan kemampuan untuk mendapatkan satu biner yang dapat dieksekusi yang terhubung secara statis untuk setiap layanan.  Akibatnya, kami secara signifikan menghemat sumber daya, metode, dan lalu lintas penyebaran layanan ke perangkat akhir, waktu pengembangan, dan debugging kode. </p><br><p>  Sistem ini diimplementasikan sesuai dengan prinsip modular klasik dan berisi beberapa subsistem: </p><br><ol><li>  Registrasi metrik. <br>  Setiap metrik dilayani oleh alirannya sendiri dan disinkronkan melalui saluran.  Kami berhasil mendapatkan akurasi sinkronisasi hingga 10 nanodetik. </li><li>  Penyimpanan metrik <br>  Kami memilih antara menulis repositori kami untuk deret waktu atau menggunakan salah satu dari yang tersedia.  Basis data diperlukan untuk data retrospektif, yang akan dikenakan visualisasi berikutnya, yaitu tidak memiliki data keterlambatan dalam saluran setiap 0,5 milidetik atau indikasi kesalahan dalam jaringan transportasi, tetapi ada kecepatan pada setiap antarmuka setiap 500 milidetik.  Selain persyaratan tinggi untuk lintas platform dan konsumsi sumber daya yang rendah, sangat penting bagi kami untuk dapat memproses.  data di tempat yang sama di mana ia disimpan.  Ini sangat menghemat sumber daya komputasi.  Sejak 2016, kami telah menggunakan Tarantool DBMS dalam proyek ini dan sejauh ini kami tidak melihat penggantinya di cakrawala.  Fleksibel, dengan konsumsi sumber daya yang optimal, lebih dari cukup dukungan teknis.  Tarantool juga memiliki modul GIS.  Ini tentu saja tidak sekuat PostGIS, tetapi cukup untuk tugas kita menyimpan beberapa metrik yang terkait dengan lokasi (relevan untuk transportasi). </li><li>  Visualisasi Metrik <br>  Semuanya relatif sederhana di sini.  Kami mengambil data dari penyimpanan dan menunjukkannya secara real time atau retrospektif. </li><li>  Sinkronisasi data dengan sistem pemantauan pusat. <br>  Sistem pemantauan pusat menerima data dari semua perangkat, menyimpannya dengan retrospektif yang diberikan, dan mengirimkannya melalui API ke sistem pemantauan Pelanggan.  Tidak seperti sistem pemantauan klasik, di mana "kepala" berjalan dan mengumpulkan data - kami memiliki skema sebaliknya.  Perangkat itu sendiri mengirim data ketika ada koneksi.  Ini adalah poin yang sangat penting, karena memungkinkan Anda untuk menerima data dari perangkat untuk periode waktu di mana itu tidak tersedia dan tidak memuat saluran dan sumber daya saat perangkat tidak tersedia.  Sebagai sistem pemantauan pusat, kami menggunakan server pemantauan Influx.  Tidak seperti analog, ini dapat mengimpor data retrospektif (yaitu, dengan cap waktu yang berbeda dari saat metrik diterima) Metrik yang dikumpulkan divisualisasikan oleh file Grafana yang dimodifikasi.  Tumpukan standar ini juga dipilih karena memiliki API integrasi siap pakai dengan hampir semua sistem pemantauan pelanggan. </li><li>  Sinkronisasi data dengan sistem manajemen perangkat pusat. <br>  Sistem manajemen perangkat mengimplementasikan Zero Touch Provisioning (memperbarui firmware, konfigurasi, dll.) Dan, tidak seperti sistem pemantauan, hanya menerima masalah perangkat.  Ini adalah pemicu dari layanan pengawas perangkat keras onboard dan semua metrik sistem pendukung kehidupan: CPU dan suhu SSD, beban CPU, ruang bebas dan kesehatan SMART pada disk.  Penyimpanan subsistem juga dibangun di atas Tarantool.  Ini memberi kita kecepatan yang signifikan dalam agregasi seri waktu di ribuan perangkat, dan juga sepenuhnya menyelesaikan masalah sinkronisasi data dengan perangkat ini.  Tarantool memiliki sistem antrian yang sangat baik dan pengiriman yang terjamin.  Kami punya fitur penting ini di luar kotak, hebat! </li></ol><br><h3 id="sistema-upravleniya-setyu">  Sistem manajemen jaringan </h3><br><img src="https://habrastorage.org/webt/2f/8i/o9/2f8io9alx_n41fnl9fi2wkmilwc.png"><br><h2 id="chto-dalshe">  Apa selanjutnya </h2><br><p>  Sejauh ini, mata rantai terlemah di negara kita adalah sistem pemantauan pusat.  Diimplementasikan pada 99,9% pada stack standar dan memiliki sejumlah kelemahan: </p><br><ol><li>  InfluxDB kehilangan data saat daya dimatikan.  Sebagai aturan, Pelanggan segera mengambil semua yang datang dari perangkat dan tidak ada data yang lebih lama dari 5 menit dalam database itu sendiri, tetapi di masa depan hal ini dapat menyebalkan. </li><li>  Grafana memiliki sejumlah masalah dengan agregasi data dan sinkronisasi tampilan mereka.  Masalah yang paling umum adalah ketika database berisi deret waktu dengan interval 2 detik mulai dari, katakanlah, 00:00:00, dan Grafana mulai menampilkan data dalam agregasi dari +1 detik.  Akibatnya, pengguna melihat grafik menari. </li><li>  Kode kelebihan untuk integrasi API dengan sistem pemantauan pihak ketiga.  Dapat dibuat jauh lebih ringkas dan tentu saja menulis ulang untuk Go) </li></ol><br><p>  Saya kira Anda semua benar-benar melihat seperti apa Grafana dan tanpa saya Anda tahu masalahnya, karena itu saya tidak akan membebani pos dengan gambar. </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Saya sengaja tidak menjelaskan detail teknis, tetapi hanya mendeskripsikan desain pendukung sistem ini.  Pertama, untuk mendeskripsikan sistem secara teknis, diperlukan satu artikel lagi.  Kedua, tidak semua orang akan tertarik.  Tulis di komentar detail teknis apa yang ingin Anda ketahui. </p><br><p>  Jika ada yang memiliki pertanyaan di luar artikel ini, saya dapat menulis ke a.rodin @ qedr.com </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id451778/">https://habr.com/ru/post/id451778/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id451766/index.html">Heisenbug 2019 Piter: apa yang akan terjadi dalam siaran gratis, dan apa yang hanya ada di acara itu</a></li>
<li><a href="../id451768/index.html">Meningkatkan kerja Wi-Fi. Prinsip umum dan hal-hal berguna</a></li>
<li><a href="../id451770/index.html">Veeam Backup & Replication: Kiat Berguna untuk Membuat Cadangan dan Replika Dapat Digunakan</a></li>
<li><a href="../id451772/index.html">Apa yang istimewa tentang Cloudera dan cara memasaknya</a></li>
<li><a href="../id451776/index.html">Bagaimana cara memprogram mesin role-playing di Google Sheets</a></li>
<li><a href="../id451780/index.html">Audit dalam 60 menit - periksa resistensi karyawan terhadap serangan phishing melalui Sophos Phish Threat secara gratis</a></li>
<li><a href="../id451782/index.html">Windows Subsystem untuk Linux (WSL) versi 2: bagaimana jadinya? (FAQ)</a></li>
<li><a href="../id451784/index.html">Drive hibrid untuk penyimpanan Enterprise. Pengalaman Menggunakan Seagate EXOS</a></li>
<li><a href="../id451786/index.html">Jalankan tes instrumental di Firebase Test Lab. Bagian 1: proyek iOS</a></li>
<li><a href="../id451790/index.html">Bahaya pengumpulan data dalam game</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>