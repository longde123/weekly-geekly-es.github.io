<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé≤ üì™ ‚è¨ Licen√ßa para dirigir um carro ou por que os aplicativos devem ser de atividade √∫nica üõçÔ∏è ü§Ω ü§πüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No AppsConf 2018 , que aconteceu de 8 a 9 de outubro, fiz uma apresenta√ß√£o sobre a cria√ß√£o de aplicativos Android inteiramente em uma Atividade. Embor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Licen√ßa para dirigir um carro ou por que os aplicativos devem ser de atividade √∫nica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/426617/"><p><img src="https://habrastorage.org/webt/n0/m4/p4/n0m4p4tyrh-7bky85jet7jyzllc.png" alt="imagem"></p><br><p>  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AppsConf 2018</a> , que aconteceu de 8 a 9 de outubro, fiz uma apresenta√ß√£o sobre a cria√ß√£o de aplicativos Android inteiramente em uma Atividade.  Embora o t√≥pico seja bem conhecido, existem muitos preconceitos com rela√ß√£o a essa escolha - a sala lotada e o n√∫mero de perguntas ap√≥s o discurso confirmam isso.  Para n√£o esperar a grava√ß√£o do v√≠deo, decidi fazer um artigo com uma transcri√ß√£o do discurso. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1b8/c2d/a29/1b8c2da294869720e98d50d529300817.jpg"></p><br><p>  O que vou dizer </p><br><ol><li>  Por que e por que devo mudar para Atividade √önica </li><li>  Uma abordagem universal para resolver tarefas que voc√™ est√° acostumado a resolver em v√°rias atividades </li><li>  Exemplos de tarefas comerciais padr√£o </li><li>  Gargalos nos quais o c√≥digo geralmente √© sustentado em vez de fazer tudo honestamente </li></ol><a name="habracut"></a><br><h2 id="pochemu-single-activity---eto-pravilno">  Por que a atividade √∫nica √© correta? </h2><br><h4 id="zhiznennyy-cikl">  Ciclo de vida </h4><br><p><img src="https://habrastorage.org/webt/6i/k8/fk/6ik8fkusqlvahretkm_yqfhfgg8.png"></p><br><p>  Todos os desenvolvedores do Android conhecem o esquema de inicializa√ß√£o a frio do aplicativo.  Primeiro, onCreate √© chamado na classe Application e, em seguida, o ciclo de vida da primeira Activity entra em a√ß√£o. <br>  Se houver v√°rias atividades em nosso aplicativo (e houver uma maioria desses aplicativos), acontece o seguinte: </p><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">App</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onCreate</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onCreate</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onStart</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onResume</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onPause</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onCreate</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onStart</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onResume</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onStop</span></span>()</code> </pre> <br><p>  Este √© o log de ativa√ß√£o da atividadeB abstrata da ActivityA.  Uma linha vazia √© o momento em que o lan√ßamento de uma nova tela foi chamado.  √Ä primeira vista, est√° tudo bem.  Mas se voltarmos para a documenta√ß√£o, ficar√° claro: para garantir que a tela fique vis√≠vel para o usu√°rio e que ele possa interagir com ela, isso s√≥ ser√° poss√≠vel depois de chamar <code>onResume</code> em cada tela: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">App</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onCreate</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onCreate</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onStart</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onResume</span></span>() &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onPause</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onCreate</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onStart</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onResume</span></span>() &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ActivityA</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onStop</span></span>()</code> </pre> <br><p>  O problema √© que esse log n√£o ajuda a entender o ciclo de vida do aplicativo.  Quando o usu√°rio ainda est√° dentro, e quando ele j√° mudou para outro aplicativo ou minimizou o nosso e assim por diante.  E isso √© necess√°rio <strong>quando queremos vincular a l√≥gica de neg√≥cios ao LC do aplicativo, por exemplo, manter uma conex√£o de soquete enquanto o usu√°rio estiver no aplicativo e fech√°-la ao sair</strong> </p><br><p>  Em um aplicativo de atividade √∫nica, tudo √© simples - o LC Activity se torna um aplicativo de LC.  Tudo o que voc√™ precisa para qualquer l√≥gica √© f√°cil de vincular ao estado do aplicativo. </p><br><h4 id="zapusk-ekranov">  Telas de lan√ßamento </h4><br><p>  Como usu√°rio, sempre me deparei com o fato de uma chamada da agenda telef√¥nica (e este √© claramente o lan√ßamento de uma Atividade separada) n√£o ocorrer depois de clicar em um contato.  N√£o est√° claro com o que isso est√° relacionado, mas aqueles a quem tentei passar sem sucesso disseram que receberam a liga√ß√£o e ouviram o som de passos.  Ao mesmo tempo, meu smartphone est√° no meu bolso h√° muito tempo. </p><br><p><img src="https://habrastorage.org/webt/iq/u5/kx/iqu5kxfhylvhmqh5wzuwvqpztzi.png"></p><br><p>  O problema √© que iniciar uma atividade √© um processo completamente ass√≠ncrono!  N√£o h√° garantia de inicializa√ß√£o instant√¢nea e, pior ainda, n√£o podemos controlar o processo.  Absolutamente. </p><br><p>  No aplicativo de atividade √∫nica, trabalhando com o gerenciador de fragmentos, podemos controlar o processo. <br>  <code>transaction.commit()</code> - alterna as telas de forma ass√≠ncrona, o que permite abrir ou fechar v√°rias telas ao mesmo tempo. <br>  <code>transaction.commitNow()</code> - alterna a tela de forma s√≠ncrona, se voc√™ n√£o precisar adicion√°-la √† pilha. <br>  fragmentManager.executePendingTransactions () `permite que voc√™ execute todas as transa√ß√µes lan√ßadas anteriormente agora. </p><br><h4 id="analiz-steka-ekranov">  An√°lise de pilha de tela </h4><br><p>  Imagine que a l√≥gica comercial do seu aplicativo depende da profundidade atual da pilha de telas (por exemplo, restri√ß√µes de aninhamento).  Ou, no final de algum processo, voc√™ precisa retornar a uma determinada tela e, se houver v√°rias id√™nticas, √† mais pr√≥xima da raiz (o in√≠cio da cadeia). <br>  Como obter uma pilha de atividades?  Quais par√¢metros devem ser especificados ao iniciar a tela? </p><br><p><img src="https://habrastorage.org/webt/pk/bz/5h/pkbz5hhcjv_gqiyirr7ab5e27h8.png"></p><br><p>  A prop√≥sito, sobre a m√°gica das op√ß√µes de lan√ßamento de atividade: </p><br><ul><li>  voc√™ pode especificar sinalizadores de inicializa√ß√£o no Intent (e tamb√©m mistur√°-los e alter√°-los de lugares diferentes); </li><li>  voc√™ pode adicionar par√¢metros de inicializa√ß√£o no manifesto, porque toda atividade deve ser descrita l√°; </li><li>  adicione filtros de inten√ß√£o aqui para lidar com disparos externos; </li><li>  e, finalmente, pense nas MultiTasks, quando o Activities for executado em diferentes "tarefas". </li></ul><br><p>  Juntos, isso cria confus√£o e problemas com a depura√ß√£o de suporte.  Voc√™ nunca pode dizer com certeza exatamente como a tela foi lan√ßada e como isso afetou a pilha. </p><br><p>  Em um aplicativo de atividade √∫nica, todas as telas alternam apenas atrav√©s de transa√ß√µes de fragmento.  Voc√™ pode analisar a pilha atual de telas e transa√ß√µes salvas. <br>  Na demonstra√ß√£o da biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cicerone</a> , √© poss√≠vel ver como o status atual da pilha √© exibido na barra de ferramentas. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/45f/285/af2/45f285af219d69df32d0994db1eeb58d.gif" alt="imagem"></p><br><p>  <em>Nota:</em> na vers√£o mais recente, as bibliotecas de suporte bloquearam o acesso √† matriz de fragmentos dentro do gerenciador de fragmentos, mas se voc√™ realmente quiser, esse problema sempre pode ser resolvido. </p><br><h4 id="activity-tolko-odna-na-ekrane">  Apenas uma atividade na tela </h4><br><p>  Em aplicativos reais, definitivamente precisaremos combinar telas "l√≥gicas" em uma atividade, para que voc√™ n√£o possa escrever um aplicativo real apenas na atividade.  A dualidade da abordagem √© sempre ruim, pois o mesmo problema pode ser resolvido de maneiras diferentes (em algum lugar, o layout est√° diretamente na Atividade e, em algum lugar, a Atividade √© apenas um cont√™iner). </p><br><h4 id="dont-keep-activities">  N√£o mantenha atividades </h4><br><p>  Este sinalizador para teste realmente permite encontrar alguns erros no aplicativo, mas o comportamento que ele reproduz <strong>NUNCA</strong> ocorre na realidade!  N√£o acontece que o processo de inscri√ß√£o permane√ßa e nesse momento a Atividade, embora n√£o ativa, morra!  As atividades podem morrer apenas com o processo de inscri√ß√£o.  Se o aplicativo for exibido para o usu√°rio e o sistema n√£o tiver recursos suficientes, tudo ao seu redor morrer√° (outros aplicativos inativos, servi√ßos e at√© o iniciador), e seu aplicativo viver√° at√© o fim, e se precisar morrer, ser√° totalmente. <br>  Voc√™ pode conferir. </p><br><h4 id="nasledie">  Legado </h4><br><p>  Historicamente, h√° uma enorme quantidade de l√≥gica desnecess√°ria no Activity que provavelmente n√£o √© √∫til para voc√™.  Por exemplo, tudo o que voc√™ precisa para trabalhar com <code>loaders</code> , <code>actionBar</code> , <code>action menu</code> e assim por diante.  Isso torna a classe em si bastante massiva e pesada. </p><br><h4 id="animacii">  Anima√ß√µes </h4><br><p>  Talvez qualquer pessoa possa fazer uma anima√ß√£o de mudan√ßa simples ao alternar entre a Atividade.  Aqui, vale esclarecer que voc√™ precisa fazer um desconto na assincronia do lan√ßamento da Atividade, sobre a qual falamos anteriormente. <br>  Se voc√™ precisar de algo mais interessante, lembre-se de exemplos de anima√ß√µes de transi√ß√£o feitas na Atividade: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/62f/b33/b28/62fb33b285f8eb80ff856c813e278552.gif" alt="imagem"></p><br><p>  Mas h√° um grande problema: personalizar essa anima√ß√£o √© quase imposs√≠vel.  √â improv√°vel que agrade designers e clientes. </p><br><p>  Com fragmentos, tudo √© diferente.  Podemos ir direto ao n√≠vel da hierarquia da exibi√ß√£o e fazer qualquer anima√ß√£o que voc√™ possa imaginar!  Evid√™ncia direta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> : </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/446/23f/e72/44623fe72553a5f7ba0b0074c45109eb.gif" alt="imagem"></p><br><p>  Se voc√™ olhar o c√≥digo-fonte, ver√° que isso √© feito em um layout regular.  Sim, o c√≥digo √© decente l√°, mas a anima√ß√£o √© sempre dif√≠cil o suficiente, e ter essa oportunidade √© sempre uma vantagem.  Se voc√™ tiver duas atividades ativadas, o aplicativo n√£o ter√° um cont√™iner comum onde voc√™ poder√° fazer essas transi√ß√µes. </p><br><h4 id="izmenenie-konfiguracii-naletu">  Configurar a configura√ß√£o imediata </h4><br><p>  Este ponto n√£o estava no meu discurso, mas tamb√©m √© muito importante.  Se voc√™ tiver um recurso para alternar o idioma dentro do aplicativo, com v√°rias Atividades, ser√° bastante problem√°tico implement√°-lo, se, entre outras coisas, voc√™ n√£o precisar reiniciar o aplicativo, mas permanecer no mesmo local em que o usu√°rio estava no momento da chamada da funcionalidade. </p><br><p>  Em um aplicativo de Atividade √önica, basta alterar o c√≥digo do idioma instalado no contexto do aplicativo e chamar <code>recreate()</code> na Atividade, o restante do sistema far√° tudo sozinho. </p><br><h4 id="naposledok">  No final </h4><br><p>  O Google possui uma solu√ß√£o de navega√ß√£o, cuja documenta√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">afirma explicitamente</a> que √© aconselh√°vel escrever aplicativos de atividade √∫nica. </p><br><p>  Neste ponto, espero que voc√™ n√£o tenha d√∫vidas de que a abordagem cl√°ssica com v√°rias atividades contenha uma s√©rie de defici√™ncias, das quais √© habitual fechar os olhos, se escondendo atr√°s da tend√™ncia geral do descontentamento do Android. </p><br><h2 id="esli-vse-tak-to-pochemu-single-activity-esche-ne-standart-razrabotki">  Se sim, ent√£o por que a Atividade √önica ainda n√£o √© um padr√£o de desenvolvimento? </h2><br><p>  Aqui vou citar meu bom amigo: </p><br><p><img src="https://habrastorage.org/webt/z_/k_/ou/z_k_outvwlcibszeamtv2jhjst0.png"></p><br><p>  Ao iniciar um novo projeto s√©rio, qualquer l√≠der tem medo de errar e evita decis√µes arriscadas.  Isto est√° correto.  Mas tentarei fornecer um plano abrangente para a transi√ß√£o para a atividade √∫nica. </p><br><h4 id="perehod-na-single-activity">  Mudando para atividade √∫nica </h4><br><p><img src="https://habrastorage.org/webt/vf/sw/8h/vfsw8hvr_sfcjs3olaxb3s2lptw.png"></p><br><p>  Se voc√™ estudar esse aplicativo, poder√° determinar a partir das anima√ß√µes e comportamentos caracter√≠sticos que ele est√° escrito em v√°rias atividades.  Eu posso estar errado e tudo foi feito mesmo em visualiza√ß√µes personalizadas, mas isso n√£o afetar√° nosso racioc√≠nio. </p><br><p>  Agora aten√ß√£o!  Fazemos assim: </p><br><p><img src="https://habrastorage.org/webt/0v/dt/cm/0vdtcmkom7y0jt0osv3fj61wn4k.png"></p><br><p>  Fizemos apenas duas altera√ß√µes: adicionamos a classe AppActivity e substitu√≠mos toda a atividade pelo FlowFragment.  Considere cada altera√ß√£o com mais detalhes. </p><br><p>  O <strong>AppActivity</strong> √© respons√°vel por: </p><br><ul><li>  cont√©m apenas um recipiente para fragmentos <br><ul><li>  √© o ponto de inicializa√ß√£o dos objetos da interface do usu√°rio do escopo (costumava ser feito no aplicativo, o que est√° errado, porque, por exemplo, os objetos de servi√ßo em nosso aplicativo definitivamente n√£o precisam desses objetos) </li><li>  √© um provedor de aplicativos </li><li>  traz todos os benef√≠cios da atividade √∫nica. </li></ul></li></ul><br><p>  O que √© <strong>FlowFragment</strong> : </p><br><ul><li>  faz exatamente a mesma coisa que a atividade, em vez da qual ela foi criada. </li></ul><br><h4 id="novaya-navigaciya">  Nova navega√ß√£o </h4><br><p>  A principal diferen√ßa da abordagem antiga √© a navega√ß√£o. </p><br><p><img src="https://habrastorage.org/webt/6c/xe/xm/6cxexm9iv1rxz4p9ag1hov7jb90.png"></p><br><p>  Anteriormente, o desenvolvedor tinha uma op√ß√£o: iniciar uma nova atividade ou uma transa√ß√£o de fragmento na atual.  A escolha n√£o desapareceu, mas os m√©todos foram alterados - agora precisamos decidir se devemos iniciar a fragmenta√ß√£o do fragmento no AppActivity ou dentro do FlowFragment atual. </p><br><p><img src="https://habrastorage.org/webt/am/cq/ac/amcqacvs343ah96hpnaykgnixtw.png"></p><br><p>  Da mesma forma com o processamento do bot√£o Voltar.  Anteriormente, a Atividade passava o evento para o fragmento atual e, se n√£o o processasse, tomava a pr√≥pria decis√£o.  Agora AppActivity passa o evento para o FlowFragment atual e, por sua vez, passa para o fragmento atual. </p><br><h4 id="peredacha-rezultata-mezhdu-ekranami">  Transferindo resultados entre telas </h4><br><p>  Para desenvolvedores inexperientes, a quest√£o da transfer√™ncia de dados entre telas √© o principal problema da nova abordagem, porque anteriormente era poss√≠vel usar a funcionalidade startActivityForResult ()! </p><br><p>  N√£o no primeiro ano, v√°rias abordagens arquiteturais para escrever aplicativos foram discutidas.  A principal tarefa ao mesmo tempo continua sendo a separa√ß√£o da interface do usu√°rio e a camada de dados e a l√≥gica de neg√≥cios.  Desse ponto de vista, startActivityForResult () quebra o c√¢none, pois os dados entre as telas de <strong>um</strong> aplicativo s√£o transferidos no lado da entidade da camada da interface do usu√°rio.  Enfatizo que √© apenas <strong>um</strong> aplicativo, pois temos uma camada de dados comum, modelos comuns em um escopo global e assim por diante.  N√£o usamos essas oportunidades e nos dirigimos √† estrutura de um pacote (serializa√ß√£o, tamanho e muito mais). <br>  <strong>Meu conselho</strong> : n√£o use startActivityForResult () dentro do aplicativo!  Use-o apenas para a finalidade a que se destina - para executar aplicativos externos e obter resultados com eles. </p><br><p>  Como ent√£o iniciar uma tela com uma op√ß√£o para outra tela?  Existem tr√™s op√ß√µes: </p><br><ol><li>  Targetfragment </li><li>  Eventbus </li><li>  modelo a jato </li></ol><br><p>  TargetFragment - uma op√ß√£o "pronta para uso", mas a mesma transfer√™ncia de dados no lado da camada da interface do usu√°rio.  <strong>Op√ß√£o ruim.</strong> </p><br><p>  EventBus - se voc√™ pode concordar com uma equipe e - o mais importante - controlar os arranjos, pode implementar a transfer√™ncia de dados entre telas no barramento de dados global.  Mas, como essa √© uma jogada perigosa, a conclus√£o √© uma <strong>m√° op√ß√£o.</strong> </p><br><p>  Modelo reativo - essa abordagem implica a presen√ßa de retornos de chamada e muito mais.  Como voc√™ os implementa √© decidido pela equipe de cada projeto.  Mas essa abordagem √© ideal, pois fornece controle sobre o que est√° acontecendo e n√£o permite que o c√≥digo seja usado para outros fins.  <strong>Nossa escolha!</strong> </p><br><h4 id="itog">  Sum√°rio </h4><br><p>  Adoro novas abordagens quando s√£o simples e t√™m benef√≠cios √≥bvios.  Espero que este seja o caso neste caso.  Os benef√≠cios s√£o descritos na primeira parte e voc√™ deve julgar a dificuldade.  Basta substituir toda a atividade pelo FlowFragment, mantendo toda a l√≥gica inalterada.  Mude um pouco o c√≥digo de navega√ß√£o e pense em trabalhar com a transfer√™ncia de dados entre telas, se ainda n√£o o tiver feito. </p><br><p>  Para mostrar a simplicidade da abordagem, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mudei o aplicativo aberto</a> para Atividade √önica e levou apenas algumas horas (√© claro, vale a pena considerar que esse n√£o √© um legado antigo e que tudo √© mais ou menos bom com a arquitetura). </p><br><h2 id="chto-poluchilos">  O que aconteceu? </h2><br><p>  Vamos ver como resolver problemas padr√£o em uma nova abordagem. </p><br><h4 id="bottomnavigationbar-i-navigationdrawer">  BottomNavigationBar e NavigationDrawer </h4><br><p>  Usando a regra simples de substituir toda a Atividade pelo FlowFragment, o menu lateral estar√° agora em algum fragmento e alternar√° fragmentos aninhados: </p><br><p><img src="https://habrastorage.org/webt/hp/dv/u9/hpdvu9gp85_zzzt2qi23ndafrxw.png"></p><br><p>  Semelhante ao BottomNavigationBar. <br>  √â muito mais interessante podermos investir alguns FlowFragment em outros, pois ainda s√£o fragmentos comuns! </p><br><p><img src="https://habrastorage.org/webt/vk/qo/2r/vkqo2rovrabjb_2qorv-ot6leie.png"></p><br><p>  Esta op√ß√£o pode ser encontrada no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitFox</a> . </p><br><p>  √â a possibilidade de simplesmente combinar alguns fragmentos entre outros que possibilita a cria√ß√£o de uma interface de usu√°rio din√¢mica para diferentes dispositivos sem problemas: tablets + smartphones. </p><br><h4 id="di-skoupy">  Escopos DI </h4><br><p>  Se voc√™ possui um fluxo de compras de produtos em v√°rias telas e precisa mostrar o nome do produto em cada tela, provavelmente j√° o colocou em uma Atividade separada que armazena o produto e o fornece √†s telas. <br>  Ser√° o mesmo com o FlowFragment - ele conter√° uma escala DI com modelos para todas as telas aninhadas.  Essa abordagem elimina o controle complicado da vida √∫til do escopo, vinculando-o √† vida √∫til do FlowFragment. </p><br><p><img src="https://habrastorage.org/webt/jg/o7/fc/jgo7fcldgytixv_pi4rd4vv9ynw.png"></p><br><h4 id="deep-links">  Links diretos </h4><br><p>  Se voc√™ usou filtros no manifesto para iniciar uma tela espec√≠fica no link direto, poder√° ter problemas ao iniciar a Atividade, sobre a qual escrevi na primeira parte.  Na nova abordagem, todos os links diretos se enquadram em AppActivity.onNewIntent.  Al√©m disso, de acordo com os dados obtidos, h√° uma transi√ß√£o para a tela necess√°ria (ou uma cadeia de telas. Proponho examinar essa <a href="">funcionalidade no Chicheron</a> ). </p><br><p><img src="https://habrastorage.org/webt/hg/hv/dz/hghvdzuz1kp_zaj_mqqxwgbbmk0.png"></p><br><h4 id="smert-processa">  Processo de morte </h4><br><p>  Se o aplicativo estiver gravado em v√°rias Atividades, voc√™ deve saber que, quando o aplicativo morrer, e quando o processo for restaurado, o usu√°rio estar√° na √∫ltima Atividade, e todos os anteriores ser√£o restaurados somente quando retornarem a eles. </p><br><p><img src="https://habrastorage.org/webt/za/39/ws/za39wsenkveryhdk21ngp0w-hyq.png"></p><br><p>  Se voc√™ n√£o considerar isso com anteced√™ncia, poder√£o surgir problemas.  Por exemplo, se o escopo necess√°rio na √∫ltima Atividade foi aberto na anterior, ningu√©m o recriar√°.  O que fazer  Trazer isso para a classe Application?  V√°rios pontos abrem escopos? </p><br><p>  Tudo √© mais simples com fragmentos, pois eles est√£o dentro de uma Atividade ou outro FlowFragment, e qualquer cont√™iner ser√° restaurado ANTES de recriar o fragmento. </p><br><p><img src="https://habrastorage.org/webt/8p/vd/q5/8pvdq5nmwbgjbfi6am26nzotpnq.png"></p><br><p>  Podemos discutir outras tarefas pr√°ticas nos coment√°rios, caso contr√°rio, h√° uma chance de o artigo ser muito volumoso. </p><br><p>  E agora a parte mais interessante. </p><br><h2 id="uzkie-mesta-nado-pomnit-i-dumat">  Gargalos (voc√™ precisa se lembrar e pensar). </h2><br><p>  Aqui est√£o reunidas coisas importantes que voc√™ deve pensar em qualquer projeto, mas todo mundo est√° t√£o acostumado a "rasg√°-las" em projetos de v√°rias Atividades que vale a pena lembrar e dizer como resolv√™-las corretamente na nova abordagem.  E primeiro na lista </p><br><h4 id="povorot-ekrana">  Rota√ß√£o da tela </h4><br><p>  Esse √© o <u>conto</u> mais <u>terr√≠vel</u> para os f√£s chor√µes que o Android recria o Activity quando a tela √© girada.  O m√©todo de solu√ß√£o mais popular √© corrigir a orienta√ß√£o de retrato.  Al√©m disso, essa proposta n√£o √© mais feita por desenvolvedores, mas por gerentes assustados com frases como " <em>manter uma curva √© muito dif√≠cil e custa v√°rias vezes mais</em> ". <br>  N√£o discutiremos sobre a exatid√£o de tal decis√£o.  Outra coisa √© importante: <strong>fixar a rota√ß√£o n√£o isenta da morte da Atividade!</strong>  Como os mesmos processos ocorrem com muitos outros eventos: modo dividido, quando v√°rios aplicativos s√£o exibidos na tela, conectando um monitor externo, alterando a configura√ß√£o do aplicativo rapidamente e assim por diante. </p><br><p>  Al√©m disso, a rota√ß√£o da tela permite verificar a "elasticidade" correta do layout, portanto, em nossa equipe de S√£o Petersburgo, n√£o desativamos a rota√ß√£o em todas as montagens de vendas, mesmo que n√£o esteja na vers√£o de lan√ßamento.  Sem mencionar os erros t√≠picos que ainda ser√£o encontrados durante a verifica√ß√£o. </p><br><p>  Muitas solu√ß√µes j√° foram escritas para virar, come√ßando no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moxy</a> e terminando com v√°rias implementa√ß√µes do MVVM.  Fa√ßa com que n√£o seja mais dif√≠cil do que qualquer outra coisa. </p><br><p>  Considere outro caso interessante. <br>  Imagine um aplicativo de cat√°logo de produtos.  Fazemos isso em atividade √∫nica.  Em todos os lugares o modo retrato √© fixo, mas o cliente deseja um recurso quando, ao visualizar a galeria de fotos, o usu√°rio pode assisti-los na orienta√ß√£o paisagem.  Como apoiar isso? </p><br><p>  Algu√©m oferecer√° a <strong>primeira muleta</strong> : </p><br><pre> <code class="hljs pgsql">&lt;activity android:<span class="hljs-type"><span class="hljs-type">name</span></span>=".AppActivity" android:configChanges="orientation" /&gt;</code> </pre> <br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onConfigurationChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(newConfig: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Configuration</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newConfig?.orientation == Configuration.ORIENTATION_LANDSCAPE) { <span class="hljs-comment"><span class="hljs-comment">//ignore } else { super.onConfigurationChanged(newConfig) } }</span></span></code> </pre> <br><p>  Portanto, n√£o podemos chamar <code>super.onConfigurationChanged(newConfig)</code> , mas process√°-lo e rotacionar apenas a visualiza√ß√£o necess√°ria na tela. <br>  Mas com a API 23, o projeto trava com uma <code>SuperNotCalledException</code> , uma <strong>p√©ssima escolha</strong> . </p><br><p>  <strong>As declara√ß√µes acima cometeram um erro:</strong> <br>  Fui razoavelmente corrigido nos coment√°rios de que a adi√ß√£o de android: configChanges = "guidance | screenSize" √© suficiente e, em seguida, voc√™ pode chamar super e Activity n√£o ser√° recriado ap√≥s a rota√ß√£o.  √â √∫til us√°-lo quando um WebView ou mapa est√° na tela que leva muito tempo para inicializar e voc√™ deseja evitar isso. <br>  Isso ajudar√° a resolver o caso descrito com a galeria, mas a principal mensagem desta se√ß√£o: <u>n√£o ignore a recria√ß√£o de Activity</u> , isso pode acontecer em muitos outros casos. </p><br><p>  Algu√©m pode sugerir outra solu√ß√£o: </p><br><pre> <code class="hljs pgsql">&lt;activity android:<span class="hljs-type"><span class="hljs-type">name</span></span>=".AppActivity" android:screenOrientation="portrait" /&gt; &lt;activity android:<span class="hljs-type"><span class="hljs-type">name</span></span>=".RotateActivity" /&gt;</code> </pre> <br><p>  Mas, dessa maneira, nos afastamos da abordagem de atividade √∫nica para resolver um problema simples e nos privamos de todos os benef√≠cios da abordagem.  Esta √© uma muleta, e uma muleta √© sempre uma <strong>m√° escolha</strong> . </p><br><p>  Aqui est√° a solu√ß√£o certa: </p><br><pre> <code class="hljs pgsql">&lt;activity android:<span class="hljs-type"><span class="hljs-type">name</span></span>=".AppActivity" android:configChanges="orientation" /&gt;</code> </pre> <br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume() activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_SENSOR } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPause</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onPause() activity?.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT }</code> </pre> <br><p>  Ou seja, quando o fragmento √© aberto, o aplicativo come√ßa a "girar" e, quando retorna, √© corrigido novamente.  Na minha <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">experi√™ncia,</a> √© assim que o aplicativo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AirBnB funciona</a> .  Se voc√™ abrir uma vista das fotos da habita√ß√£o, o processamento de turnos ser√° ativado, mas na orienta√ß√£o paisagem, voc√™ pode arrastar a foto para baixo para sair da galeria.  Abaixo dela, a tela anterior ficar√° vis√≠vel na orienta√ß√£o paisagem, que voc√™ normalmente n√£o encontrar√°, pois imediatamente ap√≥s sair da galeria, a tela se tornar√° um retrato e ser√° corrigida. </p><br><p><img src="https://habrastorage.org/webt/to/wt/kj/towtkjtucdgw_d2s5da7b2awzkm.png"></p><br><p>  √â aqui que a prepara√ß√£o oportuna para as rota√ß√µes da tela ajudar√°. </p><br><h4 id="transparent-status-bar">  Barra de status transparente </h4><br><p>  Somente Activity pode funcionar com a barra do sistema, mas agora temos apenas uma, portanto, voc√™ deve sempre especificar </p><br><pre> <code class="hljs pgsql">&lt;item <span class="hljs-type"><span class="hljs-type">name</span></span>="android:windowTranslucentStatus"&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>&lt;/item&gt;</code> </pre> <br><p>  Mas, em algumas telas, n√£o √© necess√°rio "rastrear" por baixo e √© necess√°rio exibir todo o conte√∫do abaixo.  A bandeira vem em socorro </p><br><pre> <code class="hljs objectivec">android:fitsSystemWindows=<span class="hljs-string"><span class="hljs-string">"true"</span></span></code> </pre> <br><p>  que indica o layout que voc√™ n√£o deve desenhar sob a barra do sistema.  Mas se voc√™ especific√°-lo no layout do fragmento e tentar exibi-lo atrav√©s da transa√ß√£o no gerenciador de fragmentos, ficar√° desapontado ... n√£o funcionar√°! <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A resposta √© rapidamente google</a> <br>  Eu recomendo que voc√™ se familiarize com uma resposta realmente abrangente e com muitos links √∫teis. <br>  Uma solu√ß√£o r√°pida e funcional ( <em>mas n√£o a correta</em> ) √© agrupar o layout no <code>CoordinatorLayout</code> </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.design.widget.CoordinatorLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:fitsSystemWindows</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.design.widget.CoordinatorLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Uma solu√ß√£o melhor ajuda a processar o teclado tamb√©m. </p><br><h4 id="izmenenie-verstki-pri-poyavlenii-klaviatury">  Alterar o layout quando o teclado aparecer </h4><br><p>  Quando o teclado sair, o layout deve mudar para que elementos importantes da interface do usu√°rio n√£o fiquem fora de alcance.  E, se anteriormente, poder√≠amos especificar diferentes modos de rea√ß√£o para o teclado para diferentes atividades, agora precisamos fazer isso na atividade √∫nica.  Portanto, √© necess√°rio usar </p><br><pre> <code class="hljs objectivec">android:windowSoftInputMode=<span class="hljs-string"><span class="hljs-string">"adjustResize"</span></span></code> </pre> <br><p>  Se voc√™ usar a abordagem da se√ß√£o anterior para processar uma barra de status transparente, encontrar√° um erro infeliz: se um fragmento rastrear com √™xito sob a barra de status, quando o teclado aparecer, ele encolher√° acima e abaixo, conforme a barra de status e o teclado dentro do sistema funcionem <code>SystemWindows</code> . </p><br><p>  Preste aten√ß√£o ao t√≠tulo </p><br><p><img src="https://habrastorage.org/webt/vr/ay/xo/vrayxosszrpgfsq-eyia_z4hshi.gif"></p><br><p>  O que fazer  Leia a documenta√ß√£o!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E n√£o deixe de ver </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chris Banes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falar </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">sobre WindowInsets</font></a><font style="vertical-align: inherit;"> .</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usar WindowInsets permitir√° </font></font></p><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descubra a altura correta da barra de status (e n√£o o c√≥digo 51dp) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prepare o aplicativo para qualquer recorte nas telas dos novos smartphones </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descubra a altura do teclado (√© real!) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Receba eventos e responda √† apar√™ncia do teclado. </font></font></li></ul><br><p> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todo mundo aprende WindowInsets!</font></font></strong> </p><br><h4 id="splash-screen"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tela inicial </font></font></h4><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se outra pessoa n√£o souber, a tela inicial can√¥nica n√£o √© a primeira tela no aplicativo que carrega dados, mas o que o usu√°rio v√™ na inicializa√ß√£o at√© que o conte√∫do da atividade tenha tempo para renderizar. </font><font style="vertical-align: inherit;">Existem muitos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre esse assunto.</font></font></p><br><p><img src="https://habrastorage.org/webt/fs/nd/nt/fsndntzk-erl-iebzisfiiftsfc.png"></p><br><p>    ,   Single-Activity,    Splash screen.     ,     deep-link      Splash screen     . </p><br><h4 id="zapusk-vashego-prilozheniya-iz-drugih-prilozheniy">       </h4><br><p>  <strong>    </strong> ,    ,      ,    . </p><br><p> ,       .    Single-Activity.    -         ,   ,    . <br>                 ... <br>  Intent,   ,        ... <br>  O que vem a seguir?   : </p><br><ul><li>    ,       ¬´¬ª.    ¬´¬ª,    .    ,   ! </li><li>      ,    ‚Ä¶ </li></ul><br><p>      ,     .           ?     ‚Äî           ¬´¬ª   ¬´¬ª   . </p><br><p>  O que fazer  ,    . </p><br><p>    Activity! <br> ,    :       ,   ‚Äî        . <br>       ‚Äî ,      (   Activity),    . </p><br><p>  Activity ‚Äî       .      Activity,         .     . </p><br><p><img src="https://habrastorage.org/webt/hj/cs/wd/hjcswdrykm21jtyzupyongbe494.png"></p><br><h2 id="zaklyuchenie">  Conclus√£o </h2><br><p>    ()   ,        Activity,        Android-.         ,             . </p><br><p>    :     Google       .        ‚Äî      ,   ,    Activity     . </p><br><p> ,    ,      ,        !  Obrigada </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426617/">https://habr.com/ru/post/pt426617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426605/index.html">An√°lise est√°tica do c√≥digo PHP usando PHPStan, Phan e Salmo como exemplo</a></li>
<li><a href="../pt426609/index.html">O Office 365 e outros produtos MS adicionam E / S de voz para disl√©xicos</a></li>
<li><a href="../pt426611/index.html">Integra√ß√£o ao SAP ERP, usando o Django-python como exemplo, usando o protocolo oData (restante)</a></li>
<li><a href="../pt426613/index.html">N√£o deixe a impressora 3D pregui√ßosa</a></li>
<li><a href="../pt426615/index.html">Escrevendo uma CLI no NodeJS</a></li>
<li><a href="../pt426621/index.html">Strings compactas em Java 9</a></li>
<li><a href="../pt426623/index.html">Este √© um √¥nibus el√©trico: o que sabemos sobre o transporte com bateria</a></li>
<li><a href="../pt426625/index.html">√Årvores multil√≠ngues no Yii2 como um exemplo de cria√ß√£o de um m√≥dulo de menu</a></li>
<li><a href="../pt426627/index.html">Exemplos de Flexbox</a></li>
<li><a href="../pt426629/index.html">Filosofia da reforma tribut√°ria de Trump</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>