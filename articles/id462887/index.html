<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🔧 🤚🏻 🌇 Pengalaman mempersonalisasi toko online menggunakan contoh rekomendasi dinamis 🎄 🖖🏾 🐎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! 

 Saya akan membagikan pengalaman saya tentang bagaimana kami menyusun sistem personalisasi kami sendiri berdasarkan “pengetahuan” tentan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengalaman mempersonalisasi toko online menggunakan contoh rekomendasi dinamis</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462887/">  Halo, Habr! <br><br>  Saya akan membagikan pengalaman saya tentang bagaimana kami menyusun sistem personalisasi kami sendiri berdasarkan “pengetahuan” tentang pembeli potensial. <br><br><img src="https://habrastorage.org/webt/g9/tm/42/g9tm42bsweko8glwn5j1p9qd89a.jpeg" alt="gambar"><br><br>  Satu-satunya perbedaan antara solusi kami dan yang klasik adalah penggunaan bundel gabungan sejumlah solusi dan memenuhi daftar persyaratan: <br><br><ul><li>  layanan seharusnya bekerja segera di situs N </li><li>  segmentasi audiens yang dinamis </li><li>  Penyaringan kolaboratif untuk keperluan perkiraan dalam berbagai kondisi segmen audiens </li><li>  statis yang dihasilkan sebelumnya dalam bentuk konten yang disarankan + campuran dinamis barang berdasarkan analisis clickstream </li><li>  perubahan konten, hampir secara real time, dari RAM, dengan mempertimbangkan koefisien dinamis akun </li></ul><br>  Ini lebih rinci :) Dan tentang rake yang membantu kami mengubah tumpukan menjadi lebih baik. <br><a name="habracut"></a><br><h3>  Latar belakang </h3><br>  Ada sekelompok situs dengan subjek yang sama, yang pemirsanya mirip - situs satu holding.  Kontennya berbeda, sebagai aturannya, setiap situs menerbitkan informasi tentang barang yang diproduksi oleh perusahaan induk.  Selain situs "konten" ini, ada juga toko online sendiri tempat produk ini dijual. <br><br>  Setiap situs memiliki tim pemasarannya sendiri, penghitung GA dan Ya Metriknya sendiri.  Menganalisis audiens mereka sendiri, sesama pemasar menyesuaikan konten situs, dengan mempertimbangkan kebutuhan pengunjung.  Secara alami, audiensi dari situs-situs ini berpotongan, tetapi karena pada saat itu tidak ada penghitung tunggal, hasil analisisnya bersifat lokal. <br><br>  Analis mana pun akan membuat keputusan yang tepat, siap dengan lebih banyak data.  Demi tujuan yang baik ini, ia mengembangkan versi konternya sendiri. <br><br>  <b>Mengapa tidak Google Analytics?</b> <br><br>  Sampling, kurangnya kemampuan untuk menarik segala sesuatu tentang pengguna dengan rantai perpindahannya dari situs eksternal, melalui banyak situs kami, dengan detail yang ia tonton, dll.  Ya, dalam hal tugas GA, ini adalah alat yang bagus, tetapi ketika Anda ingin mendapatkan data secara langsung dan segera memutuskan konten apa yang akan ditampilkan kepada pengunjung, maka ... raksasa analitik tidak memiliki solusi seperti itu.  Menari dengan rebana ID klien untuk transfer antar situs bukan pilihan kami. <br>  Menempatkan penghitung tunggal untuk semua situs bukanlah keputusan "politik" yang sepenuhnya benar, dan mereka akan langsung jatuh ke dalam pembatasan versi gratis. <br><br>  Saya harus segera mengatakan bahwa saya tidak mulai menemukan kembali roda dan membatasi diri pada fungsional sederhana yang tugasnya adalah: <br><br><ol><li>  Perbaiki setiap pengguna unik, apa pun situsnya.  Ini diperlukan untuk membuat profil klien tunggal di mana semua datanya akan ditulis dengan referensi ke setiap situs. </li><li>  Melacak rantai transisi yang panjang antara semua situs grup dalam satu sesi.  Ini diperlukan untuk mengidentifikasi: kepentingan pengguna;  apa yang mereka tonton;  apa yang mereka beli;  apa yang dimasukkan ke dalam keranjang tetapi tidak dibeli;  produk apa dari situs yang berbeda dapat menjadi “produk pengganti” selama proses pembelian, dll. </li><li>  Melacak aktivitas periklanan dari semua pemasar (di setiap tim situs) untuk analisis selanjutnya.  Ini diperlukan untuk: memperkaya profil setiap pengunjung;  identifikasi kampanye iklan optimal yang dikaitkan dengan produk;  identifikasi saluran iklan yang efektif dengan mengacu pada suatu produk atau kampanye, dll.  daftarnya sangat panjang. </li></ol><br>  Semua data dituangkan secara real time ke dalam koleksi lokal.  Ternyata tidak terlalu buruk.  Di masa mendatang, dimungkinkan untuk membuat laporan agregat apa pun berdasarkan produk dan oleh: audiens, kampanye iklan, sumber lalu lintas, dan apa pun yang muncul di pikiran.  Untuk setiap unit barang ada data tentang harga, jumlah dalam stok, diskon, promosi, dan bahkan lautan data. <br><br>  Puji situasi ini, saya seorang analis + pengembang + pemasar + manajer + saya memiliki akses ke segala sesuatu yang didigitalkan dalam holding.  Saya tidak punya tugas teknis di awal, saya melakukannya sendiri untuk menyelesaikan tugas analisis data biasa. <br><br><h4>  Momen teknis: </h4><br><ul><li>  MongoDB digunakan sebagai sistem penyimpanan terpadu </li><li>  pengumpulan data real-time berbasis javascript </li><li>  pertukaran data lokal antara situs berdasarkan rabbitmq </li></ul><br><blockquote>  Sementara segalanya, seperti orang lain ... Tapi kemudian dimulai </blockquote><br>  Mengingat fakta bahwa pengetahuan yang diperoleh tentang pembeli dan produk telah cukup terakumulasi, kami memutuskan untuk membuat sistem rekomendasi kami sendiri untuk toko online. <br><br>  Semuanya ternyata hebat.  Kami menganalisis segalanya, tetapi tanpa fanatisme.  Modelnya bertambah besar dan, seperti biasanya, saatnya tiba ketika saya menginginkan lebih. <br><br><h4>  Momen teknis 2: </h4><br><ul><li>  Replikasi MongoDB membantu hidup, tetapi sharding segera ditinggalkan.  Momen ini belum melewati sejumlah aspek internal.  Jika koleksi clickstream dapat tersebar di sekitar pecahan, maka koleksi profil pengguna tidak lagi ada.  Dimungkinkan untuk mengumpulkan hasil kueri teragregasi dari bagian yang berbeda untuk sebagian laporan, tetapi kecepatan eksekusi meninggalkan banyak hal yang diinginkan.  Tanpa pecahan, itu bekerja lebih baik dan lebih stabil </li><li>  Pengumpulan data waktu nyata berdasarkan javascript - di sini bundel CORS + HTTPS adalah diktator.  Contohnya, ketika seorang pengguna datang ke salah satu situs grup, dan layanan kami "memberinya wewenang" segera di zona multi-domain (saya ingat, ada 5 situs terpisah yang terpisah pada waktu itu) itu indah secara teknologi dan misterius untuk sesama pemasar yang sekarang dapat melihat semua tekan rantai untuk semua situs sekaligus. </li><li>  Model layanan rekomendasi ditulis dalam Python.  Namun pelatihan itu butuh waktu lama.  File model beberapa puluh GB. </li><li>  Layanan pemberi rekomendasi bekerja secara standar pada APInya sendiri, tetapi respons server menjadi hambatan, atau lebih tepatnya, waktu yang dibutuhkan untuk mendapatkan hasilnya.  Semakin banyak data, semakin besar model, semakin besar model, semakin lambat hasilnya.  Sebagai tanggapan, perlu memperhitungkan banyak faktor yang berubah setiap jam (stok barang dalam persediaan, karakteristik pengguna dan mode, semua jenis diskon, dll.) </li></ul><br>  Beberapa bulan kemudian, kualitas API telah melewati semua batas "kualitas" yang waras.  Untuk pengguna, kecepatan respons melebihi tanda 400ms.  Blok konten berkumpul perlahan, situs mulai terasa membosankan.  Koleksi MongoDB berjumlah puluhan juta catatan ... <br><br><h2>  Sudah waktunya untuk mengubah sesuatu </h2><br>  Hampir semua instrumen dicatat pada tingkat operasi, masing-masing bersin diukur. <br><br>  Apa yang berubah untuk apa: <br><br><ul><li>  Clickhouse di MongoDB </li><li>  lanjut MongoDB ke MongoDB + Tarantool </li><li>  EVE di Labu </li><li>  Labu Selanjutnya di Falcon </li><li>  file terpisah dengan janji di js dan dengan otorisasi pengguna di semua domain.  Mereka tidak mengubah logika, refactoring menang </li></ul><br>  <b>Mengapa tidak metrik API?</b> <br><br>  Pada awalnya, saya hanya melihat ke arah solusi siap pakai dari Yandex, tetapi itu tidak lama.  Ini bagus ketika satu situs sedang beroperasi.  dan ketika ada n, dan Anda ingin memproses data segera, maka tidak ada waktu untuk menari dengan rebana. <br><br>  <b>Mengapa MongoDB?</b> <br><br>  Spesifikasi produk terus ditambahkan, beberapa dari mereka, sayangnya, tidak selalu disajikan. <br>  Menggunakan kueri teragregasi - sangat cocok dengan format gaya teknologi lokal tim.  SQL klasik tidak ingin menghasilkan tabel. <br><br>  Cukup sering, jenis dan varian data yang disimpan dan diproses diubah. <br>  Pada awalnya, saya berpikir bahwa saya akan menggunakan Yandex clickhouse sebagai dasar untuk layanan ini, tetapi kemudian saya meninggalkan ide ini, tetapi clickhouse juga ada di stack holder kami. <br><br>  Saat yang baru telah tiba, 2000 permintaan per detik ... asalkan dalam seminggu luncurkan fungsionalitas baru dan beban akan semakin meningkat. <br><br>  Selama pembelajaran mesin, untuk pertama kalinya di htop saya melihat beban 100% dari 12 core sekaligus dan pertukaran penuh pada server yang produktif.  Zabbix secara aktif menginformasikan bahwa MongoDB telah mengubah master dalam replika dua kali dalam 10 menit.  Semua orang menginginkan stabilitas dan keadaan yang dapat diprediksi. <br><br><h2>  Sudah waktunya untuk mengubah sesuatu 2.0 </h2><br>  Jumlah pengguna telah meningkat.  Jumlah pelanggan serupa.  Untuk semua orang yang pernah berkunjung ke salah satu situs, kami telah mengumpulkan profil pribadi.  Penonton pengunjung reguler sebagian terbentuk. <br><br>  Apa yang kamu tahu bagaimana melakukannya?  Ya, laporan tidak standar apa pun untuk analytics + keanekaragaman konten: <br><br><ul><li>  Pilih semua pengguna yang datang dari kampanye iklan A, yang berada pada kuartal terakhir, di antara mereka, temukan orang-orang yang tertarik pada barang dari pos N, kemudian mengecualikan mereka yang membeli hanya pada saham, mengecualikan mereka yang memasukkan produk apa pun di keranjang dan pergi situs  Menurut mereka, buat penyortiran dengan urutan menurun dari pendapatan toko jika pengguna ini sekarang datang ke situs web toko dan membeli barang Z.  <i>Sesuatu seperti itu, dan dengan kancing mutiara lainnya ...</i> </li><li>  Untuk menganalisis lalu lintas masuk, bagi pengguna dengan utm tag Y untuk membentuk penawaran konten, tetapi SEBELUM membangun, mengidentifikasi pengguna, mengecualikan mereka yang minggu lalu tetapi berada di situs S (salah satu grup dari situs memegang) dan tertarik pada produk Q - untuk itu menghasilkan konten yang diurutkan berdasarkan kriteria x, y, z </li><li>  Adalah basi untuk menemukan mereka yang sering mengunjungi situs A, kadang-kadang itu terjadi di situs B (mereka mengunjungi bagian tertentu), dan yang memiliki rata-rata cek di toko online lebih dari N rubel </li></ul><br>  Sebenarnya, ini bukan dalam format "pemrograman abnormal", saya menginginkan sesuatu yang lain.  Yang lain mendatangi kami.  Pada saat kampanye iklan, toko online dibungkuk karena beban, apa yang dapat kita katakan tentang API-shki kami, yang menangkap beban ini “berdiri di sebelahnya”. <br><br><h2>  Keputusan diambil tepat waktu </h2><br>  Kami melakukan analisis terhadap audiens, memutuskan untuk mengumpulkan konten bukan untuk semua orang, tetapi untuk kelompok pengunjung.  Seluruh kerumunan berkerumun.  Setiap cluster memiliki karakteristik dan “rasa” tersendiri untuk berbelanja.  Clustering dilakukan setiap hari.  Ini diperlukan agar pada saat kunjungan berikutnya pengguna akan menunjukkan konten yang paling sesuai dengannya. <br><br>  Dari sesi ke sesi, minat dan kebutuhan klien berubah, dan jika terakhir kali ia secara otomatis ditugaskan ke cluster No. 788897, maka dengan mempertimbangkan minatnya saat ini, sistem dapat mentransfernya ke cluster No. 9464, yang akan lebih efektif mempengaruhi konversi berikutnya. <br><br>  Setelah prosedur pengelompokan harian, tahap berikutnya diluncurkan - melatih model, memperhitungkan data dan pengetahuan baru tentang pelanggan dan memperhitungkan barang akun yang muncul di rak toko atau meninggalkannya selamanya. <br><br>  Untuk setiap cluster, kami membentuk blok konten terlebih dahulu dan merekamnya dalam memori.  Kemudian Tarantool datang ke tempat kejadian dengan segala kemuliaan.  Sebelumnya, kami menggunakannya untuk menyimpan data cepat, yang kemudian digunakan dalam pembelajaran mesin.  Ini adalah solusi terbaik, agar tidak mengoceh MongoDB yang sudah sibuk dengan tugas-tugas lain.  Di ruang angkasa Tarantool menyimpan data barang, data pengguna (pengetahuan yang diperlukan tentang pembeli). <br><br>  Secara kasar, malam ini kami "menyiapkan" konten untuk setiap kelompok khalayak yang mungkin mengunjungi situs tersebut besok.  Pengguna masuk, kami dengan cepat menentukan apakah kami tahu sesuatu tentang dia, dan jika jawabannya ya, paket konten yang diperlukan akan terbang ke Nginx.  Secara terpisah, untuk pengguna NoName, kluster default dikumpulkan dengan kontennya. <br><br><h2>  Postprocessing untuk personalisasi </h2><br>  Kami tahu bahwa ada pengguna sederhana, dan ada orang-orang yang kami miliki seluruh file pengetahuannya.  Semua ini ada di Tarantool dan diperbarui secara real time. <br><br>  Pada saat merakit halaman, kami mengetahui seluruh sejarah pembelian dan keranjang yang ditinggalkan setiap pengunjung (jika sebelumnya ia adalah klien kami), menentukan afiliasi klusternya, modul clickstream memberikan pengetahuan tentang sumber lalu lintas, kami tahu tentang minatnya di masa lalu dan yang mendesak.  Membangun array TOP50 dengan cepat dari produk yang dilihat sebelumnya (di salah satu situs grup), kami "menentukan mode" dan dicampur dalam konten "rasa" dari produk-produk tersebut, subjek yang paling sering menjadi filum di TOP50.  Analisis sederhana dari produk yang terakhir dilihat ini memberikan keuntungan nyata.  Konten cluster, kami memperkaya hasil personalisasi. <br><br><h2>  Hasil dari pengalaman kami </h2><br><ol><li>  Kami mendapat percepatan proses pembuatan konten pribadi sebanyak N kali </li><li>  Mengurangi beban server sebanyak 15 kali </li><li>  Kami dapat membuat hampir semua konten secara pribadi, dengan mempertimbangkan banyak pemasar Wishlist, fitur presentasi produk dan banyak pengecualian, dengan mempertimbangkan data akun dari profil pengguna dan peristiwa yang terjadi di situs saat ini - dan semua ini untuk ~ 25 ms </li><li>  Konversi untuk blok tersebut tidak jatuh di bawah 5,6% - pengguna bersedia membeli apa yang lebih dekat dengan kebutuhan mereka saat ini </li><li>  Kecepatan pemuatan halaman ideal - mereka menghapus konten yang "melewati" cluster sebesar&gt; 67%, yang benar </li><li>  Kami mendapatkan alat yang, sesuai dengan tugas pemasar, tidak hanya memberikan jawaban "apa yang terjadi sebelumnya", tetapi juga membantu merumuskan konten dalam waktu dekat, dengan mempertimbangkan minat dan kebutuhan pembeli potensial </li><li>  Informasi dari DMP ditambahkan ke profil setiap pembeli, sekarang kita dapat melakukan pengelompokan, termasuk oleh jejaring sosial, minat, tingkat pendapatan, dan permen lainnya. </li><li>  Layanan rekomendasi kami menjadi lebih baik, lebih banyak pesanan di toko </li></ol><br><h4>  Apa bagusnya ini? </h4><br>  Kami mendapat pengalaman baru, menguji sejumlah hipotesis yang kami tidak tahu cara melakukan pendekatan sebelumnya, kami tidak menggunakan solusi berbayar pihak ketiga untuk layanan rekomendasi yang tidak memperhitungkan semua fitur kami dan bekerja pada domain yang sama.  Tim menerima kasus yang bagus dan menarik, yang berhasil mereka kelola. <br><br>  Nafsu makan bertambah ... sekarang kami menguji logika baru perakitan konten.  Kami ingin mengumpulkan halaman untuk kampanye iklan, buletin, dan aktivitas eksternal lainnya.  Paket termasuk mentransfer logika konfigurasi dari mode manul ke arah pembelajaran mesin.  Situs akan menjalani kehidupan mereka sendiri, dan kami, selain dari "popcorn," akan mengamati evolusi penyajian konten situs berdasarkan pendapat AI. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id462887/">https://habr.com/ru/post/id462887/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id462877/index.html">Kunci di PostgreSQL: 1. Kunci Hubungan</a></li>
<li><a href="../id462879/index.html">Slurm DevOps: dari Git ke SRE dengan semua berhenti</a></li>
<li><a href="../id462881/index.html">Mengapa begitu sulit untuk memilih film mana yang akan ditonton (dan apa yang bisa dilakukan)</a></li>
<li><a href="../id462883/index.html">Mendesain toko online untuk SEO: (teori + daftar periksa)</a></li>
<li><a href="../id462885/index.html">Jaringan IPoE yang toleran terhadap kesalahan sudah dekat</a></li>
<li><a href="../id462889/index.html">Kisah Lanjutan: Kompilator Pascal sendiri untuk Windows dari awal</a></li>
<li><a href="../id462893/index.html">Pengenalan Wajah di Kota-kota: Keamanan vs Privasi</a></li>
<li><a href="../id462895/index.html">Memecahkan pekerjaan dengan pwnable.kr 17 - memcpy. Penyelarasan data</a></li>
<li><a href="../id462897/index.html">Pelajari OpenGL. Pelajaran 7.1 - Debugging</a></li>
<li><a href="../id462903/index.html">Bagaimana kami merancang dan mengimplementasikan jaringan baru pada Huawei di kantor Moskow, bagian 3: pabrik server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>