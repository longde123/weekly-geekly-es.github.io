<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ ğŸ‘ğŸ½ âœğŸ¾ ViewPager 2-æ—§åŒ…è£…ä¸­çš„æ–°åŠŸèƒ½ ğŸ‰ ğŸ’ ğŸ¤›ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ViewPageræ˜¯Androidæ”¯æŒåº“ä¸­æœ€è‘—åå’Œä½¿ç”¨æœ€å¹¿æ³›çš„ç»„ä»¶ä¹‹ä¸€ã€‚ æ‰€æœ‰æœ€ç®€å•çš„è½®æ’­ï¼Œç™»æœºå’Œæ»‘æ¡éƒ½åˆ¶ä½œåœ¨ä¸Šé¢ã€‚ åœ¨2019å¹´2æœˆï¼ŒAndroidXå¼€å‘å›¢é˜Ÿå‘å¸ƒäº†ViewPager2ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›å…ˆå†³æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œä»¥åŠè¯¥ç»„ä»¶çš„æ›´æ–°ç‰ˆæœ¬å…·æœ‰å“ªäº›ä¼˜åŠ¿ã€‚ 



 ViewPager 2 
 åœ¨æ’°å†™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ViewPager 2-æ—§åŒ…è£…ä¸­çš„æ–°åŠŸèƒ½</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/461873/">  ViewPageræ˜¯Androidæ”¯æŒåº“ä¸­æœ€è‘—åå’Œä½¿ç”¨æœ€å¹¿æ³›çš„ç»„ä»¶ä¹‹ä¸€ã€‚ æ‰€æœ‰æœ€ç®€å•çš„è½®æ’­ï¼Œç™»æœºå’Œæ»‘æ¡éƒ½åˆ¶ä½œåœ¨ä¸Šé¢ã€‚ åœ¨2019å¹´2æœˆï¼ŒAndroidXå¼€å‘å›¢é˜Ÿå‘å¸ƒäº†ViewPager2ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›å…ˆå†³æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œä»¥åŠè¯¥ç»„ä»¶çš„æ›´æ–°ç‰ˆæœ¬å…·æœ‰å“ªäº›ä¼˜åŠ¿ã€‚ <br><br><img src="https://habrastorage.org/webt/eu/aw/ss/euawsscpwdgkcngbjdjqabx1uhc.png"><br><a name="habracut"></a><br><h3>  ViewPager 2 </h3><br> åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ˆ2019å¹´7æœˆï¼‰ï¼Œæä¾›äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ViewPager2</a>çš„betaç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€å¯ä»¥è§£å†³ä»¥ä¸‹æåˆ°çš„é—®é¢˜ï¼Œå¹¶å¯ä»¥æ”¹è¿›å’Œæ‰©å±•åŠŸèƒ½ã€‚ å¼€å‘äººå‘˜æ‰¿è¯ºå°†æ¥ä¼šå¢åŠ å¯¹TabLayoutçš„æ”¯æŒï¼ˆå°½ç®¡å®ƒåªèƒ½ä¸ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸€èµ·ä½¿ç”¨ï¼‰ï¼Œä¼˜åŒ–é€‚é…å™¨çš„æ€§èƒ½ï¼Œè¿›è¡Œè®¸å¤šå°çš„æ›´æ­£å¹¶æœ€ç»ˆç¡®å®šæ–‡æ¡£ã€‚ <br><br><h3> æ•´åˆæ€§ </h3><br> è¯¥ç»„ä»¶ä¸éšæ ‡å‡†åŒ…è£…ä¸€èµ·æä¾›ï¼Œè€Œæ˜¯å•ç‹¬è¿æ¥ã€‚ ä¸ºæ­¤ï¼Œå°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°æ¨¡å—çš„gradleè„šæœ¬ä¸­çš„dependencieså—ä¸­ï¼š <br><br><pre><code class="java hljs">implementation <span class="hljs-string"><span class="hljs-string">"androidx.viewpager2:viewpager2:1.0.0-beta02"</span></span></code> </pre> <br><h3> å®ä½œ </h3><br> è®©æˆ‘ä»¬ä»å¥½æ¶ˆæ¯å¼€å§‹ï¼šä»ç¬¬ä¸€ç‰ˆåˆ°ç¬¬äºŒç‰ˆçš„è¿‡æ¸¡å°½å¯èƒ½åœ°ç®€å•ï¼Œå½’ç»“ä¸ºå¯¼å…¥çš„æ”¹å˜ã€‚ è‰¯å¥½çš„æ—§è¯­æ³•æ²¡æœ‰è¢«è§¦åŠï¼š <i>getCurrentItemï¼ˆï¼‰</i>æ–¹æ³•è¿”å›å½“å‰é¡µé¢ï¼Œ <i>ViewPager2.onPageChangeCallback</i>å…è®¸<i>æ‚¨</i>è®¢é˜…å¯»å‘¼æœº<i>çŠ¶æ€</i> ï¼Œä»ç„¶é€šè¿‡<i>setAdapterï¼ˆï¼‰</i>å®‰è£…é€‚é…å™¨<i>ã€‚</i> <br><br><hr><br> å€¼å¾—æ·±å…¥ç ”ç©¶ï¼Œå› ä¸ºå¾ˆæ˜æ˜¾ç¬¬ä¸€å’Œç¬¬äºŒå¯»å‘¼æœºé™¤æ¥å£å¤–æ²¡æœ‰å…¶ä»–å…±åŒä¹‹å¤„ã€‚ ç†Ÿæ‚‰setAdapterï¼ˆï¼‰æ–¹æ³•çš„å®ç°ä¸å®¹ç½®ç–‘ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Nullable Adapter adapter)</span></span></span><span class="hljs-function"> </span></span>{ mRecyclerView.setAdapter(adapter); }</code> </pre><br> æ˜¯çš„ï¼ŒViewPager2åªæ˜¯<b>RecyclerView</b>çš„åŒ…è£…ã€‚ ä¸€æ–¹é¢ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¥½å¤„ï¼Œå¦ä¸€æ–¹é¢ï¼Œè¿™ä¼šå¢åŠ å¤´ç—›ã€‚ éšç€<b>PagerSnapHelper</b>çš„å‡ºç°ï¼Œå°†<i>RecyclerView</i>ä¼ªè£…æˆä¼ å•æˆä¸ºå¯èƒ½ã€‚ æ­¤ç±»æ›´æ”¹æ»šåŠ¨çš„ç‰©ç†åŸç†ã€‚ å½“ç”¨æˆ·æ¾å¼€æ‰‹æŒ‡æ—¶ï¼Œ <i>PagerSnapHelperä¼šè®¡</i>ç®—å‡ºæœ€é è¿‘åˆ—è¡¨ä¸­å¿ƒçº¿çš„åˆ—è¡¨é¡¹ï¼Œå¹¶é€šè¿‡å¹³æ»‘çš„åŠ¨ç”»å°†å…¶æ°å¥½å¯¹å‡†ä¸­å¿ƒã€‚ å› æ­¤ï¼Œå¦‚æœæ»‘åŠ¨è¶³å¤Ÿå°–é”ï¼Œåˆ™åˆ—è¡¨å°†æ»šåŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™-åŠ¨ç”»å°†è¿”å›å…¶åŸå§‹çŠ¶æ€ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PagerSnapHelper().attachToRecyclerView(mRecyclerView);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/737/962/b7a/737962b7a5620216a2a6d0c71353a2a1.gif" alt="å›¾ç‰‡"><br><blockquote> ä½¿ç”¨PagerSnapHelperæ—¶ï¼Œè¯·ç¡®ä¿RecyclerViewæœ¬èº«åŠå…¶æ‰€æœ‰ViewHoldersçš„å®½åº¦å’Œé«˜åº¦éƒ½è®¾ç½®ä¸ºMATCH_PARENTã€‚ å¦åˆ™ï¼ŒSnapHelperçš„è¡Œä¸ºå°†æ— æ³•é¢„æµ‹ï¼Œé”™è¯¯å¯èƒ½ä¼šåœ¨å®Œå…¨æ„å¤–çš„åœ°æ–¹å‘ç”Ÿã€‚ å°½ç®¡å¯èƒ½ï¼Œæ‰€æœ‰è¿™äº›ä½¿å¾—åˆ¶ä½œé«˜åº¦å°çš„å…ƒä»¶çš„æ—‹è½¬æœ¨é©¬ç›¸å½“è€—æ—¶ã€‚ </blockquote><br> é‰´äºä»¥ä¸Šæ‰€æœ‰å†…å®¹ï¼Œåœ¨å¸ƒå±€ä¸­ï¼Œå°éƒ¨ä»¶å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">androidx.viewpager2.widget.ViewPager2</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/main_pager"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br> åœ¨ä¸<i>ViewPager2</i>ç›¸åŒçš„ç¨‹åºåŒ…ä¸­<i>ï¼Œ</i>æˆ‘ä»¬è¿˜å¯ä»¥æ‰¾åˆ°<b>ScrollEventAdapter</b>ç±»ï¼Œè¯¥ç±»æœ‰åŠ©äºç»´æŠ¤è¯­æ³•çš„è¿ç»­æ€§ã€‚  <i>ScrollEventAdapter</i>å®ç°<b>RecyclerView.OnScrollListener</b>å¹¶å°†æ»šåŠ¨äº‹ä»¶<b>è½¬æ¢ä¸ºOnPageChangeCallback</b>äº‹ä»¶ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onScrollStateChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull RecyclerView recyclerView, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mAdapterState != STATE_IN_PROGRESS_MANUAL_DRAG &amp;&amp; newState == RecyclerView.SCROLL_STATE_DRAGGING) { ... dispatchStateChanged(SCROLL_STATE_DRAGGING); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } ... }</code> </pre><br> ç°åœ¨ï¼Œ <i>OnPageChangeCallback</i>ä¸å†ç”±æ¥å£è¡¨ç¤ºï¼Œè€Œæ˜¯ç”±æŠ½è±¡ç±»è¡¨ç¤ºï¼Œè¯¥æŠ½è±¡ç±»å…è®¸æ‚¨ä»…è¦†ç›–å¿…éœ€çš„æ–¹æ³•ï¼ˆåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä»…éœ€è¦<i>nPageSelectedï¼ˆIntï¼‰</i> ï¼Œå½“é€‰æ‹©ç‰¹å®šé¡µé¢æ—¶æ‰èµ·ä½œç”¨ï¼‰ï¼š <br><br><pre> <code class="java hljs">main_pager.registerOnPageChangeCallback( object : ViewPager2.OnPageChangeCallback() { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPageSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//do your stuff } } )</span></span></code> </pre><br><h3> ç‰¹è‰²åŠŸèƒ½ </h3><br>  <b>å€¼å¾—æ³¨æ„çš„æ˜¯setPageTransformerï¼ˆï¼‰</b>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†<b>ViewPager2.PageTransformer</b>ä½œä¸ºå‚æ•°ã€‚ å®ƒä¸ºæ¯ä¸ªé¡µé¢é€‰æ‹©äº‹ä»¶è®¾ç½®ä¸€ä¸ª<i>å›è°ƒ</i> ï¼Œå¹¶ä¸ºè¯¥é¡µé¢è®¾ç½®è‡ªå·±çš„åŠ¨ç”»ã€‚  <i>å›è°ƒ</i>æ¥æ”¶å½“å‰é¡µé¢çš„<i>è§†å›¾</i>åŠå…¶ç¼–å·ä½œä¸ºè¾“å…¥ã€‚ ä¸è¯¥æ–¹æ³•æœ€æ¥è¿‘çš„ç±»ä¼¼ç‰©æ˜¯<i>RecyclerViewä¸­</i>çš„<i>ItemAnimator</i> ã€‚ <br><br> åœ¨è¯¥åº“çš„æ–°ç‰ˆæœ¬ä¸­ï¼Œæ·»åŠ äº†è½¬æ¢å™¨çš„ä¸¤ä¸ªå®ç°ï¼š <br><br>  <b>CompositePageTransformer</b>å’Œ<b>MarginPageTransformer</b> ã€‚ ç¬¬ä¸€ä¸ªè´Ÿè´£ç»„åˆè½¬æ¢å™¨ï¼Œä»¥ä¾¿ä¸€æ¬¡å°†å¤šä¸ªè½¬æ¢åº”ç”¨äºä¸€ä¸ªå¯»å‘¼æœºï¼Œç¬¬äºŒä¸ªè´Ÿè´£åœ¨é¡µé¢ä¹‹é—´ç¼©è¿›ï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/53d/c0d/49b/53dc0d49b39527079355f55a5c5cf4e0.gif" alt="å›¾ç‰‡"><br><br> æ­¤å¤–ï¼Œæ–°çš„å°éƒ¨ä»¶è¿˜æ”¯æŒæ–¹å‘æ›´æ”¹ï¼šåªéœ€è°ƒç”¨<b>setOrientationï¼ˆï¼‰</b>æ–¹æ³•ï¼Œæ‚¨å°±å¯ä»¥é€šè¿‡ä¸Šä¸‹æ»‘åŠ¨å°†å¯»å‘¼æœºå˜æˆå‚ç›´åˆ—è¡¨ï¼š <br><br><pre> <code class="kotlin hljs">main_pager.setOrientation(ViewPager2.ORIENTATION_VERTICAL)</code> </pre><br> ç”±äºè¿‡æ¸¡åˆ°<i>RecyclerViewï¼Œ</i>å†æ¬¡å‘ç”Ÿäº†è¿™ç§æƒ…å†µï¼šåœ¨å¼•æ“ç›–ä¸‹ï¼Œ <i>ç§°ä¸ºLayoutManagerçš„</i>æ–¹å‘å‘ç”Ÿäº†å˜åŒ–ï¼Œå®ƒè´Ÿè´£æ˜¾ç¤ºåˆ—è¡¨é¡¹ã€‚ åº”å½“æŒ‡å‡ºï¼Œå°†å¤§é‡ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–ç±»å·²ç»ä½¿æ–°ç»„ä»¶å—ç›Šï¼šæ–°ç»„ä»¶çš„æ¸…å•å˜å¾—æ›´åŠ ç´§å‡‘å’Œæ˜“è¯»ã€‚ <br><br> è¿™ä¸æ˜¯ä¹è¶£çš„å°½å¤´ã€‚ åœ¨ä¸€ä¸ªæ›´æ–°ä¸­ï¼Œ <i>ViewPager2</i>è·å¾—äº†å¯¹<i>ItemDecorationçš„</i>æ”¯æŒï¼šä¸€ä¸ªç”¨äºè£…é¥°å­çº§<i>View</i>çš„<i>è¾…åŠ©</i>ç±»ã€‚ æ­¤æœºåˆ¶å¯ç”¨äºåœ¨å…ƒç´ ï¼Œè¾¹æ¡†ï¼Œå•å…ƒæ ¼çªå‡ºæ˜¾ç¤ºä¹‹é—´ç»˜åˆ¶åˆ†éš”ç¬¦ã€‚ <br><br> è£…é¥°å™¨å·²ç»æœ‰å¾ˆå¤šç°æˆçš„å®ç°ï¼Œå› ä¸ºå¤šå¹´æ¥ï¼Œå®ƒä»¬åœ¨ä¸å¸¸è§„<i>RecyclerView</i>ä¸€èµ·å·¥ä½œæ—¶å·²è¢«æˆåŠŸä½¿ç”¨ã€‚ ç°åœ¨æ‰€æœ‰çš„å‘å±•éƒ½é€‚ç”¨äºå¯»å‘¼æœºã€‚ å¼€ç®±å³ç”¨çš„å¯»å‘¼æœºåˆ†éš”ç¬¦çš„æ ‡å‡†å®ç°æ˜¯å¯ç”¨çš„ï¼š <br><br><pre> <code class="kotlin hljs">main_pager.addItemDecoration( DividerItemDecoration(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, RecyclerView.HORIZONTAL) )</code> </pre><br> éšç€2019å¹´5æœˆçš„ä¸‹ä¸€æ¬¡æ›´æ–°ï¼Œ <i>ViewPager2</i>æ·»åŠ äº†å¦ä¸€ä¸ªé‡è¦æ–¹æ³•ï¼š <b>setOffscreenPageLimitï¼ˆIntï¼‰</b> ã€‚ ä»–è´Ÿè´£åœ¨å¯»å‘¼æœºä¸­åˆå§‹åŒ–ä¸­å¿ƒå·¦ä¾§å’Œå³ä¾§çš„å¤šå°‘ä¸ªå…ƒç´ ã€‚ å°½ç®¡<i>RecyclerView</i>é»˜è®¤è´Ÿè´£ç¼“å­˜å’Œæ˜¾ç¤º<i>View</i> ï¼Œä½†æ˜¯ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æ˜¾å¼è®¾ç½®è¦åŠ è½½çš„æ‰€éœ€é¡¹ç›®æ•°ã€‚ <br><br><h3> è½¬æ¥å¤´ </h3><br> ç¬¬ä¸€ä¸ªå¯»å‘¼æœºé€‚é…å™¨çš„æ€æƒ³ä¸Šçš„ç»§æ‰¿è€…æ˜¯<i>FragmentStateAdapter</i> ï¼šäº¤äº’æ¥å£å’Œç±»å‘½åå‡ ä¹ç›¸åŒã€‚ æ‰€åšçš„æ›´æ”¹ä»…å½±å“æŸäº›æ–¹æ³•çš„å‘½åã€‚ å¦‚æœè¾ƒæ—©æ—¶æœ‰å¿…è¦å®ç°æŠ½è±¡å‡½æ•°<i>getItemï¼ˆpositionï¼‰</i>ä»¥è¿”å›ç»™å®šä½ç½®æ‰€éœ€çš„<i>Fragment</i>å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼è§£é‡Šè¿™ç§å‘½åï¼Œç°åœ¨æ­¤å‡½æ•°å·²é‡å‘½åä¸º<i>createFragmentï¼ˆpositionï¼‰</i> ã€‚ ç‰‡æ®µçš„æ€»æ•°ç”±<i>getCountï¼ˆï¼‰</i>å‡½æ•°åƒä»¥å‰ä¸€æ ·æä¾›ã€‚ <br><br> åœ¨æ¥å£çš„é‡è¦ç»“æ„æ›´æ”¹ä¸­ï¼Œè¿˜åº”æ³¨æ„ï¼Œé€‚é…å™¨ç°åœ¨å…·æœ‰æ§åˆ¶å…¶å…ƒç´ ç”Ÿå‘½å‘¨æœŸçš„èƒ½åŠ›ï¼Œå› æ­¤ï¼Œå®ƒä¸æ„é€ å‡½æ•°ä¸­çš„<i>FragmentManager</i>ä¸€èµ·ï¼Œæ¥å—<i>Lifecycleå¯¹è±¡</i> ï¼ˆ <i>Activity</i>æˆ–<i>Fragmentï¼‰</i> ã€‚ å› æ­¤ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œå°†<i>saveStateï¼ˆï¼‰</i>å’Œ<i>restoreStateï¼ˆï¼‰</i>æ–¹æ³•å£°æ˜ä¸ºfinalå¹¶å…³é—­ä»¥è¿›è¡Œç»§æ‰¿ã€‚ <br>  <b>FragmentViewHolder</b>ç±»è´Ÿè´£å°†ç‰‡æ®µå­˜å‚¨åœ¨<i>RecyclerView</i>å†…éƒ¨ã€‚  <b>FragmentStateAdapter</b>çš„<b>onCreateViewHolderï¼ˆï¼‰</b>æ–¹æ³•è°ƒç”¨<b>FragmentViewHolder.createï¼ˆï¼‰</b> ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> FragmentViewHolder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ViewGroup parent)</span></span></span><span class="hljs-function"> </span></span>{ FrameLayout container = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FrameLayout(parent.getContext()); container.setLayoutParams( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ViewGroup.LayoutParams( ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT ) ); container.setId(ViewCompat.generateViewId()); container.setSaveEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FragmentViewHolder(container); }</code> </pre><br>  <b>è°ƒç”¨onBindViewHolderï¼ˆï¼‰</b>æ–¹æ³•æ—¶ï¼Œ <b>ä¼šå°†</b>å½“å‰ä½ç½®çš„å…ƒç´ çš„æ ‡è¯†ç¬¦ä¸<i>ViewHolder</i>æ ‡è¯†ç¬¦<i>ç›¸å…³è”</i> ï¼Œä»¥è¿›ä¸€æ­¥å°†ç‰‡æ®µé™„åŠ åˆ°è¯¥ç‰‡æ®µï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> itemId = holder.getItemId(); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> viewHolderId = holder.getContainer().getId(); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Long boundItemId = itemForViewHolder(viewHolderId); ... mItemIdToViewHolder.put(itemId, viewHolderId); ensureFragment(position); <span class="hljs-comment"><span class="hljs-comment">//  </span></span></code> </pre><br> æœ€åï¼Œå°†å®¹å™¨ä»<i>ViewHolderé™„åŠ </i>åˆ°<i>View</i>å±‚æ¬¡ç»“æ„æ—¶ï¼Œå°†æ‰§è¡Œ<i>FragmentTransaction</i> ï¼Œå°†<i>Fragment</i>æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">placeFragmentInViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> FragmentViewHolder holder)</span></span></span><span class="hljs-function"> </span></span>{ Fragment fragment = mFragments.get(holder.getItemId()); ... scheduleViewAttach(fragment, container); mFragmentManager.beginTransaction() .add(fragment, <span class="hljs-string"><span class="hljs-string">"f"</span></span> + holder.getItemId()) .setMaxLifecycle(fragment, STARTED) .commitNow(); ... }</code> </pre><br> å› æ­¤ï¼Œ <i>å‡ºç°</i>äº†<i>ViewPager2çš„</i>ä¸¤ç§ç”¨æ³•ï¼šé€šè¿‡ç›´æ¥ä»<i>RecyclerView.Adapter</i>æˆ–<i>FragmentStateAdapter</i>ç»§æ‰¿é€‚é…å™¨ç±»ã€‚ <br><br><hr><br> å½“ç„¶ï¼Œæ‚¨ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆåœ¨å­˜åœ¨æ­£å¸¸è¿è¡Œçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„æƒ…å†µä¸‹ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¸¦æœ‰åˆ†ç‰‡çš„ç¬¬äºŒä¸ªå¯»å‘¼æœºå’Œä¸€ä¸ªé€‚é…å™¨ï¼Ÿ ä½¿ç”¨å¤§å‹åŠ¨æ€æ•°æ®åˆ—è¡¨æ—¶ï¼Œ <i>ViewPager</i>è¿œéâ€œçµä¸¹å¦™è¯â€ã€‚ å®ƒéå¸¸é€‚åˆåˆ›å»ºå¸¦æœ‰ä¸€ç»„é™æ€å›¾ç‰‡æˆ–æ¨ªå¹…çš„è½®æ’­ï¼Œä½†æ˜¯åˆ†é¡µçš„æ–°é—»æè¦å’Œå¤§é‡çš„å¹¿å‘Šå‘å¸ƒï¼Œè¿‡æ»¤ä¼šäº§ç”Ÿåšç¡¬è€Œä¸‘é™‹çš„æ€ªç‰©ã€‚ è¿Ÿæ—©ï¼Œæ‚¨è‚¯å®šä¼šé‡åˆ°ä¸€ç§å¼ºçƒˆçš„æ„¿æœ›ï¼Œé‚£å°±æ˜¯è¦é‡å†™<i>RecyclerViewä¸Šçš„</i>æ‰€æœ‰å†…å®¹ã€‚ ç°åœ¨ï¼Œæ‚¨ä¸å¿…è¿™æ ·åšï¼Œå› ä¸ºä¼ å‘¼æœºæœ¬èº«å°±å˜æˆäº†å®ƒï¼Œå®ƒå€Ÿç”¨äº†å…¶å¼ºå¤§çš„åŠŸèƒ½æ¥å¤„ç†åŠ¨æ€åˆ—è¡¨ï¼ŒåŒæ—¶å°†å®ƒä»¬åŒ…è£…åœ¨å¸¸è§„è¯­æ³•ä¸­ã€‚ <br><br>  <i>PagerAdapter</i>å”¯ä¸€å¯ä»¥æä¾›ç»™<i>æˆ‘ä»¬çš„</i>æ˜¯<b>notifyDataSetChangedï¼ˆï¼‰</b>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¼ºåˆ¶<i>ViewPager</i>é‡æ–°ç»˜åˆ¶æ‰€æœ‰å‘ˆç°çš„åˆ—è¡¨é¡¹ã€‚ æ‚¨å¯èƒ½ä¼šåˆç†åœ°æ³¨æ„åˆ°ï¼Œæ²¡æœ‰äººé˜»æ­¢æˆ‘ä»¬å­˜å‚¨ç°æœ‰å…ƒç´ çš„ä½ç½®åˆ—è¡¨ï¼Œå¹¶ä»<i>getItemPositionï¼ˆï¼‰</i>æ–¹æ³•è¿”å›<i>POSITION_UNCHANGED</i> ï¼Œä»…æ­¤è€Œå·²ã€‚ ä½†æ˜¯ï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆä¸èƒ½ç§°å…¶ä¸ºç¾è§‚ï¼Œè€Œä¸”ç›¸å½“éº»çƒ¦ï¼Œè€Œä¸”ï¼Œå¾ˆéš¾æ‰©å±•åˆ—è¡¨ä¸­å…ƒç´ ä¸æ–­å˜åŒ–çš„æƒ…å†µï¼Œè€Œä¸ä»…ä»…æ˜¯é¡ºåºæ·»åŠ åˆ°æœ€åã€‚  <i>FragmentStateAdapter</i>å…·æœ‰å®Œæ•´çš„<i>RecyclerView.Adapter</i>æ–¹æ³•åº“ï¼Œå› æ­¤å¯ä»¥æ›´çµæ´»åœ°é…ç½®é‡ç»˜å…ƒç´ çš„é€»è¾‘ã€‚ æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ä¸<i>FragmentStateAdapter</i>ä¸€èµ·ä½¿ç”¨<i>DiffUtil</i> ï¼Œå®ƒä½¿æ‚¨å‡ ä¹å®Œå…¨è‡ªåŠ¨åŒ–äº†æ›´æ”¹é€šçŸ¥çš„å·¥ä½œã€‚ <br><br><img src="https://habrastorage.org/webt/8s/j9/xg/8sj9xgon6lnfcn1thlzbhox2jtw.png"><br><blockquote>  <b>æ³¨æ„ï¼</b> ä¸ºäº†ä½¿<i>notify</i> ...æ–¹æ³•æ­£å¸¸å·¥ä½œï¼ˆ <i>notifyDataSetChanged</i>é™¤å¤–ï¼‰ï¼Œåº”è¯¥é‡æ–°å®šä¹‰<b>getItemIdï¼ˆIntï¼‰</b>å’Œ<b>ctaintainsItemï¼ˆLongï¼‰</b>æ–¹æ³•ã€‚ è¿™æ ·åšæ˜¯å› ä¸ºé»˜è®¤å®ç°ä»…æŸ¥çœ‹é¡µç ï¼Œä¾‹å¦‚ï¼Œå¦‚æœåœ¨å½“å‰å…ƒç´ ä¹‹åæ·»åŠ æ–°å…ƒç´ ï¼Œåˆ™ä¸ä¼šæ·»åŠ è¯¥å…ƒç´ ï¼Œå› ä¸º<i>getItemId</i>å°†ä¿æŒä¸å˜ã€‚ åŸºäº<i>Int</i>ç±»å‹çš„å…ƒç´ åˆ—è¡¨è¦†ç›–è¿™ä¸¤ç§æ–¹æ³•çš„ç¤ºä¾‹ï¼š </blockquote><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Long</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items[position].toLong() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">containsItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(itemId: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Long</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.contains(itemId.toInt()) }</code> </pre><br><hr><br>  <i>ViewPager2</i>å‡ºç°çš„<i>ä¸»è¦åŸå› </i>æ˜¯ä¸æ„¿é‡æ–°å‘æ˜è½®å­ã€‚ ä¸€æ–¹é¢ï¼Œ <b>AndroidX</b>å¼€å‘<b>å›¢é˜Ÿ</b>æ˜¾ç„¶å·²ç»å‡†å¤‡å¥½æ”¾å¼ƒè¿‡æ—¶çš„<i>ViewPager</i> ï¼Œå¹¶ä¸”è‚¯å®šä¸ä¼šæŠ•èµ„äºæ‰©å±•å…¶åŠŸèƒ½ã€‚ æ˜¯çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ æ¯•ç«Ÿï¼Œ <i>RecyclerView</i>å·²ç»çŸ¥é“æ‰€éœ€çš„ä¸€åˆ‡ã€‚ å¦ä¸€æ–¹é¢ï¼Œå–æ¶ˆå’Œç»ˆæ­¢å¯¹å¦‚æ­¤å¹¿æ³›ä½¿ç”¨çš„ç»„ä»¶çš„æ”¯æŒæ˜¾ç„¶ä¸ä¼šå¢åŠ ç¤¾åŒºçš„å¿ è¯šåº¦ã€‚ <br><br> æ€»ç»“ä¸€ä¸‹ï¼š <i>ViewPager2</i>ç»å¯¹å€¼å¾—å…³æ³¨ï¼Œå°½ç®¡ç›®å‰å¹¶éæ²¡æœ‰ä¸¥é‡çš„ç¼ºé™·ã€‚ <br><br><h3> ç¼ºç‚¹ </h3><br><ul><li> æ½®æ¹¿å’Œå¤§é‡é”™è¯¯ï¼ˆå¯¹äºBetaç‰ˆæœ¬å¯åŸè°…ï¼‰ï¼› </li><li> äº²å¯†ã€‚  <i>RecyclerView</i>æ˜¯<i>ViewPager2</i>çš„<i>ç§æœ‰</i>å­—æ®µï¼Œå®ƒå‰¥å¤ºäº†æˆ‘ä»¬å¾ˆå¤šæœºä¼šï¼šæ— æ³•å®ç°<i>æ»‘åŠ¨</i> <b>æ“¦é™¤</b>æˆ–<i>æ‹–æ”¾</i> ï¼ˆ <b>ItemTouchHelper</b>ç›´æ¥è¿æ¥åˆ°<i>RecyclerView</i> ï¼‰ï¼Œæ‚¨ä¸èƒ½ä»¥ä»»ä½•æ–¹å¼é‡æ–°å®šä¹‰<b>ItemAnimator</b> ï¼Œä¸è¦ç›´æ¥è®¿é—®<b>LayoutManager</b>å¹¶ä½¿ç”¨<b>RecycledViewPool</b> ã€‚ ä½†æ˜¯ï¼Œéšç€è¯¥ç»„ä»¶æ–°ç‰ˆæœ¬çš„å‘å¸ƒï¼Œä»<i>RecyclerView</i>ç»§æ‰¿çš„æ¥å£æ–¹æ³•çš„æ•°é‡æ­£åœ¨å¢åŠ ï¼ˆä¾‹å¦‚<i>ItemDecoration</i> ï¼‰ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ¥å¯ä»¥æ·»åŠ ç¼ºå°‘çš„æ–¹æ³•ã€‚ </li></ul><br><h3> ä¼˜ç‚¹ </h3><br><ul><li> æ”¯æŒ<i>RecyclerView.Adapterçš„</i>æ‰€æœ‰ä¼˜ç‚¹ï¼šå°†ä¸åŒç±»å‹çš„å…ƒç´ åˆå¹¶åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œåœ¨æ»‘åŠ¨æ—¶ç›´æ¥æ·»åŠ å’Œåˆ é™¤å…ƒç´ ï¼Œæ›´æ”¹æ—¶ä»¥åŠ¨ç”»æ–¹å¼é‡ç»˜åˆ—è¡¨çš„å†…å®¹ï¼› </li><li> æ”¯æŒå„ç§<i>é€šçŸ¥</i>æ–¹æ³•å’Œä½¿ç”¨<i>DiffUtil</i>è‡ªåŠ¨è®¡ç®—å˜åŒ–; </li><li> ç”±äºè¯­æ³•çš„è¿ç»­æ€§ï¼Œæ˜“äºè¿‡æ¸¡ï¼› </li><li> æ”¯æŒâ€œå¼€ç®±å³ç”¨â€çš„å‚ç›´å’Œæ°´å¹³æ–¹å‘ï¼› </li><li>  <i>RTL</i>æ”¯æŒï¼› </li><li> æ”¯æŒ<i>ItemDecorator</i> ; </li><li> æ”¯æŒé€šè¿‡<i>fakeScrollByï¼ˆï¼‰æ»šåŠ¨</i>è½¯ä»¶ï¼› </li><li> èƒ½å¤Ÿæ‰‹åŠ¨è®¾ç½®å·²åŠ è½½é¡¹ç›®çš„æ•°é‡ï¼› </li><li> ä½¿ç”¨ä»»ä½•ç°æˆçš„å¼€æºè§£å†³æ–¹æ¡ˆæ¥å‡å°‘<i>æ ·æ¿ä»£ç çš„èƒ½åŠ›</i> ï¼Œè¿™æ˜¯ç¼–å†™è‡ªå®šä¹‰<i>RecyclerView.Adapter</i>æ—¶ä¸å¯é¿å…çš„ã€‚ ä¾‹å¦‚ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>EasyAdapter</i></a> ã€‚ </li></ul><br> æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘æƒ³è¯´<b>ViewPager2</b>ç¡®å®å€¼å¾—<b>ä»”ç»†</b>ç ”ç©¶ã€‚ è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰å‰é€”çš„ï¼Œå¯æ‰©å±•çš„ï¼ŒåŠŸèƒ½æ€§çš„è§£å†³æ–¹æ¡ˆã€‚ è€Œä¸”ï¼Œå°½ç®¡åœ¨ç”Ÿäº§ä¸­å¯åŠ¨<i>æ–°çš„å°éƒ¨ä»¶</i>è¿˜ä¸ºæ—¶è¿‡æ—©ï¼Œä½†æ˜¯å¯ä»¥è‚¯å®šåœ°è¯´ï¼Œåœ¨å®Œå…¨å‘å¸ƒä¹‹åï¼Œå®ƒå¯ä»¥å¹¶ä¸”åº”è¯¥å®Œå…¨å–ä»£å…¶ç¥–å…ˆã€‚ <br><br> å¯¹äºé‚£äº›å¤§èƒ†è€Œæœæ–­çš„äººï¼ˆæœ¬æ–‡å¯å‘ä»–ä»¬è¿›è¡Œå®éªŒï¼‰ï¼Œ <i>PagerSnapHelper</i>å‡ºç°åœ¨ç¬¬28ç‰ˆ<b>æ”¯æŒåº“ä¸­</b> ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥é€šè¿‡<i>è‡ªå·±</i>åˆ›å»º<i>ViewPager2</i>ä¸<i>RecyclerView</i>ä¸€èµ·ä½¿ç”¨ã€‚ <br><br>  <i>ViewPager2</i>å’Œ<i>FragmentStateAdapter</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„ç¤ºä¾‹</a>æ“ä½œã€‚ <br><br> å®˜æ–¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‘è¡Œè¯´æ˜</a> ViewPager2 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN461873/">https://habr.com/ru/post/zh-CN461873/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461859/index.html">ä½ å¯¹é£Ÿå“æŠ€æœ¯ä¸€æ— æ‰€çŸ¥</a></li>
<li><a href="../zh-CN461861/index.html">Office 365äº‘å®‰å…¨æ€§ï¼šCheck Point CloudGuard SaaSæµ‹è¯•</a></li>
<li><a href="../zh-CN461865/index.html">è§†é¢‘è¯¾ç¨‹â€œä½¿ç”¨IDA PROä»é›¶å¼€å§‹ä»‹ç»ã€‚ ç¬¬ä¸€ç« </a></li>
<li><a href="../zh-CN461867/index.html">å¦‚ä½•ä½¿ç”¨ML Kitè¯†åˆ«æ‰‹æœºä¸Šçš„å›¾ç‰‡å’Œæ–‡å­—</a></li>
<li><a href="../zh-CN461871/index.html">æˆä¸ºä¼˜ç§€ç¨‹åºå‘˜ï¼ˆå’Œäººç±»ï¼‰çš„101æ¡æŠ€å·§</a></li>
<li><a href="../zh-CN461875/index.html">5çº³ç±³å’Œ3çº³ç±³</a></li>
<li><a href="../zh-CN461877/index.html">Java vs Kotlin for Androidï¼šå¼€å‘äººå‘˜æ„è§</a></li>
<li><a href="../zh-CN461879/index.html">ã€Š Linuxåœ¨è¡ŒåŠ¨ã€‹ä¸€ä¹¦</a></li>
<li><a href="../zh-CN461881/index.html">Node.jsè®°å½•æŒ‡å—</a></li>
<li><a href="../zh-CN461885/index.html">EDSæ˜¯å¦ä¸€ç§æ¬ºè¯ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>