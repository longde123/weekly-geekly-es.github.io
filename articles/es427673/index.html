<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóúÔ∏è üî¨ üåΩ Machine learning @ booking.com üë©üèø‚Äçüöí üëáüèº ‚õ≤Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El aprendizaje autom√°tico le permite hacer que el servicio sea mucho m√°s conveniente para los usuarios. No es tan dif√≠cil comenzar a implementar recom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Machine learning @ booking.com</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/427673/"> El aprendizaje autom√°tico le permite hacer que el servicio sea mucho m√°s conveniente para los usuarios.  No es tan dif√≠cil comenzar a implementar recomendaciones, los primeros resultados se pueden obtener incluso sin tener una infraestructura establecida, lo principal es comenzar.  Y solo entonces para construir un sistema a gran escala.  As√≠ comenz√≥ todo en Booking.com.  Y lo que result√≥, qu√© enfoques se est√°n utilizando ahora, c√≥mo se est√°n introduciendo los modelos en producci√≥n, cu√°les monitorear, dijo Viktor Bilyk a HighLoad ++ Siberia.  Los posibles errores y problemas no se dejaron atr√°s en el informe, ayudar√° a alguien a sortear las aguas poco profundas y a alguien se le ocurrir√°n nuevas ideas. <br><br><img src="https://habrastorage.org/webt/xi/se/oi/xiseoiionccibwqnt5plovk4qza.jpeg"><br><br>  <strong>Acerca del orador:</strong> Victor Bilyk introduce productos de aprendizaje autom√°tico en operaciones comerciales en Booking.com. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8IskcexLLpI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Primero, veamos d√≥nde utiliza Booking.com el aprendizaje autom√°tico en qu√© productos. <br><img src="https://habrastorage.org/webt/ka/6t/3y/ka6t3y4chljglcr3ijjzszcxhgm.jpeg"><br><br>  En primer lugar, este es un gran n√∫mero de sistemas de recomendaci√≥n para hoteles, destinos, fechas y en diferentes puntos del embudo de ventas y en diferentes contextos.  Por ejemplo, estamos tratando de adivinar a d√≥nde ir√° cuando no haya ingresado nada en la l√≠nea de b√∫squeda. <br><br><img src="https://habrastorage.org/webt/lo/em/bh/loembheuhe8qp-vhv_jntors2je.jpeg"><br><br>  Esta es una captura de pantalla en mi cuenta, y definitivamente visitar√© dos de estas √°reas este a√±o. <br><br><img src="https://habrastorage.org/webt/ab/zc/go/abzcgoqypaywtxwzygsoxo4njrc.jpeg"><br><br>  Procesamos casi cualquier mensaje de texto de los clientes, desde filtros de spam banales hasta productos sofisticados como Assistant y ChatToBook, que utilizan modelos para determinar intenciones y reconocer entidades.  Adem√°s, hay modelos que no son tan notables, por ejemplo, la detecci√≥n de fraude. <br><br>  Analizamos opiniones.  Las modelos nos dicen por qu√© la gente va, por ejemplo, a Berl√≠n. <br><img src="https://habrastorage.org/webt/xn/sv/9e/xnsv9escc-iqeayrkec7ekop_n4.jpeg"><br><br>  Con la ayuda de modelos de aprendizaje autom√°tico, se analiza por qu√© se elogia al hotel para que no tenga que leer miles de comentarios usted mismo. <br><img src="https://habrastorage.org/webt/u6/qi/4y/u6qi4yc7gz7vgiqk0ekkxa72a_i.jpeg"><br><br>  En algunos lugares de nuestra interfaz, casi todas las piezas est√°n vinculadas a las predicciones de algunos modelos.  Por ejemplo, aqu√≠ estamos tratando de predecir cu√°ndo se agotar√° el hotel. <br><img src="https://habrastorage.org/webt/7f/yy/kv/7fyykvfv6k6h7unwgh2unlvgzdq.jpeg"><br><br>  A menudo nos encontramos en lo cierto: despu√©s de 19 horas, la √∫ltima habitaci√≥n ya est√° reservada. <br><img src="https://habrastorage.org/webt/41/wy/bp/41wybpl2pkhjpcidi6yv-geyvpy.jpeg"><br><br>  O, por ejemplo, - la insignia "Oferta favorable".  Aqu√≠ estamos tratando de formalizar lo subjetivo: qu√© es una oferta tan ventajosa.  ¬øC√≥mo entender que los precios establecidos por el hotel para estas fechas son buenos?  Despu√©s de todo, esto, adem√°s del precio, depende de muchos factores, como servicios adicionales y, a menudo, incluso de razones externas, si, por ejemplo, la Copa del Mundo o una gran conferencia t√©cnica se celebra en esta ciudad ahora. <br><br><h2>  Inicio de implementaci√≥n <br></h2><br>  Rebobinemos hace unos a√±os, en 2015.  Algunos de los productos de los que habl√© ya existen.  Adem√°s, el sistema del que hablar√© hoy todav√≠a no lo es.  ¬øC√≥mo se llev√≥ a cabo la implementaci√≥n en ese momento?  Las cosas fueron, francamente, no muy.  El hecho es que tuvimos un gran problema, parte del cual es t√©cnico y parte es organizacional. <br><img src="https://habrastorage.org/webt/05/om/8s/05om8smme1rfenwrzl_ue7rwwh4.jpeg"><br><br>  Enviamos cient√≠ficos de datos a equipos interfuncionales existentes que trabajan en un problema espec√≠fico del usuario y esperamos que mejoren el producto de alguna manera. <br><br>  Muy a menudo, estas piezas del producto se construyeron en la pila de Perl.  Hay un problema obvio con Perl: no est√° dise√±ado para la inform√°tica intensiva, y nuestro backend ya est√° cargado de otras cosas.  Adem√°s, el desarrollo de sistemas serios que resolver√≠an este problema no podr√≠a priorizarse dentro del equipo, porque el enfoque del equipo est√° en resolver un problema del usuario, y no en resolver un problema del usuario mediante el aprendizaje autom√°tico.  Por lo tanto, el propietario del producto (PO) se opondr√≠a mucho a esto. <br><br>  Veamos c√≥mo sucedi√≥ entonces. <br><br>  Solo hab√≠a dos opciones: lo s√© con certeza, porque en ese momento solo estaba trabajando en un equipo as√≠ y ayud√© a los Cient√≠ficos de Datos a llevar sus primeros modelos a la batalla. <br><br>  La primera opci√≥n era la <strong>materializaci√≥n de las predicciones</strong> .  Supongamos que hay un modelo muy simple con solo dos caracter√≠sticas: <br><br><ol><li>  pa√≠s donde se encuentra el visitante; </li><li>  La ciudad en la que busca un hotel. </li></ol><br>  Necesitamos predecir la probabilidad de alg√∫n evento.  Simplemente explotamos todos los vectores de entrada: por ejemplo, 100,000 ciudades, 200 pa√≠ses, un total de 20 millones de l√≠neas en MySQL.  Parece una opci√≥n totalmente funcional para la producci√≥n de algunos sistemas de clasificaci√≥n peque√±os u otros modelos simples. <br><img src="https://habrastorage.org/webt/vh/jq/y0/vhjqy0gxsyydgrnirucbg4kpiva.jpeg"><br><br>  Otra opci√≥n es <strong>incrustar las predicciones directamente en el c√≥digo de fondo</strong> .  Existen grandes limitaciones (cientos, quiz√°s miles de coeficientes), eso es todo lo que podemos permitirnos. <br><img src="https://habrastorage.org/webt/oa/sm/qn/oasmqn17bfvbsfjxla2qcidhgds.jpeg"><br><br>  Obviamente, ni una ni la otra manera le permite sacar al menos alg√∫n tipo de modelo complejo en producci√≥n.  Esto limit√≥ el centro de datos y los √©xitos que pudieron lograr al mejorar los productos.  Obviamente, este problema tuvo que resolverse de alguna manera. <br><br><h3>  Servicio de predicci√≥n <br></h3><br>  Lo primero que hicimos fue un servicio de predicci√≥n.  Probablemente, la arquitectura m√°s simple que se haya mostrado en Habr√© y HighLoad ++ es m√°s baja. <br><img src="https://habrastorage.org/webt/my/xw/jx/myxwjxsaotaglrxaq7obr2klmtc.jpeg"><br><br>  Escribimos una peque√±a aplicaci√≥n en Scala + Akka + Spray que simplemente tom√≥ los vectores entrantes y devolvi√≥ la predicci√≥n.  De hecho, estoy un poco astuto: el sistema era un poco m√°s complicado, porque de alguna manera necesit√°bamos monitorearlo y desplegarlo.  En realidad, todo se ve√≠a as√≠: <br><img src="https://habrastorage.org/webt/jc/mi/o9/jcmio9itnh23j0xsjwm0--_mmkc.jpeg"><br><br>  Booking.com tiene un sistema de eventos, algo as√≠ como una revista para todos los sistemas.  Es muy f√°cil escribir all√≠, y esta secuencia es muy f√°cil de redirigir.  Al principio, necesit√°bamos enviar telemetr√≠a de clientes a Graphite y Grafana con latencias percibidas e informaci√≥n detallada del lado del servidor. <br><img src="https://habrastorage.org/webt/r1/9x/kf/r19xkf9zdmzalcslvhxamaxj9qk.jpeg"><br><br>  Creamos bibliotecas de clientes simples para Perl: ocultamos el RPC completo en una llamada local, pusimos varios modelos all√≠ y el servicio comenz√≥ a despegar.  Vender dicho producto fue bastante simple, porque tuvimos la oportunidad <strong>de presentar modelos m√°s complejos y pasar mucho menos tiempo</strong> . <br><img src="https://habrastorage.org/webt/g9/b-/xd/g9b-xdm7jzfyeysocelckin2rdc.jpeg"><br><br>  Los cient√≠ficos de datos comenzaron a trabajar con muchas menos restricciones, y en algunos casos el trabajo de los back -ders se redujo a una sola l√≠nea. <br><br><h3>  Predicciones de producto <br></h3><br>  Pero volvamos brevemente a c√≥mo usamos estas predicciones en el producto. <br><br>  Hay un modelo que hace predicciones basadas en hechos conocidos.  Seg√∫n esta predicci√≥n, de alguna manera estamos cambiando la interfaz de usuario.  Este, por supuesto, no es el √∫nico escenario para el uso del aprendizaje autom√°tico en nuestra empresa, sino que es bastante com√∫n. <br><br>  <strong>¬øCu√°l es el problema de lanzar tales funciones?</strong>  La cuesti√≥n es que estas son dos cosas en una botella: un modelo y un cambio en la interfaz de usuario.  Es muy dif√≠cil separar los efectos de ambos. <br><br>  Imagine que lanza la insignia de "Oferta favorable" como parte de un experimento AB.  Si no despega (no hay un cambio estad√≠sticamente significativo en las m√©tricas objetivo), no se sabe cu√°l es el problema: una insignia incomprensible, peque√±a, discreta o un mal modelo. <br><br>  Adem√°s, los modelos pueden degradarse, y puede haber muchas razones para esto.  Lo que funcion√≥ ayer no necesariamente funciona hoy.  Adem√°s, estamos constantemente en modo de arranque en fr√≠o, conectando constantemente nuevas ciudades y hoteles, personas de nuevas ciudades vienen a nosotros.  Necesitamos entender de alguna manera que el modelo a√∫n se generaliza bien en estas partes del espacio entrante. <br><img src="https://habrastorage.org/webt/np/rc/91/nprc91mvpwisjodjjq2ri2eueps.jpeg"><br><br>  El caso m√°s probable de degradaci√≥n del modelo m√°s recientemente conocido fue la historia con Alex.  Lo m√°s probable es que, como resultado del reentrenamiento, ella comenz√≥ a comprender ruidos aleatorios, como una solicitud para re√≠rse, y comenz√≥ a re√≠rse por la noche, asustando a los propietarios. <br><br><h3>  Monitoreo de predicciones <br></h3><br>  Para monitorear las predicciones, modificamos ligeramente nuestro sistema (diagrama a continuaci√≥n).  Del mismo modo, desde el sistema de eventos, redirigimos la transmisi√≥n a Hadoop y comenzamos a guardar, adem√°s de todo lo que guardamos antes, todos los vectores de entrada y todas las predicciones hechas por nuestro sistema.  Luego, usando Oozie, los agregamos en MySQL y desde all√≠ los mostramos con una peque√±a aplicaci√≥n web a aquellos que est√©n interesados ‚Äã‚Äãen alg√∫n tipo de caracter√≠sticas cualitativas de los modelos. <br><img src="https://habrastorage.org/webt/nw/jj/3i/nwjj3iu-btqmjbx1ajvbsgik2hg.jpeg"><br><br>  Sin embargo, es importante averiguar qu√© mostrar all√≠.  El caso es que en nuestro caso es muy dif√≠cil calcular las m√©tricas habituales utilizadas en el entrenamiento de modelos, porque a menudo tenemos un gran retraso en las etiquetas. <br><br>  Considera esto como un ejemplo.  Queremos predecir si el usuario se va de vacaciones solo o con su familia.  Necesitamos esta predicci√≥n cuando una persona elige un hotel, pero solo podemos descubrir la verdad en un a√±o.  Despu√©s de irse de vacaciones, el usuario recibir√° una invitaci√≥n para dejar una rese√±a, donde, entre otras cosas, habr√° una pregunta si estuvo all√≠ solo o con su familia. <br><br>  Es decir, debe almacenar en alg√∫n lugar todas las predicciones hechas durante el a√±o, e incluso para poder encontrar coincidencias r√°pidamente con las etiquetas entrantes.  Parec√≠a una inversi√≥n muy seria, tal vez incluso una gran inversi√≥n.  Por lo tanto, hasta que resolvamos este problema, decidimos hacer algo m√°s simple. <br><br>  Este "m√°s simple" result√≥ ser solo un <strong>histograma de predicciones</strong> hechas por el modelo. <br><img src="https://habrastorage.org/webt/k4/gu/gm/k4gugmskee9ve0ewmw2qldlcopg.jpeg"><br><br>  Arriba en el gr√°fico hay una regresi√≥n log√≠stica que predice si el usuario cambiar√° la fecha de su viaje o no.  Se puede ver que divide a los usuarios en dos clases: a la izquierda, la colina es la que no har√° esto;  la colina a la derecha son quienes lo hacen. <br><img src="https://habrastorage.org/webt/fy/ac/dk/fyacdkdo2pmlpmbmnmelkm3zx8w.jpeg"><br><br>  De hecho, incluso mostramos dos gr√°ficos: uno para el per√≠odo actual y el otro para el anterior.  Se ve claramente que esta semana (este es un gr√°fico semanal) el modelo predice un cambio de fechas un poco m√°s a menudo.  Es dif√≠cil decir con certeza si es estacionalidad o esa misma degradaci√≥n con el tiempo. <br><br>  Esto condujo a un cambio en el trabajo de datacientes, que dejaron de involucrar a otras personas y comenzaron a iterar sus modelos m√°s r√°pido.  Enviaron modelos a producci√≥n en seco junto con ingenieros de back-end.  Es decir, se recolectaron los vectores, el modelo hizo una predicci√≥n, pero estas predicciones no se utilizaron de ninguna manera. <br><br>  En el caso de una insignia, simplemente no mostramos nada, como antes, sino que recopilamos estad√≠sticas.  Esto nos permiti√≥ no perder tiempo en proyectos fallidos por adelantado.  Hemos liberado tiempo para front-end y dise√±adores para otros experimentos.  <strong>Mientras el centro de datos no est√© seguro de que el modelo funciona de la manera que desea, simplemente no involucra a otros en este proceso.</strong> <br><br>  Es interesante ver c√≥mo cambian los gr√°ficos en diferentes secciones. <br><img src="https://habrastorage.org/webt/kb/z_/oy/kbz_oyrod8128_uwtafqsjoym_m.jpeg"><br><br>  A la izquierda est√° la probabilidad de cambiar las fechas en el escritorio, a la derecha est√° en las tabletas.  Se ve claramente que en tabletas el modelo predice un cambio m√°s probable de fechas.  Esto se debe probablemente al hecho de que la tableta se usa a menudo para planificar viajes y con menos frecuencia para reservas. <br><br>  Tambi√©n es interesante ver c√≥mo cambian estos gr√°ficos a medida que los usuarios se mueven a trav√©s del embudo de ventas. <br><img src="https://habrastorage.org/webt/oi/ck/zi/oickzi_2tyz5vm8qyf4uk3g-dlw.jpeg"><br><br>  A la izquierda est√° la probabilidad de cambiar las fechas en la p√°gina de b√∫squeda, a la derecha est√° en la primera p√°gina de reserva.  Se puede ver que un n√∫mero mucho mayor de personas que ya han decidido sus fechas llegan a la p√°gina de reserva. <br><br>  Pero estos fueron buenos gr√°ficos.  ¬øC√≥mo son los malos?  De maneras muy diferentes.  A veces es solo ruido, a veces es una colina enorme, lo que significa que el modelo no puede separar efectivamente dos clases de predicciones. <br><img src="https://habrastorage.org/webt/uv/c4/zo/uvc4zocpgcdejqtebbpzzvgibws.jpeg"><br><br>  A veces estos son picos enormes. <br><img src="https://habrastorage.org/webt/gv/l1/y3/gvl1y36_ui-ut8wbo9ncdhciksg.jpeg"><br><br>  Esto tambi√©n es una regresi√≥n log√≠stica, y hasta cierto punto mostr√≥ una hermosa imagen con dos colinas, pero una ma√±ana se volvi√≥ as√≠. <br><br>  Para comprender lo que sucedi√≥ dentro, debe comprender c√≥mo se calcula la regresi√≥n log√≠stica. <br><br><h4>  Referencia r√°pida <br></h4><br><img src="https://habrastorage.org/webt/-f/op/w2/-fopw2q3tayu8rhnyg_pp5z4yms.jpeg"><br><br>  Esta es una funci√≥n log√≠stica del producto escalar, donde x <sub>n</sub> son algunas caracter√≠sticas.  Una de estas caracter√≠sticas era el precio de una noche en un hotel (en euros). <br><img src="https://habrastorage.org/webt/sb/mw/6o/sbmw6ocz3ts8f-fdjawob2ve3zk.jpeg"><br><br>  Llamar a este modelo ser√≠a algo como esto: <br><img src="https://habrastorage.org/webt/cf/so/m1/cfsom1foagpoo152nli4z31aqmo.jpeg"><br><br>  Presta atenci√≥n a la selecci√≥n.  Era necesario convertir el precio a euros, pero el desarrollador olvid√≥ hacerlo. <br><img src="https://habrastorage.org/webt/sz/5x/my/sz5xmybzwpcutqsc1xrj9vczaei.jpeg"><br><br>  Las monedas como rupias o rublos multiplicaron el producto escalar muchas veces y, por lo tanto, obligaron a este modelo a producir un valor cercano a la unidad, mucho m√°s a menudo, que vemos en el gr√°fico. <br><br><h4>  Valores umbral <br></h4><br>  Otra caracter√≠stica √∫til de estos histogramas fue la posibilidad de una elecci√≥n consciente y √≥ptima de los valores umbral. <br><img src="https://habrastorage.org/webt/0p/j-/lj/0pj-ljv2emwsf_7wu8bttcdb-e8.jpeg"><br><br>  Si coloca la pelota en la colina m√°s alta de este histograma, emp√∫jela e imagine d√≥nde se detendr√°, este ser√° el punto √≥ptimo para la separaci√≥n de clases.  Todo a la derecha es una clase, todo a la izquierda es otra. <br><br>  Sin embargo, si comienza a mover este punto, puede lograr efectos muy interesantes.  Supongamos que queremos ejecutar un experimento que, si el modelo dice que s√≠, de alguna manera cambia la interfaz de usuario.  Si mueve este punto a la derecha, la audiencia de nuestro experimento se reduce.  Despu√©s de todo, el n√∫mero de personas que recibieron esta predicci√≥n es el √°rea bajo la curva.  Sin embargo, en la pr√°ctica, la precisi√≥n de las predicciones es mucho mayor.  Del mismo modo, si no hay suficiente potencia est√°tica, puede aumentar la audiencia de su experimento, pero disminuir la precisi√≥n de las predicciones. <br><br>  Adem√°s de las predicciones en s√≠, comenzamos a monitorear los valores de entrada en los vectores. <br><br><h4>  Una codificaci√≥n activa <br></h4><br>  La mayor√≠a de las caracter√≠sticas en nuestros modelos m√°s simples son categ√≥ricas.  Esto significa que no se trata de n√∫meros, sino de ciertas categor√≠as: la ciudad de la que es el usuario o la ciudad en la que busca un hotel.  Utilizamos One Hot Encoding y convertimos cada uno de los valores posibles en una unidad en un vector binario.  Como al principio solo utilizamos nuestro propio n√∫cleo inform√°tico, fue f√°cil identificar situaciones en las que no hay lugar para la categor√≠a entrante en el vector entrante, es decir, el modelo no vio estos datos durante el entrenamiento. <br><img src="https://habrastorage.org/webt/xf/9t/w4/xf9tw4lzt0qbikwpfzeenzjjpie.jpeg"><br><br>  Esto es lo que generalmente parece. <br><img src="https://habrastorage.org/webt/hb/ih/0n/hbih0nrx9t3xlnl2coxoot3ek7a.jpeg"><br><br>  destination_id: la ciudad en la que el usuario busca un hotel.  Naturalmente, el modelo no vio alrededor del 5% de los valores, ya que constantemente estamos conectando nuevas ciudades.  visitor_cty_id = 23.32%, porque los cient√≠ficos de datos a veces omiten conscientemente ciudades menos comunes. <br><br>  En un mal caso, podr√≠a verse as√≠: <br><img src="https://habrastorage.org/webt/mq/14/ak/mq14akuux2wuwsqqyif_02e8j-e.jpeg"><br><br>  Inmediatamente 3 propiedades, el 100% de los valores que el modelo nunca ha visto.  La mayor√≠a de las veces esto ocurre debido al uso de formatos distintos a los utilizados en el entrenamiento, o simplemente errores tipogr√°ficos banales. <br><br>  Ahora, con la ayuda de paneles, detectamos y corregimos tales situaciones muy r√°pidamente. <br><br><h2>  Escaparate de aprendizaje autom√°tico <br></h2><br>  Hablemos de otros problemas que hemos resuelto.  Despu√©s de crear bibliotecas y monitoreo de clientes, el servicio comenz√≥ a ganar impulso muy r√°pidamente.  Est√°bamos literalmente abrumados con aplicaciones de diferentes partes de la compa√±√≠a: ‚Äú¬°Conectemos tambi√©n este modelo!  ¬°Actualicemos el viejo!  Acabamos de coser, de hecho, cualquier nuevo desarrollo se ha detenido. <br><br>  Salimos de la situaci√≥n haciendo <strong>un quiosco de autoservicio para cient√≠ficos de datos</strong> .  Ahora puede ir a nuestro portal, el mismo que usamos al principio solo para monitorear, y literalmente al hacer clic en el bot√≥n cargar el modelo en producci√≥n.  En unos minutos ella trabajar√° y dar√° predicciones. <br><br>  Hubo un problema m√°s. <br><img src="https://habrastorage.org/webt/mw/rp/l-/mwrpl-evpqktnfdk9l61shicboc.jpeg"><br><br>  Booking.com tiene aproximadamente 200 equipos de TI.  ¬øC√≥mo hacer que el equipo sepa en una parte completamente diferente de la compa√±√≠a que hay un modelo que podr√≠a ayudarlos?  Es posible que simplemente no sepa que tal equipo incluso existe.  ¬øC√≥mo saber qu√© modelos hay y c√≥mo usarlos?  Tradicionalmente, las comunicaciones externas en nuestros equipos se dedican a PO (Product Owner).  Esto no significa que no tengamos otras conexiones horizontales, solo PO lo hace m√°s que otras.  Pero es obvio que a tal escala, la comunicaci√≥n uno a uno no escala.  Necesitas hacer algo al respecto. <br><br>  <strong>¬øC√≥mo se puede facilitar la comunicaci√≥n?</strong> <br><br>  De repente nos dimos cuenta de que el portal, que creamos exclusivamente para monitoreo, gradualmente comienza a convertirse en un escaparate de aprendizaje autom√°tico dentro de nuestra empresa. <br><img src="https://habrastorage.org/webt/p_/r8/ps/p_r8pst3fhoza0zyb-b5lercws8.jpeg"><br><br>  Hemos permitido que los cient√≠ficos de datos describan sus modelos en detalle.  Cuando hab√≠a muchos modelos, agregamos etiquetas de tema y √°rea para una agrupaci√≥n conveniente. <br><img src="https://habrastorage.org/webt/54/d5/ft/54d5ftteqrf-siyozzgllalvuly.jpeg"><br><br>  Vinculamos nuestra herramienta con ExperimentTool.  Este es un producto dentro de nuestra empresa que proporciona experimentos A / B y almacena toda la historia de la experimentaci√≥n. <br><img src="https://habrastorage.org/webt/kh/bp/e2/khbpe2ifrcjlhkpaf9ihq-_3m0e.jpeg"><br><br>  Ahora, junto con la descripci√≥n del modelo, tambi√©n puede ver lo que otros equipos han hecho con este modelo antes y con qu√© √©xito.  Ha cambiado todo. <br><br>  En serio, esto ha cambiado la forma en que funciona la TI, porque incluso en situaciones en las que no hay un cient√≠fico de datos en el equipo, puede usar el aprendizaje autom√°tico. <br><img src="https://habrastorage.org/webt/kf/4n/pn/kf4npnnbrtj1vh_1080whzeewbk.jpeg"><br><br>  Por ejemplo, muchos equipos usan esto durante las sesiones de lluvia de ideas.  Cuando se les ocurren nuevas ideas de productos, simplemente seleccionan los modelos que les convienen y los utilizan.  No se necesita nada complicado para esto. <br><br>  <strong>¬øQu√© derram√≥ por nosotros?</strong>  En este momento, en el pico, entregamos alrededor de 200 mil predicciones por segundo, con latencia de menos de 20-30 ms, incluido el viaje de ida y vuelta de HTTP, y la colocaci√≥n de m√°s de 200 modelos. <br><br>  Puede parecer que fue una caminata tan f√°cil en el parque: hicimos un trabajo maravilloso, todo funciona, ¬°todos est√°n felices! <br><img src="https://habrastorage.org/webt/do/-q/mg/do-qmg7z1boovf5kyag7ngbr2wy.jpeg"><br><br>  Esto, por supuesto, no sucede.  Hubo errores  Al principio, por ejemplo, plantamos una peque√±a bomba de tiempo.  Por alguna raz√≥n, asumimos que la mayor√≠a de nuestros modelos ser√°n sistemas de recomendaci√≥n con vectores de entrada pesados, y la pila Scala + Akka fue elegida precisamente porque es muy f√°cil organizar c√°lculos paralelos con su ayuda.  Pero, en realidad, la sobrecarga de toda esta paralelizaci√≥n, para reunirse, result√≥ ser mayor que la ganancia posible.  En alg√∫n momento, nuestras 100 m√°quinas procesaron solo 100,000 RPS, y las fallas ocurrieron con s√≠ntomas bastante caracter√≠sticos: la utilizaci√≥n de la CPU es baja, pero se obtienen tiempos de espera. <br><img src="https://habrastorage.org/webt/ms/so/zz/mssozzq2glmsbn5o-g5au7dqjaa.jpeg"><br><br>  Luego volvimos a nuestro n√∫cleo de computaci√≥n, revisamos, hicimos puntos de referencia y, como resultado de las pruebas de capacidad, aprendimos que para el mismo tr√°fico solo necesitamos 4 m√°quinas. ,    ,      -,       , ,   ,      100 000 RPS  4 . <br><br>    -  ,        ,        .  -       ,      ,    ,    . <br><br>   ‚Äî    ,           .  ,    ID ,     .    ,    0. <br><img src="https://habrastorage.org/webt/cq/0b/6w/cq0b6wonigy8ltd8_jwilv7j62k.jpeg"><br><br>   ‚Äî    ,   ‚Äî     . <br><img src="https://habrastorage.org/webt/v-/qb/-u/v-qb-uqcn4kn09heh1z03rycgfm.jpeg"><br><br>   ,        .       ,    .    ,        ‚Äî      ,   .  , ,  ,       - . <br><br>     ,           ‚Äî  ID .        ‚Äî 49-51%.      ,     .     ,     ,    .     ,     . <br><br><h2>  Planes futuros <br></h2><br><ul><li> Label based metrics <br></li></ul><br>     -           ,     .   Label based metrics,   precision  recall   . <br><br><ul><li> More tools &amp; integrations <br></li></ul><br>        ,     .     ,            Perl  Java,  ,  ,   .       Spark,        . <br><br><ul><li> Reusable training pipelines <br></li></ul><br>          . <br><br> ,   -.  ,       , ,    ,  , <strong>steaming</strong> ‚Äî    -   ,       ,   . <br><br>      .     pipeline,    ,   .       ,    ,    . <br><br><ul><li> Async models <br></li></ul><br>     .    ,  <strong>,   50 ,    </strong> .   ,            .          ,      ,   . <br><br><h3> Start small <br></h3><br><blockquote>  ,   ,         Booking.com,    ,   ,     ‚Äî   ! <br></blockquote><br>        ,  ,    MySQL. ,      ,      .    -    . B      .      ,     ,    -     ‚Äî      . <br><br><blockquote>    ,      ? <br></blockquote><br><h3> Monitor <br></h3><br>     ‚Äî      , -, . <strong> ‚Äî     </strong> .   ‚Äî   ,    .    , ,   ,  .      :  ,  . ,      ,       ,      ‚Äî ! <br><br><h3> Organization footprint <br></h3><br>   ,    .         ,     . ,                . <br><br><h3> (Don't) Follow our steps <br></h3><br>   - , , ,    . , -     ,    .   ,     .   ‚Äî     ,      ,  ?  ,  ,     ,    ? <br><br> <strong>, ,   !</strong> <br><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HighLoad++ 2018,</a>   8  9   ,  <strong>135 </strong> ,      .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> <strong>9  -  </strong> .    ,      . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es427673/">https://habr.com/ru/post/es427673/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es427661/index.html">Sportiduino - sistema de marcado electr√≥nico para eventos deportivos, parte 3</a></li>
<li><a href="../es427663/index.html">Habro osos y cangrejo</a></li>
<li><a href="../es427665/index.html">Las mejores escalas inteligentes (seg√∫n Wareable)</a></li>
<li><a href="../es427669/index.html">KNX Home Control: iluminaci√≥n</a></li>
<li><a href="../es427671/index.html">Sberbank y Yandex lanzaron oficialmente la plataforma comercial Beru, la versi√≥n rusa de Amazon</a></li>
<li><a href="../es427675/index.html">Papeles, por favor. C√≥mo una red neuronal nos ayuda a verificar clientes y atrapar a los estafadores</a></li>
<li><a href="../es427679/index.html">Reducir a cero el l√≠mite de compras libres de impuestos llevar√° un a√±o y medio, si se toma una decisi√≥n</a></li>
<li><a href="../es427681/index.html">Arrastra y desliza en RecyclerView. Parte 1: ItemTouchHelper</a></li>
<li><a href="../es427683/index.html">Por qu√© no es buena idea portar el desbordamiento de enteros</a></li>
<li><a href="../es427685/index.html">FSB contra Internet satelital de operadores extranjeros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>