<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐ป ๐ โ๐ฟ DIY Autoscaling ูุน AWX ุ Ansible ุ haproxy ู CROC Cloud โ๐ผ ๐ฉ๐ผโ๐ณ ๐ง๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฐ ุจุนุถ ุงูููุช ุ ูุนููุง ุฑุตุฏ Agentless ูุฅูุฐุงุฑุงุช ูุฐูู. ูุฐุง ูู ุชูุงุธุฑูุฉ CloudWatch ูู AWS ูุน API ูุชูุงูู. ุงูุขู ูุญู ูุนูู ุนูู ุงูููุงุฒู ูุงููููุงุณ ุงูุชููุงุฆู. ูููู ุจ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DIY Autoscaling ูุน AWX ุ Ansible ุ haproxy ู CROC Cloud</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/croccloudteam/blog/456826/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/6f/nt/tj/6fnttjgdk8vat9bbsahsnck_rfa.jpeg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ููุฐ ุจุนุถ ุงูููุช ุ ูุนููุง ุฑุตุฏ Agentless ูุฅูุฐุงุฑุงุช ูุฐูู.  ูุฐุง ูู ุชูุงุธุฑูุฉ CloudWatch ูู AWS ูุน API ูุชูุงูู.  ุงูุขู ูุญู ูุนูู ุนูู ุงูููุงุฒู ูุงููููุงุณ ุงูุชููุงุฆู.  ูููู ุจูููุง ูุง ููุฏู ูุซู ูุฐู ุงูุฎุฏูุฉ ุ ูุฅููุง ููุฏู ูุนููุงุฆูุง ุงูููุงู ุจุฐูู ุจุฃููุณูู ุ ูุฐูู ุจุงุณุชุฎุฏุงู ุงููุฑุงูุจุฉ ูุงูุนูุงูุงุช ุงูุฎุงุตุฉ ุจูุง (AWS Resource Tagging API) ูุงูุชุดุงู ุฎุฏูุฉ ุจุณูุท ููุตุฏุฑ ููุจูุงูุงุช.  ุณูุจูู ููููุฉ ุงูููุงู ุจุฐูู ูู ูุฐุง ุงูููุดูุฑ. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุนูู ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ูุฎุฏูุฉ ููุจ ุจุณูุทุฉ: DNS -&gt; 2 ููุงุฒูุงุช -&gt; 2 ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ูููู ุงุนุชุจุงุฑ ูุฐู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุงูุญุฏ ุงูุฃุฏูู ุงูุถุฑูุฑู ููุชุดุบูู ูุงูุตูุงูุฉ ุงูุชู ุชุชุญูู ุงูุฃุฎุทุงุก.  ููุฐุง ุงูุณุจุจ ุ ูู "ูุถุบุท" ูุฐู ุงูุจููุฉ ุงูุชุญุชูุฉ ุฃูุซุฑ ุ ุชุงุฑููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุงุฌูุฉ ูุงุญุฏุฉ ููุท.  ููููู ุฃุฑุบุจ ูู ุฒูุงุฏุฉ ุนุฏุฏ ุฎูุงุฏู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุชูููุต ุนุฏุฏ ุฎูุงุฏููุง.  ุณุชููู ูุฐู ูููุชูุง.  ุฌููุน ุงูุฃูุซูุฉ ูุชููุฑุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุณุชูุฏุน</a> . </p><br><h3 id="bazovaya-infrastruktura" style=";text-align:right;direction:rtl">  ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุฃุณุงุณูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ูู ูุชุญุฏุซ ุจุงูุชูุตูู ุนู ุชูููู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงููุฐููุฑุฉ ุฃุนูุงู ุ ูุณูู ูุธูุฑ ููุท ููููุฉ ุฅูุดุงุฆูุง.  ูุญู ููุถู ูุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุงุณุชุฎุฏุงู Terraform.  ูุณุงุนุฏ ุนูู ุฅูุดุงุก ูู ูุง ุชุญุชุงุฌ ุฅููู ุจุณุฑุนุฉ (VPC ุ ุงูุดุจูุฉ ุงููุฑุนูุฉ ุ ูุฌููุนุฉ ุงูุฃูุงู ุ VMs) ูุชูุฑุงุฑ ูุฐุง ุงูุฅุฌุฑุงุก ูุฑุงุฑูุง ูุชูุฑุงุฑูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุจุฑูุงูุฌ ุงููุตู ูุฑูุน ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุฃุณุงุณูุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">main.tf</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="bash hljs">variable <span class="hljs-string"><span class="hljs-string">"ec2_url"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"access_key"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"secret_key"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"region"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"vpc_cidr_block"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"instance_type"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"big_instance_type"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"az"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"ami"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"client_ip"</span></span> {} variable <span class="hljs-string"><span class="hljs-string">"material"</span></span> {} provider <span class="hljs-string"><span class="hljs-string">"aws"</span></span> { endpoints { ec2 = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.ec2_url}</span></span></span><span class="hljs-string">"</span></span> } skip_credentials_validation = <span class="hljs-literal"><span class="hljs-literal">true</span></span> skip_requesting_account_id = <span class="hljs-literal"><span class="hljs-literal">true</span></span> skip_region_validation = <span class="hljs-literal"><span class="hljs-literal">true</span></span> access_key = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.access_key}</span></span></span><span class="hljs-string">"</span></span> secret_key = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.secret_key}</span></span></span><span class="hljs-string">"</span></span> region = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.region}</span></span></span><span class="hljs-string">"</span></span> } resource <span class="hljs-string"><span class="hljs-string">"aws_vpc"</span></span> <span class="hljs-string"><span class="hljs-string">"vpc"</span></span> { cidr_block = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.vpc_cidr_block}</span></span></span><span class="hljs-string">"</span></span> } resource <span class="hljs-string"><span class="hljs-string">"aws_subnet"</span></span> <span class="hljs-string"><span class="hljs-string">"subnet"</span></span> { availability_zone = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.az}</span></span></span><span class="hljs-string">"</span></span> vpc_id = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_vpc.vpc.id}</span></span></span><span class="hljs-string">"</span></span> cidr_block = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cidrsubnet(aws_vpc.vpc.cidr_block, 8, 0)}</span></span></span><span class="hljs-string">"</span></span> } resource <span class="hljs-string"><span class="hljs-string">"aws_security_group"</span></span> <span class="hljs-string"><span class="hljs-string">"sg"</span></span> { name = <span class="hljs-string"><span class="hljs-string">"auto-scaling"</span></span> vpc_id = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_vpc.vpc.id}</span></span></span><span class="hljs-string">"</span></span> ingress { from_port = 22 to_port = 22 protocol = <span class="hljs-string"><span class="hljs-string">"tcp"</span></span> cidr_blocks = [<span class="hljs-string"><span class="hljs-string">"0.0.0.0/0"</span></span>] } ingress { from_port = 80 to_port = 80 protocol = <span class="hljs-string"><span class="hljs-string">"tcp"</span></span> cidr_blocks = [<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cidrsubnet(aws_vpc.vpc.cidr_block, 8, 0)}</span></span></span><span class="hljs-string">"</span></span>] } ingress { from_port = 8080 to_port = 8080 protocol = <span class="hljs-string"><span class="hljs-string">"tcp"</span></span> cidr_blocks = [<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cidrsubnet(aws_vpc.vpc.cidr_block, 8, 0)}</span></span></span><span class="hljs-string">"</span></span>] } egress { from_port = 0 to_port = 0 protocol = <span class="hljs-string"><span class="hljs-string">"-1"</span></span> cidr_blocks = [<span class="hljs-string"><span class="hljs-string">"0.0.0.0/0"</span></span>] } } resource <span class="hljs-string"><span class="hljs-string">"aws_key_pair"</span></span> <span class="hljs-string"><span class="hljs-string">"key"</span></span> { key_name = <span class="hljs-string"><span class="hljs-string">"auto-scaling-new"</span></span> public_key = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.material}</span></span></span><span class="hljs-string">"</span></span> } resource <span class="hljs-string"><span class="hljs-string">"aws_instance"</span></span> <span class="hljs-string"><span class="hljs-string">"compute"</span></span> { count = 5 ami = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.ami}</span></span></span><span class="hljs-string">"</span></span> instance_type = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${count.index == 0 ? var.big_instance_type : var.instance_type}</span></span></span><span class="hljs-string">"</span></span> key_name = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_key_pair.key.key_name}</span></span></span><span class="hljs-string">"</span></span> subnet_id = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_subnet.subnet.id}</span></span></span><span class="hljs-string">"</span></span> availability_zone = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${var.az}</span></span></span><span class="hljs-string">"</span></span> security_groups = [<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_security_group.sg.id}</span></span></span><span class="hljs-string">"</span></span>] } resource <span class="hljs-string"><span class="hljs-string">"aws_eip"</span></span> <span class="hljs-string"><span class="hljs-string">"pub_ip"</span></span> { instance = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_instance.compute.0.id}</span></span></span><span class="hljs-string">"</span></span> vpc = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } output <span class="hljs-string"><span class="hljs-string">"awx"</span></span> { value = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_eip.pub_ip.public_ip}</span></span></span><span class="hljs-string">"</span></span> } output <span class="hljs-string"><span class="hljs-string">"haproxy_id"</span></span> { value = [<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${slice(aws_instance.compute.*.id, 1, 3)}</span></span></span><span class="hljs-string">"</span></span>] } output <span class="hljs-string"><span class="hljs-string">"awx_id"</span></span> { value = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${aws_instance.compute.0.id}</span></span></span><span class="hljs-string">"</span></span> } output <span class="hljs-string"><span class="hljs-string">"backend_id"</span></span> { value = [<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${slice(aws_instance.compute.*.id, 3, 5)}</span></span></span><span class="hljs-string">"</span></span>] }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุจุฏู ุฃู ุฌููุน ุงูููุงูุงุช ุงูููุตููุฉ ูู ูุฐุง ุงูุชูููู ูุฌุจ ุฃู ูููููุง ุงููุณุชุฎุฏู ุงูุนุงุฏู ููุบููู ุงูุญุฏูุซุฉ.  ูุชู ููู ุงููุชุบูุฑุงุช ุงูุฎุงุตุฉ ุจุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูุง ูููููุฉ ูุญุฏุฏุฉ ุฅูู ููู ูููุตู - terraform.tfvars: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">terraform.tfvars</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ec2_url = <span class="hljs-string"><span class="hljs-string">"https://api.cloud.croc.ru"</span></span> access_key = <span class="hljs-string"><span class="hljs-string">"project:user@customer"</span></span> secret_key = <span class="hljs-string"><span class="hljs-string">"secret-key"</span></span> region = <span class="hljs-string"><span class="hljs-string">"croc"</span></span> az = <span class="hljs-string"><span class="hljs-string">"ru-msk-vol51"</span></span> instance_type = <span class="hljs-string"><span class="hljs-string">"m1.2small"</span></span> big_instance_type = <span class="hljs-string"><span class="hljs-string">"m1.large"</span></span> vpc_cidr_block = <span class="hljs-string"><span class="hljs-string">"10.10.0.0/16"</span></span> ami = <span class="hljs-string"><span class="hljs-string">"cmi-3F5B011E"</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุฅุทูุงู Terraform: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุทุจูู terraform</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">yes yes | terraform apply -var client_ip=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(curl -s ipinfo.io/ip)</span></span></span><span class="hljs-string">/32"</span></span> -var material=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(cat &lt;ssh_publick_key_path&gt;)</span></span></span><span class="hljs-string">"</span></span></code> </pre> </div></div><br><h3 id="nastroyka-monitoringa" style=";text-align:right;direction:rtl">  ุฑุตุฏ ุงูุฅุนุฏุงุฏ </h3><br><p style=";text-align:right;direction:rtl">  ุชุชู ูุฑุงูุจุฉ VMs ุงูุชู ุชู ุฅุทูุงููุง ุฃุนูุงู ุชููุงุฆููุง ุจูุงุณุทุฉ ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูุง.  ุณุชููู ุจูุงูุงุช ุงููุฑุงูุจุฉ ูุฐู ูู ูุตุฏุฑ ุงููุนูููุงุช ูุนูููุฉ ุงูุชุนููู ุงูุฐุงุชู ุงููุณุชูุจููุฉ.  ุจุงูุงุนุชูุงุฏ ุนูู ููุงููุณ ูุนููุฉ ุ ูููููุง ุฒูุงุฏุฉ ุฃู ุชูููู ุงูุทุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุชุชูุญ ูู ุงููุฑุงูุจุฉ ูู ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูุง ุชูููู ุฃุฌูุฒุฉ ุงูุฅูุฐุงุฑ ููููุง ููุธุฑูู ุงููุฎุชููุฉ ููููุงููุณ ุงููุฎุชููุฉ.  ุงููุง ูุฑูุญุฉ ุฌุฏุง.  ูุง ูุญุชุงุฌ ุฅูู ุชุญููู ุงูููุงููุณ ูู ุฃู ููุงุตู ุฒูููุฉ ูุงุชุฎุงุฐ ูุฑุงุฑ - ุณูุชู ุฐูู ุนู ุทุฑูู ุงููุฑุงูุจุฉ ุงูุณุญุงุจูุฉ.  ูู ูุฐุง ุงููุซุงู ุ ุณูู ูุณุชุฎุฏู ุฃุฌูุฒุฉ ุงูุฅูุฐุงุฑ ุงูุฎุงุตุฉ ุจููุงููุณ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ูููู ูู ุงููุฑุงูุจุฉ ุงูุฎุงุตุฉ ุจูุง ูููู ุฃูุถูุง ุชูููููุง ูููุงููุณ ูุซู: ุงุณุชุฎุฏุงู ุงูุดุจูุฉ (ุงูุณุฑุนุฉ / ููุทุฉ ูู ุงูุซุงููุฉ) ุ ูุงุณุชุฎุฏุงู ุงููุฑุต (ุงูุณุฑุนุฉ / iops). </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุณุญุงุจุฉ ูุถุน ูุชุฑู ุฅูุฐุงุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CLOUDWATCH_URL=https://monitoring.cloud.croc.ru <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> instance_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;backend_instance_ids&gt;; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> \ aws --profile &lt;aws_cli_profile&gt; --endpoint-url <span class="hljs-variable"><span class="hljs-variable">$CLOUDWATCH_URL</span></span> \ cloudwatch put-metric-alarm \ --alarm-name <span class="hljs-string"><span class="hljs-string">"scaling-low_</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$instance_id</span></span></span><span class="hljs-string">"</span></span> \ --dimensions Name=InstanceId,Value=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$instance_id</span></span></span><span class="hljs-string">"</span></span> \ --namespace <span class="hljs-string"><span class="hljs-string">"AWS/EC2"</span></span> --metric-name CPUUtilization --statistic Average \ --period 60 --evaluation-periods 3 --threshold 15 --comparison-operator LessThanOrEqualToThreshold; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> instance_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;backend_instance_ids&gt;; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> \ aws --profile &lt;aws_cli_profile&gt; --endpoint-url <span class="hljs-variable"><span class="hljs-variable">$CLOUDWATCH_URL</span></span> \ cloudwatch put-metric-alarm\ --alarm-name <span class="hljs-string"><span class="hljs-string">"scaling-high_</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$instance_id</span></span></span><span class="hljs-string">"</span></span> \ --dimensions Name=InstanceId,Value=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$instance_id</span></span></span><span class="hljs-string">"</span></span> \ --namespace <span class="hljs-string"><span class="hljs-string">"AWS/EC2"</span></span> --metric-name CPUUtilization --statistic Average\ --period 60 --evaluation-periods 3 --threshold 80 --comparison-operator GreaterThanOrEqualToThreshold; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุตู ุจุนุถ ุงููุนููุงุช ุงูุชู ูุฏ ุชููู ุบูุฑ ูููููุฉ: </p><br><p style=";text-align:right;direction:rtl">  --profile - ููู ุชุนุฑูู ุฅุนุฏุงุฏุงุช aws-cli ุ ุงูููุตูู ูู ~ / .aws / config.  ุนุงุฏุฉ ุ ูุชู ุชุนููู ููุงุชูุญ ูุตูู ูุฎุชููุฉ ูู ูููุงุช ุชุนุฑูู ูุฎุชููุฉ. </p><br><p style=";text-align:right;direction:rtl">  - ุฃุจุนุงุฏ - ุชุญุฏุฏ ุงููุนููุฉ ุงูููุฑุฏ ุงูุฐู ุณูุชู ุฅูุดุงุก ุงูููุจู ุ ูู ุงููุซุงู ุฃุนูุงู - ูููุซูู ุฐู ุงููุนุฑู ูู ุงููุชุบูุฑ $ ูุซูู _. </p><br><p style=";text-align:right;direction:rtl">  - ูุณุงุญุฉ ุงูุงุณู - ูุณุงุญุฉ ุงูุงุณู ุงูุชู ุณูุชู ุชุญุฏูุฏ ูููุงุณ ุงููุฑุงูุจุฉ ูููุง. </p><br><p style=";text-align:right;direction:rtl">  - ุงุณู ูุชุฑู - ุงุณู ููุงุณ ุงูุฑุตุฏ. </p><br><p style=";text-align:right;direction:rtl">  - ุฅุญุตุงุฆู - ุงุณู ุทุฑููุฉ ุชุฌููุน ุงููููุฉ ุงููุชุฑูุฉ. </p><br><p style=";text-align:right;direction:rtl">  - ูุชุฑุฉ - ุงููุงุตู ุงูุฒููู ุจูู ุฑุตุฏ ุฃุญุฏุงุซ ุฌูุน ุงููููุฉ. </p><br><p style=";text-align:right;direction:rtl">  - ูุชุฑุงุช ุงูุชูููู - ุนุฏุฏ ุงูููุงุตู ุงูุฒูููุฉ ุงููุงุฒูุฉ ูุฅุทูุงู ุฅูุฐุงุฑ. </p><br><p style=";text-align:right;direction:rtl">  - ุงูุนุชุจุฉ - ูููุฉ ุงูุนุชุจุฉ ุงููุชุฑูุฉ ูุชูููู ุญุงูุฉ ุงูุฅูุฐุงุฑ. </p><br><p style=";text-align:right;direction:rtl">  - ุงูููุงุฑูุฉ - ุนุงูู - ุทุฑููุฉ ูุชู ุงุณุชุฎุฏุงููุง ูุชูููู ูููุฉ ุงููููุงุณ ุจุงููุณุจุฉ ุฅูู ูููุฉ ุงูุนุชุจุฉ. </p></div></div><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซุงู ุฃุนูุงู ุ ูุชู ุฅูุดุงุก ุฌูุงุฒู ุฅูุฐุงุฑ ููู ูุซูู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ุณูุชู ุชุดุบูู ุงูููุงุณ ุงูููุฎูุถ &lt;instance-id&gt; ูู ุญุงูุฉ ุงูุฅูุฐุงุฑ ุนูุฏ ุชุญููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุฃูู ูู 15ูช ููุฏุฉ 3 ุฏูุงุฆู.  ุณูุชู ุชุดุบูู ุงูููุงุณ - &lt;instance-id&gt; - ุงููุฑุชูุน ูู ุญุงูุฉ ุงูุฅูุฐุงุฑ ุนูุฏ ุชุญููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุฃูุซุฑ ูู 80ูช ููุฏุฉ 3 ุฏูุงุฆู. </p><br><h3 id="nastroyka-tegov" style=";text-align:right;direction:rtl">  ุชุฎุตูุต ุงูุนูุงูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅุนุฏุงุฏ ุงููุฑุงูุจุฉ ุ ููุงุฌู ุงููููุฉ ุงูุชุงููุฉ - ุงูุชุดุงู ุงูุญุงูุงุช ูุฃุณูุงุฆูุง (ุงูุชุดุงู ุงูุฎุฏูุฉ).  ูุญุชุงุฌ ุฃู ูููู ุจุทุฑููุฉ ูุง ุนุฏุฏ ุงูุญุงูุงุช ุงูุฎูููุฉ ุงูุชู ุฃุทูููุงูุง ุงูุขู ุ ููุญุชุงุฌ ุฃูุถูุง ุฅูู ูุนุฑูุฉ ุฃุณูุงุฆูู.  ูู ุนุงูู ุฎุงุฑุฌ ุงูุณุญุงุจุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุณูููู ูุงูุจ ุงูููุตู ูุงูููุตู ููุงุณุจูุง ูุชูููู ููุงุฒู.  ูููู ููุงู ุนูุงูุงุช ูู ุณุญุงุจุฉ ูุฏููุง.  ุณุชุณุงุนุฏูุง ุงูุนูุงูุงุช ูู ุชุตููู ุงูููุงุฑุฏ.  ุนู ุทุฑูู ุทูุจ ูุนูููุงุช ูุนูุงูุฉ ูุนููุฉ (ูุตู ุงูุนูุงูุงุช) ุ ูููููุง ุฃู ูููู ุนุฏุฏ ุงูุญุงูุงุช ุงูุชู ูุฏููุง ุญุงููุง ูู ุงููุฌูุน ููุง ูู ูุนุฑู ูุฏููู.  ุงูุชุฑุงุถููุง ุ ูุชู ุงุณุชุฎุฏุงู ูุนุฑู ูุซูู ูุฑูุฏ ูุงุณู ูุถูู.  ุจูุถู DNS ุงูุฏุงุฎูู ุงูุฐู ูุนูู ุฏุงุฎู VPC ุ ูุชู ุญู ุฃุณูุงุก ุงููููุฉ / ุงููุถููุงุช ูุฐู ุนูู ูุซููุงุช IP ุงูุฏุงุฎููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ูุถุน ุนูุงูุงุช ุนูู ูุซููุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุงูููุงุฒูุงุช: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ec2 ุฅูุดุงุก ุงูุนูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> EC2_URL=<span class="hljs-string"><span class="hljs-string">"https://api.cloud.croc.ru"</span></span> aws --profile &lt;aws_cli_profile&gt; --endpoint-url <span class="hljs-variable"><span class="hljs-variable">$EC2_URL</span></span> \ ec2 create-tags --resources <span class="hljs-string"><span class="hljs-string">"&lt;awx_instance_id&gt;"</span></span> \ --tags Key=env,Value=auto-scaling Key=role,Value=awx <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;backend_instance_ids&gt;; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> \ aws --profile &lt;aws_cli_profile&gt; --endpoint-url <span class="hljs-variable"><span class="hljs-variable">$EC2_URL</span></span> \ ec2 create-tags --resources <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">"</span></span> \ --tags Key=env,Value=auto-scaling Key=role,Value=backend ; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;haproxy_instance_ids&gt;; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> \ aws --profile &lt;aws_cli_profile&gt; --endpoint-url <span class="hljs-variable"><span class="hljs-variable">$EC2_URL</span></span> \ ec2 create-tags --resources <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$i</span></span></span><span class="hljs-string">"</span></span> \ --tags Key=env,Value=auto-scaling Key=role,Value=haproxy; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span>;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญูุซ: </p><br><p style=";text-align:right;direction:rtl">  --resources - ูุงุฆูุฉ ุจูุนุฑูุงุช ุงูููุงุฑุฏ ุงูุชู ุณูุชู ุชุนููู ุงูุนูุงูุงุช ููุง. </p><br><p style=";text-align:right;direction:rtl">  - ุงูุนูุงูุงุช ูู ูุงุฆูุฉ ุจุฃุฒูุงุฌ ุงููููุฉ ุงูุฑุฆูุณูุฉ. </p></div></div><br><p style=";text-align:right;direction:rtl">  ูุชููุฑ ูุซุงู ููุตู ุงูุนูุงูุงุช ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู</a> CROC Cloud. </p><br><h3 id="nastroyka-avtoskeylinga" style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ ุงูุชุญุฌูู ุงูุชููุงุฆู </h3><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญุช ุงูุณุญุงุจุฉ ุชุฑุงูุจ ุ ููุนุฑู ููููุฉ ุงูุชุนุงูู ูุน ุงูุนูุงูุงุช ุ ูููููุง ููุท ุงุณุชูุตุงุก ุญุงูุฉ ุงูุฅูุฐุงุฑุงุช ุงูุชู ุชู ุชูููููุง ููุชุดุบูู.  ูุญุชุงุฌ ููุง ุฅูู ููุงู ุณูุดุงุฑู ูู ููุงู ุงููุฑุงูุจุฉ ูุงูุฑุตุฏ ุงูุฏูุฑูุฉ ูุฅูุดุงุก / ุญุฐู ุงูุญุงูุงุช.  ูููู ุชุทุจูู ุฃุฏูุงุช ุงูุชุดุบูู ุงูุขูู ุงููุฎุชููุฉ ููุง.  ุณูู ูุณุชุฎุฏู AWX.  AWX ูู ุฅุตุฏุงุฑ ููุชูุญ ุงููุตุฏุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุจุฑุฌ Ansible</a> ุงูุชุฌุงุฑู ุ ููู ููุชุฌ ูุฅุฏุงุฑุฉ ุงูุจููุฉ ุงูุฃุณุงุณูุฉ Ansible ูุฑูุฒููุง.  ูุชุชูุซู ุงููููุฉ ุงูุฑุฆูุณูุฉ ูู ุฅุทูุงู playbook ูุฏููุง ansible ุจุดูู ุฏูุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุนูู ูุดุฑ AWX ูุชุงุญ ุนูู ุตูุญุฉ <a href="">ุงููููู</a> ูู ุงููุณุชูุฏุน ุงูุฑุณูู.  ุชู ูุตู ุชูููู AWX ุฃูุถูุง ูู ูุซุงุฆู Ansible Tower.  ููู ุชุจุฏุฃ AWX ูู ุชุดุบูู ููุงุนุฏ ุงูุชุดุบูู ุงููุฎุตุตุฉ ุ ูุฌุจ ุนููู ุชูููููุง ุนู ุทุฑูู ุฅูุดุงุก ุงูููุงูุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃูุฑุงู ุงุนุชูุงุฏ ูู ุซูุงุซุฉ ุฃููุงุน: <br>  <em>- ุฃูุฑุงู ุงุนุชูุงุฏ AWS - ูุชุฎููู ุงูุนูููุงุช ุงููุชุนููุฉ ุจุณุญุงุจุฉ CROC.</em> <em><br></em>  - ุจูุงูุงุช ุงุนุชูุงุฏ ุงูุฌูุงุฒ - ููุงุชูุญ ssh ูููุตูู ุฅูู ุงูุญุงูุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ุญุฏูุซูุง. <br>  - ุฃูุฑุงู ุงุนุชูุงุฏ SCM - ููุญุตูู ุนูู ุฅุฐู ูู ูุธุงู ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑ. </li><li style=";text-align:right;direction:rtl">  Project ูู ููุงู ุณูุฏูุน ูุณุชูุฏุน git ูู playbook. </li><li style=";text-align:right;direction:rtl">  ุงูุจุฑุงูุฌ ุงููุตูุฉ - ุงูุจุฑูุงูุฌ ุงููุตู ุงููุฎุฒูู ุงูุฏููุงูููู ู ansible. </li><li style=";text-align:right;direction:rtl">  ุงูุฌุฑุฏ ูู ููุงู ูููู ุจุงุณุชุฏุนุงุก ุงูุจุฑูุงูุฌ ุงููุตู ูููุฎุฒูู ุงูุฏููุงูููู ูุจู ุจุฏุก ุชุดุบูู playbook. </li><li style=";text-align:right;direction:rtl">  ูุงูุจ - ุชูููู ููุงููุฉ playbook ูุนููุฉ ุ ููุชุฃูู ูู ูุฌููุนุฉ ูู ุฃูุฑุงู ุงูุงุนุชูุงุฏ ูุฌุฑุฏ ูููุงุนุฏ ุงููุนุจุฉ ูู Project. </li><li style=";text-align:right;direction:rtl">  ุณูุฑ ุงูุนูู - ุณูุณูุฉ ูู ุงูููุงููุงุช playbooks </li></ul><br><p style=";text-align:right;direction:rtl">  ูููู ุชูุณูู ุนูููุฉ autoscaling ุฅูู ูุณููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  scale_up - ุฅูุดุงุก ูุซูู ุนูุฏ ุชุดุบูู ุฅูุฐุงุฑ ูุงุญุฏ ุนูู ุงูุฃูู ุ </li><li style=";text-align:right;direction:rtl">  scale_down - ุฅููุงุก ูุซูู ุฅุฐุง ูุงู ููุงู ุฅูุฐุงุฑ ููุฎูุถ ูุนูู ุนููู. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฌุฒุก ูู ุงูุฌุฒุก scale_up ุ ุณุชุญุชุงุฌ ุฅูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุฌูุงุจ ุฎุฏูุฉ ุงููุฑุงูุจุฉ ุงูุณุญุงุจูุฉ ุญูู ูุฌูุฏ ุฃุฌูุฒุฉ ุงูุฅูุฐุงุฑ ุงูุนุงููุฉ ูู ุญุงูุฉ "ุงูููุจู" ุ </li><li style=";text-align:right;direction:rtl">  ุฅููุงู scale_up ูุจู ุงูููุนุฏ ุงููุญุฏุฏ ุฅุฐุง ูุงูุช ุฌููุน ุงูุฅูุฐุงุฑุงุช ุงูุนุงููุฉ ูู ุญุงูุฉ "ููุงูู" ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุซูู ุฌุฏูุฏ ุจุงูุณูุงุช ุงููุงุฒูุฉ (ุงูุนูุงูุฉ ุ ุงูุดุจูุฉ ุงููุฑุนูุฉ ุ security_group ุ ุฅูุฎ) ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฅูุฐุงุฑุงุช ุนุงููุฉ ูููุฎูุถุฉ ููุซูู ููุฏ ุงูุชุดุบูู ุ </li><li style=";text-align:right;direction:rtl">  ุชูููู ุชุทุจูููุง ุฏุงุฎู ูุซูู ุฌุฏูุฏ (ูู ุญุงูุชูุง ุ ุณูููู ูุฌุฑุฏ nginx ูุน ุตูุญุฉ ุงุฎุชุจุงุฑ) ุ </li><li style=";text-align:right;direction:rtl">  ูู ุจุชุญุฏูุซ ุชูููู haproxy ุ ููู ุจุฅุนุงุฏุฉ ุชุญููู ุจุญูุซ ุชุจุฏุฃ ุงูุทูุจุงุช ูู ุงูุงูุชูุงู ุฅูู ุงููุซูู ุงูุฌุฏูุฏ. </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅูุดุงุก instance.yaml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">--- - name: get alarm statuses describe_alarms: region: "croc" alarm_name_prefix: "scaling-high" alarm_state: "alarm" register: describe_alarms_query - name: stop if no alarms fired fail: msg: zero high alarms in alarm state when: describe_alarms_query.meta | length == 0 - name: create instance ec2: region: "croc" wait: yes state: present count: 1 key_name: "{{ hostvars[groups['tag_role_backend'][0]].ec2_key_name }}" instance_type: "{{ hostvars[groups['tag_role_backend'][0]].ec2_instance_type }}" image: "{{ hostvars[groups['tag_role_backend'][0]].ec2_image_id }}" group_id: "{{ hostvars[groups['tag_role_backend'][0]].ec2_security_group_ids }}" vpc_subnet_id: "{{ hostvars[groups['tag_role_backend'][0]].ec2_subnet_id }}" user_data: | #!/bin/sh sudo yum install epel-release -y sudo yum install nginx -y cat &lt;&lt;EOF &gt; /etc/nginx/conf.d/dummy.conf server { listen 8080; location / { return 200 '{"message": "$HOSTNAME is up"}'; } } EOF sudo systemctl restart nginx loop: "{{ hostvars[groups['tag_role_backend'][0]] }}" register: new - name: create tag entry ec2_tag: ec2_url: "https://api.cloud.croc.ru" region: croc state: present resource: "{{ item.id }}" tags: role: backend loop: "{{ new.instances }}" - name: create low alarms ec2_metric_alarm: state: present region: croc name: "scaling-low_{ item.id }}" metric: "CPUUtilization" namespace: "AWS/EC2" statistic: Average comparison: "&lt;=" threshold: 15 period: 300 evaluation_periods: 3 unit: "Percent" dimensions: {'InstanceId':"{{ item.id }}"} loop: "{{ new.instances }}" - name: create high alarms ec2_metric_alarm: state: present region: croc name: "scaling-high_{{ item.id }}" metric: "CPUUtilization" namespace: "AWS/EC2" statistic: Average comparison: "&gt;=" threshold: 80.0 period: 300 evaluation_periods: 3 unit: "Percent" dimensions: {'InstanceId':"{{ item.id }}"} loop: "{{ new.instances }}"</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูู create-example.yaml ุ ูุง ูุญุฏุซ ูู: ุฅูุดุงุก ูุซูู ูุน ุงููุนููุงุช ุงูุตุญูุญุฉ ููุถุน ุนูุงูุงุช ุนูู ูุฐุง ุงููุซูู ูุฅูุดุงุก ุงูุฅูุฐุงุฑุงุช ุงููุงุฒูุฉ.  ูุชู ุชูุฑูุฑ ุงูุจุฑูุงูุฌ ุงููุตู ูุชุซุจูุช ูุชูููู nginx ุฃูุถูุง ูู ุฎูุงู ุจูุงูุงุช ุงููุณุชุฎุฏู.  ุชุชู ูุนุงูุฌุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ุจูุงุณุทุฉ ุฎุฏูุฉ cloud-init ุ ูุงูุชู ุชุชูุญ ุงูุชูููู ุงููุฑู ูููุซูู ุฃุซูุงุก ุจุฏุก ุงูุชุดุบูู ุฏูู ุงููุฌูุก ุฅูู ุฃุฏูุงุช ุงูุชุดุบูู ุงูุขูู ุงูุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูู update-lb.yaml ุ ูุชู ุฅุนุงุฏุฉ ุฅูุดุงุก ููู /etc/haproxy/haproxy.cfg ุนูู ูุซูู haproxy ูุฎุฏูุฉ ุฅุนุงุฏุฉ ุชุญููู haproxy: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุชุญุฏูุซ lb.yaml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">- name: update haproxy configs template: src: haproxy.cfg.j2 dest: /etc/haproxy/haproxy.cfg - name: add new backend host to haproxy systemd: name: haproxy state: restarted</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุญูุซ haproxy.cfg.j2 ูู ูุงูุจ ููู ุชูููู ุฎุฏูุฉ haproxy: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">haproxy.cfg.j2</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># {{ ansible_managed }} global log /dev/log local0 log /dev/log local1 notice chroot /var/lib/haproxy stats timeout 30s user haproxy group haproxy daemon defaults log global mode http option httplog option dontlognull timeout connect 5000 timeout client 50000 timeout server 50000 frontend loadbalancing bind *:80 mode http default_backend backendnodes backend backendnodes balance roundrobin option httpchk HEAD / {% for host in groups['tag_role_backend'] %} server {{hostvars[host]['ec2_id']}} {{hostvars[host]['ec2_private_ip_address']}}:8080 check {% endfor %}</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุชุนุฑูู ุฎูุงุฑ httpchk ูู ูุณู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุชูููู haproxy ุ ุณุชููู ุฎุฏูุฉ haproxy ุจุงุณุชูุตุงุก ุญุงูุงุช ูุซููุงุช ุงูุฎูููุฉ ูุญุฑูุฉ ุงููุฑูุฑ ุงูููุงุฒูุฉ ููุท ุจูู ุงููุญูุตุงุช ุงูุตุญูุฉ ุงูุณุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฌุฒุก ุงูุชุฏุฑุฌ ุงูุฐู ุชุญุชุงุฌู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญูู ูุงููุณ ุงูุฎุทุฑ ุฏููุฉ ููุฎูุถุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅููุงุก ุงููุณุฑุญูุฉ ูุจู ุงูุฃูุงู ุฅุฐุง ูู ููู ููุงู ุฅูุฐุงุฑุงุช ููุฎูุถุฉ ูู ุญุงูุฉ "ุงูููุจู" ุ </li><li style=";text-align:right;direction:rtl">  ุฅููุงุก ุฌููุน ุงูุญุงูุงุช ุงูุชู ูููู ูููุง ุงูุชูุจูู ุงูููุฎูุถ ูู ูุฆุฉ ุงูุฅูุฐุงุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุญุธุฑ ุฅููุงุก ุขุฎุฑ ุฒูุฌ ูู ุงูุญุงูุงุช ุ ุญุชู ูู ูุงูุช ุฅูุฐุงุฑุงุชูู ูู ุญุงูุฉ ุงูุฅูุฐุงุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุฅุฒุงูุฉ ุงูุญุงูุงุช ุงูุชู ุฃุฒููุงูุง ูู ุชูููู ููุงุฒู ุงูุชุญููู. </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุฏููุฑ-instance.yaml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">- name: look for alarm status describe_alarms: region: "croc" alarm_name_prefix: "scaling-low" alarm_state: "alarm" register: describe_alarms_query - name: count alarmed instances set_fact: alarmed_count: "{{ describe_alarms_query.meta | length }}" alarmed_ids: "{{ describe_alarms_query.meta }}" - name: stop if no alarms fail: msg: no alarms fired when: alarmed_count | int == 0 - name: count all described instances set_fact: all_count: "{{ groups['tag_role_backend'] | length }}" - name: fail if last two instance remaining fail: msg: cant destroy last two instances when: all_count | int == 2 - name: destroy tags for marked instances ec2_tag: ec2_url: "https://api.cloud.croc.ru" region: croc resource: "{{ alarmed_ids[0].split('_')[1] }}" state: absent tags: role: backend - name: destroy instances ec2: region: croc state: absent instance_ids: "{{ alarmed_ids[0].split('_')[1] }}" - name: destroy low alarms ec2_metric_alarm: state: absent region: croc name: "scaling-low_{{ alarmed_ids[0].split('_')[1] }}" - name: destroy high alarms ec2_metric_alarm: state: absent region: croc name: "scaling-high_{{ alarmed_ids[0].split('_')[1] }}"</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูู ุฅุชูุงู-ูุซูู. yaml ุ ูุชู ุญุฐู ุงูุฅูุฐุงุฑุงุช ุ ููุชู ุฅููุงุก ุงููุซูู ูุนูุงูุฉ ุงูุชูููุฒ ุงูุฎุงุตุฉ ุจู ุ ููุชู ูุญุต ุงูุดุฑูุท ุงูุชู ุชุญุธุฑ ุฅููุงุก ุงูุญุงูุงุช ุงูุฃุฎูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุญุฐู ุงูุนูุงูุงุช ุจุดูู ุตุฑูุญ ุจุนุฏ ุญุฐู ุงููุซููุงุช ูุธุฑูุง ูุญูููุฉ ุฃูู ุจุนุฏ ุญุฐู ูุซูู ุ ูุชู ุญุฐู ุงูุนูุงูุงุช ุงููุฑุชุจุทุฉ ุจู ููุชุงุญุฉ ููุฏุฉ ุฏูููุฉ ุฃุฎุฑู. <br>  AWX. </p><br><h3 id="nastroyka-zadach-shablonov" style=";text-align:right;direction:rtl">  ุชุญุฏูุฏ ุงูููุงู ูุงูููุงูุจ </h3><br><p style=";text-align:right;direction:rtl">  ุณุชููู ูุฌููุนุฉ ุงูููุงู ุงูุชุงููุฉ ุจุฅูุดุงุก ุงูููุงูุงุช ุงููุงุฒูุฉ ูู AWX: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">AWX-configure.yaml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">--- - name: Create tower organization tower_organization: name: "scaling-org" description: "scaling-org organization" state: present - name: Add tower cloud credential tower_credential: name: cloud description: croc cloud api creds organization: scaling-org kind: aws state: present username: "{{ croc_user }}" password: "{{ croc_password }}" - name: Add tower github credential tower_credential: name: ghe organization: scaling-org kind: scm state: present username: "{{ ghe_user }}" password: "{{ ghe_password }}" - name: Add tower ssh credential tower_credential: name: ssh description: ssh creds organization: scaling-org kind: ssh state: present username: "ec2-user" ssh_key_data: "{{ lookup('file', 'private.key') }}" - name: Add tower project tower_project: name: "auto-scaling" scm_type: git scm_credential: ghe scm_url: &lt;repo-name&gt; organization: "scaling-org" scm_branch: master state: present - name: create inventory tower_inventory: name: dynamic-inventory organization: "scaling-org" state: present - name: copy inventory script to awx copy: src: "{{ role_path }}/files/ec2.py" dest: /root/ec2.py - name: create inventory source shell: | export SCRIPT=$(tower-cli inventory_script create -n "ec2-script" --organization "scaling-org" --script @/root/ec2.py | grep ec2 | awk '{print $1}') tower-cli inventory_source create --update-on-launch True --credential cloud --source custom --inventory dynamic-inventory -n "ec2-source" --source-script $SCRIPT --source-vars '{"EC2_URL":"api.cloud.croc.ru","AWS_REGION": "croc"}' --overwrite True - name: Create create-instance template tower_job_template: name: "create-instance" job_type: "run" inventory: "dynamic-inventory" credential: "cloud" project: "auto-scaling" playbook: "create-instance.yaml" state: "present" register: create_instance - name: Create update-lb template tower_job_template: name: "update-lb" job_type: "run" inventory: "dynamic-inventory" credential: "ssh" project: "auto-scaling" playbook: "update-lb.yaml" credential: "ssh" state: "present" register: update_lb - name: Create destroy-instance template tower_job_template: name: "destroy-instance" job_type: "run" inventory: "dynamic-inventory" project: "auto-scaling" credential: "cloud" playbook: "destroy-instance.yaml" credential: "ssh" state: "present" register: destroy_instance - name: create workflow tower_workflow_template: name: auto_scaling organization: scaling-org schema: "{{ lookup('template', 'schema.j2')}}" - name: set scheduling shell: | tower-cli schedule create -n "3min" --workflow "auto_scaling" --rrule "DTSTART:$(date +%Y%m%dT%H%M%SZ) RRULE:FREQ=MINUTELY;INTERVAL=3"</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุณููุดุฆ ุงูููุชุทู ุงูุณุงุจู ูููุฐุฌูุง ููู ูู ูุชุจ ุงููุนุจ ุงููุฑุฆูุฉ ุงููุณุชุฎุฏูุฉ.  ูููู ูู ูุงูุจ ุจุชูููู ุชุดุบูู playbook ูุน ูุฌููุนุฉ ูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูุงููุฎุฒูู ุงููุญุฏุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ุชูุฌูู ููููุงููุงุช ุฅูู playbooks ุณูู ูุณูุญ ูุงูุจ ุณูุฑ ุงูุนูู.  ูููุง ููู ุฅุนุฏุงุฏ ุณูุฑ ุงูุนูู ููุชุฑููุฒ ุงูุชููุงุฆู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">schema.j2</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">- failure_nodes: - id: 101 job_template: {{ destroy_instance.id }} success_nodes: - id: 102 job_template: {{ update_lb.id }} id: 103 job_template: {{ create_instance.id }} success_nodes: - id: 104 job_template: {{ update_lb.id }}</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุนุฑุถ ุงููุงูุจ ุงูุณุงุจู ูุฎุทุท ุณูุฑ ุงูุนูู ุ ุฃู  ุชุณูุณู ุชูููุฐ ุงููุงูุจ.  ูู ุณูุฑ ุงูุนูู ูุฐุง ุ ุณูุชู ุชูููุฐ ูู ุฎุทูุฉ ุชุงููุฉ (success_nodes) ููุท ุฅุฐุง ุชู ุฅููุงู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ ุจูุฌุงุญ.  ูุชู ุนุฑุถ ุชูุซูู ุฑุณููู ูุณูุฑ ุงูุนูู ูู ุงูุตูุฑุฉ: <br><img src="https://habrastorage.org/webt/po/l-/vb/pol-vbfpulv4hoimk99mvbtig-u.png" alt="ุณูุฑ ุงูุนูู"></p><br><p style=";text-align:right;direction:rtl">  ููุชูุฌุฉ ูุฐูู ุ ุชู ุฅูุดุงุก ุณูุฑ ุนูู ูุนูู ูููุฐ ูุชุงุจ ููุงุนุฏ ุฅูุดุงุก ู / ุฃู ุจูุงุกู ุนูู ุญุงูุฉ ุงูุชูููุฐ ููุชุจ ุงูุชุดุบูู ุงููุฏูุฑุฉ ู / ุฃู ุงูุชุญุฏูุซ - ุฑุทู.  ุณูุฑ ุงูุนูู ุงููุชูุงูู ููุงุณุจ ููุนูู ููู ุฌุฏูู ูุญุฏุฏ.  ุณุชุจุฏุฃ ุนูููุฉ ุงูููุงุณ ุงูุชููุงุฆู ูู ุซูุงุซ ุฏูุงุฆู ุ ุญูุซ ุชุจุฏุฃ ูุชูุชูู ุงูุญุงูุงุช ุญุณุจ ุญุงูุฉ ุงูุฅูุฐุงุฑ. </p><br><h3 id="testirovanie-raboty" style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑ ุงูุนูู </h3><br><p style=";text-align:right;direction:rtl">  ุชุญูู ุงูุขู ูู ุชุดุบูู ุงููุธุงู ุงูููููู.  ุฃููุงู ุ ูู ุจุชุซุจูุช ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ wrk ูููุงุณ http. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุซุจูุช wrk</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ssh -A ec2-user@&lt;aws_instance_ip&gt; sudo su - <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /opt yum groupinstall <span class="hljs-string"><span class="hljs-string">'Development Tools'</span></span> yum install -y openssl-devel git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/wg/wrk.git wrk <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> wrk make install wrk /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุณูุณุชุฎุฏู ุงููุฑุงูุจุฉ ุงูุณุญุงุจูุฉ ููุฑุงูุจุฉ ุงุณุชุฎุฏุงู ููุงุฑุฏ ุงููุซูู ุฃุซูุงุก ุงูุชุญููู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฑุงูุจุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">function CPUUtilizationMonitoring() { local AWS_CLI_PROFILE="&lt;aws_cli_profile&gt;" local CLOUDWATCH_URL="https://monitoring.cloud.croc.ru" local API_URL="https://api.cloud.croc.ru" local STATS="" local ALARM_STATUS="" local IDS=$(aws --profile $AWS_CLI_PROFILE --endpoint-url $API_URL ec2 describe-instances --filter Name=tag:role,Values=backend | grep -i instanceid | grep -oE 'i-[a-zA-Z0-9]*' | tr '\n' ' ') for instance_id in $IDS; do STATS="$STATS$(aws --profile $AWS_CLI_PROFILE --endpoint-url $CLOUDWATCH_URL cloudwatch get-metric-statistics --dimensions Name=InstanceId,Value=$instance_id --namespace "AWS/EC2" --metric CPUUtilization --end-time $(date --iso-8601=minutes) --start-time $(date -d "$(date --iso-8601=minutes) - 1 min" --iso-8601=minutes) --period 60 --statistics Average | grep -i average)"; ALARMS_STATUS="$ALARMS_STATUS$(aws --profile $AWS_CLI_PROFILE --endpoint-url $CLOUDWATCH_URL cloudwatch describe-alarms --alarm-names scaling-high-$instance_id | grep -i statevalue)" done echo $STATS | column -s ',' -o '|' -N $(echo $IDS | tr ' ' ',') -t echo $ALARMS_STATUS | column -s ',' -o '|' -N $(echo $IDS | tr ' ' ',') -t } export -f CPUUtilizationMonitoring watch -n 60 bash -c CPUUtilizationMonitoring</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุฃุฎุฐ ุงูุจุฑูุงูุฌ ุงููุตู ุงูุณุงุจู ูุฑุฉ ูู 60 ุซุงููุฉ ูุนูููุงุช ุญูู ูุชูุณุท โโูููุฉ ููุงุณ CPUUtilization ููุฏูููุฉ ุงูุฃุฎูุฑุฉ ููุณุชูุตู ุญุงูุฉ ุงูุฅูุฐุงุฑุงุช ููุซููุงุช ุงูุฎูููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุงูุขู ุชุดุบูู wrk ูุฅููุงุก ูุธุฑุฉ ุนูู ุงุณุชุฎุฏุงู ููุงุฑุฏ ูุซููุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ุชุญุช ุงูุญูู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุถ ุงููุฏู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ssh -A ec2-user@&lt;awx_instance_ip&gt; wrk -t12 -c100 -d500s http://&lt;haproxy_instance_id&gt; <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุณููุทูู ุงูุฃูุฑ ุงูุฃุฎูุฑ ุงููุนูุงุฑ ููุฏุฉ 500 ุซุงููุฉ ุ ุจุงุณุชุฎุฏุงู 12 ููุถูุนูุง ููุชุญ 100 ุงุชุตุงู HTTP. </p><br><p style=";text-align:right;direction:rtl">  ุจูุฑูุฑ ุงูููุช ุ ูุฌุจ ุฃู ูุธูุฑ ุงูุจุฑูุงูุฌ ุงููุตู ูููุฑุงูุจุฉ ุฃู ุงููููุฉ ุงูุฅุญุตุงุฆูุฉ ููููุงุณ CPUUtilization ุชุฒุฏุงุฏ ุฎูุงู ุงููุคุดุฑ ุญุชู ุชุตู ุฅูู 300ูช.  ุจุนุฏ 180 ุซุงููุฉ ูู ุจุฏุก ุงูุงุฎุชุจุงุฑ ุ ูุฌุจ ุฃู ุชุญูู ุฅุดุงุฑุฉ StateValue ุฅูู ุญุงูุฉ ุงูุฅูุฐุงุฑ.  ูุฑุฉ ูุงุญุฏุฉ ูู ุฏูููุชูู ุ ูุจุฏุฃ ุณูุฑ ุงูุนูู autoscaling.  ุงูุชุฑุงุถููุง ุ ูุญุธุฑ ุงูุชูููุฐ ุงููุชูุงุฒู ูุณูุฑ ุงูุนูู ููุณู.  ููุฐุง ูู ุ ูู ุฏูููุชูู ุ ุณุชุชู ุฅุถุงูุฉ ูููุฉ ูุชูููุฐ ุณูุฑ ุงูุนูู ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุณูุชู ุชุดุบูููุง ููุท ุจุนุฏ ุงูุงูุชูุงุก ูู ุณุงุจูุชูุง.  ูุจุงูุชุงูู ุ ุฃุซูุงุก ุนูู wrk ุ ุณุชููู ููุงู ุฒูุงุฏุฉ ูุณุชูุฑุฉ ูู ุงูููุงุฑุฏ ุญุชู ุชุฏุฎู ุงูุฅูุฐุงุฑุงุช ุงูุนุงููุฉ ูุฌููุน ุงูุญุงูุงุช ุงูุฎูููุฉ ุฅูู ุงูุญุงูุฉ "ููุงูู".  ุนูุฏ ุงูุงูุชูุงุก ุ ูููู ุณูุฑ ุนูู scale_down wrk ุจุฅููุงุก ุฌููุน ูุซููุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ุจุงุณุชุซูุงุก ุญุงูุชูู. </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุนูู ุฅุฎุฑุงุฌ ุงูุจุฑูุงูุฌ ุงููุตู ูููุฑุงูุจุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุชุงุฆุฌ ุงูุฑุตุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># start test i-43477460 |i-AC5D9EE0 "Average": 0.0 | "Average": 0.0 i-43477460 |i-AC5D9EE0 "StateValue": "ok"| "StateValue": "ok" # start http load i-43477460 |i-AC5D9EE0 "Average": 267.0 | "Average": 111.0 i-43477460 |i-AC5D9EE0 "StateValue": "ok"| "StateValue": "ok" # alarm state i-43477460 |i-AC5D9EE0 "Average": 267.0 | "Average": 282.0 i-43477460 |i-AC5D9EE0 "StateValue": "alarm"| "StateValue": "alarm" # two new instances created i-1E399860 |i-F307FB00 |i-43477460 |i-AC5D9EE0 "Average": 185.0 | "Average": 215.0 | "Average": 245.0 | i-1E399860 |i-F307FB00 |i-43477460 |i-AC5D9EE0 "StateValue": "insufficient_data"| "StateValue": "insufficient_data"| "StateValue": "alarm"| "StateValue": "alarm" # only two instances left after load has been stopped i-935BAB40 |i-AC5D9EE0 "Average": 0.0 | "Average": 0.0 i-935BAB40 |i-AC5D9EE0 "StateValue": "ok"| "StateValue": "ok"</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุฃูุถุง ูู CROC Cloud ุ ููููู ุนุฑุถ ุงูุฑุณูู ุงูุจูุงููุฉ ุงููุณุชุฎุฏูุฉ ูู ููุดูุฑ ุงููุฑุงูุจุฉ ูู ุตูุญุฉ ุงููุซูู ูู ุนูุงูุฉ ุงูุชุจููุจ ุงูููุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุนุฑุถ ุงูุฅูุฐุงุฑุงุช ูุชุงุญ ูู ุตูุญุฉ ุงููุฑุงูุจุฉ ูู ุนูุงูุฉ ุชุจููุจ ุงูุฅูุฐุงุฑุงุช. </p><br><h3 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h3><br><p style=";text-align:right;direction:rtl">  ูุนุฏ Autoscaling ุณููุงุฑูู ุดุงุฆุนูุง ุฅูู ุญุฏ ูุง ุ ููู ูุณูุก ุงูุญุธ ุ ููุณ ูู ุณุญุงุจุฉ ูุฏููุง ุญุชู ุงูุขู (ูููู ุงูุขู ููุท).  ููุน ุฐูู ุ ูุฏููุง ุงููุซูุฑ ูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููููุฉ ููููุงู ุจุฃุดูุงุก ููุงุซูุฉ ูุฃุดูุงุก ุฃุฎุฑู ูุซูุฑุฉ ุ ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ุดุงุฆุนุฉ ุ ุดุจู ููุงุณูุฉ ุ ูุซู Terraform ู ansible ู aws-cli ูุบูุฑูุง. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar456826/">https://habr.com/ru/post/ar456826/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar456812/index.html">ูุงุฐุง ููุฌุฏ ูู ุฌุงูุนุฉ ITMO - ููุฑุฌุงูุงุช ุชูููููุฌูุง ุงููุนูููุงุช ุ ุงููุงูุงุซูู ุ ุงููุคุชูุฑุงุช ูุงููุฏูุงุช ุงูููุชูุญุฉ</a></li>
<li><a href="../ar456814/index.html">ุชุนูู ุงูุจุฑูุฌุฉ ุงููุธูููุฉ ูู ุจูุซูู ูู 10 ุฏูุงุฆู</a></li>
<li><a href="../ar456818/index.html">ูุณุคูู ุงููุธุงู ูู ุดุฑูุฉ ูุง ูููู ูุจูููุง. ุนุจุก ูุง ูุทุงู ูู ูุฌุฑูุ</a></li>
<li><a href="../ar456820/index.html">ุงูุทูู โ ุงูุทูุจ โ ูููุฏ</a></li>
<li><a href="../ar456824/index.html">ูุง ูู ุงูุงุญุชูุงู ูููููุฉ ุญุณุงุจู</a></li>
<li><a href="../ar456828/index.html">ุถุจุท ููุงุณ ููุญุงุช ุงูุฏูุงุฆุฑ ุงููุทุจูุนุฉ</a></li>
<li><a href="../ar456830/index.html">ูููุงูุฏู 2.6 - ูุชุนุฉ ุงูุตูู</a></li>
<li><a href="../ar456836/index.html">ุงูุงุฎุชูุงุฑ: 5 ุฃุฏูุงุช ุชุญููู ุชูุงูุณูุฉ ุบูุฑ ูุงุถุญุฉ ูุฏ ูุง ุชููู ุนูู ุนูู ุจูุง</a></li>
<li><a href="../ar456838/index.html">ููุฏูุฉ ูู ุณุฌู ICE ูุชุญุฏูุฏ ุฃููููุงุช ููุฒุงุช ุงูููุชุฌ</a></li>
<li><a href="../ar456840/index.html">SDL 2 ุงูุฏุฑูุณ: ุงูุฏุฑุณ 6 - ุงูุจุฏุงุฆูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>