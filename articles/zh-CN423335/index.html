<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎹 🕊️ 🐴 如何以每月60万卢布的价格击败Y.Direct和AdWords中的点击 👇🏽 🌼 🖕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在过去的六个月中，我们以每月100万卢布的预算击败了上下文广告的“点击”。 

 打击欺诈的关键是每分钟对流量进行监控，并通过API进行异常更改通知和禁用有问题的公告，以及大量反映实时情况的报告。 


 图1.癸胺按关键字划分的访问者数量图表 

 您怎么知道自己受到攻击？ 
 广告“点击”的最早...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何以每月60万卢布的价格击败Y.Direct和AdWords中的点击</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423335/"> 在过去的六个月中，我们以每月100万卢布的预算击败了上下文广告的“点击”。 <br><br> 打击欺诈的关键是每分钟对流量进行监控，并通过API进行异常更改通知和禁用有问题的公告，以及大量反映实时情况的报告。 <br><br><img src="https://habrastorage.org/webt/ss/cg/tk/sscgtkndx4m1wahkipwk1ozgxwk.png"><br>  <font color="#7c8792">图1.癸胺按关键字划分的访问者数量图表</font> <br><br><h2>  <font color="#3e6c9a">您怎么知道自己受到攻击？</font> </h2><br>  <b>广告“点击”的最早迹象之一将是Yandex.Direct和AdWords中欺诈退款的百分比增加。</b> <br><blockquote>  “在Yandex Direct中，欺诈费用会自动退回到广告活动的余额中。 由反欺诈系统消除的点击次数显示在“整个选定期间的无效点击”行的“每日统计”，“一般统计”报告中。 </blockquote>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">帮助J.指导“无效点击”</a> 。 <br><br> 在AdWords中，可以在“列”标签上启用“无效点击”级别的显示： <br><br><img src="https://habrastorage.org/webt/kf/0y/sp/kf0ysp3nbfkov-ypcrfcc1sbmgw.png"><br>  <font color="#7c8792">图2. AdWords中具有“无效点击”级别的自定义列</font> <br><br> 在我们的案例中，Yandex.Direct的平均“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">无效点击</a> ”水平约为10％，因此，Yandex突然开始返还40％的广告预算，而一个月后，就返还了54％。 <br><a name="habracut"></a><br>  <b>欺诈的下一个迹象是，许多广告组的过渡次数不合理增加，并且行为指标发生了重大变化。</b> <br><br> 我们注意到，对于每天从未有超过200个访问者的许多关键字，突然出现了多达3,000个访问者的峰值。 实际上，在这种活动的日子里，如果预算广告没有按时停止，则可以将其用于一项广告活动。 <br><br><img src="https://habrastorage.org/webt/dy/dj/37/dydj375imemm0ytnqa6ttkesya8.png"><br>  <font color="#7c8792">图3. Direct中特定广告组的流量增长不合理</font> <br><br><h2>  <font color="#3e6c9a">Yandex和Google无法防范欺诈行为</font> </h2><br> 在官方Direct Club中阅读有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上下文广告</a>中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">欺诈级别</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">讨论</a>就足够了，以确保许多广告客户因欺诈而蒙受损失。 <br><br>  Google正式承认其安全系统的错误，并向广告客户提供“退款要求”（预算回报）。 根据ClickSease服务的统计信息，Google Ads平均返回广告预算的12％。 <br><br><div class="spoiler">  <b class="spoiler_title">如何通过AdWords的点击退还部分款项</b> <div class="spoiler_text"> 您必须向Adwords发送<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关“无效点击”</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">投诉</a> ，在此之后，您将获得≈12％的支出报销。 此外，ClickSease服务会每2个月自动向Google发送类似的退款请求。 <br><br> 在我们的案例中，Google AdWords首先将我们流量的18％识别为“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">无效</a> ”并退回了款项，当我们发送“退款要求”投诉时，Google又退还了预算的13％。 <br></div></div><br>  Yandex无法识别其自身的保护筛选器的脆弱性以及对明显欺诈案件的投诉，因此发送了模板响应，指出问题出在广告商及其网站上。 <br><br> 在我们的案例中，Y。Direct的报告中，任何广告系列的“无效点击”百分比都从未超过令人垂涎的50％，即使在最猛烈的爆发时期，当80％的预算“合并”到通常不受欢迎的广告组中而没有致电时和应用程序。 <br><br><img src="https://habrastorage.org/webt/6h/4u/ef/6h4uefov0nkyjh0n3wpuii9qb0q.png"><br>  <font color="#7c8792">图4. Direct中的一个广告系列中的“无效点击”级别</font> <br><br><h2>  <font color="#3e6c9a">我们遇到了什么级别的攻击？</font> </h2><br> 欺诈流量被定向到两个城市的四个业务线。 当连接新的广告活动或开始长期停止的活动时，在数小时内，“点击”也重新分配给了它们。 <br><br>  “点击欺诈”与时间无关，并且重新分配预算（例如在晚上）没有任何效果：我们仍然获得了剩余点击量。 在YAN，Yandex搜索和Google展示广告网络中，“点击”活动同样活跃。 <br><br> 在网站上，漫游器模拟用户的行为，浏览网站的各个部分，选择文本，自然地滚动并移动光标。 <br><br><h2>  <font color="#3e6c9a">有现成的补救措施吗？</font> </h2><br> 所有的点击欺诈防护服务都只有一种直接对抗工具-这将阻止Ya.Direct和AdWords广告系列中的可疑IP地址或展示位置。 <br><br> 如果使用动态IP来对付您，那么任何点击欺诈控制服务将始终比欺诈者更容易通过IP阻止它们：在该服务将该IP列入黑名单之前，该漫游器已经对您的广告进行了多次点击并停止在其上展示广告。 此外，在欺诈性软件看不到您的广告之后，它只会更改IP地址，硬件ID并继续其操作。 <br><br> 在GDN或YAN上攻击广告时，通常会使用各种展示位置，并且自动防护系统无法检测到可屏蔽的可屏蔽站点。 <br><br> 让我们回到IP封锁-这里是最有趣的部分：如果AdWords允许您封锁多达500个IP地址，那么<u>Yandex Direct</u>每个广告系列<u>只能封锁25个唯一IP地址</u> ！ 如此小的IP地址黑名单不再重要，因为现在您可以安全地以1万卢布的价格购买500个IPv4地址，并规避此限制。 <br><br> 有两种方法可以保护自己免受高层“点击”的影响： <br><br><ol><li> 学会不向欺诈用户或机器人展示广告，您需要针对其行为和特征寻找某些“模式”； <br></li><li> 暂时停止要定位的特定广告组和关键字。 <br></li></ol><br><h2>  <font color="#3e6c9a">减少部分观众以节省大部分</font> </h2><br> 如果您学会了不向漫游器或欺诈性用户展示点击广告，那么它们将不会受到伤害。 <br><br> 您可以始终跟踪类似的行为方式和模式，例如，欺诈行为通常在莫斯科的Windows 7上从5:00运行到9:00，并在所有受攻击的广告系列中为相似的受众群体将出价调整设置为-100％。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AdWords中</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">出价调整</a>功能非常广泛，而<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Yandex Direct中的调整功能</a>则无法说明。 <br><br><h3> 我们正在通过安全服务寻找欺诈行为的模式 </h3><br> 为了了解他们如何精确地攻击我们并手动跟踪欺诈性流量中的模式，我们连接了俄罗斯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ClickFrog</a>反欺诈<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">服务</a> 。 该产品早已为所有人所熟知，并在CPA环境中流行。 <br><br>  ClickFrog很快证明完全残疾： <br><br><ol><li> 每天分配的可疑IP地址不超过40个，每天来自Direct的流量为3,000万次点击，甚至被Yandex认可，每天还有1300次“左”点击； <br></li><li> 保护服务的主要工具是按IP地址阻止，有关该命令的命令是通过API发送给J.Direct的。但是，一旦填写了25个IP地址的黑名单，您就需要手动删除每个广告系列中的最后几个IP，并等待下一个列表被填充，并且所以围成一圈。 <br></li></ol><br> 然后，我们为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ClickSease</a>安装了代码， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ClickSease</a>是一种针对AdWords的美国服务，尚未与Yandex.Direct一起使用。 顺便说一下，与ClickFrog不同，该服务的免费试用期为2周。 <br><br> 事实证明，ClickSease更为有用：它每天开始捕获300-400个唯一的欺诈性IP。 为每个被阻止的IP服务提供统计信息： <br><br><ul><li> 互联网服务提供商 </li><li> 发生过渡的平台； </li><li> 作业系统 </li><li> 唯一的设备ID </li><li> 第一次和最后一次转换的时间； </li><li> 地区。 </li></ul><br> 从ClickSease报告中，我们能够识别欺诈行为的模式： <br><ul><li> 在81％的情况下，设备会模拟移动操作系统：Android或iOS； </li><li> 在59％的情况下，IP地址的地理位置不适用于莫斯科，而欺诈行为直接针对莫斯科。 </li></ul><br><h3> 手动寻找欺诈行为的模式 </h3><br> 但是，即使是这种明显的模式也不足以减少欺诈带来的危害，我也不想关闭移动广告。 服务通常只能提供识别欺诈中类似模式的想法，然后您需要在Metrica中发现欺诈（以防Direct受到攻击），然后在单独的Yandex Audience部分中将其选中，以进行进一步的分析和阻止。 <br><br><img src="https://habrastorage.org/webt/p3/op/ya/p3opya9dpzuhirhhz0_wfdeywf8.png"><br>  <font color="#7c8792">图5.在Metric中按年龄组进行流量分析以搜索欺诈模式的示例</font> <br><br> 流量切片以帮助识别欺诈模式： <br><ul><li> 按年龄段划分的受众动态； </li><li> 用户长期利益的动态； </li><li> 设备和操作系统动态。 </li></ul><br>  <b>对于AdWords，抵制机制很明确：</b> <br><br><ol><li> 我们定义了一个被欺诈“感染”的受众群体； </li><li> 我们将所选细分受众群的出价调整设置为-100％； </li><li> 我们监控指标的变化：转化，网站停留时间，浏览深度，跳出率。 </li></ol><br>  <b>在Yandex Direct中，斗争机制更加复杂，分为两种选择：</b> <br><br>  a）您设法找到与性别，年龄或流动性有关的明显欺诈模式： <br><br><ol><li> 我们将所选细分的出价调整设置为-50％或-100％； </li><li> 我们监控关键指标的变化。 </li></ol><br>  b）没有发现明显的模式： <br><br><ol><li> 我们在单独的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Yandex.Audience</a>细分中选择欺诈流量（例如，您知道从10月1日到10月20日，广告组的点击次数不能达到5,000，每天的访问量始终不超过30） </li><li> 通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">与Yandex相似，我们</a>创建了与欺诈行为相似的用户群； </li><li> 将手动创建的细分受众群的出价调整设置为-100％； </li><li> 我们仔细测试了Yandex创建的细分受众群广告费率的降低情况。 </li></ol><br><h2>  <font color="#3e6c9a">建立显示欺诈的图表</font> </h2><br>  <b>欺诈总是产生明显的焦点和高峰</b> ，无论它是模仿真实用户行为还是执行技术任务的自由职业者行为的抽象软件。 <br><br><img src="https://habrastorage.org/webt/go/o2/al/goo2alj10gtzlycltq5rje0hoji.png"><br>  <font color="#7c8792">图6.癸胺按关键字划分的访问者数量图表</font> <br><br> 欺诈不均的发生有几个原因： <br><ul><li> 要使攻击“顺利进行”，您需要掌握机密信息，并知道您的广告获得了谁，何时和多少次点击； </li><li> 该软件会突然出现，每分钟，10分钟，有时甚至在每小时图表上，它的动作都会引人注目； </li><li> 即使“学童”在公告板上对您不利，他们也会通过算法执行特定的任务，并且很容易跟踪他们产生的异常情况。 </li></ul><br> 如果您学会快速查找并消除病灶，则可以显着减少欺诈造成的危害。 在我们的案例中，一个明显的迹象是特定关键字在特定的10分钟或1分钟内上下文广告的点击次数异常增加。 <br><br> 对于可视化， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google Data Studio是</a>最合适的，因为只有Analytics（分析）才能正确收集1分钟和10分钟的时间细分数据，而Metrika在构建关于薄荷的报告时会给出错误的指示。 <br><br><div class="spoiler">  <b class="spoiler_title">如何在10分钟内（而不是每小时）在Google Data Studio中构建图表</b> <div class="spoiler_text"> 默认情况下，在Analytics（分析）或Data Studio中，您无法每分钟或10分钟构建图表，但是可以在Date Studio中按以下步骤进行操作： <br><br> 步骤1.打开字段编辑 <br><br><img src="https://habrastorage.org/webt/sy/y2/1v/syy21vr-evstitegmwu-ivqreh8.png"><br><br> 步骤2.创建以下字段的副本：年，年中的月份，月中的某天，小时，分钟，并为其命名，例如，年（天），年中的月（天）等。 同样，在复制的字段中，必须将“类型”从时间和日期格式更改为“数字”，如图所示。 <br><br><img src="https://habrastorage.org/webt/zj/3a/a6/zj3aa66qqh0eq42cyc-ajbujxzm.png"><br>  <font color="#7c8792">步骤2.，将复制字段的类型从“日期”更改为“数字”</font> <br><br> 步骤3.创建一个新字段，在其中写入以下公式：年（天）* 10000000 +月份（天）* 100000 +月份（天）* 1000 +小时（天）* 10 +地板（分钟（天）/ 10） <br><br><img src="https://habrastorage.org/webt/ud/mm/8o/udmm8oej5cb9ysefk3zpmka2rvs.png"><br>  <font color="#7c8792">步骤3.创建一个计算字段“ 10分钟的时间”</font> <br><br> 步骤4.保存创建的字段，然后返回所有字段的列表，并找到新字段“ Time for 10 minutes（decamenut）”。 如图所示，有必要将其类型从“数字”更改为“日期和时间”，然后将类型“数字”分配回该字段。 <br><br><img src="https://habrastorage.org/webt/7f/bi/hh/7fbihh4hc4yss02cqsfra1ljfta.png"><br>  <font color="#7c8792">步骤4.创建一个计算字段“ 10分钟的时间”</font> <br><br> 步骤5.创建一个“组合图表”，并将新的“ 10分钟的时间”字段设置为参数，如图所示。 做完了 <br><br><img src="https://habrastorage.org/webt/rq/o5/hy/rqo5hybxbnptkakzlyrs4rclzqu.png"><br>  <font color="#7c8792">步骤5.创建一个“组合图”</font> <br></div></div><br><br><h2>  <font color="#3e6c9a">配置有关欺诈爆发的通知</font> </h2><br> 为了不手动跟踪所有欺诈案件，我在Google表格中创建了一个报告，该报告每分钟更新一次数据并通知欺诈开始。 <br><br>  Google表格支持<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Core Reporting API</a> ，可以通过表格中的脚本编辑器进行访问。 <br><br> 步骤1.转到脚本编辑器以访问Analytics（分析） <br><br><img src="https://habrastorage.org/webt/fe/6t/r-/fe6tr-kjvklwxovqwutpmuvbvcc.png"><br>  <font color="#7c8792">图7.脚本编辑器，用于通过Google Tables访问Analytics Core Reporting API</font> <br><br> 第2步。我们向Google Analytics（分析）编写API请求，以接收有关必要指标的数据（例如，在我们的示例中，每天的每一分钟点击付费广告的用户数量）。 <br><br><div class="spoiler">  <b class="spoiler_title">Google脚本代码可从Google表格中的Google Analytics（分析）中请求任何数据</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runDemo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = getFirstProfile(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = getReportDataForProfile(firstProfile); outputToSpreadsheet(results); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { Browser.msgBox(error.message); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> accounts = Analytics.Management.Accounts.list(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (accounts.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstAccountId = accounts.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> webProperties = Analytics.Management.Webproperties.list(firstAccountId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (webProperties.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstWebPropertyId = webProperties.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = Analytics.Management.Profiles.list(firstAccountId, firstWebPropertyId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (profiles.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = profiles.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> firstProfile; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No views (profiles) found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No webproperties found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No accounts found.'</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReportDataForProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstProfile</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profileId = firstProfile.getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableId = <span class="hljs-string"><span class="hljs-string">'ga:'</span></span> + profileId; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startDate = <span class="hljs-string"><span class="hljs-string">"today"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// getLastNdays(14)  2 weeks (a fortnight) ago. var endDate = "today"; //getLastNdays(0)  Today. var optArgs = { 'dimensions': 'ga:date,ga:hour,ga:minute,ga:sourceMedium', // Comma separated list of dimensions. 'sort': 'ga:date,ga:hour,ga:minute', // Sort by sessions descending, then keyword. //'segment': 'dynamic::ga:isMobile==Yes', // Process only mobile traffic. 'filters': 'ga:sourceMedium==yandex / cpc', 'start-index': '1', 'max-results': '10000' // Display the first 250 results. }; // Make a request to the API. var results = Analytics.Data.Ga.get( tableId, // Table id (format ga:xxxxxx). startDate, // Start-date (format yyyy-MM-dd). endDate, // End-date (format yyyy-MM-dd). 'ga:users', // Comma seperated list of metrics. optArgs); if (results.getRows()) { return results; } else { throw new Error('No views (profiles) found'); } } function getLastNdays(nDaysAgo) { var today = new Date(); var before = new Date(); before.setDate(today.getDate() - nDaysAgo); return Utilities.formatDate(before, 'GMT', 'yyyy-MM-dd'); } function outputToSpreadsheet(results) { var sheets = SpreadsheetApp.getActiveSpreadsheet(); var sheet = sheets.getSheetByName("coeff1"); var range = sheet.getRange('A:E'); range.clear(); // Print the headers. var headerNames = []; for (var i = 0, header; header = results.getColumnHeaders()[i]; ++i) { headerNames.push(header.getName()); } sheet.getRange(1, 1, 1, headerNames.length) .setValues([headerNames]); // Print the rows of data. sheet.getRange(2, 1, results.getRows().length, headerNames.length) .setValues(results.getRows()); }</span></span></code> </pre> <br></div></div><br><br> 步骤3.我们将触发器设置为每分钟更新一次数据： <br><br><img src="https://habrastorage.org/webt/bu/-f/lq/bu-flq0ftubu0wa1lcqxw1uilz0.png"><br>  <font color="#7c8792">图8.我们每分钟都要求提供新数据以快速应对欺诈行为</font> <br><br> 第4步。我们从工作表中每分钟更新一次必要数据，以创建数据透视表，并分析这些指标以配置电子邮件通知触发器或使用Yandex.Direct API或AdWords禁用广告组。 <br><br><img src="https://habrastorage.org/webt/ha/ba/-g/haba-goptrqk9xjgxrge_wjqqjs.png" alt="图片">  <font color="#7c8792">图9.异常通知的设置公式示例</font> <br><br><div class="spoiler">  <b class="spoiler_title">我的Google脚本代码示例，用于发送电子邮件通知</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ss = SpreadsheetApp.getActiveSpreadsheet(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheet = ss.getSheetByName(<span class="hljs-string"><span class="hljs-string">"notification"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = sheet.getRange(<span class="hljs-string"><span class="hljs-string">"D2:E4"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// The row and column here are relative to the range // getCell(1,1) in this code returns the cell at B2, B2 var cell = range.getCell(1, 2); Logger.log(cell.getValue()); if (cell.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell.getValue(), "Check me "+range.getCell(1, 1).getValue()); } else { } var cell2 = range.getCell(2, 2); Logger.log(cell2.getValue()); if (cell2.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell2.getValue(), "Check me "+range.getCell(2, 1).getValue()); } else { } var cell3 = range.getCell(3, 2); Logger.log(cell3.getValue()); if (cell3.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell3.getValue(), "Check me "+range.getCell(3, 1).getValue()); } else { } }</span></span></code> </pre> <br></div></div><br><h2>  <font color="#3e6c9a">底线：如何消除点击</font> </h2><br> 打击点击欺诈可分为三类： <br><br>  a）积极行动： <br><ul><li> 关闭“污染场地”； </li><li> 禁止为您显示带有欺诈迹象的受众群体的广告，例如针对来自圣彼得堡的平板电脑上的用户的广告（可以通过AdWords列表和“指标”细分使用更复杂的屏蔽参数）； </li><li> 针对与欺诈细分受众群相似的细分受众群的出价调整（在Y. Audiences和Google列表中创建“相似”细分受众群）； </li><li> 通过IP网络掩码阻止欺诈（仅在AdWords中可用）。 </li></ul><br>  b）预防措施： <br><ul><li> 将预算退款报告给AdWords和Direct </li><li>  “谁下令攻击您”的调查； </li><li> 将可疑且经常受到攻击的广告组归为一个广告系列； </li><li> 最简单的机器人的“陷阱”，即站点上仅对机器人可见的隐藏按钮，单击该按钮将进入列表。 </li></ul><br>  c）“事后”行动： <br><ul><li> 通过IP地址阻止； </li><li> 点击中心快速断开连接：关键字，广告组，广告系列，细分受众群。 </li></ul><br><img src="https://habrastorage.org/webt/lh/kt/qu/lhktquoljkgpshxr78ig6mspa4q.png" alt="图片"><br>  <font color="#7c8792">图10.防止点击欺诈</font> <br><br>  <b>有用的链接：</b> <b><br></b> <br><ul><li> 核心报表API <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">库</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">查询浏览器</a> ，方便测试API命令； </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我们编写脚本来自动处理Google应用程序</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">自动化Google表格</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google Analytics（分析）智能部</a>向Google Analytics（分析）机器人询问：“但是，过去一年中付费流量是否有异常？”  -并获得明确答案。 </li></ul><br><div class="spoiler">  <b class="spoiler_title">如何找出谁下令对您的广告发起攻击</b> <div class="spoiler_text"> 任何适当的竞争对手在攻击他人时都将其伤害降至最低： <br><br><ol><li> 首先，攻击者将尽量不按照当前攻击的方向显示广告，以免合并其点击率并提高其每次点击费用； <br></li><li> 其次，不道德的竞争者会选择此类关键字进行攻击，据此，他可以停止展示自己的广告，而不会对自己造成太大伤害。 <br></li></ol><br> 在我们的案例中，竞争对手也开始在两个城市的四个方向上点击欺诈行为，因此计算起来并不难。 <br><br> 为了更轻松地分析与您相交的竞争对手，您可以在Yandex.Direct界面中看到每个关键字的所有随附竞争对手广告： <br><br><img src="https://habrastorage.org/webt/w2/_t/4p/w2_t4p4zpj0imyxdogo7saha0sg.png"><br>  <font color="#7c8792">图9.所有竞争对手的关键字广告</font> <br></div></div><br><br>  <b>谁还会面临上下文广告点击-在评论中写，我们将尽力互相帮助！</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN423335/">https://habr.com/ru/post/zh-CN423335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN423317/index.html">为什么选择Scala？</a></li>
<li><a href="../zh-CN423319/index.html">Vivaldi代码集成。 我们的开发人员告诉</a></li>
<li><a href="../zh-CN423321/index.html">保护GitHub存储库免受恶意提交</a></li>
<li><a href="../zh-CN423323/index.html">“您需要变得懒惰才能成为一名优秀的测试人员。”</a></li>
<li><a href="../zh-CN423329/index.html">准备接受五大公司的采访</a></li>
<li><a href="../zh-CN423337/index.html">如何交朋友通过Docker编译的PHPstorm，xDebug和远程分支？ 太简单了...</a></li>
<li><a href="../zh-CN423339/index.html">Windows 98下是否有生命，第一部分-关于硬件</a></li>
<li><a href="../zh-CN423341/index.html">在公众压力下，索尼承认巴赫的作品不属于她。</a></li>
<li><a href="../zh-CN423343/index.html">用塑料制成的文化价值开始衰退</a></li>
<li><a href="../zh-CN423345/index.html">恐惧的绞索</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>