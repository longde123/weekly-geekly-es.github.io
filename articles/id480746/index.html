<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍⚖️ 🧠 🍞 Preload di php 7.4: Komposer dan pilih file untuk preload 👎🏾 🤽 🐰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami di Badoo aktif beralih ke PHP 7.4 dan sangat antusias tentang peluang untuk menggunakan fungsi preload baru. Belum lama ini kami membicarakan eks...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Preload di php 7.4: Komposer dan pilih file untuk preload</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/480746/">  Kami di Badoo aktif beralih ke PHP 7.4 dan sangat antusias tentang peluang untuk menggunakan fungsi preload baru.  Belum lama ini kami <a href="https://habr.com/ru/company/badoo/blog/472528/">membicarakan</a> eksperimen kami dengannya. <br><br>  Tampaknya, komunitas sama bersemangatnya dengan kami.  Pengembang framework secara aktif <a href="https://github.com/laravel/ideas/issues/1406">mendiskusikan</a> kemungkinan memperkenalkan preload (dan beberapa telah <a href="https://symfony.com/blog/new-in-symfony-4-4-preloading-symfony-applications-in-php-7-4">membuat dukungannya</a> ).  Sekarang giliran manajer ketergantungan Composer. <br><br><img src="https://habrastorage.org/webt/t2/b9/bm/t2b9bmzxxtkxl00vu23lyoqwnd4.png"><br><br>  <a href="https://medium.com/%40DarkGhostHunter">Italo Baeza</a> menulis <a href="https://medium.com/swlh/composer-how-it-should-preload-in-php-7-4-3f8d19fda40">sebuah artikel</a> di mana dia menyatakan pendapatnya tentang bagaimana Composer harus bekerja dengan preload.  Saya memutuskan untuk membagikan terjemahan dari teks ini, dan pada saat yang sama terjemahan dari <a href="https://medium.com/swlh/preloading-your-php-7-4-project-in-one-line-9ede756f292c">artikelnya yang lain</a> , tentang bagaimana para pengembang Komposer sendiri menjawab proposal tersebut, serta tentang alat baru yang membuat bekerja dengan preload lebih mudah. <br><a name="habracut"></a><br><h2>  Bagaimana Komposer Harus Dimuat di PHP 7.4 </h2><br>  Preload adalah salah satu fitur penting yang ditawarkan PHP 7.4 kepada pengembang yang membutuhkan kinerja yang lebih baik.  Fungsi ini dapat disebut "pemanasan" sebelum menerapkan mesin JIT, yang akan muncul (atau akan muncul) di PHP 8. Sebelum itu, preloading akan cukup, dan siapa tahu, mungkin mereka dapat bekerja bersama-sama. <br><br>  Apa fungsi preload dijelaskan dalam <a href="https://stitcher.io/blog/preloading-in-php-74">artikel ini</a> .  Intinya sangat sederhana: php.ini menentukan skrip PHP yang ketika proses dimulai, file dimuat ke dalam memori (preload).  Dalam kombinasi dengan OPCache dan fungsi autoloader <a href="https://medium.com/tech-tajawal/php-composer-the-autoloader-d676a2f103aa">,</a> file Composer juga dapat dikompilasi dan ditautkan satu kali, setelah itu mereka akan tersedia untuk semua permintaan berikutnya.  Berkat ini, PHP tidak perlu mengunduh dan mengkompilasi file dengan setiap permintaan. <br><br>  Namun, pengembang Komposer tidak setuju tentang bagaimana seharusnya membantu preload, selain menyediakan fungsi startup.  Faktanya adalah sebagai berikut: <br><br><ul><li>  preloading pertama kali diumumkan dalam PHP 7.4; <br></li><li>  tidak ada arahan Komposer untuk membantu memuat file; <br></li><li>  untuk melakukan preload, Anda memerlukan akses ke php.ini, yaitu ke proses itu sendiri; <br></li><li>  preloading semua file tidak serta merta meningkatkan kinerja dibandingkan dengan preloading hanya file yang paling banyak diminta. <br></li></ul><br>  Dengan kata lain, hanya mereka yang memiliki akses penuh ke server yang dapat menggunakan preloading.  Ini tidak termasuk server bersama dan beberapa solusi PaaS yang tidak melibatkan bekerja dengan php.ini. <br><br>  Jadi, bagaimana Composer dapat membantu memuat sebelumnya mengingat ini adalah sebuah inovasi?  Ini pendapat saya. <br><br><h2>  Bagaimana preload seharusnya bekerja </h2><br>  Mekanisme untuk preloading harus didasarkan pada daftar file yang akan <i>dimuat</i> dan disimpan dalam memori saat startup.  Dan karena ini adalah daftar, kita perlu bekerja dengan berbagai file dan membiarkan Komposer melakukan semua pekerjaan, daripada <i>memuat</i> setiap file secara manual. <br><br>  Composer harus mengambil daftar file yang ditentukan oleh aplikasi (proyek root) dan mengkompilasi semuanya menjadi file yang dapat digunakan PHP tanpa kesulitan. <br>  Pada saat yang sama, kita membutuhkan kemampuan untuk menambah dan menghapus paket dari mekanisme preload. <br>  Preloading tidak boleh bekerja di tingkat paket, karena itu adalah tanggung jawab pengembang untuk mengaktifkan atau menonaktifkan preloading setiap paket. <br><br>  Preloading dalam Komposer harus opsional.  Pengembang harus dapat menonaktifkannya sehingga PHP menggunakan preloadernya sendiri, yang dapat bekerja berdasarkan analisis OPCache - tergantung pada beban aplikasi dan bekerja jauh lebih efisien daripada hanya preloading semua file. <br><br><h3>  Semuanya dimulai di preload.json </h3><br>  Agar tidak menyulitkan sistem, letakkan file preload.json di root proyek.  Ini akan mencantumkan file preload yang dapat dipilih oleh Composer.  Karena ini adalah file JSON, pengembang bahkan dapat membuatnya dengan bantuan perintah khusus.  Saya pikir akan bagus jika Komposer memiliki utilitas untuk membuat file JSON berbasis script. <br><br><pre><code class="php hljs">{ <span class="hljs-string"><span class="hljs-string">"pre-compile"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"my-script.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"my-other-script.php"</span></span> ], <span class="hljs-string"><span class="hljs-string">"extensions"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"php"</span></span> ], <span class="hljs-string"><span class="hljs-string">"files"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"app/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"config/"</span></span>, <span class="hljs-string"><span class="hljs-string">"helpers.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/Models/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/Controllers/*/Http/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/Views/Compiled*.php"</span></span> ], <span class="hljs-string"><span class="hljs-string">"namespace"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"App\\Models"</span></span>, <span class="hljs-string"><span class="hljs-string">"App\\Controllers\\"</span></span>, <span class="hljs-string"><span class="hljs-string">"App\\Views\\MainView"</span></span>, <span class="hljs-string"><span class="hljs-string">"Vendor\\Package\\*"</span></span>, ], <span class="hljs-string"><span class="hljs-string">"packages"</span></span>: { <span class="hljs-string"><span class="hljs-string">"symfony/http-client"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">"robert/*-client"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">"vendor/package"</span></span>: { <span class="hljs-string"><span class="hljs-string">"files"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">"namespace"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }, <span class="hljs-string"><span class="hljs-string">"foo/bar"</span></span>: { <span class="hljs-string"><span class="hljs-string">"files"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"helpers.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"loaders/*"</span></span> ], <span class="hljs-string"><span class="hljs-string">"namespace"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Foo\\Bar\\DynamicLoaders\\*"</span></span>, <span class="hljs-string"><span class="hljs-string">"Foo\\Bar\\Clients"</span></span> ] } }, <span class="hljs-string"><span class="hljs-string">"output"</span></span>: <span class="hljs-string"><span class="hljs-string">"preload-compiled.php"</span></span> }</code> </pre> <br>  Menggunakan preload.json memungkinkan Anda untuk dengan cepat memeriksa apakah preloading termasuk dalam proyek: jika file tersebut hilang, maka preloading tidak didukung atau tidak diinginkan. <br><br>  Mari kita lihat apa yang dilakukan kunci. <br><br>  <b>pra-kompilasi</b> <br><br>  File-file ini akan dieksekusi oleh Komposer.  Setiap skrip harus mengembalikan array jalur file absolut untuk menambahkannya ke daftar preload, yang akan memainkan peran daftar utama. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"pre-compile"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"my-script.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"my-other-script.php"</span></span> ]</code> </pre><br>  File-file ini akan dieksekusi dalam urutan yang ditentukan. <br><br>  Tujuannya adalah agar pengembang membuat daftar file yang menurutnya sesuai, daripada mengandalkan file JSON tunggal.  File-file ini akan dieksekusi terlebih dahulu.  Dan ya, Anda hanya dapat mengimplementasikan preload.json dengan kunci ini.  Karena kita berbicara tentang file PHP, ketika menyusun array, Anda bahkan dapat menambahkan file lain. <br><br>  <b>ekstensi</b> <br><br>  Ini adalah daftar ekstensi file yang harus dimuat sebelumnya.  Secara default, hanya file dengan ekstensi php yang diambil. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"extensions"</span></span>: [<span class="hljs-string"><span class="hljs-string">"php"</span></span>, <span class="hljs-string"><span class="hljs-string">"php5"</span></span>, <span class="hljs-string"><span class="hljs-string">"php7"</span></span>]</code> </pre> <br>  Misalnya, Anda dapat menambahkan direktori yang diisi dengan file * .phtml, termasuk beberapa file PHP yang berguna, dan Composer hanya akan memilihnya, dan bukan seluruh isi direktori. <br>  Seperti yang Anda pahami, proses ini dapat diganti dengan menambahkan file secara manual. <br><br>  <b>file</b> <br><br>  Kunci ini memberitahu Composer untuk mengunduh semua file dari daftar yang jalurnya relatif terhadap lokasi composer.json. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"files"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"helpers.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/Models/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/Controllers/*/Http/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/Views/Compiled*.php"</span></span>, ]</code> </pre><br>  Mengetahui daftar itu mudah: <br><br><ul><li>  gunakan jalur relatif untuk menambahkan file dan direktori; <br></li><li>  dari direktori hanya file anak yang disimpan di dalamnya yang akan ditambahkan (tidak secara rekursif); <br></li><li>  jalur rekursif ditandai dengan tanda bintang (*); <br></li><li>  menggunakan simbol ini Anda juga dapat, misalnya, menambahkan file dan direktori tertentu: <code>src/Clients/*/Stores</code> atau <code>src/Model*.php</code> . <br></li></ul><br>  Menambahkan file dengan mask tanpa memilih secara manual atau membuat skrip khusus aplikasi sangat berguna saat mengembangkan aplikasi besar. <br><br>  Jika Anda hanya perlu memuat semua file menggunakan <a href="">kunci autoload</a> di file JSON Composer, atur menjadi <code>true</code> . <br><br>  <b>namespace</b> <br><br>  Kunci ini memberitahu Composer untuk memuat file dengan namespace atau nama kelas yang diberikan seperti <code>file</code> atau <code>directory</code> .  Mekanisme yang sama memungkinkan Anda untuk memanggil nama ruang secara dinamis dari paket yang diinstal lainnya. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"namespaces"</span></span>: [   <span class="hljs-string"><span class="hljs-string">"App\\Models"</span></span>,   <span class="hljs-string"><span class="hljs-string">"App\\Controllers\\"</span></span>,   <span class="hljs-string"><span class="hljs-string">"App\\Views\\MainView"</span></span>,   <span class="hljs-string"><span class="hljs-string">"Vendor\\Package\\*"</span></span>, ]</code> </pre> <br>  Ini juga nyaman ketika bekerja pada aplikasi besar yang lebih bergantung pada ruang nama, daripada pada file yang dapat berubah kapan saja.  Composer akan secara otomatis mengekstrak file sesuai dengan namespace dan memasukkannya ke dalam daftar. <br><br>  <b>paket</b> <br><br>  Kunci ini memungkinkan Anda untuk memuat file lain yang terdaftar dari paket eksternal, seperti file tambahan atau kelas yang terkait dengan namespace. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"packages"</span></span>: {   <span class="hljs-string"><span class="hljs-string">"symfony/http-client"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,   <span class="hljs-string"><span class="hljs-string">"robert/*-client"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,   <span class="hljs-string"><span class="hljs-string">"vendor/package"</span></span>: {       <span class="hljs-string"><span class="hljs-string">"files"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,       <span class="hljs-string"><span class="hljs-string">"namespace"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>   },   <span class="hljs-string"><span class="hljs-string">"foo/bar"</span></span>: {       <span class="hljs-string"><span class="hljs-string">"files"</span></span>: {           <span class="hljs-string"><span class="hljs-string">"helpers.php"</span></span>,           <span class="hljs-string"><span class="hljs-string">"loaders/*"</span></span>       },       <span class="hljs-string"><span class="hljs-string">"namespace"</span></span>: [           <span class="hljs-string"><span class="hljs-string">"Foo\\Bar\\DynamicLoaders\\*"</span></span>,           <span class="hljs-string"><span class="hljs-string">"Foo\\Bar\\Clients"</span></span>       ]   } }</code> </pre> <br>  Semuanya sangat sederhana di sini: jika nilainya benar, maka seluruh isi <a href="">kunci autoload</a> dalam file composer.json dari paket ini akan dimuat.  Jika tidak, Anda dapat lebih mengontrol penambahan preload. <br><br>  Jika nilai kunci benar, maka itu akan mengunduh semua file yang terdaftar dalam <code>autoload</code> .  Nilai standarnya <code>false</code> .  Ini juga berlaku untuk kunci <code>namespace</code> . <br><br>  Anda juga dapat memilih file individu atau ruang nama dengan aturan ini.  Tetapi dalam kasus ini, kunci <code>autoload</code> tidak akan digunakan. <br><br>  <b>keluaran</b> <br><br>  Ini hanyalah nama file daftar preload yang dikompilasi. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"output"</span></span>: <span class="hljs-string"><span class="hljs-string">"preload-compiled.php"</span></span></code> </pre> <br><h3>  Perakitan mudah </h3><br>  Daftar pra-muat kami siap, dan kami dapat memanggil Komposer untuk mengkompilasi skrip pra-muat utama. <br><br><pre> <code class="php hljs">composer preload</code> </pre> <br>  Akibatnya, preload-compiled.php akan dibuat dengan semua file yang harus dimuat oleh PHP.  Tentu saja, Anda dapat mengubah nama file sesuai keinginan. <br><br>  Anda juga perlu mengganti kunci <code>preload</code> parameter. <br><br><pre> <code class="php hljs">composer preload \   --input=my-custom-preload-<span class="hljs-keyword"><span class="hljs-keyword">list</span></span>.json \   --output=my-preload.php</code> </pre> <br><h3>  Dinonaktifkan secara default </h3><br>  Proyek tanpa preload.json akan mengembalikan kesalahan jika Anda mencoba mengkompilasi file untuk preloading.  Alasannya adalah bahwa Komposer tidak akan (dan tidak seharusnya) menebak apa yang harus dimuat. <br><br>  Biarkan saya mengingatkan Anda bahwa preload tidak mengganggu fungsi Composer yang normal.  Karena ini adalah perintah konsol, dengan pengembangan lokal, Anda dapat sepenuhnya mengabaikan preloading.  Satu-satunya hal yang dibutuhkan mekanisme preload Composer adalah file Autoload, yang harus dihasilkan jika hilang.  Yah, setelah semua, hampir tahun 2020 di halaman, PSR-4 digunakan di mana-mana, kan? <br><br><h3>  Hasil </h3><br>  Anda harus mendapatkan file php dengan sesuatu seperti ini: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Preloading </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@generated</span></span></span><span class="hljs-comment"> by Composer */</span></span> <span class="hljs-comment"><span class="hljs-comment">// Autoload the classes so those can be preloaded using `require_once`. require_once __DIR__.'/../autoload.php'; // File list $files = [ '/var/www/app/Foo.php', '/var/www/app/Bar.php', '/var/www/helpers/basic.php', '/var/www/helpers/advanced.php', '/var/www/vendor/Foo/Bar/src/Class.php', '/var/www/vendor/Foo/Bar/helpers/helpers.php', '/var/www/vendor/Foo/Bar/config.php', // ... ]; // Preload all root project files foreach ($files as $file) { require_once $file; }</span></span></code> </pre> <br>  Bahkan, ini hanya daftar file yang akan dimuat menggunakan fungsi autoloader di Composer.  PHP akan mengeksekusi file ini sekali, dan itu akan menjadi sejarah. <br><hr><br>  Saya sangat berharap bahwa Komposer akan memiliki beberapa cara untuk memuat file tanpa harus menulis peretasan. <br><br>  Karena metode yang dijelaskan di atas bukan bagian dari kernel Komposer, Anda masih dapat memilih file yang paling penting untuk preloading berdasarkan analisis OPCache tanpa menyentuh yang kurang dibutuhkan.  Bayangkan bahwa alih-alih melakukan prapembuatan 1.500 file dengan kapasitas 100 MB, Anda dapat mengunduh hanya 150 file dengan kapasitas 10 MB, sambil mempertahankan 99% dari kinerja aslinya. <br><br><h2>  Kami memuat proyek PHP 7.4 dalam satu baris </h2><br>  Segera setelah saya menulis artikel tentang bagaimana Komposer dapat membantu Anda melakukan preload proyek, <a href="https://github.com/Seldaek">Seldaek</a> (anggota tim pengembangan Komposer) <a href="https://github.com/composer/composer/issues/7777">membunuh semua harapan</a> bahwa Komposer akan memiliki pilihan yang mudah untuk memuatkan proyek ke dalam proses PHP dari manajer paket. <br><br><blockquote>  (...) Saya akan menjelaskan: Saya yakin bahwa dalam waktu dekat kami tidak akan menambahkan apa pun yang terkait dengan prapembuatan ke Komposer. </blockquote><br>  Mengapa  Preloading dalam PHP lebih merupakan masalah pengembangan (bukan ketergantungan), diselesaikan dengan mengedit secara manual php.ini - hanya pengembang yang dapat melakukannya jika mereka sendiri yang mengelola PHP. <br><br>  Tetapi ini tidak menghentikan saya untuk membuat paket sendiri untuk melakukan preload proyek.  Dan kamu juga. <br><br><h2>  Preload dan Metrik </h2><br>  Preloading dapat menjadi alat yang baik untuk peningkatan produktivitas yang <a href="https://wiki.php.net/rfc/preload">sederhana dan murah</a> tanpa pemrosesan serius. <br><br>  Tapi masalahnya bukan <i>bagaimana melakukan</i> preload, tapi <i>apa</i> .  Preloading seluruh kerangka kerja dan ribuan file akan dengan cepat menghabiskan memori, sehingga melakukannya secara membabi buta bukanlah suatu pilihan, setidaknya dalam proyek-proyek besar.  Dianjurkan untuk hanya mengunduh file yang paling banyak diminta.  Tetapi bagaimana cara mendefinisikannya? <br><br>  Untungnya, OPCache memungkinkan <a href="https://www.php.net/manual/en/function.opcache-get-status.php">opcache_get_status ()</a> untuk mengumpulkan data tentang file mana yang paling banyak diakses.  Anda tidak hanya dapat mengetahui file mana yang paling diminati, tetapi bahkan berapa banyak memori yang mereka konsumsi beberapa saat setelah aplikasi dimulai. <br><br>  Dianjurkan untuk menunggu seminggu atau sampai saat OPCache mendaftarkan sejumlah hit.  Itu semua tergantung pada aplikasi, tetapi Anda mendapatkan intinya. <br>  Jadi mari kita buat daftar preload berdasarkan statistik dari file paling populer.  Saya membuat paket untuk ini. <br><br><h2>  Bayangkan ... Preloader! </h2><br>  Paket ini secara otomatis akan membuat daftar preload untuk aplikasi Anda.  Ini akan mengumpulkan statistik penggunaan OPCache, mengurutkan file dengan jumlah klik dan membuat daftar sehingga ukuran file total tidak melebihi ambang yang ditentukan. <br><br><img src="https://habrastorage.org/webt/sm/1b/vi/sm1bvipjlzifwjfc4evvvpaqaau.png"><br><br>  Saya bingung untuk waktu yang lama dalam mencari strategi terbaik untuk membuat daftar.  Dan saya sampai pada kesimpulan bahwa yang terbaik adalah menambahkan semua file ke dalamnya sampai Anda mengalami batas memori, yang untuk paket adalah 32 MB secara default.  File akan diurutkan berdasarkan jumlah klik, dan paket itu sendiri akan secara otomatis dikecualikan. <br><br>  Dengan kata lain, PHP akan meningkatkan kinerja aplikasi saat memproses sebagian besar permintaan. <br><br>  Dan bagaimana cara menggunakannya?  Beri tahu Pembuat Komposer tempat menulis skrip Prapuat, dan Anda selesai. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">DarkGhostHunter</span></span>\<span class="hljs-title"><span class="hljs-title">Preloader</span></span>\<span class="hljs-title"><span class="hljs-title">Preloader</span></span>; Preloader::make() -&gt;autoload(<span class="hljs-string"><span class="hljs-string">'vendor/autoload.php'</span></span>) -&gt;output(<span class="hljs-string"><span class="hljs-string">'preload.php'</span></span>) -&gt;generate();</code> </pre><br>  Tentu saja, Anda harus memilih kapan untuk menghasilkan, tetapi itulah intinya.  Anda bahkan dapat melakukan ini secara acak dan menulis ulang daftar, misalnya, untuk setiap permintaan ke-100. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">DarkGhostHunter</span></span>\<span class="hljs-title"><span class="hljs-title">Preloader</span></span>\<span class="hljs-title"><span class="hljs-title">Preloader</span></span>; Preloader::make() -&gt;whenOneIn(<span class="hljs-number"><span class="hljs-number">100</span></span>) -&gt;autoload(<span class="hljs-string"><span class="hljs-string">'vendor/autoload.php'</span></span>) -&gt;output(<span class="hljs-string"><span class="hljs-string">'preload.php'</span></span>) -&gt;overwrite() -&gt;generate();</code> </pre><br>  Anda akan mendapatkan skrip preload yang sudah jadi yang bisa Anda masukkan ke dalam php.ini. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * This file is generated automatically by Preloader. * * This script uses Composer Autoload file and `require_once` to preload the files in this * list. Add this file to your `php.ini` in `opcache.preload` to preload this list into * PHP at startup. Additionally, this file also includes information about Opcache. * * * Add (or update) this line in `php.ini`: * * opcache.preload=/www/app/vendor/preload.php * * --- Config --- * Generated at: 2019-11-20 15:20:49 UTC * Opcache * - Used Memory: 130585 B * - Free Memory: 294896 B * - Wasted Memory: 347764 B * - Cached files: 2675 * - Hit rate: 94% * - Misses: 542 * Preloader config * - Memory limit: 32 MB * - Overwrite: false * - Files excluded: 0 * - Files appended: 0 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> <span class="hljs-string"><span class="hljs-string">'/www/app/vendor/autoload.php'</span></span>; $files = [ <span class="hljs-string"><span class="hljs-string">'/www/app/ClassFoo.php'</span></span>, <span class="hljs-string"><span class="hljs-string">'/www/app/ClassBar.php'</span></span>, <span class="hljs-string"><span class="hljs-string">'/www/app/ClassBaz.php'</span></span>, <span class="hljs-string"><span class="hljs-string">'/www/app/ClassQuz.php'</span></span>, <span class="hljs-string"><span class="hljs-string">'/www/app/ClassQux.php'</span></span>, <span class="hljs-string"><span class="hljs-string">'/www/app/vendor/author/package/src/Example.php'</span></span>, <span class="hljs-comment"><span class="hljs-comment">// ... ]; foreach ($files as $file) { require_once $file; }</span></span></code> </pre><br>  Dan itu dia.  Cobalah sendiri: <a href="https://packagist.org/packages/darkghosthunter/preloader%3Fsource%3Dpost_page-----9ede756f292c----------------------">darkghosthunter / preloader - Packagist</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id480746/">https://habr.com/ru/post/id480746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id480734/index.html">Daripada TestMace lebih baik dari Postman</a></li>
<li><a href="../id480736/index.html">Mengapa tidak semua kesalahan perlu diperbaiki untuk membuat produk TI lebih baik</a></li>
<li><a href="../id480738/index.html">Pengalaman dalam menciptakan produk di Rusia atau Cara membuat penyedot debu nirkabel "rakyat" PRO-EXPERT</a></li>
<li><a href="../id480740/index.html">4 fitur Numpy keren yang saya gunakan terus-menerus</a></li>
<li><a href="../id480744/index.html">Bagaimana seorang programmer bisa melindungi proyek kesayangannya</a></li>
<li><a href="../id480748/index.html">Mengapa Anda membutuhkan begitu banyak pengembang?</a></li>
<li><a href="../id480752/index.html">ICANN menangguhkan penjualan zona domain .ORG</a></li>
<li><a href="../id480754/index.html">Manajemen kekacauan: bersihkan dengan perutean</a></li>
<li><a href="../id480756/index.html">Buka data. Roscosmos. Mari kita lakukan seperti di NASA</a></li>
<li><a href="../id480760/index.html">Bekerja di luar negeri: di negara mana Internet tercepat?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>