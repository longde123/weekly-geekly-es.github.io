<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⤵️ 🌦️ 📒 Bepergian Windows Defender dengan murah dan ceria: mengaburkan Mimikatz 👨🏻‍🎤 🍶 😮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Hari ini kami akan mempertimbangkan opsi untuk menjalankan mimikatz di Windows 10. Mimikatz adalah alat yang mengimplementasikan fungsi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bepergian Windows Defender dengan murah dan ceria: mengaburkan Mimikatz</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tomhunter/blog/454758/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/654/4e0/ef1/6544e0ef1426f38bf9111062ac398b49.jpg" alt="gambar"></div><br>  Halo semuanya.  Hari ini kami akan mempertimbangkan opsi untuk menjalankan mimikatz di Windows 10. Mimikatz adalah alat yang mengimplementasikan fungsionalitas Editor Kredensial Windows dan memungkinkan Anda untuk mengekstrak data otentikasi pengguna yang masuk ke sistem dalam bentuk terbuka. <br><br>  Selama pentest itu berguna untuk memiliki sesuatu yang membuang kata sandi pengguna, tetapi sekarang bahkan Windows Defender standar yang dibangun ke dalam Windows menjadi masalah dan dapat mengganggu rencana muluk kami. <br><br>  Saya perhatikan bahwa metode ini juga cocok untuk produk anti-virus lainnya (Virustotal SEBELUM dan SETELAH juga berpikir demikian), yang melakukan analisis statis biner dengan tanda tangan. <br>  Jadi, meskipun metode ini tidak mungkin membantu Anda melawan solusi EDR, metode ini dapat dengan mudah mengatasi Windows Defender. <br><br>  Sebelumnya, Anda bisa menyiasatinya dengan mengubah kata-kata dalam file dari mimikatz ke mimidogz, menghapus beberapa baris dalam metadata dan spanduk.  Sekarang menjadi lebih sulit, tetapi masih mungkin. <br><a name="habracut"></a><br>  Untuk ide dari semua tindakan ini saya ucapkan terima kasih kepada orang dengan julukan ippsec. <br><br>  Pada artikel ini kita akan menggunakan: <br><br><ul><li>  Windows 10 dengan Windows Defender diaktifkan (dengan basis data yang diperbarui) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mimikatz</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Studio visual</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HxD</a> (hex editor) </li></ul><br>  Menyalin mimikatz ke komputer korban, kita diharapkan melihat peringatan seperti itu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fef/45e/382/fef45e382ec0516c4d017fcd8c6a6382.jpg" alt="gambar"></div><br><br>  Selanjutnya, kami akan melakukan serangkaian manipulasi sehingga Defender tidak lagi melihat ancaman di sini. <br><br>  Pertama-tama, kita akan menemukan dan mengganti kata-kata mimikatz.  Ganti mimikatz misalnya dengan thunt (Anda dapat menggantinya dengan apa saja), dan MIMIKATZ dengan THUNT.  Itu terlihat seperti ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06d/d9d/3f9/06dd9d3f90d0be4fb6748ee962257939.jpg" alt="gambar"></div><br>  Selanjutnya, kita akan mengedit file mimikatz \ mimikatz \ mimikatz.rc di Visual Studio (yang setelah penggantian kita sekarang thunt.rc), mengganti mimikatz dan gentilkiwi dengan apa pun, kita juga tidak akan lupa untuk mengganti mimikatz.ico dengan ikon lainnya.  Klik "solusi rekondisi" (atau solusi rekondisi) dan dapatkan mimikatz versi terbaru kami.  Kami menyalin korban ke komputer, ii ... waspada.  Mari kita cari tahu untuk apa bek bekerja.  Cara termudah adalah menyalin biner dengan ukuran yang berbeda sebelum operasi antivirus yang pertama. <br><br>  Pertama, salin setengah dan salin ke mesin Windows 10. <br><br><pre><code class="bash hljs">head –c 600000 mimikatz.exe &gt; hunt.exe</code> </pre> <br>  Bek diam, sudah tidak buruk.  Bereksperimen, kami menemukan operasi pertama.  Ini terlihat seperti ini untuk saya: <br><br><pre> <code class="plaintext hljs">head -c 900000 mimikatz.exe &gt; hunt.exe –   head -c 950000 mimikatz.exe &gt; hunt.exe –  head -c 920000 mimikatz.exe &gt; hunt.exe –   head -c 930000 mimikatz.exe &gt; hunt.exe –   head -c 940000 mimikatz.exe &gt; hunt.exe –  head -c 935000 mimikatz.exe &gt; hunt.exe –   head -c 937000 mimikatz.exe &gt; hunt.exe –  head -c 936000 mimikatz.exe &gt; hunt.exe –   head -c 936500 mimikatz.exe &gt; hunt.exe –  head -c 936400 mimikatz.exe &gt; hunt.exe –  head -c 936300 mimikatz.exe &gt; hunt.exe –  head -c 936200 mimikatz.exe &gt; hunt.exe –  </code> </pre> <br>  Buka hunt.exe di hex editor dan lihat seperti apa bek itu bekerja.  Mata menangkap tali KiwiAndRegistryTools. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/056/977/94b/05697794b81a7d4423c20f8576b9d68c.jpg" alt="gambar"><br><br>  Mari bermain dengan caps acak - ini menjadi KiWIAnDReGiSTrYToOlS, simpan dan salin.  Diam, yang artinya kita menebak dengan benar.  Sekarang kita akan menemukan semua kemunculan dari baris-baris ini dalam kode, mengganti dan membangun kembali proyek kita.  Untuk memeriksa, jalankan head -c 936300 mimikatz.exe&gt; ​​hunt.exe.  Terakhir kali Pembela bekerja, sekarang tidak.  Pindah. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/023/8e4/017/0238e401735da0efcc4e751033f2542c.jpg" alt="gambar"></div><br>  Sedemikian rumitnya, menambahkan lebih banyak baris ke hunt.exe kami, kata-kata pemicu ditemukan - wdigest.dll, isBase64InterceptOutput, isBase64InterceptInput, multirdp, logonPasswords, credman.  Mengganti mereka dengan topi acak, saya memastikan bahwa Defender berhenti memaki mereka. <br>  Tapi itu tidak mudah, pikir Defender dan bekerja untuk fungsi-fungsi yang diimpor dan case-sensitive.  Ini adalah fungsi yang dipanggil dari pustaka netapi32.dll. <br><br><ul><li>  I_NetServerAuthenticate2 </li><li>  I_NetServerReqChallenge </li><li>  I_NetServerTrustPasswordsDapatkan </li></ul><br>  Jika kita melihat netapi32.dll (C: \ windows \ system32 \ netapi32.dll), kita akan melihat bahwa setiap fungsi diberi nomor. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9d/a63/057/b9da6305790eca73f118bd026615e538.jpg" alt="gambar"><br><br>  Ubah panggilan fungsi dari formulir <br>  windows.netapi32.I_NetServerTrustPasswordsDapatkan (args) <br>  pada <br>  windows.netapi32 [62] (args) <br>  Untuk melakukan ini, kita perlu mengganti mimikatz \ lib \ x64 \ netapi32.min.lib.  Buat file netapi32.def dan tulis baris berikut di sana: <br><br><pre> <code class="plaintext hljs">LIBRARY netapi32.dll EXPORTS I_NetServerAuthenticate2 @ 59 I_NetServerReqChallenge @ 65 I_NetServerTrustPasswordsGet @ 62</code> </pre> <br>  Kami menyimpan dan menjalankan perintah (jangan lupa untuk membuat cadangan netapi32.min.lib yang asli untuk berjaga-jaga) <br><br><pre> <code class="bash hljs">lib /DEF:netapi32.def /OUT:netapi32.min.lib</code> </pre> <br>  Sekali lagi, kami akan membangun kembali proyek dan menyalin apa yang kami dapatkan.  Bek diam.  Jalankan mimikatz yang dihasilkan dengan hak administrator. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e9d/de3/bf1/e9dde3bf1406d3def0d55dae31481157.jpg" alt="gambar"><br><br>  Sukses  Dengan demikian, mimikatz diluncurkan dan Windows Defender tidak berfungsi, itulah yang kami tuju.  Kata sandi, penampilan, dan hash dikeluarkan. <br><br>  <b>Perangkap</b> <br><br>  Menunggu: <br><br><pre> <code class="plaintext hljs">* Username : thunt * Domain : DESKTOP-JJRBJJA * Password : Xp3#2!^&amp;qrizc</code> </pre> <br>  Realitas: <br><br><pre> <code class="plaintext hljs">* Username : thunt * Domain : DESKTOP-JJRBJJA * Password : (null)</code> </pre> <br>  Situasi dalam kehidupan agak berbeda dari kondisi laboratorium.  Anda mungkin perlu bekerja dengan registri untuk melihat kata sandi.  Misalnya, aktifkan atau buat kunci UseLogonCredential (HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ SecurityProviders \ WDigest).  Tetapi mungkin ada masalah dengan ini, seperti  saat me-reboot, kunci dapat diatur kembali. <br><br>  Ini bisa menjadi lebih buruk jika, jika Anda menjalankan di salah satu versi terbaru Windows 10, daripada kata sandi dalam teks biasa Anda akan melihat ini: <br><br><pre> <code class="plaintext hljs">* Password : _TBAL_{68EDDCF5-0AEB-4C28-A770-AF5302ECA3C9}</code> </pre> <br>  Ini semua tentang TBAL, yang merupakan penerus Sign-On Restart Otomatis ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ARSO</a> ).  Sekarang, ketika TBAL diminta, lsasrv memeriksa apakah akun itu akun lokal atau MS, dan, berdasarkan ini, menggunakan msv1_0 atau cloudAP untuk menyimpan semua yang diperlukan untuk melanjutkan sesi pengguna.  Setelah itu, mekanisme autologon diatur ke kata sandi hard-code _TBAL_ {68EDDCF5-0AEB-4C28-A770-AF5302ECA3C9}. <br><br>  Namun demikian, di laboratorium kami menerima kata sandi pengguna, dan dalam situasi pertempuran, setidaknya kami bisa mendapatkan hash. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id454758/">https://habr.com/ru/post/id454758/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id454744/index.html">Tinjauan Java Track Reports dari RigaDevDays Conference</a></li>
<li><a href="../id454748/index.html">Panduan Kelangsungan Hidup MongoDB</a></li>
<li><a href="../id454750/index.html">UI cepat - berlari kencang di seluruh Eropa</a></li>
<li><a href="../id454754/index.html">Kapan perlu memeriksa hipotesis efektivitas yang tidak kalah pentingnya?</a></li>
<li><a href="../id454756/index.html">Memeriksa efektivitas pengaturan situs dan iklan, biaya menarik pelanggan dari perusahaan grosir</a></li>
<li><a href="../id454760/index.html">Intel Optane Memory M15 - Lebih Cepat Dari M10</a></li>
<li><a href="../id454766/index.html">HBO, terima kasih telah mengingatkan saya ... "Kit pertolongan pertama Chernobyl" dari seorang apoteker Belarusia</a></li>
<li><a href="../id454770/index.html">Keanggotaan Samsung Startup - program baru untuk startup di Rusia</a></li>
<li><a href="../id454774/index.html">Kami menulis kode yang paling berguna dalam hidup kami, tetapi membuangnya ke tempat sampah. Bersama kami</a></li>
<li><a href="../id454776/index.html">Freelance atau kantor? Tanggapan Freelancer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>