<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>  ご Intuitivo RL (aprendizaje de refuerzo): Introducci贸n a Advantage-Actor-Critic (A2C)  锔 ィ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! Les traigo a su atenci贸n una traducci贸n del art铆culo de Rudy Gilman y Katherine Wang RL intuitiva: Introducci贸n a Advantage-Actor-Critic (A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Intuitivo RL (aprendizaje de refuerzo): Introducci贸n a Advantage-Actor-Critic (A2C)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442522/"><p>  Hola Habr!  Les traigo a su atenci贸n una traducci贸n del art铆culo de Rudy Gilman y Katherine Wang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RL intuitiva: Introducci贸n a Advantage-Actor-Critic (A2C)</a> . </p><img vspace="10" src="https://habrastorage.org/webt/_g/tr/gc/_gtrgckvsc0pemxqwe4iv6sxzsu.png"><p>  Los especialistas en aprendizaje reforzado (RL) han producido muchos tutoriales excelentes.  Sin embargo, la mayor铆a describe RL en t茅rminos de ecuaciones matem谩ticas y diagramas abstractos.  Nos gusta pensar sobre el tema desde una perspectiva diferente.  El RL en s铆 mismo est谩 inspirado en c贸mo aprenden los animales, entonces, 驴por qu茅 no traducir el mecanismo de RL subyacente nuevamente en fen贸menos naturales que se pretende simular?  La gente aprende mejor a trav茅s de las historias. </p><br><p>  Esta es la historia del modelo Actor Advantage Critic (A2C).  El modelo de sujeto cr铆tico es una forma popular del modelo Policy Gradient, que en s铆 mismo es un algoritmo RL tradicional.  Si entiendes A2C, entiendes RL profundo. </p><br><a name="habracut"></a><p>  Despu茅s de obtener una comprensi贸n intuitiva de A2C, verifique: </p><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Nuestra implementaci贸n simple</a> del c贸digo A2C (para capacitaci贸n) o nuestra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">versi贸n</a> industrial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de PyTorch</a> basada en el modelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenAI TensorFlow Baselines</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Una introducci贸n a RL por Barto &amp; Sutton</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el curso can贸nico de David Silver</a> , una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">revisi贸n de Yusi Lee</a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">repositorio de Denny Brits en GitHub</a> para una inmersi贸n profunda en RL; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El incre铆ble curso fast.ai</a> para una cobertura intuitiva y pr谩ctica del aprendizaje profundo en general, implementado en PyTorch; </li><li>  Tutoriales de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Arthur Giuliani</a> RL implementados en TensorFlow. </li></ul><p>  Ilustraciones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@embermarke</a> </p><br><p>  En RL, el agente, el zorro Klyukovka, se mueve a trav茅s de estados rodeados de acciones, tratando de maximizar las recompensas en el camino. </p><img vspace="10" src="https://habrastorage.org/webt/8y/wv/jb/8ywvjb4hyom44rjn5c-nynakjua.png"><p>  A2C recibe entradas de estado - entradas de sensor en el caso de Klukovka - y genera dos salidas: <br>  1) Una evaluaci贸n de cu谩nta remuneraci贸n se recibir谩, a partir del momento del estado actual, con la excepci贸n de la remuneraci贸n actual (existente). <br>  2) Una recomendaci贸n sobre qu茅 medidas tomar (pol铆tica). <br><br>  Cr铆tico: wow, qu茅 maravilloso valle!  隆Ser谩 un d铆a fruct铆fero para buscar comida!  Apuesto a que hoy recoger茅 20 puntos antes del atardecer. <br>  "Sujeto": estas flores se ven hermosas, siento un antojo por "A". </p><img vspace="10" src="https://habrastorage.org/webt/gf/_x/wf/gf_xwfrsu-z-64k9ijhxyakmoks.png"><p>  Los modelos Deep RL son m谩quinas de mapeo de entrada-salida, como cualquier otro modelo de clasificaci贸n o regresi贸n.  En lugar de categorizar im谩genes o texto, los modelos RL profundos traen estados a acciones y / o estados a valores de estado.  A2C hace las dos cosas. </p><img vspace="10" src="https://habrastorage.org/webt/cb/vv/st/cbvvstverqhmym9qtsnbpptrrwc.png"><img vspace="10" src="https://habrastorage.org/webt/cq/0a/hj/cq0ahjxh9khnmukf2fnivdfsify.png"><p>  Este conjunto de recompensa de acci贸n estatal es una observaci贸n.  Ella escribir谩 esta l铆nea de datos en su diario, pero todav铆a no va a pensar en ello.  Ella lo llenar谩 cuando se detenga a pensar. <br><br>  Algunos autores asocian la recompensa 1 con el tiempo paso 1, otros la asocian con el paso 2, pero todos tienen en cuenta el mismo concepto: la recompensa est谩 asociada con el estado y la acci贸n la precede inmediatamente. </p><img vspace="10" src="https://habrastorage.org/webt/ht/gj/vw/htgjvw00nace9trmp4ggdse9j_g.png"><p>  Enganchar repite el proceso nuevamente.  Primero, percibe su entorno y desarrolla una funci贸n V (S) y una recomendaci贸n para la acci贸n. <br><br>  Cr铆tico: Este valle parece bastante est谩ndar.  V (S) = 19. <br>  Asunto: Las opciones de acci贸n son muy similares.  Creo que simplemente ir茅 por la pista "C". </p><img vspace="10" src="https://habrastorage.org/webt/al/eo/oy/aleooy4igiqksso14znacoxewjq.png"><p>  Entonces act煤a. </p><img vspace="10" src="https://habrastorage.org/webt/qd/kz/1y/qdkz1y1xfopu075_7yhhqtzmdkm.png"><p>  隆Recibe una recompensa de +20!  Y registra la observaci贸n. </p><img vspace="10" src="https://habrastorage.org/webt/kg/gs/-v/kggs-vsqtnvt1pos-jf9yurnl_w.png"><p>  Ella repite el proceso nuevamente. </p><img vspace="10" src="https://habrastorage.org/webt/wy/sp/d8/wyspd8yva6igzeeg29bw5x4lfdo.png"><p>  Despu茅s de recoger tres observaciones, Klyukovka se detiene a pensar. <br><br>  Otras familias modelo esperan hasta el final del d铆a (Monte Carlo), mientras que otras piensan despu茅s de cada paso (un paso). <br>  Antes de que pueda configurar su cr铆tico interno, Klukovka necesita calcular cu谩ntos puntos recibir谩 realmente en cada estado. <br><br>  Pero primero! <br>  Veamos c贸mo la prima de Klukovka, Lis Monte Carlo, calcula el verdadero significado de cada estado. <br><br>  Los modelos de Monte Carlo no reflejan su experiencia hasta el final del juego, y dado que el valor del 煤ltimo estado es cero, es muy simple encontrar el verdadero valor de este estado anterior como la suma de las recompensas recibidas despu茅s de este momento. </p><img vspace="10" src="https://habrastorage.org/webt/xb/4m/g9/xb4mg9-occctbf6y-ixw-yhlohu.png"><p>  De hecho, esta es solo una muestra de alta dispersi贸n V (S).  El agente podr铆a seguir f谩cilmente una trayectoria diferente desde el mismo estado, recibiendo as铆 una recompensa agregada diferente. </p><br><p>  Pero Klyukovka se va, se detiene y reflexiona muchas veces hasta que el d铆a llega a su fin.  Ella quiere saber cu谩ntos puntos obtendr谩 realmente de cada estado hasta el final del juego, porque quedan varias horas hasta el final del juego. <br><br>  Ah铆 es donde hace algo realmente inteligente: la zorra Klyukovka estima cu谩ntos puntos recibir谩 por el 煤ltimo estado en este set.  Afortunadamente, tiene una evaluaci贸n correcta de su condici贸n: su cr铆tica. <br>  Con esta evaluaci贸n, Klyukovka puede calcular los valores "correctos" de los estados anteriores exactamente como lo hace el zorro de Monte Carlo. <br><br>  Lis Monte Carlo eval煤a las marcas de destino, realiza el despliegue de la trayectoria y agrega recompensas hacia adelante desde cada estado.  A2C corta esta trayectoria y la reemplaza con una evaluaci贸n de su cr铆tico.  Esta carga inicial reduce la varianza de la puntuaci贸n y permite que el A2C se ejecute continuamente, aunque introduciendo un peque帽o sesgo. </p><img vspace="10" src="https://habrastorage.org/webt/cw/7f/jo/cw7fjo1fqmzudzpagzrp5yqsuye.png"><p>  Las recompensas a menudo se reducen para reflejar el hecho de que la remuneraci贸n ahora es mejor que en el futuro.  Por simplicidad, Klukovka no reduce sus recompensas. </p><img vspace="10" src="https://habrastorage.org/webt/xn/2b/49/xn2b49qlafvhtjjjxd-buohiafs.png"><p>  Klukovka ahora puede pasar por cada fila de datos y comparar sus estimaciones de valores de estado con sus valores reales.  Ella usa la diferencia entre estos n煤meros para perfeccionar sus habilidades de predicci贸n.  Cada tres pasos durante el d铆a, Klyukovka recopila una valiosa experiencia que vale la pena considerar. <br><br>  Califiqu茅 mal los estados 1 y 2. 驴Qu茅 hice mal?  Si!  La pr贸xima vez que vea plumas como estas, aumentar茅 V (S). <br><br>  Puede parecer una locura que Klukovka pueda usar su calificaci贸n V (S) como base para compararlo con otros pron贸sticos.  隆Pero los animales (incluidos nosotros) hacen esto todo el tiempo!  Si siente que las cosas van bien, no necesita volver a capacitar las acciones que lo llevaron a este estado. </p><img vspace="10" src="https://habrastorage.org/webt/lg/qz/to/lgqztow-bkbik5suijbm_ix4bte.png"><p>  Al recortar nuestros resultados calculados y reemplazarlos con una estimaci贸n de carga inicial, reemplazamos la gran variaci贸n de Monte Carlo con un peque帽o sesgo.  Los modelos RL suelen sufrir una alta dispersi贸n (que representa todos los caminos posibles), y tal reemplazo generalmente vale la pena. </p><br><p>  Klukovka repite este proceso todo el d铆a, recogiendo tres observaciones de estado-acci贸n-recompensa y reflexionando sobre ellas. </p><img vspace="10" src="https://habrastorage.org/webt/ia/d8/r2/iad8r2v24aklliudj27dnsggaek.png"><p>  Cada conjunto de tres observaciones es una peque帽a serie autocorrelacionada de datos de entrenamiento etiquetados.  Para reducir esta autocorrelaci贸n, muchas A2C capacitan a muchos agentes en paralelo, sumando su experiencia antes de enviarla a una red neuronal com煤n. </p><img vspace="10" src="https://habrastorage.org/webt/4w/qx/rd/4wqxrd2ilmgr1cjvzpymeou4dvk.png"><p>  El d铆a finalmente est谩 llegando a su fin.  Solo quedan dos pasos. <br>  Como dijimos anteriormente, las recomendaciones de las acciones de Klukovka se expresan en porcentaje de confianza sobre sus capacidades.  En lugar de simplemente elegir la opci贸n m谩s confiable, Klukovka elige de esta distribuci贸n de acciones.  Esto asegura que ella no siempre acepta acciones seguras, pero potencialmente mediocres. </p><br><p>  Podr铆a arrepentirme, pero ... A veces, explorando cosas desconocidas, puedes llegar a nuevos descubrimientos emocionantes ... </p><img vspace="10" src="https://habrastorage.org/webt/bd/w1/mq/bdw1mqtm96hfbvp6suy7ftdliec.png"><p>  Para alentar a煤n m谩s la investigaci贸n, un valor llamado entrop铆a se resta de la funci贸n de p茅rdida.  Entrop铆a significa el "alcance" de la distribuci贸n de acciones. <br>  - 隆Parece que el juego ha valido la pena! <br></p><img vspace="10" src="https://habrastorage.org/webt/nu/u1/tr/nuu1tr5-gopjruyry7z3qph7wfk.png"><p>  O no? <br><br>  A veces, el agente se encuentra en un estado donde todas las acciones conducen a resultados negativos.  A2C, sin embargo, hace frente a situaciones malas. </p><img vspace="10" src="https://habrastorage.org/webt/3w/kq/tn/3wkqtngcomlmylol0jdj79u6wfc.png"><img vspace="10" src="https://habrastorage.org/webt/va/9x/x6/va9xx61axwvy7lio5lgtyvcftzw.png"><p>  Cuando se puso el sol, Klyukovka reflexion贸 sobre el 煤ltimo conjunto de soluciones. </p><img vspace="10" src="https://habrastorage.org/webt/ql/k0/sw/qlk0sw5tngzheqw6t5obdw_p_mw.png"><p>  Hablamos sobre c贸mo Klyukovka configura su cr铆tico interno.  Pero, 驴c贸mo afina su "sujeto" interior?  驴C贸mo aprende a tomar decisiones tan exquisitas? </p><br><p>  La pol铆tica de gradiente de zorro de mente simple mirar铆a los ingresos reales despu茅s de la acci贸n y ajustar铆a su pol铆tica para hacer que los buenos ingresos sean m谩s probables: - Parece que mi pol铆tica en este estado condujo a una p茅rdida de 20 puntos, creo que en el futuro es mejor hacer "C" menos probable <br><br>  - Pero espera!  Es injusto culpar a la acci贸n "C".  Este estado ten铆a un valor estimado de -100, por lo que elegir "C" y terminar con -20 fue en realidad una mejora relativa de 80.  Tengo que hacer que "C" sea m谩s probable en el futuro. <br><br>  En lugar de ajustar su pol铆tica en respuesta a los ingresos totales que recibi贸 al seleccionar la acci贸n C, sintoniza su acci贸n con los ingresos relativos de la acci贸n C. Esto se denomina "ventaja". </p><img vspace="10" src="https://habrastorage.org/webt/tl/l6/zq/tll6zqru_0k4izo07o3gyutrsdi.png"><p>  Lo que llamamos una ventaja es simplemente un error.  Como ventaja, Klukovka lo usa para hacer actividades que fueron sorprendentemente buenas, m谩s probables.  Como error, ella usa la misma cantidad para presionar a su cr铆tico interno a mejorar su evaluaci贸n del valor del estado. <br><br>  El sujeto aprovecha: <br>  - "Wow, eso funcion贸 mejor de lo que pensaba, la acci贸n C debe ser una buena idea". <br>  El cr铆tico usa el error: <br>  驴Pero por qu茅 me sorprendi贸?  Probablemente no deber铆a haber evaluado esta condici贸n tan negativamente ". <br><br>  Ahora podemos mostrar c贸mo se calculan las p茅rdidas totales: minimizamos esta funci贸n para mejorar nuestro modelo. <br>  "P茅rdida total = p茅rdida de acci贸n + p茅rdida de valor - entrop铆a" <br><br>  Tenga en cuenta que para calcular los gradientes de tres tipos cualitativamente diferentes, tomamos los valores "a trav茅s de uno".  Esto es efectivo, pero puede dificultar la convergencia. </p><img vspace="10" src="https://habrastorage.org/webt/qa/2x/oa/qa2xoa3zbrhfvjiuvej7awoas9e.png"><p>  Como todos los animales, a medida que Klyukovka crezca, perfeccionar谩 su capacidad de predecir los valores de los estados, ganar谩 m谩s confianza en sus acciones y, con menos frecuencia, se sorprender谩 de los premios. </p><br><p>  Los agentes de RL, como Klukovka, no solo generan todos los datos necesarios, simplemente interact煤an con el entorno, sino que tambi茅n eval煤an las etiquetas de destino.  As铆 es, los modelos RL actualizan las calificaciones anteriores para que coincidan mejor con las calificaciones nuevas y mejoradas. <br><br>  Como dice el Dr. David Silver, jefe del grupo RL en Google Deepmind: AI = DL + RL.  Cuando un agente como Klyukovka puede establecer su propia inteligencia, las posibilidades son infinitas ... </p><img vspace="10" src="https://habrastorage.org/webt/ea/5k/fm/ea5kfmjm_1hzvkjupaxfpiaucju.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/442522/">https://habr.com/ru/post/442522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442512/index.html">Personalizaci贸n de Django ORM en el ejemplo de ZomboDB</a></li>
<li><a href="../442514/index.html">Sistemas distribuidos. Patrones de dise帽o. Rese帽a del libro</a></li>
<li><a href="../442516/index.html">Pandas Guide to Big Data Analysis</a></li>
<li><a href="../442518/index.html">Las 10 mejores t茅cnicas de pirater铆a web 2018</a></li>
<li><a href="../442520/index.html">Caso. Ahorro de 300 000 p. por mes en publicidad contextual</a></li>
<li><a href="../442524/index.html">C贸mo aumentar la seguridad en la identificaci贸n personal y los sistemas de control de acceso</a></li>
<li><a href="../442526/index.html">La historia de los reproductores de cassette sovi茅ticos (segunda parte): el auge de Walkmen, un dispositivo para el KGB y las grabadoras</a></li>
<li><a href="../442528/index.html">C贸mo hacer que el juego funcione a 60 fps</a></li>
<li><a href="../442530/index.html">Wireshark 3.0.0: revisi贸n de innovaciones</a></li>
<li><a href="../442532/index.html">Grabadoras de video para video vigilancia - gratis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>