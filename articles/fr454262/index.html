<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïâÔ∏è üëØ üåê Pourquoi chaque Data Scientist devrait conna√Ætre Dask üòñ üöí üôáüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour coll√®gues! 

 Peut-√™tre que le titre de la publication d'aujourd'hui aurait √©t√© meilleur avec un point d'interrogation - c'est difficile √† dir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pourquoi chaque Data Scientist devrait conna√Ætre Dask</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/454262/"> Bonjour coll√®gues! <br><br>  Peut-√™tre que le titre de la publication d'aujourd'hui aurait √©t√© meilleur avec un point d'interrogation - c'est difficile √† dire.  Dans tous les cas, nous voulons aujourd'hui vous offrir une br√®ve visite qui vous pr√©sentera la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dask</a> , con√ßue pour parall√©liser les t√¢ches en Python.  Nous esp√©rons revenir plus en d√©tail sur ce sujet √† l'avenir. <br><br><img src="https://habrastorage.org/webt/v1/sy/al/v1syalwkg-cp2dnxebftth8yhnu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i>Photo prise √†</i></a> <br><a name="habracut"></a><br>  Dask est, sans exag√©ration, l'outil de traitement de donn√©es le plus r√©volutionnaire que j'ai rencontr√©.  Si vous aimez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pandas et Numpy</a> , mais parfois vous ne pouvez pas g√©rer des donn√©es qui ne tiennent pas dans la RAM, alors Dask est exactement ce dont vous avez besoin.  Dask prend en charge le cadre de donn√©es Pandas et les structures de donn√©es Numpy (tableaux).  Dask peut √™tre ex√©cut√© sur l'ordinateur local ou mis √† l'√©chelle, puis ex√©cut√© dans le cluster.  En substance, vous √©crivez le code une seule fois, puis choisissez de l'utiliser sur la machine locale ou de le d√©ployer dans un cluster de nombreux n≈ìuds en utilisant la syntaxe Python la plus courante pour tout cela.  La fonctionnalit√© elle-m√™me est excellente, mais j'ai d√©cid√© d'√©crire cet article juste pour souligner: chaque Data Scientist (au moins en utilisant Python) devrait utiliser Dask.  De mon point de vue, la magie de Dask est qu'en minimisant le code, vous pouvez le parall√©liser en utilisant la puissance de calcul qui est d√©j√† disponible, par exemple, sur mon ordinateur portable.  Avec le traitement parall√®le des donn√©es, le programme s'ex√©cute plus rapidement, vous devez attendre moins et, par cons√©quent, il reste plus de temps pour l'analyse.  En particulier, dans cet article, nous parlerons de l'objet <code>dask.delayed</code> et de son <code>dask.delayed</code> dans le flux de t√¢ches de science des donn√©es. <br><br><h3>  Pr√©sentation de Dask </h3><br>  En guise d'introduction √† Dask, voici quelques exemples juste pour vous donner une id√©e de sa syntaxe compl√®tement discr√®te et naturelle.  La conclusion la plus importante que je veux sugg√©rer dans ce cas est que les connaissances que vous avez d√©j√† seront suffisantes pour fonctionner;  Vous n'avez pas besoin d'apprendre un nouvel outil de Big Data comme Hadoop ou Spark. <br><br>  Dask propose 3 collections parall√®les dans lesquelles vous pouvez stocker des donn√©es d√©passant la taille de la RAM, √† savoir les trames de donn√©es, les sacs et les tableaux.  Dans chacun de ces types de collections, vous pouvez stocker des donn√©es en les segmentant entre la RAM et le disque dur, ainsi que distribuer des donn√©es sur plusieurs n≈ìuds d'un cluster. <br><br>  Un Dask DataFrame se compose de trames de donn√©es d√©chiquet√©es, telles que celles de Pandas, de sorte qu'il vous permet d'utiliser un sous-ensemble des fonctionnalit√©s de la syntaxe de requ√™te Pandas.  Voici un exemple de code qui t√©l√©charge tous les fichiers csv pour 2018, analyse un champ avec un horodatage et lance une demande Pandas: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.dataframe <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> dd df = dd.read_csv(<span class="hljs-string"><span class="hljs-string">'logs/2018-*.*.csv'</span></span>, parse_dates=[<span class="hljs-string"><span class="hljs-string">'timestamp'</span></span>]) df.groupby(df.timestamp.dt.hour).value.mean().compute()</code> </pre> <br>  <i>Exemple de trame de donn√©es Dask</i> <br><br>  Dans Dask Bag, vous pouvez stocker et traiter des collections d'objets pythoniques qui ne tiennent pas en m√©moire.  Dask Bag est id√©al pour le traitement des journaux et des collections de documents au format json.  Dans cet exemple de code, tous les fichiers json pour 2018 sont charg√©s dans la structure de donn√©es Dask Bag, chaque enregistrement json est analys√© et les donn√©es utilisateur sont filtr√©es √† l'aide de la fonction lambda: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.bag <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> db <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json records = db.read_text(<span class="hljs-string"><span class="hljs-string">'data/2018-*-*.json'</span></span>).map(json.loads) records.filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> d: d[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] == <span class="hljs-string"><span class="hljs-string">'Aneesha'</span></span>).pluck(<span class="hljs-string"><span class="hljs-string">'id'</span></span>).frequencies()</code> </pre> <br>  <i>Exemple de sac Dask</i> <br><br>  La structure de donn√©es de Dask Arrays prend en charge les tranches de style Numpy.  Dans l'exemple suivant, un ensemble de donn√©es HDF5 est divis√© en blocs de dimension (5000, 5000): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py f = h5py.File(<span class="hljs-string"><span class="hljs-string">'myhdf5file.hdf5'</span></span>) dset = f[<span class="hljs-string"><span class="hljs-string">'/data/path'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.array <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> da x = da.from_array(dset, chunks=(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>))</code> </pre> <br>  <i>Exemple de tableau Dask</i> <br><br><h3>  Traitement parall√®le dans Dask </h3><br>  Un autre titre tout aussi pr√©cis pour cette section serait ¬´Mort d'un cycle s√©quentiel¬ª.  De temps en temps, je rencontre un mod√®le commun: parcourir la liste des √©l√©ments, puis ex√©cuter la m√©thode Python avec chaque √©l√©ment, mais avec des arguments d'entr√©e diff√©rents.  Les sc√©narios courants de traitement des donn√©es incluent le calcul d'agr√©gats de fonctionnalit√©s pour chaque client ou l'agr√©gation d'√©v√©nements √† partir du journal pour chaque √©tudiant.  Au lieu d'appliquer une fonction √† chaque argument d'une boucle s√©quentielle, l'objet Dask Delayed vous permet de traiter de nombreux √©l√©ments en parall√®le.  Lorsque vous travaillez avec Dask Delayed, tous les appels de fonction sont mis en file d'attente, plac√©s dans le graphique d'ex√©cution, apr√®s quoi ils doivent √™tre trait√©s. <br><br>  J'ai toujours √©t√© un peu paresseux pour √©crire mon propre moteur de thread ou utiliser asyncio, donc je ne vais m√™me pas vous montrer d'exemples similaires pour la comparaison.  Avec Dask, vous ne pouvez changer ni la syntaxe ni le style de programmation!  Il vous suffit d'annoter ou de boucler la m√©thode, qui sera ex√©cut√©e en parall√®le avec <code>@dask.delayed</code> et d'appeler la m√©thode de calcul apr√®s l'ex√©cution du code de boucle. <br><br><img src="https://habrastorage.org/webt/e_/_t/k9/e__tk9l_qrxshram0hqh-golmie.png"><br><br><h3>  Exemple de graphique de calcul Dask </h3><br>  Dans l'exemple ci-dessous, les deux m√©thodes sont annot√©es <code>@dask.delayed</code> .  Trois nombres sont stock√©s dans une liste, ils doivent √™tre mis au carr√©, puis additionn√©s ensemble.  Dask construit un graphe de calcul qui fournit une ex√©cution parall√®le de la m√©thode de mise au carr√©, apr√®s quoi le r√©sultat de cette op√©ration est pass√© √† la m√©thode <code>sum_list</code> .  Le graphique de calcul peut √™tre affich√© en appelant en <code>calling .visualize()</code> .  <code>Calling .compute()</code> ex√©cute le graphe de calcul.  Comme il ressort de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conclusion</a> , les √©l√©ments de la liste ne sont pas trait√©s dans l'ordre, mais en parall√®le. <br><br>  Le nombre de threads peut √™tre d√©fini (par exemple, <code>dask.set_options( pool=ThreadPool(10)</code> ), et ils peuvent √©galement √™tre facilement √©chang√©s pour utiliser des processus sur votre ordinateur portable ou PC (par exemple, <code>dask.config.set( scheduler='processes'</code> ) . <br><br>  J'ai donc d√©montr√© combien il serait trivial d'ajouter un traitement parall√®le de t√¢ches √† un projet du domaine de la science des donn√©es √† l'aide de Dask.  Peu de temps avant d'√©crire cet article, j'ai utilis√© Dask pour diviser les donn√©es sur les flux de clics des utilisateurs (historique des visites) en sessions de 40 minutes, puis agr√©ger les attributs de chaque utilisateur pour un clustering plus pouss√©.  Dites-nous comment vous avez utilis√© Dask! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454262/">https://habr.com/ru/post/fr454262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454248/index.html">Les serfs √† l'√®re de l'intelligence artificielle</a></li>
<li><a href="../fr454252/index.html">M√™me les ressources Web d'organisations bien connues ne sont pas prot√©g√©es contre les erreurs des enfants.</a></li>
<li><a href="../fr454254/index.html">Nous √©crivons le proxy Reverse socks5 sur PowerShell. Partie 3</a></li>
<li><a href="../fr454256/index.html">Quel est le probl√®me avec notre informatique</a></li>
<li><a href="../fr454260/index.html">Journ√©e des enfants Bad Code</a></li>
<li><a href="../fr454264/index.html">4 cha√Ænes Youtube sensibles sur les interviews techniques</a></li>
<li><a href="../fr454266/index.html">Dell et Alienware au Computex 2019: parler des principales innovations</a></li>
<li><a href="../fr454272/index.html">Toute la v√©rit√© sur RTOS. Article # 27. Heure syst√®me</a></li>
<li><a href="../fr454274/index.html">Lumi√®re, cam√©ra ... nuage: comment les nuages ‚Äã‚Äãchangent l'industrie du cin√©ma</a></li>
<li><a href="../fr454278/index.html">La cyberassurance sur le march√© russe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>