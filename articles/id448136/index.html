<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âš•ï¸ ğŸ’‚ğŸ¼ ğŸ––ğŸ» Instruksi: cara menguji peran yang dimungkinkan dan mencari tahu tentang masalah sebelum produksi â˜ğŸ» ğŸ‘ âš›ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 


 Saya bekerja sebagai insinyur DevOps di layanan pemesanan hotel Ostrovok.ru . Dalam artikel ini saya ingin berbicara tentang pengal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Instruksi: cara menguji peran yang dimungkinkan dan mencari tahu tentang masalah sebelum produksi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ostrovok/blog/448136/"><p>  Halo semuanya! </p><br><p>  Saya bekerja sebagai insinyur DevOps di layanan pemesanan hotel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ostrovok.ru</a> .  Dalam artikel ini saya ingin berbicara tentang pengalaman kami dalam menguji peran yang mungkin. </p><br><p>  Di Ostrovok.ru, kami menggunakan ansible sebagai manajer konfigurasi.  Kami baru-baru ini datang dengan kebutuhan untuk menguji peran, tetapi ternyata, tidak ada banyak alat untuk ini - kerangka kerja Molekul mungkin yang paling populer, jadi kami memutuskan untuk menggunakannya.  Tetapi ternyata dokumentasinya diam tentang banyak jebakan.  Kami tidak dapat menemukan panduan yang cukup rinci dalam bahasa Rusia, jadi kami memutuskan untuk menulis artikel ini. </p><br><img src="https://habrastorage.org/webt/a-/ia/np/a-ianpukaixuflfp5svh_vpj8tu.png"><a name="habracut"></a><br><h1>  Molekul </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Molekul</a> - kerangka kerja untuk membantu menguji peran yang mungkin. </p><br><p>  Deskripsi yang disederhanakan: Molekul membuat sebuah instance pada platform yang Anda tentukan (cloud, mesin virtual, wadah; untuk lebih jelasnya, lihat bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Driver</a> ), jalankan peran Anda di atasnya, kemudian jalankan tes dan hapus instance.  Dalam hal kegagalan pada salah satu langkah, Molekul akan memberi tahu Anda tentang hal ini. </p><br><p>  Sekarang lebih detail. </p><br><h3 id="nemnogo-teorii">  Sedikit teori </h3><br><p>  Pertimbangkan dua entitas kunci Molekul: Skenario dan Pengemudi. </p><br><h4 id="scenario">  Skenario </h4><br><p> Script berisi deskripsi tentang apa, di mana, bagaimana, dan dalam urutan apa yang akan dilakukan.  Satu peran dapat memiliki beberapa skrip, dan masing-masing adalah direktori di sepanjang jalur <code>&lt;role&gt;/molecule/&lt;scenario&gt;</code> , yang berisi deskripsi tindakan yang diperlukan untuk pengujian.  Skrip <code>default</code> harus ada, yang akan dibuat secara otomatis jika Anda menginisialisasi peran menggunakan Molekul.  Nama-nama skenario berikut ini dipilih atas kebijakan Anda. </p><br><p>  Urutan pengujian dalam skrip disebut <strong>matriks</strong> , dan secara default adalah sebagai berikut: </p><br><p>  <em>(Langkah ditandai dengan <code>?</code> Dilewati secara default jika tidak dijelaskan oleh pengguna)</em> </p><br><ul><li>  <code>lint</code> - run linter.  Secara default, <code>yamllint</code> dan <code>flake8</code> , </li><li>  <code>destroy</code> - menghapus instance dari peluncuran Molekul terakhir (jika dibiarkan), </li><li>  <code>dependency</code> ?  - pemasangan dependensi yang dimungkinkan dari peran yang diuji, </li><li>  <code>syntax</code> - periksa sintaks peran menggunakan <code>ansible-playbook --syntax-check</code> , </li><li>  <code>create</code> - buat sebuah instance, </li><li>  <code>prepare</code> ?  - persiapan instance;  mis. memeriksa / menginstal python2 </li><li>  <code>converge</code> - peluncuran playbook yang diuji, </li><li>  <code>idempotence</code> - restart playbook untuk tes idempotency, </li><li>  <code>side_effect</code> ?  - tindakan yang tidak terkait langsung dengan peran, tetapi diperlukan untuk pengujian, </li><li>  <code>verify</code> - jalankan tes dari konfigurasi yang dihasilkan menggunakan <code>testinfra</code> (default) / <code>goss</code> / <code>inspec</code> , </li><li>  <code>cleanup</code> ?  - (dalam versi baru) - secara kasar, "pembersihan" infrastruktur eksternal yang dipengaruhi oleh Molekul, </li><li>  <code>destroy</code> - menghapus sebuah instance. </li></ul><br><p>  Urutan ini mencakup sebagian besar kasus, tetapi Anda dapat mengubahnya jika perlu. </p><br><p>  Setiap langkah di atas dapat dijalankan secara terpisah menggunakan <code>molecule &lt;command&gt;</code> .  Tetapi bermanfaat untuk memahami bahwa untuk setiap cli-command tersebut mungkin ada urutan tindakannya sendiri, yang dapat dikenali dengan mengeksekusi <code>molecule matrix &lt;command&gt;</code> .  Misalnya, ketika Anda menjalankan perintah <code>converge</code> (menjalankan buku pedoman yang diuji), tindakan berikut akan dilakukan: </p><br><pre> <code class="bash hljs">$ molecule matrix converge ... â””â”€â”€ default <span class="hljs-comment"><span class="hljs-comment">#   â”œâ”€â”€ dependency #   â”œâ”€â”€ create #   â”œâ”€â”€ prepare #   â””â”€â”€ converge #  </span></span></code> </pre> <br><p>  Urutan tindakan ini dapat diedit.  Jika sesuatu dari daftar telah selesai, maka akan dilewati.  Keadaan saat ini, serta konfigurasi instance, disimpan dalam direktori <code>$TMPDIR/molecule/&lt;role&gt;/&lt;scenario&gt;</code> . </p><br><p>  Tambahkan langkah dengan <code>?</code>  Anda dapat, setelah mendeskripsikan tindakan yang diinginkan dalam format playbook yang memungkinkan, dan membuat nama file sesuai langkah: <code>prepare.yml</code> / <code>side_effect.yml</code> .  Molekul akan menunggu file-file ini di folder skrip. </p><br><h4 id="driver">  Supir </h4><br><p>  Driver adalah suatu entitas tempat instance uji dibuat. <br>  Daftar driver standar yang siap digunakan Molecule adalah sebagai berikut: Azure, Docker, EC2, GCE, LXC, LXD, OpenStack, Vagrant, Delegated. </p><br><p>  Dalam kebanyakan kasus, templat adalah file <code>create.yml</code> dan <code>create.yml</code> di folder skrip yang masing-masing menggambarkan pembuatan dan penghapusan instance. <br>  Pengecualian adalah Docker dan Vagrant, karena interaksi dengan modul mereka dapat terjadi tanpa file di atas. </p><br><p>  Layak menyoroti driver Delegated, karena jika digunakan dalam file untuk membuat dan menghapus instance, hanya bekerja dengan konfigurasi instance yang dijelaskan, sisanya harus dijelaskan oleh insinyur. </p><br><p>  Driver default adalah Docker. </p><br><p>  Sekarang kita beralih ke latihan dan mempertimbangkan fitur lebih lanjut di sana. </p><br><h3 id="nachalo-raboty">  Memulai </h3><br><p>  Sebagai "hello world", kami menguji peran sederhana menginstal nginx.  Kami akan memilih buruh pelabuhan sebagai driver - saya pikir itu diinstal pada sebagian besar dari Anda (dan ingat bahwa buruh pelabuhan adalah driver default). </p><br><p>  Siapkan <code>virtualenv</code> dan pasang <code>molecule</code> di dalamnya: </p><br><pre> <code class="bash hljs">&gt; pip install virtualenv &gt; virtualenv -p `<span class="hljs-built_in"><span class="hljs-built_in">which</span></span> python2` venv &gt; <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> venv/bin/activate &gt; pip install molecule docker <span class="hljs-comment"><span class="hljs-comment"># molecule  ansible  ; docker  </span></span></code> </pre> <br><p>  Langkah selanjutnya adalah menginisialisasi peran baru. <br>  Inisialisasi peran baru, serta skenario baru, dilakukan dengan menggunakan perintah <code>molecule init &lt;params&gt;</code> : </p><br><pre> <code class="bash hljs">&gt; molecule init role -r nginx --&gt; Initializing new role nginx... Initialized role <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;path&gt;/nginx successfully. &gt; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> nginx &gt; tree -L 1 . â”œâ”€â”€ README.md â”œâ”€â”€ defaults â”œâ”€â”€ handlers â”œâ”€â”€ meta â”œâ”€â”€ molecule â”œâ”€â”€ tasks â””â”€â”€ vars 6 directories, 1 file</code> </pre> <br><p>  Hasilnya adalah peran yang memungkinkan.  Lebih lanjut, semua interaksi dengan molekul CLI dibuat dari akar peran. </p><br><p>  Mari kita lihat apa yang ada di direktori peran: </p><br><pre> <code class="bash hljs">&gt; tree molecule/default/ molecule/default/ â”œâ”€â”€ Dockerfile.j2 <span class="hljs-comment"><span class="hljs-comment"># Jinja-  Dockerfile â”œâ”€â”€ INSTALL.rst. #       â”œâ”€â”€ molecule.yml #   â”œâ”€â”€ playbook.yml #    â””â”€â”€ tests #     verify â””â”€â”€ test_default.py 1 directory, 6 files</span></span></code> </pre> <br><p>  Mari kita menganalisis konfigurasi <code>molecule/default/molecule.yml</code> (kami hanya akan mengganti gambar buruh pelabuhan): </p><br><pre> <code class="plaintext hljs">--- dependency: name: galaxy driver: name: docker lint: name: yamllint platforms: - name: instance image: centos:7 provisioner: name: ansible lint: name: ansible-lint scenario: name: default verifier: name: testinfra lint: name: flake8</code> </pre> <br><h4 id="dependency">  ketergantungan </h4><br><p>  Bagian ini menjelaskan sumber dependensi. </p><br><p>  Opsi yang memungkinkan: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">galaksi</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gilt</a> , shell. </p><br><p>  Shell hanyalah shell perintah yang digunakan jika galaksi dan emas tidak memenuhi kebutuhan Anda. </p><br><p>  Saya tidak akan berhenti di sini untuk waktu yang lama, itu sudah dijelaskan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> . </p><br><h4 id="driver-1">  pengemudi </h4><br><p>  Nama pengemudi.  Kami memiliki buruh pelabuhan ini. </p><br><h4 id="lint">  serat </h4><br><p>  Sebagai linter, yamllint digunakan. </p><br><p>  Opsi yang berguna di bagian konfigurasi ini adalah kemampuan untuk menentukan file konfigurasi untuk yamllint, meneruskan variabel lingkungan atau menonaktifkan linter: </p><br><pre> <code class="plaintext hljs">lint: name: yamllint options: config-file: foo/bar env: FOO: bar enabled: False</code> </pre> <br><h4 id="platforms">  platform </h4><br><p>  Menjelaskan konfigurasi instance. <br>  Dalam kasus buruh pelabuhan sebagai driver, Molekul diulangi di atas bagian ini, dan setiap item daftar tersedia di <code>Dockerfile.j2</code> sebagai variabel <code>item</code> . </p><br><p>  Dalam kasus driver, di mana <code>create.yml</code> dan <code>create.yml</code> <code>destroy.yml</code> , bagian tersedia di dalamnya sebagai <code>molecule_yml.platforms</code> , dan iterasi di atasnya sudah dijelaskan dalam file-file ini. </p><br><p>  Karena Molekul menyediakan kontrol instan untuk modul yang mungkin, daftar pengaturan yang mungkin harus dicari di sana.  Untuk buruh pelabuhan, misalnya, modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">docker_container_module digunakan</a> .  Modul mana yang digunakan pada driver lain dapat ditemukan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> . </p><br><p>  Dan juga contoh penggunaan berbagai driver dapat ditemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dalam tes Molekul itu sendiri</a> . </p><br><p>  Ganti <strong>centos: 7</strong> di <strong>ubuntu di sini</strong> . </p><br><h4 id="provisioner">  pembuat ketentuan </h4><br><p>  "Penyedia" adalah entitas yang mengendalikan mesin virtual.  Dalam kasus Molekul, ini dimungkinkan, dukungan untuk orang lain tidak direncanakan, sehingga bagian ini dapat dipanggil dengan reservasi konfigurasi lanjutan dari ansible. <br>  Di sini Anda dapat menentukan banyak hal, saya akan menyoroti utama, menurut pendapat saya, momen: </p><br><ul><li>  <strong>playbooks</strong> : Anda dapat menentukan playbook mana yang harus digunakan pada tahapan tertentu. </li></ul><br><pre> <code class="plaintext hljs">provisioner: name: ansible playbooks: create: create.yml destroy: ../default/destroy.yml converge: playbook.yml side_effect: side_effect.yml cleanup: cleanup.yml</code> </pre> <br><ul><li>  <strong>config_options</strong> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">konfigurasi yang dimungkinkan</a> </li></ul><br><pre> <code class="plaintext hljs">provisioner: name: ansible config_options: defaults: fact_caching: jsonfile ssh_connection: scp_if_ssh: True</code> </pre> <br><ul><li>  <strong>connection_options</strong> : parameter <strong>koneksi</strong> </li></ul><br><pre> <code class="plaintext hljs">provisioner: name: ansible connection_options: ansible_ssh_common_args: "-o 'UserKnownHostsFile=/dev/null' -o 'ForwardAgent=yes'"</code> </pre> <br><ul><li>  <strong>opsi</strong> : Opsi opsi dan variabel lingkungan </li></ul><br><pre> <code class="plaintext hljs">provisioner: name: ansible options: vvv: true diff: true env: FOO: BAR</code> </pre> <br><h4 id="scenario-1">  skenario </h4><br><p>  Nama dan deskripsi urutan skrip. <br>  Anda dapat mengubah matriks tindakan default dari suatu <code>&lt;command&gt;_sequence</code> menambahkan <code>&lt;command&gt;_sequence</code> dan menentukan daftar langkah-langkah yang kita butuhkan sebagai nilai untuknya. <br>  Misalkan kita ingin mengubah urutan tindakan saat menjalankan perintah jalankan playbook: <code>molecule converge</code> </p><br><pre> <code class="plaintext hljs"># : # - dependency # - create # - prepare # - converge scenario: name: default converge_sequence: - create - converge</code> </pre> <br><h4 id="verifier">  pemverifikasi </h4><br><p>  Menyiapkan kerangka kerja untuk tes dan linter untuk itu.  Secara default, <code>testinfra</code> dan <code>flake8</code> digunakan <code>testinfra</code> <code>flake8</code> .  Opsi yang mungkin mirip dengan yang di atas: </p><br><pre> <code class="plaintext hljs">verifier: name: testinfra additional_files_or_dirs: - ../path/to/test_1.py - ../path/to/test_2.py - ../path/to/directory/* options: n: 1 enabled: False env: FOO: bar lint: name: flake8 options: benchmark: True enabled: False env: FOO: bar</code> </pre> <br><p>  Mari kita kembali ke peran kita.  Edit file <code>tasks/main.yml</code> agar terlihat seperti ini: </p><br><pre> <code class="plaintext hljs">--- - name: Install nginx apt: name: nginx state: present - name: Start nginx service: name: nginx state: started</code> </pre><br><p>  Dan tambahkan tes ke <code>molecule/default/tests/test_default.py</code> </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_nginx_is_installed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(host)</span></span></span><span class="hljs-function">:</span></span> nginx = host.package(<span class="hljs-string"><span class="hljs-string">"nginx"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> nginx.is_installed <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_nginx_running_and_enabled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(host)</span></span></span><span class="hljs-function">:</span></span> nginx = host.service(<span class="hljs-string"><span class="hljs-string">"nginx"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> nginx.is_running <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> nginx.is_enabled <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_nginx_config</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(host)</span></span></span><span class="hljs-function">:</span></span> host.run(<span class="hljs-string"><span class="hljs-string">"nginx -t"</span></span>)</code> </pre><br><p>  Selesai, tetap berjalan saja (dari akar peran, saya ingatkan Anda): </p><br><pre> <code class="bash hljs">&gt; molecule <span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Knalpot panjang di bawah spoiler:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">--&gt; Validating schema &lt;path&gt;/nginx/molecule/default/molecule.yml. Validation completed successfully. --&gt; Test matrix â””â”€â”€ default â”œâ”€â”€ lint â”œâ”€â”€ destroy â”œâ”€â”€ dependency â”œâ”€â”€ syntax â”œâ”€â”€ create â”œâ”€â”€ prepare â”œâ”€â”€ converge â”œâ”€â”€ idempotence â”œâ”€â”€ side_effect â”œâ”€â”€ verify â””â”€â”€ destroy --&gt; Scenario: 'default' --&gt; Action: 'lint' --&gt; Executing Yamllint on files found in &lt;path&gt;/nginx/... Lint completed successfully. --&gt; Executing Flake8 on files found in &lt;path&gt;/nginx/molecule/default/tests/... Lint completed successfully. --&gt; Executing Ansible Lint on &lt;path&gt;/nginx/molecule/default/playbook.yml... Lint completed successfully. --&gt; Scenario: 'default' --&gt; Action: 'destroy' PLAY [Destroy] ***************************************************************** TASK [Destroy molecule instance(s)] ******************************************** changed: [localhost] =&gt; (item=None) changed: [localhost] TASK [Wait for instance(s) deletion to complete] ******************************* ok: [localhost] =&gt; (item=None) ok: [localhost] TASK [Delete docker network(s)] ************************************************ PLAY RECAP ********************************************************************* localhost : ok=2 changed=1 unreachable=0 failed=0 --&gt; Scenario: 'default' --&gt; Action: 'dependency' Skipping, missing the requirements file. --&gt; Scenario: 'default' --&gt; Action: 'syntax' playbook: &lt;path&gt;/nginx/molecule/default/playbook.yml --&gt; Scenario: 'default' --&gt; Action: 'create' PLAY [Create] ****************************************************************** TASK [Log into a Docker registry] ********************************************** skipping: [localhost] =&gt; (item=None) TASK [Create Dockerfiles from image names] ************************************* changed: [localhost] =&gt; (item=None) changed: [localhost] TASK [Discover local Docker images] ******************************************** ok: [localhost] =&gt; (item=None) ok: [localhost] TASK [Build an Ansible compatible image] *************************************** changed: [localhost] =&gt; (item=None) changed: [localhost] TASK [Create docker network(s)] ************************************************ TASK [Create molecule instance(s)] ********************************************* changed: [localhost] =&gt; (item=None) changed: [localhost] TASK [Wait for instance(s) creation to complete] ******************************* changed: [localhost] =&gt; (item=None) changed: [localhost] PLAY RECAP ********************************************************************* localhost : ok=5 changed=4 unreachable=0 failed=0 --&gt; Scenario: 'default' --&gt; Action: 'prepare' Skipping, prepare playbook not configured. --&gt; Scenario: 'default' --&gt; Action: 'converge' PLAY [Converge] **************************************************************** TASK [Gathering Facts] ********************************************************* ok: [instance] TASK [nginx : Install nginx] *************************************************** changed: [instance] TASK [nginx : Start nginx] ***************************************************** changed: [instance] PLAY RECAP ********************************************************************* instance : ok=3 changed=2 unreachable=0 failed=0 --&gt; Scenario: 'default' --&gt; Action: 'idempotence' Idempotence completed successfully. --&gt; Scenario: 'default' --&gt; Action: 'side_effect' Skipping, side effect playbook not configured. --&gt; Scenario: 'default' --&gt; Action: 'verify' --&gt; Executing Testinfra tests found in &lt;path&gt;/nginx/molecule/default/tests/... ============================= test session starts ============================== platform darwin -- Python 2.7.15, pytest-4.3.0, py-1.8.0, pluggy-0.9.0 rootdir: &lt;path&gt;/nginx/molecule/default, inifile: plugins: testinfra-1.16.0 collected 4 items tests/test_default.py .... [100%] ========================== 4 passed in 27.23 seconds =========================== Verifier completed successfully. --&gt; Scenario: 'default' --&gt; Action: 'destroy' PLAY [Destroy] ***************************************************************** TASK [Destroy molecule instance(s)] ******************************************** changed: [localhost] =&gt; (item=None) changed: [localhost] TASK [Wait for instance(s) deletion to complete] ******************************* changed: [localhost] =&gt; (item=None) changed: [localhost] TASK [Delete docker network(s)] ************************************************ PLAY RECAP ********************************************************************* localhost : ok=2 changed=2 unreachable=0 failed=0</code> </pre></div></div><br><p>  Peran sederhana kami diuji tanpa masalah. <br>  Perlu diingat bahwa jika ada masalah selama pengoperasian <code>molecule test</code> , maka jika Anda tidak mengubah urutan standar, Molekul akan menghapus instance. </p><br><p>  Perintah-perintah berikut berguna untuk debugging: </p><br><pre> <code class="bash hljs">&gt; molecule --debug &lt;<span class="hljs-built_in"><span class="hljs-built_in">command</span></span>&gt; <span class="hljs-comment"><span class="hljs-comment"># debug info.      . &gt; molecule converge #      . &gt; molecule login #    . &gt; molecule --help #   .</span></span></code> </pre> <br><h3 id="suschestvuyuschaya-rol">  Peran yang ada </h3><br><p>  Menambahkan skrip baru ke peran yang ada terjadi <strong>dari direktori peran dengan</strong> perintah berikut: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     &gt; molecule init scenarion --help #    &gt; molecule init scenario -r &lt;role_name&gt; -s &lt;scenario_name&gt;</span></span></code> </pre> <br><p>  Dalam hal ini adalah skrip pertama dalam peran, <code>-s</code> dapat dihilangkan karena skrip <code>default</code> akan dibuat. </p><br><h3 id="zaklyuchenie">  Kesimpulan </h3><br><p>  Seperti yang Anda lihat, Molekul tidak terlalu rumit, dan saat menggunakan templat Anda sendiri, Anda dapat mengurangi penyebaran skrip baru ke mengedit variabel dalam buku pedoman untuk membuat dan menghapus instance.  Molekul terintegrasi dengan sistem CI, yang memungkinkan Anda untuk meningkatkan kecepatan pengembangan dengan mengurangi waktu yang dibutuhkan untuk secara manual menguji buku pedoman. </p><br><p>  Terima kasih atas perhatian anda  Jika Anda memiliki pengalaman menguji peran yang memungkinkan, dan itu tidak terkait dengan Molekul - beri tahu kami tentang hal itu di komentar! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448136/">https://habr.com/ru/post/id448136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448122/index.html">Bagaimana ReactJS Bekerja Paket Bereaksi</a></li>
<li><a href="../id448124/index.html">Mikrotik. Kontrol SMS menggunakan server WEB</a></li>
<li><a href="../id448126/index.html">Rahasia API perangkat Android. Laporan Yandex</a></li>
<li><a href="../id448128/index.html">9 tips untuk menggunakan perpustakaan Kucing di Scala</a></li>
<li><a href="../id448130/index.html">Desain deckbuilding video game</a></li>
<li><a href="../id448140/index.html">SNA Hackathon 2019 - hasil</a></li>
<li><a href="../id448142/index.html">Di mana bukti, fakta, dan imajinasi bertemu</a></li>
<li><a href="../id448144/index.html">NASA: perubahan genetik yang disebabkan oleh perjalanan ruang angkasa bersifat sementara</a></li>
<li><a href="../id448146/index.html">Dari pemodelan proses hingga merancang sistem otomatis (Bagian 1)</a></li>
<li><a href="../id448148/index.html">Perencanaan infrastruktur untuk menginstal Zimbra Collaboration Suite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>