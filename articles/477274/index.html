<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë≤üèæ üíø üßúüèæ ¬øC√≥mo deshacerse del c√≥digo CSS no utilizado? Parte 1 üè¶ üßôüèø üöô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El autor del art√≠culo, cuya primera parte de la traducci√≥n publicamos hoy, quisiera que los lectores sepan de antemano que deshacerse de CSS innecesar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øC√≥mo deshacerse del c√≥digo CSS no utilizado? Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/477274/">  El autor del art√≠culo, cuya primera parte de la traducci√≥n publicamos hoy, quisiera que los lectores sepan de antemano que deshacerse de CSS innecesarios es una tarea dif√≠cil.  Si lee esto con la esperanza de encontrar una herramienta, ejecutarla, puede averiguar exactamente qu√© c√≥digo CSS se puede eliminar de forma segura de su proyecto, entonces ... Hay herramientas similares, pero deben usarse con mucho cuidado, ya que ninguna de ellas <a href="https://css-tricks.com/heres-the-thing-about-unused-css-tools/">no puede</a> dar una respuesta decente a la pregunta de CSS no utilizado. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/477274/"><img src="https://habrastorage.org/webt/f4/ut/rj/f4utrjbd9kcbmnixe8auxnnafzg.jpeg"></a> <br><br>  Es f√°cil entender que a cualquier desarrollador web le gustar√≠a tomar alg√∫n tipo de utilidad, ejecutarla y eliminar el CSS innecesario que informa.  Un par de minutos, y el sitio se acelera.  Pero no tan simple.  El autor de este material cree que dicha herramienta debe tratarse con escepticismo saludable.  Ninguno de ellos le miente al desarrollador.  Estas herramientas generalmente simplemente no tienen suficiente informaci√≥n para permitirles producir resultados en los que se pueda confiar incondicionalmente.  Pero esto no significa que tales herramientas no puedan usarse.  Esto no significa que no pueda deshacerse de CSS no utilizado de ninguna manera.  Discutimos esto. <br><br>  ‚Üí <a href="https://habr.com/ru/company/ruvds/blog/477276/">Leer la segunda parte</a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">¬øPor qu√© deshacerse de CSS no utilizado?</font> </h2><br>  Creo que la raz√≥n principal por la que alguien podr√≠a necesitar deshacerse del CSS no utilizado se puede describir con el siguiente ejemplo.  Supongamos que usa un marco CSS (como Bootstrap), y todo el c√≥digo CSS para ese marco entra en su proyecto.  Pero en realidad, solo una peque√±a parte de dicho c√≥digo se usa en el proyecto.  ¬øC√≥mo deshacerse de todo lo innecesario? <br><br>  Puedo sentir los sentimientos de alguien que est√° en una situaci√≥n similar.  Los marcos CSS a menudo no ofrecen a los desarrolladores formas f√°ciles de seleccionar exactamente las caracter√≠sticas que se aplican a proyectos espec√≠ficos.  Al mismo tiempo, llevar el c√≥digo fuente del marco a un estado que corresponda idealmente a un determinado proyecto puede requerir un equipo de un nivel de experiencia que tal vez no tenga.  Una situaci√≥n similar en s√≠ misma puede convertirse en la raz√≥n de la b√∫squeda del marco. <br><br>  Suponga que descarga 100 KB de CSS.  Yo dir√≠a que es mucho.  (En el momento en que escribo esto, <a href="https://css-tricks.com/">css-tricks.com</a> utiliza aproximadamente 23 Kb de CSS. Hay bastantes p√°ginas y plantillas. No hice nada especial para reducir el tama√±o de CSS). Existe la sospecha de que no est√° utilizando parte de esta cantidad de c√≥digo.  Y tal vez encuentres alguna evidencia de esto.  Veo una raz√≥n para hacer sonar la alarma.  Si tiene un archivo jpg de 100 Kb que se puede comprimir a 20 Kb proces√°ndolo con alg√∫n tipo de herramienta, entonces esto es excelente y vale la pena hacerlo.  Pero si algo como esto se hace con CSS, entonces esto es mucho m√°s importante.  El punto es que CSS se carga al comienzo de la carga de la p√°gina y es un recurso que bloquea la representaci√≥n.  Los archivos JPG no son tales recursos. <br><br><h2>  <font color="#3AC1EF">An√°lisis de situaci√≥n con las herramientas de desarrollador de Chrome</font> </h2><br>  La ventana de Chrome Developer Tools tiene una pesta√±a de <code>Coverage</code> .  Con su ayuda, puede averiguar cu√°nto CSS y JavaScript cargados se usan realmente en la p√°gina analizada.  Por ejemplo, ahora fui a css-tricks.com.  A continuaci√≥n se muestra lo que vi en la pesta√±a <code>Coverage</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc2/5e4/8c7/dc25e48c77b837d2f5ad6cdf883593f2.png"></div><br>  <i><font color="#999999">Herramientas para desarrolladores de Chrome, pesta√±a de cobertura</font></i> <br><br>  Aqu√≠ veo que el 70.7% de mi archivo <code>style.css</code> no se usa.  Creo que no hay nada de malo en eso.  La parte restante no utilizada de CSS se utiliza en algunas otras p√°ginas del sitio.  En este sitio no uso ninguna biblioteca de estilo grande.  Yo mismo escrib√≠ todas las l√≠neas de CSS, as√≠ que dudo que 2/3 de las CSS est√©n fuera de lugar a nivel mundial. <br><br>  Supuse que al trabajar con la pesta√±a <code>Coverage</code> , puede comenzar a "grabar" y pasear por el sitio, observando c√≥mo cae el porcentaje de recursos no utilizados a medida que se muestran diferentes p√°ginas en el navegador.  Pero, desafortunadamente, cuando la p√°gina se actualiza, el contenido de la pesta√±a <code>Coverage</code> tambi√©n se actualiza.  Como resultado, esta herramienta no es particularmente √∫til para determinar el porcentaje de uso de recursos en varias p√°ginas.  Quiz√°s esto no sea solo si analiza una aplicaci√≥n de una p√°gina. <br><br>  Es desagradable para m√≠ decir esto, pero analizar el sitio usando la pesta√±a <code>Coverage</code> result√≥ casi in√∫til.  Lo que vi, estos 70.7%, es una imagen terrible que juega con mis dudas, pero este an√°lisis no me da nada concreto, como resultado, solo puedo preocuparme por algo mal en mi sitio. <br><br>  Quiz√°s este an√°lisis del sitio sea el mecanismo que lo llevar√° a la idea de que necesita encontrar y eliminar el c√≥digo CSS que se carga, pero que no se utiliza en su proyecto. <br><br><h2>  <font color="#3AC1EF">Mi problema principal</font> </h2><br>  Al encontrar y eliminar CSS no utilizados, lo siguiente me preocupa m√°s.  Supongamos que alguien mira los resultados del an√°lisis y ve fragmentos CSS no utilizados. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a7/12d/543/5a712d543a1d2d2d997bee59edb7c626.png"></div><br>  <i><font color="#999999">Fragmentos de CSS no utilizados</font></i> <br><br>  √âl piensa: "Bien, borra todo lo innecesario".  Se elimina lo superfluo, y luego resulta que no era del todo superfluo, y que su eliminaci√≥n condujo a grandes problemas con el estilo en todo el sitio.  Aqu√≠ est√° la cosa: puede estar completamente seguro de que no se usa alg√∫n selector CSS, solo si realiza una investigaci√≥n sobre el siguiente plan: <br><br><ol><li>  Debe verificar cada p√°gina del sitio con una herramienta como la pesta√±a <code>Coverage</code> . </li><li>  En este caso, debe ejecutar todo el c√≥digo JavaScript. </li><li>  Esto debe hacerse con todas las opciones posibles para el estado de la aplicaci√≥n. </li><li>  Y, adem√°s, debe verificar todo esto con todas las opciones posibles para las consultas de medios utilizadas. </li></ol><br>  Si solo se marca la p√°gina de inicio del sitio web, esto no se tiene en cuenta.  Estudiar todas las p√°ginas de nivel superior tampoco se considera una prueba real.  Debe pasar por todas las p√°ginas, examinar el sitio en situaciones que su desarrollador puede no recordar de inmediato, verificar todos los casos l√≠mite.  De lo contrario, todo puede terminar con la eliminaci√≥n del estilo de la lista desplegable de tarjetas de cr√©dito en la ventana modal emergente para los usuarios con una cuenta deshabilitada que inician sesi√≥n en el sistema durante el per√≠odo de gracia para pagar una nueva suscripci√≥n y al mismo tiempo tienen una tarjeta de regalo v√°lida. <br><br>  Algo as√≠ es demasiado complicado para los analizadores CSS autom√°ticos.  No pueden realizar tales controles a la perfecci√≥n, especialmente considerando el an√°lisis del sitio en una situaci√≥n de incertidumbre.  Estamos hablando, por ejemplo, de investigar proyectos en diferentes contextos de navegador (diferentes tama√±os de pantalla, diferentes capacidades de navegador, diferentes navegadores), y teniendo en cuenta el impacto de las bibliotecas de terceros en el sitio. <br><br>  Y ahora quiero mostrar un ejemplo de c√≥mo se ven en la pr√°ctica todos los problemas de los que acabo de hablar. <br><br><h2>  <font color="#3AC1EF">PurifyCSS en l√≠nea</font> </h2><br>  Decid√≠ intentar optimizar css-tricks.com utilizando el <a href="https://purifycss.online/">recurso en l√≠nea PurifyCSS</a> .  Puede pasarle enlaces e inmediatamente produce CSS listo para usar.  "Aliment√©" css-tricks.com a este sitio y ten√≠a un nuevo c√≥digo CSS a mi disposici√≥n.  Esto es lo que sucedi√≥ despu√©s de usar este c√≥digo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1a8/9aa/535/1a89aa535d6e45a17ced716bb724f77f.png"></div><br>  <i><font color="#999999">A la izquierda est√° la vista habitual de css-tricks.com.</font></i>  <i><font color="#999999">A la derecha est√° el resultado de aplicar un nuevo CSS "refinado".</font></i>  <i><font color="#999999">Este nuevo c√≥digo carec√≠a de mucho de lo que se necesita para varias p√°ginas del sitio.</font></i> <br><br>  PurifyCSS le permite analizar en funci√≥n de muchos enlaces (lo cual es bueno), pero en css-tricks.com hay decenas de miles de enlaces.  Muchos de ellos conducen a p√°ginas similares, en t√©rminos de CSS, pero en cada una de estas p√°ginas puede haber algo que no se usa en otros lugares.  Adem√°s, tuve la sensaci√≥n de que PurifyCSS no ejecutaba el c√≥digo JS, porque despu√©s de "limpiar" mi CSS, todo lo que se mostraba en las p√°ginas usando JavaScript result√≥ sin estilo.  Incluso los estilos para las pseudo-clases <code>:hover</code> . <br><br>  Probablemente, ya he dicho lo suficiente para hacerle entender que no es casualidad que conf√≠e tan poco en esas herramientas. <br><br><h2>  <font color="#3AC1EF">Purifique CSS con PurifyCSS como parte del proceso de construcci√≥n del proyecto</font> </h2><br>  <a href="https://github.com/purifycss/purifycss">PurifyCSS</a> probablemente se usa con m√°s frecuencia como una herramienta utilizada para construir un proyecto que como un limpiador de CSS en l√≠nea.  La documentaci√≥n del proyecto contiene instrucciones para su uso cuando se utiliza Grunt, Gulp y webpack.  Por ejemplo, procesando archivos por plantillas: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">content</span></span> = <span class="hljs-selector-attr"><span class="hljs-selector-attr">['**/src/js/*.js', '**/src/html/*.html']</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">css</span></span> = <span class="hljs-selector-attr"><span class="hljs-selector-attr">['**/src/css/*.css']</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">options</span></span> = {  //  CSS    .  <span class="hljs-attribute"><span class="hljs-attribute">output</span></span>: <span class="hljs-string"><span class="hljs-string">'./dist/purified.css'</span></span> }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">purify</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">content</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">css</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">options</span></span>);</code> </pre> <br>  Este enfoque permite una precisi√≥n mucho mayor.  Los materiales del sitio que se env√≠an para su an√°lisis pueden ser una lista que incluye cada plantilla, cada fragmento utilizado para crear p√°ginas y cada archivo JavaScript.  Puede resultar que tal lista de recursos no sea f√°cil de mantener, pero le permite considerar todo lo que se puede tener en cuenta.  Sin embargo, esto no se aplica al contenido de las p√°ginas que se encuentran en ciertos repositorios (como publicaciones de blog que est√°n almacenadas en la base de datos) y al c√≥digo JavaScript de terceros, pero tal vez esto en algunos casos no sea importante, o tal vez el desarrollador podr√° tener en cuenta de alguna manera las necesidades de CSS de dichos recursos. <br><br>  Documentaci√≥n rival de PurifyCSS PurgeCSS tiene una advertencia sobre el m√©todo de manejo de recursos utilizado por PurifyCSS.  Es decir, estamos hablando del hecho de que PurifyCSS puede trabajar con recursos de cualquier tipo, y no solo con HTML y JavaScript.  PurifyCSS en el curso del trabajo analiza todas las palabras en archivos y las compara con selectores en c√≥digo CSS.  Cada palabra se considera un selector.  Es decir, muchos selectores pueden ser err√≥neamente reconocidos como utilizados en el sitio.  Por ejemplo, en el contenido textual de un archivo, en una oraci√≥n regular, puede haber una palabra correspondiente a un cierto selector CSS. <br><br>  Vale la pena recordar PurifyCSS sobre esto.  Esta herramienta busca selectores CSS en los materiales del sitio utilizando un algoritmo extremadamente simple.  Esto, por un lado, es una idea sensata y, por otro, es bastante peligroso. <br><br><h2>  <font color="#3AC1EF">Servicio CSS no utilizado</font> </h2><br>  El ajuste manual de una herramienta, realizado para que esta herramienta analice cada p√°gina, de modo que la examine desde todos los puntos de vista posibles, es, por supuesto, una rutina aburrida.  Adem√°s, dicho trabajo debe llevarse a cabo diariamente, ya que la informaci√≥n analizada sobre el sitio debe actualizarse con nuevos datos a medida que se desarrolla el proyecto.  Hay un servicio en l√≠nea llamado <a href="https://unused-css.com/">UnusedCSS</a> .  Independientemente pasa por alto las p√°ginas del sitio, salvando al desarrollador de una gran cantidad de trabajo mon√≥tono.  Este servicio es suficiente para transferir un solo enlace al sitio. <br><br>  Me inscrib√≠ para una suscripci√≥n paga a este servicio y analic√© css-tricks.com con √©l.  Debo admitir que despu√©s de mirar los resultados, tuve la sensaci√≥n de que se ve√≠an mucho m√°s precisos de lo que hab√≠a visto antes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/940/80a/694/94080a694ca7e9d64f8c896fb6428cfe.png"></div><br>  <i><font color="#999999">Analice css-tricks.com usando UnusedCSS.</font></i>  <i><font color="#999999">El informe dice que el sitio usa el 93% del c√≥digo CSS cargado.</font></i>  <i><font color="#999999">Me parece cercano a la verdad, ya que escrib√≠ manualmente todo el c√≥digo CSS para este sitio</font></i> <br><br>  El servicio, adem√°s, le permite descargar un archivo con c√≥digo CSS borrado y ofrece la capacidad de administrar el contenido de este archivo.  Por ejemplo, esto habilita y deshabilita los selectores que el desarrollador desea o no desea agregar al c√≥digo CSS.  Supongamos que un desarrollador ve un nombre de clase que, seg√∫n UnusedCSS, no es necesario en el sitio, pero el desarrollador sabe con certeza que no puede prescindir de este nombre de clase.  Como resultado, el c√≥digo reconocido err√≥neamente como innecesario puede marcarse seg√∫n sea necesario.  Otras caracter√≠sticas de UnusedCSS incluyen trabajar con prefijos y eliminar selectores duplicados. <br><br>  Realmente me gust√≥ el hecho de que UnusedCSS me dio resultados mucho m√°s precisos que otras herramientas.  Sin embargo, hay demasiado "ruido" en los datos generados por este servicio, y todav√≠a no s√© c√≥mo incluir UnusedCSS en el proceso repetido regularmente de construir un proyecto y poner en producci√≥n sus nuevas versiones. <br><br>  ‚Üí <a href="https://habr.com/ru/company/ruvds/blog/477276/">Leer la segunda parte</a> <br><br>  <b>Estimados lectores!</b>  ¬øHa encontrado el problema de tener c√≥digo CSS no utilizado en sus proyectos? <br><br><div style="text-align:center;"> <a href="https://ruvds.com/vps_start/"><img src="https://habrastorage.org/webt/-o/2e/tu/-o2etuqogwhmdnmysb9_vivc9v4.png"></a> </div><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/477274/">https://habr.com/ru/post/477274/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../477262/index.html">Androides de la empresa Promobot. Vista lateral</a></li>
<li><a href="../477264/index.html">La excavadora se convirti√≥ en un robot aut√≥nomo capaz de cavar trincheras de forma independiente</a></li>
<li><a href="../477266/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 390 (18-24 de noviembre de 2019)</a></li>
<li><a href="../477268/index.html">Optimizaci√≥n de soluciones de b√∫squeda en github</a></li>
<li><a href="../477272/index.html">Primera introducci√≥n a AssemblyScript</a></li>
<li><a href="../477276/index.html">¬øC√≥mo deshacerse del c√≥digo CSS no utilizado? Parte 2</a></li>
<li><a href="../477278/index.html">Pruebas frontend</a></li>
<li><a href="../477282/index.html">Perfilar el c√≥digo del proyecto Go y resolver problemas de asignaci√≥n de memoria</a></li>
<li><a href="../477284/index.html">¬øPor qu√© se requiere JavaScript en modo estricto?</a></li>
<li><a href="../477286/index.html">Axios o Fetch: ¬øqu√© usar en 2019?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>