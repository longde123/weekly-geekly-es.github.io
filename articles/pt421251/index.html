<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèΩ üêÉ üëÜüèª Sistema de backup üë©üèª‚Äçüöí üòΩ üïµüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artigo faz parte de uma s√©rie sobre a cria√ß√£o de NAS e foi escrito para um tipo espec√≠fico de sistema. 


 O backup √© a segunda tarefa principal ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistema de backup</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421251/"><p><img src="https://habrastorage.org/webt/in/pk/uh/inpkuhyjnf8c-efshdvkj_edp7m.jpeg"></p><br><p>  Este artigo faz parte de uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">s√©rie sobre a cria√ß√£o de NAS</a> e foi escrito para um tipo espec√≠fico de sistema. </p><br><p>  O backup √© a segunda tarefa principal que eu queria resolver usando o NAS, depois <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do sistema de gerenciamento de reposit√≥rio</a> . </p><br><p>  Sua decis√£o se arrastou ... </p><br><p>  Muitos artigos e at√© v√°rios livros j√° foram escritos sobre esse t√≥pico, e muitas c√≥pias foram quebradas em disputas sobre esse assunto. </p><br><p>  Abaixo est√° uma tentativa de descobrir esse monte de material, coloc√°-lo na sua cabe√ßa e criar um pequeno sistema de forma relativamente competente. </p><a name="habracut"></a><br><p>  O sistema de backup (SRK) √© determinado por: </p><br><ul><li>  Pol√≠tica de backup.  A pol√≠tica define os principais objetivos e metas do backup, os requisitos para ele, com base na lista de amea√ßas para cada sistema de backup, e tamb√©m justifica sua necessidade. </li><li>  Regulamentos de backup baseados em pol√≠ticas.  O regulamento descreve os algoritmos de backup e recupera√ß√£o respons√°veis ‚Äã‚Äãpor backups, condi√ß√µes de armazenamento para backups, etc. </li><li>  Implementa√ß√£o instrumental.  Na verdade, software e hardware. </li></ul><br><p>  O processo de backup regular √© dividido nas seguintes partes principais: </p><br><ul><li>  In√≠cio peri√≥dico da c√≥pia. </li><li>  Inicie a recupera√ß√£o sob demanda. </li><li>  Testando o processo de c√≥pia. </li></ul><br><p>  Pontos de interface do sistema com a plataforma NAS: </p><br><ul><li> <code>tank0/apps/backup</code> - armazenamento de <code>tank0/apps/backup</code> . </li><li>  <code>tank1/apps/backup</code> - armazenamento de <code>tank1/apps/backup</code> . </li><li>  <code>https://backup.NAS.cloudns.cc</code> - interface do sistema baseada na Web. </li></ul><br><p>  Reposit√≥rios de backup s√£o <strong>sistemas de arquivos separados</strong> . <br>  Isso √© necess√°rio porque suas op√ß√µes podem ser muito diferentes, tanto dos sistemas de arquivos normais quanto entre si. </p><br><p>  Por exemplo, se necess√°rio, a desduplica√ß√£o por meio do FS pode ser ativada e a compacta√ß√£o pode ser desativada. </p><br><h2 id="principy-rezervnogo-kopirovaniya">  Princ√≠pios de backup </h2><br><p><img src="https://habrastorage.org/webt/t-/pe/i4/t-pei4njc4jilp-l0unqmcpanho.jpeg"></p><br><p>  Vale a pena entender que, embora eu esteja descrevendo aqui um caso especial de backup adaptado √†s necessidades de uma pequena rede, os princ√≠pios, observa√ß√µes e padr√µes s√£o comuns em todos os lugares. <br>  Em casos simples, alguns deles podem ser negligenciados, mas √© desej√°vel saber. </p><br><p>  Esses princ√≠pios s√£o baseados em pol√≠ticas e regulamentos. </p><br><p>  Aqui est√£o alguns b√°sicos: </p><br><ul><li>  <strong>3-2-1</strong> .  Fa√ßa pelo menos tr√™s backups, em dois formatos de armazenamento, dos quais pelo menos um deve ser armazenado em um local fisicamente separado.  √â desej√°vel observar o princ√≠pio.  No meu caso, esse princ√≠pio √© parcialmente implementado.  Em primeiro lugar, existem tr√™s m√°quinas diferentes nas quais os dados s√£o parcialmente duplicados: NAS, trabalho e laptop.  Em segundo lugar, a replica√ß√£o para a nuvem est√° planejada. </li><li>  <strong>Verifique o que foi copiado</strong> .  Caso contr√°rio, pode acontecer que em um momento crucial, os dados n√£o possam ser restaurados.  Verifique melhor atrav√©s do processo de recupera√ß√£o. </li><li>  <strong>Use as ferramentas certas para a tarefa</strong> .  √â prov√°vel que, ao copiar uma frota de m√°quinas virtuais, um sistema para copiar arquivos com um agente em uma m√°quina tenha um desempenho ruim.  O software especializado copia mais rapidamente e menos custosos nos recursos da m√°quina.  √â importante que a ferramenta seja confi√°vel e simples.  O IBS n√£o √© algo com o qual voc√™ normalmente queira se divertir. </li><li>  <strong>√â melhor copiar tudo, com a exce√ß√£o √≥bvia do excesso</strong> .  Ou "√© melhor ultrapassar do que n√£o terminar".  Ser√° poss√≠vel descartar o excesso, mas se a pol√≠tica inversa for usada, poder√° ser imposs√≠vel restaurar um arquivo valioso que voc√™ esqueceu de especificar explicitamente. </li><li>  <strong>Deve ser poss√≠vel selecionar e restaurar dados rapidamente</strong> .  √â aconselh√°vel "um clique" e n√£o espere uma hora.  Formalmente, voc√™ precisa ter um RTO aceit√°vel baixo e RPO suficiente.  √â extremamente conveniente se o IBS permitir restaurar acidentalmente exclu√≠do e escolher entre v√°rias vers√µes, e n√£o apenas a mais recente (por exemplo, se estiver danificada, porque erros l√≥gicos n√£o s√£o exclu√≠dos). </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">No final do artigo,</a> existem links para fontes que voc√™ pode estudar para se familiarizar mais com esses pontos e ler sobre outros. </p><br><h2 id="politika-rezervnogo-kopirovaniya">  Pol√≠tica de backup </h2><br><p>  Obviamente, o objetivo de qualquer backup √© reduzir o custo da destrui√ß√£o n√£o planejada de dados em situa√ß√µes de emerg√™ncia. </p><br><p>  Isso √© conseguido duplicando dados valiosos de m√°quinas em funcionamento para armazenamento de terceiros. </p><br><h3 id="zadachi-rezervnogo-kopirovaniya">  Tarefas de backup </h3><br><p>  As seguintes tarefas s√£o definidas para fins de backup: </p><br><ul><li>  Real√ßar dados de destino. </li><li>  Salvando os dados especificados para recupera√ß√£o subseq√ºente. </li><li>  Recupera√ß√£o de dados salvos. </li><li>  Garantir a estabilidade dos dados armazenados para altera√ß√£o e destrui√ß√£o. </li><li>  Diferencia√ß√£o do acesso aos dados armazenados. </li><li>  Fornecendo controle do sistema e processo de backup. </li></ul><br><h3 id="trebovaniya-k-sisteme">  Requisitos de sistema </h3><br><p>  Al√©m disso, na lista, os requisitos funcionais e n√£o funcionais s√£o misturados: </p><br><ul><li>  O backup deve ser realizado: <br><ul><li>  No hor√°rio. </li><li>  A pedido. </li><li>  Se voc√™ pular a anterior. </li></ul></li><li>  O backup de dados deve ser fornecido pelo menos 1 vez por dia, com profundidade de 1 m√™s.  A pr√°tica de tirar instant√¢neos, bem como usar a vers√£o anterior do sistema em uma m√°quina que funciona, mostra que isso √© suficiente para mim. </li><li>  O tempo de recupera√ß√£o de dados n√£o deve exceder 2 minutos por 1 GB (o limite da largura de banda da rede √© 81 s. Por 1 GB).  Levando em considera√ß√£o a largura de banda da LAN e a velocidade do disco, como fatores limitantes. </li><li>  Todos os canais devem ser criptografados.  Dados confidenciais, como dados de autoriza√ß√£o em servi√ßos online, podem ser salvos. </li><li>  Deve ser poss√≠vel criptografar os backups do usu√°rio com uma chave secreta na m√°quina do usu√°rio, sem a possibilidade de descriptografia no servidor.  Isso √© importante porque os usu√°rios n√£o precisam confiar no servidor. </li><li>  A c√≥pia incompleta n√£o deve demorar muito, por exemplo, mais de 30 minutos.  Internet √© usada para copiar dados de um laptop. </li><li>  Deve haver o potencial de replicar c√≥pias para a nuvem (a capacidade de configurar de forma flex√≠vel a replica√ß√£o para um armazenamento em nuvem espec√≠fico) com criptografia de backups.  Essa tamb√©m √© uma das consequ√™ncias do "princ√≠pio 3-2-1". </li><li>  Deve haver um gerenciamento centralizado simples com integra√ß√£o √† interface da web. </li><li>  Um m√≠nimo de melhorias e configura√ß√µes complexas no servidor. </li></ul><br><h3 id="sostav-rezerviruemyh-resursov">  Composi√ß√£o de recursos reservados </h3><br><p>  No meu caso, √© bastante t√≠pico: </p><br><ul><li>  A principal m√°quina de trabalho.  Computador de mesa. </li><li>  M√°quina de trabalho m√≥vel.  O laptop </li><li>  Roteador LAN.  Ele armazena configura√ß√µes de rede, que podem conter logins e senhas para uma conex√£o com a Internet e alguns servi√ßos. </li><li>  NAS  Sim, a configura√ß√£o do NAS tamb√©m √© redundante.  Apesar do fato de que a maioria dos FS possui snapshots. </li></ul><br><h3 id="sostav-ugroz">  Composi√ß√£o da amea√ßa </h3><br><p>  √â aqui, o qu√™ e o que deve ser protegido e de que maneira. </p><br><div class="spoiler">  <b class="spoiler_title">Para fazer isso, compilei uma pequena tabela de amea√ßas.</b> <div class="spoiler_text"><div class="scrollable-table"><table><thead><tr><th>  Recurso </th><th>  Amea√ßa </th><th>  Solu√ß√£o </th></tr></thead><tbody><tr><td>  M√°quina de trabalho principal </td><td>  Corrup√ß√£o de dados f√≠sicos </td><td>  Backup de dados e configura√ß√µes de chave </td></tr><tr><td>  M√°quina de trabalho principal </td><td>  Corrup√ß√£o direta parcial e impercept√≠vel de dados </td><td>  Mantendo backups mais antigos por algum tempo </td></tr><tr><td>  M√°quina de trabalho principal </td><td>  Perda de acesso a dados </td><td>  Armazenamento da imagem completa da m√°quina, ou <strong>configura√ß√µes, para uma r√°pida recupera√ß√£o em outra m√°quina</strong> ou duplica√ß√£o de fun√ß√µes em um PC m√≥vel </td></tr><tr><td>  M√°quina de trabalho principal </td><td>  Acesso f√≠sico n√£o autorizado a dados </td><td>  Criptografia de dados e backup, transfer√™ncia de c√≥pias criptografadas </td></tr><tr><td>  M√°quina de trabalho principal </td><td>  Acesso n√£o autorizado por viola√ß√£o de software </td><td>  Reserva de somas de verifica√ß√£o de software e reconcilia√ß√£o peri√≥dica, sistemas de controle (ainda n√£o implementados) </td></tr><tr><td>  M√°quina de trabalho m√≥vel </td><td>  Perder um carro junto com os dados </td><td>  Criptografia de dados, backup completo ou backup das principais configura√ß√µes e dados </td></tr><tr><td>  Roteador LAN </td><td>  Destrui√ß√£o de uma configura√ß√£o ou dispositivo </td><td>  Redund√¢ncia de configura√ß√£o, poss√≠vel redund√¢ncia de dispositivo </td></tr><tr><td>  Roteador LAN </td><td>  Perda de controle devido a hackers </td><td>  Reserva de configura√ß√£o </td></tr><tr><td>  Roteador LAN </td><td>  Corrup√ß√£o parcial e invis√≠vel de dados </td><td>  Armazenamento de soma de verifica√ß√£o de software e reconcilia√ß√£o peri√≥dica </td></tr><tr><td>  NAS </td><td>  Configura√ß√µes de servi√ßo corrompidas </td><td>  Reserva de reserva local </td></tr><tr><td>  NAS </td><td>  Corrup√ß√£o de dados f√≠sicos </td><td>  Replica√ß√£o na nuvem </td></tr><tr><td>  NAS </td><td>  Perda de acesso ao sistema e backups </td><td>  Replica√ß√£o na nuvem </td></tr><tr><td>  NAS </td><td>  Acesso n√£o autorizado a dados de terceiros </td><td>  Armazenamento e replica√ß√£o de dados em forma criptografada, troca de dados em forma criptografada </td></tr><tr><td>  NAS </td><td>  Acesso n√£o autorizado de administrador aos dados </td><td>  Criptografia de backups em chaves locais de m√°quinas redundantes </td></tr></tbody></table></div></div></div><br><p>  Todas as principais amea√ßas ao computador m√≥vel repetem as amea√ßas ao computador parado. <br>  Os computadores tablet praticamente n√£o diferem dos dispositivos m√≥veis, desse ponto de vista. </p><br><h3 id="dopolnitelnye-usloviya-politiki">  Termos adicionais da pol√≠tica </h3><br><p>  √â aconselh√°vel lev√°-los em considera√ß√£o: </p><br><ul><li>  Testes regulares de recupera√ß√£o devem ser realizados. </li><li>  Os procedimentos de recupera√ß√£o de falhas devem ser documentados. </li><li>  As a√ß√µes devem ser regulamentadas no caso de uma falha secund√°ria: o que fazer se, ap√≥s a restaura√ß√£o, o sistema n√£o estiver operacional ou os dados n√£o puderem ser restaurados. </li><li>  √â necess√°rio testar se o processo de recupera√ß√£o depende de equipamentos espec√≠ficos <br>  (que pode falhar no momento da recupera√ß√£o).  Eu, no meu caso, n√£o vou verificar isso, limitado apenas a uma verifica√ß√£o b√°sica do sistema. </li><li>  Se voc√™ tiver um backup completo do sistema, dever√° fazer o backup imediatamente ap√≥s uma atualiza√ß√£o substancial. </li><li>  Se o volume acumulado de backups incrementais exceder o volume de backup completo, √© racional fazer um backup completo n√£o programado.  Ou seja, a frequ√™ncia de cria√ß√£o de backups completos deve ser aumentada nesse caso. </li></ul><br><p>  N√£o levo em considera√ß√£o o √∫ltimo ponto da pol√≠tica, porque geralmente meu fluxo de trabalho n√£o muda e √© suficiente monitorar o volume por um tempo, apenas para a configura√ß√£o inicial. <br>  Empiricamente, verificou-se que o esquema "m√™s, semana, dia, hora" est√° bem comigo. <br>  Para sistemas maiores, pode ser necess√°rio alterar a frequ√™ncia de backup dinamicamente para cada sistema. </p><br><h2 id="reglament-rezervnogo-kopirovaniya">  Regulamentos de backup </h2><br><p>  Ap√≥s o desenvolvimento de uma pol√≠tica, √© poss√≠vel prosseguir com o desenvolvimento de um regulamento diretamente. <br>  No caso geral, pode haver v√°rios regulamentos: geral, para administradores do IBS, usu√°rios, respons√°veis ‚Äã‚Äãpelo armazenamento, administradores de sistemas de destino, etc. <br>  Por√©m, no caso de um sistema pequeno, geralmente √© uma pessoa e, portanto, existe apenas um regulamento. </p><br><h3 id="zadachi-reglamenta">  Os objetivos dos regulamentos </h3><br><ul><li>  Definindo procedimentos de backup de dados. </li><li>  Definindo procedimentos de recupera√ß√£o de dados. </li><li>  Definindo um procedimento de verifica√ß√£o de integridade do sistema. </li><li>  Condi√ß√µes de armazenamento de backup e requisitos de m√≠dia. </li><li>  Simplificando o trabalho. </li></ul><br><h3 id="primer-reglamenta">  Exemplo de regulamento </h3><br><p>  Sob o spoiler, voc√™ pode ver como s√£o as regras em uma grande organiza√ß√£o, usando o exemplo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20160731233007/">do regulamento Rosreestr retirado de fontes abertas</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Regulamento do Rosreestr.</b> <div class="spoiler_text"><h1 id="reglament-rezervnogo-kopirovaniya-dannyh-v-territorialnyh-podrazdeleniyah-rosreestra">  REGULAMENTO DO BACKUP DE DADOS NOS DEPARTAMENTOS TERRITORIAIS DE ROSRESTR </h1><br><h2 id="oglavlenie">  Sum√°rio </h2><br><ol><li>  Disposi√ß√µes Gerais </li><li>  Ordem de backup. </li><li>  Monitorando os resultados. </li><li>  Suporte regulat√≥rio. </li><li>  Rota√ß√£o da m√≠dia de backup. </li><li>  Restaurar informa√ß√µes de um backup. </li><li>  Ap√™ndice 1 </li><li>  Ap√™ndice 2 Lista de pessoas respons√°veis ‚Äã‚Äãpelo backup. </li></ol><br><h2 id="1--obschie-polozheniya">  <strong>1</strong> Geral </h2><br><p>  Este regulamento estabelece os requisitos b√°sicos para organizar o backup (recupera√ß√£o) de programas e dados armazenados em bancos de dados nos servidores da autoridade territorial de Rosreestr, bem como para fazer backup de hardware. </p><br><p>  O presente regulamento destina-se a: </p><br><ul><li>  determina√ß√£o da categoria de informa√ß√µes sujeitas a backup obrigat√≥rio; </li><li>  determinar o procedimento para fazer backup de dados para a restaura√ß√£o subsequente do desempenho dos sistemas de informa√ß√£o em caso de perda total ou parcial de informa√ß√µes causada por falhas ou mau funcionamento de hardware ou software, erros do usu√°rio, emerg√™ncias (inc√™ndio, desastres naturais, etc.); </li><li>  determinar o procedimento para recuperar informa√ß√µes no caso de tal necessidade; </li><li>  agilizando o trabalho e determinando a responsabilidade dos funcion√°rios relacionados ao backup e restaura√ß√£o de informa√ß√µes. </li></ul><br><p>  O backup de informa√ß√µes significa a cria√ß√£o de c√≥pias completas dos bancos de dados de produ√ß√£o do Office para a r√°pida recupera√ß√£o do sistema de gerenciamento de informa√ß√µes do Registro Unificado de Empresas do Estado AIS "Justi√ßa" no caso de uma emerg√™ncia que resulte em danos ou perda de dados. </p><br><p>  Todos os bancos de dados de produ√ß√£o de todos os departamentos territoriais do Office est√£o sujeitos a backup. </p><br><p>  A m√≠dia de armazenamento da m√°quina que cont√©m uma c√≥pia de backup recebe um carimbo de confidencialidade para o carimbo mais alto de informa√ß√£o neles contido. </p><br><p>  Os backups s√£o armazenados fora da sala do servidor, o acesso aos backups √© limitado.  A lista de pessoas que t√™m acesso aos dados √© formada com base em um pedido por escrito do chefe da unidade de tecnologia da informa√ß√£o (TI), acordado com o chefe da unidade de seguran√ßa da informa√ß√£o (SI).  Os direitos de acesso a meios t√©cnicos reservados, matrizes e m√≠dia de armazenamento s√£o alterados com base em um aplicativo do chefe do departamento de TI, acordado com o chefe do departamento de SI.  As tentativas detectadas de acesso n√£o autorizado √†s informa√ß√µes e hardware reservados, bem como outras viola√ß√µes de IS que ocorreram durante o processo de backup, s√£o relatadas √† unidade de IS com uma nota de servi√ßo durante o dia √∫til ap√≥s a detec√ß√£o do evento especificado. </p><br><h2 id="2-poryadok-rezervnogo-kopirovaniya">  <strong>2</strong> Ordem de backup </h2><br><p>  O backup √© feito por meio regular do Oracle DBMS.  O backup pode ser feito: </p><br><ul><li>  Manualmente - o operador respons√°vel pelo backup inicia o procedimento de exporta√ß√£o do Oracle (um exemplo de in√≠cio do procedimento no Ap√™ndice 1). </li><li>  Automaticamente - o arquivo execut√°vel que chama o procedimento de exporta√ß√£o Oracle √© iniciado automaticamente pelo sistema operacional, de acordo com o agendamento. </li></ul><br><p>  O backup do banco de dados √© realizado pelo menos 1 vez por dia.  O per√≠odo de armazenamento do banco de dados de backup √© de pelo menos 1 m√™s. </p><br><p>  A estrat√©gia de backup deve garantir a recupera√ß√£o s√≠ncrona de dados localizados em diferentes esquemas de banco de dados.  Por exemplo, o esquema HED (o reposit√≥rio de documentos eletr√¥nicos) deve ser copiado simultaneamente com o esquema AIS Justice. </p><br><p>  Os meios materiais e t√©cnicos do sistema de backup devem fornecer desempenho suficiente para salvar as informa√ß√µes no prazo e em intervalos especificados.  As pessoas respons√°veis ‚Äã‚Äãpela organiza√ß√£o di√°ria do backup monitoram a disponibilidade da quantidade de espa√ßo em disco necess√°ria para o backup. </p><br><h2 id="3-kontrol-rezultatov">  <strong>3</strong> Monitoramento de resultados </h2><br><p>  Os resultados de todos os procedimentos de backup s√£o monitorados pelos funcion√°rios respons√°veis ‚Äã‚Äãindicados no Ap√™ndice 2, at√© 10 horas no dia √∫til seguinte √† data estabelecida para a execu√ß√£o desses procedimentos. </p><br><p>  Se um erro for detectado, a pessoa respons√°vel pelo monitoramento dos resultados o reportar√° ao servi√ßo de suporte t√©cnico do desenvolvedor, o mais tardar 11 horas do dia √∫til atual. </p><br><h2 id="4-normativno-pravovoe-obespechenie">  <strong>4</strong> Suporte regulat√≥rio </h2><br><p>  Para organizar o processo de backup, voc√™ deve: </p><br><ul><li>  Defina uma lista de pessoas respons√°veis ‚Äã‚Äãpor executar o processo de backup e monitorar seus resultados (Ap√™ndice 2). </li><li>  Prepare e aprove uma programa√ß√£o de backup. </li><li>  Preparar e aprovar documentos regulat√≥rios internos sobre a nomea√ß√£o dos respons√°veis ‚Äã‚Äãpelo backup dos dados. </li></ul><br><h2 id="5-rotaciya-nositeley-rezervnoy-kopii">  <strong>5</strong> M√≠dia de backup rotativa </h2><br><p>  O sistema de backup deve fornecer a capacidade de substituir periodicamente (descarregar) a m√≠dia de backup sem perda de informa√ß√µes, al√©m de garantir a restaura√ß√£o das informa√ß√µes atuais dos sistemas automatizados no caso de falha de qualquer um dos dispositivos de backup.  Todos os procedimentos para carregar, descarregar m√≠dia do sistema de backup, bem como sua transfer√™ncia para o Servi√ßo de Seguran√ßa e vice-versa, s√£o executados pelo administrador de backup mediante solicita√ß√£o e na presen√ßa de um funcion√°rio respons√°vel do Servi√ßo de Seguran√ßa do Cliente (de acordo com o Ap√™ndice No. 2). </p><br><p>  Como novas transportadoras, √© permitido reutilizar aquelas para as quais o per√≠odo de armazenamento das informa√ß√µes contidas expirou. </p><br><p>  Informa√ß√µes confidenciais da m√≠dia que n√£o s√£o mais usadas no sistema de backup devem ser apagadas usando o software PGP. </p><br><h2 id="6-vosstanovlenie-informacii-iz-rezervnoy-kopii">  <strong>6</strong> Restaurar informa√ß√µes de um backup </h2><br><p>  Se necess√°rio, a restaura√ß√£o dos dados dos backups √© realizada pelo funcion√°rio respons√°vel do departamento de TI especificado no Ap√™ndice No. 2. </p><br><p>  A recupera√ß√£o de dados de backups ocorre no caso de seu desaparecimento ou viola√ß√£o devido ao acesso n√£o autorizado ao sistema, exposi√ß√£o a v√≠rus, erros de software, erros de funcion√°rios e falhas de hardware. </p><br><p>  A restaura√ß√£o do software do sistema e do software de uso geral √© realizada a partir de sua m√≠dia, de acordo com as instru√ß√µes do fabricante. </p><br><p>  A restaura√ß√£o de software especializado √© realizada a partir da m√≠dia de distribui√ß√£o ou de suas c√≥pias de backup, de acordo com as instru√ß√µes para instala√ß√£o ou restaura√ß√£o deste software. </p><br><p>  As informa√ß√µes que n√£o est√£o relacionadas √† constante altera√ß√£o dos bancos de dados s√£o restauradas a partir da m√≠dia de backup.  Isso usa a c√≥pia mais recente das informa√ß√µes. </p><br><p>  Em caso de viola√ß√£o parcial ou desaparecimento dos registros do banco de dados, a restaura√ß√£o √© realizada a partir da √∫ltima c√≥pia di√°ria n√£o perturbada.  Todas as informa√ß√µes s√£o restauradas a partir da √∫ltima c√≥pia. </p><br><h2 id="7-prilozhenie-1">  <strong>7</strong> Ap√™ndice 1 </h2><br><p>  Um exemplo de como iniciar o utilit√°rio de exporta√ß√£o Oracle na linha de comandos: </p><br><p>  exp userid = JUST_USER / PASSWORD @ SERVER owner = (JUST_USER, HED_USER) direto = Y consistente = Y statistics = NENHUMA compacta√ß√£o = N arquivo = C: \ BACKUP.DMP log = C: \ BACKUP.LOG </p><br><p>  onde: </p><br><p>  JUST_USER / PASSWORD @ SERVER <em>- nome do</em> propriet√°rio do esquema / senha @ nome do servidor; </p><br><p>  owner = (JUST_USER, HED_USER) - lista de esquemas copiados; neste exemplo, o esquema AIS Justice e o esquema HED s√£o exportados simultaneamente; </p><br><p>  file = C: \ BACKUP.DMP <em>-</em> caminho e nome do arquivo de exporta√ß√£o criado; </p><br><p>  log = C: \ BACKUP.LOG <em>-</em> caminho e nome do arquivo de log de exporta√ß√£o criado. </p><br><h2 id="8-prilozhenie-2-perechen-lic-otvetstvennyh-za-rezervnoe-kopirovanie">  <strong>8</strong> Ap√™ndice 2. Lista de pessoas respons√°veis ‚Äã‚Äãpelo backup </h2><br><div class="scrollable-table"><table><thead><tr><th>  <strong>No. p / p</strong> </th><th>  <strong>Fun√ß√£o</strong> </th><th>  <strong>Nome do respons√°vel</strong> </th></tr></thead><tbody><tr><td>  1 </td><td>  Configura√ß√£o inicial do sistema de backup. </td><td></td></tr><tr><td>  2 </td><td>  Fazendo altera√ß√µes significativas na configura√ß√£o do sistema de backup. </td><td></td></tr><tr><td>  3 </td><td>  An√°lise de logs de backup, acompanhando a necessidade de altera√ß√µes nas configura√ß√µes de backup, garantindo a rota√ß√£o da m√≠dia. </td><td></td></tr><tr><td>  4 </td><td>  Rota√ß√£o da m√≠dia, verificando a corre√ß√£o do backup, garantindo que o backup seja armazenado fora do escrit√≥rio em caso de desastre. </td><td></td></tr></tbody></table></div></div></div><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> voc√™ encontrar√° outro exemplo com uma breve descri√ß√£o. </p><br><h3 id="procedura-rezervirovaniya">  Procedimento de reserva </h3><br><p>  Composi√ß√£o dos dados de backup: </p><br><ul><li>  M√°quinas de trabalho: <br><ul><li>  Diret√≥rios pessoais de usu√°rios ( <code>/home/*</code> ).         . </li><li>   . </li><li>    ,   ( <code>/opt</code> ). </li><li>   ( <code>/etc</code> ). </li><li>    . </li><li>  . </li><li>   . </li><li>   . </li></ul></li><li> : <br><ul><li>  . </li></ul></li><li> NAS: <br><ul><li>    Docker . </li><li>   . </li><li>  . </li><li>    . </li><li>  . </li><li>     Docker . </li><li>   . </li><li>    . </li></ul></li><li>  : <br><ul><li>    . </li></ul></li></ul><br><p>  : </p><br><ul><li>       . </li><li>     ,    . </li><li>          <code>/etc/apt/apt.conf.d</code> ,  ,     . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> Mikrotik</a> . </li><li> NAS    . </li></ul><br><p>  : </p><br><ul><li>     1      .     . <br>  3 . </li><li>     1     . <br>  . </li><li>     1   . <br>  . </li><li>       . <br>  . </li><li>          . <br>    6 ,      . </li></ul><br><h3 id="procedura-vosstanovleniya">   </h3><br><p><img src="https://habrastorage.org/webt/qu/i3/il/qui3ilw9nczsm17-w7d1dwcalhy.jpeg"></p><br><ul><li>        ,  . </li><li>       ,    . </li></ul><br><p>        : </p><br><ul><li>   live . </li><li>        . </li><li>     ,  . </li></ul><br><p>  ,           Debian   (  Squeeze  2011 ),           Slackware  ReiserFS    . </p><br><p>       : </p><br><ul><li>    ,  . </li><li>       . </li><li>   ,    . </li><li>       . </li></ul><br><p> Mikrotik   ,    RouterOS . </p><br><h3 id="procedura-proverki-rabotosposobnosti">    </h3><br><ul><li>       . <br>   logcheck, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a> . </li><li>          . </li></ul><br><p>       ,    . </p><br><h3 id="usloviya-hraneniya-rezervnyh-kopiy-i-trebovaniya-k-nositelyam">         </h3><br><ul><li>      . </li><li>    1        . <br>              . </li><li>  .     . </li><li>    . </li></ul><br><h2 id="resheniya-dlya-rezervnogo-kopirovaniya">     </h2><br><p>     ,       . </p><br><h3 id="trebovaniya-k-po">    </h3><br><p>      : </p><br><ul><li>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Veeam</a>     ,   ,    .     ,    Acronis,    ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . </li><li>             . </li><li>          . </li></ul><br><h3 id="vybor-po">   </h3><br><p>          . <br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . </p><br><div class="spoiler"> <b class="spoiler_title">  .</b> <div class="spoiler_text"><h3 id="resheniya-na-baze-unix-utilit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solu√ß√µes Unix Utility </font></font></h3><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solu√ß√µes baseadas em rsync, tar, rdiff-backup, etc. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o s√£o considerados devido √† grande quantidade de trabalho que precisar√° ser realizado e √† falta da interface WEB necess√°ria.</font></font></p><br><h3 id="bareoshttpswwwbareosorgen"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Breos</font></font></a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/kp/pa/7t/kppa7tts84fep2t5rfk52poagx4.png"></a> </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BareOS (Backup de recupera√ß√£o de arquivamento aberto de c√≥digo aberto) - fork do Bacula desde 2010. </font></font></p><br><p>  Pr√≥s: </p><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sistema depurado est√°vel. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Suporta v√°rios tipos de agentes em diferentes sistemas operacionais. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ele suporta v√°rios tipos de backup: incremental, diferencial, completo. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A interface WEB √© muito desenvolvida e funcional. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Configura√ß√£o flex√≠vel. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> H√° um driver FUSE que mostra backups. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Existe uma liga√ß√£o para Python que permite que voc√™ interaja com o Director. </font></font></li><li>       (, ). </li><li>       . </li><li>     . </li></ul><br><p>  Contras: </p><br><ul><li>    . </li><li>   . </li><li>    . </li><li>   ,    . </li><li>   (500+ ),    ,          . </li></ul><br><h3 id="backuppchttpbackuppcsourceforgenet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BackupPC</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/zi/dv/e4/zidve44-5zrteeqdkiosyigkvwu.png"></a> </p><br><p>    . </p><br><p>   : </p><br><ul><li>    . </li><li>    . </li><li>  Web-. </li><li>    . </li><li> .    ,       . </li><li>   . </li><li>   ,   SMB, rsync. </li><li>      Web-. </li><li>     ,      . </li><li>  ,  ,      . </li><li>   . </li></ul><br><p>  Contras: </p><br><ul><li>   Perl,   CPAN. </li><li>    ,    ,     . <br>        ,   ,   ,     .   ,         SSH   ,   ,    , ..      . </li><li>      (  ,    ). </li></ul><br><h3 id="urbackuphttpswwwurbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UrBackup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/u1/lo/ed/u1loed_wq1-njxjlq1f7ths2kso.png"></a> </p><br><p> -     . </p><br><p>   : </p><br><ul><li>  . </li><li>  Web-. </li><li>    . </li><li>      ( .. ). </li><li>   Windows, Linux, MacOS X. </li><li>    :     ,        . </li><li>     . </li><li>     . </li><li>      (,  Outlook,     ). </li><li>   .    ,       . </li><li>   (,   ..)     . </li><li>  . </li><li>    ,     . </li><li>     ,      . </li><li>   . </li><li>      Internet. </li><li>   (,  ) . </li><li>     . </li><li>     (,   USB ). </li><li>  . </li><li>  GUI     . </li></ul><br><p>  Contras: </p><br><ul><li>   Windows,    , . </li><li>      NTFS. </li><li>  LDAP,   ,  ,   AD      . </li></ul><br><h3 id="restichttpsresticnet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Restic</a> </h3><br><p>         . </p><br><p>   : </p><br><ul><li>  . </li><li>      . </li><li> .    ,       . </li><li>   / .   .    . </li><li>       .    . </li><li>   . </li><li>  FUSE ,       host/. </li></ul><br><p>  Contras: </p><br><ul><li> Web- . </li><li>    RAM (~2.7GB  1TB). </li><li>   ACL   . </li><li>     RAM   . </li><li>      (     ). </li><li>       (        ).    . </li><li>       restic. </li></ul><br><h3 id="borgbackuphttpswwwborgbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BorgBackup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/a_/qp/rh/a_qprhceevkysy_nk_xg20os5x0.jpeg"></a> </p><br><p>     . </p><br><p>   : </p><br><ul><li>   . </li><li>        . </li><li>   (   Python,      C  ). </li><li> . </li><li> : LZ4, zlib, LZMA. </li><li>  FUSE ,   . </li><li>     : Linux, macOS, BSD, etc. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> Web-,   </a> . </li><li>    . </li></ul><br><p>  Contras: </p><br><ul><li> Web-  . </li><li>     Windows (  Linux subsystem  cygwin). </li></ul><br><h3 id="lsyncdhttpsgithubcomaxkibelsyncd"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lsyncd</a> </h3><br><p> ,      rsync. </p><br><p>   : </p><br><ul><li>  inotify  fsevents    .     rsync   . </li><li>     rsync. </li><li>   Lua,     Lua. </li><li>      . </li><li>  . </li></ul><br><p>  Contras: </p><br><ul><li>  .   Web-   . </li></ul><br><h3 id="box-backuphttpswwwboxbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Box Backup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/4e/o-/ta/4eo-taslxisuzzofmwhmmjtjxmk.png"></a> </p><br><p>       . <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a> . </p><br><p>   : </p><br><ul><li>                 ,  . </li><li>  ,  TLS,   ,     SSL . </li><li>    ,   "" ,    . </li><li>      . </li><li> ,   :   ,   . </li><li>      ,    . </li><li>  . </li><li>      :     . </li><li>      RAID. </li><li>  *nix-like , Windows native, Windows cygwin. </li><li>   GUI. </li></ul><br><p>  Contras: </p><br><ul><li>     ,    UID.       ,    . </li><li>  Web-. </li></ul></div></div><br><p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UrBackup</a> . <br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . </p><br><p>           . </p><br><h3 id="nastroyka-servera-urbackup">   UrBackup </h3><br><p>        ,   : </p><br><pre> <code class="plaintext hljs"># zfs create -o com.sun:auto-snapshot=false -p tank0/apps/backup # zfs set compression=on tank0/apps/backup</code> </pre> <br><p>   ,     ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  UrBackup  ZFS </a> . </p><br><p>   ,            : </p><br><pre> <code class="plaintext hljs"># zfs set dedup=on tank0/apps/backup</code> </pre> <br><p>     UrBackup  : </p><br><pre> <code class="plaintext hljs"># mkdir /tank0/docker/services/urbackup # cd /tank0/docker/services/urbackup # vim docker-compose.yml # docker-compose up -d</code> </pre> <br><p>   docker-compose  . <br>     Web-      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> . </p><br><div class="spoiler">  <b class="spoiler_title">docker-compose.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: '2' networks: docker0: external: name: docker0 services: urbackup: uroni/urbackup-server image: restart: always expose: - 55414 ports: # - 55413:55413 - 55415:55415 - 35623:35623/udp volumes: - /tank0/apps/backup/urbackup/database:/var/urbackup - /tank0/apps/backup/urbackup/backups:/backups - /tank0/apps/backup/urbackup/log:/var/log - /etc/localtime:/etc/localtime:ro networks: - docker0 environment: - VIRTUAL_HOST=backup.* - VIRTUAL_PORT=55414 - VIRTUAL_PROTO=http - CERT_NAME=NAS.cloudns.cc - TZ=Europe/Moscow</code> </pre> </div></div><br><p>  Docker  <code>uroni/urbackup-server</code>  ,      <code>tristanteu/urbackup-docker</code> . <br>       . </p><br><p> ,      : </p><br><ol><li>  .           UrBackup  LDAP . </li><li>    LDAP.  LDAP  .  "   ".  ,      . </li><li>   . </li><li>       ,  .   .     .  ,       NAS,     . </li><li>  -. </li></ol><br><p>   : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/03/xx/3d/03xx3dgvb6xtswdsfejbdakwwkg.png"></a> </p><br><p>  : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/um/0u/1h/um0u1h_i9ikrjhpgt-ppfyjubzs.png" alt="Adicionando Admin"></a> </p><br><p> LDAP    ,     :     ,         . </p><br><p>      : </p><br><pre> <code class="bash hljs">ou=users,dc=nas,dc=nas?memberOf,objectClass?sub?(&amp;(memberOf=cn=users_backup,ou=groups,dc=nas,dc=nas)(uid={USERNAME}))</code> </pre> <br><p>   - ,    . </p><br><p> <a href=""><img src="https://habrastorage.org/webt/az/wb/0q/azwb0qxoafmccqrzs1iyrchpi2q.png" alt="Configura√ß√£o LDAP"></a> </p><br><p>     ,      ,       . <br>       ,     : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/xi/cx/vn/xicxvnphcifc4z8ocwwrem8hqei.png"></a> </p><br><p>  -: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sp/vk/uc/spvkuc8fxj9-vxldm4k9qmb7c6o.png"></a> </p><br><p>  ,     ,        . </p><br><p> ,  UrBackup: </p><br><ul><li>  TCP 55415 ‚Äî   . </li><li>  TCP 55414 ‚Äî Web-  HTTP. </li><li>  TCP 55413 ‚Äî Web-  FastCGI,        Web-.  Porque    NAS  HTTP/HTTPS,    . </li><li>  TCP 35621 ‚Äî           . </li><li>  UDP 35622 ‚Äî       .        .      . </li><li>  TCP 35623 ‚Äî              . </li><li>  UDP 35623 ‚Äî    . </li></ul><br><p> ,  55415    ,   35621, 35622, 35623         . </p><br><h3 id="ustanovka-agenta">   </h3><br><p>            ,      . </p><br><p>     : </p><br><ul><li>   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>  shell . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  GUI</a> ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Docker-</a> . </li></ul><br><p>   UrBackup , ..      ,            : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/-k/e3/k4/-ke3k4w2aornwpmehottv2shgxk.png" alt="P√°gina de download do agente"></a> </p><br><p>      . </p><br><p>     shell : </p><br><pre> <code class="bash hljs">TF=`mktemp` &amp;&amp; wget <span class="hljs-string"><span class="hljs-string">"https://NAS.system.cloudns.cc/x?a=download_client&amp;lang=ru&amp;clientid=1&amp;authkey=KEY&amp;os=linux"</span></span> -O <span class="hljs-variable"><span class="hljs-variable">$TF</span></span> &amp;&amp; sh <span class="hljs-variable"><span class="hljs-variable">$TF</span></span>; rm <span class="hljs-variable"><span class="hljs-variable">$TF</span></span></code> </pre> <br><p>         : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># urbackupclientctl status { "capability_bits": 65548, "finished_processes": [], "internet_connected": true, "internet_status": "connected", "last_backup_time": 0, "running_processes": [], "servers": [], "time_since_last_lan_connection": 152446032 }</span></span></code> </pre> <br><p>    NAS     ,   : </p><br><ul><li>  : <code>/etc;/home;/var;/root;/tank0/apps;/tank0/docker</code> . </li><li> : <code>/tank0/apps/backup;/tank1/apps/backup;/tank0/apps/cloud/nextcloud/html/data</code> . </li></ul><br><p>       ,   ,  ,    ,  ,     . </p><br><p>  ,     ,  , "  ",  ,   : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/qr/np/ts/qrnptsrut7fv4rumu7rde8fwypm.png"></a> </p><br><p>       : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend status ‚óè urbackupclientbackend.service - UrBackup Client backend Loaded: loaded (/lib/systemd/system/urbackupclientbackend.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2019-09-30 21:55:53 MSK; 37min ago Main PID: 1694 (urbackupclientb) Tasks: 14 (limit: 4915) Memory: 13.4G CGroup: /system.slice/urbackupclientbackend.service ‚îî‚îÄ1694 /usr/local/sbin/urbackupclientbackend --config /etc/default/urbackupclient --no-consoletime  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/   .djvu"  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/  .doc"  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/-.fb2"</span></span></code> </pre> <br><h3 id="problemy">  Os problemas </h3><br><p>  , UrBackup       ,   .     . <br>    ‚Äî    -,    . </p><br><div class="spoiler"> <b class="spoiler_title">    ...</b> <div class="spoiler_text"><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend status ‚óè urbackupclientbackend.service - UrBackup Client backend Loaded: loaded (/lib/systemd/system/urbackupclientbackend.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2019-09-30 20:36:54 MSK; 9s ago Main PID: 27034 (urbackupclientb) Tasks: 10 (limit: 4915) Memory: 6.1M CGroup: /system.slice/urbackupclientbackend.service ‚îî‚îÄ27034 /usr/local/sbin/urbackupclientbackend --config /etc/default/urbackupclient --no-consoletime  30 20:36:54 host urbackupclientbackend[27034]: urbackupserver: Server started up successfully!  30 20:36:54 host urbackupclientbackend[27034]: FileSrv: Server started up successfully  30 20:36:54 host urbackupclientbackend[27034]: Started UrBackupClient Backend...  30 20:36:55 host urbackupclientbackend[27034]: Looking for old Sessions... 2 sessions  30 20:36:56 host urbackupclientbackend[27034]: Trying to connect to internet server "NAS.system.cloudns.cc" at port 55415  30 20:36:56 host urbackupclientbackend[27034]: Successfully connected.  30 20:36:56 host urbackupclientbackend[27034]: ERROR: Internet server auth failed. Error: Auth failed (Authkey/password wrong)  30 20:36:56 host urbackupclientbackend[27034]: InternetClient: Had an auth error  30 20:36:56 host urbackupclientbackend[27034]: ERROR: Internet server auth failed. Error: Auth failed (Authkey/password wrong)  30 20:36:56 host urbackupclientbackend[27034]: InternetClient: Had an auth error</span></span></code> </pre> </div></div><br><p>     : </p><br><pre> <code class="bash hljs">ERROR: Internet mode not enabled. Please <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"internet_mode_enabled"</span></span> to <span class="hljs-string"><span class="hljs-string">"true"</span></span>.</code> </pre> <br><p>             . </p><br><p>        : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend stop ~# rm -rf /usr/local/var/urbackup/</span></span></code> </pre> <br><p>      <code>/etc/default/urbackupclient</code> ,     . </p><br><p>          ,     <code>/usr/local/var/urbackup/data/settings.cfg</code> . </p><br><p>   ,    ,     : </p><br><pre> <code class="plaintext hljs">internet_server=NAS.system.cloudns.cc internet_server_port=55415 internet_authkey=44R3MUIdB computername=zenbook internet_mode_enabled=true</code> </pre> <br><p>   ,   ,     -. <br>  ,     ,   ,      . </p><br><h3 id="zapusk-polnogo-rezervnogo-kopirovaniya-posle-obnovleniya">       </h3><br><p>  Debian,    ,       <code>/etc/apt/apt.conf.d/80full-backup</code> : </p><br><pre> <code class="python hljs">DPkg::Post-Invoke {<span class="hljs-string"><span class="hljs-string">"test -x /usr/local/bin/urbackupclientctl &amp;&amp; /usr/local/bin/urbackupclientctl start -f || true"</span></span>; };</code> </pre> <br><h3 id="rezervnaya-kopiya-routera">    </h3><br><p>    NAS,    .  ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mtbackup</a>  SSH,    NAS. <br>    Python    ,   ,    ,    UrBakup,   . </p><br><h3 id="proverka-vosstanovleniya">   </h3><br><p>   : </p><br><ul><li> . </li><li> . </li></ul><br><p> ,     :         .  ,    . </p><br><p>    ,   : </p><br><ul><li>    . </li><li>    ,   . </li><li>    . </li><li>  ,   ,   . </li><li>    . </li><li>   . </li><li>   ,   . </li></ul><br><p>   ,   - ,     . </p><br><h2 id="oblachnye-servisy-dlya-rezervirovaniya">     </h2><br><p><img src="https://habrastorage.org/webt/ms/no/j4/msnoj4lqhhfm-keodwyhhdoaudm.jpeg"></p><br><p>       . <br>      ,        ,          . <br>       -  ,     ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Storj</a> . </p><br><h2 id="literatura">  Literatura </h2><br><p>     ,       ,     : </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    debian-russian</a> .   ,  "  rsync?". </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">" "</a> . </li><li> " 3-2-1" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  Veeam</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   </a> . </li><li>  , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  </a> ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   Veeam</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20181201152034/">"    "</a>  ,  ,   . </li><li>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">" :     "</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    </a> ,          . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    </a> . </li></ul><br><p> ,     : </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">W. Curtis Preston ‚Äî "Backup &amp; Recovery" ‚Äî 2000</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> .. ‚Äî     </a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> . ‚Äî Backup  "" ‚Äî 2014</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Steven Nelson ‚Äî Pro Data Backup and Recovery ‚Äî 2011</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dorian Cougias ‚Äî The Backup Book: Disaster Recovery from Desktop to Data Center, 3 edition ‚Äî 2003</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>      (2017 )  . </li></ul><br><p>      . </p><br><p>       ,          RTO, RPA, RPO. ,    ,         ,      . </p><br><p> -      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   NAS</a> , , ,   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt421251/">https://habr.com/ru/post/pt421251/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt421241/index.html">Banco Central pede bloqueio preventivo de sites maliciosos</a></li>
<li><a href="../pt421243/index.html">LLTR Parte 2: Algoritmo para determinar a topologia de rede a partir de estat√≠sticas coletadas</a></li>
<li><a href="../pt421245/index.html">C #: um caso de uso para qualquer tarefa</a></li>
<li><a href="../pt421247/index.html">Como transformar gr√°ficos em som e por que voc√™ precisa</a></li>
<li><a href="../pt421249/index.html">Por que os financiadores de Wall Street trabalham demais e podem ser corrigidos</a></li>
<li><a href="../pt421253/index.html">Por que precisamos de carros de cauda?</a></li>
<li><a href="../pt421255/index.html">Elon Musk abandonou os planos de transformar Tesla em uma empresa privada</a></li>
<li><a href="../pt421257/index.html">Como uma rede internacional de hackers conseguiu US $ 100 milh√µes roubando press releases</a></li>
<li><a href="../pt421259/index.html">Se voc√™ est√° pensando em come√ßar a escrever no Go, aqui est√° o que voc√™ deve saber</a></li>
<li><a href="../pt421261/index.html">O efeito da acrasia: por que n√£o cumprimos nossos planos e o que fazer com isso</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>