<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßìüèª üëí ‚õÑÔ∏è Navigation dans l'application Android √† l'aide de coordinateurs üìà üå™Ô∏è üêô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours des derni√®res ann√©es, nous avons d√©velopp√© des approches communes pour la cr√©ation d'applications Android. Architecture pure, mod√®les archite...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Navigation dans l'application Android √† l'aide de coordinateurs</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/416301/">  Au cours des derni√®res ann√©es, nous avons d√©velopp√© des approches communes pour la cr√©ation d'applications Android.  Architecture pure, mod√®les architecturaux (MVC, MVP, MVVM, MVI), mod√®le de r√©f√©rentiel et autres.  Cependant, il n'existe toujours pas d'approche g√©n√©ralement accept√©e pour organiser la navigation dans l'application.  Aujourd'hui, je veux vous parler du mod√®le ¬´coordinateur¬ª et des possibilit√©s de son application dans le d√©veloppement d'applications Android. <br><blockquote>  Le mod√®le de coordinateur est souvent utilis√© dans les applications iOS et a √©t√© introduit par Soroush Khanlou afin de simplifier la navigation de l'application.  On pense que le travail de Sorush est bas√© sur l‚Äôapproche du contr√¥leur d‚Äôapplication d√©crite dans les mod√®les d‚Äôarchitecture d‚Äôapplication d‚Äôentreprise de Martin Fowler. <br></blockquote>  Le mod√®le ¬´coordinateur¬ª est con√ßu pour r√©soudre les t√¢ches suivantes: <br><br><ul><li>  lutte avec le probl√®me Massive View Controller (le probl√®me √©tait d√©j√† √©crit sur le hub - note du traducteur), qui se manifeste souvent avec l'av√®nement de God-Activity (activit√© avec beaucoup de responsabilit√©s). </li><li>  s√©paration de la logique de navigation en une entit√© distincte </li><li>  r√©utilisation des √©crans d'application (activit√© / fragments) en raison d'une faible connexion avec la logique de navigation </li></ul><br>  Mais, avant de vous familiariser avec le mod√®le et d'essayer de l'impl√©menter, jetons un coup d'≈ìil aux impl√©mentations de navigation utilis√©es dans les applications Android. <br><a name="habracut"></a><br><h3>  La logique de navigation est d√©crite dans l'activit√© / le fragment </h3><br>  √âtant donn√© que le SDK Android n√©cessite Context pour ouvrir une nouvelle activit√© (ou FragmentManager afin d'ajouter un fragment √† l'activit√©), la logique de navigation est souvent d√©crite directement dans l'activit√© / le fragment.  M√™me les exemples de la documentation du SDK Android utilisent cette approche. <br><br><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShoppingCartActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(b) setContentView(R.layout.activity_shopping_cart) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> checkoutButton = findViewById(R.id.checkoutButton) checkoutButton.setOnClickListener { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> intent = Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, CheckoutActivity::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">startActivity</span></span></span></span>(intent) } } }</code> </pre> <br>  Dans l'exemple ci-dessus, la navigation est √©troitement li√©e √† l'activit√©.  Est-il pratique de tester un tel code?  On pourrait faire valoir que nous pouvons s√©parer la navigation en une entit√© distincte et la nommer, par exemple, Navigateur, qui peut √™tre impl√©ment√©.  Voyons voir: <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShoppingCartActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> navigator : Navigator <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(b) setContentView(R.layout.activity_shopping_cart) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> checkoutButton = findViewById(R.id.checkoutButton) checkoutButton.setOnClickListener { navigator.showCheckout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Navigator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showCheckout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(activity : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Activity</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> intent = Intent(activity, CheckoutActivity::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">activity</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">startActivity</span></span></span></span>(intent) } }</code> </pre><br>  Cela s'est av√©r√© pas mal, mais j'en veux plus. <br><br><h3>  Navigation avec MVVM / MVP </h3><br>  Je vais commencer par la question: o√π placeriez-vous la logique de navigation lors de l'utilisation de MVVM / MVP? <br><br>  Dans la couche sous le pr√©sentateur (appelons cela la logique m√©tier)?  Ce n'est pas une bonne id√©e, car vous r√©utiliserez tr√®s probablement votre logique m√©tier dans d'autres mod√®les de pr√©sentation ou pr√©sentateurs. <br><br>  Dans la couche d'affichage?  Voulez-vous vraiment lancer des √©v√©nements entre la pr√©sentation et le mod√®le pr√©sentateur / pr√©sentation?  Regardons un exemple: <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShoppingCartActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ShoppingCartView</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> navigator : Navigator <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> presenter : ShoppingCartPresenter <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(b) setContentView(R.layout.activity_shopping_cart) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> checkoutButton = findViewById(R.id.checkoutButton) checkoutButton.setOnClickListener { presenter.checkoutClicked() } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">navigateToCheckout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigator.showCheckout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShoppingCartPresenter</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Presenter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ShoppingCartView</span></span></span><span class="hljs-class">&gt; </span></span>{ ... <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkoutClicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ view?.navigateToCheckout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } }</code> </pre><br>  Ou si vous pr√©f√©rez MVVM, vous pouvez utiliser SingleLiveEvents ou EventObserver <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShoppingCartActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ShoppingCartView</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> navigator : Navigator <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> viewModel : ViewModel <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(b) setContentView(R.layout.activity_shopping_cart) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> checkoutButton = findViewById(R.id.checkoutButton) checkoutButton.setOnClickListener { viewModel.checkoutClicked() } viewModel.navigateToCheckout.observe(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Observer { navigator.showCheckout(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) }) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShoppingCartViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ViewModel</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> navigateToCheckout = MutableLiveData&lt;Event&lt;<span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkoutClicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigateToCheckout.value = Event(<span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>) <span class="hljs-comment"><span class="hljs-comment">// Trigger the event by setting a new Event as a new value } }</span></span></code> </pre><br>  Ou pla√ßons un navigateur dans un mod√®le de vue au lieu d'utiliser EventObserver comme indiqu√© dans l'exemple pr√©c√©dent <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ShoppingCartViewModel @Inject <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(val navigator : Navigator)</span></span></span><span class="hljs-function"> :</span></span> ViewModel() <span class="hljs-comment"><span class="hljs-comment">{ fun checkoutClicked(){ navigator.showCheckout() }</span></span> }</code> </pre><br>  Veuillez noter que cette approche peut √™tre appliqu√©e au pr√©sentateur.  Nous ignorons √©galement une √©ventuelle fuite de m√©moire dans le navigateur s'il conserve un lien vers l'activateur. <br><br><h3>  Coordinateur </h3><br>  Alors, o√π pla√ßons-nous la logique de navigation?  Logique m√©tier?  Plus t√¥t, nous avons d√©j√† envisag√© cette option et sommes arriv√©s √† la conclusion que ce n'√©tait pas la meilleure solution.  Lancer des √©v√©nements entre la vue et le mod√®le de vue peut fonctionner, mais cela ne ressemble pas √† une solution √©l√©gante.  De plus, la vue est toujours responsable de la logique de navigation, m√™me si nous l'avons apport√©e au navigateur.  Suite √† la m√©thode d'exclusion, nous avons toujours la possibilit√© de placer la logique de navigation dans le mod√®le de pr√©sentation, et cette option semble prometteuse.  Mais le mod√®le de vue doit-il se soucier de la navigation?  N'est-ce pas juste une couche entre la vue et le mod√®le?  C'est pourquoi nous sommes arriv√©s √† la notion de coordinateur. <br><br>  "Pourquoi avons-nous besoin d'un autre niveau d'abstraction?"  - demandez-vous.  Vaut-il la complexit√© du syst√®me?  Dans les petits projets, l'abstraction peut vraiment s'av√©rer utile pour l'abstraction, cependant, dans les applications complexes ou dans le cas de l'utilisation de tests A / B, le coordinateur peut √™tre utile.  Supposons qu'un utilisateur puisse cr√©er un compte et se connecter.  Nous avons d√©j√† une certaine logique, o√π nous devons v√©rifier si l'utilisateur s'est connect√© et afficher soit l'√©cran de connexion, soit l'√©cran principal de l'application.  Le coordinateur peut vous aider avec l'exemple donn√©.  Notez que le coordinateur n'aide pas √† √©crire moins de code; il aide √† obtenir le code de la logique de navigation √† partir de la vue ou du mod√®le de vue. <br><br>  L'id√©e du coordinateur est extr√™mement simple.  Il ne sait que quel √©cran d'application ouvrir ensuite.  Par exemple, lorsqu'un utilisateur clique sur le bouton de paiement d'une commande, le coordinateur re√ßoit l'√©v√©nement correspondant et sait que l'√©tape suivante consiste √† ouvrir l'√©cran de paiement.  Dans iOS, le coordinateur est utilis√© comme localisateur de services pour cr√©er des ViewControllers et contr√¥ler la pile arri√®re.  Cela suffit pour le coordinateur (rappelez-vous le principe de la responsabilit√© exclusive).  Dans les applications Android, le syst√®me cr√©e des activit√©s, nous avons de nombreux outils pour impl√©menter les d√©pendances et il y a un backstack pour les activit√©s et les fragments.  Revenons maintenant √† l'id√©e originale du coordinateur: le coordinateur sait simplement quel √©cran sera le prochain. <br><br><h3>  Exemple: application d'actualit√©s utilisant un coordinateur </h3><br>  Parlons enfin directement du mod√®le.  Imaginez que nous devons cr√©er une application de nouvelles simple.  L'application dispose de 2 √©crans: ¬´liste d'articles¬ª et ¬´texte d'article¬ª, qui s'ouvre en cliquant sur un √©l√©ment de la liste. <br><br><img src="https://habrastorage.org/webt/yw/oy/cl/ywoycl_vvhclm0s6wlwkzpcgzpk.png"><br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewsFlowCoordinator</span></span></span><span class="hljs-class"> </span></span>(<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> navigator : Navigator) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigator.showNewsList() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readNewsArticle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>{ navigator.showNewsArticle(id) } }</code> </pre><br>  Un script (Flow) contient un ou plusieurs √©crans.  Dans notre exemple, le sc√©nario de l'actualit√© se compose de 2 √©crans: ¬´liste d'articles¬ª et ¬´texte d'article¬ª.  Le coordinateur √©tait extr√™mement simple.  Lorsque l'application d√©marre, nous appelons NewsFlowCoordinator # start () pour afficher une liste d'articles.  Lorsqu'un utilisateur clique sur un √©l√©ment de la liste, la m√©thode NewsFlowCoordinator # readNewsArticle (id) est appel√©e et un √©cran avec le texte int√©gral de l'article s'affiche.  Nous travaillons toujours avec le navigateur (nous en reparlerons un peu plus tard), auquel nous d√©l√©guons l'ouverture de l'√©cran.  Le coordinateur n'a pas d'√©tat, il ne d√©pend pas de l'impl√©mentation du back-end et impl√©mente une seule fonction: il d√©termine o√π aller ensuite. <br><br>  Mais comment connecter le coordinateur √† notre mod√®le de pr√©sentation?  Nous suivrons le principe de l'inversion de d√©pendance: nous passerons le lambda au mod√®le de vue, qui sera appel√© lorsque l'utilisateur tapotera sur l'article. <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewsListViewModel</span></span></span></span>( newsRepository : NewsRepository, <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onNewsItemClicked: ( (<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> )? ) : ViewModel() { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> newsArticles = MutableLiveData&lt;List&lt;News&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> disposable = newsRepository.getNewsArticles().subscribe { newsArticles.value = it } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newsArticleClicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>{ onNewsItemClicked!!(id) <span class="hljs-comment"><span class="hljs-comment">// call the lambda } override fun onCleared() { disposable.dispose() onNewsItemClicked = null // to avoid memory leaks } }</span></span></code> </pre><br>  onNewsItemClicked: (Int) -&gt; Unit est un lambda qui a un argument entier et renvoie Unit.  Veuillez noter que lambda peut √™tre nul, cela nous permettra d'effacer le lien afin d'√©viter une fuite de m√©moire.  Le cr√©ateur du mod√®le de vue (par exemple, une dague) doit transmettre un lien vers la m√©thode coordinatrice: <br><br><pre> <code class="hljs lisp">return NewsListViewModel( <span class="hljs-name"><span class="hljs-name">newsRepository</span></span> = newsRepository, onNewsItemClicked = newsFlowCoordinator:<span class="hljs-symbol"><span class="hljs-symbol">:readNewsArticle</span></span> )</code> </pre><br>  Plus t√¥t, nous avons mentionn√© le navigateur, qui effectue le changement d'√©crans.  La mise en ≈ìuvre du navigateur est √† votre discr√©tion, car elle d√©pend de votre approche sp√©cifique et de vos pr√©f√©rences personnelles.  Dans notre exemple, nous utilisons une activit√© avec plusieurs fragments (un √©cran - un fragment avec son propre mod√®le de pr√©sentation).  Je donne une impl√©mentation na√Øve d'un navigateur: <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Navigator</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activity : FragmentActivity? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showNewsList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ activty!!.supportFragmentManager .beginTransaction() .replace(R.id.fragmentContainer, NewsListFragment()) .commit() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showNewsDetails</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(newsId: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { activty!!.supportFragmentManager .beginTransaction() .replace(R.id.fragmentContainer, NewsDetailFragment.newInstance(newsId)) .addToBackStack(<span class="hljs-string"><span class="hljs-string">"NewsDetail"</span></span>) .commit() } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppCompatActivity</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> navigator : Navigator <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) setContentView(R.layout.activity_main) navigator.activty = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onDestroy() navigator.activty = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-comment"><span class="hljs-comment">// Avoid memory leaks } }</span></span></code> </pre><br>  La mise en ≈ìuvre ci-dessus du navigateur n'est pas id√©ale, mais l'id√©e principale de ce message est d'introduire un coordinateur dans le mod√®le.  Il convient de noter que, puisque le navigateur et le coordinateur n'ont pas d'√©tat, ils peuvent √™tre d√©clar√©s dans l'application (par exemple, les √©tendues <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Singleton</a> dans un poignard) et peuvent √™tre instanci√©s dans Application # onCreate (). <br><br>  Ajoutons une autorisation √† notre application.  Nous allons d√©finir un nouvel √©cran de connexion (LoginFragment + LoginViewModel, pour plus de simplicit√©, nous allons omettre la r√©cup√©ration et l'enregistrement des mots de passe) et LoginFlowCoordinator.  Pourquoi ne pas ajouter de nouvelles fonctionnalit√©s √† NewsFlowCoordinator?  Nous ne voulons pas avoir un God-Coordinator qui sera responsable de toute la navigation dans l'application?  De plus, le script d'autorisation ne s'applique pas au sc√©nario du lecteur de news, non? <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginFlowCoordinator</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> navigator: Navigator ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigator.showLogin() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerNewUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigator.showRegistration() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forgotPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigator.showRecoverPassword() } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginViewModel</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> usermanager: Usermanager, <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onSignUpClicked: ( () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> )?, <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onForgotPasswordClicked: ( () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> )? ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(username : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, password : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>{ usermanager.login(username, password) ... } ... }</code> </pre><br>  Ici, nous voyons que pour chaque √©v√©nement d'interface utilisateur, il existe un lambda correspondant, mais il n'y a pas de lambda pour le rappel d'une connexion r√©ussie.  C'est aussi un d√©tail d'impl√©mentation et vous pouvez ajouter le lambda correspondant, mais j'ai une meilleure id√©e.  Ajoutons un RootFlowCoordinator et souscrivons aux modifications du mod√®le. <br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RootFlowCoordinator</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> usermanager: Usermanager, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> loginFlowCoordinator: LoginFlowCoordinator, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> newsFlowCoordinator: NewsFlowCoordinator, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onboardingFlowCoordinator: OnboardingFlowCoordinator ) { <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> { usermanager.currentUser.subscribe { user -&gt; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (user){ <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NotAuthenticatedUser -&gt; loginFlowCoordinator.start() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> AuthenticatedUser -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user.onBoardingCompleted) newsFlowCoordinator.start() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> onboardingFlowCoordinator.start() } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onboardingCompleted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ newsFlowCoordinator.start() } }</code> </pre><br>  Ainsi, RootFlowCoordinator sera le point d'entr√©e de notre navigation au lieu de NewsFlowCoordinator.  Concentrons-nous sur le RootFlowCoordinator.  Si l'utilisateur est connect√©, nous v√©rifions s'il a termin√© l'int√©gration (plus d'informations √† ce sujet plus tard) et commen√ßons le script pour les actualit√©s ou l'int√©gration.  Veuillez noter que LoginViewModel n'est pas impliqu√© dans cette logique.  Nous d√©crivons le sc√©nario d'int√©gration. <br><br><img src="https://habrastorage.org/webt/hm/dg/nq/hmdgnqdu3xrkvkkisqk0xdo5mnw.png"><br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OnboardingFlowCoordinator</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">navigator</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Navigator</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">onboardingFinished</span></span></span><span class="hljs-class">: () -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Unit</span></span></span><span class="hljs-class"> // this is </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RootFlowCoordinator</span></span></span><span class="hljs-class">.onboardingCompleted() ) { fun start(){ navigator.showOnboardingWelcome() } fun welcomeShown(){ navigator.showOnboardingPersonalInterestChooser() } fun onboardingCompleted(){ onboardingFinished() } }</span></span></code> </pre><br>  Onboarding est d√©marr√© en appelant OnboardingFlowCoordinator # start (), qui affiche WelcomeFragment (WelcomeViewModel).  Apr√®s avoir cliqu√© sur le bouton "Suivant", la m√©thode OnboardingFlowCoordinator # welcomeShown () est appel√©e.  Ce qui montre l'√©cran suivant PersonalInterestFragment + PersonalInterestViewModel, sur lequel l'utilisateur s√©lectionne des cat√©gories de nouvelles int√©ressantes.  Apr√®s avoir s√©lectionn√© les cat√©gories, l'utilisateur appuie sur le bouton ¬´Suivant¬ª et la m√©thode OnboardingFlowCoordinator # onboardingCompleted () est appel√©e, qui proc√®de par proxy √† l'appel √† RootFlowCoordinator # onboardingCompleted (), qui lance NewsFlowCoordinator. <br>  Voyons comment le coordinateur peut simplifier le travail avec les tests A / B.  J'ajouterai un √©cran avec une offre pour effectuer un achat dans l'application et le montrerai √† certains utilisateurs. <br><br><img src="https://habrastorage.org/webt/e7/ok/a8/e7oka8yuwnttopnufiday2904iw.png"><br><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewsFlowCoordinator</span></span></span><span class="hljs-class"> </span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> navigator : Navigator, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> abTest : AbTest ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ navigator.showNewsList() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readNewsArticle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id : </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>{ navigator.showNewsArticle(id) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">closeNews</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abTest.isB){ navigator.showInAppPurchases() } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { navigator.closeNews() } } }</code> </pre><br>  Encore une fois, nous n'avons ajout√© aucune logique √† la vue ou √† son mod√®le.  Avez-vous d√©cid√© d'ajouter InAppPurchaseFragment √† l'int√©gration?  Pour ce faire, il vous suffit de changer le coordinateur d'int√©gration, car le fragment de magasinage et son mod√®le de vue sont compl√®tement ind√©pendants des autres fragments et nous pouvons le r√©utiliser librement dans d'autres sc√©narios.  Le coordinateur aidera √©galement √† mettre en ≈ìuvre le test A / B, qui compare deux sc√©narios d'int√©gration. <br><br>  Des sources compl√®tes peuvent √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">trouv√©es sur le github</a> , et pour les paresseux j'ai pr√©par√© une d√©mo vid√©o <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PfRLZeRLvTo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Conseil utile: en utilisant kotlin, vous pouvez cr√©er un dsl pratique pour d√©crire les coordinateurs sous la forme d'un graphique de navigation. <br><br><pre> <code class="hljs erlang"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newsFlowCoordinator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(navigator, abTest)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">navigator</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showNewsList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readNewsArticle</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">id</span></span></span><span class="hljs-function"> -&gt;</span></span> navigator.showNewsArticle(id) } closeNews { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abTest.isB){ navigator.showInAppPurchases() } else { navigator.closeNews() } } }</code> </pre><br><h3>  R√©sum√©: </h3><br>  Le coordinateur aidera √† apporter la logique de navigation au composant faiblement coupl√© test√©.  Pour le moment, il n'y a pas de biblioth√®que pr√™te pour la production, je n'ai d√©crit que le concept de r√©solution du probl√®me.  Le coordinateur est-il applicable √† votre candidature?  Je ne sais pas, cela d√©pend de vos besoins et de la facilit√© avec laquelle il sera int√©gr√© √† l'architecture existante.  Il pourrait √™tre utile d'√©crire une petite application en utilisant un coordinateur. <br><br><h5>  FAQ: </h5><br>  <i>L'article ne mentionne pas l'utilisation d'un coordinateur avec un mod√®le MVI.</i>  <i>Est-il possible d'utiliser un coordinateur avec cette architecture?</i>  Oui, j'ai un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article s√©par√©</a> . <br><br>  <i>Google a r√©cemment introduit le contr√¥leur de navigation dans le cadre d'Android Jetpack.</i>  <i>Quel est le lien entre le coordinateur et la navigation Google?</i>  Vous pouvez utiliser le nouveau contr√¥leur de navigation au lieu du navigateur dans les coordinateurs ou directement dans le navigateur au lieu de cr√©er manuellement des transactions de fragments. <br><br>  <i>Et si je ne veux pas utiliser de fragments / activit√© et que je veux √©crire mon propre back-end pour g√©rer les vues - pourrai-je utiliser le coordinateur dans mon cas?</i>  J'y ai √©galement r√©fl√©chi et je travaille sur un prototype.  J'√©crirai √† ce sujet sur mon blog.  Il me semble que la machine d'√©tat simplifiera consid√©rablement la t√¢che. <br><br>  <i>Le coordinateur est-il attach√© √† l'approche de candidature √† une seule activit√©?</i>  Non, vous pouvez l'utiliser dans diff√©rents sc√©narios.  L'impl√©mentation de la transition entre les √©crans est masqu√©e dans le navigateur. <br><br>  <i>Avec l'approche d√©crite, vous obtenez un √©norme navigateur.</i>  <i>Nous avons en quelque sorte essay√© de nous √©loigner de Dieu-Object'a?</i>  Nous ne sommes pas tenus de d√©crire le navigateur dans une classe.  Cr√©ez plusieurs petits navigateurs pris en charge, par exemple, un navigateur distinct pour chaque sc√©nario utilisateur. <br><br>  <i>Comment travailler avec des animations de transition continue?</i>  <i>D√©crivez les animations de transition dans le navigateur, puis l'activit√© / le fragment ne saura rien de l'√©cran pr√©c√©dent / suivant.</i>  <i>Comment le navigateur sait-il quand d√©marrer l'animation?</i>  Supposons que nous voulons montrer une animation de la transition entre les fragments A et B. Nous pouvons souscrire √† l'√©v√©nement onFragmentViewCreated (v: View) √† l'aide de FragmentLifecycleCallback et lorsque cet √©v√©nement se produit, nous pouvons travailler avec des animations de la m√™me mani√®re que nous l'avons fait directement dans le fragment: ajouter OnPreDrawListener d'attendre d'√™tre pr√™t et d'appeler startPostponedEnterTransition ().  De la m√™me mani√®re, vous pouvez impl√©menter une transition anim√©e entre une activit√© √† l'aide de ActivityLifecycleCallbacks ou entre ViewGroup √† l'aide de OnHierarchyChangeListener.  N'oubliez pas de vous d√©sabonner des √©v√©nements ult√©rieurement pour √©viter les fuites de m√©moire. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416301/">https://habr.com/ru/post/fr416301/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416291/index.html">Comment construire une architecture IIoT √† faire soi-m√™me. Partie 2: ¬´Choses¬ª</a></li>
<li><a href="../fr416293/index.html">Un avion √©lectrique hybride r√©duira les √©missions et le bruit</a></li>
<li><a href="../fr416295/index.html">Le plus grand t√©lescope du monde pourra enfin voir les √©toiles sans rayons de diffraction</a></li>
<li><a href="../fr416297/index.html">plug-in ml-agent pour l'unit√©</a></li>
<li><a href="../fr416299/index.html">Les gens suivent les glaciers en Islande depuis des d√©cennies; Maintenant, la technique le fera</a></li>
<li><a href="../fr416303/index.html">Recr√©er le premier d√©clencheur</a></li>
<li><a href="../fr416305/index.html">La normalisation est la plus longue aventure de l'Internet des objets</a></li>
<li><a href="../fr416307/index.html">iOS 12: nouveau dans les notifications</a></li>
<li><a href="../fr416309/index.html">Comment utiliser les fichiers HDF5 en Python</a></li>
<li><a href="../fr416313/index.html">Liste de contr√¥le d'analyse du journal des √©v√©nements de s√©curit√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>