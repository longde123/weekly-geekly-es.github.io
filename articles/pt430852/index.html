<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë™ üöß üë®üèø‚Äçü§ù‚Äçüë®üèº Garantias de consist√™ncia e ACID em sistemas de armazenamento distribu√≠do ‚õ≥Ô∏è üåÜ üêÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os sistemas distribu√≠dos s√£o usados ‚Äã‚Äãquando h√° necessidade de dimensionamento horizontal para fornecer indicadores de desempenho aprimorados que um s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Garantias de consist√™ncia e ACID em sistemas de armazenamento distribu√≠do</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/gridgain/blog/430852/">  Os sistemas distribu√≠dos s√£o usados ‚Äã‚Äãquando h√° necessidade de dimensionamento horizontal para fornecer indicadores de desempenho aprimorados que um sistema dimensionado verticalmente n√£o √© capaz de fornecer dinheiro adequado. <br><br>  Assim como a transi√ß√£o de um paradigma de thread √∫nico para multi-thread, a migra√ß√£o para um sistema distribu√≠do requer um tipo de imers√£o e compreens√£o de como ele funciona no interior, no que voc√™ precisa prestar aten√ß√£o. <br><br>  Um dos problemas enfrentados por uma pessoa que deseja migrar um projeto para um sistema distribu√≠do ou iniciar um projeto nele √© qual produto escolher. <br><br>  N√≥s, como uma empresa que ‚Äúcomeu um cachorro‚Äù no desenvolvimento de tais sistemas, ajudamos nossos clientes a tomar decis√µes equilibradas em rela√ß√£o aos sistemas de armazenamento distribu√≠do.  Tamb√©m estamos lan√ßando uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">s√©rie de semin√°rios</a> on- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">line</a> para um p√∫blico mais amplo, focado em princ√≠pios b√°sicos em um idioma simples, e quaisquer prefer√™ncias alimentares espec√≠ficas ajudam a mapear recursos significativos para facilitar a escolha. <br><br>  Este artigo √© baseado em nossos materiais sobre consist√™ncia e garantias ACID em sistemas distribu√≠dos. <br><a name="habracut"></a><br><h1>  O que √© e por que √© necess√°rio? </h1><br>  " <b>Consist√™ncia de</b> <b>dados</b> (√†s vezes <i>consist√™ncia de dados</i> ) √© <i>consist√™ncia de dados</i> entre si, integridade de dados e consist√™ncia interna."  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> ) <br><br>  A consist√™ncia implica que, a qualquer momento, os aplicativos possam ter certeza de que est√£o trabalhando com a vers√£o correta e tecnicamente relevante dos dados, e poder√£o confiar neles para tomar decis√µes. <br><br>  Em sistemas distribu√≠dos, garantir a consist√™ncia est√° se tornando mais dif√≠cil e mais caro, porque surgem uma s√©rie de novos desafios relacionados √† troca de rede entre n√≥s diferentes, √† possibilidade de falha de n√≥s individuais e - frequentemente - √† falta de uma √∫nica mem√≥ria que pode servir para verifica√ß√£o. <br><br>  Por exemplo, se eu tiver um sistema de 4 n√≥s: A, B, C e D, que serve transa√ß√µes banc√°rias, e os n√≥s C e D estiverem separados de A e B (por exemplo, devido a problemas de rede), √© bem poss√≠vel que agora n√£o esteja Eu tenho acesso a parte da transa√ß√£o.  Como eu ajo nesta situa√ß√£o?  Sistemas diferentes adotam abordagens diferentes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lm/8p/gw/lm8pgwmqnfcsp0uifu1hgiizhqg.png"></div><br>  No n√≠vel superior, existem duas dire√ß√µes principais que s√£o expressas no teorema da PAC. <br><br>  ‚Äú <b>O teorema da CAP</b> (tamb√©m conhecido como <b>teorema de Brewer</b> ) √© uma afirma√ß√£o heur√≠stica de que em qualquer implementa√ß√£o da computa√ß√£o distribu√≠da √© poss√≠vel fornecer n√£o mais que duas das tr√™s propriedades a seguir: <br><br><ul><li>  consist√™ncia dos dados (consist√™ncia Eng.) - em todos os n√≥s de computa√ß√£o em um determinado momento, os dados n√£o se contradizem; </li><li>  disponibilidade (disponibilidade do Eng.) - qualquer solicita√ß√£o para um sistema distribu√≠do termina com uma resposta correta, mas sem garantia de que as respostas de todos os n√≥s do sistema correspondam; </li><li>  toler√¢ncia de parti√ß√£o - dividir um sistema distribu√≠do em v√°rias se√ß√µes isoladas n√£o leva a uma resposta incorreta de cada se√ß√£o. ‚Äù </li></ul><br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> ) <br><br>  Quando o teorema da CAP fala de consist√™ncia, implica uma defini√ß√£o bastante rigorosa, incluindo lineariza√ß√£o de registros e leituras, e estipula apenas consist√™ncia ao escrever valores individuais.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Martin Kleppman</a> ) <br><br>  O teorema da CAP diz que, se queremos resistir a problemas de rede, em geral devemos escolher se devemos sacrificar: consist√™ncia ou acessibilidade.  Existe tamb√©m uma vers√£o estendida desse teorema - PACELC ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> ), que tamb√©m fala sobre o fato de que, mesmo na aus√™ncia de problemas de rede, devemos escolher entre velocidade de resposta e consist√™ncia. <br><br>  E, embora, √† primeira vista, um nativo do mundo dos DBMSs cl√°ssicos, parece que a escolha √© √≥bvia e a consist√™ncia √© a coisa mais importante que temos, isso est√° longe de ser sempre o caso, que ilustra claramente o crescimento explosivo de v√°rios DBMSs NoSQL que fizeram uma escolha diferente e Apesar disso, eles t√™m uma enorme base de usu√°rios.  O Apache Cassandra, com sua famosa consist√™ncia eventual, √© um bom exemplo. <br><br>  Tudo isso se deve ao fato de ser uma <i>escolha</i> que implica sacrificar alguma coisa e nem sempre estamos prontos para sacrific√°-la. <br><br>  Freq√ºentemente, o problema de consist√™ncia em sistemas distribu√≠dos √© resolvido simplesmente abandonando essa consist√™ncia. <br><br>  Mas √© necess√°rio e importante entender quando a rejei√ß√£o dessa consist√™ncia √© aceit√°vel e quando √© um requisito comercial cr√≠tico. <br><br>  Por exemplo, se eu projetar um componente respons√°vel por armazenar sess√µes do usu√°rio, aqui, provavelmente, a consist√™ncia n√£o √© t√£o importante para mim e a perda de dados n√£o ser√° cr√≠tica se ocorrer apenas em casos problem√°ticos - muito raramente.  O pior que acontecer√° √© que o usu√°rio precisar√° fazer login e, para muitas empresas, isso ter√° pouco efeito no desempenho financeiro. <br><br>  Se eu fizer an√°lises no fluxo de dados a partir de sensores, em muitos casos, √© totalmente n√£o-cr√≠tico para mim perder alguns dados e obter uma redu√ß√£o de amostragem por um curto per√≠odo de tempo, especialmente se finalmente os ver. <br><br>  Mas se eu criar um sistema banc√°rio, a consist√™ncia das transa√ß√µes em dinheiro √© fundamental para os meus neg√≥cios.  Se eu acumulei uma penalidade no empr√©stimo de um cliente devido ao fato de simplesmente n√£o ver o pagamento pontual, embora ele estivesse no sistema, isso √© muito, muito ruim.  Assim como se o cliente pudesse retirar todo o dinheiro do meu cart√£o de cr√©dito v√°rias vezes, porque eu tinha problemas de rede no momento da transa√ß√£o e as informa√ß√µes de retirada n√£o atingiram parte do meu cluster. <br><br>  Se voc√™ fizer uma compra cara em uma loja on-line, n√£o deseja que seu pedido seja esquecido, apesar do relat√≥rio de sucesso na p√°gina da web. <br><br>  Mas se voc√™ optar pela consist√™ncia, sacrifica a acessibilidade.  E muitas vezes isso √© esperado, provavelmente voc√™ j√° se deparou com isso mais de uma vez. <br><br>  √â melhor que a cesta da loja online diga "tente mais tarde, o DBMS distribu√≠do n√£o est√° dispon√≠vel" do que se relatar o sucesso e esquecer o pedido.  √â melhor obter uma recusa em uma transa√ß√£o devido √† indisponibilidade dos servi√ßos do banco do que uma batida no sucesso e depois nos procedimentos com o banco porque se esqueceu de que voc√™ pagou o empr√©stimo. <br><br>  Finalmente, se observarmos o teorema do PACELC estendido, entendemos que, mesmo no caso de opera√ß√£o regular do sistema, escolhendo a consist√™ncia, podemos sacrificar lat√™ncias baixas, obtendo um n√≠vel potencialmente mais baixo de desempenho m√°ximo. <br><br>  Portanto, respondendo √† pergunta ‚Äúpor que isso √© necess√°rio?‚Äù: √â necess√°rio que seja essencial para sua tarefa ter dados atualizados e consistentes, e a alternativa trar√° a voc√™ perdas significativas maiores que a indisponibilidade tempor√°ria do servi√ßo durante o per√≠odo do incidente ou seu desempenho inferior. <br><br><h1>  Como fornecer isso? </h1><br>  Consequentemente, a primeira decis√£o que voc√™ precisa tomar √© onde est√° no teorema da PAC, deseja consist√™ncia ou disponibilidade em caso de incidente. <br><br>  Em seguida, voc√™ precisa entender em que n√≠vel deseja fazer altera√ß√µes.  Talvez voc√™ tenha registros at√¥micos suficientes que afetam um √∫nico objeto, pois o MongoDB era capaz e capaz (agora o amplia adicionalmente com suporte para transa√ß√µes completas).  Deixe-me lembr√°-lo de que o teorema do CAP n√£o diz nada sobre a consist√™ncia das opera√ß√µes de grava√ß√£o envolvendo v√°rios objetos: o sistema pode muito bem ser CP (ou seja, preferir a consist√™ncia da acessibilidade) e, ao mesmo tempo, fornecer apenas registros √∫nicos at√¥micos. <br><br>  Se isso n√£o for suficiente para voc√™, come√ßaremos a abordar o conceito de transa√ß√µes ACID distribu√≠das de pleno direito. <br><br>  Observo que, mesmo quando entramos no admir√°vel mundo novo de transa√ß√µes ACID distribu√≠das, muitas vezes precisamos sacrificar algo.  Por exemplo, v√°rios sistemas de armazenamento distribu√≠do t√™m transa√ß√µes distribu√≠das, mas apenas dentro de uma √∫nica parti√ß√£o.  Ou, por exemplo, o sistema pode n√£o suportar a parte ‚ÄúI‚Äù no n√≠vel que voc√™ precisa, sem isolamento ou com um n√∫mero insuficiente de n√≠veis de isolamento. <br><br>  Essas restri√ß√µes costumavam ser feitas por algum motivo: para simplificar a implementa√ß√£o ou, por exemplo, para melhorar o desempenho ou para outra coisa.  Eles s√£o suficientes para um grande n√∫mero de casos, portanto, voc√™ n√£o deve consider√°-los como contras por conta pr√≥pria. <br><br>  Voc√™ precisa entender se essas restri√ß√µes s√£o um problema para o seu cen√°rio espec√≠fico.  Caso contr√°rio, voc√™ tem mais op√ß√µes e pode dar mais peso, por exemplo, aos indicadores de desempenho ou √† capacidade do sistema de fornecer toler√¢ncia a desastres, etc.  Finalmente, n√£o devemos esquecer que em v√°rios sistemas esses par√¢metros podem ser ajustados at√© o ponto em que o sistema pode ser CP ou AP, dependendo da configura√ß√£o. <br><br>  Se nosso produto pretende ser CP, geralmente ele possui uma abordagem de quorum para sele√ß√£o de dados ou n√≥s dedicados que s√£o os principais propriet√°rios dos registros, todas as altera√ß√µes de dados passam por eles e, no caso de problemas de rede, se esses n√≥s principais n√£o puderem fornecer dados. resposta, acredita-se que os dados, em princ√≠pio, n√£o possam ser obtidos, ou arbitragem, quando um componente externo altamente acess√≠vel (por exemplo, o cluster ZooKeeper) pode dizer qual dos segmentos de cluster √© o principal, cont√©m a vers√£o atual dos dados e pode atender com efici√™ncia √† solicita√ß√£o  s. <br><br>  Por fim, se estivermos interessados ‚Äã‚Äãn√£o apenas no CP, mas no suporte a transa√ß√µes ACID distribu√≠das completas, geralmente uma √∫nica fonte de verdade √© frequentemente usada, por exemplo, armazenamento em disco centralizado, onde nossos n√≥s, de fato, atuam apenas como caches para ele, que podem ser desativados em tempo de confirma√ß√£o ou o protocolo de confirma√ß√£o multif√°sico √© aplicado. <br><br>  A primeira abordagem de disco √∫nico tamb√©m simplifica a implementa√ß√£o, fornece baixas lat√™ncias nas transa√ß√µes distribu√≠das, mas troca em troca de escalabilidade muito limitada em cargas com grandes volumes de grava√ß√£o. <br><br>  A segunda abordagem oferece muito mais liberdade no dimensionamento e, por sua vez, √© dividida em protocolos de confirma√ß√£o de duas fases ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> ) e trif√°sicas ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> ). <br><br>  Considere uma confirma√ß√£o em duas fases que use, por exemplo, Apache Ignite. <br><br><img src="https://habrastorage.org/webt/ha/1a/qx/ha1aqxrjarg8g-x81wdn2i3xcoe.png"><br>  Ôøº <br>  O procedimento de confirma√ß√£o √© dividido em 2 fases: preparar e confirmar. <br><br>  Na fase de prepara√ß√£o, uma mensagem √© preparada sobre a prepara√ß√£o para a confirma√ß√£o, e cada participante, se necess√°rio, bloqueia, executa todas as opera√ß√µes at√© e inclusive a confirma√ß√£o real e envia a prepara√ß√£o para suas r√©plicas, se isso for assumido pelo produto.  Se pelo menos um dos participantes respondeu com uma recusa por algum motivo ou se mostrou indispon√≠vel - os dados realmente n√£o foram alterados, n√£o houve confirma√ß√£o.  Os participantes revertem as altera√ß√µes, liberam bloqueios e retornam ao seu estado original. <br><br>  Na fase de consolida√ß√£o, a execu√ß√£o real da consolida√ß√£o √© enviada aos n√≥s do cluster.  Se por algum motivo alguns dos n√≥s estavam indispon√≠veis ou responderam com um erro, ent√£o os dados foram inseridos em seu redo-log (desde que a prepara√ß√£o foi bem-sucedida) e a confirma√ß√£o, em qualquer caso, pode ser conclu√≠da pelo menos em um estado pendente. <br><br>  Por fim, se o coordenador falhar, no est√°gio de prepara√ß√£o, o commit ser√° cancelado, no est√°gio de commit, um novo coordenador poder√° ser selecionado e, se todos os n√≥s tiverem conclu√≠do o preparo, ele poder√° verificar e garantir que o est√°gio de commit seja conclu√≠do. <br><br>  Diferentes produtos t√™m seus pr√≥prios recursos de implementa√ß√£o e otimiza√ß√£o.  Assim, por exemplo, alguns produtos conseguem, em alguns casos, reduzir um commit de duas fases para um de 1 fase, ganhando significativamente em desempenho. <br><br><h1>  Conclus√µes </h1><br>  Conclus√£o chave: os sistemas de armazenamento distribu√≠do s√£o um mercado bastante desenvolvido e os produtos nele podem fornecer alta consist√™ncia dos dados. <br><br>  Al√©m disso, os produtos dessa categoria est√£o localizados em diferentes pontos da escala de consist√™ncia, desde produtos totalmente em AP sem nenhuma transacionalidade at√© produtos em CP que fornecem adicionalmente transa√ß√µes ACID de pleno direito.  Alguns produtos podem ser configurados de uma maneira ou de outra. <br><br>  Quando voc√™ escolhe o que precisa, precisa levar em conta as necessidades do seu caso e entender bem quais sacrif√≠cios e compromissos est√° disposto a fazer, porque nada acontece de gra√ßa e, ao escolher um, voc√™ provavelmente recusar√° outra coisa. <br><br>  Ao avaliar produtos desse lado, vale a pena prestar aten√ß√£o ao seguinte: <br><br><ul><li>  onde eles est√£o no teorema da PAC; </li><li>  Eles suportam transa√ß√µes ACID distribu√≠das? </li><li>  que restri√ß√µes eles imp√µem √†s transa√ß√µes distribu√≠das (por exemplo, apenas dentro de uma √∫nica parti√ß√£o, etc.); </li><li>  Conveni√™ncia e efici√™ncia do uso de transa√ß√µes distribu√≠das, sua integra√ß√£o com outros componentes do produto. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt430852/">https://habr.com/ru/post/pt430852/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt430840/index.html">Que evid√™ncia pode convencer os matem√°ticos se n√£o houver evid√™ncia rigorosa?</a></li>
<li><a href="../pt430842/index.html">Usamos blockchain para combater a corrup√ß√£o e o cyberbullying</a></li>
<li><a href="../pt430844/index.html">Como escolher uma bateria para UPS</a></li>
<li><a href="../pt430846/index.html">O que h√° de novo: detalhes sobre a implementa√ß√£o da nova arquitetura Zen 2 ficaram conhecidos</a></li>
<li><a href="../pt430850/index.html">Apple Metal em MAPS.ME</a></li>
<li><a href="../pt430854/index.html">‚ÄúJS est√° ficando mais maduro‚Äù: uma entrevista com o comit√™ do programa HolyJS 2018 em Moscou</a></li>
<li><a href="../pt430856/index.html">Toda a verdade sobre o RTOS. Artigo 21. Caixas de correio: Introdu√ß√£o e servi√ßos b√°sicos</a></li>
<li><a href="../pt430860/index.html">Baixe, salve e visualize PDF no Swift</a></li>
<li><a href="../pt430862/index.html">"Monstros nos jogos - como fazer um jogador te odiar"</a></li>
<li><a href="../pt430864/index.html">Jogos n√£o √© um brinquedo?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>