<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîõ ü§∂üèΩ üë≠ Prototyping eines Handyspiels, wo man anf√§ngt und wie man es macht. Teil 2 üöÑ üé´ üë®üèΩ‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="F√ºr diejenigen, die den ersten Teil verpasst haben - Teil 1 
 N√§chster Teil - Teil 3 

 Wenn jemand Interesse daran hat, etwas √ºber den von der Verans...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prototyping eines Handyspiels, wo man anf√§ngt und wie man es macht. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453236/">  F√ºr diejenigen, die den ersten Teil verpasst haben - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> <br>  N√§chster Teil - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br><br>  Wenn jemand Interesse daran hat, etwas √ºber den von der Veranstaltung verwendeten Aggregator zu lesen, dann <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sind</a> Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> , aber dies ist nicht erforderlich. <br><br><h3>  Also fangen wir an, alles auf einem Haufen zu sammeln </h3><br><img src="https://habrastorage.org/webt/z-/sa/5r/z-sa5rumeqhyobemc4hutmppbai.png"><br><a name="habracut"></a><br>  <b>Rakete:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Basisraketenklasse</b> <div class="spoiler_text"><pre><code class="java hljs">using DG.Tweening; using GlobalEventAggregator; using UnityEngine; namespace PlayerRocket { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Rocket</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlayerRocketBase</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> pathorrectionTime = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 movingUp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StartEventReact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ButtonStartPressed buttonStartPressed)</span></span></span><span class="hljs-function"> </span></span>{ transform.SetParent(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); rocketState = RocketState.MOVE; transform.DORotate(Vector3.zero, pathorrectionTime); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ base.Start(); EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RegisterUser { playerHelper = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rocketState == RocketState.WAITFORSTART) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; RocketBehaviour(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FixedUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ RocketBehaviour(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RocketBehaviour</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (rocketState) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.WAITFORSTART: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputController.OnTouch &amp;&amp; !inputController.OnDrag) rocketHolder.RotateHolder(inputController.worldMousePos); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.MOVE: rigidbody.AddRelativeForce(Vector3.up*(config.Speed*Time.deltaTime)); forceModel.AddModificator(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.STOP: Debug.Log(<span class="hljs-string"><span class="hljs-string">" "</span></span>); rigidbody.velocity = Vector3.zero; rigidbody.drag = <span class="hljs-number"><span class="hljs-number">50</span></span>; rocketState = RocketState.COMPLETESTOP; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.COMPLETESTOP: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: rocketState = RocketState.COMPLETESTOP; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } }</code> </pre> <br></div></div><br>  Was brauchen wir, damit eine Rakete abhebt?  Im Spielraum brauchen wir einen bedingten Planeten, mit dem wir starten, einen Startknopf und eine Rakete.  Was sollte eine Rakete k√∂nnen? <br><br><ol><li>  Warten Sie auf den Start </li><li>  Fliegen </li><li>  Von Modifikatoren betroffen sein </li><li>  Um aufzuh√∂ren </li></ol><br>  Das hei√üt, wir haben ein unterschiedliches Verhalten / einen unterschiedlichen Zustand der Rakete. Abh√§ngig vom aktuellen Zustand sollte die Rakete ein unterschiedliches Verhalten aufweisen.  Bei der Programmierung sind wir st√§ndig mit einer Situation konfrontiert, in der ein Objekt viele radikal unterschiedliche Verhaltensweisen haben kann. <br><br>  F√ºr komplexes Verhalten von Objekten ist es besser, Verhaltensmuster zu verwenden, beispielsweise ein Zustandsmuster.  F√ºr die einfachen verwenden unerfahrene Programmierer oft viel, wenn nicht anders.  Ich empfehle die Verwendung von switch und enum.  Erstens ist dies eine klarere Unterteilung der Logik in bestimmte Phasen. Dank dieser Informationen wissen wir genau, in welchem ‚Äã‚ÄãZustand wir uns gerade befinden und was passiert. Es gibt weniger M√∂glichkeiten, den Code in eine Nudel von Dutzenden von Ausnahmen zu verwandeln. <br><br>  <b>Wie es funktioniert:</b> <br><br>  Zuerst beginnen wir mit den Staaten, die wir brauchen: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> RocketState { WAITFORSTART = <span class="hljs-number"><span class="hljs-number">0</span></span>, MOVE = <span class="hljs-number"><span class="hljs-number">1</span></span>, STOP = <span class="hljs-number"><span class="hljs-number">2</span></span>, COMPLETESTOP = <span class="hljs-number"><span class="hljs-number">3</span></span>, }</code> </pre> <br>  In der Elternklasse haben wir ein Feld - <pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> RocketState rocketState;</code> </pre> <br>  Standardm√§√üig wird ihm der erste Wert zugewiesen.  Enum selbst legt die Standardwerte fest, aber f√ºr Daten, die von oben ge√§ndert oder von Spieledesignern konfiguriert werden k√∂nnen - wof√ºr habe ich die Werte manuell festgelegt?  Um dem inam irgendwo einen weiteren Wert hinzuf√ºgen zu k√∂nnen und die gespeicherten Daten nicht zu verletzen.  Ich rate Ihnen auch, Flaggenaufz√§hlung zu studieren. <br><br>  <b>Weiter:</b> <br><br>  Wir definieren das Verhalten selbst in einem Update, abh√§ngig vom Wert des rocketState-Feldes <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FixedUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ RocketBehaviour(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RocketBehaviour</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (rocketState) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.WAITFORSTART: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputController.OnTouch &amp;&amp; !inputController.OnDrag) rocketHolder.RotateHolder(inputController.worldMousePos); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.MOVE: rigidbody.AddRelativeForce(Vector3.up*(config.Speed*Time.deltaTime)); forceModel.AddModificator(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.STOP: Debug.Log(<span class="hljs-string"><span class="hljs-string">" "</span></span>); rigidbody.velocity = Vector3.zero; rigidbody.drag = <span class="hljs-number"><span class="hljs-number">50</span></span>; rocketState = RocketState.COMPLETESTOP; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RocketState.COMPLETESTOP: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: rocketState = RocketState.COMPLETESTOP; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> <br>  <b>Ich werde entziffern, was passiert:</b> <br><br><ol><li>  Wenn wir warten, drehen wir einfach die Rakete in Richtung des Mauszeigers und stellen so die anf√§ngliche Flugbahn ein </li><li>  Der zweite Zustand - wir fliegen, beschleunigen die Rakete in die richtige Richtung und aktualisieren das Modifikatormodell f√ºr das Auftreten von Objekten, die die Flugbahn beeinflussen </li><li>  Der dritte Zustand ist, wenn das Team bei uns ankommt, um anzuhalten. Hier arbeiten wir alles so aus, dass die Rakete anh√§lt und sich in den Zustand √ºbersetzt - wir haben vollst√§ndig angehalten. </li><li>  Der letzte Zustand ist, dass wir nichts tun. </li></ol><br>  Die Bequemlichkeit des aktuellen Musters - alles ist sehr leicht erweiterbar und einstellbar, aber es gibt nur eine schwache Verbindung - dann k√∂nnen wir einen Zustand haben, der eine Reihe anderer Zust√§nde kombiniert.  Hier entweder ein Flag inam, mit einer Komplikation der Verarbeitung, oder bereits zu "schwereren" Mustern wechseln. <br><br>  Wir haben die Rakete herausgefunden.  Der n√§chste Schritt ist ein einfaches, aber lustiges Objekt - der Startknopf. <br><br><h3>  Starttaste </h3><br>  Die folgenden Funktionen sind f√ºr sie erforderlich - geklickt, sie benachrichtigt, dass sie auf sie geklickt haben. <br><br><div class="spoiler">  <b class="spoiler_title">Start Button Class</b> <div class="spoiler_text"><pre> <code class="java hljs">using UnityEngine; using UnityEngine.EventSystems; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StartButton</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IPointerDownHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> bool isTriggered; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ButtonStartPressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isTriggered) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; isTriggered = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ButtonStartPressed()); Debug.Log(<span class="hljs-string"><span class="hljs-string">""</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPointerDown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ ButtonStartPressed(); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct ButtonStartPressed { }</code> </pre> <br></div></div><br>  Laut Spieldesign ist dies ein 3D-Objekt auf der B√ºhne, der Knopf soll in das Design des Startplaneten integriert werden.  Okay, es gibt eine Nuance - wie kann man einen Klick auf ein Objekt in einer Szene verfolgen? <br><br>  Wenn wir googeln, finden wir eine Reihe von OnMouse-Methoden, unter denen es einen Klick gibt.  Es scheint eine einfache Wahl zu sein, aber es ist einfach sehr schlecht, angefangen mit der Tatsache, dass es oft schief funktioniert (es gibt viele Nuancen f√ºr das Verfolgen von Klicks), ‚ÄûLiebes‚Äú, bis hin zur Tatsache, dass es nicht so viele Br√∂tchen gibt, die in UnityEngine.EventSystems enthalten sind. <br><br>  Am Ende empfehle ich die Verwendung von UnityEngine.EventSystems und den Schnittstellen IPointerDownHandler, IPointerClickHandler.  In ihren Methoden erkennen wir die Reaktion auf das Pressen, aber es gibt mehrere Nuancen. <br><br><ol><li>  In der Szene muss ein EventSystem vorhanden sein. Dies ist ein Objekt / eine Klasse / eine Komponente der Einheit, die normalerweise beim Erstellen der Zeichenfl√§che f√ºr die Schnittstelle erstellt wird. Sie k√∂nnen sie jedoch auch selbst erstellen. </li><li>  Physik RayCaster muss auf der Kamera vorhanden sein (dies ist f√ºr 3D, f√ºr 2D-Grafiken gibt es einen separaten Racaster) </li><li>  In der Einrichtung muss sich ein Collider befinden </li></ol><br>  <i>Im Projekt sieht es so aus:</i> <br><br><img src="https://habrastorage.org/webt/-l/qa/1s/-lqa1sfgetxwqvlj7tqn1qdafia.jpeg"><br><br>  Jetzt verfolgt das Objekt den Klick und diese Methode hei√üt: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPointerDown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ ButtonStartPressed(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ButtonStartPressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isTriggered) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; isTriggered = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ButtonStartPressed()); Debug.Log(<span class="hljs-string"><span class="hljs-string">""</span></span>); }</code> </pre> <br>  <b>Was ist hier los:</b> <br><br>  Wir haben ein Boolesches Feld, in dem wir verfolgen, ob die Taste gedr√ºckt wurde oder nicht (dies ist ein Schutz gegen wiederholtes Dr√ºcken, damit nicht jedes Mal ein Startskript ausgef√ºhrt wird). <br><br>  Als n√§chstes rufen wir das Ereignis auf - der Knopf wird gedr√ºckt, den die Raketenklasse abonniert hat, und die Rakete in einen Bewegungszustand versetzt. <br><br>  Ein bisschen vorausspringen - warum ist es hier und da f√ºr Events?  Dies ist eine ereignisorientierte Programmierung. Erstens ist ein Ereignismodell billiger als eine kontinuierliche Datenverarbeitung, um ihre √Ñnderungen herauszufinden.  Zweitens ist dies die schw√§chste Verbindung. Wir m√ºssen auf der Rakete nicht wissen, dass es einen Knopf gibt, dass jemand darauf gedr√ºckt hat, und so weiter. Wir wissen nur, dass es ein Ereignis gibt, das gestartet werden muss. Wir haben es erhalten und handeln.  Au√üerdem ist dieses Ereignis nicht nur f√ºr die Rakete interessant, zum Beispiel ist ein Feld mit Modifikatoren f√ºr dasselbe Ereignis signiert, es ist zu Beginn der Rakete versteckt.  Dieses Ereignis kann auch f√ºr den Eingabecontroller von Interesse sein - und Benutzereingaben d√ºrfen nach dem Start der Rakete nicht anders verarbeitet werden. <br><br>  Warum m√∂gen nicht viele Programmierer das Ereignisparadigma?  Weil eine Menge Ereignisse und Abonnements f√ºr diese Ereignisse den Code leicht in Nudeln verwandeln, in denen √ºberhaupt nicht klar ist, wo er beginnen soll und ob er irgendwo enden wird, ganz zu schweigen von der Tatsache, dass Sie auch Ihr Abbestellen / Abonnement √ºberwachen und alle Objekte am Leben erhalten m√ºssen. <br><br>  Und deshalb verwende ich f√ºr die Implementierung von Ereignissen meinen Ereignisaggregator, der tats√§chlich keine Ereignisse √ºbertr√§gt, sondern Datencontainer √ºber Ereignisse und Klassen, die die Daten abonnieren, die sie interessieren.  Au√üerdem √ºberwacht der Aggregator selbst lebende Objekte und wirft tote Objekte aus Abonnenten.  Dank der √úbergabe des Beh√§lters ist auch die Injektion m√∂glich, Sie k√∂nnen uns einen Link zur interessierenden Klasse √ºbergeben.  Mithilfe des Containers k√∂nnen Sie leicht verfolgen, wer diese Daten verarbeitet und sendet.  F√ºr das Prototyping ist das eine tolle Sache. <br><br><h3>  Raketendrehung zur Bestimmung des Startpfades </h3><br><img src="https://habrastorage.org/webt/se/fm/hx/sefmhxvs8qjjymxmsj-i9uogdk0.jpeg"><br>  Entsprechend dem Spieldesign sollte sich die Rakete um den Planeten drehen k√∂nnen, um die anf√§ngliche Flugbahn zu bestimmen, jedoch nicht mehr als einen bestimmten Winkel.  Die Drehung erfolgt durch Ber√ºhren - die Rakete folgt einfach dem Finger und ist immer auf die Stelle gerichtet, an der wir auf den Bildschirm gesto√üen haben.  √úbrigens ist es nur der Prototyp, der es m√∂glich gemacht hat, festzustellen, dass dies eine Schwachstelle ist, und es gibt viele mit dem Management verbundene Episoden, die an diese Funktionalit√§t grenzen. <br><br>  <b>Aber in der Reihenfolge:</b> <br><br><ol><li>  Wir brauchen die Rakete, um uns relativ zum Planeten in Richtung der Schubkarre zu drehen </li><li>  Wir m√ºssen den Drehwinkel festklemmen </li></ol><br>  Was die Rotation relativ zum Planeten betrifft - Sie k√∂nnen sich schlau um die Achse drehen und die Rotationsachse berechnen, oder Sie k√∂nnen einfach ein Objekt mit einem im Planeten zentrierten Dummy erstellen, die Rakete dorthin bewegen und den Dummy leise um die Z-Achse drehen. Der Dummy hat eine Klasse, die das Verhalten des Objekts bestimmt.  Die Rakete dreht sich mit.  Das Objekt, das ich RocketHolder genannt habe.  Wir haben es herausgefunden. <br><br>  Nun zu den Einschr√§nkungen beim Drehen und Drehen in Richtung der Schubkarre: <br><br><div class="spoiler">  <b class="spoiler_title">Klasse RocketHolder</b> <div class="spoiler_text"><pre> <code class="java hljs">using UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RocketHolder</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> clampAngle = <span class="hljs-number"><span class="hljs-number">45</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.AddListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, (InjectEvent&lt;RocketHolder&gt; obj) =&gt; obj.inject(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClampAngle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> angle, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> to)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (angle &lt; <span class="hljs-number"><span class="hljs-number">0f</span></span>) angle = <span class="hljs-number"><span class="hljs-number">360</span></span> + angle; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (angle &gt; <span class="hljs-number"><span class="hljs-number">180f</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Mathf.Max(angle, <span class="hljs-number"><span class="hljs-number">360</span></span> + from); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Mathf.Min(angle, to); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClampRotationVectorZ</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Vector3 rotation )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(rotation.x, rotation.y, ClampAngle(rotation.z, -clampAngle, clampAngle)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RotateHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Vector3 targetPosition)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> diff = targetPosition - transform.position; diff.Normalize(); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> rot_z = Mathf.Atan2(diff.y, diff.x) * Mathf.Rad2Deg; transform.rotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>, rot_z - <span class="hljs-number"><span class="hljs-number">90</span></span>); transform.eulerAngles = ClampRotationVectorZ(transform.rotation.eulerAngles); } }</code> </pre> <br></div></div><br>  Trotz der Tatsache, dass das Spiel theoretisch 3D ist, ist die gesamte Logik und das Gameplay tats√§chlich 2D.  Und wir m√ºssen nur die Rakete um die Z-Achse in Richtung des Druckortes festziehen.  Am Ende der Methode klemmen wir den Rotationsgrad um den im Inspektor angegebenen Wert.  In der Awake-Methode k√∂nnen Sie die korrekteste Implementierung einer Klasseninjektion √ºber einen Aggregator anzeigen. <br><br><h3>  Eingangssteuerung </h3><br>  Eine der wichtigsten Klassen ist es, der das Benutzerverhalten sammelt und verarbeitet.  Dr√ºcken von Hotkeys, Gamepad-Tasten, Tastaturen usw.  Ich habe eine ziemlich einfache Eingabe in den Prototyp, in der Tat m√ºssen Sie nur 3 Dinge wissen: <br><br><ol><li>  Gibt es einen Klick und seine Koordinaten </li><li>  Gibt es einen vertikalen Wisch und wie viel Wischen </li><li>  Arbeite ich mit Schnittstelle / Modifikatoren? </li></ol><br><div class="spoiler">  <b class="spoiler_title">Klasse InputController</b> <div class="spoiler_text"><pre> <code class="java hljs">using System; using UnityEngine; using UnityEngine.EventSystems; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InputController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> DirectionRange = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 clickedPosition; [Header(<span class="hljs-string"><span class="hljs-string">"     "</span></span>)] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> afterThisDistanceWeGonnaDoSwipe = <span class="hljs-number"><span class="hljs-number">0.5f</span></span>; [Header(<span class="hljs-string"><span class="hljs-string">"  "</span></span>)] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speedOfVerticalScroll = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ReactiveValue&lt;<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt; ReactiveVerticalScroll { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> set; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector3 worldMousePos =&gt; Camera.main.ScreenToWorldPoint(Input.mousePosition); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool OnTouch { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> set; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool OnDrag { get; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> set; } <span class="hljs-comment"><span class="hljs-comment">// Start is called before the first frame update private void Awake() { ReactiveVerticalScroll = new ReactiveValue&lt;float&gt;(); GlobalEventAggregator.EventAggregator.AddListener(this, (ImOnDragEvent obj) =&gt; OnDrag = obj.IsDragging); GlobalEventAggregator.EventAggregator.AddListener&lt;InjectEvent&lt;InputController&gt;&gt;(this, InjectReact); } private void InjectReact(InjectEvent&lt;InputController&gt; obj) { obj.inject(this); } private void OnEnable() { GlobalEventAggregator.EventAggregator.Invoke(this); } void Start() { GlobalEventAggregator.EventAggregator.Invoke(this); } private void MouseInput() { if (EventSystem.current.IsPointerOverGameObject() &amp;&amp; EventSystem.current.gameObject.layer == 5) return; if (Input.GetKeyDown(KeyCode.Mouse0)) clickedPosition = Input.mousePosition; if (Input.GetKey(KeyCode.Mouse0)) { if (OnDrag) return; VerticalMove(); OnTouch = true; return; } OnTouch = false; ReactiveVerticalScroll.CurrentValue = 0; } private void VerticalMove() { if ( Math.Abs(Input.mousePosition.y-clickedPosition.y) &lt; afterThisDistanceWeGonnaDoSwipe) return; var distance = clickedPosition.y + Input.mousePosition.y * speedOfVerticalScroll; if (Input.mousePosition.y &gt; clickedPosition.y) ReactiveVerticalScroll.CurrentValue = distance; else if (Input.mousePosition.y &lt; clickedPosition.y) ReactiveVerticalScroll.CurrentValue = -distance; else ReactiveVerticalScroll.CurrentValue = 0; } // Update is called once per frame void Update() { MouseInput(); } } }</span></span></code> </pre> <br></div></div><br>  Es ist alles in der Stirn und ohne Probleme, interessant kann die primitive Implementierung von reaktivem propriet√§r sein - als ich gerade mit dem Programmieren anfing, war es immer interessant herauszufinden, dass sich die Daten ge√§ndert haben, ohne die Daten st√§ndig zu bel√ºften.  Nun, das ist es. <br><br>  Es sieht so aus: <br><br><div class="spoiler">  <b class="spoiler_title">Klasse ReactiveValue</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReactiveValue</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">struct</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> T currentState; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Action&lt;T&gt; OnChange; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> T CurrentValue { get =&gt; currentState; set { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value.Equals(currentState)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { currentState = value; OnChange?.Invoke(currentState); } } } }</code> </pre><br></div></div><br>  Wir abonnieren OnChange und zucken, wenn sich nur der Wert ge√§ndert hat. <br><br>  In Bezug auf Prototyping und Architektur - die Tipps sind dieselben, nur √∂ffentlich zug√§ngliche Eigenschaften und Methoden. Alle Daten sollten nur lokal ge√§ndert werden.  Verarbeitung und Berechnung - nach getrennten Methoden addieren.  Infolgedessen k√∂nnen Sie die Implementierung / Berechnungen jederzeit √§ndern, was sich nicht auf die externen Benutzer der Klasse auswirkt.  Das ist alles f√ºr den Moment, im dritten letzten Teil - √ºber Modifikatoren und Schnittstelle (Drag-Drop).  Und ich habe vor, das Projekt auf Git zu stellen, damit ich sehen / f√ºhlen kann.  Wenn Sie Fragen zum Prototyping haben - fragen Sie, ich werde versuchen, diese klar zu beantworten. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de453236/">https://habr.com/ru/post/de453236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de453220/index.html">13 E-Mail-Marketing-Fehler, die f√ºr ein besseres Engagement vermieden werden sollten</a></li>
<li><a href="../de453222/index.html">SphinxSearch-Meetup SuperJob</a></li>
<li><a href="../de453228/index.html">Nixie Uhr an den Anzeigen IN-18</a></li>
<li><a href="../de453232/index.html">Schreiben von Milliarden Songs mit C # und Deep Learning</a></li>
<li><a href="../de453234/index.html">Reverse Engineering des Austauschprotokolls in EOS-Ger√§ten</a></li>
<li><a href="../de453238/index.html">Lauflicht am Relais</a></li>
<li><a href="../de453242/index.html">Spielplatz f√ºr Sommerveranstaltungen</a></li>
<li><a href="../de453246/index.html">ERP - Continuous Degradation System</a></li>
<li><a href="../de453248/index.html">Artemis Lunar Mission - Produktion des Hauptelements der Mondorbitalstation Lunar Gateway gestartet</a></li>
<li><a href="../de453252/index.html">Wie wir das Sportmaster Club Programm gemacht haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>