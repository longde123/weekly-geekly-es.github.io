<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯОС ЁЯЫАЁЯП┐ ЁЯШБ рд╣рд╛рд╕реНрдХреЗрд▓ рдЖрд╢реНрд░рд┐рдд рдкреНрд░рдХрд╛рд░: рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╡рд┐рдХрд╛рд╕ рдХрд╛ рднрд╡рд┐рд╖реНрдп рдХреНрдпреЛрдВ рд╣реИ ЁЯШ╡ ЁЯдЭ ЁЯУ╖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╕реЗрд░реЛрдХреЗрд▓ рдореЗрдВ, рд╣рдо рди рдХреЗрд╡рд▓ рд╡рд╛рдгрд┐рдЬреНрдпрд┐рдХ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд▓рдЧреЗ рд╣реБрдП рд╣реИрдВ, рдмрд▓реНрдХрд┐ рдмреЗрд╣рддрд░ рдХреЗ рд▓рд┐рдП рджреБрдирд┐рдпрд╛ рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рднреА рд╣рд╛рд╕реНрдХреЗрд▓рд┐рд╕...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╣рд╛рд╕реНрдХреЗрд▓ рдЖрд╢реНрд░рд┐рдд рдкреНрд░рдХрд╛рд░: рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╡рд┐рдХрд╛рд╕ рдХрд╛ рднрд╡рд┐рд╖реНрдп рдХреНрдпреЛрдВ рд╣реИ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485174/"><p><img src="https://habrastorage.org/getpro/habr/post_images/fce/995/232/fce99523266b5bc548c3d1730c70b885.jpg"></p><br><p> рд╕реЗрд░реЛрдХреЗрд▓ рдореЗрдВ, рд╣рдо рди рдХреЗрд╡рд▓ рд╡рд╛рдгрд┐рдЬреНрдпрд┐рдХ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд▓рдЧреЗ рд╣реБрдП рд╣реИрдВ, рдмрд▓реНрдХрд┐ рдмреЗрд╣рддрд░ рдХреЗ рд▓рд┐рдП рджреБрдирд┐рдпрд╛ рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рднреА рд╣рд╛рд╕реНрдХреЗрд▓рд┐рд╕реНрдЯ - рдЧреНрд▓рд╛рд╕рдЧреЛ рд╣рд╛рд╕реНрдХреЗрд▓ рдХрдВрдкрд╛рдЗрд▓рд░ (рдЬреАрдПрдЪрд╕реА) рдХреЗ рдореБрдЦреНрдп рдЙрдкрдХрд░рдг рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рд╣рдордиреЗ рд░рд┐рдЪрд░реНрдб рдПрд╕реЗрдирдмрд░реНрдЧ рдХреЗ рдХрд╛рдо рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреЗ рддрд╣рдд рдЯрд╛рдЗрдк рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╡рд┐рд╕реНрддрд╛рд░ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд┐рдпрд╛, <a href="https://github.com/goldfirere/thesis/blob/master/built/thesis.pdf" rel="nofollow">"рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░: рд╕рд┐рджреНрдзрд╛рдВрдд рдФрд░ рдЕрднреНрдпрд╛рд╕</a> ред <a href="https://github.com/goldfirere/thesis/blob/master/built/thesis.pdf" rel="nofollow">"</a> </p><br><p>  <a href="https://serokell.io/blog/why-dependent-haskell" rel="nofollow">рд╣рдорд╛рд░реЗ рдмреНрд▓реЙрдЧ рдореЗрдВ,</a> рд╡реНрд▓рд╛рджрд┐рд╕реНрд▓рд╛рд╡ рдиреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА рдереА рдХрд┐ рд╣рд╛рд╕реНрдХреЗрд▓ рдкрд░ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░ рдХреА рдХрдореА рдХреНрдпреЛрдВ рд╣реИ рдФрд░ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рддреЗ рд╣реИрдВред  рд╣рдордиреЗ рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЛ рд░реВрд╕реА рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рддрд╛рдХрд┐ рдЕрдзрд┐рдХ рд╕реЗ рдЕрдзрд┐рдХ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВ рдФрд░ рдПрдХ рднрд╛рд╖рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдПрдХ рдФрд░ рдпреЛрдЧрджрд╛рди рдХрд░ рд╕рдХреЗрдВред </p><a name="habracut"></a><br><h1 id="tekuschee-polozhenie-del">  рдорд╛рдорд▓реЛрдВ рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ </h1><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6d3/260/bba/6d3260bbad59d047ba6f10b1fffd5383.jpg" alt="рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдЪрдпрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо"></p><br><p>  рдЖрд╢реНрд░рд┐рдд рдкреНрд░рдХрд╛рд░ рд╡реЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рд╕рдмрд╕реЗ рдЬреНрдпрд╛рджрд╛ рдпрд╛рдж рдХрд░рддрд╛ рд╣реВрдВред  рдЖрдЗрдП рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВ рдХрд┐ рдХреНрдпреЛрдВред  рдХреЛрдб рд╕реЗ рд╣рдо рдЪрд╛рд╣рддреЗ рд╣реИрдВ: </p><br><ul><li>  рдкреНрд░рджрд░реНрд╢рди, рдЕрд░реНрдерд╛рддреН, рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЧрддрд┐ рдФрд░ рдХрдо рдореЗрдореЛрд░реА рдЦрдкрдд; </li><li>  рд╕реНрдерд┐рд░рддрд╛ рдФрд░ рд╕рдордЭрдиреЗ рдореЗрдВ рдЖрд╕рд╛рдиреА; </li><li>  рдЗрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рд╢реБрджреНрдзрддрд╛ рдХреА рдЧрд╛рд░рдВрдЯреАред </li></ul><br><p>  рдореМрдЬреВрджрд╛ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде, рд╕рднреА рддреАрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдмрд╣реБрдд рдХрдо рд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рд╛рд╕реНрдХреЗрд▓ рдкрд░ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рде, рдХрд╛рд░реНрдп рд╕рд░рд▓ рд╣реИред </p><br><h2 id="standartnyy-haskell-ergonomika--proizvoditelnost">  рд╣рд╛рд╕реНрдХреЗрд▓ рдорд╛рдирдХ: рдПрд░реНрдЧреЛрдиреЙрдорд┐рдХреНрд╕ + рдкреНрд░рджрд░реНрд╢рди </h2><br><p>  рд╣рд╛рд╕реНрдХреЗрд▓ рдПрдХ рд╕рд░рд▓ рдкреНрд░рдгрд╛рд▓реА рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ: рдЖрд▓рд╕реА рдЧрдгрдирд╛, рдмреАрдЬреАрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдФрд░ рдкреНрд░рдХрд╛рд░ рдХреА рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдмрд╣реБрд░реВрдкреА рд▓реИрдореНрдмреНрдбрд╛ рдкрдерд░реАред  рдпрд╣ рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рд╕рдВрдпреЛрдЬрди рд╣реИ рдЬреЛ рд╣рдореЗрдВ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг, рд╕рдорд░реНрдерд┐рдд рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдЙрддреНрдкрд╛рджрдХ рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдЗрд╕ рджрд╛рд╡реЗ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╣рд╛рд╕реНрдХреЗрд▓ рдХреА рддреБрд▓рдирд╛ рдЕрдзрд┐рдХ рд▓реЛрдХрдкреНрд░рд┐рдп рднрд╛рд╖рд╛рдУрдВ рд╕реЗ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдореЗрдореЛрд░реА рдореЗрдореЛрд░реА рд╡рд╛рд▓реА рднрд╛рд╖рд╛рдПрдВ, рдЬреИрд╕реЗ рдХрд┐ рд╕реА, рд╕рдмрд╕реЗ рдЧрдВрднреАрд░ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдХрд╛рд░рдг рдмрдирддреА рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ, рдореЗрдореЛрд░реА рд▓реАрдХ)ред  рдХрднреА-рдХрднреА рдРрд╕реА рднрд╛рд╖рд╛рдУрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╡рд┐рдЪрд╛рд░ рд╣реИ рдЗрд╕рд▓рд┐рдПред </p><br><p>  рд╕реБрд░рдХреНрд╖рд┐рдд рдореЗрдореЛрд░реА рдПрдХреНрд╕реЗрд╕ рд▓реИрдВрдЧреНрд╡реЗрдЬ рджреЛ рд╕рдореВрд╣ рдмрдирд╛рддреА рд╣реИрдВ: рд╡реЗ рдЬреЛ рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╛рд╣рдХ рдФрд░ рдЬрдВрдЧ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВред  <a href="https://pcwalton.github.io/2013/05/20/safe-manual-memory-management.html" rel="nofollow">рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣ рдХреЗ рдмрд┐рдирд╛ рдореЗрдореЛрд░реА рддрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдкрд╣реБрдВрдЪ</a> рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рдиреЗ рдореЗрдВ рдЬрдВрдЧ рдЕрджреНрд╡рд┐рддреАрдп рд▓рдЧрддреА рд╣реИред  рдЗрд╕ рд╕рдореВрд╣ рдореЗрдВ рдЕрдм рдЪрдХреНрд░рд╡рд╛рдд рдФрд░ рдЕрдиреНрдп рд╢реЛрдз рднрд╛рд╖рд╛рдУрдВ рдХрд╛ рднреА рд╕рдорд░реНрдерди рдирд╣реАрдВ рд╣реИред  рд▓реЗрдХрд┐рди рдЙрдирдХреЗ рд╡рд┐рдкрд░реАрдд, рд░рд╕реНрдЯ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХреЗ рд░рд╛рд╕реНрддреЗ рдкрд░ рд╣реИред  рдиреБрдХрд╕рд╛рди рдпрд╣ рд╣реИ рдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд░рд╕реНрдЯ рдХрд╛ рдореЗрдореЛрд░реА рдкреНрд░рдмрдВрдзрди рдЧреИрд░-рддреБрдЪреНрдЫ рдФрд░ рдореИрдиреБрдЕрд▓ рд╣реИред  рдЙрди рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЬреЛ рдХрдЪрд░рд╛ рдХрд▓реЗрдХреНрдЯрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рд╡рд╣рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рд╕рдордп рдмрд┐рддрд╛рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИред </p><br><p>  рдХрдЪрд░рд╛ рдмреАрдирдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рдкрд╛рд╕ рднрд╛рд╖рд╛рдПрдВ рдмрдЪреА рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдЖрдЧреЗ рдЙрдирдХреА рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рджреЛ рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВрдЧреЗред </p><br><p>  рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдЯрд╛рдЗрдк рдХреА рдЧрдИ (рдпрд╛ рдмрд▓реНрдХрд┐ <a href="https://existentialtype.wordpress.com/2011/03/19/dynamic-languages-are-static-languages/" rel="nofollow">рдореЛрдиреЛрдЯрд╛рдЗрдкреНрдб</a> ) рднрд╛рд╖рд╛рдПрдВ, рдЬреИрд╕реЗ рдХрд┐ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдХреНрд▓реЛрдЬрд░, рд╕реНрдереИрддрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдФрд░ рдЗрд╕рд▓рд┐рдП рдХреЛрдб рдХреА рд╢реБрджреНрдзрддрд╛ рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд╛ рд╕рдорд╛рди рд╕реНрддрд░ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддреА (рдФрд░ рдирд╣реАрдВ, рдкрд░реАрдХреНрд╖рдг рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ - рдЖрдкрдХреЛ рджреЛрдиреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ) !)ред </p><br><p>  рдЬрд╛рд╡рд╛ рдпрд╛ рдЧреЛ рдЬреИрд╕реА рд╡реИрдзрд╛рдирд┐рдХ рд░реВрдк рд╕реЗ рдЯрд╛рдЗрдк рдХреА рдЧрдИ рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдЕрдХреНрд╕рд░ рдмрд╣реБрдд рд╕реАрдорд┐рдд рдкреНрд░рдХрд╛рд░ рдХреА рдкреНрд░рдгрд╛рд▓реА рд╣реЛрддреА рд╣реИред  рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░реНрд╕ рдХреЛ рдирд┐рд░рд░реНрдердХ рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдФрд░ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЧреЛ рдореЗрдВ рдЬреЗрдиреЗрд░рд┐рдХ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдХрдореА <a href="https://tour.golang.org/methods/14" rel="nofollow">рдЗрдВрдЯрд░рдлрд╝реЗрд╕ {}</a> рдХреЗ рдЙрдкрдпреЛрдЧ рдФрд░ <a href="https://golang.org/ref/spec" rel="nofollow">рд░рдирдЯрд╛рдЗрдо рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдврд▓рд╛рдИ рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдп рдХрд░рддреА рд╣реИ</a> ред  рд╕рд╛рдЗрдб рдЗрдлреЗрдХреНрдЯ (рдЗрдирдкреБрдЯ, рдЖрдЙрдЯрдкреБрдЯ) рдФрд░ рд╢реБрджреНрдз рдЧрдгрдирд╛ рдХреЗ рд╕рд╛рде рдЧрдгрдирд╛ рдХреЗ рдмреАрдЪ рдХреЛрдИ рдЕрд▓рдЧрд╛рд╡ рдирд╣реАрдВ рд╣реИред </p><br><p>  рдЕрдВрдд рдореЗрдВ, рд╕реБрд░рдХреНрд╖рд┐рдд рдореЗрдореЛрд░реА рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рднрд╛рд╖рд╛рдУрдВ рдХреЗ рдмреАрдЪ, рдПрдХ рдХрдЪрд░рд╛ рдХрд▓реЗрдХреНрдЯрд░ рдФрд░ рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдкреНрд░рдХрд╛рд░ рдХреА рдкреНрд░рдгрд╛рд▓реА, рд╣рд╛рд╕реНрдХреЗрд▓ рдЖрд▓рд╕реНрдп рдХреЗ рд▓рд┐рдП рдмрд╛рд╣рд░ рдЦрдбрд╝рд╛ рд╣реИред  <a href="https://augustss.blogspot.com/2011/05/more-points-for-lazy-evaluation-in.html" rel="nofollow">рдЖрд▓рд╕реА рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ</a> рдХрдВрдкреЛрдЬрд╝реЗрдмрд▓, рдореЙрдбреНрдпреВрд▓рд░ рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмреЗрд╣рдж рдЙрдкрдпреЛрдЧреА рд╣реИред  рд╡реЗ рд╕рд╣рд╛рдпрдХ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЗ рдХрд┐рд╕реА рднреА рд╣рд┐рд╕реНрд╕реЗ рдореЗрдВ рд╡рд┐рдШрдЯрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдмрдирд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдирд┐рд░реНрдорд╛рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВред </p><br><p>  рд╣рд╛рд╕реНрдХреЗрд▓ рд▓рдЧрднрдЧ рдПрдХ рд╕рд╣реА рднрд╛рд╖рд╛ рдХреА рддрд░рд╣ рд▓рдЧрддрд╛ рд╣реИ рдЬрдм рддрдХ рдЖрдкрдХреЛ рдПрд╣рд╕рд╛рд╕ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ <a href="https://agda.readthedocs.io/en/latest/" rel="nofollow">рдПрдЬрдбрд╛</a> рдЬреИрд╕реЗ рдкреНрд░рдореЗрдп рдкреНрд░реВрдл рд╕рд╛рдзрдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╕реНрдереИрддрд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрдкрдиреА рдкреВрд░реА рдХреНрд╖рдорддрд╛ рд╕реЗ рджреВрд░ рд╣реИред </p><br><p> рдЬрд╣рд╛рдВ рд╣рд╛рд╕реНрдХреЗрд▓ рдкреНрд░рдХрд╛рд░ рдкреНрд░рдгрд╛рд▓реА рдкрд░реНрдпрд╛рдкреНрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдирд╣реАрдВ рд╣реИ, рдЙрд╕рдХреЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, <code>Prelude</code> (рдпрд╛ рдПрдХ <code>primitive</code> рдкреИрдХреЗрдЬ рд╕реЗ рдПрдХ <a href="http://hackage.haskell.org/package/primitive-0.6.4.0/docs/Data-Primitive-Array.html" rel="nofollow">рд╕рд░рдгреА рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛)</a> рд╕реЗ <a href="http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html" rel="nofollow">рд╕реВрдЪреА рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛</a> рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: </p><br><pre> <code class="haskell hljs">(!!) :: [a] -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; a indexArray :: <span class="hljs-type"><span class="hljs-type">Array</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; a</code> </pre> <br><p>  рдЗрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдореЗрдВ рдХреБрдЫ рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рд╕реВрдЪрдХрд╛рдВрдХ рдЧреИрд░-рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╕рдВрдЧреНрд░рд╣ рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдХрдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЙрдЪреНрдЪ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рд╡рд╛рд▓реЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рд╣реИред </p><br><h2 id="agda-ergonomika--korrektnost">  рдПрдЬрдбрд╛: рдПрд░реНрдЧреЛрдиреЙрдорд┐рдХреНрд╕ + рд╢реБрджреНрдзрддрд╛ </h2><br><p>  рдкреНрд░рдореЗрдпреЛрдВ рдХреЗ рдкреНрд░рдорд╛рдг рдХреЗ рд╕рд╛рдзрди (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="https://coq.inria.fr/" rel="nofollow">рдХреЛрдХ</a> ) рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдЙрдкрдХрд░рдг рд╣реИрдВ рдЬреЛ рдЧрдгрд┐рддреАрдп рдкреНрд░рдореЗрдпреЛрдВ рдХреЗ рдФрдкрдЪрд╛рд░рд┐рдХ рдкреНрд░рдорд╛рдг рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрдкреНрдпреВрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред  рдПрдХ рдЧрдгрд┐рддрдЬреНрдЮ рдХреЗ рд▓рд┐рдП, рдРрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдХрд╛рдЧрдЬ рдкрд░ рд╕рдмреВрдд рд▓рд┐рдЦрдиреЗ рдЬреИрд╕рд╛ рд╣реИред  рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рд╛рдХреНрд╖реНрдп рдХреА рд╡реИрдзрддрд╛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрдкреНрдпреВрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдЕрднреВрддрдкреВрд░реНрд╡ рдХрдареЛрд░рддрд╛ рдореЗрдВ рдЕрдВрддрд░ред </p><br><p>  рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдХреЗ рд▓рд┐рдП, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреНрд░рдореЗрдпреЛрдВ рдХреЛ рд╕рд╛рдмрд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╕рд╛рдзрди рдПрдХ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкреНрд░рдХрд╛рд░ рдХреА рдкреНрд░рдгрд╛рд▓реА (рдФрд░ рд╕рдВрднрд╡рддрдГ рдПрдХ рдПрдХреАрдХреГрдд рд╡рд┐рдХрд╛рд╕ рд╡рд╛рддрд╛рд╡рд░рдг) рдХреЗ рд╕рд╛рде рдЧреВрдврд╝ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЗ рд▓рд┐рдП рд╕рдВрдХрд▓рдХ рд╕реЗ рдЗрддрдирд╛ рдЕрд▓рдЧ рдирд╣реАрдВ рд╣реИ, рдФрд░ рдФрд╕рдд рджрд░реНрдЬреЗ (рдпрд╛ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдиреБрдкрд╕реНрдерд┐рдд) рдмрд╛рдХреА рд╕рдм рдХреБрдЫред  рдкреНрд░рдореЗрдп рд╕рд╛рдмрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕рд╛рдзрди, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдПрдВ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рд▓реЗрдЦрдХреЛрдВ рдиреЗ рдЕрдкрдирд╛ рд╕рд╛рд░рд╛ рд╕рдордп рдПрдХ рдЯрд╛рдЗрдкрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдмрд┐рддрд╛рдпрд╛ рдФрд░ рдпрд╣ рднреВрд▓ рдЧрдП рдХрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рдЕрднреА рднреА рдЪрд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><p>  рд╕рддреНрдпрд╛рдкрд┐рдд рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХрд╛ рдкреЛрд╖рд┐рдд рд╕рдкрдирд╛ рдкреНрд░рдореЗрдпреЛрдВ рдХреЛ рд╕рд╛рдмрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕рд╛рдзрди рд╣реИ, рдЬреЛ рдЙрдЪреНрдЪ рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд╛рд▓реЗ рдХреЛрдб рдЬрдирд░реЗрдЯрд░ рдФрд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдЪреНрдЫреА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рд╣реЛрдЧреАред  рдЗрд╕ рджрд┐рд╢рд╛ рдореЗрдВ <a href="https://www.idris-lang.org/" rel="nofollow">рдЗрджрд░реАрд╕</a> рдХреЗ рд░рдЪрдирд╛рдХрд╛рд░реЛрдВ рдиреЗ рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ред  рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдЦреНрдд (рдКрд░реНрдЬрд╛рд╡рд╛рди) рдЧрдгрдирд╛ рдХреЗ рд╕рд╛рде рдПрдХ рднрд╛рд╖рд╛ рд╣реИ, рдФрд░ рдлрд┐рд▓рд╣рд╛рд▓ рдЗрд╕рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕реНрдерд┐рд░ рдирд╣реАрдВ рд╣реИред </p><br><p>  рдкреНрд░рдореЗрдпреЛрдВ рдХреЛ рд╕рд┐рджреНрдз рдХрд░рдиреЗ рдХреЗ рд╕рднреА рд╕рд╛рдзрдиреЛрдВ рдореЗрдВ, рдПрдЬрдбрд╛ рд╣рд╛рд╕реНрдХреЗрд▓рд┐рд╕реНрдЯ рд╕рднреА рдХреЛ рдкрд╕рдВрдж рдХрд░рддреЗ рд╣реИрдВред  рдХрдИ рдорд╛рдпрдиреЛрдВ рдореЗрдВ, рдпрд╣ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдзрд┐рдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдкреНрд░рдХрд╛рд░ рдХреА рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд╕рд╛рдеред  рд╣рдо рд╕реЗрд░реЛрдХреЗрд▓ рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкрдиреЗ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЧреБрдгреЛрдВ рдХреЛ рд╕рд╛рдмрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред  рдореЗрд░реА рд╕рд╣рдпреЛрдЧреА рдбрд╛рдирд┐рдпрд╛ рд░реЛрдЧреЛрдЬрд┐рди рдиреЗ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ <a href="https://serokell.io/blog/2018/11/14/logical-background" rel="nofollow">рдХрдИ рд▓реЗрдЦ рд▓рд┐рдЦреЗ</a> ред </p><br><p>  рдпрд╣рд╛рдБ рд╣рд╛рд╕реНрдХреЗрд▓ рдСрдкрд░реЗрдЯрд░ <code>(!!)</code> рд╕рдорд╛рди рдПрдХ <a href="" rel="nofollow">рд▓реБрдХрдЕрдк</a> рдлрдВрдХреНрд╢рди рдЯрд╛рдЗрдк рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">lookup</span></span> : тИА (xs : <span class="hljs-type"><span class="hljs-type">List</span></span> <span class="hljs-type"><span class="hljs-type">A</span></span>) тЖТ <span class="hljs-type"><span class="hljs-type">Fin</span></span> (length xs) тЖТ <span class="hljs-type"><span class="hljs-type">A</span></span></code> </pre> <br><p>  рдпрд╣рд╛рдВ рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдЯрд╛рдЗрдк <code>List A</code> , рдЬреЛ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ <code>[a]</code> рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╣рдо рдЗрд╕реЗ рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╛рдо <code>xs</code> рджреЗрддреЗ рд╣реИрдВред  рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ, рд╣рдо рдХреЗрд╡рд▓ рд╢рдмреНрдж рд╕реНрддрд░ рдкрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рддрд░реНрдХреЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="haskell hljs">(!!) :: [a] -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> -&gt; a <span class="hljs-comment"><span class="hljs-comment">--   xs  (!!) = \xs i -&gt; ... --   xs </span></span></code> </pre> <br><p>  рд▓реЗрдХрд┐рди Agda рдореЗрдВ, рд╣рдо рдЗрд╕ <code>xs</code> рдорд╛рди рдХреЛ рдЙрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реНрддрд░ рдкрд░ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рд╣рдо рджреВрд╕рд░реЗ <code>lookup</code> рдкреИрд░рд╛рдореАрдЯрд░, <code>Fin (length xs)</code> ред  рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдЬреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реНрддрд░ рдкрд░ рдЕрдкрдиреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЙрд╕реЗ рдПрдХ <em>рдирд┐рд░реНрднрд░ рдлрд╝рдВрдХреНрд╢рди</em> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред </p><br><p>  <code>lookup</code> рдореЗрдВ рджреВрд╕рд░рд╛ рдкреИрд░рд╛рдореАрдЯрд░ <code>n ~ length xs</code> рд▓рд┐рдП <code>Fin n</code> рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИред  <code>Fin n</code> рдкреНрд░рдХрд╛рд░ рдХрд╛ рдорд╛рди рд░реЗрдВрдЬ <code>[0, n)</code> рдореЗрдВ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП <code>Fin (length xs)</code> рдПрдХ рдЧреИрд░-рдЛрдгрд╛рддреНрдордХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ рдЬреЛ рдЗрдирдкреБрдЯ рд╕реВрдЪреА рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдХрдо рд╣реИред  рдпрд╣ рд╡рд╣реА рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдХрд┐рд╕реА рд╕реВрдЪреА рдЖрдЗрдЯрдо рдХреЗ рд╡реИрдз рд╕реВрдЪрдХрд╛рдВрдХ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдореЛрдЯреЗ рддреМрд░ рдкрд░, <code>lookup ["x","y","z"] 2</code> рдЯрд╛рдЗрдк рдЪреЗрдХрд┐рдВрдЧ рдкрд╛рд╕ рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди <code>lookup ["x","y","z"] 42</code> рдлреЗрд▓ рд╣реЛрдЧрд╛ред </p><br><p>  рдЬрдм рдпрд╣ рдПрдЬрдбрд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЪрд▓рд╛рдиреЗ рдХреА рдмрд╛рдд рдЖрддреА рд╣реИ, рддреЛ рд╣рдо MAlonzo <a href="http://wiki.portal.chalmers.se/agda/pmwiki.php%3Fn%3DDocs.MAlonzo" rel="nofollow">рдмреИрдХрдПрдВрдб</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕рдВрдХрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЙрддреНрдкрдиреНрди рдХреЛрдб рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдЕрд╕рдВрддреЛрд╖рдЬрдирдХ рд╣реЛрдЧрд╛ред  рдпрд╣ MAlonzo рдХреА рдЧрд▓рддреА рдирд╣реАрдВ рд╣реИ: рдЙрд╕реЗ рдХрдИ <code>unsafeCoerce</code> рд╕рдореНрдорд┐рд▓рд┐рдд <code>unsafeCoerce</code> рддрд╛рдХрд┐ GHC рдХреЛрдб рдкрд╣рд▓реЗ рд╕реЗ рд╣реА Agda рджреНрд╡рд╛рд░рд╛ рд╕рддреНрдпрд╛рдкрд┐рдд <code>unsafeCoerce</code> ред  рд▓реЗрдХрд┐рди рд╡рд╣реА <code>unsafeCoerce</code> <a href="https://dspace.library.uu.nl/bitstream/handle/1874/357868/3800296.pdf" rel="nofollow">рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИ</a> <em>(рдЗрд╕ рд▓реЗрдЦ рдХреА рдЪрд░реНрдЪрд╛ рдХреЗ рдмрд╛рдж, рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдкреНрд░рджрд░реНрд╢рди рдХреА рд╕рдорд╕реНрдпрд╛рдПрдВ рдЕрдиреНрдп рдХрд╛рд░рдгреЛрдВ рд╕реЗ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ - рд▓реЗрдЦрдХ рдХрд╛ рдиреЛрдЯ)</em> ред </p><br><p>  рдпрд╣ рд╣рдореЗрдВ рдПрдХ рдореБрд╢реНрдХрд┐рд▓ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИ: рд╣рдореЗрдВ рдореЙрдбрд▓рд┐рдВрдЧ рдФрд░ рдФрдкрдЪрд╛рд░рд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдПрдЬрдбрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рд╣рд╛рд╕реНрдХреЗрд▓ рдкрд░ рд╕рдорд╛рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рд╡рд░реНрдХрдлрд╝реНрд▓реЛрдЬрд╝ рдХреЗ рдЗрд╕ рд╕рдВрдЧрдарди рдХреЗ рд╕рд╛рде, рд╣рдорд╛рд░рд╛ рдПрдЬрдбрд╛ рдХреЛрдб рдПрдХ рдХрдВрдкреНрдпреВрдЯрд░-рд╕рддреНрдпрд╛рдкрд┐рдд рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдореЗрдВ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рд╕реЗ рдмреЗрд╣рддрд░ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрджрд░реНрд╢ рд╕реЗ рдмрд╣реБрдд рджреВрд░ рд╣реИред  рд▓рдХреНрд╖реНрдп рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдХреЛрдб рд╕рдВрдХрд▓рд┐рдд рд╣реИ, рддреЛ рдпрд╣ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </p><br><h2 id="haskell-s-rasshireniyami-korrektnost--proizvoditelnost">  рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓: рд╕реБрдзрд╛рд░ + рдкреНрд░рджрд░реНрд╢рди </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/954/0e8/735/9540e8735ab539e67787046735ee5789.jpg"></p><br><p>  рдЖрд╢реНрд░рд┐рдд рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рднрд╛рд╖рд╛рдУрдВ рдХреА рд╕реНрдерд┐рд░ рдЧрд╛рд░рдВрдЯреА рдХреЗ рд▓рд┐рдП, GHC рдиреЗ рдПрдХ рд▓рдВрдмрд╛ рд╕рдлрд░ рддрдп рдХрд┐рдпрд╛ рд╣реИред  рдЯрд╛рдЗрдк рд╕рд┐рд╕реНрдЯрдо рдХреА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреЛрдбрд╝реЗ рдЧрдП рдереЗред  рдореИрдВрдиреЗ Haskell рдХрд╛ рдЙрдкрдпреЛрдЧ рддрдм рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрдм GHC 7.4 рд╕рдВрдХрд▓рдХ рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдерд╛ред  рдлрд┐рд░ рднреА, рдЗрд╕рдХреЗ рдкрд╛рд╕ рдЙрдиреНрдирдд рдкреНрд░рдХрд╛рд░-рд╕реНрддрд░реАрдп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдереЗ: <code>RankNTypes</code> , <code>GADTs</code> , <code>TypeFamilies</code> , <code>DataKinds</code> рдФрд░ <code>PolyKinds</code> ред </p><br><p>  рдлрд┐рд░ рднреА, рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рдЕрднреА рднреА рдкреВрд░реНрдг-рдирд┐рд░реНрднрд░ рдЖрд╢реНрд░рд┐рдд рдкреНрд░рдХрд╛рд░ рдирд╣реАрдВ рд╣реИрдВ: рди рддреЛ рдЖрд╢реНрд░рд┐рдд рдХрд╛рд░реНрдп (╬а-type) рдФрд░ рди рд╣реА рдЖрд╢реНрд░рд┐рдд рдЬреЛрдбрд╝реЗ (dependent-types)ред  рджреВрд╕рд░реА рдУрд░, рдХрдо рд╕реЗ рдХрдо рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЙрдирдХреЗ рд▓рд┐рдП рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╣реИ! </p><br><p>  рд╡рд░реНрддрдорд╛рди рдЕрднреНрдпрд╛рд╕ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ: </p><br><ul><li>  рдирд┐рдЬреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрд░рд┐рд╡рд╛рд░реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдиреНрдХреЛрдб рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реНрддрд░, </li><li>  рдЕрд╕рдВрддреГрдкреНрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд░рд┐рдпрд╛рд╢реАрд▓рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, </li><li>  рдПрдХрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢рдмреНрджреЛрдВ рдФрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдмреАрдЪ рдХреА рдЦрд╛рдИ рдХреЛ рдкрд╛рдЯреЗрдВ </li></ul><br><p>  рдпрд╣ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рддреНрд░рд╛ рдореЗрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдХреЛрдб рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди <code>singletons</code> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЯреЗрдореНрдкрд▓реЗрдЯ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдиреА рдкреАрдврд╝реА рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/003/56f/e2a/00356fe2af43f034df850dbb556fb82f.jpg"></p><br><p>  рддреЛ рд╕рдмрд╕реЗ рд╕рд╛рд╣рд╕реА рдФрд░ рдирд┐рд░реНрдгрд╛рдпрдХ рдЕрдм рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдХреЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ, рдпрд╣рд╛рдБ Agda рдкрд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рдорд╛рди <code>lookup</code> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-meta"><span class="hljs-meta">{-# OPTIONS -Wall -Wno-unticked-promoted-constructors -Wno-missing-signatures #-}</span></span> <span class="hljs-meta"><span class="hljs-meta">{-# LANGUAGE LambdaCase, DataKinds, PolyKinds, TypeFamilies, GADTs, ScopedTypeVariables, EmptyCase, UndecidableInstances, TypeSynonymInstances, FlexibleInstances, TypeApplications, TemplateHaskell #-}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> ListLookup <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Data.Singletons.TH <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Data.Singletons.Prelude singletons [d| data N = Z | SN len :: [a] -&gt; N len [] = Z len (<span class="hljs-title"><span class="hljs-title">_</span></span>:<span class="hljs-title"><span class="hljs-title">xs</span></span>) = S (<span class="hljs-title"><span class="hljs-title">len</span></span> <span class="hljs-title"><span class="hljs-title">xs</span></span>) |] data Fin n where FZ :: Fin (<span class="hljs-type"><span class="hljs-type">S</span></span> <span class="hljs-title"><span class="hljs-title">n</span></span>) FS :: Fin n -&gt; Fin (<span class="hljs-type"><span class="hljs-type">S</span></span> <span class="hljs-title"><span class="hljs-title">n</span></span>) lookupS :: SingKind a =&gt; SList (<span class="hljs-title"><span class="hljs-title">xs</span></span> :: [<span class="hljs-title"><span class="hljs-title">a</span></span>]) -&gt; Fin (<span class="hljs-type"><span class="hljs-type">Len</span></span> <span class="hljs-title"><span class="hljs-title">xs</span></span>) -&gt; Demote a lookupS SNil = \case{} lookupS (<span class="hljs-type"><span class="hljs-type">SCons</span></span> <span class="hljs-title"><span class="hljs-title">x</span></span> <span class="hljs-title"><span class="hljs-title">xs</span></span>) = \case FZ -&gt; fromSing x FS i' -&gt; lookupS xs i'</code> </pre> <br><p>  рдФрд░ рдпрд╣рд╛рдБ GHCi рд╕рддреНрд░ рджрд┐рдЦрд╛ рд░рд╣рд╛ рд╣реИ рдХрд┐ рд▓реБрдХрдЕрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдРрд╕реЗ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдмрд╣реБрдд рдмрдбрд╝реЗ рд╣реИрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-type"><span class="hljs-type">GHCi</span></span>, version <span class="hljs-number"><span class="hljs-number">8.6</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>: http://www.haskell.org/ghc/ :? for help [<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-type"><span class="hljs-type">Compiling</span></span> <span class="hljs-type"><span class="hljs-type">ListLookup</span></span> ( <span class="hljs-type"><span class="hljs-type">ListLookup</span></span>.hs, interpreted ) <span class="hljs-type"><span class="hljs-type">Ok</span></span>, one <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> loaded. *ListLookup&gt; :set -XTypeApplications -XDataKinds *ListLookup&gt; lookupS (<span class="hljs-title"><span class="hljs-title">sing</span></span> @["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) FZ "x" *ListLookup&gt; lookupS (<span class="hljs-title"><span class="hljs-title">sing</span></span> @["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) (<span class="hljs-type"><span class="hljs-type">FS</span></span> <span class="hljs-type"><span class="hljs-type">FZ</span></span>) "y" *ListLookup&gt; lookupS (<span class="hljs-title"><span class="hljs-title">sing</span></span> @["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> <span class="hljs-type"><span class="hljs-type">FZ</span></span>)) "z" *ListLookup&gt; lookupS (<span class="hljs-title"><span class="hljs-title">sing</span></span> @["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> <span class="hljs-type"><span class="hljs-type">FZ</span></span>))) &lt;interactive&gt;:5:34: error: тАв Couldn't match type ''S n0' with ''Z' Expected type: Fin (<span class="hljs-type"><span class="hljs-type">Len</span></span> '["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) Actual type: Fin ('<span class="hljs-type"><span class="hljs-type">S</span></span> ('<span class="hljs-type"><span class="hljs-type">S</span></span> ('<span class="hljs-type"><span class="hljs-type">S</span></span> ('<span class="hljs-type"><span class="hljs-type">S</span></span> <span class="hljs-title"><span class="hljs-title">n0</span></span>)))) тАв In the second argument of 'lookupS', namely '(<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> <span class="hljs-type"><span class="hljs-type">FZ</span></span>)))' In the expression: lookupS (<span class="hljs-title"><span class="hljs-title">sing</span></span> @["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> <span class="hljs-type"><span class="hljs-type">FZ</span></span>))) In an equation for 'it': it = lookupS (<span class="hljs-title"><span class="hljs-title">sing</span></span> @["<span class="hljs-title"><span class="hljs-title">x</span></span>", "<span class="hljs-title"><span class="hljs-title">y</span></span>", "<span class="hljs-title"><span class="hljs-title">z</span></span>"]) (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> (<span class="hljs-type"><span class="hljs-type">FS</span></span> <span class="hljs-type"><span class="hljs-type">FZ</span></span>)))</code> </pre> <br><p>  рдпрд╣ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рд╡реНрдпрд╡рд╣рд╛рд░реНрдпрддрд╛ рдХрд╛ рдорддрд▓рдм рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдирд╣реАрдВ рд╣реИред  рдореБрдЭреЗ рдЦреБрд╢реА рд╣реИ рдХрд┐ <code>lookupS</code> рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рд╛рд╕реНрдХреЗрд▓ рдХреА рднрд╛рд╖рд╛ рдХреНрд╖рдорддрд╛рдПрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рд╛рде рд╣реА рдореИрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдЬрдЯрд┐рд▓рддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд┐рдВрддрд┐рдд рд╣реВрдВ рдЬреЛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИред  рдЕрдиреБрд╕рдВрдзрд╛рди рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рдмрд╛рд╣рд░, рдореИрдВ рдЗрд╕ рддрд░рд╣ рдХреА рдХреЛрдб рд╢реИрд▓реА рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ред </p><br><p>  рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рд▓рдВрдмрд╛рдИ-рдЕрдиреБрдХреНрд░рдорд┐рдд рд╡реИрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдо рдЬрдЯрд┐рд▓рддрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, Agda рд╕реЗ рдкреНрд░рддреНрдпрдХреНрд╖ рдХреЛрдб рдЕрдиреБрд╡рд╛рдж рдЙрди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдмреЗрд╣рддрд░ рдврдВрдЧ рд╕реЗ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЕрдиреНрдп рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред </p><br><p>  рдпрд╣рд╛рдБ рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рд╣реИрдВ: </p><br><ul><li>  рдЯрд╛рдЗрдкрд┐рдВрдЧ рдХрд╛ рд╕рдВрдмрдВрдз <code>a :: t</code> рдФрд░ рдкреНрд░рдкрддреНрд░ <code>t :: k</code> рдХрд╛ рдЧрдВрддрд╡реНрдп рд╕рдВрдмрдВрдз <code>t :: k</code> рдЕрд▓рдЧ рд╣реИрдВред  <code>5 :: Integer</code> рд╢рдмреНрджреЛрдВ рдореЗрдВ рд╕рддреНрдп рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рдирд╣реАрдВред  <code>"hi" :: Symbol</code> рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рд╕рдЪ рд╣реИ, рд▓реЗрдХрд┐рди рд╢рдмреНрджреЛрдВ рдореЗрдВ рдирд╣реАрдВред  рдпрд╣ рд╡рд┐рдЪрд╛рд░реЛрдВ рдФрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>Demote</code> рдЯрд╛рдЗрдк <code>Demote</code> рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </li><li>  рдорд╛рдирдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп <code>Int</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реВрдЪреА рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░рддрд╛ рд╣реИ (рдФрд░ <code>singletons</code> рдКрдВрдЪреЗ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ <code>Nat</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ)ред  <code>Int</code> рдФрд░ <code>Nat</code> рдЧреИрд░-рдЖрдЧрдордирд╛рддреНрдордХ рдкреНрд░рдХрд╛рд░ рд╣реИрдВред  рдкреНрд░рд╛рдХреГрддрд┐рдХ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреА рдПрдХрд╛рддреНрдордХ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╡реЗ <code>Fin</code> рдпрд╛ <code>lookupS</code> рдЬреИрд╕реЗ рдкреНрд░реЗрд░рдХ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рд╡рдЬрд╣ рд╕реЗ, рд╣рдо <code>length</code> рдХреЛ <code>len</code> рд░реВрдк рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </li><li>  рд╣рд╕реНрдХреЗрд▓ рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕реНрддрд░ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рддрдВрддреНрд░ рдирд╣реАрдВ рд╣реИред  <code>singletons</code> рдЙрдиреНрд╣реЗрдВ рдирд┐рдЬреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрд░рд┐рд╡рд╛рд░реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрд░рд┐рд╡рд╛рд░реЛрдВ рдХреЗ рдЖрдВрд╢рд┐рдХ рдЙрдкрдпреЛрдЧ рдХреА рдХрдореА рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд░рд┐рдпрд╛рд╢реАрд▓рддрд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдЬрдЯрд┐рд▓ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрдВ рдПрдХ рдЯреЗрдореНрдкреНрд▓реЗрдЯ рд╣рд╛рд╕реНрдХреЗрд▓ рдЙрджреНрдзрд░рдг рдореЗрдВ <code>len</code> рдкрд░рд┐рднрд╛рд╖рд╛ <code>len</code> рдереА, рддрд╛рдХрд┐ <code>singletons</code> рдЕрдкрдиреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реНрддрд░ рдХреЗ рд╕рдордХрдХреНрд╖, <code>Len</code> рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред </li><li>  рдХреЛрдИ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЖрд╢реНрд░рд┐рдд рдХрд╛рд░реНрдп рдирд╣реАрдВ рд╣реИрдВред  рд╢рдмреНрджреЛрдВ рдФрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреЛ рдкрд╛рдЯрдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://repository.brynmawr.edu/cgi/viewcontent.cgi%3Farticle%3D1009%26context%3Dcompsci_pubs" rel="nofollow">рдЗрдХрд╛рдИ рдкреНрд░рдХрд╛рд░реЛрдВ</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИред  рд╕рд╛рдорд╛рдиреНрдп рд╕реВрдЪреА рдХреЗ рдмрдЬрд╛рдп, рд╣рдо <code>SList</code> рдХреЛ <code>lookupS</code> рдЗрдирдкреБрдЯ рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рд╣реА рдмрд╛рд░ рдореЗрдВ рд╕реВрдЪрд┐рдпреЛрдВ рдХреА рдХрдИ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рджреМрд░рд╛рди рдУрд╡рд░рд╣реЗрдб рдХреА рдУрд░ рднреА рдЬрд╛рддрд╛ рд╣реИред  рд╡реЗ рдпреВрдирд┐рдЯ рдкреНрд░рдХрд╛рд░реЛрдВ ( <code>toSing</code> , <code>fromSing</code> ) рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдореВрд▓реНрдпреЛрдВ рдФрд░ рдореВрд▓реНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рдХрд╛рд░рдг рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд░реВрдкрд╛рдВрддрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ ( <code>SingKind</code> рдкреНрд░рддрд┐рдмрдВрдз) рдХреЗ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдХреЗ рдХрд╛рд░рдгред </li></ul><br><p>  рдЕрд╕реБрд╡рд┐рдзрд╛ рдХрдо рд╕рдорд╕реНрдпрд╛ рд╣реИред  рдЗрд╕рд╕реЗ рднреА рдмрджрддрд░, рдпреЗ рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ 2016 рдореЗрдВ рд╕рдорд╕реНрдпрд╛ <a href="https://gitlab.haskell.org/ghc/ghc/issues/12564" rel="nofollow"># 12564</a> рд╡рд╛рдкрд╕ рдХреА, рдФрд░ рдЙрд╕реА рд╡рд░реНрд╖ рдХреЗ <a href="https://gitlab.haskell.org/ghc/ghc/issues/12088" rel="nofollow"># 12088</a> рднреА рд╣реИрдВред  рджреЛрдиреЛрдВ рд╕рдорд╕реНрдпрд╛рдПрдВ рдкрд╛рдареНрдпрдкреБрд╕реНрддрдХреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ (рдЬреИрд╕реЗ рдЕрдиреБрдХреНрд░рдордг рд╕реВрдЪрд┐рдпреЛрдВ) рд╕реЗ рдЕрдзрд┐рдХ рдЙрдиреНрдирдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдмрд╛рдзрд╛ рдбрд╛рд▓рддреА рд╣реИрдВред  рдпреЗ рдЬреАрдПрдЪрд╕реА рдХреАрдбрд╝реЗ рдЕрднреА рднреА рддрдп рдирд╣реАрдВ рд╣реИрдВ, рдФрд░ рдЗрд╕рдХрд╛ рдХрд╛рд░рдг, рдореБрдЭреЗ рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ, рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рд╕рдордп рдирд╣реАрдВ рд╣реИред  рдЬреАрдПрдЪрд╕реА рдкрд░ рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓реЛрдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд░реВрдк рд╕реЗ рдмрд╣реБрдд рдХрдо рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХреБрдЫ рдЪреАрдЬреЗрдВ рдЖрд╕рдкрд╛рд╕ рдирд╣реАрдВ рдорд┐рд▓рддреА рд╣реИрдВред </p><br><h2 id="rezyume">  рд╕рд╛рд░рд╛рдВрд╢ </h2><br><p>  рдореИрдВрдиреЗ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдерд╛ рдХрд┐ рд╣рдо рдХреЛрдб рд╕реЗ рд╕рднреА рддреАрди рдЧреБрдг рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рд╣реИ рдЬреЛ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЛ рджрд░реНрд╢рд╛рддреА рд╣реИ: </p><br><div class="scrollable-table"><table><thead><tr><th></th><th>  рдорд╛рдирдХ рд╣рд╛рд╕реНрдХреЗрд▓ </th><th>  AGDA </th><th>  рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓ </th></tr></thead><tbody><tr><td>  рдПрд░реНрдЧреЛрдиреЙрдорд┐рдХреНрд╕ рдФрд░ рдореЗрдВрдЯреЗрдиреЗрдВрд╕ </td><td>  + </td><td>  + </td><td>  - </td></tr><tr><td>  рдЙрддреНрдкрд╛рджрдХрддрд╛ </td><td>  + </td><td>  - </td><td>  + </td></tr><tr><td>  рдЖрд▓реЗрдЦрди рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рд╕рд╣реА рдХреА рдЧрдИ рдЧрд╛рд░рдВрдЯреА </td><td>  - </td><td>  + </td><td>  + </td></tr></tbody></table></div><br><h1 id="svetloe-buduschee">  рдЙрдЬреНрдЬрд╡рд▓ рднрд╡рд┐рд╖реНрдп </h1><br><p>  рдЙрдкрд▓рдмреНрдз рддреАрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреА рдЕрдкрдиреА рдХрдорд┐рдпрд╛рдВ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдареАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><ul><li>  рдорд╛рдирдХ рд╣рд╛рд╕реНрдХреЗрд▓ рд▓реЗрдВ рдФрд░ <code>singletons</code> рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдХреЛрдбрд┐рдВрдЧ рдХреЗ рдмрдЬрд╛рдп рд╕реАрдзреЗ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░ рдЬреЛрдбрд╝реЗрдВред  (рдЖрд╕рд╛рди рдХрд╛рдо рд╕реЗ рдХрд╣рд╛ред) </li><li>  Agda рд▓реЗ рд▓реЛ рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдХреБрд╢рд▓ рдХреЛрдб рдЬрдирд░реЗрдЯрд░ рдФрд░ RTS рд▓рд╛рдЧреВ рдХрд░реЗрдВред  (рдЖрд╕рд╛рди рдХрд╛рдо рд╕реЗ рдХрд╣рд╛ред) </li><li>  рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓ рд▓реЗрдВ, рдмрдЧ рдХреЛ рдареАрдХ рдХрд░реЗрдВ рдФрд░ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдХреЛрдбрд┐рдВрдЧ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреЛрдбрд╝рдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдВред  (рдЖрд╕рд╛рди рдХрд╛рдо рд╕реЗ рдХрд╣рд╛ред) </li></ul><br><p>  рдЕрдЪреНрдЫреА рдЦрдмрд░ рдпрд╣ рд╣реИ рдХрд┐ рд╕рднреА рддреАрди рд╡рд┐рдХрд▓реНрдк рдПрдХ рдмрд┐рдВрджреБ рдкрд░ (рдПрдХ рдЕрд░реНрде рдореЗрдВ) рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред  рдорд╛рдирдХ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рд╡рд┐рд╕реНрддрд╛рд░ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдЬреЛ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреЛрдб рдХреЗ рд╕рд╣реА рд╣реЛрдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред  рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХреЛрдб рдХреЗ рдмрд┐рдирд╛ Agda рдХреЛрдб рдХреЛ рдЗрд╕ рднрд╛рд╖рд╛ рдореЗрдВ рд╕рдВрдХрд▓рд┐рдд (рдЯреНрд░рд╛рдВрд╕рдкреЛрдЬрд╝реНрдб) рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдФрд░ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓ рдПрдХ рдЕрд░реНрде рдореЗрдВ, рдЗрд╕ рднрд╛рд╖рд╛ рдХрд╛ рдПрдХ рдЕрдзреВрд░рд╛ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╣реИред  рдХреБрдЫ рдХреЛ рд╕реБрдзрд╛рд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдХреБрдЫ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдВрдд рдореЗрдВ, рд╣рдо рд╡рд╛рдВрдЫрд┐рдд рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред </p><br><h2 id="izbavlenie-ot-singletons">  рд╕рд┐рдВрдЧрд▓реЗрдЯреНрд╕ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ </h2><br><p>  рдкреНрд░рдЧрддрд┐ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рд╕рдВрдХреЗрддрдХ <code>singletons</code> рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рд╕рд░рд▓реАрдХрд░рдг рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдЖрд╢реНрд░рд┐рдд рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд░реНрдХрдЕрд░рд╛рдЙрдВрдб рдФрд░ <code>singletons</code> рдореЗрдВ рд▓рд╛рдЧреВ рд╡рд┐рд╢реЗрд╖ рдорд╛рдорд▓реЛрдВ рдХреА рд╡рд┐рд╢реЗрд╖ рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдХреА рдЕрдм рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЕрдВрддрддрдГ, рдЗрд╕ рдкреИрдХреЗрдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рдПрдЧреАред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 2016 рдореЗрдВ, <code>-XTypeInType</code> рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ <code>-XTypeInType</code> рдореИрдВрдиреЗ <a href="https://github.com/goldfirere/singletons/pull/148/files" rel="nofollow">рдХреЗрдкреНрд░реЙрдХреНрд╕реА</a> рдХреЛ <code>SingKind</code> рдФрд░ <code>SomeSing</code> рд╕реЗ <a href="https://github.com/goldfirere/singletons/pull/148/files" rel="nofollow">рд╣рдЯрд╛ рджрд┐рдпрд╛</a> ред  рдпрд╣ рдкрд░рд┐рд╡рд░реНрддрди рдкреНрд░рдХрд╛рд░реЛрдВ рдФрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдорд┐рд▓рди рд╕реЗ рд╕рдВрднрд╡ рд╣реБрдЖред  рдкреБрд░рд╛рдиреА рдФрд░ рдирдИ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kparam</span></span></span><span class="hljs-class"> ~ '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class">) =&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SingKind</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kparam</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> kparam :: * fromSing :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SingKind</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> kparam toSing :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> kparam -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> kparam </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> ('</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kproxy</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) where </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sing</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> ('</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KProxy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  рдкреБрд░рд╛рдиреА рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ, <code>k</code> рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╡реНрдпреВ рдкреЛрдЬреАрд╢рди рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рдлреЙрд░реНрдо <code>t :: k</code> рдХреЗ рдПрдиреЛрдЯреЗрд╢рди рдХреЗ рджрд╛рдИрдВ рдУрд░ред  рд╣рдо <code>kparam :: KProxy k</code> рдЙрдкрдпреЛрдЧ <code>kparam :: KProxy k</code> рдХреЛ <code>k</code> рдХреЛ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ <code>k</code> рд▓рд┐рдПред </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SingKind</span></span></span><span class="hljs-class"> k </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> k :: * fromSing :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SingKind</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> k toSing :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> k -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> k </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DemoteRep</span></span></span><span class="hljs-class"> k </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> k where </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sing</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> k</span></span></code> </pre> <br><p>  рдирдИ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ, <code>k</code> рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рджреГрд╢реНрдп рдФрд░ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрджреЛрдВ рдХреЗ рдмреАрдЪ рдЪрд▓рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ <code>KProxy</code> рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐, рдЬреАрдПрдЪрд╕реА 8.0 рд╕реЗ рд╢реБрд░реВ рд╣реЛрдХрд░, рдкреНрд░рдХрд╛рд░ рдФрд░ рдкреНрд░рдХрд╛рд░ рдПрдХ рд╣реА рд╕рд┐рдВрдЯреИрдХреНрдЯрд┐рдХ рд╢реНрд░реЗрдгреА рдореЗрдВ рдЖрддреЗ рд╣реИрдВред </p><br><p>  рдорд╛рдирдХ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рддреАрди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рджреБрдирд┐рдпрд╛ рд╣реИрдВ: рд╢рдмреНрдж, рдкреНрд░рдХрд╛рд░ рдФрд░ рд╡рд┐рдЪрд╛рд░ред  рдпрджрд┐ рдЖрдк рдЬреАрдПрдЪрд╕реА 7.10 рдХреЗ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ <a href="" rel="nofollow">рдкрд╛рд░реНрд╕рд░</a> рдФрд░ рдПрдХ рдЕрд▓рдЧ <a href="" rel="nofollow">рдЪреЗрдХ</a> рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдЬреАрдПрдЪрд╕реА 8.0 рдЕрдм рдЙрдирдХреЗ рдкрд╛рд╕ рдирд╣реАрдВ рд╣реИ: рдкреНрд░рдХрд╛рд░ рдФрд░ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП <a href="" rel="nofollow">рдкрд╛рд░реНрд╕рд░</a> рдФрд░ <a href="" rel="nofollow">рд╕рддреНрдпрд╛рдкрди</a> рдЖрдо рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d01/37e/387/d0137e3870470beb4b2aee56240926cf.jpg"></p><br><p>  рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ, рджреГрд╢реНрдп рдХреЗрд╡рд▓ рд╡рд╣ рднреВрдорд┐рдХрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рдХрд╛рд░ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">f</span></span> :: <span class="hljs-type"><span class="hljs-type">T</span></span> z -&gt; ... <span class="hljs-comment"><span class="hljs-comment">-- 'z'   g :: T (a :: z) -&gt; ... -- 'z'   h :: T z -&gt; T (a :: z) -&gt; ... -- 'z'   ,  </span></span></code> </pre> <br><p>  рдЬреАрдПрдЪрд╕реА 8.08.4 рдореЗрдВ, рдЕрднреА рднреА рдкреНрд░рдХрд╛рд░ рдФрд░ рдкреНрд░рдХрд╛рд░ рдореЗрдВ рдирд╛рдо рд╕рдВрдХрд▓реНрдк рдХреЗ рдмреАрдЪ рдХреБрдЫ рдЕрдВрддрд░ рдереЗред  рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдЙрдиреНрд╣реЗрдВ рдЬреАрдПрдЪрд╕реА 8.6 рддрдХ рдЫреЛрдЯрд╛ рдХрд░ рджрд┐рдпрд╛: рдореИрдВрдиреЗ <code>StarIsType</code> рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрдирд╛рдпрд╛ рдФрд░ <code>StarIsType</code> рдореЗрдВ <code>PolyKinds</code> рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреЗрд╢ рдХреАред  рдореИрдВрдиреЗ рд╢реЗрд╖ рдорддрднреЗрджреЛрдВ рдХреЛ рдЬреАрдПрдЪрд╕реА 8.8 рдХреЗ рд▓рд┐рдП <a href="https://github.com/ghc/ghc/commit/8df24474d0194d28b8273c1539af05793156e23f" rel="nofollow">рдЪреЗрддрд╛рд╡рдиреА рдХреЗ</a> рд░реВрдк рдореЗрдВ <a href="https://github.com/ghc/ghc/commit/8df24474d0194d28b8273c1539af05793156e23f" rel="nofollow">рдмрдирд╛рдпрд╛</a> , рдФрд░ рдЬреАрдПрдЪрд╕реА 8.10 рдореЗрдВ <a href="https://github.com/ghc/ghc/commit/5bc195b1fe788e9a900a15fbe473967850517c3e" rel="nofollow">рдЙрдиреНрд╣реЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдорд╛рдкреНрдд рдХрд░ рджрд┐рдпрд╛</a> ( <em>рдЗрд╕ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдЕрджреНрдпрддрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдореВрд▓ рд░реВрдк рдореЗрдВ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рднрд╡рд┐рд╖реНрдп рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рд▓реЗрдЦрдХ рдХрд╛ рдиреЛрдЯ</em> )ред </p><br><p>  рдЕрдЧрд▓рд╛ рдХрджрдо рдХреНрдпрд╛ рд╣реИ?  рдЖрдЗрдП рдПрдХ рдирдЬрд╝рд░ <code>SingKind</code> рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ <code>SingKind</code> рдкрд░: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SingKind</span></span></span><span class="hljs-class"> k </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> k = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">r</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">) | r -&gt; k fromSing :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sing</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k</span></span></span><span class="hljs-class">) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> k toSing :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> k -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SomeSing</span></span></span><span class="hljs-class"> k</span></span></code> </pre> <br><p>  <code>Demote</code> рдЯрд╛рдЗрдк <code>Demote</code> рд▓рд┐рдП рдЯрд╛рдЗрдкрд┐рдВрдЧ рд░рд┐рд▓реЗрд╢рди рдХреЗ рдмреАрдЪ рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ <code>Demote</code> рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ <code>a :: t</code> рдФрд░ рдлреЙрд░реНрдо рдХрд╛ рдЧрдВрддрд╡реНрдп рд░рд┐рд╢реНрддрд╛ <code>t :: k</code> ред  рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ (рдмреАрдЬреАрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП), <code>Demote</code> рдПрдХ рдкрд╣рдЪрд╛рди рдорд╛рдирдЪрд┐рддреНрд░рдг рд╣реИ: </p><br><ul><li> <code>type Demote Bool = Bool</code> </li> <li> <code>type Demote [a] = [Demote a]</code> </li> <li> <code>type Demote (Either ab) = Either (Demote a) (Demote b)</code> </li> </ul><br><p>  рдЗрд╕рд▓рд┐рдП, <code>Demote (Either [Bool] Bool) = Either [Bool] Bool</code> ред  рдпрд╣ рдЕрд╡рд▓реЛрдХрди рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд░рд▓реАрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SingKind</span></span></span><span class="hljs-class"> k </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> fromSing :: <span class="hljs-type"><span class="hljs-type">Sing</span></span> (a :: k) -&gt; k toSing :: k -&gt; <span class="hljs-type"><span class="hljs-type">SomeSing</span></span> k</code> </pre> <br><p>  рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ!  рдФрд░, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рджреЛрдиреЛрдВ <code>Either [Bool] Bool</code> рдФрд░ рдЕрдиреНрдп рдмреАрдЬреАрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдЧрд╛ред  рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рдЧреИрд░-рдмреАрдЬреАрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВ: <code>Integer,</code> <code>Natural</code> , <code>Char</code> , <code>Text</code> , рдФрд░ рдЗрд╕реА рддрд░рд╣ред  рдпрджрд┐ рдкреНрд░рдЬрд╛рддрд┐рдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╡реЗ рдЖрдмрд╛рджреА рдирд╣реАрдВ рд╣реИрдВ: <code>1 :: Natural</code> рд╢рдмреНрджреЛрдВ рдХреЗ рд╕реНрддрд░ рдкрд░ рд╕рдЪ рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕реНрддрд░ рдкрд░ рдирд╣реАрдВред  рдЗрд╕ рд╡рдЬрд╣ рд╕реЗ, рд╣рдо рдРрд╕реА рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Nat</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Natural</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Symbol</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Text</span></span></span></span></code> </pre> <br><p>  рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╣рд▓ рдЖрджрд┐рдо рдкреНрд░рдХрд╛рд░ рдХреЛ рдЙрдард╛рдирд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>Text</code> рдЗрд╕ рддрд░рд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-comment"><span class="hljs-comment">-- | A space efficient, packed, unboxed Unicode text type. data Text = Text {-# UNPACK #-} !Array -- payload (Word16 elements) {-# UNPACK #-} !Int -- offset (units of Word16, not Char) {-# UNPACK #-} !Int -- length (units of Word16, not Char) data Array = Array ByteArray# data Int = I# Int#</span></span></code> </pre> <br><p>  рдпрджрд┐ рд╣рдо <code>ByteArray#</code> рдФрд░ <code>Int#</code> рдХреЛ рдареАрдХ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдмрдврд╝рд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо <code>Symbol</code> рдмрдЬрд╛рдп <code>Text</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  <code>Natural</code> рдФрд░ рд╕рдВрднрд╡рддрдГ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ рдПрдХ рдЬреЛрдбрд╝реЗ рдХреЗ рд╕рд╛рде рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ, рдЖрдк <code>Demote</code> рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд╣реИ рдирд╛? </p><br><p>  рдХрд╛рд╢, рдРрд╕рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ред  рдЙрдкрд░реЛрдХреНрдд рдореЗрдВ, рдореИрдВрдиреЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░: рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдВрдзреЗ рдЖрдБрдЦ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ред  рдЙрдирдХреЗ рдкрд╛рд╕ рдПрдХ рд╡рд┐рд╢реЗрд╖ <code>Demote</code> рдЙрджрд╛рд╣рд░рдг рднреА рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k1</span></span></span><span class="hljs-class"> ~&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">k2</span></span></span><span class="hljs-class">) = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> k1 -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Demote</span></span></span><span class="hljs-class"> k2 </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> a ~&gt; b = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TyFun</span></span></span><span class="hljs-class"> ab -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TyFun</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span></span></code> </pre> <br><p>  <code>~&gt;</code> рдпрд╣ рдПрдХ рдкреНрд░рдХрд╛рд░ рд╣реИ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдирд┐рдЬреА-рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрд░рд┐рд╡рд╛рд░реЛрдВ рдФрд░ <a href="https://typesandkinds.wordpress.com/2013/04/01/defunctionalization-for-the-win/" rel="nofollow">рдХреНрд░рд┐рдпрд╛рд╢реАрд▓рддрд╛ рдХреЗ</a> рдЖрдзрд╛рд░ рдкрд░ рд╕рд┐рдВрдЧрд▓-рд▓реЗрд╡рд▓ рдлрд╝рдВрдХреНрд╢рди рдПрдХрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рдПрдиреНрдХреЛрдбреЗрдб рд╣реЛрддреЗ рд╣реИрдВред </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рдПрдХ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдЪрд╛рд░ рдХреА рддрд░рд╣ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ <code>~&gt;</code> рдФрд░ <code>-&gt;</code> , рдХреНрдпреЛрдВрдХрд┐ рджреЛрдиреЛрдВ рдХрд╛ рдЕрд░реНрде рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкреНрд░рдХрд╛рд░ (рдкреНрд░рдХрд╛рд░) рд╣реИред  рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ <code>-&gt;</code> рдкреНрд░рдХрд╛рд░ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдФрд░ <code>-&gt;</code> рджреГрд╢реНрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЪреАрдЬреЛрдВ рдХрд╛ рдорддрд▓рдм рд╣реИред  рд╢рдмреНрдж рд╕реНрддрд░ рдкрд░, <code>a</code> рд╕реЗ <code>b</code> рддрдХ рдХреЗ рд╕рднреА рдХрд╛рд░реНрдп <code>a -&gt; b</code> рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реИрдВред  рдЯрд╛рдЗрдк рд╕реНрддрд░ рдкрд░, рдХреЗрд╡рд▓ <code>a</code> рд╕реЗ <code>b</code> рддрдХ рдХреЗ <em>рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░</em> рдЯрд╛рдЗрдк <code>a -&gt; b</code> , рд▓реЗрдХрд┐рди рд╡реЗ рдЯрд╛рдЗрдк рдХреЗ рдкрд░реНрдпрд╛рдп рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рди рд╣реА рдЯрд╛рдЗрдк рдХреЗ рдкрд░рд┐рд╡рд╛рд░ред  рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, GHC рдорд╛рди рд▓реЗрддрд╛ рд╣реИ рдХрд┐ <code>f ~ g</code> рдФрд░ <code>a ~ b</code> рдХрд╛ рдкрд╛рд▓рди <code>fa ~ gb</code> , рдЬреЛ рдирд┐рд░реНрдорд╛рдгрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рд╣реИ, рд▓реЗрдХрд┐рди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ - рдЗрд╕реАрд▓рд┐рдП рдПрдХ рд╕реАрдорд╛ рд╣реИред </p><br><p>  рдЗрд╕рд▓рд┐рдП, рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕реНрддрд░ рддрдХ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд▓реЗрдХрд┐рди рдкреНрд░рдХрд╛рд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдирд┐рд░реНрдорд╛рдгрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдкреНрд░рдХрд╛рд░ рдкрд░ рд▓реЗ рдЬрд╛рдирд╛ рд╣реЛрдЧрд╛ред  рд╣рдо рдЗрд╕реЗ <code>a :-&gt; b</code> , рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рдЪ рд╣реЛрдЧрд╛ рдХрд┐ <code>f ~ g</code> рдФрд░ <code>a ~ b</code> follow from <code>fa ~ gb</code> ред  рдЕрдиреНрдп рдХрд╛рд░реНрдп рдЕрднреА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реЛрдВрдЧреЗ <code>a -&gt; b</code> ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>Just :: a :-&gt; Maybe a</code> , рд▓реЗрдХрд┐рди <code>Just :: a :-&gt; Maybe a</code> рд╣реА рд╕рдордп рдореЗрдВ <code>Just :: a :-&gt; Maybe a</code> <code>isJust :: Maybe a -&gt; Bool</code> ред </p><br><p>  рдЬрдм <code>Demote</code> рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЕрдВрддрд┐рдо рдХрджрдо рдЦреБрдж <code>Sing</code> рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдирдП рдХреНрд╡рд╛рдВрдЯрд┐рдлрд╛рдпрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ <code>forall</code> рдФрд░ <code>-&gt;</code> рдмреАрдЪ рдПрдХ рд╕рдВрдХрд░ рд╣реИред  рдЖрдЗрдП рдЗрд╕рд╕реНрдЯ рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">isJust</span></span> :: <span class="hljs-keyword"><span class="hljs-keyword">forall</span></span> a. <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> isJust = \x -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-type"><span class="hljs-type">Nothing</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">False</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> _ -&gt; <span class="hljs-type"><span class="hljs-type">True</span></span></code> </pre> <br><p>  <code>isJust</code> рдлрд╝рдВрдХреНрд╢рди <code>isJust</code> <code>a</code> рдФрд░ рдлрд┐рд░ рдорд╛рди <code>x :: Maybe a</code> рд╕рд╛рде рдЯрд╛рдЗрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ <code>a</code> <code>x :: Maybe a</code> ред  рдЗрди рджреЛ рдорд╛рдкрджрдВрдбреЛрдВ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЧреБрдг рд╣реИрдВ: </p><br><ul><li>  рдореБрдЦрд░рддрд╛ред  <code>isJust (Just "hello")</code> рдХреЙрд▓ рдореЗрдВ, рд╣рдо <code>x = Just "hello"</code> рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ <code>a = String</code> рд╕рдВрдХрд▓рдХ рджреНрд╡рд╛рд░рд╛ <code>isJust (Just "hello")</code> рд░реВрдк рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рд╣реЛрддрд╛ рд╣реИред  рдЖрдзреБрдирд┐рдХ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ, рд╣рдо рджреЛрдиреЛрдВ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рд░рд┐рдд рд╣реЛрдиреЗ рдХреЛ рднреА рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <code>isJust @String (Just "hello")</code> ред </li><li>  рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХрддрд╛ред  рдХреЛрдб рдореЗрдВ <code>isJust</code> рдХреЗ рдЗрдирдкреБрдЯ рдХреЗ рд▓рд┐рдП рджрд┐рдпрд╛ рдЧрдпрд╛ рдорд╛рди рднреА рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рджреМрд░рд╛рди рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: рд╣рдо <code>case</code> рд╕реЗ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреИрдЯрд░реНрди рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддреЗ рд╣реИрдВ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдпрд╣ <code>Nothing</code> рдпрд╛ <code>Just</code> ред  рдЗрд╕рд▓рд┐рдП, рдорд╛рди рдХреЛ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдкреНрд░рдХрд╛рд░ рдорд┐рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреИрдЯрд░реНрди рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ: рдлрд╝рдВрдХреНрд╢рди <code>Maybe Int</code> , <code>Maybe String</code> , <code>Maybe Bool</code> , рдЖрджрд┐ред  рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдЕрдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рд╕рдВрдкрддреНрддрд┐ рдХреЛ рдкреИрд░рд╛рдореАрдЯреНрд░рд┐рдХрд┐рдЯреА рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рдирд┐рд░реНрднрд░рддрд╛ред  <code>forall a. t</code>  <code>forall a. t</code> , рдЯрд╛рдЗрдк <code>t</code> <code>a</code> рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░ рд╕рдХрддрд╛ <code>a</code> , рдФрд░ рдЗрд╕рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкрд╛рд░рд┐рдд <code>a</code> рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ <code>a</code> ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>isJust @String</code> рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ <code>Maybe String -&gt; Bool</code> , рдФрд░ <code>isJust @Int</code> рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ <code>Maybe Int -&gt; Bool</code> ред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ <code>forall</code> рдПрдХ рдЖрд╢реНрд░рд┐рдд рдорд╛рддреНрд░рд╛рддреНрдордХ рд╣реИред  рдорд╛рди рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдЕрдВрддрд░ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ: рдЗрд╕рд╕реЗ рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рд╣рдо рдХреЙрд▓ рдХрд░рддреЗ <code>isJust Nothing</code> рдпрд╛ <code>isJust (Just тАж)</code> , рдкрд░рд┐рдгрд╛рдо рдкреНрд░рдХрд╛рд░ рд╣рдореЗрд╢рд╛ <code>Bool</code> ред  рдЗрд╕рд▓рд┐рдП, <code>-&gt;</code> рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рдХреНрд╡рд╛рдВрдЯрд┐рдлрд╛рдпрд░ рд╣реИред </li></ul><br><p>  <code>Sing</code> рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдХреНрд╡рд╛рдВрдЯрд┐рдлрд╛рдпрд░ рд╕реНрдкрд╖реНрдЯ рдФрд░ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ <code>a -&gt; b</code> , рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдкрд░ рдирд┐рд░реНрднрд░ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ <code>forall (a :: k). t</code>  <code>forall (a :: k). t</code> ред  рдЗрд╕реЗ <code>foreach (a :: k) -&gt; t</code> рд░реВрдк рдореЗрдВ рдирд┐рд░реВрдкрд┐рдд рдХрд░реЗрдВред  <code>SingI</code> рдХреЛ рдмрд╛рд╣рд░ <code>SingI</code> , рд╣рдо рдПрдХ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдЖрд╢реНрд░рд┐рдд рдХреНрд╡рд╛рдВрдЯрд┐рдлрд╛рдпрд░, <code>SingI</code> <code>foreach (a :: k). t</code> рднреА рдкреЗрд╢ рдХрд░рддреЗ рд╣реИрдВ <code>foreach (a :: k). t</code>  <code>foreach (a :: k). t</code> ред  рдирддреАрдЬрддрди, <code>singletons</code> рдХреА рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реЛрдЧреА рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рднрд╛рд╖рд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рд╛ рд╣реИред </p><br><h2 id="kratkiy-vzglyad-na-haskell-s-zavisimymi-tipami">  рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓ рдкрд░ рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдирдЬрд╝рд░ </h2><br><p>  рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░ рдФрд░ <code>lookupS</code> рдХреНрд╡рд╛рдВрдЯрд┐рдлрд╛рдпрд░ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдЙрджрдп рдХреЗ рд╕рд╛рде, рд╣рдо <code>lookupS</code> рдХреЛ рдлрд┐рд░ рд╕реЗ <code>lookupS</code> рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Z</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SN</span></span></span><span class="hljs-class"> len :: [a] -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class"> len [] = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Z</span></span></span><span class="hljs-class"> len (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_</span></span></span><span class="hljs-class">:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xs</span></span></span><span class="hljs-class">) = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">len</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xs</span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fin</span></span></span><span class="hljs-class"> n where </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FZ</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fin</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FS</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fin</span></span></span><span class="hljs-class"> n -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fin</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">) lookupS :: foreach (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xs</span></span></span><span class="hljs-class"> :: [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">]) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fin</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">len</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xs</span></span></span><span class="hljs-class">) -&gt; a lookupS [] = \case{} lookupS (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xs</span></span></span><span class="hljs-class">) = \case </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FZ</span></span></span><span class="hljs-class"> -&gt; x </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FS</span></span></span><span class="hljs-class"> i' -&gt; lookupS xs i'</span></span></code> </pre> <br><p>  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдХреЛрдб рдирд╣реАрдВ рдерд╛, рдлрд┐рд░ рднреА рдирд┐рд░рд░реНрдердХ рдХреЛрдб рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдореЗрдВ <code>singletons</code> рдмрд╣реБрдд рдЕрдЪреНрдЫреЗ рдереЗред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдирдпрд╛ рдХреЛрдб рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ: рдЕрдм <code>SingKind</code> , <code>SList</code> , <code>SNil</code> , <code>fromSing</code> , <code>fromSing</code> ред  <code>TemplateHaskell</code> рдХрд╛ рдХреЛрдИ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдм рд╣рдо <code>Len</code> рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрд░рд┐рд╡рд╛рд░ рдмрдирд╛рдиреЗ рдХреЗ рдмрдЬрд╛рдп рд╕реАрдзреЗ <code>len</code> рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдкреНрд░рджрд░реНрд╢рди рднреА рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЕрдм рдЖрдкрдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </p><br><p>  рд╣рдореЗрдВ рдЕрднреА рднреА <code>Int</code> рдмрдЬрд╛рдп рдПрдХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд <code>N</code> рдХреЛ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>len</code> рд░реВрдк рдореЗрдВ <code>length</code> рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╣реИред  рд╢рд╛рдпрдж рд╣рд╛рд╕реНрдХреЗрд▓ рдкрд░ рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдврд╛рдВрдЪреЗ рдореЗрдВ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ Agda <code>lookup</code> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдПрдХ рдЗрдВрдбрд┐рд╡рд┐рдЬреБрдЕрд▓ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд <code>N</code> рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдХреБрдЫ рдкрд╣рд▓реБрдУрдВ рдореЗрдВ, рдирд┐рд░реНрднрд░ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рд╣рд╛рд╕реНрдХреЗрд▓ рдорд╛рдирдХ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдФрд░ рднреА рд╕рд░рд▓ рд╣реИред  рдлрд┐рд░ рднреА, рдЗрд╕рдореЗрдВ рд╢рдмреНрдж, рдкреНрд░рдХрд╛рд░ рдФрд░ рдкреНрд░рдХрд╛рд░ рдХреЛ рдПрдХ рд╕рдорд╛рди, рдПрдХ рд╕рдорд╛рди рднрд╛рд╖рд╛ рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдореИрдВ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдкреНрд░рдореБрдЦ рдШрдЯрдХреЛрдВ рдХреА рд╢реБрджреНрдзрддрд╛ рдХреЛ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рд╕рд╛рдмрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рдгрд┐рдЬреНрдпрд┐рдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдЗрд╕ рд╢реИрд▓реА рдореЗрдВ рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВред  рдХрдИ рд╣рд╛рд╕реНрдХреЗрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдПрдХрд▓ рдХреА рдЬрдЯрд┐рд▓рддрд╛ рдХреЗ рдмрд┐рдирд╛ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдЗрдВрдЯрд░рдлреЗрд╕ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВред </p><br><p>  рдпрд╣ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реЛрдЧрд╛ред  рд╣рдореЗрдВ рдЬреАрдПрдЪрд╕реА рдХреЗ рд╕рднреА рдШрдЯрдХреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХрдИ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝ рд░рд╣рд╛ рд╣реИ: рдПрдХ рдкрд╛рд░реНрд╕рд░, рдирд╛рдо рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди, рдЯрд╛рдЗрдк рдЪреЗрдХрд┐рдВрдЧ рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдХреЛрд░ рднрд╛рд╖рд╛ред  рд╕рдм рдХреБрдЫ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдпрд╛ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </p><br><hr><br><h1 id="tezaurus">  рдХреЛрд╢ </h1><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>рдЕрд╡рдзрд┐</strong> <br></td><td>  <strong>рдЕрдиреБрд╡рд╛рдж</strong> <br></td><td>  <strong>рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг</strong> <br></td></tr><tr><td> correct by construction <br></td><td> ,       <br></td><td>  ,         (,   ),   . <br></td></tr><tr><td> memory unsafe <br></td><td>      <br></td><td>         ,    . <br></td></tr><tr><td> unityped <br></td><td>  <br></td><td> ,   Bob Harper     ,    .           . <br></td></tr><tr><td> boilerplate <br></td><td>   <br></td><td>       ,    -   . <br></td></tr><tr><td> generics <br></td><td>   <br></td><td>       . ,     ┬л┬╗  ┬л┬╗,     ,    &lt;&gt;  &lt;&gt;. <br></td></tr><tr><td> runtime cast <br></td><td>     <br></td><td>              . <br></td></tr><tr><td> effectful computation <br></td><td>     <br></td><td> ,          . <br></td></tr><tr><td> composable <br></td><td>  <br></td><td>  ,          . <br></td></tr><tr><td> control structures <br></td><td> ,    <br></td><td>  ,       . <br></td></tr><tr><td> proof assistant <br></td><td>    <br></td><td>       . <br></td></tr><tr><td> strict (eager) evaluation <br></td><td>  ()  <br></td><td>   ,         . <br></td></tr><tr><td> backend <br></td><td>  <br></td><td>  ,         . <br></td></tr><tr><td> singleton type <br></td><td>   <br></td><td> ,   ,       . <br></td></tr><tr><td> promoted definitions <br></td><td>   <br></td><td>    ,         . <br></td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi485174/">https://habr.com/ru/post/hi485174/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi485158/index.html">рдирд┐рдХреЛрд▓реЗ рд╡рд╛рд╡рд┐рд▓реЛрд╡ред рд╡рд╣ рд╡реНрдпрдХреНрддрд┐ рдЬреЛ рдкреВрд░реА рджреБрдирд┐рдпрд╛ рдХреЛ рдЦрд╛рдирд╛ рдЦрд┐рд▓рд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдФрд░ рдЬреЗрд▓ рдХреА рдХреЛрдард░реА рдореЗрдВ рднреБрдЦрдорд░реА рд╕реЗ рдорд░ рдЧрдпрд╛</a></li>
<li><a href="../hi485160/index.html">рдореИрдВ ACID рдореЗрдВ рдХреНрдпрд╛ рд╣реВрдВ рдпрд╛ рдПрдХ рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг</a></li>
<li><a href="../hi485162/index.html">1940 рд╕реЗ 2020 рддрдХ рдХреИрд╕реЗ рдХреЛрдб рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдИрдВ</a></li>
<li><a href="../hi485164/index.html">рд╡реИрдВрдХреВрд╡рд░ рдореЗрдВ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░ рдФрд░ рдШреГрдгрд╛: рдХреИрд╕реЗ рдПрдВрдЯреА-рдкреНрд▓рд╛рдЬрд┐рдпрд╛рд░рд┐рдЬреНрдо рдиреНрдпреВрд░реЛрдЗрдкреНрд╕-2019 рдХреА рд╕рд╡рд╛рд░реА рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi485172/index.html">рдмрдбрд╝реА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЗ рдореБрджреНрджреЗ</a></li>
<li><a href="../hi485176/index.html">рдЙрддреНрдкрд╛рдж рдкреНрд░рдмрдВрдзрди рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЛ рд╕рдордЭрд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЫрд╣ рдпреЛрдЬрдирд╛рдПрдВ</a></li>
<li><a href="../hi485178/index.html">рддрд╕реНрд╡реАрд░реЛрдВ рд╕реЗ рдЦреЛрдИ рдЗрдорд╛рд░рддреЛрдВ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рдкрджреНрдзрддрд┐</a></li>
<li><a href="../hi485180/index.html">рдХреНрдпрд╛ рд╣рдореЗрдВ рдбреЗрдЯрд╛ рд▓реЗрдХ рдХреА рдЬрд░реВрд░рдд рд╣реИ? рдбреЗрдЯрд╛ рд╡реЗрдпрд░рд╣рд╛рдЙрд╕ рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ?</a></li>
<li><a href="../hi485182/index.html">2020 рдореЗрдВ рд╕реЗрдирд╣рд╛рдЗрдЬрд╝рд░ - рд╡рд░реНрд╖рдЧрд╛рдВрда рдХреЗ рд▓рд┐рдП рд╡рд╛рдпрд░рд▓реЗрд╕ рд╣реЗрдбрдлрд╝реЛрди рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛</a></li>
<li><a href="../hi485184/index.html">рдЯреИрдмреНрдб рдкреЛрд▓ рдкрд░рд┐рдгрд╛рдо</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>