<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐆 ✔️ 🎼 配置带有rEFInd的UEFI Dual Boot系统 🐰 ✏️ ⌚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="KDPV。REFInd具有常规主题的启动管理器。
 
 迄今为止，几乎每个人都听说过UEFI技术。我不会谈论它是什么以及为什么需要它。今天，我将描述安装具有完全UEFI支持的Dual Boot系统的最简单方案，并考虑单独安装和设置rEFInd启动管理器。也许您已经看过这样的手册和指南，但是我将尽力很...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>配置带有rEFInd的UEFI Dual Boot系统</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394005/"><img src="https://habrastorage.org/files/389/a12/029/389a12029afb4dc0bc82690eca41596f.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KDPV。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REFInd</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常规</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主题的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">启动管理器</font></a><font style="vertical-align: inherit;">。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
迄今为止，几乎每个人都听说过UEFI技术。我不会谈论它是什么以及为什么需要它。今天，我将描述安装具有完全UEFI支持的Dual Boot系统的最简单方案，并考虑单独安装和设置rEFInd启动管理器。也许您已经看过这样的手册和指南，但是我将尽力很清楚地传达我们将要做的事情和原因的本质。在其他手册中，您只是看着赌徒的“魔力”，并试图重复它，常常会犯一些基本的错误。这个话题对谁来说有趣-我要猫。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常，相反地，UEFI旨在简化引导过程，而不是使其复杂化。</font><font style="vertical-align: inherit;">例如，通过此技术，计算机可以在GRUB / LILO / etc等人员的任何层进行引导，而UEFI本身可以充当加载程序。</font><font style="vertical-align: inherit;">但是，此方法有其缺点，例如，您必须修改内核更新，您当然可以编写脚本，但是从总体上来说，</font></font><code>grub2-efi</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们为我们的操作创建一个大概列表，对于其中的一些操作来说足以阅读它并开始工作。</font><font style="vertical-align: inherit;">实际上只有</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">四</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">点。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第五和第六段是可选的。</font></font></strong><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将Windows 10（8 / 8.1）的映像刻录到磁盘/闪存驱动器。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在磁盘的一部分上安装Windows 10。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将具有EFI支持的Linux分发映像（最多）刻录到磁盘/闪存驱动器。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在磁盘其余部分上安装Linux发行版。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rEFInd的安装和配置。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除GRUB并完全过渡到rEFInd。</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
乍一看，一切都很简单，只有4个基本要点，但有很多细微差别。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
错误在各个阶段都会出现：进入Legacy-bios模式，指示错误的启动分区，根本不了解自己在做什么等。</font><font style="vertical-align: inherit;">最终，所有这些都会在论坛，聊天室等中带来很多痛苦。</font><font style="vertical-align: inherit;">实际上，一切都是不现实的简单，您只需要了解每个阶段的工作并进行自我测试即可。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先一点理论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UEFI仅看到一个特殊的ESP分区，它通常具有100-200 MB的大小，并以FAT32格式（有时以FAT16格式）进行格式化，它包含名为la Boot，Microsoft，Fedora，Ubuntu等的文件夹。如果您尝试了足够多的操作系统，但从未格式化过此部分，则可能在其中键入了很多文件夹。例如，我有2个活动轴，大约有6个文件夹。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeRush</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建议所有FS（如果具有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适当的驱动程序）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">均受支持</font><font style="vertical-align: inherit;">：</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是不对的。</font><font style="vertical-align: inherit;">UEFI将查看在特定固件实施中可使用FS驱动程序的所有部分。</font><font style="vertical-align: inherit;">ESP与其他部分的不同之处仅在于：a）需要FAT驱动程序，并且b）ESP部分搜索引导加载程序，并在找到引导加载程序时自动创建适当的BootXXXX变量。</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文件夹本身包含可执行的.efi文件，它们充当操作系统加载程序。</font><font style="vertical-align: inherit;">您可能会在debian文件夹</font></font><code>grubx64.efi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和Microsoft文件夹中</font><font style="vertical-align: inherit;">找到该文件</font></font><code>bootmgr.efi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大多数Linux发行版都将ESP分区安装到</font></font><code>/boot/efi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，即Debian引导加载程序将大致以这种方式说谎：我们</font></font><code>/boot/efi/EFI/debian/grubx64.efi</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
找到了目录，然后呢？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后，您需要了解仍然存在引导顺序，可以使用该实用程序来控制该引导顺序。</font></font><code>efibootmgr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如果没有它，则可以通过包管理器下载它，它存在于所有标准存储库中。首先，您只需输入此命令并查看启动顺序列表以及所有UEFI记录。如果要使用该实用程序，则抽烟并阅读Internet，通常这很简单。 Evil Windows就在这里，并覆盖了我们的GRUB，并将Windows Boot Manager放在首位，因此必须对其进行还原。我只想说如何编辑记录：</font></font><br>
<code>efibootmgr -b &lt; &gt; -&lt; &gt; &lt; &gt;</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，</font></font><code>efibootmgr -b 0 -B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除0的记录手段</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的CodeRush</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和其他评论员注意到，efibootmgr是一个非常危险的工具，并注意多的安全使用EFI Shell。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，GRUB根本不能被触动，因为它可能位于文件夹中</font></font><code>EFI/&lt; &gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您只需要恢复录音并设置第一优先级，但是如果可以chroot并输入，为什么还要挖东西</font></font><code>grub-install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呢？</font><font style="vertical-align: inherit;">在大多数情况下，他会自己做所有事情。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一句，您不应忘记</font></font><code>efibootmgr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UEFI本身也具有</font><font style="vertical-align: inherit;">基本功能</font><font style="vertical-align: inherit;">，它可以读取这些记录并建立优先级。</font><font style="vertical-align: inherit;">但是他不知道如何浏览ESP部分并添加新条目；这些职责已分配给EFI Shell和操作系统。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeRush</font></font></a> <blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从UEFI 2.2开始，规范就要求具备这项技能（SecureBoot出现在UEFI 2.3.1C中）。</font></font></blockquote><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您的所有动作都</font></font><code>efibootmgr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记录在NVRAM中！在大多数情况下，UEFI可以在每次检查损坏的NVRAM时将其恢复，并在出现故障时将其覆盖。但是，一些不道德的制造商会生产原始固件，您可以获得真正的砖头。例如，具有基于Phoenix SCT的UEFI的笔记本电脑正在苦苦搜寻！因此，在继续阅读之前，请确保您的主板或笔记本电脑型号能够抵抗此类实验。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚苯乙烯</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写完大部分文章后，我想起了安全启动。</font><font style="vertical-align: inherit;">通常，UEFI会随身携带它，但是在大多数情况下，可以非常简单地在UEFI设置中将其关闭。</font><font style="vertical-align: inherit;">许多Linux发行版都支持它，但是我仍然建议禁用它，因为它可能导致很多问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本理论之旅结束了。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在可以练习了</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免责声明</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：我会立即说我更喜欢无菌条件，并使用我亲自测试的工具彻底重新安装自己。</font><font style="vertical-align: inherit;">如果您将使用其他实用程序，请不要写出为什么您不在某个阶段或另一阶段工作的原因。</font><font style="vertical-align: inherit;">我的版本已通过数百次重新安装给朋友和同事的测试。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们需要刻录Windows的第一件事</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因为如果您第二次安装Windows，则它将覆盖引导加载程序。恢复？没问题但是，如果您可以立即明智地做所有事情，那又何必呢？但是，我将在文章结尾稍晚讨论恢复的细微差别。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我认为，与Linux不同，Windows更容易编写。第一种方法可能为许多人所熟悉，您只需要以管理员身份进入cmd.exe并输入以下命令。不难发现，绝对没有魔术。我们只是将USB闪存驱动器格式化为FAT32：</font><font style="vertical-align: inherit;">
之后，您只需要使用存档器打开ISO文件并将内容传输到空白USB闪存驱动器。就是这样，UEFI闪存驱动器已准备就绪。在Linux上，您可以用相同的方式进行所有操作，只需将其格式化为FAT32格式并复制内容即可。</font><font style="vertical-align: inherit;">
由此产生的闪存驱动器应能完美地在任何具有UEFI支持的PC上加载。</font></font><br>
<br>
<code>diskpart<br>
list disk<br>
select disk &lt; &gt;<br>
clean<br>
create partition primary<br>
select partition 1<br>
active<br>
format fs fat32 quick<br>
assign<br>
exit</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<blockquote>,   :    Windows 10   efi,          ,     UEFI.            .</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，我更喜欢使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufus实用程序</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的第二种方法</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">他从不让我失望。</font><font style="vertical-align: inherit;">但是，这是仅Windows的方法。</font><font style="vertical-align: inherit;">在Linux系统上，使用ddresque创建可启动的Windows闪存驱动器不起作用。</font><font style="vertical-align: inherit;">因此，如果第一种采用简单格式的方法没有帮助，请尝试其他实用程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您所需要的一切：选择USB闪存驱动器，将</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“分区方案和系统接口类型”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数设置</font><font style="vertical-align: inherit;">为</font></font><strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“具有UEFI的计算机的GPT”</font></font></em></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后按开始。</font><font style="vertical-align: inherit;">其余参数无需触摸。</font><font style="vertical-align: inherit;">最好使用较小的闪存驱动器（8-16 GB）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，其中一种方法应该是顺风车，我个人在此阶段从未遇到过问题，主要是计算机支持UEFI。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，让我们进入安装阶段</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在UEFI模式下加载后，我们将按照标准方案进行所有操作，但是在选择安装类型的阶段，我们选择“专家”，也就是说，我们将自己标记该部分。我建议进行整洁的分区，尤其是在有很多磁盘的情况下。最后，选择驱动器后，删除所有现有分区。创建一个具有所需大小（例如150 GB）的分区。 （如果您希望为操作系统和文件创建两个或多个分区-没问题，请创建一个）。单击鼠标选择此部分，然后单击</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“下一步”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。如果您做对了所有事情，Windows会要求您创建其他文件。请务必回答</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“是”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。系统将创建三个分区。我们有两个满足系统需求，一个属于我们的EFI部分。我总是有第二个编号，我将得到4个分区，包括用户NTFS。如果安装程序不提供创建分区或仅创建分区的功能，那么您将引导至传统模式，并且需要重写USB闪存驱动器，则出了点问题。不幸的是，Windows安装程序分区编辑器的功能极其薄弱，因此为将来的Linux尝试对分区进行分区是没有意义的，我们只保留了这个地方。接下来，以正常模式安装所有组件。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一句，在UEFI模式下正确安装Windows的标志之一是启动时主板/笔记本电脑/平板电脑制造商的徽标出现。</font><font style="vertical-align: inherit;">在许多UEFI中（例如，来自ASUS和ASRock的），都有一个单独的设置。</font><font style="vertical-align: inherit;">因此，如果没有徽标，但其他所有内容都像发条一样，则没有任何问题。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我不建议您现在对Windows进行微调，因为如果出现问题，则可能必须重新安装它。</font></font></blockquote><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写Li​​nux吗？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是的 </font><font style="vertical-align: inherit;">登录Windows后，建议立即下载所选发行版本的映像，并</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过Rufus</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以相同的方式对其</font><strong><font style="vertical-align: inherit;">进行</font></strong><font style="vertical-align: inherit;">刻录</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">的确，在Linux发行版中，Rufus可以提出很多问题，例如，他可以要求从Internet加载syslinux引导程序或选择图像记录模式：ISO或DD。</font><font style="vertical-align: inherit;">我们以</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“是”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答所有问题</font><em><font style="vertical-align: inherit;">。</font></em><font style="vertical-align: inherit;">，即，是，下载最新版本的syslinux并以ISO模式记录。</font><font style="vertical-align: inherit;">在Ubuntu（及其Server，Mate，GNOME的变体），Fedora，RHEL7，Debian等版本上进行了测试。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">双启动实际上只有一步之遥</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与Windows不同，大多数发行版都很好地表明了UEFI模式。例如，Debian在其安装程序中以黑白显示系统正在UEFI模式下运行。其他发行版显示这是一个奇怪的grub引导程序，看起来“某种程度上是错误的”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我认为，如果您要安装Linux，那么您自己可能知道如何安装自己喜欢的发行版，因此，我将不关注安装单个发行版的详细信息。因为这个阶段非常简单。如果您确实以UEFI模式启动并按需安装Windows，那么Dual Boot几乎在您的口袋里。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，在安装Linux时您需要做的所有事情</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选择一个分区</font></font><code>/dev/sda2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（在您的情况下，可能是不同的部分），并指定安装点- </font></font><code>/boot/efi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。仅此而已。不，真的，就是这样。当然，不要忘了对</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ext4 / Btrfs / ReiserFS / XFS / JFS</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分区进行分区，将其挂载到根目录/。谁需要交换（如果需要）也可以创建它。接下来，您的发行版的安装程序将自行完成所有操作，将</font></font><code>EFI/&lt; &gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其GRUB </font><font style="vertical-align: inherit;">安装到目录中</font><font style="vertical-align: inherit;">并找到Windows（</font></font><code>EFI/microsoft</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">条目</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此逻辑已在以上所有发行版中进行了测试。</font><font style="vertical-align: inherit;">也就是说，我再次重复：主要是要向您的发行版显示您拥有这个宝贵的ESP分区的位置以及需要将引导加载程序扔给它的位置。</font><font style="vertical-align: inherit;">它不会格式化，而只是添加GRUB。</font><font style="vertical-align: inherit;">但是GRUB本身在做魔术，更改启动优先级等。</font><font style="vertical-align: inherit;">我注意到有些发行版本身会在必要时挂载此部分，因为它们会看到ESP和BOOT标志。</font><font style="vertical-align: inherit;">例如，在Debian安装程序中，您只需要创建一个用户部分即可。</font></font></blockquote><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带来美丽，设定rEFInd</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
到 </font></font><del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不幸的是</font></font></del><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幸运的是，我厌倦了一种完美主义。简单的GRUB2不适合我，它非常疼且不美观。快速浏览一下，向我介绍了GRUB的“美丽”叉子BURG，但是它被废弃了，此刻死活比活着的可能性更大。幸运的是，对于UEFI机器，还有一个很好的选择-rEFInd。 rEFInd是现已废弃的rEFIt及其逻辑延续的分支。第一个主要是为Mac创建的，并且可以在Boot Camp附近使用，当前的fork没有那么狭窄的专业知识，几乎适用于任何配置。</font></font><br>
<br>
<blockquote>  ,  rEFInd   .    Boot Manager,    .efi-  ,     UEFI       <code>/boot</code>.        ,   UEFI.  Multi-Boot    .    rEFInd  .efi-,   UEFI Shell.     <code>EFI/refind/refind_x64.efi</code></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了您可以在PC上已安装的系统之间进行选择之外，一个不错的优点是自动检测可引导闪存驱动器和磁盘。在CPDV上可以看到这一点。我有一个带有Debian的可引导USB闪存驱动器（不是安装程序，而是完整的操作系统），您可以看到一个方便的指示，它是USB闪存驱动器，而不是其他任何东西。如果您有多个核心，则可以按F2查看它们的列表。除此之外，</font></font><code>/boot/refind_linux.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以</font><font style="vertical-align: inherit;">在文件中</font><font style="vertical-align: inherit;">使用不同的内核参数指定几个选项（例如，第一个是用于加载GUI的标准选项，第二个是不带视频驱动程序的安全模式等，您可以创建多个选项，默认情况下只有三个）。也到文件夹</font></font><code>EFI/tools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以删除不同的.efi二进制文件，例如UEFI Shell或memtest86 +。</font><font style="vertical-align: inherit;">rEFInd会自动将其选中，并在底行将其显示为实用程序。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有更多屏幕截图</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/214/160/b94/214160b9441642afa9f20501502ccf8b.png"><br>
<br>
<img src="https://habrastorage.org/files/43c/028/19a/43c02819a2c0454d933a65501a11d9a9.png"><br>
<br>
<img src="https://habrastorage.org/files/487/e84/495/487e844951c845189e568a967265fa4a.png"><br>
</div></div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还想要吗</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Linux下安装过程非常简单。</font><font style="vertical-align: inherit;">所有方法均在官方网站上进行了描述，您几乎可以从任何操作系统上进行安装。</font><font style="vertical-align: inherit;">首先，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请访问此页面</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并下载.deb或.rpm软件包。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您有稀有的发行套件（例如Slackware或Gentoo），那么我个人将无法为您提供帮助，但是该站点具有常规的.zip归档文件和其他安装选项，因此，如果您使用这种发行版，则可能可以自行安装而无需问题。</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
备份EFI目录：</font></font><br>
<code>cp -r /boot/efi/EFI /boot/EFI.bkp</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下载软件包后，执行：</font></font><br>
<code>cd Downloads</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>cd </code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装软件包：</font></font><br>
<code>sudo dpkg -i &lt; &gt;.deb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>sudo dnf install &lt; &gt;.rpm</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就我而言，</font></font><code>dpkg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时我无法拉出依赖项，如果遇到同样的困难，请安装gdebi（</font></font><code>sudo apt-get install gdebi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）并执行</font></font><code>sudo gdebi &lt; &gt;.deb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您拥有RHEL或CentOS，请</font></font><code>yum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改用</font></font><code>dnf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在软件包的安装日志中，您可以跟踪安装日志rEFInd，其中可能存在错误，应立即跟踪它们。但是，以我的经验，如果一切正确，就不会有错误。您可以使用实用程序检查rEFInd安装程序的结果</font></font><code>efibootmgr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中rEFInd Boot Manager应该是第一优先级。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果已经安装了软件包，则可以使用以下命令再次安装rEFInd：使用以下命令</font></font><br>
<code>refind-install</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手动安装具有第一优先级的rEFInd：</font></font><br>
<code>refind-mkdefault</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重新启动。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一切都很可怕，我在哪里可以得到这么多操作系统？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是的，这很可怕，再见。实际上，您只有两个操作系统。 rEFInd收集了所有.efi二进制文件，并显示了具有直接下载功能的操作系统。为了纠正这种误解，我们将删除多余的部分，编写我们的配置，然后在rEFInd上放置一个漂亮的主题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，通过选择一个工作启动点进入Linux。菜单中应该有一个项目，可以不使用grubx64.efi进行加载！该部分可</font></font><code>/boot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从管理员那里更轻松地进行工作（因为该团队</font></font><code>cd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有特权，但</font></font><code>sudo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它不起作用），因此我们</font></font><code>su</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入root密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此项不是徒然可选的，因为如果您没有足够的经验，那么您很容易破坏某些内容而不会注意到它。我建议准备一个具有正常工作的LiveCD的闪存驱动器，以便在出现意外情况时进行恢复。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的首要任务是删除不必要的下载指令，它们可以很容易地分成6个部分，并且只有两个系统。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们进入目录：</font></font><br>
<code>cd /boot/efi/EFI &amp;&amp; ls</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可能会有五个文件夹：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BOOT，microsoft，&lt;您的发行版&gt;，refind和工具。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果有多余的东西，请随时删除。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法1 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（通过纯化，更危险）</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
确保通过rEFInd（！）引导并且不为此使用GRUB之后，可以安全地删除分发文件夹。</font><font style="vertical-align: inherit;">重新启动并检查是否可以启动到Linux。</font><font style="vertical-align: inherit;">如果可以的话，引导菜单中可能还剩下4个指令：Windows，Linux和两个（很可能）引导Linux的奇怪项目。</font><font style="vertical-align: inherit;">可能会猜到这些是文件夹中的.efi二进制文件</font></font><code>EFI/BOOT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该文件夹可以完全删除。</font><font style="vertical-align: inherit;">但是！</font><font style="vertical-align: inherit;">确保您有备份。</font><font style="vertical-align: inherit;">重新启动。</font><font style="vertical-align: inherit;">一切都还好吗？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
删除GRUB：</font></font><br>
<code>sudo apt-get remove grub2 grub2-efi grub grub-efi</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
或：</font></font><br>
<code>sudo dnf remove grub2</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在您可以放置​​主题。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">某些UEFI根本看不到其他目录。</font><font style="vertical-align: inherit;">因此，对于这种系统存在小的解决方法。</font><font style="vertical-align: inherit;">删除BOOT文件夹，将refind文件夹重命名为BOOT文件夹，并将bootx64.efi中的refind_x64.efi文件本身重命名。</font><font style="vertical-align: inherit;">重新启动。</font></font></blockquote><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法2 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（通过rEFInd配置更安全）</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此方法更安全，因为我们不会删除或触摸任何东西，所以我们将通过正确配置配置来获得结果。山姆的配置是在这里：</font></font><code>/boot/efi/EFI/refind/refind.conf</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要设置准则负载需要使用两个参数</font></font><code>scanfor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>menuentry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，后设置应该是这样的配置：</font><font style="vertical-align: inherit;">
当然，这仅仅是配置的一部分，而其他参数可以从例子中可以采取</font><b><font style="vertical-align: inherit;">我的第一种方法的基础上的配置，带注释</font></b><font style="vertical-align: inherit;"> 
另外，您可以阅读有关普利茅斯</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">在这里</font></a><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">包含一个漂亮的主题，</font></b><font style="vertical-align: inherit;"> 
这很简单，仅在配置的最后一行上方指向该主题的.conf文件。主题本身最好放在文件夹中</font></font><br>
<br>
<code>#    ,    <br>
scanfor manual,external,optical<br>
#    Linux<br>
menuentry Linux {<br>
 loader /EFI/ubuntu/grubx64.efi<br>
 icon /EFI/refind/icons/os_linux.png<br>
}<br>
#    Windows 10<br>
menuentry "Windows 10" {<br>
 loader \EFI\Microsoft\Boot\bootmgr.efi<br>
 icon /EFI/refind/icons/os_win.png<br>
}<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br>
<code>#     - <br>
timeout 20<br>
#   300 ,    , <br>
#       <br>
screensaver 300<br>
#  -<br>
resolution 1280 1024<br>
#     Linux.        Plymouth<br>
#     <br>
use_graphics_for linux<br>
scanfor internal,external,optical,netboot,biosexternal<br>
#  <br>
include themes/refind-theme-regular/theme.conf<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
 <br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"></font><code>/boot/efi/EFI/refind/themes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认情况下，不是通过创建的</font></font><code>mkdir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们转到themes目录，然后编写</font></font><code>git clone https://github.com/munlik/refind-theme-regular.git</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在配置注册行中，</font></font><code>include themes/refind-theme-regular/theme.conf</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其他主题</font><font style="vertical-align: inherit;">行</font><font style="vertical-align: inherit;">可以在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">办公室</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">。</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">网站</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，您可以看到详细的安装过程，用于微调配置的参数等等。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
也许就这些。</font><font style="vertical-align: inherit;">我们有一个漂亮的启动管理器，可以选择具有完全UEFI支持的正确操作系统。</font><font style="vertical-align: inherit;">安装rEFInd的项目最复杂，因此是可选的，大多数就足够了</font></font><code>grub2-efi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，我的一段短片：</font></font><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/VxY39Zfdh48" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
肯定会有大量的文字错误出现，如果您给我写关于PM的内容，我将感到高兴。</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN394005/">https://habr.com/ru/post/zh-CN394005/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN393987/index.html">军事发展：秘密巨像</a></li>
<li><a href="../zh-CN393989/index.html">HoloFlex：灵活的全息智能手机</a></li>
<li><a href="../zh-CN393997/index.html">植入式电子设备在大脑中独立溶解</a></li>
<li><a href="../zh-CN393999/index.html">春季早到北极导致非洲鸟类死亡</a></li>
<li><a href="../zh-CN394001/index.html">未经您的允许就在您的Facebook上发布您孩子的照片？监禁一年和罚款45,000欧元</a></li>
<li><a href="../zh-CN394007/index.html">互联网。现在在乡下</a></li>
<li><a href="../zh-CN394009/index.html">刘启新著作《三体问题》的翻译</a></li>
<li><a href="../zh-CN394011/index.html">现场红外测温仪测试</a></li>
<li><a href="../zh-CN394015/index.html">投影智能手表：从Ritot到Samsung的一系列高端应用程序</a></li>
<li><a href="../zh-CN394017/index.html">简单的破坏工作场所的技巧</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>