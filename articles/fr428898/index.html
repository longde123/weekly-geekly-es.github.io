<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•† üë©üèΩ‚Äçü§ù‚Äçüë©üèª üî≤ Aspects probl√©matiques de la programmation en C ++ üà∑Ô∏è üèµÔ∏è üé•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En C ++, il existe de nombreuses fonctionnalit√©s qui peuvent √™tre consid√©r√©es comme potentiellement dangereuses - avec des erreurs de calcul dans la c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aspects probl√©matiques de la programmation en C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428898/"><hr><p>  <i>En C ++, il existe de nombreuses fonctionnalit√©s qui peuvent √™tre consid√©r√©es comme potentiellement dangereuses - avec des erreurs de calcul dans la conception ou un codage inexact, elles peuvent facilement conduire √† des erreurs.</i>  <i>L'article fournit une s√©lection de ces fonctionnalit√©s, donne des conseils sur la fa√ßon de r√©duire leur impact n√©gatif.</i> <i><br></i> </p><hr><br><a name="habracut"></a><br><h1>  Table des mati√®res </h1><br><div class="spoiler">  <b class="spoiler_title">Table des mati√®res</b> <div class="spoiler_text"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1. Types</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Instructions et op√©rateurs conditionnels</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conversions implicites</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2. R√©solution du nom</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Masquage de variables dans des √©tendues imbriqu√©es</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Surcharge de fonction</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3. Constructeurs, destructeurs, initialisation, suppression</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonctions membres de classe g√©n√©r√©es par le compilateur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Variables non initialis√©es</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Proc√©dure d'initialisation pour les classes de base et les membres de classe non statiques</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Proc√©dure d'initialisation pour les membres de classe statique et les variables globales</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exceptions dans les destructeurs</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suppression d'objets et de tableaux dynamiques</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3.7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suppression lorsque la d√©claration de classe est incompl√®te</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4. Op√©rateurs, expressions</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Priorit√© de l'op√©rateur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Surcharge de l'op√©rateur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La proc√©dure de calcul des sous-expressions</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5. Fonctions virtuelles</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5.1 Remplacement des fonctions virtuelles</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5.2 Surcharge et utilisation des param√®tres par d√©faut</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5.3 Appel de fonctions virtuelles dans le constructeur et le destructeur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5.4 Destructeur virtuel</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6. Travail direct avec m√©moire</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6.1 D√©bordement du tampon</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6.2 Cha√Ænes termin√©es par Z</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6.3 Fonctions √† nombre de param√®tres variable</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7. Syntaxe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7.1 Annonces compliqu√©es</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7.2 Ambigu√Øt√© de syntaxe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8. Divers</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.1 Mot-cl√© en ligne et ODR</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.2 Fichiers d'en-t√™te</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.3 instruction switch</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.4 Passage des param√®tres par valeur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.5 Gestion des ressources</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.6 Liens propri√©taires et non propri√©taires</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.7 Compatibilit√© binaire</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8.8 Macros</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">9. R√©sum√©</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les r√©f√©rences</a> <br></p><br></div></div><br><p>  <i>Praemonitus, praemunitus.</i> <i><br></i>  <i>Averti signifie arm√©.</i>  <i>(lat.)</i> <br></p><br><a name="id-introdaction"></a><br><h1>  Pr√©sentation </h1><br><p>  En C ++, il existe de nombreuses fonctionnalit√©s qui peuvent √™tre consid√©r√©es comme potentiellement dangereuses - avec des erreurs de calcul dans la conception ou un codage inexact, elles peuvent facilement conduire √† des erreurs.  Certains d'entre eux peuvent √™tre attribu√©s √† une enfance difficile, certains √† la norme C ++ 98 obsol√®te, mais d'autres sont d√©j√† associ√©s aux fonctionnalit√©s du C ++ moderne.  Consid√©rez les principaux et essayez de donner des conseils sur la fa√ßon de r√©duire leur impact n√©gatif. </p><br><a name="id-1"></a><br><h1>  1. Types </h1><br><a name="id-1-1"></a><br><h2>  1.1.  Instructions et op√©rateurs conditionnels </h2><br><p> Le besoin de compatibilit√© avec C conduit au fait que dans l'instruction <code>if(...)</code> et similaires, vous pouvez remplacer n'importe quelle expression num√©rique ou pointeur, et pas seulement des expressions comme <code>bool</code> .  Le probl√®me est aggrav√© par la conversion implicite de <code>bool</code> en <code>int</code> dans les expressions arithm√©tiques et la priorit√© de certains op√©rateurs.  Cela conduit, par exemple, aux erreurs suivantes: </p><br><p>  <code>if(a=b)</code> quand correctement <code>if(a==b)</code> , <br>  <code>if(a&lt;x&lt;b)</code> , quand correctement <code>if(a&lt;x &amp;&amp; x&lt;b)</code> , <br>  <code>if(a&amp;x==0)</code> , quand correctement <code>if((a&amp;x)==0)</code> , <br>  <code>if(Foo)</code> quand correctement <code>if(Foo())</code> , <br>  <code>if(arr)</code> quand correctement <code>if(arr[0])</code> , <br>  <code>if(strcmp(s,r))</code> lorsqu'il est correct <code>if(strcmp(s,r)==0)</code> . </p><br><p>  Certaines de ces erreurs provoquent un avertissement du compilateur, mais pas une erreur.  Les analyseurs de code peuvent √©galement parfois aider.  En C #, de telles erreurs sont presque impossibles, l' <code>if(...)</code> et similaires n√©cessitent un type <code>bool</code> , vous ne pouvez pas m√©langer des types <code>bool</code> et num√©riques dans des expressions arithm√©tiques. </p><br><p>  Comment se battre: </p><br><ul><li>  Programme sans avertissements.  Malheureusement, cela n'aide pas toujours; certaines des erreurs d√©crites ci-dessus ne donnent pas d'avertissement. </li><li>  Utilisez des analyseurs de code statique. </li><li>  Technique de r√©ception √† l'ancienne: lors de la comparaison avec une constante, placez-la √† gauche, par exemple <code>if(MAX_PATH==x)</code> .  Il a l'air assez copropri√©t√© (et a m√™me son propre nom - "notation Yoda"), et aide dans un petit nombre de cas. </li><li>  Utilisez le qualificatif <code>const</code> aussi largement que possible.  Encore une fois, cela n'aide pas toujours. </li><li>  Prenez l'habitude d'√©crire les expressions logiques correctes: <code>if(x!=0)</code> au lieu de <code>if(x)</code> .  (Bien que vous puissiez tomber dans le pi√®ge des priorit√©s des op√©rateurs ici, consultez le troisi√®me exemple.) </li><li>  Soyez extr√™mement attentif. </li></ul><br><a name="id-1-2"></a><br><h2>  1.2.  Conversions implicites </h2><br><p>  C ++ fait r√©f√©rence √† des langages fortement typ√©s, mais les conversions de types implicites sont largement utilis√©es pour raccourcir le code.  Ces conversions implicites peuvent dans certains cas conduire √† des erreurs. </p><br><p>  Les conversions implicites les plus ennuyeuses sont les conversions d'un type num√©rique ou d'un pointeur vers <code>bool</code> et de <code>bool</code> vers <code>int</code> .  Ce sont ces transformations (n√©cessaires √† la compatibilit√© avec C) qui provoquent les probl√®mes d√©crits dans la section 1.1.  Les conversions implicites qui peuvent potentiellement entra√Æner une perte de pr√©cision des donn√©es num√©riques (r√©tr√©cissement des conversions), par exemple du <code>double</code> au <code>int</code> sont pas toujours appropri√©es non plus.  Dans de nombreux cas, le compilateur g√©n√®re un avertissement (surtout lorsqu'il peut y avoir une perte de pr√©cision des donn√©es num√©riques), mais un avertissement n'est pas une erreur.  En C #, les conversions entre types num√©riques et <code>bool</code> interdites (m√™me explicites), et les conversions qui peuvent potentiellement entra√Æner une perte de pr√©cision dans les donn√©es num√©riques sont presque toujours une erreur. </p><br><p>  Le programmeur peut ajouter d'autres conversions implicites: (1) d√©finir un constructeur avec un param√®tre sans le mot-cl√© <code>explicit</code> ;  (2) la d√©finition d'un op√©rateur de conversion de type.  Ces transformations comblent des lacunes de s√©curit√© suppl√©mentaires bas√©es sur des principes de typage solides. </p><br><p>  En C #, le nombre de conversions implicites int√©gr√©es est beaucoup plus petit; les conversions implicites personnalis√©es doivent √™tre d√©clar√©es √† l'aide du mot cl√© <code>implicit</code> . </p><br><p>  Comment se battre: </p><br><ul><li>  Programme sans avertissements. </li><li>  Faites tr√®s attention aux mod√®les d√©crits ci-dessus, ne les utilisez pas sans besoin extr√™me. </li></ul><br><a name="id-2"></a><br><h1>  2. R√©solution du nom </h1><br><a name="id-2-1"></a><br><h2>  2.1.  Masquage de variables dans des √©tendues imbriqu√©es </h2><br><p>  En C ++, la r√®gle suivante s'applique.  Soit </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   {    int x;    // ... //  ,       {        int x;        // ...    } }</span></span></code> </pre> <br><p>  Selon les r√®gles C ++, la variable <code></code> d√©clar√©e en <code></code> cache la variable <code></code> d√©clar√©e en <code></code>  La premi√®re d√©claration <code>x</code> ne doit pas n√©cessairement √™tre dans un bloc: elle peut √™tre membre d'une classe ou d'une variable globale, elle doit juste √™tre visible dans le bloc <code></code> </p><br><p>  Imaginez maintenant la situation o√π vous devez refactoriser le code suivant </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   {    int x;    // ... //  ,       {    // -         } }</span></span></code> </pre> <br><p>  Par erreur, des modifications sont apport√©es: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   {    //  , :    int x;    // -         // ...    //  :    // -      }</span></span></code> </pre> <br><p>  Et maintenant, le code ¬´quelque chose se fait avec <code></code> de <code></code> ¬ª fera quelque chose avec <code></code> de <code></code> !  Il est clair que tout ne fonctionne pas comme avant, et de trouver ce qui est souvent tr√®s difficile.  Ce n'est pas en vain qu'en C # il est interdit de cacher les variables locales (bien que les membres de la classe le puissent).  Notez que le m√©canisme de masquage des variables sous une forme ou une autre est utilis√© dans presque tous les langages de programmation. </p><br><p>  Comment se battre: </p><br><ul><li>  D√©clarez les variables dans la port√©e la plus √©troite possible. </li><li>  N'√©crivez pas de blocs longs et profond√©ment imbriqu√©s. </li><li>  Utilisez des conventions de codage pour distinguer visuellement les identifiants de port√©e diff√©rente. </li><li>  Soyez extr√™mement attentif. </li></ul><br><a name="id-2-2"></a><br><h2>  2.2.  Surcharge de fonction </h2><br><p>  La surcharge de fonctions fait partie int√©grante de nombreux langages de programmation et C ++ ne fait pas exception.  Mais cette opportunit√© doit √™tre utilis√©e avec pr√©caution, sinon vous pouvez avoir des ennuis.  Dans certains cas, par exemple, lorsque le constructeur est surcharg√©, le programmeur n'a pas le choix, mais dans d'autres cas, le refus de surcharger peut √™tre justifi√©.  Tenez compte des probl√®mes qui surviennent lors de l'utilisation de fonctions surcharg√©es. </p><br><p>  Si vous essayez de consid√©rer toutes les options possibles pouvant survenir lors de la r√©solution d'une surcharge, les r√®gles de r√©solution d'une surcharge s'av√®rent √™tre tr√®s compliqu√©es, et donc difficiles √† pr√©voir.  La complexit√© suppl√©mentaire est introduite par les fonctions de mod√®le et la surcharge des op√©rateurs int√©gr√©s.  C ++ 11 a ajout√© des probl√®mes avec les liens rvalue et les listes d'initialisation. </p><br><p>  Des probl√®mes peuvent √™tre cr√©√©s par l'algorithme de recherche pour que les candidats r√©solvent la surcharge dans les zones de visibilit√© imbriqu√©es.  Si le compilateur a trouv√© des candidats dans la port√©e actuelle, la recherche se termine.  Si les candidats trouv√©s ne sont pas appropri√©s, conflictuels, supprim√©s ou inaccessibles, une erreur est g√©n√©r√©e, mais aucune autre recherche n'est tent√©e.  Et seulement s'il n'y a aucun candidat dans la port√©e actuelle, la recherche passe √† la port√©e suivante, plus large.  Le m√©canisme de masquage du nom fonctionne, qui est presque le m√™me que celui discut√© dans la section 2.1, voir [Dewhurst]. </p><br><p>  Les fonctions de surcharge peuvent r√©duire la lisibilit√© du code, ce qui signifie provoquer des erreurs. </p><br><p>  L'utilisation de fonctions avec des param√®tres par d√©faut ressemble √† l'utilisation de fonctions surcharg√©es, bien que, bien s√ªr, il y ait moins de probl√®mes potentiels.  Mais le probl√®me de la mauvaise lisibilit√© et des erreurs possibles subsiste. </p><br><p>  Avec une extr√™me prudence, les param√®tres de surcharge et par d√©faut pour les fonctions virtuelles doivent √™tre utilis√©s, voir la section 5.2. </p><br><p>  C # prend √©galement en charge la surcharge de fonctions, mais les r√®gles de r√©solution des surcharges sont l√©g√®rement diff√©rentes. </p><br><p>  Comment se battre: </p><br><ul><li>  N'abusez pas de la surcharge de fonctions, ainsi que de la conception de fonctions avec des param√®tres par d√©faut. </li><li>  Si les fonctions sont surcharg√©es, utilisez des signatures qui ne font aucun doute lors de la r√©solution des surcharges. </li><li>  Ne d√©clarez pas les fonctions du m√™me nom dans la port√©e imbriqu√©e. </li><li>  N'oubliez pas que le m√©canisme des fonctions distantes ( <code>=delete</code> ) apparu en C ++ 11 peut √™tre utilis√© pour interdire certaines options de surcharge. </li></ul><br><a name="id-3"></a><br><h1>  3. Constructeurs, destructeurs, initialisation, suppression </h1><br><a name="id-3-1"></a><br><h2>  3.1.  Fonctions membres de classe g√©n√©r√©es par le compilateur </h2><br><p>  Si le programmeur n'a pas d√©fini les fonctions membres de la classe dans la liste suivante - le constructeur par d√©faut, le constructeur de copie, l'op√©rateur d'affectation de copie, le destructeur - le compilateur peut le faire pour lui.  C ++ 11 a ajout√© un constructeur de d√©placement et un op√©rateur d'affectation de d√©placement √† cette liste.  Ces fonctions membres sont appel√©es fonctions membres sp√©ciales.  Ils ne sont g√©n√©r√©s que s'ils sont utilis√©s et des conditions suppl√©mentaires sp√©cifiques √† chaque fonction sont remplies.  Nous attirons l'attention sur le fait que cette utilisation peut s'av√©rer assez cach√©e (par exemple lors de l'impl√©mentation de l'h√©ritage).  Si la fonction requise ne peut pas √™tre g√©n√©r√©e, une erreur est g√©n√©r√©e.  (√Ä l'exception des op√©rations de relocalisation, elles sont remplac√©es par des op√©rations de copie.) Les fonctions membres g√©n√©r√©es par le compilateur sont publiques et int√©grables.  Des d√©tails sur les fonctions sp√©ciales des membres peuvent √™tre trouv√©s dans [Meyers2]. </p><br><p>  Dans certains cas, une telle aide du compilateur peut √™tre un ¬´service baissier¬ª.  L'absence de fonctions membres sp√©ciales personnalis√©es peut conduire √† la cr√©ation d'un type trivial, ce qui, √† son tour, provoque le probl√®me des variables non initialis√©es, voir la section 3.2.  Les fonctions membres g√©n√©r√©es sont publiques, ce qui n'est pas toujours coh√©rent avec la conception des classes.  Dans les classes de base, le constructeur doit √™tre prot√©g√©; parfois, pour un contr√¥le plus fin du cycle de vie de l'objet, un destructeur prot√©g√© est n√©cessaire.  Si une classe a un descripteur de ressource brute en tant que membre et poss√®de cette ressource, le programmeur doit alors impl√©menter le constructeur de copie, l'op√©rateur d'affectation de copie et le destructeur.  La soi-disant ¬´r√®gle des trois grands¬ª est bien connue, qui stipule que si un programmeur d√©finit au moins une des trois op√©rations - constructeur de copie, op√©rateur d'affectation de copie ou destructeur - alors il doit d√©finir les trois op√©rations.  Le constructeur de d√©placement et l'op√©rateur d'affectation de d√©placement g√©n√©r√© par le compilateur sont √©galement loin de toujours ce dont vous avez besoin.  Le destructeur g√©n√©r√© par le compilateur conduit dans certains cas √† des probl√®mes tr√®s subtils, pouvant entra√Æner une fuite de ressources, voir section 3.7. </p><br><p>  Le programmeur peut interdire la g√©n√©ration de fonctions membres sp√©ciales, en C ++ 11 il est n√©cessaire d'utiliser la construction <code>"=delete"</code> lors de la d√©claration, en C ++ 98 d√©clarer la fonction membre correspondante priv√©e et non d√©finir. </p><br><p>  Si le programmeur est √† l'aise avec les fonctions membres g√©n√©r√©es par le compilateur, alors en C ++ 11, il peut l'indiquer explicitement, et pas simplement supprimer la d√©claration.  Pour ce faire, vous devez utiliser la construction <code>"=default"</code> lors de la d√©claration, tandis que le code est mieux lu et que des fonctionnalit√©s suppl√©mentaires apparaissent li√©es √† la gestion du niveau d'acc√®s. </p><br><p>  En C #, le compilateur peut g√©n√©rer un constructeur par d√©faut, cela ne pose g√©n√©ralement aucun probl√®me. </p><br><p>  Comment se battre: </p><br><ul><li>  Contr√¥lez le compilateur g√©n√©rant des fonctions membres sp√©ciales.  Si n√©cessaire, mettez-les en ≈ìuvre vous-m√™me ou interdisez-les. </li></ul><br><a name="id-3-2"></a><br><h2>  3.2.  Variables non initialis√©es </h2><br><p>  Les constructeurs et les destructeurs peuvent √™tre appel√©s √©l√©ments cl√©s du mod√®le d'objet C ++.  Lors de la cr√©ation d'un objet, le constructeur doit √™tre appel√© et lors de la suppression, le destructeur est appel√©.  Mais les probl√®mes de compatibilit√© avec C ont forc√© certaines exceptions, et cette exception est appel√©e types triviaux.  Ils sont introduits pour simuler les types sichny et le cycle de vie syshny des variables, sans l'appel obligatoire du constructeur et du destructeur.  Le code C, s'il est compil√© et ex√©cut√© en C ++, devrait fonctionner comme en C. Les types triviaux incluent les types num√©riques, les pointeurs, les √©num√©rations, ainsi que les classes, les structures, les unions et les tableaux constitu√©s de types triviaux.  Les classes et les structures doivent remplir des conditions suppl√©mentaires: absence de constructeur personnalis√©, destructeur, copie, fonctions virtuelles.  Pour une classe triviale, le compilateur peut g√©n√©rer un constructeur par d√©faut et un destructeur.  Le constructeur par d√©faut met √† z√©ro l'objet, le destructeur ne fait rien.  Mais ce constructeur ne sera g√©n√©r√© et utilis√© que s'il est explicitement appel√© lors de l'initialisation de la variable.  Une variable de type trivial ne sera pas initialis√©e si vous n'utilisez pas une variante d'initialisation explicite.  La syntaxe d'initialisation d√©pend du type et du contexte de la d√©claration de variable.  Les variables statiques et locales sont initialis√©es lorsqu'elles sont d√©clar√©es.  Pour une classe, les classes de base imm√©diates et les membres de classe non statiques sont initialis√©s dans la liste d'initialisation du constructeur.  (C ++ 11 vous permet d'initialiser des membres de classe non statiques lors de la d√©claration, voir plus loin.) Pour les objets dynamiques, l'expression <code>new T()</code> cr√©e un objet initialis√© par le constructeur par d√©faut, mais le <code>new T</code> pour les types triviaux cr√©e un objet non initialis√©.  Lors de la cr√©ation d'un tableau dynamique d'un type trivial, <code>new T[N]</code> , ses √©l√©ments seront toujours non initialis√©s.  Si une instance de <code>std::vector&lt;T&gt;</code> est cr√©√©e ou √©tendue et que les param√®tres ne sont pas fournis pour l'initialisation explicite des √©l√©ments, ils sont garantis pour appeler le constructeur par d√©faut.  C ++ 11 introduit une nouvelle syntaxe d'initialisation - utilisant des accolades.  Une paire de crochets vide signifie l'initialisation √† l'aide du constructeur par d√©faut.  Une telle initialisation est possible partout o√π l'initialisation traditionnelle est utilis√©e, en plus il est devenu possible d'initialiser des membres non statiques de la classe lors de la d√©claration, ce qui remplace l'initialisation dans la liste d'initialisation du constructeur. </p><br><p>  Une variable non initialis√©e est structur√©e comme suit: si elle est d√©finie dans la port√©e de l' <code>namespace</code> (globalement), elle aura tous les bits z√©ro, si elle est locale ou cr√©√©e dynamiquement, elle recevra un ensemble al√©atoire de bits.  Il est clair que l'utilisation d'une telle variable peut conduire √† un comportement impr√©visible du programme. </p><br><p>  Certes, la progression ne s'arr√™te pas, les compilateurs modernes, dans certains cas, d√©tectent les variables non initialis√©es et g√©n√®rent une erreur.  Les analyseurs de code non initialis√©s d√©tectent encore mieux. </p><br><p>  La biblioth√®que standard C ++ 11 poss√®de des mod√®les appel√©s propri√©t√©s de type (fichier d'en-t√™te <code>&lt;type_traits&gt;</code> ).  L'un d'eux vous permet de d√©terminer si le type est trivial.  L'expression <code>std::is_trivial&lt;&gt;::value</code> est <code>true</code> si <code>T</code> type trivial et <code>false</code> sinon. </p><br><p>  Les structures sysyliques sont aussi souvent appel√©es Plain Old Data (POD).  Nous pouvons supposer que POD et le ¬´type trivial¬ª sont des termes presque √©quivalents. </p><br><p>  En C #, les variables non initialis√©es provoquent une erreur qui est contr√¥l√©e par le compilateur.  Les champs d'objets d'un type de r√©f√©rence sont initialis√©s par d√©faut si l'initialisation explicite n'est pas effectu√©e.  Les champs d'objets d'un type significatif sont initialis√©s soit tous par d√©faut, soit tous doivent √™tre initialis√©s explicitement. </p><br><p>  Comment se battre: </p><br><ul><li>  Prenez l'habitude d'initialiser explicitement une variable.  Une variable non initialis√©e devrait "couper l'≈ìil". </li><li>  D√©clarez les variables dans la port√©e la plus √©troite possible. </li><li>  Utilisez des analyseurs de code statique. </li><li>  Ne concevez pas de types triviaux.  Pour s'assurer que le type n'est pas trivial, il suffit de d√©finir un constructeur personnalis√©. </li></ul><br><a name="id-3-3"></a><br><h2>  3.3.  Proc√©dure d'initialisation pour les classes de base et les membres de classe non statiques </h2><br><p>  Lors de l'impl√©mentation du constructeur de classe, les classes de base imm√©diates et les membres de classe non statiques sont initialis√©s.  L'ordre d'initialisation est d√©termin√© par la norme: d'abord, les classes de base dans l'ordre dans lequel elles sont d√©clar√©es dans la liste des classes de base, puis les membres non statiques de la classe dans l'ordre de d√©claration.  Si n√©cessaire, l'initialisation explicite des classes de base et des membres non statiques utilise la liste d'initialisation du constructeur.  Malheureusement, les √©l√©ments de cette liste ne doivent pas n√©cessairement √™tre dans l'ordre dans lequel l'initialisation a lieu.  Ceci doit √™tre pris en compte si, lors de l'initialisation, les √©l√©ments de liste utilisent des r√©f√©rences √† d'autres √©l√©ments de liste.  En cas d'erreur, le lien peut √™tre vers un objet qui n'a pas encore √©t√© initialis√©.  C ++ 11 vous permet d'initialiser des membres de classe non statiques lors de la d√©claration (en utilisant des accolades).  Dans ce cas, ils n'ont pas besoin d'√™tre initialis√©s dans la liste d'initialisation du constructeur et le probl√®me est partiellement supprim√©. </p><br><p>  En C #, un objet est initialis√© comme suit: d'abord les champs sont initialis√©s, du sous-objet de base √† la derni√®re d√©riv√©e, puis les constructeurs sont appel√©s dans le m√™me ordre.  Le probl√®me d√©crit ne se produit pas. </p><br><p>  Comment se battre: </p><br><ul><li>  Conservez la liste d'initialisation du constructeur dans l'ordre de d√©claration. </li><li>  Essayez de rendre l'initialisation des classes de base et des membres de classe ind√©pendants. </li><li>  Utilisez l'initialisation des membres non statiques lors de la d√©claration. </li></ul><br><a name="id-3-4"></a><br><h2>  3.4.  Proc√©dure d'initialisation pour les membres de classe statique et les variables globales </h2><br><p>  Les membres de classe statiques, ainsi que les variables d√©finies dans l' <code>namespace</code> port√©e (globalement) dans diff√©rentes unit√©s de compilation (fichiers), sont initialis√©s dans l'ordre d√©termin√© par l'impl√©mentation.  Ceci doit √™tre pris en compte si, lors de l'initialisation, ces variables utilisent des r√©f√©rences les unes aux autres.  Le lien peut √™tre vers une variable non initialis√©e. </p><br><p>  Comment se battre: </p><br><ul><li>  Prenez des mesures sp√©ciales pour √©viter cette situation.  Par exemple, utilisez des variables statiques locales (singleton), elles sont initialis√©es √† la premi√®re utilisation. </li></ul><br><a name="id-3-5"></a><br><h2>  3.5.  Exceptions dans les destructeurs </h2><br><p>  Le destructeur ne doit pas lever d'exceptions.  Si vous enfreignez cette r√®gle, vous pouvez obtenir un comportement ind√©fini, le plus souvent une r√©siliation anormale. </p><br><p>  Comment se battre: </p><br><ul><li>  √âvitez de lancer des exceptions dans le destructeur. </li></ul><br><a name="id-3-6"></a><br><h2>  3.6.  Suppression d'objets et de tableaux dynamiques </h2><br><p>  Si un objet dynamique d'un type <code>T</code> </p><br><pre> <code class="cpp hljs">T* pt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> T(<span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>);</code> </pre> <br><p>  puis il est supprim√© avec l'op√©rateur de <code>delete</code> </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> pt;</code> </pre> <br><p>  Si un tableau dynamique est cr√©√© </p><br><pre> <code class="cpp hljs">T* pt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> T[N];</code> </pre> <br><p>  puis il est supprim√© avec l'op√©rateur <code>delete[]</code> </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>[] pt;</code> </pre> <br><p>  Si vous ne respectez pas cette r√®gle, vous pouvez obtenir un comportement ind√©fini, c'est-√†-dire que tout peut arriver: une fuite de m√©moire, un crash, etc.  Voir [Meyers1] pour plus de d√©tails. </p><br><p>  Comment se battre: </p><br><ul><li>  Utilisez le bon formulaire de <code>delete</code> . </li></ul><br><a name="id-3-7"></a><br><h2>  3.7.  Suppression lorsque la d√©claration de classe est incompl√®te </h2><br><p>  Le caract√®re omnivore de l'op√©rateur de <code>delete</code> peut cr√©er certains probl√®mes; il peut √™tre appliqu√© √† un pointeur de type <code>void*</code> ou √† un pointeur sur une classe qui a une d√©claration incompl√®te (pr√©emptive).  L'op√©rateur de <code>delete</code> appliqu√© √† un pointeur sur une classe est une op√©ration en deux phases; d'abord, le destructeur est appel√©, puis la m√©moire est lib√©r√©e.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si l'op√©rateur est appliqu√© </font></font><code>delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† un pointeur sur une classe avec une d√©claration incompl√®te, aucune erreur ne se produit, le compilateur ignore simplement l'appel au destructeur (bien qu'un avertissement soit √©mis).</font></font> Prenons un exemple: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">//   X* CreateX(); void Foo() {    X* p = CreateX();    delete p; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce code compile m√™me si la </font></font><code>delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©claration de classe compl√®te n'est pas disponible </font><font style="vertical-align: inherit;">au cadran-pair </font></font><code>X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Visual Studio affiche l'avertissement suivant:</font></font><br><p> <code>warning C4150: deletion of pointer to incomplete type 'X'; no destructor called</code> <br> </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'il existe une impl√©mentation </font></font><code>X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et que </font></font><code>CreateX()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le code est compil√©, s'il </font></font><code>CreateX()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">renvoie un pointeur vers un objet cr√©√© par l'op√©rateur </font></font><code>new</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors l'appel est </font></font><code>Foo()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ex√©cut√© avec succ√®s, le destructeur n'est pas appel√©. </font><font style="vertical-align: inherit;">Il est clair que cela peut conduire √† un √©puisement des ressources, donc encore une fois sur la n√©cessit√© de traiter soigneusement les avertissements.</font></font></p><br><p>    ,           -.      ,  .       ,      ,   ,   ,   .        [Meyers2]. </p><br><p>  : </p><br><ul><li>   . </li><li>            . </li><li>     . </li></ul><br><a name="id-4"></a><br><h1> 4. ,  </h1><br><a name="id-4-1"></a><br><h2>  4.1.   </h2><br><p>   ++ ,     .      .       .   ,    1.1. </p><br><p>  Voici un exemple: </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::out&lt;&lt;c?x:y;</code> </pre> <br><p>        </p><br><pre> <code class="cpp hljs">(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::out&lt;&lt;c)?x:y;</code> </pre> <br><p>   </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::out&lt;&lt;(c?x:y);</code> </pre> <br><p> ,  ,  . </p><br><p>         .            <code>&lt;&lt;</code>      <code>?:</code>      <code>std::out</code>  <code>void*</code> .  ++            ,     . -,          ,    .    <code>?:</code>      .       ,     (  ). </p><br><p>   :  <code>x&amp;f==0</code>    <code>x&amp;(f==0)</code> ,   <code>(x&amp;f)==0</code> , ,  ,  .     -  , ,     ,         ,   . </p><br><p>  . /          .  /    ,  /,    . ,     <code>x/4+1</code>  <code>x&gt;&gt;2+1</code> ,   <code>x&gt;&gt;(2+1)</code> ,   <code>(x&gt;&gt;2)+1</code> ,  . </p><br><p> C#      ,   C++,      ,    -      . </p><br><p>  : </p><br><ul><li>   ,     . , ,    . </li></ul><br><a name="id-4-2"></a><br><h2>  4.2.   </h2><br><p> ++     ,      .        .        ,          , .  4.1.    ‚Äî    <code>+</code>  <code>+=</code>   .     . ,   : <code>,</code> (), <code>&amp;&amp;</code> , <code>||</code>  .   ,         (-),            (short-circuit evaluation semantics),        ,        .      &amp; ( ).     &amp;    , ..       . </p><br><p>        ,  -    (-) ,  .      . </p><br><p>  -  ,    ,    .  . [Dewhurst]. </p><br><p> C#    ,     , ,   . </p><br><p>  : </p><br><ul><li>    . </li><li>       . </li></ul><br><a name="id-4-3"></a><br><h2>  4.3.    </h2><br><p>   ++           ,         . (   : <code>,</code> (), <code>&amp;&amp;</code> , <code>||</code> , <code>?:</code> .)     ,  ,   ,    .    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y=(++x*<span class="hljs-number"><span class="hljs-number">2</span></span>)+(++x*<span class="hljs-number"><span class="hljs-number">3</span></span>);</code> </pre> <br><p>  <code>y</code>     . </p><br><p>      ,        .  . </p><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Y</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;X&gt;, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;Y&gt;)</span></span></span></span>;</code> </pre> <br><p>  <code>Foo()</code>   : </p><br><pre> <code class="cpp hljs">Foo(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;X&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> X()), <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;Y&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Y()));</code> </pre> <br><p>     :  <code>X</code> ,  <code>Y</code> ,  <code>std::shared_ptr&lt;X&gt;</code> ,  <code>std::shared_ptr&lt;Y&gt;</code> .   <code>Y</code>  ,   <code>X</code>   . </p><br><p>     : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> p1 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;X&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> X()); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> p2 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;Y&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Y()); Foo(p1, p2);</code> </pre> <br><p>     <code>std::make_shared&lt;Y&gt;</code> (    ,     ): </p><br><pre> <code class="cpp hljs">Foo(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;X&gt;(), <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;Y&gt;());</code> </pre> <br><p>  . [Meyers2]. </p><br><p>  : </p><br><ul><li>    . </li></ul><br><a name="id-5"></a><br><h1> 5.   </h1><br><a name="id-5-1"></a><br><h2>  5.1.    </h2><br><p>  ++98  ,           ( ), ,     (     ,    ).      <code>virtual</code> ,   ,    .   ( ),   ,   ,     . ,     ,  .  ,  ++11    <code>override</code> ,    ,    ,       .          . </p><br><p>  : </p><br><ul><li>    <code>override</code> . </li><li>    .    ,         . </li></ul><br><a name="id-5-2"></a><br><h2>  5.2.       </h2><br><p>            .   ,              ,     .               .    . [Dewhurst]. </p><br><p>  : </p><br><ul><li>           . </li></ul><br><a name="id-5-3"></a><br><h2>  5.3.        </h2><br><p> ,     ,          . , ,     post_construct  pre_destroy. ,      ‚Äî         .    .   ,        :     ( )   . (, ,      .)     ,           ( ),    ( ).  . [Dewhurst]. ,         ,  . </p><br><p>       ‚Äî  -         . </p><br><p> ,   C#  ,     ,   ,     .  C#    :   ,      ,       .  ,           ( ,    ). </p><br><p>  : </p><br><ul><li>        ,     ,   . </li></ul><br><a name="id-5-4"></a><br><h2>  5.4.   </h2><br><p>     ,        ,           <code>delete</code>     .          , -    . </p><br><p>  : </p><br><ul><li>     . </li></ul><br><a name="id-6"></a><br><h1> 6.     </h1><br><p>        ‚Äî      C/C++,        .           .        .     ¬´  ¬ª. </p><br><p>  C#        unsafe mode,    . </p><br><a name="id-6-1"></a><br><h2>  6.1.     </h2><br><p>    /++  ,        : <code>strcpy()</code> , <code>strcat()</code> , <code>sprinf()</code> , etc.    ( <code>std::vector&lt;&gt;</code> , etc.)         ,    . (,         ,         ,     . . <strong>Checked Iterators</strong>  MSDN.)      ,      :   ,      ,     ;     ,      . </p><br><p>  C#,   unsafe mode,      . </p><br><p>  : </p><br><ul><li>    , . </li><li>     . </li><li>   z-terminated   ,    <code>_s</code> (.   ). </li></ul><br><a name="id-6-2"></a><br><h2>  6.2. Z-terminated  </h2><br><p>       ,  .    ,  : </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">strncpy</span></span>(dst,src,n);</code> </pre> <br><p>  <code>strlen(src)&gt;=n</code> ,  <code>dst</code>     (,      ).      ,       , .  .       ‚Äî       .   <code>if(*str)</code> ,  <code>if(strlen(str)&gt;0)</code> ,           .         [Spolsky]. </p><br><p>  C#  <code>string</code>      . </p><br><p>  : </p><br><ul><li>    . </li><li>     z-terminated   ,    <code>_s</code> (.   ). </li></ul><br><a name="id-6-3"></a><br><h2>  6.3.      </h2><br><p>    <code>...</code>    .      <code>printf</code> - ,     C.          , ,  ,     ,      .         ,       . </p><br><p>  C#    <code>printf</code> ,     . </p><br><p>  : </p><br><ul><li>     . ,  <code>printf</code> -    /. </li><li>   . </li></ul><br><a name="id-7"></a><br><h1> 7.  </h1><br><a name="id-7-1"></a><br><h2>  7.1.   </h2><br><p>  ++     , ,   ,        .  Voici un exemple: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = <span class="hljs-number"><span class="hljs-number">4</span></span>, M = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x,                <span class="hljs-comment"><span class="hljs-comment">// 1    *px,              // 2    ax[N],            // 3    *apx[N],          // 4    F(char),          // 5    *G(char),          // 6    (*pF)(char),      // 7    (*apF[N])(char),  // 8    (*pax)[N],        // 9    (*apax[M])[N],    // 10    (*H(char))(long);  // 11</span></span></code> </pre> <br><p>        : </p><br><ol><li>   <code>int</code> ; </li><li>   <code>int</code> ; </li><li>   <code>N</code>   <code>int</code> ; </li><li>   <code>N</code>     <code>int</code> ; </li><li> ,  <code>char</code>   <code>int</code> ; </li><li> ,  <code>char</code>     <code>int</code> ; </li><li>   ,  <code>char</code>   <code>int</code> ; </li><li>   <code>N</code>     ,  <code>char</code>   <code>int</code> ; </li><li>     <code>N</code>   <code>int</code> ; </li><li>   <code>M</code>       <code>N</code>   <code>int</code> ; </li><li> ,  <code>char</code>     ,  <code>long</code>   <code>int</code> . </li></ol><br><p> ,             . (     .) </p><br><p>     <code>*</code>    <code>&amp;</code>     . (    .) </p><br><p>        <code>typedef</code> ( <code>using</code> -). ,       : </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*P)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; PH(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>);</code> </pre> <br><p>      ,     . </p><br><p>  C#    ,    . </p><br><p>  : </p><br><ul><li>   . </li></ul><br><a name="id-7-2"></a><br><h2>  7.2.   </h2><br><p>           .     </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    X(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> val = <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ... };</span></span></code> </pre> <br><p>     </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">X </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;</code> </pre> <br><p>    <code>x</code>  <code>X</code> ,   5.    </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">X </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>;</code> </pre> <br><p>    <code>x</code> ,    <code>X</code>    ,     <code>x</code>  <code>X</code> ,    .     <code>X</code> ,    ,     : </p><br><pre> <code class="cpp hljs">X x; X x = X(); X x{};    <span class="hljs-comment"><span class="hljs-comment">//   C++11</span></span></code> </pre> <br><p>   ,    ,          ,   .         [Sutter]. </p><br><p>  ,  ,   C++     (      ).         . (    C++  .) </p><br><p>  , ,      ,       ,         . </p><br><p>  C#   ,         ,      . </p><br><p>  : </p><br><ul><li>    . </li></ul><br><a name="id-8"></a><br><h1> 8.  </h1><br><a name="id-8-1"></a><br><h2>  8.1.   <code>inline</code>  ODR </h2><br><p>   ,    <code>inline</code> ‚Äî             .  ,     .   <code>inline</code>          (One Defenition Rule, ODR).  .            ,   .          ,  ODR.       <code>static</code> :    ,       ,   .   <code>static</code>  <code>inline</code> .      ,        ,  ODR,     . ,       .   - ,          -.         . </p><br><p>  : </p><br><ul><li>  ¬´¬ª <code>inline</code> .          <code>namespace</code> .      ,     . </li><li>        ‚Äî  <code>namespace</code> . </li></ul><br><a name="id-8-2"></a><br><h2>  8.2.   </h2><br><p>        .        .    ,    ,     ,   ,      . </p><br><p>  : </p><br><ul><li>     ,     . </li><li>  ,     :  () ,    -. </li><li>            <code>using</code> -: <code>using namespace <i></i></code> ,   <code>using</code> -. </li><li>           . </li></ul><br><a name="id-8-3"></a><br><h2>  8.3.  <code>switch</code> <br></h2><br><p>   ‚Äî  <code>break</code>    <code>case</code> . (  .)  C#     . </p><br><p>  : </p><br><ul><li>   . </li></ul><br><a name="id-8-4"></a><br><h2> 8.4.     </h2><br><p>  ++    ,      ‚Äî     , ‚Äî       .    (  <code>class</code>  <code>struct</code> )    ,         . (      ,      #  Java.)    ‚Äî   ,     . </p><br><ol><li>      ,   .           (  <code>std::string</code> , <code>std::vector</code> , etc.),    ,           . </li><li>    ,        ,     . </li><li>          ,      (slicing),      ,       . </li></ol><br><p>     ,      ,  ,     .      . ,       ,         . ,          .           .    ‚Äî     ( <code>=delete</code> ),   ‚Äî     <code>explicit</code> . </p><br><p>  C#      ,           . </p><br><p>  : </p><br><ul><li>   ,     . </li><li>       . </li></ul><br><a name="id-8-5"></a><br><h2>  8.5.  Gestion des ressources </h2><br><p>  ++         .     ,     . -       (    ),   ++11   ,        ,   ,           . </p><br><p>      C++   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </p><br><p>  C#   ,       .        ,     .        (using-)      Basic Dispose. </p><br><p>  : </p><br><ul><li>  -       . </li></ul><br><a name="id-8-6"></a><br><h2> 8.6.     </h2><br><p>     ¬´¬ª     .     ,  , C++ , STL-   - . </p><br><p>       .         .     ,        .      .        ¬´¬ª,      .          COM-      . (,    .)      ,    C++   .      ‚Äî      .        .            .  ,      (¬´¬ª     )    ,      .        . </p><br><p>  #    ,     .     ‚Äî    . </p><br><p>  : </p><br><ul><li>   . </li><li>        . </li></ul><br><a name="id-8-7"></a><br><h2> 8.7.   </h2><br><p>  C++      ,     :   ,    ,   . (     !)      .        ,      .     ,   .     ,   ,     . (,           .) </p><br><p>      C (    ),   C++       C  (   <code>extern "C"</code> ).      C/C++ . </p><br><p>          -.   <code>#pragma</code> -    ,    ,   . </p><br><p>        , ,    ,    . </p><br><p>     , ,    COM. COM-,    ,   (     ,      ).  COM     ,   ,     . </p><br><p>  C#     . ,   ‚Äî    ,      C#,    C#  C/C++. </p><br><p>  : </p><br><ul><li>        . </li></ul><br><a name="id-8-8"></a><br><h2> 8.8.  </h2><br><p>        ,         .    ,       .  C++    .  Au lieu de cela </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> XXL 32</span></span></code> </pre> <br><p>   </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> XXL=<span class="hljs-number"><span class="hljs-number">32</span></span>;</code> </pre> <br><p>   .       <code>inline</code>   . </p><br><p>  #   (   ). </p><br><p>  : </p><br><ul><li>       . </li></ul><br><a name="id-conclusion"></a><br><h1> 9.  </h1><br><ol><li>      .       .   .      ,       . </li><li>    . </li><li>    .   ++      ‚Äî ++11/14/17. </li><li>   - ,  -   . </li><li>        . </li></ol><br><a name="id-refs"></a><br><h1>  Les r√©f√©rences </h1><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><p> [Dewhurst] <br> ,  .   C++.         .: .  de l'anglais ‚Äî .:  , 2012. </p><br><p> [Meyers1] <br> , .   C++. 55        .: .  de l'anglais ‚Äî .:  , 2014. </p><br><p> [Meyers2] <br> , .    C++: 42    C++11  C++14.: .  de l'anglais ‚Äî .:  ¬´.. ¬ª, 2016. </p><br><p> [Sutter] <br> , .     C++.: .  de l'anglais ‚Äî :  ¬´.. ¬ª, 2015. </p><br><p> [Spolsky] <br> , .   .: .  de l'anglais ‚Äî .: -, 2008. </p><br></div></div><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428898/">https://habr.com/ru/post/fr428898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428888/index.html">qml: puissance et simplicit√©</a></li>
<li><a href="../fr428890/index.html">Toute la v√©rit√© sur RTOS. Article # 18. Groupes d'indicateurs d'√©v√©nements: services d'assistance et structures de donn√©es</a></li>
<li><a href="../fr428892/index.html">Comment cr√©er un jeu AI: un guide pour les d√©butants</a></li>
<li><a href="../fr428894/index.html">TVA sur les achats nationaux</a></li>
<li><a href="../fr428896/index.html">R√©seaux de neurones de censure Hentai</a></li>
<li><a href="../fr428900/index.html">Des robots √† roues commencent √† livrer des marchandises aux r√©sidents des √âtats-Unis et de la Grande-Bretagne</a></li>
<li><a href="../fr428902/index.html">Balises sans fil NFC</a></li>
<li><a href="../fr428904/index.html">Fintech Digest: Central Bank Robotics, Ethereum 2.0, Cryptocurrency Control by Rosfinmonitoring and Trends in Fintech</a></li>
<li><a href="../fr428906/index.html">Cr√©ation de jeux de puzzle sur Puzzle Script</a></li>
<li><a href="../fr428908/index.html">Frostpunk: d√©montage de la m√©canique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>