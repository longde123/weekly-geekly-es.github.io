<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšˆ ğŸ‘° ğŸ“ˆ GHIDRAçš„ç°ä»£åŒ–ã€‚ æœ—å§†Sega Mega Driveè£…è½½æœº ğŸˆ¹ ğŸŠ ğŸ¤¦ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="äº²çˆ±çš„é—®å€™ã€‚ æˆ‘è¿˜æ²¡æœ‰å¬è¯´è¿‡å°šæœªå¼€æ”¾æºä»£ç çš„GHIDRA ï¼Œå¯èƒ½åªæ˜¯è‹å“‘/ç›²ç›®/æ„šè ¢/æ²¡æœ‰äº’è”ç½‘çš„é€†å‘å·¥ç¨‹å¸ˆã€‚ å…¶å¼€ç®±å³ç”¨çš„åŠŸèƒ½ä»¤äººæƒŠå¹ï¼šæ‰€æœ‰æ”¯æŒçš„å¤„ç†å™¨çš„åç¼–è¯‘å™¨ï¼Œæ–°æ¶æ„çš„ç®€å•æ·»åŠ ï¼ˆç”±äºå°†å¼ºå¤§çš„åŠŸèƒ½è½¬æ¢ä¸ºIRå¯ä»¥ç«‹å³è¿›è¡Œä¸»åŠ¨åç¼–è¯‘ï¼‰ï¼Œä¸€å †ç®€åŒ–ç”Ÿæ´»çš„è„šæœ¬ï¼Œ Undo / Redoçš„å¯èƒ½æ€§...è€Œè¿™åª...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GHIDRAçš„ç°ä»£åŒ–ã€‚ æœ—å§†Sega Mega Driveè£…è½½æœº</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444562/"><p><img src="https://habrastorage.org/webt/_v/rj/sh/_vrjshbx1kl_9rudbdgaly0wd8c.png"></p><br><p>äº²çˆ±çš„é—®å€™ã€‚ æˆ‘è¿˜æ²¡æœ‰å¬è¯´è¿‡å°šæœªå¼€æ”¾æºä»£ç çš„<code>GHIDRA</code> ï¼Œå¯èƒ½åªæ˜¯è‹å“‘/ç›²ç›®/æ„šè ¢/æ²¡æœ‰äº’è”ç½‘çš„é€†å‘å·¥ç¨‹å¸ˆã€‚ å…¶å¼€ç®±å³ç”¨çš„åŠŸèƒ½ä»¤äººæƒŠå¹ï¼šæ‰€æœ‰æ”¯æŒçš„å¤„ç†å™¨çš„åç¼–è¯‘å™¨ï¼Œæ–°æ¶æ„çš„ç®€å•æ·»åŠ ï¼ˆç”±äºå°†å¼ºå¤§çš„åŠŸèƒ½è½¬æ¢ä¸ºIRå¯ä»¥ç«‹å³è¿›è¡Œä¸»åŠ¨åç¼–è¯‘ï¼‰ï¼Œä¸€å †ç®€åŒ–ç”Ÿæ´»çš„è„šæœ¬ï¼Œ <code>Undo</code> / <code>Redo</code>çš„å¯èƒ½æ€§...è€Œè¿™åªæ˜¯æ‰€æä¾›æ‰€æœ‰åŠŸèƒ½çš„å¾ˆå°ä¸€éƒ¨åˆ†ã€‚ è¦è¯´ç»™æˆ‘ç•™ä¸‹æ·±åˆ»çš„å°è±¡æ˜¯ä»€ä¹ˆä¹Ÿæ²¡è¯´ã€‚ <a name="habracut"></a></p><br><p> å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³å‘Šè¯‰æ‚¨æˆ‘å¦‚ä½•ä¸º<code>GHIDRA</code>ç¼–å†™æˆ‘çš„ç¬¬ä¸€ä¸ªæ¨¡å—-ç”¨äº<code>Sega Mega Drive / Genesis</code>æ¸¸æˆçš„æœ—å§†é…’è£…è½½<code>Sega Mega Drive / Genesis</code> ã€‚ è¦å†™å®ƒï¼Œæˆ‘åªéœ€è¦å‡ ä¸ªå°æ—¶ï¼ èµ°å§ </p><br><div class="spoiler">  <b class="spoiler_title">ä½†æ˜¯IDAå‘¢ï¼Ÿ</b> <div class="spoiler_text"><p> æˆ‘èŠ±äº†å‡ å¤©çš„æ—¶é—´æ¥äº†è§£ä¸º<code>IDA</code>ç¼–å†™ä¸‹è½½ç¨‹åºçš„è¿‡ç¨‹ã€‚ å½“æ—¶å¥½åƒæ˜¯<code>6.5</code>ç‰ˆï¼Œä½†æ˜¯åœ¨é‚£äº›æ—¥å­é‡Œï¼ŒSDKæ–‡æ¡£æœ‰å¾ˆå¤šé—®é¢˜ã€‚ </p></div></div><br><h2 id="podgotavlivaem-sredu-razrabotki"> æˆ‘ä»¬å‡†å¤‡å¼€å‘ç¯å¢ƒ </h2><br><p>  <code>GHIDRA</code>å¼€å‘äººå‘˜å‡ ä¹è€ƒè™‘äº†æ‰€æœ‰é—®é¢˜ï¼ˆ <em>Ilfak</em> ï¼Œæ‚¨å»è¿‡å“ªé‡Œï¼Ÿï¼‰ã€‚ å¹¶ä¸”ï¼Œåªæ˜¯ä¸ºäº†ç®€åŒ–æ–°åŠŸèƒ½çš„å®ç°ï¼Œä»–ä»¬å¼€å‘äº†<code>Eclipse</code>æ’ä»¶<code>GhidraDev</code> ï¼Œå®é™…ä¸Šå¯ä»¥â€œ <em>å¸®åŠ©</em> â€ç¼–å†™ä»£ç ã€‚ è¯¥æ’ä»¶å·²é›†æˆåˆ°å¼€å‘ç¯å¢ƒä¸­ï¼Œæ‚¨åªéœ€å•å‡»å‡ ä¸‹å³å¯åˆ›å»ºè„šæœ¬ï¼Œè£…è½½ç¨‹åºï¼Œå¤„ç†å™¨æ¨¡å—åŠå…¶æ‰©å±•çš„é¡¹ç›®æ¨¡æ¿ä»¥åŠå¯¼å‡ºæ¨¡å—ï¼ˆæ®æˆ‘æ‰€çŸ¥ï¼Œè¿™æ˜¯ä»é¡¹ç›®ä¸­å¯¼å‡ºæŸç§æ•°æ®ï¼‰ã€‚ </p><br><p> ä¸ºäº†å®‰è£…æ’ä»¶ï¼Œè¯·ä¸‹è½½<code>Eclipse</code> for <code>Java</code> ï¼Œå•å‡»â€œ <code>Help</code> -&gt;â€œ <code>Install New Software...</code> ï¼Œç„¶åå•å‡»â€œ <code>Add</code>æŒ‰é’®ï¼Œç„¶åä½¿ç”¨â€œ <code>Archive...</code>æŒ‰é’®æ‰“å¼€å¸¦æœ‰æ’ä»¶çš„å­˜æ¡£é€‰æ‹©å¯¹è¯æ¡†ã€‚ åŒ…å«<code>GhidraDev</code>çš„å½’æ¡£æ–‡ä»¶ä½äº<code>$(GHIDRA)/Extensions/Eclipse/GhidraDev</code> ã€‚ é€‰æ‹©å®ƒï¼Œå•å‡»<code>Add</code>æŒ‰é’®ã€‚ </p><br><p><img src="https://habrastorage.org/webt/iq/ox/e3/iqoxe3k8b5www3rqb6i0cy_xadg.png"></p><br><p> åœ¨å‡ºç°çš„åˆ—è¡¨ä¸­ï¼Œåœ¨<code>Ghidra</code>ä¸Šæ”¾ä¸€ä¸ªdawï¼Œå•å‡»<code>Next &gt;</code> ï¼ŒåŒæ„åè®®ï¼Œå•å‡»<code>Install Anyway</code> ï¼ˆå› ä¸ºè¯¥æ’ä»¶æ²¡æœ‰ç­¾åï¼‰ï¼Œç„¶åé‡æ–°å¯åŠ¨<code>Eclipse</code> ã€‚ </p><br><p><img src="https://habrastorage.org/webt/h_/5h/_a/h_5h_auzh5po7rvzaaywyvzxz9o.png"></p><br><p> æ€»çš„æ¥è¯´ï¼Œæ–°çš„<code>GhidraDev</code>é¡¹å°†å‡ºç°åœ¨IDE <code>GhidraDev</code>ä»¥æ–¹ä¾¿åˆ›å»ºå’Œåˆ†å‘é¡¹ç›®ï¼ˆå½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡å¸¸è§„å‘å¯¼ä¸ºæ–°çš„<code>Eclipse</code>é¡¹ç›®åˆ›å»ºï¼‰ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰æœºä¼šè°ƒè¯•å¼€å‘çš„æ’ä»¶æˆ–è„šæœ¬ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ka/3m/tg/ka3mtgmipvkbbmib3bilgamwe44.png"></p><br><div class="spoiler">  <b class="spoiler_title">åº”ç”¨ç¨‹åºè°ƒè¯•å™¨åœ¨å“ªé‡Œï¼Ÿ</b> <div class="spoiler_text"><p>  <code>GHIDRA</code>çœŸæ­£æƒ¹æ¼äº†è¿™ç§æƒ…å†µï¼Œ <code>GHIDRA</code>å°±æ˜¯ä»–å¦ˆçš„æ²™å“‘çš„ç‚’ä½œåŒ…å«å‡ ä¹ç›¸åŒçš„ææ–™ï¼Œè€Œä¸”äº‹å®å¹¶éå¦‚æ­¤ã€‚ ä¸€ä¸ªä¾‹å­ï¼Ÿ æ˜¯çš„ï¼Œè¯·ï¼š </p><br><blockquote> è¯¥å·¥å…·çš„å½“å‰ç‰ˆæœ¬æ˜¯9.0ã€‚ è¯¥å·¥å…·å…·æœ‰ä¸€äº›é€‰é¡¹ï¼Œå¯ä»¥åŒ…æ‹¬å…¶ä»–åŠŸèƒ½ï¼Œä¾‹å¦‚å¯†ç åˆ†æï¼Œä¸Ghidraè°ƒè¯•å™¨OllyDbgçš„äº¤äº’ã€‚ </blockquote><p> è¿™æ˜¯å“ªé‡Œï¼Ÿ ä¸è¡Œ </p><br><p> ç¬¬äºŒç‚¹ï¼šå¼€æ”¾æ€§ã€‚ å®é™…ä¸Šï¼Œå®ƒå‡ ä¹å­˜åœ¨ï¼Œä½†æ˜¯å®é™…ä¸Šä¸å­˜åœ¨ã€‚  <code>GHIDRA</code>åŒ…å«ç”¨<code>Java</code>ç¼–å†™çš„ç»„ä»¶çš„æºä»£ç ï¼Œä½†æ˜¯å¦‚æœæ‚¨æŸ¥çœ‹<code>Gradle</code>è„šæœ¬ï¼Œæ‚¨ä¼šå‘ç°ï¼Œç§˜å¯†é¡¹ç›®å¯¹ä¸€å †å¤–éƒ¨é¡¹ç›®æœ‰ä¾èµ–å…³ç³» <del> å®éªŒå®¤ </del>  <code>NSA</code>å­˜å‚¨åº“ã€‚ <br> åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå°šæ— åç¼–è¯‘å™¨å’Œ<code>SLEIGH</code> ï¼ˆè¿™æ˜¯ä¸€ä¸ªç”¨äºç¼–è¯‘å¤„ç†å™¨æ¨¡å—è¯´æ˜å’Œè½¬æ¢ä¸ºIRçš„å®ç”¨ç¨‹åºï¼‰ã€‚ </p><br><p> å¥½å§ï¼Œå“¦ï¼Œæˆ‘å¯¹æŸäº›äº‹æƒ…åˆ†å¿ƒäº†ã€‚ </p></div></div><br><p> å› æ­¤ï¼Œè®©æˆ‘ä»¬åœ¨<code>Eclipse</code>åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚ </p><br><h2 id="sozdayom-proekt-zagruzchika"> åˆ›å»ºä¸€ä¸ªåŠ è½½å™¨é¡¹ç›® </h2><br><p>  <code>GhidraDev</code> &gt; <code>New</code> -&gt; <code>Ghidra Module Project...</code> </p><br><p> æˆ‘ä»¬æŒ‡å®šé¡¹ç›®çš„åç§°ï¼ˆè€ƒè™‘åˆ°<code>Loader</code>ç±»å‹çš„å•è¯å°†è¢«ç²˜è´´åˆ°æ–‡ä»¶åä¸Šï¼Œå¹¶ä¸”ä¸ºäº†ä¸å¾—åˆ°<code>sega_loaderLoader.java</code>ç±»çš„<code>sega_loaderLoader.java</code> ï¼Œæˆ‘ä»¬ç›¸åº”åœ°å‘½åå®ƒä»¬ï¼‰ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ok/iq/kx/okiqkxnztehs89bnjh3wzen848w.png"></p><br><p> å•å‡»<code>Next &gt;</code> ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†dawsæ”¾åœ¨æ‰€éœ€ç±»åˆ«çš„å‰é¢ã€‚ å°±æˆ‘è€Œè¨€ï¼Œè¿™åªæ˜¯ä¸€ä¸ª<code>Loader</code> ã€‚ å•å‡»<code>Next &gt;</code> ã€‚ </p><br><p><img src="https://habrastorage.org/webt/3g/-c/_6/3g-c_6t4e10co47udy8txa7udiq.png"></p><br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨<code></code>æŒ‡ç¤ºç›®å½•çš„è·¯å¾„ã€‚ å•å‡»<code>Next &gt;</code> ã€‚ </p><br><p><img src="https://habrastorage.org/webt/9p/j6/kc/9pj6kcva-wqfiggwzf3itwssqm8.png"></p><br><p>  <code>GHIDRA</code>å…è®¸<code>GHIDRA</code>ä½¿ç”¨pythonï¼ˆé€šè¿‡<code>Jython</code> ï¼‰ç¼–å†™è„šæœ¬ã€‚ æˆ‘å°†ç”¨<code>Java</code>ç¼–å†™ï¼Œæ‰€ä»¥æˆ‘ä¸æ•¢è¯´ã€‚ æˆ‘æŒ‰<code>Finish</code> ã€‚ </p><br><p><img src="https://habrastorage.org/webt/_d/dr/z5/_ddrz5hnlfc0g-fnztl248er0tw.png"></p><br><h2 id="pishem-kod"> ç¼–å†™ä»£ç  </h2><br><p> ç©ºçš„é¡¹ç›®æ ‘çœ‹èµ·æ¥ä»¤äººå°è±¡æ·±åˆ»ï¼š </p><br><p><img src="https://habrastorage.org/webt/mn/vf/fx/mnvffx-jubdk6uqdcpw5njysqfe.png"></p><br><p> æ‰€æœ‰å¸¦æœ‰<code>java</code>ä»£ç çš„æ–‡ä»¶éƒ½åœ¨<code>/src/main/java</code>åˆ†æ”¯ä¸­ï¼š </p><br><p><img src="https://habrastorage.org/webt/xz/sx/6_/xzsx6_dw-avgpgufemblxrnbutm.png"></p><br><h3 id="getname">  getNameï¼ˆï¼‰ </h3><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºå¼•å¯¼åŠ è½½ç¨‹åºé€‰æ‹©ä¸€ä¸ªåç§°ã€‚  <code>getName()</code>æ–¹æ³•è¿”å›å®ƒï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Sega Mega Drive / Genesis Loader"</span></span>; }</code> </pre> <br><h3 id="findsupportedloadspecs">  findSupportedLoadSpecsï¼ˆï¼‰ </h3><br><p>  <code>findSupportedLoadSpecs()</code>æ–¹æ³•ï¼ˆåŸºäºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­åŒ…å«çš„æ•°æ®<code>findSupportedLoadSpecs()</code>å†³å®šåº”ä½¿ç”¨å“ªä¸ªå¤„ç†å™¨æ¨¡å—è¿›è¡Œåæ±‡ç¼–ï¼ˆä»¥åŠ<code>IDA</code>ä¸­çš„åæ±‡ç¼–ï¼‰ã€‚ åœ¨<code>GHIDRA</code>æœ¯è¯­ä¸­<code>GHIDRA</code>è¿™ç§°ä¸º<code>Compiler Language</code> ã€‚ å®ƒåŒ…æ‹¬ï¼šå¤„ç†å™¨ï¼Œå­—èŠ‚åºï¼Œä½å’Œç¼–è¯‘å™¨ï¼ˆå¦‚æœå·²çŸ¥ï¼‰ã€‚ </p><br><p> æ­¤æ–¹æ³•è¿”å›å—æ”¯æŒçš„ä½“ç³»ç»“æ„å’Œè¯­è¨€çš„åˆ—è¡¨ã€‚ å¦‚æœæ•°æ®æ ¼å¼é”™è¯¯ï¼Œæˆ‘ä»¬åªè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚ </p><br><p> å› æ­¤ï¼Œåœ¨<code>Sega Mega Drive</code>çš„æƒ…å†µä¸‹ï¼Œå•è¯â€œ <code>SEGA</code> â€æœ€ç»å¸¸å‡ºç°åœ¨æ ‡å¤´çš„åç§»é‡<code>0x100</code> ï¼ˆè¿™ä¸æ˜¯å…ˆå†³æ¡ä»¶ï¼Œä½†åœ¨99ï¼…çš„æƒ…å†µä¸‹å¯ä»¥å®ç°ï¼‰ã€‚ æ‚¨éœ€è¦æ£€æŸ¥æ­¤è¡Œæ˜¯å¦åœ¨å¯¼å…¥çš„æ–‡ä»¶ä¸­ã€‚ ä¸ºæ­¤ï¼Œå°†<code>ByteProvider provider</code> <code>findSupportedLoadSpecs()</code> <code>ByteProvider provider</code> ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¯¥æ–‡ä»¶å¤„ç†æ–‡ä»¶ã€‚ </p><br><p> æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>BinaryReader</code>å¯¹è±¡ï¼Œä»¥æ–¹ä¾¿ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼š </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ <code>false</code>å‚æ•°è¡¨ç¤ºåœ¨è¯»å–æ—¶ä½¿ç”¨<code>Big Endian</code> ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬é˜…è¯»è¿™ä¸€è¡Œã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨<code>reader</code>å¯¹è±¡çš„<code>readAsciiString(offset, size)</code>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs">reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))</code> </pre> <br><p> å¦‚æœ<code>equals()</code>è¿”å›<code>true</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ­£åœ¨å¤„ç†Segovæœ—å§†é…’ï¼Œå¹¶åœ¨åˆ—è¡¨ä¸­<code>List&lt;LoadSpec&gt; loadSpecs = new ArrayList&lt;&gt;();</code> å¯ä»¥æ·»åŠ Motorola <code>m68k</code> ã€‚ ä¸ºæ­¤ï¼Œè¯·åˆ›å»ºä¸€ä¸ªç±»å‹ä¸º<code>LoadSpec</code>çš„æ–°å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°æ¥å—å°†è¦åŠ è½½ROMçš„åŠ è½½å™¨å¯¹è±¡ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º<code>this</code> ï¼‰ <code>ImageBase</code> ï¼Œä¸€ä¸ª<code>LanguageCompilerSpecPair</code>ç±»å‹çš„å¯¹è±¡å’Œä¸€ä¸ªæ ‡å¿—-æ­¤<code>LoadSpec</code>åœ¨åˆ—è¡¨ä¸­æ˜¯å…¶ä»–ï¼ˆåœ¨åˆ—è¡¨ä¸­æ˜¯ï¼‰ <code>LoadSpec</code>å¯èƒ½æœ‰å¤šä¸ª<code>LoadSpec</code> ï¼‰ã€‚ </p><br><p>  <code>LanguageCompilerSpecPair</code>çš„æ„é€ å‡½æ•°æ ¼å¼å¦‚ä¸‹ï¼š </p><br><ol><li> ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>languageID</code> ï¼Œå½¢å¼ä¸ºâ€œ <em>ProcessorNameï¼šEndiannessï¼šBitsï¼šExactCpu</em> â€çš„å­—ç¬¦ä¸²ã€‚ åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥æ˜¯â€œ <em>68000ï¼šBEï¼š32ï¼šMC68020</em> â€è¡Œï¼ˆä¸å¹¸çš„æ˜¯ï¼Œäº¤è´§æ—¶æœªåŒ…å«<code>MC68000</code> ï¼Œä½†è¿™ä¸æ˜¯è¿™æ ·çš„é—®é¢˜ï¼‰ã€‚  <code>ExactCpu</code>å¯èƒ½æ˜¯<code>default</code> </li><li> å¯ä»¥åœ¨æ–‡ä»¶<code>68000.opinion</code>ä¸­çš„å¸¦æœ‰<code></code>å¤„ç†å™¨æè¿°ï¼ˆ <code>$(GHIDRA)/Ghidra/Processors/68000/data/languages</code> ï¼‰çš„ç›®å½•ä¸­æ‰¾åˆ°ç¬¬äºŒä¸ªå‚æ•°<code>$(GHIDRA)/Ghidra/Processors/68000/data/languages</code> ï¼Œä»¥åœ¨æ­¤å¤„æŸ¥æ‰¾éœ€è¦æŒ‡å®šçš„<code>68000.opinion</code> ã€‚ æˆ‘ä»¬çœ‹åˆ°è¿™é‡Œä»…æ˜¾ç¤º<code>default</code> ã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬æŒ‡å‡ºäº†è¿™ä¸€ç‚¹ </li></ol><br><p> ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä»¥ä¸‹ä»£ç ï¼ˆå¦‚æ‚¨æ‰€è§ï¼Œåˆ°ç›®å‰ä¸ºæ­¢æ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„ï¼‰ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Collection&lt;LoadSpec&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findSupportedLoadSpecs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ List&lt;LoadSpec&gt; loadSpecs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))) { loadSpecs.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoadSpec(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageCompilerSpecPair(<span class="hljs-string"><span class="hljs-string">"68000:BE:32:MC68020"</span></span>, <span class="hljs-string"><span class="hljs-string">"default"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadSpecs; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">IDAå’ŒGHIDRAåœ¨æ¨¡å—æ–¹é¢çš„åŒºåˆ«</b> <div class="spoiler_text"><p> æœ‰åŒºåˆ«ï¼Œè€Œä¸”ä»ç„¶å¾ˆå¼ºã€‚ åœ¨<code>GHIDRA</code>æ‚¨å¯ä»¥ç¼–å†™ä¸€ä¸ªé¡¹ç›®ï¼Œè¯¥é¡¹ç›®å°†äº†è§£ä¸åŒçš„ä½“ç³»ç»“æ„ï¼Œä¸åŒçš„æ•°æ®æ ¼å¼ï¼Œæˆä¸ºåŠ è½½ç¨‹åºï¼Œå¤„ç†å™¨æ¨¡å—ï¼Œåç¼–è¯‘å™¨åŠŸèƒ½çš„æ‰©å±•ä»¥åŠå…¶ä»–ä¼˜ç‚¹ã€‚ </p><br><p> åœ¨<code>IDA</code> ï¼Œè¿™æ˜¯æ¯ç§åŠ è½½é¡¹çš„å•ç‹¬é¡¹ç›®ã€‚ </p><br><p> æœ‰å¤šå°‘æ–¹ä¾¿ï¼Ÿ æˆ‘è®¤ä¸ºï¼Œæœ‰æ—¶åœ¨<code>GHIDRA</code> ï¼ </p></div></div><br><h3 id="load"> åŠ è½½ï¼ˆä¸ªï¼‰ </h3><br><p> åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæ®µï¼Œå¤„ç†è¾“å…¥æ•°æ®ï¼Œåˆ›å»ºä»£ç å’Œå…ˆå‰å·²çŸ¥çš„æ ‡ç­¾ã€‚ ä¸ºæ­¤ï¼Œåœ¨å…¥å£å¤„æäº¤ä»¥ä¸‹å¯¹è±¡ä»¥å¸®åŠ©æˆ‘ä»¬ï¼š </p><br><ol><li>  <code>ByteProvider provider</code> ï¼šæˆ‘ä»¬å·²ç»è®¤è¯†ä»–ã€‚ å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶æ•°æ® </li><li>  <code>LoadSpec loadSpec</code> ï¼šåœ¨æ–‡ä»¶çš„å¯¼å…¥é˜¶æ®µä½¿ç”¨<code>findSupportedLoadSpecs</code>æ–¹æ³•é€‰æ‹©çš„ä½“ç³»ç»“æ„çš„<code>findSupportedLoadSpecs</code> ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸€ä¸ªæ¨¡å—ä¸­ä½¿ç”¨å¤šç§æ•°æ®æ ¼å¼ï¼Œåˆ™å¾ˆæœ‰å¿…è¦ã€‚ æ–¹ä¾¿çš„ </li><li>  <code>List&lt;Option&gt; options</code> ï¼š <code>List&lt;Option&gt; options</code>åˆ—è¡¨ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ï¼‰ã€‚ æˆ‘è¿˜æ²¡å­¦ä¼šå’Œä»–ä»¬ä¸€èµ·å·¥ä½œ </li><li>  <code>Program program</code> ï¼šæä¾›å¯¹æ‰€æœ‰å¿…è¦åŠŸèƒ½çš„è®¿é—®çš„ä¸»è¦å¯¹è±¡ï¼šæ¸…å•ï¼Œåœ°å€ç©ºé—´ï¼Œæ®µï¼Œæ ‡ç­¾ï¼Œåˆ›å»ºæ•°ç»„ç­‰ã€‚ </li><li>  <code>MemoryConflictHandler handler</code>å’Œ<code>MemoryConflictHandler handler</code> <code>TaskMonitor monitor</code> ï¼šæˆ‘ä»¬å¾ˆå°‘éœ€è¦ç›´æ¥ä½¿ç”¨å®ƒä»¬ï¼ˆé€šå¸¸ï¼Œåªéœ€å°†è¿™äº›å¯¹è±¡ä¼ é€’ç»™ç°æˆçš„æ–¹æ³•ï¼‰ </li><li>  <code>MessageLog log</code> ï¼šè®°å½•å™¨æœ¬èº« </li></ol><br><p> å› æ­¤ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€äº›å¯¹è±¡æ¥ç®€åŒ–<code>GHIDRA</code>å®ä½“å’Œç°æœ‰æ•°æ®çš„å·¥ä½œã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬è‚¯å®šéœ€è¦<code>BinaryReader</code> ï¼š </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p> ä¸‹ä¸€ä¸ª è¿™å¯¹æˆ‘ä»¬éå¸¸æœ‰ç”¨ï¼Œå®ƒå°†ç®€åŒ–<code>FlatProgramAPI</code>ç±»çš„å‡ ä¹æ•´ä¸ªå¯¹è±¡ï¼ˆç¨åæ‚¨å°†çœ‹åˆ°å¯ä»¥ä½¿ç”¨å®ƒåšä»€ä¹ˆï¼‰ï¼š </p><br><pre> <code class="java hljs">FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor);</code> </pre> <br><h4 id="zagolovok-roma"> æœ—å§†é…’æ ‡é¢˜ </h4><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç¡®å®šæ™®é€šçš„ä¸–å˜‰æœ—å§†é…’çš„æ ‡é¢˜ã€‚ åœ¨å‰<code>0x100</code>å­—èŠ‚ä¸­ï¼Œæœ‰ä¸€ä¸ªè¡¨ï¼Œè¯¥è¡¨åŒ…å«æŒ‡å‘çŸ¢é‡çš„64ä¸ªDWORDæŒ‡é’ˆï¼Œä¾‹å¦‚ï¼š <code>Reset</code> ï¼Œ <code>Trap</code> ï¼Œ <code>DivideByZero</code> ï¼Œ <code>VBLANK</code>ç­‰ã€‚ </p><br><p> æ¥ä¸‹æ¥æ˜¯å¸¦æœ‰Romaåç§°ï¼ŒåŒºåŸŸï¼Œ <code>ROM</code>å’Œ<code>RAM</code>å—çš„å¼€å§‹å’Œç»“æŸåœ°å€ï¼Œå¤é€‰æ¡†ï¼ˆæ­¤å­—æ®µæ˜¯åº”å¼€å‘äººå‘˜çš„è¦æ±‚è€Œä¸æ˜¯å‰ç¼€è¿›è¡Œæ£€æŸ¥ï¼‰å’Œå…¶ä»–ä¿¡æ¯çš„ç»“æ„ã€‚ </p><br><p> è®©æˆ‘ä»¬åˆ›å»º<code>java</code>ç±»æ¥ä½¿ç”¨è¿™äº›ç»“æ„ï¼Œä»¥åŠå®ç°å°†æ·»åŠ åˆ°ç»“æ„åˆ—è¡¨ä¸­çš„æ•°æ®ç±»å‹ã€‚ </p><br><h4 id="vectorstable"> å‘é‡è¡¨ </h4><br><p> æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»<code>VectorsTable</code> ï¼Œå¹¶æ³¨æ„ï¼Œæˆ‘ä»¬æŒ‡å‡ºå®ƒå®ç°äº†<code>StructConverter</code>æ¥å£ã€‚ åœ¨æ­¤ç±»ä¸­ï¼Œæˆ‘ä»¬å°†å­˜å‚¨å‘é‡çš„åœ°å€ï¼ˆä»¥å¤‡å°†æ¥ä½¿ç”¨ï¼‰åŠå…¶åç§°ã€‚ </p><br><p><img src="https://habrastorage.org/webt/au/3c/m-/au3cm-qdnrviqcgqtn_asztwbao.png"></p><br><p> æˆ‘ä»¬å£°æ˜å‘é‡åç§°åŠå…¶ç¼–å·çš„åˆ—è¡¨ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_SIZE = <span class="hljs-number"><span class="hljs-number">0x100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_COUNT = VECTORS_SIZE / <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] VECTOR_NAMES = { <span class="hljs-string"><span class="hljs-string">"SSP"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reset"</span></span>, <span class="hljs-string"><span class="hljs-string">"BusErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"AdrErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"InvOpCode"</span></span>, <span class="hljs-string"><span class="hljs-string">"DivBy0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Check"</span></span>, <span class="hljs-string"><span class="hljs-string">"TrapV"</span></span>, <span class="hljs-string"><span class="hljs-string">"GPF"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trace"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv4"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadInt"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv13"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv16"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv17"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadIRQ"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ1"</span></span>, <span class="hljs-string"><span class="hljs-string">"EXT"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ3"</span></span>, <span class="hljs-string"><span class="hljs-string">"HBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ5"</span></span>, <span class="hljs-string"><span class="hljs-string">"VBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap4"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap5"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap6"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap8"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap9"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap13"</span></span>,<span class="hljs-string"><span class="hljs-string">"Trap14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv30"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv31"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv32"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv33"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv34"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv35"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv36"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv37"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv38"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv39"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3A"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3B"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3C"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3D"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3E"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3F"</span></span> };</code> </pre> <br><p> æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç±»æ¥å­˜å‚¨åœ°å€å’Œå‘é‡åç§°ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address address; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Address address, String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.address = address; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> address; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } }</code> </pre> <br><p> å‘é‡åˆ—è¡¨å°†å­˜å‚¨åœ¨<code>vectors</code>æ•°ç»„ä¸­ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> VectorFunc[] vectors;</code> </pre> <br><p>  <code>VectorsTable</code>çš„æ„é€ <code>VectorsTable</code>å°†æ¥å—ï¼š </p><br><ol><li>  <code>FlatProgramAPI fpa</code>ç”¨äºå°†<code>long</code>åœ°å€è½¬æ¢ä¸ºHydraçš„<code>Address</code>æ•°æ®ç±»å‹ï¼ˆå®é™…ä¸Šï¼Œæ­¤æ•°æ®ç±»å‹é€šè¿‡å°†åœ°å€ç»‘å®šåˆ°å¦ä¸€ä¸ªèŠ¯ç‰‡-åœ°å€ç©ºé—´æ¥è¡¥å……åœ°å€çš„ç®€å•æ•°å€¼ï¼‰ </li><li>  <code>BinaryReader reader</code> -é˜…è¯»ç  </li></ol><br><p>  <code>toAddr()</code>å¯¹è±¡å…·æœ‰<code>toAddr()</code>æ–¹æ³•ï¼Œè€Œ<code>reader</code>å…·æœ‰<code>setPointerIndex()</code>å’Œ<code>readNextUnsignedInt()</code> ã€‚ åŸåˆ™ä¸Šï¼Œä¸éœ€è¦ä»»ä½•å…¶ä»–æ“ä½œã€‚ æˆ‘ä»¬å¾—åˆ°ä»£ç ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; VECTORS_COUNT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0</span></span>); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc[VECTORS_COUNT]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { vectors[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc(fpa.toAddr(reader.readNextUnsignedInt()), VECTOR_NAMES[i]); } }</code> </pre> <br><p> ä¸ºäº†å®ç°ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦é‡å†™<code>toDataType()</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åº”è¿”å›ä¸€ä¸ª<code>Structure</code>å¯¹è±¡ï¼Œåœ¨å…¶ä¸­åº”å£°æ˜ç»“æ„å­—æ®µçš„åç§°ï¼Œå…¶å¤§å°å’Œæ¯ä¸ªå­—æ®µçš„æ³¨é‡Šï¼ˆå¯ä»¥ä½¿ç”¨<code>null</code> ï¼‰ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"VectorsTable"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { s.add(POINTER, <span class="hljs-number"><span class="hljs-number">4</span></span>, VECTOR_NAMES[i], <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }</code> </pre> <br><p> å¥½å§ï¼Œè®©æˆ‘ä»¬å®ç°è·å–æ¯ä¸ªçŸ¢é‡æˆ–æ•´ä¸ªåˆ—è¡¨çš„æ–¹æ³•ï¼ˆä¸€å †æ ·æ¿ä»£ç ï¼‰ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">å…¶ä»–æ–¹æ³•</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> VectorFunc[] getVectors() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSSP</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBusErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdrErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">3</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInvOpCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDivBy0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">5</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">6</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrapV</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">7</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">8</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">9</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">10</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">11</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">13</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">12</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">14</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">13</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">14</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">15</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">17</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">16</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">18</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">17</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">19</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">18</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">19</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">21</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">20</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">22</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">21</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">23</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">22</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv17</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">23</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadIRQ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">24</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">26</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">25</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEXT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">27</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">26</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">27</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">29</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">28</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">29</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">30</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">31</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">33</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">32</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">34</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">33</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">35</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">34</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">36</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">35</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">37</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">36</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">38</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">37</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">39</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">38</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">40</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">39</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap8</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">41</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">40</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap9</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">42</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">41</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">43</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">42</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">44</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">43</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">45</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">44</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">45</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">46</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">47</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv30</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">49</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">48</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv31</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">50</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">49</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv32</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">51</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">50</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv33</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">52</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">51</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv34</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">53</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">52</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv35</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">54</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">53</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv36</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">55</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">54</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv37</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">56</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">55</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv38</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">57</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">56</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv39</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">58</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">57</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3A</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">59</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">58</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3B</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">59</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3C</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">61</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">60</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">62</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">61</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3E</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">63</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">62</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3F</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">64</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">63</span></span>]; }</code> </pre> </div></div><br><h4 id="gameheader"> æ¸¸æˆå¤´ </h4><br><p> æˆ‘ä»¬å°†æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå®ç°<code>StructConverter</code>æ¥å£çš„<code>GameHeader</code>ç±»ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æ¸¸æˆæœ—å§†é…’å¤´ç»“æ„</b> <div class="spoiler_text"><table><thead><tr><th> å¼€å§‹åç§» </th><th> ç»“æŸåç§» </th><th> å†…å®¹æè¿° </th></tr></thead><tbody><tr><td>  100ç¾å…ƒ </td><td>  $ 10F </td><td> æ§åˆ¶å°åç§°ï¼ˆé€šå¸¸æ˜¯â€œ SEGA MEGA DRIVEâ€æˆ–â€œ SEGA GENESISâ€ï¼‰ </td></tr><tr><td>  $ 110 </td><td>  $ 11æ¥¼ </td><td> å‘å¸ƒæ—¥æœŸï¼ˆé€šå¸¸ä¸ºâ€œÂ©XXXX YYYY.MMMâ€ï¼Œå…¶ä¸­XXXXæ˜¯å…¬å¸ä»£ç ï¼ŒYYYYæ˜¯å¹´ä»½ï¼ŒMMM-æœˆï¼‰ </td></tr><tr><td>  $ 120 </td><td>  $ 14F </td><td> å›½å†…å </td></tr><tr><td>  $ 150 </td><td>  $ 17F </td><td> å›½é™…å </td></tr><tr><td>  $ 180 </td><td>  $ 18D </td><td> ç‰ˆæœ¬ï¼ˆâ€œ XX YYYYYYYYYYYYYYâ€ï¼Œå…¶ä¸­XXæ˜¯æ¸¸æˆç±»å‹ï¼Œè€ŒYYæ˜¯æ¸¸æˆä»£ç ï¼‰ </td></tr><tr><td>  $ 18E </td><td>  $ 18F </td><td> æ ¡éªŒå’Œ </td></tr><tr><td>  $ 190 </td><td>  $ 19F </td><td>  I / Oæ”¯æŒ </td></tr><tr><td>  $ 1A0 </td><td>  $ 1A3 </td><td>  ROMå¯åŠ¨ </td></tr><tr><td>  $ 1A4 </td><td>  $ 1A7 </td><td>  ROMç»“æŸ </td></tr><tr><td>  $ 1A8 </td><td>  $ 1AB </td><td>  RAMå¯åŠ¨ï¼ˆé€šå¸¸$ 00FF0000ï¼‰ </td></tr><tr><td>  $ 1AC </td><td>  $ 1AF </td><td>  RAMç»“æŸï¼ˆé€šå¸¸æ˜¯$ 00FFFFFFï¼‰ </td></tr><tr><td>  $ 1B0 </td><td>  $ 1B2 </td><td>  'RA'å’Œ$ F8ä½¿èƒ½SRAM </td></tr><tr><td>  $ 1B3 </td><td>  ---- </td><td> æœªä½¿ç”¨ï¼ˆ$ 20ï¼‰ </td></tr><tr><td>  $ 1B4 </td><td>  $ 1B7 </td><td>  SRAMå¯åŠ¨ï¼ˆé»˜è®¤$ 00200000ï¼‰ </td></tr><tr><td>  $ 1B8 </td><td>  $ 1BB </td><td>  SRAMç»“æŸï¼ˆé»˜è®¤$ 0020FFFFï¼‰ </td></tr><tr><td>  $ 1BC </td><td>  $ 1FF </td><td> æ³¨é‡Šï¼ˆæœªä½¿ç”¨ï¼‰ </td></tr></tbody></table></div></div><br><p> æˆ‘ä»¬è®¾ç½®å­—æ®µï¼Œæ£€æŸ¥è¾“å…¥æ•°æ®çš„é•¿åº¦æ˜¯å¦è¶³å¤Ÿï¼Œä½¿ç”¨<code>reader</code>å¯¹è±¡çš„<code>readNextByteArray()</code> ï¼Œ <code>readNextUnsignedShort()</code>ä¸¤ä¸ªæ–°æ–¹æ³•æ¥è¯»å–æ•°æ®ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç»“æ„ã€‚ ç»“æœä»£ç å¦‚ä¸‹ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">æ¸¸æˆå¤´</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.BinaryReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.StructConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.flatapi.FlatProgramAPI; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.DataType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.Structure; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.StructureDataType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StructConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] consoleName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] releaseDate = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] domesticName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] internationalName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] version = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> checksum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] ioSupport = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address romStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, romEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address ramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] sramCode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> unused = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address sramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, sramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] notes = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FlatProgramAPI fpa; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fpa = fpa; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; <span class="hljs-number"><span class="hljs-number">0x200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0x100</span></span>); consoleName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); releaseDate = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); domesticName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); internationalName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); version = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x0E</span></span>); checksum = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>) reader.readNextUnsignedShort(); ioSupport = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); romStart = fpa.toAddr(reader.readNextUnsignedInt()); romEnd = fpa.toAddr(reader.readNextUnsignedInt()); ramStart = fpa.toAddr(reader.readNextUnsignedInt()); ramEnd = fpa.toAddr(reader.readNextUnsignedInt()); sramCode = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x03</span></span>); unused = reader.readNextByte(); sramStart = fpa.toAddr(reader.readNextUnsignedInt()); sramEnd = fpa.toAddr(reader.readNextUnsignedInt()); notes = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x44</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"GameHeader"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ConsoleName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ReleaseDate"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"DomesticName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"InternationalName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x0E</span></span>, <span class="hljs-string"><span class="hljs-string">"Version"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(WORD, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-string"><span class="hljs-string">"Checksum"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"IoSupport"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-string"><span class="hljs-string">"SramCode"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(BYTE, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-string"><span class="hljs-string">"Unused"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-string"><span class="hljs-string">"Notes"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getConsoleName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> consoleName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getReleaseDate() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> releaseDate; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getDomesticName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> domesticName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getInternationalName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> internationalName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getVersion() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> version; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChecksum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> checksum; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getIoSupport() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioSupport; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramEnd; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getSramCode() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUnused</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unused; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSRAM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramCode == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'R'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0xF8</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getNotes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> notes; } }</code> </pre> </div></div><br><p> ä¸ºæ ‡é¢˜åˆ›å»ºå¯¹è±¡ï¼š </p><br><pre> <code class="java hljs">vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader);</code> </pre> <br><h4 id="segmenty"> åŒºéš” </h4><br><p>  Segaæœ‰ä¸€ä¸ªè‘—åçš„å†…å­˜åŒºåŸŸæ˜ å°„ï¼Œåœ¨è¿™é‡Œæˆ‘å¯èƒ½ä¸ä¼šä»¥è¡¨çš„å½¢å¼ç»™å‡ºï¼Œä½†æˆ‘åªä¼šç»™å‡ºç”¨äºåˆ›å»ºæ®µçš„ä»£ç ã€‚ </p><br><p> å› æ­¤ï¼Œ <code>FlatProgramAPI</code>ç±»çš„å¯¹è±¡å…·æœ‰<code>createMemoryBlock()</code>æ–¹æ³•ï¼Œä½¿ç”¨è¯¥æ–¹æ³•å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå†…å­˜åŒºåŸŸã€‚ åœ¨è¾“å…¥ä¸­ï¼Œå®ƒé‡‡ç”¨ä»¥ä¸‹å‚æ•°ï¼š </p><br><ol><li>  <code>name</code> ï¼šåœ°åŒºåç§° </li><li>  <code>address</code> ï¼šåŒºåŸŸçš„èµ·å§‹åœ°å€ </li><li>  <code>stream</code> ï¼š <code>InputStream</code>ç±»å‹çš„å¯¹è±¡ï¼Œå®ƒå°†ä½œä¸ºå†…å­˜åŒºåŸŸä¸­æ•°æ®çš„åŸºç¡€ã€‚ å¦‚æœæŒ‡å®š<code>null</code> ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæœªåˆå§‹åŒ–çš„åŒºåŸŸï¼ˆä¾‹å¦‚ï¼Œå¯¹äº<code>68K RAM</code>æˆ–<code>Z80 RAM</code>æˆ‘ä»¬åªéœ€è¦ </li><li>  <code>size</code> ï¼šåˆ›å»ºåŒºåŸŸçš„å¤§å° </li><li>  <code>isOverlay</code> ï¼šæ¥å—<code>true</code>æˆ–<code>false</code> ï¼Œå¹¶æŒ‡ç¤ºå†…å­˜åŒºåŸŸå·²è¦†ç›–ã€‚ é™¤äº†å¯æ‰§è¡Œæ–‡ä»¶å¤–ï¼Œæˆ‘ä¸çŸ¥é“éœ€è¦ä»€ä¹ˆåœ°æ–¹ </li></ol><br><p> åœ¨è¾“å‡ºä¸­ï¼Œ <code>createMemoryBlock()</code>è¿”å›ç±»å‹ä¸º<code>MemoryBlock</code>çš„å¯¹è±¡ï¼Œæ‚¨å¯ä»¥é€‰æ‹©<code>MemoryBlock</code>è®¾ç½®è®¿é—®æƒé™æ ‡å¿—ï¼ˆ <code>Read</code> ï¼Œ <code>Write</code> ï¼Œ <code>Execute</code> ï¼‰ã€‚ </p><br><p> ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹å½¢å¼çš„å‡½æ•°ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createSegment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, InputStream stream, String name, Address address, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> read, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> write, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> execute)</span></span></span><span class="hljs-function"> </span></span>{ MemoryBlock block = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { block = fpa.createMemoryBlock(name, address, stream, size, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); block.setRead(read); block.setWrite(read); block.setExecute(execute); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"Error creating %s segment"</span></span>, name)); } }</code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜è°ƒç”¨äº†<code>Msg</code>ç±»çš„é™æ€<code>error</code>æ–¹æ³•æ¥æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ã€‚ </p><br><p> åŒ…å«æ¸¸æˆæœ—å§†é…’çš„åˆ†æ®µçš„æœ€å¤§å¤§å°ä¸º<code>0x3FFFFF</code> ï¼ˆå…¶ä»–æ‰€æœ‰<code>0x3FFFFF</code>éƒ½å·²ç»å±äºå…¶ä»–åŒºåŸŸï¼‰ã€‚ åˆ›å»ºå®ƒï¼š </p><br><pre> <code class="java hljs">InputStream romStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0</span></span>); createSegment(fpa, romStream, <span class="hljs-string"><span class="hljs-string">"ROM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x000000</span></span>), Math.min(romStream.available(), <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre> <br><p>    <code>InputStream</code>    ,    0. </p><br><p>       ,     ( <code>SegaCD</code>  <code>Sega32X</code> ).        <code>OptionDialog</code> . , <code>showYesNoDialogWithNoAsDefaultButton()</code>      <code>YES</code>  <code>NO</code>   -  <code>NO</code> . </p><br><p>    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega CD segment?"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (romStream.available() &gt; <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>) { InputStream epaStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>); createSegment(fpa, epaStream, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega 32X segment?"</span></span>)) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"32X"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x800000</span></span>), <span class="hljs-number"><span class="hljs-number">0x200000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }</code> </pre> <br><p>      : </p><br><pre> <code class="java hljs">createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z80"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA00000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS1"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span> * <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS2"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z802"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z803"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"FDC"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TMSS"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"VDP"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"RAM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xFF0000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header.hasSRAM()) { Address sramStart = header.getSramStart(); Address sramEnd = header.getSramEnd(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramStart.getOffset() &gt;= <span class="hljs-number"><span class="hljs-number">0x200000</span></span> &amp;&amp; sramEnd.getOffset() &lt;= <span class="hljs-number"><span class="hljs-number">0x20FFFF</span></span> &amp;&amp; sramStart.getOffset() &lt; sramEnd.getOffset()) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SRAM"</span></span>, sramStart, sramEnd.getOffset() - sramStart.getOffset() + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }</code> </pre> <br><h4 id="massivy-metki-i-konkretnye-adresa"> ,     </h4><br><p>       <code>CreateArrayCmd</code> .   ,     : </p><br><ol><li> <code>address</code> : ,      </li><li> <code>numElements</code> :    </li><li> <code>dataType</code> :       </li><li> <code>elementSize</code> :    </li></ol><br><p>        <code>applyTo(program)</code> ,   . </p><br><p>        ,    ,  <code>BYTE</code> , <code>WORD</code> , <code>DWORD</code>  .  ,    <code>FlatProgramAPI</code>   <code>createByte()</code> , <code>createWord()</code> , <code>createDword()</code>  .. </p><br><p>  ,    ,       (,     <code>VDP</code> ).  ,    : </p><br><ol><li>    <code>Program</code>   <code>getSymbolTable()</code> ,       ,   .. </li><li>      <code>createLabel()</code> ,     ,    .      , ,     <code>SourceType.IMPORTED</code>      </li></ol><br><p>          ,   : </p><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedByteArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, ByteDataType.dataType, ByteDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createByte(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create byte. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedWordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, WordDataType.dataType, WordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create word. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedDwordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, DWordDataType.dataType, DWordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createDWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create dword. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="java hljs">createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA04000</span></span>), <span class="hljs-string"><span class="hljs-string">"Z80_YM2612"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_PCBVER"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10002</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10004</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10006</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10008</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10010</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10012</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10014</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10016</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10018</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_RAMMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80BUS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80RES"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_FDC"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TIME"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TMSS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00002</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00004</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00006</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00008</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000A</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000C</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP___CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000E</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP____CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00011</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_PSG"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> </div></div><br><h4 id="primenenie-struktur-zagolovka">    </h4><br><p>           <code>createData()</code>  <code>DataUtilities</code> .       : </p><br><ol><li> <code>program</code> :   <code>Program</code> </li><li> <code>address</code> : ,      </li><li> <code>dataType</code> :   </li><li> <code>dataLength</code> :  .   <code>-1</code>    </li><li> <code>stackPointers</code> :  <code>true</code> ,  -     .  <code>false</code> </li><li> <code>clearDataMode</code> :          ,     (,     ) </li></ol><br><p>    : ..      (,  ),         .      <code>FlatProgramAPI</code>    <code>createFunction()</code> ,       . </p><br><p>                 : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markVectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0</span></span>), vectors.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (VectorFunc func : vectors.getVectors()) { fpa.createFunction(func.getAddress(), func.getName()); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000000"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x100</span></span>), header.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000100"</span></span>); } }</code> </pre> <br><h3 id="zavershaem-metod-load">   load() </h3><br><p>         <code>load()</code>    <code>setMessage()</code>   <code>TaskMonitor</code> ,     . </p><br><pre> <code class="java hljs">monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName()));</code> </pre> <br><p>     ,     : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, LoadSpec loadSpec, List&lt;Option&gt; options, Program program, MemoryConflictHandler handler, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException, IOException </span></span>{ monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName())); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader); createSegments(fpa, provider, program, monitor); markVectorsTable(program, fpa); markHeader(program, fpa); monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Loading done"</span></span>, getName())); }</code> </pre> <br><h3 id="getdefaultoptions-i-validateoptions"> getDefaultOptions  validateOptions </h3><br><p>       ,      </p><br><h2 id="otlazhivaem-rezultaty-nashih-trudov">     </h2><br><p>        <code>Run</code> -&gt; <code>Debug As</code> -&gt; <code>1 Ghidra</code> .   . </p><br><p><img src="https://habrastorage.org/webt/fv/ua/ya/fvuaya-gohpzkoiiflp6v28eily.png"></p><br><h2 id="eksport-distributiva-i-ustanovka-v-ghidra">      GHIDRA </h2><br><p>     ,   -    .       <code>Eclipse</code>   <code>extension.properties</code> ,   : </p><br><pre> <code class="java hljs">description=Loader <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Sega Mega Drive / Genesis ROMs author=Dr. MefistO createdOn=<span class="hljs-number"><span class="hljs-number">20.03</span></span>.2019</code> </pre> <br><p>       <code>GhidraDev</code> -&gt; <code>Export</code> -&gt; <code>Ghidra Module Extension...</code>      : </p><br><p><img src="https://habrastorage.org/webt/4p/d-/4x/4pd-4xgokfhzsbfwdccrnzguqb0.png"></p><br><p><img src="https://habrastorage.org/webt/t2/gs/j3/t2gsj3lpwgtn-lueej69ostsil4.png"></p><br><p><img src="https://habrastorage.org/webt/z3/kn/ik/z3knik478dyvau73nau8j-rhiik.png"></p><br><p>      <code>dist</code>    zip- (-  <code>ghidra_9.0_PUBLIC_20190320_Sega.zip</code> )       <code>GHIDRA</code> . </p><br><p>     .  <code></code> ,  <code>File</code> -&gt; <code>Install Extensions...</code> ,     ,     . ... </p><br><p><img src="https://habrastorage.org/webt/ky/tk/uh/kytkuhf_3pciliw9ihhgthadbrs.png"></p><br><p><img src="https://habrastorage.org/webt/qj/bz/gf/qjbzgfycyjaeghezz_w1rehayo0.png"></p><br><h2 id="ishodniki-i-prochee">    </h2><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github-</a> ,   . </p><br><p>     :   <code>IDA</code>  <code>GHIDRA</code>       .   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN444562/">https://habr.com/ru/post/zh-CN444562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN444552/index.html">TDMSèˆªé“ã€‚ ä¸ä¸“ä¸šçŸ¥è¯†ä¸€èµ·å·¥ä½œ</a></li>
<li><a href="../zh-CN444554/index.html">Elixirä¸Šæœ€ç®€å•çš„JSON RESTful API</a></li>
<li><a href="../zh-CN444556/index.html">å¤ªç©ºä¸­æœˆäº®å’Œå¤ªé˜³çš„é¢œè‰²çš„RGBå’Œè‰²æ¸©å€¼</a></li>
<li><a href="../zh-CN444558/index.html">CUBA 7çš„æ–°åŠŸèƒ½</a></li>
<li><a href="../zh-CN444560/index.html">æˆ‘ä»¬é‚€è¯·æ‚¨å‚åŠ â€œäº‘ã€‚ Fashion Trendsâ€ 2019å¹´3æœˆ26æ—¥</a></li>
<li><a href="../zh-CN444564/index.html">å…·æœ‰å¿ƒç†æ¨¡å‹çš„æ•°å­—äº§å“å¼€å‘</a></li>
<li><a href="../zh-CN444566/index.html">è¥¿ç§‘æ–¯åŸºä¸ä¸€åç”·å­ä¸€èµ·è¿›è¡Œäº†æ— äººç›´å‡æœºçš„æ¼”ç¤º</a></li>
<li><a href="../zh-CN444568/index.html">2018å¹´å‘ç°çš„C ++é¡¹ç›®çš„åå¤§bug</a></li>
<li><a href="../zh-CN444570/index.html">2018å¹´C ++é¡¹ç›®ä¸­çš„åå¤§é”™è¯¯</a></li>
<li><a href="../zh-CN444572/index.html">LEDé—ªçƒ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>