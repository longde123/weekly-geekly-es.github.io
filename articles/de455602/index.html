<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ üë®üèø‚Äçü§ù‚Äçüë®üèæ üë™ Das Provozieren von Browsern st√ºrzt mit Verhaltensfuzzing ab ü•™ üí≠ üÖøÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werde ich Ihnen erz√§hlen, wie ich Fuzzing verwendet habe, um mehrere Abst√ºrze in Firefox zu finden. Normalerweise dient das Fuzzing ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Das Provozieren von Browsern st√ºrzt mit Verhaltensfuzzing ab</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vds/blog/455602/"><img src="https://habrastorage.org/getpro/habr/post_images/de5/60c/9c4/de560c9c4bd1bb90f65f35ecacdbc310.jpg" alt="Bild"><br><br>  In diesem Artikel werde ich Ihnen erz√§hlen, wie ich Fuzzing verwendet habe, um mehrere Abst√ºrze in Firefox zu finden.  Normalerweise dient das Fuzzing dazu, einen Fehler zu finden, der auf eine Speicherbesch√§digung hinweist. Mein Ziel ist jedoch anders: Ich m√∂chte eine unerwartete Browserreaktion erkennen.  Dies k√∂nnen Zeichen sein, die ein ungew√∂hnliches Tag √∂ffnen oder schlie√üen, oder m√∂glicherweise Zeichen, die vom JavaScript-Parser ignoriert werden.  Eine solche unerwartete Reaktion kann h√§ufig verwendet werden, um XSS-Angriffe durchzuf√ºhren, Sicherheitsfilter zu umgehen und die JavaScript-Sandbox zu umgehen. <a name="habracut"></a><br><br>  Der erste Fehler, √ºber den ich sprechen m√∂chte, ist das Schlie√üen des HTML-Kommentars auf andere Weise.  Wenn Sie die HTML-Spezifikation lesen, wissen Sie, dass ein Kommentar mit -&gt; oder -!&gt; Geschlossen werden kann.  Aber wie geht das anders?  Tolle Frage, um mit dem Fuzzing zu beginnen!  Sie m√ºssen nur den Code generieren, der die Antwort gibt. <br><br>  Als ich 2008 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Shazzer zusammenstellte,</a> um das Verhalten des Browsers zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verwirren</a> , war ich auf ungef√§hr 10.000 Richtungen pro Seite beschr√§nkt.  Heute, im Jahr 2019, funktioniert alles schneller, sodass wir viel h√§ufiger fusseln k√∂nnen.  Dar√ºber hinaus beschleunigt die Verwendung des DOM das Fuzzing, da Sie nicht mehr jede Richtung zum aktuellen Dokument hinzuf√ºgen m√ºssen.  Es ist erw√§hnenswert, dass dies ein unzuverl√§ssiger Ansatz ist, da Sie unterschiedliche Ergebnisse erzielen k√∂nnen.  In der Tat habe ich F√§lle gefunden, in denen das DOM Nullwerte in Attributargumenten wie href zul√§sst, der HTML-Parser jedoch nicht.  Dies sind immer noch unkritische Fehler, aber Sie k√∂nnen den Ergebnissen nicht immer vertrauen, um ein vollst√§ndiges Bild der Funktionsweise des HTML-Parsers zu erhalten.  In den meisten F√§llen funktioniert es jedoch und ist viel schneller als die HTML-Ausgabe von der Serverseite. <br><br>  Der erste Schritt wurde bereits getan - wir haben eine Frage: "Welche Zeichen k√∂nnen den HTML-Kommentar schlie√üen?".  Um dies zu beantworten, m√ºssen wir vorhandene Zeichen verwenden, die den HTML-Kommentar schlie√üen, und Fuzz-Zeichen, die wir nicht kennen.  Der n√§chste Schritt ist die Verwendung einer geeigneten Fuzzing-Software.  In meinem Fall verwende ich mein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hackvertor-</a> Tool, aber mit dem lokalen Webserver kann ich die gleichen Ergebnisse erzielen.  Die Idee dieses Tools ist es, die Eingabe in das Eingabefeld einzuf√ºgen, die Tags ein wenig zu konvertieren und etwas mit der Ausgabe zu tun.  Da wir nichts zu konvertieren haben, k√∂nnen wir unseren Code direkt in das Ausgabefeld einf√ºgen.  Klicken Sie daher auf den Textausgabebereich und erstellen Sie ein Array zum Speichern von Fuzzy-Zeichen und ein div-Element zum Testen von HTML: <br><br><pre><code class="javascript hljs">log = []; div=<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>);</code> </pre> <br>  Dann m√ºssen wir mehr als 1.000.000 Unicode-Zeichen oder genauer gesagt 0x10ffff ausblenden.  Eine einfache for-Schleife ist alles, was wir brauchen: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-number"><span class="hljs-number">0x10ffff</span></span>;i++){</code> </pre> <br>  Dann verwenden wir das div-Element, das wir f√ºr jedes Zeichen erstellt haben, wieder.  In diesem Fall teste ich die Position danach! Damit das Zeichen danach eingegeben wird! .. Dann benutze ich das img-Element, um zu sehen, ob das Fuzzing erfolgreich war.  Wenn dieses Element vorhanden ist, wurde der HTML-Kommentar geschlossen und wir haben einige interessante Zeichen! <br><br><pre> <code class="javascript hljs">div.innerHTML = <span class="hljs-string"><span class="hljs-string">'&lt;!-- --!'</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(i)+<span class="hljs-string"><span class="hljs-string">'&gt;&lt;img&gt;--&gt;'</span></span>;</code> </pre> <br>  Schlie√ülich √ºberpr√ºfen wir mit querySelector, ob img vorhanden ist, und f√ºgen den Protokollen Zeichen hinzu.  Dann schlie√üe ich die if-Anweisung und die for-Schleife.  Zum Schluss gebe ich die Ergebnisse in das Eingabefeld links ein: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(div.querySelector(<span class="hljs-string"><span class="hljs-string">'img'</span></span>)){ log.push(i); } } input.value=log</code> </pre> <br>  Hier ist die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vollversion des</a> Codes.  Sie m√ºssen die URL in Firefox √∂ffnen, die Eingabezeichen in das Ausgabefeld eingeben und auf die Schaltfl√§che "JS ausf√ºhren" klicken, um die Zeichen zu verwischen.  Nach Abschluss des Fuzzings sollten die Zahlen im Eingabefeld angezeigt werden. Sie entsprechen den Zeichencodes, die erfolgreich waren.  Zum Zeitpunkt des Schreibens erlaubt Firefox (Version 67) weiterhin, dass Zeilenumbr√ºche - \ n und \ r - nach! - den Kommentar schlie√üen.  Ich wurde informiert, dass dies in zuk√ºnftigen Versionen von Firefox behoben wurde.  Die letzte Phase des Fuzzing besteht darin, Ihre Nutzlast aufzubauen. Es ist ziemlich einfach.  Sie m√ºssen den Zeichencode durch das Zeichen ersetzen und die XSS-Nutzdaten hinzuf√ºgen: <br><br><pre> <code class="javascript hljs">&lt;!-- --! &gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">img</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onerror</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">alert(1)</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> --&gt;</span></span></code> </pre> <br>  Sie k√∂nnen Hackvertor erneut verwenden, um seine Funktion zu testen, indem Sie das Obige in das Ausgabefeld einf√ºgen und dann auf "HTML testen" klicken.  Ein Warnfenster sollte angezeigt werden, da Firefox (Version 67) die neue Zeile als Teil des endg√ºltigen Kommentars aufl√∂st. <br><br>  Auf diese Weise konnten wir einen unkritischen Fehler im Firefox-HTML-Parser finden.  Lass uns einen anderen finden!  Wir brauchen eine neue Frage: "Welche Zeichen k√∂nnen einen HTML-Kommentar √∂ffnen?".  Anstatt √ºber den vorhandenen HTML-Kommentar hinauszugehen, verwenden wir jetzt den HTML-Kommentar, um √ºber das vorhandene HTML-Attribut hinauszugehen.  Wie Sie sicher wissen, wissen Sie alle, dass Sie einen HTML-Kommentar mit &lt;!  -.  Alles ist richtig?  Wir werden den gleichen Code wieder verwenden, aber dieses Mal √§ndern Sie den Zweck von innerHTML, um zu √ºberpr√ºfen, ob der Kommentar offen ist: <br><br><img src="https://habrastorage.org/webt/nb/ji/du/nbjidu5mobde5mgiiojvfnumiwi.png"><br><br>  Daher wird das Symbol, das wir verschwimmen, nach dem ersten Bindestrich stehen.  Wenn das Zeichen erfolgreich einen √∂ffnenden HTML-Kommentar erstellt, kommentiert es das div-Element und beendet so das title-Attribut.  Wenn wir dieses Mal "Execute JS" ausf√ºhren, erhalten wir in Firefox (Version 67) zwei Ergebnisse: "0.45".  Code 45 wird erwartet, da es sich um einen Bindestrich handelt, 0 jedoch ein NULL-Zeichen!  Dies bedeutet, dass Firefox die Sequenz &lt;! - NULL- als offenen Kommentar interpretiert.  Eine Art Spiel!  (Ich denke, Browser-Anbieter ben√∂tigen mehr Verhaltens-Fuzzing =)).  Um diesen Testfall zu beenden, m√ºssen wir jetzt unsere Richtung erstellen.  Machen wir dasselbe: Ersetzen Sie erneut die Funktion String.fromCodePoint durch das Symbol NULL und XSS mit der folgenden Richtung: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML = <span class="hljs-string"><span class="hljs-string">'&lt;!-\x00- &gt;&lt;div title="--&gt;&lt;img src=1 onerror=alert(1)&gt;"&gt;&lt;/div&gt;'</span></span>;</code> </pre> <br>  Wechseln wir zu JavaScript anstelle von HTML.  Ich habe jeden Browser getestet und es tut mir leid, Mozilla, aber Firefox macht wieder eine Art Spiel.  Ich war von der Tatsache inspiriert, dass das Fuzzing aus dem jinmo123- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tweet</a> interessante neue ES6-Funktionen verwendet, um Funktionen ohne Klammern aufzurufen.  Die Frage, die ich mir zum Fuzzing gestellt habe, war: "Welche Zeichen sind nach den In- oder Instanzen von Operatoren zul√§ssig?"  Dann erstellen wir den Code erneut in Hackvertor, er folgt einem √§hnlichen Muster, verwendet diesmal jedoch nicht das DOM.  Erstellen Sie zun√§chst ein Array und eine for-Schleife: <br><br><pre> <code class="javascript hljs">log = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-number"><span class="hljs-number">0x10ffff</span></span>;i++){</code> </pre><br>  Dann werden wir eval anstelle von innerHTML verwenden, um unsere Werte zu verwischen.  Zuerst m√ºssen wir einen try catch-Block verwenden, um Ausnahmen zu erkennen, die durch ung√ºltige Zeichen verursacht werden. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"/a/"</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(i)+<span class="hljs-string"><span class="hljs-string">"instanceof function(){}"</span></span>);</code> </pre> <br>  Die eval-Funktion wird verwendet, um festzustellen, ob unser JavaScript g√ºltig ist.  Wenn ja, geht es zur n√§chsten Zeile, wenn nicht, l√∂st es eine Ausnahme aus, die bemerkt wird, und geht dann zum n√§chsten Zeichen.  Die n√§chste Zeile registriert einfach das Zeichen und schlie√üt dann den try catch-Block und die for-Schleife.  Die Funktion zeigt dann die Ergebnisse im Eingabefeld an. <br><br><pre> <code class="javascript hljs">log.push(i); }<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(e){} } input.value=log</code> </pre> <br>  Wenn Sie diesen Code mit "JS ausf√ºhren" ausf√ºhren, erhalten Sie eine Reihe von Ergebnissen!  Firefox ignoriert viele Zeichen.  Wenn Sie den Code in Chrome ausprobieren, erhalten Sie vern√ºnftigere Ergebnisse.  Suchen Sie den Zeichencode in dem Eingabefeld, das Sie verwenden m√∂chten. In meinem Fall war es "1114110" oder "0x10fffe" in hex.  Jetzt erstellen wir unseren JavaScript-Vektor: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"1337"</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(<span class="hljs-number"><span class="hljs-number">1114110</span></span>)+<span class="hljs-string"><span class="hljs-string">"in"</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(<span class="hljs-number"><span class="hljs-number">1114110</span></span>)+<span class="hljs-string"><span class="hljs-string">"alert(1337)"</span></span>);</code> </pre> <br>  Sie k√∂nnen es sich auch in einem SVG-Skript vorstellen: <br><br><img src="https://habrastorage.org/webt/hv/92/k2/hv92k2ivxpvq3-2faoms6akr9hg.png"><br><br>  Die neuesten Dual-Prozessor-Konfigurationen dedizierter Server mit Intel Scalable-Prozessoren f√ºr 2019 sind auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>DEDIC.SH</b></a> verf√ºgbar: <br><ul><li>  2x Xeon Silver 4214 - insgesamt 24 Kerne </li><li>  2x Xeon Gold 5218 - insgesamt 32 Kerne </li><li>  2x Xeon Gold 6240 - Konfiguration mit 36 ‚Äã‚ÄãKernen. </li></ul><br>  Die Kosten f√ºr einen Server mit zwei Xeon Silver 4214 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>ab 15210 Rubel / Monat</b></a> <br>  Wir sind auch bereit, <b>jede Konfiguration</b> f√ºr Sie zu sammeln - <b><a href="">schreiben Sie uns</a></b> ! <br><br>  Wenn keine gro√üen Leistungen eines dedizierten Servers erforderlich sind - <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VDS ab 150 Rubel / Monat</a></b> ist das, was Sie brauchen! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de455602/">https://habr.com/ru/post/de455602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de455592/index.html">Viren, die Industrieunternehmen als Bedrohung f√ºr die physische Sicherheit angreifen</a></li>
<li><a href="../de455594/index.html">Microsoft Edge von CVE zu RCE unter Windows 10</a></li>
<li><a href="../de455596/index.html">DevConfX :: Management - Berichte von Managern in einfachen Worten</a></li>
<li><a href="../de455598/index.html">Aktualisieren Sie Exim dringend auf 4.92 - es liegt eine aktive Infektion vor</a></li>
<li><a href="../de455600/index.html">Die 3DEXPERIENCE-Plattform hilft bei der Schaffung √∂ffentlicher Verkehrsmittel der Zukunft</a></li>
<li><a href="../de455604/index.html">Verantwortlich f√ºr die Verwaltung der Windows-Konfiguration. Erfolgsgeschichte</a></li>
<li><a href="../de455606/index.html">Maschinelles Lernen und Datenanalyse: Masterstudiengang an der Higher School of Economics in St. Petersburg</a></li>
<li><a href="../de455608/index.html">Bitmap-Indizes in Go: Unglaubliche Suchgeschwindigkeit</a></li>
<li><a href="../de455610/index.html">Legend√§rer Intel Core i7-2600K: Testen von Sandy Bridge im Jahr 2019 (Teil 1)</a></li>
<li><a href="../de455612/index.html">Wir denken √ºber die Charaktere von Spielen und Dialogen nach dem Rat von Schriftstellern und am Beispiel von Unterst√ºtzern der Theorie einer flachen Erde nach</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>