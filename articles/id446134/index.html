<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏼 👩🏾‍🤝‍👨🏼 🤶🏼 Ketergantungan Injeksi dalam Flutter ✊🏼 ☝🏼 🌷</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami saat ini bereksperimen dengan Flutter sambil mengembangkan proyek sampingan kami untuk tantangan langkah dengan kolega. Proyek sampingan ini juga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ketergantungan Injeksi dalam Flutter</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446134/"><p>  Kami saat ini bereksperimen dengan Flutter sambil mengembangkan proyek sampingan kami untuk tantangan langkah dengan kolega.  Proyek sampingan ini juga harus dianggap sebagai taman bermain, di mana kita dapat memeriksa apakah kita dapat menggunakan Flutter dalam proyek yang lebih serius.  Itu sebabnya kami ingin menggunakan beberapa pendekatan di sana yang dapat terlihat seperti rekayasa berlebihan untuk proyek sekecil itu. </p><br><p> Jadi salah satu pertanyaan pertama adalah apa yang bisa kita gunakan untuk injeksi ketergantungan.  Pencarian cepat di internet mengungkapkan 2 perpustakaan dengan ulasan positif: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">get_it</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kiwi</a> .  Karena <code>get_it</code> ternyata adalah Service Locator (dan saya bukan penggemar pola ini), saya akan bermain dengan kiwi, yang terlihat lebih menjanjikan, tapi kemudian saya menemukan satu perpustakaan lagi: <a href="">inject.dart</a> .  Ini sangat terinspirasi oleh perpustakaan Dagger, dan saat kami menggunakan yang terbaru di proyek Android kami yang lain, saya memutuskan untuk menggali lebih dalam. </p><a name="habracut"></a><br><p>  Patut dikatakan bahwa meskipun perpustakaan ini terletak di repositori Google GitHub, ini bukan perpustakaan resmi dari Google dan saat ini tidak ada dukungan yang diberikan: </p><br><blockquote>  Pustaka ini saat ini ditawarkan apa adanya (pratinjau pengembang) karena bersumber terbuka dari repositori internal di dalam Google.  Karena itu kami tidak dapat menindak bug atau permintaan fitur saat ini. </blockquote><p>  Meskipun demikian, sepertinya perpustakaan melakukan semua yang kami butuhkan untuk saat ini, jadi saya ingin membagikan beberapa info tentang bagaimana Anda dapat menggunakan perpustakaan ini dalam proyek Anda. </p><br><h2 id="installation">  Instalasi </h2><br><p>  Karena tidak ada paket di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori resmi</a> , kami harus menginstalnya secara manual.  Saya lebih suka melakukannya sebagai submodule git, jadi saya membuat folder <code>vendor</code> di direktori sumber proyek saya dan menjalankan perintah berikut dari direktori ini: </p><br><pre> <code class="plaintext hljs">git submodule add https://github.com/google/inject.dart</code> </pre> <br><p>  Dan sekarang kita dapat mengaturnya dengan menambahkan baris berikut ke <code>pubspec.yaml</code> : </p><br><pre> <code class="plaintext hljs">dependencies: // other dependencies here inject: path: ./vendor/inject.dart/package/inject dev_dependencies: // other dev_dependencies here build_runner: ^1.0.0 inject_generator: path: ./vendor/inject.dart/package/inject_generator</code> </pre> <br><h2 id="usage">  Penggunaan </h2><br><p>  Fungsi apa yang biasanya kita harapkan dari perpustakaan DI?  Mari kita membahas beberapa kasus penggunaan umum: </p><br><p>  <strong>Injeksi kelas beton</strong> </p><br><p>  Ini bisa sesederhana ini: </p><br><pre> <code class="plaintext hljs">import 'package:inject/inject.dart'; @provide class StepService { // implementation }</code> </pre> <br><p>  Kita dapat menggunakannya misalnya dengan widget Flutter seperti ini: </p><br><pre> <code class="plaintext hljs">@provide class SomeWidget extends StatelessWidget { final StepService _service; SomeWidget(this._service); }</code> </pre> <br><p>  <strong>Injeksi antarmuka</strong> </p><br><p>  Pertama-tama kita perlu mendefinisikan kelas abstrak dengan beberapa kelas implementasi, misalnya: </p><br><pre> <code class="plaintext hljs">abstract class UserRepository { Future&lt;List&lt;User&gt;&gt; allUsers(); } class FirestoreUserRepository implements UserRepository { @override Future&lt;List&lt;User&gt;&gt; allUsers() { // implementation } }</code> </pre> <br><p>  Dan sekarang kami dapat menyediakan dependensi dalam modul kami: </p><br><pre> <code class="plaintext hljs">import 'package:inject/inject.dart'; @module class UsersServices { @provide UserRepository userRepository() =&gt; FirestoreUserRepository(); }</code> </pre> <br><p>  <strong>Penyedia</strong> </p><br><p>  Apa yang harus dilakukan jika kita tidak perlu menginstruksikan beberapa kelas, melainkan penyedia, yang akan memberi kita instance baru dari kelas ini setiap kali?  Atau jika kita perlu menyelesaikan ketergantungan dengan malas alih-alih mendapatkan contoh konkret di konstruktor?  Saya tidak menemukannya dalam dokumentasi (well, karena tidak ada dokumentasi sama sekali) maupun dalam contoh yang diberikan, tetapi sebenarnya berfungsi dengan cara ini sehingga Anda dapat meminta fungsi mengembalikan instance yang diperlukan dan itu akan disuntikkan dengan benar. </p><br><p>  Kami bahkan dapat mendefinisikan jenis pembantu seperti ini: </p><br><pre> <code class="plaintext hljs">typedef Provider&lt;T&gt; = T Function();</code> </pre> <br><p>  dan menggunakannya di kelas kami: </p><br><pre> <code class="plaintext hljs">@provide class SomeWidget extends StatelessWidget { final Provider&lt;StepService&gt; _service; SomeWidget(this._service); void _someFunction() { final service = _service(); // use service } }</code> </pre> <br><p>  <strong>Injeksi dengan bantuan</strong> </p><br><p>  Tidak ada fungsi bawaan untuk menyuntikkan objek yang memerlukan argumen yang dikenal saat runtime saja, jadi kita dapat menggunakan pola umum dengan pabrik dalam kasus ini: membuat kelas pabrik yang mengambil semua dependensi waktu kompilasi dalam konstruktor dan menyuntikkannya, dan menyediakan metode pabrik dengan argumen runtime yang akan membuat instance yang diperlukan. </p><br><p>  <strong>Lajang, kualifikasi, dan injeksi asinkron</strong> </p><br><p>  Ya, perpustakaan mendukung semua ini.  Sebenarnya ada penjelasan yang bagus dalam <a href="">contoh resmi</a> . </p><br><p>  <strong>Mengabelkannya</strong> </p><br><p>  Langkah terakhir untuk membuat semuanya berfungsi adalah membuat injector (alias komponen dari Dagger), misal seperti ini: </p><br><pre> <code class="plaintext hljs">import 'main.inject.dart' as g; @Injector(const [UsersServices, DateResultsServices]) abstract class Main { @provide MyApp get app; static Future&lt;Main&gt; create( UsersServices usersModule, DateResultsServices dateResultsModule, ) async { return await g.Main$Injector.create( usersModule, dateResultsModule, ); } }</code> </pre> <br><p>  Di sini <code>UserServices</code> dan <code>DateResultsServices</code> adalah modul yang didefinisikan sebelumnya, <code>MyApp</code> adalah widget root dari aplikasi kami, dan <code>main.inject.dart</code> adalah file yang dibuat secara otomatis (lebih lanjut tentang ini nanti). </p><br><p>  Sekarang kita dapat mendefinisikan fungsi utama kita seperti ini: </p><br><pre> <code class="plaintext hljs">void main() async { var container = await Main.create( UsersServices(), DateResultsServices(), ); runApp(container.app); }</code> </pre> <br><h2 id="running">  Lari </h2><br><p>  Karena <code>inject</code> berfungsi dengan pembuatan kode, kita perlu menggunakan build runner untuk menghasilkan kode yang diperlukan.  Kita dapat menggunakan perintah ini: </p><br><pre> <code class="plaintext hljs">flutter packages pub run build_runner build</code> </pre> <br><p>  atau <code>watch</code> perintah untuk menjaga kode sumber disinkronkan secara otomatis: </p><br><pre> <code class="plaintext hljs">flutter packages pub run build_runner watch</code> </pre> <br><p>  Tapi ada satu momen penting di sini: secara default kode akan dihasilkan ke folder <code>cache</code> dan Flutter saat ini tidak mendukung ini (meskipun ada pekerjaan yang sedang berlangsung untuk menyelesaikan masalah ini).  Jadi kita perlu menambahkan file <code>inject_generator.build.yaml</code> dengan konten berikut: </p><br><pre> <code class="plaintext hljs">builders: inject_generator: target: ":inject_generator" import: "package:inject_generator/inject_generator.dart" builder_factories: - "summarizeBuilder" - "generateBuilder" build_extensions: ".dart": - ".inject.summary" - ".inject.dart" auto_apply: dependents build_to: source</code> </pre> <br><p>  Ini sebenarnya konten yang sama seperti di <code>vendor/inject.dart/package/inject_generator/build.yaml</code> file <code>vendor/inject.dart/package/inject_generator/build.yaml</code> kecuali untuk satu baris: <code>build_to: cache</code> telah diganti dengan <code>build_to: source</code> . </p><br><p>  Sekarang kita dapat menjalankan <code>build_runner</code> , itu akan menghasilkan kode yang diperlukan (dan memberikan pesan kesalahan jika beberapa dependensi tidak dapat diselesaikan) dan setelah itu kita dapat menjalankan Flutter build seperti biasa. </p><br><h2 id="profit">  Untung </h2><br><p>  Itu saja.  Anda juga harus memeriksa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh yang</a> disediakan dengan perpustakaan itu sendiri, dan jika Anda memiliki pengalaman dengan perpustakaan Dagger, <code>inject</code> akan sangat akrab bagi Anda. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446134/">https://habr.com/ru/post/id446134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446124/index.html">Acara digital di Moskow dari tanggal 1 hingga 7 April</a></li>
<li><a href="../id446126/index.html">Santai pikiran orang yang malas tentang kriptografi dan perlindungan data</a></li>
<li><a href="../id446128/index.html">Fonogram sinar-X kembali: Serangan besar-besaran, Jonsi dan yang lainnya merilis rekaman "di tulang"</a></li>
<li><a href="../id446130/index.html">Agregator Acara untuk Acara Unity3d</a></li>
<li><a href="../id446132/index.html">92,7% membuat cadangan, kehilangan data meningkat 30%. Apa yang salah</a></li>
<li><a href="../id446136/index.html">Mesin 3D Marmer Saya Dicetak</a></li>
<li><a href="../id446138/index.html">Betapa mudahnya mengatur startup Anda secara legal dalam bentuk kemitraan sederhana</a></li>
<li><a href="../id446142/index.html">Flat Earth: Eksperimen dan Bukti</a></li>
<li><a href="../id446144/index.html">Intisari materi menarik untuk pengembang seluler # 292 (25 Maret - 31 Maret)</a></li>
<li><a href="../id446148/index.html">Linux Kernel 5.0 - menulis Perangkat Blok Sederhana di bawah blk-mq</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>