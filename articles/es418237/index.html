<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÉüèø üë©üèæ‚Äçüíº üíÖüèæ Desarrollo de aplicaciones multiinquilino en la plataforma SAP Cloud en Neo, Parte 2: Autorizaci√≥n y autenticaci√≥n üèÆ üéÄ ü§¶üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el segundo art√≠culo de la serie sobre el desarrollo de aplicaciones en la plataforma SAP Cloud Platform en el entorno Neo, cubriremos uno de los as...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de aplicaciones multiinquilino en la plataforma SAP Cloud en Neo, Parte 2: Autorizaci√≥n y autenticaci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sap/blog/418237/"> En el segundo art√≠culo de la serie sobre el desarrollo de aplicaciones en la plataforma SAP Cloud Platform en el entorno Neo, cubriremos uno de los aspectos m√°s importantes: la autorizaci√≥n y la gesti√≥n de autenticaci√≥n de usuarios. <br><br>  En este art√≠culo, mostraremos c√≥mo establecer una conexi√≥n entre la plataforma SAP Cloud y el proveedor de identidad (IDP) del cliente imaginario ABC PetroCorp, y tambi√©n agregaremos usuarios al IDP.  A continuaci√≥n, veremos c√≥mo asignar roles para los usuarios de la empresa cliente en una aplicaci√≥n espec√≠fica (desde IDP), y c√≥mo configurar los atributos SAML para su transferencia desde IDP a la aplicaci√≥n de la plataforma SCP en la nube. <br><a name="habracut"></a><br>  En la subcuenta del cliente ficticio ABC PetroCorp <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del primer art√≠culo</a> , ya est√° instalada una suscripci√≥n a las aplicaciones de monitoreo de contaminaci√≥n SCP proporcionadas por ITeLO Consulting.  Ahora, el empleado de ABC PetroCorp necesita que esta aplicaci√≥n est√© disponible para otros colegas. <br><br>  Un usuario de SAP Cloud Platform puede conectar su IDP corporativo a la plataforma en la nube y configurar la gesti√≥n de seguridad y autenticaci√≥n para su aplicaci√≥n cargada en SCP. <br><br>  ABC PetroCorp ha activado el servicio SAP Cloud Platform Identity Authentication, que proporciona acceso a procesos, aplicaciones y datos comerciales.  Este servicio proporciona un inquilino de SCI, dentro del cual hay una configuraci√≥n de aplicaci√≥n y gesti√≥n de autorizaci√≥n de usuario. <br><br>  Emily, la hero√≠na imaginaria del primer art√≠culo, tiene acceso a este inquilino de SCI: es su administrador y puede configurar la autorizaci√≥n del usuario en una aplicaci√≥n espec√≠fica.  Ella quiere descubrir c√≥mo crear estas configuraciones utilizando el servicio de autenticaci√≥n de identidad. <br><br>  Requisitos: <br><br><ul><li>  Una cuenta SCP global productiva (no de prueba) con el servicio de autenticaci√≥n de identidad conectado (como IDP para la subcuenta ABC PetroCorp); </li><li>  El usuario de la subcuenta del cliente debe ser el administrador del inquilino de SCI, por lo que tendr√° acceso a la consola de administraci√≥n del servicio de autenticaci√≥n de identidad. </li></ul><br>  Emily debe completar los siguientes pasos en la consola de administraci√≥n del servicio de autenticaci√≥n de identidad y el panel de control de SCP para que la aplicaci√≥n en la plataforma en la nube est√© disponible para otros empleados de ABC PetroCorp: <br><br>  <i>Paso 1: Establezca una relaci√≥n de confianza entre el inquilino de SCI y la subcuenta SCP.</i> <i><br></i>  <i>Paso 2: Importe usuarios al inquilino de SCI y actualice (agregue) los atributos necesarios.</i> <i><br></i>  <i>Paso 3: Asignar roles a usuarios de nivel de aplicaci√≥n en SCP.</i> <i><br></i>  <i>Paso 4: Configure los atributos en el panel de control del inquilino SCI y SCP para transferirlos a la aplicaci√≥n.</i> <i><br></i>  <i>Paso 5: Verifique la configuraci√≥n.</i> <br><br>  <b><i>Paso 1: Establezca una confianza entre el inquilino de SCI y la subcuenta SCP</i></b> <b><i><br></i></b> <br>  Emily es la administradora de la subcuenta ABC PetroCorp y el inquilino de SCI, lo que le permite aplicar la configuraci√≥n necesaria para utilizar el inquilino de SCI como un "repositorio de usuarios" para la aplicaci√≥n multiempresa proporcionada por el proveedor ITeLO Consulting. <br><br>  Primero, Emily necesita establecer una relaci√≥n de confianza entre el inquilino de SCI y la subcuenta SCP del cliente ABC PetroCorp. <br><br>  Vamos a la consola de administraci√≥n del servicio de autenticaci√≥n de identidad utilizando el enlace "https: //.accounts.ondemand.com/admin", donde se encuentra el identificador del inquilino de SCI.  Este enlace se puede encontrar en la carta de registro que le llega al administrador del inquilino del servicio de autenticaci√≥n de identidad.  El identificador de inquilino tambi√©n se indica all√≠. <br><br>  La consola de administraci√≥n del servicio de autenticaci√≥n de identidad es la siguiente: <br><br><img src="https://habrastorage.org/webt/cp/co/sg/cpcosgfcvdxme2noud-nmpiu9z8.png"><br><br>  En otra pesta√±a del navegador, abra el panel de control para la subcuenta del cliente "ABC PetroCorp" y vaya a la pesta√±a "Seguridad" -&gt; "Confianza". <br><br><img src="https://habrastorage.org/webt/6w/xx/m0/6wxxm0jlg4ba0p4j6cin6m2n4by.png"><br><br>  En el men√∫ "Gesti√≥n de confianza" que se abre, vaya a la pesta√±a "Proveedor de servicios locales" y haga clic en "Editar". <br><br><img src="https://habrastorage.org/webt/8r/r5/gt/8rr5gt5cef-3zbr4bh-xwapupuu.png"><br><br>  Luego realizamos los siguientes pasos: <br><br><ul><li>  En el campo "Tipo de configuraci√≥n", cambie el tipo a "Personalizado"; </li><li>  Haga clic en "Generar par de claves" para crear una clave y un certificado para la cuenta; </li><li>  Cambie el valor en el campo "Propagaci√≥n principal" a "Activar"; </li><li>  Haga clic en "Guardar". </li></ul><br><img src="https://habrastorage.org/webt/pj/i_/yt/pji_ytcjevq_bzd5odtcvdchclm.png"><br><br>  Haga clic en "Obtener metadatos" para descargar el archivo de metadatos en el formato "xml", que contiene las configuraciones descritas anteriormente.  Se utilizar√° para generar confianza con el inquilino de SCI. <br><br>  Volvamos a la consola de administraci√≥n del servicio de Autenticaci√≥n de Identidad y vayamos a la pesta√±a "Aplicaciones y Recursos" -&gt; "Aplicaciones" en el men√∫ de la izquierda.  En el √°rea "Aplicaciones", haga clic en el bot√≥n "Agregar" para indicar una nueva aplicaci√≥n implementada en la subcuenta "ABC PetroCorp". <br><br><img src="https://habrastorage.org/webt/en/a4/ow/ena4owiid3yz0_qdn5ch4c2vexe.png"><br><br>  En la ventana que aparece, ingrese el nombre de la aplicaci√≥n (por ejemplo, ABC_PetroCorp_IDP) y haga clic en "Guardar".  Despu√©s de eso, se crear√° un nuevo punto en el inquilino para nuestra aplicaci√≥n. <br><br>  En la aplicaci√≥n creada, vaya a la pesta√±a "Confianza" y seleccione el par√°metro "Configuraci√≥n de SAML 2.0". <br><br><img src="https://habrastorage.org/webt/oi/cy/fg/oicyfgksa9mue9msaysvy_7asyq.png"><br><br>  En la secci√≥n "Definir desde metadatos", haga clic en "Examinar" y seleccione el archivo de metadatos en el formato "xml", que descargamos antes al configurar la confianza en la subcuenta SCP.  Los detalles sobre la configuraci√≥n de SAML 2.0 se completar√°n autom√°ticamente despu√©s de descargar el archivo.  Haga clic en "Guardar": ahora se crea y guarda la configuraci√≥n SAML 2.0 para esta aplicaci√≥n. <br><br><img src="https://habrastorage.org/webt/eu/dv/se/eudvsepyrbw9drrqhzl6ydstbhe.png"><br><br>  Regrese al punto de aplicaci√≥n llamado ABC_PetroCorp_IDP en el inquilino, haga clic en "URL de inicio" e ingrese una URL como "https: // contaminacionmonitoringui- &lt;nombre_cuenta_suba&gt; .dispatcher. &lt;region_host&gt;". <br><br>  Esta URL se puede encontrar en la descripci√≥n de la aplicaci√≥n HTML5 a la que est√° suscrito el cliente (subcuenta "ABC PetroCorp").  Para hacerlo, vaya a la subcuenta del cliente en la pesta√±a "Aplicaciones" -&gt; "Suscripciones" y seleccione la aplicaci√≥n HTML5 firmada. <br><br><img src="https://habrastorage.org/webt/ys/6l/bb/ys6lbbnjrqqh1tnwwsfufr_tmpe.png"><br><br>  En la pesta√±a "Descripci√≥n general" estar√° la URL que necesitamos. <br><br><img src="https://habrastorage.org/webt/zx/sg/_j/zxsg_jrg0wntfrttlqjlv5l2q3y.png"><br><br>  Luego volvemos al punto de solicitud en el inquilino de SCI, designamos la URL de la aplicaci√≥n en la "URL de inicio" y hacemos clic en "Guardar". <br><br><img src="https://habrastorage.org/webt/rm/ie/od/rmieoddhrh-rj2wopqy9llz_dqm.png"><br><br>  Ahora vaya a la pesta√±a "Aplicaciones y recursos" -&gt; "Configuraci√≥n del inquilino" en la consola de administraci√≥n del servicio de autenticaci√≥n de identidad.  En la p√°gina de configuraci√≥n del inquilino, seleccione "Configuraci√≥n de SAML 2.0". <br><br><img src="https://habrastorage.org/webt/nj/yf/fx/njyffxlfgdvcp5y3m-nyeqznqde.png"><br><br>  En la ventana que se abre, haga clic en "Descargar archivo de metadatos" para descargar el archivo "xml" que contiene las configuraciones de inquilinos SCI.  Se utilizar√° en el futuro para establecer la confianza con la subcuenta del cliente en SCP. <br><br>  Vuelva a la subcuenta "ABC PetroCorp" y vaya al men√∫ "Seguridad" -&gt; "Confianza", en la ventana que se abre, seleccione la pesta√±a "Proveedor de identidad de la aplicaci√≥n".  Haga clic en "Agregar proveedor de identidad confiable" para agregar detalles sobre el inquilino de SCI. <br><br><img src="https://habrastorage.org/webt/ai/x9/yg/aix9ygszpkfu5bhbmalbvyj0hpk.png"><br><br>  En la pesta√±a "General", haga clic en "Examinar" y seleccione el archivo de metadatos en el formato "xml" descargado de la consola de administraci√≥n del servicio de autenticaci√≥n de identidad.  Los detalles de configuraci√≥n se completan autom√°ticamente despu√©s de descargar el archivo.  Desmarque la casilla "Solo para SSO iniciado por IDP" y haga clic en "Guardar". <br><br><img src="https://habrastorage.org/webt/il/ob/nw/ilobnwscixyn19_7dfsdjifo_pm.png"><br><br>  Ahora se ha establecido con √©xito la relaci√≥n de confianza entre la subcuenta del cliente ABC PetroCorp y su inquilino de SCI.  Se puede aplicar la misma configuraci√≥n a las subcuentas de otros clientes (por ejemplo, para el cliente XYZ EnergyCorp). <br><br>  <i><b>Paso 2: Importe usuarios al inquilino de SCI y actualice (agregue) los atributos necesarios</b></i> <i><b><br></b></i> <br>  Emily necesita asegurarse de que los usuarios de la aplicaci√≥n est√©n registrados con el IDP corporativo de ABC PetroCorp. <br><br>  Idealmente, un IDP corporativo (en nuestro caso, un inquilino de SCI) ya incluir√≠a una lista de todos los usuarios de la empresa.  Para mayor claridad, importamos algunos usuarios al inquilino de SCI, despu√©s de lo cual recibir√°n los permisos adecuados para acceder a la aplicaci√≥n. <br>  Las demostraciones para la aplicaci√≥n se almacenan en un archivo "csv" en github, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en Github</a> . <br><br>  Descargue el archivo "CSV" para "ABC PetroCorp" de GitHub.  Se indican dos usuarios en el archivo "csv": <br><br><ul><li>  ABCPlantSupervisor: este usuario ser√° el gerente de una planta espec√≠fica de ABC PetroCorp y solo podr√° ver datos sobre su planta; </li><li>  ABCAreaManager: este usuario ser√° el administrador de un √°rea completa, que puede incluir varias plantas de ABC PetroCorp.  Podr√° ver datos de todas las plantas en su √°rea. </li></ul><br><img src="https://habrastorage.org/webt/1g/jj/kg/1gjjkg_amk9yp8nu-ht9j8ju5yg.png"><br><br>  El archivo .csv para ABC PetroCorp contiene direcciones de correo electr√≥nico de usuario ficticias.  Deben ser reemplazados por otros reales, ya que entonces recibir√°n cartas para activar las cuentas.  Por ejemplo, si su correo real es "john.smith@sap.com", debe reemplazar la designaci√≥n &lt;&gt; con "john.smith" y &lt;&lt;inserci√≥n_su_empresa&gt;&gt; con "savia". <br><br><img src="https://habrastorage.org/webt/-g/z_/jt/-gz_jtxt7lwrrhkqrsrxggowp6s.png"><br><br>  Vaya a la consola de administraci√≥n del servicio de autenticaci√≥n de identidad y seleccione la pesta√±a "Usuarios y autorizaciones" -&gt; "Importar usuarios".  Seleccione el punto de aplicaci√≥n "ABC_PetroCorp_IDP" creado anteriormente y haga clic en "Examinar", luego seleccione el archivo "ABCPetroCorp.csv" que describe a nuestros usuarios de demostraci√≥n y haga clic en el bot√≥n "Importar". <br><br><img src="https://habrastorage.org/webt/ah/dv/k2/ahdvk2otnkhjwdfueyubevzd0vk.png"><br><br>  Los usuarios deben activar su cuenta.  Para recibir un correo electr√≥nico con un enlace de activaci√≥n, debe hacer clic en "Enviar" en la ventana "Enviar correos electr√≥nicos". <br><br>  Antes de activar al usuario, debe cambiar algunas configuraciones. <br>  Vaya a la pesta√±a "Usuarios y autorizaciones" -&gt; "Gesti√≥n de usuarios".  Dos usuarios aparecieron en las listas de usuarios: "Area Manager" y "Plant Supervisor".  Se les asignan identificadores autom√°ticamente: P000011 y P000010.  Estos identificadores se pueden usar como inicios de sesi√≥n para ingresar al inquilino (y en la aplicaci√≥n, cuando se realizan todas las configuraciones necesarias). <br><br><img src="https://habrastorage.org/webt/kr/5n/ns/kr5nnsayi-h_uzenvlbkvzvttds.png"><br><br>  Vayamos al usuario P000011 o "Administrador de √°rea" y agreguemos un nombre que tambi√©n se pueda usar como inicio de sesi√≥n para ingresar.  Para hacer esto, haga clic en el icono de edici√≥n en el campo "Informaci√≥n personal" y complete el "Nombre de inicio de sesi√≥n" (en nuestro caso, es Johan). <br><br><img src="https://habrastorage.org/webt/cr/qa/vg/crqavg4m8ids9ec4eqifslnuwu0.png"><br><br>  Luego haga clic en "Guardar". <br><br>  Ahora, hagamos lo mismo con el usuario P000010 o el Supervisor de planta, pero ll√°melo Smith. <br><br><img src="https://habrastorage.org/webt/8-/yr/-k/8-yr-klcft-lnsvvfxtg_gyphfc.png"><br><br>  El usuario del Supervisor de planta debe poder ver informaci√≥n solo sobre su planta, luego en la secci√≥n con informaci√≥n sobre la compa√±√≠a es necesario indicar el identificador de la compa√±√≠a (en el Paso 4 se explicar√° c√≥mo se usar√° este identificador). <br><br>  Para hacer esto, vaya a la secci√≥n "Informaci√≥n de la compa√±√≠a" e ingrese el identificador de la planta, a saber, "101", en el campo "Compa√±√≠a". <br><br>  Ahora la informaci√≥n sobre nuestros usuarios ha cambiado.  Para activarlos, vaya a los buzones de correo especificados en el archivo "csv" y haga clic en el enlace de activaci√≥n, o haga clic en "Haga clic aqu√≠ para activar su cuenta". <br><br><img src="https://habrastorage.org/webt/us/nr/jr/usnrjrph5ur5oawb8yamdoir3zg.png"><br><br>  Por lo tanto, hemos importado con √©xito usuarios al inquilino de SCI, hemos actualizado la informaci√≥n sobre ellos y los hemos activado. <br><br>  <b><i>Paso 3: asignaci√≥n de roles a usuarios a nivel de aplicaci√≥n en la plataforma SAP Cloud</i></b> <b><i><br></i></b> <br>  La aplicaci√≥n de Monitoreo de la contaminaci√≥n de m√∫ltiples inquilinos, creada por Robert de ITeLO Consulting, proporciona dos roles predefinidos, PlantSupervisor y AreaManager, que controlan la autorizaci√≥n del usuario en la aplicaci√≥n y determinan lo que ve el usuario final. <br><br><ul><li>  Funci√≥n Supervisor de PlantSupervisor: los usuarios a los que se les asigna esta funci√≥n solo podr√°n ver los datos de la planta identificados en la Informaci√≥n de la empresa en el inquilino de SCI. </li><li>  Rol "AreaManager": los usuarios a los que se les asigna este rol podr√°n ver datos de todas las plantas en su √°rea. </li></ul><br>  Veamos c√≥mo se logra la separaci√≥n de roles a nivel de c√≥digo del proyecto. <br><br>  Pasemos al archivo web.xml ubicado a lo largo de la ruta / control de la contaminaci√≥n <br>  /src/main/webapp/WEB-INF/web.xml "en la carpeta del proyecto. <br><br>  Abra el archivo y aseg√∫rese de que los dos roles anteriores est√©n definidos en la aplicaci√≥n. <br><br><img src="https://habrastorage.org/webt/vm/jy/4r/vmjy4ruivum6qlp-a2kw-6nsar4.png"><br><br>  Ahora vamos al archivo "PollutionDataService.java" ubicado a lo largo de la ruta "/pollutionmonitoring/src/main/java/com/sap/hana/cloud/samples/pollutionmonitoring/api/PollutionDataService.java" del proyecto y √°bralo. <br><br>  El m√©todo "getCompanyPollutionData ()" se indica en este archivo.  Le permite verificar si el usuario es un administrador (administrador).  En caso afirmativo, la aplicaci√≥n muestra datos para todas las plantas, de lo contrario, los datos se filtran por la ID de la planta (plant_id).  Adem√°s, la aplicaci√≥n mostrar√° informaci√≥n solo para aquellas plantas cuyos identificadores corresponden a los indicados en la informaci√≥n del usuario. <br><br><img src="https://habrastorage.org/webt/wb/nr/-1/wbnr-1xbi_tiqah2efsv4444tn4.png"><br><br>  Para mayor claridad, puede consultar el m√©todo isUserAdmin (), que le permite determinar por rol si un usuario es un administrador (administrador) o no. <br><br><img src="https://habrastorage.org/webt/hg/az/25/hgaz25dqc9shpbzdjr8szqb81dc.png"><br><br>  Se utiliza un algoritmo similar para extraer datos de la planta de los sistemas locales. <br><br><img src="https://habrastorage.org/webt/im/ds/qa/imdsqalrzqvuubw7e9lx1ppwgo0.png"><br><br>  Ahora Emily, como empleada de ABC PetroCorp, necesita identificar gerentes de √°rea y gerentes de planta asign√°ndoles los roles correspondientes (ABCPlantSupervisor y ABCAreaManager) en la aplicaci√≥n en SCP. <br><br>  Iremos a la subcuenta del cliente ABC PetroCorp y seleccionaremos la aplicaci√≥n Java de monitoreo de contaminaci√≥n provista por el proveedor de ITeLO Consulting (se encuentra en la pesta√±a Aplicaciones -&gt; pesta√±a Suscripciones). <br><br><img src="https://habrastorage.org/webt/py/ql/b_/pyqlb_s5jxwjw3amjgu3z2lzcus.png"><br><br>  A continuaci√≥n, vaya a la pesta√±a "Roles" (en el nivel de aplicaci√≥n). <br><br>  En la ventana que se abre, aparece una lista de roles indicados en la aplicaci√≥n.  Seleccione el rol "PlantSupervisor" y haga clic en "Asignar".  En la ventana que aparece, ingrese la ID de usuario, indicada en el inquilino de SCI como "ABCPlantSupervisor".  En nuestro caso, el identificador de dicho usuario ser√° P000010. <br><br>  Luego seleccione el rol "AreaManager" y haga clic en "Asignar".  En la ventana que aparece, ingrese el identificador de usuario indicado en el inquilino de SCI como "ABCAreaManager" (en nuestro caso, el identificador de dicho usuario ser√° P000011). <br><br><img src="https://habrastorage.org/webt/pw/k2/qr/pwk2qre0nnl8iyytqg8szu9wwhc.png"><br><br>  Por lo tanto, hemos comparado con √©xito los roles de la aplicaci√≥n con los usuarios correspondientes de ABC PetroCorp del inquilino de SCI. <br><br>  La misma configuraci√≥n se puede aplicar en la subcuenta de otro cliente (por ejemplo, "XYZ EnergyCorp"). <br><br>  <i><b>Paso 4: Configuraci√≥n de atributos en el Panel de control de inquilino SCI y SCP para transferir a la aplicaci√≥n</b></i> <i><b><br></b></i> <br>  Robert de ITeLO Consulting program√≥ la aplicaci√≥n multiinquilino de tal manera que necesita pasar la identificaci√≥n de usuario de PlantSupervisor a la planta para que los datos de la planta se puedan filtrar en la aplicaci√≥n para esta identificaci√≥n de planta espec√≠fica. <br>  En los pasos anteriores, agregamos el identificador de planta al usuario "PlantSupervisor" en el inquilino de SCI en el campo "Informaci√≥n de la empresa", que ahora tenemos que transferir a la aplicaci√≥n multicliente.  Luego se puede usar en una aplicaci√≥n para mostrar datos relacionados con una planta en particular.  El usuario de AreaManager es esencialmente un administrador que puede ver los datos de todas las plantas. <br><br>  Veamos c√≥mo se organiza esto a nivel de c√≥digo de aplicaci√≥n. <br><br>  Abra el archivo "PollutionDataService.java" ubicado en la ruta "/pollutionmonitoring/src/main/java/com/sap/hana/cloud/samples/pollutionmonitoring/api/PollutionDataService.java" en el proyecto. <br><br>  Este archivo describe el m√©todo getPlantId ().  Este m√©todo describe c√≥mo obtener el nombre de usuario y verificar el atributo "PLANT_ID", que se utiliza para filtrar datos de contaminaci√≥n y datos de la planta. <br><br><img src="https://habrastorage.org/webt/oo/5k/8f/oo5k8fcedmqrdjgd1qc3b1jink8.png"><br><br>  Podemos transferir atributos de usuario del inquilino de SCI a la aplicaci√≥n a trav√©s de los Atributos de aserci√≥n de SAML.  Esto es necesario para que SCP lea el atributo de usuario del inquilino de SCI que contiene informaci√≥n de la compa√±√≠a en el momento en que el usuario inicia sesi√≥n.  El llamado "Atributo de Afirmaci√≥n" (atributo de aprobaci√≥n) definido para el usuario debe transferirse a la aplicaci√≥n de monitoreo de contaminaci√≥n. <br><br>  Para hacer esto, primero cree un "Atributo de aserci√≥n" en el inquilino de SCI, luego - designe el atributo de aprobaci√≥n en el atributo principal ("Atributo principal") en la subcuenta "ABC PetroCorp", que puede leerse mediante el c√≥digo de la aplicaci√≥n, como se muestra arriba. <br><br>  Vaya a la consola de administraci√≥n del servicio de autenticaci√≥n de identidad y seleccione la pesta√±a "Aplicaciones y recursos" -&gt; "Aplicaciones".  Seleccione la aplicaci√≥n que necesitamos (ABC_PetroCorp_IDP) y en la pesta√±a "Confianza", haga clic en "Atributos de aserci√≥n". <br><br><img src="https://habrastorage.org/webt/aj/vx/a1/ajvxa1wkg_edv7_a4s8peeug_ge.png"><br><br>  Aparecer√° una lista de atributos existentes, necesitamos uno m√°s en ella.  Para hacer esto, haga clic en el bot√≥n "Agregar" y seleccione el atributo "Compa√±√≠a". <br><br>  Luego agregamos "plant_id" (distingue entre may√∫sculas y min√∫sculas) al valor del atributo y hacemos clic en "Guardar". <br><br><img src="https://habrastorage.org/webt/gq/_0/g7/gq_0g7ulur1s6brsmvessvvt-2e.png"><br><br>  Ahora vaya a la subcuenta "ABC PetroCorp" en SCP y vaya a la pesta√±a "Seguridad" -&gt; "Confianza".  En la ventana "Gesti√≥n de confianza", vaya a la pesta√±a "Proveedor de identidad de la aplicaci√≥n" y seleccione el IdP asociado con la subcuenta. <br><br><img src="https://habrastorage.org/webt/wd/bo/x8/wdbox8lmoxamqgwybxzrsugpmru.png"><br><br>  En la ventana que se abre, vaya a la pesta√±a "Atributos" y haga clic en "Agregar atributo basado en aserciones".  En el campo "Atributo de aserci√≥n" ingresamos el valor "plant_id" (como en el inquilino de SCI), y en el campo "Atributo principal" ingresamos "PLANT_ID" (este valor se transferir√° a la aplicaci√≥n como el c√≥digo de la planta) - y haga clic en "Guardar". <br><br>  Por lo tanto, hemos configurado con √©xito los atributos en el inquilino de SCI y en el panel de control de SCP para transferirlos a la aplicaci√≥n. <br><br>  <b><i>Paso 5: Verifique la configuraci√≥n</i></b> <b><i><br></i></b>  Emily ahora puede verificar que la configuraci√≥n del inquilino de SCI (IdP) est√© correctamente definida para la subcuenta "ABC PetroCorp" en SCP y para la aplicaci√≥n que proporciona el proveedor. <br><br>  Para hacerlo, vaya a la subcuenta "ABC PetroCorp" y dir√≠jase a la aplicaci√≥n HTML5 "contaminaci√≥nmonitoringui" (se encuentra en la pesta√±a "Aplicaciones" -&gt; "Suscripciones"). <br><br><img src="https://habrastorage.org/webt/ys/6l/bb/ys6lbbnjrqqh1tnwwsfufr_tmpe.png"><br><br>  Copie el enlace a la aplicaci√≥n.  Abra una nueva pesta√±a en el navegador en modo inc√≥gnito e inserte un enlace a la aplicaci√≥n HTML5.  Aparecer√° una ventana para ingresar a la aplicaci√≥n, donde se mostrar√° el nombre indicado en el inquilino de SCI. <br><br>  Si todo est√° configurado correctamente, entonces deber√≠a poder ingresar a la aplicaci√≥n bajo los usuarios de "AreaManager" y "PlantSupervisor", indicados en el inquilino de SCI. <br><br>  En nuestro caso, el gerente de la regi√≥n es el usuario Johan (P000011), y el jefe de la planta es Smith (P000010).  Puede ingresar a la aplicaci√≥n con estos usuarios utilizando el nombre de usuario o su identificador como inicio de sesi√≥n. <br><br>  <i>Nota: al ingresar a la aplicaci√≥n en esta etapa, no se mostrar√°n datos.</i>  <i>Esto es normal porque la configuraci√≥n a√∫n no est√° completa y el sistema local no est√° conectado.</i> <i><br></i> <br><br>  Por lo tanto, hemos configurado una conexi√≥n de proveedor de identidad (IDP) con nuestra aplicaci√≥n de monitoreo de contaminaci√≥n SCP.  Tambi√©n importamos usuarios y les asignamos los roles correctos para acceder a la aplicaci√≥n, nos aseguramos de que la informaci√≥n correcta de la planta se transfiriera a la aplicaci√≥n. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418237/">https://habr.com/ru/post/es418237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418225/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 7: Sandbox de Native Client Parte 2</a></li>
<li><a href="../es418227/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 7: El sandbox del cliente nativo, parte 3</a></li>
<li><a href="../es418229/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 8: Modelo de seguridad de red, parte 1</a></li>
<li><a href="../es418233/index.html">BMW mnemotecnia para encontrar valores l√≠mite</a></li>
<li><a href="../es418235/index.html">Saga orquestada o c√≥mo construir transacciones comerciales en servicios con la base de datos por patr√≥n de servicio</a></li>
<li><a href="../es418239/index.html">48 megap√≠xeles para tel√©fono inteligente</a></li>
<li><a href="../es418241/index.html">¬øPor qu√© gauss? (100 formas de resolver el sistema de ecuaciones)</a></li>
<li><a href="../es418243/index.html">La historia popular de la astronom√≠a est√° equivocada</a></li>
<li><a href="../es418245/index.html">C√≥mo no desarrollar un proyecto en Bitrix</a></li>
<li><a href="../es418247/index.html">Acelere la multiplicaci√≥n de matriz flotante 4x4 con SIMD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>