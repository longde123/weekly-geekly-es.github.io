<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🏫 👩🏿 👏 Jeu interactif sur XSLT 🥢 🛰️ 👆🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il était une fois, les gens sont venus avec le langage XML et ont vu que c'était bon. Et ils ont commencé à l'utiliser dans la mesure du possible, et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jeu interactif sur XSLT</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441478/"><img src="https://habrastorage.org/webt/dh/fa/ki/dhfaki02qcnjz62awuxjzoncne4.png" alt="image"><br><br>  Il était une fois, les gens sont venus avec le langage XML et ont vu que c'était bon.  Et ils ont commencé à l'utiliser dans la mesure du possible, et même là où cela ne devrait pas.  Formats pour le stockage et le transfert de données, les configurations, les services Web, les bases de données ... Il semblait regarder autour - XML, XML partout.  Le temps a passé, les gens ont changé d'avis, inventé divers autres formats de données (ou caché XML dans les archives), et la folie XML a semblé se calmer.  Mais depuis lors, presque tous les systèmes ont pu XML et intégrer de tels systèmes (qui a dit Apache Camel?) Est la meilleure et la plus simple utilisation des documents XML. <br><br>  Là où XML est, il y a XSLT, un langage conçu pour transformer les documents XML.  Ce langage est spécialisé, mais a la propriété d'être <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">complet selon Turing</a> .  Par conséquent, le langage convient à une utilisation "anormale".  Ici, par exemple, il existe une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">solution au problème des 8 reines</a> .  Vous pouvez donc écrire un jeu. <br><br>  Pour les impatients: un programme de travail sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JSFiddle</a> , sources sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> . <br><a name="habracut"></a><br>  Tout programme convertit l'entrée en sortie.  Trois parties peuvent être distinguées dans le programme: préprocesseur, processeur et postprocesseur.  Le préprocesseur prépare les données d'entrée pour un traitement ultérieur.  Le processeur est engagé dans le travail principal de conversion de données, si nécessaire, "mélange" des entrées utilisateur et des signaux et événements externes, y compris dans un cycle.  Un post-processeur est nécessaire pour convertir les résultats du processeur sous une forme adaptée à la perception humaine (ou par d'autres programmes). <br><br><img src="https://habrastorage.org/webt/_c/nr/ci/_cnrciga45icv1qpwjygfgs6vqq.png" alt="image"><br><br>  Dans le cas d'un jeu interactif sur XSLT, chacune des trois parties du programme sera un fichier XSLT distinct.  Le préprocesseur préparera le terrain de jeu.  Le processeur appliquera le mouvement du joueur humain, fera le mouvement du joueur informatique et déterminera le gagnant.  Le postprocesseur rendra l'état du jeu. <br><br>  Un programme XSLT a besoin d'un runtime.  Le runtime le plus courant capable d'exécuter XSLT est n'importe quel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">navigateur moderne</a> .  Nous utiliserons XSLT version 1.0, car il est pris en charge par les navigateurs prêts à l'emploi. <br><br><h3>  Un peu sur XSLT et XPath </h3><br>  XSLT est un langage de transformation de document XML;  XPath est utilisé pour accéder à des parties d'un document XML.  Les spécifications de ces langues sont publiées sur w3.org: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">XSLT version 1.0</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">XPath version 1.0</a> . <br><br>  Les bases et les exemples d'utilisation de XSLT et XPath sont facilement consultables sur le net.  Ici, j'attire l'attention sur les fonctionnalités qui doivent être prises en compte lorsque vous essayez d'utiliser XSLT comme langage de programmation de haut niveau à usage général "normal". <br><br>  XSLT a nommé des fonctions.  Ils sont déclarés élément. <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"function_name"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  et sont appelés de cette façon: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"function_name"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  Les fonctions peuvent avoir des paramètres. <br><br>  Annonce: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"y"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$x + $y"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Appel de fonction avec paramètres: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"y"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Les paramètres peuvent avoir des valeurs par défaut. <br><br>  Les paramètres peuvent être «globaux» venant de l'extérieur.  En utilisant ces paramètres, l'entrée utilisateur sera transférée au programme. <br><br>  Le langage vous permet également de déclarer des variables pouvant être associées à une valeur.  Les paramètres et les variables sont immuables et des valeurs peuvent leur être attribuées une fois (comme dans Erlang, par exemple). <br><br>  XPath définit quatre types de données de base: chaîne, nombre, booléen et ensemble de nœuds.  XSLT ajoute un cinquième type - un fragment d'arbre de résultat.  Ce fragment ressemble à un ensemble de nœuds, mais avec lui, vous pouvez effectuer un ensemble limité d'opérations.  Il peut être entièrement copié dans le document de sortie XML, mais vous ne pouvez pas accéder aux nœuds enfants. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"board"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:variable</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  La variable board contient un fragment du document XML.  Mais les nœuds enfants ne sont pas accessibles.  Ce code n'est pas valide: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$board/cell"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  Le mieux que vous puissiez obtenir est d'accéder aux nœuds de texte du fragment et de les utiliser comme une chaîne: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(string($board), 2, 1)"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  renverra "2". <br><br>  Pour cette raison, dans notre jeu, le plateau (ou terrain de jeu) sera présenté comme une chaîne afin qu'il puisse être manipulé arbitrairement. <br><br>  XSLT vous permet d'itérer un ensemble de nœuds à l'aide de la construction xsl: for-each.  Mais la langue n'a pas les boucles for ou while habituelles.  À la place, vous pouvez utiliser un appel de fonction récursif (l'itération et la récursivité sont isomorphes).  Une boucle du formulaire pour x dans a..b sera organisée comme ceci: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"for_loop"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$a"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"to"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$b"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"for_loop"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"to"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:if</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$x &lt; $to"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  -  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"for_loop"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"x"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$x + 1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"to"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$to"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:call-template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:if</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3>  Écrire un runtime </h3><br>  Pour que le programme fonctionne, vous avez besoin de: 3 XSLT, XML source, entrée utilisateur (paramètres), XML état interne et XML de sortie. <br><br>  Nous plaçons des champs de texte avec des identificateurs dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fichier html</a> : "preprocessor-xslt", "processor-xslt", "postprocessor-xslt", "input-xml", "parameters", "output-xml", "postprocessed-xml".  Nous plaçons également /&gt; pour intégrer le résultat dans la page (pour la visualisation). <br><br>  Ajoutez deux boutons: initialisation et appel (étape) du processeur. <br><br>  Écrivons du code JavaScript. <br><br><div class="spoiler">  <b class="spoiler_title">Une caractéristique clé est l'utilisation de la transformation XSLT.</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transform</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">xslt, xml, params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> processor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XSLTProcessor(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOMParser(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xsltDom = parser.parseFromString(xslt, <span class="hljs-string"><span class="hljs-string">"application/xml"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> check errors .documentElement.nodeName == "parsererror" var xmlDom = parser.parseFromString(xml, "application/xml"); processor.importStylesheet(xsltDom); if (typeof params !== 'undefined') { params.forEach(function(value, key) { processor.setParameter("", key, value); }); } var result = processor.transformToDocument(xmlDom); var serializer = new XMLSerializer(); return serializer.serializeToString(result); }</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Fonctions d'exécution du préprocesseur, du processeur et du postprocesseur:</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doPreprocessing</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xslt = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"preprocessor-xslt"</span></span>).value; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xml = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"input-xml"</span></span>).value; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = transform(xslt, xml); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"output-xml"</span></span>).value = result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doProcessing</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> params = parseParams(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"parameters"</span></span>).value); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xslt = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"processor-xslt"</span></span>).value; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xml = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"output-xml"</span></span>).value; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = transform(xslt, xml, params); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"output-xml"</span></span>).value = result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doPostprocessing</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xslt = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"postprocessor-xslt"</span></span>).value; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xml = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"output-xml"</span></span>).value; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = transform(xslt, xml); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"postprocessed-xml"</span></span>).value = result; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"output"</span></span>).innerHTML = result; }</code> </pre> <br></div></div><br>  La fonction d'assistance parseParams () analyse l'entrée utilisateur en paires clé = valeur. <br><br><div class="spoiler">  <b class="spoiler_title">Le bouton d'initialisation appelle</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onInit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ doPreprocessing(); doPostprocessing(); }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Bouton de démarrage du processeur</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStep</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ doProcessing(); doPostprocessing(); }</code> </pre> <br></div></div><br>  Le runtime de base est prêt. <br><br>  Comment l'utiliser.  Insérez trois documents XSLT dans les champs appropriés.  Insérer un document d'entrée XML.  Appuyez sur le bouton "Init".  Si nécessaire, saisissez les valeurs requises dans le champ des paramètres.  Cliquez sur le bouton Étape. <br><br><h3>  Écrire un jeu </h3><br>  Si quelqu'un d'autre n'a pas deviné, le jeu interactif du titre est le classique 3 par 3 tic-tac-toe. <br><br>  Le terrain de jeu est un tableau de 3 par 3, dont les cellules sont numérotées de 1 à 9. <br>  Le joueur humain traverse toujours (le symbole "X"), l'ordinateur - des zéros ("O").  Si la cellule est occupée par une croix ou un zéro, le chiffre correspondant est remplacé par le symbole «X» ou «O». <br><br>  L'état du jeu est contenu dans un document XML de cette forme: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">game</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">board</span></span></span><span class="hljs-tag">&gt;</span></span>123456789<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">board</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">state</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beginner</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beginner</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">message</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">message</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">game</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  L'élément &lt;board /&gt; contient le terrain de jeu;  &lt;état /&gt; - l'état du jeu (gagner un des joueurs ou un match nul ou une erreur);  l'élément &lt;débutant /&gt; est utilisé pour déterminer qui a commencé la partie en cours (afin qu'un autre joueur commence la partie suivante);  &lt;message /&gt; - message pour le joueur. <br><br>  <a href="">Le préprocesseur</a> génère un état initial (champ vide) à partir d'un document XML arbitraire. <br><br>  <a href="">Le processeur</a> valide l'entrée utilisateur, applique son mouvement, calcule l'état du jeu, calcule et applique le mouvement de l'ordinateur. <br><br><div class="spoiler">  <b class="spoiler_title">Sur le pseudo code, cela ressemble à ceci</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">fn do_move() { let board_after_human_move = apply_move(board, "X", param) let state_after_human_move = get_board_state(board_after_human_move) if state_after_human_move = "" { let board_after_computer_move = make_computer_move(board_after_human_move) let state_after_computer_move = get_board_state(board_after_computer_move) return (board_after_computer_move, state_after_computer_move) } else { return (board_after_human_move, state_after_human_move) } } fn apply_move(board, player, index) { //     board    index   player     } fn get_board_state(board) { //   "X",   , "O",   , "tie"          } fn make_computer_move(board) { let position = get_the_best_move(board) return apply_move(board, "O", position) } fn get_the_best_move(board) { return get_the_best_move_loop(board, 1, 1, -1000) } fn get_the_best_move_loop(board, index, position, score) { if index &gt; 9 { return position } else if cell_is_free(board, index) { let new_board = apply_move(board, "O", index) let new_score = minimax(new_board, "X", 0) if score &lt; new_score { return get_the_best_move_loop(board, index + 1, index, new_score) } else { return get_the_best_move_loop(board, index + 1, position, score) } } else { return get_the_best_move_loop(board, index + 1, position, score) } } fn cell_is_free(board, index) { //   true,    board   index   ( ) } fn minimax(board, player, depth) { let state = get_board_state(board) if state = "X" { //   return -10 + depth } else if state = "O" { //   return 10 - depth } else if state = "tie" { //  return 0 } else { let score = if player = "X" { 1000 } else { -1000 } return minimax_loop(board, player, depth, 1, score) } } fn minimax_loop(board, player, depth, index, score) { if index &gt; 9 { return score } else if cell_is_free(board, index) { //   ,    let new_board = apply_move(board, player, index) let new_score = minimax(new_board, switch_player(player), depth + 1) let the_best_score = if player = "X" { //    if new_score &lt; score { new_score } else { score } } else { //    if new_score &gt; score { new_score } else { score } } return minimax_loop(board, player, depth, index + 1, the_best_score) } else { //      return minimax_loop(board, player, depth, index + 1, score) } } fn switch_player(player) { //   ; X -&gt; O, O -&gt; X }</code> </pre><br></div></div><br>  La fonction de sélection de déplacement de l'ordinateur utilise l'algorithme minimax, où l'ordinateur maximise son score et la personne le minimise.  Le paramètre de profondeur de la fonction minimax est nécessaire pour sélectionner un coup qui mène à la victoire dans le moins de coups. <br><br>  Cet algorithme utilise un grand nombre d'appels récursifs et le premier mouvement de l'ordinateur est calculé sur ma machine jusqu'à 2-3 secondes.  Nous devons en quelque sorte accélérer.  Vous pouvez simplement prendre et pré-calculer les meilleurs mouvements de l'ordinateur pour toutes les conditions de terrain de jeu acceptables possibles.  De tels états se sont avérés être 886. Il est possible de réduire ce nombre en raison des rotations et des réflexions du champ, mais ce n'est pas nécessaire.  <a href="">La nouvelle version</a> est rapide. <br><br>  Il est temps d'afficher magnifiquement le terrain de jeu.  Que faut-il utiliser si c'est quelque chose a) devrait dessiner des graphiques (21e siècle dans la cour, quel genre de jeu sans graphiques?!) Et b) il est souhaitable d'avoir un format XML?  Bien sûr, SVG! <br><br>  <a href="">Le post-processeur</a> dessine un champ à carreaux et y organise des croix vertes, des zéros bleus et de petites <s>robes</s> noires.  Il affiche également des messages sur la fin du jeu. <br><br>  Et maintenant, c'est comme si le jeu était prêt.  Mais quelque chose ne va pas.  Pour jouer, vous devez faire beaucoup d'actions inutiles, ennuyeuses et ennuyeuses: entrez le numéro de cellule dans le champ pour le code suivant et appuyez sur le bouton.  Cliquez simplement sur la cellule souhaitée! <br><br>  Nous finalisons le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">runtime</a> et le <a href="">postprocesseur</a> . <br><br>  En runtime, ajoutez la fonction de réponse en cliquant sur l'élément SVG: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSvgClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"parameters"</span></span>).value = arg; onStep(); }</code> </pre> <br>  Dans le postprocesseur, nous ajoutons un carré au-dessus de chaque cellule (la transparence est spécifiée par le style rect.btn), lorsque vous cliquez dessus, une fonction avec le numéro de cellule est appelée: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rect</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-23"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"45"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"45"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onSvgClick({$index})"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  Une fois le lot terminé, un clic sur n'importe quelle cellule en démarre une nouvelle.  Le bouton «Init» ne doit être pressé qu'une seule fois au tout début. <br><br>  Vous pouvez maintenant considérer le jeu comme terminé.  La chose est petite: cachez l'intérieur, emballez-le dans une application électronique, mettez-le sur Steam, ???, réveillez-vous riche et célèbre. <br><br><h3>  Conclusion </h3><br>  Un programmeur avisé peut tout écrire sur n'importe quoi, <s>même en JavaScript</s> .  Mais il vaut mieux utiliser un outil adapté à chaque tâche. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr441478/">https://habr.com/ru/post/fr441478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr441458/index.html">Bras et manipulateurs mécanisés - dites-vous ce que fait le laboratoire de robotique de l'Université ITMO</a></li>
<li><a href="../fr441460/index.html">Et comment voyez-vous l'éducation informatique?</a></li>
<li><a href="../fr441468/index.html">Facebook fermera son logiciel espion VPN Onavo</a></li>
<li><a href="../fr441472/index.html">Un réseau de neurones a appris à dessiner les détails manquants sur la photo de personnes</a></li>
<li><a href="../fr441476/index.html">Création de l'éditeur JaCarta</a></li>
<li><a href="../fr441482/index.html">La nouvelle chronologie d'Iyon le Pacifique</a></li>
<li><a href="../fr441484/index.html">Les employés de Microsoft se sont opposés à l'utilisation de HoloLens dans l'armée, car la guerre se transforme en jeu informatique</a></li>
<li><a href="../fr441490/index.html">Ce qu'il faut rechercher lors du choix d'un lecteur - systèmes d'exploitation et matériel</a></li>
<li><a href="../fr441496/index.html">Son sur le fil: l'histoire du télégraphe</a></li>
<li><a href="../fr441498/index.html">Kuril en ligne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>