<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÑπÔ∏è ü•ô ü§∑üèº Profundidades SIEM: correlaciones listas para usar. Parte 2. Esquema de datos como reflejo del modelo del "mundo" üïì üåñ ‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este es el segundo art√≠culo de la serie, dedicado a la metodolog√≠a para crear reglas de correlaci√≥n listas para usar para los sistemas SIEM. En el art...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades SIEM: correlaciones listas para usar. Parte 2. Esquema de datos como reflejo del modelo del "mundo"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/424975/">  Este es el segundo art√≠culo de la serie, dedicado a la metodolog√≠a para crear reglas de correlaci√≥n listas para usar para los sistemas SIEM.  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> anterior <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">,</a> nos propusimos esta tarea, describimos las ventajas que se obtendr√°n en su implementaci√≥n y tambi√©n enumeramos los principales problemas que se interponen en nuestro camino.  En este art√≠culo, comenzaremos a buscar soluciones y comenzaremos con el problema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">transformar el modelo del "mundo"</a> , as√≠ como su manifestaci√≥n en la etapa de normalizaci√≥n de los eventos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/ty/w_/thtyw_5tngr0v1dhkcakeexhlw8.jpeg" alt="Transformaci√≥n del modelo SIEM"></div><br><a name="habracut"></a><br>  El problema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">transformar el modelo "mundial"</a> se describi√≥ en el primer art√≠culo.  Recordemos brevemente su esencia: cuando se produce un fen√≥meno en el origen de los eventos (por ejemplo, al iniciar un proceso en el sistema operativo), se repara en diferentes formatos, primero en la memoria, luego en el registro de eventos del sistema operativo y luego en el sistema SIEM.  Cada etapa del procesamiento va acompa√±ada de p√©rdida de datos, ya que a nivel del sistema operativo hay un modelo "mundial", y en el registro del sistema operativo, otro, limitado por un conjunto de campos, por el esquema de registro.  Por lo tanto, hay una reflexi√≥n (transformaci√≥n) de un modelo con un gran n√∫mero de par√°metros a otro, con un n√∫mero menor de ellos.  Normalizar y guardar un evento en SIEM es otra transformaci√≥n que tambi√©n ocurre con la p√©rdida de datos, ya que SIEM tambi√©n tiene su propio modelo "mundial". <br><br>  Es dif√≠cil encontrar una manera que permita la transformaci√≥n de un modelo en otro sin p√©rdida.  Conociendo esta limitaci√≥n, es necesario formular un enfoque de este tipo para la normalizaci√≥n y la formaci√≥n de una lista de campos del esquema de eventos, en el que la informaci√≥n no se pierda, importante en la correlaci√≥n e investigaci√≥n adicional de incidentes de seguridad de la informaci√≥n. <br><br>  Dentro del marco de SIEM, un modelo est√° representado por un esquema, un conjunto de campos en el que los datos del evento inicial se ajustan al proceso de normalizaci√≥n.  En el futuro, ser√° utilizado por especialistas en la creaci√≥n de reglas de correlaci√≥n.  Para que los investigadores de incidentes y los responsables de desarrollar reglas de correlaci√≥n interpreten sin ambig√ºedad los eventos normalizados, el esquema debe satisfacer las propiedades b√°sicas: <br><br><ul><li>  estar unificado para eventos de cualquier tipo y fuentes; </li><li>  describa claramente qui√©n interactu√≥ con qui√©n y c√≥mo; </li><li>  Mantener la esencia y el contexto de la interacci√≥n. </li></ul><br>  En el proceso de desarrollar reglas de normalizaci√≥n, la informaci√≥n sobre la interacci√≥n debe encontrarse en el evento inicial y descomponerse en campos especialmente designados.  Lo mismo debe hacerse con el contexto y la esencia de la interacci√≥n (m√°s sobre esto en el pr√≥ximo art√≠culo). <br><br>  Surge la pregunta: ¬øes posible identificar esquemas t√≠picos para interacciones que satisfagan cualquier evento creado por todas las posibles fuentes de seguridad de la informaci√≥n y TI?  Si es as√≠, ¬øc√≥mo son estos esquemas? <br><br>  Para encontrar la respuesta a estas preguntas, debe recurrir a la anal√≠tica e intentar analizar tantas reglas de normalizaci√≥n ya desarrolladas y que funcionen en las soluciones SIEM como sea posible para identificar patrones comunes.  Como parte de dicho trabajo, fue posible analizar m√°s de 3.000 reglas de normalizaci√≥n de m√°s de 100 fuentes diferentes de soluciones como Positive Technologies MaxPatrol SIEM y Micro Focus ArcSight.  El an√°lisis arroj√≥ las siguientes conclusiones: <br><br><ol><li>  Existen esquemas de interacci√≥n t√≠picos. </li><li>  En cada evento individual, como regla, hay informaci√≥n sobre la interacci√≥n a <b>nivel de red</b> y a <b>nivel de aplicaci√≥n</b> . </li><li>  Los patrones de interacci√≥n t√≠picos pueden variar en diferentes niveles, y esto debe tenerse en cuenta. </li></ol><br><a name="NetworkAppLevels"></a><br><h1>  Red y esquemas de comunicaci√≥n de capa de aplicaci√≥n </h1><br>  Describimos esquemas t√≠picos para cada nivel.  Antes de esto, debe resaltar las entidades que siempre est√°n presentes en los eventos.  Adem√°s, en base a ellos, se construir√°n esquemas de interacci√≥n.  Estos incluyen: <br><br><ul><li>  <b>Sujeto</b>  Una entidad que afecta a un objeto.  Por ejemplo, un usuario que cambia una clave de registro o un host con IP 10.0.0.1 y env√≠a un paquete a un host con IP 20.0.0.1. </li><li>  <b>Objeto</b> .  La entidad afectada por el Sujeto. </li><li>  <b>Fuente</b>  Como regla general, un host que registra la interacci√≥n del Sujeto con el Objeto y genera el evento en s√≠.  Por ejemplo, la Fuente ser√° un cortafuegos que registr√≥ la transmisi√≥n de paquetes desde el host, el Asunto con IP 10.0.0.1, al host, el Objeto con IP 20.0.0.1. </li><li>  <b>Transmisor</b>  Hay casos en que SIEM recibe eventos no directamente de la fuente, sino de un servidor intermedio a trav√©s del cual pasan estos eventos.  El ejemplo m√°s simple es un servidor syslog intermedio.  Un ejemplo es m√°s complicado: cuando el Transmisor puede ser un servidor de administraci√≥n, por ejemplo, Kaspersky Security Center.  En este caso, la Fuente es un agente espec√≠fico de Kaspersky Endpoint Security. </li></ul><br>  Sin embargo, no todas las entidades pueden representarse simult√°neamente en el evento (m√°s sobre esto m√°s adelante), por lo tanto, es importante celebrar acuerdos inicialmente, ya que en este caso se llenan los campos correspondientes del esquema.  Esto ayudar√° en el futuro a distinguir claramente entre casos en los que estos campos no se completaron debido a un error por parte de un especialista que est√° desarrollando reglas de normalizaci√≥n a partir de casos en los que el evento original realmente no conten√≠a datos sobre ninguna entidad. <br><br>  Pasemos a patrones de interacci√≥n y ejemplos de eventos.  Para mayor claridad, todos los ejemplos se dar√°n sobre la base de registros de archivos, mensajes de syslog o registros en una base de datos relacional, pero se pueden usar para otros formatos de registro, por ejemplo, binarios. <br><br><h2>  Nivel de red </h2><br>  El identificador principal para las entidades de nivel de red son las direcciones IP.  Es importante comprender que puede haber otros identificadores relacionados (direcciones MAC a nivel de canal, FQDN) a nivel de aplicaci√≥n.  Surge la pregunta: ¬øest√°n hablando de la misma entidad o diferente?  ¬øPueden estos identificadores cambiar con el tiempo con la misma entidad?  Se dedicar√° un art√≠culo separado a esto. Ahora analicemos el hecho de que el identificador principal para los modelos de interacci√≥n a nivel de red es la direcci√≥n IP. <br><br>  Por lo tanto, los esquemas de interacci√≥n t√≠picos de este nivel se pueden dividir en dos clases: b√°sica y degenerada. <br><br><h3>  Esquemas b√°sicos de interacci√≥n </h3><br><a name="Schema1"></a><br><img src="https://habrastorage.org/webt/-s/nl/ii/-snliisaaef13_b5_bvrawyycxi.png" height="262"><br>  <i>Esquema 1. Esquema de interacci√≥n completo</i> <br><br>  Dentro del marco de este modelo, en el evento recibido en la entrada SIEM, se pueden distinguir todas las entidades principales: Sujeto, Objeto, Fuente, Transmisor.  En el esquema de interacci√≥n, el Sujeto act√∫a sobre el Objeto.  Este efecto registra (observa) el origen y genera un evento.  El evento desde la Fuente ingresa al Transmisor y desde √©l ingresa al SIEM. <br><br>  El evento a continuaci√≥n captura la resoluci√≥n de la interacci√≥n de red entre los hosts mediante el firewall de Stonesoft (ahora Forcepoint), mientras que el evento en s√≠ no ingresa a SIEM directamente, sino desde un servidor syslog intermedio. <br><br><img src="https://habrastorage.org/webt/rr/99/hk/rr99hkccik_qrx1gqndn6dub870.png"><br><br>  Aqu√≠: <br>  <b>40.0.0.1</b> - Transmisor (servidor syslog intermedio), <br>  <b>30.0.0.1</b> - Fuente (nodo de firewall), <br>  <b>10.0.0.1</b> - Asunto (env√≠o de paquetes UDP), <br>  <b>20.0.0.1</b> - Un objeto (que recibe paquetes UDP). <br><br><img src="https://habrastorage.org/webt/mm/tv/3d/mmtv3d2b7w5gan5mcmxzuvsyyaa.png"><br>  <i>Diagrama 2: Diagrama de recolecci√≥n directa sin transmisor</i> <br><br>  No siempre en el esquema de interacci√≥n hay un transmisor.  Como regla, est√° presente cuando se utiliza un servidor intermedio (por ejemplo, un servidor syslog) para transmitir eventos, o cuando la soluci√≥n de la que se recopilan los eventos tiene un sistema de administraci√≥n centralizado, por ejemplo, Kaspersky Security Center, Check Point Smart Console o Cisco Prime.  Bajo este esquema, los eventos caen en SIEM directamente desde la Fuente.  La mayor√≠a de todos los eventos se describen mediante este esquema particular.  Por cierto, un ejemplo de tal evento se puede ver en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Figura 1</a> , si no hab√≠a un servidor syslog intermedio y recibimos eventos directamente desde el firewall. <br><br><img src="https://habrastorage.org/webt/gu/vp/aw/guvpawlp6njgeswk6dukx9cf5io.png"><br><br>  Aqu√≠: <br>  <b>30.0.0.1</b> - Fuente (nodo de firewall), <br>  <b>10.0.0.1</b> - Asunto (env√≠o de paquetes UDP), <br>  <b>20.0.0.1</b> - Un objeto (que recibe paquetes UDP). <br><br><img src="https://habrastorage.org/webt/b8/0s/m2/b80sm2hvahlh46ih3ylmb8tut9w.png"><br>  <i>Esquema 3. Interacci√≥n con muchos objetos.</i> <br><br>  Este esquema de interacci√≥n a nivel de red es bastante raro y, como regla, es t√≠pico para eventos de equipos de red.  En el esquema, un Sujeto interact√∫a con muchos Objetos, una interacci√≥n similar est√° presente en eventos que describen transmisiones multicast, unicast o broadcast. <br><br>  Tenga en cuenta que a veces muchos objetos pueden estar unidos por un identificador com√∫n: una direcci√≥n de subred o una direcci√≥n de difusi√≥n.  Esto debe recordarse, ya que al analizar eventos, incluso a nivel de reglas de correlaci√≥n, puede omitir f√°cilmente la interacci√≥n potencialmente importante, ya que en dicho esquema la direcci√≥n del Objeto se oculta detr√°s de la direcci√≥n del grupo. <br><br>  El siguiente ejemplo muestra un evento desde un servidor de retransmisi√≥n IGMP a trav√©s del cual se transmite una solicitud de membres√≠a de multidifusi√≥n. <br><br><img src="https://habrastorage.org/webt/i7/zj/yk/i7zjykhwdwtzkocjqqaexwiiey0.png"><br><br>  Aqu√≠: <br>  <b>30.0.0.1</b> - Fuente (servidor de retransmisi√≥n IGMP), <br>  <b>10.0.0.1</b> - Asunto (solicitud de membres√≠a en un grupo), <br>  <b>224.0.0.252</b> : el objeto (direcci√≥n de multidifusi√≥n). <br><br><h3>  Esquemas degenerados </h3><br>  Sujeto, Objeto y Fuente son las entidades b√°sicas en el grupo de esquemas de interacci√≥n b√°sicos.  Sin embargo, hay casos en que una de las entidades puede estar ausente en el evento. <br><br><img src="https://habrastorage.org/webt/e8/h_/z4/e8h_z4bo7ixafd2vytv7y-gxuqa.png"><br>  <i>Esquema 4. Interacci√≥n sin un objeto</i> <br><br>  A menudo, este patr√≥n es t√≠pico en situaciones en las que el Sujeto informa un cambio en su estado interno, es decir, act√∫a simult√°neamente en el papel del Sujeto y el Objeto.  Por ejemplo, esta interacci√≥n se puede observar en cambios de configuraci√≥n o eventos de detecci√≥n de malware en la estaci√≥n de trabajo.  Pero esta informaci√≥n no es registrada por el propio sujeto, sino por un sistema de gesti√≥n centralizado y almacenado en su diario. <br><br>  El ejemplo muestra c√≥mo Symantec Management Server captura que el agente de Symantec Endpoint Protection que administra ha detectado un archivo malicioso en su host. <br><br><img src="https://habrastorage.org/webt/uc/8i/tk/uc8itkdycqecus0f5xb2zhxlbgi.png"><br><br>  Aqu√≠: <br>  <b>30.0.0.1</b> - Fuente (Symantec Management Server), <br>  <b>10.0.0.1</b> - Asunto (Agente de Symantec Endpoint Protection). <br><br><img src="https://habrastorage.org/webt/qq/wg/ao/qqwgaoqcw7dwndbgulrzbdimunm.png"><br>  <i>Esquema 5. Combinando el papel del Sujeto y el Objeto en la Fuente</i> <br><br>  El √∫ltimo esquema de interacci√≥n degenerada es t√≠pico para una situaci√≥n en la que SIEM recibe eventos de una Fuente que informa un cambio en su estado interno: por ejemplo, reconfigurar un dispositivo o software, habilitar o deshabilitar un puerto de red.  En tal esquema, el rol de la Fuente coincide con el rol del Sujeto y el Objeto.  A diferencia del esquema anterior, aqu√≠ los eventos en SIEM vienen directamente. <br><br>  En este ejemplo, un conmutador basado en Cisco IOS informa que su interfaz ha pasado al estado UP. <br><br><img src="https://habrastorage.org/webt/in/ap/cd/inapcd3rbeuutgbgivcfmt-ujmq.png"><br><br>  Aqu√≠ <b>30.0.0.1</b> es la fuente (interruptor). <br><br><h2>  Nivel de aplicaci√≥n </h2><br>  En este nivel, hay interacciones de entidades ya conocidas: Sujeto, Objeto.  Sin embargo, toda la informaci√≥n sobre la Fuente y el Transmisor permanece directamente en el nivel de la red y no se refleja en el nivel de la aplicaci√≥n. <br><br>  La mayor√≠a de todos los tipos de eventos incorporan interacciones simult√°neamente a nivel de red y de aplicaci√≥n.  Sin embargo, observamos que los eventos generados directamente por el software de la aplicaci√≥n, por ejemplo, 1C: Enterprise, Microsoft SQL Server u Oracle Database, pueden contener exclusivamente interacciones a nivel de aplicaci√≥n. <br><br>  Adem√°s, aparece una entidad de <b>Recursos</b> adicional en el nivel de aplicaci√≥n. <br><br>  <b>Un recurso</b> es una entidad intermedia a trav√©s de la cual el Sujeto ejerce influencia sobre el Objeto sin interacci√≥n directa.  Por ejemplo, otorgarle a Alex los derechos para acceder a MyFile a Bob.  Aqu√≠ Alex es el sujeto, Bob es el objeto, MyFile es el recurso.  Tenga en cuenta que en este ejemplo, Alex no interact√∫a directamente con Bob. <br><br>  <i>Importante</i> : los eventos en el nivel de aplicaci√≥n pueden contener par√°metros adicionales del Asunto y el Objeto, as√≠ como el Recurso en s√≠.  Por ejemplo, los par√°metros adicionales de un recurso como un "archivo" pueden ser el directorio en el que se encuentra o su tama√±o. <br>  En este caso, el Asunto, el Objeto y el Recurso se identifican por nombre o identificador √∫nico: direcci√≥n de correo electr√≥nico, nombre de archivo, nombre de directorio, nombre de tabla en la base de datos. <br><br>  Considere patrones de interacci√≥n adicionales espec√≠ficos del nivel de aplicaci√≥n. <br><br><img src="https://habrastorage.org/webt/tg/lk/rm/tglkrmwarm0l4og50f0igcsgwhm.png"><br>  <i>Figura 6. Interacci√≥n de recursos</i> <br><br>  En este diagrama, el Sujeto act√∫a indirectamente sobre el Objeto a trav√©s de un Recurso intermedio.  Como regla general, los eventos con dicho esquema son claramente visibles en los registros de auditor√≠a de la base de datos o cuando se trabaja con derechos de acceso a archivos y directorios a nivel del sistema operativo. <br><br>  El ejemplo muestra una entrada de la base de datos de auditor√≠a de la base de datos Oracle.  Soluciona el proceso de revocar un rol de un usuario. <br><br><img src="https://habrastorage.org/webt/fc/fe/l3/fcfel3yxldwmxgxkj8mnp_3uf8k.png"><br><br>  Aqu√≠: <br>  <b>"ALEX"</b> - Asunto (nombre de usuario que retira el rol), <br>  <b>"BOB"</b> - Objeto (nombre del usuario que est√° siendo revocado), <br>  <b>"PAPEL"</b> - Recurso (nombre del rol revocado). <br><br><img src="https://habrastorage.org/webt/3m/kt/93/3mkt93zoast_9sgow61s6yiaou8.png"><br>  <i>Diagrama 7. Interacci√≥n con muchos recursos.</i> <br><br>  A nivel de aplicaci√≥n, as√≠ como a nivel de red, existen tales tipos de eventos en los cuales el Sujeto interact√∫a con el Objeto inmediatamente a trav√©s de muchos Recursos.  Es muy raro, pero hay ocasiones en que la cantidad de Objetos tambi√©n es m√°s de uno.  Este tipo de eventos aparecen al arreglar operaciones masivas.  Por ejemplo, otorgar acceso a varios archivos a un usuario o cambiar el conjunto de reglas incluidas en la pol√≠tica. <br><br>  En el ejemplo, la soluci√≥n para proteger entornos virtuales vGate Security Code captura la incorporaci√≥n de nuevas pol√≠ticas al conjunto. <br><br><img src="https://habrastorage.org/webt/jp/hn/il/jphnilptae5cmxk3by0plhdjnno.png"><br><br>  Aqu√≠: <br>  <b>"Admin @ VGATE"</b> - Asunto (nombre del usuario que cambia el conjunto de pol√≠ticas) <br>  <b>"Base"</b> - Objeto (conjunto de pol√≠ticas) <br>  <b>"Instalaci√≥n y mantenimiento de la integridad del sistema de archivos", "Comprobaci√≥n de la configuraci√≥n del agente SNMP", "Desactivaci√≥n de la instalaci√≥n autom√°tica de VMware Tools"</b> - Recursos (nombres de pol√≠ticas adicionales) <br><a name="ChannelModel"></a><br><h1>  El modelo del canal de interacci√≥n entre el Sujeto y el Objeto. </h1><br>  En todos los esquemas, distinguimos diferentes entidades (sujetos, objetos, recursos, fuentes, transmisores) y notamos el llamado canal de interacci√≥n entre ellos.  Deteng√°monos con m√°s detalle en el pen√∫ltimo componente del modelo grande del "mundo" con el que SIEM debe operar: en los modelos del canal de interacci√≥n entre el Sujeto y el Objeto.  Recuerde que el √∫ltimo componente es el contexto de interacci√≥n (el siguiente art√≠culo se dedicar√° a esto). <br><br>  Entonces, hay dos entidades que interact√∫an entre s√≠.  Como parte de esta interacci√≥n, los datos se transfieren de una entidad a otra.  Estos pueden ser paquetes de red con datos, archivos o comandos de administraci√≥n.  En este caso, el canal formado puede representarse en forma de una "tuber√≠a" a lo largo de la cual hay un flujo dirigido de datos y comandos.  Tal modelo es claramente visible a nivel de red, pero menos pronunciado a nivel de aplicaci√≥n (ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ejemplo</a> ). <br><br><img src="https://habrastorage.org/webt/pi/3i/hl/pi3ihljaztjgnfszntwesq3s5k8.png"><br>  <i>Modelo de canal de datos</i> <br><br>  Basado en dicho modelo, cada evento que recibe el SIEM puede contener informaci√≥n que describe: <br><br><ul><li>  Los par√°metros del canal en s√≠ son la "tuber√≠a", </li><li>  Los datos transmitidos a trav√©s de este "tubo". </li></ul><br>  T√≠picamente, un canal se describe mediante par√°metros como el identificador de sesi√≥n, el protocolo de transferencia de datos, el tiempo de establecimiento del canal, el tiempo de finalizaci√≥n y la duraci√≥n.  Los datos en eventos se caracterizan por el formato utilizado por los algoritmos de cifrado, el n√∫mero de paquetes transmitidos, el n√∫mero de bytes transmitidos. <br><br>  Considere un ejemplo de un evento que contiene datos sobre el canal de interacci√≥n.  Aqu√≠ hay un evento del Cisco Identity Services Engine (ISE), un sistema de gesti√≥n de procesos para identificar y controlar el acceso, que registra la sesi√≥n de red de un usuario como parte del procedimiento de contabilidad (contabilidad). <br><br><a name="ComplexExample"></a><br><img src="https://habrastorage.org/webt/op/qr/qt/opqrqtfyo0do7ybijdpx7gm_va4.png"><br><br>  Aqu√≠: <br>  <b>"Acct-Session-Id = 1A346216", "Acct-Session-Time = 50", "Service-Type = Framed", "Framed-Protocol = PPP"</b> - par√°metros del canal de comunicaci√≥n, <br>  <b>‚ÄúAcct-Input-Octets = 43525‚Äù, ‚ÄúAcct-Output-Octets = 122215‚Äù, ‚ÄúAcct-Input-Packets = 234‚Äù, ‚ÄúAcct-Output-Packets = 466‚Äù</b> - par√°metros de los datos transmitidos por el canal. <br><br><h1>  Un ejemplo de modelos de interacci√≥n de entidades y el canal en un evento. </h1><br>  Entonces, examinamos los esquemas de interacci√≥n de los niveles y las aplicaciones de la red, as√≠ como el modelo del canal de interacci√≥n.  A continuaci√≥n, mostramos un ejemplo de c√≥mo en un caso se combinan los esquemas de interacci√≥n de diferentes niveles y se utiliza la informaci√≥n sobre el modelo de canal. <br><br>  Aqu√≠ vemos un evento desde el firewall: el dispositivo de seguridad adaptable de Cisco (ASA), en el que se repara una conexi√≥n TCP saliente. <br><br><img src="https://habrastorage.org/webt/ls/ra/i5/lsrai5eqgcgrydjiwanqr4hhfde.png"><br><br>  El ejemplo muestra claramente que dentro de un evento hay entidades del nivel de red y el nivel de aplicaci√≥n.  A nivel de red, un esquema de interacci√≥n entre el Sujeto y el Objeto, que se fija mediante la Fuente.  No hay transmisor. <br><br>  Aqu√≠: <br>  <b>30.0.0.1</b> - Fuente (Cisco ASA), <br>  <b>10.0.0.1</b> - Asunto (la direcci√≥n de quien se conecta), <br>  <b>20.0.0.1</b> - Un objeto (la direcci√≥n de aquel a quien se conectan). <br><br>  A nivel de aplicaci√≥n, un esquema simple en el que solo el Asunto y el Objeto est√°n presentes: <br>  <b>"ALEX"</b> - Asunto (nombre de usuario que se conecta), <br>  <b>"BOB"</b> : el objeto (el nombre del usuario al que se conectan). <br><br>  Tambi√©n en este caso hay una descripci√≥n del canal de transmisi√≥n de datos, pero no hay una descripci√≥n de los datos en s√≠: <br>  <b>"TCP"</b> es el protocolo en base al cual se cre√≥ el canal, <br>  <b>"136247"</b> es el identificador de sesi√≥n del canal. <br><br><h1>  Conclusiones </h1><br>  ¬øC√≥mo pueden ayudar los esquemas de interacci√≥n t√≠picos resaltados por nosotros? <br><br><ul><li>  <b>Primero</b> , al escribir reglas de correlaci√≥n y analizar eventos, un experto debe comprender qu√© entidades est√°n presentes dentro de cada evento que llega a SIEM.  Para esto, es necesario, en la etapa de normalizaci√≥n de los eventos, distinguir claramente las entidades: Sujeto, Objeto, Recurso, Fuente y Transmisor. </li><li>  <b>En segundo lugar</b> , durante la normalizaci√≥n, es importante tener en cuenta que el evento contiene informaci√≥n sobre la interacci√≥n del nivel de red y el nivel de aplicaci√≥n.  Ambas interacciones pueden estar presentes simult√°neamente en un evento. </li><li>  <b>En tercer lugar</b> , la interacci√≥n en s√≠ misma es una estructura compuesta en la que hay informaci√≥n sobre el canal formado y sobre los datos transmitidos a trav√©s de este canal. </li></ul><br>  Por lo tanto, el modelo del "mundo", que est√° construido en SIEM y est√° representado por un conjunto de campos (un esquema), debe contener secciones para describir: <br><br><ol><li>  <b>A nivel de red</b> : <br><ul><li>  Sujeto; </li><li>  El objeto; </li><li>  Fuente; </li><li>  Transmisor </li><li>  Canal de interacci√≥n; </li><li>  Datos transmitidos por el canal. </li></ul><br></li><li>  <b>A nivel de aplicaci√≥n</b> : <br><ul><li>  Sujeto; </li><li>  Un objeto o una pluralidad de objetos; </li><li>  Un recurso o m√∫ltiples recursos. </li></ul><br></li></ol><br>  Para cada entidad, es necesario definir un conjunto de propiedades que lo identifiquen de forma exclusiva.  A nivel de red, las entidades se identifican por IP, MAC o FQDN.  A nivel de aplicaci√≥n, por nombre o ID.  El esquema debe tener campos dedicados para almacenar estos identificadores. <br><br>  Existen esquemas de interacci√≥n degenerados en los que una entidad puede combinar varios roles a la vez.  Al normalizar tales eventos, es necesario definir expl√≠citamente la regla para completar todos los campos del esquema que son responsables de todo el conjunto de entidades.  En el futuro, esto ayudar√° a las reglas de correlaci√≥n a no perder parte de las interacciones. <br><br>  Expliquemos: tomemos el caso de combinar el papel del Sujeto y el Objeto en la Fuente.        ,   ,   ,           ,      . <br><br>       ,          .      ,   . <br><br>    ,      ,  : <br><br><img src="https://habrastorage.org/webt/zo/dp/if/zodpiffknu6hbuk7e0rqpqg4h7q.png"><br> <i> ,   </i> <br><br>   ‚Äî    ¬´¬ª SIEM     ,     .  ,   ,   Alex        , ‚Äî  ,      , , .         ,       . , -     ,      ,    SIEM    . <br><br>        ,        ,    .          ,      ,     . <br><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br>  SIEM:  ¬´ ¬ª.  2.      ¬´¬ª ( <i> </i> ) <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  3.1.  </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  ¬´ ¬ª.  5.    </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424975/">https://habr.com/ru/post/es424975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424965/index.html">Reaccionar el desarrollo de aplicaciones usando ReasonReact</a></li>
<li><a href="../es424967/index.html">Atajos de JavaScript para principiantes</a></li>
<li><a href="../es424969/index.html">Gu√≠a de Node.js, Parte 9: Trabajar con el sistema de archivos</a></li>
<li><a href="../es424971/index.html">Habrokast "Puesta de sol manual" # 1. Tratando de configurar un entorno para desarrollar un juguete para Windows</a></li>
<li><a href="../es424973/index.html">Detecci√≥n de rostros en video: Raspberry Pi y Neural Compute Stick</a></li>
<li><a href="../es424977/index.html">Aprender de los errores: optimizar aplicaciones en App Store y Google Play</a></li>
<li><a href="../es424979/index.html">Olmo C√≥modo e inc√≥modo. Http, Tarea</a></li>
<li><a href="../es424981/index.html">Easter Egg Text RPG en el c√≥digo del motor de b√∫squeda de Google</a></li>
<li><a href="../es424985/index.html">En un importante precedente judicial, las agencias de inteligencia de EE. UU. No pudieron interceptar llamadas telef√≥nicas en el mensajero</a></li>
<li><a href="../es424987/index.html">Recupere im√°genes borrosas y desenfocadas utilizando el filtro Wiener. Implementaci√≥n en C ++ OpenCV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>