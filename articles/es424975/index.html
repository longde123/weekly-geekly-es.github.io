<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ℹ️ 🥙 🤷🏼 Profundidades SIEM: correlaciones listas para usar. Parte 2. Esquema de datos como reflejo del modelo del "mundo" 🕓 🌖 ⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este es el segundo artículo de la serie, dedicado a la metodología para crear reglas de correlación listas para usar para los sistemas SIEM. En el art...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades SIEM: correlaciones listas para usar. Parte 2. Esquema de datos como reflejo del modelo del "mundo"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/424975/">  Este es el segundo artículo de la serie, dedicado a la metodología para crear reglas de correlación listas para usar para los sistemas SIEM.  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">artículo</a> anterior <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">,</a> nos propusimos esta tarea, describimos las ventajas que se obtendrán en su implementación y también enumeramos los principales problemas que se interponen en nuestro camino.  En este artículo, comenzaremos a buscar soluciones y comenzaremos con el problema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">transformar el modelo del "mundo"</a> , así como su manifestación en la etapa de normalización de los eventos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/ty/w_/thtyw_5tngr0v1dhkcakeexhlw8.jpeg" alt="Transformación del modelo SIEM"></div><br><a name="habracut"></a><br>  El problema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">transformar el modelo "mundial"</a> se describió en el primer artículo.  Recordemos brevemente su esencia: cuando se produce un fenómeno en el origen de los eventos (por ejemplo, al iniciar un proceso en el sistema operativo), se repara en diferentes formatos, primero en la memoria, luego en el registro de eventos del sistema operativo y luego en el sistema SIEM.  Cada etapa del procesamiento va acompañada de pérdida de datos, ya que a nivel del sistema operativo hay un modelo "mundial", y en el registro del sistema operativo, otro, limitado por un conjunto de campos, por el esquema de registro.  Por lo tanto, hay una reflexión (transformación) de un modelo con un gran número de parámetros a otro, con un número menor de ellos.  Normalizar y guardar un evento en SIEM es otra transformación que también ocurre con la pérdida de datos, ya que SIEM también tiene su propio modelo "mundial". <br><br>  Es difícil encontrar una manera que permita la transformación de un modelo en otro sin pérdida.  Conociendo esta limitación, es necesario formular un enfoque de este tipo para la normalización y la formación de una lista de campos del esquema de eventos, en el que la información no se pierda, importante en la correlación e investigación adicional de incidentes de seguridad de la información. <br><br>  Dentro del marco de SIEM, un modelo está representado por un esquema, un conjunto de campos en el que los datos del evento inicial se ajustan al proceso de normalización.  En el futuro, será utilizado por especialistas en la creación de reglas de correlación.  Para que los investigadores de incidentes y los responsables de desarrollar reglas de correlación interpreten sin ambigüedad los eventos normalizados, el esquema debe satisfacer las propiedades básicas: <br><br><ul><li>  estar unificado para eventos de cualquier tipo y fuentes; </li><li>  describa claramente quién interactuó con quién y cómo; </li><li>  Mantener la esencia y el contexto de la interacción. </li></ul><br>  En el proceso de desarrollar reglas de normalización, la información sobre la interacción debe encontrarse en el evento inicial y descomponerse en campos especialmente designados.  Lo mismo debe hacerse con el contexto y la esencia de la interacción (más sobre esto en el próximo artículo). <br><br>  Surge la pregunta: ¿es posible identificar esquemas típicos para interacciones que satisfagan cualquier evento creado por todas las posibles fuentes de seguridad de la información y TI?  Si es así, ¿cómo son estos esquemas? <br><br>  Para encontrar la respuesta a estas preguntas, debe recurrir a la analítica e intentar analizar tantas reglas de normalización ya desarrolladas y que funcionen en las soluciones SIEM como sea posible para identificar patrones comunes.  Como parte de dicho trabajo, fue posible analizar más de 3.000 reglas de normalización de más de 100 fuentes diferentes de soluciones como Positive Technologies MaxPatrol SIEM y Micro Focus ArcSight.  El análisis arrojó las siguientes conclusiones: <br><br><ol><li>  Existen esquemas de interacción típicos. </li><li>  En cada evento individual, como regla, hay información sobre la interacción a <b>nivel de red</b> y a <b>nivel de aplicación</b> . </li><li>  Los patrones de interacción típicos pueden variar en diferentes niveles, y esto debe tenerse en cuenta. </li></ol><br><a name="NetworkAppLevels"></a><br><h1>  Red y esquemas de comunicación de capa de aplicación </h1><br>  Describimos esquemas típicos para cada nivel.  Antes de esto, debe resaltar las entidades que siempre están presentes en los eventos.  Además, en base a ellos, se construirán esquemas de interacción.  Estos incluyen: <br><br><ul><li>  <b>Sujeto</b>  Una entidad que afecta a un objeto.  Por ejemplo, un usuario que cambia una clave de registro o un host con IP 10.0.0.1 y envía un paquete a un host con IP 20.0.0.1. </li><li>  <b>Objeto</b> .  La entidad afectada por el Sujeto. </li><li>  <b>Fuente</b>  Como regla general, un host que registra la interacción del Sujeto con el Objeto y genera el evento en sí.  Por ejemplo, la Fuente será un cortafuegos que registró la transmisión de paquetes desde el host, el Asunto con IP 10.0.0.1, al host, el Objeto con IP 20.0.0.1. </li><li>  <b>Transmisor</b>  Hay casos en que SIEM recibe eventos no directamente de la fuente, sino de un servidor intermedio a través del cual pasan estos eventos.  El ejemplo más simple es un servidor syslog intermedio.  Un ejemplo es más complicado: cuando el Transmisor puede ser un servidor de administración, por ejemplo, Kaspersky Security Center.  En este caso, la Fuente es un agente específico de Kaspersky Endpoint Security. </li></ul><br>  Sin embargo, no todas las entidades pueden representarse simultáneamente en el evento (más sobre esto más adelante), por lo tanto, es importante celebrar acuerdos inicialmente, ya que en este caso se llenan los campos correspondientes del esquema.  Esto ayudará en el futuro a distinguir claramente entre casos en los que estos campos no se completaron debido a un error por parte de un especialista que está desarrollando reglas de normalización a partir de casos en los que el evento original realmente no contenía datos sobre ninguna entidad. <br><br>  Pasemos a patrones de interacción y ejemplos de eventos.  Para mayor claridad, todos los ejemplos se darán sobre la base de registros de archivos, mensajes de syslog o registros en una base de datos relacional, pero se pueden usar para otros formatos de registro, por ejemplo, binarios. <br><br><h2>  Nivel de red </h2><br>  El identificador principal para las entidades de nivel de red son las direcciones IP.  Es importante comprender que puede haber otros identificadores relacionados (direcciones MAC a nivel de canal, FQDN) a nivel de aplicación.  Surge la pregunta: ¿están hablando de la misma entidad o diferente?  ¿Pueden estos identificadores cambiar con el tiempo con la misma entidad?  Se dedicará un artículo separado a esto. Ahora analicemos el hecho de que el identificador principal para los modelos de interacción a nivel de red es la dirección IP. <br><br>  Por lo tanto, los esquemas de interacción típicos de este nivel se pueden dividir en dos clases: básica y degenerada. <br><br><h3>  Esquemas básicos de interacción </h3><br><a name="Schema1"></a><br><img src="https://habrastorage.org/webt/-s/nl/ii/-snliisaaef13_b5_bvrawyycxi.png" height="262"><br>  <i>Esquema 1. Esquema de interacción completo</i> <br><br>  Dentro del marco de este modelo, en el evento recibido en la entrada SIEM, se pueden distinguir todas las entidades principales: Sujeto, Objeto, Fuente, Transmisor.  En el esquema de interacción, el Sujeto actúa sobre el Objeto.  Este efecto registra (observa) el origen y genera un evento.  El evento desde la Fuente ingresa al Transmisor y desde él ingresa al SIEM. <br><br>  El evento a continuación captura la resolución de la interacción de red entre los hosts mediante el firewall de Stonesoft (ahora Forcepoint), mientras que el evento en sí no ingresa a SIEM directamente, sino desde un servidor syslog intermedio. <br><br><img src="https://habrastorage.org/webt/rr/99/hk/rr99hkccik_qrx1gqndn6dub870.png"><br><br>  Aquí: <br>  <b>40.0.0.1</b> - Transmisor (servidor syslog intermedio), <br>  <b>30.0.0.1</b> - Fuente (nodo de firewall), <br>  <b>10.0.0.1</b> - Asunto (envío de paquetes UDP), <br>  <b>20.0.0.1</b> - Un objeto (que recibe paquetes UDP). <br><br><img src="https://habrastorage.org/webt/mm/tv/3d/mmtv3d2b7w5gan5mcmxzuvsyyaa.png"><br>  <i>Diagrama 2: Diagrama de recolección directa sin transmisor</i> <br><br>  No siempre en el esquema de interacción hay un transmisor.  Como regla, está presente cuando se utiliza un servidor intermedio (por ejemplo, un servidor syslog) para transmitir eventos, o cuando la solución de la que se recopilan los eventos tiene un sistema de administración centralizado, por ejemplo, Kaspersky Security Center, Check Point Smart Console o Cisco Prime.  Bajo este esquema, los eventos caen en SIEM directamente desde la Fuente.  La mayoría de todos los eventos se describen mediante este esquema particular.  Por cierto, un ejemplo de tal evento se puede ver en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Figura 1</a> , si no había un servidor syslog intermedio y recibimos eventos directamente desde el firewall. <br><br><img src="https://habrastorage.org/webt/gu/vp/aw/guvpawlp6njgeswk6dukx9cf5io.png"><br><br>  Aquí: <br>  <b>30.0.0.1</b> - Fuente (nodo de firewall), <br>  <b>10.0.0.1</b> - Asunto (envío de paquetes UDP), <br>  <b>20.0.0.1</b> - Un objeto (que recibe paquetes UDP). <br><br><img src="https://habrastorage.org/webt/b8/0s/m2/b80sm2hvahlh46ih3ylmb8tut9w.png"><br>  <i>Esquema 3. Interacción con muchos objetos.</i> <br><br>  Este esquema de interacción a nivel de red es bastante raro y, como regla, es típico para eventos de equipos de red.  En el esquema, un Sujeto interactúa con muchos Objetos, una interacción similar está presente en eventos que describen transmisiones multicast, unicast o broadcast. <br><br>  Tenga en cuenta que a veces muchos objetos pueden estar unidos por un identificador común: una dirección de subred o una dirección de difusión.  Esto debe recordarse, ya que al analizar eventos, incluso a nivel de reglas de correlación, puede omitir fácilmente la interacción potencialmente importante, ya que en dicho esquema la dirección del Objeto se oculta detrás de la dirección del grupo. <br><br>  El siguiente ejemplo muestra un evento desde un servidor de retransmisión IGMP a través del cual se transmite una solicitud de membresía de multidifusión. <br><br><img src="https://habrastorage.org/webt/i7/zj/yk/i7zjykhwdwtzkocjqqaexwiiey0.png"><br><br>  Aquí: <br>  <b>30.0.0.1</b> - Fuente (servidor de retransmisión IGMP), <br>  <b>10.0.0.1</b> - Asunto (solicitud de membresía en un grupo), <br>  <b>224.0.0.252</b> : el objeto (dirección de multidifusión). <br><br><h3>  Esquemas degenerados </h3><br>  Sujeto, Objeto y Fuente son las entidades básicas en el grupo de esquemas de interacción básicos.  Sin embargo, hay casos en que una de las entidades puede estar ausente en el evento. <br><br><img src="https://habrastorage.org/webt/e8/h_/z4/e8h_z4bo7ixafd2vytv7y-gxuqa.png"><br>  <i>Esquema 4. Interacción sin un objeto</i> <br><br>  A menudo, este patrón es típico en situaciones en las que el Sujeto informa un cambio en su estado interno, es decir, actúa simultáneamente en el papel del Sujeto y el Objeto.  Por ejemplo, esta interacción se puede observar en cambios de configuración o eventos de detección de malware en la estación de trabajo.  Pero esta información no es registrada por el propio sujeto, sino por un sistema de gestión centralizado y almacenado en su diario. <br><br>  El ejemplo muestra cómo Symantec Management Server captura que el agente de Symantec Endpoint Protection que administra ha detectado un archivo malicioso en su host. <br><br><img src="https://habrastorage.org/webt/uc/8i/tk/uc8itkdycqecus0f5xb2zhxlbgi.png"><br><br>  Aquí: <br>  <b>30.0.0.1</b> - Fuente (Symantec Management Server), <br>  <b>10.0.0.1</b> - Asunto (Agente de Symantec Endpoint Protection). <br><br><img src="https://habrastorage.org/webt/qq/wg/ao/qqwgaoqcw7dwndbgulrzbdimunm.png"><br>  <i>Esquema 5. Combinando el papel del Sujeto y el Objeto en la Fuente</i> <br><br>  El último esquema de interacción degenerada es típico para una situación en la que SIEM recibe eventos de una Fuente que informa un cambio en su estado interno: por ejemplo, reconfigurar un dispositivo o software, habilitar o deshabilitar un puerto de red.  En tal esquema, el rol de la Fuente coincide con el rol del Sujeto y el Objeto.  A diferencia del esquema anterior, aquí los eventos en SIEM vienen directamente. <br><br>  En este ejemplo, un conmutador basado en Cisco IOS informa que su interfaz ha pasado al estado UP. <br><br><img src="https://habrastorage.org/webt/in/ap/cd/inapcd3rbeuutgbgivcfmt-ujmq.png"><br><br>  Aquí <b>30.0.0.1</b> es la fuente (interruptor). <br><br><h2>  Nivel de aplicación </h2><br>  En este nivel, hay interacciones de entidades ya conocidas: Sujeto, Objeto.  Sin embargo, toda la información sobre la Fuente y el Transmisor permanece directamente en el nivel de la red y no se refleja en el nivel de la aplicación. <br><br>  La mayoría de todos los tipos de eventos incorporan interacciones simultáneamente a nivel de red y de aplicación.  Sin embargo, observamos que los eventos generados directamente por el software de la aplicación, por ejemplo, 1C: Enterprise, Microsoft SQL Server u Oracle Database, pueden contener exclusivamente interacciones a nivel de aplicación. <br><br>  Además, aparece una entidad de <b>Recursos</b> adicional en el nivel de aplicación. <br><br>  <b>Un recurso</b> es una entidad intermedia a través de la cual el Sujeto ejerce influencia sobre el Objeto sin interacción directa.  Por ejemplo, otorgarle a Alex los derechos para acceder a MyFile a Bob.  Aquí Alex es el sujeto, Bob es el objeto, MyFile es el recurso.  Tenga en cuenta que en este ejemplo, Alex no interactúa directamente con Bob. <br><br>  <i>Importante</i> : los eventos en el nivel de aplicación pueden contener parámetros adicionales del Asunto y el Objeto, así como el Recurso en sí.  Por ejemplo, los parámetros adicionales de un recurso como un "archivo" pueden ser el directorio en el que se encuentra o su tamaño. <br>  En este caso, el Asunto, el Objeto y el Recurso se identifican por nombre o identificador único: dirección de correo electrónico, nombre de archivo, nombre de directorio, nombre de tabla en la base de datos. <br><br>  Considere patrones de interacción adicionales específicos del nivel de aplicación. <br><br><img src="https://habrastorage.org/webt/tg/lk/rm/tglkrmwarm0l4og50f0igcsgwhm.png"><br>  <i>Figura 6. Interacción de recursos</i> <br><br>  En este diagrama, el Sujeto actúa indirectamente sobre el Objeto a través de un Recurso intermedio.  Como regla general, los eventos con dicho esquema son claramente visibles en los registros de auditoría de la base de datos o cuando se trabaja con derechos de acceso a archivos y directorios a nivel del sistema operativo. <br><br>  El ejemplo muestra una entrada de la base de datos de auditoría de la base de datos Oracle.  Soluciona el proceso de revocar un rol de un usuario. <br><br><img src="https://habrastorage.org/webt/fc/fe/l3/fcfel3yxldwmxgxkj8mnp_3uf8k.png"><br><br>  Aquí: <br>  <b>"ALEX"</b> - Asunto (nombre de usuario que retira el rol), <br>  <b>"BOB"</b> - Objeto (nombre del usuario que está siendo revocado), <br>  <b>"PAPEL"</b> - Recurso (nombre del rol revocado). <br><br><img src="https://habrastorage.org/webt/3m/kt/93/3mkt93zoast_9sgow61s6yiaou8.png"><br>  <i>Diagrama 7. Interacción con muchos recursos.</i> <br><br>  A nivel de aplicación, así como a nivel de red, existen tales tipos de eventos en los cuales el Sujeto interactúa con el Objeto inmediatamente a través de muchos Recursos.  Es muy raro, pero hay ocasiones en que la cantidad de Objetos también es más de uno.  Este tipo de eventos aparecen al arreglar operaciones masivas.  Por ejemplo, otorgar acceso a varios archivos a un usuario o cambiar el conjunto de reglas incluidas en la política. <br><br>  En el ejemplo, la solución para proteger entornos virtuales vGate Security Code captura la incorporación de nuevas políticas al conjunto. <br><br><img src="https://habrastorage.org/webt/jp/hn/il/jphnilptae5cmxk3by0plhdjnno.png"><br><br>  Aquí: <br>  <b>"Admin @ VGATE"</b> - Asunto (nombre del usuario que cambia el conjunto de políticas) <br>  <b>"Base"</b> - Objeto (conjunto de políticas) <br>  <b>"Instalación y mantenimiento de la integridad del sistema de archivos", "Comprobación de la configuración del agente SNMP", "Desactivación de la instalación automática de VMware Tools"</b> - Recursos (nombres de políticas adicionales) <br><a name="ChannelModel"></a><br><h1>  El modelo del canal de interacción entre el Sujeto y el Objeto. </h1><br>  En todos los esquemas, distinguimos diferentes entidades (sujetos, objetos, recursos, fuentes, transmisores) y notamos el llamado canal de interacción entre ellos.  Detengámonos con más detalle en el penúltimo componente del modelo grande del "mundo" con el que SIEM debe operar: en los modelos del canal de interacción entre el Sujeto y el Objeto.  Recuerde que el último componente es el contexto de interacción (el siguiente artículo se dedicará a esto). <br><br>  Entonces, hay dos entidades que interactúan entre sí.  Como parte de esta interacción, los datos se transfieren de una entidad a otra.  Estos pueden ser paquetes de red con datos, archivos o comandos de administración.  En este caso, el canal formado puede representarse en forma de una "tubería" a lo largo de la cual hay un flujo dirigido de datos y comandos.  Tal modelo es claramente visible a nivel de red, pero menos pronunciado a nivel de aplicación (ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ejemplo</a> ). <br><br><img src="https://habrastorage.org/webt/pi/3i/hl/pi3ihljaztjgnfszntwesq3s5k8.png"><br>  <i>Modelo de canal de datos</i> <br><br>  Basado en dicho modelo, cada evento que recibe el SIEM puede contener información que describe: <br><br><ul><li>  Los parámetros del canal en sí son la "tubería", </li><li>  Los datos transmitidos a través de este "tubo". </li></ul><br>  Típicamente, un canal se describe mediante parámetros como el identificador de sesión, el protocolo de transferencia de datos, el tiempo de establecimiento del canal, el tiempo de finalización y la duración.  Los datos en eventos se caracterizan por el formato utilizado por los algoritmos de cifrado, el número de paquetes transmitidos, el número de bytes transmitidos. <br><br>  Considere un ejemplo de un evento que contiene datos sobre el canal de interacción.  Aquí hay un evento del Cisco Identity Services Engine (ISE), un sistema de gestión de procesos para identificar y controlar el acceso, que registra la sesión de red de un usuario como parte del procedimiento de contabilidad (contabilidad). <br><br><a name="ComplexExample"></a><br><img src="https://habrastorage.org/webt/op/qr/qt/opqrqtfyo0do7ybijdpx7gm_va4.png"><br><br>  Aquí: <br>  <b>"Acct-Session-Id = 1A346216", "Acct-Session-Time = 50", "Service-Type = Framed", "Framed-Protocol = PPP"</b> - parámetros del canal de comunicación, <br>  <b>“Acct-Input-Octets = 43525”, “Acct-Output-Octets = 122215”, “Acct-Input-Packets = 234”, “Acct-Output-Packets = 466”</b> - parámetros de los datos transmitidos por el canal. <br><br><h1>  Un ejemplo de modelos de interacción de entidades y el canal en un evento. </h1><br>  Entonces, examinamos los esquemas de interacción de los niveles y las aplicaciones de la red, así como el modelo del canal de interacción.  A continuación, mostramos un ejemplo de cómo en un caso se combinan los esquemas de interacción de diferentes niveles y se utiliza la información sobre el modelo de canal. <br><br>  Aquí vemos un evento desde el firewall: el dispositivo de seguridad adaptable de Cisco (ASA), en el que se repara una conexión TCP saliente. <br><br><img src="https://habrastorage.org/webt/ls/ra/i5/lsrai5eqgcgrydjiwanqr4hhfde.png"><br><br>  El ejemplo muestra claramente que dentro de un evento hay entidades del nivel de red y el nivel de aplicación.  A nivel de red, un esquema de interacción entre el Sujeto y el Objeto, que se fija mediante la Fuente.  No hay transmisor. <br><br>  Aquí: <br>  <b>30.0.0.1</b> - Fuente (Cisco ASA), <br>  <b>10.0.0.1</b> - Asunto (la dirección de quien se conecta), <br>  <b>20.0.0.1</b> - Un objeto (la dirección de aquel a quien se conectan). <br><br>  A nivel de aplicación, un esquema simple en el que solo el Asunto y el Objeto están presentes: <br>  <b>"ALEX"</b> - Asunto (nombre de usuario que se conecta), <br>  <b>"BOB"</b> : el objeto (el nombre del usuario al que se conectan). <br><br>  También en este caso hay una descripción del canal de transmisión de datos, pero no hay una descripción de los datos en sí: <br>  <b>"TCP"</b> es el protocolo en base al cual se creó el canal, <br>  <b>"136247"</b> es el identificador de sesión del canal. <br><br><h1>  Conclusiones </h1><br>  ¿Cómo pueden ayudar los esquemas de interacción típicos resaltados por nosotros? <br><br><ul><li>  <b>Primero</b> , al escribir reglas de correlación y analizar eventos, un experto debe comprender qué entidades están presentes dentro de cada evento que llega a SIEM.  Para esto, es necesario, en la etapa de normalización de los eventos, distinguir claramente las entidades: Sujeto, Objeto, Recurso, Fuente y Transmisor. </li><li>  <b>En segundo lugar</b> , durante la normalización, es importante tener en cuenta que el evento contiene información sobre la interacción del nivel de red y el nivel de aplicación.  Ambas interacciones pueden estar presentes simultáneamente en un evento. </li><li>  <b>En tercer lugar</b> , la interacción en sí misma es una estructura compuesta en la que hay información sobre el canal formado y sobre los datos transmitidos a través de este canal. </li></ul><br>  Por lo tanto, el modelo del "mundo", que está construido en SIEM y está representado por un conjunto de campos (un esquema), debe contener secciones para describir: <br><br><ol><li>  <b>A nivel de red</b> : <br><ul><li>  Sujeto; </li><li>  El objeto; </li><li>  Fuente; </li><li>  Transmisor </li><li>  Canal de interacción; </li><li>  Datos transmitidos por el canal. </li></ul><br></li><li>  <b>A nivel de aplicación</b> : <br><ul><li>  Sujeto; </li><li>  Un objeto o una pluralidad de objetos; </li><li>  Un recurso o múltiples recursos. </li></ul><br></li></ol><br>  Para cada entidad, es necesario definir un conjunto de propiedades que lo identifiquen de forma exclusiva.  A nivel de red, las entidades se identifican por IP, MAC o FQDN.  A nivel de aplicación, por nombre o ID.  El esquema debe tener campos dedicados para almacenar estos identificadores. <br><br>  Existen esquemas de interacción degenerados en los que una entidad puede combinar varios roles a la vez.  Al normalizar tales eventos, es necesario definir explícitamente la regla para completar todos los campos del esquema que son responsables de todo el conjunto de entidades.  En el futuro, esto ayudará a las reglas de correlación a no perder parte de las interacciones. <br><br>  Expliquemos: tomemos el caso de combinar el papel del Sujeto y el Objeto en la Fuente.        ,   ,   ,           ,      . <br><br>       ,          .      ,   . <br><br>    ,      ,  : <br><br><img src="https://habrastorage.org/webt/zo/dp/if/zodpiffknu6hbuk7e0rqpqg4h7q.png"><br> <i> ,   </i> <br><br>   —    «» SIEM     ,     .  ,   ,   Alex        , —  ,      , , .         ,       . , -     ,      ,    SIEM    . <br><br>        ,        ,    .          ,      ,     . <br><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  1:     ?</a> <br><br>  SIEM:  « ».  2.      «» ( <i> </i> ) <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  3.1.  </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  4.      </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> SIEM:  « ».  5.    </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424975/">https://habr.com/ru/post/es424975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424965/index.html">Reaccionar el desarrollo de aplicaciones usando ReasonReact</a></li>
<li><a href="../es424967/index.html">Atajos de JavaScript para principiantes</a></li>
<li><a href="../es424969/index.html">Guía de Node.js, Parte 9: Trabajar con el sistema de archivos</a></li>
<li><a href="../es424971/index.html">Habrokast "Puesta de sol manual" # 1. Tratando de configurar un entorno para desarrollar un juguete para Windows</a></li>
<li><a href="../es424973/index.html">Detección de rostros en video: Raspberry Pi y Neural Compute Stick</a></li>
<li><a href="../es424977/index.html">Aprender de los errores: optimizar aplicaciones en App Store y Google Play</a></li>
<li><a href="../es424979/index.html">Olmo Cómodo e incómodo. Http, Tarea</a></li>
<li><a href="../es424981/index.html">Easter Egg Text RPG en el código del motor de búsqueda de Google</a></li>
<li><a href="../es424985/index.html">En un importante precedente judicial, las agencias de inteligencia de EE. UU. No pudieron interceptar llamadas telefónicas en el mensajero</a></li>
<li><a href="../es424987/index.html">Recupere imágenes borrosas y desenfocadas utilizando el filtro Wiener. Implementación en C ++ OpenCV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>