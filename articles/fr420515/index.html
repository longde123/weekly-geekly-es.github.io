<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüë¶‚Äçüë¶ üåà ü•£ Diarisation bas√©e sur le mod√®le GMM-UBM et l'algorithme d'adaptation MAP üë©‚Äçüë©‚Äçüëß‚Äçüë¶ üê§ üßíüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut, Habr. Je voudrais parler d'une des approches pour r√©soudre le probl√®me de la diarisation des locuteurs et montrer comment cette m√©thode peut √™t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Diarisation bas√©e sur le mod√®le GMM-UBM et l'algorithme d'adaptation MAP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420515/">  Salut, Habr.  Je voudrais parler d'une des approches pour r√©soudre le probl√®me de la diarisation des locuteurs et montrer comment cette m√©thode peut √™tre impl√©ment√©e en python.  Afin de ne pas effrayer le lecteur, je ne donnerai pas de formules math√©matiques complexes (en partie parce que je ne suis pas moi-m√™me un vrai soudeur), mais j'essaierai de tout expliquer dans un langage simple et de tout dire de telle mani√®re qu'un d√©veloppeur qui n'a jamais rencontr√© le machine learning auparavant l'a compris. <br><a name="habracut"></a><br>  En me pr√©parant √† √©crire cet article, j'ai choisi entre deux options: pour ceux qui connaissent d√©j√† la Data Science et ceux qui se contentent de bien programmer.  Au final, j'ai choisi la deuxi√®me option, d√©cidant que ce serait une bonne d√©monstration des capacit√©s de DS. <br><br><h3>  √ânonc√© du probl√®me </h3><br>  Comme nous le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dit</a> Wikipedia, la diarisation est le processus de division d'un flux audio entrant en segments homog√®nes selon que le flux audio appartient √† l'un ou √† l'autre haut-parleur.  En d'autres termes, le dossier doit √™tre divis√© en morceaux et num√©rot√©: une personne parle √† ces endroits et une autre √† ces endroits.  Du point de vue de l'apprentissage automatique, les t√¢ches de ce type appartiennent √† la classe d'apprentissage sans enseignant et sont appel√©es clustering.  Vous pouvez lire sur les m√©thodes de clustering qui existent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> , par exemple, mais je ne parlerai que de celles qui nous sont utiles - il s'agit d'un mod√®le de m√©lange gaussien et d'un clustering spectral.  Mais √† leur sujet un peu plus tard. <br>  Commen√ßons par le tout d√©but. <br><br><h3>  Pr√©paration de l'environnement </h3><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Je ne savais pas trop si je devais quitter cette section - je ne voulais pas transformer l'article en un tr√®s tutoriel.  Mais √† la fin je l'ai laiss√©.  Celui qui n'en a pas besoin sautera, et pour ceux qui feront tout √† partir de z√©ro, cette √©tape facilitera le d√©marrage. <br></div></div><br>  De mani√®re g√©n√©rale, en plus de R, python est le langage principal pour r√©soudre les probl√®mes de Data Science, et si vous n'avez pas encore essay√© de le programmer, alors je recommande fortement de le faire car python vous permet de faire beaucoup de choses avec √©l√©gance, litt√©ralement en quelques lignes (√† propos, il y a m√™me un tel m√®me). <br><br>  Il existe deux branches de python d√©velopp√©es s√©par√©ment - les versions 2 et 3. Dans mes exemples, j'ai utilis√© la version 3.6, mais si vous le souhaitez, elles peuvent facilement √™tre port√©es vers la version 2.7.  Il est pratique de d√©ployer l'une de ces branches avec le programme d'installation d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anaconda</a> , en installant lequel vous recevrez imm√©diatement un shell interactif pour le d√©veloppement - IPython. <br><br>  En plus de l'environnement de d√©veloppement lui-m√™me, des biblioth√®ques suppl√©mentaires seront n√©cessaires: librosa (pour travailler avec l'audio et extraire les attributs), webrtcvad (pour la segmentation) et pickle (pour √©crire des mod√®les entra√Æn√©s dans un fichier).  Tous sont install√©s par une simple commande dans Anaconda Prompt. <br><br><pre><code class="hljs sql">pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">library</span></span>]</code> </pre> <br><h3>  Extraction de fonctionnalit√©s </h3><br>  Commen√ßons par l'extraction des fonctionnalit√©s - des donn√©es avec lesquelles les mod√®les d'apprentissage automatique fonctionneront.  En principe, le signal sonore lui-m√™me est d√©j√† une donn√©e, √† savoir un tableau ordonn√© de valeurs d'amplitude sonore, auquel est ajout√© un en-t√™te contenant le nombre de canaux, la fr√©quence d'√©chantillonnage et d'autres informations.  Mais nous ne serons pas en mesure d'analyser ces donn√©es directement, car elles ne contiennent pas de telles choses, en regardant lesquelles, notre mod√®le peut dire - oui, ces pi√®ces appartiennent √† la m√™me personne. <br><br>  Dans les t√¢ches de traitement de la parole, il existe plusieurs approches pour extraire des fonctionnalit√©s.  L'un d'eux est d'obtenir des coefficients cepstraux de fr√©quence de Mel.  Ils ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©j√† √©t√©</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©crits</a> ici, donc je ne vous le rappelle que l√©g√®rement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/dn/w-/fgdnw-m6jhpjb7b1wbj1xevahps.png" alt="image"></div><br>  Le signal d'origine est d√©coup√© en trames d'une dur√©e de 16 √† 40 ms.  Ensuite, en appliquant une fen√™tre de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Hamming</a> au cadre, ils font une transform√©e de Fourier rapide et obtiennent la densit√© spectrale de puissance.  Ensuite, avec un ¬´peigne¬ª sp√©cial de filtres dispos√©s uniform√©ment sur l'√©chelle de craie, un spectrogramme de craie est r√©alis√©, auquel une transform√©e en cosinus discr√®te (DCT) est appliqu√©e - un algorithme de compression de donn√©es largement utilis√©.  Les coefficients ainsi obtenus sont une sorte de caract√©ristique compress√©e de la trame, et puisque les filtres que nous avons utilis√©s √©taient situ√©s √† l'√©chelle de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">craie</a> , les coefficients portent plus d'informations dans le domaine de perception de l'oreille humaine.  En r√®gle g√©n√©rale, 13 √† 25 MFCC par trame sont utilis√©s.  √âtant donn√© qu'en plus du spectre lui-m√™me, la personnalit√© de la voix est form√©e par la vitesse et l'acc√©l√©ration, MFCC est combin√© avec les premi√®re et deuxi√®me d√©riv√©es. <br><br>  En g√©n√©ral, MFCC est l'option la plus courante pour travailler avec la parole, mais en plus d'eux, il existe d'autres signes - LPC (Linear Predictive Coding) et PLP (Perceptual Linear Prediction), et parfois vous pouvez √©galement trouver LFCC, o√π au lieu de l'√©chelle de craie, lin√©aire est utilis√©. <br><br>  Voyons comment extraire MFCC en python. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> librosa mfcc=librosa.feature.mfcc(y=y, sr=sr, hop_length=int(hop_seconds*sr), n_fft=int(window_seconds*sr), n_mfcc=n_mfcc) mfcc_delta=librosa.feature.delta(mfcc) mfcc_delta2=librosa.feature.delta(mfcc, order=<span class="hljs-number"><span class="hljs-number">2</span></span>) stacked=np.vstack((mfcc, mfcc_delta, mfcc_delta2)) features=stacked.T <span class="hljs-comment"><span class="hljs-comment">#librosa   MFCC   ,       .</span></span></code> </pre><br>  Comme vous pouvez le voir, cela se fait vraiment en quelques lignes.  Passons maintenant au premier algorithme de clustering. <br><br><h3>  Mod√®le de m√©lange gaussien </h3><br>  Un mod√®le d'un m√©lange de distributions gaussiennes sugg√®re que nos donn√©es sont un m√©lange de distributions gaussiennes multidimensionnelles avec certains param√®tres. <br><br>  Si vous le souhaitez, vous pouvez facilement trouver une description d√©taill√©e du mod√®le et comment fonctionne l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">algorithme EM</a> qui forme ce mod√®le, mais j'ai promis de ne pas ennuyer avec des formules complexes et donc je vais montrer de beaux exemples de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article. <br><br>  Nous allons g√©n√©rer quatre clusters et les dessiner. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.datasets.samples_generator <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> make_blobs X, y_true=make_blobs(n_samples=<span class="hljs-number"><span class="hljs-number">400</span></span>, centers=<span class="hljs-number"><span class="hljs-number">4</span></span>, cluster_std=<span class="hljs-number"><span class="hljs-number">0.60</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/px/my/d7/pxmyd7covni39hf8fq19684nrv0.png" alt="image"></div><br>  Nous allons cr√©er un mod√®le, nous entra√Æner sur nos donn√©es et dessiner √† nouveau les points, mais en tenant compte du mod√®le pr√©vu d'appartenance au cluster. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.mixture <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianMixture gmm = GaussianMixture(n_components=<span class="hljs-number"><span class="hljs-number">4</span></span>) gmm.fit(X) labels=gmm.predict(X) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=labels, s=<span class="hljs-number"><span class="hljs-number">40</span></span>, cmap=<span class="hljs-string"><span class="hljs-string">'viridis'</span></span>);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n0/2y/6n/n02y6nz_1nw3krhnatqj_qf5o9k.png" alt="image"></div><br>  Le mod√®le a bien g√©r√© les donn√©es artificielles.  En principe, en r√©gulant le nombre de composants du m√©lange et le type de matrice de covariance (le nombre de degr√©s de libert√© des Gaussiens), des donn√©es assez compliqu√©es peuvent √™tre d√©crites. <br><br><img src="https://habrastorage.org/webt/ni/je/-m/nije-mrfqiykrrfykphnafbyr5w.png" alt="image"><br><br>  Ainsi, nous savons comment param√©trer les donn√©es et sommes capables de former un mod√®le d'un m√©lange de distributions gaussiennes.  Maintenant, on pourrait essayer de faire un regroupement sur le front - la formation de GMM sur le MFCC extraite du dialogue.  Et, probablement, dans un certain dialogue sph√©rique-vide id√©al, dans lequel chaque locuteur s'int√©grera dans son gaussien, nous obtiendrons un bon r√©sultat.  Il est clair qu'en r√©alit√©, cela ne se produira jamais.  En fait, avec l'aide de GMM, ils ne mod√©lisent pas un dialogue, mais chaque personne dans un dialogue - c'est-√†-dire qu'ils imaginent que la voix de chaque locuteur dans les signes extraits est d√©crite par son propre ensemble de gaussiens. <br>  Pour r√©sumer, nous arrivons lentement au sujet principal. <br><br><h3>  Segmentation </h3><br>  Traditionnellement, le processus de diarisation se compose de trois blocs cons√©cutifs - d√©tection vocale (Voice Activity Detection), segmentation et clustering (il existe des mod√®les dans lesquels les deux derni√®res √©tapes sont combin√©es, voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LIA E-HMM</a> ). <br><br>  Dans la premi√®re √©tape, la parole est s√©par√©e de divers types de bruit.  L'algorithme VAD d√©termine si le morceau du fichier audio qui lui est soumis est un discours, ou par exemple, il sonne une sir√®ne ou quelqu'un √©ternue.  Il est clair que pour qu'un tel algorithme soit de haute qualit√©, une formation avec un enseignant est n√©cessaire.  Et cela signifie √† son tour que vous devez baliser les donn√©es - en d'autres termes, cr√©er une base de donn√©es avec des enregistrements de parole et toutes sortes de bruits.  Nous le ferons paresseusement - prenez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VAD</a> pr√™t √† l'emploi, qui ne fonctionne pas parfaitement, mais pour les d√©butants, nous en avons assez. <br><br>  Le deuxi√®me bloc coupe les donn√©es vocales en segments avec un locuteur actif.  L'approche classique √† cet √©gard est l'algorithme pour d√©terminer le changement de locuteur sur la base du crit√®re d'information bay√©sien - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BIC</a> .  L'essence de cette m√©thode est la suivante - une fen√™tre coulissante parcourt les enregistrements audio et √† chaque point du passage, ils r√©pondent √† la question: "Comment les donn√©es de cet endroit sont-elles mieux d√©crites - une distribution ou deux?"  Pour r√©pondre √† cette question, le param√®tre est calcul√© <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>B</mi><mi>I</mi><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.053ex" height="2.057ex" viewBox="0 -780.1 4759 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-44" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6C" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-42" x="2734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-49" x="3494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-43" x="3998" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>B</mi><mi>I</mi><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ Delta BIC </script>  , en fonction du signe dont la d√©cision est prise de changer de locuteur.  Le probl√®me est que cette m√©thode ne fonctionnera pas tr√®s bien en cas de changements de haut-parleur fr√©quents, et m√™me en pr√©sence de bruit (qui sont tr√®s caract√©ristiques pour l'enregistrement d'une conversation t√©l√©phonique). <br><br><div class="spoiler">  <b class="spoiler_title">Une petite explication</b> <div class="spoiler_text">  Dans l'original, j'ai travaill√© avec des enregistrements t√©l√©phoniques d'un centre d'appels d'une dur√©e moyenne d'environ 4 minutes.  Pour des raisons √©videntes, je ne peux pas poster ces notes, donc pour la d√©monstration j'ai pris <a href="">une</a> interview d'une station de radio.  Dans le cas d'un long entretien, cette m√©thode donnerait probablement un r√©sultat acceptable, mais elle n'a pas fonctionn√© sur mes donn√©es. <br></div></div><br>  Dans les conditions o√π les annonceurs ne s'interrompent pas et que leurs voix ne se chevauchent pas, le VAD que nous utiliserons fera plus ou moins face √† la t√¢che de segmentation, donc les deux premi√®res √©tapes ressembleront √† ceci. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  y_, sr = librosa.load('data/2018-08-26-beseda-1616.mp3', sr=SR) #   pre-emphasis:    pre_emphasis = 0.97 y = np.append(y[0], y[1:] - pre_emphasis * y[:-1]) #       webrtcvad    vad = webrtcvad.Vad(2) #  VAD audio = np.int16(y/np.max(np.abs(y)) * 32767) frames = frame_generator(10, audio, sr) frames = list(frames) segments = vad_collector(sr, 50, 200, vad, frames) if not os.path.exists('data/chunks'): os.makedirs('data/chunks') for i, segment in enumerate(segments): chunk_name = 'data/chunks/chunk-%003d.wav' % (i,) # vad      ,     write_wave(chunk_name, segment[0: len(segment)-int(100*sr/1000)], sr)</span></span></code> </pre><br>  En r√©alit√©, les gens parleront certainement en m√™me temps.  De plus, le VAD √† certains endroits a fait une erreur en raison du fait que le disque n'est pas en direct, mais est un collage dans lequel les pauses sont supprim√©es.  Vous pouvez essayer de r√©p√©ter la d√©coupe en segments, augmentant l'agressivit√© du VAD de 2 √† 3. <br><br><h3>  GMM-UBM </h3><br>  Nous avons maintenant des segments s√©par√©s et nous avons d√©cid√© de mod√©liser chaque haut-parleur √† l'aide de GMM.  Nous extrayons les signes du segment et sur ces donn√©es nous formons le mod√®le.  Faisons-le sur chaque segment et comparons les mod√®les r√©sultants entre eux.  Il est l√©gitime de s'attendre √† ce que les mod√®les form√©s sur des segments appartenant √† la m√™me personne soient quelque peu similaires.  Mais ici, nous sommes confront√©s au probl√®me suivant: en extrayant des signes d'un fichier audio d'une seconde de long avec une fr√©quence d'√©chantillonnage de 8000 Hz avec une taille de fen√™tre de 10 ms, nous obtenons un ensemble de 800 vecteurs MFCC.  Notre mod√®le ne pourra pas apprendre de telles donn√©es, car elles sont n√©gligeables.  M√™me si ce n'est pas une seconde, mais dix, les donn√©es ne seront toujours pas suffisantes.  Et ici, le mod√®le d'arri√®re-plan universel (UBM) vient √† la rescousse, il est √©galement appel√© ind√©pendant du locuteur.  L'id√©e est la suivante.  Nous formerons GMM sur un grand √©chantillon de donn√©es (dans notre cas, il s'agit d'un enregistrement d'interview complet) et nous obtiendrons un mod√®le acoustique d'un locuteur g√©n√©ralis√© (ce sera notre UBM).  Et puis, en utilisant un algorithme d'adaptation sp√©cial (√† ce sujet ci-dessous), nous ¬´adapterons¬ª ce mod√®le aux caract√©ristiques extraites de chaque segment.  Cette approche est largement utilis√©e non seulement pour la diarisation, mais aussi dans les syst√®mes de reconnaissance vocale.  Pour reconna√Ætre une personne par la voix, vous devez d'abord former un mod√®le sur elle et sans UBM, vous devriez avoir plusieurs heures d'enregistrement du discours de cette personne. <br><br>  De chaque GMM adapt√©, on extrait le vecteur des coefficients de cisaillement <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ mu </script>  (c'est aussi une attente m√©diane ou mat., si vous voulez) et, sur la base des donn√©es sur ces vecteurs de tous les segments, nous ferons un clustering (ci-dessous, il sera clair pourquoi il s'agit du vecteur de d√©calage). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8o/v1/gc/8ov1gcun9ic5sqshic7fvlg09wo.png" alt="image"></div><br><h3>  Adaptation de la carte </h3><br>  La m√©thode par laquelle nous personnaliserons l'UBM pour chaque segment est appel√©e adaptation maximale a posteriori.  En g√©n√©ral, l'algorithme est le suivant.  Premi√®rement, la probabilit√© post√©rieure est calcul√©e sur les donn√©es d'adaptation et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des statistiques suffisantes</a> pour le poids, la m√©diane et la variance de chaque gaussien.  Ensuite, les statistiques obtenues sont combin√©es avec les param√®tres UBM et les param√®tres du mod√®le adapt√© sont obtenus.  Dans notre cas, nous n'adapterons que les m√©dianes, sans affecter le reste des param√®tres.  Malgr√© le fait que j'ai promis de ne pas approfondir les math√©matiques, je citerai apr√®s tout trois formules, car l'adaptation MAP est le point cl√© de cet article. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>P</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.446ex" height="3.021ex" viewBox="0 -883.9 13969.9 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="1044" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-3D" x="1360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-66" x="2666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-72" x="3217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="3668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-63" x="4198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-31" x="4631" y="0"></use><g transform="translate(5132,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-73" x="6327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="6796" y="0"></use><g transform="translate(7369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-50" x="9507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-72" x="10259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-28" x="10710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="11100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-7C" x="11445" y="0"></use><g transform="translate(11724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-29" x="12652" y="0"></use><g transform="translate(13041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> E_ {i} = \ frac {1} {n_ {i}} \ sum_ {t = 1} ^ NPr (i | x_ {t}) x_ {t} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.817ex" height="2.66ex" viewBox="0 -832 16713 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-3D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-62" x="5346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="5776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="6242" y="0"></use><g transform="translate(6604,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="748" y="-213"></use></g><g transform="translate(7478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="1044" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-2B" x="8783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-28" x="9783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-31" x="10173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-2212" x="10896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-62" x="12146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="12576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="13042" y="0"></use><g transform="translate(13404,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-29" x="14278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="14917" y="0"></use><g transform="translate(15796,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ hat \ mu_ {i} = \ beta_ {i} E_ {i} + (1- \ beta_ {i}) \ mu_ {i} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>+</mo><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.627ex" height="3.021ex" viewBox="0 -987.6 10172.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1146" y="0"></use><g transform="translate(1507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-3D" x="2659" y="0"></use><g transform="translate(3715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-2F" x="4660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-28" x="5160" y="0"></use><g transform="translate(5550,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-2B" x="6717" y="0"></use><g transform="translate(7717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-62" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="783" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1249" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="1611" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-29" x="9783" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>+</mo><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ beta_ {i} = n_ {i} / (n_ {i} + r ^ {\ beta}) </script></p><br>  Ici <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.208ex" height="2.66ex" viewBox="0 -832 3534.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-72" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-28" x="1203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="1592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-7C" x="1938" y="0"></use><g transform="translate(2216,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMAIN-29" x="3144" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> Pr (i | x_ {t}) </script>  - probabilit√© post√©rieure, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.515ex" height="2.419ex" viewBox="0 -780.1 1082.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="1044" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> E_ {i} </script>  - statistiques suffisantes pour <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> \ mu </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.739ex" height="2.419ex" viewBox="0 -780.1 3762.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-9"> \ hat \ mu_ {i} </script>  - m√©diane du mod√®le adapt√©, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.531ex" height="2.419ex" viewBox="0 -780.1 2381.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1146" y="0"></use><g transform="translate(1507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-69" x="748" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-10"> \ beta_ {i} </script>  - coefficient d'adaptation, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.796ex" height="2.419ex" viewBox="0 -935.7 2065.1 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-62" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-65" x="783" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-74" x="1249" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-61" x="1611" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11"> r ^ {\ beta} </script>  - facteur de conformit√©. <br>  Si tout cela semble insens√© et provoque le d√©couragement - ne d√©sesp√©rez pas.  En effet, pour comprendre le fonctionnement de l'algorithme, il n'est pas n√©cessaire de se plonger dans ces formules; son fonctionnement peut √™tre facilement d√©montr√© par l'exemple suivant: <br><br><img src="https://habrastorage.org/webt/rj/fg/st/rjfgstiekke6cv1m8zc-d6s4kji.png" alt="image"><br><br>  Supposons que nous ayons des donn√©es suffisamment volumineuses et que nous avons form√© UBM sur celles-ci (image de gauche, UBM est un m√©lange √† deux composantes de distributions gaussiennes).  De nouvelles donn√©es apparaissent qui ne rentrent pas dans notre mod√®le (figure au milieu).  En utilisant cet algorithme, nous d√©placerons les centres des Gaussiens pour qu'ils se trouvent sur les nouvelles donn√©es (figure √† droite).  En appliquant cet algorithme aux donn√©es exp√©rimentales, nous nous attendons √† ce que sur les segments avec le m√™me locuteur, les Gaussiens se d√©placent dans une direction, formant ainsi des grappes.  C'est pourquoi nous utiliserons des donn√©es de cisaillement pour regrouper les segments <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> \ mu </script>  . <br><br>  Alors, faisons l'adaptation MAP pour chaque segment.  (Pour r√©f√©rence: en plus de l'adaptation MAP, la m√©thode MLLR - R√©gression lin√©aire par maximum de vraisemblance et certaines de ses modifications sont largement utilis√©es. Ils essaient √©galement de combiner ces deux m√©thodes.) <br><br><pre> <code class="python hljs">SV = [] <span class="hljs-comment"><span class="hljs-comment">#    chunk-000  chunk-100 for i in range(101): clear_output(wait=True) fname='data/chunks/chunk-%003d.wav' % (i,) print('UBM MAP adaptation for {0}'.format(fname)) y_, sr_ = librosa.load(fname, sr=None) f_ = extract_features(y_, sr_, window=N_FFT, hop=HOP_LENGTH, n_mfcc=N_MFCC) f_ = preprocessing.scale(f_) gmm = copy.deepcopy(ubm) gmm = map_adaptation(gmm, f_, max_iterations=1, relevance_factor=16) sv = gmm.means_.flatten() #   sv = preprocessing.scale(sv) SV.append(sv) SV = np.array(SV) clear_output() print(SV.shape)</span></span></code> </pre><br>  Maintenant que pour chaque segment, nous avons des donn√©es sur <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhi9RgF_o9WlX_GLfx3Lqh04Xt5aCg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> \ mu </script>  , nous passons enfin √† la derni√®re √©tape. <br><br><h3>  Regroupement spectral </h3><br>  Le regroupement spectral est bri√®vement d√©crit dans l'article, un lien auquel j'ai donn√© au tout d√©but.  L'algorithme construit un graphe complet, o√π les sommets sont nos donn√©es et les bords entre eux sont une mesure de similitude.  Dans les t√¢ches de reconnaissance vocale, une m√©trique de cosinus est utilis√©e comme telle mesure, car elle prend en compte l'angle entre les vecteurs, en ignorant leur amplitude (qui ne transporte pas d'informations sur le locuteur).  En construisant le graphique, les vecteurs propres de la matrice de Kirchhoff sont calcul√©s (qui est essentiellement une repr√©sentation du graphique r√©sultant) puis une m√©thode de regroupement standard est utilis√©e, par exemple, la m√©thode des k-moyennes.  Tout tient dans deux lignes de code <br><br><pre> <code class="python hljs">N_CLUSTERS = <span class="hljs-number"><span class="hljs-number">2</span></span> sc = SpectralClustering(n_clusters=N_CLUSTERS, affinity=<span class="hljs-string"><span class="hljs-string">'cosine'</span></span>) labels = sc.fit_predict(SV) <span class="hljs-comment"><span class="hljs-comment">#     , . [2,1,1,0,2] labels = rearrange(labels, N_CLUSTERS) #     [0,1,1,2,0] print(labels) #   , ,  1 -  .     print([i for i, x in enumerate(labels) if x == 1])</span></span></code> </pre><br><h3>  Conclusions et plans futurs </h3><br>  L'algorithme d√©crit a √©t√© test√© avec diff√©rents param√®tres: <br><br><ol><li>  Num√©ro MFCC: 7, 13, 20 </li><li>  MFCC en combinaison avec LPC </li><li>  Type et nombre de m√©langes dans GMM: complet [8, 16, 32], diag [8, 16, 32, 64, 256] </li><li>  M√©thodes d'adaptation UBM: MAP (avec covariance_type = 'full') et MLLR (avec covariance_type = 'diag') </li></ol><br>  En cons√©quence, les param√®tres sont rest√©s subjectivement optimaux: MFCC 13, GMM covariance_type = 'full' n_components = 16. <br><br>  Malheureusement, je n'ai pas eu la patience (j'ai commenc√© √† √©crire cet article il y a plus d'un mois) pour baliser les segments re√ßus et calculer le DER (Diariztion Error Rate).  Subjectivement, j'√©value le fonctionnement de l'algorithme comme ¬´en principe, pas mal, mais loin d'√™tre id√©al¬ª.  En regroupant les vecteurs obtenus √† partir des cent premiers segments (avec un passage MAP), puis en s√©lectionnant ceux o√π l'intervieweur dit (fille, elle parle beaucoup moins que l'invit√© l√†-bas), le regroupement donne une liste <math></math><img src="https://habrastorage.org/getpro/habr/formulas/b5f/5b8/c96/b5f5b8c962e564d107227d8156c32384.svg" alt="[1, 2, 25, 26, 46, 48, 49, 61, 85, 86] $" data-tex="inline">  c'est 100% touch√©.  Dans le m√™me temps, les segments o√π les deux haut-parleurs sont pr√©sents (par exemple, 14) abandonnent, mais cela peut d√©j√† √™tre attribu√© √† l'erreur VAD.  De plus, de tels segments commencent √† √™tre pris en compte avec une augmentation du nombre de passes MAP.  Un point important.  L'interview avec laquelle nous avons travaill√© est plus ou moins "propre".  Si divers inserts musicaux, bruits et autres choses non verbales sont ajout√©s, le regroupement commence √† boiter.  Par cons√©quent, il est pr√©vu d'essayer de former notre propre VAD (car webrtcvad, par exemple, ne s√©pare pas la musique de la parole). <br><br>  √âtant donn√© que j'avais initialement travaill√© avec une conversation t√©l√©phonique, je n'avais pas besoin d'estimer le nombre de locuteurs.  Mais le nombre de locuteurs n'est pas toujours pr√©d√©termin√©, m√™me s'il s'agit d'une interview.  Par exemple, dans <a href="">cette</a> interview au milieu, il y a une annonce superpos√©e √† la musique et exprim√©e par deux personnes suppl√©mentaires.  Par cons√©quent, il serait int√©ressant d'essayer la m√©thode d'estimation du nombre de locuteurs sp√©cifi√©e dans le premier article de la section de la liste de r√©f√©rences (bas√©e sur une analyse des valeurs propres de la matrice de Laplace normalis√©e). <br><br><h3>  Les r√©f√©rences </h3><br>  En plus des documents situ√©s sur les liens dans le texte et les ordinateurs portables Jupyter, les sources suivantes ont √©t√© utilis√©es pour pr√©parer cet article: <br><br><ol><li>  Diarisation des haut-parleurs √† l'aide du superviseur GMM et des algorithmes de r√©duction avanc√©s.  Nurit spingarn </li><li>  M√©thodes d'extraction des fonctionnalit√©s LPC, PLP et MFCC dans la reconnaissance vocale.  Namrata dave </li><li>  √âvaluation MAP pour les observations de m√©lange gaussien √† plusieurs variables des cha√Ænes de Markov.  Jean-Luc Gauvain et Chin-Hui Lee </li><li>  Sur l'analyse de regroupement spectral et un algorithme.  Andrew Y. Ng, Michael I. Jordan, Yair Weiss </li><li>  Reconnaissance du locuteur √† l'aide d'un mod√®le d'arri√®re-plan universel sur la base de donn√©es YOHO.  Alexandre Majetniak </li></ol><br>  J'ajouterai √©galement quelques projets de diarisation: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extension de</a> diarisation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sidekit</a> et s4d.  Une biblioth√®que python pour travailler avec la parole.  Malheureusement, la documentation est pauvre. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bob</a> et ses diff√©rentes parties telles que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bob.bio</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bob.learn.em</a> - une biblioth√®que python pour le traitement du signal et l'utilisation de donn√©es biom√©triques.  Windows n'est pas pris en charge. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LIUM</a> est une solution cl√© en main √©crite en Java. </li></ol><br>  Tout le code est affich√© sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> .  Pour plus de commodit√©, j'ai fabriqu√© plusieurs ordinateurs portables Jupyter avec une d√©monstration de certaines choses - MFCC, GMM, MAP Adaptation and Diarization.  Ce dernier est le processus principal.  Dans le r√©f√©rentiel se trouvent √©galement des fichiers de cornichons avec certains mod√®les pr√©-form√©s et l'interview elle-m√™me. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420515/">https://habr.com/ru/post/fr420515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420505/index.html">OpenAI Five remportera-t-il l'√©quipe professionnelle de l'International</a></li>
<li><a href="../fr420507/index.html">Contexte: l'Internet mondial pour tous et ses cr√©ateurs</a></li>
<li><a href="../fr420509/index.html">Un probl√®me √©vident avec l'utilisation de l'assertion</a></li>
<li><a href="../fr420511/index.html">Travailler en tant que sp√©cialiste informatique dans la r√©gion Extr√™me-Orient - Amour</a></li>
<li><a href="../fr420513/index.html">Une copie pirat√©e d'un service payant en 39 lignes de code Python</a></li>
<li><a href="../fr420517/index.html">Impl√©mentation FPGA de la FFT enti√®re</a></li>
<li><a href="../fr420519/index.html">Vulgarisation de la science</a></li>
<li><a href="../fr420521/index.html">Maintenant officiellement: TLS 1.3 reconnu comme standard</a></li>
<li><a href="../fr420523/index.html">Analyse des graphiques d'options binaires ou comment je me suis encore une fois prouv√© que les cadeaux n'existent pas</a></li>
<li><a href="../fr420525/index.html">Des r√©seaux pour les plus aguerris. Quinzi√®me partie. QoS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>