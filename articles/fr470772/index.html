<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤±ğŸ¾ ğŸ¥š ğŸ”­ TON: recommandations et bonnes pratiques â›ºï¸ ğŸŒ› ğŸ¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est la traduction d'un document publiÃ© sur la page blockchain de TON: smc-guidelines.txt . Peut-Ãªtre que cela aidera quelqu'un Ã  faire un ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TON: recommandations et bonnes pratiques</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470772/"><p>  Cet article est la traduction d'un document publiÃ© sur la page blockchain de TON: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">smc-guidelines.txt</a> .  Peut-Ãªtre que cela aidera quelqu'un Ã  faire un pas vers le dÃ©veloppement de cette blockchain.  De plus, Ã  la fin, j'ai fait un bref rÃ©sumÃ©. </p><a name="habracut"></a><br><h2 id="vnutrennie-soobscheniya">  Messages internes </h2><br><p>  Les contrats intelligents interagissent les uns avec les autres en envoyant des messages dits internes.  Lorsque le message interne atteint sa destination spÃ©cifiÃ©e, une transaction rÃ©guliÃ¨re est crÃ©Ã©e au nom du compte de destination et le message interne est traitÃ© selon le code spÃ©cifiÃ© et les donnÃ©es constantes de ce compte (contrat intelligent).  En particulier, une transaction de traitement peut crÃ©er un ou plusieurs messages internes, dont certains peuvent Ãªtre adressÃ©s Ã  l'adresse source du message interne en cours de traitement.  Cela peut Ãªtre utilisÃ© pour crÃ©er de simples Â«applications client-serveurÂ» lorsqu'une demande est intÃ©grÃ©e (encapsulÃ©e) dans un message interne et envoyÃ©e Ã  un autre contrat intelligent qui traite la demande et renvoie la rÃ©ponse, Ã  nouveau sous forme de message interne. </p><br><p> Cette approche conduit Ã  la nÃ©cessitÃ© de distinguer les messages internes Ã  "demander" et "rÃ©ponse" (en tant que "requÃªte" ou en tant que "rÃ©ponse"), ou qui ne nÃ©cessitent aucun traitement supplÃ©mentaire (comme un simple transfert d'argent).  De plus, lorsqu'une rÃ©ponse arrive, il doit y avoir un moyen de comprendre Ã  quelle demande elle se rapporte. </p><br><p>  Pour atteindre cet objectif, il est recommandÃ© d'utiliser le modÃ¨le de message interne suivant (rappelez-vous que la blockchain TON n'impose aucune restriction au corps du message, c'est-Ã -dire qu'il s'agit simplement d'une recommandation): </p><br><p>  0) Le corps du message peut Ãªtre intÃ©grÃ© dans le message lui-mÃªme, ou il peut Ãªtre stockÃ© dans une cellule distincte (cellule *), qui est rÃ©fÃ©rencÃ©e dans le message, comme indiquÃ© dans le fragment TL-B du diagramme (en anglais, il est plus facile Ã  comprendre: ou Ãªtre stockÃ© dans un autre cellule rÃ©fÃ©rencÃ©e dans le message, comme indiquÃ© par le fragment de schÃ©ma TL-B): </p><br><pre><code class="plaintext hljs">message$_ {X:Type} ... body:(Either X ^X) = Message X;</code> </pre> <br><p>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://core.telegram.org/mtproto</a> - ici vous pouvez lire sur les schÃ©mas TL) </p><br><p>  Le contrat intelligent de rÃ©ception doit accepter au moins les messages internes avec le corps du message intÃ©grÃ© (mÃªme s'ils sont placÃ©s dans la cellule contenant le message - chaque fois qu'ils s'insÃ¨rent dans la cellule contenant le message - il n'est pas trÃ¨s clair ce que cela signifie, par consÃ©quent, joint le texte d'origine).  Si le contrat accepte les corps de message dans des cellules distinctes (en utilisant le constructeur "droit" <code>(Either X ^X)</code> ), le traitement du message entrant ne devrait pas dÃ©pendre de la mÃ©thode particuliÃ¨re d'intÃ©gration du corps du message.  D'un autre cÃ´tÃ©, il est absolument lÃ©gal de ne pas prendre en charge le corps du message dans une cellule distincte pour simplifier les demandes et les rÃ©ponses. </p><br><p>  1) Le corps du message commence gÃ©nÃ©ralement par les champs suivants: </p><br><ul><li>  <em>op</em> - Entier non signÃ© 32 bits (big-endian) qui identifie l'opÃ©ration Ã  exÃ©cuter ou la mÃ©thode de contrat intelligent Ã  appeler. </li><li>  <em>query_id</em> est un entier non signÃ© 64 bits (big-endian) utilisÃ© dans tous les messages de questions et rÃ©ponses internes pour identifier la relation de la rÃ©ponse Ã  la demande (le <em>query_id de la</em> rÃ©ponse doit Ãªtre Ã©gal Ã  la <em>query_id de la</em> demande correspondante).  Si <em>op</em> n'est pas une mÃ©thode de demande-rÃ©ponse (il appelle une mÃ©thode Ã  partir de laquelle aucune rÃ©ponse n'est attendue), alors <em>query_id</em> peut Ãªtre omis. </li><li>  le reste du corps du message est spÃ©cifique Ã  chaque valeur prise en charge du paramÃ¨tre <em>op</em> </li></ul><br><p>  2) Si <em>op</em> est nul, le message est un simple message de transfert avec un commentaire.  Le commentaire est contenu dans le reste du message (sans <em>query_id</em> et ainsi de suite, c'est-Ã -dire Ã  partir du 5Ã¨me octet (explication: si <em>query_id</em> ne l' <em>est</em> pas, alors le champ <em>op</em> occupe les 4 premiers octets)).  S'il ne commence pas par l'octet 0xff, le commentaire est un texte;);  il peut Ãªtre affichÃ© pour l'utilisateur final du portefeuille "tel quel" (aprÃ¨s avoir filtrÃ© les caractÃ¨res invalides et de contrÃ´le et vÃ©rifiÃ© qu'il s'agit d'une chaÃ®ne UTF-8 valide).  Par exemple, les utilisateurs peuvent spÃ©cifier le but d'un simple transfert de leur portefeuille vers le portefeuille d'un autre utilisateur dans ce champ.  En revanche, si un commentaire commence par l'octet 0xff, le reste du message est un Â«commentaire binaireÂ» qui ne doit pas Ãªtre affichÃ© Ã  l'utilisateur final sous forme de texte (uniquement sous forme de vidage hexadÃ©cimal si nÃ©cessaire).  L'utilisation proposÃ©e des commentaires binaires, par exemple, est de contenir un identifiant de paiement pour le paiement dans le magasin, et d'Ãªtre automatiquement gÃ©nÃ©rÃ© et traitÃ© par le logiciel du magasin. </p><br><p>  La plupart des contrats intelligents n'ont pas Ã  effectuer d'actions non triviales ou Ã  rejeter un message entrant lorsqu'ils reÃ§oivent un Â«message de transfert simpleÂ».  Ainsi, lorsque <em>op</em> s'avÃ¨re Ãªtre nul, la fonction de contrat intelligent pour le traitement des messages internes entrants (gÃ©nÃ©ralement appelÃ©e <code>recv_internal()</code> ) doit immÃ©diatement se <code>recv_internal()</code> avec le code 0, indiquant le succÃ¨s (par exemple, lever l'exception 0 si un gestionnaire personnalisÃ© n'est pas installÃ© dans le contrat intelligent exceptions).  Cela entraÃ®nera le fait que le montant transfÃ©rÃ© par le message sera crÃ©ditÃ© sur le compte du destinataire sans autre effet. </p><br><p>  3) "Un simple transfert de message sans commentaires" a un corps vide (mÃªme sans le champ <em>op</em> ).  Les considÃ©rations ci-dessus s'appliquent Ã  ces messages.  Veuillez noter que ces messages doivent avoir leur propre corps intÃ©grÃ© dans la cellule de message. </p><br><p>  4) Nous nous attendons Ã  ce que le champ <em>op</em> des messages de demande ait le premier bit ("bit de poids fort", traduit comme le premier, cela peut Ãªtre incorrect, mais comme expliquÃ© plus tard, il devient clair) est vide, c'est-Ã -dire que la valeur du champ doit Ãªtre dans la plage <code>1 .. 2^31-1</code> , et pour les messages de rÃ©ponse, le premier bit (de poids fort) doit Ãªtre Ã©gal Ã  1, c'est-Ã -dire la valeur de champ dans la plage <code>2^31 .. 2^32-1</code> .  Si le message n'est ni une demande ni une rÃ©ponse (le corps ne contient pas le paramÃ¨tre <em>query_id</em> ), il doit contenir le paramÃ¨tre <em>op</em> dans la plage comme dans le message de demande: <code>1 .. 2^31 - 1</code> . </p><br><p>  5) Il existe plusieurs messages de rÃ©ponse Â«standardÂ» pour lesquels <em>op</em> est 0xffffffff et 0xffffffffe.  En gÃ©nÃ©ral, les valeurs <em>op</em> de 0xfffffff0 Ã  0xffffffff sont rÃ©servÃ©es pour de telles rÃ©ponses standard. </p><br><ul><li>  <em>op = 0xffffffff</em> signifie "l'opÃ©ration n'est pas prise en charge".  Il est suivi d'un <em>ID</em> de requÃªte 64 bits extrait de la requÃªte d'origine et d'un <em>op</em> 32 bits <em>de la</em> requÃªte d'origine.  Tous les contrats intelligents, sauf les plus simples, doivent renvoyer cette erreur lorsqu'ils reÃ§oivent une demande avec un <em>op</em> inconnu dans la plage 1 ... 2 ^ 31-1. </li><li>  <em>op = 0xfffffffe</em> signifie "opÃ©ration non autorisÃ©e".  Il est suivi par l' <em>identifiant de</em> requÃªte 64 bits <em>de la</em> requÃªte d'origine, puis par l'opÃ©ration 32 bits extraite de la requÃªte d'origine. </li></ul><br><p>  Notez que les "rÃ©ponses" inconnues (avec <em>op</em> dans la plage 2 ^ 31 ... 2 ^ 32-1) doivent Ãªtre ignorÃ©es (en particulier, vous ne devez pas gÃ©nÃ©rer de rÃ©ponse avec <em>op</em> Ã©gal Ã  0xffffffff), ainsi qu'un retour inattendu ( messages rebondis (avec le drapeau "rebondi"). </p><br><h2 id="oplata-za-obrabotku-zaprosov-i-otpravlenie-otvetov">  Paiement pour le traitement des demandes et l'envoi des rÃ©ponses </h2><br><p>  En gÃ©nÃ©ral, si un contrat intelligent souhaite envoyer une demande Ã  un autre contrat intelligent, il doit payer pour envoyer un message interne au contrat intelligent cible (frais de transfert de message), pour traiter ce message Ã  destination (frais de gaz: frais de gaz) et pour l'envoi d'une rÃ©ponse si nÃ©cessaire (frais d'envoi de messages). </p><br><p>  Dans la plupart des cas, l'expÃ©diteur attachera une petite quantitÃ© de gramme au message interne (par exemple, 1 gramme) (assez pour payer pour le traitement de ce message) et dÃ©finira le drapeau "rebond" dessus (c'est-Ã -dire qu'il enverra un message interne rebondissable);  le destinataire retournera la partie inutilisÃ©e de la valeur reÃ§ue avec la rÃ©ponse (en soustrayant les frais d'envoi du message).  Ceci est gÃ©nÃ©ralement rÃ©alisÃ© en appelant SENDRAWMSG avec mode = 64 (cf. Annexe A de la documentation TON VM). </p><br><p>  Si le destinataire ne peut pas traiter le message reÃ§u et que l'exÃ©cution se termine avec un code de sortie diffÃ©rent de zÃ©ro (par exemple, en raison d'une exception de dÃ©sÃ©rialisation de cellule non gÃ©rÃ©e), le message sera automatiquement Â«renvoyÃ©Â» Ã  l'expÃ©diteur et l'indicateur Â«rebondÂ» sera dÃ©cochÃ© et dÃ©fini. drapeau "rebondi".  Le corps du message renvoyÃ© sera le mÃªme que le message d'origine;  par consÃ©quent, il est important de vÃ©rifier l'indicateur "renvoyÃ©" du message interne entrant avant d'analyser le champ <em>op</em> dans le contrat intelligent et de traiter la demande correspondante (sinon il existe un risque que la demande contenue dans le message renvoyÃ© soit traitÃ©e par son expÃ©diteur d'origine comme une nouvelle demande distincte).  Si l'indicateur "rebondi" est dÃ©fini, un code spÃ©cial peut comprendre quelle demande a Ã©chouÃ© (par exemple, en dÃ©sÃ©rialisant <em>op</em> et <em>query_id Ã </em> partir d'un message renvoyÃ©) et prendre les mesures appropriÃ©es.  Un contrat intelligent plus simple peut simplement ignorer tous les messages retournÃ©s (se terminer par un code de sortie nul si l'indicateur "rebondi" est dÃ©fini). </p><br><p>  D'un autre cÃ´tÃ©, le rÃ©cepteur peut analyser correctement la demande entrante et constater que la mÃ©thode <em>op</em> demandÃ©e n'est pas prise en charge ou qu'une autre condition d'erreur a Ã©tÃ© remplie.  Ensuite, une rÃ©ponse avec <em>op</em> Ã©gal Ã  0xffffffff ou une autre valeur appropriÃ©e doit Ãªtre renvoyÃ©e en utilisant SENDRAWMSG avec mode = 64, comme mentionnÃ© ci-dessus. </p><br><p>  Dans certaines situations, l'expÃ©diteur souhaite transfÃ©rer une certaine somme d'argent en mÃªme temps?  Ã  l'expÃ©diteur?  (ici, apparemment, une erreur, et Ã©tait destinÃ© au "destinataire") et recevoir soit une confirmation soit un message d'erreur.  Par exemple, un contrat intelligent d'Ã©lections de validateur reÃ§oit une demande de participation Ã  une Ã©lection ainsi qu'une offre en tant que valeur ajoutÃ©e.  Dans de tels cas, il est logique d'attacher, par exemple, un gramme supplÃ©mentaire Ã  la valeur estimÃ©e [coÃ»t] (Ici, le mot valeur est utilisÃ© partout, dans le sens de paiement pour une action, j'ai donc utilisÃ© le mot "coÃ»t").  Si une erreur se produit (par exemple, l'offre ne peut Ãªtre acceptÃ©e pour une raison quelconque), le montant total reÃ§u (moins les frais de traitement) doit Ãªtre retournÃ© Ã  l'expÃ©diteur avec le message d'erreur (par exemple, en utilisant SENDRAWMSG avec le mode = 64, comme dÃ©crit ci-dessus).  En cas de succÃ¨s, un message de confirmation est crÃ©Ã© et exactement un gramme est renvoyÃ© (les frais de transfert du message sont soustraits de cette valeur; il s'agit du mode = 1 de SENDRAWMSG). </p><br><h2 id="ispolzovanie-nevozvratnyh-non-bounceable-soobscheniy">  Utilisation de messages non rebondissables </h2><br><p>  Presque tous les messages internes envoyÃ©s entre les contrats intelligents doivent Ãªtre retournÃ©s (vous pouvez le traduire par "rebondir", mais afin de ne pas vous tromper, il est plus facile d'utiliser cette terminologie), c'est-Ã -dire qu'ils doivent avoir le bit "rebond" non vide.  Ensuite, si le contrat intelligent cible n'existe pas ou s'il crÃ©e une exception non gÃ©rÃ©e lors du traitement de ce message, le message sera Â«renvoyÃ©Â» en retour, supportant le reste du coÃ»t initial (valeur) (moins tous les frais de transmission des messages et du gaz).  Le message renvoyÃ© aura le mÃªme corps, mais avec le drapeau "bounce" effacÃ© et le drapeau "bounce" dÃ©fini.  Par consÃ©quent, tous les contrats intelligents doivent vÃ©rifier le drapeau "rebondi" de tous les messages entrants et les recevoir en silence (se terminant immÃ©diatement avec un code de sortie nul) ou effectuer un traitement spÃ©cial pour dÃ©terminer quelle demande sortante a Ã©chouÃ©.  La demande contenue dans le corps du message renvoyÃ© ne doit jamais Ãªtre exÃ©cutÃ©e. </p><br><p>  Dans certains cas, des messages internes non rebondissants doivent Ãªtre utilisÃ©s.  Par exemple, un nouveau compte ne peut pas Ãªtre crÃ©Ã© sans qu'au moins un message interne irrÃ©vocable ne lui soit envoyÃ©.  Si ce message ne contient pas StateInit avec le code et les donnÃ©es du nouveau contrat intelligent, cela n'a aucun sens d'avoir un corps non vide dans un message interne non retournÃ©. </p><br><p>  C'est une bonne idÃ©e de ne pas permettre Ã  l'utilisateur final (par exemple, le portefeuille) d'envoyer des messages irrÃ©vocables qui contiennent une grande quantitÃ© (par exemple, plus de cinq grammes), ou au moins de les avertir s'ils essaient de le faire.  Il est prÃ©fÃ©rable d'envoyer d'abord un petit montant, puis de crÃ©er un nouveau contrat intelligent, puis d'envoyer un montant plus important. </p><br><h2 id="vneshnie-soobscheniya">  Messages externes </h2><br><p>  Les messages externes sont envoyÃ©s en externe aux contrats intelligents situÃ©s sur la blockchain TON pour les forcer Ã  effectuer certaines actions.  Par exemple, le contrat intelligent du portefeuille s'attend Ã  recevoir des messages externes contenant des commandes (par exemple, des messages internes qui seront envoyÃ©s Ã  partir du contrat intelligent du portefeuille) signÃ©s par le propriÃ©taire du portefeuille;  lorsqu'un tel message externe est reÃ§u par le contrat intelligent du portefeuille, il vÃ©rifie d'abord la signature, puis reÃ§oit le message (en lanÃ§ant la primitive TVM ACCEPT), puis effectue toutes les actions nÃ©cessaires. </p><br><p>  Veuillez noter que tous les messages externes doivent Ãªtre protÃ©gÃ©s contre les attaques par rejeu.  Les validateurs suppriment gÃ©nÃ©ralement un message externe du pool de messages externes proposÃ©s (reÃ§us du rÃ©seau);  cependant, dans certaines situations, un autre validateur peut traiter deux fois le mÃªme message externe (crÃ©ant ainsi une deuxiÃ¨me transaction pour le mÃªme message externe, ce qui conduit Ã  la duplication de l'action d'origine).  Pire encore, un attaquant peut extraire un message externe d'un bloc contenant une transaction de traitement et le renvoyer ultÃ©rieurement.  Cela peut entraÃ®ner, par exemple, un contrat de portefeuille intelligent pour rÃ©pÃ©ter le paiement. </p><br><p>  Le moyen le plus simple de protÃ©ger les contrats intelligents contre les attaques de reniflement associÃ©es aux messages externes consiste Ã  stocker le <em>compteur cur-seqno</em> 32 bits dans les donnÃ©es constantes du contrat intelligent et Ã  attendre la <em>valeur req-seqno</em> dans la (partie signÃ©e) de tous les messages externes entrants.  Le message externe n'est alors acceptÃ© (ACCEPTÃ‰ - un indice de la primitive ACCEPT) que si la signature est valide et que <em>req-seqno</em> est Ã©gal Ã  <em>cur-seqno</em> .  AprÃ¨s un traitement rÃ©ussi, la valeur de <em>cur-seqno</em> dans les donnÃ©es persistantes augmente de un, de sorte que le mÃªme message externe ne sera plus jamais reÃ§u. </p><br><p>  Vous pouvez Ã©galement inclure le champ <em>expirer Ã </em> dans un message externe et accepter le message uniquement si l'heure Unix actuelle est infÃ©rieure Ã  la valeur de ce champ.  Cette approche peut Ãªtre utilisÃ©e en combinaison avec <em>seqno</em> ;  en variante, le contrat intelligent de rÃ©ception peut stocker un ensemble (hachages) de tous les derniers messages externes reÃ§us (non expirÃ©s) dans ses donnÃ©es permanentes et rejeter un nouveau message externe s'il s'agit d'un doublon de l'un des messages enregistrÃ©s.  Vous devez Ã©galement implÃ©menter la collecte et la suppression des messages expirÃ©s dans cet ensemble pour Ã©viter une croissance illimitÃ©e des donnÃ©es persistantes. </p><br><p>  En rÃ¨gle gÃ©nÃ©rale, un message externe commence par une signature 256 bits (si nÃ©cessaire), une <em>requÃªte req-seqno</em> 32 bits (si nÃ©cessaire), une <em>expiration</em> 32 bits (si nÃ©cessaire), et Ã©ventuellement une opÃ©ration 32 bits et d'autres paramÃ¨tres nÃ©cessaires dans selon <em>op</em> .  Le modÃ¨le de message externe ne doit pas Ãªtre aussi standardisÃ© que le modÃ¨le de message interne, car les messages externes ne sont pas utilisÃ©s pour l'interaction entre diffÃ©rents contrats intelligents (Ã©crits par diffÃ©rents dÃ©veloppeurs et gÃ©rÃ©s par diffÃ©rents propriÃ©taires). </p><br><h2 id="get-metody">  Obtenir des mÃ©thodes </h2><br><p>  Certains contrats intelligents devraient implÃ©menter certaines mÃ©thodes get bien dÃ©finies.  Par exemple, tout contrat intelligent de rÃ©solution DNS pour TON DNS devrait implÃ©menter la mÃ©thode get dnsresolve.  Les contrats intelligents personnalisÃ©s peuvent dÃ©finir leurs mÃ©thodes d'obtention spÃ©cifiques.  Notre seule recommandation gÃ©nÃ©rale pour le moment est d'implÃ©menter la mÃ©thode get "seqno" (sans paramÃ¨tres), qui renvoie le <em>seqno</em> actuel <em>du</em> contrat intelligent, qui utilise des numÃ©ros de sÃ©quence pour empÃªcher les attaques de lecture associÃ©es aux mÃ©thodes externes entrantes chaque fois qu'une telle mÃ©thode a sens. </p><br><p>  Dictionnaire: </p><br><ul><li>  Cellule - Une cellule TVM se compose d'au plus 1023 bits de donnÃ©es et d'au plus quatre rÃ©fÃ©rences Ã  d'autres cellules.  Toutes les donnÃ©es persistantes (y compris le code TVM) dans la blockchain TON sont reprÃ©sentÃ©es comme une collection de cellules TVM (cf. [1, 2.5.14]).  - une cellule TVM ne comprend pas plus de 1 023 bits de donnÃ©es et pas plus de quatre liens vers d'autres cellules.  Toutes les donnÃ©es persistantes (y compris le code TVM) dans la blockchain TON sont prÃ©sentÃ©es comme un ensemble de cellules TVM (cf. [1, 2.5.14]).  - extrait de la description de la machine virtuelle TON ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://test.ton.org/tvm.pdf</a> ) </li></ul><br><h2 id="kakie-mozhno-sdelat-vyvody-na-osnove-prochitannogo">  Quelles conclusions peut-on tirer sur la base de ce que j'ai lu? </h2><br><ol><li>  Vous pouvez envoyer des messages externes aux contrats pour dÃ©clencher une action. </li><li>  Attaques - il y a, par exemple, des attaques par rejeu </li><li>  Cela vaut la peine dâ€™ <em>utiliser la</em> mÃ©thode <em>seqno</em> pour se protÃ©ger contre les attaques par rejeu. </li><li>  Les rÃ©solveurs DNS ont la mÃ©thode dnsresolve </li><li>  Vous pouvez stocker des hachages de messages externes pour vous protÃ©ger contre les attaques, mais vous devez les supprimer Ã  temps, pour cela, il vaut la peine d'utiliser le champ <em>expired_at</em> pour les messages externes </li><li>  Les messages de non-retour ne sont nÃ©cessaires que pour crÃ©er des contrats; sinon, tous les messages internes sont renvoyÃ©s </li><li>  Les messages de demande-rÃ©ponse doivent contenir les champs suivants: <em>op, query_id</em> - facultatif, et certains autres en fonction de la valeur de <em>op</em> </li><li>  Vous pouvez joindre des commentaires de texte au format UTF-8 pour les personnes et des Â«commentaires binairesÂ» pour une lecture et un traitement automatiques par un logiciel tiers. </li><li>  Cela vaut la peine de gÃ©rer les exceptions et de le faire judicieusement </li><li>  "Message simple sans commentaires" - doit avoir un corps vide </li><li>  Le bit de poids fort des messages de rÃ©ponse Ã  la demande prend une valeur de 0 pour les messages de demande et une valeur de 1 pour les messages de rÃ©ponse </li><li>  Il existe des valeurs opÃ©rationnelles standard pour les messages de rÃ©ponse afin d'identifier les erreurs </li><li>  Si un message de rÃ©ponse est reÃ§u avec une opÃ©ration inconnue, il doit Ãªtre ignorÃ©, c'est-Ã -dire terminer l'exÃ©cution avec le code 0 </li><li>  Vous devez payer pour envoyer des messages, pour le gaz et pour envoyer une rÃ©ponse.  Dans le mÃªme temps, s'il a envoyÃ© plus que nÃ©cessaire, l'excÃ©dent reviendra dans la rÃ©ponse. </li><li>  Lors de la rÃ©ception de messages, il est toujours utile de vÃ©rifier d'abord le drapeau <em>rebondi.</em> </li></ol><br><p>  Merci de votre attention, je serai heureux de recevoir des commentaires constructifs! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr470772/">https://habr.com/ru/post/fr470772/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr470750/index.html">Amazon a attrapÃ© les meilleurs produits</a></li>
<li><a href="../fr470752/index.html">Analyse des paiements Wechat</a></li>
<li><a href="../fr470754/index.html">Chatbot RASA: ExpÃ©rience Parallels</a></li>
<li><a href="../fr470756/index.html">CrÃ©ation d'une application backend pour le chat en ligne Apollo, Node.js</a></li>
<li><a href="../fr470758/index.html">AperÃ§u de l'activitÃ© virale en septembre 2019</a></li>
<li><a href="../fr470774/index.html">Nouvelles annotations de type dans Python 3.8 (protocole, final, TypedDict, littÃ©ral)</a></li>
<li><a href="../fr470778/index.html">Revue du disque Seagate ST2000DM008: Â«deuxÂ» rapides sans surprix</a></li>
<li><a href="../fr470780/index.html">La barre est prise - la nouvelle de Seagate pour le stockage</a></li>
<li><a href="../fr470782/index.html">Les donnÃ©es Ã  la frontiÃ¨re: comment crÃ©er une nouvelle architecture informatique</a></li>
<li><a href="../fr470784/index.html">La conception des couleurs des mondes mystÃ©rieux de Dead Cells</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>