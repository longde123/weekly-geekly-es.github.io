<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ…ğŸ¿ ğŸ‡ğŸ» ğŸ¼ Memantau aplikasi dengan Logger.Backends ğŸ‘‰ğŸ¾ ğŸ•´ğŸ¾ ğŸ›³ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Elixir memanfaatkan sepenuhnya infrastruktur logging Erlang untuk membuat log. Dimulai dengan versi 1.10 , yang akan dirilis dalam waktu dekat, fungsi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memantau aplikasi dengan Logger.Backends</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482626/"><p>  <em>Elixir</em> memanfaatkan sepenuhnya infrastruktur logging <em>Erlang</em> untuk membuat log.  Dimulai dengan versi <em>1.10</em> , yang akan dirilis dalam waktu dekat, fungsi-fungsi logging pengguna baru yang muncul di <em>Erlang / OTP 21+</em> tersedia untuk kami. </p><br><p> Sementara <em>OTP</em> menyediakan seluruh infrastruktur untuk mengirimkan acara jurnal (acara) kepada pelanggan, mencatatnya sendiri, jika dipahami sebagai <em>menyimpan</em> dan / atau <em>menampilkan</em> acara jurnal, harus dilaksanakan oleh aplikasi.  Untuk tujuan ini, abstraksi yang sesuai dari <code>Logger.Backend</code> . </p><a name="habracut"></a><br><p>  Berikut kutipan dari dokumentasi resmi: </p><br><blockquote>  <code>Logger</code> mendukung berbagai backend di mana pesan log ditulis. <br><br>  Backend yang tersedia secara default terbatas pada satu: <br><ul><li>  <code>:console</code> - mencatat pesan ke konsol (diaktifkan secara default) </li></ul><br><br>  Setiap pengembang dapat membuat menuai sendiri seperti backend untuk <code>Logger</code> .  Karena <code>Logger</code> adalah manajer acara yang menerapkan perilaku Erlang <code>:gen_event</code> , menulis backend baru hanyalah masalah membuat pengendali acara Anda sendiri, seperti yang dijelaskan dalam dokumentasi untuk <code>:gen_event</code> . </blockquote><p>  Backend yang digunakan dimuat melalui bagian <code>:backends</code> dalam file konfigurasi, yang harus diproses sebelum meluncurkan aplikasi <code>:logger</code> . </p><br><p>  Pendekatan paling umum yang melahirkan banyak jenis perpustakaan <a href="https://hex.pm/" rel="nofollow"><code>hex.pm</code></a> sama adalah membuat <code>Logger.Backend</code> , yang memahami dan meludahkan konsol JSON, dan mengacaukan beberapa jenis pengiriman log ke tempat Anda membutuhkannya (biasanya itu semacam <code>LaaS</code> ) .  Dengan demikian, semua log biasanya berakhir di <em>basis data NoSQL</em> , seperti <em>Elastis</em> , atau yang serupa. </p><br><p>  Kami tidak menjadi orisinal, dan kami juga menyimpan log kami di <em>Elastik</em> , tetapi sekarang log saja tidak cukup: anak laki-laki modis modern berpegang teguh pada semua pesan dalam log - metrik untuk segala sesuatu tentang segala hal.  Standar de facto untuk bekerja dengan metrik dalam aplikasi <em>OTP</em> baru-baru ini adalah perpustakaan <a href="https://www.erlang-solutions.com/blog/introducing-telemetry.html" rel="nofollow">Telemetri</a> , proyek open source yang relatif baru yang bertujuan menyatukan dan menstandarisasi bagaimana perpustakaan dan aplikasi BEAM <em>diinstrumentasi</em> dan <em>dikendalikan</em> . </p><br><p>  Pendekatan yang diadopsi oleh <em>Telemetri</em> sederhana ke <a href="https://hexdocs.pm/telemetry/telemetry.html" rel="nofollow"><code>:telemetry.execute/2</code></a> ngeri: kita sebut <a href="https://hexdocs.pm/telemetry/telemetry.html" rel="nofollow"><code>:telemetry.execute/2</code></a> setiap kali ada kebutuhan untuk mengukur sesuatu dalam aplikasi, dan perpustakaan merespons dengan callback yang terdaftar pada awal aplikasi.  Selain itu, dimungkinkan untuk melampirkan <a href="https://hexdocs.pm/telemetry_poller" rel="nofollow"><code>Telemetry.Poller</code></a> dan melakukan permintaan metrik secara berkala.  Contoh dalam artikel yang saya berikan tautan di atas menyarankan untuk memanggil <a href="https://hexdocs.pm/logger/Logger.html" rel="nofollow"><code>Logger.log/3</code></a> dari pengendali acara <em>Telemetri</em> internal. </p><br><h3 id="gelato"> <code>Gelato</code> </h3> <br><p>  Saya benci kode boilerplate yang harus Anda seret copy-paste dari proyek ke proyek, dari file ke file.  Saya ingin semua yang dapat dilakukan oleh kompiler, penjadwal, dan pekerja dilakukan sehingga saya bahkan tidak memikirkannya.  Untuk melakukan ini, saya sering mengemas kode boilerplate ke perpustakaan kecil yang menyembunyikan semua <em>boilerplate yang</em> diperlukan di bawah tenda dan menyediakan antarmuka yang bersih untuk melakukan tindakan yang diperlukan oleh aplikasi kita.  Saya hanya ingin sesuatu yang dapat disebut <code>report("message", payload)</code> untuk membuat catatan, menambahkan data telemetri, dan mengirimkan catatan ini ke repositori elastis kami. </p><br><p>  Ternyata ini tidak begitu sulit untuk dilakukan. </p><br><p>  Kami memutuskan untuk menggunakan panggilan <code>Logger</code> standar sebagai antarmuka, sehingga hanya dengan mengubah konfigurasi kami dapat memperkenalkan fungsionalitas yang diinginkan ke dalam proyek yang ada.  Cukup tambahkan <code>Logger.Backend</code> baru. <code>Logger.Backend</code> ke proyek yang ada: </p><br><pre> <code class="ruby hljs">config <span class="hljs-symbol"><span class="hljs-symbol">:logger</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">backends:</span></span> [Our.Fancy.Logger.Backend]</code> </pre> <br><p>  - dan voila - log dengan telemetri sekarang dikirim ke bunker elastis. </p><br><p>  Dan jadi perpustakaan <a href="https://hexdocs.pm/gelato/" rel="nofollow"><code>Gelato</code></a> muncul.  Saya tahu bahwa pengembang yang serius dan keras seperti perpustakaan dapat disebut sedikit kurang esoteris, tapi saya bukan pengembang yang nyata.  Apa, Anda harus berdamai.  Meskipun, <em>gelato</em> (dalam bahasa Spanyol - es krim, omong-omong) bahkan sedikit selaras dengan elastisitas. </p><br><p>  Perpustakaan sangat fokus pada bagaimana saya melihat dunia yang tepat, dan di ekor dan surai menggunakan pendekatan "konvensi di atas konfigurasi".  Ini mengemas semua yang Anda butuhkan ke dalam satu <em>JSON</em> dan mengirimkannya ke server elastis pra-konfigurasi dengan permintaan HTTP sederhana.  Itu juga melampirkan semua metadata yang bisa dijangkau, seperti metrik yang diperoleh menggunakan <a href="https://hexdocs.pm/elixir/master/Process.html%3F" rel="nofollow"><code>Process.info/1</code></a> , dll. </p><br><p>  Untuk mulai menggunakan pustaka ini dalam suatu proyek, Anda perlu menambahkan berikut ini ke file <code>config/releases.exs</code> : </p><br><pre> <code class="ruby hljs">config <span class="hljs-symbol"><span class="hljs-symbol">:gelato</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">uri:</span></span> <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:9200"</span></span>, <span class="hljs-comment"><span class="hljs-comment"># Elastic API endoint events: [:foo, :bar], # attached telemetry events handler: :elastic # or :console for tests config :logger, backends: [Gelato.Logger.Backend], level: :info</span></span></code> </pre> <br><p>  Setelah itu, panggilan <code>Logger.log/3</code> apa pun seperti yang di bawah ini akan dikirimkan oleh <code>telemetry</code> dan dikirim ke server elastis yang dikonfigurasi. </p><br><pre> <code class="ruby hljs">Logger.info <span class="hljs-string"><span class="hljs-string">"foo"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">question:</span></span> <span class="hljs-string"><span class="hljs-string">"why?"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">answer:</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">now:</span></span> System.monotonic_time(<span class="hljs-symbol"><span class="hljs-symbol">:microsecond</span></span>)</code> </pre> <br><p>  Pustaka lain adalah makro <a href="https://hexdocs.pm/gelato/Gelato.html" rel="nofollow"><code>Gelato.bench/4</code></a> , yang mengambil blok dan membuat dua panggilan ke <code>Logger.log/3</code> : satu sebelum blok dieksekusi dan yang lainnya segera setelah itu, berdasarkan jenis aspek di Jawa. </p><br><p>  <code>Gelato</code> diam-diam menekankan pengorganisasian antarmuka yang lebih baik dalam proyek menggunakan makro <a href="https://hexdocs.pm/gelato/Gelato.html" rel="nofollow"><code>Gelato.defdelegatelog/2</code></a> , komposisi sederhana <code>Gelato.bench/4</code> dan <code>Kernel.defdelegate/2</code> .  Dengan menggunakan makro ini, Anda dapat mengekstrak semua antarmuka proyek ke dalam set terbatas modul tingkat atas dan membuat panggilan ini dicatat dengan telemetri di luar kotak. </p><br><h3 id="enviolog"> <code>EnviÌo.Log</code> </h3> <br><p>  Implementasi <code>Logger.Backend</code> lain. <code>Logger.Backend</code> yang lahir di sudut hasrat teknologi kami adalah <a href="https://hexdocs.pm/envio_log" rel="nofollow"><code>EnviÌo.Log</code></a> .  Ia menggunakan perpustakaan <a href="https://hexdocs.pm/envio" rel="nofollow"><code>EnviÌo</code></a> untuk mengirim pesan ke saluran <em>Slack</em> khusus.  Logger ini memiliki pengaturan <code>log_level</code> sendiri, yang nilainya biasanya diatur ke <code>:warn</code> atau <code>:error</code> , untuk mencegah <em>Slack</em> channel dari spamming, dan semua panggilan pada level yang kurang terkonfigurasi akan dihapus dari <em>BEAM</em> selama kompilasi. </p><br><p>  Konfigurasi tipikal akan terlihat seperti ini: </p><br><pre> <code class="ruby hljs">config <span class="hljs-symbol"><span class="hljs-symbol">:envio</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:log</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">level:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:warn</span></span>, <span class="hljs-comment"><span class="hljs-comment"># do not send :info to Slack process_info: false # do not attach process info config :logger, backends: [Envio.Log.Backend], level: :debug config :envio, :backends, %{ Envio.Slack =&gt; %{ {Envio.Log.Publisher, :info} =&gt; [ hook_url: {:system, "YOUR_SLACK_CHANNEL_API_ENDPOINT"} ] } }</span></span></code> </pre> <br><p>  Setelah konfigurasi, semua panggilan ke <code>Logger.{warn,error}/2</code> akan dikirim ke saluran <em>Slack yang</em> sesuai.  Sangat nyaman untuk memantau proses kerja dalam produksi secara real time. </p><br><p>  Selamat logging! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id482626/">https://habr.com/ru/post/id482626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id482612/index.html">Menyentuh busi-board teknik, Tahun Baru dan sukarelawan</a></li>
<li><a href="../id482614/index.html">Apakah menggunakan BSP di Doom benar-benar langkah yang cerdas?</a></li>
<li><a href="../id482616/index.html">Foreve Elon 2019/2020 (NY2020 online meeting)</a></li>
<li><a href="../id482620/index.html">Slurm: Habr, selamat berlibur ...</a></li>
<li><a href="../id482622/index.html">Simulasi berlari di tengah hujan</a></li>
<li><a href="../id482628/index.html">Tonton "Laba-laba Kecil Hijau"</a></li>
<li><a href="../id482634/index.html">Tetapi esensinya adalah sesuatu, atau Meminimalkan kode sumber lebih mudah daripada kedengarannya.</a></li>
<li><a href="../id482636/index.html">Pengalaman dalam masuk ke magistrasi di Jerman (analisis rinci)</a></li>
<li><a href="../id482642/index.html">OSCD: Sprint Detection Ancaman # 1, hasil</a></li>
<li><a href="../id482644/index.html">Keylogger untuk Windows dengan perubahan hak di DACL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>