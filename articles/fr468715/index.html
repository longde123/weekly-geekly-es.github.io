<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏻 🙆🏿 🧑🏿 Expérience de développement de test React pour Aviasales 🦑 ⏮️ 👽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut, je voulais partager mon expérience dans le développement d'un cas de test pour Aviasales. 


 Je suis récemment tombé sur un emploi de développ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Expérience de développement de test React pour Aviasales</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468715/"><p>  Salut, je voulais partager mon expérience dans le développement d'un cas de test pour Aviasales. </p><br><p> Je suis récemment tombé sur un emploi de développeur React chez Aviasales.  J'ai envoyé une demande, après quoi le lendemain, les RH m'ont répondu et m'ont informé que je devrais faire une tâche de test.  Je n'aime vraiment pas faire de tâches de test, car je dois consacrer beaucoup de temps à leur mise en œuvre, et en cas d'échec, cela sera perdu.  Mais j'ai accepté ... </p><a name="habracut"></a><br><p>  Vous pouvez trouver la tâche de test ici sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> . </p><br><p>  Voici un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> vers mon référentiel de la tâche terminée. </p><br><p>  Je me suis limité à terminer la mission en une journée (bien que j'aie apporté des améliorations mineures après la publication: j'ai terminé le croquis, pour ainsi dire). </p><br><p>  Ce que j'ai choisi pour le développement: </p><br><ol><li>  J'ai choisi NextJS comme base, car je ne voulais pas bricoler la configuration de l'environnement pour Webpack, et vous pouvez déployer le projet lui-même en quelques clics. </li><li>  Je voulais écrire rapidement et j'ai choisi le package React-IOC en conjonction avec MobX, au lieu de Redux.  Il s'agit d'un package qui vous permet d'écrire des applications via des services qui ressemblent à des services angulaires. </li><li>  J'ai utilisé Web Worker pour qu'il n'y ait pas de décalage dans l'interface lors du tri d'une grande quantité de données. </li><li>  Je n'ai pas utilisé Typescript dans le but de ne pas écrire de code supplémentaire avec une perte de temps inutile sur une tâche de test. </li><li>  Sur la base du paragraphe 4, je n'ai pas non plus écrit de tests. </li><li>  J'ai ajouté deux packages supplémentaires au projet: debounce, RxJS.  Le premier est nécessaire pour créer des rappels simples, par exemple, en changeant l'état de téléchargement afin que le spinner n'affiche pas la charge si le téléchargement prend très peu de temps.  J'utilise toujours le deuxième package pour créer un script d'action, par exemple, pour traiter les états en cas d'erreur lors de l'envoi d'une requête au serveur. </li></ol><br><p>  La procédure pour la première étape de développement: </p><br><ol><li>  Référentiel initialisé. </li><li>  Projet NextJS initialisé. </li><li>  Ajout d'une page de base d'index avec un message Hello World. </li><li>  Création d'un service ticket.provider qui interagit avec le serveur api. </li><li>  Création du service ticket.service, qui injecte ticket.provider et remplit l'observateur avec un tableau de tickets affichés </li><li>  Création de ticket.filter.service, qui stocke les données filtrées injectées à partir de ticket.service via @computed </li></ol><br><p>  La deuxième étape de développement: </p><br><ol><li>  A créé des composants et peint des styles pour eux en utilisant la disposition fournie dans le référentiel de tâches. </li><li>  J'ai fait un spinner du téléchargement et mis sa valeur à partir des services. </li><li>  Connecté toute la logique de service aux composants. </li><li>  Ajout d'utilitaires avec formatage des données, comme le temps et l'argent. </li></ol><br><p>  J'ai alors décidé d'essayer l'interface «tactile» et j'ai trouvé des failles lors de l'utilisation de l'application: </p><br><ol><li>  Il y a des ralentissements d'interface lors du changement de filtre et de tri, j'ai donc transféré le stockage, la récupération et le filtrage des données vers Web Worker, après quoi les décalages ont complètement disparu. </li><li>  Spinner n'a pas corrigé l'animation de la ligne de saut, je l'ai donc remplacée par un affichage visuel des lignes avec une animation scintillante. </li><li>  Pour faciliter le rendu des données, j'ai transféré les appels de mise en forme des données vers Web Worker, cela réduit la charge sur le rendu des composants </li></ol><br><p>  Ensuite, j'ai terminé mon travail et à la fin de la journée, j'ai envoyé une tâche pour vérification. </p><br><p>  Comme je me suis limité dans le temps, je n'ai pas optimisé davantage l'application, à savoir, je n'ai pas utilisé React.memo (...).  Je n'ai pas non plus commencé à remplacer la fenêtre et le routeur par des injecteurs dans les services.  Pardonnez-moi pour cela, c'est un défaut. </p><br><p>  Mais le lendemain, j'ai ajouté la fonctionnalité de se souvenir de l'état du filtre dans la ligne d'URL du navigateur, après quoi j'étais déjà satisfait du travail effectué. </p><br><p>  J'ai attendu une réponse de leur part pendant 7 jours, ils n'ont répondu à aucun de mes messages.  Ce fut une expérience désagréable, pour ainsi dire.  Mais ils ont quand même répondu, et la réponse était extrêmement pénible à lire.  Le message peut être vu ci-dessous. </p><br><p>  Jetons un coup d'œil aux points: </p><br><p>  [1].  "Le travail a été fait très soigneusement" </p><br><p>  Je ne vois pas où, pas un argument, car il n'y a pas d'exemples. </p><br><p>  [2].  «Il semble que le développement ait poursuivi les objectifs de« ça marche »et ignoré« comment ça marche ». </p><br><p>  Pas un argument, pas d'exemples. </p><br><p>  [3].  "Sur la base de nos exigences pour les niveaux de candidats, la tâche terminée atteint à peine au milieu." </p><br><p>  Quelles sont les exigences?  O are sont-ils? </p><br><p>  [4].  «Nous prévoyons que les filtres ne seront pas codés en dur et s'adapteront aux données.  Si vous accédez aux aviasales, vous pouvez voir que les tickets sont affichés immédiatement dès le premier versement, et nous n'attendons pas que tout le monde se charge. " </p><br><p>  Cette exigence ne faisait pas partie de la tâche ci-jointe.  Et l'application Aviasales elle-même, à mon avis, n'a pas d'interface de référence, et sauter des tickets n'est pas la meilleure solution. </p><br><p>  [5].  «Pourquoi filter.service connaît-il le routeur et la fenêtre?  Il ne devrait pas contrôler l'état de l'application et avoir de telles dépendances. » </p><br><p>  Parce que les services sont créés pour contrôler l'état de l'ensemble de l'application, ou le module où ils existent.  Ici, l'auteur suggère clairement d'écrire toute la logique des composants. </p><br><p>  [6].  «Travailleurs Web.  Quel est le profit?  Dans ce cas, beaucoup de temps est consacré aux opérations asynchrones et la charge enregistrée dans le thread principal est consacrée aux objets sérialiser / désérialiser (et aux objets observables).  Si nous parlons d'optimisations, cela valait la peine de commencer non pas par la suppression dans le Web Worker, mais par la résolution des problèmes dans le thread principal. » </p><br><p>  Comment gérer le traitement de grandes quantités de données dans le thread principal et en même temps sans décalage d'interface?  Il sera extrêmement intéressant pour moi de découvrir si quelqu'un a un exemple, puis d'écrire dans les commentaires.  Apparemment, il me manque quelque chose. </p><br><p>  [7].  "Cela n'a aucun sens d'ajouter des rxjs au projet juste pour implémenter une nouvelle tentative et un chargement séquentiel." </p><br><p>  Pourquoi cela n'a-t-il pas de sens?  Vous pouvez importer des fonctions strictement nécessaires dans RxJS; si les packages et les fonctions d'agitation d'arbre ne fonctionnent pas correctement, cela n'augmentera pas la taille de l'application. </p><br><p> [8].  «Le projet ne peut pas être mis à l'échelle et maintenu.  Les constructions comme <code>(ticket.segments || [{}, {}]).map((ticket) =&gt; ...)</code> très lourdes. " </p><br><p>  Passons en revue les critères de mise à l'échelle et de support: accessibilité (les services résolvent ce problème), risques ( <code>ticket.segments || [{}, {}]</code> - ce n'est qu'un exemple de la façon de traiter les cas si l'entrée ne contient pas de données. Un exemple est mauvais, mais l'approche de la structure nullable au moins, mais j'essaye de me conformer), du code propre (enfin, au moins je sais ce que c'est :), même si j'ai essayé de tout écrire comme il se doit).  Il semble que tout soit capturé, encore une fois pas un argument. </p><br><p>  [9].  «J'ai eu l'impression qu'il n'y a absolument aucune compréhension du fonctionnement de React sous le capot.  Il existe de nombreuses erreurs critiques dans l'utilisation des accessoires pour les composants qui ont un très mauvais effet sur les performances.  Les mécanismes d'optimisation de React sont ignorés. » </p><br><p>  Je ne peux pas comprendre où sont les problèmes décrits.  Quel genre de mécanismes? </p><br><p>  [10].  "Création de fonctions de gestionnaire dans le rendu." </p><br><p>  Je n'ai aucune fonction de gestionnaire dans le rendu, est-ce que quelqu'un comprend ce qui est écrit ici?  J'ai même transféré le traitement du formatage vers Web Worker </p><br><p>  [11].  «Créer un nouvel objet vide et le transférer sur le ticket.  <code>ticket-list-loading.jsx:10</code> ou <code>Ticket.tsx:24</code> " </p><br><p>  Il n'y a rien de critique ici, à part ma paresse de retirer séparément le composant ticket de chargement.  Passer un objet vide ne viole aucun principe de programmation, sauf qu'ici il fallait le faire via <code>ticket = ticket || {};</code> <code>ticket = ticket || {};</code>  mais cela est purement dû au fait que le temps de développement était limité à un jour et qu'il faudrait plus de temps pour corriger tous les défauts mineurs. </p><br><p>  [12].  "Array index comme clés sur la liste des tickets" </p><br><p>  Il y a plutôt une question à savoir pourquoi api ne renvoie pas d'éléments avec id.  Par conséquent, lors de la réception de données du serveur, je devrais générer des clés uniques pour chaque élément, ce que je n'ai pas fait dans le cadre de la tâche de test, car même dans un projet réel, c'est une approche douteuse. </p><br><p>  Et enfin, la conclusion: «En général, React n'a pas fonctionné ( <br>  Total: pour le niveau intermédiaire, nous nous attendons à ce qu'il n'y ait pas de problèmes critiques avec la réaction, mais il y en a beaucoup dans le travail effectué. » </p><br><p>  Il n'y a déjà aucun commentaire ... </p><br><p>  Merci si vous lisez jusqu'au bout.  J'ai une opinion très négative sur Aviasales, donc je poste tout ici pour que vous puissiez vous évaluer si vous devez les contacter ou non. </p><br><p>  Texte intégral du message: </p><br><p>  Le travail est fait très soigneusement.  Il semble que pendant le développement, les objectifs étaient «ça marche», et «comment ça marche» a été ignoré.  Sur la base de nos exigences pour les niveaux de candidats, la tâche terminée atteint à peine le milieu. </p><br><p>  Performance et structure: <br>  Nous prévoyons que les filtres ne seront pas codés en dur et s'adapteront aux données.  Si vous accédez aux aviasales, vous pouvez voir que les tickets sont affichés immédiatement dès que le premier versement apparaît et nous n'attendons pas que tout le monde se charge. </p><br><p>  De plus, des points plus techniques. </p><br><ol><li>  Pourquoi <code>filter.service</code> connaît-il le routeur et la fenêtre?  Il ne doit pas contrôler l'état de l'application et avoir de telles dépendances. </li><li>  Travailleurs Web.  Quel est le profit?  Dans ce cas, beaucoup de temps est consacré aux opérations asynchrones et la charge enregistrée dans le thread principal est consacrée aux objets sérialiser / désérialiser (et aux objets observables).  Si nous parlons d'optimisations, cela valait la peine de commencer non pas par la suppression dans le Web Worker, mais par la résolution des problèmes dans le thread principal. </li><li>  Cela n'a aucun sens d'ajouter des rxjs au projet uniquement pour implémenter une nouvelle tentative et un chargement séquentiel. </li><li>  Le projet ne peut pas être mis à l'échelle et maintenu.  Les constructions comme ( <code>ticket.segments || [{}, {}]).map((ticket) =&gt; ticket</code> ) sont très lourdes. <br>  Réagissez: <br>  J'ai eu l'impression qu'il n'y a absolument aucune compréhension du fonctionnement de React sous le capot.  Il existe de nombreuses erreurs critiques dans l'utilisation des accessoires pour les composants qui ont un très mauvais effet sur les performances.  Les mécanismes d'optimisation de React sont ignorés.  En bref sur les problèmes: </li><li>  Création de fonctions de gestionnaire dans le rendu. </li><li>  Créez un nouvel objet vide et transférez-le sur le ticket.  <code>ticket-list-loading.jsx:10</code> ou <code>Ticket.tsx:24</code> . </li><li>  Les index de tableau sous forme de clés sur une liste de tickets. <br>  En général, React n'a pas fonctionné :( </li></ol><br><p>  Total: pour le niveau intermédiaire, nous prévoyons qu'avec réagir, il n'y aura pas de problèmes critiques, mais il y en a beaucoup dans le travail effectué. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468715/">https://habr.com/ru/post/fr468715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468695/index.html">Mon premier hack: un site qui vous permet de définir n'importe quel mot de passe utilisateur</a></li>
<li><a href="../fr468697/index.html">DB & DWH MeetUp # 5 à Raiffeisenbank</a></li>
<li><a href="../fr468705/index.html">Appel vidéo dans le navigateur sur PeerJS. Démarrage rapide</a></li>
<li><a href="../fr468707/index.html">Open PostgreSQL Meetup Enregistrement et diffusion d'enregistrement UPD</a></li>
<li><a href="../fr468713/index.html">Projet d'échange légal de crypto-monnaie</a></li>
<li><a href="../fr468719/index.html">Développement de système d'exploitation de type Unix - Shell. Conclusion (9)</a></li>
<li><a href="../fr468721/index.html">Retentioneering: comment nous avons écrit les outils d'analyse de produits open-source en Python et Pandas</a></li>
<li><a href="../fr468723/index.html">JS Design Patterns: Patterns de création d'objets</a></li>
<li><a href="../fr468725/index.html">Rendre votre filtrage d'appels Google basé sur Voximplant et Dialogflow</a></li>
<li><a href="../fr468727/index.html">Lenovo ThinkShield: une puissante suite d'options et de services protège la sécurité des PC d'entreprise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>