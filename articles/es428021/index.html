<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïõ üèûÔ∏è üê© Sellos contra la red neuronal. O seleccione y ejecute una red neuronal para reconocer objetos en Raspberry Zero üíã üë®üèΩ‚Äçüî¨ üë≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buen dia a todos. 

 La peque√±a frambuesa es una gran cosa. Utilic√© Raspberry Zero W en un par de proyectos en los √∫ltimos seis meses. Sobornado por l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sellos contra la red neuronal. O seleccione y ejecute una red neuronal para reconocer objetos en Raspberry Zero</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428021/">  Buen dia a todos. <br><br>  La peque√±a frambuesa es una gran cosa.  Utilic√© Raspberry Zero W en un par de proyectos en los √∫ltimos seis meses.  Sobornado por la simplicidad de la creaci√≥n de prototipos y la eliminaci√≥n de varias ideas.  Y ahora aqu√≠ hay una pregunta opcional: ¬øeste dispositivo extraer√° una cuadr√≠cula convolucional completa?  [Spoiler - tirar, pero hay matices graciosos].  ¬øA qui√©n le importa el tema? Bienvenido a Cat.  ¬°Atenci√≥n, habr√° muchos gatos! <br><br><img src="https://habrastorage.org/webt/8b/mr/ki/8bmrkihh9e5nc34ibcorjmjuwos.jpeg" alt="imagen"><br><a name="habracut"></a><br><br><h2>  ¬øPor qu√© es la red neuronal Raspberry? </h2><br>  De alguna manera, coleccion√© un video trampa simple en Raspbery Zero W para observar la vida nocturna de los animales (principalmente gatos) en el pa√≠s.  El c√≥digo era simple y funcionaba bastante bien.  Para la detecci√≥n de video-foto, se us√≥ una c√°mara con iluminaci√≥n IR como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta "C√°mara Raspberry Pi Night Version"</a> . <br><br><img src="https://habrastorage.org/webt/is/4n/el/is4nelvh4jnhu9d_muw2-shijuy.jpeg" alt="imagen"><br><br>  La esencia del c√≥digo es tomar dos cuadros consecutivos, comparar p√≠xel por p√≠xel y, si el n√∫mero de p√≠xeles modificados es mayor que un cierto valor umbral, comenzar a grabar un video de 10 segundos.  No proporcionar√© el texto del c√≥digo en esta publicaci√≥n, si alguien est√° interesado, escriba los comentarios, puedo ponerlo a continuaci√≥n.  La caracter√≠stica principal es comparar los dos cuadros en 0.2 segundos, al menos para capturar eventos r√°pidos.  Bueno, compara r√°pidamente estos marcos, por supuesto. <br><br>  Luego surgi√≥ la idea de fijar una red neuronal simple al algoritmo para que fuera posible determinar un objeto en un cuadro capturado e iniciar una grabaci√≥n de video solo si la clase de objeto se determinaba de manera confiable.  Potencialmente, esto elimina los falsos positivos de la captura de video.  Estos ocurren por objetos en movimiento (por ejemplo, hierba o ramas) o por una iluminaci√≥n n√≠tida de la escena de la c√°mara (la luz en la ventana encendida o la l√°mpara se apag√≥, por ejemplo). <br><br><h2>  ¬øQu√© cuadr√≠cula poner en la frambuesa? </h2><br>  Afortunadamente, bajo el Python preinstalado (en mi caso es 3.5.3) y el ampliamente disponible OpenCV (uso 3.4.3), puede colocar casi cualquier grilla.  Desafortunadamente, debido a las capacidades inform√°ticas limitadas del dispositivo, la lista de opciones es peque√±a.  De hecho, solo puede elegir entre las opciones "ligeras": <br><br>  1. SqueezeNet (c√≥digo de muestra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ). <br>  2. YOLO Tiny ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ). <br>  3. MobileNet-SSD ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ). <br>  4. MobileNet_v1_224 (hay un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">video</a> fant√°stico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del funcionamiento del detector de objetos en esta cuadr√≠cula</a> ). <br><br>  En todos estos casos, soborna la oportunidad de utilizar un modelo pre-entrenado en conjuntos de datos s√≥lidos, aliviando as√≠ todos los tormentos y preocupaciones de un conjunto de datos independiente y el entrenamiento posterior de una red neuronal en ellos. <br><br>  El solicitante No. 1 se inspir√≥ en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">alta precisi√≥n de reconocimiento</a> con modestos tama√±os de factores de ponderaci√≥n.  Adem√°s, una breve b√∫squeda en Internet condujo al excelente blog <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adrian Rosebrock</a> , que coment√≥ el c√≥digo en detalle y describi√≥ varias opciones para implementar el aprendizaje profundo en Raspberry. <br><br>  El c√≥digo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de aqu√≠ se</a> us√≥ para probar las capacidades de SqueezeNet.  El autor env√≠a el peso y la representaci√≥n textual del modelo al correo electr√≥nico despu√©s de completar el formulario en el sitio.  Por cierto, si no tiene instalado OpenCV, puede encontrar el algoritmo de acciones en su blog.  Adem√°s, hay ejemplos de "overclocking" del c√≥digo para acelerar el tiempo de trabajo de los modelos y mucho m√°s.  Respeto a Adrian, un recurso realmente genial. <br><br>  ¬°Bien, ejecutemos el c√≥digo y obtengamos un resultado sorprendente en la primera imagen! <br><br><img src="https://habrastorage.org/webt/9w/ip/c3/9wipc305vgfjkeprf21e4dv2ruc.jpeg" alt="imagen"><br><br>  El gato en la imagen se define como persa con una probabilidad del 99%.  De hecho, √©l no es persa, sino brit√°nico de pelo largo o monta√±√©s.  Pero para un modelo con un rango de 1000 clases, se puede decir, dar en el blanco.  Por conveniencia, coloqu√© los principales resultados de la red neuronal directamente en la foto.  Estas son las 5 clases m√°s probables, la primera es la m√°s probable, la segunda es la siguiente m√°s significativa, y as√≠ sucesivamente. <br><br>  Por cierto, el modelo cuenta las clases de objetos en mi Zero durante 6.5 segundos.  Si cree en los datos de Adrian, el c√°lculo en el Raspberry Pi B + en las im√°genes que se muestran en su publicaci√≥n (foto de las instalaciones del peluquero, la cobra y la medusa) tomar√° aproximadamente 0.92 segundos.  Estoy dispuesto a creer que la versi√≥n completa de Raspberry tiene 4 n√∫cleos en el procesador despu√©s de todo.  Creo que todos saben que Zero solo tiene uno ((( <br><br>  Parece que tendr√° que olvidarse de definir la clase de objeto en tiempo real en Zero.  Por cierto, debo admitir que un segundo de tiempo para trabajar el modelo en un Pi "completo" tampoco es el sue√±o final. <br><br>  Pero sigamos probando el modelo. <br><br><img src="https://habrastorage.org/webt/l6/ga/sg/l6gasgvwsavydyknmgm2ayzy948.jpeg" alt="imagen"><br><br>  El gato cambi√≥ la posici√≥n del cuerpo y perdi√≥ hasta el 7% de su antiguo "persa").  Pero esto es una broma, por supuesto, en general, el trabajo del modelo es muy bueno.  Fue en este mismo lugar donde fue posible terminar, pero quer√≠a complicar un poco la tarea del modelo.  Sigamos practicando en ... gatos.  Pero recopilaremos marcos donde el gato no se sienta en una pose cl√°sica, sino que duerme, por ejemplo.  Entonces vamos. <br><br><img src="https://habrastorage.org/webt/zm/qc/a6/zmqca6rk4v_kswhdc2zobjivz5o.jpeg" alt="imagen"><br><br>  En esta imagen, el gato se define como Angora, pero esto no es exacto.  Aparentemente por el hecho de que le molesta una solicitud obsesiva de abandonar el fregadero.  Bueno, la red neuronal estaba mal, bueno, ¬øa qui√©n no le sucede al final? <br><br><img src="https://habrastorage.org/webt/4c/ki/4-/4cki4-dqt-fsq0nxfcbtzkgdpdo.jpeg" alt="imagen"><br><br>  Resulta que un bal√≥n de f√∫tbol esponjoso vive en mi casa) S√≠, sucede que las personas no son para nada lo que parecen a primera vista.  La pelea de gatos y redes neuronales da un giro serio. <br><br><img src="https://habrastorage.org/webt/og/v7/7d/ogv77daxm11eov32uhjf4-ssv2m.jpeg" alt="imagen"><br><br>  Wow  Ahora ella es un husky siberiano.  Algo me dice que el gato sigue contando) <br><br><img src="https://habrastorage.org/webt/3k/bs/n4/3kbsn40vaigsobq41ks9rmnj1vc.jpeg" alt="imagen"><br><br>  Parece que uno de estos dos est√° claramente derribado y esto claramente no es un gato.  Ahora est√° definido por la red neuronal como un huso (aunque solo en un 8,5%), todav√≠a hay opciones de que sea un beagle, una orca, una pit√≥n rocosa o una mofeta.  ¬°No es un gato, pero una mujer es un misterio! <br><br><img src="https://habrastorage.org/webt/pk/8j/tv/pk8jtvc5aeesdnetalwdfxep-jw.jpeg" alt="imagen"><br><br>  Vamos!  ¬°Esto sigue siendo una orca!  S√≠, s√≠, un mam√≠fero marino de orden de cet√°ceos.  Por alguna raz√≥n, record√© las l√≠neas de la infancia lejana: <br>  "No hay orden en este cuento, <br>  ¬°Aqu√≠ hay un error, un error tipogr√°fico!  Alguien <br>  Contra todas las reglas <br>  En un cuento de hadas, reorganiz√≥ las letras, <br>  Transportado <br>  "KIT" en el "CAT", <br>  "CAT" en "KIT", al contrario ". <br>  Suena el gong, el √°rbitro detiene la pelea) <br><br><img src="https://habrastorage.org/webt/xf/bp/-7/xfbp-7svqzxku4awsfk-cxx7fpi.jpeg" alt="imagen"><br><br>  En la segunda ronda, el gato, con astucia usando anteojos, pas√≥ al bulldog de Boston con una probabilidad del 34%.  O para los franceses.  Parece que la red neuronal no se ha recuperado completamente de la derrota en la primera ronda) <br><br><img src="https://habrastorage.org/webt/ao/c8/j5/aoc8j5rjtsgodpe4hwpjex94mgs.jpeg" alt="imagen"><br><br>  Bueno, por fin!  ¬°El gato se define como siam√©s con una probabilidad de hasta 66%!  Bravo, SqueezeNet!  En serio, parece que en el conjunto de datos original prevalecieron las fotos de gatos no mentirosos, sino sentados.  Mentir eran en su mayor√≠a perros) <br><br><img src="https://habrastorage.org/webt/0p/oz/ro/0pozrokqqgilu4xfmtpumwzrlkm.jpeg" alt="imagen"><br><br>  La capacidad de los gatos para tomar la forma de una caja es confusa incluso para los humanos, y mucho menos para la red neuronal.  La inmersi√≥n en la caja redujo la precisi√≥n del reconocimiento hasta en un 40%. <br><br><img src="https://habrastorage.org/webt/zj/is/nr/zjisnron-r3rauwfpsjtfld1694.jpeg" alt="imagen"><br><br>  Entonces, entonces ... Y esto, al parecer, generalmente es una recepci√≥n prohibida.  El rat√≥n de la computadora que se encuentra al lado del gato confunde completamente la red neuronal.  ¬°Ahora nuestro gato es un rat√≥n!  ) <br><br>  Entonces, a toda la red neuronal se le presentaron 11 fotos de gatos, de las cuales solo 5 fueron identificadas correctamente, adem√°s, con una probabilidad de m√°s del 50% en solo tres casos.  De ninguna manera disminuye el trabajo de los autores de SqueezeNet.  Esta es una red s√≥lida con una clase muy amplia de objetos y requisitos de recursos relativamente bajos. <br><br>  El art√≠culo, por supuesto, es de naturaleza c√≥mica, pero se pueden sacar conclusiones bastante pragm√°ticas de los datos obtenidos.  Es necesario usar redes neuronales pre-entrenadas con mucho cuidado, verific√°ndolas en im√°genes reales de la tarea para la cual se planea usar una red neuronal. <br><br>  En cuanto a la elecci√≥n de la red neuronal √≥ptima para Raspberry, la pregunta sigue abierta hasta ahora.  Contin√∫o los experimentos, si hay inter√©s de la audiencia en este tema, compartir√© los resultados de m√°s investigaciones.  Es solo que los resultados del primer paso resultaron ser tan divertidos que realmente quer√≠a compartirlos. <br><br>  Gracias por leer hasta el final.  Buena suerte y que tengas una buena semana laboral) <br><br>  UPD: Consulte la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">segunda parte de</a> esta publicaci√≥n para ver el c√≥digo de trabajo para ejecutar una red neuronal en Raspberry Pi Zero W. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es428021/">https://habr.com/ru/post/es428021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es428005/index.html">Tres formas efectivas de exacerbar un desastre de relaciones p√∫blicas</a></li>
<li><a href="../es428007/index.html">Ya no es una PC con capacidad de carga, a√∫n no es una computadora port√°til: Laptop TOSHIBA T3100 / 20</a></li>
<li><a href="../es428009/index.html">Equifax: un a√±o despu√©s de la mayor fuga de datos</a></li>
<li><a href="../es428011/index.html">Canciones de zombies espaciales</a></li>
<li><a href="../es428019/index.html">Juega a Mortal Kombat con TensorFlow.js</a></li>
<li><a href="../es428023/index.html">Conceptos b√°sicos de seguridad el√©ctrica en el dise√±o de dispositivos electr√≥nicos.</a></li>
<li><a href="../es428025/index.html">Conexi√≥n de un archivo de intercambio (SWAP) en MAC OS X cuando se utiliza un SSD externo como sistema</a></li>
<li><a href="../es428027/index.html">C√≥mo intent√© hacer un analizador est√°tico GLSL (y qu√© sali√≥ mal)</a></li>
<li><a href="../es428029/index.html">Eventos digitales en Mosc√∫ del 29 de octubre al 4 de noviembre.</a></li>
<li><a href="../es428031/index.html">Integraci√≥n de 3CX con 1C: Gesti√≥n de comercio: un m√©todo para combinar configuraciones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>