<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüíª üî∫ üë©üèæ‚ÄçüöÄ An√°lise de sentimento de prot√≥tipo com Python e TextBlob üë©üèø‚Äçü§ù‚Äçüë®üèΩ üìâ üíÖüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O que √© importante para uma equipe de desenvolvimento que est√° apenas come√ßando a construir um sistema de aprendizado de m√°quina? Arquitetura, compone...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>An√°lise de sentimento de prot√≥tipo com Python e TextBlob</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457168/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/ir/g2/8lirg2klkrmofom9vhhcgldh-qo.jpeg" alt="imagem"></div><br>  O que √© importante para uma equipe de desenvolvimento que est√° apenas come√ßando a construir um sistema de aprendizado de m√°quina?  Arquitetura, componentes, recursos de teste usando integra√ß√£o e testes de unidade, fazem um prot√≥tipo e obt√™m os primeiros resultados.  E al√©m da avalia√ß√£o da contribui√ß√£o do trabalho, planejamento de desenvolvimento e implementa√ß√£o. <br><br>  Este artigo se concentrar√° no prot√≥tipo.  Que foi criado algum tempo depois de conversar com o Gerente de Produto: por que n√£o tocamos no Machine Learning?  Em particular, PNL e an√°lise de sentimentos? <br><a name="habracut"></a><br>  "Por que n√£o?"  Eu respondi.  Ainda assim, estou envolvido no desenvolvimento de back-end h√° mais de 15 anos, gosto de trabalhar com dados e resolver problemas de desempenho.  Mas eu ainda tinha que descobrir "qu√£o profunda √© a toca do coelho". <br><br><h2>  Selecionar componentes </h2><br>  Para delinear de alguma maneira o conjunto de componentes que implementam a l√≥gica do nosso n√∫cleo de ML, vejamos um exemplo simples da implementa√ß√£o da an√°lise de sentimentos, uma das muitas dispon√≠veis no GitHub. <br><br><div class="spoiler">  <b class="spoiler_title">Um exemplo de an√°lise de sentimentos em Python</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> nltk <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( datasets, model_selection, feature_extraction, linear_model ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extract_features</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(corpus)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''Extract TF-IDF features from corpus'''</span></span> <span class="hljs-comment"><span class="hljs-comment"># vectorize means we turn non-numerical data into an array of numbers count_vectorizer = feature_extraction.text.CountVectorizer( lowercase=True, # for demonstration, True by default tokenizer=nltk.word_tokenize, # use the NLTK tokenizer stop_words='english', # remove stop words min_df=1 # minimum document frequency, ie the word must appear more than once. ) processed_corpus = count_vectorizer.fit_transform(corpus) processed_corpus = feature_extraction.text.TfidfTransformer().fit_transform( processed_corpus) return processed_corpus data_directory = 'movie_reviews' movie_sentiment_data = datasets.load_files(data_directory, shuffle=True) print('{} files loaded.'.format(len(movie_sentiment_data.data))) print('They contain the following classes: {}.'.format( movie_sentiment_data.target_names)) movie_tfidf = extract_features(movie_sentiment_data.data) X_train, X_test, y_train, y_test = model_selection.train_test_split( movie_tfidf, movie_sentiment_data.target, test_size=0.30, random_state=42) # similar to nltk.NaiveBayesClassifier.train() model = linear_model.LogisticRegression() model.fit(X_train, y_train) print('Model performance: {}'.format(model.score(X_test, y_test))) y_pred = model.predict(X_test) for i in range(5): print('Review:\n{review}\n-\nCorrect label: {correct}; Predicted: {predict}'.format( review=X_test[i], correct=y_test[i], predict=y_pred[i] ))</span></span></code> </pre> <br></div></div><br>  A an√°lise desses exemplos √© um desafio separado para o desenvolvedor. <br>  Apenas 45 linhas de c√≥digo e 4 (quatro, Karl!) Blocos l√≥gicos de uma s√≥ vez: <br><br><ol><li>  Fazendo Download de Dados para o Treinamento do Modelo (Linhas 25 a 26) </li><li>  Preparando dados carregados - extra√ß√£o de recursos (linhas 31 a 34) </li><li>  Criando e treinando um modelo (linhas 36-39) </li><li>  Testando um modelo treinado e produzindo resultados (linhas 41-45) </li></ol><br>  Cada um desses pontos merece um artigo separado.  E certamente requer registro em um m√≥dulo separado.  Pelo menos para as necessidades de teste de unidade. <br><br>  Separadamente, vale destacar os componentes da prepara√ß√£o de dados e do treinamento do modelo. <br>  Em cada uma das maneiras de tornar o modelo mais preciso, s√£o investidas centenas de horas de trabalho cient√≠fico e de engenharia. <br><br>  Felizmente, para iniciar rapidamente a PNL, existe uma solu√ß√£o pronta - as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bibliotecas NLTK</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TextBlob</a> .  O segundo √© um inv√≥lucro sobre o NLTK que realiza a tarefa - extrai os recursos do conjunto de treinamento e treina o modelo na primeira solicita√ß√£o de classifica√ß√£o. <br><br>  Mas antes de treinar o modelo, voc√™ precisa preparar dados para ele. <br><br><h2>  Preparando dados </h2><br><h3>  Baixar dados </h3><br>  Se falamos sobre o prot√≥tipo, o carregamento de dados de um arquivo CSV / TSV √© elementar.  Voc√™ simplesmente chama a fun√ß√£o <b>read_csv</b> da biblioteca do pandas: <br><br><pre> <code class="plaintext hljs">import pandas as pd data = pd.read_csv(data_path, delimiter)</code> </pre><br>  Mas n√£o haver√° dados prontos para uso no modelo. <br><br>  Primeiro, se ignorarmos um pouco o formato csv, √© f√°cil esperar que cada fonte forne√ßa dados com suas pr√≥prias caracter√≠sticas e, portanto, precisamos de algum tipo de prepara√ß√£o de dados dependentes da fonte.  Mesmo no caso mais simples de um arquivo CSV, para analis√°-lo, precisamos conhecer o delimitador. <br><br>  Al√©m disso, voc√™ deve determinar quais entradas s√£o positivas e quais s√£o negativas.  Obviamente, essas informa√ß√µes s√£o indicadas na anota√ß√£o dos conjuntos de dados que queremos usar.  Mas o fato √© que, em um caso, o sinal de pos / neg √© 0 ou 1, no outro, √© um True / False l√≥gico, no terceiro, √© apenas uma sequ√™ncia de pos / neg e, em alguns casos, uma tupla de n√∫meros inteiros de 0 a 5 O √∫ltimo √© relevante para o caso da classifica√ß√£o multiclasse, mas quem disse que esse conjunto de dados n√£o pode ser usado para classifica√ß√£o bin√°ria?  Voc√™ s√≥ precisa identificar adequadamente a fronteira de valores positivos e negativos. <br><br>  Eu gostaria de experimentar o modelo em diferentes conjuntos de dados, e √© necess√°rio que, ap√≥s o treinamento, o modelo retorne o resultado em um √∫nico formato.  E, para isso, deve trazer seus dados heterog√™neos para um √∫nico formul√°rio. <br><br>  Portanto, existem tr√™s fun√ß√µes que precisamos no est√°gio de carregamento de dados: <br><br><ol><li>  A conex√£o com a fonte de dados √© para CSV; no nosso caso, √© implementada dentro da fun√ß√£o read_csv; </li><li>  Suporte para recursos de formato; </li><li>  Prepara√ß√£o preliminar de dados. </li></ol><br>  √â assim que parece no c√≥digo. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-comment"><span class="hljs-comment"># linear algebra import pandas as pd # data processing, CSV file I/O (eg pd.read_csv) import logging log = logging.getLogger() class CsvSentimentDataLoader(): def __init__(self, file_path, delim, text_attr, rate_attr, pos_rates): self.data_path = file_path self.delimiter = delim self.text_attr = text_attr self.rate_attr = rate_attr self.pos_rates = pos_rates def load_data(self): #     csv  tsv  data = pd.read_csv(self.data_path, self.delimiter) data.head() #   , #      data = data[[self.text_attr, self.rate_attr]] #    #     'pos'  'neg' data[self.rate_attr] = np.where( data[self.rate_attr].isin(self.pos_rates), 'pos', 'neg') return data</span></span></code> </pre><br>  Foi <b>criada a</b> classe <b>CsvSentimentDataLoader</b> , que no construtor passa o caminho para csv, o separador, os nomes do texto e os atributos de classifica√ß√£o, al√©m de uma lista de valores que aconselham o valor positivo do texto. <br><br>  O carregamento em si ocorre no m√©todo <b>load_data</b> . <br><br><h3>  Dividimos os dados em conjuntos de teste e treinamento </h3><br>  Ok, carregamos os dados, mas ainda precisamos dividi-los nos conjuntos de treinamento e teste. <br><br>  Isso √© feito com a fun√ß√£o <b>train_test_split da</b> biblioteca <b>sklearn</b> .  Essa fun√ß√£o pode receber muitos par√¢metros como entrada, determinando como exatamente esse conjunto de dados ser√° dividido em treinamento e teste.  Esses par√¢metros afetam significativamente os conjuntos de treinamento e teste resultantes e provavelmente ser√° conveniente criar uma classe (vamos cham√°-lo de SimpleDataSplitter) que gerenciar√° esses par√¢metros e agregar√° a chamada a esta fun√ß√£o. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-comment"><span class="hljs-comment"># to split the training and testing data import logging log = logging.getLogger() class SimpleDataSplitter(): def __init__(self, text_attr, rate_attr, test_part_size=.3): self.text_attr = text_attr self.rate_attr = rate_attr self.test_part_size = test_part_size def split_data(self, data): x = data[self.text_attr] y = data[self.rate_attr] x_train, x_test, y_train, y_test = train_test_split( x, y, test_size = self.test_part_size) return x_train, x_test, y_train, y_test</span></span></code> </pre><br>  Agora, essa classe inclui a implementa√ß√£o mais simples, que, quando dividida, levar√° em conta apenas um par√¢metro - a porcentagem de registros que devem ser tomados como um conjunto de testes. <br><br><h3>  Conjuntos de dados </h3><br>  Para treinar o modelo, usei conjuntos de dados dispon√≠veis gratuitamente no formato CSV: <br><br><ul><li>  Conjunto de dados do Amazon Alexa Reviews, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dispon√≠vel no Kaggle</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conjunto de dados de frases com sentimentos</a> da Universidade da Calif√≥rnia </li></ul><br>  E para torn√°-lo ainda mais conveniente, para cada um dos conjuntos de dados, criei uma classe que carrega dados do arquivo CSV correspondente e os divide em conjuntos de treinamento e teste. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> web.data.loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CsvSentimentDataLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> web.data.splitters <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SimpleDataSplitter, TdIdfDataSplitter log = logging.getLogger() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AmazonAlexaDataset</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.file_path = os.path.normpath(os.path.join(os.path.dirname(__file__), <span class="hljs-string"><span class="hljs-string">'amazon_alexa/train.tsv'</span></span>)) self.delim = <span class="hljs-string"><span class="hljs-string">'\t'</span></span> self.text_attr = <span class="hljs-string"><span class="hljs-string">'verified_reviews'</span></span> self.rate_attr = <span class="hljs-string"><span class="hljs-string">'feedback'</span></span> self.pos_rates = [<span class="hljs-number"><span class="hljs-number">1</span></span>] self.data = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.train = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.test = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> loader = CsvSentimentDataLoader(self.file_path, self.delim, self.text_attr, self.rate_attr, self.pos_rates) splitter = SimpleDataSplitter(self.text_attr, self.rate_attr, test_part_size=<span class="hljs-number"><span class="hljs-number">.3</span></span>) self.data = loader.load_data() x_train, x_test, y_train, y_test = splitter.split_data(self.data) self.train = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(x_train, y_train)] self.test = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(x_test, y_test)]</code> </pre><br>  Sim, para o carregamento de dados, resultou um pouco mais de 5 linhas de c√≥digo no exemplo original. <br>  Mas agora √© poss√≠vel criar novos conjuntos de dados manipulando fontes de dados e algoritmos de prepara√ß√£o de conjuntos de treinamento. <br><br>  Al√©m disso, componentes individuais s√£o muito mais convenientes para testes de unidade. <br><br><h2>  Treinamos o modelo </h2><br>  O modelo est√° aprendendo h√° algum tempo.  E isso deve ser feito uma vez, no in√≠cio do aplicativo. <br>  Para esses fins, foi criado um pequeno inv√≥lucro que permite fazer o download e preparar dados, al√©m de treinar o modelo no momento da inicializa√ß√£o do aplicativo. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextBlobWrapper</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.log = logging.getLogger() self.is_model_trained = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.classifier = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.log.info(<span class="hljs-string"><span class="hljs-string">'&gt;&gt;&gt;&gt;&gt; TextBlob initialization started'</span></span>) self.ensure_model_is_trained() self.log.info(<span class="hljs-string"><span class="hljs-string">'&gt;&gt;&gt;&gt;&gt; TextBlob initialization completed'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ensure_model_is_trained</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.is_model_trained: ds = SentimentLabelledDataset() ds.load_data() <span class="hljs-comment"><span class="hljs-comment"># train the classifier and test the accuracy self.classifier = NaiveBayesClassifier(ds.train) acr = self.classifier.accuracy(ds.test) self.log.info(str.format('&gt;&gt;&gt;&gt;&gt; NaiveBayesClassifier trained with accuracy {}', acr)) self.is_model_trained = True return self.classifier</span></span></code> </pre><br>  Primeiro, obtemos dados de treinamento e teste, depois realizamos a extra√ß√£o e, finalmente, treinamos o classificador e verificamos a precis√£o no conjunto de testes. <br><br><h2>  Teste </h2><br>  Na inicializa√ß√£o, obtemos um log, julgando pelo qual, os dados foram baixados e o modelo foi treinado com sucesso.  E treinado com muito boa precis√£o (para iniciantes) - 0,8878. <br><br><img src="https://habrastorage.org/webt/nl/hw/pt/nlhwptjx8xnwfao2anynttvbr1u.png" alt="imagem"><br><br>  Tendo recebido esses n√∫meros, fiquei muito entusiasmado.  Mas minha alegria, infelizmente, n√£o foi longa.  O modelo treinado neste conjunto √© um otimista impenetr√°vel e, em princ√≠pio, n√£o √© capaz de reconhecer coment√°rios negativos. <br><br>  A raz√£o para isso est√° nos dados do conjunto de treinamento.  O n√∫mero de cr√≠ticas positivas no conjunto √© superior a 90%.  Consequentemente, com uma precis√£o de modelo de cerca de 88%, as an√°lises negativas simplesmente caem nos 12% esperados de classifica√ß√µes incorretas. <br><br>  Em outras palavras, com esse conjunto de treinamento, √© simplesmente imposs√≠vel treinar o modelo para reconhecer coment√°rios negativos. <br><br>  Para ter certeza disso, fiz um teste de unidade que executa a classifica√ß√£o separadamente para 100 frases positivas e 100 negativas de outro conjunto de dados - para o teste, fiz o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conjunto de Dados de Senten√ßas Rotuladas de Sentimentos</a> da Universidade da Calif√≥rnia. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta"> @loggingtestcase.capturelogs(None, level='INFO') def test_classifier_on_separate_set(self, logs): tb = TextBlobWrapper() # Going to be trained on Amazon Alexa dataset ds = SentimentLabelledDataset() # Test dataset ds.load_data() # Check poisitives true_pos = 0 data = ds.data.to_numpy() seach_mask = np.isin(data[:, 1], ['pos']) data = data[seach_mask][:100] for e in data[:]: # Model train will be performed on first classification call r = tb.do_sentiment_classification(e[0]) if r == e[1]: true_pos += 1 self.assertLessEqual(true_pos, 100) print(str.format('\n\nTrue Positive answers - {} of 100', true_pos))</span></span></code> </pre><br>  O algoritmo para testar a classifica√ß√£o de valores positivos √© o seguinte: <br><br><ul><li>  Fa√ßa o download dos dados de teste; </li><li>  Take 100 posts tagged 'pos' </li><li>  Executamos cada um deles atrav√©s do modelo e contamos o n√∫mero de resultados corretos </li><li>  Exiba o resultado final no console. </li></ul><br>  Da mesma forma, √© feita uma contagem para coment√°rios negativos. <br><br><div class="spoiler">  <b class="spoiler_title">Resultado</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/79/lj/px/79ljpxifxo5sl1kpdt_h0q4zd58.png" alt="imagem"><br></div></div><br>  Como esperado, todos os coment√°rios negativos foram reconhecidos como positivos. <br><br>  E se voc√™ treinar o modelo no conjunto de dados usado para o teste - <b>Sentiment Labeled</b> ?  L√°, a distribui√ß√£o de coment√°rios negativos e positivos √© exatamente de 50 a 50. <br><br><div class="spoiler">  <b class="spoiler_title">Mude o c√≥digo e teste, execute</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tj/cw/oo/tjcwoocc2qodmbd5zl7emwqt8ve.png" alt="imagem"><br></div></div><br>  Algo j√°.  A precis√£o real de 200 entradas de um conjunto de terceiros √© de 76%, enquanto a precis√£o da classifica√ß√£o de coment√°rios negativos √© de 79%. <br><br>  Obviamente, 76% servir√£o como prot√≥tipo, mas n√£o o suficiente para a produ√ß√£o.  Isso significa que ser√£o necess√°rias medidas adicionais para melhorar a precis√£o do algoritmo.  Mas este √© um t√≥pico para outro relat√≥rio. <br><br><h2>  Sum√°rio </h2><br>  Primeiramente, obtivemos um aplicativo com uma d√∫zia de classes e mais de 200 linhas de c√≥digo, o que √© um pouco mais que o exemplo original em 30 linhas.  E voc√™ deve ser honesto - essas s√£o apenas dicas da estrutura, o primeiro esclarecimento dos limites da futura aplica√ß√£o.  Prot√≥tipo. <br><br>  E esse prot√≥tipo tornou poss√≠vel perceber at√© que ponto a dist√¢ncia entre as abordagens do c√≥digo √© do ponto de vista dos especialistas em Machine Learning e do ponto de vista dos desenvolvedores de aplicativos tradicionais.  E essa, na minha opini√£o, √© a principal dificuldade dos desenvolvedores que decidem experimentar o aprendizado de m√°quina. <br><br>  A pr√≥xima coisa que pode colocar um iniciante em um estupor - os dados n√£o s√£o menos importantes que o modelo selecionado.  Isso foi claramente mostrado. <br><br>  Al√©m disso, sempre existe a possibilidade de que um modelo treinado em alguns dados se mostre inadequado em outros, ou em algum momento sua precis√£o comece a se degradar. <br>  Consequentemente, s√£o necess√°rias m√©tricas para monitorar o estado do modelo, flexibilidade ao trabalhar com dados, recursos t√©cnicos para ajustar o aprendizado em tempo real.  E assim por diante <br><br>  Quanto a mim, tudo isso deve ser levado em considera√ß√£o ao projetar a arquitetura e construir processos de desenvolvimento. <br><br>  Em geral, o "buraco do coelho" n√£o era apenas muito profundo, mas tamb√©m extremamente inteligente.  Mas ainda mais interessante para mim, como desenvolvedor, estudar este t√≥pico no futuro. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457168/">https://habr.com/ru/post/pt457168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457152/index.html">Confer√™ncia DEFCON 25. Garry Kasparov. "A √∫ltima batalha do c√©rebro." Parte 1</a></li>
<li><a href="../pt457154/index.html">Design de aplicativo responsivo para todos os usu√°rios</a></li>
<li><a href="../pt457156/index.html">Quais podem ser os sistemas de computa√ß√£o do futuro</a></li>
<li><a href="../pt457160/index.html">Minha abordagem para implementar delegados em C ++: chamando uma fun√ß√£o com par√¢metros desconhecidos em tempo de execu√ß√£o</a></li>
<li><a href="../pt457164/index.html">Navega√ß√£o em um aplicativo .NET Core de plataforma cruzada com salvando o estado no disco usando o exemplo de ReactiveUI e Avalonia</a></li>
<li><a href="../pt457172/index.html">ScreenLogger - sorria, voc√™ √© filmado por uma c√¢mera escondida</a></li>
<li><a href="../pt457178/index.html">Como os processadores s√£o projetados e fabricados: Design da CPU</a></li>
<li><a href="../pt457180/index.html">O site oficial Node.js agora est√° em russo</a></li>
<li><a href="../pt457182/index.html">L√≠ngua REXX, 40 anos</a></li>
<li><a href="../pt457184/index.html">Criar dinamicamente robots.txt para sites ASP.NET Core</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>