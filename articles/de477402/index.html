<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔌 ⚜️ 👩🏿‍🏭 Bereitstellen des Keras Deep Learning-Modells als Python-Webanwendung ♿️ 💈 🦕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Übersetzung des Artikels wurde speziell für Studenten des Kurses "Webentwickler in Python" erstellt. 



 Das Erstellen eines coolen maschinellen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bereitstellen des Keras Deep Learning-Modells als Python-Webanwendung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/477402/">  <i>Die Übersetzung des Artikels wurde speziell für Studenten des Kurses <a href="https://otus.pw/PcSx/">"Webentwickler in Python" erstellt.</a></i> <br><br><img src="https://habrastorage.org/webt/vz/ii/2j/vzii2j88n5_-t9hihzrz276v7ho.png"><br><hr><br>  Das Erstellen eines coolen maschinellen Lernprojekts ist eine Sache, eine andere Sache, wenn andere Leute es auch sehen müssen.  Natürlich kannst du das ganze Projekt auf GitHub stellen, aber wie werden deine Großeltern verstehen, was du getan hast?  Nein, wir müssen unser Deep-Learning-Modell als Webanwendung bereitstellen, die jedem auf der Welt zur Verfügung steht. <br><br>  In diesem Artikel erfahren Sie, wie Sie eine Webanwendung schreiben, die das von Keras trainierte, wiederkehrende neuronale Netzwerk verwendet und es Benutzern ermöglicht, neue Patentanmerkungen zu erstellen.  Dieses Projekt basiert auf der Arbeit aus dem Artikel <a href="https://medium.com/p/ffd204f99470%3Fsource%3Duser_profile---------6------------------">„Recurrent Neural Networks by Example“</a> , es ist jedoch nicht erforderlich zu wissen, wie RNN jetzt aufgebaut ist.  Im Moment betrachten wir es nur als Black Box: Wir legen die Anfangsreihenfolge fest und es wird eine völlig neue Patentanmerkung angezeigt, die in einem Browser angezeigt werden kann! <a name="habracut"></a><br><br>  In der Regel entwickeln Datenanalysten Modelle und zeigen sie im Front-End der Welt.  In diesem Projekt müssen wir beide Rollen spielen und in die Webentwicklung eintauchen (obwohl fast ausschließlich in Python). <br><br>  Für dieses Projekt müssen mehrere Tools kombiniert werden: <br><br><ul><li>  <a href="http://flask.pocoo.org/">Flasche</a> : um eine grundlegende Webanwendung in Python zu erstellen; </li><li>  <a href="http://keras.io/">Keras</a> : Bereitstellen eines <a href="http://keras.io/">vorab trainierten, wiederkehrenden</a> neuronalen Netzwerks </li><li>  Vorlagen aus der <a href="http://jinja.pocoo.org/">Jinja-</a> Vorlagen-Engine; </li><li>  <a href="https://www.w3schools.com/html/">HTML</a> und <a href="https://www.w3schools.com/html/html_css.asp">CSS</a> zum Erstellen von Webseiten. </li></ul><br>  Letztendlich erhalten wir eine Webanwendung, mit der Benutzer mithilfe eines trainierten neuronalen Netzes völlig neue Patentanmerkungen erstellen können. <br><br><img src="https://habrastorage.org/webt/l_/oc/2j/l_oc2jgyuokd3kvrsk2pn87bhis.gif"><br><br>  Der gesamte Projektcode ist auf <a href="https://github.com/WillKoehrsen/recurrent-neural-networks">GitHub</a> verfügbar. <br><br><h3>  Der Ansatz </h3><br>  Ziel war es, die Webanwendung so schnell wie möglich bereitzustellen.  Dafür habe ich Flask gewählt, mit dem Sie Anwendungen in Python schreiben können.  Ich mag es nicht, mit Stilen zu experimentieren (ich glaube, Sie haben sie bereits gesehen), daher kopiere ich fast alle CSS-Dateien aus Quellen von Drittanbietern und füge sie ein.  Dieser <a href="https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html">Artikel</a> vom Keras-Team war hilfreich, um die Grundlagen zu erlernen, und <a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">dieser Artikel</a> ist auch eine nützliche Anleitung. <br><blockquote>  <i>Im Allgemeinen entspricht dieses Projekt meinen Entwurfsprinzipien: Erstellen Sie einen Prototyp, der schnell funktioniert (Kopieren und Einfügen von beliebig viel Code), und wiederholen Sie das gleiche, um das Produkt zu verbessern.</i> </blockquote><h3>  Grundlegende Webanwendung für Flask </h3><br>  Der schnellste Weg, eine Python-Webanwendung zu erstellen, ist die Verwendung von Flask (http://flask.pocoo.org/).  Um unsere eigene Anwendung zu erstellen, können wir Folgendes verwenden: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Not Much Going On Here&lt;/h1&gt;"</span></span> app.run(host=<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>, port=<span class="hljs-number"><span class="hljs-number">50000</span></span>)</code> </pre> <br>  Wenn Sie diesen Code ausführen, sehen Sie Ihre eigene Anwendung auf localhost: 50000.  Natürlich brauchen wir etwas mehr, deshalb verwenden wir eine komplexere Funktion, die im Allgemeinen dasselbe tut: Sie verarbeitet Anforderungen von Ihrem Browser und stellt einige Inhalte in Form von HTML bereit. <br><br><h3>  Benutzereingabeformular </h3><br>  Wenn Benutzer zur Hauptseite der Anwendung wechseln, wird ihnen ein Formular mit drei Optionen angezeigt: <br><br><ol><li>  Geben Sie die Quellsequenz für die RNN ein oder generieren Sie sie nach dem Zufallsprinzip. </li><li>  Auswahl der „Vielfalt“ der RNN-Prognosen. </li><li>  Die Wahl der Anzahl der vom RNN ausgegebenen Wörter. </li></ol><br>  Um ein Formular in Python zu erstellen, verwenden wir <a href="https://wtforms.readthedocs.io/">wtforms</a> .  Sie werden den Code für seine Erstellung unten sehen: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wtforms <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> (Form, TextField, validators, SubmitField, DecimalField, IntegerField) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReusableForm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Form)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""User entry form for entering specifics for generation"""</span></span> <span class="hljs-comment"><span class="hljs-comment"># Starting seed seed = TextField("Enter a seed string or 'random':", validators=[ validators.InputRequired()]) # Diversity of predictions diversity = DecimalField('Enter diversity:', default=0.8, validators=[validators.InputRequired(), validators.NumberRange(min=0.5, max=5.0, message='Diversity must be between 0.5 and 5.')]) # Number of words words = IntegerField('Enter number of words to generate:', default=50, validators=[validators.InputRequired(), validators.NumberRange(min=10, max=100, message='Number of words must be between 10 and 100')]) # Submit button submit = SubmitField("Enter")</span></span></code> </pre> <br>  Damit haben wir das unten gezeigte Formular erstellt (mit Stilen aus <code>main.css</code> ): <br><br><img src="https://habrastorage.org/webt/ja/mc/2j/jamc2jeigbqz87z4flruuzuzp4e.png"><br><br>  Eine Überprüfung des Codes ist erforderlich, um sicherzustellen, dass der Benutzer die richtigen Informationen eingibt.  Zum Beispiel überprüfen wir, ob alle Felder ausgefüllt sind und der Wert des Diversity-Parameters zwischen 0,5 und 5 liegt. Diese Bedingungen müssen erfüllt sein, um beginnen zu können. <br><br><img src="https://habrastorage.org/webt/wz/wy/e2/wzwye2lrn8rrnfdp1lemj9hf4p4.png"><br>  <i>Fehler beim Validieren der eingegebenen Daten</i> <br><br>  Wir verarbeiten dieses Formular mit Vorlagen auf <code>Flask</code> . <br><br><h3>  Muster </h3><br>  Eine Vorlage ist eine Datei mit einem bereits vorbereiteten „Rahmen“, der lediglich auf eine bestimmte Weise ausgefüllt werden muss.  Für eine Flask-Webanwendung können wir die <a href="http://jinja.pocoo.org/">Jinja-</a> Vorlagenbibliothek verwenden, um Python-Code in ein HTML-Dokument zu übersetzen.  In unserer Hauptfunktion senden wir beispielsweise den Inhalt des Formulars an eine Vorlage mit dem Namen <code>index.html</code> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> render_template <span class="hljs-comment"><span class="hljs-comment"># Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br>  Wenn der Benutzer zur Hauptseite wechselt, wird von unserer Anwendung <code>index.html</code> Eingabe über das Formular <code>index.html</code> .  Die Vorlage ist eine vollständige HTML-Struktur, in der wir mithilfe der Syntax <code>{{variable}}</code> auf Python-Variablen verweisen. <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>RNN Patent Writing<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span>Writing Novel Patent Abstracts with Recurrent Neural Networks<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {% for message in form.seed.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.diversity.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.words.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">post</span></span></span><span class="hljs-tag">&gt;</span></span> {{ form.seed.label }} {{ form.seed }} {{ form.diversity.label }} {{ form.diversity }} {{ form.words.label }} {{ form.words }} {{ form.submit }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Wenn im Formular ein Fehler auftritt (Eingabe kann nicht überprüft werden), blinkt eine Fehlermeldung.  Außerdem wird das Formular wie in der obigen Datei angezeigt. <br><br>  Wenn der Benutzer Informationen eingibt und auf Senden klickt ( <code>POST</code> Anforderung), leiten wir die Eingabedaten bei korrekter Information an die entsprechende Funktion weiter, um Vorhersagen unter Verwendung von trainiertem RNN zu treffen.  Dies bedeutet, dass Sie <code>home()</code> ändern müssen. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request <span class="hljs-comment"><span class="hljs-comment"># User defined utility functions from utils import generate_random_start, generate_from_seed # Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # On form entry and all conditions met if request.method == 'POST' and form.validate(): # Extract information seed = request.form['seed'] diversity = float(request.form['diversity']) words = int(request.form['words']) # Generate a random sequence if seed == 'random': return render_template('random.html', input=generate_random_start(model=model, graph=graph, new_words=words, diversity=diversity)) # Generate starting from a seed sequence else: return render_template('seeded.html', input=generate_from_seed(model=model, graph=graph, seed=seed, new_words=words, diversity=diversity)) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br>  Wenn der Benutzer jetzt auf Senden drückt und die eingegebenen Informationen korrekt sind, wird die Eingabe abhängig von der Eingabe entweder an <code>generate_random_start</code> oder <code>generate_from_seed</code> gesendet.  Diese Funktionen verwenden das von Keras trainierte Modell, um ein neues Patent mit den Benutzer- und <code>diversity</code> Parametern <code>num_words</code> .  Die Ausgabe dieser Funktion wird wiederum nach dem Zufallsprinzip an die Vorlagen <code>random.html</code> oder <code>seeded.html</code> und als Webseite angezeigt. <br><br><h2>  Erstellen von Vorhersagen mit dem vortrainierten Keras-Modell </h2><br>  Der Parameter parameter enthält das vorab trainierte Keras-Modell, das wie folgt geladen wird: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_keras_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Load in the pre-trained model"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> model model = load_model(<span class="hljs-string"><span class="hljs-string">'../models/train-embeddings-rnn.h5'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Required for model to work global graph graph = tf.get_default_graph() load_keras_model()</span></span></code> </pre> <br>  (Im Wesentlichen gibt es eine <code>tf.get_default_graph()</code> , die wie <code>tf.get_default_graph()</code> aussieht: <code>tf.get_default_graph()</code> ) <br>  Ich werde nicht zwei <code>util</code> Funktionen vollständig <code>util</code> (den Code finden Sie <a href="https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/utils.py">hier</a> ), da Sie nur verstehen müssen, dass sie das bereits trainierte Keras-Modell zusammen mit den Parametern speichern und Vorhersagen treffen - Patentanmerkungen. <br><br>  Beide Funktionen geben einen String in Python mit formatiertem HTML zurück.  Diese Zeile wird an eine andere Vorlage gesendet, die als Webseite angezeigt wird.  Beispielsweise gibt <code>generate_random_start</code> formatiertes HTML zurück, das an <code>random.html</code> gesendet <code>random.html</code> : <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Random Starting Abstract <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>Home<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {{input|safe}} {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Hier verwenden wir wieder die <code>Jinja</code> Template-Engine, um eine formatierte HTML-Datei anzuzeigen.  Da der Python-String bereits in HTML übersetzt ist, müssen wir zur Anzeige nur <code>{{input|safe}}</code> (wobei <code>input</code> eine Python-Variable ist).  Dann <code>main.css</code> wir in <code>main.css</code> dieser Seite Stile hinzufügen, aber auch andere HTML-Seiten. <br><br><h3>  Arbeitsergebnis </h3><br>  Die Funktion <code>generate_random_start</code> wählt eine zufällige Patentanmerkung als Eingabesequenz aus und erstellt darauf basierende Vorhersagen.  Anschließend werden die Eingabesequenz, die von RNN generierte Ausgabe und die tatsächliche Ausgabe angezeigt: <br><br><img src="https://habrastorage.org/webt/z_/2y/6q/z_2y6q7q7xalfmwihsw3ohxwuza.png"><br>  <i>Die Ausgabe basiert auf einer zufälligen Eingabesequenz.</i> <br><br>  Die Funktion <code>generate_from_seed</code> akzeptiert die vom Benutzer eingegebene Anfangssequenz und erstellt darauf basierend Prognosen.  Die Ausgabe ist wie folgt: <br><br><img src="https://habrastorage.org/webt/vd/4t/xw/vd4txwgqdyresaxrd5a0midnosm.png"><br>  <i>Ausgabe basierend auf der Benutzereingabereihenfolge.</i> <br><br>  Obwohl die Ergebnisse nicht immer logische Sequenzen bilden, zeigen sie doch, dass das neuronale Netz mit den Grundlagen der englischen Sprache vertraut ist.  Sie wurde darauf trainiert, jedes nächste Wort basierend auf den vorherigen 50 vorauszusagen und dabei eine überzeugende Anmerkung auszuwählen.  Je nach <code>diversity</code> Parameter kann die Ausgabe völlig zufällig oder zyklisch sein. <br><br><h3>  Anwendungsstart </h3><br>  Um die Anwendung selbst zu starten, müssen Sie <code>run_keras_server.py</code> das Repository herunterladen, in das Verzeichnis <code>run_keras_server.py</code> , in dem sich die Bereitstellung befindet, und <code>run_keras_server.py</code> .  Die Anwendung wird bei <code>localhost:10000</code> verfügbar sein <code>localhost:10000</code> . <br><br>  Je nachdem, wie Ihr Heim-WLAN konfiguriert ist, sollten Sie über Ihre IP-Adresse von jedem Computer im Netzwerk aus auf die Anwendung zugreifen können. <br><br><h3>  Nächste Schritte </h3><br>  Die auf Ihrem PC ausgeführte Webanwendung eignet sich hervorragend zum Teilen mit Freunden und der Familie.  Ich empfehle jedoch definitiv nicht, es für alle in Ihrem Heimnetzwerk zu öffnen.  Später werden wir lernen, wie Sie die Anwendung auf <a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">AWS EC2</a> bereitstellen und sie schließlich der Welt zeigen. <br><br>  Um die Anwendung zu verbessern, können Sie die Stile ( <a href="">in main.css</a> ) <a href="">ändern</a> und möglicherweise zusätzliche Parameter hinzufügen, z. B. die Möglichkeit, ein vorab trainiertes <a href="https://github.com/WillKoehrsen/recurrent-neural-networks/tree/master/models">Netzwerk</a> auszuwählen.  Das Tolle an persönlichen Projekten ist, dass Sie sie so lange entwickeln können, wie Sie möchten.  Wenn Sie mit der Anwendung spielen möchten, laden Sie das <a href="https://github.com/WillKoehrsen/recurrent-neural-networks">Repository</a> herunter und legen Sie los. <br><br><img src="https://habrastorage.org/webt/hu/z9/up/huz9upmw2zstf5wdojoflzsrxey.gif"><br><br><h2>  Fazit </h2><br>  In diesem Artikel haben wir gelernt, wie ein vorgefertigtes Deep Learning-Modell von Keras als Webanwendung bereitgestellt wird.  Dies erforderte die Integration einer Reihe verschiedener Technologien, einschließlich wiederkehrender neuronaler Netze, Webanwendungen, Vorlagen, HTML, CSS und natürlich <a href="https://www.python.org/">Python</a> . <br><br>  Dies ist zwar eine grundlegende Anwendung, sie zeigt jedoch, dass Sie mit relativ geringem Aufwand Webanwendungen mit Deep Learning erstellen können.  Nur wenige Menschen können behaupten, dass sie ein Deep Learning-Modell in Form einer Webanwendung implementieren konnten. Wenn Sie jedoch die Anweisungen in diesem Artikel befolgen, können Sie einer von ihnen werden! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de477402/">https://habr.com/ru/post/de477402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de477388/index.html">NILFS2 - kugelsicheres Dateisystem für / home</a></li>
<li><a href="../de477390/index.html">Debuggen von Netzwerkverzögerungen in Kubernetes</a></li>
<li><a href="../de477392/index.html">Mikrofon öffnen: Backend. Wir laden Referenten ein</a></li>
<li><a href="../de477396/index.html">Wie melde ich mich für einen Kurs an und ... gehe zum Ende</a></li>
<li><a href="../de477400/index.html">Über den Beruf des Produktmanagers: Wie erreicht man das Ideal?</a></li>
<li><a href="../de477404/index.html">Das Problem des häufigen Erstellens und Löschens von Objekten in C ++</a></li>
<li><a href="../de477406/index.html">Technischer Support und Support. Gute Recherche auf dem Arbeitsmarkt und bei den Gehältern. Was hat sich in 2 Jahren verändert?</a></li>
<li><a href="../de477408/index.html">JavaFX Tutorial: Erweiterte Layouts</a></li>
<li><a href="../de477414/index.html">Data Engineer - Der sexyste Beruf des 21. Jahrhunderts</a></li>
<li><a href="../de477416/index.html">Wann ist es schädlich für Hash</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>