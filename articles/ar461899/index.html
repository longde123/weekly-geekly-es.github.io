<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ผ ๐๐ป ๐จ๐พโโ๏ธ ุงูุญุฏุซ ุงูุฌูู ุ CQRS ููุงุฑุงููู ๐ฉ๐ฟโ๐คโ๐ฉ๐ป ๐ฉ๐ฟโโ๏ธ ๐๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชู ุฅุนุฏุงุฏ ุชุฑุฌูุฉ ุงูููุงู ูุทูุงุจ ุงูุฏูุฑุฉ ุงูููููุฉ "Framework Laravel" 
 



 ููุฏูุฉ 
 ูุฐู ุงูููุงูุฉ ูุฎุตุตุฉ ูุฃุณุงุณูุงุช ุฅูุดุงุก ุฃูุธูุฉ CQRS ููุญุฏุซ ูู ูุบุฉ PHP ููู ุฅุทุงุฑ La...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุญุฏุซ ุงูุฌูู ุ CQRS ููุงุฑุงููู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/461899/" style=";text-align:right;direction:rtl">  <i>ุชู ุฅุนุฏุงุฏ ุชุฑุฌูุฉ ุงูููุงู ูุทูุงุจ ุงูุฏูุฑุฉ ุงูููููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Framework Laravel"</a></i> <i><br></i> <br><img src="https://habrastorage.org/webt/h8/4u/y5/h84uy5i5spnt3rdmpaiw2aynd0s.png"><br><br><hr><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  ูุฐู ุงูููุงูุฉ ูุฎุตุตุฉ ูุฃุณุงุณูุงุช ุฅูุดุงุก ุฃูุธูุฉ CQRS ููุญุฏุซ ูู ูุบุฉ PHP ููู ุฅุทุงุฑ Laravel.  ูู ุงูููุชุฑุถ ุฃู ุชููู ุนูู ุฏุฑุงูุฉ ุจูุฎุทุท ุงูุชุทููุฑ ุจุงุณุชุฎุฏุงู ูุงูู ุงูุฃูุงูุฑ ููุฏูู ููุฑุฉ ุนู ุงูุฃุญุฏุงุซ (ุนูู ูุฌู ุงูุฎุตูุต ุ ูุดุฑ ุงูุฃุญุฏุงุซ ููุฌููุนุฉ ูู ุงููุณุชูุนูู).  ูุชุญุฏูุซ ูุฐู ุงููุนุฑูุฉ ุ ููููู ุงุณุชุฎุฏุงู ุฎุฏูุฉ Laracasts.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุงูููุชุฑุถ ุฃู ูุฏูู ููููุง ูุนูููุง ููุจุฏุฃ CQRS.  ุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ูุฅููู ุฃูุตู ุจุดุฏุฉ ุจุงูุงุณุชูุงุน ุฅูู ูุญุงุถุฑุชูู: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุดุฉ ุนูู Mathias Verraes ุญูู ุฅูุดุงุก ุงูุฃุญุฏุงุซ</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GQ Young's CQRS ูุญุฏุซ ุงูุฌูู</a> . <br><a name="habracut"></a><br>  ูุง ุชุณุชุฎุฏู ุงูุดูุฑุฉ ุงููุงุฑุฏุฉ ููุง ูู ูุดุงุฑูุนู!  ุฅููุง ููุตุฉ ุชุนููููุฉ ูููู ุงูุฃููุงุฑ ุงููุงููุฉ ูุฑุงุก CQRS.  ูุง ูููู ุชุณููุฉ ูุฐู ุงูุดูุฑุฉ ุจุงูููุซูููุฉ ุ ุญูุซ ูุชู ุงุฎุชุจุงุฑูุง ุจุดูู ุณูุก ุ ูุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุงุฏุฑุงู ูุง ุฃููู ุจุจุฑูุฌุฉ ูุงุฌูุงุช ุ ูุฐูู ุณูููู ูู ุงูุตุนุจ ุชุบููุฑ ุฃุฌุฒุงุก ูุฑุฏูุฉ ูู ุงูููุฏ.  ุฃูุถู ูุซุงู ูุญุฒูุฉ CQRS ุงูุชู ููููู ุงุณุชุฎุฏุงููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Broadway ุ ุงูุฐู ุทูุฑุชู ุดุฑูุฉ Qandidate Lab</a> .  ูุฐุง ุฑูุฒ ูุธูู ููุฑุชุจุท ุจุดูู ูุถูุงุถ ุ ููุน ุฐูู ุ ูุฅู ุจุนุถ ุงูุชุฌุฑูุฏุงุช ุชุฌุนู ูู ุบูุฑ ุงููุงุถุญ ุชูุงููุง ูุง ุฅุฐุง ููุช ูู ุชุตุงุฏู ุฃูุธูุฉ ุฃุญุฏุงุซ ุฃุจุฏูุง. <br><br>  ูุงูุฃุฎูุฑ - ุงูููุฏ ุงูุฎุงุต ุจู ูุฑุชุจุท ุจุงูุฃุญุฏุงุซ ูุญุงููุฉ ููุงุฏุฉ Laravel.  ุฃุฑุฏุช ุฃู ุฃุฑู ููู ุณูุจุฏู ุงูุฑูุฒ ูู Laravel (ุนุงุฏุฉู ูุง ุฃุณุชุฎุฏู ูุฐุง ุงูุฅุทุงุฑ ููุดุงุฑูุน ุงูููุงูุงุช ุงูุตุบูุฑุฉ) ุ ููุน ุฐูู ุ ุจุงููุธุฑ ุฅูู ุงููุฑุงุก ุ ุฃุนุชูุฏ ุฃูู ููุจุบู ุนูู ุฅูุดุงุก ุชุทุจููุงุชู ุงูุฎุงุตุฉ.  ุขูู ุฃู ุชููู ุงูุดูุฑุฉ ุงูุฎุงุตุฉ ุจู ูุงุถุญุฉ ุญุชู ูุฃููุฆู ุงูุฐูู ูุง ูุณุชุฎุฏููู ุงูุฃุทุฑ. <br><br>  ุนูู github ุ ููุฌุฏ ุงูููุฏ ูู <a href="">https://github.com/scazz/cqrs-tutorial.git</a> ุ ููู ุฏููููุง ุณููุธุฑ ูู ููููุงุชู ูุฒูุงุฏุฉ ุงูููุทู. <br><br>  ุณูููู ุจุฅูุดุงุก ูุธุงู ุงูุชุณุฌูู ุงูุฃููู ููุฏุฑุณุฉ ุฑููุจ ุงูุฃููุงุฌ.  ูู ุฎูุงู ูุณุงุนุฏุชูุง ุ ูููู ูุนููุงุก ุงููุฏุงุฑุณ ุงูุชุณุฌูู ูู ุงููุตูู ุงูุฏุฑุงุณูุฉ.  ุจุงููุณุจุฉ ูุนูููุฉ ุงูุชุณุฌูู ุ ูููู ุจุตูุงุบุฉ ุงูููุงุนุฏ ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ููู ุฏุฑุณ ุนููู ูุงุญุฏ ุนูู ุงูุฃูู ... </li><li style=";text-align:right;direction:rtl">  ... ูููู ููุณ ุฃูุซุฑ ูู ุซูุงุซุฉ. </li></ul><br>  ูุงุญุฏุฉ ูู ุงูููุฒุงุช ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุฅุนุฌุงุจ ูุฃูุธูุฉ CQRS ุงููุณุชูุฏุฉ ุฅูู ุงูุญุฏุซ ูู ุฅูุดุงุก ููุงุฐุฌ ุงููุฑุงุกุฉ ุงูุฎุงุตุฉ ุจูู ููุงุณ ูุทููุจ ูู ุงููุธุงู.  ุณุชุฌุฏ ุฃูุซูุฉ ูุฅุณูุงุท ููุงุฐุฌ ุงููุฑุงุกุฉ ูู ElasticSearch ุ ูููุฐ Greg Young ูุบุฉ ููุฌูุฉ ูุญู ุงูููุถูุน ูู ูุชุฌุฑ ุงูุฃุญุฏุงุซ ุงูุฎุงุต ุจู ููุชุนุงูู ูุน ุงูุฃุญุฏุงุซ ุงููุนูุฏุฉ.  ููุน ุฐูู ุ ูู ุฃุฌู ุงูุจุณุงุทุฉ ุ ุณูููู ุนุฑุถ ุงููุฑุงุกุฉ ุงูุฎุงุต ุจูุง ุจูุซุงุจุฉ ูุงุนุฏุฉ ุจูุงูุงุช SQL ููุงุณูุฉ ููุงุณุชุฎุฏุงู ูุน Eloquent.  ูุชูุฌุฉ ูุฐูู ุ ุณูููู ูุฏููุง ุฌุฏูู ูุงุญุฏ ูููุตูู ูุขุฎุฑ ููุนููุงุก. <br><br>  ูุณูุญ ูู ููููู ุฅูุดุงุก ุงูุญุฏุซ ุฃูุถูุง ุจูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ ูู ูุถุน ุนุฏู ุงูุงุชุตุงู.  ููู ูู ูุฐู ุงูููุงูุฉ ุณุฃูุชุฒู ุจููุงุฐุฌ ุงูุชุทููุฑ "ุงูุชูููุฏูุฉ" ุฅูู ุงูุญุฏ ุงูุฃูุตู (ูุฑุฉ ุฃุฎุฑู ุ ูุชุจุณูุทูุง) ุ ูุณูุชู ุชุญุฏูุซ ุชููุนุงุช ุงููุฑุงุกุฉ ูุฏููุง ูู ุงูููุช ุงูุญูููู ุ ูุจุงุดุฑุฉ ุจุนุฏ ุชุฎุฒูู ุงูุฃุญุฏุงุซ ูู ุงููุณุชูุฏุน. <br><br><h2 style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ ุงููุดุฑูุน ูุงูุงุฎุชุจุงุฑ ุงูุฃูู </h2><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">git clone https://github.com/scazz/cqrs-tutorial</code> </pre> <br>  ุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ ูุงุฑุงููู 5 <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$&gt; laravel new cqrs-tutorial</code> </pre> <br>  ูุจุงููุณุจุฉ ูููุจุชุฏุฆูู ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุงุฎุชุจุงุฑ.  ุณูุณุชุฎุฏู ุงุฎุชุจุงุฑ ุงูุชูุงูู ุ ุงูุฐู ุณูุถูู ุฃู ุชุณุฌูู ุงูุนููู ูููุตูู ูุคุฏู ุฅูู ุญูููุฉ ุฃู ุงูุฏุฑุณ ุชู ุฅูุดุงุคู ูู ูููุฐุฌ Eloquent ุงูุฎุงุต ุจูุง. <br><br>  ูุงุฆูุฉ ุงูุงุฎุชุจุงุฑุงุช / CQRSTest.php: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">use Illuminate\Foundation\Bus\DispatchesCommands; class CQRSTest extends TestCase { use DispatchesCommands;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">/** *  ,   BookLesson       * @<span class="hljs-built_in"><span class="hljs-built_in">return</span></span> void */ public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testFiringEventUpdatesReadModel</span></span></span></span>() { <span class="hljs-variable"><span class="hljs-variable">$testLessonId</span></span> = <span class="hljs-string"><span class="hljs-string">'123e4567-e89b-12d3-a456-426655440000'</span></span>; <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span> = <span class="hljs-string"><span class="hljs-string">"George"</span></span>; <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> = new LessonId(<span class="hljs-variable"><span class="hljs-variable">$testLessonId</span></span>); <span class="hljs-variable"><span class="hljs-variable">$command</span></span> = new BookLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch(<span class="hljs-variable"><span class="hljs-variable">$command</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertNotNull(Lesson::find(<span class="hljs-variable"><span class="hljs-variable">$testLessonId</span></span>)); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertEquals( Lesson::find(<span class="hljs-variable"><span class="hljs-variable">$testLessonId</span></span>)-&gt;clientName, <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span> ); } }</code> </pre> <br>  ูุญู ููุดุฑ ูุดุงุทูุง ุฌุฏูุฏูุง ููุนุฑู ุ ูุฃูุดุฆ ูุฑูููุง ููุงุดุชุฑุงู ูู ูุดุงุท ุฌุฏูุฏ ุ ููุทูุจ ูู Laravel ุฅุฑุณุงูู.  ูู ุฌุฏูู ุงูุฏุฑูุณ ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ ูููููุง ูุฑุงุกุชู ุจุงุณุชุฎุฏุงู ูููุฐุฌ Eloquent.  ูุญุชุงุฌ ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช ุ ูุฐุง ุงููุฃ ููู .env ุจุดูู ุตุญูุญ. <br><br>  ูุชู ุฅุฑูุงู ูู ุญุฏุซ ูุณุฌู ูู ูุชุฌุฑ ุงูุฃุญุฏุงุซ ุงูุฎุงุต ุจูุง ุจุฌุฐุฑ ุงููุฌููุนุฉ ุ ูุงูุฐู ุณูุทูู ุนููู ุจุจุณุงุทุฉ ุงูููุงู (ุงูููุงู) - ุงูุชุฌุฑูุฏ ููุฃุบุฑุงุถ ุงูุชุนููููุฉ ูุถูู ููุท ุงูุงุฑุชุจุงู.  ุงููุนุฑู ูู ูุนุฑู ูุฑูุฏ ุนุงููู (UUID).  ูุง ููุชู ูุชุฌุฑ ุงูุฃุญุฏุงุซ ุฅุฐุง ูุงู ุงูุญุฏุซ ููุทุจู ุนูู ุงูุฏุฑุณ ุฃู ุงูุนููู.  ุฅูู ูุนูู ููุท ุฃูู ูุฑุชุจุท ุจูุนุฑู. <br><br>  ุจูุงุกู ุนูู ุงูุฃุฎุทุงุก ุงูุชู ุชู ุชุญุฏูุฏูุง ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ ุ ูููููุง ุฅูุดุงุก ูุตูู ููููุฏุฉ.  ุฃููุงู ุ ุณูููู ุจุฅูุดุงุก ูุฆุฉ LessonId ุ ุซู ุฃูุฑ BookLesson (ูุง ุชููู ุจุดุฃู ุทุฑููุฉ ุงููุนุงูุฌ ุญุชู ุงูุขู ุ ููุท ูู ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑ).  ูุฆุฉ ุงูุฏุฑุณ ูู ูููุฐุฌ ูููุฑุงุกุฉ ุฎุงุฑุฌ ูุณุงุญุฉ ุงุณู ุงูุฏุฑุณ.  ูููุฐุฌ ูุฑุงุกุฉ ุญุตุฑู - ูู ูุชู ุชุฎุฒูู ููุทู ููุทูุฉ ุงูููุถูุน ููุง ูุทูููุง.  ูู ุงูุฎุชุงู ุ ุณูุญุชุงุฌ ุฅูู ุฅูุดุงุก ุชุฑุญูู ูุฌุฏูู ุงูุฏุฑุณ. <br><br>  ููุญูุงุธ ุนูู ูุถูุญ ุงูุดูุฑุฉ ุ ุณุฃุณุชุฎุฏู ููุชุจุฉ ุงูุชุญูู ูู ุงูุชุฃููุฏ.  ูููู ุฅุถุงูุชู ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$&gt; composer require beberlei/assert</code> </pre> <br>  ุงููุธุฑ ูู ุงูุนูููุฉ ุงูุชู ููุจุบู ุฃู ุชุจุฏุฃ ูู ูุจู ูุฐุง ุงูุฃูุฑ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุงูุตุญุฉ: โโูุฏ ุชูุดู ุงูุฃูุงูุฑ ุงูุถุฑูุฑูุฉ ุ ููุฏ ููุนุช ุงูุฃุญุฏุงุซ ุจุงููุนู ูุจุงูุชุงูู ูุง ููุจุบู ุฃู ุชูุดู. </li><li style=";text-align:right;direction:rtl">  ูู ุจุฅูุดุงุก ุญุฏุซ LessonWasBooked ุฌุฏูุฏ (ุงุดุชุฑู ูู ุฏุฑุณ). </li><li style=";text-align:right;direction:rtl">  ุชุญุฏูุซ ุญุงูุฉ ุงููุดุงุท.  (ูุฌุจ ุฃู ูููู ุทุฑุงุฒ ุงูุณุฌู ุนูู ุฏุฑุงูุฉ ุจุญุงูุฉ ุงููููุฐุฌ ุญุชู ูุชููู ูู ุฅุฌุฑุงุก ุงูุชุญูู ูู ุงูุตุญุฉ.) </li><li style=";text-align:right;direction:rtl">  ุฃุถู ูุฐุง ุงูุญุฏุซ ุฅูู ูุฌููุนุฉ ุงูุฃุญุฏุงุซ ุบูุฑ ุงูููุชุฒู ุจูุง ุงููุฎุฒูุฉ ูู ูููุฐุฌ ุณุฌู ุงููุดุงุท. </li><li style=";text-align:right;direction:rtl">  ุงุญูุธ ูุฌููุนุฉ ุงูุฃุญุฏุงุซ ุบูุฑ ุงูููุชุฒู ุจูุง ูู ุงููุณุชูุฏุน. </li><li style=";text-align:right;direction:rtl">  ุงุฑูุน ุญุฏุซ LessonWasBooked ุนูู ูุณุชูู ุงูุนุงูู ูุฅุนูุงู ุฌููุน ุฃุฌูุฒุฉ ูุฑุงุกุฉ ุงููุฑุงุกุฉ ุจุชุญุฏูุซ ุฌุฏูู ุงูุฏุฑุณ. </li></ol><br>  ุชุญุชุงุฌ ุฃููุงู ุฅูู ุฅูุดุงุก ูููุฐุฌ ุชุณุฌูู ููุฏุฑุณ.  ุณูู ูุณุชุฎุฏู ุทุฑููุฉ ุงููุตูุน ุงูุซุงุจุช <code>Lesson::bookClientOntoNewLesson()</code> .  ูููู ุจุฅูุดุงุก ุญุฏุซ <code>LessonWasOpened</code> ุฌุฏูุฏ (ุงูุฏุฑุณ ููุชูุญ) ุ ููุทุจู ูุฐุง ุงูุญุฏุซ ุนูู ููุณู (ููุท ูุญุฏุฏ ูููุชู) ุ ููุถูู ุงูุญุฏุซ ุงูุฌุฏูุฏ ุฅูู ูุงุฆูุฉ ุงูุฃุญุฏุงุซ ุบูุฑ ุงูููุชุฒู ุจูุง ูู ุดูู <code>DomainEventMessage</code> (ุงูุญุฏุซ ุจุงูุฅุถุงูุฉ ุฅูู ุจุนุถ ุงูุจูุงูุงุช ุงูุชุนุฑูููุฉ ุงูุชู ูุณุชุฎุฏููุง ุนูุฏ ุงูุญูุธ ูู ูุฎุฒู ุงูุฃุญุฏุงุซ). <br><br>  ุชุชูุฑุฑ ุงูุนูููุฉ ูุฅุถุงูุฉ ุนููู ุฅูู ุงูุญุฏุซ.  ุนูุฏ ุชุทุจูู ุญุฏุซ <code>ClientWasBookedOntoLesson</code> (ุชู ุชุณุฌูู ุงูุนููู ูู ุงูุฏุฑุณ) ุ ูุฅู ูููุฐุฌ ุงูุชุณุฌูู ูุง ูุชุชุจุน ุฃุณูุงุก ุงูุนููุงุก ุ ูููู ููุท ุนุฏุฏ ุงูุนููุงุก ุงููุณุฌููู.  ูุง ุชุญุชุงุฌ ููุงุฐุฌ ุงูุณุฌูุงุช ุฅูู ูุนุฑูุฉ ุฃุณูุงุก ุงูุนููุงุก ูุถูุงู ุงูุงุชุณุงู. <br><br>  ูุฏ ูุจุฏู ุฃู ุฃุณุงููุจ <code>applyClientWasBookedOntoLesson</code> ู <code>applyClientWasBookedOntoLesson</code> ุบุฑูุจุฉ ุจุนุถ ุงูุดูุก ูู <code>applyClientWasBookedOntoLesson</code> ุงูุญุงูู.  ุณูุณุชุฎุฏููุง ูุงุญููุง ุนูุฏูุง ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงูุฃุญุฏุงุซ ุงููุฏููุฉ ูู ุฃุฌู ุชุดููู ุญุงูุฉ ูููุฐุฌ ุงูุชุณุฌูู.  ููุณ ูู ุงูุณูู ุดุฑุญ ุฐูู ุ ูุฐูู ุณุฃูุฏู ูู ููุฏูุง ูุณุงุนุฏู ุนูู ููู ูุฐู ุงูุนูููุฉ.  ูู ููุช ูุงุญู ุ ุณูููู ุจุงุณุชุฎุฑุงุฌ ุงูููุฏ ุงูุฐู ูุนุงูุฌ uncommittedEvents ููููู ุจุฅูุดุงุก ุฑุณุงุฆู ุฃุญุฏุงุซ ุงููุฌุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">app/School/Lesson/Lesson.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> openLesson( LessonId <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> ) { /*      ,      ,       */ <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;apply( new LessonWasOpened( <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>) ); } protected <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> applyLessonWasOpened( LessonWasOpened <span class="hljs-variable"><span class="hljs-variable">$event</span></span> ) { <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;lessonId = <span class="hljs-variable"><span class="hljs-variable">$event</span></span>-&gt;getLessonId(); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;numberOfClients = 0; } public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> bookClient( <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;numberOfClients &gt;= 3) { throw new TooManyClientsAddedToLesson(); } <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;apply( new ClientBookedOntoLesson( <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;lessonId, <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span>) ); } /** *       โ *  ,       *      ,       , *      . */ protected <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> applyClientBookedOntoLesson( ClientBookedOntoLesson <span class="hljs-variable"><span class="hljs-variable">$event</span></span> ) { <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;numberOfClients++; }</code> </pre> <br>  ูููููุง ุงุณุชุฎุฑุงุฌ ููููุงุช CQRS ูู ูููุฐุฌ ุงูุชุณุฌูู ุงูุฎุงุต ุจูุง - ุฃุฌุฒุงุก ูู ุงููุตู ุชุดุงุฑู ูู ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ ุบูุฑ ุงูููุชุฒู ุจูุง.  ูููููุง ุฃูุถูุง ูุณุญ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ูููุงู ุชู ุฅูุดุงุคู ูู ุฎูุงู ุฅูุดุงุก ูุธููุฉ <code>applyEventName()</code> ุขููุฉ ุชูุจู ุงูุญุฏุซ ุ ูุชุฏุนู <code>applyEventName()</code> ุงููุทุงุจู ุ ูุชุถูู ุญุฏุซ <code>DomainEventMessage</code> ุฌุฏูุฏูุง ุฅูู ูุงุฆูุฉ ุงูุฃุญุฏุงุซ ุบูุฑ ุงูููุชุฒู ุจูุง.  ุงููุฆุฉ ุงููุณุชุฎุฑุฌุฉ ุนุจุงุฑุฉ ุนู ุชูุงุตูู ูุชูููุฐ CQRS ููุง ุชุญุชูู ุนูู ููุทู ุงููุฌุงู ุ ูุฐูู ูููููุง ุฅูุดุงุก ูุณุงุญุฉ ุงุณู ุฌุฏูุฏุฉ: App \ CQRS: <br><br>  <i>ุงูุชุจู ุฅูู <code>app/CQRS/EventSourcedEntity.php</code> ุงูููุฏ <code>app/CQRS/EventSourcedEntity.php</code></i> <i><br></i>  <i>ููู ุชุนูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุฆุฉ <code>DomainEventMessage</code> ุ ููู DTO ุจุณูุทุฉ - ูููู ุงูุนุซูุฑ ุนูููุง ูู <code>app/CQRS/DomainEventMessage.php</code></i> <br><br>  ูุจุงูุชุงูู ุ ุญุตููุง ุนูู ูุธุงู ูููู ุจุฅูุดุงุก ุฃุญุฏุงุซ ููู ูุญุงููุฉ ูุชุงุจุฉ ููุณุชุฎุฏู ุงูุฃุญุฏุงุซ ูุชุณุฌูู ุงูุชุบููุฑุงุช ุงููุงุฒูุฉ ูููุน ุงููุชุบูุฑุงุช.  ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุญูุธ ูุฐู ุงูุฃุญุฏุงุซ ูู ุงููุชุฌุฑ (EventStore).  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุฌุจ ุฅูุดุงุก ูุณุชูุฏุน ุงูุญุฏุซ ูุฐุง.  ูุชุจุณูุท ุ ุณูู ูุณุชุฎุฏู ูููุฐุฌ Eloquent ุ ููู ุฌุฏูู SQL ุจุณูุท ูุน ุงูุญููู ุงูุชุงููุฉ: * <code>UUID</code> (ููุนุฑูุฉ ุงูููุงู ุงูุฐู ุณูุชู ุชุทุจูู ุงูุญุฏุซ ุนููู) * <code>event_payload</code> (ุฑุณุงูุฉ ูุชุณูุณูุฉ ุชุญุชูู ุนูู ูู ุดูุก ุถุฑูุฑู ูุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุญุฏุซ) * <code>event_payload</code> - ุงูุทุงุจุน ุงูุฒููู ููุนุฑูุฉ ูุชู ุญุฏุซ ุญุฏุซ ูุง ุญุฏุซ.  ุฅุฐุง ููุช ุจูุฑุงุฌุนุฉ ุงูููุฏ ุจุนูุงูุฉ ุ ูุณุชุฑู ุฃููู ููุช ุจุฅูุดุงุก ุฃูุฑูู - ูุฅูุดุงุก ุฌุฏูู ุชุฎุฒูู ุงูุฃุญุฏุงุซ ุงูุฎุงุต ุจูุง ูุชุฏููุฑู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  php ุงูุญุฑูู eloquenteventstore: ุฅูุดุงุก (App \ CQRS \ EloquentEventStore \ CreateEloquentEventStore) </li><li style=";text-align:right;direction:rtl">  ุงูุญุฑูู php eloquenteventstore: drop (App \ CQRS \ EloquentEventStore \ DropEloquentEventStore) (ูุง ุชูุณ ุฅุถุงูุชูุง ุฅูู App \ Console \ Kernel.php ุจุญูุซ ูุชู ุชุญููููุง). </li></ul><br>  ููุงู ุณุจุจุงู ุฌูุฏุงู ูุนุฏู ุงุณุชุฎุฏุงู SQL ููุฎุฒู ุฃุญุฏุงุซ: ูุง ูุชู ุชุทุจูู ุทุฑุงุฒ ุงูุฅูุญุงู ููุท (ููุท ุฅุถุงูุฉ ุงูุจูุงูุงุช ุ ููุฌุจ ุฃู ุชููู ุงูุฃุญุฏุงุซ ุบูุฑ ูุงุจูุฉ ููุชุบููุฑ) ุ ูุฃูุถูุง ูุฃู SQL ููุณุช ูุบุฉ ุงุณุชุนูุงู ูุซุงููุฉ ูููุงุนุฏ ุงูุจูุงูุงุช ุงูุฒูููุฉ.  ูุจุฑูุฌ ุงููุงุฌูุฉ ูุชุณููู ุงุณุชุจุฏุงู ูุฎุฒู ุงูุฃุญุฏุงุซ ูู ุงูููุดูุฑุงุช ุงููุงุญูุฉ. <br><br>  ูุญูุธ ุงูุฃุญุฏุงุซ ุ ุงุณุชุฎุฏู ุงููุณุชูุฏุน.  ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก <code>save()</code> ููููุฐุฌ ุงูุชุณุฌูู ุ ูุฅููุง ูุญูุธ ูุงุฆูุฉ uncommittedEvents ูู ูุฎุฒู ุงูุฃุญุฏุงุซ.  ูุชุฎุฒูู ุงูุฃุญุฏุงุซ ุ ูุญุชุงุฌ ุฅูู ุขููุฉ ูุชุณูุณููุง ูุฅูุบุงุก ุงูุชุณูุณู.  ุฅูุดุงุก Serializer ููุฐุง.  ุณูุญุชุงุฌ ุฅูู ุจูุงูุงุช ูุตููุฉ ุ ูุซู ูุฆุฉ ุงูุญุฏุซ (ุนูู ุณุจูู ุงููุซุงู ุ <code>App\School\Lesson\Events\LessonWasOpened</code> ) <code>App\School\Lesson\Events\LessonWasOpened</code> ุญุฏุซ (ุงูุจูุงูุงุช ุงููุงุฒูุฉ ูุฅุนุงุฏุฉ ุจูุงุก ุงูุญุฏุซ). <br><br>  ุณูุชู ุชุดููุฑ ูู ูุฐุง ุจุชูุณูู JSON ุ ุซู ูุชุงุจุชู ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุฅูู ุฌุงูุจ ุงูููุงู UUID ูุงูุทุงุจุน ุงูุฒููู.  ูุฑูุฏ ุชุญุฏูุซ ููุงุฐุฌ ุงููุฑุงุกุฉ ุงูุฎุงุตุฉ ุจูุง ุจุนุฏ ุงูุชูุงุท ุงูุฃุญุฏุงุซ ุ ูุจุงูุชุงูู ูุฅู ุงููุฎุฒูู ุณูุดุบู ูู ุญุฏุซ ุจุนุฏ ุงูุญูุธ.  ุณูููู Serializer ูุณุคููุงู ุนู ูุชุงุจุฉ ูุฆุฉ ุงูุญุฏุซ ุ ูู ุญูู ุณูููู ุงูุญุฏุซ ูุณุคููุงู ุนู ุฅุฌุฑุงุก ุชุณูุณู ูุญููุชู.  ุณูุจุฏู ุงูุญุฏุซ ุงููุชุณูุณู ุจุงููุงูู ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> { class: "App\\School\\Lesson\\Events\\", event: $event-&gt;serialize() }</code> </pre> <br>  ูุธุฑูุง ูุฃู ุฌููุน ุงูุฃุญุฏุงุซ ุชุชุทูุจ ุฃุณููุจูุง ููุชุณูุณู ูุฅูุบุงุก ุงูุชุณูุณู ุ ูููููุง ุฅูุดุงุก ูุงุฌูุฉ <code>SerializableEvent</code> ูุฅุถุงูุฉ ูุคุดุฑ ูููุน ุงููููุฉ ุงููุชููุนุฉ.  ุชุญุฏูุซ ุญุฏุซ <code>LessonWasOpened</code> ุจูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">app/School/Lesson/Events/LessonWasOpened.php class LessonWasOpened implements SerializableEvent { public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serialize</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> array( <span class="hljs-string"><span class="hljs-string">'lessonId'</span></span>=&gt; (string) <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;getLessonId() ); } }</code> </pre> <br>  ุฅูุดุงุก ูุณุชูุฏุน <code>LessonRepository</code> .  ูููููุง refactor ูุงุณุชุฎุฑุงุฌ ููููุงุช CQRS ุงูุฃุณุงุณูุฉ ูู ููุช ูุงุญู. <br><br> <code>app/School/Lesson/LessonRepository.php</code> <br> <pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">eventStoreRepository = new EloquentEventStoreRepository( new EventSerializer() ); } public function save(Lesson $lesson) { /** @var DomainEventMessage $domainEventMessage */ foreach( $lesson-&gt;getUncommittedDomainEvents() as $domainEventMessage ) { $this-&gt;eventStoreRepository-&gt;append( $domainEventMessage-&gt;getId(), $domainEventMessage-&gt;getEvent(), $domainEventMessage-&gt;getRecordedAt() ); Event::fire($domainEventMessage-&gt;getEvent()); } } }</code> </pre> <br>  ุฅุฐุง ููุช ุจุชุดุบูู ุงุฎุชุจุงุฑ ุงูุชูุงูู ูุฑุฉ ุฃุฎุฑู ุซู ุชุญูู ูู ุฌุฏูู SQL <code>domain_events</code> ุ ูุณุชุฑู ุญุฏุซูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. <br><br>  ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ ูู ุงุฌุชูุงุฒ ุงูุงุฎุชุจุงุฑ ุจูุฌุงุญ ูู ุงูุงุณุชูุงุน ุฅูู ุฃุญุฏุงุซ ุงูุจุซ ูุชุญุฏูุซ ุฅุณูุงุท ูููุฐุฌ ูุฑุงุกุฉ ุงูุฏุฑุณ.  ุณูุชู ุงุนุชุฑุงุถ ุฃุญุฏุงุซ ุจุซ ุงูุฏุฑุณ ูู ูุจู <code>LessonProjector</code> ุ ูุงูุชู ุณุชุทุจู ุงูุชุบููุฑุงุช ุงููุงุฒูุฉ ุนูู <code>LessonProjection</code> (ููุงุฐุฌ ุจููุบุฉ ูู ุฌุฏูู ุงูุฏุฑุณ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> app/School/Lesson/Projections/LessonProjector.php class LessonProjector { public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> applyLessonWasOpened( LessonWasOpened <span class="hljs-variable"><span class="hljs-variable">$event</span></span> ) { <span class="hljs-variable"><span class="hljs-variable">$lessonProjection</span></span> = new LessonProjection(); <span class="hljs-variable"><span class="hljs-variable">$lessonProjection</span></span>-&gt;id = <span class="hljs-variable"><span class="hljs-variable">$event</span></span>-&gt;getLessonId(); <span class="hljs-variable"><span class="hljs-variable">$lessonProjection</span></span>-&gt;save(); } public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> subscribe(Dispatcher <span class="hljs-variable"><span class="hljs-variable">$events</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$fullClassName</span></span> = self::class; <span class="hljs-variable"><span class="hljs-variable">$events</span></span>-&gt;listen( LessonWasOpened::class, <span class="hljs-variable"><span class="hljs-variable">$fullClassName</span></span>.<span class="hljs-string"><span class="hljs-string">'@applyLessonWasOpened'</span></span>); } }  app/School/Lesson/Projections/LessonProjection.php class LessonProjection extends Model { public <span class="hljs-variable"><span class="hljs-variable">$timestamps</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; protected <span class="hljs-variable"><span class="hljs-variable">$table</span></span> = <span class="hljs-string"><span class="hljs-string">"lessons"</span></span>; }</code> </pre> <br>  ุฅุฐุง ููุช ุจุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑ ุ ุณุชุฑู ุฃู ุฎุทุฃ SQL ูุฏ ุญุฏุซ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Unknown column 'clientName' in 'field list'</code> </pre> <br>  ุจูุฌุฑุฏ ุฅูุดุงุก ุนูููุฉ ุชุฑุญูู ูุฅุถุงูุฉ <code>clientName</code> ุฅูู ุฌุฏูู ุงูุฏุฑุณ ุ <code>clientName</code> ุงูุงุฎุชุจุงุฑ ุจูุฌุงุญ.  ูููุง ุจุชุทุจูู ุงููุธููุฉ ุงูุฃุณุงุณูุฉ ูู CQRS: ุชููู ุงููุฑู ุจุฅูุดุงุก ุฃุญุฏุงุซ ุชุณุชุฎุฏู ูุฅูุดุงุก ููุงุฐุฌ ุงููุฑุงุกุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญุณูู ูููุฐุฌ ุงููุฑุงุกุฉ ูุน ุงูุฑูุงุจุท </h2><br>  ููุฏ ูุตููุง ุฅูู ูุนูู ูุงู ุ ููู ูุฐุง ููุณ ูู ุดูุก!  ุญุชู ุงูุขู ุ ูุฏุนู ูููุฐุฌ ุงููุฑุงุกุฉ ุนููููุง ูุงุญุฏูุง ููุท (ุญุฏุฏูุง ุซูุงุซุฉ ูู ููุงุนุฏ ูุฌุงููุง).  ุงูุชุบููุฑุงุช ุงูุชู ูุฌุฑููุง ุนูู ูููุฐุฌ ุงููุฑุงุกุฉ ุจุณูุทุฉ ููุบุงูุฉ: ูููู ููุท ุจุฅูุดุงุก ูููุฐุฌ ุงูุฅุณูุงุท Client ู <code>ClientProjector</code> ุงูุฐู ููุณู ุงูุญุฏุซ <code>ClientBookedOntoLesson</code> .  ุฃููุงู ุ ูููู ุจุชุญุฏูุซ ุงุฎุชุจุงุฑูุง ููุนูุณ ุงูุชุบููุฑุงุช ุงูุชู ูุฑูุฏ ุฃู ูุฑุงูุง ูู ูููุฐุฌ ุงููุฑุงุกุฉ ูุฏููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">tests/CQRSTest.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testFiringEventUpdatesReadModel</span></span></span></span>() { <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> = new LessonId( (string) \Rhumsaa\Uuid\Uuid::uuid1() ); <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span> = <span class="hljs-string"><span class="hljs-string">"George"</span></span>; <span class="hljs-variable"><span class="hljs-variable">$command</span></span> = new BookLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch(<span class="hljs-variable"><span class="hljs-variable">$command</span></span>); <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span> = Lesson::find( (string) <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertEquals( <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>-&gt;id, (string) <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> ); <span class="hljs-variable"><span class="hljs-variable">$client</span></span> = <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>-&gt;clients()-&gt;first(); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertEquals(<span class="hljs-variable"><span class="hljs-variable">$client</span></span>-&gt;name, <span class="hljs-variable"><span class="hljs-variable">$clientName</span></span>); }</code> </pre><br>  ูุฐุง ุฏููู ูุงุถุญ ุนูู ูุฏู ุณูููุฉ ุชุบููุฑ ููุงุฐุฌ ุงููุฑุงุกุฉ.  ูู ุดูุก ุ ูุตููุง ุฅูู ูุณุชูุฏุน ุงูุญุฏุซ ุ ูุง ูุฒุงู ุฏูู ุชุบููุฑ.  ุนูู ุณุจูู ุงูููุงูุฃุฉ ุ ุนูุฏ ุงุณุชุฎุฏุงู ูุธุงู ุงูุฃุญุฏุงุซ ุ ูุญุตู ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑุงุช ุงูุฃุณุงุณูุฉ - ุนูุฏ ุชุบููุฑ ุฌูุงุฒ ุงูุนุฑุถ ููููุฐุฌ ุงููุฑุงุกุฉ ุ ูุณุชูุน ุฅูู ูู ุญุฏุซ ุญุฏุซ ูู ูุธุงููุง. <br><br>  ูุนูุฏ ุฅูุชุงุฌ ูุฐู ุงูุฃุญุฏุงุซ ุจุงุณุชุฎุฏุงู ุฌูุงุฒ ุงูุนุฑุถ ุงูุฌุฏูุฏ ุ ููุชุญูู ูู ุงูุงุณุชุซูุงุกุงุช ุ ูููุงุฑู ุงููุชุงุฆุฌ ูุน ุงูุชููุนุงุช ุงูุณุงุจูุฉ.  ุจุนุฏ ุฃู ูุนูู ุงููุธุงู ูุจุนุถ ุงูููุช ุ ุณูููู ูุฏููุง ูุฌููุนุฉ ุชูุซูููุฉ ุฅูู ุญุฏ ูุง ูู ุงูุฃุญุฏุงุซ ูุงุฎุชุจุงุฑ ุฃุฌูุฒุฉ ุงูุนุฑุถ ูุฏููุง. <br><br>  ูููุฐุฌ ุงูุชุณุฌูู ูุฏููุง ุญุงูููุง ูุง ูููู ุงููุฏุฑุฉ ุนูู ุชุญููู ุงูุญุงูุฉ ุงูุญุงููุฉ.  ุฅุฐุง ุฃุฑุฏูุง ุฅุถุงูุฉ ุนููู ุซุงูู ุฅูู ุงูุฏุฑุณ ุ ููููููุง ุจุจุณุงุทุฉ ุฅูุดุงุก ุญุฏุซ ClientWasidedToLesson ุขุฎุฑ ุ ููู ูุง ูููููุง ุชูููุฑ ุงูุญูุงูุฉ ุถุฏ ุงููุชุญูููู.  ููุฒูุฏ ูู ุงููุถูุญ ุ ุฃูุชุฑุญ ูุชุงุจุฉ ุงุฎุชุจุงุฑ ุซุงูู ูุญุงูู ุชุณุฌูู ุนููููู ููู ุฏุฑุณ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">tests/CQRSTest.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testLoadingWriteModel</span></span></span></span>() { <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> = new LessonId( (string) \Rhumsaa\Uuid\Uuid::uuid1() ); <span class="hljs-variable"><span class="hljs-variable">$clientName_1</span></span> = <span class="hljs-string"><span class="hljs-string">"George"</span></span>; <span class="hljs-variable"><span class="hljs-variable">$clientName_2</span></span> = <span class="hljs-string"><span class="hljs-string">"Fred"</span></span>; <span class="hljs-variable"><span class="hljs-variable">$command</span></span> = new BookLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-variable"><span class="hljs-variable">$clientName_1</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch(<span class="hljs-variable"><span class="hljs-variable">$command</span></span>); <span class="hljs-variable"><span class="hljs-variable">$command</span></span> = new BookClientOntoLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-variable"><span class="hljs-variable">$clientName_2</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch(<span class="hljs-variable"><span class="hljs-variable">$command</span></span>); <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span> = Lesson::find( (string) <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertClientCollectionContains(<span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>-&gt;clients, <span class="hljs-variable"><span class="hljs-variable">$clientName_1</span></span>); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertClientCollectionContains(<span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>-&gt;clients, <span class="hljs-variable"><span class="hljs-variable">$clientName_2</span></span>); }</code> </pre> <br>  ุจุงููุณุจุฉ ูุทุฑุงุฒ ุงูุชุณุฌูู ุงูุฎุงุต ุจูุง ุ ูุญุชุงุฌ ุฅูู ุชุทุจูู ุทุฑููุฉ "ุชุญููู" ููุงู ุชูุทุจู ุนููู ุงูุฃุญุฏุงุซ ุจุงููุนู ูู ูุชุฌุฑ ุงูุฃุญุฏุงุซ.  ูููููุง ุชุญููู ุฐูู ูู ุฎูุงู ุชุดุบูู ูู ุญุฏุซ ูุดูุฑ ุฅูู UUID ููููุงู.  ุจุนุจุงุฑุงุช ุนุงูุฉ ุ ุชููู ุงูุนูููุฉ ููุง ููู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชููู ุฌููุน ุฑุณุงุฆู ุงูุฃุญุฏุงุซ ุฐุงุช ุงูุตูุฉ ูู ูุชุฌุฑ ุงูุฃุญุฏุงุซ. </li><li style=";text-align:right;direction:rtl">  ููู ุฑุณุงูุฉ ุ ูููู ุจุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุญุฏุซ ุงูููุงุจู. </li><li style=";text-align:right;direction:rtl">  ูููู ุจุฅูุดุงุก ูููุฐุฌ ุณุฌู ููุงู ุฌุฏูุฏ ูุฅุนุงุฏุฉ ุชุดุบูู ูู ุญุฏุซ. </li></ol><br>  ูู ุงูููุช ุงูุญุงูู ุ <code>BookClientOntoLesson</code> ุงุฎุชุจุงุฑุงุชูุง ุงุณุชุซูุงุกุงุช ุ ูุฐูู ุณูุจุฏุฃ ุจุฅูุดุงุก <code>BookClientOntoLesson</code> ุงูุถุฑูุฑู (ุชุณุฌูู ุนููู ููุฏุฑุณ) ุ ุจุงุณุชุฎุฏุงู ุฃูุฑ <code>BookLesson</code> ููุงูุจ.  ุณุชุจุฏู ุทุฑููุฉ ุงููุนุงูุฌ ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> app/School/Lesson/Commands/BookClientOntoLesson.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> handle(LessonRepository <span class="hljs-variable"><span class="hljs-variable">$repository</span></span>) { /** @var Lesson <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span> */ <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span> = <span class="hljs-variable"><span class="hljs-variable">$repository</span></span>-&gt;load(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;lessonId); <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>-&gt;bookClient(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;clientName); <span class="hljs-variable"><span class="hljs-variable">$repository</span></span>-&gt;save(<span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>); }      : app/School/Lesson/LessonRepository.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> load(LessonId <span class="hljs-variable"><span class="hljs-variable">$id</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$events</span></span> = <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;eventStoreRepository-&gt;load(<span class="hljs-variable"><span class="hljs-variable">$id</span></span>); <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span> = new Lesson(); <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>-&gt;initializeState(<span class="hljs-variable"><span class="hljs-variable">$events</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> <span class="hljs-variable"><span class="hljs-variable">$lesson</span></span>; }</code> </pre> <br>  ุชุฑุฌุน ุฏุงูุฉ ุชุญููู ุงููุณุชูุฏุน ูุฌููุนุฉ ูู ุงูุฃุญุฏุงุซ ุงูุชู ุชู ุฅุนุงุฏุฉ ุฅูุดุงุฆูุง.  ููููุงู ุจุฐูู ุ ุชุนุซุฑ ุฃููุงู ุนูู ุฑุณุงุฆู ุญูู ุงูุฃุญุฏุงุซ ูู ุงููุณุชูุฏุน ุ ุซู ุชููู ุจุชูุฑูุฑูุง ุฅูู <code>Serializer</code> ูุชุญููู ูู ุฑุณุงูุฉ ุฅูู ุญุฏุซ.  ููุดุฆ <code>Serializer</code> ุฑุณุงุฆู ูู ุงูุฃุญุฏุงุซ ุ ูุฐูู ูุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุทุฑููุฉ <code>deserialize()</code> ูุฅุฌุฑุงุก ุงูุชุญููู ุงูุนูุณู.  ุชุฐูุฑ ุฃูู ูุชู ุชูุฑูุฑ <code>Serializer</code> ุฅูู ูู ุญุฏุซ ูุฅุฌุฑุงุก ุชุณูุณู ูุจูุงูุงุช ุงูุญุฏุซ (ุนูู ุณุจูู ุงููุซุงู ุ ุงุณู ุงูุนููู).  ุณููุนู ููุณ ุงูุดูุก ูุฅุฌุฑุงุก ุงูุชุญููู ุงูุนูุณู ุ ุจูููุง ูุฌุจ ุชุญุฏูุซ ูุงุฌูุฉ <code>SerializableEvent</code> ุจุงุณุชุฎุฏุงู ุทุฑููุฉ <code>deserialize()</code> .  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงูููุฏ ุจุญูุซ ููุน ูู ุดูุก ูู ููุงูู.  ุงูุฃูู ูู <code>EventStoreRepository</code> ุชุญููู <code>EventStoreRepository</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">app/CQRS/EloquentEventStore/EloquentEventStoreRepository.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> load(<span class="hljs-variable"><span class="hljs-variable">$uuid</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$eventMessages</span></span> = EloquentEventStoreModel::<span class="hljs-built_in"><span class="hljs-built_in">where</span></span>(<span class="hljs-string"><span class="hljs-string">'uuid'</span></span>, <span class="hljs-variable"><span class="hljs-variable">$uuid</span></span>)-&gt;get(); <span class="hljs-variable"><span class="hljs-variable">$events</span></span> = []; foreach(<span class="hljs-variable"><span class="hljs-variable">$eventMessages</span></span> as <span class="hljs-variable"><span class="hljs-variable">$eventMessage</span></span>) { /*       event_payload,        . */ <span class="hljs-variable"><span class="hljs-variable">$events</span></span>[] = <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;eventSerializer-&gt;deserialize( json_decode(<span class="hljs-variable"><span class="hljs-variable">$eventMessage</span></span>-&gt;event_payload)); } <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> <span class="hljs-variable"><span class="hljs-variable">$events</span></span>; }</code> </pre><br>  ุจุงุณุชุฎุฏุงู ูุธููุฉ ุฅูุบุงุก ุงูุชุณูุณู ุงูููุงุณุจุฉ ูู <code>eventSerializer</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">app/CQRS/Serializer/EventSerializer.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> serialize( SerializableEvent <span class="hljs-variable"><span class="hljs-variable">$event</span></span> ) { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> array( <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; get_class(<span class="hljs-variable"><span class="hljs-variable">$event</span></span>), <span class="hljs-string"><span class="hljs-string">'payload'</span></span> =&gt; <span class="hljs-variable"><span class="hljs-variable">$event</span></span>-&gt;serialize() ); } public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> deserialize( <span class="hljs-variable"><span class="hljs-variable">$serializedEvent</span></span> ) { <span class="hljs-variable"><span class="hljs-variable">$eventClass</span></span> = <span class="hljs-variable"><span class="hljs-variable">$serializedEvent</span></span>-&gt;class; <span class="hljs-variable"><span class="hljs-variable">$eventPayload</span></span> = <span class="hljs-variable"><span class="hljs-variable">$serializedEvent</span></span>-&gt;payload; <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> <span class="hljs-variable"><span class="hljs-variable">$eventClass</span></span>::deserialize(<span class="hljs-variable"><span class="hljs-variable">$eventPayload</span></span>); }</code> </pre> <br>  ูู ุงูุฎุชุงู ุ ุณูู ูุณุชุฎุฏู ุฃุณููุจ ุงููุตูุน ุงูุซุงุจุช <code>deserialize()</code> ูู <code>LessonWasOpened</code> (ูุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุฐู ุงูุทุฑููุฉ ุฅูู ูู ุญุฏุซ) <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">app/School/Lesson/Events/LessonWasOpened.php public static <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> deserialize(<span class="hljs-variable"><span class="hljs-variable">$data</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> = new LessonId(<span class="hljs-variable"><span class="hljs-variable">$data</span></span>-&gt;lessonId); <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> new self(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>); }</code> </pre> <br>  ุงูุขู ูุฏููุง ูุฌููุนุฉ ูู ุฌููุน ุงูุฃุญุฏุงุซ ุงูุชู <code>app/CQRS/EventSouredEntity.php</code> ููุชู ูุณุจุฉู ุฅูู ูููุฐุฌ ุณุฌู ุงูููุงู ุงูุฎุงุต ุจูุง ูุชููุฆุฉ ุงูุญุงูุฉ ูู ุทุฑููุฉ <code>initializeState</code> ูู <code>app/CQRS/EventSouredEntity.php</code> <br><br>  ุงูุขู ุชุดุบูู ุงุฎุชุจุงุฑูุง.  ุงูุจูุบู! <br>  ูู ุงููุงูุน ุ ููุณ ูุฏููุง ูู ุงูููุช ุงูุญุงูู ุงุฎุชุจุงุฑ ููุชุญูู ูู ุงูุงูุชุซุงู ูููุงุนุฏ ุงููุทุงู ูุฏููุง ุ ูุฐูู ุฏุนููุง ููุชุจูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">tests/CQRSTest.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testMoreThan3ClientsCannotBeAddedToALesson</span></span></span></span>() { <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> = new LessonId( (string) \Rhumsaa\Uuid\Uuid::uuid1() ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch( new BookLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-string"><span class="hljs-string">"bob"</span></span>) ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch( new BookClientOntoLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-string"><span class="hljs-string">"george"</span></span>) ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch( new BookClientOntoLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-string"><span class="hljs-string">"fred"</span></span>) ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;setExpectedException( TooManyClientsAddedToLesson::class ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch( new BookClientOntoLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-string"><span class="hljs-string">"emma"</span></span>) ); }</code> </pre> <br>  ูุฑุฌู ููุงุญุธุฉ ุฃููุง ูุญุชุงุฌ ููุท ุฅูู <code>lessonId</code> - ูุฐุง ุงูุงุฎุชุจุงุฑ <code>lessonId</code> ุชููุฆุฉ ุญุงูุฉ ุงูุฏุฑุณ ุฎูุงู ูู ุฃูุฑ. <br><br>  ูู ุงูููุช ุงูุญุงูู ุ ูููู ุจุจุณุงุทุฉ ุจููู <code>UUID</code> ุชู ุฅูุดุงุคูุง ูุฏูููุง ุ ุจูููุง ูู ุงููุงูุน ูุฑูุฏ ุฅูุดุงุกูุง ุชููุงุฆููุง.  <code>Ramsy\UUID</code> ุญุฒูุฉ <code>Ramsy\UUID</code> ุ ูุฐูู ุฏุนููุง ุชุซุจูุชูุง ูุน <code>composer</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$&gt; composer require ramsey/uuid</code> </pre> <br>  ุงูุขู ูู ุจุชุญุฏูุซ ุงุฎุชุจุงุฑุงุชูุง ูุงุณุชุฎุฏุงู ุงูุญุฒูุฉ ุงูุฌุฏูุฏุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">tests/CQRSTest.php public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testEntityCreationWithUUIDGenerator</span></span></span></span>() { <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span> = new LessonId( (string) \Rhumsaa\Uuid\Uuid::uuid1() ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;dispatch( new BookLesson(<span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>, <span class="hljs-string"><span class="hljs-string">"bob"</span></span>) ); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;assertInstanceOf( Lesson::class, Lesson::find( (string) <span class="hljs-variable"><span class="hljs-variable">$lessonId</span></span>) ); }</code> </pre><br>  ุงูุขู ูููู ููุทูุฑ ุงููุดุฑูุน ุงูุฌุฏูุฏ ุงูุงุทูุงุน ุนูู ุงูููุฏ ุ ุฑุงุฌุน <code>App\School\ReadModels</code> ุ ูุงูุฐู ูุญุชูู ุนูู ูุฌููุนุฉ ูู ุงูููุงุฐุฌ <code>App\School\ReadModels</code> ุ ูุงุณุชุฎุฏุงู ูุฐู ุงูููุงุฐุฌ ููุชุงุจุฉ ุงูุชุบููุฑุงุช ุนูู ุฌุฏูู ุงูุฏุฑุณ.  ูููููุง ููุน ุฐูู ุนู ุทุฑูู ุฅูุดุงุก ูุฆุฉ <code>ImmutableModel</code> ุงูุชู ุชูุชุฏ ูุฆุฉ <code>app/CQRS/ReadModelImmutableModel.php</code> Model ูุชุชุฌุงูุฒ ุทุฑููุฉ ุงูุญูุธ ูู <code>app/CQRS/ReadModelImmutableModel.php</code> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar461899/">https://habr.com/ru/post/ar461899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar461885/index.html">EDS ูู ููุน ุขุฎุฑ ูู ุงูุงุญุชูุงู</a></li>
<li><a href="../ar461887/index.html">ุฏุฎูู Aeronet ุงูุญููุฉ 2: ุตุงุฑูุฎ ููุฌู ุจุฏูู ุทูุงุฑ</a></li>
<li><a href="../ar461891/index.html">ููู ุตูุนูุง ุตุฏุงูุงุช ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงููุตุฑููุฉ ุจุงุณุชุฎุฏุงู ManageIQ</a></li>
<li><a href="../ar461895/index.html">ุชุนูู ุฃุซูุงุก ุงูุณูุฑ - ููู ุณุงูุฑูุง ูู ููู ุชุญููู ุงูุฃุนูุงู ุงูุฃูุฑูุจู ุงูุฃูู</a></li>
<li><a href="../ar461897/index.html">ููู ูุญุงูุธ ุนูู ุงุณุชูุฑุงุฑ ุชุทุจูู Lamoda</a></li>
<li><a href="../ar461901/index.html">ุซูุงุซ ุณููุงุช ูู ุงูุงุฎุชุจุงุฑุงุช ุงูุฐุงุชูุฉ: ููููุฉ ุฒูุงุฏุฉ ุงูุณุฑุนุฉ ูููุณ ููุท</a></li>
<li><a href="../ar461903/index.html">ุฎุตู ุบุงูุถ: ุงูุงูุชุฑุงุถ ุงูุบุงูุถ</a></li>
<li><a href="../ar461905/index.html">ุชูู ุชุงู ุชู ุ ุงูุฌุฒุก 7: pytest ู Travis CI</a></li>
<li><a href="../ar461907/index.html">ุชุญูููุงุช ุงูููุชุฌ ูู ุงุณุชูุฏูู ุฏูุฑุฉ ูุงููุฉ</a></li>
<li><a href="../ar461913/index.html">ุณูููุฉ ุงุณุชุฎุฏุงู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ ูู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ: ุชุญููู ุฃูุถู 20 ูุชุฌุฑูุง ุฅููุชุฑููููุง ูู ุฑูุณูุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>