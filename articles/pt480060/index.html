<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèΩ üçû üéè Classificador P300 simples em dados abertos üñ§ üè¢ üßëüèæ‚Äçü§ù‚Äçüßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Meu colega Rafael Grigoryan eegdude escreveu recentemente um artigo sobre por que a humanidade precisava do EEG e que fen√¥menos significativos podem s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Classificador P300 simples em dados abertos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480060/"><p>  Meu colega Rafael Grigoryan <a href="https://habr.com/ru/users/eegdude/" class="user_link">eegdude</a> <a href="https://m.habr.com/ru/post/479164/">escreveu recentemente</a> um artigo sobre por que a humanidade precisava do EEG e que fen√¥menos significativos podem ser registrados nele.  Hoje, na continua√ß√£o do t√≥pico das interfaces neurais, usamos um dos conjuntos de dados abertos gravados em um jogo usando a mec√¢nica P300 para visualizar o sinal de EEG, ver a estrutura dos potenciais chamados, construir os principais classificadores, avaliar a qualidade com a qual podemos prever a presen√ßa desse potencial chamado. </p><br><p>  Deixe-me lembr√°-lo de que o P300 √© um potencial chamado (VP), uma resposta espec√≠fica do c√©rebro associada √† tomada de decis√£o e est√≠mulos distintos (que veremos abaixo).  Geralmente √© usado para construir BCI moderno. </p><br><p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png"></p><br><p>  Para fazer a classifica√ß√£o EEG, voc√™ pode ligar para amigos, escrever um jogo sobre Guaxinins e Dem√¥nios em VR, escrever suas pr√≥prias rea√ß√µes e escrever um artigo cient√≠fico (vou falar sobre isso outra vez), mas, felizmente, cientistas de todo o mundo conduzimos algumas experi√™ncias para n√≥s e resta apenas fazer o download dos dados. </p><br><p>  Uma an√°lise de como criar uma interface neural no P300 com c√≥digo e visualiza√ß√µes passo a passo, al√©m de um link para o reposit√≥rio, pode ser encontrada abaixo do gato. </p><a name="habracut"></a><br><p>  O artigo mostra apenas os pontos principais do c√≥digo, a vers√£o reproduz√≠vel completa no caderno jupyter <a href="https://gitlab.com/impulse-neiry_public/posts">para pesquisar aqui</a> </p><br><p>  Do ponto de vista de um EEG, o P300 √© apenas uma explos√£o em um determinado momento em determinados canais.  Existem v√°rias maneiras de cham√°-lo, por exemplo, se voc√™ se concentrar em um objeto, e ele √© ativado em um momento aleat√≥rio (muda de forma, cor, brilho ou salta para algum lugar).  Eis como foi implementado nos tempos antigos. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wKDimrzvwYA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Em termos gerais, o esquema √© o seguinte: existem v√°rios (geralmente de 3 a 7) est√≠mulos no campo de vis√£o de uma pessoa.  Uma pessoa escolhe uma delas e se concentra nela (uma boa maneira √© contar o n√∫mero de ativa√ß√µes), ent√£o cada objeto pisca em uma ordem aleat√≥ria.  Conhecendo o tempo de ativa√ß√£o de cada est√≠mulo, agora podemos observar o pr√≥ximo EEG e determinar se havia um pico caracter√≠stico (veremos nas visualiza√ß√µes abaixo).  Como a pessoa se concentrou em apenas um est√≠mulo, o pico deve ser um.  Assim, nessas interfaces neurais, uma das v√°rias op√ß√µes √© selecionada (cartas para escrever, a√ß√µes no jogo e Deus sabe o que mais).  Se houver mais de sete op√ß√µes, voc√™ poder√° coloc√°-las na grade e reduzir a tarefa para selecionar uma linha + coluna.  √â assim que o verificador cl√°ssico P300 de matriz, mostrado acima. </p><br><p>  No caso do conjunto de dados considerado hoje, a parte visual (assim como o nome) foi emprestada dos famosos <a href="https://en.wikipedia.org/wiki/Space_Invaders">invasores do espa√ßo de</a> jogo.  Parecia algo assim </p><br><p><img src="https://habrastorage.org/webt/xg/yb/du/xgybdulftmr0dpr4muypl7avlro.png" alt="Invasores do c√©rebro jogabilidade"></p><br><p>  De fato, este √© o mesmo jogo, apenas as letras s√£o substitu√≠das por alien√≠genas do jogo. <br>  O <a href="https://www.youtube.com/watch%3Fv%3Ds73l8ZfQcWw">v√≠deo do processo do jogo</a> e <a href="https://arxiv.org/ftp/arxiv/papers/1905/1905.05182.pdf">os relat√≥rios t√©cnicos</a> tamb√©m <a href="https://arxiv.org/ftp/arxiv/papers/1905/1905.05182.pdf">foram</a> preservados. </p><br><p>  De uma forma ou de outra, os dados coletados usando este jogo apareceram na Internet e podemos acess√°-los.  Os dados consistem em 16 canais de EEG e um canal de evento, mostrando em quais momentos os incentivos alvo (feitos pelo jogador) e n√£o alvo foram ativados, e trabalharemos com eles. </p><br><p> A maioria dos conjuntos de dados da BCI foram escritos por neurofisiologistas, e esses s√£o os que realmente n√£o se preocupam com a compatibilidade. Portanto, os formatos de dados s√£o muito diversos: desde vers√µes diferentes de arquivos <a href="https://en.wikipedia.org/wiki/European_Data_Format"><code>.edf</code></a> formatos "padr√£o" <a href="https://en.wikipedia.org/wiki/European_Data_Format"><code>.edf</code></a> e <a href="https://en.wikipedia.org/wiki/General_Data_Format_for_Biomedical_Signals"><code>.gdf</code></a> . <br>  A coisa mais importante que voc√™ precisa saber sobre esses formatos √© que n√£o deseja analis√°-los ou trabalhar diretamente com eles. <br>  Felizmente, um grupo de entusiastas do <a href="https://neurotechx.com/">NeuroTechX</a> escreveu downloads para alguns conjuntos de dados diretamente em numpy. <br>  Esses gerenciadores de inicializa√ß√£o fazem parte do projeto <a href="https://github.com/NeuroTechX/moabb/tree/master/moabb">moabb</a> que afirma ser uma solu√ß√£o universalizada para o BCI. </p><br><h2 id="zagruzka-syrogo-dataseta">  Baixar conjunto de dados brutos </h2><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> moabb.datasets sampling_rate = <span class="hljs-number"><span class="hljs-number">512</span></span> m_dataset = moabb.datasets.bi2013a( NonAdaptive=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Adaptive=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Training=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Online=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ) m_dataset.download() m_data = m_dataset.get_data()</code> </pre> <br><p>  Nesta fase, obtivemos uma estrutura <a href="https://mne.tools/stable/generated/mne.io.Raw.html">RawEDF</a> contendo registros EEG.  Essa √© uma estrutura do pacote <a href="https://mne.tools/stable/index.html"><code>mne</code></a> , os bi√≥logos costumam us√°-la para interagir com sinais: essa estrutura possui m√©todos <a href="https://mne.tools/stable/index.html"><code>mne</code></a> para filtrar, visualizar, armazenar etiquetas e voc√™ nunca sabe.  Mas n√£o vamos por aqui desde  a interface do pacote tende a ser inst√°vel (a vers√£o atual √© <code>0.19</code> , mas usaremos <code>0.17</code> pois o conjunto de dados n√£o √© mais lido pela nova vers√£o) e mal documentado; por isso, nossos resultados podem se tornar improdutivos. </p><br><p>  O que extra√≠mos da estrutura resultante s√£o os r√≥tulos dos canais no <a href="https://en.wikipedia.org/wiki/10%25E2%2580%259320_system_(EEG)">sistema 10-20</a> .  Este √© um arranjo internacional de eletrodos na cabe√ßa de uma pessoa, criado para que os cientistas possam correlacionar as zonas cerebrais e a localiza√ß√£o dos canais de EEG.  Abaixo est√° a disposi√ß√£o dos eletrodos no sistema 10-10 (difere de 10-20 por duas vezes a densidade de marca√ß√£o) e os canais que foram registrados neste conjunto de dados s√£o marcados em vermelho. <br><img src="https://habrastorage.org/webt/j0/x0/uq/j0x0uq27-vjl277bgamcuuz3qpy.jpeg" alt="sistema 10-10"></p><br><pre> <code class="python hljs">print(m_data[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-string"><span class="hljs-string">'session_1'</span></span>][<span class="hljs-string"><span class="hljs-string">'run_1'</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># &lt;RawEDF | 1.gdf, n_channels x n_times : 17 x 159232 (311.0 sec), ~20.7 MB, data loaded&gt; channels = m_data[1]['session_1']['run_1'].ch_names[:-1] channels # ['FP1', 'FP2', 'F5', 'AFz', 'F6', 'T7', 'Cz', 'T8', 'P7', 'P3', 'Pz', 'P4', 'P8', 'O1', 'Oz', 'O2']</span></span></code> </pre><br><p>  Primeiro, a partir dos dados baixados para cada sujeito, alocamos matrizes de EEG cont√≠nuo por 16 segundos e todos os r√≥tulos para esse intervalo (nos dados, esse √© apenas mais um canal no qual s√£o anotados os prim√≥rdios dos eventos de interesse). </p><br><p>  Nesse est√°gio, mantemos o comprimento m√°ximo do EEG cont√≠nuo para n√£o encontrar efeitos de borda durante a filtragem adicional. </p><br><pre> <code class="python hljs">raw_dataset = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, sessions <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(m_data.items()): eegs, markers = [], [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item, run <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(sessions[<span class="hljs-string"><span class="hljs-string">'session_1'</span></span>].items()): data = run.get_data() eegs.append(data[:<span class="hljs-number"><span class="hljs-number">-1</span></span>]) markers.append(data[<span class="hljs-number"><span class="hljs-number">-1</span></span>]) raw_dataset.append((eegs, markers))</code> </pre> <br><h2 id="filtraciya-i-razdelenie-na-epohi">  Filtragem e Separa√ß√£o </h2><br><p>  Em geral, para revisar os m√©todos de pr√©-processamento e classifica√ß√£o do EEG, posso recomendar <a href="https://iopscience.iop.org/article/10.1088/1741-2552/aab2f2/meta">uma excelente vis√£o geral</a> dos mestres das interfaces de neurocomputadores.  Tamb√©m n√£o faz muito tempo, foi lan√ßada uma <a href="https://iopscience.iop.org/article/10.1088/1741-2552/ab0ab5">revis√£o</a> mais <a href="https://iopscience.iop.org/article/10.1088/1741-2552/ab0ab5">recente dos</a> testes de redes neurais. </p><br><p>  O pr√©-processamento m√≠nimo do sinal EEG para classifica√ß√£o inclui 3 etapas: </p><br><ul><li>  dizima√ß√£o </li><li>  filtragem </li><li>  escala </li></ul><br><p>  Para implementar essas etapas, usaremos o bom e velho <code>sklearn</code> e seu paradigma para transformadores e tubula√ß√µes, para que nosso pr√©-processamento possa ser facilmente extens√≠vel. <br>  O c√≥digo dos transformadores √© colocado em um arquivo separado, abaixo descreveremos alguns detalhes. </p><br><p>  <strong>Dizima√ß√£o</strong> </p><br><p>  Por alguma raz√£o, em alguns artigos e exemplos de processamento, eu encontrei uma diminui√ß√£o na frequ√™ncia do sinal simplesmente jogando amostras no estilo <code>eeg = eeg[:, ::10]</code> .  Isso est√° completamente incorreto (por que - veja qualquer livro sobre processamento de sinais).  Usamos a <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.decimate.html"><code>  scipy</code></a> padr√£o <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.decimate.html"><code>  scipy</code></a> . </p><br><p>  <strong>Filtragem</strong> </p><br><p>  Aqui, tamb√©m contamos com filtros <code>scipy</code> , selecionando um filtro passa-banda Butterworth de 4 ordens e aplicando-o na dire√ß√£o direta e reversa ( <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html"><code>filtfilt</code></a> ) para manter a fase.  Frequ√™ncias de corte - de 0,5 a 20 Hz, esta √© a faixa padr√£o para nossa tarefa. </p><br><p>  <strong>Dimensionamento</strong> </p><br><p>  Usamos um <code>StandardScaler</code> por canal (subtrai a m√©dia, divide pelo desvio padr√£o), que v√™ todos os sinais da amostra.  De fato, um pequeno vazamento de dados √© introduzido neste momento.  formalmente, o scaler tamb√©m v√™ dados da amostra de teste, mas com volumes de dados suficientemente grandes, a m√©dia e o desvio s√£o os mesmos. <br>  A masturba√ß√£o √© realizada canal por canal, para que, dentro do mesmo conjunto de dados, seja poss√≠vel agregar dados de diferentes sensores com diferentes ordens de magnitude e natureza (por exemplo, <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25B0%25D0%25BA%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C_%25D0%25BA%25D0%25BE%25D0%25B6%25D0%25B8">rea√ß√£o pele-galv√¢nica (RAG)</a> ) </p><br><p>  Al√©m das opera√ß√µes acima, tamb√©m foi poss√≠vel distinguir artefatos no EEG (piscando, mastigando, movendo a cabe√ßa), mas esse conjunto de dados j√° est√° muito limpo, ent√£o vamos deix√°-lo at√© a pr√≥xima vez. </p><br><pre> <code class="python hljs">reload(transformers) decimation_factor = <span class="hljs-number"><span class="hljs-number">10</span></span> final_rate = sampling_rate // decimation_factor epoch_duration = <span class="hljs-number"><span class="hljs-number">0.9</span></span> <span class="hljs-comment"><span class="hljs-comment"># seconds epoch_count = int(epoch_duration * final_rate) eeg_pipe = make_pipeline( transformers.Decimator(decimation_factor), transformers.ButterFilter(sampling_rate // decimation_factor, 4, 0.5, 20), transformers.ChannellwiseScaler(StandardScaler()), ) markers_pipe = transformers.MarkersTransformer(labels_mapping, decimation_factor)</span></span></code> </pre> <br><p>  Em seguida, aplicaremos o pipeline de pr√©-processamento aos nossos dados e cortaremos o sinal EEG cont√≠nuo em √©pocas.  Vamos chamar a √©poca de per√≠odo imediatamente ap√≥s a ativa√ß√£o do est√≠mulo, com uma dura√ß√£o caracter√≠stica de 0,5-1 segundo, no nosso caso, a dura√ß√£o √© de 900 ms, embora possa ser encurtada. </p><br><p>  Em nosso conjunto de dados, existem 16 canais de EEG; ap√≥s a aplica√ß√£o da dizima√ß√£o, a frequ√™ncia cai para 50 Hz; portanto, uma √©poca ser√° descrita por uma matriz <code>(16, 45)</code> - 900 ms a 50 Hz s√£o 45 amostras de tempo. </p><br><p>  As tags neste conjunto de dados s√£o apenas bin√°rios - elas marcam os sinais de destino (ocultos pelo jogador, ativos, 1) e n√£o-alvo (vazios, 0). </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eegs, _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> raw_dataset: eeg_pipe.fit(eegs) dataset = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eegs, markers <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> raw_dataset: epochs = [] labels = [] filtered = eeg_pipe.transform(eegs) markups = markers_pipe.transform(markers) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> signal, markup <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(filtered, markups): epochs.extend([signal[:, start:(start + epoch_count)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> start <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> markup[:, <span class="hljs-number"><span class="hljs-number">0</span></span>]]) labels.extend(markup[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]) dataset.append((np.array(epochs), np.array(labels)))</code> </pre> <br><pre> <code class="python hljs">dataset[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>].shape, dataset[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>].shape <span class="hljs-comment"><span class="hljs-comment"># ((1308, 16, 45), (1308,))</span></span></code> </pre> <br><p>  Ent√£o, temos um conjunto de <code>Pytorch</code> no estilo Pytorch, no qual o primeiro √≠ndice conta pessoas diferentes.  Com essa estrutura, podemos realizar a valida√ß√£o cruzada nos dados de uma pessoa e testar a toler√¢ncia do classificador entre pessoas diferentes (o chamado aprendizado de transfer√™ncia, previs√£o sem calibra√ß√£o).  Os dados de uma pessoa consistem em uma variedade de eras e r√≥tulos de classe.  O n√∫mero de eras para cada pessoa varia um pouco devido √†s caracter√≠sticas da grava√ß√£o. </p><br><h2 id="issledovanie-i-vizualizaciya-dannyh">  Pesquisa e visualiza√ß√£o de dados </h2><br><p>  Primeiro, d√™ uma olhada em um dos sinais cont√≠nuos antes de cortar em √©pocas. </p><br><p>  Apesar de j√° ter sido filtrado, ele n√£o mostra nenhuma ativa√ß√£o no olho e parece mais algum tipo de ru√≠do. </p><br><p><img src="https://habrastorage.org/webt/mb/xy/js/mbxyjsh7g4ch3an8smi2wtpujpw.png" alt="Sinal de EEG filtrado de uma corrida do jogo"></p><br><p>  Se considerarmos apenas uma √©poca alvo do nosso conjunto de dados, veremos um aumento caracter√≠stico no intervalo de 400 a 600 ms.  Este √© o nosso P300 potencial procurado. </p><br><p><img src="https://habrastorage.org/webt/eu/v9/k-/euv9k-t6w0nss44m2fnvt_mrhxs.png" alt="√©poca p300"></p><br><p>  No total, em nosso conjunto de dados, existem cerca de 35 mil √©pocas, ou seja, ativa√ß√£o de est√≠mulos.  Cada pessoa tem cerca de 1300 a 1750 (isso se deve ao fato de algu√©m abater alien√≠genas mais r√°pido e mais lento). </p><br><p>  H√° tamb√©m um desequil√≠brio not√°vel nas classes: 1 a 5 a favor de est√≠mulos vazios.  temos 6 linhas e colunas na matriz e apenas uma delas √© o destino.  Mais tarde, voltaremos a isso ao discutir as m√©tricas obtidas. </p><br><p><img src="https://habrastorage.org/webt/ed/7n/jb/ed7njbim3sdcge3lpb-_ll8ucls.png" alt="saldo de classe"></p><br><p>  Agora √© hora de observar a diferen√ßa entre o sinal alvo e o n√£o alvo </p><br><p><img src="https://habrastorage.org/webt/c5/tx/oa/c5txoadzfwl8qzg8t-29siuftnw.png" alt="resposta m√©dia do conjunto de dados"></p><br><p>  No gr√°fico esquerdo, voc√™ pode ver que os sinais m√©dios variam muito, e ambos t√™m uma resposta inespec√≠fica na regi√£o de 180ms, mas o alvo √© muito mais amplitude, o alvo tamb√©m possui um hump caracter√≠stico de 250 a 500 ms - este √© o not√≥rio P300. </p><br><p>  Com essa diferen√ßa no sinal, nossa tarefa pode parecer um pouco, mas se adicionarmos o desvio padr√£o em cada ponto ao gr√°fico, veremos que a imagem n√£o √© t√£o otimista - o sinal √© bastante barulhento.  E isso apesar do fato de a rela√ß√£o sinal / ru√≠do do P300 ser considerada uma das mais altas da neurofisiologia. </p><br><p>  (Na verdade, esses gr√°ficos n√£o s√£o constru√≠dos com honestidade, porque o sinal vazio √© calculado em m√©dia cinco vezes mais do que amostras diferentes, portanto os desvios aleat√≥rios s√£o mais sufocados, mas como podemos ver pela dispers√£o da mesma ordem, isso n√£o ajuda muito) </p><br><p><img src="https://habrastorage.org/webt/7b/nw/hw/7bnwhwdx7xrbkvwgqiw9jc5um5g.png" alt="Resposta m√©dia da pessoa"></p><br><p>  Tamb√©m √© √∫til observar os sinais m√©dios de uma pessoa. </p><br><p>  Aqui √© encontrada a observa√ß√£o anterior sobre a m√©dia ‚Äúdesonesta‚Äù - o sinal vazio √© visivelmente mais amplitude do que a m√©dia geral.  Al√©m disso, o pico do P300 em uma pessoa √© mais alto devido √† menor m√©dia. </p><br><p>  √â importante observar outra caracter√≠stica do sinal de uma pessoa - ela tem uma forma ligeiramente diferente da generalizada.  A variabilidade interpessoal das rea√ß√µes neurofisiol√≥gicas √© bastante alta, ainda veremos a influ√™ncia desse fator no trabalho dos classificadores.  No entanto, as diferen√ßas intrapessoais (uma pessoa com humor diferente, n√≠vel de estresse, fadiga) tamb√©m s√£o bastante grandes. </p><br><p><img src="https://habrastorage.org/webt/jt/kj/sj/jtkjsjbgmym86-unjyshdxgtd80.png" alt="png"></p><br><p>  A seguir, vemos a varredura canal a canal dos sinais.  O ponto de vista aqui coincide com a figura acima, que mostra a posi√ß√£o dos eletrodos - nariz acima, etc. </p><br><p>  A resposta de cada parte da cabe√ßa √© diferente.  Em Fp1,2, dois picos negativos anteriores ao pico positivo s√£o pronunciados.  Al√©m disso, em alguns canais h√° dois picos positivos e em alguns - um ou algo de transi√ß√£o entre eles. </p><br><p>  Canais diferentes s√£o de import√¢ncia diferente para determinar a presen√ßa do P300, ele pode ser estimado usando m√©todos diferentes - c√°lculo de informa√ß√µes m√∫tuas (informa√ß√µes m√∫tuas) ou m√©todo de adi√ß√£o e exclus√£o (tamb√©m conhecido como regress√£o por etapas).  A aplica√ß√£o desses m√©todos, vamos lidar com outro momento. </p><br><p>  Vale lembrar que medimos a diferen√ßa de potencial entre os eletrodos com eletrodos, o que significa que podemos construir mapas de tens√£o para toda a cabe√ßa em determinados momentos, usando mudan√ßas de tens√£o em pontos individuais.  √â claro que, se houver 16 eletrodos, a precis√£o de tal cart√£o deixa muito a desejar, mas √© necess√°rio algum entendimento.  (por padr√£o, <code>mne</code> espera ver microvolts, mas j√° aplicamos a escala, portanto os valores absolutos n√£o est√£o corretos) </p><br><p><img src="https://habrastorage.org/webt/zq/2y/kz/zq2ykzbpc6oxqz2woyizwuswod4.png" alt="png"></p><br><p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png" alt="png"></p><br><h2 id="klassifikaciya">  Classifica√ß√£o </h2><br><p>  Finalmente, √© hora de aplicar m√©todos de aprendizado de m√°quina √† nossa amostra. </p><br><p>  V√°rios b√°sicos foram escolhidos como classificadores - um log.  regress√£o, o m√©todo do vetor de suporte (SVM) e v√°rios m√©todos usando a an√°lise de correla√ß√£o do pacote <a href="https://github.com/alexandrebarachant/pyRiemann"><code>pyriemann</code></a> (detalhes de cada m√©todo podem ser encontrados na documenta√ß√£o), √© importante notar que esses m√©todos foram desenvolvidos especialmente para a aplica√ß√£o ao EEG e, com a ajuda deles, <a href="https://www.kaggle.com/c/inria-bci-challenge/discussion/12819">v√°rias</a> <a href="https://www.kaggle.com/c/grasp-and-lift-eeg-detection/discussion/16479">competi√ß√µes</a> foram vencidas. kaggle. </p><br><pre> <code class="python hljs">clfs = { <span class="hljs-string"><span class="hljs-string">'LR'</span></span>: ( make_pipeline(Vectorizer(), LogisticRegression()), {<span class="hljs-string"><span class="hljs-string">'logisticregression__C'</span></span>: np.exp(np.linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>))}, ), <span class="hljs-string"><span class="hljs-string">'LDA'</span></span>: ( make_pipeline(Vectorizer(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {}, ), <span class="hljs-string"><span class="hljs-string">'SVM'</span></span>: ( make_pipeline(Vectorizer(), SVC()), {<span class="hljs-string"><span class="hljs-string">'svc__C'</span></span>: np.exp(np.linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>))}, ), <span class="hljs-string"><span class="hljs-string">'CSP LDA'</span></span>: ( make_pipeline(CSP(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {<span class="hljs-string"><span class="hljs-string">'csp__n_components'</span></span>: (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>), <span class="hljs-string"><span class="hljs-string">'csp__cov_est'</span></span>: (<span class="hljs-string"><span class="hljs-string">'concat'</span></span>, <span class="hljs-string"><span class="hljs-string">'epoch'</span></span>)}, ), <span class="hljs-string"><span class="hljs-string">'Xdawn LDA'</span></span>: ( make_pipeline(Xdawn(<span class="hljs-number"><span class="hljs-number">2</span></span>, classes=[<span class="hljs-number"><span class="hljs-number">1</span></span>]), Vectorizer(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {}, ), <span class="hljs-string"><span class="hljs-string">'ERPCov TS LR'</span></span>: ( make_pipeline(ERPCovariances(estimator=<span class="hljs-string"><span class="hljs-string">'oas'</span></span>), TangentSpace(), LogisticRegression()), {<span class="hljs-string"><span class="hljs-string">'erpcovariances__estimator'</span></span>: (<span class="hljs-string"><span class="hljs-string">'lwf'</span></span>, <span class="hljs-string"><span class="hljs-string">'oas'</span></span>)}, ), <span class="hljs-string"><span class="hljs-string">'ERPCov MDM'</span></span>: ( make_pipeline(ERPCovariances(), MDM()), {<span class="hljs-string"><span class="hljs-string">'erpcovariances__estimator'</span></span>: (<span class="hljs-string"><span class="hljs-string">'lwf'</span></span>, <span class="hljs-string"><span class="hljs-string">'oas'</span></span>)}, ), }</code> </pre> <br><p><img src="https://habrastorage.org/webt/3x/yb/qc/3xybqcusgidyxfs5lfcilxqn-gs.png" alt="registro de crossvalidate"></p><br><p>  O esquema mais comum de interfaces neurais √© "calibra√ß√£o + trabalho", ou seja,  Primeiro, √© necess√°rio que uma pessoa se concentre nos est√≠mulos indicados anteriormente por algum tempo, e somente depois disso predizemos sua escolha.  Essa abordagem tem a √≥bvia desvantagem de um est√°gio inicial chato. </p><br><p>  Para avaliar o desempenho de nossos m√©todos nesse modo, realizaremos a valida√ß√£o cruzada nas √©pocas de uma pessoa. <br>  A m√©trica de precis√£o, neste caso, n√£o √© relevante devido ao desequil√≠brio do conjunto de dados (a linha de base √© de 5/6 a 83% aqui), ent√£o prefiro examinar os tr√™s tr√™s. </p><br><p>  Para revisar todo o conjunto de dados, calculamos a m√©dia dos resultados dessa valida√ß√£o cruzada em todas as pessoas.  Em geral, o desempenho dos melhores modelos √© bastante alto comparado ao que temos em <a href="https://impulse-neiry.com/">Neiry</a> nas condi√ß√µes "de campo" de um parque de divers√µes (lembro-me de que esse conjunto de dados foi registrado em laborat√≥rio). </p><br><p>  Nesse conjunto de dados, existem apenas r√≥tulos bin√°rios para os dados.  Em geral, precisamos resolver o problema multiclasse de escolher um dos est√≠mulos (a prop√≥sito, ele √© equilibrado, pois cada est√≠mulo √© ativado no mesmo n√∫mero de vezes).  Para resolv√™-lo, o n√∫mero de ativa√ß√µes de cada est√≠mulo geralmente √© fixo (por exemplo, 6 est√≠mulos de 5 ativa√ß√µes cada) e todos os est√≠mulos s√£o ativados aleatoriamente (30 vezes), s√£o obtidas 30 √©pocas e adicionadas as probabilidades de suas ativa√ß√µes, ap√≥s as quais o est√≠mulo que atingiu o m√°ximo o valor √© reconhecido como alvo.  Demonstraremos a implementa√ß√£o dessa abordagem em uma publica√ß√£o futura em um conjunto de dados adequado. </p><br><p><img src="https://habrastorage.org/webt/zx/-o/lm/zx-olmert9y5wdjpebgqa1dy8zm.png" alt="crossvalidate_dataset"></p><br><p>  O segundo esquema √© chamado aprendizado de transfer√™ncia - ou seja, a transfer√™ncia do classificador entre as pessoas.  O fato √© que, quando fazemos a calibra√ß√£o, na verdade, retreinamos a forma de pico de uma pessoa, para podermos prever bem em testes subsequentes.  Na aus√™ncia de calibra√ß√£o, um classificador pr√©-treinado deve poder isolar o conceito P300 sem conhecer antecipadamente a forma de onda de uma pessoa em particular. </p><br><p>  Conduziremos dois experimentos - treinaremos o classificador em uma pessoa e preveremos cinco; em seguida, aumentaremos a amostra de treinamento para 10 pessoas e compararemos os resultados para garantir que os modelos possam aumentar sua capacidade de generaliza√ß√£o. </p><br><p>  Treinamento para 1 pessoa <br><img src="https://habrastorage.org/webt/fk/n5/5w/fkn55wh6yl7hfpjtjrqesq8gm8e.png" alt="transfer_validate_1"></p><br><p>  Treinamento para 10 pessoas <br><img src="https://habrastorage.org/webt/in/ol/kq/inolkqy3-fezzcavmstah4vwhic.png" alt="transfer_valiidate_10"></p><br><p>  Portanto, f1 passou de 0,23 para 0,4 para um classificador melhor (nos dois casos, √© uma regress√£o logar√≠tmica com a mesma regulariza√ß√£o). </p><br><p>  Isso significa que a capacidade preditiva aumentou de "n√£o" para "aceit√°vel".  Com base em nossa experi√™ncia, com essas m√©tricas de tarefas bin√°rias, 5 ativa√ß√µes de cada est√≠mulo s√£o suficientes para atingir a precis√£o de um problema de v√°rias classes de cerca de 75%. </p><br><p>  No final, quero observar que o m√©todo acima √© bastante primitivo, o que pode ser visto, por exemplo, pelo alto grau de regulariza√ß√£o da regress√£o logar√≠tmica - os canais nos dados est√£o fortemente correlacionados e existem v√°rias abordagens para resolver essa circunst√¢ncia. </p><br><h2 id="zaklyuchenie">  Conclus√£o </h2><br><p>  Hoje, nos familiarizamos com o potencial evocado do P300 e constru√≠mos um pipeline simples para a interface neural.  Eu recomendo aos interessados ‚Äã‚Äãabrir um laptop por conta pr√≥pria (localizado no <a href="https://gitlab.com/impulse-neiry_public/posts">reposit√≥rio</a> ) e experimentar op√ß√µes de visualiza√ß√£o e classificadores. </p><br><p>  Tendo uma compreens√£o b√°sica dos m√©todos de trabalho com o sinal EEG, poderemos examinar esse t√≥pico mais profundamente - aplicar m√©todos avan√ßados de pr√©-processamento, bem como redes neurais, para resolver os problemas de constru√ß√£o de interfaces neurais.  Para continuar ... </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt480060/">https://habr.com/ru/post/pt480060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt480048/index.html">Desmistificando o novo Servi√ßo do Trabalhador do .NET Core 3</a></li>
<li><a href="../pt480050/index.html">Estudos de campo do conceito de "Documenta√ß√£o como c√≥digo"</a></li>
<li><a href="../pt480052/index.html">SEO vs. PPC - O que √© melhor para o seu neg√≥cio?</a></li>
<li><a href="../pt480056/index.html">Ativa√ß√£o de c√¢mera oculta pelos navegadores: Big Brother ou erro de c√°lculo da tecnologia?</a></li>
<li><a href="../pt480058/index.html">Estrela do transformador na √°rvore de Natal</a></li>
<li><a href="../pt480062/index.html">10 sistemas de controle. Onde √© mais conveniente se comunicar em tarefas e compartilhar arquivos?</a></li>
<li><a href="../pt480064/index.html">Aprendendo palavras agrupadas tematicamente</a></li>
<li><a href="../pt480068/index.html">[Update] Nosso povo √© espancado, e n√≥s ficaremos em sil√™ncio?</a></li>
<li><a href="../pt480070/index.html">Reativar benef√≠cios: uma b√™n√ß√£o para as empresas?</a></li>
<li><a href="../pt480072/index.html">Kubernetes: por que √© t√£o importante configurar o gerenciamento de recursos do sistema?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>