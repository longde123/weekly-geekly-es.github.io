<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧓 🗜️ 👩 Kauri Hanipot Angriffsanalyse 🏈 👨🏻‍🌾 🏑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Statistiken für 24 Stunden nach der Installation des Hanipots am Standort Digital Ocean in Singapur 

 Poo poo! Beginnen wir gleich mit einer Angriffs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kauri Hanipot Angriffsanalyse</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436076/">  <b>Statistiken für 24 Stunden nach der Installation des Hanipots am Standort Digital Ocean in Singapur</b> <br><br><h1>  Poo poo!  Beginnen wir gleich mit einer Angriffskarte. </h1><br>  Unsere Superklasse-Karte zeigt einzigartige Lieferavise, die innerhalb von 24 Stunden mit unserem Cowrie-Hanipot verbunden sind.  <font color="orange">Gelb</font> entspricht SSH-Verbindungen und <font color="red">Rot</font> entspricht Telnet.  Solche Animationen beeindrucken häufig den Verwaltungsrat des Unternehmens, wodurch Sie mehr Geld für Sicherheit und Ressourcen erhalten.  Trotzdem hat die Karte einen gewissen Wert und zeigt deutlich die geografische und organisatorische Verteilung der Angriffsquellen auf unseren Host in nur 24 Stunden.  Die Animation spiegelt nicht den Datenverkehr von jeder Quelle wider. <br><a name="habracut"></a><br><h3>  Was ist eine Pew Pew Card? </h3><br>  <i>Pew Map Pew</i> ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Visualisierung von Cyberangriffen</a> , normalerweise animiert und sehr schön.  Dies ist eine modische Art, Ihr Produkt zu verkaufen, das für seine Verwendung durch Norse Corp. bekannt ist.  Das Unternehmen endete schlecht: Es stellte sich heraus, dass schöne Animationen ihr einziger Vorteil waren, und sie verwendeten fragmentarische Daten für die Analyse. <br><br><h3>  Gemacht mit Leafletjs </h3><br>  Für diejenigen, die eine Angriffskarte für den großen Bildschirm im Operations Center entwickeln möchten (Ihr Chef wird es mögen), gibt es eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Broschürenbibliothek</a> .  Kombinieren Sie es mit dem Plugin für die Broschürenmigrationsschicht, dem Maxmind GeoIP-Dienst, und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fertig</a> . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ep/4i/nf/ep4infkfydwq1bq0w9qllkshgys.png"></a> <br><br><h1>  WTF: Was ist der Cowrie Hanipot? </h1><br>  Khanipot ist ein System, das speziell im Netzwerk platziert wird, um Angreifer anzulocken.  Verbindungen zum System sind normalerweise illegal und ermöglichen es Ihnen, einen Angreifer anhand detaillierter Protokolle zu erkennen.  In den Protokollen werden nicht nur die üblichen Verbindungsinformationen gespeichert, sondern auch Sitzungsinformationen, die die <b>Techniken, Taktiken und Verfahren</b> des Angreifers <b>(TTP)</b> offenlegen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der Cowrie Hanipot</a> dient zur <b>Aufzeichnung von SSH- und Telnet-Verbindungen</b> .  Solche Hanipots werden häufig im Internet angezeigt, um die Tools, Skripte und Hosts der Angreifer zu verfolgen. <br><br><blockquote>  Meine Botschaft an Unternehmen, die glauben, nicht angegriffen zu werden, lautet: „Sie sehen schlecht aus.“ <br>  <i>- James Snook</i> </blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/b6d/51f/054/b6d51f054d5d6e844819d6a4ae52ec4a.jpg"><br><br><h1>  Was ist in den Protokollen? </h1><br><h3>  Gesamtzahl der Verbindungen </h3><br>  Viele Hosts haben wiederholte Verbindungsversuche erhalten.  Dies ist normal, da die Liste der Anmeldeinformationen in den angreifenden Skripten blockiert ist und mehrere Kombinationen versucht werden.  Der Cowrie Hanipot ist so konfiguriert, dass er bestimmte Kombinationen aus Benutzername und Passwort akzeptiert.  Dies wird in der <b>Datei user.db</b> konfiguriert. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/baa/53b/95a/baa53b95a17508d61d6fc90f138ded6c.png"><br><br><h3>  Geographie der Angriffe </h3><br>  Gemäß den Geolokalisierungsdaten von Maxmind habe ich die Anzahl der Verbindungen aus jedem Land berechnet.  Brasilien und China führen mit großem Abstand, aus diesen Ländern gibt es oft viel Lärm von Scannern. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e5/00d/15b/8e500d15bb9b18fa0e0d09ea4920693c.png"><br><br><h3>  Netzwerkblockbesitzer </h3><br>  Eine Studie über Eigentümer von Netzwerkeinheiten (Network Unit Owners, ASNs) kann Organisationen mit einer großen Anzahl angreifender Hosts identifizieren.  Natürlich und in solchen Fällen sollten Sie immer daran denken, dass viele Angriffe von infizierten Hosts ausgehen.  Es ist anzunehmen, dass die meisten Eindringlinge nicht so dumm sind, das Web von einem Heimcomputer aus zu scannen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed2/f4d/a08/ed2f4da086d9540231d850cff7a8a40b.png"><br><br><h3>  Offene Ports auf angreifenden Systemen (Shodan.io-Daten) </h3><br>  Durch Ausführen der IP-Liste über die hervorragende <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Shodan-API</a> werden <b>offene Portsysteme</b> und welche Art von Ports schnell identifiziert.  Die folgende Abbildung zeigt die Konzentration offener Häfen nach Land und Organisation.  Es wäre möglich, Blöcke kompromittierter Systeme zu identifizieren, aber in der <b>kleinen Stichprobe</b> ist nichts Außergewöhnliches zu sehen, außer der großen Anzahl <b>von 500 offenen Häfen in China</b> . <br><br>  Ein interessanter Fund ist laut Censys und Shodan die große Anzahl von Systemen in Brasilien, bei <b>denen 22, 23</b> oder <b>andere Häfen nicht</b> <b>geöffnet</b> sind.  Anscheinend sind dies Verbindungen von Endbenutzercomputern. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0cb/72c/b3a/0cb72cb3a213c3808906fd2becd3179b.png"><br><br><h3>  Bots?  Nicht unbedingt </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Censys-</a> Daten für die Ports 22 und 23 für diesen Tag waren seltsam.  Ich nahm an, dass die meisten Scans und Passwortangriffe von Bots stammen.  Das Skript wird über offene Ports verteilt, nimmt Kennwörter auf, kopiert sich selbst vom neuen System und wird weiterhin mit derselben Methode verteilt. <br><br>  Hier sehen Sie jedoch, dass nur eine kleine Anzahl von Hosts, die Telnet scannen, Port 23 geöffnet hat. Dies bedeutet, dass die Systeme entweder auf andere Weise kompromittiert werden oder Angreifer Skripts manuell ausführen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e01/cca/89b/e01cca89b6f93be94d69ced873ebc3c4.png"><br><br><h3>  Heimanschlüsse </h3><br>  Ein weiterer interessanter Fund war die große Anzahl von Heimanwendern in der Stichprobe.  Bei der <b>umgekehrten Suche habe</b> ich 105 Verbindungen von bestimmten Heimcomputern identifiziert.  Bei vielen Heimverbindungen wird beim Rückblick auf DNS der Hostname mit den Worten dsl, home, Kabel, Glasfaser usw. angezeigt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64f/ddc/ed6/64fddced6a4b65050eeacf128da6821a.png"><br><br><h1>  Lernen und erforschen: Erhöhen Sie Ihren eigenen Hanipot </h1><br>  Kürzlich habe ich ein kurzes Handbuch zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installation von Cowrie auf Ihrem System geschrieben</a> .  Wie bereits erwähnt, wurde in unserem Fall Digital Ocean VPS in Singapur verwendet.  Für eine Analyse von 24 Stunden betrugen die Kosten buchstäblich einige Cent, und die Zeit für den Aufbau des Systems betrug 30 Minuten. <br><br>  Anstatt Cowrie im Internet zu betreiben und den Lärm zu fangen, können Sie vom Hanipot im lokalen Netzwerk profitieren.  Senden Sie eine Benachrichtigung, wenn Anforderungen an bestimmte Ports gesendet werden.  Dies ist entweder ein Eindringling im Netzwerk oder ein neugieriger Mitarbeiter oder ein Schwachstellenscan. <br><br><h1>  Schlussfolgerungen </h1><br>  Nach dem Betrachten der Aktionen der Angreifer pro Tag wird klar, dass es unmöglich ist, eine offensichtliche Angriffsquelle in einer Organisation, einem Land oder sogar dem Betriebssystem herauszufinden. <br><br>  Weit verbreitete Quellen zeigen, dass das Scan-Rauschen konstant ist und keiner bestimmten Quelle zugeordnet ist.  Jeder, der im Internet arbeitet, sollte sicherstellen, dass sein System über <b>mehrere Sicherheitsstufen verfügt</b> .  Eine übliche und effektive Lösung für <b>SSH</b> besteht darin, den Dienst auf einen zufälligen hohen Port zu verschieben.  Dies beseitigt nicht die Notwendigkeit eines strengen Kennwortschutzes und einer strengen Überwachung, stellt jedoch zumindest sicher, dass die Protokolle nicht durch ständiges Scannen verstopft werden.  High-Port-Verbindungen zielen eher auf Angriffe ab, die Sie interessieren könnten. <br><br>  Offene Telnet-Ports befinden sich häufig auf Routern oder anderen Geräten, sodass sie nicht einfach auf einen High-Port verschoben werden können.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen zu allen offenen Ports</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zur Angriffsfläche sind</a> die einzige Möglichkeit, um sicherzustellen, dass diese Dienste durch eine Firewall geschützt oder deaktiviert sind.  Wenn möglich, sollten Sie Telnet überhaupt nicht verwenden, dieses Protokoll ist nicht verschlüsselt.  Wenn Sie es ohne benötigen, überwachen Sie es sorgfältig und verwenden Sie sichere Passwörter. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de436076/">https://habr.com/ru/post/de436076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de436064/index.html">Künstliche Intelligenz für alle</a></li>
<li><a href="../de436066/index.html">Mathematik der Apokalypse: Spieltheorie und die karibische Atomkrise</a></li>
<li><a href="../de436068/index.html">C ++ Russland Konferenz 2019</a></li>
<li><a href="../de436070/index.html">Wie man mit flockigen Tests in der OpenSource-Community umgeht</a></li>
<li><a href="../de436072/index.html">Reinigen, markieren: Wie wir Chatbot beigebracht haben, um Kundenprobleme zu unterscheiden</a></li>
<li><a href="../de436080/index.html">Sicherheitswoche 03: 2019 - Jahr der Privatsphäre</a></li>
<li><a href="../de436082/index.html">Wie UEBA zur Verbesserung der Cybersicherheit beiträgt</a></li>
<li><a href="../de436086/index.html">Übersicht über Update 4 für Veeam Cloud Connect</a></li>
<li><a href="../de436088/index.html">Der grafische Editor von GANpaint zeichnet Objekte und demonstriert GAN-Funktionen</a></li>
<li><a href="../de436090/index.html">Oracle existiert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>