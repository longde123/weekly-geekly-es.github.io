<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â›½ï¸ ğŸŒº ğŸˆ RxVMSåŸºç¡€ï¼šRxCommandå’ŒGetIt ğŸ¥• ğŸ›ï¸ ğŸ“¦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿™æ˜¯æˆ‘çš„Flutterä½“ç³»ç»“æ„ç³»åˆ—çš„ç¬¬å››éƒ¨åˆ†ï¼š 


- å¼•è¨€ 
- Dart StreamsåŸºç¡€çŸ¥è¯† 
- RxDartï¼šæµç¨‹çš„ç¥å¥‡è½¬å˜ 
- RxVMSåŸºç¡€ï¼šRxCommandå’ŒGetItï¼ˆæœ¬æ–‡ï¼‰ 
- RxVMSï¼šæœåŠ¡å’Œç®¡ç†å™¨ 
- RxVMSï¼šç‹¬ç«‹çš„å°éƒ¨ä»¶ 
- ä½¿ç”¨RxVMSè¿›è¡Œç”¨æˆ·èº«ä»½éªŒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RxVMSåŸºç¡€ï¼šRxCommandå’ŒGetIt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449872/"><p> è¿™æ˜¯æˆ‘çš„Flutterä½“ç³»ç»“æ„ç³»åˆ—çš„ç¬¬å››éƒ¨åˆ†ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼•è¨€</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dart StreamsåŸºç¡€çŸ¥è¯†</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxDartï¼šæµç¨‹çš„ç¥å¥‡è½¬å˜</a> </li><li>  <strong>RxVMSåŸºç¡€ï¼šRxCommandå’ŒGetItï¼ˆæœ¬æ–‡ï¼‰</strong> </li><li>  RxVMSï¼šæœåŠ¡å’Œç®¡ç†å™¨ </li><li>  RxVMSï¼šç‹¬ç«‹çš„å°éƒ¨ä»¶ </li><li> ä½¿ç”¨RxVMSè¿›è¡Œç”¨æˆ·èº«ä»½éªŒè¯ </li></ul><br><p> å°½ç®¡å‰ä¸¤éƒ¨åˆ†æ˜¾ç„¶ä¸RxVMSæ¨¡å¼æ— å…³ï¼Œä½†æ˜¯å¯¹äºæ¸…æ¥šåœ°äº†è§£æ­¤æ–¹æ³•è€Œè¨€ï¼Œå®ƒä»¬æ˜¯å¿…éœ€çš„ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬è½¬åˆ°åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨RxVMSæ‰€éœ€çš„æœ€é‡è¦çš„ç¨‹åºåŒ…ã€‚ </p><a name="habracut"></a><br><h2 id="getit-bystryy-servicelocator">  GetItï¼šå¿«é€ŸServiceLocator </h2><br><p> å½“æ‚¨å›é¡¾æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­å„ç§RxVMSå…ƒç´ çš„å›¾è¡¨æ—¶... </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9cf/f8a/7c1/9cff8a7c191e44a7f4f269c3b0ee97cd.png" alt="å›¾ç‰‡"></p><br><p> ...ä¹Ÿè®¸æ‚¨æƒ³çŸ¥é“å„ç§æ˜ å°„ï¼Œç®¡ç†å™¨å’ŒæœåŠ¡å¦‚ä½•ç›¸äº’äº†è§£ã€‚ æ›´é‡è¦çš„æ˜¯ï¼Œæ‚¨å¯èƒ½æƒ³çŸ¥é“ä¸€ä¸ªå…ƒç´ å¦‚ä½•è®¿é—®å¦ä¸€ä¸ªå…ƒç´ çš„åŠŸèƒ½ã€‚ </p><br><p> é€šè¿‡è®¸å¤šä¸åŒçš„æ–¹æ³•ï¼ˆä¾‹å¦‚ç»§æ‰¿çš„å°éƒ¨ä»¶ï¼ŒIoCå®¹å™¨ï¼ŒDI ...ï¼‰ï¼Œæˆ‘ä¸ªäººæ›´å–œæ¬¢æœåŠ¡å®šä½å™¨ã€‚ åœ¨è¿™æ–¹é¢ï¼Œæˆ‘æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç¯‡</a>å…³äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GetIt</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç‰¹åˆ«æ–‡ç« </a> -è¿™ç§æ–¹æ³•çš„å®ç°ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘å°†ç•¥å¾®è°ˆè°ˆè¯¥ä¸»é¢˜ã€‚ é€šå¸¸ï¼Œæ‚¨åªéœ€åœ¨è¯¥æœåŠ¡ä¸­æ³¨å†Œå¯¹è±¡ä¸€æ¬¡ï¼Œç„¶åå°±å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­è®¿é—®å®ƒä»¬ã€‚ æœ‰ç‚¹å•èº«â€¦â€¦ä½†å…·æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚ </p><br><h2 id="ispolzovanie"> ä½¿ç”¨æ–¹æ³• </h2><br><p> ä½¿ç”¨GetItå¾ˆæ˜æ˜¾ã€‚ åœ¨åº”ç”¨ç¨‹åºçš„æœ€å¼€å§‹ï¼Œæ‚¨æ³¨å†Œäº†æ‚¨è®¡åˆ’éšåä½¿ç”¨çš„æœåŠ¡å’Œ/æˆ–ç®¡ç†å™¨ã€‚ å°†æ¥ï¼Œåªéœ€è°ƒç”¨GetItæ–¹æ³•å³å¯è®¿é—®å·²æ³¨å†Œç±»çš„å®ä¾‹ã€‚ </p><br><p> ä¸€ä¸ªä¸é”™çš„åŠŸèƒ½æ˜¯ï¼Œæ‚¨å¯ä»¥åƒå…·ä½“å®ç°ä¸€æ ·æ³¨å†Œæ¥å£æˆ–æŠ½è±¡ç±»ã€‚ è®¿é—®å®ä¾‹æ—¶ï¼Œåªéœ€ä½¿ç”¨æ¥å£/æŠ½è±¡ï¼Œå³å¯åœ¨æ³¨å†ŒæœŸé—´è½»æ¾æ›¿æ¢å¿…è¦çš„å®ç°ã€‚ è¿™ä½¿æ‚¨å¯ä»¥è½»æ¾åœ°å°†å®é™…æœåŠ¡åˆ‡æ¢åˆ°MockServiceã€‚ </p><br><h2 id="nemnogo-praktiki"> ä¸€ç‚¹ç»ƒä¹  </h2><br><p> æˆ‘é€šå¸¸é€šè¿‡å…¨å±€å˜é‡åœ¨åä¸ºservice_locator.dartçš„æ–‡ä»¶ä¸­åˆå§‹åŒ–SeviceLocatorã€‚ è¿™æ ·å°±ä¸ºæ•´ä¸ªé¡¹ç›®è·å¾—äº†ä¸€ä¸ªå…¨å±€å˜é‡ã€‚ </p><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    GetIt sl = new GetIt(); void setUpServiceLocator(ErrorReporter reporter) { //  // [registerSingleton]  -  . //   . // sl.get&lt;ErrorReporter&gt;.get()    . sl.registerSingleton&lt;ErrorReporter&gt;(reporter); // [registerLazySingleton]   ,       // sl.get&lt;ImageService&gt;.get()            . sl.registerLazySingleton&lt;ImageService&gt;(() =&gt; new ImageServiceImplementation()); sl.registerLazySingleton&lt;MapService&gt;(() =&gt; new MapServiceImplementation()); //  sl.registerSingleton&lt;UserManager&gt;(new UserManagerImplementation()); sl.registerLazySingleton&lt;EventManager&gt;(() =&gt; new EvenManagerImplementation()); sl.registerLazySingleton&lt;ImageManager&gt;(() =&gt; new ImageManagerImplementation()); sl.registerLazySingleton&lt;AppManager&gt;(() =&gt; new AppManagerImplementation());</span></span></code> </pre> <br><p> æ¯å½“æ‚¨è¦è®¿é—®æ—¶ï¼Œåªéœ€è‡´ç”µ </p><br><pre> <code class="cpp hljs">RegistrationType object = sl.get&lt;RegistrationType&gt;(); <span class="hljs-comment"><span class="hljs-comment">//  GetIt  `callable`,   : RegistrationType object2 = sl&lt;RegistrationType&gt;();</span></span></code> </pre> <br><p>  <strong>æå…¶é‡è¦çš„æ³¨æ„äº‹é¡¹ï¼š</strong>ä½¿ç”¨GetItæ—¶ï¼Œå¯¼å…¥æ–‡ä»¶æ—¶å§‹ç»ˆä½¿ç”¨ç›¸åŒçš„æ ·å¼-åŒ…ï¼ˆæ¨èï¼‰æˆ–ç›¸å¯¹è·¯å¾„ï¼Œä½†ä¸èƒ½åŒæ—¶ä½¿ç”¨ä¸¤ç§æ–¹æ³•ã€‚ è¿™æ˜¯å› ä¸ºDartä¸ç®¡è¿™äº›æ–‡ä»¶çš„èº«ä»½å¦‚ä½•ï¼Œéƒ½å°†å®ƒä»¬è§†ä¸ºä¸åŒçš„æ–‡ä»¶ã€‚ </p><br><p> å¦‚æœæ‚¨å¯¹æ­¤æ„Ÿåˆ°å›°éš¾ï¼Œè¯·è®¿é—®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘çš„åšå®¢</a>ä»¥è·å–è¯¦ç»†ä¿¡æ¯ã€‚ </p><br><h2 id="rxcommand"> æ¥æ”¶å‘½ä»¤ </h2><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨GetItæ¥è®¿é—®ä»»ä½•åœ°æ–¹çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ç”¨æˆ·ç•Œé¢ï¼‰ï¼Œæˆ‘æƒ³æè¿°å¦‚ä½•å®ç°UIäº‹ä»¶çš„å¤„ç†å‡½æ•°ã€‚ æœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†åŠŸèƒ½æ·»åŠ åˆ°ç®¡ç†å™¨å¹¶åœ¨å°éƒ¨ä»¶ä¸­è°ƒç”¨å®ƒä»¬ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManager</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lookUpZip</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String zip)</span></span></span></span>; }</code> </pre> <br><p> ç„¶ååœ¨ç”¨æˆ·ç•Œé¢ä¸­ </p><br><pre> <code class="cpp hljs">TextField(onChanged: sl.get&lt;SearchManager&gt;().lookUpZip,)</code> </pre> <br><p> è¿™å°†åœ¨<code>TextField</code>æ¯æ¬¡æ›´æ”¹æ—¶<code>lookUpZip</code> ã€‚ ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•å°†ç»“æœä¼ é€’ç»™æˆ‘ä»¬ï¼Ÿ ç”±äºæˆ‘ä»¬å¸Œæœ›æ˜¯ååº”å¼çš„ï¼Œå› æ­¤å¯ä»¥åœ¨<code>SearchManager</code>æ·»åŠ ä¸€ä¸ª<code>StreamController</code> ï¼š </p><br><pre> <code class="cpp hljs">abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManager</span></span></span><span class="hljs-class"> {</span></span> Stream&lt;String&gt; get nameOfCity; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lookUpZip</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String zip)</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManagerImplementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManager</span></span></span><span class="hljs-class">{</span></span> @override Stream&lt;String&gt; get nameOfCity =&gt; cityController.stream; StreamController&lt;String&gt; cityController = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamController(); @override Future&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; lookUpZip(String zip) async { var cityName = await sl.get&lt;ZipApiService&gt;().lookUpZip(zip); cityController.add(cityName); } }</code> </pre> <br><p> å¹¶åœ¨ç”¨æˆ·ç•Œé¢ä¸­ï¼š </p><br><pre> <code class="cpp hljs">StreamBuilder&lt;String&gt;( initialData:<span class="hljs-string"><span class="hljs-string">'', stream: sl.get&lt;SearchManager&gt;().nameOfCity, builder: (context, snapshot) =&gt; Text(snapShot.data);</span></span></code> </pre> <br><p> å°½ç®¡æ­¤æ–¹æ³•æœ‰æ•ˆï¼Œä½†è¿™ä¸æ˜¯æœ€ä½³æ–¹æ³•ã€‚ è¿™é‡Œæ˜¯é—®é¢˜ï¼š </p><br><ul><li> å†—ä½™ä»£ç -å¦‚æœæˆ‘ä»¬ä¸æƒ³åœ¨å…¬å…±é¢†åŸŸä¸­æ˜ç¡®æ˜¾ç¤ºå®ƒï¼Œæˆ‘ä»¬æ€»æ˜¯å¿…é¡»ä¸ºå…¶åˆ›å»ºä¸€ä¸ªæ–¹æ³•StreamControllerå’Œä¸€ä¸ªgetter </li><li> å¿™çŠ¶æ€-å¦‚æœæˆ‘ä»¬æƒ³åœ¨å‡½æ•°æ‰§è¡Œå…¶å·¥ä½œæ—¶æ˜¾ç¤ºSpinneræ€ä¹ˆåŠï¼Ÿ </li><li> é”™è¯¯å¤„ç†-å¦‚æœä¸€ä¸ªå‡½æ•°æŠ›å‡ºå¼‚å¸¸æ€ä¹ˆåŠï¼Ÿ </li></ul><br><p> å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ æ›´å¤šStreamControlleræ¥å¤„ç†çŠ¶æ€å’Œé”™è¯¯...ä½†æ˜¯å¾ˆå¿«å®ƒå˜å¾—å¾ˆä¹å‘³ï¼Œå¹¶ä¸”<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rx_command</a>åŒ…åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æ´¾ä¸Šç”¨åœºã€‚ </p><br><p>  <code>RxCommand</code>è§£å†³äº†ä¸Šè¿°æ‰€æœ‰é—®é¢˜ï¼Œç”šè‡³æ›´å¤šã€‚  <code>RxCommand</code>å°è£…äº†ä¸€ä¸ªå‡½æ•°ï¼ˆåŒæ­¥æˆ–å¼‚æ­¥ï¼‰ï¼Œå¹¶å°†å…¶ç»“æœè‡ªåŠ¨å‘å¸ƒåˆ°æµä¸­ã€‚ </p><br><p> ä½¿ç”¨RxCommandï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·é‡å†™æˆ‘ä»¬çš„ç®¡ç†å™¨ï¼š </p><br><pre> <code class="cpp hljs">abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManager</span></span></span><span class="hljs-class"> {</span></span> RxCommand&lt;String,String&gt; lookUpZipCommand; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManagerImplementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchManager</span></span></span><span class="hljs-class">{</span></span> @override RxCommand&lt;String,String&gt; lookUpZipCommand; SearchManagerImplementation() { lookUpZipCommand = RxCommand.createAsync((zip) =&gt; sl.get&lt;ZipApiService&gt;().lookUpZip(zip)); } }</code> </pre> <br><p> å¹¶åœ¨ç”¨æˆ·ç•Œé¢ä¸­ï¼š </p><br><pre> <code class="cpp hljs">TextField(onChanged: sl.get&lt;SearchManager&gt;().lookUpZipCommand,) ... StreamBuilder&lt;String&gt;( initialData:<span class="hljs-string"><span class="hljs-string">'', stream: sl.get&lt;SearchManager&gt;().lookUpZipCommand, builder: (context, snapshot) =&gt; Text(snapShot.data);</span></span></code> </pre> <br><p> è¿™æ›´åŠ ç®€æ´æ˜“è¯»ã€‚ </p><br><h2 id="rxcommand-v-detalyah">  RxCommandè¯¦ç»† </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/0aa/485/a85/0aa485a85b55c760e32b482a6c00b758.png"></p><br><p>  RxCommandå…·æœ‰ä¸€ä¸ªè¾“å…¥å’Œäº”ä¸ªè¾“å‡ºObservablesï¼š </p><br><ul><li><p>  <strong>canExecuteInput</strong>æ˜¯ä¸€ä¸ªå¯é€‰çš„<code>Observable&lt;bool&gt;</code> ï¼Œæ‚¨å¯ä»¥åœ¨åˆ›å»ºRxCommandæ—¶å°†å…¶ä¼ é€’ç»™å·¥å‚å‡½æ•°ã€‚ æ ¹æ®æ¥æ”¶åˆ°çš„æœ€åä¸€ä¸ªå€¼ï¼Œå®ƒå‘RxCommandå‘å‡ºä¿¡å·æ˜¯å¦å¯ä»¥æ‰§è¡Œã€‚ </p><br></li><li><p>  <strong>isExecuting</strong>æ˜¯ä¸€ä¸ª<code>Observable&lt;bool&gt;</code> ï¼Œå®ƒæŒ‡ç¤ºå‘½ä»¤å½“å‰æ˜¯å¦æ­£åœ¨æ‰§è¡Œå…¶åŠŸèƒ½ã€‚ å›¢é˜Ÿç¹å¿™æ—¶ï¼Œæ— æ³•é‡æ–°è¿è¡Œã€‚ å¦‚æœè¦åœ¨è¿è¡Œæ—¶æ˜¾ç¤ºSpinnerï¼Œè¯·æ”¶å¬<code>isExecuting</code> </p><br></li><li><p>  <strong>canExecute</strong>æ˜¯ä¸€ä¸ª<code>Observable&lt;bool&gt;</code> ï¼Œå®ƒè¡¨ç¤ºæ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚ ä¾‹å¦‚ï¼Œè¿™ä¸StreamBuilderé…åˆå¾—å¾ˆå¥½ï¼Œå¯ä»¥åœ¨å¼€/å…³çŠ¶æ€ä¹‹é—´æ›´æ”¹æŒ‰é’®çš„å¤–è§‚ã€‚ <br>  <em>å…¶å«ä¹‰å¦‚ä¸‹ï¼š</em> </p><br><pre> <code class="cpp hljs">Observable&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; canExecute = Observable.combineLatest2&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;(canExecuteInput,isExecuting) =&gt; canExecuteInput &amp;&amp; !isExecuting).distinct.</code> </pre> <br><p>  <em>è¿™æ„å‘³ç€</em> </p><br><ul><li> å¦‚æœisExecutingè¿”å›<code>true</code>åˆ™ä¸º<code>true</code> </li><li> ä»…å½“isExecutingè¿”å›<code>false</code>å¹¶ä¸”canExecuteInputä¸è¿”å›<code>false</code> ï¼Œå®ƒå°†è¿”å›<code>false</code> ã€‚ </li></ul><br></li><li><p>  <strong>thrownExceptions</strong>æ˜¯ä¸€ä¸ª<code>Observable&lt;Exception&gt;</code> ã€‚ æ‰“åŒ…å‡½æ•°å¯ä»¥æŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸éƒ½å°†è¢«æ•è·å¹¶å‘é€åˆ°æ­¤Observableã€‚ å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ”¶å¬å¹¶æ˜¾ç¤ºå¯¹è¯æ¡†ã€‚ </p><br></li><li><p>  <strong>ï¼ˆå›¢é˜Ÿæœ¬èº«ï¼‰</strong>å®é™…ä¸Šä¹Ÿæ˜¯å¯è§‚å¯Ÿçš„ã€‚ å·¥ä½œå‡½æ•°è¿”å›çš„å€¼å°†åœ¨æ­¤é€šé“ä¸Šä¼ è¾“ï¼Œå› æ­¤æ‚¨å¯ä»¥å°†RxCommandä½œä¸ºæµå‚æ•°ç›´æ¥ä¼ é€’ç»™StreamBuilder </p><br></li><li><p>  <strong>ç»“æœ</strong>åœ¨ä¸€ä¸ª<code>Observable&lt;CommandResult&gt;</code>åŒ…å«æ‰€æœ‰å‘½ä»¤çŠ¶æ€ï¼Œå…¶ä¸­<code>CommandResult</code>å®šä¹‰ä¸º </p><br></li></ul><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/// Combined execution state of an `RxCommand` /// Will be issued for any state change of any of the fields /// During normal command execution, you will get this item's listening at the command's [.results] observable. /// 1. If the command was just newly created, you will get `null, false, false` (data, error, isExecuting) /// 2. When calling execute: `null, false, true` /// 3. When exceution finishes: `result, false, false` class CommandResult&lt;T&gt; { final T data; final Exception error; final bool isExecuting; const CommandResult(this.data, this.error, this.isExecuting); bool get hasData =&gt; data != null; bool get hasError =&gt; error != null; @override bool operator ==(Object other) =&gt; other is CommandResult&lt;T&gt; &amp;&amp; other.data == data &amp;&amp; other.error == error &amp;&amp; other.isExecuting == isExecuting; @override int get hashCode =&gt; hash3(data.hashCode, error.hashCode, isExecuting.hashCode); @override String toString() { return 'Data: $data - HasError: $hasError - IsExecuting: $isExecuting'; } }</span></span></code> </pre> <br><p> å¦‚æœè¦å°†å‘½ä»¤çš„ç»“æœç›´æ¥ä¼ é€’åˆ°StreamBuilderï¼Œåˆ™<code>.results</code> Observableå°¤å…¶æœ‰ç”¨ã€‚ è¿™å°†æ ¹æ®å‘½ä»¤çš„çŠ¶æ€æ˜¾ç¤ºä¸åŒçš„å†…å®¹ï¼Œå¹¶ä¸”ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rx_widgets</a>åŒ…ä¸­çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxLoader</a>ä¸€èµ·ä½¿ç”¨æ—¶æ•ˆæœå¾ˆå¥½ã€‚ è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨<code>.results</code> Observableçš„RxLoaderå°éƒ¨ä»¶ç¤ºä¾‹ï¼š </p><br><pre> <code class="cpp hljs">Expanded( <span class="hljs-comment"><span class="hljs-comment">/// RxLoader      ///    Stream&lt;CommandResult&gt; child: RxLoader&lt;List&lt;WeatherEntry&gt;&gt;( spinnerKey: AppKeys.loadingSpinner, radius: 25.0, commandResults: sl.get&lt;AppManager&gt;().updateWeatherCommand.results, /// ,  .hasData == true dataBuilder: (context, data) =&gt; WeatherListView(data, key: AppKeys.weatherList), /// ,  .isExceuting == true placeHolderBuilder: (context) =&gt; Center( key: AppKeys.loaderPlaceHolder, child: Text("No Data")), /// ,  .hasError == true errorBuilder: (context, ex) =&gt; Center( key: AppKeys.loaderError, child: Text("Error: ${ex.toString()}")), ), ),</span></span></code> </pre><br><h2 id="sozdanie-rxcommands"> åˆ›å»ºRxCommand </h2><br><p>  RxCommandså¯ä»¥ä½¿ç”¨åŒæ­¥å’Œå¼‚æ­¥åŠŸèƒ½ï¼š </p><br><ul><li> å®ƒä»¬æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿä¸è¿”å›ç»“æœã€‚ </li><li> å®ƒä»¬æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¸è¿”å›ç»“æœã€‚ </li><li> å®ƒä»¬æ²¡æœ‰å‚æ•°å¹¶è¿”å›ç»“æœã€‚ </li><li> å®ƒä»¬æœ‰ä¸€ä¸ªå‚æ•°å¹¶è¿”å›ç»“æœï¼› </li></ul><br><p> å¯¹äºæ‰€æœ‰é€‰é¡¹ï¼ŒRxCommandæä¾›äº†å‡ ç§å·¥å‚æ–¹æ³•ï¼Œå…¶ä¸­è€ƒè™‘äº†åŒæ­¥å’Œå¼‚æ­¥å¤„ç†ç¨‹åºï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;TParam, TResult&gt; createSync&lt;TParam, TResult&gt;(Func1&lt;TParam, TResult&gt; func,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, TResult&gt; createSyncNoParam&lt;TResult&gt;(Func&lt;TResult&gt; func,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;TParam, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; createSyncNoResult&lt;TParam&gt;(Action1&lt;TParam&gt; action,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; createSyncNoParamNoResult(Action action,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;TParam, TResult&gt; createAsync&lt;TParam, TResult&gt;(AsyncFunc1&lt;TParam, TResult&gt; func,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, TResult&gt; createAsyncNoParam&lt;TResult&gt;(AsyncFunc&lt;TResult&gt; func,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;TParam, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; createAsyncNoResult&lt;TParam&gt;(AsyncAction1&lt;TParam&gt; action,... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RxCommand&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; createAsyncNoParamNoResult(AsyncAction action,...</code> </pre> <br><p>  <strong>å³ä½¿æ‰“åŒ…çš„å‡½æ•°ä¸è¿”å›å€¼ï¼ŒRxCommandåœ¨æ‰§è¡Œå‡½æ•°åä¹Ÿå°†è¿”å›ç©ºå€¼ã€‚</strong>  <strong>å› æ­¤ï¼Œæ‚¨å¯ä»¥å°†ä¾¦å¬å™¨è®¾ç½®ä¸ºæ­¤ç±»å‘½ä»¤ï¼Œä»¥ä½¿å…¶å¯¹åŠŸèƒ½çš„å®Œæˆåšå‡ºå“åº”ã€‚</strong> </p><br><h2 id="dostup-k-poslednemu-rezultatu"> è·å–æœ€æ–°ç»“æœ </h2><br><p>  <code>RxCommand.lastResult</code>ä½¿æ‚¨å¯ä»¥è®¿é—®å‘½ä»¤æ‰§è¡Œç»“æœçš„æœ€åæˆåŠŸå€¼ï¼Œè¯¥å€¼å¯ä»¥åœ¨StreamBuilderä¸­ç”¨ä½œ<code>initialData</code> ã€‚ </p><br><p> å¦‚æœè¦åœ¨è¿è¡Œæ—¶æˆ–å‘ç”Ÿé”™è¯¯æ—¶è·å–CommandResultäº‹ä»¶ä¸­åŒ…å«çš„æœ€åç»“æœï¼Œåˆ™å¯ä»¥åœ¨åˆ›å»ºå‘½ä»¤æ—¶ä¼ é€’<code>emitInitialCommandResult = true</code> ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œå¦‚æœè¦å°†åˆå§‹å€¼åˆ†é…ç»™<code>.lastResult</code> ï¼Œåˆ™åœ¨StreamBuilderä¸­å°†å…¶ç”¨ä½œ<code>initialData</code>æ—¶ï¼Œå¯ä»¥åœ¨åˆ›å»ºå‘½ä»¤æ—¶å°†å®ƒä¸<code>initialLastResult</code>å‚æ•°ä¸€èµ·ä¼ é€’ã€‚ </p><br><h2 id="primer---delaem-flutter-reaktivnym"> ç¤ºä¾‹-ä½¿Flutterå…·æœ‰ååº”æ€§ </h2><br><p> è¯¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¤ºä¾‹</a>çš„æœ€æ–°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç‰ˆæœ¬</a>å·²ä¸º<strong>RxVMS</strong>è¿›è¡Œäº†é‡ç»„ï¼Œå› æ­¤ç°åœ¨æ‚¨åº”è¯¥åœ¨å¦‚ä½•ä½¿ç”¨å®ƒæ–¹é¢æœ‰äº†ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ </p><br><p> ç”±äºè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åº”ç”¨ç¨‹åºï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªç®¡ç†å‘˜ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppManager</span></span></span><span class="hljs-class"> {</span></span> RxCommand&lt;String, List&lt;WeatherEntry&gt;&gt; updateWeatherCommand; RxCommand&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; switchChangedCommand; RxCommand&lt;String, String&gt; textChangedCommand; AppManager() { <span class="hljs-comment"><span class="hljs-comment">//    bool         //   Observable switchChangedCommand = RxCommand.createSync&lt;bool, bool&gt;((b) =&gt; b); //    switchChangedCommand  canExecute Observable  // updateWeatherCommand updateWeatherCommand = RxCommand.createAsync&lt;String, List&lt;WeatherEntry&gt;&gt;( sl.get&lt;WeatherService&gt;().getWeatherEntriesForCity, canExecute: switchChangedCommand, ); //         textChangedCommand = RxCommand.createSync&lt;String, String&gt;((s) =&gt; s); //    ... textChangedCommand //     500ms... .debounce(new Duration(milliseconds: 500)) // ...   updateWeatherCommand .listen(updateWeatherCommand); //     updateWeatherCommand(''); } }</span></span></code> </pre> <br><p> æ‚¨å¯ä»¥å°†ä¸åŒçš„RxCommandsç»„åˆåœ¨ä¸€èµ·ã€‚ è¯·æ³¨æ„ï¼Œ <code>switchedChangedCommand</code>å®é™…ä¸Šæ˜¯<code>updateWeatherCommand</code>çš„<strong>Observable canExecute</strong> ã€‚ </p><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ç”¨æˆ·ç•Œé¢ä¸­ä½¿ç”¨Managerï¼š </p><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Scaffold( appBar: AppBar(title: Text(<span class="hljs-string"><span class="hljs-string">"WeatherDemo"</span></span>)), resizeToAvoidBottomPadding: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, body: Column( children: &lt;Widget&gt;[ Padding( padding: <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> EdgeInsets.all(<span class="hljs-number"><span class="hljs-number">16.0</span></span>), child: TextField( key: AppKeys.textField, autocorrect: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, controller: _controller, decoration: InputDecoration( hintText: <span class="hljs-string"><span class="hljs-string">"Filter cities"</span></span>, ), style: TextStyle( fontSize: <span class="hljs-number"><span class="hljs-number">20.0</span></span>, ), <span class="hljs-comment"><span class="hljs-comment">//    textChangedCommand! onChanged: sl.get&lt;AppManager&gt;().textChangedCommand, ), ), Expanded( /// RxLoader   builders   ///   Stream&lt;CommandResult&gt; child: RxLoader&lt;List&lt;WeatherEntry&gt;&gt;( spinnerKey: AppKeys.loadingSpinner, radius: 25.0, commandResults: sl.get&lt;AppManager&gt;().updateWeatherCommand.results, dataBuilder: (context, data) =&gt; WeatherListView(data, key: AppKeys.weatherList), placeHolderBuilder: (context) =&gt; Center(key: AppKeys.loaderPlaceHolder, child: Text("No Data")), errorBuilder: (context, ex) =&gt; Center(key: AppKeys.loaderError, child: Text("Error: ${ex.toString()}")), ), ), Padding( padding: const EdgeInsets.all(8.0), child: Row( children: &lt;Widget&gt;[ ///  Updatebutton    updateWeatherCommand.canExecute Expanded( //        Streambuilder, //      WidgetSelector child: WidgetSelector( buildEvents: sl .get&lt;AppManager&gt;() .updateWeatherCommand .canExecute, onTrue: RaisedButton( key: AppKeys.updateButtonEnabled, child: Text("Update"), onPressed: () { _controller.clear(); sl.get&lt;AppManager&gt;().updateWeatherCommand(); }, ), onFalse: RaisedButton( key: AppKeys.updateButtonDisabled, child: Text("Please Wait"), onPressed: null, ), ), ), //    canExecuteInput StateFullSwitch( state: true, onChanged: sl.get&lt;AppManager&gt;().switchChangedCommand, ), ], ), ), ], ), );</span></span></code> </pre> <br><h2 id="tipovye-shablony-ispolzovaniya"> å…¸å‹ä½¿ç”¨æ¨¡å¼ </h2><br><p> æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸€ç§ä½¿ç”¨<strong>CommandResults</strong>å“åº”å‘½ä»¤çš„ä¸åŒçŠ¶æ€çš„æ–¹æ³•ã€‚ åœ¨æˆ‘ä»¬è¦æ˜¾ç¤ºå‘½ä»¤æ˜¯å¦æˆåŠŸï¼ˆä½†ä¸æ˜¾ç¤ºç»“æœï¼‰çš„æƒ…å†µä¸‹ï¼Œä¸€ç§å¸¸è§çš„æ¨¡å¼æ˜¯åœ¨<code>initState</code> StatefulWidgetå‡½æ•°ä¸­ä¾¦å¬Observableså‘½ä»¤ã€‚ è¿™æ˜¯ä¸€ä¸ªçœŸå®é¡¹ç›®çš„ç¤ºä¾‹ã€‚ </p><br><p>  <code>createEventCommand</code>å®šä¹‰ï¼š </p><br><pre> <code class="cpp hljs"> RxCommand&lt;Event, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>&gt; createEventCommand;</code> </pre> <br><p> è¿™å°†åœ¨æ•°â€‹â€‹æ®åº“ä¸­åˆ›å»ºä¸€ä¸ª<strong>Event</strong>å¯¹è±¡ï¼Œå¹¶ä¸”ä¸ä¼šè¿”å›ä»»ä½•å®é™…å€¼ã€‚ ä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€äº†è§£çš„ï¼Œå³ä½¿è¿”å›ç±»å‹ä¸º<code>void</code>çš„RxCommandåœ¨å®Œæˆæ—¶ä¹Ÿå°†è¿”å›å•ä¸ªæ•°æ®é¡¹ã€‚ å› æ­¤ï¼Œå‘½ä»¤å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤è¡Œä¸ºæ¥è§¦å‘åº”ç”¨ç¨‹åºä¸­çš„æ“ä½œï¼š </p><br><pre> <code class="cpp hljs">@<span class="hljs-function"><span class="hljs-function">override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      ,        _eventCommandSubscription = _createCommand.listen((_) async { Navigator.pop(context); await showToast('Event saved'); }); //        _errorSubscription = _createEventCommand.thrownExceptions.listen((ex) async { await sl.get&lt;ErrorReporter&gt;().logException(ex); await showMessageDialog(context, 'There was a problem saving event', ex.toString()); }); }</span></span></code> </pre> <br><p>  <strong>é‡è¦æç¤º</strong> ï¼šå½“æˆ‘ä»¬ä¸å†éœ€è¦è®¢é˜…æ—¶ï¼Œè¯·ä¸è¦å¿˜è®°å®Œæˆè®¢é˜…ï¼š </p><br><pre> <code class="cpp hljs">@<span class="hljs-function"><span class="hljs-function">override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ _eventCommandSubscription?.cancel(); _errorSubscription?.cancel(); super.dispose(); }</code> </pre> <br><p> æ­¤å¤–ï¼Œå¦‚æœè¦ä½¿ç”¨å¿™ç¢Œè®¡æ•°å™¨æ˜¾ç¤ºï¼Œå¯ä»¥ï¼š </p><br><ul><li> ç›‘å¬<code>initState</code>å‡½æ•°ä¸­çš„<code>initState</code> Observableå‘½ä»¤ï¼› </li><li> æ˜¾ç¤º/éšè—è®¢é˜…ä¸­çš„è®¡æ•°å™¨ï¼› ä»¥åŠ </li><li> ä½¿ç”¨å‘½ä»¤æœ¬èº«ä½œä¸º<strong>StreamBuilder</strong>çš„æ•°æ®æº </li></ul><br><h2 id="oblegchenie-zhizni-s-rxcommandlisteners"> ä½¿ç”¨RxCommandListenersä½¿ç”Ÿæ´»æ›´è½»æ¾ </h2><br><p> å¦‚æœè¦ä½¿ç”¨å¤šä¸ªObservableï¼Œåˆ™å¯èƒ½å¿…é¡»ç®¡ç†å¤šä¸ªè®¢é˜…ã€‚ ç›´æ¥æ§åˆ¶ä¾¦å¬å’Œé‡Šæ”¾ä¸€ç»„è®¢é˜…å¯èƒ½å¾ˆå›°éš¾ï¼Œè¿™ä¼šä½¿ä»£ç çš„å¯è¯»æ€§é™ä½ï¼Œå¹¶ä½¿æ‚¨æœ‰å‡ºé”™çš„é£é™©ï¼ˆä¾‹å¦‚ï¼Œåœ¨å®Œæˆè¿‡ç¨‹ä¸­å¿˜è®°<code>cancel</code> ï¼‰ã€‚ </p><br><p> æœ€æ–°ç‰ˆæœ¬çš„<strong>rx_command</strong>æ·»åŠ äº†å¸®åŠ©ç¨‹åºç±»<code>RxCommandListener</code> ï¼Œè¯¥ç±»æ—¨åœ¨ç®€åŒ–æ­¤å¤„ç†ã€‚ å®ƒçš„æ„é€ å‡½æ•°æ¥å—å„ç§çŠ¶æ€æ›´æ”¹çš„å‘½ä»¤å’Œå¤„ç†ç¨‹åºï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RxCommandListener</span></span></span><span class="hljs-class">&lt;TParam, TResult&gt; {</span></span> final RxCommand&lt;TParam, TResult&gt; command; <span class="hljs-comment"><span class="hljs-comment">//       final void Function(TResult value) onValue; //    isExecuting final void Function(bool isBusy) onIsBusyChange; //       final void Function(Exception ex) onError; //    canExecute final void Function(bool state) onCanExecuteChange; //    .results Observable  final void Function(CommandResult&lt;TResult&gt; result) onResult; //     /  final void Function() onIsBusy; final void Function() onNotBusy; //     final Duration debounceDuration; RxCommandListener(this.command,{ this.onValue, this.onIsBusyChange, this.onIsBusy, this.onNotBusy, this.onError, this.onCanExecuteChange, this.onResult, this.debounceDuration,} ) void dispose();</span></span></code> </pre> <br><p> æ‚¨ä¸éœ€è¦ä¼ é€’æ‰€æœ‰å¤„ç†ç¨‹åºå‡½æ•°ã€‚ æ‰€æœ‰è¿™äº›éƒ½æ˜¯å¯é€‰çš„ï¼Œå› æ­¤æ‚¨å¯ä»¥ç®€å•åœ°è½¬ç§»æ‰€éœ€çš„é‚£äº›ã€‚ æ‚¨åªéœ€è¦åœ¨<code>dispose</code>å‡½æ•°ä¸­ä¸º<code>RxCommandListener</code>è°ƒç”¨<code>dispose</code> ï¼Œå®ƒå°†å–æ¶ˆè®¢é˜…ä¸­ä½¿ç”¨çš„æ‰€æœ‰å†…å®¹ã€‚ </p><br><p> åœ¨å¦ä¸€ä¸ªçœŸå®ç¤ºä¾‹ä¸­ï¼Œè®©æˆ‘ä»¬æ¯”è¾ƒå¸¦æœ‰å’Œä¸<code>RxCommandListener</code>çš„ç›¸åŒä»£ç ã€‚ åœ¨èŠå¤©å±å¹•ä¸Šï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨<code>selectAndUploadImageCommand</code>å‘½ä»¤ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­ä¸Šä¼ å›¾åƒã€‚ è°ƒç”¨å‘½ä»¤æ—¶ï¼š </p><br><ul><li>  <strong>æ˜¾ç¤ºâ€œå›¾åƒé€‰æ‹©å™¨â€</strong>å¯¹è¯æ¡†<strong>ã€‚</strong> </li><li> é€‰æ‹©å›¾åƒååŠ è½½ </li><li> ä¸‹è½½å®Œæˆåï¼Œè¯¥å‘½ä»¤å°†è¿”å›å›¾åƒå­˜å‚¨åœ°å€ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥åˆ›å»ºæ–°çš„èŠå¤©æ¡ç›®ã€‚ </li></ul><br><p> æ²¡æœ‰<strong>RxCommandListener</strong> ï¼š </p><br><pre> <code class="cpp hljs">_selectImageCommandSubscription = sl .get&lt;ImageManager&gt;() .selectAndUploadImageCommand .listen((imageLocation) async { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imageLocation == null) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    sl.get&lt;EventManager&gt;().createChatEntryCommand(new ChatEntry( event: widget.event, isImage: true, content: imageLocation.downloadUrl, )); }); _selectImageIsExecutingSubscription = sl .get&lt;ImageManager&gt;() .selectAndUploadImageCommand .isExecuting .listen((busy) { if (busy) { MySpinner.show(context); } else { MySpinner.hide(); } }); _selectImageErrorSubscription = sl .get&lt;ImageManager&gt;() .selectAndUploadImageCommand .thrownExceptions .listen((ex) =&gt; showMessageDialog(context, 'Upload problem', "We cannot upload your selected image at the moment. Please check your internet connection"));</span></span></code> </pre> <br><p> ä½¿ç”¨<strong>RxCommandListener</strong> ï¼š </p><br><pre> <code class="cpp hljs">selectImageListener = RxCommandListener( command: sl.get&lt;ImageManager&gt;().selectAndUploadImageCommand, onValue: (imageLocation) async { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imageLocation == null) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; sl.get&lt;EventManager&gt;().createChatEntryCommand(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChatEntry( event: widget.event, isImage: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, content: imageLocation.downloadUrl, )); }, onIsBusy: () =&gt; MySpinner.show(context), onNotBusy: MySpinner.hide, onError: (ex) =&gt; showMessageDialog(context, <span class="hljs-string"><span class="hljs-string">'Upload problem'</span></span>, <span class="hljs-string"><span class="hljs-string">"We cannot upload your selected image at the moment. Please check your internet connection"</span></span>));</code> </pre> <br><p> é€šå¸¸ï¼Œå¦‚æœæœ‰å¤šä¸ªObservableï¼Œæˆ‘å°†å§‹ç»ˆä½¿ç”¨RxCommandListenerã€‚ </p><br><p> å°è¯•ä½¿ç”¨<strong>RxCommands</strong> ï¼Œçœ‹çœ‹å®ƒå¦‚ä½•ä½¿æ‚¨çš„ç”Ÿæ´»æ›´è½»æ¾ã€‚ <br>  <em>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæ‚¨ä¸éœ€è¦ä½¿ç”¨<strong>RxVMS</strong>æ¥åˆ©ç”¨<strong>RxCommands</strong> ã€‚</em> </p><br><p> æœ‰å…³<code>RxCommand</code>æ›´å¤šä¿¡æ¯<code>RxCommand</code>é˜…è¯»<code>RxCommand</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è‡ªè¿°</a>åŒ…ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN449872/">https://habr.com/ru/post/zh-CN449872/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN449862/index.html">ï¼ƒ296ç§»åŠ¨å¼€å‘äººå‘˜çš„æœ‰è¶£ææ–™æ‘˜è¦ï¼ˆ4æœˆ22æ—¥è‡³26æ—¥ï¼‰</a></li>
<li><a href="../zh-CN449864/index.html">ResNet50ã€‚ è‡ªå·±å®æ–½</a></li>
<li><a href="../zh-CN449866/index.html">å¯¹HTTPSçš„æ½œåœ¨æ”»å‡»ä»¥åŠå¦‚ä½•é˜²å¾¡</a></li>
<li><a href="../zh-CN449868/index.html">GITæ•°æ®åº“ç‰ˆæœ¬æ§åˆ¶æœºåˆ¶ï¼ˆMySQLè½¬å‚¨ç®¡ç†ï¼‰</a></li>
<li><a href="../zh-CN449870/index.html">é€šç”¨JSONDecoder</a></li>
<li><a href="../zh-CN449876/index.html">Innovation SSI-2001ï¼šIBM PCï¼ˆåŠå…¶å‰¯æœ¬ï¼‰ä¸­æœ€ç¨€æœ‰çš„å£°å¡ä¹‹ä¸€çš„æ•…äº‹</a></li>
<li><a href="../zh-CN449878/index.html">ITé¢†åŸŸçš„ä¸“åˆ©ç ”ç©¶ã€‚ å¹´è½»æˆ˜å£«çš„å†ç¨‹ã€‚ ç¬¬ä¸€éƒ¨åˆ†ï¼šå¦‚ä½•ç†è§£å®¢æˆ·éœ€æ±‚å¹¶å‡†å¤‡æŠ¥å‘Šæ¨¡æ¿</a></li>
<li><a href="../zh-CN449880/index.html">æ•æ·ç²¾ç®€ç‰ˆï¼šä¸“é—¨é’ˆå¯¹å€¦æ€ </a></li>
<li><a href="../zh-CN449884/index.html">ESP8266ä¸Šçš„8008å¾®å¤„ç†å™¨ä»¿çœŸ</a></li>
<li><a href="../zh-CN449886/index.html">å°±åƒéª‘è‡ªè¡Œè½¦ä¸€æ ·</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>