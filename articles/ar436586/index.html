<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎉 🔼 🙌🏻 معركة JS: كيف كتبت لي eval () ⚠️ 🧑🏿 🖐🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="يمكنك أن تتذكر ألكساندر كوروتاييف في إصدار متصفح "أبطال القوة والسحر": فك تشفير تقريره عنها جمع قدرًا هائلاً من الآراء حول حبري. وقد صنع الآن لعبة ترك...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>معركة JS: كيف كتبت لي eval ()</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/436586/" style=";text-align:right;direction:rtl">  يمكنك أن تتذكر <b>ألكساندر كوروتاييف</b> في إصدار متصفح "أبطال القوة والسحر": <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">فك تشفير</a> تقريره عنها جمع قدرًا هائلاً من الآراء حول حبري.  وقد صنع الآن لعبة تركز على المبرمجين: تحتاج إلى تشغيلها برمز JS. <br><br>  هذه المرة ، لم يستغرق التطوير أسابيع ، بل أسابيع ، لكن بدون تحديات مثيرة على أي حال ، لم يكن من الممكن القيام به.  كيف تجعل اللعبة مريحة حتى بالنسبة للمطورين الذين لم يسبق لهم لمس JavaScript؟  كيف تحمي نفسك من طرق بسيطة للتغلب على اللعبة؟ <br><br><img src="https://habrastorage.org/webt/to/1i/n0/to1in00dneigddmemqzjqonebuy.png"><br><br>  نتيجة لذلك ، قدم ألكساندر مرة أخرى تقريرًا عن HolyJS ، وقمنا (منظمو المؤتمر) مرة أخرى بإعداد نسخة نصية لـ Habr. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/TJ7TGk5WJ5k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  اسمي ألكسندر كوروتاييف ، أعمل في Tinkoff.ru ، أنا منخرط في الواجهة الأمامية.  بالإضافة إلى ذلك ، كجزء من مجتمع Spb-frontend ، أساعد في تنظيم عمليات mitaps.  أقوم بإنتاج بودكاست Drinkc ، ندعو الأشخاص المثيرين للاهتمام ومناقشة مختلف الموضوعات. <br><br>  ما هو جوهر اللعبة؟  أولاً ، تحتاج إلى اختيار وحدة من الوحدات المقترحة ، وهذا نظام RPG: لكل وحدة نقاط القوة والضعف الخاصة بها.  ترى الوحدات التي اختارها العدو ، واختر الانتقام منه.  ثم عليك أن تكتب في JavaScript نصًا لسلوك جيشك - وبعبارة أخرى ، النص "ما يجب أن تفعله كل وحدة في ساحة المعركة". <br><br>  يتم ذلك في وضع التصحيح: في الواقع ، تقوم بخصم الكود ، ثم يقوم كلا الخصمين بدفع الكود الخاص بهم ، وتبدأ المعركة بين الجانبين. <br><br>  وبالتالي ، يمكنك أن ترى كيف أن مخطوطين ، منطقين ، خوارزميات تقاتلان بعضهما البعض.  أردت دائمًا أن أفعل شيئًا كهذا ، والآن يتم تنفيذه أخيرًا. <br><br>  في العمل ، يبدو كل شيء كما يلي: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/LfgaRFnmkhk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  وما شكل العمل عليه؟  ذهب الكثير من العمل في الوثائق.  عندما يجلس المشغل على الكمبيوتر المحمول ، يرى الوثائق ، التي يتم وصف كل شيء فيها ببعض التفاصيل. <br><br>  استغرق مني الكثير من الوقت لتخطيطه ومراجعته واستجوابه بين الناس عما إذا كان الأمر واضحًا.  ونتيجة لذلك ، اتضح بشكل واضح لـ sishnikov و javists والمطورين الآخرين الذين لا يعرفون شيئًا عن JS.  يمكنك أيضًا ترقية JavaScript باستخدام هذه اللعبة: "إنها ليست مخيفة ، انظر كيف يمكنك الكتابة عليها ، حتى يحدث شيء ممتع." <br><br><img src="https://habrastorage.org/webt/c3/9b/cf/c39bcfhakno9pvemjsm5rfj1_jo.png"><br><br>  كانت لدينا بطولة كبيرة في شركتنا ، شارك فيها أي مبرمجين تقريبًا. <br><br>  من التكنولوجيا ، استخدمت محرك اللعبة الأكثر شعبية من عالم JS - Phaser.  أكبر وأكثرها استخداما محرر الآس.  هذا محرر على شبكة الإنترنت ، يشبه إلى حد كبير Sublime أو VSCode ، ويمكن تضمينه في صفحة ويب.  كما أنني استخدمت RxJS للعمل مع التفاعلات غير المتزامنة من مختلف المستخدمين و Preact لتقديم HTML.  من التقنيات المحلية ، كان يعمل بشكل خاص مع العمال و websocket. <br><br><img src="https://habrastorage.org/webt/hr/7e/hj/hr7ehjcuxfyljukymq0yeiwsvou.png"><br><br><hr><br><h2 style=";text-align:right;direction:rtl">  ألعاب للمبرمجين </h2><br>  ما هي الألعاب للمبرمجين بشكل عام؟  في رأيي ، هذه ألعاب تحتاج إلى الكود فيها ، ثم تحصل على نتيجة مضحكة يمكن مقارنتها بشخص ما ، فهذه معركة.  من بين هذه الألعاب المتوفرة عبر الإنترنت ، أعرف <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Elevator Saga"</a> - تكتب نصوصًا للمصاعد وفقًا لمعايير معينة.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Screeps"</a> - حول البيولوجيا ، الجزيئات ، تكتب نصوصاً لهم. <br><br>  هناك أيضًا ألعاب يتم عرضها أحيانًا في المؤتمرات.  الأكثر شعبية منهم هو "Code in the Dark" ، وقد قدمناها أيضًا اليوم.  بالمناسبة ، "الكود في الظلام" ألهمني بطريقة ما. <br><br><img src="https://habrastorage.org/webt/di/ri/xp/dirixpaaxzsners2q5wbecnqf_i.png"><br><br>  لماذا تم ذلك؟  لقد حصلت على المهمة التي تحتاجها للتوصل إلى شيء رائع بموقف في المؤتمر ، شيء غير عادي.  لا أن هناك eychars مع الاستبيانات.  من الواضح أن الجميع يريدون جذب الانتباه وجمع جهات الاتصال.  قررنا الذهاب أبعد من ذلك وتوصلنا إلى شيء رائع وممتع للمبرمجين.  أدركت أن المبرمجين يريدون القتال والتنافس ، ونحن بحاجة إلى منحهم مثل هذه الفرصة.  من الضروري إنشاء موقف سيأتون إليه وسوف يرمزون إليه. <br><br>  Gamification  لقد فعلنا هذا ليس فقط بين المبرمجين الممارسين ، ولكن أيضًا بين الطلاب.  عقدنا مثل هذه المباريات في المعاهد في يوم المهنة.  كنا بحاجة إلى أن نرى بطريقة أو بأخرى أي نوع من اللاعبين كانوا مناسبين لنا أم لا.  استخدمنا gamification لجذب الناس إلى العملية ، لنرى كيف يتصرفون ، ماذا يفعلون.  لقد لعبوا وتم صرف انتباههم ، لكن ذلك أعطانا معلومات.  دفع البعض الشفرة دون تشغيلها مرة واحدة ، وكان من الواضح على الفور أنه من المبكر جدًا التطوير. <br><br><img src="https://habrastorage.org/webt/zy/j7/-d/zyj7-dtcxgbzsnlm6eiakic1pri.png"><br><br>  كيف بدا في الإصدار الأول.  كانت شاشة رئيسية وجهازي كمبيوتر محمول للاعبين.  كل هذا اتصل بالخادم ، وقام الخادم بتخزين الحالة وتفتيشها بين جميع العملاء المتصلين.  كانت كل شاشة عميل متصل.  أجهزة الكمبيوتر المحمولة للاعبين عبارة عن شاشات تفاعلية يمكن تغيير هذه الحالة منها.  يتم ربط الشاشات بشكل صارم بخادم واحد. <br><br><h2 style=";text-align:right;direction:rtl">  قصة ضيق الوقت </h2><br>  القصة الأولى التي صادفتها في هذا التطور هي القصة التي كان لدي القليل من الوقت فيها.  في غضون خمس دقائق حرفيًا ، ظهرت فكرة ، في خمس ثوان تم اختراع اسم عندما كان مطلوبًا لإنشاء <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع</a> على GitHub.  يمكن أن أقضي كل ذلك أربع ساعات فقط في المساء ، وأخذهم بعيداً عن زوجتي.  ونتيجة لذلك ، كان أمامي ثلاثة أسابيع فقط قبل المؤتمر لإدراك ذلك بطريقة أو بأخرى على الأقل.  بدأ كل شيء بحيث كان من الضروري للتوصل إلى فكرة في إطار العصف الذهني ، في خمس دقائق ولدت الفكرة: "هيا نكتب نوعًا من الذكاء الاصطناعي لـ RPG في JS".  إنه رائع ، ممتع ، يمكنني تنفيذه. <br><br><img src="https://habrastorage.org/webt/un/tq/kh/untqkhyleylozw4th97etc8grc0.png"><br><br>  في التطبيق الأول ، كان للشاشة محرر كود وشاشة معركة ، كانت المعركة نفسها عليها.  تم استخدام Phaser و Ace Editor و Node.js الخالص كخادم بدون أي أطر عمل.  ما أسفه لاحقًا ، لكن لا شيء خاص كان مطلوبًا من الخادم. <br><br><img src="https://habrastorage.org/webt/_g/lz/uz/_glzuzkixm5rkvgffsvxc6i0txi.png"><br><br>  تمكنت من إدراك Renderer الذي رسم المعركة بنفسه.  كان الجزء الأكثر صعوبة هو صندوق الرمل لرمز JS ، أي صندوق رمل كان من المفترض أن يتم فيه تنفيذ كل شيء بمعزل عن كل لاعب.  كان هناك أيضا تقاسم الدولة التي جاءت من الخادم.  أرسل اللاعبون حالة تغيير بطريقة ما ، وألقوا على الخادم ، أرسل الباقي إلى مآخذ الويب.  كان الخادم مصدرًا للحقيقة ، وقد وثق جميع العملاء المتصلين بما جاء من الخادم. <br><br><h2 style=";text-align:right;direction:rtl">  صندوق الرمل </h2><br>  ما هو الصعب للغاية لتنفيذ رمل؟  والحقيقة هي أن رمل هو العالم كله للرمز الذي يجب أن يكون رمز موجود.  وهذا يعني أنك تصنع له نفس العالم كما هو حوله ، ولكن يتكون فقط من بعض الاتفاقيات ، من واجهة برمجة تطبيقات يمكنك التفاعل معها.  كيفية تنفيذ هذا على JS؟  يبدو أن JS غير قادر على ذلك ، فهو مليء بالثقوب ومجاني لدرجة أنه لا يعمل على إحاطة رمز المستخدم بالكامل في صندوق دون استخدام جهاز افتراضي منفصل مع نظام تشغيل منفصل. <br><br><img src="https://habrastorage.org/webt/gb/ok/yi/gbokyimz5h1piufn5yfoudov554.png"><br><br>  ماذا يجب أن تفعل رمل؟ <br><br>  أولاً ، كما قلت ، قم بعزل الكود.  يجب أن يكون عالما لا يمكن للمرء الخروج منه. <br><br>  أيضا ، يجب أن يتم طرح API إدارة وحدة هناك.  يجب أن يتفاعل اللاعبون مع ساحة المعركة ، ونقل الوحدات ، وتوجيههم ، ومنحهم ناقل هجوم. <br>  وأية إجراءات من وحدات غير متزامن ، وهذا هو ، يجب أن تعمل بطريقة أو بأخرى مع رمز غير متزامن. <br><br><img src="https://habrastorage.org/webt/or/q1/y1/orq1y1fcofatt5oz2qieinaixay.png"><br><br>  ماذا أردت أن أقول عن عدم التزامن؟  والحقيقة هي أنه في JS يتم تنفيذه أساسا باستخدام الوعود.  كل شيء واضح للجميع هنا ، والوعود شيء عظيم ، فهي تعمل بشكل مثالي ، وكنا دائمًا معنا.  لسنوات عديدة ، يعرف الجميع كيفية العمل معهم ، ولكن هذه اللعبة لم تكن مخصصة فقط لجافا سكريبت.  تخيل لو بدأت في شرح للجاويين كيفية كتابة رمز معركة باستخدام الوعود؟  كيف نفعل بعد ذلك ، ثم ، لماذا لا يكون ذلك ضروريًا في بعض الأحيان ... ماذا تفعل بالظروف أو الحلقات؟ <br><br><img src="https://habrastorage.org/webt/z2/qn/ir/z2qnirhdy_puuuliwdnfu0sxalg.png"><br><br>  يمكنك ، بالطبع ، أن تذهب بأفضل طريقة وأن تأخذ بناء جملة async / await.  [Slide 8:57] ولكن هل يمكنك أيضًا أن تتخيل كيف يمكن لمبرمجي برامج الجافا سكريبت توضيح أنك بحاجة إلى الانتظار قبل كل سطر تقريبًا؟  نتيجة لذلك ، فإن أفضل طريقة للتعامل مع عدم التزامن هي عدم استخدامه على الإطلاق. <br><br><img src="https://habrastorage.org/webt/vm/yd/bi/vmydbi-ocp9npyl56wzqv-rnr4e.png"><br><br>  اصنع الرمز الأكثر تزامنًا وواجهة برمجة التطبيقات البسيطة ، على غرار أي لغة برمجة تقريبًا.  نحن نصنع لعبة ، ليس فقط للأشخاص الذين يكتبون في JS ، بل نريد أن نجعلها في متناول الجميع الذين يعرفون كيفية الشفرة. <br><br><img src="https://habrastorage.org/webt/ng/et/2d/nget2dl8vrmwwi3y608ztrpn2pk.png"><br><br>  نحن جميعا بحاجة لبدء بطريقة ما.  يكتب المستخدم الكود ، ونحن بحاجة إلى تنفيذه ، انقل الوحدات على الخريطة.  أول ما يتبادر إلى الذهن هو أننا نحتاج إلى eval () بالإضافة إلى العبارة غير الموصى بها مع العبارة ، والتي <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">لا يوصى باستخدامها على MDN</a> .  هذا سوف يعمل ، ولكن هناك مشاكل. <br><br><img src="https://habrastorage.org/webt/ca/18/5a/ca185aygesba1t6wuxfymhvkghi.png"><br><br>  على سبيل المثال ، لدينا كود يدمر تمامًا فكرتنا بالكامل ، مما يمنعنا من القيام بأي شيء آخر.  هذا هو الرمز الذي يمنع التنفيذ.  يجب القيام بشيء ما حتى لا يتمكن المستخدم من حظر التطبيق.  على سبيل المثال ، يمكن حلقة لا نهاية لها كسر كل شيء.  إذا كان لا يزال من الممكن إعادة تعريف التنبيه () والموجه () ، فلا يمكننا إعادة تعريف حلقة لا نهائية على الإطلاق. <br><br><h2 style=";text-align:right;direction:rtl">  eval () هو الشر </h2><br>  لذلك نصل إلى النقطة التي يكون فيها eval () شريرًا.  لا يسمونه شرًا لأنه لا شيء ، لأنه وظيفة خبيثة تدمج فعليًا كل ما هو أكثر حرية وانفتاحًا في JS ، ولا تتركنا أعزل تمامًا.  من خلال وظيفة واحدة بسيطة ، نقوم بعمل ثقب كبير في تطبيقنا. <br><br><img src="https://habrastorage.org/webt/-e/1s/yv/-e1syve2mujeqy_vpnr3obdk7sk.png"><br><br>  ولكن ماذا لو قلت لك ، <i>[في صوت ستيف جوبز]</i> أننا اخترعنا eval ()؟ <br><br>  لقد فعلنا eval () في التقنيات الأخرى ، وهو يعمل بنفس الطريقة تقريبًا مثل eval () التي لدينا بالفعل.  في الحقيقة ، لديّ وظيفة eval () في الكود الخاص بي ، لكن تم تنفيذها باستخدام Workers ، the with statement ، و Proxy. <br><br><img src="https://habrastorage.org/webt/wf/gj/ox/wfgjoxy3qrjkfnrnpvq-o06xr8k.png"><br><br>  لماذا العمال؟  الحقيقة هي أنهم ينشئون سلسلة منفصلة من التنفيذ ، أي أن JS هي ذات سلسلة واحدة ، لكن بفضل العمال يمكننا الحصول على سلسلة أخرى.  هذا يعطينا العديد من الفوائد.  على سبيل المثال ، ضمن نفس الحلقات التي لا نهاية لها ، يمكننا مقاطعة الخيط الذي تم إنشاؤه من خلال العامل من الخيط الرئيسي ، وربما هذا هو السبب الرئيسي لاستخدام العمال.  إذا تمكن العامل من العمل بشكل أسرع من ثانية واحدة ، فإننا نعتبره ناجحًا ، ونحصل على النتيجة.  إذا لم يكن الأمر كذلك ، فإننا نقطعها.  في الواقع ، لم يعمل رمز المستخدم لسبب ما ، حدثت بعض الأخطاء الغريبة ، أو تم إبطائه بسبب حلقة لا نهائية.  لقد حاول الكثيرون اليوم الكتابة بينما (صحيح) ، وحذرت من أن هذا لن ينجح. <br><br><img src="https://habrastorage.org/webt/ee/en/va/eeenvauyaknpsa7hizr52fvkcwk.png"><br><br>  لكتابة عاملنا ، نحتاج فقط إلى تغذية البرنامج النصي إلى المنشئ العامل ، والذي سيتم تنزيله عبر http.  داخل البرنامج النصي ، نحتاج إلى إنشاء معالج رسائل من سلسلة الرسائل الرئيسية.  باستخدام وظيفة postMessage () داخل العامل ، يمكننا توجيه الرسائل إلى سلسلة الرسائل الرئيسية.  بهذه الطريقة نجعل التواصل بين الخيطين.  واجهة برمجة تطبيقات بسيطة مريحة إلى حد ما ، ولكن هناك شيء ما مفقود فيها ، وهو رمز المستخدم الذي يجب علينا تنفيذه في هذا العامل.  لن نقوم في كل مرة بإنشاء ملف نصي على الخادم وإطعامه للعامل. <br><br><img src="https://habrastorage.org/webt/u2/4h/ia/u24hian_cjbwwi-06mtfn6qldmo.png"><br><br>  لقد وجدت طريقة لاستخدام URL.createObjectURL ().  نجعل كتلة وإطعامها إلى عامل src.  وبالتالي ، فإنه يفرغ رمز لدينا مباشرة من الخط.  بالمناسبة ، تعمل هذه الطريقة مع أي كائنات في DOM لها src - تعمل الصورة مثل هذا ، على سبيل المثال ، وحتى في iframe يمكنك تحميل html فقط عن طريق توليده من سلسلة.  رائع جدا ومرنة ، على ما أعتقد.  يمكننا أيضًا إدارة العامل عن طريق تمريره ببساطة كائننا الذي تم إنشاؤه خصيصًا من عنوان URL.  يمكننا أيضًا إنهائه ويعمل بالفعل حسب حاجتنا ، وأنشأنا أول صندوق رمل. <br><br><img src="https://habrastorage.org/webt/mq/kp/mk/mqkpmkw8-ufofb05g8qb94-mzm4.png"><br><br>  تتواصل التفاعلات غير المتزامنة إلى أبعد من ذلك ، لأن أي عمل مع العمال غير متزامن.  لقد أرسلنا بعض الرسائل ، ولا يمكننا الانتظار بشكل متزامن للرسالة التالية ، حيث يقوم العامل بإرجاع المثال إلينا ، ويمكننا الاشتراك في الرسائل.  نحصل على الرسالة باستخدام RxJS ، نقوم بإنشاء خيطين: واحد للرسالة الناجحة من العامل ، والثاني للإنجاز بحلول المهلة.  اثنين من المواضيع التي نتحكم بعد ذلك مع دمجها. <br><br><img src="https://habrastorage.org/webt/-x/mt/ny/-xmtnyqc5ytkd6w2zkzdeqfgsws.png"><br><br>  لدى RxJS عوامل تشغيل تسمح لنا بالعمل مع سلاسل الرسائل.  في الواقع ، هو مثل lodash لعمليات متزامنة.  يمكننا الإشارة إلى بعض الوظائف وعدم التفكير في كيفية تنفيذها في الداخل ، فهو يخفف من الصداع.  نحتاج إلى البدء في التفكير في مؤشرات الترابط ، ويدمج عامل الدمج مؤشرات الترابط الخاصة بنا ، ويستجيب لأي رسالة.  سوف تستجيب لكل من المهلة والرسالة.  نحتاج إلى الرسالة الأولى فقط ، على التوالي ، بعد الرسالة الأولى التي ننهي العامل.  في حالة وجود خطأ ، اطبع هذا الخطأ ؛ في حالة النجاح ، نحل المشكلة. <br><br><img src="https://habrastorage.org/webt/l0/fj/lr/l0fjlrbzawogdkbhwkwkci-1osi.png"><br><br>  كل شيء بسيط جدا هنا.  يصبح لدينا كود التعريفي ، وتعقيد عدم التزامن يذهب إلى مكان ما.  الشيء الرئيسي هو تعلم هؤلاء المشغلين. <br><br><img src="https://habrastorage.org/webt/mi/oc/ev/miocevejr1in0eyfg30wqmozb10.png"><br><br>  هذه هي الطريقة التي نعمل بها مع وحدة واجهة برمجة التطبيقات.  أردت أن تكون وحدة واجهة برمجة التطبيقات بسيطة قدر الإمكان.  عند الحديث عن JS ، يعتقد الكثير من الناس أنه من الصعب ، عليك الصعود إلى مكان ما ، وتعلم شيء ما.  وأردت أن أبسط الأمر قدر الإمكان: كل شيء في المنطقة العالمية ، لا يوجد سوى نطاق واجهة برمجة تطبيقات الوحدة ، لا شيء أكثر من ذلك.  كل شيء لإدارة وحدة ، حتى الإكمال التلقائي. <br><br><img src="https://habrastorage.org/webt/nl/-c/v8/nl-cv8_2s_3134omu8mqeanuiis.png"><br><br>  [الشريحة 15:20] يقترح الحل نفسه أن كل هذا يمكن أن يتم دفعه إلى الممنوع للغاية من خلال العبارة.  دعونا نفهم لماذا ممنوع. <br><br>  الحقيقة هي أنه مع مشاكله.  على سبيل المثال ، مع ، للأسف ، يتم تسريبه خارج النطاق الذي ألقينا فيه ، لأنه يحاول أن يبدو أعمق من وحدة واجهة برمجة التطبيقات وينظر إلى النطاق العام. <br><br><img src="https://habrastorage.org/webt/tt/hw/gg/tthwggh1janwscz0t9poham_x44.png"><br>  هنا المثال الأخير رائع بشكل خاص ، لأنه حتى أربعة يمكن أن تكون خطرة على التعليمات البرمجية لدينا ، حيث يمكن تنفيذ جميع هذه الوظائف عن طريق رمز المستخدم.  يمكن للمستخدم القيام بأي شيء.  هذه لعبة للمبرمجين ، وهم يحبون استكشاف المشكلات وطرق اختراق شيء ما. <br><br><img src="https://habrastorage.org/webt/b4/e0/hb/b4e0hbfhxr1l7xn51miw-qk8bzk.png"><br><br>  كما قلت ، فإن النطاقات شديدة التسرب ، لذلك يتوفر نطاق عالمي دائمًا.  بغض النظر عن عدد النطاقات التي نضعها على الشفرة المخصصة لدينا ، وبغض النظر عن عدد النطاقات التي نلفها بها ، سيظل النطاق العالمي مرئيًا.  وكل ذلك بسبب مع. <br><br>  في الواقع ، إنه لا يعزل أي شيء ، إنه يضيف إلينا طبقة جديدة من التجريد ، نطاق عالمي جديد.  ولكن يمكننا تغيير هذا السلوك مع الوكيل. <br><br><img src="https://habrastorage.org/webt/zz/ed/qq/zzedqqwgeq-gxquunu4_ypeatak.png"><br><br>  الحقيقة هي أن الخادم الوكيل يعتني بكافة المكالمات التي نوجهها إلى الكائن الذي يتم إرساله عبر واجهة برمجة التطبيقات الجديدة ، ويمكننا التحكم في كيفية سلوك طلبات البيانات الجديدة في هذا الكائن. <br><br><img src="https://habrastorage.org/webt/1u/lh/xa/1ulhxahfzy_yahdczgj7jbmacaw.png"><br><br>  في الواقع ، مع الأعمال بكل بساطة.  عندما نطعمه نوعًا ما من المتغيرات ، يتحقق تحت الغطاء ما إذا كان هذا المتغير موجودًا في الكائن (أي أنه ينفذ المشغل) ، وإذا كان الأمر كذلك ، فسيتم تنفيذه في الكائن ، وإذا لم يكن كذلك ، فسيتم تنفيذه في النطاق العلوي ، في قضيتنا عالمية.  انها بسيطة جدا هنا.  الشيء الرئيسي الذي يساعدنا الوكيل هو أنه يمكننا تجاوز هذا السلوك. <br><br><img src="https://habrastorage.org/webt/c0/jg/ie/c0jgie64g9zgd4fukgnjadkj2g4.png"><br><br>  هناك شيء مثل السنانير في الوكيل.  شيء رائع يسمح لنا بالوكالة عن أي طلبات للكائن.  يمكننا تغيير سلوك طلب السمة ، وتغيير سلوك مهمة السمة ، والأهم من ذلك ، يمكننا تغيير سلوك هذا في عامل التشغيل.  هناك هوك ، والتي يمكننا العودة صحيحا فقط.  وبالتالي ، فإننا نأخذ وخدعنا تمامًا بياننا ، مما يجعل API أكثر أمانًا من ذي قبل. <br><br><img src="https://habrastorage.org/webt/4w/-n/vy/4w-nvyhnsledhvcyl0tetw33hvq.png"><br><br>  إذا حاولنا تشغيل eval () ، فسيسأل أولاً إذا كان هذا eval () موجودًا في unitApi ، فسوف يجيبون بـ "نعم" ويحصلون على "غير معرّفة ليست وظيفة".  يبدو أن هذه هي المرة الأولى التي أكون سعيدًا بهذا الخطأ!  هذا الخطأ هو بالضبط ما كان ينبغي أن نتلقاه.  أخذناها وأخبرنا المستخدم: "آسف ، انسوا كل شيء تعرفه عن كائن النافذة ، هذا لم يعد".  لقد تركنا بالفعل بعض المشاكل ، لكن هذا ليس كل شيء. <br><br><img src="https://habrastorage.org/webt/fo/yw/a2/foywa2mzbpbijvc3ndgpq-9tpxw.png"><br><br>  الحقيقة هي أن العبارة with هي نفسها من JS ، JS ديناميكية وغريبة بعض الشيء.  الشيء الغريب هو أنه لا يعمل كل شيء كما نود ، دون النظر في المواصفات.  والحقيقة هي أنه مع يعمل أيضا مع خصائص النموذج الأولي.  وهذا هو ، يمكننا أن يطعمه مبتذل مجموعة ، وتنفيذ هذا الرمز الغامض.  جميع وظائف المصفوفة متاحة كعمومية في هذا النطاق ، والتي تبدو غريبة بعض الشيء. <br><br><img src="https://habrastorage.org/webt/ih/2g/yr/ih2gyrz7isyixyvx7bswlamgvbe.png"><br><br>  هذا غير مهم بالنسبة لنا ، من المهم بالنسبة لنا أنه يمكن للمستخدم تنفيذ valueOf () والحصول على كل صندوق الحماية الخاص بنا.  خذ مباشرة والتقاط ، ونرى ما هو فيه.  لا أريد هذا أيضًا ، لذا تم تقديم شيء مثير للاهتمام في المواصفات: Symbol.unscopables.  هذا هو ، في المواصفات الجديدة للرموز ، تم تقديم Symbol.unscopables خصيصًا للبيان with ، وهو محظور.  لأنهم يعتقدون أن شخصًا آخر يستخدمه.  على سبيل المثال ، أنا! <br><br><img src="https://habrastorage.org/webt/fv/9o/ns/fv9ons58tbtnrnc5rp7biuexgfk.png"><br><br>  وبالتالي ، سنقوم بعمل اعتراض آخر ، حيث نتحقق بالتحديد لمعرفة ما إذا كان هذا الرمز في قائمة جميع سمات unscopables.  إذا لم يكن كذلك ، فأعده ، ولكن إذا كان الأمر كذلك ، فأسف ، لن نعود.  نحن لا نستخدمه أيضا.  وبالتالي ، مع أننا لا نستطيع حتى الحصول على نموذج أولي من رمل لدينا. <br><br><img src="https://habrastorage.org/webt/07/5h/tt/075httw1dt0ekhe37frcstztzri.png"><br><br>  لا يزال لدينا بيئة العمال.  هذا شيء معلق في منطقة عالمية ولا يزال الوصول إليه ممكنًا.  الحقيقة هي أنه إذا قمت ببساطة بتجاوز هذا ، فسيكون متاحًا في النموذج الأولي.  من خلال النموذج الأولي في JS ، يمكنك سحب أي شيء تقريبًا.  والمثير للدهشة أن كل هذه الأساليب لا تزال متاحة من خلال النموذج الأولي. <br><br><img src="https://habrastorage.org/webt/po/mt/fl/pomtflwlmxujubh-l8qzqqn2drg.png"><br><br>  كان علي أن آخذ كل هذا وتنظيفه.  نذهب من خلال جميع المفاتيح وتنظيف كل شيء. <br><br><img src="https://habrastorage.org/webt/zg/9k/at/zg9katqtaothaqjip6trmosdig0.png"><br><br>  ثم نترك بيضة عيد الفصح قليلاً للمستخدم ، الذي لا يزال يحاول استدعاء هذا.  نأخذ الوظيفة المعتادة ، الشيء الرئيسي ليس وظيفة السهم ، التي لها نطاق ، ونغير نطاقها إلى كائننا ، الذي نترك فيه بيضة عيد الفصح صغيرة لمستخدم فضولي بشكل خاص يريد عرض بعض هذا أو الذات في وحدة التحكم.  أعتقد أن بيض عيد الفصح رائع ويجب تركه في الكود. <br><br><img src="https://habrastorage.org/webt/_s/7r/fq/_s7rfqdggfjikj2rjm7rcmhwja8.png"><br><br>  اتضح كذلك أنهم تركوا فقط مع وحدة واجهة برمجة التطبيقات الخاصة بنا.  لقد حظرنا كل شيء تمامًا - في الواقع ، تركنا قائمة بيضاء.  نحتاج إلى إضافة واجهات برمجة التطبيقات (APIs) المفيدة والمطلوبة.  على سبيل المثال ، واجهة برمجة تطبيقات Math ، التي تحتوي على وظيفة عشوائية مفيدة يستخدمها العديد من الأشخاص عند كتابة التعليمات البرمجية للوحدات. <br><br>  نحتاج أيضًا إلى وحدة التحكم والعديد من الوظائف النفعية الأخرى التي لا تحمل أي وظيفة مدمرة.  نقوم بإنشاء قائمة من الوقت لواجهات برمجة التطبيقات الخاصة بنا.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هذا أمر جيد ، لأنه إذا أنشأنا قائمة سوداء ، فسنعتمد على أي تحديث للمتصفح يحدث دون علمنا. </font></font><br><br><img src="https://habrastorage.org/webt/nz/mc/0o/nzmc0or7a_svlqdlhcdg36_bzi8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">من خلال إنشاء قائمة بيضاء ، يمكننا البدء في استخدام try-catch في التعليمات البرمجية الخاصة بنا. </font><font style="vertical-align: inherit;">لدينا رمز ملفوف بالفعل يمسك الأخطاء ويمكن إرسالها إلى المستخدم ، وهو أمر مهم للغاية لتصحيح الأخطاء. </font></font><br><br><img src="https://habrastorage.org/webt/cl/pa/q1/clpaq1aarq_8svpxquxahgyrkym.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ولكن الحقيقة هي أن أساليب وحدة التحكم من Worker لا تظهر نفسها في رمز المستخدم. </font><font style="vertical-align: inherit;">أي إذا فتحت وحدة التحكم وانتقلت إلى بيئة العامل ، فستكون متاحة ، لكن سيكون من الخطأ إخبار المستخدم "افتح وحدة التحكم وشاهد ما حدث لك". </font><font style="vertical-align: inherit;">قررت إنشاء وحدة تحكم ودية للاعب ، حيث يمكن للاعب ، حتى بدون خبرة في JavaScript ، أن يرى بطريقة ودية ما حدث.</font></font><br><br>  ,    , -   .      ,     .      ,         webpack   . <br><br><img src="https://habrastorage.org/webt/cl/pa/q1/clpaq1aarq_8svpxquxahgyrkym.png"><br><br>      patchMethod(),     ,     postMessage().    postMessage()   console log, error, warn, info.        ,    .  ,       &lt;div&gt;,      ,    ,      ,     ,        . <br><br><img src="https://habrastorage.org/webt/nf/oq/yw/nfoqywkngugbgug6i5wwv_tpuhy.png"><br><br>     ,      .      : -   -  —   ,     ,  -     . , ,    promises.   ,        actions,       . <br><br><img src="https://habrastorage.org/webt/jl/np/2f/jlnp2fcxsgtmghti8wzt4iwzbki.png"><br><br>          actions.   ,     real-time ?   ,  real-time    workers    ,        worker,       .       - ,    .    ,    , .   ,      ,   .        . <br><br><img src="https://habrastorage.org/webt/lk/zb/xp/lkzbxpal1f_bkmcq1pyk5sto8ey.png"><br><br>     workers,       .  workers ,           .      ,   .  ,     ,    (   ,  ),            .  :    — . <br><hr><br><h2 style=";text-align:right;direction:rtl">  Math.random() </h2><br>   ,   ,         ,     .      Math.random(). <br><br>     ,   ,      ,                   .   ,  Math.random()     - . <br><br><img src="https://habrastorage.org/webt/g5/xs/zj/g5xszjwvqxhjxp4slm1hfmdfct4.png"><br><br>  ,     ,        (   ), JS   ,        .         . <br><br><img src="https://habrastorage.org/webt/ds/ic/sy/dsicsy7ra1vb8fuzq6xkry7y9zg.png"><br><br>   ,              ,  ,          .       ,    - . <br><br>            ,      . ,        random(),     . <br><br><img src="https://habrastorage.org/webt/cp/ew/ou/cpewoullokdb8p903gddmmgguj8.png"><br><br>  ,  random()     —  « »      ,      .    ,    -  ,     random() ,       .    -    ,     .   ,          ,  random()    . <br><br><img src="https://habrastorage.org/webt/hu/tp/ot/hutpotesuqtwdc_p7yqelekwpjk.png"><br><br>       .    ,   ,   random()  .   - seed          (  ,        ,   ). <br><br><img src="https://habrastorage.org/webt/of/xs/da/ofxsdamysx7gcyfjgctqw1o72o0.png"><br>     ,     .            ,      random().                  ,  random()     -. <br><br>  <a href=""></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هناك حاجة إلى جميع التعليمات البرمجية التي يتم إرسالها إلى العامل لجعل JS آمنة تماما. </font><font style="vertical-align: inherit;">البرتقالي "إدراج" هو نفس رمز المستخدم. </font><font style="vertical-align: inherit;">الذي يتم حقنه هناك. </font><font style="vertical-align: inherit;">هذا هو مقدار الكود الذي تحتاجه لجعل JS آمنة. </font><font style="vertical-align: inherit;">يتم حقن Random () وواجهة برمجة التطبيقات للوحدة أيضًا هناك. </font><font style="vertical-align: inherit;">من خلال الحقن ، أحصل على مزيد من الشفرة التي يتم إرسالها إلى العامل.</font></font><br><hr><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مشاركة الدولة: RxJS والخادم والعملاء </font></font></h2><br>  لذلك اكتشفنا ما لدينا مع العميل.  الآن دعنا نتحدث عن مشاركة الدولة ، لماذا هناك حاجة لذلك وكيف تم تنظيمها.  لدينا حالة مخزنة على الخادم ، يجب على الخادم أن يتعثر مع العملاء المتصلين.  [الشريحة 28:48] <br><br>  لدينا أربعة أدوار لعملاء مختلفين يمكنهم الاتصال بالخادم: "المستخدم الأيسر" ، "المستخدم الصحيح" ، المشاهد الذي ينظر إلى الشاشة الرئيسية ، ومسؤول يمكنه فعل أي شيء. <br><br>  لا يمكن للشاشة اليسرى تغيير حالة المشغل الصحيح ، ولا يمكن للمشاهد تغيير أي شيء ، ويمكن للمشرف فعل كل شيء. <br><br><img src="https://habrastorage.org/webt/qo/nw/xz/qonwxz54aiudwbywh6msiilucss.png"><br><br>  لماذا كانت هذه مشكلة؟  كل شيء مرتب بكل بساطة.  يمكن لأي عميل متصل إلقاء جلسة ، ويقبله الخادم ويدخل في الحالة ، وهو موجود داخل الخادم ثم يوزعه على جميع العملاء.  إنه يتحسس لأي تغييرات تأتي إليه.  كان من الضروري تصفية ذلك بطريقة أو بأخرى. <br><br><img src="https://habrastorage.org/webt/th/ol/vu/tholvuuygb9shbr5-de-aemuxs8.png"><br><br>  أولاً ، سأقول لماذا يحتوي الخادم أيضًا على RxJS.  تصبح جميع التفاعلات مع اثنين أو أكثر من المستخدمين المتصلين غير متزامنة.  يجب أن ننتظر النتائج من كلا المستخدمين.  على سبيل المثال ، نقر المستخدمون على الزر "إنهاء" ، وعليك الانتظار حتى ينقر كلاهما ، ثم فقط تنفيذ الإجراء.  كان كل شيء واضحًا جدًا على RxJS بهذه الطريقة: <br><br><img src="https://habrastorage.org/webt/xa/dp/6z/xadp6zds6_xaucjyb7hdrpskcmu.png"><br><br>  نحن نعمل مرة أخرى مع المواضيع ، هناك تيار من المقبس ، والذي يسمى المقبس.  لإنشاء مؤشر ترابط واحد يراقب اللاعب الأيسر فقط ، نحن ببساطة نأخذ ونرشح الرسائل من هذا المقبس بواسطة اللاعب الأيسر (وبالمثل مع اليمين).  بعد ذلك ، يمكننا دمجها باستخدام عامل التشغيل forkJoin () ، والذي يعمل مثل Promise.all () وهو التناظرية.  ننتظر كلا الإجراءين ونستدعي طريقة setState () ، والتي تحدد حالتنا على "جاهزة".  اتضح أننا ننتظر اللاعبين ونغير حالة الخادم.  في RxJS ، يظهر هذا التصريح قدر الإمكان ، وهذا هو سبب استخدامه. <br><br>  لا تزال هناك مشكلة في حقيقة أن اللاعبين يمكنهم تغيير حالة بعضهم البعض.  يجب أن يحظر عليهم القيام بذلك.  لا يزال ، هم المبرمجين ، كانت هناك سوابق حاول شخص ما.  لنقم بإنشاء فصول منفصلة لهم موروثة من العميل. <br><br><img src="https://habrastorage.org/webt/jz/9-/6v/jz9-6vskw2b3lqcf3fxasd2w4kq.png"><br><br>  سيكون لديهم المنطق الأساسي لاتصال اللاعب بالخادم ، وفي كل فصل سيكون هناك منطقه المخصص لتصفية البيانات. <br><br>  العميل هو في الواقع مجموعة من الاتصالات ، اتصالات مع العملاء. <br><br><img src="https://habrastorage.org/webt/sc/qz/kl/scqzklyflx8hylw3stj7drudpdy.png"><br><br>  إنه يخزنهم فقط ولديه دفق onUnsafeMessage ، وهو أمر غير آمن تمامًا: لا يمكن الوثوق به ، فهذه مجرد رسائل أولية من المستخدم الذي يتلقاه.  نكتب هذه الرسائل الأولية إلى الدفق. <br><br>  علاوة على ذلك ، عند تطبيق لاعب معين ، فإننا نأخذ هذا onUnsafeMessage ونصفه. <br><br><img src="https://habrastorage.org/webt/yn/z0/1k/ynz01kbib00wt83k_5jwx5ix3ku.png"><br><br>  نحتاج فقط إلى تصفية البيانات التي يمكننا الحصول عليها من هذا اللاعب ، الذي يمكننا الوثوق به.  يمكن للاعب الأيسر تغيير حالة اللاعب الأيسر فقط ، على التوالي ، نأخذ من جميع البيانات التي يمكن أن يرسلها ، فقط حالة اللاعب الأيسر.  إذا لم ترسلها ، حسنًا.  إذا أرسلت - نحن نأخذ.  وبالتالي ، من الرسائل غير الآمنة تمامًا ، نحصل على رسائل آمنة يمكننا الوثوق بها عند العمل في الغرفة. <br><br><img src="https://habrastorage.org/webt/g3/-a/dg/g3-adglwnncvagey8nojzmksixw.png"><br><br>  لدينا غرف ألعاب تجمع اللاعبين.  داخل الغرفة ، يمكننا كتابة الوظائف ذاتها التي يمكن أن تتغير حالتها مباشرةً ، ببساطة عن طريق الاشتراك في هذه التدفقات ، والتي يمكننا الوثوق بها بالفعل.  نحن المستخرجة من مجموعة من الشيكات.  لقد قمنا بالتحققات بناءً على الأدوار ، ودعونا بفصول منفصلة.  قمنا بتقسيم الكود بطريقة أنه داخل وحدة التحكم ، حيث يتم تنفيذ الوظائف المهمة لتغيير الحالة ، أصبح الكود بسيطًا وتوضيحيًا قدر الإمكان. <br><br>  يستخدم RxJS أيضًا على العميل ، وهو متصل بالمقبس على الجانب الخلفي ، ويصدر الأحداث ويعيد توجيهها بكل طريقة. <br><br>  في هذه الحالة ، أود أن أقدم مثالاً عندما أحتاج إلى تغيير جيش الخصم الصحيح. <br><br><img src="https://habrastorage.org/webt/qf/u8/oy/qfu8oy7syyrcekd2z424rxuhplw.png"><br><br>  للاشتراك فيه ، نقوم بإنشاء دفق من نفس المقبس وتصفيته.  نتأكد من أن هذا هو اللاعب المناسب حقًا ، ونأخذ رسالة منه حول ماهية جيشه.  إذا لم تكن هناك رسالة من هذا القبيل ، فلن يُرجع الدفق أي شيء ، ولن تكون هناك رسالة واحدة فيه ، وستظل صامتة حتى يغير اللاعب الجيش.  نحن على الفور حل مشكلة تصفية الأحداث ، ليس لدينا هو مبتذل. <br><br>  وعندما يأتي شيء بالفعل من الدفق ، فإننا ندعو وظيفة setState ().  هذا بسيط للغاية ، وهو النهج الذي يسمح لنا بالقيام بكل شيء بشفافية وإعلانية.  الشيء ذاته الذي أخذت منه مشروع RxJS وما ساعدني كثيرًا. <br><br><img src="https://habrastorage.org/webt/gy/p9/qc/gyp9qchh3hadurc4_vmg0vjj1u4.png"><br><br>  أقوم بإنشاء تدفقات قمت بتسميةها بوضوح تام ، والتي أفهمها كيف أعمل ، كل شيء تعريفي ، يتم استدعاء الوظائف الضرورية ، لا يوجد أي ضجة مع الكثير من أحداث if وفلترة ، كل ذلك يتم بواسطة RxJS. <br><br><h2 style=";text-align:right;direction:rtl">  التاريخ: من لاعب واحد إلى لاعبين متعددين </h2><br><br>  لذلك ، تم كتابة الإصدار الأول من لعبتي.  يمكننا القول أنه كان لاعبًا واحدًا ، لأنه لا يمكن تشغيله إلا لاعبين اثنين ، تم إصلاح عدد العملاء المتصلين.  كان لدينا لاعب يسار ولاعب الأيمن وشاشة خلفه ، كل هذا متصل مباشرة بالخادم.  كان كل شيء مشدودًا ، لكن خلال ثلاثة أسابيع تم القيام به. <br><br>  تلقيت عرضًا جديدًا: لتوسيع اللعبة لجميع المبرمجين في الشركة حتى يتمكنوا من فتحها وتشغيلها على أجهزة الكمبيوتر الخاصة بهم.  حتى نحصل على قائمة من القادة ، متعددة اللاعبين حتى يتمكنوا من اللعب معًا.  ثم أدركت أن لدي الكثير من إعادة البناء. <br><br><img src="https://habrastorage.org/webt/qy/vs/-k/qyvs-khwziiaiv8xyfsnvcrlark.png"><br><br>  اتضح أنها ليست صعبة للغاية.  لقد قمت ببساطة بدمج جميع الكيانات التي كنت أمتلكها في غرف منفصلة.  حصلت على جوهر "الغرفة" ، والتي يمكن أن تجمع بين جميع الأدوار.  الآن ليس اللاعبون أنفسهم هم الذين يتصلون مباشرة بالخادم ، ولكن الغرف.  تحتوي الغرف بالفعل على طلبات مباشرة إلى الخادم ، لتحل محل الحالة ، وأصبحت الولاية منفصلة لكل غرفة. <br><br><img src="https://habrastorage.org/webt/cc/au/tt/ccautts_bfhkftuja4joqqeg9vm.png"><br><br>  لقد أخذت وأعدت كتابة كل شيء ، أضفنا قائمة من القادة ، لقد منحنا الأفضل بجوائز.  كان من الضروري وجود عدد كبير من المستخدمين ، كان من المستحيل بالفعل متابعة الجميع ، كان من الضروري أن تكتب شيئًا لتجمع فيه جميع البيانات. <br><br><h2 style=";text-align:right;direction:rtl">  شبيبة Gamedev ومشاكله </h2><br><br>  وهكذا ، أصبحت أكثر معرفة جدية مع JS-gamedev.  قمت بحركة حول المشروع الأخير لمدة ثلاث سنوات ، واستريح بشكل دوري.  وهنا كان لدي كل مرة لمدة ثلاثة أسابيع.  جلست كل يوم وفعلت شيئًا في المساء. <br><br>  ما هي المشاكل الموجودة في تطوير الألعاب على JS؟  يختلف كل شيء عن تطبيقات أعمالنا ، حيث لا تشكل مشكلة في كتابة شيء ما من نقطة الصفر.  علاوة على ذلك ، فإن الكثير منها مرحب به: سنقوم بعملنا الخاص ، ونتذكر القصص مع NPM والجزء الأيسر بنفسك. <br><br><img src="https://habrastorage.org/webt/f6/6l/zc/f66lzct-hy9vzyyixqvuplcd2qk.png"><br><br>  من المستحيل القيام بذلك في JS Gamedev ، لأن جميع تقنيات عرض الرسومات منخفضة للغاية لدرجة أنه من غير المربح اقتصاديًا كتابة شيء عليها.  إذا استخدمت هذه اللعبة وبدأت في كتابتها من نقطة الصفر على WebGL ، فسأجلس خلفها لمدة ستة أشهر فقط ، وأحاول فقط اكتشاف بعض الأخطاء الغريبة.  محرك اللعبة الأكثر شعبية فيزر إزالة هذه المشاكل مني ... <br><br><img src="https://habrastorage.org/webt/x1/zs/aa/x1zsaafnaxys0r9tssldvcper38.png"><br><br>  ... وأضفت جديدة إلي: 5 ميغابايت في حزمة.  ولا يمكن القيام بشيء حيال ذلك ؛ فهو لا يعرف ماهية تهجم الأشجار على الإطلاق.  علاوة على ذلك ، يمكن فقط لأحدث إصدار من Phaser العمل مع حزم الويب والحزم.  قبل ذلك ، كان متصلاً Phaser فقط في علامة html للنص ، كان غريباً بالنسبة لي. <br><br>  لقد جئت من جميع أنواع البرامج النصية webpacks ، وفي لعبة JS dev ، لا يمكن لأي شيء تقريبًا فعل ذلك.  تحتوي جميع الوحدات النمطية على طباعة رديئة للغاية أو لا تملكها على الإطلاق ، أو أساسًا لا تعرف كيفية استخدام حزمة الويب ، كان من الضروري إيجاد طرق لفها.  كما اتضح ، حتى Ace Editor بشكله النقي لا يعمل مع webpack على الإطلاق.  لبدء العمل ، تحتاج إلى تنزيل حزمة منفصلة حيث يتم لفها بالفعل (دعامة). <br><br>  كان الأمر على نفس المنوال مع Phaser ، لكن في الإصدار الجديد ، فعلوا ذلك بشكل طبيعي أكثر أو أقل.  واصلت الكتابة على Phaser ووجدت كيف أجعل كل شيء يعمل مع حزمة الويب بالطريقة التي اعتدنا عليها: يمكن ربط كل من الاختبارات والاختبارات بكل هذا.  لقد وجدت أنه يمكنك أن تأخذ <a href="">PixiJS</a> بشكل منفصل ، وهو عبارة عن عرض webpack ، والعثور على الكثير من الوحدات الجاهزة للعمل معها. <br><br><img src="https://habrastorage.org/webt/cz/cf/o7/czcfo7ib3-d7n3w-l1rpzxfo8cw.png"><br><br>  PixiJS هي مكتبة رائعة يمكن عرضها إما على WebGL أو على Canvas.  علاوة على ذلك ، يمكنك كتابة الكود كما لو كان Canvas ، وسوف يتم عرضه في WebGL.  يمكن أن تقدم هذه المكتبة ثنائية الأبعاد بسرعة كبيرة.  الشيء الرئيسي هو معرفة كيفية عملها مع الذاكرة ، حتى لا تقع في موقف عندما انتهت الذاكرة. <br><br>  أوصي بشكل منفصل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بمخزن رائع - pixijs</a> على GitHub ، حيث يمكنك العثور على وحدات مختلفة.  الأهم من ذلك كله أنني أحب <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">React-pixi</a> .  يمكننا ببساطة تجاهل حل المشكلات في طريقة العرض عندما نكتب وظائف حتمية مباشرة في وحدة التحكم لرسم الأشكال الهندسية والعفاريت والرسوم المتحركة والمزيد.  يمكننا جميع العلامات في JSX.  لقد جئنا من عالم JSX من خلال تطبيق أعمالنا ويمكننا استخدامه أكثر.  هذا هو ما أحب التجريد ل.  React-pixi يعطينا هذا التجريد المألوف. <br><br>  كما أنصحك أن تأخذ tween.js - نفس محرك الرسوم المتحركة الشهير من Phaser ، والذي يسمح لك بعمل رسوم متحركة إرشادية تشبه إلى حد ما الرسوم المتحركة لـ CSS: نحن ننتقل بين الولايات ، ونقرر tween.js لنا بالضبط كيفية تحريك الكائن. <br><br><h2 style=";text-align:right;direction:rtl">  أنواع اللاعبين: من هم وكيفية تكوين صداقات معهم </h2><br>  صادفت لاعبين مختلفين ، وأود أيضًا أن أخبركم عن اختبار اللعبة.  جمعت زملائي في غرفة واحدة مغلقة ولم أسمح لهم بالخروج حتى ينتهيوا من اللعبة.  لسوء الحظ ، لم يتمكن الجميع من إنهاء اللعبة ، لأنه في البداية كان لدي الكثير من الأخطاء.  لحسن الحظ ، بدأت في الاختبار بمجرد ظهور بعض النماذج الأولية للعمل.  بصراحة ، فشل الاختبار الأول لأن اثنين من اللاعبين لم يبدأوا بأي شيء.  كان ذلك عارًا ، لكنه أعطاني ركلة سمحت لي بالمضي قدمًا. <br><br>  عندما تكون لعبتك جاهزة ، يمكنك استلامها جيدًا ، أو باستخدام رصيف مشعل ومشاعل.  جميع الناس ينتظرون نوعًا من المعجبين بالألعاب ، في انتظار السعادة التي ستعطيها لهم.  وأنت تعطيهم شيئًا لا يعمل على الإطلاق ، رغم أنه يبدو أنه يعمل من أجلك.  عندما يكون لديك لعبة على الإنترنت ، فهناك المزيد من الأخطاء. <br><br>  نتيجةً لذلك ، فإن أكثر الأشخاص اللطيفين الذين قابلتهم هم "باحثون" يجدون دائمًا في لعبتك أكثر مما هو في الحقيقة.  يمكنهم استكمالها بكل سرور بكل أنواع الأشياء الصغيرة ، مما يدفعك إلى إضافة شيء ما.  ولكن لسوء الحظ ، فإن التواصل مع هؤلاء الأشخاص لم يعطِ شيئًا مهمًا - استقرار اللعبة. <br><br>  هناك لاعبون عاديون يأتون فقط من أجل المعجبين.  قد لا يلاحظون في بعض الأحيان أخطاء ، يتسللون بطريقة ما من خلالهم في طريقهم إلى المتعة. <br><br>  فئة أخرى هي جامعي الأخطاء ، حيث لا يعمل كل شيء تقريبًا.  يجب أن تكون صديقًا لهؤلاء الأشخاص ، رغم أنهم سيتحدثون كثيرًا عن السلبية.  نحتاج إلى إقامة علاقات غريبة معهم: إنها تؤذيك ، وتحاول أن تأخذ شيئًا مفيدًا لنفسك منها ، "دعنا نجلس على الكمبيوتر ونرى".  تحتاج إلى العمل معهم ، لأنه في النهاية هؤلاء الأشخاص هم الذين سيجعلون جودة لعبتك. <br><br>  تحتاج إلى اختبار فقط على الناس الأحياء.  عينيك غير واضحة ، وسيظهر الاختبار بالتأكيد ما هو مخفي.  أنت تقوم بتطوير لعبة والغطس بشكل أعمق ، مع رؤية بعض الميزات ، لكن قد لا تكون هناك حاجة إليها.  تذهب مباشرة إلى مستهلكيك ، اعرضهم وشاهد كيف يلعبون ، أي المفاتيح يضغطون عليها.  يمنحك هذا حافزًا للقيام بما تحتاجه بالضبط.  سترى أن بعض الأشخاص يضغطون باستمرار على Ctrl + S ، لأنهم معتادون على حفظ الكود - حسنًا ، على الأقل لجعل الكود يعمل على Ctrl + S ، سيشعر اللاعب بمزيد من الراحة.  تحتاج إلى تهيئة بيئة مريحة للاعب ، لذلك عليك أن تحبه وتتبعه. <br><br>  تعمل القاعدة 80/20: أنت تقدم عرضًا تجريبيًا بنسبة 20٪ من الوقت من التطوير الكامل للعبة ، ويبدو أنها لعبة مكتملة بنسبة 80٪ بالنسبة للاعب.  يعمل الإدراك بحيث تكون الميكانيكا الأساسية جاهزة ، وكل شيء يتحرك ويعمل ، مما يعني أن اللعبة جاهزة تقريبًا ، وسيعمل المطور على الانتهاء منها قريبًا.  ولكن في الواقع ، لا يزال لدى المطور طريقة للخروج من 80 ٪.  كما قلت ، لفترة طويلة كان عليّ أن أعمل على التوثيق بحيث يكون مفهومًا للجميع.  لقد أوضحت ذلك للعديد من الأشخاص الذين تحدثوا عن تعليقاتهم ، قمت بتصفيتها ، محاولين فهم جوهر البيانات.  وكثير من الوقت استغرق مني البحث عن الأخطاء. <br><br>  لذا في تطوير اللعبة ، يمكنني أن أنصحك فقط بالقيام بالعروض التوضيحية: فهي تسعد الجميع ، ولا تتطلب الكثير من الوقت ، ولا يتوقع أحد حقًا أي شيء من العروض.  تعتبر عملية إنهاء الألعاب عملية مملة ، ولكن البدء أمر رائع. <br><br>  أخيرًا ، أتركك روابط: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع مع لعبة وتعليمات التشغيل</a> (سأكون سعيدًا بتجميع الطلبات إذا وجدت أخطاء) </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">فيزر</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">رهيبة - pixijs</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Colyseus multiplayer game server</a> (لقد كتبت بنفسي multiplayer ، ثم رأيت خادم مكتمل مع غرف) </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ايس المحرر</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">عرض هذا التقرير</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مؤتمرات باللغة الروسية التي يمكنك تقديم تقرير إليها</a> </li></ul><br><blockquote style=";text-align:right;direction:rtl">  <b>سوف يعقد HolyJS 2019 Piter</b> ، وهو مؤتمر لمطوري جافا سكريبت ، يومي 24 و 25 مايو في سان بطرسبرغ.  وقد ظهرت بالفعل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أول المتحدثين</a> على الموقع. <br>  يمكنك أيضًا تقديم طلب للحصول على تقرير ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Call for Papers</a> مفتوح حتى 11 مارس. <br>  سترتفع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أسعار</a> التذاكر في 1 فبراير. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar436586/">https://habr.com/ru/post/ar436586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar436568/index.html">منصة الفيديو الخاصة أو كيفية الحصول على الكثير من موارد الحوسبة. الجزء 1</a></li>
<li><a href="../ar436570/index.html">طرد مبرمج</a></li>
<li><a href="../ar436572/index.html">تحدي سكولكوفو للأمن السيبراني 2019 مسابقة مشروع الأمن السيبراني</a></li>
<li><a href="../ar436578/index.html">سعر الأمان الشخصي لمديري شركات تكنولوجيا المعلومات الكبرى في السنة</a></li>
<li><a href="../ar436584/index.html">قانون إدارة Runet - تنفيذ الأحكام ومجالات المسؤولية</a></li>
<li><a href="../ar436588/index.html">MegaSlerm في موسكو في أوائل يونيو: الإعلان الأول والخصومات</a></li>
<li><a href="../ar436590/index.html">نصائح لعميل وظيفي. اضغط على Δ لقراءة</a></li>
<li><a href="../ar436592/index.html">الخلفية في VueJS مكونات ملف واحد</a></li>
<li><a href="../ar436594/index.html">وداعا تشيفي فولت: قصص وأساطير الهجين القابلة لإعادة الشحن</a></li>
<li><a href="../ar436596/index.html">مطورون مكدس كامل في الواقع عالقون في المستوى المتوسط. تجنب نفسك من المعاناة - لا تسلك هذا الطريق</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>