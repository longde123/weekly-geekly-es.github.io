<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐จ๐ฟโ๐คโ๐จ๐ป ๐ฉ๐ฟโ๐คโ๐ฉ๐พ ๐ Spark SQL. ููููุง ุนู ูุญุณู ุงูุงุณุชุนูุงู ๐จ๐ฟโ๐ป ๐๏ธ ๐ฅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ุจุงูุฌููุน. ูููุฏูุฉ ุ ุฃูุฏ ุฃู ุฃุฎุจุฑูู ููู ุฌุฆุช ุฅูู ูุซู ูุฐู ุงูุญูุงุฉ. 



 ูุจู ุงูุงุฌุชูุงุน ูุน Big Data ู Spark ุ ุนูู ูุฌู ุงูุฎุตูุต ุ ูุงู ูุฏู ุงููุซูุฑ ูุบุงูุจุงู ูุชุญุณ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Spark SQL. ููููุง ุนู ูุญุณู ุงูุงุณุชุนูุงู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neoflex/blog/417103/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฑุญุจุง ุจุงูุฌููุน.  ูููุฏูุฉ ุ ุฃูุฏ ุฃู ุฃุฎุจุฑูู ููู ุฌุฆุช ุฅูู ูุซู ูุฐู ุงูุญูุงุฉ. <br></p><br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุงุฌุชูุงุน ูุน Big Data ู Spark ุ ุนูู ูุฌู ุงูุฎุตูุต ุ ูุงู ูุฏู ุงููุซูุฑ ูุบุงูุจุงู ูุชุญุณูู ุงุณุชุนูุงูุงุช SQL ุ ุฃููุงู ูู MSSQL ุ ุซู ูู Oracle ุ ูุงูุขู ุตุงุฏูุช SparkSQL. <br></p><br><p style=";text-align:right;direction:rtl">  ูุฅุฐุง ูุงู ููุงู ุจุงููุนู ุงููุซูุฑ ูู ุงููุชุจ ุงูุฌูุฏุฉ ูู DBMS ุงูุชู ุชุตู ุงููููุฌูุฉ ู "ุงูุฃููุงู" ุงูุชู ููููู ุชุญุฑูููุง ููุญุตูู ุนูู ุฎุทุฉ ุงูุงุณุชุนูุงู ุงููุซูู ุ ูุนูุฏุฆุฐ ูู ุฃุฑ ูุซู ูุฐู ุงููุชุจ ูู Spark.  ููุฏ ุตุงุฏูุช ุงููุฒูุฏ ูู ุงูููุงูุงุช ููุฌููุนุงุช ุงูููุงุฑุณุงุช ุ ูุงูุชู ุชุชุนูู ุฃูุซุฑ ุจุงูุนูู ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช RDD / Dataset ุ ุจุฏูุงู ูู SQL ุฎุงูุต.  ุจุงููุณุจุฉ ูู ุ ุฃุญุฏ ุงููุชุจ ุงููุฑุฌุนูุฉ ุญูู ุชุญุณูู SQL ูู ูุชุงุจ J. Lewis ุ Oracle.  ุฃุณุงุณูุงุช ุชุญุณูู ุงูุชูููุฉ ".  ุจุญุซุช ุนู ุดูุก ููุงุซู ูู ุนูู ุงูุฏุฑุงุณุฉ.  ููุงุฐุง ูุงู ููุถูุน ุงูุจุญุซ ุจุงูุชุญุฏูุฏ SparkSQL ุ ูููุณ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฃุณุงุณูุฉุ  ุซู ูุงู ุณุจุจ ุงูุงูุชูุงู ููุฒุงุช ุงููุดุฑูุน ุงูุฐู ุฃุนูู ุนููู. <br></p><br><img src="https://habrastorage.org/webt/po/1f/un/po1fun6vgbktou6lykepwmrncci.jpeg"><br><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุฃุญุฏ ุนููุงุฆูุง ุ ุชุนูู ุดุฑูุชูุง ุนูู ุชุทููุฑ ูุณุชูุฏุน ุจูุงูุงุช ุ ูุทุจูุฉ ุชูุตูููุฉ ูููุง ูุฌุฒุก ูู ุญุงูุงุช ุงูุนุฑุถ ูู ูุฌููุนุฉ Hadoop ุ ูุญุงูุงุช ุงูุนุฑุถ ุงูููุงุฆูุฉ ูู Oracle.  ูุชุถูู ูุฐุง ุงููุดุฑูุน ุทุจูุฉ ุชุญููู ุจูุงูุงุช ูุงุณุนุฉ ุงููุทุงู ุ ูุงูุชู ูุชู ุชูููุฐูุง ุนูู Spark.  ูุชุณุฑูุน ุงูุชุทููุฑ ูุงูุงุชุตุงู ุจูุทูุฑู ETL ุงูุฐูู ููุณูุง ุนูู ุฏุฑุงูุฉ ุจุชุนููุฏุงุช ุชูููุงุช ุงูุจูุงูุงุช ุงููุจูุฑุฉ ุ ูููููู ุนูู ุฏุฑุงูุฉ ุจุฃุฏูุงุช SQL ู ETL ุ ุชู ุชุทููุฑ ุฃุฏุงุฉ ุชุฐูุฑ ุฃูุฏููููุฌูุงู ุฃุฏูุงุช ETL ุงูุฃุฎุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ Informatica ุ ูุชุณูุญ ูู ุจุชุตููู ุนูููุงุช ETL ุจุตุฑููุง ูุน ุงูุฌูู ุงูุชุงูู ููุฏ ุณุจุงุฑู.  ูุธุฑูุง ูุชุนููุฏ ุงูุฎูุงุฑุฒููุงุช ูุงูุนุฏุฏ ุงููุจูุฑ ูู ุงูุชุญูููุงุช ุ ูุณุชุฎุฏู ุงููุทูุฑูู ุจุดูู ุฃุณุงุณู ุงุณุชุนูุงูุงุช SparkSQL. <br></p><br><p style=";text-align:right;direction:rtl"> ูููุง ุชุจุฏุฃ ุงููุตุฉ ุ ุญูุซ ูุงู ุนููู ุฃู ุฃุฌูุจ ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูุฃุณุฆูุฉ ูู ุงููููุฐุฌ "ููุงุฐุง ูุง ูุนูู / ูุนูู ุงูุทูุจ ุจุจุทุก / ูู ูุนูู ุจุดูู ูุฎุชูู ุนู Oracleุ".  ุชุจูู ุฃู ูุฐุง ูู ุงูุฌุฒุก ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ุจุงููุณุจุฉ ูู: "ููุงุฐุง ูุนูู ุจุจุทุกุ".  ุนูุงูุฉ ุนูู ุฐูู ุ ุนูู ุนูุณ ูุธุงู ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช (DBMS) ุงูุฐู ุนููุช ูุนู ูู ูุจู ุ ููููู ุงูุฏุฎูู ุฅูู ุดูุฑุฉ ุงููุตุฏุฑ ูุงูุญุตูู ุนูู ุฅุฌุงุจุฉ ูุฃุณุฆูุชู. <br></p><cut text="    "></cut><br><h2 style=";text-align:right;direction:rtl">  ุงููููุฏ ูุงูุงูุชุฑุงุถุงุช </h2><br><p style=";text-align:right;direction:rtl">  ูุณุชุฎุฏู Spark 2.3.0 ูุชุดุบูู ุงูุฃูุซูุฉ ูุชุญููู ุดูุฑุฉ ุงููุตุฏุฑ. <br>  ูู ุงูููุชุฑุถ ุฃู ุงููุงุฑุฆ ุนูู ุฏุฑุงูุฉ ุจููุฏุณุฉ Spark ุ ูุงููุจุงุฏุฆ ุงูุนุงูุฉ ููุญุณู ุงูุงุณุชุนูุงู ูุฃุญุฏ ุฃูุธูุฉ DBMS.  ูุญุฏ ุฃุฏูู ุ ูุฌุจ ุฃูุง ุชููู ุนุจุงุฑุฉ "ุฎุทุฉ ุงูุงุณุชุนูุงู" ููุงุฌุฆุฉ ุจุงูุชุฃููุฏ. <br></p><br><p style=";text-align:right;direction:rtl">  ุฃูุถูุง ุ ูุง ุชุญุงูู ูุฐู ุงูููุงูุฉ ุฃู ุชุตุจุญ ุชุฑุฌูุฉ ูุดูุฑุฉ ููุญุณููู Spark ุฅูู ุงููุบุฉ ุงูุฑูุณูุฉ ุ ูุฐุง ุจุงููุณุจุฉ ููุฃุดูุงุก ุงููุซูุฑุฉ ููุงูุชูุงู ุฌุฏูุง ูู ูุฌูุฉ ูุธุฑ ุงูููุญุณููู ุ ูุงูุชู ูููู ูุฑุงุกุชูุง ูู ุดูุฑุฉ ุงููุตุฏุฑ ุ ุณูุชู ุฐูุฑูุง ููุชุฑุฉ ูุฌูุฒุฉ ููุง ูุน ุฑูุงุจุท ูููุฆุงุช ุงูููุงุจูุฉ. <br></p><br><h2 style=";text-align:right;direction:rtl">  ุงูุชูู ุฅูู ุงูุฏุฑุงุณุฉ </h2><br><p style=";text-align:right;direction:rtl">  ููุจุฏุฃ ุจุงุณุชุนูุงู ุตุบูุฑ ูุงุณุชูุดุงู ุงููุฑุงุญู ุงูุฃุณุงุณูุฉ ุงูุชู ููุฑ ูู ุฎูุงููุง ุงูุชุญููู ุงููุบูู ุฅูู ุงูุชูููุฐ. <br></p><br><pre style=";text-align:right;direction:rtl"><code class="scala hljs">scala&gt; spark.read.orc(<span class="hljs-string"><span class="hljs-string">"/user/test/balance"</span></span>).createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"bal"</span></span>) scala&gt; spark.read.orc(<span class="hljs-string"><span class="hljs-string">"/user/test/customer"</span></span>).createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"cust"</span></span>) scala&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> df = spark.sql(<span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">" | select bal.account_rk, cust.full_name | from bal | join cust | on bal.party_rk = cust.party_rk | and bal.actual_date = cust.actual_date | where bal.actual_date = cast('2017-12-31' as date) | "</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>) df: org.apache.spark.sql.<span class="hljs-type"><span class="hljs-type">DataFrame</span></span> = [account_rk: decimal(<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>), full_name: string] scala&gt; df.explain(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงููุญุฏุฉ ุงูุฑุฆูุณูุฉ ุงููุณุคููุฉ ุนู ุชุญููู SQL ูุชุญุณูู ุฎุทุฉ ุชูููุฐ ุงูุงุณุชุนูุงู ูู Spark Catalyst. <br></p><br><p style=";text-align:right;direction:rtl">  ูุชูุญ ูู ุงูุฅุฎุฑุงุฌ ุงูููุณุน ูู ูุตู ุฎุทุฉ ุงูุทูุจ (df.explain (true)) ุชุชุจุน ุฌููุน ุงููุฑุงุญู ุงูุชู ููุฑ ุจูุง ุงูุทูุจ: <br></p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฎุทุฉ ููุทููุฉ ูุญููุฉ - ุงุญุตู ุนูู ุจุนุฏ ุชุญููู SQL.  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุชู ุงูุชุญูู ูู ุตุญุฉ ุงููุญูู ููุทูุจ ููุท. </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs rust">== Parsed Logical Plan == <span class="hljs-symbol"><span class="hljs-symbol">'Project</span></span> [<span class="hljs-symbol"><span class="hljs-symbol">'bal</span></span>.account_rk, <span class="hljs-symbol"><span class="hljs-symbol">'cust</span></span>.full_name] +- <span class="hljs-symbol"><span class="hljs-symbol">'Filter</span></span> (<span class="hljs-symbol"><span class="hljs-symbol">'bal</span></span>.actual_date = cast(<span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">12</span></span>-<span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> date)) +- <span class="hljs-symbol"><span class="hljs-symbol">'Join</span></span> Inner, ((<span class="hljs-symbol"><span class="hljs-symbol">'bal</span></span>.party_rk = <span class="hljs-symbol"><span class="hljs-symbol">'cust</span></span>.party_rk) &amp;&amp; (<span class="hljs-symbol"><span class="hljs-symbol">'bal</span></span>.actual_date = <span class="hljs-symbol"><span class="hljs-symbol">'cust</span></span>.actual_date)) :- <span class="hljs-symbol"><span class="hljs-symbol">'UnresolvedRelation</span></span> `bal` +- <span class="hljs-symbol"><span class="hljs-symbol">'UnresolvedRelation</span></span> `cust`</code> </pre><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุฎุทุฉ ุงูููุทููุฉ ุงููุญููุฉ - ูู ูุฐู ุงููุฑุญูุฉ ุ ูุชู ุฅุถุงูุฉ ูุนูููุงุช ุญูู ูููู ุงูููุงูุงุช ุงููุณุชุฎุฏูุฉ ุ ููุชู ุงูุชุญูู ูู ูุฑุงุณูุงุช ุงููููู ูุงูุณูุงุช ุงููุทููุจุฉ. </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs delphi">== Analyzed Logical Plan == account_rk: decimal(<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>), full_name: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Project [account_rk<span class="hljs-string"><span class="hljs-string">#1</span></span>, full_name<span class="hljs-string"><span class="hljs-string">#59</span></span>] +- Filter (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = cast(<span class="hljs-number"><span class="hljs-number">2017</span></span>-<span class="hljs-number"><span class="hljs-number">12</span></span>-<span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> date)) +- Join Inner, ((party_rk<span class="hljs-string"><span class="hljs-string">#18</span></span> = party_rk<span class="hljs-string"><span class="hljs-string">#57</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span>)) :- SubqueryAlias bal : +- Relation[ACTUAL_END_DATE<span class="hljs-string"><span class="hljs-string">#0</span></span>,ACCOUNT_RK<span class="hljs-string"><span class="hljs-string">#1</span></span>,... <span class="hljs-number"><span class="hljs-number">4</span></span> more fields] orc +- SubqueryAlias cust +- Relation[ACTUAL_END_DATE<span class="hljs-string"><span class="hljs-string">#56</span></span>,PARTY_RK<span class="hljs-string"><span class="hljs-string">#57</span></span>... <span class="hljs-number"><span class="hljs-number">9</span></span> more fields] orc</code> </pre><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุฎุทุฉ ุงูููุทููุฉ ุงููุญุณูุฉ ูู ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ุจุงููุณุจุฉ ููุง.  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุชู ุชุญููู ุดุฌุฑุฉ ุงูุงุณุชุนูุงู ุงููุงุชุฌุฉ ุจูุงุกู ุนูู ููุงุนุฏ ุงูุชุญุณูู ุงููุชุงุญุฉ. </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs delphi">== Optimized Logical Plan == Project [account_rk<span class="hljs-string"><span class="hljs-string">#1</span></span>, full_name<span class="hljs-string"><span class="hljs-string">#59</span></span>] +- Join Inner, ((party_rk<span class="hljs-string"><span class="hljs-string">#18</span></span> = party_rk<span class="hljs-string"><span class="hljs-string">#57</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span>)) :- Project [ACCOUNT_RK<span class="hljs-string"><span class="hljs-string">#1</span></span>, PARTY_RK<span class="hljs-string"><span class="hljs-string">#18</span></span>, ACTUAL_DATE<span class="hljs-string"><span class="hljs-string">#27</span></span>] : +- Filter ((isnotnull(actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>)) &amp;&amp; isnotnull(party_rk<span class="hljs-string"><span class="hljs-string">#18</span></span>)) : +- Relation[ACTUAL_END_DATE<span class="hljs-string"><span class="hljs-string">#0</span></span>,ACCOUNT_RK<span class="hljs-string"><span class="hljs-string">#1</span></span>,... <span class="hljs-number"><span class="hljs-number">4</span></span> more fields] orc +- Project [PARTY_RK<span class="hljs-string"><span class="hljs-string">#57</span></span>, FULL_NAME<span class="hljs-string"><span class="hljs-string">#59</span></span>, ACTUAL_DATE<span class="hljs-string"><span class="hljs-string">#88</span></span>] +- Filter ((isnotnull(actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span>) &amp;&amp; isnotnull(party_rk<span class="hljs-string"><span class="hljs-string">#57</span></span>)) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>)) +- Relation[ACTUAL_END_DATE<span class="hljs-string"><span class="hljs-string">#56</span></span>,PARTY_RK<span class="hljs-string"><span class="hljs-string">#57</span></span>,... <span class="hljs-number"><span class="hljs-number">9</span></span> more fields] orc</code> </pre><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุฎุทุฉ ุงููุงุฏูุฉ - ุจุฏุฃุช ุชุคุฎุฐ ููุฒุงุช ุงููุตูู ุฅูู ุจูุงูุงุช ุงููุตุฏุฑ ูู ุงูุงุนุชุจุงุฑ ุ ุจูุง ูู ุฐูู ุงูุชุญุณููุงุช ูุชุตููุฉ ุงูุฃูุณุงู ูุงูุจูุงูุงุช ูุชูููู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุงุชุฌุฉ.  ุชู ุชุญุฏูุฏ ุงุณุชุฑุงุชูุฌูุฉ ุชูููุฐ ุงูุงูุถูุงู (ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุงูุฎูุงุฑุงุช ุงููุชุงุญุฉ ุ ุงูุธุฑ ุฃุฏูุงู). </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">== Physical Plan == *(<span class="hljs-number"><span class="hljs-number">2</span></span>) Project [account_rk#<span class="hljs-number"><span class="hljs-number">1</span></span>, full_name#<span class="hljs-number"><span class="hljs-number">59</span></span>] +- *(<span class="hljs-number"><span class="hljs-number">2</span></span>) BroadcastHashJoin [party_rk#<span class="hljs-number"><span class="hljs-number">18</span></span>, actual_date#<span class="hljs-number"><span class="hljs-number">27</span></span>], [party_rk#<span class="hljs-number"><span class="hljs-number">57</span></span>, actual_date#<span class="hljs-number"><span class="hljs-number">88</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">Inner</span></span>, BuildRight :- *(<span class="hljs-number"><span class="hljs-number">2</span></span>) Project [ACCOUNT_RK#<span class="hljs-number"><span class="hljs-number">1</span></span>, PARTY_RK#<span class="hljs-number"><span class="hljs-number">18</span></span>, ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">27</span></span>] : +- *(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Filter</span></span> isnotnull(party_rk#<span class="hljs-number"><span class="hljs-number">18</span></span>) : +- *(<span class="hljs-number"><span class="hljs-number">2</span></span>) FileScan orc [ACCOUNT_RK#<span class="hljs-number"><span class="hljs-number">1</span></span>,PARTY_RK#<span class="hljs-number"><span class="hljs-number">18</span></span>,ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">27</span></span>] Batched: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">Format</span></span>: ORC, <span class="hljs-keyword"><span class="hljs-keyword">Location</span></span>: InMemoryFileIndex[hdfs://<span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>:<span class="hljs-number"><span class="hljs-number">8020</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>/test/balance], PartitionCount: <span class="hljs-number"><span class="hljs-number">1</span></span>, PartitionFilters: [isnotnull(ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">27</span></span>), (ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">27</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>)], PushedFilters: [IsNotNull(PARTY_RK)], ReadSchema: struct&lt;ACCOUNT_RK:<span class="hljs-type"><span class="hljs-type">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>),PARTY_RK:<span class="hljs-type"><span class="hljs-type">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>)&gt; +- BroadcastExchange HashedRelationBroadcastMode(List(<span class="hljs-keyword"><span class="hljs-keyword">input</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-type"><span class="hljs-type">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">input</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-type"><span class="hljs-type">date</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>])) +- *(<span class="hljs-number"><span class="hljs-number">1</span></span>) Project [PARTY_RK#<span class="hljs-number"><span class="hljs-number">57</span></span>, FULL_NAME#<span class="hljs-number"><span class="hljs-number">59</span></span>, ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">88</span></span>] +- *(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Filter</span></span> isnotnull(party_rk#<span class="hljs-number"><span class="hljs-number">57</span></span>) +- *(<span class="hljs-number"><span class="hljs-number">1</span></span>) FileScan orc [PARTY_RK#<span class="hljs-number"><span class="hljs-number">57</span></span>,FULL_NAME#<span class="hljs-number"><span class="hljs-number">59</span></span>,ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">88</span></span>] Batched: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">Format</span></span>: ORC, <span class="hljs-keyword"><span class="hljs-keyword">Location</span></span>: InMemoryFileIndex[hdfs://<span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>:<span class="hljs-number"><span class="hljs-number">8020</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>/test/customer], PartitionCount: <span class="hljs-number"><span class="hljs-number">1</span></span>, PartitionFilters: [isnotnull(ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">88</span></span>), (ACTUAL_DATE#<span class="hljs-number"><span class="hljs-number">88</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>)], PushedFilters: [IsNotNull(PARTY_RK)], ReadSchema: struct&lt;PARTY_RK:<span class="hljs-type"><span class="hljs-type">decimal</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>),FULL_NAME:string&gt;</code> </pre><br><p style=";text-align:right;direction:rtl">  ุชุชุฌุงูุฒ ูุฑุงุญู ุงูุชุญุณูู ูุงูุชูููุฐ ุงูุชุงููุฉ (ุนูู ุณุจูู ุงููุซุงู ุ WholeStageCodegen) ูุทุงู ูุฐู ุงูููุงูุฉ ุ ูููู ุชู ูุตููุง ุจุชูุตูู ูุจูุฑ (ุจุงูุฅุถุงูุฉ ุฅูู ุงููุฑุงุญู ุงูููุถุญุฉ ุฃุนูุงู) ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Mastering Spark Sql</a> . <br></p><br><p style=";text-align:right;direction:rtl">  ุนุงุฏุฉู ูุง ุชุชู ูุฑุงุกุฉ ุฎุทุฉ ุชูููุฐ ุงูุงุณุชุนูุงู "ูู ุงูุฏุงุฎู" ู "ูู ุงูุฃุณูู ุฅูู ุงูุฃุนูู" ุ ุฃู ูุชู ุชูููุฐ ุงูุฃุฌุฒุงุก ุงูุฃูุซุฑ ุชุฏุงุฎููุง ุฃููุงู ุ ูุชุชูุฏู ุชุฏุฑูุฌููุง ุฅูู ุงูุฅุณูุงุท ุงูููุงุฆู ุงูููุฌูุฏ ูู ุงูุฃุนูู. <br></p><br><h2 style=";text-align:right;direction:rtl">  ุฃููุงุน ูุญุณูุงุช ุงูุงุณุชุนูุงู </h2><br><p style=";text-align:right;direction:rtl">  ูููู ุชูููุฒ ููุนูู ูู ูุญุณูุงุช ุงูุงุณุชุนูุงู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุณูุงุช ุชุณุชูุฏ ุฅูู ุงูููุงุนุฏ (RBOs). </li><li style=";text-align:right;direction:rtl">  ุงูููุญุณููููู ุจูุงุกู ุนูู ุชูุฏูุฑ ุชูููุฉ ุชูููุฐ ุงูุงุณุชุนูุงู (ููุญุณููู ูุงุฆู ุนูู ุงูุชูููุฉ ุ CBO). </li></ul><br><p style=";text-align:right;direction:rtl">  ุชุฑูุฒ ุงูููุงุนุฏ ุงูุฃููู ุนูู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ูู ุงูููุงุนุฏ ุงูุซุงุจุชุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุชุทุจูู ุดุฑูุท ุงูุชุฑุดูุญ ูู ุญูุซ ูู ุงููุฑุงุญู ุงููุจูุฑุฉ ุ ุฅู ุฃููู ุ ุญุณุงุจ ุงูุซูุงุจุช ุ ุฅูุฎ. <br></p><br><p style=";text-align:right;direction:rtl">  ูุชูููู ุฌูุฏุฉ ุงูุฎุทุฉ ุงููุงุชุฌุฉ ุ ูุณุชุฎุฏู ููุญุณููู CBO ุฏุงูุฉ ุชูููุฉ ุ ูุงูุชู ุชุนุชูุฏ ุนุงุฏุฉู ุนูู ูููุฉ ุงูุจูุงูุงุช ุงูููุนุงูุฌุฉ ุ ูุนุฏุฏ ุงูุตููู ุงูุชู ุชูุน ุชุญุช ุงููุฑุดุญุงุช ุ ูุชูููุฉ ุชูููุฐ ุนูููุงุช ูุนููุฉ. <br></p><br><p style=";text-align:right;direction:rtl">  ููุนุฑูุฉ ุงููุฒูุฏ ุนู ููุงุตูุงุช ุชุตููู CBO ูู Apache Spark ุ ูุฑุฌู ุงุชุจุงุน ุงูุฑูุงุจุท: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงุตูุงุช</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููุฉ JIRA ุงูุฑุฆูุณูุฉ ููุชูููุฐ</a> . <br></p><br><p style=";text-align:right;direction:rtl">  ููุทุฉ ุงูุจุฏุงูุฉ ูุงุณุชูุดุงู ูุฌููุนุฉ ูุงููุฉ ูู ุงูุชุญุณููุงุช ุงูุญุงููุฉ ูู ุฑูุฒ Optimizer.scala. <br></p><br><p style=";text-align:right;direction:rtl">  ูููุง ููู ููุชุทู ูุตูุฑ ูู ูุงุฆูุฉ ุทูููุฉ ูู ุงูุชุญุณููุงุช ุงููุชุงุญุฉ: <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl">def batches: Se<span class="hljs-string"><span class="hljs-string">q[Batch]</span></span> = { val operatorOptimizationRuleSet = Se<span class="hljs-string"><span class="hljs-string">q( // Operator push down PushProjectionThroughUnion, ReorderJoin, EliminateOuterJoin, PushPredicateThroughJoin, PushDownPredicate, LimitPushDown, ColumnPruning, InferFiltersFromConstraints, // Operator combine CollapseRepartition, CollapseProject, CollapseWindow, CombineFilters, CombineLimits, CombineUnions, // Constant folding and strength reduction NullPropagation, ConstantPropagation, ........</span></span></code> </pre><br><p style=";text-align:right;direction:rtl">  ูุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ูุงุฆูุฉ ูุฐู ุงูุชุญุณููุงุช ุชุชุถูู ููุง ูู ุงูุชุญุณููุงุช ุงููุณุชูุฏุฉ ุฅูู ุงูููุงุนุฏ ูุงูุชุญุณููุงุช ุงุณุชูุงุฏูุง ุฅูู ุชูุฏูุฑุงุช ุชูููุฉ ุงูุงุณุชุนูุงู ุ ูุงูุชู ุณูุชู ููุงูุดุชูุง ุฃุฏูุงู. <br></p><br><p style=";text-align:right;direction:rtl">  ุฅุญุฏู ููุฒุงุช CBO ูู ุฃูู ูู ุฃุฌู ุงูุชุดุบูู ุงูุตุญูุญ ุ ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ูุชุฎุฒูู ุงููุนูููุงุช ุญูู ุฅุญุตุงุฆูุงุช ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงูุงุณุชุนูุงู - ุนุฏุฏ ุงูุณุฌูุงุช ุ ุญุฌู ุงูุชุณุฌูู ุ ุงูุฑุณูู ุงูุจูุงููุฉ ูุชูุฒูุน ุงูุจูุงูุงุช ูู ุฃุนูุฏุฉ ุงูุฌุฏูู. <br></p><br><p style=";text-align:right;direction:rtl">  ูุฌูุน ุงูุฅุญุตุงุฆูุงุช ุ ูุฌููุนุฉ ูู ุฃูุงูุฑ SQL ANALYZE TABLE ... ูุชู ุงุณุชุฎุฏุงู ุฅุญุตุงุฆูุงุช ุงูููุจููุชุฑ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ุญุงุฌุฉ ุฅูู ูุฌููุนุฉ ูู ุงูุฌุฏุงูู ูุชุฎุฒูู ุงููุนูููุงุช ุ ูุชู ุชูููุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูู ุฎูุงู ExternalCatalog ุ ูุจุดูู ุฃูุซุฑ ุฏูุฉ ูู ุฎูุงู HiveExternalCatalog. <br></p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู CBO ูุนุทู ุญุงูููุง ุจุดูู ุงูุชุฑุงุถู ุ ูุณูุชู ุงูุชุฑููุฒ ุจุดูู ุฑุฆูุณู ุนูู ุงูุจุญุซ ุนู ุงูุชุญุณููุงุช ุงูุฏูููุฉ ูุงููุฑูู ุงูุฏูููุฉ ูู RBO. <br></p><br><h2 style=";text-align:right;direction:rtl">  ุฃููุงุน ูุงุฎุชูุงุฑ ุงุณุชุฑุงุชูุฌูุฉ ุงูุงูุถูุงู </h2><br><p style=";text-align:right;direction:rtl">  ูู ูุฑุญูุฉ ุชุดููู ุงูุฎุทุฉ ุงููุงุฏูุฉ ูุชูููุฐ ุงูุทูุจ ุ ูุชู ุงุฎุชูุงุฑ ุงุณุชุฑุงุชูุฌูุฉ ุงูุงูุถูุงู.  ุงูุฎูุงุฑุงุช ุงูุชุงููุฉ ูุชุงุญุฉ ุญุงูููุง ูู Spark (ููููู ุจุฏุก ุชุนูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู SparkStrategies.scala). <br></p><br><h3 style=";text-align:right;direction:rtl">  ุฑุจุท ุชุฌุฒุฆุฉ ุงูุจุซ </h3><br><p style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑ ุงูุฃูุถู ูู ุฅุฐุง ูุงู ุฃุญุฏ ุฃุทุฑุงู ุงูุงูุถูุงู ุตุบูุฑูุง ุจูุง ููู ุงูููุงูุฉ (ูุชู ุชุนููู ูุนูุงุฑ ุงูุงูุชูุงุก ุจูุงุณุทุฉ <em>spark.sql.autoBroadcastJoinThreshold</em> ูู SQLConf).  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ูุณุฎ ูุฐุง ุงูุฌุงูุจ ุจุงููุงูู ุฅูู ุฌููุน ุงููููุฐูู ุ ุญูุซ ููุฌุฏ ุฑุงุจุท ุชุฌุฒุฆุฉ ูุน ุงูุฌุฏูู ุงูุฑุฆูุณู.  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุญุฌู ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ุญุงูุฉ ุงูุตูุฉ ุงูุฎุงุฑุฌูุฉ ุ ูููู ููุท ูุณุฎ ุงูุฌุงูุจ ุงูุฎุงุฑุฌู ุ ูุฐูู ุ ุฅุฐุง ุฃููู ุ ูุฌุฏูู ุฑุงุฆุฏ ูู ุญุงูุฉ ุงูุตูุฉ ุงูุฎุงุฑุฌูุฉ ุ ูุฌุจ ุนููู ุงุณุชุฎุฏุงู ุงูุฌุฏูู ุจุฃูุจุฑ ูููุฉ ูู ุงูุจูุงูุงุช. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">  ,    ,     <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span>      Oracle,   <span class="hljs-comment"><span class="hljs-comment">/*+ broadcast(t1, t2) */</span></span></code> </pre><br><h3 style=";text-align:right;direction:rtl">  ุฏูุฌ ุฏูุฌ ุงููุฑุฒ </h3><br><p style=";text-align:right;direction:rtl">  ูุน ุชุดุบูู <em>spark.sql.join.preferSortMergeJoin</em> ุงูุชุฑุงุถููุง ุ ูุชู ุชุทุจูู ูุฐู ุงูุทุฑููุฉ ุงูุชุฑุงุถููุง ุฅุฐุง ูุงู ูู ุงููููู ูุฑุฒ ููุงุชูุญ ุงูุงูุถูุงู. <br>  ูู ุงูููุฒุงุช ุ ูููู ููุงุญุธุฉ ุฃูู ุ ุนูู ุนูุณ ุงูุทุฑููุฉ ุงูุณุงุจูุฉ ุ ูุง ูุชููุฑ ุชุญุณูู ุฅูุดุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุฃุฏุงุก ุงูุนูููุฉ ุฅูุง ููุฑุจุท ุงูุฏุงุฎูู. <br></p><br><h3 style=";text-align:right;direction:rtl">  ุงูุถูุงู ุฎูุท ุงูุชุฌุฒุฆุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ููู ูู ุงููููู ูุฑุฒ ุงูููุงุชูุญ ุ ุฃู ุชู ุชุนุทูู ุฎูุงุฑ ุชุญุฏูุฏ ุฏูุฌ ุฏูุฌ ุงููุฑุฒ ุงูุงูุชุฑุงุถู ุ ูุณูุญุงูู Catalyst ุชุทุจูู ุฑุจุท ุชุฌุฒุฆุฉ ุนุดูุงุฆู.  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุ ุชู ุงูุชุญูู ุฃูุถูุง ูู ุฃู Spark ูุฏูู ุฐุงูุฑุฉ ูุงููุฉ ูุฅูุดุงุก ุฎุฑูุทุฉ ุชุฌุฒุฆุฉ ูุญููุฉ ููุณู ูุงุญุฏ (ูุชู ุชุนููู ุงูุนุฏุฏ ุงูุฅุฌูุงูู <em>ููุฃูุณุงู</em> ุนู ุทุฑูู ุชุนููู <em>spark.sql.shuffle.partitions</em> ) </p><br><h3 style=";text-align:right;direction:rtl">  BroadcastNestedLoopJoin ู CartesianProduct </h3><br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุฅููุงููุฉ ููููุงุฑูุฉ ุงููุจุงุดุฑุฉ ุญุณุจ ุงูููุชุงุญ (ุนูู ุณุจูู ุงููุซุงู ุ ุญุงูุฉ ูุซู) ุฃู ูุง ุชูุฌุฏ ููุงุชูุญ ูุฑุจุท ุงูุฌุฏุงูู ุ ุงุนุชูุงุฏูุง ุนูู ุญุฌู ุงูุฌุฏุงูู ุ ูุชู ุชุญุฏูุฏ ูุฐุง ุงูููุน ุฃู CartesianProduct. <br></p><br><h3 style=";text-align:right;direction:rtl">  ุชุฑุชูุจ ุชุญุฏูุฏ ุงูุฌุฏุงูู ูู ุงูุงูุถูุงู </h3><br><p style=";text-align:right;direction:rtl">  ูู ุฃู ุญุงู ุ ูุชุทูุจ ุงูุฑุจุท ุฌุฏุงูู ุชุจุฏูู ุญุณุจ ุงูููุชุงุญ.  ูุฐูู ุ ูู ุงูููุช ุงูุญุงูู ุ ูุนุฏ ุชุฑุชูุจ ุชุญุฏูุฏ ุงูุฌุฏุงูู ุ ุฎุงุตุฉู ูู ุญุงูุฉ ุฅุฌุฑุงุก ุนุฏุฉ ูุตูุงุช ูุชุชุงููุฉ ุ ููููุง (ุฅุฐุง ููุช ููููุง ุ ุฅุฐุง ูู ูุชู ุชูููู CBO ููู ูุชู ุชูููู ุฅุนุฏุงุฏ JOIN_REORDER_ENABLED). <br></p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุฐูู ูููููุง ุ ูุฌุจ ุฃู ูููู ุชุฑุชูุจ ุงูุงูุถูุงู ุฅูู ุงูุฌุฏุงูู ูู ุนุฏุฏ ุนูููุงุช ุงูุชุจุฏูู ุงูุนุดูุงุฆู ููุฌุฏุงูู ุงููุจูุฑุฉ ุ ูุงูุชู ูุฌุจ ุฃู ุชุชู ุนูููุงุช ุงูุฑุจุท ููุง ุนูู ููุณ ุงูููุชุงุญ ุจุงูุชุณูุณู.  ููุง ุชูุณ ุฃูุถูุง ุชูููู ุงูุจูุงูุงุช ููุงูุถูุงู ูุชูููู ุจุซ Hash Join. <br></p><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุทุจูู ุงูุชุจุงุฏูู ูุธุฑูู ุงููุฑุดุญ </h2><br><p style=";text-align:right;direction:rtl">  ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุงุณุชุนูุงู ุงูุชุงูู: <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> bal.account_rk, cust.full_name <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> balance bal <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> customer cust <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> bal.party_rk = cust.party_rk <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> bal.actual_date = cust.actual_date <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> bal.actual_date = <span class="hljs-keyword"><span class="hljs-keyword">cast</span></span>(<span class="hljs-string"><span class="hljs-string">'2017-12-31'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>)</code> </pre><br><p style=";text-align:right;direction:rtl">  ููุง ูููู ุจุชูุตูู ุฌุฏูููู ููุณููู ุจููุณ ุงูุทุฑููุฉ ุ ููููุง ูุญูู ุงูุชุงุฑูุฎ ุงููุนูู ููุทุจู ูุฑุดุญูุง ุตุฑูุญูุง ููุท ุนูู ุงููุณู ููููุง ูุฌุฏูู ุงูุชูุงุฒู. <br></p><br><p style=";text-align:right;direction:rtl">  ููุง ูููู ุฑุคูุชู ูู ุฎุทุฉ ุงูุงุณุชุนูุงู ุงููุญุณูุฉ ุ ูุชู ุชุทุจูู ุนุงูู ุงูุชุตููุฉ ุญุณุจ ุงูุชุงุฑูุฎ ุฃูุถูุง ุนูู ุงูุนููู ุ ููู ููุช ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ุงููุฑุต ุ ูุชู ุชุญุฏูุฏ ูุณู ูุงุญุฏ ุจุงูุถุจุท. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs delphi">== Optimized Logical Plan == Project [account_rk<span class="hljs-string"><span class="hljs-string">#1</span></span>, full_name<span class="hljs-string"><span class="hljs-string">#59</span></span>] +- Join Inner, ((party_rk<span class="hljs-string"><span class="hljs-string">#18</span></span> = party_rk<span class="hljs-string"><span class="hljs-string">#57</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span>)) :- Project [ACCOUNT_RK<span class="hljs-string"><span class="hljs-string">#1</span></span>, PARTY_RK<span class="hljs-string"><span class="hljs-string">#18</span></span>, ACTUAL_DATE<span class="hljs-string"><span class="hljs-string">#27</span></span>] : +- Filter ((isnotnull(actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>)) &amp;&amp; isnotnull(party_rk<span class="hljs-string"><span class="hljs-string">#18</span></span>)) : +- Relation[,... <span class="hljs-number"><span class="hljs-number">4</span></span> more fields] orc +- Project [PARTY_RK<span class="hljs-string"><span class="hljs-string">#57</span></span>, FULL_NAME<span class="hljs-string"><span class="hljs-string">#59</span></span>, ACTUAL_DATE<span class="hljs-string"><span class="hljs-string">#88</span></span>] +- Filter (((actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>) &amp;&amp; isnotnull(actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span>)) &amp;&amp; isnotnull(party_rk<span class="hljs-string"><span class="hljs-string">#57</span></span>)) +- Relation[,... <span class="hljs-number"><span class="hljs-number">9</span></span> more fields] orc</code> </pre><br><p style=";text-align:right;direction:rtl">  ูููู ุชุญุชุงุฌ ููุท ุฅูู ุงุณุชุจุฏุงู ุงูุตูุฉ ุงูุฏุงุฎููุฉ ุจุงูุฌุงูุจ ุงูุฃูุณุฑ ุงูุฃูุณุฑ ูู ุงูุงุณุชุนูุงู ุ ุญูุซ ููุฎูุถ โโุงูุถุบุท ุงููุณูุฏ ูุฌุฏูู ุงูุนููุงุก ุนูู ุงูููุฑ ุ ููุญุฏุซ ูุณุญ ูุงูู ุ ููู ุชุฃุซูุฑ ุบูุฑ ูุฑุบูุจ ููู. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs delphi">== Optimized Logical Plan == Project [account_rk<span class="hljs-string"><span class="hljs-string">#1</span></span>, full_name<span class="hljs-string"><span class="hljs-string">#59</span></span>] +- Join LeftOuter, ((party_rk<span class="hljs-string"><span class="hljs-string">#18</span></span> = party_rk<span class="hljs-string"><span class="hljs-string">#57</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = actual_date<span class="hljs-string"><span class="hljs-string">#88</span></span>)) :- Project [ACCOUNT_RK<span class="hljs-string"><span class="hljs-string">#1</span></span>, PARTY_RK<span class="hljs-string"><span class="hljs-string">#18</span></span>, ACTUAL_DATE<span class="hljs-string"><span class="hljs-string">#27</span></span>] : +- Filter (isnotnull(actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span>) &amp;&amp; (actual_date<span class="hljs-string"><span class="hljs-string">#27</span></span> = <span class="hljs-number"><span class="hljs-number">17531</span></span>)) : +- Relation[,... <span class="hljs-number"><span class="hljs-number">4</span></span> more fields] orc +- Project [PARTY_RK<span class="hljs-string"><span class="hljs-string">#57</span></span>, FULL_NAME<span class="hljs-string"><span class="hljs-string">#59</span></span>, ACTUAL_DATE<span class="hljs-string"><span class="hljs-string">#88</span></span>] +- Relation[,... <span class="hljs-number"><span class="hljs-number">9</span></span> more fields] orc</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ููุน ุงูุชุญููู </h2><br><p style=";text-align:right;direction:rtl">  ุถุน ูู ุงุนุชุจุงุฑู ูุซุงูุงู ุจุณูุทูุง ููุชุญุฏูุฏ ูู ุฌุฏูู ูุน ุงูุชุตููุฉ ุญุณุจ ููุน ุงูุนููู ุ ูู ููุน ุงูุญูู ููุน party_type ูู ุณูุณูุฉ. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> party_rk, full_name <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cust <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> actual_date = cast(<span class="hljs-string"><span class="hljs-string">'2017-12-31'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">date</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> party_type = <span class="hljs-number"><span class="hljs-number">101</span></span> <span class="hljs-comment"><span class="hljs-comment">--   -- and party_type = '101' --    </span></span></code> </pre><br><p style=";text-align:right;direction:rtl">  ููุงุฑู ุจูู ุงูุฎุทุชูู ุงููุงุชุฌุชูู ุ ุงูุฃููู - ุนูุฏูุง ูุดูุฑ ุฅูู ุงูููุน ุบูุฑ ุงูุตุญูุญ (ุณูููู ููุงู ุถููููุง ุถููููุง ุฅูู int) ุ ูุงูุซุงููุฉ - ุนูุฏูุง ูุชูุงูู ุงูููุน ูุน ุงููุฎุทุท. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">PushedFilters: [<span class="hljs-type"><span class="hljs-type">IsNotNull</span></span>(<span class="hljs-type"><span class="hljs-type">PARTY_TYPE</span></span>)] //            . PushedFilters: [<span class="hljs-type"><span class="hljs-type">IsNotNull</span></span>(<span class="hljs-type"><span class="hljs-type">PARTY_TYPE</span></span>), <span class="hljs-type"><span class="hljs-type">EqualTo</span></span>(<span class="hljs-type"><span class="hljs-type">PARTY_TYPE</span></span>,<span class="hljs-number"><span class="hljs-number">101</span></span>)] //             .</code> </pre><br><p style=";text-align:right;direction:rtl">  ููุญุธุช ูุดููุฉ ููุงุซูุฉ ูู ุญุงูุฉ ููุงุฑูุฉ ุงูุชูุงุฑูุฎ ุจุณูุณูุฉ ุ ุณูููู ููุงู ูุฑุดุญ ูููุงุฑูุฉ ุงูุณูุงุณู.  ูุซุงู: <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">where</span></span> OPER_DATE = <span class="hljs-string"><span class="hljs-string">'2017-12-31'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Filter</span></span> (isnotnull(oper_date#<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; (cast(oper_date#<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> string) = <span class="hljs-number"><span class="hljs-number">2017</span></span><span class="hljs-number"><span class="hljs-number">-12</span></span><span class="hljs-number"><span class="hljs-number">-31</span></span>) PushedFilters: [IsNotNull(OPER_DATE)] <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> OPER_DATE = cast(<span class="hljs-string"><span class="hljs-string">'2017-12-31'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">date</span></span>) PushedFilters: [IsNotNull(OPER_DATE), EqualTo(OPER_DATE,<span class="hljs-number"><span class="hljs-number">2017</span></span><span class="hljs-number"><span class="hljs-number">-12</span></span><span class="hljs-number"><span class="hljs-number">-31</span></span>)]</code> </pre><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ููุญุงูุฉ ุงูุชู ูููู ูููุง ุชุญููู ููุน ุถููููุง ูููููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ int -&gt; ุนุดุฑู ุ ูููู ุงููุญุณู ุจุฐูู ูู ุชููุงุก ููุณู. <br></p><br><h2 style=";text-align:right;direction:rtl">  ูุฒูุฏ ูู ุงูุจุญุซ </h2><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุญุตูู ุนูู ุงููุซูุฑ ูู ุงููุนูููุงุช ุงููุซูุฑุฉ ููุงูุชูุงู ุญูู "ุงูููุงุจุถ" ุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูุถุจุท ุงููุญูุฒ ุ ููุฐูู ุญูู ุฅููุงููุงุช (ุงูุญุงุถุฑ ูุงููุณุชูุจู) ูููุญุณู ูู SQLConf.scala. <br></p><br><p style=";text-align:right;direction:rtl">  ุนูู ูุฌู ุงูุฎุตูุต ุ ููุง ุชุฑู ุจุดูู ุงูุชุฑุงุถู ุ ูุง ูุฒุงู ููุญุณููู ุงูุชูููุฉ ูุชููููุง ูู ุงูููุช ุงูุญุงูู. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-type"><span class="hljs-type">CBO_ENABLED</span></span> = buildConf(<span class="hljs-string"><span class="hljs-string">"spark.sql.cbo.enabled"</span></span>) .doc(<span class="hljs-string"><span class="hljs-string">"Enables CBO for estimation of plan statistics when set true."</span></span>) .booleanConf .createWithDefault(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)</code> </pre><br><p style=";text-align:right;direction:rtl">  ูุถูุง ุนู ุงูุชุญุณููุงุช ุงูุชุงุจุนุฉ ููุง ุงููุฑุชุจุทุฉ ุจุฅุนุงุฏุฉ ุชุฑุชูุจ join'ov. <br></p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-type"><span class="hljs-type">JOIN_REORDER_ENABLED</span></span> = buildConf(<span class="hljs-string"><span class="hljs-string">"spark.sql.cbo.joinReorder.enabled"</span></span>) .doc(<span class="hljs-string"><span class="hljs-string">"Enables join reorder in CBO."</span></span>) .booleanConf .createWithDefault(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)</code> </pre><br><p style=";text-align:right;direction:rtl">  ุฃู </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-type"><span class="hljs-type">STARSCHEMA_DETECTION</span></span> = buildConf(<span class="hljs-string"><span class="hljs-string">"spark.sql.cbo.starSchemaDetection"</span></span>) .doc(<span class="hljs-string"><span class="hljs-string">"When true, it enables join reordering based on star schema detection. "</span></span>) .booleanConf .createWithDefault(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ููุฎุต ููุฌุฒ </h2><br><p style=";text-align:right;direction:rtl">  ูู ูููุณ ุณูู ุฌุฒุก ุตุบูุฑ ูู ุงูุชุญุณููุงุช ุงูุญุงููุฉ ุ ูุชูู ุงูุชุฌุงุฑุจ ูุน ุชุญุณูู ุงูุชูููุฉ ุ ูุงูุชู ูููู ุฃู ุชุนุทู ูุณุงุญุฉ ุฃูุจุฑ ุจูุซูุฑ ูุชุญููู ุงูุงุณุชุนูุงู ุ ูู ุงููุณุชูุจู.  ุฃูุถูุง ุ ุณุคุงู ูุซูุฑ ููุงูุชูุงู ูููุตู ูู ููุงุฑูุฉ ูุฌููุนุฉ ูู ุงูุชุญุณููุงุช ุนูุฏ ูุฑุงุกุฉ ุงููููุงุช ูู Parquet ู Orc ุ ุฅุฐุง ุญูููุง ูู ูุจู jira ูููุดุฑูุน ุ ูุฅู ุงูุฃูุฑ ูุชุนูู ุจุงูุชูุงูุค ุ ูููู ูู ูู ูุฐูู ุญููุงุ <br></p><br><p style=";text-align:right;direction:rtl">  ุจุงูุฅุถุงูุฉ ุฅูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญููู ุงูุทูุจุงุช ูุชุญุณูููุง ูุซูุฑ ููุงูุชูุงู ููุซูุฑ ููุงูุชูุงู ุ ุฎุงุตุฉ ุจุงููุธุฑ ุฅูู ุชููุฑ ุฑููุฒ ุงููุตุฏุฑ. </li><li style=";text-align:right;direction:rtl">  ุฅุฏุฑุงุฌ CBO ุณูููุฑ ุงููุฌุงู ููุฒูุฏ ูู ุงูุชุญุณููุงุช ูุงูุจุญูุซ. </li><li style=";text-align:right;direction:rtl">  ูู ุงูุถุฑูุฑู ูุฑุงูุจุฉ ุชุทุจูู ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ ุงูุชู ุชุณูุญ ูู ุจุชุตููุฉ ุฃูุจุฑ ูุฏุฑ ูููู ูู ุงูุจูุงูุงุช "ุงูุฅุถุงููุฉ" ูู ุงููุฑุงุญู ุงููุจูุฑุฉ ุงูููููุฉ. </li><li style=";text-align:right;direction:rtl">  ุงูุงูุถูุงู ูู ุดุฑ ูุง ุจุฏ ููู ุ ูููู ุฅุฐุง ูุงู ุฐูู ูููููุง ุ ูุฅูู ูุณุชุญู ุงูุชูููู ููู ูุชุชุจุน ุงูุชูููุฐ ุงูุฐู ูุชู ุงุณุชุฎุฏุงูู ุชุญุช ุบุทุงุก ุงููุญุฑู. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar417103/">https://habr.com/ru/post/ar417103/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar417091/index.html">ุฅูุดุงุก ุชุธููู ุงูููุงู ุงููุฑุชูู ููููุจ. ุงูุฌุฒุก 3</a></li>
<li><a href="../ar417093/index.html">ููุงุชูุญ ุชุนูู ุจุงูููุณ ูุน Modbus: ููุงุฐุง ูู ุจุญุงุฌุฉ ุฅูููุง ูููููุฉ ุชุทุจูููุง ูู ุดูุฉ ุฐููุฉ</a></li>
<li><a href="../ar417097/index.html">ุจุฑูุฌุฉ ุฌุงูุง ุณูุฑูุจุช</a></li>
<li><a href="../ar417099/index.html">ููู ูุชุจุช ููุชุจุฉ C ++ 11 ุงูููุงุณูุฉ ุฃู ููุงุฐุง ูููู ุงูุชุนุฒูุฒ ูุฎูููุง ุฌุฏูุง. ุงููุตู 2</a></li>
<li><a href="../ar417101/index.html">ุชุนุฑูู ุฌุงูุฒ - ูุง ูุณููุง ุฃู ูููู ุนูู</a></li>
<li><a href="../ar417105/index.html">ุงูุทุจุงุนุฉ ุนูู ุทุงุจุนุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ. ุชุฌุงุฑุจ 3Dtool ุงูุณุฑูุฉ</a></li>
<li><a href="../ar417107/index.html">ููุดุฆ ุงููุนุจุฉ ุฃุซูุงุก True: ุชุนูู () ุญูู ุจุฑูุฌุฉ gamedev ููุดููุงุช VR ููุญุงูุงุฉ ML</a></li>
<li><a href="../ar417109/index.html">ุฑูุชุดุงุฑุฏ ูุงูููุฌ: ุงููุตู 10. ูุธุฑูุฉ ุงูุชุฑููุฒ - ุฃูุง</a></li>
<li><a href="../ar417111/index.html">ุงููุคุชูุฑุงุช ุนุจุฑ ุงูุฅูุชุฑูุช: ุงูุฌุฑู ููุงุจู ุงูููุจููุงุฑ</a></li>
<li><a href="../ar417113/index.html">ุทุงุจุนุฉ ุฅูุทุงููุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูู ุฑูุณูุง: Raise3D N1 Dual - ุงูููุฐุฌุฉ ูุงูููุงุฐุฌ ุงูุฃูููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>