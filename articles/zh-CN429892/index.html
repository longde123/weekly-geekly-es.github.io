<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍯 🤷🏾 🍇 xonsh-python作为shell的替代品 🚣 👥 🏙️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="令人惊讶的是，在中心上，仍然没有关于xonsh （ github ）这样非常有趣的shell替换的文章 ，从我的角度来看，所有shell的语法都很糟糕，我认为没有理由在21世纪和Python中保存它它具有出色的语法和许多其他优点，因此，我认为它应该是xonsh试图实现的默认自动化语言。 


 我已...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>xonsh-python作为shell的替代品</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429892/"><p> 令人惊讶的是，在中心上，仍然没有关于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">xonsh</a> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a> ）这样非常有趣的shell替换的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> ，从我的角度来看，所有shell的语法都很糟糕，我认为没有理由在21世纪和Python中保存它它具有出色的语法和许多其他优点，因此，我认为它应该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">是xonsh试图实现</a>的默认自动化语言。 </p><br><p> 我已经使用xonsh已有一段时间了，所以我想可以开始谈论它了。 </p><a name="habracut"></a><br><p> 预订： </p><br><ul><li>  xonsh仅与Python 3有关，但这<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">是规范</a> 。 </li><li>  xonsh尚未发布（在撰写本文时为0.8.3版），显然，据开发人员说，尚未实现所有所需的功能，但根据我的感觉，一切正常（如果您查看下面的差异）。 </li></ul><br><p>  xonsh的主要功能是它<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“神奇”地</a>猜测您输入的内容-python或shell命令，并且效果很好。 </p><br><p>您可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">dog</a>将python代码插入shell命令中。 </p><br><p> 我不会详细介绍xonsh的功能，在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a>和任何<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a>中都对此进行了明确<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">说明</a> ，从我的角度来看，您可以在shell中获得普通的循环语法就足够了： </p><br><pre><code class="plaintext hljs">worldmind@x ~ $ for i in range(3): ............... echo $SHELL</code> </pre> <br><p> 因此，我将尝试着重于未描述或描述不充分的内容。 </p><br><h2 id="ustanovka"> 安装方式 </h2><br><p> 我将描述不需要超级用户特权的安装（对于Debian / Ubuntu），尽管我只是最近才切换到这样的方案，但我将其放在系统文件夹中，写在<code>/etc/shells</code>并使用<code>chsh</code>命令更改了shell，但乍一看一切正常也使用新方法，对我来说似乎更正确，我不想用不是来自存储库的软件包来阻塞系统，但是每个人都可以自己决定。 </p><br><p> 如果尚未添加点子，我们将： </p><br><pre> <code class="plaintext hljs">sudo apt-get install python3-pip</code> </pre> <br><p> 我们放了xonsh（不带sudo），我给出了一个安装所有可选依赖项的命令，以获取作者设想的所有包子，如果有人希望进行最小程度的安装，则可以删除包含以下内容的方括号： </p><br><pre> <code class="plaintext hljs">pip3 install --user xonsh[ptk,pygments,proctitle,linux]</code> </pre> <br><p> 很有可能您已经在PATH的<code>.profile</code>中的某个位置添加了带有二进制文件<code>$HOME/.local/bin</code>的本地文件夹的路径，但是只有在它们存在的情况下才添加它们，因此您需要重新启动终端，以便此代码起作用并且xonsh二进制文件必须跑去看看。 <br> 更新是标准的： </p><br><pre> <code class="plaintext hljs">pip3 install --user xonsh --upgrade</code> </pre> <br><h3 id="venv"> 静脉 </h3><br><p> 如果要使用相应的功能，请放入venv（有关vox的更多信息，请参见）： </p><br><pre> <code class="plaintext hljs">sudo apt-get install python3-venv</code> </pre> <br><p> 所有venvs都针对特定的外壳进行了改进，因此xonsh提供了自己的包装器<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">vox</a> ，但是为了舒适使用，值得安装<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">avox</a>扩展： </p><br><pre> <code class="plaintext hljs">pip3 install --user xontrib-avox</code> </pre> <br><h3 id="ustanovka-pyenv">  Pyenv安装 </h3><br><p> 如果需要使用任意版本的python的虚拟环境，则需要通过首先<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安装用于构建python的依赖项</a>来克隆pyenv： </p><br><pre> <code class="plaintext hljs">git clone https://github.com/pyenv/pyenv.git ~/.pyenv</code> </pre> <br><p> 进一步在示例配置中，您可以看到安装了一对环境变量以使用pyenv。 </p><br><h3 id="zapusk"> 发射 </h3><br><p> 现在我们已经安装了所有东西，剩下的就是使xonsh成为shell，为了不更改用户文件夹之外的任何东西，我对bash使用以下代码（基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SO</a> ）（如果您有另一个shell，那么您知道该怎么做，但是不使用.profile）因为xonsh也会读取它）添加到<code>.bashrc</code> ： </p><br><pre> <code class="plaintext hljs"># set default shell without editing /etc/shells if [ "${XONSH_VERSION:-unset}" = "unset" ] ; then export SHELL=$HOME/.local/bin/xonsh exec $HOME/.local/bin/xonsh -l fi</code> </pre> <br><p> 我们重新启动Shell，如果一切顺利，那么您已经在xonsh中，即 实际上，在python控制台中，例如，您可以直接在命令行上执行计算，例如，找出<code>2+2</code> 。 </p><br><h2 id="nastroyka"> 客制化 </h2><br><p> 在开始使用它之前，您应该创建一个<code>.xonshrc</code>配置文件： </p><br><pre> <code class="plaintext hljs">aliases['g'] = 'git' import os local_bin = '{}/.local/bin'.format($HOME) if os.path.isdir(local_bin): $PATH.append(local_bin) $PYENV_ROOT = '%s/.pyenv' % $HOME $PATH.insert(0, '%s/bin' % $PYENV_ROOT) xontrib load vox $PROJECT_DIRS = ["~/projects"] xontrib load avox</code> </pre> <br><p> 重新启动外壳以应用新设置。 </p><br><p> 值得关注的是人类数据模型- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">别名</a>是一个字典，方式是一个列表，这似乎很明显，但是由于某些原因，并不总是这样。 <br> 另外，我们在配置中导入了<code>os</code>模块，这意味着它已经可以在我们的Shell中使用，因此您可以导入必要的模块并获得自己舒适的环境。 </p><br><p> 上面文件的开头更多地展示了这些功能，但是最后三行使您可以方便地使用虚拟环境，稍后将使用其中的一个示例。 </p><br><h2 id="ispolzovanie-virtualnyh-okruzheniy"> 使用虚拟环境 </h2><br><p> 创建一个项目文件夹（avox期望所有项目都在<code>$PROJECT_DIRS</code> ）： </p><br><pre> <code class="plaintext hljs">mkdir -p projects/test</code> </pre> <br><p> 为此项目创建一个虚拟环境： </p><br><pre> <code class="plaintext hljs">vox new test</code> </pre> <br><p> 由于配置了<code>avox</code>附加组件<code>avox</code>我们只需要转到项目文件夹以激活虚拟环境， <code>source ./bin/activate</code>不需要执行任何奇怪的<code>source ./bin/activate</code> ： </p><br><pre> <code class="plaintext hljs">worldmind@x ~ $ cd projects/test/ (test) worldmind@x ~/projects/test $ pip install see ... (test) worldmind@x ~/projects/test $ python -c 'import see'</code> </pre> <br><p> 退出文件夹后，虚拟环境将被停用： </p><br><pre> <code class="plaintext hljs">(test) worldmind@x ~/projects/test $ cd worldmind@x ~ $ python3 -c 'import see' err&gt;out | fgrep 'NotFound' ModuleNotFoundError: No module named 'see'</code> </pre> <br><p> 同时，您可以看到更多有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">重定向I / O流的</a>人工工作，他们从未忘记如何在各种bash中执行此操作，让他们成为第一个向我提出评论的人。 </p><br><p><del> 为了完整起见，我希望在这些虚拟环境中可以使用例如通过pyenv安装的任意版本的python，但是到目前为止， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">它还没有一起发展</a> ，并且还没有动手来加固自己。 </del><br>  UPD：不久前，xonsh被<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">教导</a>在虚拟环境中使用任意版本的python。 <br> 安装所需版本的python（可用<code>pyenv install --list</code>列表）： </p><br><pre> <code class="plaintext hljs">pyenv install 3.7.2</code> </pre> <br><p> 与她一起创建虚拟环境： </p><br><pre> <code class="plaintext hljs">mkdir projects/projectwith3.7 vox new -p $PYENV_ROOT/versions/3.7.2/bin/python projectwith3.7</code> </pre> <br><p> 我们检查： </p><br><pre> <code class="plaintext hljs">(projectwith3.7) worldmind@x ~/projects/projectwith3.7 $ python --version Python 3.7.2</code> </pre> <br><h2 id="grabli"> 耙子 </h2><br><p> 我想到的唯一一件事就是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">转义</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">区别</a> ： </p><br><pre> <code class="plaintext hljs">find . -name data.txt -exec echo {} \;</code> </pre> <br><p> 将不起作用，因为反斜杠转义在xonsh中不起作用，并且花括号具有特殊含义，因此需要使用引号，例如： </p><br><pre> <code class="plaintext hljs">find . -name .xonshrc -exec echo '{}' ';'</code> </pre> <br><p> 与bash的某些区别在于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a>中的表格形式。 </p><br><h2 id="vyvod"> 结论 </h2><br><p> 在我看来，xonsh是未来所有人正常外壳的良好竞争者，尤其是它应该对python爱好者有吸引力。 开始使用（不使用sudo进行安装可以很容易地回滚，您可以简单地删除文件夹）来了解您是否个人所需的一切，也许正是您要找的东西，但是害怕安装。 </p><br><h2 id="dopolneniya-v-kommentariyah"> 评论中的补充 </h2><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">设置文件夹的环境变量</a> 。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">虚拟环境激活挂钩</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN429892/">https://habr.com/ru/post/zh-CN429892/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN429878/index.html">为什么随着公司的成长，处于最前沿的开发人员“落伍”</a></li>
<li><a href="../zh-CN429880/index.html">Pix4D-从照片到测量</a></li>
<li><a href="../zh-CN429882/index.html">通过赛普拉斯UDB微控制器PSoC控制RGB LED</a></li>
<li><a href="../zh-CN429888/index.html">Cyclone IV FPGA板上的基于堆栈的计算器</a></li>
<li><a href="../zh-CN429890/index.html">开放式网络研讨会“生成对抗网络”</a></li>
<li><a href="../zh-CN429894/index.html">在具有ROS的Raspberry Pi 3上使用鱼眼-第2部分</a></li>
<li><a href="../zh-CN429898/index.html">DMS（经销商管理系统）-用于管理经销商网络的信息生态系统的实施</a></li>
<li><a href="../zh-CN429902/index.html">Web 2.0时代的页面排名-第1部分</a></li>
<li><a href="../zh-CN429904/index.html">关于计算机游戏开发的有趣和悲伤的故事</a></li>
<li><a href="../zh-CN429908/index.html">如何在食物中使用协程和夜间安眠</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>