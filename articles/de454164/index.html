<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕢 👩🏻‍✈️ 🏏 Wie funktionieren A / B-Tests in Avito? 🥖 🙆 👨‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo an alle. Mein Name ist Danila, ich arbeite in einem Team, das in Avito eine analytische Infrastruktur entwickelt. Im Zentrum dieser Infrastruktu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie funktionieren A / B-Tests in Avito?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/avito/blog/454164/"><p>  Hallo an alle.  Mein Name ist Danila, ich arbeite in einem Team, das in Avito eine analytische Infrastruktur entwickelt.  Im Zentrum dieser Infrastruktur stehen A / B-Tests. </p><br><p>  A / B-Experimente sind ein wichtiges Entscheidungsinstrument in Avito.  In unserem Produktentwicklungszyklus ist ein A / B-Test ein Muss.  Wir testen jede Hypothese und führen nur positive Änderungen durch. </p><br><p>  Wir erfassen Hunderte von Metriken und können diese auf Geschäftsbereiche aufteilen: Branchen, Regionen, autorisierte Benutzer usw. Wir verwenden dies automatisch auf einer einzigen Plattform für Experimente.  In dem Artikel werde ich Ihnen ausführlich genug erklären, wie die Plattform angeordnet ist, und wir werden auf einige interessante technische Details eingehen. </p><br><p><img src="https://habrastorage.org/webt/ts/r_/qw/tsr_qwh3l7qfw2kob14z0lsaiya.png"></p><a name="habracut"></a><br><p>  Die Hauptfunktionen der A / B-Plattform sind wie folgt formuliert. </p><br><ol><li>  Hilft Ihnen, schnell Experimente durchzuführen </li><li>  Steuert unerwünschte Experimentkreuzungen </li><li>  Zählt Metriken, stat.  testet, visualisiert Ergebnisse </li></ol><br><p>  Mit anderen Worten, die Plattform hilft dabei, fehlerfreie Entscheidungen am schnellsten zu treffen. </p><br><p>  Wenn wir den Prozess der Entwicklung von Features, die zum Testen gesendet werden, weglassen, sieht der gesamte Zyklus des Experiments folgendermaßen aus: </p><br><p><img src="https://habrastorage.org/webt/ve/wd/by/vewdbye97eexzetbj3riubs-i1w.png"></p><br><ul><li>  Der Kunde (Analyst oder Produktmanager) konfiguriert die Experimentparameter über das Admin-Panel. </li><li>  Der Split-Service verteilt gemäß diesen Parametern die erforderliche A / B-Gruppe an das Client-Gerät. </li><li>  Benutzeraktionen werden in Rohprotokollen gesammelt, die aggregiert und in Metriken umgewandelt werden. </li><li>  Metriken werden durch statistische Tests geführt. </li><li>  Die Ergebnisse werden am Tag nach dem Start auf dem internen Portal angezeigt. </li></ul><br><p>  Der gesamte Datentransport in einem Zyklus dauert einen Tag.  Experimente dauern in der Regel eine Woche, aber der Kunde erhält jeden Tag eine Reihe von Ergebnissen. </p><br><p>  Lassen Sie uns nun auf die Details eingehen. </p><br><h1 id="upravlenie-eksperimentom">  Versuchsmanagement </h1><br><p>  Das Admin-Panel verwendet das YAML-Format, um Experimente zu konfigurieren. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/lb/ko/k_/lbkok_pnexw8kzvdlkoq1jteuzy.png"></a> </p><br><p>  Dies ist eine bequeme Lösung für ein kleines Team: Die Fertigstellung der Funktionen der Konfiguration erfolgt ohne Front.  Die Verwendung von Textkonfigurationen vereinfacht die Arbeit für den Benutzer: Sie müssen weniger Mausklicks ausführen.  Eine ähnliche Lösung wird vom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Airbnb A / B-Framework verwendet</a> . </p><br><p>  Um den Verkehr in Gruppen aufzuteilen, verwenden wir die Common Salt Hashing-Technik. </p><br><p><img src="https://habrastorage.org/webt/fs/ar/r_/fsarr_kezrgckfiuvf1w1uyuqfs.png"></p><br><p>  Um den Effekt des "Gedächtnisses" der Benutzer zu eliminieren, mischen wir zu Beginn eines neuen Experiments zusätzlich mit dem zweiten Salz: </p><br><p><img src="https://habrastorage.org/webt/3-/qd/w0/3-qdw0xc2l0swwonorrgkfd_lpg.png"></p><br><p>  Das gleiche Prinzip wird in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Präsentation von Yandex beschrieben</a> . </p><br><p>  Um potenziell gefährliche Überschneidungen von Experimenten zu vermeiden, verwenden wir eine Logik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ähnlich der „Ebenen“ in Google</a> . </p><br><h1 id="sbor-metrik">  Metriksammlung </h1><br><p>  Wir platzieren Rohprotokolle in Vertica und aggregieren sie zu Vorbereitungstabellen mit der Struktur: </p><br><p><img src="https://habrastorage.org/webt/v6/tw/bv/v6twbvgj-togpdbylpqq21gfbz0.png"></p><br><p>  Beobachtungen sind normalerweise einfache Ereigniszähler.  Beobachtungen werden als Komponenten in der metrischen Berechnungsformel verwendet. </p><br><p>  Die Formel zur Berechnung einer Metrik ist ein Bruch, dessen Zähler und Nenner die Summe der Beobachtungen ist: </p><br><p><img src="https://habrastorage.org/webt/me/sb/or/mesbordzixv0yrcl4oo5nho5aa4.png"></p><br><p>  In einem der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Berichte</a> von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yandex wurden</a> Metriken in zwei Typen unterteilt: nach Benutzern und Verhältnis.  Dies ist geschäftlich sinnvoll, aber in der Infrastruktur ist es bequemer, alle Metriken auf dieselbe Weise wie das Verhältnis zu berücksichtigen.  Diese Verallgemeinerung ist gültig, da die "posyuzerny" -Metrik offensichtlich als Bruch dargestellt werden kann: </p><br><p><img src="https://habrastorage.org/webt/d_/ih/l5/d_ihl5vdcvdguaohaytz5xkfepy.png"></p><br><p>  Wir fassen die Beobachtungen im Zähler und Nenner der Metrik auf zwei Arten zusammen. <br>  Einfach: </p><br><p><img src="https://habrastorage.org/webt/q9/fk/vc/q9fkvc6qsmj6dzwqknqnqwpgrts.png"></p><br><p>  Dies ist die übliche Menge aller Beobachtungen: die Anzahl der Suchanfragen, Klicks auf Anzeigen usw. <br>  Und komplizierter: </p><br><p><img src="https://habrastorage.org/webt/iu/_s/ru/iu_srukdm2pyxrvoizc68butlx8.png"></p><br><p>  Eine eindeutige Anzahl von Schlüsseln in der Gruppierung, um die die Gesamtzahl der Beobachtungen größer als ein bestimmter Schwellenwert ist. </p><br><p>  Solche Formeln können einfach mit der YAML-Konfiguration festgelegt werden: </p><br><p><img src="https://habrastorage.org/webt/ga/i3/qj/gai3qjape-xmwg2pyfg0snj6lao.png"></p><br><p>  Die Groupby- und Schwellenwertparameter sind optional.  Nur bestimmen sie die zweite Summierungsmethode. </p><br><p>  Mit den beschriebenen Standards können Sie fast jede erdenkliche Online-Metrik konfigurieren.  Gleichzeitig bleibt eine einfache Logik erhalten, die die Infrastruktur nicht übermäßig belastet. </p><br><h1 id="statisticheskiy-kriteriy">  Statistisches Kriterium </h1><br><p>  Wir messen die Signifikanz von Abweichungen anhand von Metriken mit den klassischen Methoden: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">T-Test</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mann-Whitney-U-Test</a> .  Die wichtigste notwendige Voraussetzung für die Anwendung dieser Kriterien ist, dass die Beobachtungen in der Stichprobe nicht voneinander abhängen.  In fast allen unseren Experimenten glauben wir, dass Benutzer (Uid) diese Bedingung erfüllen. </p><br><p><img src="https://habrastorage.org/webt/v-/ya/nz/v-yanzyx8c--fqqgnzkhlkg4j0c.png"></p><br><p>  Nun stellt sich die Frage: Wie werden T-Test und MW-Test für Verhältnismetriken durchgeführt?  Für den T-Test müssen Sie in der Lage sein, die Varianz der Stichprobe zu lesen, und für MW sollte die Stichprobe „benutzerdefiniert“ sein. </p><br><p><img src="https://habrastorage.org/webt/d-/7j/p2/d-7jp2xfsktkjajzki-wrp8sugw.png"></p><br><p>  Antwort: Sie müssen das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verhältnis in einer Taylor-Reihe an einem Punkt auf die erste Ordnung erweitern</a> <math> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.139ex" height="2.66ex" viewBox="0 -832 14268.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-45" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-6C" x="1404" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-65" x="1702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-66" x="2169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-74" x="2719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-5B" x="3081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-58" x="3359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-72" x="4462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-69" x="4913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-67" x="5259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-68" x="5739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-74" x="6316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-5D" x="6677" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-2C" x="6956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-45" x="7401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-6C" x="8415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-65" x="8714" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-66" x="9180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-74" x="9731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-5B" x="10092" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-59" x="10371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-72" x="11384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-69" x="11836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-67" x="12181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-68" x="12662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMATHI-74" x="13238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-5D" x="13600" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhgbMeGtrlTiAMQGVms4rYgLJmFaDg#MJMAIN-29" x="13878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> ({E} \ left [X \ right], {E} \ left [Y \ right]) </script>   :: </p><br><p><img src="https://habrastorage.org/webt/ky/im/td/kyimtdhnynvygcu_r867uzeoubu.png"></p><br><p>  Diese Formel wandelt zwei Stichproben (Zähler und Nenner) in eine um, wobei der Mittelwert und die Varianz (asymptotisch) erhalten bleiben, was die Verwendung klassischer Statistiken ermöglicht.  Tests. </p><br><p><img src="https://habrastorage.org/webt/il/h3/ac/ilh3acbdbdjnszyjezba85ee4ku.png"></p><br><p>  Eine ähnliche Idee wird von Yandex-Kollegen als Verhältnislinearisierungsmethode ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einmaliges</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zweimaliges</a> Auftreten) bezeichnet. </p><br><h1 id="proizvoditelnost-pri-masshtabirovanii">  Skalierungsleistung </h1><br><p>  Verwenden Sie schnell für die CPU-Statistik.  Kriterien ermöglicht es, Millionen von Iterationen (Vergleiche von Behandlung und Kontrolle) in Minuten auf einem ganz normalen Server mit 56 Kernen durchzuführen.  Bei großen Datenmengen hängt die Leistung jedoch in erster Linie von der Speicher- und Lesezeit von der Festplatte ab. </p><br><p>  Die tägliche Berechnung von Uid-Metriken generiert Stichproben mit einer Gesamtgröße von Hunderten von Milliarden von Werten (aufgrund der großen Anzahl gleichzeitiger Experimente, Hunderten von Metriken und der kumulativen Akkumulation).  Es ist zu problematisch, solche Volumes jeden Tag von der Festplatte zu entfernen (trotz des großen Clusters der Vertica-Spaltenbasis).  Daher sind wir gezwungen, die Kardinalität von Daten zu reduzieren.  Wir tun dies jedoch fast ohne Informationsverlust über die Varianz mit einer Technik namens "Bucket". </p><br><p>  Die Idee ist einfach: Wir haben die Uids und "streuen" sie gemäß dem Rest der Division in eine Reihe von Eimern (wir bezeichnen ihre Anzahl mit B): </p><br><p><img src="https://habrastorage.org/webt/cd/1h/x-/cd1hx-k8rgilkmwxafotz3-tgok.png"></p><br><p>  Jetzt gehen wir zur neuen experimentellen Einheit über - dem Eimer.  Wir fassen die Beobachtungen im Eimer zusammen (Zähler und Nenner sind unabhängig voneinander): </p><br><p><img src="https://habrastorage.org/webt/yv/jq/bz/yvjqbz34yd8yswtoff50zpgj3g0.png"></p><br><p>  Mit dieser Transformation wird die Bedingung für die Unabhängigkeit von Beobachtungen erfüllt, der Metrikwert ändert sich nicht und es ist leicht zu überprüfen, ob die Varianz der Metrik (Durchschnitt über die Stichprobe von Beobachtungen) erhalten bleibt: </p><br><p><img src="https://habrastorage.org/webt/df/ku/6p/dfku6pb74plagc0doxg62blhdly.png"></p><br><p>  Je mehr Bucket, desto weniger Informationen gehen verloren und desto kleiner ist der Gleichheitsfehler.  In Avito nehmen wir B = 200. </p><br><p>  Die metrische Verteilungsdichte nach der Bucket-Konvertierung wird immer ähnlich wie normal. </p><br><p><img src="https://habrastorage.org/webt/fk/sa/rf/fksarfomowkwdzzhwveb10vbtr0.png"></p><br><p>  So viele große Proben können Sie auf eine feste Größe reduzieren.  Das Wachstum der Menge der gespeicherten Daten hängt in diesem Fall nur linear von der Anzahl der Experimente und Metriken ab. </p><br><h1 id="vizualizaciya-rezultatov">  Ergebnisvisualisierung </h1><br><p>  Als Visualisierungstool verwenden wir Tableau und Webview auf Tableau Server.  Jeder Avito-Mitarbeiter hat dort Zugriff.  Es ist zu beachten, dass Tableau die Arbeit gut macht.  Eine ähnliche Lösung mit einer vollständigen Back / Front-Entwicklung zu implementieren, wäre eine viel ressourcenintensivere Aufgabe. </p><br><p>  Die Ergebnisse jedes Experiments sind ein Blatt mit mehreren tausend Zahlen.  Die Visualisierung muss so beschaffen sein, dass falsche Schlussfolgerungen bei der Implementierung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehlern der ersten und zweiten Art</a> minimiert werden und gleichzeitig die Änderungen in wichtigen Metriken und Abschnitten nicht „übersehen“ werden. </p><br><p>  Zunächst überwachen wir die "Gesundheits" -Metriken der Experimente.  Das heißt, wir beantworten die Fragen: "Stimmt es, dass die Teilnehmer in jede der Gruppen" eingegossen "wurden?", "Entspricht es den autorisierten oder neuen Benutzern?" </p><br><p> <a href=""><img src="https://habrastorage.org/webt/k1/-r/-x/k1-r-xrjn1gyeg8-o6-9eolq-qe.png"></a> </p><br><p>  Bei statistisch signifikanten Abweichungen werden die entsprechenden Zellen hervorgehoben.  Wenn Sie mit der Maus über eine beliebige Zahl fahren, wird die kumulative Dynamik des Tages angezeigt. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ju/ke/z0/jukez0yfvsmoyu_gmpy384rsmzc.png" width="600"></a> </p><br><p>  Das Haupt-Dashboard mit Metriken sieht folgendermaßen aus: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ng/mb/ju/ngmbjufio9wsbf0mnpld0ldqajq.png"></a> </p><br><p>  Jede Zeile ist ein Vergleich von Gruppen anhand einer bestimmten Metrik in einem bestimmten Abschnitt.  Auf der rechten Seite befindet sich ein Feld mit Filtern für Experimente und Metriken.  Filterplatte unten. </p><br><p>  Jeder Metrikvergleich besteht aus mehreren Metriken.  Lassen Sie uns ihre Werte von links nach rechts analysieren: </p><br><p>  <strong>1. MDE.</strong>  <strong>Minimaler nachweisbarer Effekt</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sy/xw/gk/syxwgkaimg-pgsqtnrriv8ybf5e.png"></a> </p><br><p>  ⍺ und β sind vorgewählte Fehlerwahrscheinlichkeiten der ersten und zweiten Art.  MDE ist sehr wichtig, wenn die Änderung statistisch nicht signifikant ist.  Bei der Entscheidungsfindung muss der Kunde berücksichtigen, dass das Fehlen von stat.  Bedeutung ist nicht gleichbedeutend mit keiner Wirkung.  Zuverlässig können wir nur sagen, dass der mögliche Effekt nicht mehr als MDE ist. </p><br><p>  <strong>2. MW |</strong>  <strong>T. Mann-Whitney U- und T-Testergebnisse</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/za/vs/j8/zavsj8pnzmrazz-maz_lucwjrti.png"></a> </p><br><p>  Das Feld zeigt den Wert der z- und t-Statistik an (für MW bzw. T).  In einem Tooltip - p-Wert-Dynamik.  Wenn die Änderung signifikant ist, wird die Zelle je nach Vorzeichen des Unterschieds zwischen den Gruppen rot oder grün hervorgehoben.  In diesem Fall sagen wir, dass die Metrik "farbig" ist. </p><br><p>  <strong>3. Heben.</strong>  <strong>Prozentualer Unterschied zwischen Gruppen</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/cr/db/fk/crdbfkcytwrjdzez3l-v1gu1c8e.png"></a> </p><br><p>  <strong>4. Mittelwert |</strong>  <strong>Num |</strong>  <strong>Den</strong>  <strong>Metrikwert sowie Zähler und Nenner getrennt</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/8d/kc/wp/8dkcwpugkmf6f6qqdrmnksp-rda.png"></a> </p><br><p>  Wir wenden einen weiteren T-Test auf Zähler und Nenner an, um zu verstehen, wessen Beitrag entscheidend ist. </p><br><p>  <strong>5. Std.</strong>  <strong>Selektive Standardabweichung</strong> <br>  <strong>6. Hist.</strong>  <strong>Shapiro-Wilk-Test auf Normalität der "Bucket" -Verteilung.</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/0d/dh/h6/0ddhh68_mdhgjpb6dyufnucnmfc.png"></a> </p><br><p>  Wenn der Indikator rot ist, hat die Probe möglicherweise Ausreißer oder einen ungewöhnlich langen Schwanz.  In diesem Fall müssen Sie das Ergebnis gemäß dieser Metrik sorgfältig oder gar nicht nehmen.  Durch Klicken auf den Indikator wird das Histogramm der Metrik nach Gruppe geöffnet.  Das Histogramm zeigt deutlich Anomalien - es ist einfacher, Schlussfolgerungen zu ziehen. </p><br><h1 id="zaklyuchenie">  Fazit </h1><br><p>  Die Entstehung der A / B-Plattform in Avito ist ein Wendepunkt, als unser Produkt schneller zu wachsen begann.  Jeden Tag machen wir grüne Experimente, die das Team belasten.  und „Rotweine“, die gesunde Denkanstöße geben. </p><br><p>  Es ist uns gelungen, ein effektives System von A / B-Tests und -Metriken aufzubauen.  Oft haben wir komplexe Probleme mit einfachen Methoden gelöst.  Aufgrund dieser Einfachheit verfügt die Infrastruktur über einen guten Sicherheitsspielraum. </p><br><p>  Ich bin sicher, dass diejenigen, die die A / B-Plattform in ihrem Unternehmen aufbauen werden, in dem Artikel einige interessante Erkenntnisse gefunden haben.  Ich freue mich, unsere Erfahrungen mit Ihnen zu teilen. </p><br><p>  Schreiben Sie Fragen und Kommentare - wir werden versuchen, sie zu beantworten. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de454164/">https://habr.com/ru/post/de454164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de454144/index.html">In Java 13 möchten sie "Textblöcke" hinzufügen</a></li>
<li><a href="../de454148/index.html">Überprüfen der SOC-Leistung</a></li>
<li><a href="../de454154/index.html">"Branches of Hell": Wolkenkontrolle von illegalen Deponien und gefährlichen Deponien</a></li>
<li><a href="../de454156/index.html">Reifen und Protokolle in der industriellen Automatisierung: wie alles funktioniert</a></li>
<li><a href="../de454160/index.html">Verwenden von PowerShell zum Erhöhen der Berechtigungen für lokale Konten</a></li>
<li><a href="../de454166/index.html">6. Juni - VeeamON Forum in Moskau</a></li>
<li><a href="../de454168/index.html">Die Hauptarena des Landes. Wie wurde Luzhniki vor der Weltmeisterschaft aktualisiert?</a></li>
<li><a href="../de454170/index.html">Willkommen zum DroidHeads Meetup am 8. Juni</a></li>
<li><a href="../de454172/index.html">Senden von Statistiken von einem DataFrame an BigQuery am Beispiel der Yandex.Direct-Statistik</a></li>
<li><a href="../de454176/index.html">Uibook - ein visuelles Testwerkzeug für React-Komponenten mit Medienabfragen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>