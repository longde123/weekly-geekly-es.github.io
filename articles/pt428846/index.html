<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§πüèæ ‚ÑπÔ∏è ‚ùóÔ∏è Trabalhando com seq√º√™ncias de caracteres no est√°gio de compila√ß√£o no C ++ moderno ‚úîÔ∏è üë©üèΩ‚Äçüç≥ ü§´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Se voc√™ programa em C ++, provavelmente se pergunta por que n√£o pode comparar dois literais de seq√º√™ncia de caracteres ou executar sua concatena√ß√£o: 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trabalhando com seq√º√™ncias de caracteres no est√°gio de compila√ß√£o no C ++ moderno</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428846/"><p><img src="https://habrastorage.org/webt/4i/nz/cv/4inzcv5q6x14bvgcv4b4l5fbzdi.jpeg"></p><br><p>  Se voc√™ programa em C ++, provavelmente se pergunta por que n√£o pode comparar dois literais de seq√º√™ncia de caracteres ou executar sua concatena√ß√£o: </p><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> str = <span class="hljs-string"><span class="hljs-string">"hello"</span></span> + <span class="hljs-string"><span class="hljs-string">"world"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   if ("hello" &lt; "world") { // ,    ,   // ... }</span></span></code> </pre> <br><p>  No entanto, como se costuma dizer, "√© imposs√≠vel, mas se voc√™ realmente quiser, poder√°."  Iremos quebrar estere√≥tipos sob o corte e logo na fase de compila√ß√£o. </p><a name="habracut"></a><br><h3 id="zachem-vse-eto-nuzhno">  Por que tudo isso √© necess√°rio </h3><br><p>  Em um dos projetos em que eu estava trabalhando, era costume usar std :: string como constantes de string.  O projeto tinha v√°rios m√≥dulos nos quais constantes globais de string foram definidas: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// plugin.h const std::string PLUGIN_PATH = "/usr/local/lib/project/plugins/"; // ...</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// sample_plugin.h const std::string SAMPLE_PLUGIN_LIB = PLUGIN_PATH + "sample.so"; // ...</span></span></code> </pre> <br><p>  Eu acho que voc√™ j√° adivinhou o que aconteceu um dia.  <code>SAMPLE_PLUGIN_PATH</code> assumiu o valor <code>"sample.so"</code> , apesar de <code>PLUGIN_PATH</code> ter o valor <code>"/usr/local/lib/project/plugins/"</code> , conforme o esperado.  Como isso p√¥de acontecer?  Tudo √© muito simples, a ordem de inicializa√ß√£o dos objetos globais n√£o est√° definida, no momento da inicializa√ß√£o <code>SAMPLE_PLUGIN_PATH</code> vari√°vel <code>PLUGIN_PATH</code> estava vazia. </p><br><p>  Al√©m disso, essa abordagem tem v√°rias desvantagens.  Primeiro, a exce√ß√£o lan√ßada ao criar um objeto global n√£o √© capturada.  Em segundo lugar, a inicializa√ß√£o ocorre durante a execu√ß√£o do programa, o que gasta um tempo valioso do processador. </p><br><p>  Foi ent√£o que tive a ideia de trabalhar com strings na fase de compila√ß√£o, o que acabou levando √† reda√ß√£o deste artigo. </p><br><p>  Neste artigo, consideraremos as linhas que podem ser operadas no est√°gio de compila√ß√£o.  Vamos chamar essas linhas de est√°ticas. </p><br><p>  Todas as opera√ß√µes implementadas foram inclu√≠das na biblioteca para trabalhar com cadeias est√°ticas.  O c√≥digo fonte da biblioteca est√° dispon√≠vel no github, o link est√° no final do artigo. </p><br><p>  √â necess√°rio pelo menos C ++ 14 para usar a biblioteca. </p><br><h3 id="opredelenie-staticheskoy-stroki">  Defini√ß√£o de cadeia est√°tica </h3><br><p>  Definimos uma string est√°tica como uma matriz de caracteres, por conveni√™ncia, assumimos que a string sempre termina com um caractere nulo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> static_string = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>, Size&gt;; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;<span class="hljs-number"><span class="hljs-number">6</span></span>&gt; hello = {<span class="hljs-string"><span class="hljs-string">'H'</span></span>, <span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span>, <span class="hljs-string"><span class="hljs-string">'o'</span></span>, <span class="hljs-string"><span class="hljs-string">'\0'</span></span>};</code> </pre> <br><p>  Aqui voc√™ pode seguir um caminho diferente e definir a sequ√™ncia como uma tupla de caracteres.  Essa op√ß√£o me pareceu mais demorada e menos conveniente.  Portanto, n√£o ser√° considerado aqui. </p><br><h3 id="sozdanie-staticheskoy-stroki">  Criando uma sequ√™ncia est√°tica </h3><br><p>  Olhe para a defini√ß√£o da linha Ol√° acima, √© simplesmente horr√≠vel.  Primeiro, precisamos pr√©-calcular o comprimento da matriz.  Em segundo lugar, voc√™ deve se lembrar de escrever o caractere nulo no final.  Em terceiro lugar, todas essas v√≠rgulas, colchetes e aspas.  Definitivamente, h√° algo a ser feito sobre isso.  Eu gostaria de escrever algo como isto: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> hello = make_static_string(<span class="hljs-string"><span class="hljs-string">"hello"</span></span>);</code> </pre> <br><p>  Aqui, uma das formas do modelo de vari√°vel nos ajudar√°, o que nos permite expandir os argumentos do modelo como √≠ndices para a inicializa√ß√£o agregada de nossa string est√°tica a partir de uma literal de string: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> ... (Indexes) + <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; make_static_string(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> (&amp; str)[Size]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {str[Indexes] ..., <span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; } <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> hello = make_static_string&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"hello"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// hello == "hello"</span></span></code> </pre> <br><p>  J√° √© melhor, mas os √≠ndices ainda precisam ser escritos √† m√£o.  Aqui tamb√©m observamos que, se voc√™ n√£o especificar todos os √≠ndices, poder√° obter uma substring de uma string literal e, se voc√™ os escrever na ordem inversa, ser√° inverso: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> hello1 = make_static_string&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"hello"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// hello1 == "ell" constexpr hello2 = make_static_string&lt;4, 3, 2, 1, 0&gt;("hello"); // hello2 == "olleh"</span></span></code> </pre> <br><p>  Essa considera√ß√£o ser√° muito √∫til para n√≥s no futuro. </p><br><p>  Agora, precisamos gerar de alguma forma uma sequ√™ncia de √≠ndices de linha.  Para fazer isso, aplique o truque de heran√ßa.  Defina uma estrutura vazia (voc√™ precisa herdar algo) com um conjunto de √≠ndices necess√°rios como par√¢metros do modelo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index_sequence</span></span></span><span class="hljs-class"> {</span></span>};</code> </pre> <br><p>  Definimos uma estrutura de gerador que ir√° gerar √≠ndices um de cada vez, armazenando o contador no primeiro par√¢metro: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_index_sequence</span></span></span><span class="hljs-class"> :</span></span> make_index_sequence&lt;Size - <span class="hljs-number"><span class="hljs-number">1</span></span>, Size - <span class="hljs-number"><span class="hljs-number">1</span></span>, Indexes ...&gt; {};</code> </pre> <br><p>  Tamb√©m cuidaremos do ponto final da recurs√£o, quando todos os √≠ndices forem gerados (o contador √© zero), descartamos o contador e o gerador se transforma na sequ√™ncia que precisamos: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_index_sequence</span></span></span><span class="hljs-class">&lt;0, Indexes ...&gt; :</span></span> index_sequence&lt;Indexes ...&gt; {};</code> </pre> <br><p>  Como resultado, a fun√ß√£o de criar uma string est√°tica ficar√° assim: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> ... (Indexes) + <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; make_static_string(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> (&amp; str)[Size], index_sequence&lt;Indexes ...&gt;) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {str[Indexes] ..., <span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; }</code> </pre> <br><p>  Escreveremos uma fun√ß√£o semelhante para uma string est√°tica; ser√° √∫til para n√≥s ainda mais: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> ... (Indexes) + <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; make_static_string(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size&gt;&amp; str, index_sequence&lt;Indexes ...&gt;) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {str[Indexes] ..., <span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; }</code> </pre> <br><p>  Al√©m disso, para cada fun√ß√£o que pega a string literal <code>foo(const char (&amp; str)[Size])</code> , escreveremos uma fun√ß√£o semelhante que pega a string est√°tica <code>foo(const static_string&lt;Size&gt;&amp; str)</code> .  Mas, por uma quest√£o de brevidade, n√£o vou mencionar isso. </p><br><p>  Como o comprimento da literal da string √© conhecido por n√≥s, podemos gerar automaticamente uma sequ√™ncia de √≠ndices, escreveremos um wrapper para a fun√ß√£o acima: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;Size&gt; make_static_string(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> (&amp; str)[Size]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> make_static_string(str, make_index_sequence&lt;Size - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;{}); }</code> </pre> <br><p>  Essa fun√ß√£o nos permite fazer exatamente o que quer√≠amos no in√≠cio do cap√≠tulo. </p><br><p>  Se n√£o houver argumentos, retornaremos uma string est√°tica vazia, que consiste apenas em um caractere nulo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt; make_static_string() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; }</code> </pre> <br><p>  Tamb√©m precisamos criar uma string a partir de uma tupla de caracteres: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> ... (Chars) + <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; make_static_string(char_sequence&lt;Chars ...&gt;) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {Chars ..., <span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; }</code> </pre> <br><p>  A prop√≥sito, tudo o que ser√° descrito mais adiante neste artigo √© baseado nas t√©cnicas descritas neste cap√≠tulo.  Portanto, se algo permanecer incompreens√≠vel, √© melhor reler o cap√≠tulo novamente. </p><br><h3 id="vyvod-staticheskoy-stroki-v-potok">  Sa√≠da de uma sequ√™ncia est√°tica para um fluxo </h3><br><p>  Tudo √© simples aqui.  Como nossa string termina com um caractere nulo, basta enviar os dados da matriz para o fluxo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::ostream&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>&lt;&lt;(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::ostream&amp; os, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size&gt;&amp; str) { os &lt;&lt; str.data(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> os; }</code> </pre> <br><h3 id="preobrazovanie-staticheskoy-stroki-v-stdstring">  Converter string est√°tica em std :: string </h3><br><p>  Nada complicado aqui tamb√©m.  Inicializamos a string com dados da matriz: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_string</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>(str.data()); }</code> </pre> <br><h3 id="sravnenie-staticheskih-strok">  Compara√ß√£o est√°tica de cadeias </h3><br><p>  Compararemos as linhas caractere por caractere at√© encontrarmos as diferen√ßas ou at√© chegarmos ao final de pelo menos uma das linhas.  Como o constexpr for ainda n√£o foi inventado, usamos a recurs√£o e o operador tern√°rio: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size1, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size2&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size1&gt;&amp; str1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size2&gt;&amp; str2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index &gt;= Size1 &amp;&amp; index &gt;= Size2 ? <span class="hljs-number"><span class="hljs-number">0</span></span> : index &gt;= Size1 ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : index &gt;= Size2 ? <span class="hljs-number"><span class="hljs-number">1</span></span> : str1[index] &gt; str2[index] ? <span class="hljs-number"><span class="hljs-number">1</span></span> : str1[index] &lt; str2[index] ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : static_string_compare(str1, str2, index + <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br><p>  No futuro, precisaremos de uma vers√£o estendida do comparador, apresentaremos um √≠ndice individual para cada uma de suas linhas e tamb√©m limitaremos o n√∫mero de caracteres comparados: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size1, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size2&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size1&gt;&amp; str1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size2&gt;&amp; str2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cur_length, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> max_length)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cur_length &gt; max_length || (index1 &gt;= Size1 &amp;&amp; index2 &gt;= Size2) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : index1 &gt;= Size1 ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : index2 &gt;= Size2 ? <span class="hljs-number"><span class="hljs-number">1</span></span> : str1[index1] &gt; str2[index2] ? <span class="hljs-number"><span class="hljs-number">1</span></span> : str1[index1] &lt; str2[index2] ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : static_string_compare(str1, index1 + <span class="hljs-number"><span class="hljs-number">1</span></span>, str2, index2 + <span class="hljs-number"><span class="hljs-number">1</span></span>, cur_length + <span class="hljs-number"><span class="hljs-number">1</span></span>, max_length); }</code> </pre> <br><p>  Esta vers√£o do comparador nos permitir√° comparar n√£o apenas a cadeia inteira, mas tamb√©m substrings individuais. </p><br><h3 id="konkatenaciya-staticheskih-strok">  Concatena√ß√£o de cadeias est√°ticas </h3><br><p>  Para concatena√ß√£o, usamos o mesmo modelo de vari√°vel que no cap√≠tulo sobre cria√ß√£o de uma sequ√™ncia est√°tica.  Inicialize a matriz primeiro com os caracteres da primeira linha (excluindo o caractere nulo), depois a segunda e, finalmente, adicione o caractere nulo ao final: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size1, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes1, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size2, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes2&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;Size1 + Size2 - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; static_string_concat_2( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size1&gt;&amp; str1, index_sequence&lt;Indexes1 ...&gt;, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size2&gt;&amp; str2, index_sequence&lt;Indexes2 ...&gt;) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {str1[Indexes1] ..., str2[Indexes2] ..., <span class="hljs-string"><span class="hljs-string">'\0'</span></span>}; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size1, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size2&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> static_string&lt;Size1 + Size2 - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; static_string_concat_2( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size1&gt;&amp; str1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size2&gt;&amp; str2) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_concat_2(str1, make_index_sequence&lt;Size1 - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;{}, str2, make_index_sequence&lt;Size2 - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;{}); }</code> </pre> <br><p>  Tamb√©m implementamos um modelo de vari√°vel para concatenar um n√∫mero arbitr√°rio de strings ou literais de strings: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_concat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> make_static_string(); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Arg, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> ... Args&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_concat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Arg&amp;&amp; arg, Args&amp;&amp; ... args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_concat_2(make_static_string(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Arg&gt;(arg)), static_string_concat(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Args&gt;(args) ...)); }</code> </pre> <br><h3 id="operacii-poiska-v-staticheskoy-stroke">  Opera√ß√µes de pesquisa de cadeia est√°tica </h3><br><p>  Considere a opera√ß√£o de procurar um caractere e uma substring em uma sequ√™ncia est√°tica. </p><br><h4 id="poisk-simvola-v-staticheskoy-stroke">  Procure um caractere em uma sequ√™ncia est√°tica </h4><br><p>  A pesquisa de caracteres n√£o √© particularmente dif√≠cil, verifique recursivamente os caracteres para todos os √≠ndices e retorne o primeiro √≠ndice em caso de correspond√™ncia.  Tamb√©m daremos a oportunidade de definir a posi√ß√£o inicial da pesquisa e o n√∫mero de sequ√™ncia da correspond√™ncia: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> || from &gt;= Size - <span class="hljs-number"><span class="hljs-number">1</span></span> ? static_string_npos : str[from] != ch ? static_string_find(str, ch, from + <span class="hljs-number"><span class="hljs-number">1</span></span>, nth) : nth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? static_string_find(str, ch, from + <span class="hljs-number"><span class="hljs-number">1</span></span>, nth - <span class="hljs-number"><span class="hljs-number">1</span></span>) : from; }</code> </pre> <br><p>  A constante <code>static_string_npos</code> indica que a pesquisa n√£o teve √™xito.  N√≥s o definimos da seguinte forma: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> static_string_npos = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::numeric_limits&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>&gt;::max();</code> </pre> <br><p>  Da mesma forma, implementamos uma pesquisa na dire√ß√£o oposta: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_rfind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> || from &gt; Size - <span class="hljs-number"><span class="hljs-number">2</span></span> ? static_string_npos : str[from] != ch ? static_string_rfind(str, ch, from - <span class="hljs-number"><span class="hljs-number">1</span></span>, nth) : nth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? static_string_rfind(str, ch, from - <span class="hljs-number"><span class="hljs-number">1</span></span>, nth - <span class="hljs-number"><span class="hljs-number">1</span></span>) : from; }</code> </pre> <br><h4 id="opredelenie-vhozhdeniya-simvola-v-staticheskuyu-stroku">  Determinando a ocorr√™ncia de um caractere em uma sequ√™ncia est√°tica </h4><br><p>  Para determinar a ocorr√™ncia de um personagem, tente procur√°-lo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_contains</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_find(str, ch) != static_string_npos; }</code> </pre> <br><h4 id="podschet-kolichestva-vhozhdeniy-simvola-v-staticheskuyu-stroku">  Contar o n√∫mero de ocorr√™ncias de um caractere em uma sequ√™ncia est√°tica </h4><br><p>  A contagem do n√∫mero de ocorr√™ncias √© implementada trivialmente: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index &gt;= Size - <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : (str[index] == ch ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>) + static_string_count(str, ch, index + <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br><h4 id="poisk-podstroki-v-staticheskoy-stroke">  Procure uma substring em uma sequ√™ncia est√°tica </h4><br><p>  Como se sup√µe que as linhas est√°ticas ser√£o relativamente pequenas, n√£o implementaremos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o algoritmo Knut-Morris-Pratt</a> aqui, implementaremos o algoritmo quadr√°tico mais simples: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; substr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; SubSize || from &gt; Size - SubSize ? static_string_npos : static_string_compare(str, from, substr, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, SubSize - <span class="hljs-number"><span class="hljs-number">1</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span> ? static_string_find(str, substr, from + <span class="hljs-number"><span class="hljs-number">1</span></span>, nth) : nth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? static_string_find(str, substr, from + <span class="hljs-number"><span class="hljs-number">1</span></span>, nth - <span class="hljs-number"><span class="hljs-number">1</span></span>) : from; }</code> </pre> <br><p>  Da mesma forma, implementamos uma pesquisa na dire√ß√£o oposta: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_rfind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; substr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; SubSize || from &gt; Size - SubSize ? static_string_npos : static_string_compare(str, from, substr, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, SubSize - <span class="hljs-number"><span class="hljs-number">1</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span> ? static_string_rfind(str, substr, from - <span class="hljs-number"><span class="hljs-number">1</span></span>, nth) : nth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? static_string_rfind(str, substr, from - <span class="hljs-number"><span class="hljs-number">1</span></span>, nth - <span class="hljs-number"><span class="hljs-number">1</span></span>) : from; }</code> </pre> <br><h4 id="opredelenie-vhozhdeniya-podstroki-v-staticheskuyu-stroku">  Determinando a ocorr√™ncia de uma substring em uma sequ√™ncia est√°tica </h4><br><p>  Para determinar a ocorr√™ncia de uma substring, tente procur√°-la: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_contains</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; substr)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_find(str, substr) != static_string_npos; }</code> </pre> <br><h4 id="opredelenie-nachinaetsyakonchaetsya-li-staticheskaya-stroka-sna-zadannoy-podstroki">  Determinando se uma sequ√™ncia est√°tica inicia / termina com / em uma determinada substring </h4><br><p>  Aplicando o comparador descrito anteriormente, podemos determinar se a sequ√™ncia est√°tica come√ßa com a substring fornecida: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_starts_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; prefix)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SubSize &gt; Size ? <span class="hljs-literal"><span class="hljs-literal">false</span></span> : static_string_compare(str, <span class="hljs-number"><span class="hljs-number">0</span></span>, prefix, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, SubSize - <span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p>  Da mesma forma para terminar uma linha est√°tica: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_ends_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; suffix)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SubSize &gt; Size ? <span class="hljs-literal"><span class="hljs-literal">false</span></span> : static_string_compare(str, Size - SubSize, suffix, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, SubSize - <span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><h3 id="rabota-s-podstrokami-staticheskoy-stroki">  Trabalhando com substrings de cadeia est√°tica </h3><br><p>  Aqui, examinamos as opera√ß√µes associadas √†s substrings de uma string est√°tica. </p><br><h4 id="poluchenie-podstroki-prefiksa-i-suffiksa-staticheskoy-stroki">  Obtendo substring, prefixo e sufixo de uma string est√°tica </h4><br><p>  Como observamos anteriormente, para obter uma substring, voc√™ precisa gerar uma sequ√™ncia de √≠ndices, com os √≠ndices iniciais e finais fornecidos: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Begin, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> End, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_index_subsequence</span></span></span><span class="hljs-class"> :</span></span> make_index_subsequence&lt;Begin, End - <span class="hljs-number"><span class="hljs-number">1</span></span>, End - <span class="hljs-number"><span class="hljs-number">1</span></span>, Indexes ...&gt; {}; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Pos, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_index_subsequence</span></span></span><span class="hljs-class">&lt;Pos, Pos, Indexes ...&gt; :</span></span> index_sequence&lt;Indexes ...&gt; {};</code> </pre> <br><p>  Implementamos a obten√ß√£o de uma substring com a verifica√ß√£o do in√≠cio e do fim de uma substring usando <code>static_assert</code> : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Begin, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> End, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_substring</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(Begin &lt;= End, <span class="hljs-string"><span class="hljs-string">"Begin is greater than End (Begin &gt; End)"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(End &lt;= Size - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"End is greater than string length (End &gt; Size - 1)"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> make_static_string(str, make_index_subsequence&lt;Begin, End&gt;{}); }</code> </pre> <br><p>  O prefixo √© uma substring cujo in√≠cio coincide com o in√≠cio da linha est√°tica original: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> End, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_prefix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_substring&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>, End&gt;(str); }</code> </pre> <br><p>  Da mesma forma para o sufixo, apenas o final corresponde: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Begin, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_suffix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_substring&lt;Begin, Size - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(str); }</code> </pre> <br><h4 id="razdelenie-staticheskoy-stroki-na-dve-chasti-po-zadannomu-indeksu">  Dividindo uma sequ√™ncia est√°tica em duas partes em um determinado √≠ndice </h4><br><p>  Para dividir uma sequ√™ncia est√°tica em um determinado √≠ndice, basta retornar o prefixo e o sufixo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Index, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_split</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_pair(static_string_prefix&lt;Index&gt;(str), static_string_suffix&lt;Index + <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(str)); }</code> </pre> <br><h4 id="reversirovanie-staticheskoy-stroki">  Revers√£o est√°tica de string </h4><br><p>  Para reverter uma string est√°tica, escrevemos um gerador de √≠ndice que gera √≠ndices na ordem inversa: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_reverse_index_sequence</span></span></span><span class="hljs-class"> :</span></span> make_reverse_index_sequence&lt;Size - <span class="hljs-number"><span class="hljs-number">1</span></span>, Indexes ..., Size - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; {}; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> ... Indexes&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_reverse_index_sequence</span></span></span><span class="hljs-class">&lt;0, Indexes ...&gt; :</span></span> index_sequence&lt;Indexes ...&gt; {};</code> </pre> <br><p>  Agora, implementamos uma fun√ß√£o que reverte a string est√°tica: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_reverse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> make_static_string(str, make_reverse_index_sequence&lt;Size - <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;{}); }</code> </pre> <br><h3 id="vychislenie-hesha-staticheskoy-stroki">  C√°lculo de hash de cadeia est√°tica </h3><br><p>  Vamos calcular o hash usando a seguinte f√≥rmula: </p><br><p>  H (s) = (s <sub>0</sub> + 1) ‚ãÖ 33 <sup>0</sup> + (s <sub>1</sub> + 1) ‚ãÖ 33 <sup>1</sup> + ... + (s <sub>n - 1</sub> + 1) ‚ãÖ 33 <sup>n - 1</sup> + 5381 ‚ãÖ 33 <sup>n</sup> mod 2 <sup>64</sup> </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index &gt;= Size - <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-number"><span class="hljs-number">5381U</span></span>LL : static_string_hash(str, index + <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-number"><span class="hljs-number">33U</span></span>LL + str[index] + <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><h3 id="preobrazovanie-chisla-v-staticheskuyu-stroku-i-obratno">  Converter um n√∫mero em uma sequ√™ncia est√°tica e vice-versa </h3><br><p>  Neste cap√≠tulo, examinamos a convers√£o de uma sequ√™ncia est√°tica em um n√∫mero inteiro, bem como a inversa.  Por uma quest√£o de simplicidade, assumimos que os n√∫meros s√£o representados por tipos <code>long long</code> e <code>unsigned long long</code> , estes s√£o tipos de grande capacidade, ou seja, s√£o adequados para a maioria dos casos. </p><br><h4 id="preobrazovanie-chisla-v-staticheskuyu-stroku">  Converter um n√∫mero em uma sequ√™ncia est√°tica </h4><br><p>  Para converter um n√∫mero em uma sequ√™ncia est√°tica, precisamos obter todos os d√≠gitos do n√∫mero, convert√™-los nos caracteres correspondentes e criar uma sequ√™ncia desses caracteres. </p><br><p>  Para obter todos os d√≠gitos de um n√∫mero, usaremos um gerador semelhante ao gerador de sequ√™ncia de √≠ndice.  Defina uma sequ√™ncia de caracteres: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char_sequence</span></span></span><span class="hljs-class"> {</span></span>};</code> </pre> <br><p>  Implementamos um gerador de caracteres de d√≠gito, armazenando o n√∫mero atual no primeiro par√¢metro e os n√∫meros a seguir, o pr√≥ximo d√≠gito √© adicionado ao in√≠cio da sequ√™ncia e o n√∫mero √© dividido por dez: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Value, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_unsigned_int_char_sequence</span></span></span><span class="hljs-class"> :</span></span> make_unsigned_int_char_sequence&lt;Value / <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span> + Value % <span class="hljs-number"><span class="hljs-number">10</span></span>, Chars ...&gt; {};</code> </pre> <br><p>  Se o n√∫mero atual for 0, ent√£o o descartamos, retornando uma sequ√™ncia de d√≠gitos, n√£o h√° mais nada para converter: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_unsigned_int_char_sequence</span></span></span><span class="hljs-class">&lt;0, Chars ...&gt; :</span></span> char_sequence&lt;Chars ...&gt; {};</code> </pre> <br><p>  Voc√™ tamb√©m deve levar em considera√ß√£o o caso em que o n√∫mero inicial √© zero; nesse caso, voc√™ precisa retornar um caractere nulo; caso contr√°rio, zero ser√° convertido em uma sequ√™ncia de caracteres vazia e, em seguida, em uma string vazia: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_unsigned_int_char_sequence</span></span></span><span class="hljs-class">&lt;0&gt; :</span></span> char_sequence&lt;<span class="hljs-string"><span class="hljs-string">'0'</span></span>&gt; {};</code> </pre> <br><p>  O gerador implementado funciona muito bem para n√∫meros positivos, mas n√£o √© adequado para n√∫meros negativos.  Definimos um novo gerador adicionando mais um par√¢metro de modelo ao in√≠cio - o sinal do n√∫mero convertido: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> Negative, <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Value, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_signed_int_char_sequence</span></span></span><span class="hljs-class"> {</span></span>};</code> </pre> <br><p>  Processaremos o n√∫mero como mostrado acima, mas levando em considera√ß√£o o sinal: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Value, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_signed_int_char_sequence</span></span></span><span class="hljs-class">&lt;true, Value, Chars ...&gt; :</span></span> make_signed_int_char_sequence&lt;<span class="hljs-literal"><span class="hljs-literal">true</span></span>, Value / <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span> + -(Value % <span class="hljs-number"><span class="hljs-number">10</span></span>), Chars ...&gt; {}; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Value, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_signed_int_char_sequence</span></span></span><span class="hljs-class">&lt;false, Value, Chars ...&gt; :</span></span> make_signed_int_char_sequence&lt;<span class="hljs-literal"><span class="hljs-literal">false</span></span>, Value / <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span> + Value % <span class="hljs-number"><span class="hljs-number">10</span></span>, Chars ...&gt; {};</code> </pre> <br><p>  H√° um ponto sutil aqui, preste aten√ß√£o em <code>-(Value % 10)</code> .  Aqui, voc√™ n√£o pode <code>-Value % 10</code> , pois o intervalo de n√∫meros negativos √© um n√∫mero maior que o intervalo de positivos e o m√≥dulo de n√∫mero m√≠nimo fica fora do conjunto de valores v√°lidos. </p><br><p>  Descartamos o n√∫mero ap√≥s o processamento, se for negativo, adicione o s√≠mbolo de sinal de menos: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_signed_int_char_sequence</span></span></span><span class="hljs-class">&lt;true, 0, Chars ...&gt; :</span></span> char_sequence&lt;<span class="hljs-string"><span class="hljs-string">'-'</span></span>, Chars ...&gt; {}; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ... Chars&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_signed_int_char_sequence</span></span></span><span class="hljs-class">&lt;false, 0, Chars ...&gt; :</span></span> char_sequence&lt;Chars ...&gt; {};</code> </pre> <br><p>  Separadamente, cuidamos da convers√£o de zero: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">make_signed_int_char_sequence</span></span></span><span class="hljs-class">&lt;false, 0&gt; :</span></span> char_sequence&lt;<span class="hljs-string"><span class="hljs-string">'0'</span></span>&gt; {};</code> </pre> <br><p>  Por fim, implementamos as fun√ß√µes de convers√£o: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Value&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint_to_static_string</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> make_static_string(make_unsigned_int_char_sequence&lt;Value&gt;{}); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> Value&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int_to_static_string</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> make_static_string(make_signed_int_char_sequence&lt;(Value &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>), Value&gt;{}); }</code> </pre> <br><h4 id="preobrazovanie-staticheskoy-stroki-v-chislo">  Converter string est√°tica em n√∫mero </h4><br><p>  Para converter uma sequ√™ncia est√°tica em um n√∫mero, voc√™ precisa converter os caracteres em n√∫meros e adicion√°-los, multiplicando anteriormente as dezenas pela pot√™ncia correspondente.  Executamos todas as a√ß√µes recursivamente, para uma string vazia retornamos zero: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_to_uint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> || index &gt;= Size - <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : (str[index] - <span class="hljs-string"><span class="hljs-string">'0'</span></span>) + <span class="hljs-number"><span class="hljs-number">10U</span></span>LL * static_string_to_uint(str, index - <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_to_uint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_to_uint(str, Size - <span class="hljs-number"><span class="hljs-number">2</span></span>); }</code> </pre> <br><p>  Para converter n√∫meros assinados, observe que os n√∫meros negativos come√ßam com um sinal de menos: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_to_int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> first)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index &lt; first || index &gt;= Size - <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : first == <span class="hljs-number"><span class="hljs-number">0</span></span> ? (str[index] - <span class="hljs-string"><span class="hljs-string">'0'</span></span>) + <span class="hljs-number"><span class="hljs-number">10L</span></span>L * static_string_to_int(str, index - <span class="hljs-number"><span class="hljs-number">1</span></span>, first) : -(str[index] - <span class="hljs-string"><span class="hljs-string">'0'</span></span>) + <span class="hljs-number"><span class="hljs-number">10L</span></span>L * static_string_to_int(str, index - <span class="hljs-number"><span class="hljs-number">1</span></span>, first); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static_string_to_int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;Size&gt;&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : str[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'-'</span></span> ? static_string_to_int(str, Size - <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) : static_string_to_int(str, Size - <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre> <br><h3 id="voprosy-udobstva-ispolzovaniya-biblioteki">  Considera√ß√µes sobre a usabilidade da biblioteca </h3><br><p>  Neste ponto, a biblioteca j√° pode ser totalmente usada, mas alguns pontos s√£o inconvenientes.  Neste cap√≠tulo, veremos como voc√™ pode tornar o uso da biblioteca mais conveniente. </p><br><h4 id="obekt-staticheskoy-stroki">  Objeto de cadeia est√°tica </h4><br><p>  Empacote a string e os m√©todos implementados em um objeto.  Isso permitir√° o uso de nomes de m√©todos mais curtos, al√©m de implementar operadores de compara√ß√£o: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_string</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">begin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rbegin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size - <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::numeric_limits&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>&gt;::max(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">empty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Size &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reverse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_reverse(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Begin, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> End&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">substring</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_substring&lt;Begin, End&gt;(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> End&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prefix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_prefix&lt;End&gt;(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Begin&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">suffix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_suffix&lt;Begin&gt;(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_find(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ch, from, nth); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; substr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_find(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, substr, from, nth); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (&amp; substr)[SubSize], </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_find(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, substr, from, nth); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rfind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from = Size - </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_rfind(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ch, from, nth); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rfind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; substr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from = Size - SubSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_rfind(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, substr, from, nth); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rfind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (&amp; substr)[SubSize], </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> from = Size - SubSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nth = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_rfind(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, substr, from, nth); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contains</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_contains(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ch); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contains</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; substr)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_contains(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, substr); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contains</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (&amp; substr)[SubSize])</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_contains(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, substr); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">starts_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; prefix)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_starts_with(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, prefix); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">starts_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (&amp; prefix)[SubSize])</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_starts_with(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, prefix); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ends_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> static_string&lt;SubSize&gt;&amp; suffix)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_ends_with(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, suffix); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> SubSize&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ends_with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (&amp; suffix)[SubSize])</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_ends_with(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, suffix); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> size_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_count(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ch); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Index&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_split&lt;Index&gt;(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsigned</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_hash(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>[](<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> index) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data[index]; } <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">str</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> to_string(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>, Size&gt; data; };</code> </pre> <br><h4 id="operatory-sravneniya">   </h4><br><p>        .    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size1, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size2&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>&lt;(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size1&gt;&amp; str1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> static_string&lt;Size2&gt;&amp; str2) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> static_string_compare(str1, str2) &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p>     &gt; &lt;= &gt;= == !=,         .      - . </p><br><h4 id="makrosy-raboty-s-chislami">     </h4><br><p>            : </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ITOSS(x) int_to_static_string</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;(x)&gt;() #define UTOSS(x) uint_to_static_string&lt;(x)&gt;() #define SSTOI(x) static_string_to_int((x)) #define SSTOU(x) static_string_to_uint((x))</span></span></span></span></code> </pre> <br><h3 id="primery-ispolzovaniya-biblioteki">    </h3><br><p>       . </p><br><p>      : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> hello = make_static_string(<span class="hljs-string"><span class="hljs-string">"Hello"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> world = make_static_string(<span class="hljs-string"><span class="hljs-string">"World"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> greeting = hello + <span class="hljs-string"><span class="hljs-string">", "</span></span> + world + <span class="hljs-string"><span class="hljs-string">"!"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// greeting == "Hello, World!"</span></span></code> </pre> <br><p>   ,    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> apples = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> oranges = <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> message = static_string_concat(<span class="hljs-string"><span class="hljs-string">"I have "</span></span>, ITOSS(apples), <span class="hljs-string"><span class="hljs-string">" apples and "</span></span>, ITOSS(oranges), <span class="hljs-string"><span class="hljs-string">", so I have "</span></span>, ITOSS(apples + oranges), <span class="hljs-string"><span class="hljs-string">" fruits"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// message = "I have 5 apples and 7 oranges, so I have 12 fruits"</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> width = <span class="hljs-number"><span class="hljs-number">123456789U</span></span>LL; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> height = <span class="hljs-number"><span class="hljs-number">987654321U</span></span>LL; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> message = static_string_concat(<span class="hljs-string"><span class="hljs-string">"A rectangle with width "</span></span>, UTOSS(width), <span class="hljs-string"><span class="hljs-string">" and height "</span></span>, UTOSS(height), <span class="hljs-string"><span class="hljs-string">" has area "</span></span>, UTOSS(width * height)); <span class="hljs-comment"><span class="hljs-comment">// message = "A rectangle with width 123456789 and height 987654321 has area 121932631112635269"</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> revenue = <span class="hljs-number"><span class="hljs-number">1'000'000L</span></span>L; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> costs = <span class="hljs-number"><span class="hljs-number">1'200'000L</span></span>L; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> profit = revenue - costs; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> message = static_string_concat(<span class="hljs-string"><span class="hljs-string">"The first quarter has ended with net "</span></span>, (profit &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-string"><span class="hljs-string">"profit"</span></span> : <span class="hljs-string"><span class="hljs-string">"loss "</span></span>), <span class="hljs-string"><span class="hljs-string">" of $"</span></span>, ITOSS(profit &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? -profit : profit)); <span class="hljs-comment"><span class="hljs-comment">// message == "The first quarter has ended with net loss of $200000"</span></span></code> </pre> <br><p>  URL: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> url = make_static_string(<span class="hljs-string"><span class="hljs-string">"http://www.server.com:8080"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> p = url.find(<span class="hljs-string"><span class="hljs-string">"://"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> protocol = url.prefix&lt;p&gt;(); <span class="hljs-comment"><span class="hljs-comment">// protocol == "http" constexpr auto sockaddr = url.suffix&lt;p + 3&gt;(); constexpr auto hp = sockaddr.split&lt;sockaddr.find(':')&gt;(); constexpr auto host = hp.first; // host == "www.server.com" constexpr int port = SSTOI(hp.second); // port == 8080</span></span></code> </pre> <br><p>      : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> str = make_static_string(<span class="hljs-string"><span class="hljs-string">"Hello"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> i = str.begin(); i != str.end(); ++i) <span class="hljs-comment"><span class="hljs-comment">//  std::cout &lt;&lt; str[i]; std::cout &lt;&lt; std::endl; // Hello for (size_t i = str.rbegin(); i != str.rend(); --i) //  std::cout &lt;&lt; str[i]; std::cout &lt;&lt; std::endl; // olleH</span></span></code> </pre> <br><h3 id="ssylki">  Refer√™ncias </h3><br><p> ,   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> </p><br><p>   ,    . </p><br><h3 id="update"> Update </h3><br><p>    _ss       : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Char, Char ... Chars&gt; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> basic_static_string&lt;Char, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span> ... (Chars) + <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span><span class="hljs-string"><span class="hljs-string">""</span></span> _ss() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {Chars ..., <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Char&gt;(<span class="hljs-string"><span class="hljs-string">'\0'</span></span>)}; };</code> </pre> <br><p>  make_static_string()    ,    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> hello_world = <span class="hljs-string"><span class="hljs-string">"Hello"</span></span>_ss + <span class="hljs-string"><span class="hljs-string">" World"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"Hello"</span></span> &lt; <span class="hljs-string"><span class="hljs-string">"World"</span></span>_ss) { ... } <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> hash = <span class="hljs-string"><span class="hljs-string">"VeryLongString"</span></span>_ss.hash();</code> </pre> <br><p>    Char  char: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Char, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">basic_static_string</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">// ... std::array&lt;const Char, Size&gt; data; };</span></span></code> </pre> <br><p>    char  whar_t,     ,    concat,      : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static_string_t</span></span> = basic_static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>, Size&gt;; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> Size&gt; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static_wstring_t</span></span> = basic_static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">wchar_t</span></span>, Size&gt;; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> static_string = basic_static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>&gt;; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> static_wstring = basic_static_string&lt;<span class="hljs-keyword"><span class="hljs-keyword">wchar_t</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>&gt;;</code> </pre> <br><p>      "" : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> wide_string = <span class="hljs-string"><span class="hljs-string">L"WideString"</span></span>_ss; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> apples = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> oranges = <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fruits = apples + oranges; <span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> str3 = static_wstring::concat(<span class="hljs-string"><span class="hljs-string">L"I have "</span></span>, ITOSW(apples), <span class="hljs-string"><span class="hljs-string">L" apples and "</span></span>, ITOSW(oranges), <span class="hljs-string"><span class="hljs-string">L" oranges, so I have "</span></span>, ITOSW(fruits), <span class="hljs-string"><span class="hljs-string">L" fruits"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(str3 == <span class="hljs-string"><span class="hljs-string">L"I have 5 apples and 7 oranges, so I have 12 fruits"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wcout &lt;&lt; str3 &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>;</code> </pre> <br><p>   size(),  size()  length()       ,       sizeof(): </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">constexpr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> ss1 = <span class="hljs-string"><span class="hljs-string">"Hello"</span></span>_ss; <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(ss1.length() == <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(ss1.size() == <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ss1) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>);</code> </pre> <br><p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> <br>     . </p><br><h3 id="update-2"> Update 2 </h3><br><p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">AndreySu</a>       ,      : </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; using namespace std; template&lt;typename Char, Char ... Chars&gt; struct static_string{}; template&lt;typename Char, Char ... Chars1, Char ... Chars2&gt; constexpr static_string&lt;Char, Chars1 ..., Chars2 ... &gt; operator+( const static_string&lt;Char, Chars1 ... &gt;&amp; str1, const static_string&lt;Char, Chars2 ... &gt;&amp; str2) { return static_string&lt;Char, Chars1 ..., Chars2 ...&gt;{}; } template&lt;typename Char, Char ch, Char ... Chars&gt; std::basic_ostream&lt;Char&gt;&amp; operator&lt;&lt;(std::basic_ostream&lt;Char&gt;&amp; bos, const static_string&lt;Char, ch, Chars ...&gt;&amp; str) { bos &lt;&lt; ch &lt;&lt; static_string&lt;Char, Chars ... &gt;{}; return bos; } template&lt;typename Char&gt; std::basic_ostream&lt;Char&gt;&amp; operator&lt;&lt;(std::basic_ostream&lt;Char&gt;&amp; bos, const static_string&lt;Char&gt;&amp; str) { return bos; } template&lt;typename Char, Char ... Chars&gt; constexpr static_string&lt;Char, Chars ... &gt; operator"" _ss() { return static_string&lt;Char, Chars ... &gt;{}; }; int main() { constexpr auto str1 = "abc"_ss; constexpr auto str2 = "def"_ss; constexpr auto str = str1 + str2 + str1; std::cout &lt;&lt; str &lt;&lt; std::endl; return 0; }</span></span></span></span></code> </pre> <br><p>        ,  ,  -       . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt428846/">https://habr.com/ru/post/pt428846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt428834/index.html">Metade dos carros vendidos na Noruega - carros el√©tricos</a></li>
<li><a href="../pt428836/index.html">IA treinada para tratar envenenamento do sangue e diagnosticar fraturas</a></li>
<li><a href="../pt428840/index.html">Partindo - sair? Conversa noturna sobre demiss√µes</a></li>
<li><a href="../pt428842/index.html">Eventos digitais em Moscou, de 6 a 11 de novembro</a></li>
<li><a href="../pt428844/index.html">Leitura do medidor em casa</a></li>
<li><a href="../pt428848/index.html">Notas do provedor de IoT: como criar uma rede LoRa em uma cidade sem rede em um dia?</a></li>
<li><a href="../pt428850/index.html">Gerenciamento de desenvolvimento em um grande projeto</a></li>
<li><a href="../pt428852/index.html">Transmiss√£o aberta do sal√£o principal HighLoad ++ 2018</a></li>
<li><a href="../pt428854/index.html">Como cortar a luz em um pequeno data center: uma maneira barata de implantar emerg√™ncias</a></li>
<li><a href="../pt428856/index.html">Um truque maravilhoso para tornar um mantenedor de projeto de c√≥digo aberto por dia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>