<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôªÔ∏è üë≤üèª üëÉ Robo Fu√üballspieler von Anf√§ngern. Wettbewerbe bei MIPT. Android & Arduino & Bluetooth üßñüèª üé∑ üõ≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel ist eine Halbfolge der Arbeit von Love, Death and Robots: ‚ÄûDie vom Android-Ger√§t √ºber Bluetooth gesteuerte Arduino-basierte Maschine is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Robo Fu√üballspieler von Anf√§ngern. Wettbewerbe bei MIPT. Android & Arduino & Bluetooth</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448080/">  Dieser Artikel ist eine Halbfolge der Arbeit von <s>Love, Death and Robots:</s> ‚ÄûDie vom Android-Ger√§t √ºber Bluetooth gesteuerte Arduino-basierte Maschine ist ein vollst√§ndiger Zyklus‚Äú, der aus zwei Teilen besteht ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einer</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zwei</a> ).  Die dort beschriebenen Dinge wurden leicht modifiziert, √ºberarbeitet und der Roboter selbst von einer Reisemaschine in einen Fu√üballspieler verwandelt.  Im Allgemeinen gibt es interessantes Material dazu. <br><br>  Die vorherige Anweisung war in zwei Teile unterteilt: Software und physische.  Es gab nicht so viele √Ñnderungen in beide Richtungen, also ist diesmal alles in einer Kopie.  Ich werde Sie kurz daran erinnern, warum der beschriebene Teil ben√∂tigt wird, aber f√ºr ein vollst√§ndiges Verst√§ndnis ist es besser, die ersten beiden Teile durchzugehen. <br><a name="habracut"></a><br><h2>  Physischer Teil </h2><br>  Basierend auf denselben Prinzipien, die im ersten Artikel beschrieben wurden: <br><br><ul><li>  Sandwich von Arduino Uno und Motor Shield. </li><li>  zwei Motoren mit dem Motorschild verbunden. </li></ul><br>  Und hier sind die √Ñnderungen: <br><br><ul><li>  Seltsamerweise war der Schockteil daf√ºr verantwortlich, den Ball zu treffen. </li><li>  Der Fall ist jetzt ganz mein, gedruckt auf einem 3D-Drucker. </li></ul><br><h3>  Geh√§use </h3><br>  Eine Form ist ein Kreis, in den sowohl ein Brett als auch zwei R√§der passen.  Verl√§ngerung f√ºr den Teil, an dem die Aufprallkraft stehen wird. <br><br><img src="https://habrastorage.org/webt/_y/3l/ei/_y3lei6subbvm0y1qfltplolwcg.jpeg"><br><br>  Beachten Sie bei der Gestaltung Folgendes: <br><br><ul><li>  Hohe Seiten.  Roboter kollidieren w√§hrend des Spiels, die Seiten sch√ºtzen nicht nur Ihre Dr√§hte, sondern auch Ihre Rivalen vor Ihren Dr√§hten. </li><li>  Schwerpunkt und Stabilit√§t.  Der Schwerpunkt liegt nat√ºrlich dort, wo sich das Brett befindet.  Die R√§der befinden sich in der N√§he, damit sie nicht verrutschen.  Au√üerdem befindet sich oben auf der Platine eine Batterie. </li><li>  Um zu verhindern, dass der Roboter seine Nase oder seinen R√ºcken pickt, setzen wir hier und da B√§lle aus den Ampere in das Kit ein (wenn sie nicht vorhanden sind, k√∂nnen Sie sie durch ein anderes Gleitdesign ersetzen). </li><li>  Starrheit eines Designs.  Die Plattform darf nicht unter dem Gewicht von Leiterplatten und Motoren durchh√§ngen.  Verwenden Sie keine harten Materialien (Sperrholz) und verst√§rken Sie die Kunststoffstruktur nicht mit Gestellen </li></ul><br><img src="https://habrastorage.org/webt/cl/pn/a0/clpna0fp8fdkx_jys3g5dq505iy.jpeg"><br><br><h3>  Und jetzt der Hauptquatsch </h3><br>  B√§lle, die mangels "Picken" hinzugef√ºgt wurden, hoben die Plattform an, so dass die R√§der den Boden nicht erreichten.  Um dies zu vermeiden, verwenden wir entweder R√§der mit gr√∂√üerem Durchmesser oder k√ºrzen die Tragstrukturen.  In der Regel berechnen wir dies im Voraus! <br><br>  Schockteil.  Sie schl√§gt nicht.  Beats, aber nicht cool genug.  In unserem ersten Modell gab es eine Servomaschine, an die ein Teil √§hnlich einem Schneepflugschaufel angeschlossen war.  Durch √Ñndern der Position des Servos (von 0 auf 30 Grad) k√∂nnen Sie einen Schlag simulieren.  Aber die Servos erwiesen sich als langsam, so dass der Schlag auf die Zwei geht. <br><br>  Es gibt zwei M√∂glichkeiten: Beim Aufprall einen Ruck hinzuf√ºgen oder Servos durch Magnetspulen ersetzen.  Die erste M√∂glichkeit besteht darin, den Impuls zu erh√∂hen, indem die R√§der w√§hrend eines Hubs mit Geschwindigkeit versorgt werden.  In der Praxis ist dies wie folgt: Der Benutzer dr√ºckt die Treffer-Taste, der Roboter startet von der Stelle (leicht) und schl√§gt gleichzeitig zu. <br><br>  Die zweite Option - die Magnete dr√ºcken auf den Sto√üd√§mpfer, und hier h√§ngt alles von der Leistung (Geschwindigkeit) des Sto√üd√§mpfers ab, was wiederum von den Eigenschaften des Magneten abh√§ngt. <br><br><img src="https://habrastorage.org/webt/ma/da/23/mada23ag3yr3pttwrtk9oxcfzyq.jpeg"><br><br><h2>  Software-Teil </h2><br>  Nach einer guten Tradition, die bereits ein Artikel ist, werden wir diesen Abschnitt in zwei Teile teilen.  Zuerst eine Android-App, dann eine Arduino-Skizze. <br><br><h3>  Android </h3><br>  Ich m√∂chte Sie daran erinnern, dass die Bewerbung von mir von Grund auf neu geschrieben wurde.  In den letzten sechs Monaten habe ich in dieser Angelegenheit etwas mehr verstanden, daher werde ich beschreiben, woran <s>Doper</s> gedacht hat. <br><br>  Lassen Sie uns zun√§chst zur Vereinfachung gehen.  Das Kommunikationsprotokoll lautet nun wie folgt: "Er√∂ffnungszeichen" + "Wert" + "Schlie√üzeichen" (Um zu verstehen, wie ich diese Werte erhalte und worum es geht, lesen Sie die vollst√§ndige Analyse der Anwendung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ).  Dies funktioniert sowohl f√ºr Geschwindigkeit als auch f√ºr Winkel.  Da es nur eine Art von Streik gibt, braucht er keine solche Weisheit, daher besteht das Team aus einem ‚Äû/‚Äú -Zeichen (√ºber das Treffer-Team durch den Absatz). <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String speed, String angle)</span></span></span><span class="hljs-function"> </span></span>{ String speedCommand = <span class="hljs-string"><span class="hljs-string">"#"</span></span> + speed + <span class="hljs-string"><span class="hljs-string">"#"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     String angleCommand = "@" + angle + "@"; try { outputStream.write(speedCommand.getBytes()); //   outputStream.write(angleCommand.getBytes()); } catch(Exception e) { e.printStackTrace(); } }</span></span></code> </pre> <br>  Ein typischer Befehl w√ºrde folgenderma√üen aussehen: # 125 # @ 180 @, wobei 125 Geschwindigkeit und 180 Winkel ist.  Nat√ºrlich kann dies noch vereinfacht werden, aber eine der Aufgaben bestand darin, die Leichtigkeit und Lesbarkeit aufrechtzuerhalten, damit es sp√§ter auch f√ºr Kinder leicht erkl√§rt werden kann. <br><br>  Ein neuer sendHit () -Befehl wurde angezeigt, der ausgel√∂st wird, wenn die Taste ‚ÄûHit‚Äú gedr√ºckt wird.  Sie sendet ein einzelnes "/".  Da gew√∂hnliches Bluetooth 2.0+ nicht unter gleichzeitig empfangenen Daten leidet, das hei√üt, es wei√ü, wie man sie in die Warteschlange stellt und nicht verliert, m√ºssen wir dies nicht kontrollieren.  Wenn Sie mit Bluetooth Low Energy 4.0+ arbeiten m√∂chten (nun, pl√∂tzlich), muss die Warteschlange bereits manuell organisiert werden, da sonst die Daten verloren gehen. <br><br><pre> <code class="java hljs">... bHit = findViewById(R.id.b_high_hit); <span class="hljs-comment"><span class="hljs-comment">//   bHit.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { threadCommand.sendHit(); //     "" } }); ... private void sendHit() { try { outputStream.write("/".getBytes()); //   }catch (Exception e) { e.printStackTrace(); } } }</span></span></code> </pre><br><h3>  Arduino </h3><br>  Das Protokoll zum Senden von Befehlen hat sich also ge√§ndert, und auch der Empfangsalgorithmus hat sich ge√§ndert.  Er vereinfachte.  Ein, wenn Tracking-Kick hinzugef√ºgt wurde.  Eine vollst√§ndige Analyse der Skizze finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  bt.read () liest ein Zeichen.  Wenn es "#" ist, beginnen die Geschwindigkeitssymbole.  Wir lesen sie, bis das schlie√üende Zeichen "#" erscheint.  Die for-Schleife kann hier nicht verwendet werden, da die Geschwindigkeitsl√§nge nicht im Voraus bekannt ist (es kann sich um eine einstellige, zweistellige oder dreistellige Zahl handeln).  Der resultierende Wert wird in die Variable geschrieben. <br><br>  Das gleiche passiert mit einer Wende.  Nachdem sowohl Geschwindigkeit als auch Winkel gelesen wurden, √ºbergeben wir alles an die Funktion turn (int speed, int angle). <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(BTSerial.available() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<span class="hljs-comment"><span class="hljs-comment">//    char a = BTSerial.read(); //   if(a == '#') { //  sp=""; char b = BTSerial.read(); while( b != '#') { //   ,     sp+=b; b = BTSerial.read(); } } else if (a == '@') {//  val = ""; char b = BTSerial.read(); while(b != '@') { //    val+=b; //    b = BTSerial.read(); } turn(val.toInt(), sp.toInt()); //   ,   } else if (a == '/') { //,    Serial.println(a); servo.write(30); //  delay(150); servo.write(0); //    } lastTakeInformation = millis(); } else { if(millis() - lastTakeInformation &gt; 150) { //     150 //  lastTakeInformation = 0; analogWrite(speedRight, 0); analogWrite(speedLeft, 0); } } delay(5); }</span></span></code> </pre><br>  Die Funktion turn () bestimmt, in welche Richtung (vorw√§rts, r√ºckw√§rts) und wohin (rechts, links, gerade) gedreht werden soll.  Die Einschr√§nkung if (Geschwindigkeit&gt; 0 &amp;&amp; Geschwindigkeit &lt;70) ist erforderlich, damit der Roboter nicht langsamer wird, wenn Bytes verloren gehen.  Angesichts dessen, als ich die √úbertragungsgeschwindigkeit erh√∂hte (gespielt mit Verz√∂gerungen von 100-300 ms zwischen den Teams) - manchmal erreichte der Geschwindigkeitswert nicht und wurde zu 0, 40 (obwohl zum Beispiel 240 tats√§chlich gesendet wurde).  Kr√ºcke, aber es funktioniert. <br>  Es kann als "Schutz vor unkontrollierbaren Faktoren" bezeichnet werden. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">turn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> angle, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(speed &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; speed &lt; <span class="hljs-number"><span class="hljs-number">70</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(speed &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { digitalWrite(dirLeft, HIGH); digitalWrite(dirRight, HIGH); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sp &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { digitalWrite(dirLeft, LOW); digitalWrite(dirRight, LOW); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(angle &gt; <span class="hljs-number"><span class="hljs-number">149</span></span>) { analogWrite(speedLeft, speed); analogWrite(speedRight, speed - <span class="hljs-number"><span class="hljs-number">65</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  } else if (angle &lt; 31) { analogWrite(speedLeft, speed - 65); //  analogWrite(speedRight, speed); } else { analogWrite(speedLeft, speed); analogWrite(speedRight, speed); } }</span></span></code> </pre><br><h3>  Wettbewerbe bei MIPT statt insgesamt </h3><br>  Mit unserem Roboter gingen wir zum Roboter-Fu√üballwettbewerb, der am 14.04.2019 am Moskauer Institut f√ºr Physik und Technologie, Dolgoprudny, veranstaltet wurde.  Wir haben das 1: 4-Finale erreicht, sind aber nicht weiter vorangekommen. <br><br><img src="https://habrastorage.org/webt/f0/n2/lx/f0n2lxvkzlyxv0jbm9rsnd6xffe.jpeg"><br><br>  Der Prozess selbst war f√ºr uns interessant, aber hier werde ich die Schlussfolgerungen beschreiben, die wir durch einen Blick auf den Roboter vor Ort gezogen haben: <br><br><ul><li>  brauche m√§chtiger.  W√ºnschenswert sind vier R√§der oder st√§rkere Motoren und andere R√§der.  Obwohl es nat√ºrlich vierr√§drige Modelle waren, die vorteilhafter aussahen </li><li>  Management ist nicht hoch.  Es ist notwendig, den Roboter in eine Panzerkurve zu versetzen (an einer Stelle drehen, da sich die R√§der in entgegengesetzte Richtungen drehen), da sonst der Kurvenradius zu gro√ü ist.  Im Allgemeinen ist die Option mit vier Pfeilen anstelle eines Kreises mit proportionaler Geschwindigkeit <b>f√ºr den Fu√üball</b> vorzuziehen.  Die beschriebene Option eignet sich besser f√ºr Rennen, bei denen Sie ununterbrochen fahren und hier Klarheit ben√∂tigen (ich habe mich um 10 Grad um meine Achse gedreht, auf den Ball gerichtet und den Knopf nach vorne gedr√ºckt. Aber wenn ich den Ball bereits gepackt habe, m√∂chte ich flexibel man√∂vrieren, aber hier m√ºssen Sie proportional sein Geschwindigkeit ... du musst dieses Ding irgendwie kombinieren). </li></ul><br>  Kommentare und Vorschl√§ge werden sehr gl√ºcklich sein.  In fr√ºheren Artikeln sind Kommentare manchmal interessanter als der Artikel selbst.  Danke, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sasha</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dana f√ºr die Arbeit</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de448080/">https://habr.com/ru/post/de448080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de448070/index.html">Importsubstitution in der Praxis. Teil 3. Betriebssysteme</a></li>
<li><a href="../de448072/index.html">Das Verst√§ndnis von Joins ist gebrochen. Dies ist definitiv nicht der Schnittpunkt von Kreisen, ehrlich</a></li>
<li><a href="../de448074/index.html">ALU mit 12 Transistoren (eigentlich nicht)</a></li>
<li><a href="../de448076/index.html">Simple Go Simulationssystem</a></li>
<li><a href="../de448078/index.html">Bei autoregressiver Sch√§tzung der spektralen Dichte eines station√§ren Signals</a></li>
<li><a href="../de448082/index.html">[Vor Montag] Syndrom des trockenen Auges</a></li>
<li><a href="../de448084/index.html">Foto eines Schwarzen Lochs - wird es von Nutzen sein?</a></li>
<li><a href="../de448088/index.html">Produktion von Plasmamotoren in Russland</a></li>
<li><a href="../de448090/index.html">Frontend Weekly Digest (8. - 14. April 2019)</a></li>
<li><a href="../de448094/index.html">Docker: So stellen Sie eine Full-Stack-Anwendung bereit und werden nicht grau</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>