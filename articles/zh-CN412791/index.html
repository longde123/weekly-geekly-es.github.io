<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📌 🎅 👨🏾‍🏫 改善视频监控系统的性能并防止崩溃 🍲 🗨️ 👯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="显然，预防这种疾病要好于以后进行治疗。 

 随着视频系统的构建，一切都完全相同。 与其寻找原因并解决使用期间的显示/记录/存档问题，不如在设计阶段多花一点时间仔细地考虑以避免将来的麻烦。 

 我们的技术支持很活跃，非常活跃。 她提供建议，帮助设置，当然解决视频系统中的问题。 这些问题通常在软件环...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>改善视频监控系统的性能并防止崩溃</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/macroscop/blog/412791/">显然，预防这种疾病要好于以后进行治疗。 <br><br> 随着视频系统的构建，一切都完全相同。 与其寻找原因并解决使用期间的显示/记录/存档问题，不如在设计阶段多花一点时间仔细地考虑以避免将来的麻烦。 <br><br> 我们的技术支持很活跃，非常活跃。 她提供建议，帮助设置，当然解决视频系统中的问题。 这些问题通常在软件环境中可见，但与Macroscop无关。 视频系统是多组件的，如果其中出现故障或根本无法正常工作，则用户将看不到某些部分的损坏。 他将看到抽搐出现在实时视频中，“漏洞”出现在存档中。 这是否意味着问题出在软件上？ 通常原因是完全不同的。 <br><br><img src="https://habrastorage.org/webt/4p/2l/d-/4p2ld-taaiydceuzg-kdpov88bm.jpeg"><br><a name="habracut"></a><br> 由于在40％的情况下Macroscop技术支持电话（将在后面进行解释）与软件的性能无关，因此，我们决定进行有关计划和构建视频系统的小型教育计划。 并说明为什么在这些阶段不按时花钱是很重要的，如果不这样会发生什么。 我们还将讨论显而易见的内容。 但是经验表明， <b>理解和做事是两回事</b> 。 <br><br> 让我们从问题的外观开始。 在视觉上，系统中出现问题的信号可能是： <br><br><ol><li> 缺少与相机的连接。 您根本无法实时查看来自摄像机的视频，也不会收到来自摄像机的存档。 </li><li> 流畅的视频显示（抽动/加速/延迟）。 </li><li> 档案中的空白处（“空洞”）。 似乎正在进行录音，但是档案中没有视频片段。 </li><li> 人工制品。 视频中出现了实际上不是的东西（前提是超自然的力量对此没有贡献）。 </li></ol><br><img src="https://habrastorage.org/webt/-k/ho/n_/-khon_enrwhilupsa4ctfsjrqyo.jpeg"><br><br> 什么会导致违规？ <br><br><h2>  <i>联播网</i> </h2><br> 如果视频不是从摄像机到服务器，也不是从服务器到客户端或存储，则通常应该归咎于通信渠道。 它可能不够宽，不够稳定，不清晰（当有很多不同的信息时，它不知道如何正确确定优先级）。 <br><br> 因此，一开始您需要注意的第一件事就是未来通信渠道的宽度。  <b>它的计算很</b>简单-我们将使用未来系统的所有摄像机，确定每个摄像机每秒发送多少Mbit信息（为此，我们需要了解所需的录制质量-分辨率，频率，格式），并考虑是否会显示视频（从多少台摄像机和数量的显示器），我们将技术流量提高了10-15％，并了解需要在何处以及需要什么带宽。 <br><br> 最好<b>画一个</b>未来系统<b>的图</b> 。 除其他外，这可以通过特殊程序（例如，Graphical Network Simulator 3）来完成，它们将有助于计算和识别需要特别注意的“瓶颈”。 这是一个简单而明显的工具，但实际上，很少有人使用它。 特别是在初学者中。 <br><br>  <b>将</b>视频监视网络与电话网络，Internet和任何其他系统<b>分开</b> 。 为了使视频系统能够消除与YouTube的流量争夺中的损失，当时您公司的10位员工决定观看YouTube，因此您需要为其分配一个单独的频道。 <br><br> 网络可以在物理上和逻辑上进行划分。 在第一种情况下，您将安装单独的设备并铺设单独的电缆，在第二种情况下，请选择具有VLAN支持的交换机。 实际上，从设置的角度来看，如果有机会产生额外的费用，则在物理上更容易分开。 <br><br>  <b>选择网络设备时</b> ，计算<b>功率</b>很重要。 制造商可以要求更大的交换器端口带宽，但这不能保证网络设备的处理器可以承受所有这些数据量。 <br><br> 网络不仅必须经过深思熟虑，而且必须有效地<b>组装</b> 。 简而言之：用户的跳线压缩严重，这会导致连接丢失或存档中断。 不可能很快找到这样的问题，因为通常来说，检查诸如跳线或路由器插座之类的琐事的性能的最后一件事就是。 <br><br><h2>  <i>资料储存系统</i> </h2><br> 重要的是不要忘记计算服务器与网络连接存储之间的必要<b>通道宽度</b> 。 它经常被忽略。 <br><br> 为了使存储系统能够处理来自视频系统的输入信息记录，有必要计算所需<b>的内存量</b>并评估<b>IOPS</b> （负责每秒存储系统执行I / O操作次数的参数）。 这可以使用特殊程序（Iometer，IOzone，FIO，CrystalDiskMark）完成。 <br><br> 如果系统是多服务器，我们建议选择一个较小的卷而不是一个更大的存储，以避免过多的负载。 <br><br><h2>  <i>防病毒和防火墙</i> </h2><br> 通常，防火墙和防病毒软件会干扰视频流量，从而影响视频系统的运行。 它也可以是Windows Defender，Windows防火墙，硬件防火墙等。 <br><br> 您可以禁用防病毒软件，而只需排除防火墙即可，而无需在已构建系统时更改其常规配置（尤其是在大型复杂系统上）。 我们必须重建整个网络。 因此，事先要注意<b>禁用或</b>限制所有可能限制数据接收或传输的软件和设备， <b>或者</b>从视频监视系统中<b>排除</b>这些软件和设备。 通常，即使设置“例外”也不会完全限制此类解决方案对视频流量的访问。 <br><br><h2>  <i>配套设备</i> </h2><br> 除了显而易见的（相机，服务器，存储应该可以工作）之外，硬件设置中还有一些要考虑的地方。 确保检查您的计算机<b>没有进入省电模式</b> 。 否则，系统将正常工作，但网络的优先级将降低，因此来自摄像机的某些数据可能根本无法接收。 而且，很难找到原因，因为一旦您开始寻找，一切都会奇迹般地解决。 <br><br> 在项目中选择IP摄像机时，请注意它们使用的数据传输协议。 为了最大程度地减少损失，请选择一个<b>TCP</b>连接（好的，它比其他连接要普遍得多）。 然后，在出现网络错误的情况下，将发生来自摄像机的信息重复请求，并且很可能将其以很小的延迟被拉起，这对于用户而言并不明显。 <br><br> 有时会出现问题，因为用户一次从相机请求<b>多个流</b> ，而相机无法对此进行处理。 制造商很少给出有关流量数量的建议，因此在这里您必须凭经验进行验证。 <br> 安装的摄像机本身可能无法正常工作，并将带有伪影的视频发送到服务器。 要检查问题出在相机上，而不是在视频系统软件中，可以使用VLC播放器：例如，如果在播放器中观察到伪像，则必须在相机本身中寻找原因。 仅首先需要确保使用相同的协议传输视频系统和视频播放器。 <br><br> 如果您无法提供足够宽的通讯通道，则可以<b>降低</b>摄像机<b>的比特率</b> 。 为此，请在设置中降低帧速率或记录质量，使用具有现代压缩格式（h.264 +，h.265 +）和zipstream技术的相机。 而且，绝大多数人都有机会使用可变的比特率：当帧中没有移动时，传输的信息较少，移动开始时，记录质量和数据量将增加。 <br><br><h2>  <i>如何发现问题？</i> </h2><br> 如果仍然出现问题，则以下步骤可能是诊断原因的优先事项： <br><br><ol><li> 转到任务管理器并检查整体系统负载。 </li><li> 检查设备的物理状况（如果电源关闭，是否有人断线，相机是否工作等）。 </li><li> 检查防病毒软件是否已关闭。 </li><li> 利用Macroscop的<b>自我诊断</b>功能。 自我诊断会显示错误消息，并提供有关如何自行解决错误的建议。 </li></ol><br> 所有这些都可以由系统管理员完成，而无需外部专家的参与。 <br><br> 如果找不到原因，并且您无法自己解决问题，则需要联系技术支持。 在处理延迟，伪影或连接断开问题时，我们要检查的第一件事是相机和服务器之间的网络。 为此，我们使用特殊程序（Iperf）以及ping测试。 由于视频比标准数据包（MTU）的最大允许数据量多99％，因此我们只对大型数据包执行ping操作。 <br><br>  <i>示例</i> ：ping -l 5000 -t（使用5000字节的数据包进行无限ping）。 <br><br> 我们发送数据包，将其取回并估算损失。 而且它们通常是不可接受的。 即使丢失了1％的帧也会导致各种负面影响-从伪影，档案丢失，实时抖动到与相机的完全断开。 <br> 同样，可以诊断服务器和客户端计算机之间的通信通道问题。 <br><br>  Macroscop还记录了系统的运行情况，这些日志对我们的专家帮助缩小问题搜索范围有很大帮助。 由于具有诊断功能，该软件可以识别出以下问题：摄像机发送到服务器的数据包顺序冲突，访问服务器，解码子系统，授权，启动服务和记录。 <br><br> 这些只是用于检查状态和查找问题根源的一些选项，但是在大多数情况下，这些工具足以诊断原因。 否则，将开始个人研究并进行艰苦的检查。 <br><br><h2>  <i>事先考虑</i> </h2><br> 与许多其他系统一样，在视频系统中，只需在设计阶段就安全就可以避免许多问题。 提前计算网络参数，选择比计算所需的生产率高一些的设备，购买高质量的耗材并注意其安装，听取所选设备制造商和软件开发商的建议，如果您愿意，请与技术支持或售前工程师联系问题或疑问。 <br><br> 通常，一开始您对视频系统的关注越多，多年使用对视频系统的需求就越少。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN412791/">https://habr.com/ru/post/zh-CN412791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN412781/index.html">NES爱好者可以在控制台上启动SNES游戏</a></li>
<li><a href="../zh-CN412783/index.html">在Centos 7上从源代码安装MTProto Telegram代理</a></li>
<li><a href="../zh-CN412785/index.html">管理硕士和自由职业者。 故事分为三个部分</a></li>
<li><a href="../zh-CN412787/index.html">将Git嵌入企业开发系统中</a></li>
<li><a href="../zh-CN412789/index.html">“工作中的帮助”：如何使聊天机器人更智能</a></li>
<li><a href="../zh-CN412793/index.html">MassTransit，Saga和RabbitMQ用于实施流程管理器</a></li>
<li><a href="../zh-CN412795/index.html">让我们从文章“极客时代重返哈勃尔到底出了什么问题”的讨论中得出结论。</a></li>
<li><a href="../zh-CN412797/index.html">关于Google的CDN，服务和字体的危害</a></li>
<li><a href="../zh-CN412799/index.html">始终保持联系：Mango Talker-Messenger和软件电话</a></li>
<li><a href="../zh-CN412801/index.html">研究：由于加密货币交易的安全性低，黑客窃取了数百万美元</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>