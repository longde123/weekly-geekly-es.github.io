<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤· ğŸ¤– ğŸ  Androidä¸­çš„å…¨æ–‡æœ¬æœç´¢ ğŸ’ƒğŸ» ğŸˆšï¸ ğŸ•³ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæœç´¢åŠŸèƒ½éå¸¸æµè¡Œã€‚ è€Œä¸”ï¼Œå¦‚æœå®ƒåœ¨å°å‹äº§å“ä¸­å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œé‚£ä¹ˆåœ¨æä¾›è®¿é—®å¤§é‡ä¿¡æ¯çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨å°†æ— æ³•è¿›è¡Œæœç´¢ã€‚ ä»Šå¤©ï¼Œæˆ‘å°†å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨Androidç¨‹åºä¸­æ­£ç¡®å®ç°æ­¤åŠŸèƒ½ã€‚ 



 åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­å®ç°æœç´¢çš„æ–¹æ³• 


1. æœç´¢ä½œä¸ºæ•°æ®è¿‡æ»¤å™¨ é€šå¸¸ï¼Œå®ƒçœ‹èµ·æ¥åƒæŸä¸ªåˆ—è¡¨ä¸Šæ–¹çš„æœç´¢...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Androidä¸­çš„å…¨æ–‡æœ¬æœç´¢</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/466787/"> åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæœç´¢åŠŸèƒ½éå¸¸æµè¡Œã€‚ è€Œä¸”ï¼Œå¦‚æœå®ƒåœ¨å°å‹äº§å“ä¸­å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œé‚£ä¹ˆåœ¨æä¾›è®¿é—®å¤§é‡ä¿¡æ¯çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨å°†æ— æ³•è¿›è¡Œæœç´¢ã€‚ ä»Šå¤©ï¼Œæˆ‘å°†å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨Androidç¨‹åºä¸­æ­£ç¡®å®ç°æ­¤åŠŸèƒ½ã€‚ <br><br><img src="https://habrastorage.org/webt/qf/4e/cm/qf4ecmc9japqzpsmwfoajjrlozk.jpeg"><br><a name="habracut"></a><br><h3> åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­å®ç°æœç´¢çš„æ–¹æ³• </h3><br><ol><li>  <b>æœç´¢ä½œä¸ºæ•°æ®è¿‡æ»¤å™¨</b> <br><br> é€šå¸¸ï¼Œå®ƒçœ‹èµ·æ¥åƒæŸä¸ªåˆ—è¡¨ä¸Šæ–¹çš„æœç´¢æ ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªè¿‡æ»¤å®Œæˆçš„æ•°æ®ã€‚ </li><li>  <b>æœåŠ¡å™¨æœç´¢</b> <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ•´ä¸ªå®ç°äº¤ç»™æœåŠ¡å™¨ï¼Œè€Œåº”ç”¨ç¨‹åºåˆ™å……å½“ç˜¦å®¢æˆ·ç«¯ï¼Œåªéœ€è¦å°†å…¶ä»¥æ­£ç¡®çš„å½¢å¼æ˜¾ç¤ºæ•°æ®å³å¯ã€‚ </li><li>  <b>ç»¼åˆæœç´¢</b> <br><br><ul><li> è¯¥åº”ç”¨ç¨‹åºåŒ…å«å¤§é‡å„ç§ç±»å‹çš„æ•°æ®ï¼› </li><li> è¯¥åº”ç”¨ç¨‹åºå¯ä»¥ç¦»çº¿å·¥ä½œï¼› </li><li> éœ€è¦å°†æœç´¢ä½œä¸ºå¯¹åº”ç”¨ç¨‹åºçš„éƒ¨åˆ†/å†…å®¹çš„å•ä¸ªè®¿é—®ç‚¹ã€‚ </li></ul></li></ol><br> åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼ŒSQLiteå†…ç½®çš„å…¨æ–‡æœ¬æœç´¢å¯ä»¥è§£å†³ã€‚ ä½¿ç”¨å®ƒï¼Œæ‚¨å¯ä»¥éå¸¸å¿«é€Ÿåœ°æ‰¾åˆ°å¤§é‡ä¿¡æ¯ä¸­çš„åŒ¹é…é¡¹ï¼Œè¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸ç‰ºç‰²æ€§èƒ½çš„æƒ…å†µä¸‹å¯¹ä¸åŒçš„è¡¨è¿›è¡Œå¤šæ¬¡æŸ¥è¯¢ã€‚ <br><br> è€ƒè™‘ä½¿ç”¨ç‰¹å®šç¤ºä¾‹å®ç°è¿™ç§æœç´¢ã€‚ <br><br><h3> èµ„æ–™å‡†å¤‡ </h3><br> å‡è®¾æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ˜¾ç¤º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">themoviedb.org</a>ä¸­çš„ç”µå½±åˆ—è¡¨çš„åº”ç”¨ç¨‹åºã€‚ ä¸ºäº†ç®€åŒ–ï¼ˆä»¥å…ä¸Šçº¿ï¼‰ï¼Œè¯·æ‹æ‘„ç”µå½±åˆ—è¡¨å¹¶ä»ä¸­å½¢æˆJSONæ–‡ä»¶ï¼Œå°†å…¶æ”¾å…¥èµ„äº§ä¸­å¹¶åœ¨æœ¬åœ°å¡«å……æˆ‘ä»¬çš„æ•°æ®åº“ã€‚ <br><br>  JSONæ–‡ä»¶ç»“æ„ç¤ºä¾‹ï¼š <br><br><pre><code class="kotlin hljs">[ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">278</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"overview"</span></span>: <span class="hljs-string"><span class="hljs-string">"  ..."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">238</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"overview"</span></span>: <span class="hljs-string"><span class="hljs-string">" , ..."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">424</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"overview"</span></span>: <span class="hljs-string"><span class="hljs-string">"   ..."</span></span> } ]</code> </pre> <br><h3> æ•°æ®åº“å¡«å…… </h3><br>  SQLiteä½¿ç”¨è™šæ‹Ÿè¡¨æ¥å®ç°å…¨æ–‡æœç´¢ã€‚ ä»è¡¨é¢ä¸Šçœ‹ï¼Œå®ƒä»¬çœ‹èµ·æ¥åƒå¸¸è§„çš„SQLiteè¡¨ï¼Œä½†æ˜¯å¯¹å®ƒä»¬çš„ä»»ä½•è®¿é—®éƒ½ä¼šåšä¸€äº›åå°å·¥ä½œã€‚ <br><br> è™šæ‹Ÿè¡¨ä½¿æˆ‘ä»¬å¯ä»¥åŠ å¿«æœç´¢é€Ÿåº¦ã€‚ ä½†æ˜¯ï¼Œé™¤äº†ä¼˜ç‚¹ä¹‹å¤–ï¼Œå®ƒä»¬è¿˜å…·æœ‰ç¼ºç‚¹ï¼š <br><br><ul><li> æ‚¨ä¸èƒ½åœ¨è™šæ‹Ÿè¡¨ä¸Šåˆ›å»ºè§¦å‘å™¨ï¼› </li><li> æ‚¨ä¸èƒ½å¯¹è™šæ‹Ÿè¡¨æ‰§è¡ŒALTER TABLEå’ŒADD COLUMNå‘½ä»¤ï¼› </li><li> è™šæ‹Ÿè¡¨ä¸­çš„æ¯ä¸ªåˆ—éƒ½å·²å»ºç«‹ç´¢å¼•ï¼Œè¿™æ„å‘³ç€èµ„æºå¯èƒ½æµªè´¹åœ¨ç´¢å¼•åˆ—ä¸Šï¼Œè€Œè¿™äº›åˆ—ä¸åº”è¯¥åŒ…å«åœ¨æœç´¢ä¸­ã€‚ </li></ul><br> è¦è§£å†³åä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åŒ…å«éƒ¨åˆ†ä¿¡æ¯çš„å…¶ä»–è¡¨ï¼Œå¹¶åœ¨è™šæ‹Ÿè¡¨ä¸­å­˜å‚¨æŒ‡å‘å¸¸è§„è¡¨çš„å…ƒç´ çš„é“¾æ¥ã€‚ <br><br> åˆ›å»ºè¡¨ä¸æ ‡å‡†è¡¨ç•¥æœ‰ä¸åŒï¼Œæˆ‘ä»¬ä½¿ç”¨å…³é”®å­—<code>VIRTUAL</code>å’Œ<code>fts4</code> ï¼š <br><br><pre> <code class="kotlin hljs"> CREATE VIRTUAL TABLE movies USING fts4(id, title, overview);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">è¯„è®ºfts5ç‰ˆæœ¬</b> <div class="spoiler_text"> å®ƒå·²ç»è¢«æ·»åŠ åˆ°SQLiteä¸­ã€‚ æ­¤ç‰ˆæœ¬æ•ˆç‡æ›´é«˜ï¼Œæ›´å‡†ç¡®ï¼Œå¹¶ä¸”åŒ…å«è®¸å¤šæ–°åŠŸèƒ½ã€‚ ä½†æ˜¯ç”±äºAndroidçš„ç¢ç‰‡åŒ–ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šéƒ½ä½¿ç”¨fts5ï¼ˆAPI24æä¾›ï¼‰ã€‚ æ‚¨å¯ä»¥ä¸ºä¸åŒç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿç¼–å†™ä¸åŒçš„é€»è¾‘ï¼Œä½†æ˜¯è¿™å°†ä½¿è¿›ä¸€æ­¥çš„å¼€å‘å’Œæ”¯æŒä¸¥é‡å¤æ‚åŒ–ã€‚ æˆ‘ä»¬å†³å®šé‡‡ç”¨æ›´ç®€å•çš„æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨å¤§å¤šæ•°è®¾å¤‡æ”¯æŒçš„fts4ã€‚ </div></div><br> å¡«å……ä¸å¹³å¸¸æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼š <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">populate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> movies: MutableList&lt;Movie&gt; = mutableListOf() context.assets.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">"movies.json"</span></span>).use { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> typeToken = <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : TypeToken&lt;List&lt;Movie&gt;&gt;() {}.type movies.addAll(Gson().fromJson(InputStreamReader(it), typeToken)) } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { writableDatabase.beginTransaction() movies.forEach { movie -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> values = ContentValues().apply { put(<span class="hljs-string"><span class="hljs-string">"id"</span></span>, movie.id) put(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, movie.title) put(<span class="hljs-string"><span class="hljs-string">"overview"</span></span>, movie.overview) } writableDatabase.insert(<span class="hljs-string"><span class="hljs-string">"movies"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, values) } writableDatabase.setTransactionSuccessful() } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { writableDatabase.endTransaction() } }</code> </pre> <br><h3> åŸºæœ¬ç‰ˆæœ¬ </h3><br> æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œä½¿ç”¨<code>MATCH</code>å…³é”®å­—ä»£æ›¿<code>LIKE</code> ï¼š <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstSearch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(searchString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List&lt;Movie&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> query = <span class="hljs-string"><span class="hljs-string">"SELECT * FROM movies WHERE movies MATCH '</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$searchString</span></span></span><span class="hljs-string">'"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cursor = readableDatabase.rawQuery(query, <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> result = mutableListOf&lt;Movie&gt;() cursor?.use { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cursor.moveToFirst()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!cursor.isAfterLast) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> id = cursor.getInt(<span class="hljs-string"><span class="hljs-string">"id"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> title = cursor.getString(<span class="hljs-string"><span class="hljs-string">"title"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> overview = cursor.getString(<span class="hljs-string"><span class="hljs-string">"overview"</span></span>) result.add(Movie(id, title, overview)) cursor.moveToNext() } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result }</code> </pre> <br> ä¸ºäº†åœ¨ç•Œé¢ä¸­å®ç°æ–‡æœ¬è¾“å…¥å¤„ç†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code>RxJava</code> ï¼š <br><br><pre> <code class="kotlin hljs">RxTextView.afterTextChangeEvents(findViewById(R.id.editText)) .debounce(<span class="hljs-number"><span class="hljs-number">500</span></span>, TimeUnit.MILLISECONDS) .map { it.editable().toString() } .filter { it.isNotEmpty() &amp;&amp; it.length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> } .map(dbHelper::firstSearch) .subscribeOn(Schedulers.computation()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(movieAdapter::updateMovies)</code> </pre> <br> ç»“æœæ˜¯ä¸€ä¸ªåŸºæœ¬çš„æœç´¢é€‰é¡¹ã€‚ åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ ä¸­ï¼Œåœ¨è¯´æ˜ä¸­æ‰¾åˆ°äº†æ‰€éœ€çš„å•è¯ï¼Œåœ¨æ ‡é¢˜å’Œæè¿°ä¸­æ‰¾åˆ°äº†ç¬¬äºŒä¸ªå…ƒç´ ã€‚ æ˜¾ç„¶ï¼Œä»¥è¿™ç§å½¢å¼è¿˜ä¸æ¸…æ¥šæˆ‘ä»¬å‘ç°äº†ä»€ä¹ˆã€‚ è®©æˆ‘ä»¬ä¿®å¤å®ƒã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wb/jq/vo/wbjqvon_lp-zpsc9_wnnlxey6e0.png"></div><br><h3> æ·»åŠ é‡éŸ³ </h3><br> ä¸ºäº†æé«˜æœç´¢çš„æ˜æ˜¾æ€§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¾…åŠ©åŠŸèƒ½<code>SNIPPET</code> ã€‚ å®ƒç”¨äºæ˜¾ç¤ºåœ¨å…¶ä¸­æ‰¾åˆ°åŒ¹é…é¡¹çš„æ ¼å¼åŒ–æ–‡æœ¬ç‰‡æ®µã€‚ <br><br><pre> <code class="kotlin hljs">snippet(movies, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)</code> </pre> <br><ul><li> ç”µå½±-è¡¨æ ¼åç§°ï¼› </li><li>  &lt;bï¼†gtå’Œ&lt;/ b&gt;-è¿™äº›å‚æ•°ç”¨äºçªå‡ºæ˜¾ç¤ºå·²æœç´¢çš„æ–‡æœ¬éƒ¨åˆ†ï¼› </li><li>  ...-å¯¹äºæ–‡æœ¬çš„è®¾è®¡ï¼Œå¦‚æœç»“æœæ˜¯ä¸å®Œæ•´çš„å€¼ï¼› </li><li>  1-ä»ä¸­åˆ†é…æ–‡æœ¬çš„è¡¨æ ¼çš„åˆ—å·ï¼› </li><li>  15æ˜¯åŒ…å«åœ¨è¿”å›çš„æ–‡æœ¬å€¼ä¸­çš„å¤§çº¦å•è¯æ•°ã€‚ </li></ul><br> è¯¥ä»£ç ä¸ç¬¬ä¸€ä¸ªç›¸åŒï¼Œä¸åŒ…æ‹¬è¯·æ±‚ï¼š <br><br><pre> <code class="kotlin hljs">SELECT id, snippet(movies, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>) title, snippet(movies, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>) overview FROM movies WHERE movies MATCH <span class="hljs-string"><span class="hljs-string">''</span></span></code> </pre> <br> æˆ‘ä»¬å†è¯•ä¸€æ¬¡ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7u/wc/1x/7uwc1x11wt7dw4qdterexvd2y1a.png"></div><br> ç»“æœæ¯”ä»¥å‰çš„ç‰ˆæœ¬æ›´æ¸…æ¥šã€‚ ä½†è¿™è¿˜ä¸æ˜¯ç»ˆç‚¹ã€‚ è®©æˆ‘ä»¬çš„æœç´¢æ›´åŠ â€œå®Œæ•´â€ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨è¯æ³•åˆ†æå¹¶çªå‡ºæ˜¾ç¤ºæœç´¢æŸ¥è¯¢çš„é‡è¦éƒ¨åˆ†ã€‚ <br><br><h3> å®Œæˆæ”¹å–„ </h3><br>  SQLiteå…·æœ‰å†…ç½®æ ‡è®°ï¼Œå¯è®©æ‚¨æ‰§è¡Œè¯æ³•åˆ†æå¹¶è½¬æ¢åŸå§‹æœç´¢æŸ¥è¯¢ã€‚ å¦‚æœåœ¨åˆ›å»ºè¡¨æ—¶æˆ‘ä»¬æœªæŒ‡å®šç‰¹å®šçš„æ ‡è®°ç”Ÿæˆå™¨ï¼Œåˆ™å°†é€‰æ‹©â€œç®€å•â€ã€‚ å®é™…ä¸Šï¼Œå®ƒåªæ˜¯å°†æˆ‘ä»¬çš„æ•°æ®è½¬æ¢ä¸ºå°å†™å¹¶ä¸¢å¼ƒä¸å¯è¯»çš„å­—ç¬¦ã€‚ å®ƒä¸å¤ªé€‚åˆæˆ‘ä»¬ã€‚ <br><br> ä¸ºäº†åœ¨æœç´¢ä¸Šè¿›è¡Œè´¨é‡æ”¹è¿›ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<i>è¯å¹²</i> -æŸ¥æ‰¾ç»™å®šæºè¯çš„<i>è¯åº“</i>çš„è¿‡ç¨‹ã€‚ <br><br>  SQLiteå…·æœ‰ä½¿ç”¨Porter Stemmerç®—æ³•çš„é™„åŠ å†…ç½®æ ‡è®°å™¨ã€‚ è¯¥ç®—æ³•é¡ºåºåº”ç”¨è®¸å¤šç‰¹å®šè§„åˆ™ï¼Œé€šè¿‡æˆªæ–­ç»“å°¾å’Œåç¼€æ¥çªå‡ºæ˜¾ç¤ºå•è¯çš„é‡è¦éƒ¨åˆ†ã€‚ ä¾‹å¦‚ï¼Œå½“æœç´¢â€œé”®â€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—åŒ…å«å•è¯â€œ keyâ€ï¼Œâ€œ keysâ€å’Œâ€œ keyâ€çš„æœç´¢ã€‚ æˆ‘å°†åœ¨æœ€åç•™ä¸‹æŒ‡å‘è¯¥ç®—æ³•çš„è¯¦ç»†æè¿°çš„é“¾æ¥ã€‚ <br><br> ä¸å¹¸çš„æ˜¯ï¼ŒSQLiteå†…ç½®çš„ä»¤ç‰Œç”Ÿæˆå™¨ä»…é€‚ç”¨äºè‹±è¯­ï¼Œå› æ­¤å¯¹äºä¿„è¯­ï¼Œæ‚¨éœ€è¦ç¼–å†™è‡ªå·±çš„å®ç°æˆ–ä½¿ç”¨ç°æˆçš„å¼€å‘ã€‚ æˆ‘ä»¬å°†ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">algorithmist.ru</a>ç½‘ç«™è·å–å®Œæˆçš„å®ç°ã€‚ <br><br> æˆ‘ä»¬å°†æœç´¢æŸ¥è¯¢è½¬æ¢ä¸ºå¿…è¦çš„å½¢å¼ï¼š <br><br><ol><li> åˆ é™¤å¤šä½™çš„å­—ç¬¦ã€‚ </li><li> å°†çŸ­è¯­åˆ†è§£æˆå•è¯ã€‚ </li><li> è·³è¿‡è¯å¹²åˆ†æå™¨ã€‚ </li><li> æ”¶é›†æœç´¢æŸ¥è¯¢ã€‚ </li></ol><br><div class="spoiler">  <b class="spoiler_title">æ³¢ç‰¹ç®—æ³•</b> <div class="spoiler_text"><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Porter { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> PERFECTIVEGROUND = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"((|||||)|((&lt;=[])(||)))$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> REFLEXIVE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"([])$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> ADJECTIVE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(|||||||||||||||||||||||||)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> PARTICIPLE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"((||)|((?&lt;=[])(||||)))$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> VERB = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"((||||||||||||||||||||||||||||)|((?&lt;=[])(||||||||||||||||)))$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> NOUN = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(|||||||||||||||||||||||||||||||||||)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> RVRE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"^(.*?[])(.*)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> DERIVATIONAL = Pattern.compile(<span class="hljs-string"><span class="hljs-string">".*[^]+[].*?$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> DER = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"?$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> SUPERLATIVE = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(|)$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> I = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> P = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"$"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> NN = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"$"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(words: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: String { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> word = words word = word.toLowerCase() word = word.replace(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> m = RVRE.matcher(word) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.matches()) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pre = m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rv = m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> temp = PERFECTIVEGROUND.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp == rv) { rv = REFLEXIVE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) temp = ADJECTIVE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp != rv) { rv = temp rv = PARTICIPLE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { temp = VERB.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp == rv) { rv = NOUN.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rv = temp } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rv = temp } rv = I.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DERIVATIONAL.matcher(rv).matches()) { rv = DER.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } temp = P.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp == rv) { rv = SUPERLATIVE.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) rv = NN.matcher(rv).replaceFirst(<span class="hljs-string"><span class="hljs-string">""</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rv = temp } word = pre + rv } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> word } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">å°†çŸ­è¯­åˆ†è§£ä¸ºå•è¯çš„ç®—æ³•</b> <div class="spoiler_text"><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> words = searchString .replace(<span class="hljs-string"><span class="hljs-string">"\"(\\[\"]|.*)?\""</span></span>.toRegex(), <span class="hljs-string"><span class="hljs-string">" "</span></span>) .split(<span class="hljs-string"><span class="hljs-string">"[^\\p{Alpha}]+"</span></span>.toRegex()) .filter { it.isNotBlank() } .map(Porter::stem) .filter { it.length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> } .joinToString(separator = <span class="hljs-string"><span class="hljs-string">" OR "</span></span>, transform = { <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$it</span></span></span><span class="hljs-string">*"</span></span> })</code> </pre> </div></div><br> è½¬æ¢åï¼ŒçŸ­è¯­â€œåº­é™¢å’Œå¹½çµâ€çœ‹èµ·æ¥åƒâ€œåº­é™¢<b>*æˆ–</b>å¹½çµ<b>*</b> â€ã€‚ <br><br> ç¬¦å·â€œ <b>*</b> â€è¡¨ç¤ºå°†é€šè¿‡å‡ºç°ç»™å®šå•è¯æ¥è¿›è¡Œæœç´¢ã€‚  â€œ <b>æˆ–</b> â€è¿ç®—ç¬¦è¡¨ç¤ºå°†æ˜¾ç¤ºç»“æœï¼Œå…¶ä¸­åŒ…å«è‡³å°‘ä¸€ä¸ªæ¥è‡ªæœç´¢çŸ­è¯­çš„å•è¯ã€‚ æˆ‘ä»¬çœ‹ï¼š <br><br><img src="https://habrastorage.org/webt/vw/c9/sx/vwc9sxcgklqvfinisn_yq3hx998.png"><br><br><h3> æ€»ç»“ </h3><br> å…¨æ–‡æœç´¢å¹¶ä¸åƒä¹çœ‹èµ·æ¥é‚£æ ·å¤æ‚ã€‚ æˆ‘ä»¬åˆ†æäº†ä¸€ä¸ªç‰¹å®šçš„ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥åœ¨é¡¹ç›®ä¸­å¿«é€Ÿè½»æ¾åœ°å®ç°è¯¥ç¤ºä¾‹ã€‚ å¦‚æœæ‚¨éœ€è¦æ›´å¤æ‚çš„å†…å®¹ï¼Œåˆ™åº”æŸ¥é˜…æ–‡æ¡£ï¼Œå› ä¸ºå…¶ä¸­æœ‰ä¸€ä¸ªæ–‡æ¡£ï¼Œè€Œä¸”ç¼–å†™å¾—å¾ˆå¥½ã€‚ <br><br><h3> å‚è€ƒæ–‡çŒ®ï¼š </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…¨æ–‡</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¡«å¡ç®—æ³•</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Porter Stemmerï¼ˆä¿„è¯­ï¼‰</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FTS4æ–‡æ¡£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…³äºSQLiteä¸­çš„è™šæ‹Ÿè¡¨</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466787/">https://habr.com/ru/post/zh-CN466787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466775/index.html">å·¥ä½œåŸç†ï¼š5Gçš„é¢‘ç‡é€‰æ‹©</a></li>
<li><a href="../zh-CN466777/index.html">åœ¨React Nativeä¸Šåˆ›å»ºåº”ç”¨ç¨‹åºçš„å»ºè®®ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN466779/index.html">å­¦ä¹ è‹±è¯­ï¼š8ç§ç¤¼è²Œåœ°è¯´ä¸çš„æ–¹æ³•</a></li>
<li><a href="../zh-CN466781/index.html">ç”¨äºæ‰‹éƒ¨è¿½è¸ªçš„å®æ—¶ç¥ç»ç½‘ç»œ</a></li>
<li><a href="../zh-CN466785/index.html">å¤§å±±æ‰€æ•™ï¼šITä¸“å®¶çš„é€‰æ‹©</a></li>
<li><a href="../zh-CN466793/index.html">ä¿„ç½—æ–¯è¶³çƒåˆåˆ›ä¼ä¸šï¼šå®ƒä»¬çš„å­˜åœ¨</a></li>
<li><a href="../zh-CN466799/index.html">Maltegoç¦»èº«ä½“æ›´è¿‘ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN466801/index.html">é€šè¿‡ä½¿ç”¨APIâ€‹â€‹ç»•è¿‡LinkedInæœç´¢é™åˆ¶</a></li>
<li><a href="../zh-CN466803/index.html">luré¥®DevOpsã€‚ ç¬¬ä¸‰å¤© ELKï¼ŒChatOpsï¼ŒSREã€‚ è¿˜æœ‰å¼€å‘å•†çš„ç§˜å¯†ç¥ˆç¥·</a></li>
<li><a href="../zh-CN466805/index.html">ä¸ºä»€ä¹ˆæœªæ¥çš„å¤ªç©ºé£èˆ¹å°†ç”±æŒ¤å‹æˆå‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>