<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë≥üèø üÜï üßÄ Como transplantamos toda a equipe para outro idioma em um dia (na verdade n√£o) üôéüèΩ üë®üèæ‚Äç‚úàÔ∏è ü§º</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In√≠cio de um modelo para "aterramento" r√°pido dos desenvolvedores de PHP no Go 

 H√° 15 anos, realizamos um back-end em PHP. E uma vez tomada uma deci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como transplantamos toda a equipe para outro idioma em um dia (na verdade n√£o)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tuturu/blog/470461/"><img src="https://habrastorage.org/webt/zn/jh/no/znjhnorp0e_1yxm68q7zvx02eoi.jpeg"><br>  <i>In√≠cio de um modelo para "aterramento" r√°pido dos desenvolvedores de PHP no Go</i> <br><br>  H√° 15 anos, realizamos um back-end em PHP.  E uma vez tomada uma decis√£o estrat√©gica: primeiro, reescreva os locais mais carregados do Go e, em seguida, desenvolva novos servi√ßos. <br><br>  Imagine: voc√™ quer falar sobre uma nova linguagem para uma equipe de 40 desenvolvedores que preparam o PHP t√£o bem que montam um sistema multiencadeado em tempo real e de alta disponibilidade.  <b>Na pior das hip√≥teses, eles o queimar√£o, na melhor das hip√≥teses, ouvir√£o, mas continuar√£o a fazer como antes.</b>  Isto √©, se voc√™ inserir o idioma √† for√ßa. <br><br>  Portanto, decidimos primeiro organizar um hackathon e depois convidar todos para o lado sombrio.  Se pelo menos dez pessoas os tivessem recrutado, com o tempo, eles teriam mostrado a todos os outros um exemplo pessoal de como isso √© legal. <br><br>  Vou lhe dizer em etapas como repetir essa experi√™ncia com voc√™.  E sobre os resultados de nossa implementa√ß√£o.  E sobre o que acontece na cabe√ßa de um desenvolvedor de PHP quando ele v√™ uma nova linguagem. <br><br>  Come√ßamos com a prepara√ß√£o do modelo e do CI / CD, que permite desligar em 15 segundos.  Para escrever voc√™ mesmo, voc√™ precisa de duas semanas.  Fizemos isso com anteced√™ncia. <a name="habracut"></a><br><br><h3>  Etapa 1. Fale sobre Golang </h3><br>  Muitas vezes temos muitos semin√°rios internos.  Algu√©m quer contar alguma coisa, escreve um an√∫ncio, re√∫ne pessoas e conta.  Acontece que essas s√£o as peculiaridades da regula√ß√£o do tr√°fego a√©reo na R√∫ssia; acontece que √© uma hist√≥ria sobre viagens, mas com muito mais frequ√™ncia estamos falando de algum tipo de tecnologia ou recurso que foi implementado.  E isso pode ser √∫til para outra pessoa.  Ent√£o, montamos um semin√°rio interno sobre o Go, onde conversamos sobre os benef√≠cios do idioma.  R√°pido (compilado sem pandeiro: o PHP tamb√©m pode ser compilado, mas mais dif√≠cil), com v√°rios threads prontos para uso, com suporte simples, voc√™ pode escrever sem uma estrutura diretamente em um notebook, ou seja, n√£o h√° hemorr√≥idas com depend√™ncias de terceiro n√≠vel que a estrutura desenvolvida arrasta junto com ela.  Implante em 15 segundos.  E parece que n√£o h√° falhas √≥bvias em nossa situa√ß√£o.  Sugerimos tentar.  Era como uma hist√≥ria sobre outro mundo: aqui est√° a linguagem, veja como ela difere, no pr√≥ximo final de semana haver√° um hackathon para quem estiver interessado. <br><br><h3>  Etapa 2. Documenta√ß√£o </h3><br>  Tr√™s dias antes do hackathon, enviamos um link para um curso introdut√≥rio de meia hora sobre sintaxe, tipos de dados b√°sicos e funcionalidade.  E documenta√ß√£o b√°sica.  Aqui est√° o que os desenvolvedores receberam: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">golang.org/doc</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tour.golang.org</a> <br><br>  Al√©m disso, contatos Go-senior dentro. <br><br><h3>  Etapa 3. Grupos </h3><br>  Al√©m disso, propusemos dividir em grupos e trazer tarefas que gostar√≠amos de implementar aqui e agora em um novo idioma.  Eles imediatamente avisaram que o hackathon estaria no escrit√≥rio depois de horas (no s√°bado), o assunto era volunt√°rio, mas seria poss√≠vel resolver a tarefa de combate e aprender na pr√°tica em modo quase pareado com uma pessoa que conhece as nuances do idioma.  Isso interessou 40 pessoas, e eles come√ßaram a lutar em grupos e a recrutar tarefas.  Nem todos tiveram sucesso com os grupos: muitos vieram com a tarefa de apenas um, os grupos eram dois, com menos frequ√™ncia - tr√™s pessoas.  As pr√≥prias tarefas estavam no topo de pend√™ncias ou estavam relacionadas √† duplica√ß√£o de algum tipo de local inibit√≥rio. <br><br>  O objetivo final era realizar uma tarefa no hackathon, que pode ser enrolada um pouco e "vendida" ao propriet√°rio do produto (gerente de dire√ß√£o).  No esp√≠rito: "Olha, funcionou antes de 40 segundos e agora faz tudo em dois."  Esta parte √© a mais importante para o sucesso estrat√©gico da introdu√ß√£o do idioma nas equipes: voc√™ precisa de uma pequena vit√≥ria no in√≠cio. <br><br><h3>  Etapa 4. Trabalho invis√≠vel </h3><br>  Preparamos um modelo, sobre o qual falei acima, para nossa infraestrutura, o que nos permitiria executar imediatamente sem dan√ßar para criar e conectar tudo o que voc√™ precisa.  Este modelo substitui a estrutura.  Espalhar n√£o faz muito sentido: repito, √© muito aprisionado apenas para n√≥s. <br><br>  Vou listar apenas a funcionalidade que foi estabelecida no modelo: <br><br><ul><li>  Integra√ß√£o com k8s. </li><li>  Exporte m√©tricas para o prometheus. </li><li>  Configura√ß√£o atrav√©s de vari√°veis ‚Äã‚Äãde ambiente. </li><li>  Servidor HTTP. </li><li>  Opentracing. </li><li>  Logger </li></ul><br>  Estamos trabalhando no estudo do Kubernetes h√° muito tempo e, como solu√ß√£o, escolhemos o OpenShift, que ofereceu grandes oportunidades para personalizar e configurar o CI / CD.  Ent√£o, aprimoramos o modelo imediatamente sob os k8s.  O aplicativo criado no OpenShift cria o reposit√≥rio, coleta o esqueleto do aplicativo, o servi√ßo no k8s, aplica pol√≠ticas de seguran√ßa, coleta o bin√°rio, implanta no k8s e em menos de um minuto o servi√ßo est√° dispon√≠vel na rede.  Portanto, o hackathon tamb√©m se tornou um evento em que os desenvolvedores foram apresentados ao nosso futuro PaaS. <br><br>  Tamb√©m preparamos um painel na Grafana com m√©tricas b√°sicas, configuramos logs de exporta√ß√£o para o Kibana e agentes para o Jaeger.  Para cada servi√ßo, s√£o gerados links para servi√ßos, nos quais voc√™ pode obter imediatamente todas as informa√ß√µes necess√°rias. <br><br>  Em seguida, foi necess√°rio concordar com o acesso aos bancos de dados necess√°rios para a resolu√ß√£o de problemas pelos participantes do hackathon.  Isso est√° errado, mas nos conectamos √†s bases militares em somente leitura durante a dura√ß√£o do trabalho.  Essa √© outra raz√£o pela qual o s√°bado √© a menor carga neste dia. <br><br>  Eles avisaram a cozinha (lembro que a temos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gratuitamente para lanches</a> - frutas de queijo cottage, mas n√£o para comida quente) sobre o evento.  A comida foi levada ao escrit√≥rio para que n√£o nos distra√≠ssemos. <br><br><h3>  Etapa 5. Hackathon propriamente dito </h3><br>  Por raz√µes √≥bvias (fam√≠lia, relaxamento), algumas falharam no s√°bado, ent√£o dividimos 15 pessoas em liga√ß√µes. <br><br>  Eles falaram sobre nossa plataforma PaaS, como criar um aplicativo a partir de um modelo, como usar um modelo.  Essa estrutura, na qual existem inv√≥lucros para coletar m√©tricas, verifica√ß√µes de integridade e m√©tricas, conectar-se a um banco de dados e assim por diante, mostrou como conectar todos os tipos de coisas diferentes.  Foi poss√≠vel remover tudo no local ou com anteced√™ncia (o modelo tamb√©m foi distribu√≠do para o hackathon).  Este √© um aplicativo pronto que precisa ser expandido. <br><br>  Eles falaram sobre os recursos de implanta√ß√£o e desenvolvimento do Kubernetes (configura√ß√£o, registro, m√©tricas, trabalho com amostras prontas, aloca√ß√£o de recursos para o processador e mem√≥ria, etc.).  Eles tentaram implantar "Ol√°, mundo!". <br><br><img src="https://habrastorage.org/webt/ct/j5/ma/ctj5maql1tuvo1pwz3nurqi6x5c.png"><br><br>  Os pr√≥prios caras criaram os servi√ßos.  Fiquei agradavelmente surpreendido com a simplicidade e facilidade de uso do modelo.  Algu√©m j√° teve tempo de praticar em Golang, algu√©m apenas folheou a documenta√ß√£o. <br><br><img src="https://habrastorage.org/webt/ya/xq/2s/yaxq2spzorirno6pu2s5nyxg_e0.png"><br><br>  N√£o t√≠nhamos o objetivo de mostrar como escrever bem; era necess√°rio obter um c√≥digo funcional aproximado e mostrar como tudo pode ir rapidamente para o pr√©-produto, como tudo funciona rapidamente e como √© f√°cil fazer edi√ß√µes. <br><br>  O plano era o seguinte: as equipes escrevem, se voc√™ tiver alguma d√∫vida, n√≥s respondemos.  Depois, uma sess√£o de revis√£o e ajuda sobre como fazer algo mais correto na arquitetura em Golang. <br><br>  Das distor√ß√µes cognitivas do meio PHP, vale a pena notar a maneira "antiga" de pensar em um √∫nico t√≥pico.  O Go possui um bom modelo competitivo interno e multithreading pronto para uso, que n√£o estava no PHP.  O c√≥digo acaba sendo muito leg√≠vel, o que poucos esperavam. <br><br>  Na pr√°tica, nem sempre usamos multithreading.  Depende da tarefa.  Mas, sob o cap√¥, ela tamb√©m √© e, quando necess√°rio, a velocidade aumenta devido a ela.  Por exemplo, uma goroutine separada √© criada para qualquer solicita√ß√£o REST recebida.  Golang pode processar v√°rias solicita√ß√µes ao mesmo tempo, quando a maioria das outras linguagens (incluindo PHP), por padr√£o, enfileira-as e processa-as em um encadeamento para cada trabalhador. <br><br>  O segundo recurso √© uma grande dor com o retorno de erros.  Se o multithreading √© apenas uma arquitetura diferente e √© f√°cil se acostumar a ela em uma ou duas horas, no caso de erros ao mudar do PHP, essa √© uma mudan√ßa em todo o modelo de pensamento.  Retornar erros de fun√ß√µes √© o principal paradigma no Go.  No PHP, o try-catch geralmente envolve as coisas.  E aqui √© necess√°rio processar explicitamente no corpo da fun√ß√£o.  Algumas pessoas foram brutalmente bombardeadas por esse "abrandamento", resistiram ativamente.  Isso ocorre porque a abordagem √© muito pr√≥xima do TDD, e o TDD exige paci√™ncia ao escrever o c√≥digo, mas √© f√°cil depurar.  Isso aumenta o c√≥digo linha por linha "se - um erro", mas depois que voc√™ escreve e n√£o retorna.  Isso √© muito importante na arquitetura dos microsservi√ßos, porque os microsservi√ßos crescem como cogumelos e um desenvolvedor pode gravar dezenas de microsservi√ßos.  Constantemente alternar contextos e erros de depura√ß√£o √© muito caro e ineficiente.  Se tudo for feito corretamente, o aplicativo funcionar√° por anos, t√£o efetivamente quanto durante o desenvolvimento.  E no PHP, na mesma situa√ß√£o, √© prov√°vel que, se o c√≥digo for escrito incorretamente, novos erros surjam constantemente, ap√≥s o que ser√° necess√°rio depurar tudo novamente. <br><br>  Descobriu-se os cal√ßados para os p√©s.  Quando a parte funcional foi lan√ßada, eles j√° descobriram a melhor forma de decomp√¥-la em pacotes.  Ent√£o houve uma revis√£o.  Quando o Go-senior ajuda voc√™, √© muito √∫til imediatamente.  Eles mostraram a algu√©m como substituir visitas constantes √† base por um cache na RAM.  Algu√©m foi ajudado a reescrever o c√≥digo em execu√ß√£o paralela.  Em algum lugar, havia pequenos plugues, como o fato de o servidor HTTP no PHP tradicionalmente subir e morrer, mas aqui ainda resta travar. <br><br><h3>  Etapa 6. Reposit√≥rio </h3><br>  No final do hackathon, o c√≥digo foi dobrado no reposit√≥rio, onde todos podiam ver o c√≥digo das equipes vizinhas e enviar uma solicita√ß√£o de recebimento.  Isso tamb√©m faz parte do treinamento e, durante a semana, essas solicita√ß√µes foram bastante ativas. <br><br><h3>  Sum√°rio </h3><br>  Oito horas de hackathon em dois fluxos de mais ou menos 15 pessoas (lembre-se, de 70 desenvolvedores, 40 queriam experimentar o Go e receberam documenta√ß√£o e um modelo, mas nem todos puderam participar de um dia ou quiseram participar fisicamente). <br><br>  Um quarto dos servi√ßos deu o resultado esperado imediatamente.  Outra parte exigia longas modifica√ß√µes por parte do mon√≥lito PHP ou simplesmente tinha mais de oito horas de largura.  Cerca de metade dos servi√ßos foram conclu√≠dos antes da venda posteriormente. <br><br>  Como resultado, todos se familiarizaram com o idioma, a plataforma OpenShift, como se casar com eles e assim por diante.  Vimos o modelo de aplicativo e o novo CI / CD, obtivemos todo o conjunto de ferramentas para resolver ainda mais nossos problemas no Go. <br><br>  Em seguida, os recursos foram "vendidos" para os propriet√°rios do produto.  Respondemos √†s perguntas de arquitetura dos l√≠deres de equipe. <br><br>  No m√™s seguinte, quase todos juntos adicionaram um modelo (que √© uma mini-estrutura) √†s necessidades dos departamentos.  Como resultado, ele se tornou maior.  Sim, outro recurso do modelo: toda a configura√ß√£o - por meio de vari√°veis ‚Äã‚Äãde ambiente, isto √©, com desenvolvimento local e ao mudar para pr√©-produto, tudo funciona perfeitamente da mesma maneira.  Docker √© bom. <br><br>  N√£o s√≥ Go passou do hackathon para as massas.  Os modelos apareceram na plataforma PaaS para PHP e Node.js, mas, mesmo assim, todas as outras coisas iguais, os desenvolvedores geralmente escolhem Go como a linguagem do microsservi√ßo.  Como resultado, na pr√°tica, todos os novos microsservi√ßos vendidos escritos ap√≥s o hackathon s√£o escritos especificamente no Go.  Ou seja, cortamos o mon√≥lito e imediatamente escrevemos tudo de novo no Kubernetes.  At√© o final do ano, nos mudaremos para l√° quase completamente. <br><br>  Quem n√£o veio perguntou aos colegas o que era.  Em seguida, eles se aproximaram e pediram o idioma, realizaram v√°rias tarefas em segundo plano (para o trabalho principal), depois colocaram o c√≥digo no reposit√≥rio e receberam solicita√ß√µes pull de outros desenvolvedores rec√©m-treinados e dos especialistas da Go.  Interessado em livros.  Ou seja, ainda tivemos algumas semanas de suporte t√©cnico da segunda linha. <br><br>  Para aqueles que queriam continuar seus estudos, eles criaram um grupo no Telegram com livros e muito mais.  Tamb√©m organizamos uma guilda de desenvolvedores Golang, onde discutimos semanalmente quest√µes emergentes no trabalho, desenvolvemos componentes comuns, compartilhamos boas pr√°ticas.  Qualquer desenvolvedor pode entrar. <br><br>  A maior conseq√º√™ncia √© que, depois de um m√™s, reescrevemos uma das se√ß√µes mais movimentadas e ela come√ßou a trabalhar cerca de seis mil vezes mais r√°pido no prod.  Mas √© melhor falar sobre isso separadamente: n√£o h√° apenas os recursos da linguagem, mas tamb√©m a implementa√ß√£o de multithreading, algumas melhorias arquiteturais e um pouco de xamanismo.  O mais importante √© a nossa experi√™ncia de conhecer o idioma, e geralmente √© f√°cil repeti-lo com voc√™ se voc√™ tiver pelo menos um especialista em Go que passar√° algumas semanas aprendendo. <br><br>  Outros posts sobre o nosso desenvolvimento: a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hist√≥ria do mon√≥lito de 15 anos</a> , uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">abordagem de mercearia na cozinha</a> , o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">que o desenvolvedor deve saber sobre o neg√≥cio</a> e, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">especialmente, o retorno de passagens a√©reas</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt470461/">https://habr.com/ru/post/pt470461/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt470449/index.html">Principais habilidades necess√°rias para ser um desenvolvedor front-end</a></li>
<li><a href="../pt470451/index.html">Como o junior verde entrou na TI</a></li>
<li><a href="../pt470453/index.html">Bicicletas de TI de varejo - como era h√° 12 anos</a></li>
<li><a href="../pt470455/index.html">Servidor QIWI 5.0</a></li>
<li><a href="../pt470457/index.html">Movimento browniano fracion√°rio</a></li>
<li><a href="../pt470465/index.html">PVS-Studio nas nuvens: CircleCI</a></li>
<li><a href="../pt470469/index.html">PVS-Studio vai para as nuvens: CircleCI</a></li>
<li><a href="../pt470471/index.html">Arrefecer o vinho rapidamente! (Adi√ß√£o)</a></li>
<li><a href="../pt470473/index.html">Cr√¥nicas de importa√ß√£o: uma revis√£o do MyOffice</a></li>
<li><a href="../pt470475/index.html">Mais acess√≠vel: an√°lises de √°udio de baixo custo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>