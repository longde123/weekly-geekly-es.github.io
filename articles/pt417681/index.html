<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèûÔ∏è üòà üë¶üèæ Imers√£o em desenvolvimento no Ethereum. Parte 5: Oraclize üõ∏ ü¶í üíÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O acesso a arquivos grandes e a v√°rios dados din√¢micos externos geralmente √© uma parte muito importante de um aplicativo descentralizado. Ao mesmo tem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Imers√£o em desenvolvimento no Ethereum. Parte 5: Oraclize</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417681/">  O acesso a arquivos grandes e a v√°rios dados din√¢micos externos geralmente √© uma parte muito importante de um aplicativo descentralizado.  Ao mesmo tempo, o pr√≥prio Ethereum n√£o fornece um mecanismo para mudar de posi√ß√£o - contratos inteligentes s√≥ podem ser lidos e gravados dentro do pr√≥prio blockchain.  Neste artigo, consideraremos o Oraclize, que possibilita a intera√ß√£o com o mundo exterior consultando quase todos os recursos da Internet.  Um t√≥pico relacionado √© o IPFS e mencione-o brevemente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sp/_k/1m/sp_k1m_ob9-qh3_yiiyhmtecypu.jpeg"></div><br><a name="habracut"></a><br><h2>  IPFS </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IPFS</a> √© um sistema de arquivos distribu√≠do com endere√ßamento de conte√∫do.  Isso significa que, para o conte√∫do de qualquer arquivo adicionado l√°, √© considerado um hash exclusivo.  O mesmo hash √© usado para pesquisar e recuperar esse conte√∫do da rede. <br>  As informa√ß√µes b√°sicas j√° foram descritas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste artigo</a> e em v√°rios outros, portanto n√£o vemos motivo para repetir. <br><br><h3>  Por que usar o IPFS em conjunto com o Ethereum? </h3><br>  Salvar qualquer volume de conte√∫do na blockchain √© muito caro e prejudicial para a rede.  Portanto, a melhor op√ß√£o √© salvar algum tipo de link para o arquivo que est√° no armazenamento fora da cadeia, n√£o necessariamente IPFS.  Mas o IPFS tem v√°rias vantagens: <br><br><ul><li>  Um link de arquivo √© um hash exclusivo do conte√∫do espec√≠fico do arquivo; portanto, se colocarmos esse hash no blockchain, podemos ter certeza de que o arquivo recebido √© o que foi originalmente adicionado, o arquivo n√£o pode ser substitu√≠do </li><li>  O sistema distribu√≠do garante a indisponibilidade de um servidor espec√≠fico (devido a bloqueio ou outros motivos) </li><li>  O link para o arquivo e a confirma√ß√£o de hash s√£o combinados em uma linha, o que significa que voc√™ pode escrever menos no blockchain e economizar g√°s </li></ul><br>  Entre as defici√™ncias, pode-se mencionar que, como n√£o h√° servidor central, para a acessibilidade dos arquivos, √© necess√°rio que pelo menos um arquivo seja ‚Äúdistribu√≠do‚Äù.  Mas se voc√™ possui um arquivo espec√≠fico, √© f√°cil conectar-se aos distribuidores - inicie o daemon ipfs e adicione o arquivo via <code>ipfs add</code> . <br><br>  A tecnologia √© muito adequada para a ideologia da descentraliza√ß√£o, portanto, considerando o Oraclize agora, frequentemente encontraremos o uso do IPFS em diferentes mecanismos de or√°culo. <br><br><h2>  Oraclize </h2><br>  Para executar praticamente qualquer trabalho √∫til, um contrato inteligente precisa receber novos dados.  No entanto, n√£o h√° capacidade integrada de atender a uma solicita√ß√£o da blockchain para o mundo exterior.  Obviamente, voc√™ pode adicionar tudo o que √© exigido pelas transa√ß√µes manualmente, mas √© imposs√≠vel verificar de onde esses dados vieram e sua confiabilidade.  Al√©m disso, pode ser necess√°rio organizar uma infraestrutura adicional para atualizar rapidamente dados din√¢micos, como taxas de c√¢mbio.  E atualiza√ß√µes com um intervalo fixo levar√£o a excedentes de g√°s. <br><br>  Portanto, o servi√ßo fornecido pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Oraclize</a> √© √∫til: em um contrato inteligente, voc√™ pode enviar uma solicita√ß√£o para quase qualquer API ou recurso na Internet, verifique se os dados recebidos do recurso especificado n√£o s√£o alterados e use o resultado no mesmo contrato inteligente. <br><br>  O Oraclize n√£o √© apenas um servi√ßo Ethereum, funcionalidade semelhante √© fornecida a outras cadeias de blocos, mas descreveremos apenas o pacote com o Ethereum. <br><br><h3>  Introdu√ß√£o </h3><br>  Tudo que voc√™ precisa para come√ßar - √© adicionar-se a um projecto dos arquivos de oraclizeAPI <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio</a> .  Voc√™ s√≥ precisa escolher aquele adequado para sua vers√£o do compilador (solc): oraclizeAPI_0.5.sol para vers√µes a partir de 0.4.18, oraclizeAPI_0.4.sol para vers√µes a partir de 0.4.1, oraclizeAPI_pre0.4.sol para todas as vers√µes antigas, suporte Esta vers√£o j√° foi descontinuada.  Se voc√™ usar trufa, n√£o esque√ßa de renomear o arquivo para usingOraclize - isso exige que o nome do arquivo e o contrato correspondam. <br><br>  Ao incluir o arquivo apropriado em seu projeto, voc√™ herda o contrato de <code>usingOraclize</code> .  E voc√™ pode come√ßar a usar o Oracle, que se resume a duas coisas principais: enviar uma solicita√ß√£o usando o assistente <code>oraclize_query</code> e depois processar o resultado na fun√ß√£o <code>__callback</code> .  O contrato inteligente mais simples (para obter o pre√ßo atual do tempo de antena em d√≥lares) pode ter a seguinte apar√™ncia: <br><br><pre> <code class="javascript hljs">pragma solidity <span class="hljs-number"><span class="hljs-number">0.4</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./usingOraclize.sol"</span></span>; contract ExampleContract is usingOraclize { string public ETHUSD; event updatedPrice(string price); event newOraclizeQuery(string description); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExampleContract</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">payable</span></span></span><span class="hljs-function"> </span></span>{ updatePrice(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__callback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bytes32 myid, string result</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (msg.sender == oraclize_cbAddress()); ETHUSD = result; updatedPrice(result); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updatePrice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">payable</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (oraclize_getPrice(<span class="hljs-string"><span class="hljs-string">"URL"</span></span>) &gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.balance) { newOraclizeQuery(<span class="hljs-string"><span class="hljs-string">"Oraclize query was NOT sent, please add some ETH to cover for the query fee"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { newOraclizeQuery(<span class="hljs-string"><span class="hljs-string">"Oraclize query was sent, standing by for the answer.."</span></span>); oraclize_query(<span class="hljs-string"><span class="hljs-string">"URL"</span></span>, <span class="hljs-string"><span class="hljs-string">"json(https://api.coinmarketcap.com/v1/ticker/ethereum/?convert=USD).0.price_usd"</span></span>); } } }</code> </pre> <br>  A fun√ß√£o que envia a solicita√ß√£o √© <code>updatePrice</code> .  Voc√™ pode ver que primeiro h√° uma verifica√ß√£o de que <code>oraclize_getPrice(‚ÄúURL‚Äù)</code> maior que o saldo atual do contrato.  Isso ocorre porque a chamada <code>oraclize_query</code> deve ser paga, o pre√ßo √© calculado como a soma da comiss√£o fixa e do pagamento de g√°s para a chamada de retorno de chamada.  <code>‚ÄúURL‚Äù</code> √© uma designa√ß√£o de um dos tipos de fontes de dados; nesse caso, √© uma solicita√ß√£o simples via https, e consideraremos outras op√ß√µes.  As respostas sob solicita√ß√£o podem ser analisadas antecipadamente como json (como no exemplo) e de v√°rias outras maneiras (consideraremos mais adiante).  Uma linha de <code>__callback</code> √© retornada em <code>__callback</code> .  No in√≠cio, verifica-se que a chamada passada no endere√ßo confi√°vel oraclize <br><br>  Todas as op√ß√µes para usar o oraclize s√£o constru√≠das de acordo com um esquema, apenas as fontes de dados e a capacidade de adicionar autentica√ß√£o ao <code>__callback</code> .  Portanto, em exemplos futuros, citaremos apenas diferen√ßas significativas. <br><br><h3>  Usar pre√ßo </h3><br>  Como j√° mencionado, √©ter extra √© pago por solicita√ß√µes de oraclize e √© removido do saldo do contrato, e n√£o do endere√ßo de chamada.  Uma exce√ß√£o √© apenas a primeira solicita√ß√£o de cada novo contrato, √© fornecida gratuitamente.  Tamb√©m √© interessante que a mesma mec√¢nica seja preservada nas redes de teste, mas o pagamento √© feito atrav√©s da transmiss√£o da rede correspondente, ou seja, nas solicita√ß√µes de testnet s√£o praticamente gratuitas. <br><br>  J√° foi mencionado que o pre√ßo solicitado consiste em dois valores: uma comiss√£o fixa e pagamento por uma chamada de retorno de chamada de g√°s.  Uma comiss√£o fixa √© definida em d√≥lares e a quantidade de √©ter √© calculada a partir da taxa atual.  A comiss√£o depende da fonte dos dados e de mecanismos de suporte adicionais, nos quais iremos nos concentrar.  A tabela de pre√ßos atual √© assim: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d9/w2/xv/d9w2xvqkoi2laplioqc377xydxm.png"></div><br>  Como voc√™ pode ver, o pre√ßo por solicita√ß√£o de URL √© de v√°rios centavos.  √â muito ou pouco?  Para fazer isso, vamos considerar quanto custa a segunda parte - a cobran√ßa do g√°s de retorno de chamada. <br>  Isso funciona de acordo com o seguinte esquema: a quantidade de √©ter necess√°ria para pagar uma quantidade fixa de g√°s a um pre√ßo fixo √© transferida antecipadamente com a solicita√ß√£o do contrato.  Esse valor deve ser suficiente para efetuar uma chamada de retorno e o pre√ßo deve ser adequado ao mercado; caso contr√°rio, a transa√ß√£o n√£o ser√° realizada ou travar√° por muito tempo.  Ao mesmo tempo, fica claro que nem sempre √© poss√≠vel saber a quantidade de g√°s com anteced√™ncia; portanto, a diretoria tamb√©m deve estar em reserva (a reserva n√£o √© devolvida).  Os valores padr√£o s√£o um limite de 200 mil gases a um pre√ßo de 20 gwei.  Isso √© suficiente para um retorno de chamada m√©dio com v√°rias entradas e algum tipo de l√≥gica.  E o pre√ßo de 20 gwei, embora possa parecer muito grande no momento (no momento em que escrevo, a m√©dia √© de 4 gwei), mas no momento do influxo de transa√ß√µes, o pre√ßo de mercado pode subir repentinamente e ser ainda mais alto, ent√£o, em geral, esses valores est√£o pr√≥ximos dos reais usados.  Portanto, com esses valores e o pre√ßo do ar na regi√£o de US $ 500, os pagamentos de g√°s chegar√£o a US $ 2, para que possamos dizer que uma comiss√£o fixa ocupa uma pequena parte. <br><br>  Se voc√™ sabe o que est√° fazendo, existe a op√ß√£o de alterar o limite e o pre√ßo do g√°s, economizando significativamente em solicita√ß√µes. <br><br>  O pre√ßo do g√°s pode ser definido por uma fun√ß√£o separada - <code>oraclize_setCustomGasPrice(&lt;  wei&gt;)</code> .  Ap√≥s a chamada, o pre√ßo √© salvo e usado em todas as solicita√ß√µes subsequentes. <br>  O limite pode ser definido a pedido <code>oraclize_query</code> , indicando o seu √∫ltimo argumento, assim: <br><br><pre> <code class="javascript hljs">oraclize_query(<span class="hljs-string"><span class="hljs-string">"URL"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;&gt;"</span></span>, <span class="hljs-number"><span class="hljs-number">50000</span></span>);</code> </pre> <br>  Se voc√™ tiver uma l√≥gica complexa em <code>__callback</code> e o g√°s for consumido mais de 200k, voc√™ definitivamente precisar√° definir um limite que cubra o pior caso de consumo de g√°s.  Caso contr√°rio, se o limite for excedido, <code>__callback</code> simplesmente reverter√°. <br><br>  A prop√≥sito, recentemente oraclize obteve informa√ß√µes que voc√™ pode pagar por solicita√ß√µes fora da blockchain, o que permitir√° que voc√™ n√£o gaste todo o limite ou devolva o saldo (e o pagamento n√£o vem do contrato).  Ainda n√£o tivemos que us√°-lo, mas a oraclize se oferece para entrar em contato com info@oraclize.it, se essa op√ß√£o for interessante.  Portanto, lembre-se. <br><br><h3>  Como isso funciona </h3><br>  Por que, tendo herdado de um contrato inteligente regular, obtemos funcionalidades que n√£o eram inicialmente suportadas por mecanismos de blockchain?  De fato, o servi√ßo oracle n√£o consiste apenas em contratos com fun√ß√µes auxiliares.  O principal trabalho de obten√ß√£o de dados √© realizado por um servi√ßo externo.  Os contratos inteligentes formam aplicativos para acesso a dados externos e os colocam no blockchain.  Servi√ßo externo - monitora novos blocos do blockchain e, se detectar um aplicativo, o executa.  Esquematicamente, isso pode ser representado da seguinte maneira: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/b0/ka/thb0kan1hwm75ijixmdrqtiwvum.png"></div><br><h3>  Fontes de dados </h3><br>  Al√©m do <code>URL</code> considerado, o oraclize fornece mais 4 op√ß√µes (que voc√™ viu na se√ß√£o sobre pre√ßos): <code>WolframAlpha</code> , <code>IPFS</code> , <code>random</code> e <code>computation</code> .  Vamos considerar cada um deles. <br><br><h4>  1. URL </h4><br>  O exemplo j√° discutido usa essa fonte de dados.  Essa √© a fonte de solicita√ß√µes HTTP para v√°rias APIs.  O exemplo foi o seguinte: <br><br><pre> <code class="javascript hljs">oraclize_query(<span class="hljs-string"><span class="hljs-string">"URL"</span></span>, <span class="hljs-string"><span class="hljs-string">"json(https://api.coinmarketcap.com/v1/ticker/ethereum/?convert=USD).0.price_usd"</span></span>);</code> </pre> <br>  Isso est√° recebendo o pre√ßo do √©ter e, como a api fornece uma string json com um conjunto de dados, a solicita√ß√£o √© agrupada em um analisador json e retorna apenas o campo necess√°rio.  Nesse caso, √© GET, mas o URL de origem tamb√©m suporta solicita√ß√µes POST.  O tipo de solicita√ß√£o √© determinado automaticamente por um argumento adicional.  Se houver json v√°lido, como neste exemplo: <br><br><pre> <code class="javascript hljs">oraclize_query(<span class="hljs-string"><span class="hljs-string">"URL"</span></span>, <span class="hljs-string"><span class="hljs-string">"json(https://shapeshift.io/sendamount).success.deposit"</span></span>, <span class="hljs-string"><span class="hljs-string">'{"pair":"eth_btc","amount":"1","withdrawal":"1AAcCo21EUc1jbocjssSQDzLna9Vem2UN5"}'</span></span>)</code> </pre> <br>  a solicita√ß√£o √© processada como POST (a API usada √© descrita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> , se estiver interessado) <br><br><h4>  2. WolframAlpha </h4><br>  Essa fonte de dados permite acessar o servi√ßo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WolframAlpha</a> , que pode fornecer respostas a v√°rias solicita√ß√µes de fatos ou c√°lculos, por exemplo <br><br><pre> <code class="javascript hljs">oraclize_query(‚ÄúWolframAlpha‚Äù, ‚Äúpresident <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> Russia‚Äù)</code> </pre> <br>  retornar√° <code>Vladimir Putin</code> e solicitar√° <br><br><pre> <code class="javascript hljs">oraclize_query(‚ÄúWolframAlpha‚Äù, ‚Äúsolve x^<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span>‚Äù)</code> </pre> <br>  retornar√° <code>x = 2</code> . <br>  Como voc√™ pode ver, o resultado foi incompleto porque o s√≠mbolo ¬± foi perdido.  Portanto, antes de usar essa fonte, √© necess√°rio verificar se o valor de uma solicita√ß√£o espec√≠fica pode ser usado em um contrato inteligente.  Al√©m disso, a autentica√ß√£o n√£o √© suportada para respostas; portanto, eles pr√≥prios recomendam que essa fonte seja usada apenas para teste. <br><br><h4>  3. IPFS </h4><br>  Como voc√™ pode imaginar, ele permite recuperar o conte√∫do de um arquivo no IPFS usando um multi-hash.  O tempo limite para receber conte√∫do √© de 20 segundos. <br><br><pre> <code class="javascript hljs">oraclize_query(‚ÄúIPFS‚Äù, ‚ÄúQmTL5xNq9PPmwvM1RhxuhiYqoTJcmnaztMz6PQpGxmALkP‚Äù)</code> </pre> <br>  retornar√° <code>Hello, Habr!</code>  (se o arquivo com este conte√∫do ainda estiver dispon√≠vel) <br><br><h4>  4. aleat√≥rio </h4><br>  A gera√ß√£o aleat√≥ria de n√∫meros funciona da mesma maneira que outras fontes, mas se voc√™ usar <code>oraclize_query</code> , ser√° necess√°ria uma prepara√ß√£o demorada dos argumentos.  Para evitar isso, voc√™ pode usar a <code>oraclize_newRandomDSQuery(delay, nbytes, customGasLimit)</code> auxiliar <code>oraclize_newRandomDSQuery(delay, nbytes, customGasLimit)</code> , configurando apenas o atraso de execu√ß√£o (em segundos), o n√∫mero de bytes gerados e o limite de g√°s para chamar <code>__callback</code> . <br>  O uso <code>random</code> tem algumas coisas a serem lembradas: <br><br><ul><li>  Para confirmar que o n√∫mero √© realmente aleat√≥rio, um tipo especial de verifica√ß√£o √© usado - Ledger, que pode ser realizado na blockchain (diferente de todos os outros, mas mais sobre isso posteriormente).  Isso significa que, no construtor do contrato inteligente, voc√™ precisa definir este m√©todo de verifica√ß√£o pela fun√ß√£o: <br><br><pre> <code class="javascript hljs">oraclize_setProof(proofType_Ledger);</code> </pre> <br>  E no in√≠cio do retorno de chamada, deve haver uma verifica√ß√£o em si: <br><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__callback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bytes32 _queryId, string _result, bytes _proof</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (oraclize_randomDS_proofVerify__returnCode(_queryId, _result, _proof) == <span class="hljs-number"><span class="hljs-number">0</span></span>) ); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">...</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  Essa verifica√ß√£o requer uma rede real e n√£o funciona com ganache, portanto, para testes locais, voc√™ pode remover temporariamente esta linha.  A prop√≥sito, o terceiro argumento para <code>__callback</code> aqui √© o par√¢metro <code>_proof</code> opcional.  √â sempre necess√°rio quando um dos tipos de confirma√ß√£o √© usado. </li><li>  Se voc√™ usar um n√∫mero aleat√≥rio para momentos cr√≠ticos, por exemplo, para determinar o vencedor na loteria, capture a entrada do usu√°rio antes de enviar newRandomDSQuery.  Caso contr√°rio, essa situa√ß√£o poder√° ocorrer: oraclize chama _callback e a transa√ß√£o √© vis√≠vel para todos na lista pendente.  Junto com isso, o pr√≥prio n√∫mero aleat√≥rio √© vis√≠vel.  Se os usu√°rios puderem continuar a fazer apostas grosseiras, poder√£o especificar um pre√ßo de g√°s mais alto e aumentar sua taxa antes da execu√ß√£o do _callback, sabendo antecipadamente que ser√£o vencedores. </li></ul><br><br><h4>  5. computa√ß√£o </h4><br>  Esta √© a mais flex√≠vel das fontes.  Ele permite que voc√™ escreva seus pr√≥prios scripts e os use como fonte de dados.  A computa√ß√£o ocorre na AWS.  Para execu√ß√£o, √© necess√°rio descrever o Dockerfile e reuni-lo com arquivos adicionais arbitr√°rios em um arquivo zip e fazer o download do arquivo no IPFS.  A implementa√ß√£o deve atender √†s seguintes condi√ß√µes: <br><br><ul><li>  Escreva a resposta que voc√™ deseja retornar com a √∫ltima linha em stdout </li><li>  A resposta deve ter no m√°ximo 2500 caracteres </li><li>  A inicializa√ß√£o e execu√ß√£o n√£o devem demorar mais de 5 minutos no total </li></ul><br>  Para um exemplo de como isso √© feito, consideraremos como executar a uni√£o mais simples das linhas transmitidas e retornar o resultado. <br><br>  Dockerfile: <br><br><pre> <code class="bash hljs">FROM ubuntu:16.04 MAINTAINER <span class="hljs-string"><span class="hljs-string">"info@rubyruby.ru"</span></span> CMD <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ARG0</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ARG1</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ARG2</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ARG3</span></span></span><span class="hljs-string">"</span></span></code> </pre><br>  Vari√°veis ‚Äã‚Äãde ambiente <code>ARG0</code> , <code>ARG1</code> , etc.  - Estes s√£o os par√¢metros passados ‚Äã‚Äãjunto com a solicita√ß√£o. <br>  Inclua o dockerfile no arquivo morto, inicie o servidor ipfs e adicione esse arquivo l√° <br><br><pre> <code class="bash hljs">$ zip concatenation.zip Dockerfile $ ipfs daemon &amp; $ ipfs add concatenation.zip QmWbnw4BBFDsh7yTXhZaTGQnPVCNY9ZDuPBoSwB9A4JNJD</code> </pre> <br>  Usamos o hash resultante para enviar a solicita√ß√£o via <code>oraclize_query</code> no contrato inteligente: <br><br><pre> <code class="javascript hljs">oraclize_query(<span class="hljs-string"><span class="hljs-string">"computation"</span></span>, [<span class="hljs-string"><span class="hljs-string">"QmVAS9TNKGqV49WTEWv55aMCTNyfd4qcGFFfgyz7BYHLdD"</span></span>, <span class="hljs-string"><span class="hljs-string">"s1"</span></span>, <span class="hljs-string"><span class="hljs-string">"s2"</span></span>, <span class="hljs-string"><span class="hljs-string">"s3"</span></span>, <span class="hljs-string"><span class="hljs-string">"s4"</span></span>]);</code> </pre> <br>  Uma matriz √© usada como argumento, no qual o primeiro elemento √© o multihash de archive e todo o restante s√£o os par√¢metros que se enquadram nas vari√°veis ‚Äã‚Äãde ambiente. <br><br>  Se voc√™ esperar a solicita√ß√£o ser conclu√≠da, <code>__callback</code> resultado <code>s1 s2 s3 s4</code> . <br><br><h3>  Auxiliares e subconsultas do analisador </h3><br>  A partir da resposta retornada por qualquer fonte, √© poss√≠vel pr√©-selecionar apenas as informa√ß√µes necess√°rias usando v√°rios auxiliares, como: <br><br><h4>  1. Analisador JSON </h4><br>  Voc√™ viu esse m√©todo no primeiro exemplo, em que apenas o pre√ßo foi retornado do resultado retornado pelo coinmarketcap: <br><br><pre> <code class="bash hljs">json(https://api.coinmarketcap.com/v1/ticker/ethereum/?convert=USD).0.price_usd</code> </pre> <br>  O caso de uso √© bastante √≥bvio, retornando, por exemplo: <br><br><pre> <code class="hljs json">[ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"ethereum"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ethereum"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"symbol"</span></span>: <span class="hljs-string"><span class="hljs-string">"ETH"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rank"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price_usd"</span></span>: <span class="hljs-string"><span class="hljs-string">"462.857"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price_btc"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0621573"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"24h_volume_usd"</span></span>: <span class="hljs-string"><span class="hljs-string">"1993200000.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"market_cap_usd"</span></span>: <span class="hljs-string"><span class="hljs-string">"46656433775.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"available_supply"</span></span>: <span class="hljs-string"><span class="hljs-string">"100800968.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"total_supply"</span></span>: <span class="hljs-string"><span class="hljs-string">"100800968.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max_supply"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"percent_change_1h"</span></span>: <span class="hljs-string"><span class="hljs-string">"-0.5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"percent_change_24h"</span></span>: <span class="hljs-string"><span class="hljs-string">"-3.02"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"percent_change_7d"</span></span>: <span class="hljs-string"><span class="hljs-string">"5.93"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"last_updated"</span></span>: <span class="hljs-string"><span class="hljs-string">"1532064934"</span></span> } ]</code> </pre> <br>  Como esse √© um array, usamos o elemento <code>0</code> e, a partir dele, o campo <code>price_usd</code> <br><br><h4>  2. XML </h4><br>  O uso √© semelhante ao JSON, por exemplo: <br><br><pre> <code class="bash hljs">xml(https://informer.kovalut.ru/webmaster/getxml.php?kod=7701).Exchange_Rates.Central_Bank_RF.USD.New.Exch_Rate</code> </pre> <br><h4>  3. HTML </h4><br>  Voc√™ pode analisar XHTML usando XPath.  Por exemplo, obtenha um valor de mercado com o etherscan: <br><br><pre> <code class="bash hljs">html(https://etherscan.io/).xpath(string(//*[contains(@href, <span class="hljs-string"><span class="hljs-string">'/stat/supply'</span></span>)]/font))</code> </pre> <br>  <code>MARKET CAP OF $46.148 BillionB</code> <br><br><h4>  4. Auxiliar bin√°rio </h4><br>  Permite cortar peda√ßos de dados brutos usando a fun√ß√£o de fatia (deslocamento, comprimento).  Ou seja, por exemplo, temos um arquivo com o conte√∫do de ‚Äúabc‚Äù: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"abc"</span></span> &gt; example.bin</code> </pre> <br>  Coloque no IPFS: <br><br><pre> <code class="bash hljs">$ ipfs add example.bin added Qme4u9HfFqYUhH4i34ZFBKi1ZsW7z4MYHtLxScQGndhgKE</code> </pre> <br>  Agora corte 1 caractere do meio: <br><br><pre> <code class="javascript hljs">binary(Qme4u9HfFqYUhH4i34ZFBKi1ZsW7z4MYHtLxScQGndhgKE).slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Na resposta, obtemos <code>b</code> <br><br>  Como voc√™ deve ter notado, no caso do auxiliar bin√°rio, n√£o foi usada a fonte IP, mas o IPFS.  De fato, os analisadores podem ser aplicados a qualquer fonte, digamos que n√£o seja necess√°rio aplicar JSON ao que retorna a URL, voc√™ pode adicionar esse conte√∫do ao arquivo: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"one"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"two"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span> }</code> </pre> <br>  Adicione-o ao IPFS: <br><br><pre> <code class="bash hljs">$ ipfs add test.json added QmZinLwAq5fy4imz8ZNgupWeNFTneUqHjPiTPX9tuR7Vxp</code> </pre> <br>  E ent√£o desmonte assim: <br><br><pre> <code class="bash hljs">json(QmZinLwAq5fy4imz8ZNgupWeNFTneUqHjPiTPX9tuR7Vxp).one</code> </pre> <br>  get <code>1</code> <br><br>  E um caso de uso particularmente interessante √© combinar todas as fontes de dados e analisadores em uma solicita√ß√£o.  Isso √© poss√≠vel usando uma fonte de dados <code>nested</code> separada.  Usamos o arquivo que acabamos de criar em uma solicita√ß√£o mais complexa (adicionando valores em dois campos): <br><br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">WolframAlpha</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span>{<span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">IPFS</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">json</span></span></span></span>(QmZinLwAq5fy4imz8ZNgupWeNFTneUqHjPiTPX9tuR7Vxp).one} to <span class="hljs-variable"><span class="hljs-variable">$</span></span>{<span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">IPFS</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">json</span></span></span></span>(QmZinLwAq5fy4imz8ZNgupWeNFTneUqHjPiTPX9tuR7Vxp).two}</code> </pre> <br>  N√≥s temos <code>3</code> <br>  A solicita√ß√£o √© formada da seguinte maneira: especifique a fonte de dados <code>nested</code> e, para cada solicita√ß√£o, adicione o nome da fonte √† sua frente entre colchetes e, al√©m disso, enquadre todas as subconsultas em <code>${..}</code> . <br><br><h3>  Teste </h3><br>  O Oraclize fornece um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">servi√ßo √∫til de</a> valida√ß√£o de consulta sem a necessidade de contratos inteligentes.  Basta entrar, escolher uma fonte de dados, um m√©todo de verifica√ß√£o e voc√™ pode ver que ele retornar√° para __callback se voc√™ enviar as solicita√ß√µes correspondentes <br><br>  Para verifica√ß√£o local em conjunto com um contrato inteligente, voc√™ pode usar uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vers√£o especial do Remix IDE</a> que suporta solicita√ß√µes oraclize. <br><br>  E para verificar localmente com o ganache, voc√™ precisar√° do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ethereum bridge</a> , que implementar√° ou permitir√° contratos inteligentes na sua rede de teste.  Para teste, primeiro adicione a seguinte linha ao construtor do seu contrato: <br><br><pre> <code class="javascript hljs">OAR = OraclizeAddrResolverI(<span class="hljs-number"><span class="hljs-number">0x6f485C8BF6fc43eA212E93BBF8ce046C7f1cb475</span></span>);</code> </pre> <br>  correr <br><br><pre> <code class="bash hljs">ganache-cli</code> </pre> <br>  Ent√£o <br><br><pre> <code class="bash hljs">node bridge --dev</code> </pre> <br>  Aguarde at√© que os contratos terminem e voc√™ possa testar.  Na sa√≠da da <code>node bridge</code> do <code>node bridge</code> √© poss√≠vel ver os pedidos enviados e as respostas recebidas. <br><br>  Outra ajuda n√£o √© apenas para testes, mas tamb√©m no uso real - possibilidade de monitorar os pedidos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Se voc√™ estiver solicitando em uma rede p√∫blica, poder√° usar o hash da transa√ß√£o na qual a solicita√ß√£o √© executada.  Se voc√™ usar autentica√ß√£o, lembre-se de que eles garantem que sejam enviados apenas para a rede principal; para outras redes, ele pode retornar 0. Se a solicita√ß√£o estava na rede local, voc√™ pode usar o ID da solicita√ß√£o, que retorna <code>oraclize_query</code> .  A prop√≥sito, √© recomend√°vel manter sempre esse ID, por exemplo, em um mapeamento semelhante: <br><br><pre> <code class="javascript hljs">mapping(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bytes32</span></span></span><span class="hljs-function">=&gt;</span></span>bool) validIds;</code> </pre> <br>  No momento da solicita√ß√£o, marque o ID enviado como <code>true</code> : <br><br><pre> <code class="javascript hljs">bytes32 queryId = oraclize_query(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">...</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">); validIds[queryId] = true;</span></span></code> </pre><br>  E, em <code>__callback</code> verifique se a solicita√ß√£o com esse ID ainda n√£o foi processada: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__callback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bytes32 myid, string result</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(validIds[myid] != bytes32(<span class="hljs-number"><span class="hljs-number">0</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(msg.sender == oraclize_cbAddress()); validIds[myid] = bytes32(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">...</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Isso √© necess√°rio porque <code>__callback</code> em uma solicita√ß√£o pode ser chamado mais de uma vez devido √†s peculiaridades dos mecanismos do Oraclize. <br><br><h3>  Autentica√ß√£o </h3><br>  Na tabela com as fontes, voc√™ pode ver que diferentes fontes podem oferecer suporte a diferentes tipos de confirma√ß√µes, e podem ser cobradas taxas diferentes.  Essa √© uma parte muito importante do oraclize, mas uma descri√ß√£o detalhada desses mecanismos √© um t√≥pico separado. <br><br>  O mecanismo mais comumente usado, pelo menos por n√≥s, √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TLSNotary</a> com armazenamento no IPFS.  O armazenamento no IPFS √© mais eficiente porque o <code>__callback</code> n√£o retorna as evid√™ncias em si (talvez na regi√£o de 4-5 kilobytes), mas com um multi-hash muito menor.  Para especificar este tipo, adicione uma linha no construtor: <br><br><pre> <code class="javascript hljs">oraclize_setProof(proofType_TLSNotary | proofStorage_IPFS);</code> </pre> <br>  S√≥ podemos dizer que esse tipo, grosso modo, nos protege da imprecis√£o dos dados recebidos do Oraclize.  Mas o Oraclize usa servidores da Amazon, que atuam como auditor, portanto, eles s√≥ precisam confiar. <br><br>  Leia mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h2>  Conclus√£o </h2><br>  O Oraclize fornece ferramentas que aumentam significativamente o n√∫mero de casos de uso de contratos inteligentes, bem como o IPFS, que pode ser visto em v√°rias vers√µes das consultas Oracle.  O principal problema √© que novamente usamos dados externos sujeitos √†s amea√ßas que a blockchain deveria ter protegido: centraliza√ß√£o, recursos de bloqueio, altera√ß√µes de c√≥digo, falsifica√ß√£o.  Mas, embora tudo isso seja inevit√°vel e a op√ß√£o de obter dados seja muito √∫til e vi√°vel, voc√™ s√≥ precisa estar ciente do motivo pelo qual o uso da blockchain foi introduzido no projeto e se o uso de fontes externas n√£o confi√°veis ‚Äã‚Äãreduz o benef√≠cio a zero. <br><br>  Se voc√™ estiver interessado em alguns t√≥picos de desenvolvimento do Ethereum que ainda n√£o foram divulgados nesses artigos - escreva nos coment√°rios, talvez os abordemos a seguir. <br><br>  Imers√£o em desenvolvimento no Ethereum: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: Introdu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2: Web3.js e g√°s</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3: aplicativo do usu√°rio</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4: implantar e depurar trufa, ganache, infura</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt417681/">https://habr.com/ru/post/pt417681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt417671/index.html">Novos recursos da linguagem de programa√ß√£o ABAP em webinars da SAP</a></li>
<li><a href="../pt417673/index.html">A investiga√ß√£o leva Solar Dozor: 5 casos n√£o-padr√£o que o DLP revelou</a></li>
<li><a href="../pt417675/index.html">Localiza√ß√£o de jogos e aplicativos no Unity. R√°pido e f√°cil</a></li>
<li><a href="../pt417677/index.html">Migrando um projeto do yii1 para o yii2 por meio de um trabalho √∫nico</a></li>
<li><a href="../pt417679/index.html">O grave legado do passado. Problemas de linha de comando do Windows</a></li>
<li><a href="../pt417683/index.html">C√≥digo Descontinuado - C√≥digo de Terceiros</a></li>
<li><a href="../pt417685/index.html">Semin√°rios on-line na sexta-feira da Skillbox: continuando o aprendizado de gra√ßa</a></li>
<li><a href="../pt417687/index.html">Assimetria da vida</a></li>
<li><a href="../pt417689/index.html">Mobio fala com o CEO da Appnext sobre o mercado de CPI e tend√™ncias de aplicativos m√≥veis</a></li>
<li><a href="../pt417691/index.html">Nossa estante de livros √© um programador de C #. E voc√™?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>