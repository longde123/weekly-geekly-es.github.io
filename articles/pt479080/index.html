<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêê üòü üñïüèø Golden Gate: como replicar terabytes por hora ou Experimente usar o CDC no GoldenGate na VTB üéá üòá üî¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Existem muitas maneiras de analisar dados em tempo real. Na VTB, usamos a tecnologia Change Data Capture (CDC) implementada na ferramenta Oracle Golde...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Golden Gate: como replicar terabytes por hora ou Experimente usar o CDC no GoldenGate na VTB</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/479080/">  Existem muitas maneiras de analisar dados em tempo real.  Na VTB, usamos a tecnologia Change Data Capture (CDC) implementada na ferramenta Oracle Golden Gate: a velocidade √© muito importante para n√≥s, mas gostar√≠amos de reduzir a quantidade de dados transmitidos e a carga na fonte.  Embora o principal escopo dessa ferramenta seja a replica√ß√£o do Oracle e do MS SQL, ao longo dos anos de trabalho com o CDC, acumulamos v√°rios casos interessantes, como a migra√ß√£o de dados entre plataformas ou diferentes tipos de DBMS.  Sob o corte, compartilharemos nossa experi√™ncia com o Golden Gate. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c74/d6e/8df/c74d6e8df3557ba888aa1ffa4b11ca82.jpg"><br><a name="habracut"></a><br><h2>  Por que precisamos do CDC (Change Data Capture) </h2><br>  O uso di√°rio de cart√µes banc√°rios √© conhecido h√° muito tempo e as pessoas, em regra, n√£o pensam que cada uso de um terminal de pagamento seja a transfer√™ncia imediata de determinadas informa√ß√µes para o banco.  Os volumes de dados est√£o aumentando e eu gostaria de process√°-los o mais r√°pido poss√≠vel, inclusive para enviar ofertas especiais em tempo real, porque, como eles dizem, uma boa colher para o jantar.  E as ferramentas ETL tradicionais (extrair, transformar, carregar - extrair, transformar, carregar) n√£o s√£o t√£o boas no processamento de dados em tempo real.  Aqui est√° um dos links fracos: quando os dados s√£o obtidos das tabelas do sistema de origem, voc√™ precisa selecionar apenas novas linhas ou linhas com altera√ß√µes.  Essa abordagem carrega adicionalmente o sistema de origem e aumenta a quantidade de dados transmitidos. <br><br>  O CDC captura as altera√ß√µes dos logs do banco de dados em tempo real.  Portanto, a fonte √© carregada muito menos e a quantidade de dados transmitidos √© reduzida.  Com essa tecnologia, reduzimos a necessidade de recursos de computa√ß√£o para sistemas com um grande volume de altera√ß√µes transacionais: afinal, para captura de dados, mesmo para os sistemas banc√°rios mais carregados, 1-2 n√∫cleos de processador na fonte s√£o suficientes.  E se estiv√©ssemos introduzindo o ETL, ter√≠amos que comprar capacidades do processador para ler dados em paralelo. <br><br>  H√° v√°rios anos que usamos a tecnologia Oracle GoldenGate, a ferramenta CDC da Oracle, na VTB.  Com sua ajuda, enchemos o armaz√©m de dados operacionais e distribu√≠mos as fun√ß√µes dos sistemas de informa√ß√£o em zonas "quentes" e "quentes".  90% do aplicativo OGG no cen√°rio de TI do banco est√° carregando dados do Oracle e MS SQL, mas, exceto pela replica√ß√£o, ele lida com outras tarefas perfeitamente.  Vejamos alguns exemplos de nossa pr√°tica. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc3/a45/a08/dc3a45a08fe9febcd205c35970c65ed3.png"><br><br><h2>  Caso 1. Relat√≥rios online </h2> <br>  Conhecemos o GoldenGate em 2013.  Em seguida, em nosso complexo de processamento de cart√µes, as transa√ß√µes foram processadas simultaneamente e os relat√≥rios elaborados.  A carga OLTP foi combinada com a carga DWH / DSS e grandes amostras pesadas lavaram o cache da mem√≥ria do banco de dados.  Como resultado, transa√ß√µes r√°pidas tiveram que ir para o disco r√≠gido, a velocidade dos servi√ßos cr√≠ticos de neg√≥cios estava caindo.  Para descarregar o n√∫cleo de processamento, levamos todos os procedimentos e relat√≥rios que desenvolvemos para uma r√©plica "quente" no Oracle Exadata. <br>  Como replicar dados usando o GoldenGate, descrevemos em detalhes <a href="https://habr.com/ru/company/vtb/blog/415605/">aqui</a> .  Em poucas palavras: para sistemas altamente carregados onde h√° mistura de diferentes tipos de cargas, os distribu√≠mos para diferentes servidores OLTP e DWH / DSS e, para sincroniza√ß√£o entre eles, usamos o GoldenGate.  Esse padr√£o de destacar uma r√©plica "quente" foi √∫til em muitos outros casos.  Por exemplo, usamos a mesma abordagem em nosso sistema antifraude - transferimos todos os relat√≥rios para os sistemas Oracle Exadata integrados, replicamos os dados para eles usando o GoldenGate. <br><br>  N√£o h√° sistemas sem falhas.  Por exemplo, se um desenvolvedor alterar os dados no receptor, poder√° ocorrer um erro de uso de dados e os processos do GoldenGate ser√£o interrompidos.  Para excluir dados fora de sincronia, usamos o Oracle GoldenGate Veridata como um √°rbitro independente.  Essa ferramenta n√£o apenas verifica dados entre fontes e receptores - o principal √© que a Veridata elimina as diferen√ßas.  √â importante que, quando lidamos com a replica√ß√£o, a Veridata garanta uma compara√ß√£o precisa dos dados e a detec√ß√£o de registros perdidos.  Temos um relat√≥rio completo com os resultados da compara√ß√£o, que pode ser apresentado a colegas incr√©dulos. <br><br><img src="https://habrastorage.org/webt/mq/kp/ti/mqkpticidasvi4be69qvoapsxam.jpeg"><br><br><h2>  Caso 2. Relat√≥rios e prepara√ß√£o consolidados no armazenamento online </h2><br>  Um caso separado est√° associado √† constru√ß√£o do armazenamento operacional.  A dificuldade est√° no fato de que, al√©m dos relat√≥rios operacionais, estamos preparando dados para armazenamento corporativo (armazenamento tempor√°rio).  Acontece que voc√™ precisa gerar relat√≥rios operacionais com base em dados coletados de v√°rios sistemas diferentes.  E √© mais conveniente fazer isso no n√≠vel do armazenamento online.  Para obter dados em alta velocidade e com uma carga m√≠nima de recursos, aplicamos novamente o GoldenGate. <br><br>  Para compara√ß√£o, vamos explicar como descobrimos o delta de altera√ß√µes em alguns de nossos sistemas antes.  Se o sistema em si n√£o permitiu aloca√ß√£o delta ou alterou dados retroativamente, a tabela da fonte de 10 TB foi comparada com a tabela de 10 TB no receptor no dia anterior.  Esses 10 TBs tiveram que ser capturados primeiro na fonte e a carga caiu n√£o apenas no sistema de origem, CPU, mem√≥ria, mas tamb√©m na rede de dados, bem como no sistema envolvido na compara√ß√£o.  E tudo isso para encontrar o delta de novos dados em 0,01%! <br><br>  O GoldenGate praticamente n√£o carrega a fonte: o CDC apenas l√™ as revistas e produz um delta finalizado.  Isso permite que voc√™ economize seriamente na infraestrutura.  N√£o importa quem √© o destinat√°rio - um reposit√≥rio tradicional baseado em produtos Oracle, MSSQL, Teradata ou apenas Hadoop. <br><br>  Observe que, nesse caso, os bancos de dados Oracle foram usados ‚Äã‚Äãcomo fonte e receptor.  A solu√ß√£o se mostrou eficaz, agora estamos conectando todos os novos sistemas a um data warehouse on-line comum, e agora n√£o √© apenas a Oracle.  Outra vantagem do GoldenGate √© que ele √© adequado para o download de dados da maioria dos bancos de dados usados ‚Äã‚Äãno cen√°rio de TI do banco. <br><br><img src="https://habrastorage.org/webt/58/h-/_e/58h-_ehvrydefghqdgjte9ehm8m.jpeg"><br><br><h2>  Caso 3. Ofertas pessoais aos clientes em tempo real. </h2><br>  J√° mencionamos a an√°lise de streaming, ou seja, ofertas em tempo real (RTO) para clientes em tempo real.  Camaradas seniores dizem que o sucesso nos neg√≥cios banc√°rios depende diretamente de qu√£o bem voc√™ conhece seu cliente e qu√£o relevante voc√™ pode fazer uma oferta a ele.  Em outras palavras, a probabilidade de o cliente tirar proveito da oferta do banco √© inversamente proporcional √† velocidade da resposta do banco √†s necessidades do cliente. <br><br>  Como isso funciona?  Por exemplo, um hist√≥rico de transa√ß√µes mostra que um cliente compra em uma loja de bebidas toda sexta-feira.  O posicionamento geogr√°fico o detecta em um shopping center, onde existe uma loja dessa rede, e por meio de um aplicativo m√≥vel, enviamos a ele uma oferta pessoal de desconto para uma loja de delicatessen no mesmo shopping.  Esse caso √© o mais interessante para o banco, pois permite criar co-marcas e ofertas conjuntas.  Os clientes podem ser indiv√≠duos e organiza√ß√µes. <br><br>  Existem pe√ßas offline e online.  No primeiro, os clientes s√£o pr√©-segmentados usando dados de todos os sistemas.  Analistas e dados Os cientistas estudam comportamento, dados hist√≥ricos e criam as chamadas armadilhas.  O principal √© capturar um evento significativo que pode ser rastreado por uma transa√ß√£o do adquirente, um aplicativo m√≥vel ou outras fontes dispon√≠veis.  E esse evento j√° √© processado por meio de an√°lise de streaming e a decis√£o √© tomada no momento com base nas armadilhas preparadas. <br><br>  O objetivo do CDC GoldenGate √© fornecer fluxo de dados de eventos em tempo real dos sistemas de origem para a plataforma anal√≠tica.  A licen√ßa do GoldenGate for Big Data tamb√©m inclui o Oracle Stream Analytics.  Com sua ajuda, os cientistas de dados podem processar independentemente o fluxo de dados no Spark Streaming, desenvolvendo o aplicativo em um ambiente visual. <br><br><h2>  Caso 4. Contra√ß√£o operacional para novos tipos de fraude </h2><br>  Os sistemas antifraude s√£o bastante fechados, e com raz√£o: quanto menos pessoas se dedicam aos detalhes, maior a seguran√ßa.  Eles fazem um √≥timo trabalho ao lidar com casos padr√£o, mas √†s vezes surgem situa√ß√µes que n√£o se encaixam nos scripts padr√£o.  Portanto, √© importante suplementar esses modelos com cen√°rios n√£o padronizados.  Estamos constantemente desenvolvendo novos modelos baseados na correla√ß√£o de eventos de v√°rios sistemas: transa√ß√µes com cart√£o e moeda, localiza√ß√£o, opera√ß√µes de sistemas de pagamento, a√ß√µes em aplicativos m√≥veis, monitoramento de redes sociais.  Para alterar o modelo, voc√™ deve seguir os processos aceitos: solicita√ß√£o de neg√≥cios, configura√ß√£o de tarefas, passando o aplicativo por todos os est√°gios internos de implementa√ß√£o. <br>  No ano passado, testamos o upload de dados usando o Oracle GoldenGate for Big Data dos sistemas tradicionais mais movimentados, onde havia muitas transa√ß√µes pequenas, e do nosso sistema antifraude ao cluster principal no Oracle Big Data Appliance.  Tanto o Hadoop quanto o GoldenGate lidaram com a quantidade de dados transferidos - ficamos surpresos. <br><br><h2>  Terabytes por hora e outras descobertas </h2><br>  Nos √∫ltimos dois anos, com o GoldenGate, dobramos o volume de logs transferidos - at√© quase 1 TB por hora.  Isso quase fecha nossas necessidades no momento.  Infelizmente, h√° f√≠sica em que nos deparamos.  Mas, para aumentar a produtividade, o trabalho ativo est√° sendo realizado com a equipe de desenvolvimento GoldenGate, portanto, isso est√° longe do limite.  Ao mesmo tempo, estamos assistindo e testando solu√ß√µes CDC de outros fornecedores, mas n√£o encontramos nenhum motivo para migrar do Oracle GoldenGate.  No momento, essa tecnologia provou ser a mais madura das existentes no mercado. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479080/">https://habr.com/ru/post/pt479080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479068/index.html">An√°lise de incidentes em sistemas e redes de computadores</a></li>
<li><a href="../pt479070/index.html">Como Nadia se tornou Nadezhda Mikhailovna</a></li>
<li><a href="../pt479072/index.html">Navegador Firefox - 15¬∫ anivers√°rio: ascens√£o, queda e renascimento com foco na privacidade</a></li>
<li><a href="../pt479074/index.html">Est√° chegando a era dos servidores ARM?</a></li>
<li><a href="../pt479078/index.html">Cinco raz√µes pelas quais a IA n√£o ser√° capaz de substituir as pessoas e s√≥ nos tornar√° melhores</a></li>
<li><a href="../pt479082/index.html">Respostas pr√°ticas a perguntas n√£o triviais ou Como implementar o DevSecOps em organiza√ß√µes com um cen√°rio de TI complexo</a></li>
<li><a href="../pt479086/index.html">Habr Weekly # 30 / Atualiza√ß√£o do ano, sal√°rios de TI e para onde eles v√£o, usou MacBooks, ferramenta m√∫ltipla para pentester</a></li>
<li><a href="../pt479088/index.html">Como se preparar para uma entrevista no YCombinator</a></li>
<li><a href="../pt479092/index.html">Rede neural ensinada a reconhecer a fala nos l√°bios usando um algoritmo de reconhecimento de grava√ß√£o de voz</a></li>
<li><a href="../pt479094/index.html">Procurando um n√∫mero de perfil do Instagram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>