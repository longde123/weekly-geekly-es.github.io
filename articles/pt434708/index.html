<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôãüèΩ üî´ üò´ HL 2018. Resumo do relat√≥rio ‚ÄúTorne as senhas √≥timas novamente! Como vencer a for√ßa bruta e deixar os hackers sem nada ‚Äù ‚ôìÔ∏è üòº üïµÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Meu nome √© Akhmadeev Rinat, sou Sr. Desenvolvedor PHP. 


 Apresento a voc√™ o resumo do relat√≥rio Torne as senhas √≥timas novamente! Como der...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>HL 2018. Resumo do relat√≥rio ‚ÄúTorne as senhas √≥timas novamente! Como vencer a for√ßa bruta e deixar os hackers sem nada ‚Äù</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434708/"><p><img src="https://habrastorage.org/webt/ey/xs/qh/eyxsqh1i0z7s2_fexslxgbdi-fy.png" alt="As senhas s√£o como roupas √≠ntimas"></p><br><p>  Ol√° Habr!  Meu nome √© Akhmadeev Rinat, sou Sr.  Desenvolvedor PHP. </p><br><p>  Apresento a voc√™ o resumo do relat√≥rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Torne as senhas √≥timas novamente!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como derrotar o bruteforce e deixar hackers com nada</a> de Alexey Ermishkin da Virgil Security com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HighLoad ++ 2018</a> . </p><br><p>  Quando fui ao relat√≥rio, fiquei pessimista.  Mas desde  Por ser a Virgil Security, eu ainda decidi ir.  No come√ßo, o relat√≥rio parecia realmente o do capit√£o, e eu at√© comecei a perder o interesse, mas ent√£o, como se viu, descobri v√°rias novas abordagens de prote√ß√£o por senha, al√©m do uso comum de sal. </p><br><p>  O relat√≥rio discute maneiras de proteger senhas de hashes para abordagens mais modernas, como a senha do Facebook Onion, Sphinx e Pythia.  No final, os novos servi√ßos simples de criptografia protegida por senha (PHE) s√£o introduzidos. </p><br><p>  Gostei tanto do relat√≥rio que preparei um comp√™ndio.  Eu recomendo a todos que se familiarizem. </p><a name="habracut"></a><br><p>  Alexey Ermishkin compartilhou os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">slides</a> e a reportagem em v√≠deo nos coment√°rios: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/y1MQyl13ssc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="konspekt">  Resumo </h2><br><h3 id="vstuplenie">  Entrada </h3><br><p><img src="https://habrastorage.org/webt/wd/sg/tu/wdsgtu8tz1yjoswesm2sjy7gs0k.png" alt="Slide 0. Torne as senhas √≥timas novamente"></p><br><p>  Ol√° pessoal, bom dia pessoal!  Fico feliz em ver todos voc√™s na Confer√™ncia Highload.  Meu nome √© Alexey Ermishkin, trabalho para a Virgil Security. </p><br><p><img src="https://habrastorage.org/webt/p_/dm/2o/p_dm2o99hyouir1mw0qn1nq_k0s.png" alt="Virgilsecurity"></p><br><p>  Estamos envolvidos no desenvolvimento de v√°rios produtos criptogr√°ficos, tanto para desenvolvedores individuais quanto para empresas.  N√≥s nos concentramos em solu√ß√µes de ponta a ponta, √© quando voc√™ n√£o precisa confiar no servi√ßo para executar a√ß√µes como transfer√™ncia de dados, autentica√ß√£o, etc.  Nossos SDKs s√£o abertos e acess√≠veis a todos. </p><br><p><img src="https://habrastorage.org/webt/mt/_q/ey/mt_qeyv-o-f8tcltewqjz5bdxze.png" alt="Slide 7. Desempenho, conveni√™ncia, seguran√ßa"></p><br><p>  As senhas s√£o usadas h√° muito tempo como meio de autentica√ß√£o, como forma de chegar a algum lugar.  Isso foi muito antes dos computadores aparecerem.  Mas com o advento dos computadores, com o advento dos sistemas de TI, as pessoas n√£o abandonaram o h√°bito de usar senhas.  Isso se tornou um grande problema para os desenvolvedores, porque eles enfrentaram o problema de como tornar os sistemas convenientes, r√°pidos e seguros.  Muitas vezes, quando alguns desses aspectos est√£o tentando se sair bem, o terceiro n√£o funciona muito bem.  Se voc√™ tornar o sistema produtivo e seguro, poder√° ser inconveniente, etc. </p><br><p><img src="https://habrastorage.org/webt/yf/vy/8n/yfvy8nslfegffzdm8ldboycqpvc.png" alt="Slide 8. De que estamos nos protegendo?"></p><br><p>  Ent√£o, sobre o que vamos falar hoje? </p><br><p>  Vou falar sobre prote√ß√£o contra ataques offline.  Quando as senhas entram nos seus bancos de dados, o usu√°rio n√£o as controla.  Se o seu banco de dados for invadido, ele vazar√° em algum lugar e, depois disso, os hackers poder√£o fazer qualquer coisa com ele.  Mesmo que voc√™ tenha protegido as senhas, elas podem come√ßar a separ√°-las e n√£o precisam interagir com ningu√©m para isso, elas j√° t√™m tudo para isso.  Al√©m disso, os usu√°rios n√£o param de usar senhas fracas.  As pol√≠ticas de senha s√£o obviamente √∫teis, mas tamb√©m nem sempre s√£o convenientes, ou seja,  quando at√© as pessoas digitam parecer uma senha forte, a pol√≠tica ainda diz que voc√™ precisa adicionar uma letra ou um n√∫mero; ent√£o, para elas, n√£o √© conveniente.  Tamb√©m √© √≥bvio que o problema √© a necessidade de comparar o que o usu√°rio digitou com o que voc√™ possui no banco de dados.  Como fazer isso de maneira segura?  Bem, n√£o vamos esquecer que, dentro da empresa, tamb√©m existem pessoas que n√£o s√£o completamente amig√°veis ‚Äã‚Äãe gostariam de se proteger delas tamb√©m. </p><br><h3 id="heshi">  Hashes </h3><br><p><img src="https://habrastorage.org/webt/-w/aj/lj/-wajlj6zqzv9v52a1tm-jyykii0.png" alt="Slide 9. O que h√° de errado com as senhas?"></p><br><p>  Em princ√≠pio, por que as senhas s√£o um assunto t√£o dolorido, por que vale a pena trabalhar com elas com mais cuidado?  O problema √© que a senha tem uma pequena <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entropia</a> .  O que √© entropia?  Essa √© a quantidade de informa√ß√µes contidas nos dados, ou seja,  por exemplo, na palavra Highload, 8 letras s√£o 8 bytes, mas se contarmos a entropia, ela n√£o ter√° 64 bits como a palavra inteira, mas menos de 30 bits.  Hoje, quando eles falam sobre quebrar a senha, dizem que √© poss√≠vel decifrar senhas com entropia em um tempo que n√£o existe mais ou menos que tantos bits.  I.e.  mesmo o n√∫mero exato de senhas n√£o √© levado em considera√ß√£o. </p><br><p><img src="https://habrastorage.org/webt/2u/ry/lh/2urylhxlc1vap1pdvcq8wqubgai.png" alt="Slide 10.1.  Hashes"></p><br><p>  Como as pessoas come√ßaram a usar a seguran√ßa de senhas?  A primeira coisa que veio √† mente foi usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hashes criptogr√°ficos</a> unidirecionais. </p><br><p><img src="https://habrastorage.org/webt/ny/ng/3e/nyng3eb-ukqoj_siqeyekl-m6ys.png" alt="Slide 10.2.  Hashes"></p><br><p>  Sua caracter√≠stica not√°vel √© que eles n√£o podem ser devolvidos.  I.e.  Se voc√™ transferiu algumas informa√ß√µes para esse hash, recebeu um valor na sa√≠da, n√£o ser√° poss√≠vel recuperar essas informa√ß√µes a partir desse valor.  Mas, infelizmente, eles s√£o calculados muito rapidamente.  Por exemplo, um cluster moderno de 4 placas gr√°ficas NVidia pode processar v√°rios bilh√µes de senhas por segundo.  I.e.  se a entropia da sua senha for inferior a 40 bits, um cluster de 4 placas de v√≠deo a buscar√° em um minuto ou at√© menos. </p><br><h3 id="raduzhnye-tablicy">  Mesas de arco-√≠ris </h3><br><p><img src="https://habrastorage.org/webt/rw/bd/ku/rwbdku7uc7nlyovcvlp7fh19zbk.png" alt="Slide 11.1.  Mesas de arco-√≠ris"></p><br><p>  Al√©m disso, cada hash complicado tem sua pr√≥pria <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tabela de arco-√≠ris</a> .  O que √© esta tabela e como eles s√£o feitos? </p><br><p><img src="https://habrastorage.org/webt/m_/sj/yy/m_sjyylroq0g4wcqjj8stum8yq4.png" alt="Slide 11.2.  Mesas de arco-√≠ris"></p><br><p>  I.e.  eles pegam as senhas mais populares e as combina√ß√µes de caracteres que podem caber no disco r√≠gido, consideram hashes para eles e os colocam em um pouco mais de armazenamento por v√°rios terabytes.  Quando existe algum tipo de hash, n√£o √© poss√≠vel calcul√°-lo, mas encontre-o muito rapidamente nessas tabelas e compare-o com a senha que foi calculada anteriormente.  I.e.  As vantagens das tabelas s√£o que elas funcionam muito rapidamente, mas voc√™ precisa de muito espa√ßo para armazen√°-las.  No entanto, existem tabelas para os hashes mais populares da Internet, que podem ser baixados ou comprados. </p><br><p>  <em>Nota do autor da sinopse: A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> n√£o concorda com o falante: "A tabela Rainbow √© uma vers√£o especial das tabelas de pesquisa para reverter fun√ß√µes hash criptogr√°ficas usando o mecanismo de um compromisso razo√°vel entre o tempo de pesquisa na tabela e a mem√≥ria ocupada".</em>  <em>I.e.</em>  <em>ele n√£o armazena os hashes das senhas mais populares que cabem no disco, mas simplesmente os hashes de algumas senhas; o restante √© calculado com base nas que existem - existem v√°rias senhas por registro na tabela.</em> </p><br><h3 id="sol">  Sal </h3><br><p><img src="https://habrastorage.org/webt/nx/cx/l3/nxcxl3ijlwytnvaumlbt9zlnjdo.png" alt="Slide 12.1.  Sal"></p><br><p>  Mas, novamente, cada mesa arco-√≠ris tem seu pr√≥prio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sal</a> .  O que √© sal?  Este √© um conjunto aleat√≥rio de bytes, que √© anexado √† senha.  Ele √© armazenado em uma tabela em algum lugar pr√≥ximo ao hash e protege das tabelas do arco-√≠ris. </p><br><p><img src="https://habrastorage.org/webt/xl/z1/_j/xlz1_j7oasnp6wpvijtlbmpw5n8.png" alt="Slide 12.2.  Sal"></p><br><p>  I.e.  as pessoas que colocam as m√£os em uma base com hashes salgados ainda precisam calcular esses hashes.  Mas o problema √© que esses hashes s√£o calculados muito rapidamente e o sal n√£o ajuda muito aqui. </p><br><h3 id="kak-zamedlit-perebor">  Como retardar a pesquisa? </h3><br><p><img src="https://habrastorage.org/webt/tb/vh/of/tbvhoftqtm7hlvgibwwvafv9cl4.png" alt="Slide 13.1.  Como retardar uma pesquisa?"></p><br><p>  Uma sa√≠da natural disso poderia ser retardar a classifica√ß√£o de hash de alguma maneira.  Como isso pode ser feito? </p><br><p><img src="https://habrastorage.org/webt/6j/9c/x0/6j9cx0nof6w-dzgbc3b6nx5qw-8.png" alt="Slide 13.2.  Como retardar uma pesquisa?"></p><br><p>  A abordagem mais ing√™nua √© que pegamos algum tipo de fun√ß√£o hash, por exemplo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sha256,</a> e a computamos iterativamente, ou seja,  calcular o hash, a partir deste hash o hash novamente, etc.  Voc√™ pode fazer isso milhares e at√© milh√µes de vezes.  O problema √© que, se voc√™ escrever uma implementa√ß√£o desse tipo, provavelmente ser√° mais lenta que a implementa√ß√£o de pessoas envolvidas profissionalmente na adivinha√ß√£o de senha. </p><br><p><img src="https://habrastorage.org/webt/nj/f3/hr/njf3hrodtzqbbu5w3purv-vsm6u.png" alt="Slide 14. Fun√ß√µes de hash de senha"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SCrypt</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bcrypt</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arg√¥nio2</a> </p><br><p>  E, portanto, os criptografadores criaram v√°rias fun√ß√µes projetadas especificamente para retardar a pesquisa de senhas - eles usam uma grande quantidade de mem√≥ria e todas as instru√ß√µes modernas poss√≠veis do processador.  Se a senha protegida por essa fun√ß√£o cair nas m√£os dos atacantes, eles ter√£o que usar um hardware muito poderoso. </p><br><p><img src="https://habrastorage.org/webt/-e/ed/gw/-eedgw4f2c-6q3khy9pywdotzwa.png" alt="Slide 15. Argon2"></p><br><p>  Por exemplo, a fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Argon2</a> mais moderna funciona da seguinte maneira: no diagrama, voc√™ pode ver que existem muitos blocos de mem√≥ria diferentes atrav√©s dos quais o hash √© executado.  Ele faz isso de v√°rias maneiras, ida e volta, a mem√≥ria √© usada com muita intensidade, toda a mem√≥ria √© usada.  √â bastante dif√≠cil otimizar essa fun√ß√£o (velocidade de pesquisa). </p><br><p><img src="https://habrastorage.org/webt/eu/gn/u2/eugnu2x_t3tsbyfzqmyesuwlmse.png" alt="Slide 16. Fun√ß√µes de hash de senha"></p><br><p>  Mas essas abordagens tamb√©m t√™m suas desvantagens.  Essas fun√ß√µes s√£o lentas especialmente, mas s√£o lentas n√£o apenas para os atacantes, mas tamb√©m s√£o lentas para voc√™.  Eles v√£o carregar seu ferro.  Essas fun√ß√µes s√£o personaliz√°veis, ou seja,  voc√™ pode escolher quanta mem√≥ria ser√° usada para calcular o hash de uma √∫nica senha, at√© v√°rios gigabytes, quantas passagens nessa mem√≥ria.  Se voc√™ enrolar esses par√¢metros com muita seriedade, seu pr√≥prio hardware sofrer√° e se houver muitas pessoas conectando-se ao sistema, basta alocar recursos substanciais para a prote√ß√£o de senhas e senhas simples. Bem, senhas muito simples ainda podem ser obtidas . </p><br><h3 id="facebooks-password-onion">  Senha do Facebook Onion </h3><br><p><img src="https://habrastorage.org/webt/jg/ij/6k/jgij6ksfudwqixuwbidyqos8g_y.png" alt="Slide 17. E voc√™ n√£o pode carregar o back-end?"></p><br><p>  As pessoas pensaram sobre isso e fizeram a pergunta: √© poss√≠vel obter as mesmas propriedades sem carregar o back-end, sem carregar seus pr√≥prios servidores? </p><br><p><img src="https://habrastorage.org/webt/3t/bt/i5/3tbti5mfy7-5smkvkfpkzyw8cq0.png" alt="Slide 18. Senha do Facebook Onion"></p><br><p>  Um dos pioneiros nisso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">foi o Facebook</a> .  Essas linhas que voc√™ v√™ s√£o os est√°gios hist√≥ricos do Facebook, como eles protegiam senhas, no in√≠cio eram apenas senhas, depois pegaram a antiga fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">md5</a> , que foi quebrada por um longo tempo, depois adicionaram sal l√° e pegaram o hash <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sha1</a> , e aconteceu interessante, eles trouxeram o c√°lculo da fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hmac</a> (este √© um hash com uma chave) para o servi√ßo remoto. </p><br><p><img src="https://habrastorage.org/webt/at/hg/59/athg59eofneynp9pmmn1ffzdbg8.png" alt="Slide 19. Facebook"></p><br><p>  Como isso funciona?  H√° um back-end, h√° um servi√ßo remoto.  Existe algum tipo de chave secreta nesse servi√ßo.  Uma pessoa entra no back-end, digita sua senha.  Essa senha √© misturada com o salt que est√° no banco de dados, √© executada atrav√©s de um hash e enviada ao servi√ßo.  O servi√ßo pega sua chave privada, calcula a fun√ß√£o hmac e envia tudo de volta.  No back-end, √© colocado na base. </p><br><p><img src="https://habrastorage.org/webt/nj/hw/ac/njhwackeuo-kschvhkkvaxstmky.png" alt="Slide 20. Facebook"></p><br><p>  O que isso d√°?  Se o Facebook tiver um banco de dados de usu√°rios, n√£o vale a pena classificar senhas, porque eles n√£o possuem uma chave secreta remota.  Mas o problema com a abordagem do Facebook √© que, se algo acontecer com sua chave privada remota, eles ter√£o grandes problemas.  Eles n√£o podem fazer nada porque usam hashes, eles usam hmac.  Eles n√£o t√™m como resolver de alguma forma essa situa√ß√£o, para que os usu√°rios n√£o notem nada, e isso acaba levando a um canto. </p><br><h3 id="sphinx">  Esfinge </h3><br><p><img src="https://habrastorage.org/webt/_t/kq/nd/_tkqnduhchzryj-sgjt-kqytyo0.png" alt="Slide 21. Est√° melhor?"></p><br><p>  Os criptografadores olharam para a coisa toda.  Eles gostaram da ideia de usar servi√ßos remotos e decidiram pensar: √© poss√≠vel fazer ainda melhor?  √â poss√≠vel criar um sistema semelhante, mas sem os inconvenientes que o Facebook o dotou? </p><br><p><img src="https://habrastorage.org/webt/hh/04/o5/hh04o5poadnr-d4diswhuaferuq.png" alt="Slide 22. A senha √© um n√∫mero?"></p><br><p> E eles decidiram abordar esse problema da seguinte maneira: e se a senha ou o hash da senha for representado como um n√∫mero?  Se temos a palavra <code>passw0rd</code> , ela consiste em 8 bytes.  Em quase todas as linguagens de programa√ß√£o, existem tipos inteiros de oito bytes, ou seja,  Em princ√≠pio, este √© o mesmo.  I.e.  8 bytes, a palavra <code>passw0rd</code> e podemos represent√°-la como um n√∫mero decimal regular.  O que isso nos d√°?  Isso nos d√° uma liberdade de a√ß√£o completamente diferente.  Podemos adicionar senhas ou hashes a partir deles, multiplic√°-los, transform√°-los em outros n√∫meros.  Podemos realizar opera√ß√µes matem√°ticas realmente s√©rias com eles. </p><br><p><img src="https://habrastorage.org/webt/6h/3d/wm/6h3dwmeitk9jftagy1hszcqbmgo.png" alt="Slide 23.1. Sphinx - gerenciador de senhas"></p><br><p>  Um dos primeiros sistemas que usaram essa tecnologia foi o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sphinx</a> .  Ela apareceu alguns anos atr√°s.  Este √© um gerenciador de senhas determin√≠stico.  Existem muitos programas diferentes, como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">keepass</a> , onde voc√™ tem uma senha mestra e, para cada site, gera uma senha aleat√≥ria.  Mas tamb√©m existem coisas determin√≠sticas nas quais voc√™ digita sua senha mestra, o site que deseja acessar e calcula algo l√° e emite uma senha exclusiva para cada site.  Mas √© claro que, se essa senha mestre for para algum lugar, todas as senhas dos seus sites ser√£o permanentemente comprometidas. </p><br><p><img src="https://habrastorage.org/webt/qs/9j/0z/qs9j0z8enfk9_j_p53msuqcxufu.png" alt="Slide 23.2. Sphinx - gerenciador de senhas"></p><br><p>  Como a Sphinx abordou esse problema?  Ele pega a senha mestra, pega o dom√≠nio no qual voc√™ deseja fazer login, executa a coisa toda atrav√©s de um hash e a transforma em n√∫mero.  Mas, de fato, a criptografia el√≠ptica √© usada l√°, para simplificar explicarei tudo isso em n√∫meros comuns com a matem√°tica comum.  Ele o transforma em um n√∫mero (vamos cham√°-lo de) e o que ele faz a seguir? </p><br><p><img src="https://habrastorage.org/webt/wx/ba/hk/wxbahkcpmzzmwsaxj1_abbdwrpq.png" alt="Slide 24. Esfinge - o &quot;gerente&quot; de senhas, disfarce!"></p><br><p>  Coisa absolutamente maravilhosa, toda vez que podemos gerar um grande n√∫mero aleat√≥rio <code>r</code> .  Se elevarmos o n√∫mero a √† pot√™ncia de <code>r</code> , e algum tempo depois elevarmos esse n√∫mero √† pot√™ncia inversa ao n√∫mero <code>r</code> , voltaremos ao mesmo n√∫mero <code>a</code> , certo?  I.e.  podemos mascarar algo desde o come√ßo e depois desmascar√°-lo. </p><br><p><img src="https://habrastorage.org/webt/pu/yp/5t/puyp5t7x6yprlu_xyybj4z8llna.png" alt="Slide 25.1. Sphinx - gerenciador de senhas"></p><br><p>  E o que a esfinge faz?  Novamente, h√° um usu√°rio, h√° um servi√ßo remoto.  Um n√∫mero mascarado √© enviado para este servi√ßo remoto.  No servi√ßo remoto, h√° uma chave privada <code>b</code> .  O que ele esta fazendo?  Ele multiplica o n√∫mero enviado <code>a^r</code> por sua chave secreta <code>b</code> envia de volta.  ( <em>Nota do autor do comp√™ndio: no slide, o n√∫mero enviado n√£o √© multiplicado pela chave privada, mas √© aumentado para o grau da chave privada, mas o ponto principal √©</em> ).  Como o n√∫mero <code>r</code> diferente a cada vez, o servi√ßo remoto n√£o pode dizer nada sobre qual senha e dom√≠nio foram mascarados, ou seja,  toda vez que ele v√™ alguns n√∫meros aleat√≥rios diferentes.  E ele simplesmente multiplica pela sua chave privada <code>b</code> envia de volta. </p><br><p><img src="https://habrastorage.org/webt/gs/nm/bx/gsnmbxvngd2m2ziqnuqo-mdtney.png" alt="Slide 25.2. Sphinx - gerenciador de senhas"></p><br><p>  O usu√°rio desmascara o que o servidor enviou e ele recebe um n√∫mero - sua senha mestre com o dom√≠nio multiplicado pela chave secreta do servidor <code>a^b</code> .  Acontece que ele n√£o conhece a chave secreta do servidor, o servidor n√£o sabe o que o usu√°rio enviou, mas no final ele tamb√©m recebe algum tipo de n√∫mero determin√≠stico.  Cada vez que voc√™ executa esse protocolo, o disfarce ser√° diferente, mas o resultado ser√° sempre o mesmo e poder√° ser transformado em algum tipo de senha e usado para entrar em v√°rios sites. </p><br><p><img src="https://habrastorage.org/webt/7v/zd/hv/7vzdhvrksyvyg_awii2rkvphdgy.png" alt="Slide 26. Sphinx - o &quot;gerente&quot; de senhas"></p><br><p>  Tecnologia verdadeiramente maravilhosa.  Primeiro, voc√™ pode gerar senhas grandes, ou seja,  protege de rebentar.  Em segundo lugar, se um hacker obtiver acesso a v√°rias senhas, ele n√£o poder√° dizer nada sobre o resto, porque  eles s√£o gerados independentemente um do outro.  Terceiro, se a senha do usu√°rio desaparecer em algum lugar, isso tamb√©m n√£o dar√° nada, porque os hackers n√£o ter√£o uma chave secreta.  Quarto, funciona muito rapidamente, porque  aqui n√£o s√£o necess√°rios hashes grandes iterativos, ou seja,  literalmente 2-3 multiplica√ß√µes s√£o realizadas e tudo funciona instantaneamente. </p><br><p>  Mas este sistema tem suas desvantagens.  O servidor com o qual o usu√°rio est√° falando n√£o sabe nada sobre ele.  Ele simplesmente recebe alguns n√∫meros aleat√≥rios como entrada, multiplica-os por algo e os envia de volta.  O cliente tamb√©m n√£o sabe nada sobre o servidor, envia algo para algum lugar, recebe o resultado, funciona - bem.  Mas se algo acontecer com o servi√ßo, o usu√°rio n√£o poder√° dizer nada sobre ele, ele n√£o ter√° informa√ß√µes para isso.  A chave secreta tamb√©m n√£o pode ser alterada; nada pode ser feito com ela. </p><br><h3 id="pythia">  Pythia </h3><br><p><img src="https://habrastorage.org/webt/cp/kt/3z/cpkt3zvvpwx7svjbydprtntli5i.png" alt="Slide 27. Poderia ser melhor?"></p><br><p>  Poderia ser melhor? </p><br><p><img src="https://habrastorage.org/webt/ot/jg/ms/otjgmsc63aic6zb8mpod01tn9jy.png" alt="Slide 28. END-TO-END!"></p><br><p>  Os criptografadores examinaram este sistema e pensaram: √© poss√≠vel melhorar o sistema e complement√°-lo com propriedades que nos permitiriam dizer que ele cumpre os princ√≠pios de ponta a ponta?  I.e.  o cliente pode se comunicar com o servidor, mas, ao mesmo tempo, tamb√©m pode autentic√°-lo e, em certa medida, confiar nele. </p><br><p><img src="https://habrastorage.org/webt/gv/2o/p8/gv2op8fshghvw1rvt0dnqnqwxnw.png" alt="Slide 29.1. Pythia"></p><br><p>  E eles criaram um protocolo chamado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pythia</a> . </p><br><p><img src="https://habrastorage.org/webt/kq/wd/in/kqwdin-__0xxfcerqmva6s2vewo.png" alt="Slide 29.2. Pythia"></p><br><p>  Foi feita pelo homem maravilhoso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Adam Everspaugh</a> com seus colegas.  O que o torna √∫nico?  Em primeiro lugar, o servi√ßo sabe quem digita a senha, ou seja,  o ID do usu√°rio √© passado para o servidor ap√≥s a senha.  Pode ser uma caixa de identifica√ß√£o aleat√≥ria ao lado ou apenas um nome de usu√°rio.  Isso n√£o importa.  Mas o servi√ßo sabe disso.  Mas o servidor n√£o apenas sabe um pouco disso, mas estritamente pode provar matematicamente que √© ele. </p><br><p><img src="https://habrastorage.org/webt/pf/lo/zf/pflozf9qji8nzq_nhpswlqd-3xa.png" alt="Slide 30.1. Pythia"></p><br><p>  Como isso funciona?  Existe um back-end (algum tipo de servi√ßo da web, site) e existe um servi√ßo Pythia.  O que o back-end faz e o que o servi√ßo faz?  H√° uma chave privada <code>k</code> no servi√ßo, mas tamb√©m transfere sua chave p√∫blica para o back-end.  O back-end do servi√ßo envia n√£o apenas o n√∫mero mascarado <code>a^r</code> , como no protocolo Sphinx, mas tamb√©m envia algum tipo de identificador de usu√°rio ( <code>UserID</code> do usu√°rio).  O servi√ßo multiplica o ID do usu√°rio e a senha por sua chave privada e o resultado <code>(UserID, a)^(r*k)</code> do usu√°rio <code>(UserID, a)^(r*k)</code> envia o back-end.  Ele tamb√©m envia de volta uma certa <code>Proof</code> , que pode ser usada pelo servidor para verificar se o servidor n√£o foi hackeado, se est√° respondendo como deveria. </p><br><p><img src="https://habrastorage.org/webt/re/qr/x2/reqrx276lka5gxfal99x0_l9esy.png" alt="Slide 30.2. Pythia"></p><br><p>  Depois, h√° um desmascaramento e o n√∫mero <code>y</code> que resulta como resultado √© colocado em um banco de dados.  No banco de dados, n√£o temos apenas um hash, mas um n√∫mero, um ponto de uma curva el√≠ptica. </p><br><p><img src="https://habrastorage.org/webt/xx/qc/jt/xxqcjtbljojosjg0ssvhptf3oj0.png" alt="Slide 31. Pythia"></p><br><p>  Existem alguns pontos interessantes aqui: </p><br><ul><li>  A capacidade do servidor de combinar o ID do usu√°rio e a senha em um n√∫mero.  Isso √© chamado de opera√ß√£o bilinear ou emparelhamento bilinear.  Essa √© uma matem√°tica relativamente nova, que recentemente come√ßou a ser usada.  Ela tem todas as propriedades dos novos matem√°ticos nos √∫ltimos 30 anos, para que todos fiquem convencidos de que tudo est√° normal com isso. </li><li>  Mas a <code>Proof</code> que envia o servi√ßo √© uma tecnologia bastante antiga.  Isso √© chamado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">protocolo Schnorr</a> .  A gera√ß√£o de chave p√∫blica √© a multiplica√ß√£o de um ponto base por alguma chave secreta.  O protocolo Schnorr prova que a chave secreta usada para gerar a chave p√∫blica foi usada para multiplicar a senha do usu√°rio pelo mesmo n√∫mero.  Este protocolo j√° existe h√° muito tempo, √© muito usado onde e permite que voc√™ prove.  Isso √© chamado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de prova √† prova de zero</a> - o servidor n√£o mostra sua chave p√∫blica, mas diz que a opera√ß√£o que eu executei foi executada por essa chave privada, com a qual originalmente concordamos. </li></ul><br><p><img src="https://habrastorage.org/webt/jz/pg/lo/jzpglodcswcwxprayrpud8semws.png" alt="Slide 32.1. Profissionais de Pythia"></p><br><p>  Quais s√£o as vantagens deste sistema? </p><br><p><img src="https://habrastorage.org/webt/xn/dg/zg/xndgzgr-to_dgnypnwarbyxengg.png" alt="Slide 32.2. Profissionais de Pythia"></p><br><p>  E ela n√£o tem muitos deles. </p><br><ul><li>  O sistema n√£o carrega o back-end.  Como o back-end faz tudo, transforma a senha em um n√∫mero, disfar√ßa, envia e desmascara o resultado tamb√©m. </li><li>  Se um banco de dados com esses n√∫meros for roubado de voc√™, a classifica√ß√£o de senhas tamb√©m n√£o far√° sentido sem uma chave privada. </li><li>  O servi√ßo Pythia pode bloquear tentativas de for√ßa bruta, o que significa que o back-end n√£o precisa fazer isso em princ√≠pio.  Se ele perceber que, com o mesmo ID do usu√°rio, eles tentam executar essa opera√ß√£o de transforma√ß√£o v√°rias vezes, ele pode simplesmente cort√°-lo e bloque√°-lo no limite da taxa. </li><li>  Gra√ßas ao disfarce, o servi√ßo n√£o sabe nada sobre a senha.  Cada vez que um novo n√∫mero aleat√≥rio √© enviado a ele.  Somente o identificador de usu√°rio permanece constante. </li><li>  Gra√ßas ao ZKP (prova de zero conhecimento), o back-end sempre sabe que foi o pr√≥prio servi√ßo que ele entrou em contato. </li><li>  Se voc√™ tiver um banco de dados com hashes e sal, por exemplo, poder√° migrar para uma solu√ß√£o perfeita para os usu√°rios.  Eles podem nem perceber nada.  Em vez da senha do usu√°rio, voc√™ pega seu hash, o direciona para Pythia e, no futuro, apenas usa este protocolo, obt√©m o n√∫mero <code>y</code> e o coloca novamente em seu banco de dados.  O hash pode ser exclu√≠do.  Cada vez que um usu√°rio efetua login no seu sistema, esse protocolo ser√° executado, um n√∫mero ser√° obtido como resultado, o qual voc√™ comparar√° com o que est√° no banco de dados.  O sistema de autentica√ß√£o em si permanecer√° inalterado, pois  os usu√°rios efetuam login mais cedo e com as mesmas senhas, mesmo as mais fracas.  Nesse caso, o sistema ser√° muito mais seguro. </li></ul><br><p><img src="https://habrastorage.org/webt/2i/63/ja/2i63jae0xiucsx-dqailxoaqiuw.png" alt="Slide 33.1. Isso n√£o √© tudo"></p><br><p>  Mas estes n√£o s√£o todos os presentes. </p><br><p><img src="https://habrastorage.org/webt/oa/dy/h9/oadyh9nurjtlv5qdbgo8f2xfcui.png" alt="Slide 33.2. Isso n√£o √© tudo"></p><br><p>  Uma das principais caracter√≠sticas √© que, mesmo que o servi√ßo Pythia seja hackeado, √© poss√≠vel gerar uma nova chave privada.  Em nosso banco de dados, um n√∫mero √© armazenado, n√£o um hash.  Se representarmos a chave antiga como o n√∫mero <code>k</code> e a nova como o n√∫mero <code>k'</code> , poderemos calcular um n√∫mero chamado Atualizar token.  Para fazer isso, multiplicamos o novo n√∫mero pelo n√∫mero inverso ao antigo.  E com esse token de atualiza√ß√£o, voc√™ pode percorrer o banco de dados de cada usu√°rio e multiplicar esse n√∫mero <code>y</code> pelo token de atualiza√ß√£o.  Depois de fazer isso, seu sistema continuar√° trabalhando com a nova chave privada no servi√ßo remoto.  Tudo acontece instantaneamente.  Se ocorrer um desastre, seu banco de dados com senhas √© roubado, voc√™ libera o token de atualiza√ß√£o com o clique de um dedo e o fato de que hackers lhe roubaram se torna instantaneamente in√∫til.  Voc√™ apenas percorre silenciosamente todos os registros em segundo plano, os atualiza e eles trabalham com a nova chave secreta para voc√™.  Os usu√°rios geralmente nem percebem nada.  I.e.  Atualiza√ß√£o cont√≠nua e invalida√ß√£o instant√¢nea do banco de dados de senhas s√£o alguns dos principais recursos inovadores deste sistema. </p><br><p><img src="https://habrastorage.org/webt/uu/cb/_z/uucb_z0ikld1bufittz0asq5m84.png" alt="Slide 34.1. B√¥nus"></p><br><p>  Mas isso n√£o √© tudo. </p><br><p><img src="https://habrastorage.org/webt/vr/jo/3k/vrjo3kpwbw1xuzdr6wklxmwkrgw.png" alt="Slide 34.2. B√¥nus"></p><br><p>  O n√∫mero que fica na base √© grande <code>y</code> , √© basicamente grande e parece bastante pseudo-aleat√≥rio, ou seja,  √© t√£o f√°cil n√£o busc√°-lo.  Se transferirmos a funcionalidade que temos no back-end, por exemplo, para dispositivos clientes, telefones, podemos usar isso <code>y</code> para gerar chaves.  Chamamos isso de BrainKey.  Isso significa que o usu√°rio digita a senha em algum lugar do telefone, tamb√©m a disfar√ßa e a envia ao servi√ßo remoto.  O servi√ßo retorna um certo n√∫mero <code>y</code> e <code>y</code> seguida, voc√™ pode us√°-lo para gerar algumas chaves assim√©tricas.  Assim, o usu√°rio de sua senha pode obter um par de chaves.  Isso √© usado em todos os tipos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BrainWallets</a> .  √â quando voc√™ digita a senha e obt√©m a carteira de bitcoin gerada para ela.  Mas esse aplicativo n√£o se limita a criptomoedas, √© uma assinatura digital, alguns backups e recupera√ß√£o de contas, ou seja,  onde quer que a criptografia assim√©trica seja usada, onde chaves assim√©tricas s√£o necess√°rias.  Tudo isso pode ser usado, mas, ao mesmo tempo, um par de chaves e, dependendo da necessidade, podem ser gerados quantos voc√™ desejar.  Portanto, todos eles depender√£o da senha do usu√°rio, e isso √© muito conveniente. </p><br><p><img src="https://habrastorage.org/webt/sy/cw/nl/sycwnl1rpbmtpsc_0ddxi3fjlx0.png" alt="Slide 35.1. Contras?"></p><br><p>  Em um barril de mel, n√£o √© sem uma mosca na pomada. </p><br><p><img src="https://habrastorage.org/webt/wx/jw/an/wxjwanacuusmfnb_ptce1peh_cg.png" alt="Slide 35.2. Contras?"></p><br><p>  E os recursos desta tecnologia √© que ela √© muito nova.  Ele usa uma curva el√≠ptica, que √© para opera√ß√µes bilineares ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BLS12-381</a> ).  A pr√≥pria matem√°tica existe h√° algum tempo, mas essa curva espec√≠fica, que √© usada principalmente em nossa implementa√ß√£o, √© usada apenas no <nobr>ZCash,</nobr> exceto n√≥s.  Assim, as bibliotecas que usam essa nova matem√°tica podem ser contadas nos dedos de uma m√£o.  Para trazer isso para o estado de produ√ß√£o, voc√™ precisa gastar uma certa quantidade de tempo e esfor√ßo.  No entanto, o setor n√£o fica parado e todas essas desvantagens s√£o tempor√°rias.  Como conseq√º√™ncia das duas primeiras propriedades, a velocidade dessas opera√ß√µes bilineares n√£o √© muito consistente com a matem√°tica moderna, em particular el√≠ptica, que todos usamos agora, quando usamos o protocolo TLS, quando usamos alguns sites.  Isso est√° em torno de v√°rias centenas de opera√ß√µes em um servi√ßo em um n√∫cleo.  De fato, isso n√£o nos impediu e, na primavera, implementamos esse protocolo, lan√ßamos em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">produ√ß√£o</a> e traduzimos todos os nossos registros, protegendo-os usando esse protocolo.  Em princ√≠pio, estamos satisfeitos com o desempenho de nossas tarefas atuais; se necess√°rio, criaremos outro n√≥ com o servi√ßo Pythia e, em princ√≠pio, voc√™ j√° pode jogar com tudo isso. </p><br><h3 id="phe">  PHE </h3><br><p><img src="https://habrastorage.org/webt/hv/1e/1l/hv1e1lslzyk31hgsw2fu5sffk_o.png" alt="Slide 36. √â ainda melhor?"></p><br><p>  Mas pensamos se podemos fazer ainda melhor?  √â poss√≠vel obter as propriedades que Pythia fornece usando a matem√°tica de ontem?  Nem amanh√£, nem hoje, mas at√© ontem, que tem sido usado por muitos anos. </p><br><p><img src="https://habrastorage.org/webt/6r/rn/0x/6rrn0xaorj5qjkyuk2hhamqaqyk.png" alt="Slide 37.1.  Servi√ßos simples de criptografia protegidos por senha (PHE)"></p><br><p>  E, literalmente, em julho deste ano, os cientistas lan√ßaram um novo protocolo chamado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Servi√ßos de criptografia simples protegidos por senha,</a> ou PHE, para abreviar. </p><br><p><img src="https://habrastorage.org/webt/hx/o5/zv/hxo5zveu2y75lmqm-t3pqknaq0e.png" alt="Slide 37.2.  Servi√ßos simples de criptografia protegidos por senha (PHE)"></p><br><p>  Este √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Russell Lai</a> , um cientista da Europa. </p><br><p>  Qual √© a vantagem deste servi√ßo?  Primeiro, ele usa a curva <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">P-256</a> padr√£o, usada em todos os lugares, em todos os navegadores, produtos e em todos os lugares da curva padr√£o, que existe h√° muitos anos.  Em segundo lugar, isso funciona 10 vezes mais r√°pido que Pythia e usa primitivas padr√£o.  √â meio dif√≠cil, mas voc√™ pode implement√°-lo com suas pr√≥prias m√£os sem usar nenhuma biblioteca obscura.  Voc√™ pode usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenSSL</a> , ou o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bouncy Castle</a> , qualquer coisa. </p><br><p><img src="https://habrastorage.org/webt/el/f0/ho/elf0hoawmvsekav9jgvkqxp0_ju.png" alt="Slide 38. Servi√ßos simples de criptografia protegidos por senha (PHE)"></p><br><p>  Mas funciona um pouco diferente.  Novamente, h√° um back-end, h√° um servi√ßo de PHE.  O back-end tem uma chave p√∫blica, o servi√ßo tem uma chave privada <code>y</code> .  Ao contr√°rio de Pythia, o processo de registro e o processo de verifica√ß√£o de senha s√£o um pouco diferentes.  Quando um novo usu√°rio chega ao servi√ßo e deseja se registrar, o que o back-end faz?  Desde o in√≠cio, ele pediu ao servi√ßo PHE, por favor, me d√™ alguns dados que eu possa usar para registrar, algum tipo de registro de inscri√ß√£o.  O servi√ßo diz OK e responde ao back-end com as seguintes coisas.  Ele gera algum sal aleat√≥rio de 32 bytes ( <code>sNonce</code> ).  Com base nesse sal e em sua chave privada y, ele gera dois n√∫meros, vamos cham√°-los de <code>C0</code> e <code>C1</code> .  Tamb√©m gera provas ( <code>Proof</code> ) de que esses dois n√∫meros ou 2 pontos foram gerados precisamente usando sua chave privada <code>y</code> , usando o protocolo Schnorr (como nos protocolos anteriores).  O back-end verifica <code>Proof</code> .  Ainda n√£o h√° senha aqui.  O que o back-end faz?  Por sua vez, ele tamb√©m possui sua chave privada de cliente pessoal <code>x</code> e, ap√≥s receber a senha do usu√°rio, faz o mesmo que o servi√ßo, apenas adiciona a senha l√°.  Leva <code>cNonce</code> aleat√≥rio (sal de cliente aleat√≥rio), uma senha e gera novamente 2 n√∫meros <code>HC0</code> e <code>HC1</code> .  Por que 2?  Como o primeiro <code>HC0</code> usado para autentica√ß√£o, o segundo n√∫mero <code>HC1</code> mistura um n√∫mero aleat√≥rio <code>M</code> multiplicado pela chave privada <code>x</code> ( <code>MC</code> ).  O n√∫mero <code>M</code> tamb√©m tem 32 bytes de tamanho e pode ser usado posteriormente para criptografar dados do usu√°rio (temos Servi√ßos de Criptografia) ( <em>observa√ß√£o do autor da nota: neste caso, a chave de criptografia ser√° <code>MC</code></em> ).  O n√∫mero do <code>MC</code> estar√° dispon√≠vel como chave somente depois que o usu√°rio digitar a senha correta.  Acontece que, no est√°gio de registro, voc√™ pode gerar n√£o apenas um registro de autoriza√ß√£o, mas tamb√©m uma chave de criptografia, exclusiva para cada usu√°rio, com a qual voc√™ pode criptografar seu perfil, alguns dados e outras coisas.  Depois, o back-end simplesmente adiciona o que o servi√ßo enviou e o que fez - soma esses pontos e obt√©m <code>T0</code> e <code>T1</code> .  No primeiro caso, soma dois ( <code>C0 + HC0</code> ) e no segundo tr√™s ( <code>C1 + HC1 + MC</code> ).  E ele coloca na base 2 sais ( <code>sNonce</code> , <code>cNonce</code> ), com a ajuda dos quais esses n√∫meros foram obtidos e 2 n√∫meros ( <code>T0</code> e <code>T1</code> ), que resultaram como resultado da soma. </p><br><p><img src="https://habrastorage.org/webt/ly/9d/fj/ly9dfjao1laxszgo9okoovsvzjy.png" alt="Slide 39. Fa√ßa login no PHE"></p><br><p>  Assim, o processo de autentica√ß√£o do usu√°rio ocorre na ordem inversa.  O usu√°rio digita sua senha no back-end.  O back-end calcula <code>HC0</code> e, a partir do que possui no banco de dados, subtrai <code>HC0</code> de <code>T0</code> e envia o <code>C0</code> resultante ao servi√ßo junto com o sal do servidor.  O servi√ßo, conhecendo o salt do servidor, calcula o mesmo ponto em si e olha, coincide com o fato de que enviou ou n√£o o back-end, se corresponder, a senha est√° correta e voc√™ pode respond√™-la com o segundo n√∫mero <code>C1</code> , que subtrair√° junto com o <code>HC1</code> do n√∫mero <code>T1</code> e obtenha a chave de criptografia.  Portanto, a senha do servi√ßo PHE nem desaparece.  Ele nem sai do back-end.  √â na forma de alguns pontos multiplicados pela chave privada do back-end.  Ele nem existe como tal, mas, ao mesmo tempo, o servi√ßo remoto pode concluir estritamente se essa senha est√° correta ou n√£o e provar, al√©m disso, que ele executou todos os c√°lculos usando sua chave privada <code>y</code> . </p><br><p><img src="https://habrastorage.org/webt/bi/7-/op/bi7-opjxk_7cwvgb4lm4wkwgtbi.png" alt="Slide 40.1.  Recursos PHE"></p><br><p>  Quais recursos esse sistema possui? </p><br><p><img src="https://habrastorage.org/webt/2t/ar/rm/2tarrmmsr5j4sgk5zlrtcsu1eyc.png" alt="Slide 40.2.  Recursos PHE"></p><br><p>  A senha, como eu disse, n√£o sai do back-end.  Mas, diferentemente de Pythia, voc√™ precisa de uma chave privada no back-end.  Bem, precisamos e precisamos, salve em algum lugar.  PHE tem todas as fun√ß√µes b√°sicas de Pythia: </p><br><ul><li>  Voc√™ tamb√©m pode emitir o token de atualiza√ß√£o se algo acontecer com a chave privada; </li><li>  Voc√™ tamb√©m pode percorrer todo o banco de dados, atualizar e tudo ser√° como antes; </li><li>  prote√ß√£o de pesquisa; </li><li>  o servi√ßo n√£o sabe nada sobre a senha; </li><li>   (Pythia , ,  ,    ,  PHE ); </li><li>     . </li></ul><br><p><img src="https://habrastorage.org/webt/vq/_m/yr/vq_myrj2venkvtkjqaij3ujapd4.png" alt="Slide 41. Apresentando ..."></p><br><p>      ... </p><br><p><img src="https://habrastorage.org/webt/hp/s9/_t/hps9_tr6ha4ysxt6szxsdhseuoe.png" alt="Slide 42. passw0rd.io"></p><br><p> ‚Ä¶      .      .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">passw0rd.io</a>  .    password  ,    18-        ,    ,    zero trust, ..    .     , , ..  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Let's encrypt</a> .  ,   .    CLI     ,   .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 SDK</a> ,  GO  .Net,     . </p><br><p><img src="https://habrastorage.org/webt/ey/xs/qh/eyxsqh1i0z7s2_fexslxgbdi-fy.png" alt="Slide 43. As senhas s√£o como roupas √≠ntimas"></p><br><p>           : </p><br><ol><li>    . </li><li>      . </li><li>     . </li></ol><br><p><img src="https://habrastorage.org/webt/d4/nh/d4/d4nhd4nzbnhgfq21j-8yqs1ps0m.png" alt="Slide 44. Recursos"></p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VirgilSecurity.com</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@VirgilSecurity</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub.com/VirgilSecurity</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NoiseSocket.com</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">passw0rd.io</a> </li></ul><br><p>     ,             . </p><br><h3 id="voprosy"> ? </h3><br><p> <strong> 37. ?</strong> </p><br><p><img src="https://habrastorage.org/webt/z_/t0/05/z_t005mcdxnznvcinnqsg-z750a.png" alt="Slide 45. Perguntas?"></p><br><p>     . </p><br><p> Q: ,    !   .     ,      Pythia       update token,        ?        private key  .         update token?  Ou n√£o? <br> A: , update token-     . <br> Q:    .      -        update token-,       Private key         ? <br> A: ,    update token-,     ,  - ,   ,  ,    update token.     , ..   . <br> Q: , ,    ,   . <br> A: ..     . </p><br><p> Q: ,   ,     ,     -   Pythia  -    ,       ,     ,   ? <br> A:  . <br> Q:      ? <br> A: ,      Pythia   .  I.e.     ,        . <br> Q: ( )  bcrypt      ? <br> A: ,      ,   ,      . </p><br><p> Q:  ,    .      ?  , ‚Ä¶ <br> A: password   <br> Q: password  ?  Fogo!  Geralmente. <br> A: 123456   ,        12345, 123456. <br> Q: .    Pythia  ,  PHE   . <br> A:    ,           . <br> Q: .   .         ?  production   ? <br> A:  .  Ah!   Pythia. <br> Q:   Pythia,    , ? <br> A:  . <br> Q:   ,  ? <br> A:   . <br> Q: , , ! <br> A:     SDK,     . </p><br><p> Q: ,  ,  ,     , ..   -  ,     ?    ?    ? <br> A: ,    ,    , ..       PHE,    ,    5   2 ,   2   5  .    ,     .    PHE ( ,    ),    ,     10 ,    . <br> Q: ..      - ,      -  ?   ? <br> A:   .     rate limiting,   ,                . <br> Q: ..             , ? <br> A: . </p><br><p> Q: . , ..       Pythia      (),          , ? ? <br> A: ,    ,     . <br> Q:  ,   update   ? <br> A: ,    Pythia  ,         ,  -     -  ,   ,        ,     ) </p><br><p> A: ?   !   .     , ,   PHE,   , . </p><br><h2 id="vyvody">  Conclus√µes </h2><br><p>      PHE (    )          + ‚Äî    (  ,   ,  )      (     ).   PHE      ,                   . </p><br><p>         : </p><br><ul><li>       ( <strong></strong> )   ; </li><li>              (      ). </li></ul><br><p>  ,         . </p><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Scratch</a>   Virgil Security  ,    ,      ! </p><br><p>      (  )? </p><br><p> <strong>UPD</strong> :   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Scratch</a> .          .     ,     .    . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt434708/">https://habr.com/ru/post/pt434708/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt434698/index.html">Pessimismo sobre multithreading</a></li>
<li><a href="../pt434700/index.html">Vantagens de seguir as guias de estilo ao desenvolver aplicativos Angular</a></li>
<li><a href="../pt434702/index.html">Por que o SSD moderno me trava</a></li>
<li><a href="../pt434704/index.html">Raz√µes para o decl√≠nio no custo do tr√°fego m√≥vel na R√∫ssia e a previs√£o para 2019</a></li>
<li><a href="../pt434706/index.html">UDB. O que √© isso? Parte 3. Datapath FIFO</a></li>
<li><a href="../pt434710/index.html">Blog RUVDS sobre Habr: ano em tr√™s</a></li>
<li><a href="../pt434712/index.html">Terceiro teste de Turing em russo</a></li>
<li><a href="../pt434714/index.html">Sincroniza√ß√£o de solicita√ß√£o de cliente no Spring</a></li>
<li><a href="../pt434716/index.html">Movendo-se para o data center: Prepara√ß√£o</a></li>
<li><a href="../pt434718/index.html">Dois anos depois, ainda sinto falta do fone de ouvido</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>