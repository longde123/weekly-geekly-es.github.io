<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòù üóùÔ∏è ‚úåüèª A combina√ß√£o de plataforma cruzada e abordagem nativa no desenvolvimento de aplicativos m√≥veis ü•Ñ ‚ùóÔ∏è üëÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O lan√ßamento de aplicativos para apenas uma plataforma m√≥vel n√£o √© relevante e voc√™ precisa cuidar de desenvolver duas vers√µes ao mesmo tempo, para iO...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A combina√ß√£o de plataforma cruzada e abordagem nativa no desenvolvimento de aplicativos m√≥veis</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430892/">  O lan√ßamento de aplicativos para apenas uma plataforma m√≥vel n√£o √© relevante e voc√™ precisa cuidar de desenvolver duas vers√µes ao mesmo tempo, para iOS e Android.  E aqui voc√™ pode escolher duas maneiras: trabalhar nas linguagens de programa√ß√£o "nativas" para cada sistema operacional ou usar estruturas de plataforma cruzada. <br><br>  Ao desenvolver um dos projetos da DD Planet, contei com a √∫ltima op√ß√£o.  E neste artigo, falarei sobre a experi√™ncia de desenvolver um aplicativo de plataforma cruzada, os problemas que encontramos e as solu√ß√µes encontradas. <br><a name="habracut"></a><br><h2>  Tr√™s abordagens para o desenvolvimento de aplicativos m√≥veis de plataforma cruzada </h2><br>  Para come√ßar, considere as abordagens usadas quando voc√™ precisar obter dois aplicativos ao mesmo tempo: para iOS e Android. <br><br>  O primeiro √© o mais caro, em tempo e em recursos: desenvolver um aplicativo separado para cada plataforma.  A complexidade dessa abordagem est√° no fato de que cada um dos sistemas operacionais exige uma abordagem pr√≥pria: isso √© expresso tanto na linguagem em que o desenvolvimento est√° em andamento (para Android - Java ou Kotlin, para iOS - Objective-C ou Swift) e nos m√©todos para descrever a parte da interface do usu√°rio aplicativos (arquivos axml e xib ou storyboard, respectivamente). <br><br>  Somente esse fato nos leva ao fato de que, para essa abordagem, √© necess√°rio formar duas equipes de desenvolvimento.  Al√©m disso, voc√™ precisar√° duplicar a l√≥gica de cada uma das plataformas: intera√ß√£o com API e l√≥gica de neg√≥cios. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-j/pl/52/-jpl52-jwex193hykedjtv569to.png" alt="imagem"></div><br>  Mas e se o n√∫mero de APIs usadas aumentar? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pt/kl/zc/ptklzcfkjzn5zxmgqjuyxkhvtyq.png" alt="imagem"></div><br>  Isso levanta a quest√£o: como reduzir a quantidade necess√°ria de recursos humanos?  Livre-se da necessidade de duplicar o c√≥digo para cada plataforma.  H√° um n√∫mero suficiente de estruturas e tecnologias que resolvem esse problema. <br><br>  O uso de uma estrutura de plataforma cruzada (Xamarin.Forms, por exemplo) torna poss√≠vel escrever c√≥digo em uma linguagem de programa√ß√£o e descrever a l√≥gica de dados e a l√≥gica da interface do usu√°rio uma vez, em um s√≥ lugar.  Portanto, a necessidade de usar duas equipes de desenvolvimento desaparece.  E, como resultado da compila√ß√£o do projeto, obtemos dois aplicativos nativos na sa√≠da.  E esta √© a segunda abordagem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sc/si/v4/scsiv4dfupwnvimrp1507onobfa.png" alt="imagem"></div><br>  Acho que muitos sabem o que √© Xamarin, ou pelo menos ouviram falar dele, mas como funciona?  O Xamarin √© baseado na implementa√ß√£o de c√≥digo aberto da plataforma .NET - Mono.  O Mono inclui seu pr√≥prio compilador C #, tempo de execu√ß√£o e v√°rias bibliotecas, incluindo a implementa√ß√£o do WinForms e ASP.Net. <br><br>  O objetivo do projeto √© permitir que programas escritos em C # sejam executados em sistemas operacionais diferentes dos sistemas Windows - Unix, Mac OS e outros.  A estrutura do Xamarin, em ess√™ncia, √© uma biblioteca de classes que fornece aos desenvolvedores acesso ao SDK da plataforma e aos compiladores para eles.  O Xamarin.Forms, por sua vez, permite que voc√™ n√£o apenas escreva para as duas plataformas no mesmo idioma, mas tamb√©m projete telas usando a marca√ß√£o XAML, familiar para aqueles que j√° tinham experi√™ncia com aplicativos WPF.  Como resultado da montagem do projeto, temos uma apar√™ncia quase id√™ntica em todas as plataformas, pois no est√°gio de compila√ß√£o todos os controles XF s√£o convertidos em nativos para cada plataforma. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w4/ft/fs/w4ftfsahuvg63dn2ugjfugnp6_8.png" alt="imagem"></div><br>  O desenvolvedor √© for√ßado a escrever c√≥digo para cada plataforma apenas se for necess√°rio acessar qualquer recurso da plataforma (por exemplo, um scanner de impress√£o digital ou o n√≠vel da bateria) ou se for necess√°rio ajustar o comportamento do controle.  Em alguns casos, ao desenvolver um aplicativo, pode ser necess√°rio escrever c√≥digo dependente da plataforma, mas mesmo nesse caso, ningu√©m pro√≠be levar fun√ß√µes da plataforma para a interface e interagir com ela a partir de um projeto comum no futuro. <br><br>  Uma linguagem de programa√ß√£o, pouco c√≥digo e assim por diante.  Tudo parece bonito, mas Xamarin.Forms n√£o √© uma bala de prata e toda a sua beleza se transforma em realidade.  Assim que surge uma situa√ß√£o em que os controles XF internos n√£o atendem mais aos requisitos para eles, a estrutura de telas e controles se torna cada vez mais complicada.  Para garantir um trabalho confort√°vel com telas de um projeto comum, √© necess√°rio escrever cada vez mais renderiza√ß√µes personalizadas. <br><br>  Isso passar√° para a terceira abordagem, que usamos no desenvolvimento de aplicativos. <br><br>  J√° descobrimos que o uso do Xamarin Forms pode complicar o trabalho, em vez de simplific√°-lo.  Portanto, para implementar telas arquiteturalmente complexas, elementos de design e controles fundamentalmente diferentes dos nativos, foi encontrado um compromisso e a possibilidade de combinar a primeira e a segunda abordagens. <br><br>  Temos os mesmos tr√™s projetos: um projeto PCL comum, mas sem o Xamarin Forms, e dois projetos Xamarin Android e Xamarin iOS.  Ainda h√° a oportunidade de escrever tudo em um idioma, l√≥gica comum entre dois projetos, mas n√£o h√° limita√ß√µes de uma √∫nica marca√ß√£o XAML.  O componente da interface do usu√°rio √© controlado por cada plataforma e usa ferramentas nativas, no Android - AXML nativo, em arquivos iOS - XIB.  Cada plataforma tem a capacidade de cumprir suas diretrizes, uma vez que a conex√£o entre os projetos Core e a plataforma √© organizada apenas no n√≠vel de dados. <br><br>  Para organizar esse relacionamento, voc√™ pode usar o padr√£o de design do MVVM e sua implementa√ß√£o bastante popular para o Xamarin - MVVMCross.  Seu uso permite manter um ViewModel comum para cada tela, que descreve toda a "l√≥gica de neg√≥cios" da obra, e confiar sua renderiza√ß√£o √† plataforma.  Ele tamb√©m permite que dois desenvolvedores trabalhem com a mesma tela (uma com l√≥gica - a outra com interface do usu√°rio) e n√£o interfiram entre si.  Al√©m da implementa√ß√£o do padr√£o, obtemos um n√∫mero suficiente de ferramentas para o trabalho: a implementa√ß√£o de DI e IoC.  Para elevar a intera√ß√£o com a plataforma ao n√≠vel do c√≥digo comum, um desenvolvedor precisa apenas declarar uma interface e implement√°-la na plataforma.  Para coisas t√≠picas, o MvvmCross j√° fornece um conjunto de seus pr√≥prios plugins.  Na equipe, usamos o plug-in messenger para trocar mensagens entre a plataforma e o c√≥digo comum e o plug-in para trabalhar com arquivos (selecionar imagens da galeria etc.). <br><br><h2>  Resolvemos os problemas de design complexo e navega√ß√£o em v√°rios n√≠veis </h2><br>  Como mencionado anteriormente, ao usar representa√ß√µes complexas na tela, a estrutura pode complicar a vida mais do que facilitar.  Mas o que √© chamado de elemento complexo?  Como eu estou envolvido principalmente no desenvolvimento do iOS, um exemplo dessa plataforma ser√° considerado.  Por exemplo, algo trivial como um campo de entrada pode ter v√°rios estados e l√≥gica suficiente para alternar e visualizar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/fw/vf/anfwvfodqmfoui_0u2i6k52g_s4.png" alt="imagem"></div><br>  No decorrer do trabalho com a entrada do usu√°rio, esse controle de entrada foi desenvolvido aqui.  Ele pode elevar seu nome acima do campo de entrada, trabalhar com m√°scaras, definir prefixos, p√≥s-corre√ß√µes, notificar quando o CapsLock √© pressionado, validar informa√ß√µes de dois modos: proibi√ß√£o de entrada e sa√≠da de informa√ß√µes de erro.  A l√≥gica dentro do controle leva aproximadamente ~ 1000 linhas.  E, parece: o que pode ser complicado no design do campo de entrada? <br><br>  Um exemplo simples de um controle complexo que vimos.  E as telas? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cz/dq/ul/czdqulhcq0x1trskfg4j9szemd0.png" alt="imagem"></div><br>  Para come√ßar, vou esclarecer que, na maioria dos casos, uma tela de aplicativo √© uma classe - UIViewController, descrevendo seu comportamento.  Durante o desenvolvimento, foi necess√°ria a cria√ß√£o de navega√ß√£o em v√°rios n√≠veis.  O conceito do aplicativo desenvolvido se resume ao gerenciamento do seu im√≥vel e √† intera√ß√£o com vizinhos e organiza√ß√µes municipais.  Portanto, foram constru√≠dos tr√™s n√≠veis de navega√ß√£o: propriedade, n√≠vel de apresenta√ß√£o (casa, cidade, regi√£o) e tipo de conte√∫do.  Toda troca √© realizada em uma tela. <br><br>  Isso foi feito para que o usu√°rio, onde quer que esteja, entenda que tipo de conte√∫do ele v√™.  Para organizar essa navega√ß√£o, a tela principal do aplicativo n√£o consiste em apenas um controlador.  Visualmente, ele pode ser dividido em 3 partes, mas algu√©m pode tentar adivinhar quantos controladores s√£o usados ‚Äã‚Äãaqui? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tz/od/9h/tzod9hfhgm2r4fcebdz0pbhg06y.png" alt="imagem"></div><br>  Quinze controladores principais.  E isso √© apenas para conte√∫do. <br><br>  Aqui, esse monstro vive na tela principal e se sente muito bem.  Quinze controladores para uma tela s√£o, √© claro, muito.  Isso afeta a velocidade de todo o aplicativo e voc√™ precisa otimiz√°-lo de alguma forma. <br><br>  Recusamos a inicializa√ß√£o s√≠ncrona: todos os modelos de visualiza√ß√£o s√£o inicializados em segundo plano e somente quando necess√°rio.  Para reduzir o tempo de renderiza√ß√£o, tamb√©m abandonamos os arquivos xib para essas telas: posicionamento absoluto e matem√°tica s√£o sempre mais r√°pidos que calcular as depend√™ncias entre os elementos. <br><br>  Para acompanhar tantos controladores, voc√™ precisa entender: <br><br><ul><li>  Em que condi√ß√£o est√° cada um deles; </li><li>  Onde est√° o usu√°rio? </li><li>  O que ele espera ver ao mudar para outro controlador. </li></ul><br>  Para fazer isso, escrevi um processador de navega√ß√£o separado que armazena informa√ß√µes sobre a localiza√ß√£o do usu√°rio, o tipo de conte√∫do que ele est√° visualizando, hist√≥rico de navega√ß√£o etc.  Ele controla a ordem e a necessidade de inicializa√ß√£o. <br><br>  Como cada guia √© um controle deslizante do controlador (para criar uma transi√ß√£o de furto nelas), √© necess√°rio entender: cada uma delas pode estar em seu pr√≥prio estado (por exemplo, ‚ÄúNot√≠cias‚Äù est√° aberta em uma e ‚ÄúVota√ß√£o‚Äù na outra).  Isto √© seguido pelo mesmo processador de navega√ß√£o.  Mesmo alterando o n√≠vel de apresenta√ß√£o de casa para a regi√£o, permaneceremos no mesmo tipo de conte√∫do. <br><br><h2>  Controlamos o fluxo de dados em tempo real </h2><br>  Trabalhando com tantos dados no aplicativo, voc√™ precisa organizar a entrega de informa√ß√µes relevantes em todas as se√ß√µes em tempo real.  Para resolver esse problema, tr√™s m√©todos podem ser distinguidos: <br><br><ol><li>  Acesse a API por temporizadores ou gatilhos e solicite novamente o conte√∫do relevante nas telas; </li><li>  Ter uma conex√£o permanente com o servidor e receber altera√ß√µes em tempo real; </li><li>  Receba push com altera√ß√µes de conte√∫do. </li></ol><br>  Cada abordagem tem seus pr√≥s e contras, portanto, √© melhor usar os tr√™s, escolhendo apenas os pontos fortes de cada um.  Dividimos condicionalmente o conte√∫do dentro do aplicativo em v√°rios tipos: quente, regular e servi√ßo.  Isso √© feito para determinar o tempo aceit√°vel entre o evento e a notifica√ß√£o do usu√°rio.  Por exemplo, queremos ver uma mensagem de bate-papo imediatamente depois que eles nos enviaram - este √© um conte√∫do quente.  Outra op√ß√£o: pesquisa com vizinhos.  N√£o faz diferen√ßa quando o vemos, agora ou em um minuto, porque esse √© um conte√∫do comum.  Pequenas notifica√ß√µes dentro do aplicativo (mensagens n√£o lidas, comandos etc.) s√£o conte√∫do de servi√ßo que precisa de entrega urgente, mas n√£o consome muitos dados. <br><br>  Acontece: <br><br><ul><li>  Conte√∫do quente - conex√£o permanente com a API; </li><li>  Conte√∫do normal - solicita√ß√µes de http para a API; </li><li>  Conte√∫do do sistema - notifica√ß√µes push. </li></ul><br>  O mais interessante √© manter uma conex√£o constante.  Escrever o seu pr√≥prio cliente para trabalhar com soquetes da Web √© um passo na toca do coelho, ent√£o voc√™ precisa procurar outras solu√ß√µes.  Como resultado, paramos na biblioteca SignalR.  Vamos ver o que √©. <br><br>  O ASP.Net SignalR √© uma biblioteca da Microsoft que simplifica a intera√ß√£o cliente-servidor em tempo real, fornecendo comunica√ß√£o bidirecional entre o cliente e o servidor.  O servidor inclui uma API completa para gerenciar a conex√£o, eventos de desconex√£o de conex√£o, um mecanismo para combinar clientes conectados em grupos e autoriza√ß√£o. <br><br>  O SignalR pode usar solicita√ß√µes de websockets, LongPolling e http como transporte.  √â poss√≠vel especificar o tipo de transporte √† for√ßa ou confiar na biblioteca: se o websocket puder ser usado, ele funcionar√° no websocket; se isso n√£o for poss√≠vel, ser√° desativado at√© encontrar um transporte aceit√°vel.  Esse fato acabou sendo muito pr√°tico, pois est√° planejado us√°-lo em dispositivos m√≥veis. <br><br>  Total, que benef√≠cio obtemos: <br><br><ul><li>  Capacidade de trocar mensagens de qualquer tipo entre o cliente e o servidor; </li><li>  O mecanismo para alternar automaticamente entre soquetes da web, solicita√ß√µes de pool longo e HTTP; </li><li>  Informa√ß√µes sobre o status atual da conex√£o; </li><li>  Uma oportunidade para unir clientes em grupos; </li><li>  M√©todos pr√°ticos para manipular a l√≥gica do envio de mensagens em um grupo; </li><li>  A capacidade de dimensionar o servidor. </li></ul><br>  Obviamente, isso n√£o satisfaz todas as necessidades, mas notavelmente facilita a vida. <br><br>  Dentro do projeto, um wrapper √© usado na biblioteca SignalR, o que simplifica ainda mais o trabalho com ele, a saber: <br><br><ul><li>  Monitora o status da conex√£o, reconecta de acordo com as condi√ß√µes especificadas e em caso de interrup√ß√£o; </li><li>  Capaz de substituir ou reabrir rapidamente a conex√£o, matando de forma ass√≠ncrona a antiga e dando-a ao coletor de lixo para rasgar - como se viu, o m√©todo de conex√£o funciona dez vezes mais r√°pido que o m√©todo de fechamento (Dispose ou Stop), e esta √© a √∫nica maneira de fech√°-la; </li><li>  Organiza uma fila para enviar mensagens para que a reconex√£o ou reabertura da conex√£o n√£o interrompa o envio; </li><li>  Transfere o controle para os delegados apropriados em caso de erros imprevistos. </li></ul><br>  Cada um desses inv√≥lucros (os chamamos de clientes) trabalha em conjunto com o sistema de armazenamento em cache e, no caso de uma desconex√£o, pode solicitar apenas os dados que podem ter sido perdidos durante esse per√≠odo.  "Cada" porque v√°rios compostos ativos s√£o mantidos simultaneamente.  Dentro do aplicativo, existe um messenger completo e um cliente separado √© usado para atend√™-lo. <br><br>  O segundo cliente √© respons√°vel por receber notifica√ß√µes.  Como eu j√° disse, o tipo usual de conte√∫do √© obtido por meio de solicita√ß√µes http, no futuro a atualiza√ß√£o recai sobre esse cliente, que relata todas as mudan√ßas importantes nele (por exemplo, a vota√ß√£o passou de um status para outro, publica√ß√£o de novas not√≠cias). <br><br><h2>  Visualize os dados no aplicativo </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/01/ne/xn/01nexnxh3zdp2j3cizlcx2lxuhc.png" alt="imagem"></div><br>  Obter dados √© uma coisa, mostrar √© outra.  A atualiza√ß√£o de dados em tempo real tem suas pr√≥prias dificuldades.  No m√≠nimo, voc√™ precisa decidir como apresentar essas atualiza√ß√µes ao usu√°rio.  No aplicativo, usamos tr√™s tipos de notifica√ß√µes: <br><br><ol><li>  Notifica√ß√£o de conte√∫do n√£o lido; </li><li>  Atualiza√ß√£o autom√°tica de dados na tela; </li><li>  Oferta de conte√∫do. </li></ol><br>  A maneira mais familiar e comum de mostrar que em algum lugar existe um novo conte√∫do √© destacar o √≠cone da se√ß√£o.  Assim, quase todos os √≠cones t√™m a capacidade de mostrar o notificador de conte√∫do n√£o lido como um ponto vermelho.  Coisas mais interessantes s√£o as atualiza√ß√µes autom√°ticas. <br><br>  A atualiza√ß√£o autom√°tica de dados √© poss√≠vel somente quando o novo conte√∫do n√£o reorganiza a tela e n√£o altera o tamanho dos controles.  Por exemplo, na tela da pesquisa: as informa√ß√µes sobre os votos mudar√£o apenas o valor da barra de progresso e as porcentagens.  Tais altera√ß√µes n√£o implicam nenhum redimensionamento; podem ser aplicadas instantaneamente sem problemas. <br><br>  As dificuldades surgem quando voc√™ precisa adicionar novo conte√∫do √†s listas.  Todas as listas no aplicativo s√£o de fato ScrollView e possuem v√°rias caracter√≠sticas: tamanho da janela, tamanho do conte√∫do e posi√ß√£o da rolagem.  Todos eles t√™m um come√ßo est√°tico (parte superior da tela com coordenadas 0; 0) e podem se expandir para baixo.  Adicione novo conte√∫do na lista, no final, n√£o apresenta nenhum problema, a lista vai durar.  Mas o novo conte√∫do deve aparecer na parte superior, e esta √© a imagem: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rh/ve/am/rhveamjeqsuityqnk3_io3njrxy.png" alt="imagem"></div><br>  Sendo em 3 elementos, estaremos em 2 - o pergaminho saltar√° para cima.  E como o novo conte√∫do pode chegar constantemente, o usu√°rio n√£o poder√° rolar normalmente.  Voc√™ pode dizer: por que n√£o calcular o tamanho do novo conte√∫do e mudar a rolagem para baixo para esse valor?  Sim, isso pode ser feito.  Mas voc√™ precisa controlar manualmente a posi√ß√£o de rolagem e, nesse momento, o usu√°rio rola em qualquer dire√ß√£o, sua a√ß√£o ser√° interrompida.  √â por isso que essas telas n√£o podem ser atualizadas em tempo real sem o consentimento do usu√°rio. <br><br>  A melhor solu√ß√£o nessa situa√ß√£o seria informar o usu√°rio que, enquanto ele rolava o feed, algu√©m postou novo conte√∫do.  Em nosso design, parece um c√≠rculo vermelho no canto da tela.  Ao clicar nele, o usu√°rio concede seu consentimento condicional para devolv√™-lo √† parte superior da tela e exibir novos conte√∫dos. <br><br>  Com essa abordagem, √© claro que evitamos os problemas de "manipular" o conte√∫do, mas eles ainda precisavam ser resolvidos.  Ou seja, na tela de bate-papo, pois durante a comunica√ß√£o e intera√ß√£o com a tela, novos conte√∫dos devem ser exibidos em locais diferentes. <br><br>  A diferen√ßa entre o bate-papo e as listas regulares √© que o conte√∫do novo est√° na parte inferior da tela.  Como essa √© uma "cauda", voc√™ pode adicionar conte√∫do sem muita dificuldade.  O usu√°rio passa 90% do tempo aqui, o que significa que voc√™ precisa manter constantemente a posi√ß√£o de rolagem e reduzi-la ao receber e enviar mensagens.  Em uma conversa ao vivo, essas a√ß√µes devem ser realizadas com bastante frequ√™ncia. <br><br>  O segundo ponto: carregando o hist√≥rico enquanto rola para cima.  Apenas ao carregar a hist√≥ria, nos encontramos em uma situa√ß√£o em que √© necess√°rio colocar as mensagens acima do n√≠vel da revis√£o (o que implica vi√©s), para que a rolagem seja suave e cont√≠nua.  E como j√° sabemos, para n√£o incomodar o usu√°rio, √© imposs√≠vel controlar manualmente a posi√ß√£o de rolagem. <br><br>  E n√≥s encontramos uma solu√ß√£o: n√≥s a entregamos.  O flip da tela resolveu dois problemas ao mesmo tempo: <br><br><ol><li>  O final da lista est√° no topo, para que possamos adicionar uma hist√≥ria sem problemas, sem interferir na rolagem do usu√°rio; </li><li>  A √∫ltima mensagem est√° sempre no topo da lista e n√£o precisamos rolar a tela antes dela. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0n/hx/zf/0nhxzfnj9mhuofyu4bkr1epdtlw.png" alt="imagem"></div><br>  Essa solu√ß√£o tamb√©m ajudou a acelerar a renderiza√ß√£o, eliminando opera√ß√µes desnecess√°rias com o controle de rolagem. <br><br>  Falando em desempenho.  Nas primeiras vers√µes da tela, foram detectados rebaixamentos vis√≠veis ao rolar as mensagens.     ¬´¬ª  ‚Äì , , , ‚Äî     ,      .    .    ,     ,     . <br><br>      iOS       . ,       ,          ,   ,    ,   ,        ,    . <br><br>          UI . <br><br><h2>  : </h2><br><ul><li>       ; </li><li>      ,    ,     ; </li><li>           ,      ; </li><li>           ; </li><li> SignalR ‚Äì     -    ; </li><li>            ; </li><li>         ,    , ; </li><li>      ,   SignalR-,  ,  , , . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt430892/">https://habr.com/ru/post/pt430892/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt430882/index.html">Xiaomi Aqara Switch refaz de ZigBee para Z-Wave</a></li>
<li><a href="../pt430884/index.html">F√°brica de impress√£o: por que a "LANIT-Integration" abriu sua pr√≥pria "gr√°fica"</a></li>
<li><a href="../pt430886/index.html">Atualizar biblioteca SPPermission e hater</a></li>
<li><a href="../pt430888/index.html">Qu√£o seguro √© usar pacotes R para trabalhar com a API de sistemas de publicidade</a></li>
<li><a href="../pt430890/index.html">Onde o √°gil √© terr√≠vel, especialmente o scrum</a></li>
<li><a href="../pt430894/index.html">Situa√ß√£o: as marcas est√£o gastando cada vez mais dinheiro em publicidade em podcasts - entendemos por que</a></li>
<li><a href="../pt430896/index.html">A Linux Foundation estabeleceu fundos para GraphQL e Ceph - por que eles s√£o necess√°rios e o que esperar deles</a></li>
<li><a href="../pt430900/index.html">O primeiro laser na hist√≥ria: o que era</a></li>
<li><a href="../pt430902/index.html">Elfos na mem√≥ria. Executando o ELF na RAM do Linux</a></li>
<li><a href="../pt430906/index.html">M√£e dorme calmamente √† noite - coletamos o OpenCV para Raspbian'a</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>