<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸ“ ğŸ‘©ğŸ»â€ğŸ¤â€ğŸ‘¨ğŸ¿ ğŸ‘¨ğŸ¼â€âš–ï¸ äºŒåä¸€ç‚¹å’ŒæŸœå°æ¼ç”µä¿æŠ¤ ğŸ˜• ğŸ‘¨ğŸ¼â€ğŸš€ âœ¡ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="é—®å€™ã€‚æœ‰è¿™æ ·çš„äº‹æƒ…-Hydrolock \ neptune \ avkvastorozh-å¦‚æœå‘ç”Ÿä¸å¯æ§åˆ¶çš„æ³„æ¼ï¼Œåˆ™å°†æ°´åˆ‡æ–­ç³»ç»Ÿã€‚åŸç†å¾ˆç®€å•-æ°´ä¼ æ„Ÿå™¨+è‡ªåŠ¨åŒ–+ä¸€å¯¹ç”µåŠ¨é¾™å¤´ã€‚ä½†æ˜¯é­”é¬¼ä»ç„¶åƒå¾€å¸¸ä¸€æ ·åœ¨ç»†èŠ‚ä¸Šï¼šæ°´é¾™å¤´å¦‚ä½•å¸ƒç½®ï¼Œæ³„æ¼ä¼ æ„Ÿå™¨å¦‚ä½•å¸ƒç½®ä»¥åŠä¸ºä»€ä¹ˆä¸€ä¸ªèŠ±è´¹50å¢å¸ƒè€Œå¦ä¸€ä¸ªèŠ±è´¹500å¢å¸ƒã€‚ä¸€å…¬æ–¤çš„å¸ƒ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>äºŒåä¸€ç‚¹å’ŒæŸœå°æ¼ç”µä¿æŠ¤</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/399459/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é—®å€™ã€‚æœ‰è¿™æ ·çš„äº‹æƒ…-Hydrolock \ neptune \ avkvastorozh-å¦‚æœå‘ç”Ÿä¸å¯æ§åˆ¶çš„æ³„æ¼ï¼Œåˆ™å°†æ°´åˆ‡æ–­ç³»ç»Ÿã€‚åŸç†å¾ˆç®€å•-æ°´ä¼ æ„Ÿå™¨+è‡ªåŠ¨åŒ–+ä¸€å¯¹ç”µåŠ¨é¾™å¤´ã€‚ä½†æ˜¯é­”é¬¼ä»ç„¶åƒå¾€å¸¸ä¸€æ ·åœ¨ç»†èŠ‚ä¸Šï¼šæ°´é¾™å¤´å¦‚ä½•å¸ƒç½®ï¼Œæ³„æ¼ä¼ æ„Ÿå™¨å¦‚ä½•å¸ƒç½®ä»¥åŠä¸ºä»€ä¹ˆä¸€ä¸ªèŠ±è´¹50å¢å¸ƒè€Œå¦ä¸€ä¸ªèŠ±è´¹500å¢å¸ƒã€‚ä¸€å…¬æ–¤çš„å¸ƒå±€å…¬å‘Šå°†è¢«åŒ…è£¹åœ¨æ•´ä»¶äº‹ä¸Šï¼ŒåŒ…è£…å°†ä½¿æ‚¨çš„è§†çº¿ç§»å¼€ï¼Œç­‰ç­‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ•…äº‹ä¸­ï¼Œæˆ‘å°†é€æ­¥ä»‹ç»ç³»ç»Ÿçš„å„ä¸ªæ–¹é¢ï¼Œè¿™äº›å†…å®¹å¼•å¯¼äº†æˆ‘çš„é€‰æ‹©ã€‚æ•´ä¸ªç³»ç»ŸåŸºäºå·¥å‚ä¼ æ„Ÿå™¨å’ŒåŸºäºç²’å­ï¼ˆä¾‹å¦‚ç«èŠ±ï¼‰å…‰å­çš„è‡ªåˆ¶æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚esp8266ï¼Œå…·æœ‰å¼€ç®±å³ç”¨çš„åŸºäºäº‘çš„IDEï¼‰ï¼Œè®¾å¤‡åŸºç¡€æ˜¯Broadcomçš„stmæ§åˆ¶å™¨+ wifiæ¨¡å—ã€‚æ‰€æœ‰è¿™äº›éƒ½ä¸Orange Pi Oneä¸Šçš„openhabæœåŠ¡å™¨ç»‘å®šåœ¨ä¸€èµ·ã€‚</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/715/6ee/aa2/7156eeaa28b44479a5d5aff2e63ff89c.png" width="600"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºä»€ä¹ˆä¸å®Œæˆç³»ç»Ÿï¼Ÿ</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -å› ä¸ºæˆ‘è‡ªå·±å°±èƒ½åšåˆ°ï¼Œè€Œä¸”</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 éå¸¸å‡ºè‰²-åœ¨ç°æˆçš„ç³»ç»Ÿä¸­ï¼Œä¸å¤–éƒ¨ç³»ç»Ÿçš„é›†æˆæ¯”è¾ƒæ»åã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 -ç°æˆçš„ç³»ç»Ÿä¸å…·æœ‰è¾…åŠ©åŠŸèƒ½-è€ƒè™‘ä»ªè¡¨è¯»æ•°ï¼Œæ°´æ¸©ä¼ æ„Ÿå™¨ï¼Œåœæ°´é€šçŸ¥å’Œå…¶ä»–æ­¥è¡Œè‰²æƒ…å¹»æƒ³ã€‚</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä»èµ·é‡æœºå¼€å§‹</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°±æ‰­çŸ©è€Œè¨€ï¼Œç¬¨æ‹™åœ°é€‰æ‹©é¢å¤´ã€‚æœ‰ä¸€æ®µæ—¶é—´ï¼Œä»–ä½åœ¨éƒŠåŒºï¼Œé‚£é‡Œçš„æ°´è´¨ï¼ˆå¾ˆå¯èƒ½æ˜¯æ‰å§†å¡è¿ªï¼ˆZamkadyeï¼‰çš„æ¯ä¸ªåœ°æ–¹ï¼‰éƒ½ä»¤äººæœ›è€Œå´æ­¥ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ä¸æ¥è§¦å¹´ä»½ï¼Œåˆ™çƒé˜€ä¸º1/2è‹±å¯¸-å¾ˆéš¾è½¬åŠ¨ã€‚è€Œä¸”åœ¨1è‹±å¯¸åŠ çƒ­æ¯›å·¾æ¶ä¸Šï¼Œæˆ‘ä»€è‡³ä¸å°è¯•ç§»åŠ¨å®ƒ-ä»…å½“æˆ‘ç”¨æ‰³æ‰‹åŠ å›ºè‚©è†€æ—¶æ‰å¯ä»¥ï¼Œä½†åœ¨è¿™é‡Œæ‚¨å¯ä»¥å°†ä¸œè¥¿æ’•æ‰ã€‚é—®é¢˜åœ¨äºé’™ç¡¬æœ¨çš„æ²‰ç§¯ç‰©ï¼Œä¸€ä¸ªè¯â€œé•¿æ»¡äº†â€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œä»æ¶²å‹é”çš„ä¸“ä¸šç³»åˆ—ä¸­é€‰æ‹©-21N * mçš„æ‰­çŸ©æ„Ÿè§‰å¹¶ä¸åƒå¹¿å‘Šä¸­æ‰€è¯´çš„é‚£æ ·ï¼Œèµ·é‡æœºåªæ˜¯å·¨å¤§çš„-åœ¨è´­ä¹°å‰è¯„ä¼°å…¶å®‰è£…ä½ç½®ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/758/e07/18c/758e0718cc9a46e09306bac214db8cf1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ°´é¾™å¤´æ˜¯å¯†å°çš„ï¼Œå‘¨å›´æ˜¯æ©¡èƒ¶å¯†å°åœˆï¼Œèºçº¹å¯†å°å¥—ä¸‹æ–¹çš„å…¥å£ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å–ä¸‹ç›–å­ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/f9d/aa4/a25/f9daa4a251e140c3bbe4b049a5af7f46.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æˆ‘ä»¬é¢å‰çš„æ˜¯ç”µè·¯æ¿å’Œæ­¥è¿›ç”µæœºçš„é¡¶éƒ¨ã€‚æ‰€æœ‰è¿™äº›éƒ½ç”±12ä¼ç‰¹ä¾›ç”µã€‚å°†æ§åˆ¶ç”µç¼†æ¥åœ°ä¼šå¯¼è‡´é˜€é—¨å¤„äºå…³é—­ä½ç½®ã€‚åœ¨æ¿ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç®€å•çš„PIC 12f629æ§åˆ¶å™¨ã€‚ä½äº†ï¼Œæ§åˆ¶å™¨åœ¨åŠè½¦ä¸Šé©±åŠ¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¿çš„èƒŒé¢æ˜¯æœ€æœ‰è¶£çš„ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/c14/e08/f2e/c14e08f2e4224088a534e1811fa3729a.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L293 Shagoviké©±åŠ¨å™¨å’Œå…‰ç”µè€¦åˆå™¨ï¼ˆå‘å°„å™¨+å…‰ç”µæ¢æµ‹å™¨ï¼‰ã€‚å¥¹çœ‹ç€é©±åŠ¨å™¨çš„ä¸»é½¿è½®ï¼Œè¯¥é½¿è½®æ¶‚äº†ç™½è‰²å’Œé»‘è‰²çš„éƒ¨åˆ†ï¼Œå·²é—­åˆ/æ‰“å¼€ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/a14/cec/177/a14cec1771ef4d52bc15c83e9183124e.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
èµ·é‡æœºä¸€ç›´æ²¿ä¸€ä¸ªæ–¹å‘æ—‹è½¬ï¼Œæ§åˆ¶å™¨çš„é€»è¾‘å¾ˆç®€å•-æˆ‘ä»¬æ‰­è½¬è½´ï¼Œç›´åˆ°åˆ‡æ¢åˆ°æ‰€éœ€çš„é¢œè‰²ã€‚èµ·é‡æœºåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šçš„æ—‹è½¬ç£¨æŸè¾ƒå°ï¼Œå¹¶ä¸”éæ¥è§¦å¼ç¡®å®šä½ç½®çš„æ–¹å¼ä¸å¤ªå¯èƒ½ä½¿å¯å˜ç”µé˜»å™¨æˆ–é™ä½å¼€å…³å˜é…¸/æ•…éšœã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®‰è£…æ—¶ï¼Œæ‚¨å¯ä»¥ä»é©±åŠ¨å™¨ä¸Šæ‹§ä¸‹èµ·é‡æœº-å®ƒå›ºå®šåœ¨2ä¸ªèºæ¯ä¸Šã€‚é©±åŠ¨å™¨å’Œèµ·é‡æœºä¹‹é—´æœ‰ä¸€ä¸ªéš”çƒ­å«ç‰‡ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/bf7/37c/1f7/bf737c1f7a144c72baba7a17fdc94615.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸€å¹´åŠå‰ï¼Œæˆ‘è¿›è¡Œäº†ç»´ä¿®ã€‚è¯¥èµ·é‡æœºæ˜¯ä¸‰å¹´å‰è´­ä¹°çš„ï¼Œç”¨äºæ‹†å¸ï¼ŒæŸ¥æ‰¾å†…éƒ¨ï¼Œè´­ä¹°æ›´å¤šå¹¶åœ¨ç»´ä¿®æœŸé—´è¿›è¡Œç¼ ç»•ã€‚æ˜¯çš„ï¼Œç°åœ¨â€¦â€¦åœ¨è¿™ç§åœ°ç‹±èˆ¬çš„é©¬æˆå›¢ä¸­ï¼Œæˆ‘æœ€å¤§çš„åŠªåŠ›å°±æ˜¯åœ¨é›†æ°´å™¨ä¸­æ”¾ç½®ä¸€ä¸ªé›†å°˜å™¨ï¼Œå¹¶æœ‰æœ›ç”¨èµ·é‡æœºä»£æ›¿å®ƒã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»…ä»…ä¸€å¹´åŠä¹‹å-æˆ‘ä¹°äº†ç¬¬äºŒå°èµ·é‡æœºå¹¶æ‹§ç´§ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»“æœï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ç§å¥‡æ€ªä¸”ç½•è§çš„ç°è±¡ï¼ˆç”¨Drozdovçš„å£°éŸ³æœ—è¯»ï¼‰-æ¥è‡ªåˆ¶é€ å•†ç½‘ç«™çš„æ‰€æœ‰ä¿¡æ¯å‡å¾—åˆ°ç¡®è®¤ã€‚è€Œä¸”ï¼Œæè¿°å¾ˆå¥‡ç‰¹ï¼Œå°±åƒæŠ€æœ¯ä¸“å®¶å†™çš„é‚£æ ·ï¼Œç„¶åå¸‚åœºè¥é”€ä¸ºäººä»¬æ‰€ç”¨ï¼Œä½†ä»ç„¶å¾ˆå°‘æœ‰äººäº†è§£æ‰€æœ‰èŠ¯ç‰‡ã€‚è¯¥ç«™ç‚¹ä¸Šæ²¡æœ‰è¶³å¤Ÿçš„éƒ¨åˆ†â€“åŒ…å«å†…éƒ¨æŠ€æœ¯ç»†èŠ‚çš„é›†æˆå•†ã€‚å³ä½¿ä»¥å¢åŠ æ‰­çŸ©ä¸ºä»£ä»·ï¼Œå®ƒä»¬ä¹Ÿä¸æ˜¯ä¸€å¼€å§‹å°±å¤„äºæ’’è°çŠ¶æ€â€“èµ·æ­¥æ—¶èµ·é‡æœºä»¥1.5Açš„å‘åŠ¨æœºæ’å‡»ï¼Œå¹¶åœ¨2-3ç§’åå¼€å§‹ä»¥æ­£å¸¸ï¼ˆå½“å‰çš„0.7 Aï¼‰æ¨¡å¼ä¸Šå‡ã€‚å…³é—­å¤§çº¦éœ€è¦25-30ç§’ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦ä¸€ä¸ªç»éªŒï¼šä»¥æ‰­çŸ©ä¸ºä»£ä»·-åœ¨è«æ–¯ç§‘æ—¶é—´è¿™æ˜¯å¤šä½™çš„ï¼Œè¿™é‡Œçš„æ°´è¿˜å¯ä»¥ï¼Œåœ¨100Î¼mè¿‡æ»¤å™¨ä¸­æ”¾ç½®ä¸€å¹´åŠï¼Œæœ‰æ¸£å¹¶ä¸”æ²¡æœ‰è¿‡åº¦ç”Ÿé•¿ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¿…é¡»ä¸ºä»·æ ¼ï¼Œå¼€å¯æ—¶é—´å’Œå£æ©±ä¸­çš„ä½ç½®ä»˜å‡ºå·¨å¤§çš„ä»£ä»·ã€‚</font><font style="vertical-align: inherit;">æˆ‘è®¤ä¸ºå°†ä¼šæœ‰æ¥è‡ªHydrolock Ultimateï¼ŒNeptuneæˆ–Aquastorozhçš„å¸¸è§„é©±åŠ¨å™¨ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä¸èƒ½ä¿è¯æœ€åä¸¤ä¸ª-æˆ‘æ²¡æœ‰å¼„æ¸…æ¥šï¼Œå¤§çº¦5å¹´å‰ä»–ä»¬æœ‰éƒ¨åˆ†å¡‘æ–™é½¿è½®ï¼Œç°åœ¨ä¼¼ä¹å·²ç»ä¿®å¤äº†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜æœ‰ä¸€ä¸ªWinner Hydrolockï¼Œå¯ä»¥å°†ä¼ æ„Ÿå™¨ç›´æ¥è¿æ¥åˆ°é©±åŠ¨å™¨ä¸Š-è¿™æ˜¯å¦‚æœæ‚¨ä¸éœ€è¦æˆ‘åšçš„æ‰€æœ‰äº‹æƒ…ã€‚</font><font style="vertical-align: inherit;">é‚£é‡Œçš„åŠ¨åŠ›æ¥è‡ª4ä¸ªç”µæ± ï¼Œå…¶åº•åº§ç±»ä¼¼äºç»ˆæé©±åŠ¨å™¨ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ï¼Œå¯¹äºè‡ªåˆ¶çš„æ§åˆ¶å™¨æ¥è¯´ï¼Œè¿™ä¹Ÿå¯èƒ½å¾ˆæœ‰è¶£-å®ƒæ˜¯5ä¼ç‰¹ï¼Œæ‚¨ä¸éœ€è¦åœ¨5ä¼ç‰¹å’Œ12ä¼ç‰¹ä¸Šæ”¾ç½®ä¸¤æ¡æ€»çº¿ï¼Œå°±å¯ä»¥ä¸¢å¼ƒå…‰éš”ç¦»ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³„æ¼ä¼ æ„Ÿå™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘è´­ä¹°äº†åŒä¸€WSUè®¡æ•°å™¨çš„ä¼ æ„Ÿå™¨-é€šç”¨ã€‚</font><font style="vertical-align: inherit;">å®ƒä»¬æœ‰ä¸¤ä¸ªâ€œé›†ç”µæå¼€è·¯â€è¾“å‡ºï¼Œä¸€ä¸ªåªæœ‰åœ¨æœ‰æ°´æ—¶æ‰æ‹‰åˆ°åœ°é¢ï¼Œç¬¬äºŒä¸ª-å¦‚æœæœ‰æ°´è¿›æ¥ï¼Œå®ƒå°±ä¸€ç›´æ‹‰åˆ°åœ°é¢ç›´åˆ°æ–­ç”µã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»…ä½¿ç”¨ç¬¬ä¸€ä¸ªè¾“å‡ºï¼Œå…¶ä½™é€»è¾‘åœ¨æ§åˆ¶å™¨ä¸­ï¼Œä½†çœ‹èµ·æ¥æ­¤è¾“å‡ºå¯¹äºæ›´å¤šçš„å…¬å¯“åˆ†å‘ç³»ç»Ÿå¾ˆæœ‰ç”¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¥—ä»¶ä¸­çš„ç”µçº¿åœ¨æŸå¤„ä¸‰ç±³è¿œã€‚</font><font style="vertical-align: inherit;">ç”µçº¿çš„é¢œè‰²æ˜¯Ad_i_Israelã€‚</font><font style="vertical-align: inherit;">æŸ¥çœ‹æŠ¥ä»·ï¼š</font></font><br>
<br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çº¢è‰²ï¼ˆæ£•è‰²ï¼‰çº¿ï¼ˆVccï¼‰ç”±+5åˆ°+30ä¼ä¾›ç”µã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é»‘è‰²ï¼ˆç™½è‰²ï¼‰çº¿ï¼ˆOUT2ï¼‰</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç»¿è‰²çº¿ï¼ˆOUT1ï¼‰</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é»„è‰²çº¿ï¼ˆGNDï¼‰</font></font></i></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é˜»æ­¢ç™½è‰²/é»‘è‰²åœ°çƒçš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</font><font style="vertical-align: inherit;">é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œåœ¨èµ·é‡æœºé©±åŠ¨å™¨ä¸Šï¼Œå¸¦æœ‰é€»è¾‘é¢œè‰²çš„ç”µçº¿ä¹Ÿä¸æ˜¯ç¨€ç–çš„ã€‚</font><font style="vertical-align: inherit;">ç¬¬ä¸€ä¸ªä¼ æ„Ÿå™¨åœ¨å¨æˆ¿é‡Œï¼Œåœ¨æ´—ç¢—æœºæ—è¾¹çš„æ°´æ§½ä¸‹é¢ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ea/407/a25/2ea407a255b8420e9b1d6c26772e2709.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬äºŒä¸ªåœ¨æµ´å®¤çš„ç‰¹æ®Šæ’æ°´æ²Ÿä¸­ã€‚</font><font style="vertical-align: inherit;">å½“ä»–åšç†¨å¹³æ¿æ—¶ï¼Œä»–æ²¡æœ‰æŠŠå®ƒæ‹–åˆ°å¢™ä¸Šã€‚</font><font style="vertical-align: inherit;">ç»“æœäº§ç”Ÿäº†ä¸€ç§ç”¨äºä»æµ´å®¤å’Œå«ç”Ÿé—´æ”¶é›†æ°´çš„é›†æ°´æ§½ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/51d/715/898/51d71589848d4a77a59f8caf0dbf2041.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ ¹æ®æ“ä½œç»éªŒ-æ´—ç¢—æœºä¸­çš„ä¼ æ„Ÿå™¨å·²ç»å‡ºç°äº†ä¸€æ¬¡è¯¯æŠ¥ã€‚</font><font style="vertical-align: inherit;">é€šè¿‡æ—¥å¿—åˆ¤æ–­ä¸€ä¸ªè½®è¯¢å‘¨æœŸï¼ˆ500æ¯«ç§’ï¼‰ï¼Œæœ‰ä¸€ä¸ªç”µè·¯ï¼Œä¿®æ”¹äº†ä»£ç -çŠ¶æ€æ›´æ”¹ç°åœ¨ä»ä¼ æ„Ÿå™¨å‘å‡ºçš„è¿ç»­10ä¸ªç›¸åŒå€¼å¤„å‘ç”Ÿã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¼ æ„Ÿå™¨è§¦ç‚¹é•€é‡‘ã€‚</font><font style="vertical-align: inherit;">ä¸€ä½æœ‹å‹ä½¿ç”¨ç±»ä¼¼çš„ä¼ æ„Ÿå™¨å·²æœ‰å‡ å¹´äº†ï¼Œæ²¡æœ‰å‘ç°æ°§åŒ–ç°è±¡ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‹åŠ›ä¼ æ„Ÿå™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Š-ç…§åº¦è®¡ã€‚</font><font style="vertical-align: inherit;">ç²¾åº¦+-0.5 atmå®Œå…¨é€‚åˆæˆ‘ã€‚</font><font style="vertical-align: inherit;">æ ¹æ®è¿™äº›ä¼ æ„Ÿå™¨ï¼Œä¼šå‡ºç°æ–­æ°´è­¦æŠ¥ã€‚</font><font style="vertical-align: inherit;">æˆ‘åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹°äº†é˜¿é‡Œ</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¸©åº¦ä¼ æ„Ÿå™¨</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºä»€ä¹ˆä¸æ·»åŠ å‘¢ï¼Ÿ</font><font style="vertical-align: inherit;">ä»å®ç”¨å¼€å§‹-å®ƒå°†èƒ½å¤Ÿæ¯å¹´ä¸€æ¬¡é€šçŸ¥æœ‰å…³çƒ­æ°´å…³é—­çš„ä¿¡æ¯ã€‚</font><font style="vertical-align: inherit;">äºŒæ‰‹çš„banal ds18b20ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸“æŸœ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¸¸è§çš„Itelmaï¼Œæ¯10å‡æ¥è§¦ä¸€æ¬¡ã€‚</font><font style="vertical-align: inherit;">åœ¨æ§åˆ¶å™¨ç«¯ï¼Œè¾“å‡ºä¸Šæ‹‰è‡³+ 3.3vï¼Œç”µè¡¨å°†å…¶æ¥åœ°ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ§åˆ¶è€…</font></font></h3><br>
<img src="https://habrastorage.org/files/318/4e6/d7a/3184e6d7ad9c4eab99d9962410c7918c.jpg"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡Œé¢</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/a83/72d/117/a8372d1170ca43f8b92925fa76a240f8.jpg"><br>
<img src="https://habrastorage.org/files/f7b/e62/ee8/f7be62ee80a54ff2a0ed60ad17467a8b.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŸºäºç²’å­å…‰å­ï¼Œæ›´å¤šç»†èŠ‚è¯·</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç‚¹å‡»è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å®ƒä»¬å…·æœ‰å¸¦2Gæˆ–3Gæ¨¡å—ï¼ˆç”µå­ï¼‰çš„ç‰ˆæœ¬ã€‚ç¬¬ä¸€ä¸ªå›ºä»¶æ˜¯å®Œæ•´çš„ç‚‰æ¸£ï¼Œå¹¶ç”¨OKäºŒæç®¡é—ªçƒï¼Œä½†æ˜¯ä¸€æ—¦æ‚¨å’€åš¼å¤æ‚çš„é¦™è‚ ï¼Œç©i2cå’Œä¸­æ–­å°±ä¼šå¤±å»wifiã€‚ç°åœ¨å¯ä»¥ä½äº†ã€‚åŸåˆ™ä¸Šï¼Œæ‚¨å¯ä»¥å°†å‹åŠ›ä¼ æ„Ÿå™¨ä»ç”µè·¯ä¸­æ‰”å‡ºï¼Œå¹¶æ…åŠ¨ESP8266ä¸Šçš„æ‰€æœ‰éƒ¨ä»¶ï¼Œç„¶åç»§ç»­è¿›è¡Œã€‚é¦–å…ˆï¼Œå…‰å­éœ€è¦é“¾æ¥åˆ°ç²’å­å¸æˆ·ï¼ˆé€šè¿‡ç§»åŠ¨è®¾å¤‡ä¸Šçš„åº”ç”¨ç¨‹åºæˆ–é€šè¿‡ç²’å­CLIæ§åˆ¶å°å®Œæˆ-æˆ‘ä»…ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼‰å¹¶æ³¨å†Œwifiç½‘ç»œã€‚ç»‘å®šåï¼Œ</font><font style="vertical-align: inherit;">è®¾å¤‡éƒ¨åˆ†å°†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¾ç¤ºæ§åˆ¶å™¨åŠå…¶è¿æ¥åˆ°äº‘çš„çŠ¶æ€ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/71d/c17/687/71dc17687ccb4a289d0a0dd2296fdfca.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘å·²å°†æ‰€æœ‰èŠ‚ç‚¹è¿æ¥åˆ°äº‘ï¼Œä»…ç”¨äºæ›´æ–°å›ºä»¶ã€‚</font><font style="vertical-align: inherit;">å¹¶ä¸æ˜¯è¯´æˆ‘ä¼šåæ‰§-ä»…ä¸äº‘ä¸€èµ·å·¥ä½œä¼šæ¶ˆè€—ä¸ä¸°å¯Œçš„æ§åˆ¶å™¨èµ„æºã€‚</font><font style="vertical-align: inherit;">IDEæ”¯æŒä½¿ç”¨åº“ï¼Œå®é™…ä¸Šè®¡æ•°å™¨æœ¬èº«æ”¯æŒä¸€æ‰“ï¼Œå…¶ä½™çš„åˆ™ç”±ç¤¾åŒºæ”¯æŒã€‚</font><font style="vertical-align: inherit;">æ ¹æ®æˆ‘çš„è§‚å¯Ÿï¼Œæ‰€æœ‰å¸¸è§çš„ä¸œè¥¿éƒ½å·²ç»ç§»æ¤äº†å¾ˆé•¿æ—¶é—´ï¼Œå¹¶ä¸”å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯IDEå¯ä»¥ç«‹å³çŸ¥é“æœ‰å¤šå°‘é¡¹ç›®åœ¨ä½¿ç”¨è¯¥åº“ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›ºä»¶æºä»£ç </font></font></b><div class="spoiler_text"><pre><code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">// This #include statement was automatically added by the Particle IDE.</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Adafruit_SSD1306/Adafruit_SSD1306.h"</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment">// This #include statement was automatically added by the Particle IDE.</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"MQTT/MQTT.h"</span></span></span></span>

<span class="hljs-comment"><span class="hljs-comment">// This #include statement was automatically added by the Particle IDE.</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"OneWire/OneWire.h"</span></span></span></span>

SYSTEM_THREAD(ENABLED);
SYSTEM_MODE(MANUAL);
STARTUP(WiFi.selectAntenna(ANT_EXTERNAL));
STARTUP(System.enableFeature(FEATURE_RETAINED_MEMORY));

<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">counter_struct</span></span></span><span class="hljs-class"> {</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value;
  byte state;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pin;
};
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">valve_struct</span></span></span><span class="hljs-class"> {</span></span>
  byte state;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pin;
};
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensor_struct</span></span></span><span class="hljs-class"> {</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> timeout;
  byte state;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pin;
};

<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> currentMillis = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> previous_conected = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> previous_wifi_uptime = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> previous_counter_read = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> wifi_uptime;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> start_temp_timer = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> read_temp_timer = <span class="hljs-number"><span class="hljs-number">0</span></span>;
byte display_timeout = <span class="hljs-number"><span class="hljs-number">0</span></span>;

<span class="hljs-comment"><span class="hljs-comment">//temp onewire </span></span>
OneWire ds0 = OneWire(D2);
OneWire ds1 = OneWire(D3);
byte addr0[<span class="hljs-number"><span class="hljs-number">8</span></span>];
byte addr1[<span class="hljs-number"><span class="hljs-number">8</span></span>];
<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> presense0 = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> presense1 = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
byte data[<span class="hljs-number"><span class="hljs-number">12</span></span>];

<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> OLED_RESET A7</span></span>
<span class="hljs-function"><span class="hljs-function">Adafruit_SSD1306 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">display</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OLED_RESET)</span></span></span></span>;


<span class="hljs-comment"><span class="hljs-comment">//valve control</span></span>
retained valve_struct valve[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, D4}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, D5} };

<span class="hljs-comment"><span class="hljs-comment">//counter control</span></span>
retained counter_struct counter[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, A0}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, A1} };
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pressure[<span class="hljs-number"><span class="hljs-number">2</span></span>] = {A2, A3};
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SENSOR_TIMEOUT 10</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> sensor_struct sensor[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, D6}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, D7} };

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* topic, byte* payload, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> length)</span></span></span></span>;

byte server[] = { <span class="hljs-number"><span class="hljs-number">192</span></span>,<span class="hljs-number"><span class="hljs-number">168</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">101</span></span>};
<span class="hljs-function"><span class="hljs-function">MQTT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">client</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(server, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1883</span></span></span></span><span class="hljs-function"><span class="hljs-params">, callback)</span></span></span></span>;

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* t, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> retain)</span></span></span><span class="hljs-function"> 
</span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client.publish(t, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)p, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(p), retain);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* t, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> retain)</span></span></span><span class="hljs-function"> 
</span></span>{   
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf_d[<span class="hljs-number"><span class="hljs-number">12</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf_d,<span class="hljs-string"><span class="hljs-string">"%d"</span></span>,p);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client.publish(t, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)buf_d, n, retain);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* t, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> retain)</span></span></span><span class="hljs-function"> 
</span></span>{   
    <span class="hljs-comment"><span class="hljs-comment">//char buf_f[18];</span></span>
    <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;
<span class="hljs-comment"><span class="hljs-comment">//    dtostrf(p, 9, 4, buf_f);</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//int n = sprintf(buf_f,"%f",p);</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> client.publish(t, (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>*)s.c_str(), s.length(), retain);
}

<span class="hljs-comment"><span class="hljs-comment">// recieve message</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* topic, byte* payload, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> length)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> p[length + <span class="hljs-number"><span class="hljs-number">1</span></span>];
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(p, payload, length);
    p[length] = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>;
    <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p)</span></span></span></span>;
    <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(topic)</span></span></span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t.equals(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark/set"</span></span>))
    {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (message.equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"1"</span></span>))
        {
            Particle.connect();
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waitFor(Particle.connected, <span class="hljs-number"><span class="hljs-number">10000</span></span>)) 
                {publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);}
            <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
                {Particle.disconnect(); publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);}
        }
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
        {
            Particle.disconnect();
            publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
        }
    }
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t.startsWith(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/"</span></span>))
    {
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m = message.toInt();
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = t.substring(<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>).toInt();
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; m &lt; <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; x &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; x &lt;<span class="hljs-number"><span class="hljs-number">2</span></span>) 
        {
            set_valve(x, m);
        }
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
        {
            publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/"</span></span> + t.substring(<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>),  valve[x].state , <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
        }
    }
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t.startsWith(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/"</span></span>))
    {
        <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> m = message.toFloat();
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = t.substring(<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>).toInt();
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; m &lt;= <span class="hljs-number"><span class="hljs-number">999999</span></span> &amp;&amp; x &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &amp;&amp; x &lt;<span class="hljs-number"><span class="hljs-number">2</span></span>) 
        {
            counter[x].value = m;
        }
        publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/"</span></span> + t.substring(<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>),  counter[x].value , <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
<span class="hljs-comment"><span class="hljs-comment">//Serial.begin(9600);</span></span>
    WiFi.on();
    WiFi.connect();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waitFor(WiFi.ready, <span class="hljs-number"><span class="hljs-number">5000</span></span>)) {mqtt_connect();}
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) 
    {
        pinMode(valve[i].pin, OUTPUT);
        digitalWrite(valve[i].pin, valve[i].state);
        pinMode(counter[i].pin, INPUT);
        pinMode(sensor[i].pin, INPUT);
        counter[i].state = digitalRead(counter[i].pin);
        pinMode(pressure[i], AN_INPUT);
    }
    pinMode(A4, INPUT_PULLUP);

    display.begin(SSD1306_SWITCHCAPVCC, <span class="hljs-number"><span class="hljs-number">0x3C</span></span>);  <span class="hljs-comment"><span class="hljs-comment">// initialize with the I2C addr 0x3C (for the 128x64)</span></span>
    display.clearDisplay();   <span class="hljs-comment"><span class="hljs-comment">// clears the screen and buffer</span></span>

    <span class="hljs-comment"><span class="hljs-comment">//Particle.connect();</span></span>
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> 
</span></span>{
    currentMillis = millis();
    <span class="hljs-comment"><span class="hljs-comment">//       MQTT </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - previous_conected &gt;= <span class="hljs-number"><span class="hljs-number">30000</span></span> || previous_conected &gt; currentMillis)
    {
        previous_conected = currentMillis;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!client.isConnected() &amp; wifi_uptime &gt; <span class="hljs-number"><span class="hljs-number">60</span></span>)
        {
            mqtt_connect();
        }
        publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/rssi"</span></span>, WiFi.RSSI(), <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
    }
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - previous_wifi_uptime &gt;= <span class="hljs-number"><span class="hljs-number">1000</span></span> || previous_wifi_uptime &gt; currentMillis)
    {
        previous_wifi_uptime = currentMillis;
        WiFi.ready() ? wifi_uptime++ : wifi_uptime = <span class="hljs-number"><span class="hljs-number">0</span></span>;
        <span class="hljs-comment"><span class="hljs-comment">//work with button and display</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fg = digitalRead(A4);
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (display_timeout &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)
        {
            display_timeout -= <span class="hljs-number"><span class="hljs-number">1</span></span>;
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (display_timeout == <span class="hljs-number"><span class="hljs-number">0</span></span>) 
            { 
                display.clearDisplay();
                display.display();
            } 
        }
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fg == <span class="hljs-number"><span class="hljs-number">0</span></span>)
        {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (display_timeout == <span class="hljs-number"><span class="hljs-number">0</span></span>)
            {
                display.clearDisplay();   <span class="hljs-comment"><span class="hljs-comment">// clears the screen and buffer</span></span>
                display.setTextSize(<span class="hljs-number"><span class="hljs-number">2</span></span>);
                display.setTextColor(WHITE);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"C="</span></span>);
                display.println(counter[<span class="hljs-number"><span class="hljs-number">0</span></span>].value, <span class="hljs-number"><span class="hljs-number">4</span></span>);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"H="</span></span>);
                display.println(counter[<span class="hljs-number"><span class="hljs-number">1</span></span>].value, <span class="hljs-number"><span class="hljs-number">4</span></span>);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"Valve="</span></span>);
                display.print(valve[<span class="hljs-number"><span class="hljs-number">0</span></span>].state);
                display.print(<span class="hljs-string"><span class="hljs-string">"|"</span></span>);
                display.println(valve[<span class="hljs-number"><span class="hljs-number">1</span></span>].state);
                display.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>);
                display.print(<span class="hljs-string"><span class="hljs-string">"Sensor="</span></span>);
                display.print(sensor[<span class="hljs-number"><span class="hljs-number">0</span></span>].state);
                display.print(<span class="hljs-string"><span class="hljs-string">"|"</span></span>);
                display.println(sensor[<span class="hljs-number"><span class="hljs-number">1</span></span>].state);
                display.display();
            }
            display_timeout = <span class="hljs-number"><span class="hljs-number">10</span></span>;
        }
    }
    <span class="hljs-comment"><span class="hljs-comment">//counter check</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - previous_counter_read &gt;= <span class="hljs-number"><span class="hljs-number">500</span></span> || previous_counter_read &gt; currentMillis)
    {
        previous_counter_read = currentMillis;
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) 
        {
            byte count_state = digitalRead(counter[i].pin);
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count_state != counter[i].state)
            {
                counter[i].state = count_state;
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count_state == <span class="hljs-number"><span class="hljs-number">0</span></span>)
                {
                    counter[i].value += <span class="hljs-number"><span class="hljs-number">0.01</span></span>;
                    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf18[<span class="hljs-number"><span class="hljs-number">30</span></span>];
                    <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf18,<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/%d"</span></span>, i);
                    publish_message(buf18 , counter[i].value, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
                }
            }
            <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
            byte sensor_state = digitalRead(sensor[i].pin);
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor_state != sensor[i].state) <span class="hljs-comment"><span class="hljs-comment">//</span></span>
            {
                sensor[i].state = sensor_state;
                sensor[i].timeout = SENSOR_TIMEOUT; 
            }
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor[i].timeout &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) 
            {
                sensor[i].timeout -= <span class="hljs-number"><span class="hljs-number">1</span></span>;
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor[i].timeout == <span class="hljs-number"><span class="hljs-number">0</span></span>)
                {
                    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf18[<span class="hljs-number"><span class="hljs-number">30</span></span>];
                    <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf18,<span class="hljs-string"><span class="hljs-string">"home/water_count/sensor/%d"</span></span>, i);
                    publish_message(buf18 , sensor[i].state, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
                    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensor[i].state  == <span class="hljs-number"><span class="hljs-number">0</span></span>)
                    {
                        set_valve(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//close both valve</span></span>
                        set_valve(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//close both valve</span></span>
                    }
                }
            }
        }
    }

    <span class="hljs-comment"><span class="hljs-comment">// temp onewire</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - start_temp_timer &gt;= <span class="hljs-number"><span class="hljs-number">299000</span></span> || start_temp_timer &gt; currentMillis)
    { <span class="hljs-comment"><span class="hljs-comment">// </span></span>
        start_temp_timer = currentMillis;
        presense0 = start_temp0();
        presense1 = start_temp1();
    }
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentMillis - read_temp_timer &gt;= <span class="hljs-number"><span class="hljs-number">300000</span></span> || read_temp_timer &gt; currentMillis)
    {<span class="hljs-comment"><span class="hljs-comment">// </span></span>
        read_temp_timer = currentMillis;
        start_temp_timer = currentMillis;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (presense0) read_temp0();
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (presense1) read_temp1();
        <span class="hljs-comment"><span class="hljs-comment">//preasure calc and send</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf18[<span class="hljs-number"><span class="hljs-number">30</span></span>]; 
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++)
        {
            <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf18,<span class="hljs-string"><span class="hljs-string">"home/water_count/pressure/%d"</span></span>, i);
            <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> read_val = analogRead(pressure[i]);
            <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value = (read_val - <span class="hljs-number"><span class="hljs-number">600.0</span></span>) / <span class="hljs-number"><span class="hljs-number">300.0</span></span> ;
            publish_message(buf18 , value, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
        }
    }
    <span class="hljs-comment"><span class="hljs-comment">//Particle.process();</span></span>
    client.loop();
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mqtt_connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (client.connect(<span class="hljs-string"><span class="hljs-string">"water_count"</span></span>))
    { <span class="hljs-comment"><span class="hljs-comment">//  spark    </span></span>
        client.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark/set"</span></span>);
        publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/spark"</span></span>, Particle.connected() ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
        client.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/+/set"</span></span>);
        client.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/+/set"</span></span>);
        
    }
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_temp0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !ds0.search(addr0)) { ds0.reset_search(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    ds0.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OneWire::crc8(addr0, <span class="hljs-number"><span class="hljs-number">7</span></span>) != addr0[<span class="hljs-number"><span class="hljs-number">7</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    
    ds0.reset();
    ds0.select(addr0);
    ds0.write(<span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; 
}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_temp1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !ds1.search(addr1)) { ds1.reset_search(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    ds1.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OneWire::crc8(addr1, <span class="hljs-number"><span class="hljs-number">7</span></span>) != addr1[<span class="hljs-number"><span class="hljs-number">7</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;}
    
    ds1.reset();
    ds1.select(addr1);
    ds1.write(<span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; 
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-comment"><span class="hljs-comment">//delay(1000);</span></span>
    ds0.reset();
    ds0.select(addr0);
    ds0.write(<span class="hljs-number"><span class="hljs-number">0xBE</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) 
    {
        data[i] = ds0.read();
    }
    <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> raw = (data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | data[<span class="hljs-number"><span class="hljs-number">0</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> celsius = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)raw * <span class="hljs-number"><span class="hljs-number">0.0625</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (celsius &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || celsius &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
    publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/temp/0"</span></span>, celsius, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
    <span class="hljs-comment"><span class="hljs-comment">//Serial.println(celsius);</span></span>
    ds0.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;
}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{
    <span class="hljs-comment"><span class="hljs-comment">//delay(1000);</span></span>
    ds1.reset();
    ds1.select(addr1);
    ds1.write(<span class="hljs-number"><span class="hljs-number">0xBE</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);

    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) 
    {
        data[i] = ds1.read();
    }
    <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> raw = (data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | data[<span class="hljs-number"><span class="hljs-number">0</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> celsius = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)raw * <span class="hljs-number"><span class="hljs-number">0.0625</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (celsius &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || celsius &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
    publish_message(<span class="hljs-string"><span class="hljs-string">"home/water_count/temp/1"</span></span>, celsius, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);
    <span class="hljs-comment"><span class="hljs-comment">//Serial.println(celsius);</span></span>
    ds1.reset_search();
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_valve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> vlv, byte state)</span></span></span><span class="hljs-function">
</span></span>{
    valve[vlv].state = state;
    digitalWrite(valve[vlv].pin, state);
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf26[<span class="hljs-number"><span class="hljs-number">26</span></span>];
    <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(buf26,<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/%d"</span></span>, vlv);
    publish_message(buf26 , state , <span class="hljs-literal"><span class="hljs-literal">true</span></span>);
}
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šè¿‡MQTTï¼Œæˆ‘ä»¬è¿æ¥åˆ°ä»£ç†ã€‚</font><font style="vertical-align: inherit;">åœ¨mqttäº‹ä»¶å’Œå€¼çš„ç›¸åº”åˆ†æ”¯ä¸­ç›‘è§†ä¼ æ„Ÿå™¨å’Œå¤´ç›”ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚home / water_count /é˜€é—¨/ 0-æ°´é©±åŠ¨å™¨ã€‚</font><font style="vertical-align: inherit;">home / water_count /è®¡æ•°å™¨/ 0-å†·æ°´è®¡æ•°å™¨çš„è¯»æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬è®¢é˜…äº†ç”¨äºæ›´æ”¹é©±åŠ¨å™¨çŠ¶æ€å’Œè®¾ç½®è®¡æ•°å™¨å½“å‰å€¼ï¼ˆå†·æ°´å’Œçƒ­æ°´ï¼‰çš„å‘½ä»¤ï¼š</font></font><br>
<br>
<pre><code class="hljs axapta"><span class="hljs-keyword"><span class="hljs-keyword">client</span></span>.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/valve/+/set"</span></span>);
<span class="hljs-keyword"><span class="hljs-keyword">client</span></span>.subscribe(<span class="hljs-string"><span class="hljs-string">"home/water_count/counter/+/set"</span></span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®¾å¤‡ä¸Šåªæœ‰ä¸€ä¸ªæŒ‰é’®-æŒ‰ä¸‹æˆ‘ä»¬æ‰“å¼€å±å¹•ï¼Œç»˜åˆ¶è®¡æ•°å™¨ï¼Œä¼ æ„Ÿå™¨å’Œæ°´é¾™å¤´çš„å½“å‰è¯»æ•°ã€‚ OLEDå±å¹•ï¼Œå¦‚æœå§‹ç»ˆä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œåˆ™å¿«é€Ÿè¤ªè‰²ã€‚</font></font><br>
<br>
<pre><code class="hljs lisp">STARTUP(<span class="hljs-name"><span class="hljs-name">System</span></span>.enableFeature(<span class="hljs-name"><span class="hljs-name">FEATURE_RETAINED_MEMORY</span></span>))<span class="hljs-comment"><span class="hljs-comment">;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™æ˜¯stmæ§åˆ¶å™¨æœ‰è¶£çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠŸèƒ½ï¼Œåœ¨å‚è€ƒå¾®ç²’ä¸­ï¼Œä»–ä»¬å°†å…¶ç§°ä¸ºBackupSRAMã€‚å…‰å­æœ‰ä¸€ä¸ªvbatè¾“å‡º-è¿™ä¸æ˜¯ç”µæ± ç”µé‡æˆ–å……ç”µã€‚åªè¦è¿™æ¡è„šä¸Šæœ‰ç”µå‹ï¼Œå°±å¯ä»¥åœ¨æ§åˆ¶å™¨å®Œå…¨æ–­ç”µçš„æƒ…å†µä¸‹ä¿æŒ4kå­—èŠ‚SRAMçš„å†…å®¹ã€‚è¿™æ ·å°±æ¶ˆé™¤äº†EEPROMçš„ç£¨æŸé—®é¢˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ä»£ç ä¸­ï¼Œå¿…é¡»è¢«é©±åŠ¨åˆ°è¯¥å­˜å‚¨å™¨ä¸­çš„å˜é‡å£°æ˜ä¸ºï¼šretainedã€‚æˆ‘ä»1.5Fçš„è¶…çº§ç”µå®¹å™¨å®ç°äº†ç¡¬ä»¶ã€‚æ ¹æ®æ•°æ®è¡¨ï¼Œè¯¥å­˜å‚¨å™¨å°†åœ¨1.6væ—¶æ­»äº¡ï¼Œæ ¹æ®æˆ‘åœ¨åŸå‹æ¿ä¸Šçš„å®éªŒï¼Œå®ƒå°†åœ¨2å‘¨çš„æ—¶é—´å†…ç”¨å¤§çº¦æˆ‘çš„ç”µå®¹å™¨ã€‚è§¦å‘ä¼ æ„Ÿå™¨æ—¶å…³é—­èµ·é‡æœºçš„é€»è¾‘æ˜¯â€œè‡ªä¸»çš„â€ï¼Œå¹¶ä¸å–å†³äºä¸openhabçš„è¿æ¥ã€‚æœ‰ä¸€ä¸ªç”¨äºç›´æ¥é©±åŠ¨æ§åˆ¶çš„ä¸‰å‘å¼€å…³-è‡ªåŠ¨ï¼ŒOFFï¼ˆæ‰“å¼€æ°´é¾™å¤´ï¼‰ï¼ŒCloseï¼ˆå…³é—­ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹é¢çš„ç”µè·¯å›¾ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/files/1a8/f4c/63d/1a8f4c63dba34f4e9905b703fabad0fd.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eagleé¡¹ç›®ä»¥åŠè‡ªå®šä¹‰åº“å¯åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è´¹ç”¨æ˜¯LUTï¼Œåœ¨è½¨é“ä¸Šæ²¡æœ‰ç¼©å°ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ°´æµ´LUTçš„æœ€å¥½çš„æœ‹å‹</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/351/e37/1c3/351e371c3caf487d9f14f839f89402be.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”µæºå•å…ƒã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬éœ€è¦12ä¼å’Œ5ä¼ã€‚</font><font style="vertical-align: inherit;">åœ¨ebayä¸Šæœç´¢æèµ è€…çš„è¡Œï¼šâ€œç¡¬ç›˜é©±åŠ¨å™¨ç”µæºé€‚é…å™¨5v 12vâ€ï¼Œä¾‹å¦‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ¿å±‹</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®ƒæ˜¯ç”¨PLAå¡‘æ–™åœ¨3dæ‰“å°æœºï¼ˆTarantula Tevoï¼‰ä¸Šæ‰“å°çš„ã€‚</font><font style="vertical-align: inherit;">å–·å˜´0.4æ¯«ç±³ï¼Œå±‚0.25æ¯«ç±³ã€‚</font><font style="vertical-align: inherit;">ç›–å­æ˜¯åœ¨åŒä¸€æ—¶é—´ï¼Œå¹¶ä¸”æ˜¯ç”¨äºå®‰è£…æ§åˆ¶å™¨æ¿çš„åŸºåº§ã€‚</font><font style="vertical-align: inherit;">å¸¦ç”µæºçš„åº•åº§å›ºå®šåœ¨å¢™ä¸Šã€‚</font><font style="vertical-align: inherit;">å¸¦æœ‰ç›–å­çš„åº•åº§æ²¡æœ‰ç”¨èºé’‰å›ºå®šï¼Œç›–å­çš„æ‹‰åŠ›è¶³å¤Ÿå¤§ï¼ˆå°±åƒç¥–æ¯çš„ç›–å­åœ¨æœé…±ç½ä¸Šä¸€æ ·ï¼‰ï¼Œå¢™å£çš„åˆ†å±‚ç»“æ„ä¹Ÿèµ·ä½œç”¨ã€‚</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">å­˜æ¡£ä¸­çš„</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
3Dæ¨¡å‹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">
è¿™æ˜¯å®‰è£…åœ¨æ°´ç®¡ä¸Šçš„æ‰€æœ‰å¤–è§‚ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/files/945/110/37d/94511037d3734ad1a573e84e5fc426ef.png"><br>
<br>
<img src="https://habrastorage.org/files/5aa/546/c0b/5aa546c0b6dd41d58fd6b33bde08df74.png"><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/files/cfb/293/f66/cfb293f66c3f4bb9ad2f46e812418918.jpg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openhab</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éƒ¨ç½²åœ¨Armbianä¸‹çš„Orange Pi Oneä¸Šã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¡¹ç›®é…ç½®</font></font></b><div class="spoiler_text"><pre><code class="hljs julia">  -    ,  .
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_temp1	<span class="hljs-string"><span class="hljs-string">"T cool [%.1f Â°C]"</span></span>			(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/temp1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_temp2	<span class="hljs-string"><span class="hljs-string">"T hot [%.1f Â°C]"</span></span>			(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/temp2:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_count0	<span class="hljs-string"><span class="hljs-string">"Count cool [%.2f Â³]"</span></span>					(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/counter/0:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_count1	<span class="hljs-string"><span class="hljs-string">"Count hot [%.2f Â³]"</span></span>				(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/counter/1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_pressure0	<span class="hljs-string"><span class="hljs-string">"P cool [%.2f .]"</span></span>			(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/pressure/0:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_pressure1	<span class="hljs-string"><span class="hljs-string">"P hot [%.2f .]"</span></span>				(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/pressure/1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sensor0	<span class="hljs-string"><span class="hljs-string">"Sensor0 is [MAP(water_sensor.map):%s]"</span></span>		(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/sensor/0:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sensor1	<span class="hljs-string"><span class="hljs-string">"Sensor1 is [MAP(water_sensor.map):%s]"</span></span>		(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/sensor/1:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_valve0	<span class="hljs-string"><span class="hljs-string">"Valve cool"</span></span>		(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/valve/0:state:default], &gt;[mqtt_bro:home/water_count/valve/0/set:command:*:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_valve1	<span class="hljs-string"><span class="hljs-string">"Valve hot"</span></span>				(gWaterCount)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/valve/1:state:default], &gt;[mqtt_bro:home/water_count/valve/1/set:command:*:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>	watercount_sendStr <span class="hljs-string"><span class="hljs-string">"LastVol:[%s]"</span></span>						(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sendCool <span class="hljs-string"><span class="hljs-string">"Send cool [%.2f Â³]"</span></span>		(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sendHot <span class="hljs-string"><span class="hljs-string">"Send hot [%.2f Â³]"</span></span>			(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_sendSwitch <span class="hljs-string"><span class="hljs-string">"Autosend"</span></span> 	(gWaterCount)
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_rssi	<span class="hljs-string"><span class="hljs-string">"WaterCount [%d dB]"</span></span>	(gSpark_RSSI)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/rssi:state:default]"</span></span> }
<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>	watercount_spark_state	<span class="hljs-string"><span class="hljs-string">"WaterCount Spark"</span></span>		(gSpark)		{ mqtt=<span class="hljs-string"><span class="hljs-string">"&lt;[mqtt_bro:home/water_count/spark:state:default], &gt;[mqtt_bro:home/water_count/spark/set:command:*:default]"</span></span> }</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ³„æ¼ä¼ æ„Ÿå™¨éœ€è¦ä¸€ä¸ªå°çš„å˜æ¢è§„åˆ™ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®è½¬æ¢</font></font></b><div class="spoiler_text"><b>transform\water_sensor.map </b><br>
1=dry<br>
0=wet<br>
undefined=undefined<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å½¢æˆç®¡ç†é¡µé¢ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®ç«™ç‚¹åœ°å›¾</font></font></b><div class="spoiler_text"><b>Sitemap</b><br>
Text label=Â«Â» icon=Â«waterÂ» <br>
 {<br>
 Frame <br>
 {<br>
 Text item=watercount_temp1<br>
 Text item=watercount_count0<br>
 Text item=watercount_pressure0<br>
 Switch item=watercount_valve0 mappings=[1=Â«CloseÂ», 0=Â«OpenÂ»]<br>
 }<br>
 Frame <br>
 {<br>
 Text item=watercount_temp2<br>
 Text item=watercount_count1<br>
 Text item=watercount_pressure1<br>
 Switch item=watercount_valve1 mappings=[1=Â«CloseÂ», 0=Â«OpenÂ»]<br>
 }<br>
 Frame <br>
 {<br>
 Text item=watercount_sensor0<br>
 Text item=watercount_sensor1 <br>
 }<br>
 Frame <br>
 {<br>
 Switch item=watercount_sendSwitch mappings=[0=Â«OFFÂ», 1=Â«ONÂ»]<br>
 Text item=watercount_sendStr<br>
 Text item=watercount_sendCool<br>
 Text item=watercount_sendHot<br>
 }<br>
 } <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»¥åŠå¤„ç†è§„åˆ™ï¼š</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®è§„åˆ™</font></font></b><div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_sensor0"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_sensor0 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
			{
				sendTelegram("****_bot", "Sensor0 was wet less than 5 seconds")
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor0 become dry")
			}
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">0</span></span>)
			{
				sendTelegram("****_bot", "Sensor0 was dry less than 5 seconds");			
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor0 become wet! Valves will be closed!")
			}
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_sensor1"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_sensor1 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">1</span></span>)
			{
				sendTelegram("****_bot", "Sensor1 was wet less than 5 seconds")
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor1 become dry")
			}
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_sensor1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) == <span class="hljs-number"><span class="hljs-number">0</span></span>)
			{
				sendTelegram("****_bot", "Sensor1 was dry less than 5 seconds");			
			}
			<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
			{
				sendTelegram("****_bot", "Sensor1 become wet! Valves will be closed!")
			}
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
	
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_temp2"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_temp2 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_temp2.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt; <span class="hljs-number"><span class="hljs-number">37</span></span> )
		{
			sendTelegram("****_bot", String::format("Hot water temp drop to %s", watercount_temp2.state.toString));
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>

<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_pressure0"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_pressure0 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Cool pressure drop to %s", watercount_pressure0.state.toString));
		}
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure0.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Cool pressure rise to %s", watercount_pressure0.state.toString));
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Check watercount_pressure1"
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		Item watercount_pressure1 received <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Hot pressure drop to %s", watercount_pressure1.state.toString));
		}
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((watercount_pressure1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (watercount_pressure1.historicState(now.minusSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>)).state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType) &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendTelegram("****_bot", String::format("Hot pressure rise to %s", watercount_pressure1.state.toString));
		}
	<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>

<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Generate send string counters" //every <span class="hljs-number"><span class="hljs-number">24</span></span> day <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> mounth  <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">00.01</span></span> minutes
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		<span class="hljs-type"><span class="hljs-type">Time</span></span> cron "0 0 1 24 1/1 ?" 
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		
		var <span class="hljs-type"><span class="hljs-type">float</span></span> deltaCool = (watercount_count0.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue() - (watercount_sendCool.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue()
		var <span class="hljs-type"><span class="hljs-type">float</span></span> deltaHot = (watercount_count1.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue() - (watercount_sendHot.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue()
		
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (deltaCool &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; deltaHot &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>)
		{
			watercount_sendStr.postUpdate(String::format(" %.2f / %.2f 3", deltaCool, deltaHot))
			watercount_sendCool.state = watercount_count0.state
			watercount_sendHot.state = watercount_count1.state
			sendTelegram("****_bot", String::format(" 23,  5, . 23.  â„–2560097 (.) = %.2f 3. C â„–2538996 (.) = %.2f 3. %s", (watercount_sendCool.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue(), (watercount_sendHot.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue(), watercount_sendStr.state.toString()))
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			watercount_sendSwitch.postUpdate(<span class="hljs-number"><span class="hljs-number">0</span></span>)
			sendTelegram("****_bot", "Current counters value less than sended last time. Turn off autosend.")
		}
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Send string counters" 
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		<span class="hljs-type"><span class="hljs-type">Time</span></span> cron "0 0 23 24 1/1 ?"
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (watercount_sendSwitch.state == <span class="hljs-number"><span class="hljs-number">1</span></span>)
		{
			sendMail("uk@uk.ru", " 23,  5, . 23", String::format(" 23,  5, . 23.  â„–2560097 (.) = %.2f 3. C â„–2538996 (.) = %.2f 3", (watercount_sendCool.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue(), (watercount_sendHot.state <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DecimalType).floatValue()));
			sendTelegram("****_bot", "Send email with watercount values");
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			sendTelegram("****_bot", "Can't send email with watercount values - autosend is OFF.");
		}
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">rule</span></span> "Rotate valves" 
	<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>
		<span class="hljs-type"><span class="hljs-type">Time</span></span> cron "0 0 05 25 1/1 ?"
	<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (watercount_valve0.state == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; watercount_valve1.state == <span class="hljs-number"><span class="hljs-number">0</span></span>)
		{	
			watercount_valve0.postUpdate(<span class="hljs-number"><span class="hljs-number">1</span></span>)
			Thread::sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>)
			watercount_valve1.postUpdate(<span class="hljs-number"><span class="hljs-number">1</span></span>)
			Thread::sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>)
			watercount_valve0.postUpdate(<span class="hljs-number"><span class="hljs-number">0</span></span>)
			Thread::sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>)
			watercount_valve1.postUpdate(<span class="hljs-number"><span class="hljs-number">0</span></span>)
			sendTelegram("****_bot", "Valves was rotated.");
		}
		<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>
		{
			sendTelegram("****_bot", "Can't rotate valves, it's closed.");
		}
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä¸ä½¿ç”¨openhab androidåº”ç”¨ç¨‹åºçš„å†…ç½®åŠŸèƒ½ï¼Œä¹Ÿä¸ä¸å®ƒä»¬çš„äº‘é›†æˆã€‚</font><font style="vertical-align: inherit;">æˆ‘å–œæ¬¢Telegramæœºå™¨äººã€‚</font><font style="vertical-align: inherit;">å¦‚ä½•é…ç½®å’Œè¿æ¥æœºå™¨äººå¯ä»¥åœ¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šçœ‹åˆ°</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¦ä»gmailé‚®ç®±å‘é€ä¿¡ä»¶ï¼Œå¦‚æœæ‚¨å…·æœ‰ä¸¤é‡èº«ä»½éªŒè¯ï¼Œåˆ™éœ€è¦ä¸ºé‚®ä»¶åº”ç”¨ç¨‹åºå¯ç”¨ä¸€æ¬¡æ€§å¯†ç ï¼Œå¹¶åœ¨openhabé…ç½®ä¸­è®¾ç½®æ­¤å¯†ç ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éµå®ˆè§„åˆ™ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥watercount_sensor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-æ§åˆ¶å™¨ä»…åœ¨æ›´æ”¹å€¼æˆ–å‡ºç°é”™è¯¯è­¦æŠ¥ï¼ˆå°‘äº10ä¸ªå‘¨æœŸï¼‰æ—¶æ‰å‘é€æ–°çš„æ³„æ¼ä¼ æ„Ÿå™¨å€¼ã€‚æˆ‘ä»¬åˆ†æäº†æ¥æ–‡å’Œå†å²æ„ä¹‰ï¼Œå½¢æˆäº†ä¿¡æ¯æ€§æ¶ˆæ¯ã€‚æœ‰ä¸€ä¸ªç»†å¾®å·®åˆ«-å°è¯•ä¸æ–­è·å–prevoiusItemä¼šç»™å‡ºå½“å‰å€¼ï¼Œä½†æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ-æˆ‘å°†å€¼è®¾ä¸ºâ€œ -3ç§’â€ï¼Œå¦‚æœæœ‰äººå…‹æœäº†å®ƒï¼Œè¯·åœ¨æ³¨é‡Šæˆ–PMä¸­å†™ä¸‹æ¥ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥watercount_temp2-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥æ˜¯å¦ä½äº37ï¼ˆè¡¨ç¤ºçƒ­æ°´å·²å˜å†·ï¼‰ï¼Œåˆ°è¾¾æ—¶å¿…é¡»æ‰“å¼€æµé‡åŠ çƒ­å™¨ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥watercount_pressure-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬åˆ†æå½“å‰å€¼å’Œå…ˆå‰å€¼ï¼Œå¹¶ä»¥ä¸€æ¡æ¶ˆæ¯å“åº”ï¼Œè¦æ±‚ä¸‹é™åˆ°1 atmä»¥ä¸‹å¹¶åœ¨å…¶ä¹‹ä¸Šå¢é•¿ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆå‘é€å­—ç¬¦ä¸²è®¡æ•°å™¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ä»æ¯æœˆ24æ—¥å‡Œæ™¨1ç‚¹å¼€å§‹ã€‚æˆ‘ä»¬æ£€æŸ¥è¿™äº›å€¼ç°åœ¨æ˜¯å¦å¤§äºä¸Šæ¬¡å‘é€çš„å€¼ã€‚å¦‚æœè¾ƒå°‘ï¼Œè¯·å…³é—­è‡ªåŠ¨å‘é€å¹¶ç”Ÿæˆè­¦æŠ¥ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬ä¼šè®°ä½è¦å‘é€ç»™ã€Šåˆ‘æ³•ã€‹çš„è®¡æ•°å™¨çš„å€¼ï¼Œé‚£ä¹ˆä¼šå°†å°†æ¥çš„æ¶ˆæ¯æ­£æ–‡å‘é€ç»™ç”µæŠ¥ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨watercount_sendSträ¸­ä¿å­˜äº†è¿‡å»ä¸€ä¸ªæœˆçš„æ¶ˆè€—é‡ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”Ÿæˆå‘é€å­—ç¬¦ä¸²è®¡æ•°å™¨</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ä»cronå¼€å§‹äºç¬¬24å¤©çš„23.00ã€‚æ£€æŸ¥æ˜¯å¦å¯ç”¨äº†è‡ªåŠ¨å‘é€ï¼ˆå¦‚æœå·²å¯ç”¨ï¼‰-å¤´ç›”å°†è®¡æ•°å™¨å‘é€åˆ°è¿è¾“å…¬å¸çš„é‚®ä»¶ã€‚äº‹å®è¯æ˜ï¼Œå¦‚æœç”µæŠ¥ä¸­å‘ç”Ÿé”™è¯¯ï¼Œæˆ‘æ•´å¤©æœ‰24å¤©çš„æ—¶é—´ï¼Œå¯ä»¥è§£å†³ä¸€äº›é—®é¢˜ï¼Œæˆ–è€…åªæ˜¯å‡å°‘è‡ªåŠ¨å‘é€çš„æ—¶é—´ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡è¯„è®ºæ›´æ–°</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ—‹è½¬é˜€</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-æ¯æœˆå…³é—­/æ‰“å¼€æ°´é¾™å¤´ä¸€æ¬¡ä»¥é˜²æ²¸è…¾çš„è§„åˆ™ã€‚</font><font style="vertical-align: inherit;">25æ—¥å‡Œæ™¨5ç‚¹-ä¸ºäº†ä¸å½±å“æ´—ç¢—æœºæˆ–æ´—è¡£æœºçš„å·¥ä½œï¼Œä½†å³ä½¿åˆ°è¾¾é‚£é‡Œ-ä¹Ÿä¸é‡è¦ï¼Œæ°´çš„é‡å å¤§çº¦éœ€è¦3-4ç§’ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åªæœ‰åœ¨è¿™é‡Œï¼Œæ™ºèƒ½å®¶å±…æ‰å¼€å§‹â€¦â€¦</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
åœ¨å•ç‚¹ï¼ˆopenhabï¼‰ä¸­ç»„åˆç³»ç»Ÿï¼Œæ‚¨å¯ä»¥æ„å»ºä¸€ç»„è‡ªæ²»ç³»ç»Ÿæ— æ³•ä½¿ç”¨çš„é€»è¾‘ã€‚</font><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼šæ°´è¡¨å¢åŠ çš„äº‹ä»¶å·²ç»åˆ°æ¥-å®‰å…¨ç³»ç»Ÿå¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå‰é—¨é”å·²å…³é—­ï¼Œæ´—ç¢—æœºå’Œæ´—è¡£æœºçš„èƒ½è€—ä½äº5ç“¦-è¿™æ„å‘³ç€æ£€æµ‹åˆ°ä¼ æ„Ÿå™¨æ³„æ¼ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ç»„æˆå‘½ä»¤å…³é—­èµ·é‡æœºï¼Œå¹¶åœ¨Telegramä¸­å‘æœºå™¨äººå‘é€æ¶ˆæ¯ã€‚</font><font style="vertical-align: inherit;">ä½†è¿™å°±åƒç¨åçš„ä¸»é¢˜ã€‚</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN399459/">https://habr.com/ru/post/zh-CN399459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN399449/index.html">DNAä»…æ˜¯æŸ“è‰²ä½“å¤§å°çš„ä¸€åŠã€‚å…¶ä»–ä¸€åˆ‡éƒ½æ˜¯æœªçŸ¥åŠŸèƒ½çš„å¤–å£³</a></li>
<li><a href="../zh-CN399451/index.html">ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰å©´å„¿çš„å›å¿†</a></li>
<li><a href="../zh-CN399453/index.html">ç°åœ¨æœ‰äº”ç§å½¢å¼çš„åŒºå—é“¾è´§å¸å¯ç”¨</a></li>
<li><a href="../zh-CN399455/index.html">ä¸ä»…æ˜¯å®¶ç”¨ç”µå™¨ï¼šAudiomaniaè¿˜ä¸ºéŸ³ä¹çˆ±å¥½è€…ï¼Œçˆ±å¥½è€…å’ŒéŸ³ä¹å®¶æä¾›äº†ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN399457/index.html">ä¿„ç½—æ–¯é‡‘èç§‘æŠ€å¤§ä¼šï¼ƒ2ï¼šæ•°å­—æ—¶ä»£çš„äº¤æ˜“</a></li>
<li><a href="../zh-CN399461/index.html">äººå·¥æ™ºèƒ½å°†å¸®åŠ©äººä»¬æ‘†è„±ææƒ§ç—‡å’Œææƒ§</a></li>
<li><a href="../zh-CN399463/index.html">Multicopterå­¦ä¼šäº†ååœ¨åŠ¨è½¦çš„å±‹é¡¶ä¸Š</a></li>
<li><a href="../zh-CN399469/index.html">Pix2pixç¥ç»ç½‘ç»œé€¼çœŸçš„ç»™é“…ç¬”ç´ æå’Œé»‘ç™½ç…§ç‰‡ä¸Šè‰²</a></li>
<li><a href="../zh-CN399471/index.html">å¤ªç©ºä½å®…ï¼Œç¬¬5éƒ¨åˆ†ï¼šæˆ‘ä»¬å°†å¦‚ä½•ç”Ÿæ´»åœ¨æ°´æ˜Ÿä¸Šï¼ˆæˆ–è€…æˆ‘ä»¬ä¸ä¼šï¼‰</a></li>
<li><a href="../zh-CN399473/index.html">èŠ¯ç‰‡Intel 4004å·²æœ‰45å¹´å†å²äº†ã€‚ä¸€ç‚¹ITå†å²</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>