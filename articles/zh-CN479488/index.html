<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😙 🤲🏻 👨🏿‍⚖️ 从笔记本电脑-具有冗余电源的家庭服务器到Mikrotik路由器 💹 ✌️ 📋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="简要地 
 一篇让粉丝自己焊接简单方案并弄清楚为什么采用这种方案的文章。 

 对于真正需要这种服务器的人也是如此。 

 这里没有超级成就，但是有一种便宜，紧凑和经济的解决方案，在某些情况下，它可以代替庞大的设备： 



- 用一台旧笔记本电脑和一个路由器电源设备制作了一台家庭服务器， 
- 通...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>从笔记本电脑-具有冗余电源的家庭服务器到Mikrotik路由器</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479488/"><img src="https://habrastorage.org/webt/pl/gi/hh/plgihhkmxbo7cvnzhnbtwwdi85w.jpeg"><br><br><h1> 简要地 </h1><br> 一篇让粉丝自己焊接简单方案并弄清楚为什么采用这种方案的文章。 <br><br> 对于真正需要这种服务器的人也是如此。 <br><br> 这里没有超级成就，但是有一种便宜，紧凑和经济的解决方案，在某些情况下，它可以代替庞大的设备： <br><br><ul><li> 用一台旧笔记本电脑和一个路由器电源设备制作了一台家庭服务器， </li><li> 通过充电和笔记本电池解释了路由器的电源方案， </li><li> 说明打开电源时打开笔记本电脑的方案。 </li></ul><a name="habracut"></a><br><h1> 主意 </h1><br> 我需要一个小型文件服务器，该服务器还必须承受长达15分钟的断电。 <br><br> 我决定用一台旧笔记本电脑来做。 <br><br> 专门为实验准备的笔记本电脑（Asus A8J）矩阵破损，但带有带电的电池和风扇。 <br><br>  <i>（注意：如果您已经拥有一台笔记本电脑，则就像在水壶方面的众所周知的任务中一样，不必破坏矩阵。但是，如果您的路由器（如我的路由器）与4G调制解调器一起工作，则最好禁用矩阵，然后我将解释原因。</i> <i><br><br></i>  <i>在没有矩阵的情况下工作不会造成任何不适，首先使用外部监视器，然后使用SSH。）</i> <br><br> 在此过程中，我提请注意以下事实：Mikrotik路由器（我拥有RB-951G）可以使用9 V至30 V的电源供电，并且出现了用笔记本电脑供电的想法。 <br><br> 事实证明这是一个非常成功的组合：在存在电源电压的情况下，路由器由笔记本电脑充电器（19-20 V）供电，在电源出现故障的情况下，由同一台笔记本电脑的电池（放电时的12至9 V）供电，即 一切都在正常范围内。 <br><br>  <i>更确切地说，由于二极管上的压降，路由器上的电压将降低0.2-0.4 V，但仍在可接受的范围内（电池放电的下限除外，我们不确定，下限除外，但就我而言，不太可能达到该电压） 。</i> <i><br><br></i>  <i>如果确实如此，那么路由器将不会发生任何可怕的事情。</i> <br><br><h1> 路由器电源方案 </h1><br><img src="https://habrastorage.org/webt/x8/ym/3x/x8ym3xsabcnw62ea6dmynhylwic.jpeg"><br><br> 由于此处优先使用较高的电压（20V），因此两个二极管的开关电路非常简单。 <br><br> 也很方便，不需要电压保护。 <br><br> 如果长时间没有网络，电池将放电至其内置控制器将断开负载的极限，因此不会发生过放电。 <br><br> 然后，在接通主电源后，电池将开始充电，并且路由器将由充电器供电。 <br><br>  <i>从理论上讲，在不成功的情况下，我们可以超过充电器和/或电池的允许电流（因为我们在20V时将额外的0.4-0.8A电流带到路由器），但实际上不会发生过量电流，这就是为什么：我从笔记本电脑，控制器中卸下了DVD驱动器WIFI，以及矩阵。</i>  <i>因此，电流消耗降低。</i> <br><br> 为了减少电压损失，我们选择了肖特基二极管，具体地说，我组装了两个二极管（我不记得这种二极管），它们装在计算机电源中，看上去像一个功能强大的晶体管。 <br><br>  <i>在最坏的情况下-使用9V供电时，路由器及其随附的4G调制解调器的电流消耗可能高达1.7A。</i> <i><br><br></i>  <i>（路由器内部的开关电源消耗恒定功率，因此输入电压越低，电流消耗越大）。</i> <br><br> 组装二极管可承受20A的连续电流，这也很方便。 <br><br> 您不必针对输出短路做保护。 内部充电和电池保护电路将发挥这种作用（如果有的话）。 <br><br> 如果有人想使用单独的肖特基二极管，则需要使它们流过至少5A电流并至少略微冷却，例如通过电路板上的走线。 <br><br><h1> 笔记本电路 </h1><br><img src="https://habrastorage.org/webt/tz/lz/aw/tzlzawj3w4knkung90wa0vakney.jpeg"><br><br> 但是还有另一个问题：当电源电压出现时，笔记本电脑本身无法打开。  <i>BIOS中没有此类选项。</i>  <i>（由于某些原因，许多笔记本电脑没有许多有用的功能，例如，它们仍然无法从存储卡启动）。</i> <br><br> 尽管这样的中断是为了使电池完全放电，但实际上我们并没有发生，但是我已经想解决这个问题了。 <br><br> 在我的笔记本电脑上，电源按钮将电路输入关闭为负电源（您也很可能也会）。 <br><br> 在相同的输入端，我焊接了设备连接器上的导线。 <br><br> 在设备中，此输入由负晶体管关闭，笔记本电脑打开。 <br><br> 为了在不正确的连接情况下保护晶体管，已将电阻器R8添加到了集电极电路。 <br><br> 即使此电阻增加了3倍，也可以检查笔记本电脑是否稳定地打开。  （这对于您在笔记本电脑上进行检查也更好，因为按钮的输入参数可能会有所不同）。 <br><br> 为了控制晶体管，在带有施密特触发器和元件R4，R5，C3的CD4093芯片上制造了一个RC脉冲发生器。 脉冲持续时间约1 s，精度不重要。 <br><br> 重要的是，发电机的运行必须暂停。 <br><br>  <i>这就是我制作脉冲发生器的原因：第一次按下按钮时笔记本电脑有时无法打开，而第二次按下时笔记本电脑却打开了，我不知道为什么。</i>  <i>无论如何，事实证明它是一种通用且可靠的解决方案。</i> <br><br> 当笔记本电脑打开时，您不再需要“按下”按钮，我们将停止发电机。 <br><br> 该电路了解如何使用焊接到任何USB连接器+ 5V的另一根线打开笔记本电脑。 <br><br>  <i>我的笔记本电脑在打开时仅向USB提供+ 5V电压。</i> <i><br><br></i>  <i>（如果通过网络供电时USB电压始终存在，则必须关闭BIOS中的相应选项，或为此信号寻找另一个连接点）。</i> <br> 微电路由+ 20V输入通过R1和VD3和C2中最简单的稳定器供电，以防万一防止电源脉冲。 <br><br> 还使用+ 5V USB为该电路供电，以便在市电电源出现故障时，发电机电源不会下降，并且会形成虚假脉冲，从而关闭笔记本电脑。 <br><br> 两个电源均通过两个二极管VD1，VD2上最简单的电路提供给微电路，这与路由器上的相同，只是功率非常低。 <br><br><h1> 建筑施工 </h1><br><img src="https://habrastorage.org/webt/bg/i3/eb/bgi3ebghkos-hpssa5w7wrsrsie.jpeg"><br><br> 连接器为10针：PLD-10 + PBD-10，电源线上使用2根平行线。 <br><br> 在其余的4个中，两个由按钮的输入占据，+ 5V USB未被使用。 <br><br>  <i>选择了触点的位置，这样，如果您以相反的方向打开连接器，则不会烧毁任何东西，路由器将被供电，打开笔记本电脑的功能将不起作用。</i> <br><br> 该设备组装在面包板上，并放置在热缩管中。 <br><br> 无需额外的冷却。 <br> 您可以将其放在DVD驱动器所在的隔间中。 <br> 零件可以在很宽的范围内用类似物代替。 <br> 我不提供一般照片，因为 笔记本电脑坏了，所以他们都看到了。 <br><br><h1> 发生什么事了 </h1><br><img src="https://habrastorage.org/webt/q0/ym/hx/q0ymhxprycrw8yq0wg_h-szf8ue.jpeg"><br><br> 它已经工作了一个月了。 <br><br> 至少消耗13瓦（由电表测量），并且有功工作会增加到25瓦。 <br><br> 检测到2个硬件故障： <br><br> 小故障1：如果您关闭笔记本电脑的充电接口，则有时笔记本电脑会立即关闭。 <br><br>  <i>这很可能是由于我将充电后的电线直接连接到板上的设备，甚至使用了+ 5V USB和来自按钮的电线。</i> <i><br><br></i>  <i>当充电连接器从电线上断开连接时，一系列相当“陡峭”的脉冲会从+19下降至+ 12V，反之亦然，甚至会出现“反弹”，这会通过电线的电容干扰其他笔记本电脑电路。</i> <i><br><br></i>  <i>但是，如果您不断开此连接器的连接，并从网络上断开充电，则不会发生任何不良情况。</i>  <i>显然，由于充电中的电容器，电线上的电压会缓慢下降，并且不会发生干扰。</i> <br><br> 我没有修复安装，但是总的来说，当然，不值得像我那样在电路板上铺设电线。 必须以某种方式将它们屏蔽或携带在笔记本电脑外部或至少远离主板。  （事实上​​，我所有的电线都具有恒定电压）。 <br> 在负号和正号之间增加了电容器C1，似乎1号毛刺消失了。 <br><br> 小故障2：无法通过按钮关闭笔记本电脑。 <br><br> 要正确关闭笔记本电脑，请先关闭电源（以防万一，从网络上而不是从笔记本电脑上断开充电，正如我们从以前的经验中了解到的那样）。 <br> 然后我们按下电源按钮。 操作系统将关闭并关闭笔记本电脑。 <br><br> 但是 此时，笔记本电脑中的USB电源电容器上仍然有电压（没有消耗设备），它慢慢坐下，在某个时候电路向按钮提供了错误的脉冲，笔记本电脑再次打开！ <br><br>  <i>为了防止这种情况的发生，添加了一个R2电阻器，该电阻器可以在一秒钟内对电容器放电，并且一切正常。</i>  <i>如果您遇到这样的问题，则应将电阻减小2倍。不值得将电阻做得太低，因为</i>  <i>他会晒太阳。</i> <i><br><br></i>  <i>这实际上不会增加​​能耗。</i> <br><br><h1> 操作系统和程序 </h1><br> 我安装了Ubuntu服务器14.04并配置了samba，一切正常，现在就足够了。 <br><br> 有以下缺点： <br><br>  1）不论处理器负载如何，笔记本电脑的风扇都非常嘈杂。 <br><br> 我尝试了fancontrol程序，但是她找不到对风扇控件的访问。 <br> 在挖掘Internet的过程中，发现了另一个程序：asusfan，这种人曾经专门为我的笔记本电脑机型设计。 它在编译和安装后立即工作，现在风扇自动调节且几乎没有噪音，并节省了资源。 <br><br>  2）使用hdparm -S 241 / dev / sda命令无法在一夜之间停止硬盘驱动器。 <br><br>  jbd2日志记录程序每5-10分钟“拉”一次，即使一个小时内未执行任何操作。 <br><br> 论坛写道，这是ext4文件系统或其在Ubuntu中的实现所无法解决的问题。 <br><br> 然后，我将尝试切换到xfs（或也许切换到SSD），但现在-“就这样！”（C）。 <br><br><h1> 进一步的想法（将保留在这个阶段） </h1><br><ul><li> 在“ GSM中继”之类的设备上建立独立电路以重启系统。 </li><li> 在同一GSM设备上，建立用于将USB闪存驱动器与“备份”系统远程连接的电路，以便在主系统无法启动的情况下，可以从该系统启动并修复配置中的某些内容。 </li></ul><br> 为什么要通过GSM，而不是以太网？ <br><br> 首先，由于以太网控制器可能存在漏洞，我听说某处。 <br> 其次，您可能需要重新启动路由器，即 需要一个独立的计划。 <br><br> 但是Mikrotik路由器在这方面非常可靠，因此实际上没有必要，并且服务器似乎也可以正常工作。 <br><br><h1> 致谢 </h1><br> 路由器帮助我（99％）配置了@rifei同志，为此，他非常感谢。 <br><br> 以及所有在Internet上编写了指令的人，例如“如何在ubuntu 14.04上运行程序”等，因为我自己是一个完整的茶壶，但是通过阅读100500这样的指令，我设法进行了所有设置。 <br><br> 对于那些制作和发布各种有用程序的人，分别在此处提到和未提及。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN479488/">https://habr.com/ru/post/zh-CN479488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN479474/index.html">为什么团队的自组织在Scrum中如此重要，为什么其中没有经理</a></li>
<li><a href="../zh-CN479478/index.html">Java插件轻松自如</a></li>
<li><a href="../zh-CN479480/index.html">SARIF SDK及其错误</a></li>
<li><a href="../zh-CN479482/index.html">SARIF SDK及其错误</a></li>
<li><a href="../zh-CN479486/index.html">异构编程和oneAPI工具包。 英特尔专家即兴演讲回答您的问题</a></li>
<li><a href="../zh-CN479492/index.html">基于OpenWhisk的无服务器计算，第3部分</a></li>
<li><a href="../zh-CN479496/index.html">用JavaScript解析WTF任务</a></li>
<li><a href="../zh-CN479498/index.html">线性时间如何以O（n²）变为Windows</a></li>
<li><a href="../zh-CN479502/index.html">如何度过地球历史上最严峻的冰河时代？</a></li>
<li><a href="../zh-CN479504/index.html">构建基于Raspberry Pi的RDP瘦客户端</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>