<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔋 🥝 🤽🏼 Bestimmen Sie mithilfe von Python voneinander abhängige Personen an Bord von Strukturen 💇 😫 📚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Definition von voneinander abhängigen Personen nach Art. 105.1 der Abgabenordnung der Russischen Föderation ist für einen Unternehmensanwalt eine eher...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bestimmen Sie mithilfe von Python voneinander abhängige Personen an Bord von Strukturen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462643/">  Definition von voneinander abhängigen Personen nach Art.  105.1 der Abgabenordnung der Russischen Föderation ist für einen Unternehmensanwalt eine eher triviale Aufgabe. <br><br>  Normalerweise ist dies unkompliziert und es scheint, warum gibt es etwas zu automatisieren? <br>  Das ist richtig, wenn eine Gesellschaft zwei oder drei ihre Zusammensetzung von Diabetes vergleichen, gibt es kein Problem.  Aber wenn es mehr als zwei Dutzend Unternehmen gibt und gleichzeitig verschiedene Unternehmen unterschiedliche Zusammensetzung der Direktoren haben, einschließlich der Anzahl der Mitglieder?  Hier muss man schon Zeit verbringen.  Wir werden es für ein Programm ausgeben, das für uns verbundene Parteien berechnet und die Zusammensetzung des Verwaltungsrates analysiert. <br><a name="habracut"></a><br><h3>  Einige Definitionen </h3><br>  Erinnern Sie sich daran, dass voneinander abhängige Personen durch eine Reihe von Kriterien bestimmt werden, die in der Abgabenordnung der Russischen Föderation festgelegt sind. <br><br>  In Absatz 2 der Kunst.  105.1 der Abgabenordnung der Russischen Föderation listet die Gründe auf, aus denen Personen als voneinander abhängig anerkannt werden.  Aus steuerlichen Gründen sind die verbundenen Parteien also: <br><br><ul><li>  Organisation, wenn eine Organisation direkt und (oder) indirekt an einer anderen Organisation teilnimmt und der Anteil dieser Beteiligung mehr als 25% beträgt; </li><li>  eine Person und eine Organisation für den Fall, dass eine solche Person direkt und (oder) indirekt an einer solchen Organisation teilnimmt und der Anteil dieser Beteiligung mehr als 25% beträgt; </li><li>  Organisationen, wenn dieselbe Person direkt und (oder) indirekt an diesen Organisationen teilnimmt und der Anteil dieser Beteiligung an jeder Organisation mehr als 25% beträgt; </li><li>  Organisation und Person (einschließlich einer Person zusammen mit ihrem Ehepartner (Ehepartner), Eltern (einschließlich Adoptiveltern), Kindern (einschließlich Adoptiveltern), Voll- und Halbbrüdern und -schwestern, Erziehungsberechtigten (Treuhändern) und Gemeinden) mit Autorität durch Ernennung (Wahl) des alleinigen Exekutivorgans dieser Organisation oder durch Ernennung (Wahl) von mindestens 50% der Zusammensetzung des kollegialen Exekutivorgans oder des Verwaltungsrates (Aufsichtsrat) dieser Organisation; </li><li>  Organisationen, deren alleinige Exekutivorgane oder mindestens 50% des kollegialen Exekutivorgans oder des Verwaltungsrates (Aufsichtsrat) durch Entscheidung derselben Person (Einzelperson zusammen mit ihrem Ehepartner), Eltern (einschließlich Adoptiveltern) ernannt oder gewählt werden ), Kinder (einschließlich Adoptivkinder), Voll- und Halbbrüder und -schwestern, Erziehungsberechtigte (Treuhänder) und Schutzzauber); </li><li>  Organisationen, in denen mehr als 50% des kollegialen Exekutivorgans oder des Verwaltungsrates (Aufsichtsrat) dieselben Personen sind, zusammen mit ihrem Ehepartner, ihren Eltern (einschließlich Adoptiveltern), ihren Kindern (einschließlich Adoptiveltern) und vollwertigen Personen und Halbbrüder und Halbschwestern, Wächter (Treuhänder) und Schutzzauber; </li><li>  Organisation und Person, die die Befugnisse ihres einzigen Exekutivorgans ausübt; </li><li>  Organisationen, in denen die Befugnisse des alleinigen Exekutivorgans von derselben Person ausgeübt werden; </li><li>  Organisationen und (oder) Einzelpersonen, falls der Anteil der direkten Beteiligung jeder vorherigen Person an jeder nachfolgenden Organisation mehr als 50% beträgt; </li><li>  Einzelpersonen für den Fall, dass eine Person aufgrund ihrer offiziellen Position einer anderen Person untergeordnet ist; </li><li>  eine Person, ihr Ehepartner, Eltern (einschließlich Adoptiveltern), Kinder (einschließlich Adoptiveltern), Halbbrüder und Halbbrüder und -schwestern, ein Vormund (Treuhänder) und eine Gemeinde. </li></ul><br><h3>  Komm auf den Punkt </h3><br>  Es gibt viele Gründe, aber wir interessieren uns für einen davon, nämlich: <br>  - Organisationen, in denen mehr als 50% des Verwaltungsrates dieselben Personen sind. <br><br>  Diese Grundlage unterscheidet sich vom Rest darin, dass der Anwalt die gesamte Zusammensetzung des Verwaltungsrates in den Unternehmen mit einem Zufall von mehr als 50% seiner Mitglieder vergleichen muss. <br><br>  Angenommen, die gesamte Zusammensetzung des Verwaltungsrates haben wir in einer Excel-Tabelle mit Verwaltungsräten und einer Gesamtzahl von Unternehmen über zwanzig zusammengefasst: <br><br><img src="https://habrastorage.org/webt/cq/y8/-v/cqy8-vehb5ayp88ktsypd5yzzfg.jpeg"><br><br>  Wir brauchen unser Programm, das der Tabelle folgt, um Unternehmen auszuwählen, wenn mehr als 50% der Gesamtzahl der Vorstandsmitglieder zusammenfallen.  Als nächstes sollte das Programm das Ergebnis entweder auf dem Bildschirm oder in einer Datei anzeigen. <br><br>  Logischerweise führt das Programm den folgenden Algorithmus aus.  Nachdem sie den Namen der Direktoren vom Benutzer erhalten hat, vergleicht sie diese mit jeder Excel-Zeile, die den Namen der Direktoren für jedes Unternehmen enthält.  Das heißt, alle drei von fünf Benutzer-SD-Mitgliedern werden mit jeweils drei von fünf in der Tabelle verglichen.  Zu diesem Zeitpunkt analysiert das Programm keine CDs mit mehr als 5 Mitgliedern und überspringt sie. <br><br>  Die ersten Zeilen unseres Programms werden Standard sein: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'sd3.xlsx'</span></span>) sheet=wb.get_active_sheet()</code> </pre> <br>  Hier haben wir das Modul für die Arbeit mit Excel importiert und die Datei mit unserer Tabelle geöffnet. <br><br>  Jetzt bieten wir dem Benutzer an, fünf Mitglieder des Verwaltungsrates einzutragen, die das Programm in Gesellschaften zum Vergleich weiter suchen wird.  Wir schreiben alle vom Benutzer eingegebenen Mitglieder des SD in die Variablen a, b, c, e, f: <br><br><pre> <code class="python hljs">a=str(input(<span class="hljs-string"><span class="hljs-string">"-1: "</span></span>)) b=str(input(<span class="hljs-string"><span class="hljs-string">"-2: "</span></span>)) c=str(input(<span class="hljs-string"><span class="hljs-string">"-3: "</span></span>)) e=str(input(<span class="hljs-string"><span class="hljs-string">"-4: "</span></span>)) f=str(input(<span class="hljs-string"><span class="hljs-string">"-5: "</span></span>))</code> </pre> <br>  Dies ist ein wichtiger Punkt.  Der Name des Direktors muss ohne Leerzeichen eingegeben werden, z. B. Ivanov I.I.  In derselben Form müssen die vollständigen Namen der Direktoren in der Excel-Tabelle vorhanden sein. <br><br>  Lassen Sie uns zwei Listen erstellen.  Einer ist leer, der zweite ist bei Gesellschaften, in denen der Verwaltungsrat mehr als 5 Mitglieder hat: <br><br><pre> <code class="python hljs">found = [] found2=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">31</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>] <span class="hljs-comment"><span class="hljs-comment">#    sd3,   5 . h = open('55555.txt','a')</span></span></code> </pre> <br>  Wir haben auch die Textdatei 55555.txt geöffnet, in der wir die Ergebnisse speichern. Die Übereinstimmung des SD um mehr als 50% bedeutet, dass 3 von 5 Mitgliedern übereinstimmen müssen.  Das Programm sollte also 10 Überprüfungen auf übereinstimmende Namen durchführen.  So viele Kombinationen können für Diabetes von 5 Mitgliedern sein. <br><br>  Um den gleichen Code nicht zehnmal zu schreiben, was das Programm umständlich macht, erstellen wir eine Funktion und rufen sie dann zehnmal auf (führen sie aus). <br><br><h3>  Ladefunktion </h3><br>  Hier ist unsere Funktion: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myfun</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x,y,z)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rowOfCellObjects <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'B2'</span></span>:<span class="hljs-string"><span class="hljs-string">'L36'</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cellObj <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rowOfCellObjects: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cellObj.value ==<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-comment"><span class="hljs-comment">#print (cellObj) if cellObj.value == x: for cellObj in rowOfCellObjects: if cellObj.value == y: for cellObj in rowOfCellObjects: if cellObj.value == z: d = list(cellObj.coordinate) d[0]='A' dd=d[0]+d[1] if len(d)&gt;2: dd=d[0]+d[1]+d[2] i=sheet[str(dd)].value #   ,   3-  q = cellObj.row if i not in found and i not in found2: found.append(i) h.write (str(i)+'\n')</span></span></code> </pre> <br>  Lassen Sie uns den Code analysieren. <br><br>  Wir legen die Grenzen der Tabelle für B2: L36 fest.  Wenn die Zelle leer ist, wird sie übersprungen. <br><br>  Als nächstes berücksichtigt die Funktion den Namen des 1. Direktors. Wenn der Name in der Zelle dem vom Benutzer eingegebenen Namen entspricht, geht die Funktion weiter und vergleicht den 2. und dann den 3. Direktor.  Am Ende bildet die Funktion eine Liste von Unternehmen und schreibt jedes von ihnen in die Datei 55555.txt. <br>  Nachdem eine Funktion geschrieben wurde, wird sie vom Programm nicht automatisch ausgeführt. <br><br>  Es muss heißen: <br><br><pre> <code class="python hljs">myfun(a,b,c)</code> </pre> <br>  Aber hier haben wir die Funktion nur für die ersten drei Direktoren aufgerufen.  Für die restlichen Kombinationen muss der Funktionsaufruf wiederholt werden: <br><br><pre> <code class="python hljs">myfun(a,b,e) myfun(a,b,f) myfun(a,e,f) myfun(a,c,e) myfun(a,c,f) myfun(b,c,e) myfun(b,c,f) myfun(b,e,f) myfun(c,e,f) h.close()</code> </pre> <br><h3>  Wir starten </h3><br>  Führen Sie das Programm aus und geben Sie im Python-Interpreter-Fenster 5 Namen von Direktoren ein <br>  diejenigen, die mindestens einmal in der Excel-Tabelle gefunden werden: <br><br><img src="https://habrastorage.org/webt/xr/pq/et/xrpqetknvczch5ss1nl3pcqc0ia.jpeg"><br><br>  Schauen Sie sich nach der Ausführung des Programms die Datei an, die das Programm erstellen wird. <br>  55555.txt: <br><br><img src="https://habrastorage.org/webt/ep/cu/rv/epcurvh9yvzpgjvkkgysn1wkyme.jpeg"><br><br>  In der Datei - Nummern der Unternehmen, in denen Übereinstimmungen gefunden wurden.  Es ist zu beachten, dass dies Gesellschaftsnummern aus Spalte A sind, keine Excel-Zeilennummern: <br><br><img src="https://habrastorage.org/webt/1c/vm/xu/1cvmxuo-g6ng65995mohw6abzck.jpeg"><br><br>  Das Programm ist fertig, aber es muss beachtet werden, dass es die Zusammensetzung des Vorstands mit Mitgliedern von mehr als 5 Personen nicht analysiert! <br><br>  Laden Sie hier den Programmcode herunter. <br><br>  Laden Sie hier die Testkarte herunter. <br><br>  PS: Alle Übereinstimmungen in der Tabelle mit echten Persönlichkeiten sind zufällig. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462643/">https://habr.com/ru/post/de462643/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462619/index.html">Kinder, Mathe und R.</a></li>
<li><a href="../de462625/index.html">Dell G5 5590: eines der günstigsten Gaming-Laptops mit RTX 2060</a></li>
<li><a href="../de462631/index.html">Web Weekend: Intensive Netology Intensive Website-Entwicklung</a></li>
<li><a href="../de462635/index.html">Quanten oder hin und zurück: Ein neuer Algorithmus zur Untersuchung des quantenklassischen Übergangs</a></li>
<li><a href="../de462641/index.html">52 Merkmale des idealen Produktmanagers</a></li>
<li><a href="../de462649/index.html"># 18 Mosdroid Argon - Bericht</a></li>
<li><a href="../de462653/index.html">LTE als Symbol der Unabhängigkeit</a></li>
<li><a href="../de462655/index.html">Geben Sie Ihren Code schließlich ein</a></li>
<li><a href="../de462657/index.html">SkyRC B6 Nano Ladegerät Bewertung & Test</a></li>
<li><a href="../de462659/index.html">Erste Schritte mit dem PVS-Studio Static Analyzer für die C ++ - Entwicklung unter Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>