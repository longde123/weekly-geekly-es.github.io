<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéä üë©üèæ‚Äçüè´ ‚ô†Ô∏è Reloj de cuco basado en tormentas mentales de Lego üíÖüèΩ üìô ü§∞üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace dos a√±os y medio compr√© el kit Lego Mindstorms EV3 para dar mis primeros pasos en rob√≥tica. Despu√©s de enrollar el conjunto ev3dev en el controla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reloj de cuco basado en tormentas mentales de Lego</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417255/">  Hace dos a√±os y medio compr√© el kit Lego Mindstorms EV3 para dar mis primeros pasos en rob√≥tica.  Despu√©s de enrollar el conjunto ev3dev en el controlador y jugar lo suficiente con el motor SSH y el control del sensor, me enfr√≠√© para comprarlo durante dos a√±os.  La raz√≥n era que no ten√≠a suficiente imaginaci√≥n para hacerlo posible: despu√©s de varios modelos ensamblados de Lego Technics (tanto en caja como caseros), ya estaba acostumbrado a los milagros como juguetes controlados a distancia y robots simples como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los modelos de Lego</a> presentados en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">exposici√≥n de Cracovia,</a> como una persona que sol√≠a trabajar en un sistema de telemec√°nica, ya no inspiraban suficiente inspiraci√≥n.  Realmente no quer√≠a repetir la experiencia de otro. <br><br>  Al final, me di cuenta: un reloj de cuco podr√≠a convertirse en un modelo bastante complejo, interesante, pr√°ctico y no demasiado trillado.  Inspirado por esta idea, me puse manos a la obra. <br><a name="habracut"></a><br>  Seg√∫n mi idea, el modelo se convertir√≠a no solo en un juguete, sino en un dispositivo totalmente funcional.  Esto era completamente posible: el reloj se cuelga en mi pared y muestra la hora actual en modo 24/7.  No me propuse la tarea de reproducir el mecanismo del original en todos los detalles; por ejemplo, las flechas son independientes, el sonido se reproduce a trav√©s del altavoz del controlador y los pesos y el p√©ndulo se usan exclusivamente para el entorno.  Tras haber transferido, por lo tanto, todo el trabajo principal a la parte del software, ensambl√© el mecanismo en la versi√≥n m√°s simple posible.  No document√© todo el proceso de ensamblaje, por lo que no puedo ensamblar el modelo nuevamente de la misma forma;  Sin embargo, los principios b√°sicos del software y la mec√°nica de emparejamiento son tales que el programa deber√≠a funcionar con modificaciones m√≠nimas en otros modelos ensamblados de acuerdo con un principio similar. <br><br>  Los relojes en varias formas se presentan en el video que publiqu√© en Youtube: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rCxNfV3xOM0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  La informaci√≥n b√°sica sobre el modelo se presenta en el video.  A continuaci√≥n, le contar√© con un poco m√°s de detalle sobre la mec√°nica, el software y los problemas que surgieron durante el ensamblaje y la operaci√≥n de este dise√±o. <br><br><h2>  La mecanica </h2><br>  El montaje de la parte mec√°nica tom√≥ 6 d√≠as.  Despu√©s de colocar las cajas de Lego sobre la mesa, durante las vacaciones de A√±o Nuevo, arm√© un mecanismo que difiere de la versi√≥n final solo en las puertas detr√°s de las cuales vive el cuco (m√°s sobre esto a continuaci√≥n).  No tengo habilidades especiales de dise√±o, por lo que el reloj es una caja rectangular con dos manos y una esfera marcada con puntos en la parte frontal.  En la parte superior del reloj hay un compartimento cerrado por dos puertas, en el que se ha asentado el cuco, y en la parte inferior hay un p√©ndulo esquem√°tico y dos pesas.  Se tomaron piezas de varios juegos de Lego: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lego Mindstorms EV3 (31313)</a> , dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">motoniveladoras Volvo (42030)</a> , un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cami√≥n Mercedes con pluma neum√°tica (42043)</a> y una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gr√∫a (42009)</a> .  A pesar de la abundancia de juegos, apenas hab√≠a suficientes detalles para un modelo de este tama√±o: la cubierta del reloj est√° ensamblada a partir de tiras de diferentes colores, lo que, sin embargo, no llama la atenci√≥n, ya que con una instalaci√≥n montada en la pared est√° por encima del nivel del ojo. <br><br>  Como minutero, se usa la barra est√°ndar de Lego Technics para 15 unidades.  Se coloca en el eje, conect√°ndolo firmemente al motor.  Por lo tanto, la precisi√≥n de configurar la manecilla de minutos result√≥ ser suficiente para que pudiera usarse para determinar el tiempo exacto en minutos.  La manecilla de la hora es m√°s corta y est√° montada en un mecanismo giratorio.  Est√° conectado al motor a trav√©s de varios engranajes, por lo que hay una reacci√≥n bastante notable, sin embargo, no es tan grande como para causar problemas para determinar el tiempo. <br><br>  Las manecillas son accionadas por dos motores grandes (LM).  Adem√°s, emparejado con cada una de las manecillas externas, otra funciona, la interna: para la manecilla de minutos, se fija en el mismo eje que la primera, y para el reloj, el mecanismo giratorio se duplica en el interior del reloj.  El prop√≥sito de las flechas internas es presionar el bot√≥n (sensor t√°ctil) mientras se pasan las flechas externas por la posici√≥n superior.  Por lo tanto, el controlador tiene la capacidad de determinar la posici√≥n de las flechas inmediatamente despu√©s de encender, y establecer su posici√≥n correcta en funci√≥n de la hora del sistema, evitando que el usuario tenga que ingresar manualmente las flechas. <br><br>  Las pesas tienen una funci√≥n puramente decorativa.  Inicialmente, pens√© en hacer un peso, que bajar√≠a lentamente (como en un reloj normal), y luego subir√≠a r√°pidamente a la posici√≥n superior (an√°logo al devanado manual de un reloj de p√©ndulo).  Posteriormente rechac√© esta opci√≥n por varias razones.  En primer lugar, el mecanismo de cambio de la relaci√≥n de transmisi√≥n entre el motor y el peso agreg√≥ una complejidad adicional al modelo (y el accionamiento del p√©ndulo desde el mismo motor solo lo aument√≥).  En segundo lugar, un delineador r√°pido, sea lo que sea que se diga, ser√° una operaci√≥n ruidosa, pero quer√≠a que el reloj funcionara lo m√°s silenciosamente posible.  En tercer lugar, en un reloj de cuco convencional, generalmente hay dos pesos (uno proporciona el reloj, el segundo, el cuco), y colocar en la parte inferior del reloj inmediatamente dos ruedas giratorias para la cadena conducir√≠a a un aumento a√∫n mayor en el tama√±o del modelo. <br><br>  Partiendo de esto, tom√© un camino m√°s simple: en realidad instal√© dos pesas en el reloj, pero las coloqu√© en un circuito com√∫n lanzado sobre una sola rueda motriz.  En esta versi√≥n, los pesos siempre se mueven en direcciones contra el clima, descendiendo a su vez.  Este comportamiento tiene poco que ver con los relojes de p√©ndulo reales, pero parece bastante interesante. <br><br>  La cadena est√° hecha de adornos ordinarios de tres unidades que usan una combinaci√≥n de ejes y pistones: un pist√≥n deslizante es una pieza bastante rara, y utilic√© los ejes para duplicar la longitud de la cadena resultante.  No fue tan f√°cil hacer una rueda que mueva dicha cadena sin deslizamiento y aver√≠as, pero al final, fue posible. <br><br>  En cuanto a cambiar la direcci√≥n de movimiento de las pesas, mi primera idea fue hacerlo puramente mec√°nico: cuando se levanta a la pared inferior de la caja del reloj, el eje ancho montado directamente sobre el peso presiona la placa a trav√©s de la cual pasa la cadena y hace que la rueda gire.  Iba a utilizar el elemento de conmutaci√≥n de la misma manera que, por ejemplo, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gr√∫a 42009</a> : la rueda motriz, que cambia, entra en el embrague con el vecino derecho o izquierdo.  Sin embargo, esta idea no funcion√≥: la placa de presi√≥n llev√≥ la parte deslizante a la posici√≥n central cuando no estaba enganchada con el vecino derecho o izquierdo, el par de torsi√≥n dej√≥ de llegar a la rueda y el interruptor se congel√≥ en la posici√≥n central. <br><br>  Para corregir esta situaci√≥n, decid√≠ agregar un tri√°ngulo m√≥vil a este circuito, cuyos dos lados tendr√≠an una longitud fija, y el tercero estar√≠a representado por una parte deslizante con resorte utilizada en la suspensi√≥n de la misma gr√∫a.  El significado de este dise√±o era que el tri√°ngulo siempre est√° en el lado del panel de presi√≥n que corresponde al peso de elevaci√≥n: cuando el peso alcanza la parte superior, el panel presiona el tri√°ngulo, el resorte se comprime, el tri√°ngulo pasa a trav√©s de la posici√≥n de equilibrio y luego "tira" al otro lado, liberando energ√≠a almacenada por un resorte.  Se supon√≠a que esta energ√≠a, seg√∫n mi plan, desplazar√≠a el interruptor de velocidad a la posici√≥n de equilibrio, traduci√©ndolo inmediatamente a la posici√≥n opuesta. <br><br>  Sin embargo, no pude estabilizar este sistema.  Por el tama√±o del reloj, puedes entender que los mecanismos en miniatura no son lo m√≠o, pero con un aumento en el tama√±o del nudo, las distorsiones que surgen en √©l conducen a la fricci√≥n, que consume la mayor parte de la energ√≠a de conmutaci√≥n.  Despu√©s de haber sido atormentado con este mecanismo, finalmente decid√≠ trasladar todo el trabajo sucio al microcontrolador instalando un bot√≥n sobre los paneles de presi√≥n (sensor t√°ctil) en lugar de la mec√°nica compleja. <br><br>  Un poco de aritm√©tica simple.  El EV3 tiene cuatro entradas y cuatro salidas.  Dos entradas y dos salidas ya estaban ocupadas por botones y motores de flecha, respectivamente.  Agregar a este circuito un motor que gira la rueda de la cadena y dos botones significaba que, en primer lugar, no ten√≠a puertos libres para conectar el sensor de posici√≥n del cuco (pens√© usar un medidor de distancia √≥ptico para este prop√≥sito), y en segundo lugar, que Los nodos restantes (cuco y p√©ndulo) tienen un solo motor.  Pens√© en la opci√≥n en la que ambos paneles de presi√≥n sobre los pesos se conectar√≠an a un bot√≥n com√∫n, pero lo rechac√©, porque si al momento de encender el reloj uno de los pesos estar√≠a en la posici√≥n superior, manteniendo presionado el bot√≥n, el reloj no tendr√≠a suficiente informaci√≥n para seleccionar Direcci√≥n de movimiento de la cadena. <br><br>  Como el p√©ndulo era m√°s f√°cil de asociar con el mecanismo de movimiento de la cadena que con el cuco (tanto en t√©rminos de su naturaleza de movimiento como de ubicaci√≥n), coloqu√© otro motor grande en la parte inferior del cuerpo, que, en primer lugar, impulsa el p√©ndulo hacia adelante y hacia atr√°s (1 revoluci√≥n del motor se traduce en un giro completo del p√©ndulo), y en segundo lugar, a trav√©s de un engranaje de reducci√≥n, gira la rueda, que impulsa la cadena.  Tal sistema tiene la desventaja de que al invertir la direcci√≥n del movimiento de la cadena y, en consecuencia, la rotaci√≥n del motor, el p√©ndulo tambi√©n cambia la direcci√≥n del movimiento, incluso si est√° en una posici√≥n intermedia, que puede parecer fea.  Sin embargo, cambiar la direcci√≥n del movimiento de las pesas es una operaci√≥n bastante rara, por lo que descuid√© este problema.  Otro inconveniente de mi ensamblaje es el juego bastante reemplazable en la unidad de p√©ndulo, por lo que cuando se mueve lentamente, el p√©ndulo se detiene en un punto inferior durante una fracci√≥n de segundo para un ojo notable.  Fui demasiado vago para solucionar este problema. <br><br>  Hablando de la velocidad del p√©ndulo.  Despu√©s de experimentar con √©l, eleg√≠ un valor de 30 grados del motor por segundo.  Esto significa que el p√©ndulo oscila completamente en 12 segundos.  Sin embargo, esto es mucho, a medida que aumenta la velocidad, el motor comenz√≥ a aullar y la posibilidad de escuchar continuamente su canci√≥n no me sonr√≠e en absoluto.  Era demasiado flojo pasar por el mecanismo e introducir una sobremarcha, as√≠ que me decid√≠ por un formato tan "lunar".  Las relaciones de transmisi√≥n entre el motor y la rueda de transmisi√≥n de la cadena son tales que el peso pasa de la posici√≥n inferior a la superior en 40-50 minutos. <br><br>  Permaneciendo libre despu√©s de todas las manipulaciones anteriores, el puerto EV3 ocup√≥ el motor central (motor medio), que impulsa al cuco.  El cuco en s√≠ est√° ensamblado a partir de partes de la misma t√©cnica de Lego.  En altura, el ave alcanza las 11 unidades y se coloca en una barra retr√°ctil (en estos en la gr√∫a de cami√≥n mencionada anteriormente, se colocaron paradas remotas).  Un mecanismo en miniatura introduce una transmisi√≥n entre las alas del p√°jaro y su cola, a trav√©s de la cual lanc√© un cable fijo dentro del reloj.  La longitud del cable se elige de modo que el cuco se vaya completamente con las alas hacia abajo y solo al final del movimiento se separ√≥ ligeramente.  Result√≥ atmosf√©rico, justo al nivel de la mecanizaci√≥n de los modelos de relojes simples.  La ausencia de un sensor de posici√≥n se compensa con el hecho de que el accionamiento del cuco se enciende a trav√©s del engranaje deslizante; ayuda a no da√±ar el motor, incluso si intenta mover el cuco m√°s all√° de los puntos l√≠mite.  Las puertas est√°n firmemente conectadas al tabl√≥n en el que se fija el p√°jaro, y se abren simult√°neamente con la salida del cuco. <br><br>  Inicialmente, utilic√© 11 por 5 para paneles de 1 unidad como puertas, pero result√≥ ser una mala idea: sus bordes no estaban redondeados, y las puertas, que se aferraban a partes adyacentes, a menudo se bloqueaban, dejando el cuco adentro.  El video muestra la segunda versi√≥n del ensamblaje de la puerta: los adornos comunes con bordes redondeados no causan tal problema.  Adem√°s, la versi√≥n de "tabl√≥n" de la puerta se abre y cierra mucho m√°s silenciosamente. <br><br>  El reloj est√° montado en una correa atornillada a la pared.  Toda la estructura pesa m√°s de un kilogramo. <br><br>  Sobre esto, la descripci√≥n de la parte mec√°nica, en principio, termina.  Solo queda mencionar que el modelo est√° 100% ensamblado de Lego Mindstorms y Lego Technics, y la √∫nica parte que no se aplica a estos kits es el cable de alimentaci√≥n, que solde a mi EV3, para no tener que cambiar las bater√≠as todo el tiempo.  Este cable va a la fuente de alimentaci√≥n conectada a la toma de corriente. <br><br><h2>  El programa </h2><br>  El ensamblado ev3dev proporciona carpetas para muchos lenguajes de programaci√≥n.  Para no tener dificultades con el ensamblaje, decid√≠ limitarme a un script de Python.  Este script est√° disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el repositorio de GitLab</a> .  A continuaci√≥n, explicar√© brevemente su funcionalidad. <br><br>  El c√≥digo que mueve las flechas es relativamente simple: recalcula los minutos y las horas en los grados de rotaci√≥n de los motores utilizando datos sobre el n√∫mero de grados del motor por revoluci√≥n de la flecha y el desplazamiento inicial de la flecha desde la posici√≥n vertical.  Toda la diversi√≥n comienza cuando el programa intenta obtener estos datos. <br><br>  Como ya dije, se decidi√≥ abandonar la conexi√≥n manual del tirador.  En cambio, al inicio, el reloj realiza la calibraci√≥n determinando los par√°metros de geometr√≠a.  La calibraci√≥n se realiza para ambas manos independientemente una de la otra. <br><br>  El algoritmo de calibraci√≥n es el siguiente.  Primero, el motor comienza a girar a una velocidad relativamente alta (uso un valor emp√≠rico de 180 grados por segundo) hasta que llega una se√±al de confirmaci√≥n desde el bot√≥n que fija la posici√≥n superior de la flecha.  Despu√©s de eso, el motor restablece la velocidad a 30 grados por segundo y contin√∫a girando la flecha en el sentido de las agujas del reloj (la direcci√≥n de rotaci√≥n del motor se cose en el programa) hasta que se separa del punto de la √∫ltima apertura del bot√≥n en 70 grados.  Despu√©s de eso, la flecha pasa a trav√©s de la posici√≥n superior en la direcci√≥n opuesta, fijando el primer cierre y la √∫ltima apertura de los contactos (el bot√≥n puede traquetear en las posiciones de los bordes).  Alej√°ndose de la √∫ltima abertura en los mismos 70 grados, la flecha cambia nuevamente la direcci√≥n del movimiento a la l√≠nea recta, y se repite el procedimiento para registrar el primer circuito y el √∫ltimo circuito. <br><br>  Se cree que la posici√≥n superior de la flecha corresponde a la media aritm√©tica entre los cuatro valores as√≠ obtenidos.  La pr√°ctica muestra que esta aproximaci√≥n es bastante buena: la desviaci√≥n de la posici√≥n objetivo de la manecilla de minutos con respecto a la real rara vez es m√°s de 1 paso y casi nunca excede los dos pasos.  (El video muestra desviaciones m√°s significativas debido al hecho de que con el prop√≥sito de disparar traduje la hora del sistema, y ‚Äã‚Äãlas manecillas se movieron m√°s r√°pido que durante la operaci√≥n normal, aumentando el error de correcci√≥n en cada revoluci√≥n, ver m√°s abajo). Para el juego en el sentido de las agujas del reloj, el contragolpe consume precisi√≥n, pero el algoritmo, por supuesto, usa el mismo. <br><br>  Despu√©s de calcular la posici√≥n superior de la flecha y la diferencia entre el primer encendido del sensor y en realidad la posici√≥n superior de la flecha (este valor ser√° necesario para la correcci√≥n, ver m√°s abajo), el algoritmo de calibraci√≥n aumenta nuevamente la velocidad del motor a 180 grados por segundo y repite la b√∫squeda de la posici√≥n superior.  La diferencia entre dos posiciones superiores consecutivas determina la longitud de un giro completo de la flecha en unidades de rotaci√≥n del motor.  El procedimiento de b√∫squeda de la posici√≥n superior se repite cinco veces, lo que nos permite promediar los valores obtenidos y aumentar ligeramente la precisi√≥n. <br><br>  Una vez completada la calibraci√≥n, las manecillas pasan al modo de visualizaci√≥n de la hora actual.  Adem√°s, en cada c√≠rculo de la flecha, el algoritmo fija la posici√≥n en la que el interruptor autom√°tico se cerr√≥ por primera vez.  La diferencia entre los √°ngulos de rotaci√≥n real y esperado del motor en este momento es la cantidad de correcci√≥n;  Por lo tanto, incluso si la longitud del c√≠rculo completo no se calcul√≥ correctamente en la etapa de calibraci√≥n (la salida de depuraci√≥n muestra que la desviaci√≥n rara vez excede 1 grado), la correcci√≥n en cada c√≠rculo no permite que la flecha se mueva debido a la acumulaci√≥n de errores. <br><br>  Tenga en cuenta que la √∫nica informaci√≥n sobre la relaci√≥n del motor y la flecha, que se cose expl√≠citamente en el programa, es la direcci√≥n de rotaci√≥n del motor (hacia adelante o hacia atr√°s) correspondiente al movimiento hacia adelante de la flecha.  Gracias a los sensores de posici√≥n, desaparece la necesidad de datos sobre la relaci√≥n de transmisi√≥n y la posici√≥n inicial de la flecha.  Por lo tanto, si recolecta un reloj para el cual, adem√°s de la hora y los minutos, tambi√©n se presentar√° una manecilla de segundos, el algoritmo le permitir√° usarlo agregando solo unas pocas l√≠neas, sin perder tiempo contando los dientes. <br><br>  Lo que falta en el programa de movimiento de flecha es protecci√≥n contra desbordamiento o p√©rdida de precisi√≥n.  No investigu√© la cuesti√≥n de lo que suceder√° antes: la profundidad de bits del √°ngulo de rotaci√≥n del motor se desbordar√°, o las flechas comenzar√°n a moverse bruscamente debido a la salida de precisi√≥n en los d√≠gitos m√°s altos del n√∫mero de punto flotante.  Sin embargo, la pr√°ctica muestra que en momentos del orden de varias semanas, no sucede nada como esto.  Si alguna vez encuentro este problema, lo m√°s probable es que solo agregue un comando de reinicio del motor en cada vuelta, con la correcci√≥n correspondiente de los √°ngulos en el programa. <br><br>  Si la clase Hand en mi programa es responsable del movimiento de las flechas, entonces la clase LedIndication se ilumina y luego apaga los LED del panel frontal del EV3.  S√© que se puede lograr el mismo efecto con un equipo, pero inicialmente esta caracter√≠stica fue dise√±ada para rastrear bloqueos de programas, y luego se mantuvo.  No hay nada m√°s interesante en esta clase. <br><br>  La clase Pendulum es responsable del movimiento de pesas y un p√©ndulo.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El algoritmo simplemente arranca el motor en una direcci√≥n y lo gira a una velocidad constante hasta que se aprieta el bot√≥n correspondiente a la elevaci√≥n completa de este peso; despu√©s de eso, se invierte la direcci√≥n del movimiento del motor. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En esta clase, por cierto, se presenta protecci√≥n contra bloqueos del programa, que consiste en el hecho de que el motor se enciende durante solo 2 segundos con un per√≠odo de actualizaci√≥n de comando de 1 segundo. Si encend√≠ el motor en modo de rotaci√≥n constante, cuando el programa se bloque√≥, descansar sobre el bot√≥n continuar√≠a movi√©ndose hacia arriba, lo que podr√≠a conducir a una sobrecarga del motor, a un engranaje deslizante o incluso a da√±ar el mecanismo. La protecci√≥n le permite evitar este problema.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalmente, la clase Cuckoo ejecuta el cuco cada vez que un valor de 59 minutos se reemplaza por un valor de 0 minutos. Primero, se empuja el cuco hasta el fondo, luego el cuco una vez, reproduce el sonido a trav√©s del altavoz EV3 y luego se esconde nuevamente en la caja del reloj. El movimiento se repite de acuerdo con la hora actual, de 1 a 12 veces. El sonido fue tomado de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioteca gratuita de FreeSound</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y editado para que suene mejor en EV3. (No puedo decir que estaba satisfecho con el resultado, porque el bajo es casi inaudible cuando se golpea el martillo en la primavera).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La demora entre el comando de eliminaci√≥n de cuco y el comando de reproducci√≥n de sonido se selecciona experimentalmente para que el sonido se escuche aproximadamente en el momento en que el cuco alcanza su posici√≥n extrema. Sin embargo, ev3dev tiene un peque√±o problema con esto: debido a la carga del sistema, el sonido se retrasa peri√≥dicamente, especialmente si hay una conexi√≥n SSH con el reloj en ese momento. El retraso puede ser de hasta varios segundos. No estoy seguro de si esto es un problema con mi controlador, la compilaci√≥n en s√≠ misma o las actualizaciones recibidas de la red (despu√©s de instalar ev3dev, por costumbre utilic√© el comando apt get upgrade, aunque probablemente no deber√≠a haberlo hecho), pero en promedio el cuco suena normal, as√≠ que No voy a depurar esta pregunta.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por cierto, se conect√≥ un error con el retraso del sonido en una de las primeras versiones del programa, cuando a√∫n no hab√≠a agregado la expectativa del final de la reproducci√≥n: si el cuco logr√≥ esconderse y reaparecer durante el tiempo de retraso, el siguiente sonido fue "tragado", y el n√∫mero de "cucos" no coincidi√≥ cantidad de horas M√°s tarde, modifiqu√© el programa para que el cuco esperara que el sonido terminara en la posici√≥n extrema y solo luego se fue para el pr√≥ximo ciclo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los intervalos de media hora son expresados ‚Äã‚Äãpor una sola se√±al obtenida del mismo sonido original. El cuco no aparece.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La velocidad de rotaci√≥n del motor que impulsa al cuco y el √°ngulo de rotaci√≥n est√°n cosidos en el programa. Al comienzo del programa, el cuco se mete en la caja, teniendo en cuenta el engranaje deslizante instalado en el eje del motor, esta operaci√≥n es segura, pero tiene efecto si el cuco estaba fuera de la caja en el momento en que comenz√≥ el reloj. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para no interferir con el sue√±o, el cuco cuco solo durante el d√≠a. Su d√≠a de trabajo comienza a las diez de la ma√±ana, y la √∫ltima vez que dice es a medianoche. Tambi√©n apagu√© el cuco en un momento en que tengo llamadas semanales de trabajo en Skype, para no interferir.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El programa se instala como un servicio y se inicia cuando se inicia Debian. </font><font style="vertical-align: inherit;">Por lo tanto, es suficiente para encender el reloj, y ellos mismos lo hacen todo m√°s lejos. </font><font style="vertical-align: inherit;">Se toma tiempo de Internet: en mi EV3 hay un dongle WiFi. </font><font style="vertical-align: inherit;">Despu√©s de que el reloj ha comenzado, generalmente desconecto la red, para no crear una carga adicional en el procesador. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El programa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° disponible bajo la licencia BSD. </font><font style="vertical-align: inherit;">Si desea construir un modelo similar y utilizar mi software, me alegrar√©.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417255/">https://habr.com/ru/post/es417255/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417243/index.html">Instale 3CX SBC Session Edge Controller en Windows, Raspberry Pi o Debian 9</a></li>
<li><a href="../es417245/index.html">Erlang para IoT</a></li>
<li><a href="../es417247/index.html">VSCE # 1: Podcast de emprendedores de medios</a></li>
<li><a href="../es417249/index.html">La C√°mara de Auditor√≠a de EE. UU. Advierte: SpaceX y Boeing est√°n esperando nuevas demoras, es posible la interrupci√≥n de EE. UU. En los vuelos a la EEI</a></li>
<li><a href="../es417251/index.html">Usando el ojo de pez en Raspberry Pi 3 con ROS - Parte 1</a></li>
<li><a href="../es417259/index.html">Eventos digitales en Mosc√∫ del 16 al 22 de julio.</a></li>
<li><a href="../es417261/index.html">Uber despu√©s de un accidente que involucr√≥ a su autom√≥vil rob√≥tico decidi√≥ reducir el personal de los operadores de m√°quinas inteligentes en Pittsburgh</a></li>
<li><a href="../es417263/index.html">JavaScript como la encarnaci√≥n del mal</a></li>
<li><a href="../es417265/index.html">Top 10: los mejores informes de DotNext 2017 Mosc√∫</a></li>
<li><a href="../es417269/index.html">D√≥nde ir para un dise√±ador: prestigiosos premios internacionales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>