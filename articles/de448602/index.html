<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ä üê∞ üçè Ist die √úberwachung tot? - Es lebe die √úberwachung üôã üïû üë®üèª‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seit 2008 besch√§ftigt sich unser Unternehmen haupts√§chlich mit Infrastrukturmanagement und technischem Support rund um die Uhr f√ºr Webprojekte: Wir ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ist die √úberwachung tot? - Es lebe die √úberwachung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/448602/"><img src="https://habrastorage.org/webt/rb/6a/wf/rb6awfy_oiasqde7kja4h39oczm.jpeg"><br><br>  Seit 2008 besch√§ftigt sich unser Unternehmen haupts√§chlich mit Infrastrukturmanagement und technischem Support rund um die Uhr f√ºr Webprojekte: Wir haben mehr als 400 Kunden, was etwa 15% des E-Commerce in Russland entspricht.  Dementsprechend wird eine sehr vielf√§ltige Architektur unterst√ºtzt.  Wenn etwas f√§llt, m√ºssen wir es innerhalb von 15 Minuten reparieren.  Um zu verstehen, dass ein Unfall aufgetreten ist, m√ºssen Sie das Projekt √ºberwachen und auf Vorf√§lle reagieren.  Wie geht das? <br><br>  Ich glaube, dass die Organisation des richtigen √úberwachungssystems in Schwierigkeiten ist.  Wenn es keine Probleme gab, bestand meine Rede aus einer These: "Bitte installieren Sie Prometheus + Grafana und die Plugins 1, 2, 3."  Leider funktioniert das jetzt nicht.  Und das Hauptproblem ist, dass jeder weiterhin an etwas glaubt, das 2008 in Bezug auf Softwarekomponenten existierte. <br><br>  In Bezug auf die Organisation des √úberwachungssystems riskiere ich zu sagen, dass ... Projekte mit kompetenter √úberwachung nicht existieren.  Und die Situation ist so schlimm, wenn etwas f√§llt, dass die Gefahr besteht, dass es unbemerkt bleibt - jeder ist sich sicher, dass ‚Äûalles √ºberwacht wird‚Äú. <br>  Vielleicht wird alles √ºberwacht.  Aber wie? <br><br>  Wir alle sind auf eine √§hnliche Geschichte gesto√üen: Ein bestimmter Entwickler, ein bestimmter Administrator arbeitet, ein Entwicklungsteam kommt zu ihnen und sagt: "Wir haben es, jetzt wird es √ºberwacht."  Welcher Monitor?  Wie funktioniert es <br><br>  Ok  Wir √ºberwachen den altmodischen Weg.  Aber es √§ndert sich bereits und es stellt sich heraus, dass Sie Service A √ºberwacht haben, der zu Service B wurde, der mit Service C interagiert. Aber das Entwicklungsteam sagt zu Ihnen: "Software installieren, es muss alles √ºberwachen!" <br><br>  Was hat sich also ge√§ndert?  - Alles hat sich ge√§ndert! <br><a name="habracut"></a><br><h4>  2008 Jahr.  Alles ist gut </h4><br>  Es gibt einige Entwickler, einen Server und einen Datenbankserver.  Ab hier geht alles.  Wir haben einige Informationen, wir setzen Zabbix, Nagios, Kakteen.  Und dann setzen wir klare Warnungen auf der CPU, auf den Betrieb der Festplatten, auf die Stelle auf den Festplatten.  Wir f√ºhren auch einige manuelle √úberpr√ºfungen durch, um sicherzustellen, dass die Site antwortet, dass Bestellungen in die Datenbank eingehen.  Und das war's - wir sind mehr oder weniger gesch√ºtzt. <br><br>  Wenn wir den Arbeitsaufwand vergleichen, den der Administrator dann geleistet hat, um die √úberwachung sicherzustellen, war dies zu 98% automatisch: Die Person, die √ºberwacht, sollte verstehen, wie Zabbix installiert, konfiguriert und Warnungen konfiguriert werden.  Und 2% - f√ºr externe √úberpr√ºfungen: dass die Site antwortet und eine Anfrage an die Datenbank sendet, dass neue Bestellungen eingegangen sind. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/846/5ae/a65/8465aea65cdf10015bb2aad7eff7ebf6.png"><br><br><h4>  2010 Jahr.  Die Last w√§chst </h4><br>  Wir beginnen das Web zu skalieren und f√ºgen eine Suchmaschine hinzu.  Wir m√∂chten sicherstellen, dass der Produktkatalog alle Produkte enth√§lt.  Und diese Produktsuche funktioniert.  Dass die Datenbank funktioniert, dass Bestellungen get√§tigt werden, dass die Site extern reagiert und von zwei Servern antwortet und der Benutzer nicht aus der Site geworfen wird, w√§hrend er auf einen anderen Server umstellt usw.  Es gibt mehr Entit√§ten. <br><br>  Dar√ºber hinaus bleibt die mit der Infrastruktur verbundene Einheit die gr√∂√üte im Kopf des Managers.  Trotzdem liegt mir die Idee im Kopf, dass die Person, die √ºberwacht, die Person ist, die zabbix installiert und konfigurieren kann. <br><br>  Gleichzeitig werden externe √úberpr√ºfungen durchgef√ºhrt, eine Reihe von Skripten zum Abfragen des Suchindexers erstellt, eine Reihe von Skripten, um zu √ºberpr√ºfen, ob sich die Suche w√§hrend des Indizierungsprozesses √§ndert, eine Reihe von Skripten, mit denen √ºberpr√ºft wird, ob Waren an den Lieferservice √ºbertragen werden usw.  usw. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45c/974/24c/45c97424c842cf539e79b900b903437d.png"><br><br>  Hinweis: Ich habe dreimal ein ‚ÄûSkript-Set‚Äú geschrieben.  Das hei√üt, die Person, die f√ºr die √úberwachung verantwortlich ist, ist nicht mehr die Person, die nur zabbix installiert.  Dies ist die Person, die mit dem Codieren beginnt.  In den K√∂pfen des Teams hat sich jedoch noch nichts ge√§ndert. <br><br>  Aber die Welt ver√§ndert sich und wird immer komplizierter.  Als Virtualisierungsschicht werden mehrere neue Systeme hinzugef√ºgt.  Sie beginnen miteinander zu interagieren.  Wer hat gesagt, "riecht nach Microservices?"  Aber jeder Dienst sieht immer noch einzeln aus wie eine Site.  Wir k√∂nnen uns an ihn wenden und verstehen, dass er die notwendigen Informationen herausgibt und von selbst arbeitet.  Und wenn Sie ein Administrator sind, der st√§ndig an einem Projekt beteiligt ist, das sich seit 5-7-10 Jahren entwickelt, haben Sie dieses Wissen gesammelt: Eine neue Ebene erscheint - Sie haben es erkannt, eine andere Ebene erscheint - Sie haben es erkannt ... <br><br><img src="https://habrastorage.org/webt/tc/we/qe/tcweqem6jjpldcpovhhoklgt3kq.png"><br><br>  Aber selten begleitet jemand das Projekt 10 Jahre lang. <br><br><h3>  Zusammenfassung der Mann√ºberwachung </h3><br>  Angenommen, Sie sind zu einem neuen Startup gekommen, das sofort 20 Entwickler bewertet, 15 Microservices geschrieben hat, und Sie sind der Administrator, dem gesagt wird: ‚ÄûErstellen Sie ein CI / eine CD.  Bitte. "  Sie haben eine CI / CD erstellt und pl√∂tzlich h√∂ren Sie: "Es ist schwierig f√ºr uns, mit der Produktion im" Cube "zu arbeiten, ohne zu verstehen, wie die Anwendung darin funktionieren wird.  Machen Sie uns einen Sandkasten im selben "W√ºrfel". <br>  In diesem W√ºrfel erstellen Sie eine Sandbox.  Sie sagen Ihnen sofort: "Wir wollen eine B√ºhnendatenbank, die jeden Tag aus der Produktion aktualisiert wird, um zu verstehen, dass sie in der Datenbank funktioniert, aber die Produktionsdatenbank nicht ruiniert." <br><br>  Du lebst in allem.  Es sind noch 2 Wochen bis zur Ver√∂ffentlichung, sagen sie dir: "Jetzt w√ºrde alles √ºberwacht werden ..." Das hei√üt  √úberwachen der Cluster-Infrastruktur, √úberwachen der Microservice-Architektur, √úberwachen der Arbeit mit externen Diensten ... <br><br>  Und Kollegen nehmen ein so bekanntes Schema aus dem Kopf und sagen: ‚ÄûHier ist also alles klar!  Installieren Sie ein Programm, das alles √ºberwacht. ‚Äú  Ja: Prometheus + Grafana + Plugins. <br>  Und sie f√ºgen gleichzeitig hinzu: "Sie haben zwei Wochen Zeit, um sicherzustellen, dass alles zuverl√§ssig ist." <br><br>  In dem Haufen von Projekten, die wir sehen, wird eine Person f√ºr die √úberwachung zugewiesen.  Stellen Sie sich vor, wir m√∂chten eine Person f√ºr 2 Wochen einstellen, um sie zu √ºberwachen, und wir schreiben ihr einen Lebenslauf.  Welche F√§higkeiten sollte diese Person besitzen - angesichts all dessen, was wir zuvor gesagt haben? <br><br><ul><li>  Er muss die √úberwachung und die Besonderheiten der Arbeit der Eiseninfrastruktur verstehen. </li><li>  Er muss die Besonderheiten der √úberwachung von Kubernetes verstehen (und jeder m√∂chte einen ‚ÄûCube‚Äú, weil Sie alles ignorieren, verstecken k√∂nnen, weil der Administrator es herausfinden wird) - selbst, seine Infrastruktur und verstehen, wie Anwendungen darin √ºberwacht werden. </li><li>  Er muss verstehen, dass Dienste auf besondere Weise miteinander kommunizieren, und die Besonderheiten der Interaktion von Diensten untereinander kennen.  Es ist ziemlich realistisch, ein Projekt zu sehen, bei dem einige der Dienste synchron kommunizieren, da es keinen anderen Weg gibt.  Beispielsweise geht das Backend auf REST, auf gRPC an den Katalogdienst, empf√§ngt eine Warenliste und kehrt zur√ºck.  Sie k√∂nnen hier nicht warten.  Und mit anderen Diensten funktioniert es asynchron.  √úbertragen Sie die Bestellung an den Lieferservice, senden Sie einen Brief usw. <br>  Sie sind wahrscheinlich schon von all dem gesegelt?  Und der Administrator, der dies √ºberwachen muss, schwamm noch mehr. </li><li>  Er muss in der Lage sein, richtig zu planen und zu planen - da die Arbeit immer mehr wird. </li><li>  Er muss daher aus dem erstellten Dienst eine Strategie erstellen, um zu verstehen, wie dieser spezifisch √ºberwacht werden kann.  Er braucht ein Verst√§ndnis der Architektur des Projekts und seiner Entwicklung + Verst√§ndnis der in der Entwicklung verwendeten Technologien. </li></ul><br>  Erinnern wir uns an einen absolut normalen Fall: Teil der Dienste in PHP, Teil der Dienste in Go, Teil der Dienste in JS.  Sie arbeiten irgendwie untereinander.  Daher kommt der Begriff ‚ÄûMicroservice‚Äú: Es gibt so viele separate Systeme, dass Entwickler das Projekt als Ganzes nicht verstehen k√∂nnen.  Ein Teil des Teams schreibt Dienste in JS, die eigenst√§ndig funktionieren und nicht wissen, wie der Rest des Systems funktioniert.  Der andere Teil schreibt Dienste in Python und geht nicht auf die Funktionsweise anderer Dienste ein, sondern ist in ihrem Bereich isoliert.  Drittens - schreibt Dienste in PHP oder etwas anderem. <br>  Alle diese 20 Personen sind in 15 Dienste unterteilt, und es gibt nur einen Administrator, der dies alles verstehen sollte.  H√∂r auf!  Wir haben das System nur in 15 Microservices aufgeteilt, da 20 Personen das gesamte System nicht verstehen k√∂nnen. <br><br>  Aber es muss irgendwie √ºberwacht werden ... <br><br>  Was ist das Ergebnis?  Infolgedessen gibt es eine Person, die alles enth√§lt, was ein ganzes Entwicklerteam nicht verstehen kann, und dennoch muss sie wissen und in der Lage sein, was wir oben angegeben haben - Eiseninfrastruktur, Kubernetes-Infrastruktur usw. <br><br>  Was soll ich sagen ... Houston, wir haben Probleme. <br><br><h3>  Die √úberwachung eines modernen Softwareprojekts ist ein Softwareprojekt f√ºr sich </h3><br>  Aus der falschen √úberzeugung heraus, dass √úberwachung Software ist, glauben wir an Wunder.  Aber Wunder geschehen leider nicht.  Sie k√∂nnen zabbix nicht installieren und warten, bis alles funktioniert.  Es macht keinen Sinn, Grafana zu setzen und zu hoffen, dass alles in Ordnung ist.  Die meiste Zeit wird f√ºr die Organisation von √úberpr√ºfungen des Betriebs von Diensten und deren Interaktion untereinander sowie f√ºr die √úberpr√ºfung der Funktionsweise externer Systeme aufgewendet.  Tats√§chlich werden 90% der Zeit nicht f√ºr das Schreiben von Skripten, sondern f√ºr die Softwareentwicklung aufgewendet.  Und es sollte ein Team sein, das die Arbeit des Projekts versteht. <br>  Wenn in dieser Situation eine Person zur √úberwachung geworfen wird, treten Probleme auf.  Was √ºberall passiert. <br><br>  Beispielsweise gibt es mehrere Dienste, die √ºber Kafka miteinander kommunizieren.  Eine Bestellung kam, wir schickten eine Nachricht √ºber die Bestellung an Kafka.  Es gibt einen Service, der Informationen √ºber die Bestellung abh√∂rt und den Warenversand ausf√ºhrt.  Es gibt einen Dienst, der Informationen √ºber die Bestellung abh√∂rt und einen Brief an den Benutzer sendet.  Und dann gibt es immer noch eine Reihe von Diensten, und wir beginnen, verwirrt zu werden. <br><br>  Und wenn Sie es dem Administrator und den Entwicklern zu einem Zeitpunkt noch geben, an dem noch eine kurze Zeit bis zur Ver√∂ffentlichung verbleibt, muss eine Person das gesamte Protokoll verstehen.  Das hei√üt,  Ein Projekt dieser Gr√∂√üenordnung nimmt viel Zeit in Anspruch, und dies sollte in die Entwicklung des Systems einbezogen werden. <br>  Aber sehr oft, besonders beim Brennen, sehen wir in Startups, wie die √úberwachung bis sp√§ter verschoben wird.  ‚ÄûJetzt werden wir den Proof of Concept machen, wir werden damit beginnen, ihn fallen lassen - wir sind bereit zu opfern.  Und dann werden wir alles √ºberwachen. ‚Äú  Wenn (oder wenn) das Projekt anf√§ngt, Geld zu verdienen, m√∂chte das Unternehmen noch mehr Funktionen k√ºrzen - weil es funktioniert hat, m√ºssen Sie also weiter gehen!  Und Sie sind an dem Punkt angelangt, an dem Sie am Anfang alles vorher √ºberwachen m√ºssen, was nicht 1% der Zeit in Anspruch nimmt, sondern viel mehr.  √úbrigens m√ºssen Entwickler √ºberwacht werden, und es ist einfacher, sie in neue Funktionen zu integrieren.  Infolgedessen werden neue Funktionen geschrieben, alles ist abgeschlossen und Sie befinden sich in einem endlosen Stillstand. <br><br>  Wie √ºberwachen Sie ein Projekt von Anfang an und was ist, wenn Sie ein Projekt haben, das Sie √ºberwachen m√ºssen, aber nicht wissen, wo Sie anfangen sollen? <br><br>  Zuerst m√ºssen Sie planen. <br><br>  <i>Lyrischer Exkurs: Beginnen Sie sehr oft mit der √úberwachung der Infrastruktur.</i>  <i>Zum Beispiel haben wir Kubernetes.</i>  <i>Zun√§chst stellen wir Prometheus mit Grafana zusammen und stellen die Plugins unter die √úberwachung des "W√ºrfels".</i>  <i>Nicht nur Entwickler, sondern auch Administratoren haben eine ungl√ºckliche Praxis: "Wir werden dieses Plug-In installieren, und das Plug-In wei√ü wahrscheinlich, wie das geht."</i>  <i>Die Leute beginnen lieber mit einfachen und verst√§ndlichen als mit wichtigen Handlungen.</i>  <i>Die √úberwachung der Infrastruktur ist einfach.</i> <br><br>  Entscheiden Sie zuerst, was und wie Sie √ºberwachen m√∂chten, und nehmen Sie dann das Instrument in die Hand, da andere Personen nicht f√ºr Sie denken k√∂nnen.  Ja und sollten sie?  Andere Leute dachten sich, √ºber das universelle System - oder dachten √ºberhaupt nicht, als dieses Plugin geschrieben wurde.  Und die Tatsache, dass dieses Plugin 5.000 Benutzer hat, bedeutet nicht, dass es irgendeinen Nutzen bringt.  Vielleicht werden Sie der 5001., einfach weil vorher schon 5.000 Menschen dort waren. <br><br>  Wenn Sie mit der √úberwachung der Infrastruktur begonnen haben und das Backend Ihrer Anwendung nicht mehr reagiert, verlieren alle Benutzer den Kontakt zur mobilen Anwendung.  Ein Fehler wird herausfliegen.  Sie werden zu Ihnen kommen und sagen: "Die Anwendung funktioniert nicht, was machen Sie hier?"  "Wir √ºberwachen."  - "Wie √ºberwachen Sie, wenn Sie nicht sehen, dass die Anwendung nicht funktioniert ?!" <br><br><ol><li>  Ich glaube, dass es notwendig ist, die √úberwachung vom Einstiegspunkt des Benutzers aus zu starten.  Wenn der Benutzer nicht sieht, dass die Anwendung funktioniert, ist dies ein Fehler.  Und das √úberwachungssystem sollte in erster Linie davor warnen. </li><li>  Und nur dann k√∂nnen wir die Infrastruktur √ºberwachen.  Oder mach es parallel.  Die Infrastruktur ist einfacher - hier k√∂nnen wir endlich einfach zabbix installieren. </li><li>  Und jetzt m√ºssen Sie zu den Wurzeln der Anwendung gehen, um zu verstehen, wo dies nicht funktioniert. </li></ol><br>  Mein Hauptgedanke ist, dass die √úberwachung parallel zum Entwicklungsprozess erfolgen sollte.  Wenn Sie das √úberwachungsteam f√ºr andere Aufgaben (Erstellen eines CI / CD, Sandboxes, Reorganisieren der Infrastruktur) abrei√üen, verz√∂gert sich die √úberwachung und Sie werden m√∂glicherweise nie mit der Entwicklung Schritt halten (oder fr√ºher oder sp√§ter muss sie gestoppt werden). <br><br><h3>  Alles nach Ebenen </h3><br>  So sehe ich die Organisation des √úberwachungssystems. <br><br>  1) Anwendungsebene: <br><ul><li>  √úberwachung der Gesch√§ftslogik der Anwendung; </li><li>  √úberwachung der Gesundheitsmetriken von Diensten; </li><li>  Integrations√ºberwachung. </li></ul><br>  2) Infrastrukturebene: <br><ul><li>  √úberwachung des Orchestrierungsniveaus; </li><li>  √úberwachungssystemsoftware; </li><li>  √úberwachung des Eisengehalts. </li></ul><br>  3) Nochmals die Anwendungsebene - aber als Engineering-Produkt: <br><ul><li>  Sammeln und √úberwachen von Anwendungsprotokollen; </li><li>  APM </li><li>  R√ºckverfolgung. </li></ul><br>  4) Warnung: <br><ul><li>  Organisation eines Warnsystems; </li><li>  Organisation eines Uhrensystems; </li><li>  Organisation einer "Wissensdatenbank" und Workflow-Incident-Verarbeitung. </li></ul><br>  <b>Wichtig</b> : Wir werden nicht erst, sondern sofort benachrichtigt!  Es ist nicht notwendig, mit der √úberwachung zu beginnen und ‚Äûirgendwie sp√§ter‚Äú herauszufinden, wer Benachrichtigungen erhalten wird.  Was ist schlie√ülich die √úberwachungsaufgabe: zu verstehen, wo etwas im System nicht funktioniert, und die richtigen Leute dar√ºber zu informieren.  Wenn dies bis zum Ende bleibt, werden die richtigen Leute herausfinden, dass etwas schief geht, nur indem sie "nichts funktioniert f√ºr uns" nennen. <br><br><h3>  Anwendungsschicht - √úberwachung der Gesch√§ftslogik </h3><br>  Hier geht es darum zu √ºberpr√ºfen, ob die Anwendung f√ºr den Benutzer funktioniert. <br><br>  Diese Stufe sollte in der Entwurfsphase durchgef√ºhrt werden.  Zum Beispiel haben wir einen bedingten Prometheus: Er kriecht zu dem Server, der √úberpr√ºfungen durchf√ºhrt, zieht den Endpunkt und der Endpunkt √ºberpr√ºft die API. <br><br>  Wenn Programmierer h√§ufig aufgefordert werden, die Hauptseite zu √ºberwachen, um sicherzustellen, dass die Site funktioniert, geben sie einen Stift, der jedes Mal gezogen werden kann, wenn Sie sicherstellen m√∂chten, dass die API funktioniert.  Und Programmierer nehmen und schreiben derzeit noch / api / test / helloworld <br>  Nur so kann sichergestellt werden, dass alles funktioniert?  - Nein! <br><br><ul><li>  Das Erstellen solcher Pr√ºfungen ist im Wesentlichen Aufgabe der Entwickler.  Unit-Tests sollten von Programmierern geschrieben werden, die Code schreiben.  Denn wenn Sie dies mit dem Administrator zusammenf√ºhren "Alter, hier ist eine Liste der API-Protokolle f√ºr alle 25 Funktionen, bitte √ºberwachen Sie alles!"  - Nichts wird funktionieren. </li><li>  Wenn Sie "Hallo Welt" drucken, wird niemand jemals wissen, dass die API funktionieren sollte und wirklich funktioniert.  Jede √Ñnderung an der API sollte zu einer √Ñnderung der Pr√ºfungen f√ºhren. </li><li>  Wenn Sie bereits eine solche Katastrophe haben, stoppen Sie die Funktionen und w√§hlen Sie die Entwickler aus, die diese Pr√ºfungen ausstellen oder mit den Verlusten abgleichen. Stellen Sie ab, dass nichts gepr√ºft wird und fallen wird. </li></ul><br>  Technische Tipps: <br><br><ul><li>  Stellen Sie sicher, dass Sie einen externen Server f√ºr die Organisation von Inspektionen organisieren. Sie m√ºssen sicherstellen, dass Ihr Projekt f√ºr die Au√üenwelt zug√§nglich ist. </li><li>  Organisieren Sie die Validierung √ºber das gesamte API-Protokoll, nicht nur √ºber einzelne Endpunkte. </li><li>  Erstellen Sie einen Prometheus-Endpunkt mit Testergebnissen. </li></ul><br><h3>  Anwendungsebene - √úberwachung von Integrit√§tsmetriken </h3><br>  Jetzt sprechen wir √ºber externe Gesundheitsmetriken von Diensten. <br><br>  Wir haben beschlossen, alle ‚ÄûStifte‚Äú der Anwendung mithilfe externer √úberpr√ºfungen zu √ºberwachen, die wir von einem externen √úberwachungssystem aufrufen.  Dies sind jedoch genau die ‚ÄûStifte‚Äú, die der Benutzer ‚Äûsieht‚Äú.  Wir m√∂chten sichergehen, dass die Dienstleistungen selbst f√ºr uns funktionieren.  Hier ist eine bessere Geschichte: K8s hat Gesundheitspr√ºfungen, damit zumindest der Cube sicherstellt, dass der Dienst funktioniert.  Aber die H√§lfte der Schecks, die ich gesehen habe, ist der gleiche Druck ‚ÄûHallo Welt‚Äú.  Das hei√üt,  Hier zieht er einmal nach dem Einsatz, er antwortete ihm, dass alles in Ordnung ist - und das war's.  Und der Dienst verf√ºgt, wenn er √ºber eine eigene API verf√ºgt, √ºber eine gro√üe Anzahl von Einstiegspunkten f√ºr dieselbe API, die ebenfalls √ºberwacht werden m√ºssen, da wir wissen m√∂chten, dass er funktioniert.  Und wir √ºberwachen es bereits im Inneren. <br><br>  So implementieren Sie es technisch korrekt: Jeder Dienst legt einen Endpunkt f√ºr seine aktuelle Leistung fest. In den Diagrammen von Grafana (oder einer anderen Anwendung) wird der Status aller Dienste angezeigt. <br><br><ul><li>  Jede √Ñnderung an der API sollte zu einer √Ñnderung der Pr√ºfungen f√ºhren. </li><li>  Erstellen Sie sofort einen neuen Service mit Integrit√§tsmetriken. </li><li>  Der Administrator kann zu den Entwicklern kommen und fragen: "F√ºgen Sie mir einige Funktionen hinzu, damit ich alles verstehe und meinem √úberwachungssystem Informationen dazu hinzuf√ºge."  Entwickler antworten jedoch normalerweise: "Wir werden zwei Wochen vor der Ver√∂ffentlichung nichts hinzuf√ºgen." <br>  Lassen Sie die Entwicklungsmanager wissen, dass es solche Verluste geben wird, lassen Sie die Chefs der Entwicklungsmanager auch wissen.  Denn wenn alles f√§llt, wird immer noch jemand anrufen und verlangen, den "st√§ndig fallenden Dienst" zu √ºberwachen (c) </li><li>  W√§hlen Sie √ºbrigens Entwickler aus, die Plugins f√ºr Grafana schreiben - dies ist eine gute Hilfe f√ºr Administratoren. </li></ul><br><h3>  Anwendungsschicht - Integrations√ºberwachung </h3><br>  Die Integrations√ºberwachung konzentriert sich auf die √úberwachung der Kommunikation zwischen gesch√§ftskritischen Systemen. <br><br>  Zum Beispiel gibt es 15 Dienste, die miteinander kommunizieren.  Dies sind keine einzelnen Websites mehr.  Das hei√üt,  Wir k√∂nnen den Dienst nicht alleine abrufen, / helloworld erhalten und verstehen, dass der Dienst funktioniert.  Da der Webservice f√ºr die Bestellung Informationen √ºber die Bestellung an den Bus senden muss, sollte der Lagerservice diese Nachricht vom Bus empfangen und weiter damit arbeiten.  Und der E-Mail-Verteilungsdienst sollte dies irgendwie weiter erledigen usw. <br><br>  Dementsprechend k√∂nnen wir bei jedem einzelnen Service nicht verstehen, dass dies alles funktioniert.  Weil wir einen bestimmten Bus haben, √ºber den alles kommuniziert und interagiert. <br>  Daher sollte in dieser Phase die Phase des Testens von Diensten f√ºr die Interaktion mit anderen Diensten angegeben werden.  Nachdem Sie einen Nachrichtenbroker √ºberwacht haben, k√∂nnen Sie die √úberwachung der Kommunikation nicht organisieren.  Wenn es einen Dienst gibt, der Daten ausgibt, und einen Dienst, der sie empf√§ngt, werden bei der √úberwachung eines Brokers nur Daten angezeigt, die von einer Seite zur anderen fliegen.  Selbst wenn wir es irgendwie geschafft haben, die Interaktion dieser Daten im Inneren zu √ºberwachen - dass ein Produzent die Daten ver√∂ffentlicht, jemand sie liest, dieser Stream weiterhin an Kafka geht -, gibt er uns immer noch keine Informationen, wenn ein Dienst eine Nachricht in einer Version gab, aber Ein anderer Dienst hat diese Version nicht erwartet und √ºbersprungen.  Wir werden davon nichts erfahren, da die Dienste uns mitteilen werden, dass alles funktioniert. <br><br>  Wie ich empfehle: <br><br><ul><li>  F√ºr die synchrone Kommunikation: Der Endpunkt f√ºhrt Anforderungen f√ºr verwandte Dienste aus.  Das hei√üt,  Wir nehmen diesen Endpunkt, ziehen das Skript innerhalb des Dienstes, das zu allen Punkten f√ºhrt und sagt: "Ich kann dort ziehen und dort ziehen, ich kann ziehen ..." </li><li>  F√ºr asynchrone Kommunikation: Eingehende Nachrichten - Der Endpunkt √ºberpr√ºft den Bus auf Testnachrichten und zeigt den Verarbeitungsstatus an. </li><li>  F√ºr asynchrone Kommunikation: ausgehende Nachrichten - Endpunkt sendet Testnachrichten an den Bus. </li></ul><br>  Wie √ºblich: Wir haben einen Dienst, der Daten auf den Bus wirft.  Wir kommen zu diesem Service und bitten Sie, √ºber den Integrationszustand zu sprechen.  Und wenn der Dienst eine Nachricht irgendwo weiter verkaufen muss (WebApp), wird diese Testnachricht erstellt.  Und wenn wir den Service auf der OrderProcessing-Seite abrufen, ver√∂ffentlicht er zuerst etwas, das er unabh√§ngig ver√∂ffentlichen kann, und wenn es abh√§ngige Dinge gibt, liest er eine Reihe von Testnachrichten vom Bus, versteht, dass er sie verarbeiten, melden und melden kann , wenn n√∂tig, poste sie weiter und dar√ºber sagt er - alles ist in Ordnung, ich lebe. <br><br>  Sehr oft h√∂ren wir die Frage: "Wie k√∂nnen wir dies an Kampfdaten testen?"  Zum Beispiel sprechen wir √ºber den gleichen Bestellservice.  Die Bestellung sendet Nachrichten an das Lager, in dem die Waren abgeschrieben werden: Wir k√∂nnen dies nicht an den Kampfdaten testen, da "meine Waren abgeschrieben werden!"  Beenden: Planen Sie in der Anfangsphase den gesamten Test.  Sie haben Unit-Tests, die verspotten.  Tun Sie es also auf einer tieferen Ebene, wo Sie einen Kommunikationskanal haben, der dem Gesch√§ft keinen Schaden zuf√ºgt. <br><br><h3>  Infrastrukturebene </h3><br>  Die √úberwachung der Infrastruktur wird seit langem als √úberwachung selbst angesehen. <br><br><ul><li>  Die √úberwachung der Infrastruktur kann und sollte als separater Prozess gestartet werden. </li><li>  Sie sollten zun√§chst nicht die Infrastruktur eines Arbeitsprojekts √ºberwachen, auch wenn Sie dies wirklich m√∂chten.  Dies ist eine Wunde f√ºr alle Entwickler.  "Zuerst √ºberwache ich den Cluster, dann die Infrastruktur" - d. H.  Zun√§chst wird √ºberwacht, was darunter liegt, aber es wird nicht in die Anwendung geklettert.  Weil die Anwendung f√ºr den Devopa unverst√§ndlich ist.  Sie haben es ihm zugespielt, und er versteht nicht, wie es funktioniert.  Und er versteht die Infrastruktur und beginnt damit.  Aber nein - Sie m√ºssen die Anwendung immer zuerst √ºberwachen. </li><li>     .    ,   ,       - .   on-call,     ,  ¬´    ¬ª.       . </li></ul><br><h3>    - </h3><br>  : <br><br><ul><li> ELK.   .   -     ,    . </li><li> APM.  APM       (NewRelic, BlackFire, Datadog).      ,   - ,    . </li><li> Tracing.       ,         .    ,     tracing   ‚Äî     .     ‚Äì ! . Jaeger/Zipkin </li></ul><br><h3>  </h3><br><ul><li>   :           .   Grafana.     PagerDuty.     (,   ‚Ä¶).   ,     </li><li>   :      (    ,     ). Oncall    :    ,       ,       ,   ‚Äî     (          ‚Äî  , :         ,  ).  ,     ‚Äî    (¬´   ‚Äî    ¬ª),    . </li><li>  ¬´ ¬ª  workflow  :        ,        ,   .   ,    ‚Äî  ;        . </li></ul><br><h3>   </h3><br>  ,     : <br><br><ul><li>   ‚Äî Prometheus + Grafana; </li><li>   ‚Äî ELK; </li><li>  APM  Tracing ‚Äî Jaeger (Zipkin). </li></ul><br><img src="https://habrastorage.org/webt/tv/xl/3i/tvxl3isq0zhn8tfkeqermj9tuko.png"><br><br>   .  ,     ,      ,         .   ,     .  , , ,     ‚Äî       . <br><br>   ,       : <br><br> <i>Prometheus   Kubernetes ‚Äî   ?!</i>     ,    ?      ,        ,   ‚Äî ,      . <br><br> <i>       .</i>      .    ,   Promtheus,   ,    ,      .             ? ,     ,      . <br><br><h3>  Schlussfolgerungen </h3><br><ul><li>   ‚Äî   ,    . 98%   ‚Äî  .   ,   ,   ,  --. </li><li>      :     30%  ,   . </li><li> ,  ,      - ,     ‚Äî     .    ,    ‚Äî   . </li><li>        (  ) ‚Äî    . </li><li>     ,   ,   ¬´ ¬ª ‚Äî    ,      . </li></ul><br> <i>      Saint Highload++.</i> <br><br> UPD (       ): <br><br> 1.  ,   ,  ,   ¬´,  ,    ,   ¬ª. ,   :  DevOps    ,     ‚Äî   , ,  ,  . <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Ich versuche nicht anzudeuten, sie sagen: "Alles ist √ºberall schlecht, aber hier k√∂nnen wir Sie √ºberwachen - kommen Sie zu ITSumma." </font><font style="vertical-align: inherit;">Nein, wenn das Projekt gestartet wird, kann die √úberwachung nicht von einem Drittunternehmen durchgef√ºhrt werden. </font><font style="vertical-align: inherit;">Nat√ºrlich haben wir auch Gesch√§ftsziele, und wir denken wirklich daran, eine Beratung einzuf√ºhren, um das Projekt im Entwicklungsprozess zu unterst√ºtzen und zu vermitteln, wie der √úberwachungsteil der Entwicklung ordnungsgem√§√ü durchgef√ºhrt werden kann.</font></font><br><br>  Wenn du an meinen Ideen und Gedanken dazu interessiert bist und so weiter, dann kannst du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Kanal lesen</a> :-) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de448602/">https://habr.com/ru/post/de448602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de448584/index.html">7 h√§ufige Fehler bei der Verwendung von Pr√§positionen in Englisch und wie man sie vermeidet</a></li>
<li><a href="../de448588/index.html">Die Architektur des Netzwerklastenausgleichs in Yandex.Cloud</a></li>
<li><a href="../de448590/index.html">Bekannte Fremde oder noch einmal √ºber die Verwendung von Designmustern</a></li>
<li><a href="../de448594/index.html">Kostenlose Antiviren- und Firewalls (UTM, NGFW) von Sophos</a></li>
<li><a href="../de448596/index.html">Tablet-Halter auf dem Laufband oder suchen Sie nach freien Schritten</a></li>
<li><a href="../de448604/index.html">Gameboy in C #</a></li>
<li><a href="../de448606/index.html">Sidorin: Bei KnowledgeConf geht es darum, wie Wissen mit einer durchschnittlichen Arbeitsdauer an einem Ort in 2-3 Jahren aufrechterhalten werden kann</a></li>
<li><a href="../de448608/index.html">Wie mache ich die ersten Schritte in der Robotik?</a></li>
<li><a href="../de448610/index.html">DIY: Wie wir einen Live-Zeitplan f√ºr Codefest X erstellt haben</a></li>
<li><a href="../de448612/index.html">Was beim Feature Freeze 2019 eingefroren wurde. Teil I. JSONPath</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>