<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèº‚Äçü§ù‚Äçüßëüèº üë©üèª‚Äçüî¨ üë©üèª‚Äçüöí Detec√ß√£o de cores de carros usando redes neurais e TensorFlow üèÆ üë∏üèø üòó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√°, meu nome √© Roman Lapin, sou aluno do segundo ano do corpo docente da Escola Superior de F√≠sica Geral e Aplicada da UNN. Este ano, consegui conclu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Detec√ß√£o de cores de carros usando redes neurais e TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/422689/"><img src="https://habrastorage.org/webt/ay/jz/uv/ayjzuvpfvae66prncupgndyiwpc.jpeg"><br><br>  Ol√°, meu nome √© Roman Lapin, sou aluno do segundo ano do corpo docente da Escola Superior de F√≠sica Geral e Aplicada da UNN.  Este ano, consegui concluir a sele√ß√£o e participar do trabalho da Intel Summer School em Nizhny Novgorod.  Minha tarefa era determinar a cor do carro usando a biblioteca Tensorflow, na qual trabalhei com meu mentor e engenheiro da equipe de ICV Alexei Sidnev. <br>  E √© isso que eu tenho. <br><a name="habracut"></a><br>  Existem v√°rios aspectos para esta tarefa: <br><br><ol><li>  O carro pode ser pintado em v√°rias cores, como no KDPV.  E em um dos conjuntos de dados, por exemplo, t√≠nhamos um carro camuflado. </li><li>  Dependendo da ilumina√ß√£o e da c√¢mera que tira fotos do que est√° acontecendo na estrada, os carros da mesma cor ter√£o uma apar√™ncia muito diferente.  Os carros "iluminados" podem ter uma parte muito pequena correspondente √† cor "verdadeira" do carro. </li></ol><br><h2>  <font color="#0071c5">Detec√ß√£o de cor do carro</font> </h2><br>  A cor do carro √© uma subst√¢ncia bastante estranha.  O fabricante tem uma compreens√£o clara da cor do carro que produz, por exemplo: fantasma, gelo, p√©rola negra, plut√£o, lim√£o, cript√¥nio, angkor, cornalina, platina, blues.  A pol√≠cia de tr√¢nsito tem uma opini√£o sobre as cores dos carros, bastante conservadoras e muito limitadas.  Cada pessoa tem uma percep√ß√£o subjetiva da cor (voc√™ pode se lembrar da hist√≥ria popular sobre a cor do vestido).  Assim, decidimos marcar da seguinte maneira. <br><br>  Em cada imagem, as coordenadas dos v√©rtices dos ret√¢ngulos adjacentes ao redor dos carros foram marcadas (daqui em diante vou usar a vers√£o em ingl√™s - <i>caixa delimitadora do carro</i> ) e dentro delas est√£o as √°reas que melhor descrevem a cor dos ve√≠culos ( <i>caixa de cores</i> ).  O n√∫mero deste √∫ltimo √© igual √† cor do carro ( <i>n</i> x <i>caixa de cores</i> - n-color car). <br><br>  Daqui em diante, os n√∫meros dos carros s√£o borrados pela possibilidade de publicar fotos em dom√≠nio p√∫blico. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/p7/z5/mhp7z5aebrmyfhgw-cack-fm8zi.png" alt="imagem"></div><br>  <i>Conjunto de dados de marca√ß√£o de carros</i> <br><br>  No futuro, trabalhamos com dois espa√ßos de cores - RGB e LAB - com as classes 8 e 810/81, respectivamente.  Para comparar os resultados de diferentes abordagens, usamos 8 classes em RGB para determinar a cor, que √© obtida dividindo o cubo BGR em 8 cubos pequenos iguais.  Eles podem ser facilmente chamados de nomes comuns: branco, preto, vermelho, verde, azul, rosa, amarelo, ciano.  Para avaliar o erro de qualquer m√©todo, j√° usamos o espa√ßo de cores LAB, no qual a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dist√¢ncia</a> entre as cores √© determinada. <br><br>  Existem duas maneiras intuitivas de determinar cor por <i>caixa de cor</i> : <i>cor</i> m√©dia ou mediana.  Mas na <i>caixa de cores</i> existem pixels de v√°rias cores, ent√£o eu queria saber com que precis√£o cada uma dessas duas abordagens funciona. <br><br>  Para 8 cores RGB para cada <i>caixa de cores de</i> cada m√°quina no conjunto de dados, determinamos a cor e a mediana m√©dias dos pixels, os resultados s√£o mostrados nas figuras abaixo.  As cores "verdadeiras" s√£o marcadas nas linhas - ou seja, as cores definidas respectivamente como m√©dia ou mediana, nas colunas - cores que s√£o encontradas em princ√≠pio.  Ao adicionar uma m√°quina √† tabela, o n√∫mero de pixels de cada cor era normalizado para o seu n√∫mero, ou seja, a soma de todos os valores adicionados √† linha era igual a um. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ic/q-/ep/icq-ep_xxwuaiuuec8bordv3_cu.png" alt="imagem"></div><br>  <i>Investiga√ß√£o da precis√£o de determinar a cor de uma m√°quina como a cor m√©dia dos pixels coloridos 'abox.</i>  <i>Precis√£o m√©dia: <b>75%</b></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/at/b3/wm/atb3wmizgurxd0gemdqiltoj62w.png" alt="imagem"></div><br>  <i>Investiga√ß√£o da precis√£o da determina√ß√£o da cor da m√°quina como a cor mediana dos pixels da caixa de cores.</i>  <i>Precis√£o m√©dia: <b>76%</b></i> <br><br>  Como voc√™ pode ver, n√£o h√° uma diferen√ßa espec√≠fica entre os m√©todos, o que indica uma boa marca√ß√£o.  No futuro, usamos a mediana, porque apresentou o melhor resultado. <br>  A cor do carro ser√° determinada com base na √°rea dentro da <i>caixa delimitadora</i> do <i>carro</i> . <br><br><h2>  <font color="#0071c5">Voc√™ precisa de redes?</font> </h2><br>  A quest√£o √© inevit√°vel: as redes neurais s√£o realmente necess√°rias para resolver uma tarefa intuitivamente simples?  Talvez voc√™ possa pegar a cor mediana ou m√©dia dos pixels em uma <i>caixa delimitadora de carro</i> da mesma maneira?  As figuras abaixo mostram o resultado dessa abordagem.  Como ser√° mostrado mais adiante, √© pior que o m√©todo que utiliza redes neurais. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/bl/o8/anblo8jtdfojv3v7b1yd_bt5zzi.png" alt="imagem"></div><br>  <i>A distribui√ß√£o da parcela de carros com o valor de erro L2 no espa√ßo LAB entre a cor da caixa de cores definida como a m√©dia e a cor da caixa delimitadora do carro do valor desse erro</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="imagem"></div><br>  <i>Distribui√ß√£o da parcela de carros com o valor de erro L2 no espa√ßo LAB entre a caixa de cores definida como a mediana e a cor da <i>caixa delimitadora</i> do <i>carro a</i> partir do valor desse erro</i> <br><br><h2>  <font color="#0071c5">Descri√ß√£o da abordagem da tarefa</font> </h2><br>  Em nosso trabalho, usamos a arquitetura Resnet-10 para destacar recursos.  Para resolver um problema de etiqueta e multilabel, foram escolhidas as fun√ß√µes de ativa√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">softmax</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sigmoid,</a> respectivamente. <br>  Uma quest√£o importante foi a escolha da m√©trica pela qual poder√≠amos comparar nossos resultados.  No caso de tarefas de um r√≥tulo, voc√™ pode selecionar a classe que corresponde √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">resposta m√°xima</a> .  No entanto, essa solu√ß√£o obviamente n√£o funcionar√° no caso de m√°quinas com v√°rias etiquetas / v√°rias cores, j√° que o argmax produz uma cor, provavelmente.  A m√©trica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">L1</a> depende do n√∫mero de classes, portanto, tamb√©m n√£o p√¥de ser usada para comparar todos os resultados.  Portanto, decidiu-se permanecer na m√©trica da √°rea sob a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">curva</a> ROC (ROC AUC - √°rea sob curva) como universal e universalmente reconhecida. <br><br>  Trabalhamos em dois espa√ßos de cores.  O primeiro √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RGB</a> padr√£o, no qual escolhemos 8 classes: dividimos o cubo RGB em 8 subcubos id√™nticos: branco, preto, vermelho, verde, azul, rosa, amarelo, ciano.  Essa parti√ß√£o √© muito grosseira, mas simples. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vq/4z/pd/vq4zpd9edgxx4m9z0cnk-8jso2i.png" alt="imagem"></div><br>  <i>Divida o espa√ßo de cores RGB em 8 √°reas</i> <br><br>  Al√©m disso, realizamos estudos com o espa√ßo de cores LAB, que utilizou a parti√ß√£o em 810 classes.  Por que tanto?  O LAB foi introduzido depois que o cientista americano <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">David MacAdam</a> estabeleceu que existem √°reas de cores que n√£o s√£o vis√≠veis ao olho humano ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">elipses de MacAdam</a> ).  O LAB foi constru√≠do de modo que essas elipses tivessem a apar√™ncia de c√≠rculos (na se√ß√£o de L - brilho constante). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-1/y5/q9/-1y5q9owfaqva2sd7sxy45auef0.png" alt="imagem"></div><br>  <i>Elipses do MacAdam e espa√ßo de cores do LAB ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">origem</a> )</i> <br><br>  No total, existem 81 c√≠rculos na se√ß√£o de c√≠rculos, demos o passo 10 em rela√ß√£o ao par√¢metro L (de 0 a 100), obtendo 810 classes.  Al√©m disso, realizamos um experimento com uma classe L constante e, correspondentemente, 81. <br><br><h2>  <font color="#0071c5">RGB e LAB</font> </h2><br>  Os seguintes resultados foram obtidos para o problema de 8 classes e o espa√ßo RGB: <br><table><tbody><tr><th>  Fun√ß√£o de ativa√ß√£o </th><th>  Tarefa de v√°rios r√≥tulos </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,97 </td></tr><tr><td>  sigm√≥ide </td><td>  ‚úì </td><td>  0,88 </td></tr></tbody></table>  <i>Tabela de resultados de reconhecimento de cores para m√°quinas com um problema de 8 classes</i> <br><br>  Parece que o resultado da tarefa multilabel j√° √© bastante bom.  Para verificar essa suposi√ß√£o, constru√≠mos uma matriz de erros, assumindo 0,55 como o valor limite da probabilidade.  I.e.  se esse valor for excedido em probabilidade para a cor correspondente, assumimos que a m√°quina √© pintada nessa cor.  Apesar do fato de o limiar ser escolhido baixo o suficiente, podem ser vistos erros t√≠picos na determina√ß√£o da cor do carro e tirar conclus√µes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5s/5q/9t/5s5q9tyt_8nbe4c0vb-mgxtoday.png" alt="imagem"></div><br>  <i>Tabela de resultados de reconhecimento de cores para carros no problema da 8¬™ classe</i> <br><br>  Basta olhar para as linhas correspondentes √†s cores verde ou rosa para garantir que o modelo esteja longe de ser perfeito.  Voltaremos √† quest√£o de por que, com um grande valor m√©trico, um resultado t√£o estranho e malsucedido, retornaremos imediatamente e indicamos imediatamente: ao considerar apenas 8 classes, um grande n√∫mero de cores cai nas classes "branca" e "preta", portanto, esse resultado . <br><br>  Portanto, passaremos para o espa√ßo de cores do LAB e realizaremos pesquisas no local. <br><table><tbody><tr><th>  Fun√ß√£o de ativa√ß√£o </th><th>  Tarefa de v√°rios r√≥tulos </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,915 </td></tr><tr><td>  sigm√≥ide </td><td>  ‚úì </td><td>  0.846 </td></tr></tbody></table>  <i>Tabela de resultados do reconhecimento de cores da m√°quina no problema da classe 810</i> <br><br>  O resultado √© menor, o que √© l√≥gico, pois o n√∫mero de classes aumentou em duas ordens de magnitude.  Tomando o resultado sigm√≥ide como ponto de partida, tentamos melhorar nosso modelo. <br><br><h2>  <font color="#0071c5">LAB: experimentos com pesos diferentes</font> </h2><br>  Antes disso, todas as experi√™ncias foram realizadas com pesos unit√°rios na fun√ß√£o de <i>perda</i> ( <i>perda</i> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ox/u5/af/oxu5afajo-qngyg1t6tdml1sdxo.png" alt="imagem"></div><br><br>  Aqui o GT √© a verdade do solo, W √© o peso. <br><br>  Voc√™ pode inserir uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dist√¢ncia no</a> espa√ßo de cores <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do</a> LAB.  Digamos que temos uma unidade no GT.  Em seguida, corresponde a um paralelep√≠pedo retangular no espa√ßo de cores do LAB.  Esse paralelep√≠pedo (mais precisamente, seu centro) √© removido a uma dist√¢ncia diferente de todos os outros paralelep√≠pedos (novamente, seus centros).  Dependendo dessa dist√¢ncia, voc√™ pode experimentar as seguintes escalas: <br><br>  a) Zero no lugar de uma unidade no GT, e ao afastar-se dela - um aumento nos pesos; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/in/ql/zsinql6ut3hucnr3ytrvkc0xxqi.png" alt="imagem"></div><br><br>  b) Inversamente, no lugar de uma unidade no GT, √© uma: quando removida, √© uma queda nos pesos; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/-l/oo/8v-looj6mqsgrtzvz9elevykcak.png" alt="imagem"></div><br><br>  c) Op√ß√£o a) mais um pequeno aditivo gaussiano com amplitude de ¬Ω no lugar de uma unidade em GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/qy/ac/yxqyac6ks3cvy10qh6lilp4ib0q.png" alt="imagem"></div><br><br>  d) Op√ß√£o a) mais um pequeno aditivo gaussiano com amplitude de 1 no lugar de uma unidade em GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/0s/01/ep0s01rau7n0oiak71zjkp5vhxg.png" alt="imagem"></div><br><br>  e) Op√ß√£o b) com um pequeno aditivo √† dist√¢ncia m√°xima da unidade no GT. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ff/9q/ft/ff9qftnoidusfhdhz1p9jjoqwi0.png" alt="imagem"></div><br><br>  A √∫ltima vers√£o das escalas com as quais conduzimos experimentos √©, como a chamamos, Gauss tripla, ou seja, tr√™s distribui√ß√µes normais com centros no lugar de unidades no GT, bem como √† maior dist√¢ncia delas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/jr/kb/qkjrkbhyxschjibmya3xt3hik9y.png" alt="imagem"></div><br>  <i>Tr√™s distribui√ß√µes normais centradas nas unidades do GT e √† maior dist√¢ncia delas</i> <br><br>  Isso ter√° que ser explicado com mais detalhes.  Voc√™ pode selecionar os dois paralelep√≠pedos mais distantes e, portanto, as classes e compar√°-los em dist√¢ncia do original.  Para a classe correspondente √† mais distante, a amplitude de distribui√ß√£o √© definida como 0,8 e para a segunda √© m vezes menor, onde m √© a raz√£o da dist√¢ncia da fonte at√© a remota distante e a dist√¢ncia entre a fonte e o pr√≥ximo. <br><br>  Os resultados s√£o mostrados na tabela.  Devido ao fato de que nas escalas da op√ß√£o a) havia peso zero - apenas para unidades no GT, o resultado nelas foi ainda pior do que o ponto de partida, pois a rede n√£o levou em considera√ß√£o defini√ß√µes de cores bem-sucedidas, aprendendo pior.  As variantes dos pesos b) e e) praticamente coincidiram, portanto o resultado nelas coincidiu.  O maior aumento em pontos percentuais em compara√ß√£o com o resultado inicial foi demonstrado pela variante dos pesos f) - gauss triplos. <br><table><tbody><tr><th>  Fun√ß√£o de ativa√ß√£o </th><th>  N√∫mero de aulas </th><th>  Tipo de pesos </th><th>  ROC AUC </th></tr><tr><td rowspan="5">  sigm√≥ide </td><td rowspan="5">  810 </td><td>  a) </td><td>  0.844 </td></tr><tr><td>  b) e) </td><td>  0.848 </td></tr><tr><td>  c) </td><td>  0,888 </td></tr><tr><td>  d) </td><td>  0.879 </td></tr><tr><td>  f) </td><td>  0,909 </td></tr></tbody></table>  <i>Resultados de reconhecimento de cores de m√°quinas no problema da classe 810 com diferentes op√ß√µes de peso</i> <br><br><h2>  <font color="#0071c5">LAB: experimentando novos r√≥tulos</font> </h2><br>  Por isso, realizamos experimentos com diferentes pesos em <i>perdas</i> .  Decidimos tentar deixar os pesos como um e alterar os r√≥tulos, que s√£o transferidos para a fun√ß√£o de perda e usados ‚Äã‚Äãpara otimizar a rede.  Se antes disso os r√≥tulos coincidiam com o GT, agora eles decidiram usar novamente as distribui√ß√µes gaussianas com centros no local das unidades no GT: <br><br>  A motiva√ß√£o para esta decis√£o √© a seguinte.  O fato √© que, com r√≥tulos comuns, todos os carros nos conjuntos de dados se enquadram em um n√∫mero fixo de classes, inferior a 810, para que a rede aprenda a determinar a cor dos carros apenas dessas classes.  Com novos r√≥tulos, valores diferentes de zero se enquadram em todas as classes e podemos esperar um aumento na precis√£o da determina√ß√£o da cor do carro.  Experimentamos dois sigma (desvios padr√£o) para as distribui√ß√µes gaussianas acima: 41.9 e 20.9.  Porque assim?  O primeiro sigma √© escolhido da seguinte forma: a dist√¢ncia m√≠nima entre as classes (28) √© obtida e o sigma √© determinado a partir da condi√ß√£o de que a distribui√ß√£o diminua duas vezes na classe adjacente ao GT'noye.  E o segundo sigma √© apenas duas vezes menor que o primeiro. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/z4/xq/jkz4xqdkl-nwecfnttwzuhwgyuo.png" alt="imagem"></div><br>  <i>Distribui√ß√£o de carros de conjunto de dados de treinamento por classes com diferentes r√≥tulos em perda</i> <br><br>  De fato, foi poss√≠vel melhorar ainda mais o resultado usando esse truque, conforme mostrado na tabela.  Como resultado, a precis√£o da determina√ß√£o atingiu 0,955! <br><table><tbody><tr><th>  Fun√ß√£o de ativa√ß√£o </th><th>  N√∫mero de aulas </th><th>  Tipo de etiqueta </th><th>  Tipo de pesos </th><th>  ROC AUC </th></tr><tr><td rowspan="4">  sigm√≥ide </td><td rowspan="4">  810 </td><td>  habitual </td><td>  uns </td><td>  0.846 </td></tr><tr><td>  habitual </td><td>  tr√™s gauss </td><td>  0,909 </td></tr><tr><td>  novo, <sub>1</sub> </td><td rowspan="2">  tr√™s gauss </td><td>  0,955 </td></tr><tr><td>  novo, œÉ <sub>2</sub> </td><td>  0,946 </td></tr></tbody></table>  <i>Resultados de reconhecimento de cores para m√°quinas do problema da classe 810: com etiquetas comuns e pesos unit√°rios, com etiquetas comuns e pesos na forma de Gauss triplo, com novas etiquetas e pesos unit√°rios</i> <br><br><h2>  <font color="#0071c5">LAB: 81</font> </h2><br>  Se falamos de experimentos malsucedidos, devemos mencionar a tentativa de treinar uma rede com 81 classes e um par√¢metro constante L. Percebemos durante experimentos anteriores que o brilho √© determinado pela rede com bastante precis√£o, e decidimos treinar apenas os par√¢metros aeb ( chamadas as outras duas coordenadas no LAB).  Infelizmente, apesar do fato de a rede ter sido capaz de treinar perfeitamente no avi√£o, mostrando um valor maior em termos de m√©trica, a id√©ia de definir o par√¢metro L na sa√≠da da rede como m√©dia para a <i>caixa delimitadora</i> do <i>carro</i> caiu e a cor real e assim definida foram muito diferentes. <br><br><h2>  <font color="#0071c5">Compara√ß√£o com a solu√ß√£o de um problema sem o uso de redes neurais</font> </h2><br>  Agora vamos voltar ao in√≠cio e comparar o que aconteceu conosco com o reconhecimento da cor do carro sem o uso de redes neurais. <br>  Os resultados s√£o mostrados nas figuras abaixo.  Pode-se observar que o pico se tornou tr√™s vezes mais e o n√∫mero de carros com um grande erro entre a verdadeira e uma determinada cor diminuiu significativamente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="imagem"></div><br>  <i>A distribui√ß√£o da parcela de carros com o valor de erro L2 no espa√ßo LAB entre a caixa delimitadora da cor definida como a mediana e a cor da caixa delimitadora do carro do valor desse erro</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6j/wr/b5/6jwrb5imhzh2rbvnaxrgzedf0p8.png" alt="imagem"></div><br>  <i>Distribui√ß√£o da parcela de carros com o valor de erro L2 no espa√ßo LAB entre a cor na sa√≠da da rede neural e a cor da caixa delimitadora do carro do valor desse erro</i> <br><br><h2>  <font color="#0071c5">Exemplos</font> </h2><br>  A seguir, exemplos de reconhecimento de cores de autom√≥veis.  A primeira √© que a m√°quina preta (um caso t√≠pico) √© reconhecida como preta, e a dist√¢ncia no espa√ßo LAB entre a cor verdadeira e a espec√≠fica (18,16) √© menor que a dist√¢ncia m√≠nima entre as classes (28).  Na segunda figura, a rede conseguiu n√£o apenas determinar que o carro estava iluminado (existe uma alta probabilidade de corresponder a uma das classes de cores brancas), mas tamb√©m sua cor real (prata).  No entanto, a m√°quina da figura a seguir, tamb√©m iluminada, n√£o foi detectada pela rede como vermelha.  A rede n√£o conseguiu determinar a cor do carro mostrada na figura abaixo, que decorre do fato de que as probabilidades para todas as cores s√£o muito pequenas. <br><br>  De muitas maneiras, a tarefa foi devido √† necessidade de reconhecer carros multicoloridos.  A √∫ltima figura mostra um carro preto e amarelo em dois tons.  A rede provavelmente reconheceu a cor preta, provavelmente devido √† predomin√¢ncia de m√°quinas desta e de cores semelhantes no conjunto de dados de treinamento, e a cor amarela, que √© quase verdadeira, entrou no top 3. <br><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/ro/l7/re/rol7re300p2hf30rtsvaiyfbi20.png" align="right" alt="imagem"></th><th><img src="https://habrastorage.org/webt/n8/ig/cl/n8igclilt4ep3qlmipvt9rmbt5w.png" align="left" alt="imagem"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/o5/pf/fj/o5pffjzvnat7mouv8yhf-kuzs3g.png" align="right" alt="imagem"></th><th><img src="https://habrastorage.org/webt/vn/ml/wa/vnmlwawbhys7tkvrwquwc6bttsw.png" align="left" alt="imagem"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/jh/mi/hs/jhmihs9rnoqounq2ostwq8iz1q0.png" align="right" alt="imagem"></th><th><img src="https://habrastorage.org/webt/pv/sg/ft/pvsgftesuo5lmmy_gvuzsj-rg4o.png" align="left" alt="imagem"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/f7/uj/p3/f7ujp3uavgqz6aobfa_hbk6xpos.png" align="right" alt="imagem"></th><th><img src="https://habrastorage.org/webt/0c/mo/l1/0cmol16qj3ghtsc49jqag2dy8yc.png" align="left" alt="imagem"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/dd/hi/th/ddhithwwjdez_q6sr8xa9cwcs-i.png" align="right" alt="imagem"></th><th><img src="https://habrastorage.org/webt/gg/hf/px/gghfpxgurqddwvldmop4t1zszfo.png" align="left" alt="imagem"></th></tr></tbody></table><br><h2>  <font color="#0071c5">Curva ROC: visualiza√ß√£o e problemas</font> </h2><br>  Portanto, na sa√≠da, obtivemos um resultado m√©trico bastante alto.  A figura a seguir mostra curvas ROC para resolver um problema com 8 classes e para um problema com 810 classes, bem como solu√ß√µes sem o uso de redes neurais.  Pode-se ver que o resultado √© um pouco diferente do que foi escrito anteriormente.  Os resultados anteriores foram obtidos usando o TensorFlow, os gr√°ficos abaixo foram obtidos usando o pacote scikit-learn. <br><table><tbody><tr><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/zm/ib/yqzmib4v_0jaco5torqqvu0fdmo.png" alt="imagem"></div></th><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/k0/nb/gn/k0nbgn7ows7rcx-q3so38ugg_dw.png" alt="imagem"></div></th></tr></tbody></table>  <i>Curva ROC para v√°rias op√ß√µes para resolver o problema.</i>  <i>√Ä direita est√° o canto superior esquerdo do gr√°fico esquerdo</i> <br><br>  Voc√™ pode usar n√∫meros fixos como valores limite (por exemplo, Tensorflow, quando define o par√¢metro correspondente como 50, leva o mesmo n√∫mero de limites de 0 a 1 em intervalos iguais), pode usar os valores na sa√≠da da rede ou pode limit√°-los de baixo para n√£o considerar valores da ordem de 10 <sup>-4</sup> , por exemplo.  O resultado dessa √∫ltima abordagem √© mostrado na figura a seguir. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/2c/b2/fb2cb2dxnaxvjjtywmlbdb-xs54.png" alt="imagem"></div><br>  <i>Curva ROC para v√°rias op√ß√µes para resolver o problema com um limite de 10 <sup>-4</sup></i> <br><br>  Pode-se observar que todas as curvas correspondentes √† solu√ß√£o do problema usando redes neurais s√£o caracteristicamente melhores (maiores) que a solu√ß√£o para o problema sem elas, mas voc√™ n√£o pode escolher a definitivamente melhor entre as primeiras.  Dependendo do limite escolhido pelo usu√°rio, diferentes curvas corresponder√£o a diferentes solu√ß√µes √≥timas para o problema.  Portanto, por um lado, encontramos uma abordagem que nos permite determinar com precis√£o a cor da m√°quina e mostra uma m√©trica alta, por outro lado, mostramos que o limite ainda n√£o foi atingido e a m√©trica da √°rea sob a curva ROC tem suas desvantagens. <br><br>  Pronto para responder a perguntas e ouvir coment√°rios nos coment√°rios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt422689/">https://habr.com/ru/post/pt422689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt422679/index.html">Problemas imagin√°rios - a raz√£o para um software ruim</a></li>
<li><a href="../pt422681/index.html">Integra√ß√£o SAP e Python ou como facilitar os dados do SAP</a></li>
<li><a href="../pt422683/index.html">Nos EUA, dois traders criaram uma corretora falsa para roubar dinheiro de investidores iniciantes</a></li>
<li><a href="../pt422685/index.html">Rel√≥gio inteligente Samsung Galaxy Watch: atualiza√ß√£o do Android Wear OS para Tizen OS - experi√™ncia pessoal</a></li>
<li><a href="../pt422687/index.html">Mensageiros em perigo</a></li>
<li><a href="../pt422691/index.html">A c√¢mera h√≠brida e o lidar melhoram as capacidades dos robomobiles, complementando informa√ß√µes sobre o mundo exterior</a></li>
<li><a href="../pt422693/index.html">Equipe de plug-ins para configurar componentes JavaFX em um aplicativo de desktop</a></li>
<li><a href="../pt422697/index.html">Webpack 4 e dividindo o arquivo de configura√ß√£o em m√≥dulos</a></li>
<li><a href="../pt422699/index.html">Uma brecha fechada confirma a irrealidade do mundo qu√¢ntico</a></li>
<li><a href="../pt422701/index.html">Deep Learning e OpenVINO Toolkit. Fa√ßa uma pergunta a um especialista da Intel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>