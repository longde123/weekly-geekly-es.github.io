<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ğŸ¿â€ğŸ¤â€ğŸ§‘ğŸ¾ ğŸ» ğŸ‘©ğŸ¼â€ğŸ”¬ Penempatan di PythonAnywhere dari GitHub ğŸ€ ğŸ¤® ğŸŒ‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Semua orang dapat melakukan ini: 


 proyek lokal -> github 


 Dengan akses ssh (berbayar), Anda dapat melakukan ini: 


 proyek lokal -> PythonAnywh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Penempatan di PythonAnywhere dari GitHub</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457348/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a5/335/d52/2a5335d52070f6ad653a12df2a36fdd2.svg" width="546" height="69"></div><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c3d/663/162/c3d6631626f6b219c6ffc7a81f54132e.png" width="50" height="50"></div><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ba/2aa/20e/0ba2aa20e2c2ce80e9a2db5b07198464.png" width="183" height="152"></div><br><p>  <strong>Semua orang dapat melakukan ini:</strong> </p><br><p>  proyek lokal -&gt; github </p><br><p>  <strong>Dengan akses ssh (berbayar), Anda dapat melakukan ini:</strong> </p><br><p>  proyek lokal -&gt; PythonAnywhere </p><br><p>  <strong>Artikel menunjukkan bagaimana (gratis) melakukan ini:</strong> </p><br><p>  proyek lokal -&gt; github -&gt; PythonAnywhere </p><br><p>  Pertama, saya akan membuat daftar mengapa Anda mungkin membutuhkan ini, dan kemudian beralih ke cara mengimplementasikannya.  Jangan lewatkan artikel ini jika bagian pertama tidak menarik bagi Anda. </p><a name="habracut"></a><br><hr><br><h3>  Mengapa </h3><br><p>  PythonAnywhere adalah layanan hebat!  Ini gratis, memberikan daya yang baik dan bahkan database, sehingga Anda dapat meningkatkan situs dinamis dalam beberapa menit.  Ini adalah pilihan bagus untuk pemula yang ingin mencoba sesuatu secara langsung, dan bagi mereka yang perlu meng-host API atau proyek pribadi. </p><br><p>  Namun layanan ini juga memiliki kekurangan.  Bagaimana jika Anda ingin membuka kode yang sedang Anda kerjakan?  Apakah Anda akan mendukung dan membuat perubahan di dua tempat sekaligus?  Sekali pada produksi PythonAnywhere dan kedua kalinya pada GitHub untuk pengembang lain.  Bagaimana jika Anda menerima Tarik Permintaan atau ingin mengintegrasikan CI?  Menduplikasi semua tindakan secara terus-menerus sangat merepotkan. </p><br><p>  GitHub adalah layanan hebat untuk bekerja bersama dan melihat kode sumber, UI mereka lebih baik daripada di PythonAnywhere dan, yang saya tuju, mengedit kode langsung di PythonAnywhere tidak terlalu menyenangkan.  Bagaimana jika kita bisa menggabungkan yang terbaik dari dua dunia? </p><br><p>  Anda mendorong semua pembaruan di GitHub, dan aplikasi PythonAnywhere menyinkronkan dan memulai ulang secara otomatis.  Anda dapat mengedipkan PR, menggunakan tiket, melihat kode Anda dari perangkat apa pun bahkan tanpa masuk dan tanpa membuka file di editor kode - secara umum, melakukan segala hal yang GitHub bisa Anda lakukan. </p><br><p>  Saya sudah mendengar gumaman: "Bagus, bagus, yakin, tetapi bagaimana ini bisa dicapai?"  Tidak sepatah kata pun! </p><br><hr><br><h3>  Bagaimana? </h3><br><p>  Kami menggunakan webhook Github untuk memberi tahu Anda tentang pembaruan aplikasi, tarik dan muat ulang. </p><br><p>  Sebagai contoh, saya akan mempertimbangkan aplikasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SwagLyrics</a> saya, yang backend saya pegang di PythonAnywhere.  Saya menggunakan Flask, jadi prosesnya akan berbeda untuk kerangka kerja lain. </p><br><p>  Pertama, sinkronkan proyek sehingga GitHub adalah asalnya.  Jika Anda belum membuat repositori PythonAnywhere, Anda dapat menginisialisasi atau mengkodenya langsung dari GitHub. </p><br><p>  Sesuatu seperti: </p><br><pre><code class="plaintext hljs">git init git remote add origin https://github.com/yourusername/yourreponame.git</code> </pre> <br><p>  Sekarang pergi ke GitHub -&gt; Pengaturan -&gt; Webhooks -&gt; Tambahkan webhook </p><br><p>  Di sana Anda akan melihat: </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/491/db4/b6e/491db4b6e6cf50c25668c665504cd9f0.png"></div><br><p>  Di bidang "URL Muatan", tambahkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">domain_anda / route_untuk memperbarui</a> </p><br><p>  Sebagai contoh, webhook dari repositori saya menunjuk ke nbsp;  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://aadibajpai.pythonanywhere.com/update_server</a> </p><br><p>  Ubah "Jenis konten" dari <b>application / x-www-form-urlencoded</b> ke <b>application / json</b> (saya akan memberi tahu Anda mengapa ini diperlukan sedikit kemudian). </p><br><p>  Kami belum akan menyentuh bidang Rahasia. </p><br><p>  Pastikan opsi "push event" dipilih dan klik "Tambahkan webhook". </p><br><p>  Buka aplikasi Anda di Flask, kami akan mengonfigurasi rute untuk menerima informasi dari GitHub ketika acara dorong terjadi.  Path harus yang Anda tentukan di bidang "URL Muatan".  Kami tidak secara eksplisit menentukan cabang master, sebagai  untuk kesederhanaan, tersirat bahwa itu adalah satu-satunya di repositori. </p><br><p>  Setup paling sederhana akan terlihat seperti ini: </p><br><pre> <code class="plaintext hljs">from flask import Flask, request import git</code> </pre> <br><pre> <code class="plaintext hljs">app = Flask(__name__)</code> </pre> <br><pre> <code class="plaintext hljs">@app.route('/update_server', methods=['POST']) def webhook(): if request.method == 'POST': repo = git.Repo('path/to/git_repo') origin = repo.remotes.origin</code> </pre> <br><pre> <code class="plaintext hljs"> origin.pull()</code> </pre> <br><pre> <code class="plaintext hljs"> return 'Updated PythonAnywhere successfully', 200 else: return 'Wrong event type', 400</code> </pre> <br><p>  Ini adalah contoh paling sepele, versi yang lebih lengkap akan lebih rendah. </p><br><p>  Sekarang, setiap kali terjadi peristiwa dorong, aplikasi akan memperbarui dirinya sendiri dengan melakukan tarikan. </p><br><p>  Jika semuanya berjalan lancar, inilah yang akan Anda lihat setelah komit berikutnya: </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3f/dc8/f09/a3fdc8f09cd950d2ea66f1b86ef076c1.png"></div><br><p>  Sebelum kita beralih ke melindungi webhook dari orang asing, saya akan memberi tahu Anda cara me-restart aplikasi setelah menarik sehingga Anda tidak perlu melakukan ini secara manual. </p><br><h4>  Aplikasi web memuat ulang secara otomatis </h4><br><p>  Kami akan menggunakan kait git.  Ini hanya perintah shell yang dieksekusi setelah peristiwa.  Tidak ada pengait untuk acara setelah tarik, tapi ... </p><br><p>  Kami menggunakan fakta bahwa <b>git pull</b> tidak lebih dari <b>git fetch</b> â†’ <b>git merge</b> , tetapi sebuah hook untuk acara setelah <b>penggabungan</b> ada.  Ini dijalankan jika tarikan selesai dengan sukses. </p><br><p>  Di repositori PythonAnywhere Anda, buka <strong>.git / hooks /</strong> </p><br><p>  Sudah ada beberapa kait yang ada, tambahkan milik Anda kepadanya dengan membuat file <strong>pasca-penggabungan</strong> </p><br><p>  Tulis kode berikut ke dalamnya: </p><br><pre> <code class="plaintext hljs">#!/bin/sh touch /path/to/username_pythonanywhere_com_wsgi.py</code> </pre> <br><p>  Gunakan jalur ke wsgi Anda, yang, ketika diubah (sentuh), restart aplikasi. </p><br><p>  Untuk membuat file dapat dieksekusi, buka konsol dan jalankan </p><br><pre> <code class="plaintext hljs">chmod +x post-merge</code> </pre> <br><p>  Pastikan reboot berfungsi dengan membuat komit baru. </p><br><p>  Sekarang mari kita beralih ke mengamankan webhook. </p><br><hr><br><h3>  Perlindungan Webhook </h3><br><p>  Diperlukan perlindungan webhook agar orang lain tidak dapat terus-menerus mengirim permintaan untuk memulai kembali aplikasi.  Kami akan menggunakan panduan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> . </p><br><p>  Pertama, tambahkan token rahasia di PythonAnywhere sebagai variabel lingkungan, serta di bidang "Rahasia" di pengaturan webhook GitHub.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Di sini</a> prosesnya dijelaskan secara lebih rinci. </p><br><p>  GitHub memberikan metodenya dalam Ruby, tetapi kami menggunakan Python, jadi kami akan menggunakan fungsi perbandingan ini: </p><br><pre> <code class="plaintext hljs">import hmac import hashlib def is_valid_signature(x_hub_signature, data, private_key): # x_hub_signature and data are from the webhook payload # private key is your webhook secret hash_algorithm, github_signature = x_hub_signature.split('=', 1) algorithm = hashlib.__dict__.get(hash_algorithm) encoded_key = bytes(private_key, 'latin-1') mac = hmac.new(encoded_key, msg=data, digestmod=algorithm) return hmac.compare_digest(mac.hexdigest(), github_signature)</code> </pre> <br><p>  Sekarang modifikasi controller update_server untuk memeriksa apakah tanda tangan valid dengan menambahkan baris-baris ini sebelum bagian pembaruan kode: </p><br><pre> <code class="plaintext hljs">x_hub_signature = request.headers.get('X-Hub-Signature') if not is_valid_signature(x_hub_signature, request.data, w_secret):</code> </pre> <br><p>  <b>w_secret</b> harus cocok dengan nilai yang Anda atur sedikit lebih awal sebagai variabel lingkungan. </p><br><p>  Secara umum, masuk akal untuk menambahkan pencatatan dan beberapa pemeriksaan lagi untuk memastikan bahwa webhook GitHub atau bahwa acara tersebut berisi data, jadi jika Anda mau, Anda dapat menyalin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kode yang relevan dari repositori saya</a> , mengubahnya jika perlu, karena Anda sudah tahu segalanya yang penting </p><br><p>  Semoga informasinya bermanfaat.  Saya tahu ada banyak hal, tetapi saya ingin Anda mengerti apa yang terjadi. </p><br><hr><br><p>  Saya tidak menemukan semuanya sendiri, tetapi saya mengumpulkan yang paling penting dari berbagai sumber dan menciptakan solusi lengkap. </p><br><div class="spoiler">  <b class="spoiler_title">Berikut tautan yang membantu saya dan dapat membantu Anda:</b> <div class="spoiler_text"><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://stackoverflow.com/a/54268132/9044659</a> (pengaturan dasar) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://developer.github.com/webhooks/</a> (dokumentasi webhook GitHub) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/CCExtractor/sample-platform/blob/master/mod_deploy/controllers.py</a> (implementasi yang sangat terperinci dengan banyak cek jika Anda ingin menghabiskan waktu untuk hal ini) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/SwagLyrics/swaglyrics-issue-maker/blob/35d23d0ba416e742e381da931d592ce6f58fc13f/issue_maker.py#L268</a> (implementasi pengontrol saya untuk PythonAnywhere) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/SwagLyrics/SwagLyrics-For-Spotify</a> (repositori tempat saya menggunakan ini dalam praktiknya) </li></ol></div></div><br><p>  Terima kasih sudah membaca! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id457348/">https://habr.com/ru/post/id457348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id457334/index.html">TacacsGUI, Manajer Konfigurasi</a></li>
<li><a href="../id457336/index.html">Konsekuensi dari pencabutan gigi bungsu sebelum waktunya</a></li>
<li><a href="../id457338/index.html">Blitz dengan Ilya Krasinsky: bagaimana cara menembak hipotesis buruk, mengapa mengabaikan suatu produk dan bagaimana tumbuh untuk tindakan minimum?</a></li>
<li><a href="../id457340/index.html">10 plugin PostCSS yang akan menghemat waktu tata letak Anda</a></li>
<li><a href="../id457342/index.html">Tanda dari Atas: Bagaimana Kami Menyelamatkan Kartografer dari Pekerjaan yang Tidak Perlu dan Mata Merah</a></li>
<li><a href="../id457350/index.html">Mengapa osiloskop memerlukan dukungan kriptografi?</a></li>
<li><a href="../id457352/index.html">Kesimpulan informasi pada tampilan pembeli</a></li>
<li><a href="../id457354/index.html">Kebingungan Data untuk Tes Kinerja</a></li>
<li><a href="../id457362/index.html">Promosi dari RUVDS: siapkan server di musim panas</a></li>
<li><a href="../id457366/index.html">Seorang fanatik, sepotong besi atau penonton - gamer seperti apa Anda?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>