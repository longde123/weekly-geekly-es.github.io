<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¢ üïµÔ∏è üêøÔ∏è Neuronales Netz Trick f√ºr Anf√§nger üì¨ üßëüèΩ‚Äçü§ù‚ÄçüßëüèΩ üí™üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Rahmen des j√§hrlichen ZeroNights HackQuest 2018-Wettbewerbs wurden die Teilnehmer eingeladen, sich an einer Reihe nicht trivialer Aufgaben und Wett...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Neuronales Netz Trick f√ºr Anf√§nger</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/443164/"><p><img src="https://habrastorage.org/webt/us/ri/cv/usricvbthwh4i_pyy50suyvx5mq.jpeg" alt="Bild"></p><br><p>  Im Rahmen des j√§hrlichen ZeroNights HackQuest 2018-Wettbewerbs wurden die Teilnehmer eingeladen, sich an einer Reihe nicht trivialer Aufgaben und Wettbewerbe zu versuchen.  Ein Teil von ihnen bezog sich auf die Erzeugung eines kontroversen Beispiels f√ºr ein neuronales Netzwerk.  In unseren Artikeln haben wir bereits auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Angriffsmethoden</a> und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verteidigung</a> von Algorithmen f√ºr maschinelles Lernen geachtet.  Im Rahmen dieser Ver√∂ffentlichung werden wir ein Beispiel analysieren, wie es m√∂glich war, die Aufgabe mit ZeroNights Hackquest mithilfe der Foolbox-Bibliothek zu l√∂sen. </p><a name="habracut"></a><br><p>  In dieser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aufgabe sollte der</a> Angreifer Zugriff auf den Server erhalten.  Nachdem er erfolgreich war, sah er die folgende Dateistruktur in seinem Home-Verzeichnis: </p><br><pre><code class="plaintext hljs">| Home --| KerasModel.h5 --| Task.txt --| ZeroSource.bmp</code> </pre> <br><p>  Die folgenden Informationen befanden sich in der Datei Task.txt: </p><br><pre> <code class="plaintext hljs">Now it is time for a final boss! http://51.15.100.188:36491/predict You have a mode and an image. To get a ticket, you need to change an image so that it is identified as "1". curl -X POST -F image=@ZeroSource.bmp 'http://51.15.100.188:36491/predict'. (don't forget about normalization (/255) ^_^)</code> </pre> <br><p>  Um das begehrte Ticket zu erhalten, wurde der Angreifer gebeten, ZeroSource.bmp zu konvertieren: </p><br><p><img src="https://habrastorage.org/webt/f7/ef/tr/f7eftrhw6zevi-f_usxvu6ldce8.png" alt="Bild"></p><br><p>  Nach dem Senden an den Server interpretiert das neuronale Netzwerk dieses Bild als 1. Wenn Sie versuchen, dieses Bild ohne Verarbeitung zu senden, ist das Ergebnis des neuronalen Netzwerks 0. </p><br><p>  Der wichtigste Hinweis f√ºr diese Aufgabe ist nat√ºrlich die Modelldatei KerasModel.h5 (diese Datei hilft dem Angreifer, den Angriff auf die WhiteBox-Ebene zu √ºbertragen, da ihm das neuronale Netzwerk und alle damit verbundenen Daten zug√§nglich sind).  Der Dateiname enth√§lt sofort einen Hinweis - den Namen des Frameworks, in dem das neuronale Netzwerk implementiert ist. </p><br><p>  Mit diesen einleitenden Anmerkungen machte sich der Teilnehmer an die L√∂sung der Aufgabe: </p><br><ul><li>  In Keras geschriebenes neuronales Netzwerkmodell. </li><li>  Die M√∂glichkeit, ein Bild mithilfe von Curl an den Server zu senden. </li><li>  Das Originalbild, das ge√§ndert werden musste. </li></ul><br><p>  Auf der Serverseite war die √úberpr√ºfung so einfach wie m√∂glich: </p><br><ol><li>  Das Bild sollte die richtige Gr√∂√üe haben - 28x28 Pixel. </li><li>  In diesem Bild sollte das Modell 1 zur√ºckgeben. </li><li>  Der Unterschied zwischen dem urspr√ºnglichen Image von ZeroSource.bmp und dem an den Server gesendeten Image sollte durch die MSE-Metrik kleiner als der Schwellenwert k sein (Standardfehler). </li></ol><br><p>  Also fangen wir an. </p><br><p>  Zun√§chst musste der Teilnehmer Informationen dar√ºber finden, wie das neuronale Netzwerk ausgetrickst werden kann.  Nach kurzer Zeit bei Google erhielt er die Schl√ºsselw√∂rter "Widerspr√ºchliches Beispiel" und "Widerspr√ºchlicher Angriff".  Als n√§chstes musste er nach Werkzeugen suchen, um gegnerische Angriffe anzuwenden.  Wenn Sie die Abfrage "Gegnerische Angriffe auf Keras Neural Net" in Google eingeben, wird der erste Link zum GitHub des FoolBox-Projekts erstellt - einer Python-Bibliothek zum Generieren von Beispielen f√ºr Gegner.  Nat√ºrlich gibt es auch andere Bibliotheken (√ºber einige davon haben wir in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Artikeln gesprochen</a> ).  Dar√ºber hinaus k√∂nnten Angriffe, wie sie sagen, von Grund auf neu geschrieben werden.  Wir konzentrieren uns jedoch immer noch auf die beliebteste Bibliothek, die eine Person, die zuvor noch nicht auf das Thema gegnerische Angriffe gesto√üen ist, √ºber den ersten Link bei Google finden kann. </p><br><p>  Jetzt m√ºssen Sie ein Python-Skript schreiben, das ein kontroverses Beispiel generiert. <br>  Wir werden nat√ºrlich mit Importen beginnen. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> foolbox</code> </pre> <br><p>  Was sehen wir hier? </p><br><ol><li>  Keras ist der Rahmen, auf dem das Neuronale Netz geschrieben ist, den wir t√§uschen werden. </li><li>  NumPy ist eine Bibliothek, mit der wir effizient mit Vektoren arbeiten k√∂nnen. </li><li>  PIL ist ein Werkzeug zum Arbeiten mit Bildern. </li><li>  FoolBox ist eine Bibliothek zum Generieren von gegnerischen Beispielen. </li></ol><br><p>  Das erste, was Sie tun m√ºssen, ist nat√ºrlich, das neuronale Netzwerkmodell in den Speicher unseres Programms zu laden und die Modellinformationen anzuzeigen. </p><br><pre> <code class="python hljs">model = keras.models.load_model(<span class="hljs-string"><span class="hljs-string">"KerasModel.h5"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   model.summary() #     model.input #    ,       </span></span></code> </pre> <br><p>  Am Ausgang erhalten wir folgendes: </p><br><pre> <code class="plaintext hljs">Layer (type) Output Shape Param # ================================================================= conv2d_1 (Conv2D) (None, 26, 26, 32) 320 _________________________________________________________________ conv2d_2 (Conv2D) (None, 26, 26, 64) 18496 _________________________________________________________________ max_pooling2d_1 (MaxPooling2 (None, 13, 13, 64) 0 _________________________________________________________________ dropout_1 (Dropout) (None, 13, 13, 64) 0 _________________________________________________________________ conv2d_3 (Conv2D) (None, 13, 13, 64) 36928 _________________________________________________________________ conv2d_4 (Conv2D) (None, 13, 13, 128) 73856 _________________________________________________________________ max_pooling2d_2 (MaxPooling2 (None, 6, 6, 128) 0 _________________________________________________________________ flatten_1 (Flatten) (None, 4608) 0 _________________________________________________________________ dense_1 (Dense) (None, 256) 1179904 _________________________________________________________________ dense_2 (Dense) (None, 10) 2570 ================================================================= Total params: 1,312,074 Trainable params: 1,312,074 Non-trainable params: 0 _________________________________________________________________ &lt;tf.Tensor 'conv2d_1_input_1:0' shape=(?, 28, 28, 1) dtype=float32&gt;</code> </pre> <br><p>  Welche Informationen kann ich hier rausholen? </p><br><ol><li>  Das Eingabemodell (conv2d_1-Ebene) akzeptiert ein Objekt der Dimension? X28x28x1, wobei "?"  - Anzahl der Objekte;  Wenn das Bild eins ist, betr√§gt die Abmessung 1x28x28x1.  Und das Bild ist ein dreidimensionales Array, wobei eine Dimension 1 ist. Das hei√üt, das Bild wird als Wertetabelle von 0 bis 255 bereitgestellt. </li><li>  Am Ausgang des Modells (dichte_2 Schicht) wird ein Vektor der Dimension 10 erhalten. </li></ol><br><p>  Wir laden das Bild und vergessen nicht, es in den Float-Typ umzuwandeln (au√üerdem arbeitet das neuronale Netzwerk mit reellen Zahlen) und normalisieren es (teilen Sie alle Werte durch 255).  Hier sollte klargestellt werden, dass die Normalisierung einer der ‚Äûobligatorischen‚Äú Tricks bei der Arbeit mit neuronalen Netzen ist, der Angreifer dies jedoch m√∂glicherweise nicht gewusst hat. Daher haben wir in der Beschreibung der Aufgabe einen kleinen Hinweis hinzugef√ºgt. </p><br><pre> <code class="python hljs">img = Image.open(<span class="hljs-string"><span class="hljs-string">"ZeroSource.bmp"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   img = np.array(img) #     numpy.array img = img.astype('float32') #      float img /= 255 # </span></span></code> </pre> <br><p>  Jetzt k√∂nnen wir das Bild an das geladene Modell senden und sehen, welches Ergebnis es erzeugt: </p><br><pre> <code class="python hljs">model.predict(img.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#   predict           </span></span></code> </pre> <br><p>  Am Ausgang erhalten wir folgende Informationen </p><br><pre> <code class="plaintext hljs">array([[1.0000000e+00, 4.2309660e-19, 3.1170484e-15, 6.2545637e-18, 1.4199094e-16, 6.3990816e-13, 6.9493417e-10, 2.8936278e-12, 8.9440377e-14, 1.6340098e-12]], dtype=float32)</code> </pre> <br><p>  Es lohnt sich zu erkl√§ren, was dieser Vektor ist: Tats√§chlich handelt es sich um eine Wahrscheinlichkeitsverteilung, dh jede Zahl repr√§sentiert eine Wahrscheinlichkeit der Klasse 0,1,2 ..., 9.  Die Summe aller Zahlen im Vektor ist 1. In diesem Fall ist ersichtlich, dass das Modell sicher ist, dass das Eingabebild die Klasse 0 mit einer Wahrscheinlichkeit von 100% darstellt. </p><br><p>  Wenn wir dies in einem Histogramm darstellen, erhalten wir Folgendes: </p><br><p><img src="https://habrastorage.org/webt/_o/av/w9/_oavw9kqksofyiyjlg4z2jmf6_k.png" alt="Bild"></p><br><p>  Absolutes Vertrauen. </p><br><p>  Wenn das Modell die Klasse nicht bestimmen k√∂nnte, w√ºrde der Wahrscheinlichkeitsvektor zu einer gleichm√§√üigen Verteilung tendieren, was wiederum bedeuten w√ºrde, dass das Modell das Objekt allen Klassen gleichzeitig mit derselben Wahrscheinlichkeit zuweist.  Und das Histogramm w√ºrde so aussehen: </p><br><p><img src="https://habrastorage.org/webt/v1/qs/ek/v1qsek8agqisjs8geiy0bvdfq2y.png" alt="Bild"></p><br><p>  Es ist allgemein anerkannt, dass die Klasse eines Modells durch den Index der maximalen Anzahl in einem gegebenen Vektor bestimmt wird.  Das hei√üt, das Modell k√∂nnte theoretisch eine Klasse mit einer Wahrscheinlichkeit von mehr als 10% ausw√§hlen.  Diese Logik kann jedoch abh√§ngig von der von den Entwicklern beschriebenen Entscheidungslogik variieren. </p><br><p>  Kommen wir nun zum interessantesten Teil - den gegnerischen Angriffen. </p><br><p>  Um mit einem Modell in der FoolBox-Bibliothek arbeiten zu k√∂nnen, m√ºssen Sie das Modell zun√§chst in die Foolbox-Notation √ºbersetzen.  Sie k√∂nnen es so machen: </p><br><pre> <code class="python hljs">fmodel = foolbox.models.KerasModel(model,bounds=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#  bounds ,       ,        255,        0-1.</span></span></code> </pre> <br><p>  Danach k√∂nnen Sie verschiedene Angriffe testen.  Beginnen wir mit dem beliebtesten - FGSM: </p><br><h5 id="fgsm">  Fgsm </h5><br><pre> <code class="python hljs">attack = foolbox.attacks.FGSM(fmodel) <span class="hljs-comment"><span class="hljs-comment">#    FGSM     adversarial = attack(img.reshape(28,28,1),0) #  ,  adversarial  probs = model.predict(adversarial.reshape(1,28,28,1)) #     print(probs) #    print(np.argmax(probs)) #     </span></span></code> </pre> <br><p>  Die Ausgabe des neuronalen Netzwerks wird wie folgt sein </p><br><pre> <code class="plaintext hljs">[4.8592144e-01 2.5432981e-14 5.7048566e-13 1.6787202e-14 1.6875961e-11 1.2974949e-07 5.1407838e-01 3.9819957e-12 1.9827724e-09 5.7383300e-12] 6</code> </pre> <br><p>  Und das resultierende Bild: </p><br><p><img src="https://habrastorage.org/webt/m4/yc/yd/m4ycydwa2zhqfck-kelb3qlk2a8.png" alt="Bild"></p><br><p>  So wurde nun mit einer Wahrscheinlichkeit von mehr als 50% 0 als 6 erkannt. Bereits gut.  Wir wollen jedoch immer noch 1 und der Ger√§uschpegel ist nicht sehr beeindruckend.  Das Bild sieht wirklich unplausibel aus.  Dazu sp√§ter mehr.  Versuchen wir in der Zwischenzeit, die Angriffe einfach zu missachten.  Pl√∂tzlich bekommen wir immer noch 1. </p><br><h5 id="l-bfgs-ataka">  L-BFGS-Angriff </h5><br><pre> <code class="python hljs">attack = foolbox.attacks.LBFGSAttack(fmodel) adversarial = attack(img.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>) probs = model.predict(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) print(probs) print(np.argmax(probs))</code> </pre> <br><p>  Fazit: </p><br><pre> <code class="plaintext hljs">[4.7782943e-01, 1.9682934e-10, 1.0285517e-06, 3.2558936e-10, 6.5797998e-05, 4.0495447e-06, 2.5545436e-04, 3.4730587e-02, 5.5223148e-07, 4.8711312e-01] 9</code> </pre> <br><p>  Bild: </p><br><p><img src="https://habrastorage.org/webt/ax/oj/td/axojtdhkbk1ad1zlc7j-uv006i8.png" alt="Bild"></p><br><p>  Wieder von.  Jetzt haben wir 0 als 9 mit einer Wahrscheinlichkeit von ~ 49% erkannt.  Das Ger√§usch ist jedoch viel geringer. </p><br><p>  Lassen Sie uns mit einem zuf√§lligen Schlag enden.  Ein Beispiel wurde so ausgew√§hlt, dass es sehr schwierig w√§re, das Ergebnis zuf√§llig zu erhalten.  Jetzt haben wir nirgendwo angegeben, dass wir 1 bekommen wollen. Dementsprechend haben wir einen nicht zielgerichteten Angriff durchgef√ºhrt und geglaubt, dass wir immer noch Klasse 1 bekommen w√ºrden, aber dies ist nicht geschehen.  Daher lohnt es sich, gezielte Angriffe durchzuf√ºhren.  Verwenden wir die Foolbox-Dokumentation und suchen dort das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kriterienmodul</a> </p><br><p>  In diesem Modul k√∂nnen Sie ein Kriterium f√ºr einen Angriff ausw√§hlen, sofern es diese unterst√ºtzt.  Insbesondere interessieren uns zwei Kriterien: </p><br><ol><li>  TargetClass - bewirkt, dass im Vektor der Wahrscheinlichkeitsverteilungen das Element mit der Zahl k die maximale Wahrscheinlichkeit hat. </li><li>  TargetClassProbability - macht es so, dass im Vektor der Wahrscheinlichkeitsverteilungen ein Element mit der Zahl k eine Wahrscheinlichkeit von mindestens p hat. </li></ol><br><p>  Versuchen wir beides: </p><br><h5 id="l-bfgs--targetclass">  L-BFGS + TargetClass </h5><br><p>  Die Hauptsache in den TargetClass-Kriterien ist, die Wahrscheinlichkeit der Klasse k zu erhalten, die h√∂her ist als die Wahrscheinlichkeit einer anderen Klasse.  Dann wird das Netzwerk, das die Entscheidung einfach durch Betrachten der maximalen Wahrscheinlichkeit trifft, falsch sein. </p><br><pre> <code class="python hljs">attack = foolbox.attacks.LBFGSAttack(fmodel,foolbox.criteria.TargetClass(<span class="hljs-number"><span class="hljs-number">1</span></span>))<span class="hljs-comment"><span class="hljs-comment">#    ,     ,    TargetClass,  ,      ,      adversarial = attack(img.reshape(28,28,1),0) probs = model.predict(adversarial.reshape(1,28,28,1)) print(probs) print(np.argmax(probs))</span></span></code> </pre> <br><p>  Fazit: </p><br><pre> <code class="plaintext hljs">[3.2620126e-01 3.2813528e-01 8.5446298e-02 8.1292394e-04 1.1273423e-03 2.4886258e-02 3.3904776e-02 1.9947644e-01 8.2347924e-07 8.5878673e-06] 1</code> </pre> <br><p>  Bild: </p><br><p><img src="https://habrastorage.org/webt/ym/rp/pq/ymrppqvdtt7e_yfyinubsev03pm.png" alt="Bild"></p><br><p>  Wie aus der Schlussfolgerung hervorgeht, behauptet unser neuronales Netzwerk nun, dass es 1 mit einer Wahrscheinlichkeit von 32,8% ist, w√§hrend die Wahrscheinlichkeit von 0 so nahe wie m√∂glich an diesem Wert liegt und 32,6% betr√§gt.  Wir haben es geschafft!  Im Prinzip reicht dies bereits aus, um die Aufgabe abzuschlie√üen.  Wir werden aber noch weiter gehen und versuchen, eine Wahrscheinlichkeit von 1 √ºber 0,5 zu erhalten. </p><br><h5 id="l-bfgs--targetclassprobability">  L-BFGS + TargetClassProbability </h5><br><p>  Jetzt verwenden wir das Kriterium TargetClassProbability, mit dem Sie die Wahrscheinlichkeit einer Klasse in einem Objekt ermitteln k√∂nnen, das nicht niedriger als p ist.  Es hat nur zwei Parameter: <br>  1) Die Klassennummer des Objekts. <br>  2) Die Wahrscheinlichkeit dieser Klasse im gegnerischen Beispiel. <br>  Wenn es au√üerdem unm√∂glich ist, eine solche Wahrscheinlichkeit zu erreichen, oder die Zeit, um ein solches Objekt zu finden, zu lange dauert, ist das gegnerische Objekt gleich Null.  Sie k√∂nnen dies selbst √ºberpr√ºfen, indem Sie versuchen, die Wahrscheinlichkeit von beispielsweise 0,99 zu bestimmen.  Dann kann die Methode durchaus nicht konvergieren. </p><br><pre> <code class="python hljs">attack = foolbox.attacks.LBFGSAttack(fmodel,foolbox.criteria.TargetClassProbability(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0.5</span></span>)) adversarial = attack(img.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>) probs = model.predict(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) print(probs) print(np.argmax(probs))</code> </pre> <br><p>  Fazit: </p><br><pre> <code class="plaintext hljs">[4.2620126e-01 5.0013528e-01 9.5413298e-02 8.1292394e-04 1.1273423e-03 2.4886258e-02 3.3904776e-02 1.9947644e-01 8.2347924e-07 8.5878673e-06]</code> </pre> <br><p>  Hurra!  Es ist uns gelungen, ein gegnerisches Beispiel zu erhalten, bei dem die Wahrscheinlichkeit 1 f√ºr unser neuronales Netzwerk √ºber 50% liegt!  Gro√üartig!  Lassen Sie uns nun die Denormalisierung durchf√ºhren (das Bild auf das Format 0-255 zur√ºcksetzen) und es speichern. </p><br><p>  Das endg√ºltige Skript lautet wie folgt: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> foolbox <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> foolbox.criteria <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TargetClassProbability <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scipy.misc model = keras.models.load_model(<span class="hljs-string"><span class="hljs-string">"KerasModel.h5"</span></span>) img = Image.open(<span class="hljs-string"><span class="hljs-string">"ZeroSource.bmp"</span></span>) img = np.array(img.getdata()) img = img.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) img = img /<span class="hljs-number"><span class="hljs-number">255.</span></span> img = img.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) fmodel = foolbox.models.KerasModel(model,bounds=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) attack = foolbox.attacks.LBFGSAttack(fmodel,criterion=TargetClassProbability(<span class="hljs-number"><span class="hljs-number">1</span></span> ,p=<span class="hljs-number"><span class="hljs-number">.5</span></span>)) adversarial = attack(img[:,:,::<span class="hljs-number"><span class="hljs-number">-1</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>) adversarial = adversarial * <span class="hljs-number"><span class="hljs-number">255</span></span> adversarial = adversarial.astype(<span class="hljs-string"><span class="hljs-string">'int'</span></span>) scipy.misc.toimage(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>)).save(<span class="hljs-string"><span class="hljs-string">'AdversarialExampleZero.bmp'</span></span>)</code> </pre> <br><p>  Und das endg√ºltige Bild ist wie folgt: </p><br><p><img src="https://habrastorage.org/webt/1c/8i/ty/1c8ityrtcv46swzuc8yc545rw-4.png" alt="Bild">  . </p><br><h5 id="vyvody">  Schlussfolgerungen </h5><br><p>  Wie wir aus den obigen Beispielen gesehen haben, war es ziemlich einfach, ein neuronales Netzwerk zu t√§uschen.  Es gibt auch eine gro√üe Anzahl von Methoden, die dazu in der Lage sind.  √ñffnen Sie einfach die Liste der verf√ºgbaren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Angriffe in der Narrenbox</a> und versuchen Sie, sie anzuwenden.  Wir empfehlen, dass Sie versuchen, dasselbe selbst anzukurbeln, wobei Sie dasselbe neuronale Netzwerk und dasselbe Bild als Grundlage verwenden, die als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Referenz</a> verf√ºgbar sind.  Sie k√∂nnen Ihre Fragen in den Kommentaren hinterlassen.  Wir werden ihnen antworten! </p><br><p>  Denken Sie immer daran, dass die Algorithmen und Modelle, egal wie n√ºtzlich sie sind, f√ºr kleine Verschiebungen, die zu schwerwiegenden Fehlern f√ºhren k√∂nnen, √§u√üerst instabil sein k√∂nnen.  Daher empfehlen wir Ihnen, Ihre Modelle zu testen, bei denen Python und Tools wie Foolbox hilfreich sein k√∂nnen. </p><br><p>  Vielen Dank f√ºr Ihre Aufmerksamkeit! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443164/">https://habr.com/ru/post/de443164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443152/index.html">So blockieren Sie Microsoft Edge im Hintergrund unter Windows 10</a></li>
<li><a href="../de443154/index.html">Hintergrundbeleuchtung der DasKeyboard-Tastatur basierend auf Blutzucker mithilfe der REST-API</a></li>
<li><a href="../de443158/index.html">Nostalgie f√ºr die Halbwertszeit - Erstellen eines Pr√§fixes f√ºr einen Radiosender, um die Stimme und den Klang des Endes im Stil von M√§hdreschern zu empfangen</a></li>
<li><a href="../de443160/index.html">Die Zusammenfassung interessanter Materialien f√ºr den mobilen Entwickler # 289 (4. M√§rz - 10. M√§rz)</a></li>
<li><a href="../de443162/index.html">Anwendung von Matrix- und Kompetenzdiagrammen</a></li>
<li><a href="../de443166/index.html">Erstellen und aktualisieren Sie Mailinglisten in Zimbra Collaboration OSE basierend auf Active Directory-Gruppen und -Benutzern</a></li>
<li><a href="../de443174/index.html">hellOGL: OpenGL hallo Welt</a></li>
<li><a href="../de443176/index.html">7 Chrome-Erweiterungen zum Englischlernen</a></li>
<li><a href="../de443178/index.html">Crystal Blockchain Analytics: Untersuchung der Hacks und Diebstahlsf√§lle</a></li>
<li><a href="../de443180/index.html">Crew Dragon Landung und Asteroiden Videoaufnahme</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>