<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔔 🙅 🏂 Yang Perlu Anda Ketahui Tentang JavaScript Engine Switcher 3.0 🐖 📰 👩🏾‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JavaScript Engine Switcher awalnya dibuat sebagai perpustakaan bantu dan pengembangannya sebagian besar ditentukan oleh kebutuhan perpustakaan yang me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Yang Perlu Anda Ketahui Tentang JavaScript Engine Switcher 3.0</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439446/"><p><img src="https://habrastorage.org/webt/qo/zx/ss/qozxssedwxgcrteo4wnodfixdmy.png" alt="Logo untuk versi tiga dari JavaScript Engine Switcher"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JavaScript Engine Switcher</a> awalnya dibuat sebagai perpustakaan bantu dan pengembangannya sebagian besar ditentukan oleh kebutuhan perpustakaan yang menggunakannya.  Bahkan, masing-masing versi utamanya menyelesaikan satu atau beberapa tugas utama yang diperlukan untuk pengembangan lebih lanjut dari perpustakaan lain: </p><br><ol><li> Pada versi pertama, tugas ini adalah menambahkan sebanyak mungkin modul adaptor untuk mesin JS populer yang mendukung platform .NET.  Dan ini memberi pengguna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bundle Transformer</a> fleksibilitas: pada komputer pengembang, mereka dapat menggunakan modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MSIE</a> yang mendukung debugging kode JS menggunakan Visual Studio, dan pada server yang tidak memiliki versi Internet Explorer modern atau tidak diinstal sama sekali, mereka dapat menggunakan Modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V8</a> .  Beberapa bahkan berhasil menjalankan Bundle Transformer di Mono di Linux dan Mac menggunakan modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jurassic</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jint</a> . </li><li>  Tugas utama dari versi kedua adalah implementasi dukungan .NET Core, yang diperlukan untuk versi baru dari perpustakaan <a href="">ReactJS.NET</a> .  Tugas penting lainnya adalah pembuatan modul lintas-platform yang dapat dengan cepat memproses sejumlah besar kode JS (modul Jurassic dan Jint tidak cocok untuk ini), dan setelah sejumlah perbaikan, modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ChakraCore</a> menjadi modul semacam itu. </li><li>  Dalam versi ketiga, fokus utamanya adalah meningkatkan integrasi dengan perpustakaan ReactJS.NET dan meningkatkan produktivitas. </li></ol><br><p> Dalam artikel ini, kami akan mempertimbangkan beberapa inovasi dari versi ketiga, yang bagi banyak orang ternyata tidak terlihat bahkan setelah membaca <a href="">teks rilis</a> dan bagian dokumentasi <a href="">"Cara meningkatkan aplikasi ke versi 3.X"</a> : perubahan dalam kelas <code>JsEngineSwitcher</code> , <code>JsEngineSwitcher</code> kembali pengecualian, pesan kesalahan yang lebih informatif, gangguan dan kompilasi skrip pendahuluan, kemampuan untuk mengubah ukuran tumpukan maksimum dalam modul ChakraCore dan MSIE, serta modul baru berdasarkan NiL.JS. </p><a name="habracut"></a><br><h2>  Perubahan ke Kelas JsEngineSwitcher </h2><br><p>  Dalam versi baru, kelas <code>JsEngineSwitcher</code> mengimplementasikan antarmuka <code>IJsEngineSwitcher</code> dan bukan lagi singleton (Anda bisa instantiate menggunakan operator <code>new</code> ).  Untuk mendapatkan instance global, alih-alih properti <code>Instance</code> , gunakan properti <code>Current</code> .  Properti <code>Current</code> ini, tidak seperti properti <code>Instance</code> sudah tidak digunakan lagi, memiliki tipe pengembalian <code>IJsEngineSwitcher</code> .  Juga, properti <code>Current</code> memiliki penyetel, yang dengannya Anda dapat mengganti implementasi standar dengan milik Anda sendiri: </p><br><pre> <code class="cs hljs">JsEngineSwitcher.Current = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyJsEngineSwitcher();</code> </pre> <br><p>  Dalam aplikasi web ASP.NET Core yang memiliki paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JavaScriptEngineSwitcher.Extensions.MsDependencyInjection</a> diinstal, implementasinya diganti menggunakan <code>AddJsEngineSwitcher</code> ekstensi <code>AddJsEngineSwitcher</code> : </p><br><pre> <code class="cs hljs">… <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Extensions.MsDependencyInjection; … <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { … <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IServiceCollection services</span></span></span><span class="hljs-function">)</span></span> { … services.AddJsEngineSwitcher(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyJsEngineSwitcher(), options =&gt; … ) … ; … } … } …</code> </pre> <br><p>  Perubahan ini hampir selalu “memecah” aplikasi atau pustaka yang menggunakan versi JavaScript Engine Switcher sebelumnya.  Karena itu, Anda perlu membuat perubahan berikut pada kode Anda: </p><br><ol><li>  Ubah jenis variabel, parameter, atau properti dari <code>JsEngineSwitcher</code> ke <code>IJsEngineSwitcher</code> . </li><li>  Alih-alih properti <code>Instance</code> , gunakan properti <code>Current</code> mana-mana. </li></ol><br><p>  Perlu juga dicatat bahwa bagi sebagian besar pengembang, perubahan ini tidak akan bermanfaat khususnya, karena tujuan utama mereka adalah untuk menyederhanakan tes unit (misalnya, sebelumnya, dalam tes unit perpustakaan ReactJS.NET, kunci telah <a href="">digunakan</a> , tetapi sekarang Anda dapat <a href="">melakukannya tanpa mereka</a> ). </p><br><h2>  Reorganisasi Pengecualian </h2><br><p>  Sebelum versi ketiga, sebagian besar kesalahan mesin JS berubah menjadi <code>JsRuntimeException</code> , dan hanya kesalahan yang terjadi selama proses inisialisasi mesin berubah menjadi <code>JsEngineLoadException</code> .  Ada juga kelas dasar <code>JsException</code> , dari mana dua jenis pengecualian di atas diwariskan, yang memungkinkan untuk mencegat sepenuhnya semua kesalahan yang terjadi selama pengoperasian mesin JS.  Meskipun ada kelemahan yang jelas, organisasi pengecualian ini sangat cocok dengan konsep antarmuka terpadu untuk mengakses kemampuan dasar mesin JS. </p><br><p>  Tetapi dengan implementasi interupsi dan pra-kompilasi skrip (saya akan membahasnya di bagian berikut), perlu muncul pendekatan baru untuk mengatur pengecualian.  Hal pertama yang harus dilakukan adalah menambahkan tipe pengecualian baru - <code>JsInterruptedException</code> , yang diperlukan untuk memberi tahu pengguna tentang gangguan eksekusi skrip.  Maka itu perlu untuk secara eksplisit membagi semua kesalahan yang terjadi selama pemrosesan skrip menjadi dua kelompok: kesalahan kompilasi (parsing) dan kesalahan runtime.  Itu juga diperlukan untuk memisahkan semua jenis kesalahan khusus Chakra dan V8, yang tidak terkait dengan pemrosesan skrip.  Itu juga perlu untuk mempertimbangkan keberadaan pengecualian di mesin Jint yang terjadi ketika periode waktu habis untuk menjalankan skrip (batas waktu) telah berlalu.  Akibatnya, pendekatan baru untuk organisasi pengecualian dibentuk, yang dapat direpresentasikan sebagai struktur hierarkis berikut: </p><br><ul><li> <code>JsException</code> <br> <ul><li> <code>JsEngineException</code> <br> <ul><li> <code>JsEngineLoadException</code> </li> </ul></li><li> <code>JsFatalException</code> </li> <li> <code>JsScriptException</code> <br> <ul><li> <code>JsCompilationException</code> </li> <li> <code>JsRuntimeException</code> <br> <ul><li> <code>JsInterruptedException</code> </li> <li> <code>JsTimeoutException</code> </li> </ul></li></ul></li><li> <code>JsUsageException</code> </li> </ul></li><li>  <code>JsEngineNotFoundException</code> <sup>*</sup> </li></ul><br><p>  * - pengecualian ini tidak terjadi pada level mesin JS, tetapi pada level JavaScript Engine Switcher. </p><br><p>  Saya pikir hierarki pengecualian yang disajikan di atas tidak perlu komentar, karena nama-nama pengecualian tersebut berbicara sendiri.  Dengan pendekatan ini, kami tidak hanya mendapatkan lebih banyak informasi tentang penyebab kesalahan, tetapi juga dapat lebih fleksibel menangani beberapa jenis pengecualian tertentu. </p><br><h2>  Format pesan kesalahan terpadu </h2><br><p>  Masalah lain dengan versi sebelumnya dari JavaScript Engine Switcher adalah kesulitan dalam menemukan kesalahan yang terjadi saat memproses skrip.  Dari properti Pengecualian <code>Message</code> , sulit untuk memahami persis di mana kesalahan terjadi dalam kode, jadi saya harus menganalisis properti pengecualian lainnya, yang tidak selalu nyaman.  Selain itu, himpunan properti yang ada juga tidak cukup. </p><br><p>  Oleh karena itu, 2 properti baru ditambahkan ke kelas <code>JsScriptException</code> : </p><br><ol><li>  <strong>Jenis</strong> - jenis kesalahan JavaScript (misalnya, <code>SyntaxError</code> atau <code>TypeError</code> ); </li><li>  <strong>DocumentName</strong> - nama dokumen (biasanya diekstraksi dari nilai parameter berikut: <code>documentName</code> dari metode <code>Execute</code> and <code>Evaluate</code> , <code>path</code> metode <code>ExecuteFile</code> , <code>resourceName</code> metode <code>ExecuteResource</code> , dll.); </li></ol><br><p>  Satu properti baru juga telah ditambahkan ke kelas <strong>JsRuntimeException</strong> - <strong>CallStack</strong> , yang berisi representasi string dari tumpukan panggilan. </p><br><p>  Sebelumnya, nilai dari properti serupa dari pengecualian .NET asli atau representasi string dari kesalahan JavaScript hanya disalin ke properti <code>Message</code> .  Seringkali, pesan kesalahan di mesin JS yang berbeda tidak hanya berbeda dalam format, tetapi juga dalam jumlah informasi berguna yang disajikan di dalamnya.  Misalnya, karena kurangnya informasi nomor baris dan kolom dalam beberapa pesan kesalahan, pengembang perpustakaan ReactJS.NET terpaksa <a href="">melempar kembali pengecualian yang</a> diterima dari JavaScript Engine Switcher. </p><br><p>  Oleh karena itu, saya memutuskan untuk membuat pesan kesalahan sendiri di tingkat modul adaptor, yang akan memiliki format tunggal (terpadu).  Format ini menggunakan semua informasi kesalahan yang tersedia: jenis, deskripsi, nama dokumen, nomor baris, nomor kolom, fragmen kode dan tumpukan panggilan.  Sebagai dasar untuk format baru, saya mengambil format kesalahan dari perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Microsoft ClearScript</a> . </p><br><p>  Di bawah ini adalah pesan tentang kesalahan kompilasi yang sama yang dihasilkan oleh modul adaptor yang berbeda: </p><br><pre> <code class="plaintext hljs">ChakraCore ========== SyntaxError: Unexpected identifier after numeric literal at declinationOfSeconds.js:12:23 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; Jint ==== SyntaxError: Unexpected token ILLEGAL at declinationOfSeconds.js:12:25 Jurassic ======== SyntaxError: Expected operator but found 'O' at declinationOfSeconds.js:12 MSIE   Classic ===================== SyntaxError: Expected ';' at declinationOfSeconds.js:12:25 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; MSIE   Chakra ActiveScript ================================= SyntaxError: Expected ';' at declinationOfSeconds.js:12:25 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; MSIE   Chakra IE JsRT ============================ SyntaxError: Expected ';' at 12:25 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; MSIE   Chakra Edge JsRT ============================== SyntaxError: Unexpected identifier after numeric literal at declinationOfSeconds.js:12:23 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; NiL === SyntaxError: Unexpected token 'O' at 12:25 V8 == SyntaxError: Invalid or unexpected token at declinationOfSeconds.js:12:24 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; Vroom ===== SyntaxError: Unexpected token ILLEGAL at declinationOfSeconds.js:12:24</code> </pre> <br><p>  Contoh serupa untuk kesalahan runtime: </p><br><pre> <code class="plaintext hljs">ChakraCore ========== TypeError: Unable to get property '' of undefined or null reference at transliterate (russian-translit.js:929:4) -&gt; newCharValue = typeof charMapping[charValue] !== 'undefined' ? at Global code (Script Document:1:1) Jint ==== TypeError: charMapping is undefined at russian-translit.js:929:26 Jurassic ======== TypeError: undefined cannot be converted to an object at transliterate (russian-translit.js:929) at Global code (Script Document:1) MSIE   Classic ===================== TypeError: 'undefined' is null or not an object at russian-translit.js:929:4 MSIE   Chakra ActiveScript ================================= TypeError: Unable to get property '' of undefined or null reference at russian-translit.js:929:4 MSIE   Chakra IE JsRT ============================ TypeError: Unable to get property '' of undefined or null reference at transliterate (russian-translit.js:929:4) at Global code (Script Document:1:1) MSIE   Chakra Edge JsRT ============================== TypeError: Unable to get property '' of undefined or null reference at transliterate (russian-translit.js:929:4) at Global code (Script Document:1:1) NiL === TypeError: Can't get property "" of "undefined" V8 == TypeError: Cannot read property '' of undefined at transliterate (russian-translit.js:929:37) -&gt; newCharValue = typeof charMapping[charValue] !== 'undefined' ? at Script Document:1:1 Vroom ===== TypeError: Cannot read property '' of undefined at russian-translit.js:929:37</code> </pre> <br><p>  Seperti yang dapat Anda lihat dari contoh, beberapa mesin JS memberi kami deskripsi kesalahan dan nomor kolom yang sama sekali berbeda, dan kami tidak dapat selalu mendapatkan serangkaian data kesalahan yang lengkap, tetapi meskipun ada kekurangan ini, format terpadu ini memberi kami informasi lebih banyak tentang lokasi kesalahan daripada pesan kesalahan asli. </p><br><h2>  Tips Penerapan Majelis Asli </h2><br><p>  Penyebab utama kesalahan ketika bekerja dengan versi kedua dari JavaScript Engine Switcher adalah bahwa banyak pengembang lupa untuk menginstal paket NuGet yang berisi rakitan asli untuk modul ChakraCore dan V8.  Pada suatu waktu, sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pos di bugtracker ReactJS.NET</a> juga dikhususkan untuk masalah ini ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">terjemahan Rusia</a> juga tersedia).  Sekarang, kesalahan seperti itu hanya ditemui oleh pemula yang, karena alasan tertentu, tidak membaca dokumentasi. </p><br><p>  Para penulis ReactJS.NET mencoba meminimalkan jumlah kesalahan seperti itu dengan menggunakan petunjuk di dalam pesan kesalahan, tetapi <a href="">implementasi</a> pendekatan ini yang <a href="">tidak terlalu berhasil</a> menyebabkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kebingungan yang lebih besar</a> .  Gagasan tentang petunjuk itu bagus, tetapi membutuhkan implementasi yang berbeda secara mendasar, yaitu implementasi pada tingkat modul adaptor mesin JS.  Di versi baru JavaScript Engine Switcher, petunjuk seperti itu ditambahkan ke pesan kesalahan saat membungkus pengecualian <code>TypeLoadException</code> dan <code>TypeLoadException</code> <code>JsEngineLoadException</code> (lihat contoh implementasi untuk <a href="">modul ChakraCore</a> , <a href="">V8</a> dan <a href="">Vroom</a> ).  Apalagi tips ini cerdas, karena  generasi mereka memperhitungkan sejumlah faktor: jenis sistem operasi, arsitektur prosesor, dan runtime (.NET Framework, .NET Core atau Mono). </p><br><p>  Misalnya, ketika menggunakan modul ChakraCore tanpa perakitan asli dalam proses 64-bit pada sistem operasi Windows, pesan kesalahan akan terlihat seperti ini: </p><br><blockquote>  Gagal membuat instance dari ChakraCoreJsEngine.  Kemungkinan besar itu terjadi, karena perakitan 'ChakraCore.dll' atau salah satu dari dependensinya tidak ditemukan.  Cobalah untuk menginstal paket JavaScriptEngineSwitcher.ChakraCore.Native.win-x64 via NuGet.  Selain itu, Anda masih perlu menginstal Microsoft Visual C ++ Redistributable untuk Visual Studio 2017 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://www.visualstudio.com/downloads/#microsoft-visual-c-redistributable-for-visual-studio-2017</a> ). </blockquote><br><p>  Pesan kesalahan memberikan petunjuk bahwa Anda perlu menginstal paket JavaScript NuGetEngineSwitcher.ChakraCore.Native.win-x64, dan juga menyebutkan bahwa ChakraCore untuk Windows memerlukan komponen Microsoft Visual C ++ yang dapat didistribusikan untuk Visual Studio 2017 agar berfungsi. terjadi dalam proses 32-bit, pengguna akan diminta untuk menginstal paket JavaScriptEngineSwitcher.ChakraCore.Native.win-x86. </p><br><p>  Pesan kesalahan serupa di Linux di .NET Core akan terlihat seperti ini: </p><br><blockquote>  Gagal membuat instance dari ChakraCoreJsEngine.  Kemungkinan besar itu terjadi, karena perakitan 'libChakraCore.so' atau salah satu dependensinya tidak ditemukan.  Cobalah untuk menginstal paket JavaScriptEngineSwitcher.ChakraCore.Native.linux-x64 via NuGet. </blockquote><br><p>  Dalam hal ini, disarankan untuk menginstal paket JavaScriptEngineSwitcher.ChakraCore.Native.linux-x64. </p><br><p>  Ketika diluncurkan di Mono, prompt lain akan ditampilkan: </p><br><blockquote>  ... JavaScriptEngineSwitcher.ChakraCore.Native.linux- * paket tidak mendukung instalasi di bawah Mono, tetapi Anda dapat menginstal rakitan asli secara manual ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/Taritsyn/JavaScriptEngineSwitcher/wiki/ChakraCore#linux</a> ). </blockquote><br><p>  Karena paket JavaScriptEngineSwitcher.ChakraCore.Native.linux-x64 hanya kompatibel dengan .NET Core, tooltip akan memberikan tautan ke instruksi untuk secara manual menggunakan perakitan asli di Linux. </p><br><p>  Banyak lagi contoh yang bisa diberikan, tetapi ini tidak masuk akal. </p><br><h2>  Membatalkan Eksekusi Skrip </h2><br><p>  Ketika kami memberi pengguna kesempatan untuk mengeksekusi kode JS sewenang-wenang di server, kami dihadapkan pada satu masalah yang sangat serius - kami tidak tahu berapa lama waktu yang diperlukan untuk mengeksekusi kode ini.  Ini mungkin sejumlah besar kode tidak optimal atau kode yang menjalankan infinite loop.  Bagaimanapun, itu akan menjadi kode yang tidak terkontrol yang akan menghabiskan sumber daya dari server kami tanpa batas.  Untuk setidaknya mengendalikan proses ini, kita perlu kemampuan untuk menghentikan eksekusi skrip.  Saat menggunakan mesin yang ditulis dalam .NET murni (misalnya, Jint, Jurassic atau NiL.JS), kami selalu dapat mulai menjalankan kode JS sebagai tugas dengan kemampuan untuk membatalkan, tetapi pendekatan ini tidak akan bekerja untuk mesin lain.  Untungnya bagi kami, mesin C ++ memiliki mekanisme bawaan untuk mengganggu skrip. </p><br><p>  Untuk memberikan akses ke mekanisme ini, properti <code>SupportsScriptInterruption</code> dan metode <code>Interrupt</code> ditambahkan ke antarmuka <code>IJsEngine</code> .  Karena tidak semua mesin mendukung fitur ini, Anda harus selalu memeriksa nilai properti <code>SupportsScriptInterruption</code> sebelum memanggil metode <code>Interrupt</code> (jika dalam versi sebelumnya dari JavaScript Engine Switcher Anda harus menjalankan pengumpul sampah secara manual, Anda akan segera mengerti apa yang saya bicarakan): </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (engine.SupportsScriptInterruption) { engine.Interrupt(); }</code> </pre> <br><p>  Dan Anda perlu memanggil metode ini di utas terpisah berbeda dari utas tempat skrip dieksekusi.  Setelah memanggil metode <code>Interrupt</code> , semua yang sebelumnya menjalankan metode <code>Evaluate</code> , <code>Execute*</code> dan <code>CallFunction</code> akan diakhiri dengan <code>JsInterruptedException</code> . </p><br><p>  Karena API ini tingkat rendah, disarankan untuk menggunakan metode ekstensi seperti berikut ini untuk tugas-tugas yang dijelaskan di awal bagian: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> !NET40 using System.Runtime.ExceptionServices; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> using System.Threading; using System.Threading.Tasks; using JavaScriptEngineSwitcher.Core; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 using JavaScriptEngineSwitcher.Core.Extensions; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> using JavaScriptEngineSwitcher.Core.Resources; … /// &lt;summary&gt; /// Extension methods for &lt;see cref="IJsEngine"/&gt; /// &lt;/summary&gt; public static class JsEngineExtensions { /// &lt;summary&gt; /// Evaluates an expression within a specified time interval /// &lt;/summary&gt; /// &lt;typeparam name="T"&gt;Type of result&lt;/typeparam&gt; /// &lt;param name="engine"&gt;JS engine&lt;/param&gt; /// &lt;param name="expression"&gt;JS expression&lt;/param&gt; /// &lt;param name="timeoutInterval"&gt;Interval to wait before the /// script execution times out&lt;/param&gt; /// &lt;param name="documentName"&gt;Document name&lt;/param&gt; /// &lt;returns&gt;Result of the expression&lt;/returns&gt; /// &lt;exception cref="ObjectDisposedException"/&gt; /// &lt;exception cref="ArgumentNullException"/&gt; /// &lt;exception cref="ArgumentException"/&gt; /// &lt;exception cref="JsCompilationException"/&gt; /// &lt;exception cref="JsTimeoutException"/&gt; /// &lt;exception cref="JsRuntimeException"/&gt; /// &lt;exception cref="JsException"/&gt; public static T Evaluate&lt;T&gt;(this IJsEngine engine, string expression, TimeSpan timeoutInterval, string documentName) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (engine == null) { throw new ArgumentNullException(nameof(engine)); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (engine.SupportsScriptInterruption) { using (var timer = new Timer(state =&gt; engine.Interrupt(), null, timeoutInterval, #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 new TimeSpan(0, 0, 0, 0, -1))) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> Timeout.InfiniteTimeSpan)) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> { try { return engine.Evaluate&lt;T&gt;(expression, documentName); } catch (JsInterruptedException e) { throw new JsTimeoutException( Strings.Runtime_ScriptTimeoutExceeded, e.EngineName, e.EngineVersion, e ); } } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 Task&lt;T&gt; task = Task.Factory.StartNew(() =&gt; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> Task&lt;T&gt; task = Task.Run(() =&gt; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> { return engine.Evaluate&lt;T&gt;(expression, documentName); }); bool isCompletedSuccessfully = false; try { isCompletedSuccessfully = task.Wait(timeoutInterval); } catch (AggregateException e) { Exception innerException = e.InnerException; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (innerException != null) { #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 innerException.PreserveStackTrace(); throw innerException; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> ExceptionDispatchInfo.Capture(innerException).Throw(); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { throw; } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (isCompletedSuccessfully) { return task.Result; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { throw new JsTimeoutException( Strings.Runtime_ScriptTimeoutExceeded, engine.Name, engine.Version ); } } } … } …</span></span></code> </pre> <br><p>  Metode ini merupakan add-on pada metode engine <code>Evaluate&lt;T&gt;</code> , yang memungkinkan penggunaan parameter <code>timeoutInterval</code> mengatur batas waktu menunggu skrip dijalankan.  Prinsip operasi metode ekstensi ini sangat sederhana.  Pertama, kami memeriksa apakah mesin kami mendukung mekanisme interupsi bawaan.  Jika ya, kita membuat instance kelas <code>Timer</code> , yang, setelah interval <code>timeoutInterval</code> ditentukan dalam parameter <code>timeoutInterval</code> , memulai metode <code>Interrupt</code> , kemudian kita memanggil metode mesin <code>Evaluate&lt;T&gt;</code> , dan jika ada kesalahan, tangkap <code>JsInterruptedException</code> dan bungkus dalam <code>JsTimeoutException</code> .  Jika mesin tidak mendukung interupsi, kemudian buat instance kelas <code>Task</code> yang memulai metode <code>Evaluate&lt;T&gt;</code> , kemudian tetapkan interval tunggu untuk tugas yang harus diselesaikan sama dengan nilai dari parameter <code>timeoutInterval</code> , dan jika tugas selesai dengan batas waktu, kemudian <code>JsTimeoutException</code> jenis <code>JsTimeoutException</code> .  Berikut ini adalah contoh penggunaan metode ekstensi ini: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; … <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core.Helpers; … <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { … <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> expression = <span class="hljs-string"><span class="hljs-string">@"function getRandomInt(minValue, maxValue) { minValue = Math.ceil(minValue); maxValue = Math.floor(maxValue); return Math.floor(Math.random() * (maxValue - minValue + 1)) + minValue; } function sleep(millisecondsTimeout) { var totalMilliseconds = new Date().getTime() + millisecondsTimeout; while (new Date().getTime() &lt; totalMilliseconds) { } } var randomNumber = getRandomInt(1, 10); sleep(randomNumber * 1000); randomNumber;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (IJsEngine engine = JsEngineSwitcher.Current.CreateDefaultEngine()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = engine.Evaluate&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(expression, TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">"randomNumber.js"</span></span>); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">" = {0}"</span></span>, result); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsTimeoutException) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"    JavaScript "</span></span> + <span class="hljs-string"><span class="hljs-string">"   !"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"   JavaScript-  "</span></span> + <span class="hljs-string"><span class="hljs-string">"!"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); } } } … } …</code> </pre> <br><p>  Menggunakan metode ekstensi, kami menghitung hasil dari ekspresi JS.  Hasil dari ekspresi adalah bilangan bulat acak, dan angka ini juga merupakan jumlah detik dimana ekspresi ini tertunda.  Juga, saat memanggil metode ekstensi, kami menentukan interval tunggu 3 detik.  Karena waktu untuk menghitung ekspresi bervariasi dari 1 hingga 10 detik, dalam satu kasus hasil ekspresi akan ditampilkan di konsol, dan di lain, pesan tentang batas waktu. </p><br><p>  Seharusnya tidak sulit bagi Anda untuk membuat ulang metode ekstensi ini untuk memanggil metode engine lainnya (misalnya, untuk <code>Execute*</code> , <code>CallFunction</code> , atau versi lain dari metode <code>Evaluate</code> ).  Sejauh ini saya belum memutuskan apakah saya akan menambahkan metode ekstensi seperti itu ke perpustakaan itu sendiri, karena belum jelas berapa banyak mereka akan diminati. </p><br><h2>  Prompilasi skrip </h2><br><p>  Saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diminta untuk</a> menambahkan dukungan untuk penyusunan skrip awal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pada tahun 2015</a> .  Pada saat itu, tidak jelas bagaimana fungsi tersebut dapat masuk ke dalam konsep antarmuka terpadu.  Tetapi seiring berjalannya waktu, dukungan untuk fitur aksesibilitas seperti pengumpulan sampah dan gangguan skrip secara bertahap mulai muncul di JavaScript Engine Switcher.  Pada tahap terakhir pekerjaan pada versi ketiga, giliran datang ke kompilasi awal. </p><br><p>  Menggunakan pra-kompilasi, Anda dapat mengkompilasi skrip sekali dan kemudian menggunakannya berkali-kali untuk menginisialisasi mesin JS.  Karena fakta bahwa skrip pra-kompilasi tidak memerlukan parsing, inisialisasi mesin akan lebih cepat. </p><br><p>  Saat ini, pra-kompilasi didukung oleh 5 modul adaptor: ChakraCore, Jint, Jurassic, MSIE (hanya dalam mode JsRT) dan V8.  Untuk memberikan akses ke mekanisme mesin yang sesuai, properti <code>SupportsScriptPrecompilation</code> dan 3 metode baru ditambahkan ke antarmuka <code>Precompile</code> : <code>Precompile</code> , <code>PrecompileFile</code> , dan <code>PrecompileResource</code> .  <code>Precompile*</code> mengembalikan instance objek yang mengimplementasikan antarmuka <code>IPrecompiledScript</code> .  Objek ini adalah skrip pra-kompilasi yang dapat digunakan oleh mesin contoh yang berbeda (versi kelebihan dari metode <code>Execute</code> berfungsi untuk tujuan ini).  Pertimbangkan contoh sederhana menggunakan API ini: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; … <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core.Helpers; … <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { … <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> sourceCode = <span class="hljs-string"><span class="hljs-string">@"function declinationOfSeconds(number) { var result, titles = ['', '', ''], titleIndex, cases = [2, 0, 1, 1, 1, 2], caseIndex ; if (number % 100 &gt; 4 &amp;&amp; number % 100 &lt; 20) { titleIndex = 2; } else { caseIndex = number % 10 &lt; 5 ? number % 10 : 5; titleIndex = cases[caseIndex]; } result = number + ' ' + titles[titleIndex]; return result; }"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> functionName = <span class="hljs-string"><span class="hljs-string">"declinationOfSeconds"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> itemCount = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] inputSeconds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[itemCount] { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">600</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] outputStrings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[itemCount]; IJsEngineSwitcher engineSwitcher = JsEngineSwitcher.Current; IPrecompiledScript precompiledCode = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> engine = engineSwitcher.CreateDefaultEngine()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!engine.SupportsScriptPrecompilation) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"{0}  {1}   "</span></span> + <span class="hljs-string"><span class="hljs-string">"  !"</span></span>, engine.Name, engine.Version); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { precompiledCode = engine.Precompile(sourceCode, <span class="hljs-string"><span class="hljs-string">"declinationOfSeconds.js"</span></span>); engine.Execute(precompiledCode); outputStrings[<span class="hljs-number"><span class="hljs-number">0</span></span>] = engine.CallFunction&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(functionName, inputSeconds[<span class="hljs-number"><span class="hljs-number">0</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsCompilationException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"     "</span></span> + <span class="hljs-string"><span class="hljs-string">" !"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"   JavaScript-  "</span></span> + <span class="hljs-string"><span class="hljs-string">"!"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> itemIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; itemIndex &lt; itemCount; itemIndex++) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> engine = engineSwitcher.CreateDefaultEngine()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { engine.Execute(precompiledCode); outputStrings[itemIndex] = engine.CallFunction&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;( functionName, inputSeconds[itemIndex]); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"   JavaScript- "</span></span> + <span class="hljs-string"><span class="hljs-string">" !"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> itemIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; itemIndex &lt; itemCount; itemIndex++) { Console.WriteLine(outputStrings[itemIndex]); } } … } …</code> </pre> <br><p>    ,         .     <code>SupportsScriptPrecompilation</code>  ,       ,  ,     .     <code>Precompile</code>  ,      ,      <code>JsCompilationException</code> . C   <code>Execute</code>      , ..   .     <code>CallFunction</code>   <code>declinationOfSeconds</code>      .     .   ,    ,           .     3        .  ,        ,        .         ,    ,      . </p><br><p>      ,     ,    .   ,  ,           .       ReactJS.NET.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JSPool</a> ,         ( <code>System.Runtime.Caching.MemoryCache</code>  .NET Framework 4.X, <code>System.Web.Caching.Cache</code>  ASP.NET 4.X  <code>Microsoft.Extensions.Caching.Memory.IMemoryCache</code>  ASP.NET Core).      ,        (       <a href=""> </a> ).    ,       ReactJS.NET. </p><br><p>      ReactJS.NET .              .        <code>AllowJavaScriptPrecompilation</code>   <code>true</code> . </p><br><p>  ASP.NET 4.X       <code>App_Start/ReactConfig.cs</code> : </p><br><pre> <code class="cs hljs">… <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ReactConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ReactSiteConfiguration.Configuration … .SetAllowJavaScriptPrecompilation(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) … ; … } } …</code> </pre> <br><p>  ASP.NET Core      <code>Startup.cs</code> : </p><br><pre> <code class="cs hljs">… <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { … <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IApplicationBuilder app, IHostingEnvironment env</span></span></span><span class="hljs-function">)</span></span> { … app.UseReact(config =&gt; { config … .SetAllowJavaScriptPrecompilation(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) … ; }); app.UseStaticFiles(); … } } …</code> </pre> <br><p>       ,      .       <a href="">JsExecutionBenchmark</a> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">BenchmarkDotNet</a> .        JS-     .    14,9 ,     ,       .          JavaScript Engine Switcher ( 3.0.4). </p><br><p>   ,      .NET Framework 4.7.2: </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup>. </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td rowspan="2"> <sup>ChakraCore</sup> </td><td> <sup></sup> </td><td align="right"> <sup>41,72 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>74,46 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>35,07 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>91,79 </sup> </td></tr><tr><td rowspan="2"> <sup>Jint</sup> </td><td> <sup></sup> </td><td align="right"> <sup>27,19 </sup> </td><td align="right"> <sup>2 812,50</sup> </td><td align="right"> <sup>1 343,75</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>16 374,58 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>15,54 </sup> </td><td align="right"> <sup>1 296,88</sup> </td><td align="right"> <sup>640,63</sup> </td><td align="right"> <sup>31,25</sup> </td><td align="right"> <sup>7 521,49 </sup> </td></tr><tr><td rowspan="2"> <sup>Jurassic</sup> </td><td> <sup></sup> </td><td align="right"> <sup>455,70 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>15 575,28 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>78,70 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>7 892,94 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra IE JsRT</sup> </td><td> <sup></sup> </td><td align="right"> <sup>30,97 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>77,75 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>24,40 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>90,58 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra Edge JsRT</sup> </td><td> <sup></sup> </td><td align="right"> <sup>33,14 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>78,40 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>32,86 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>95,48 </sup> </td></tr><tr><td rowspan="2"> <sup>V8</sup> </td><td> <sup></sup> </td><td align="right"> <sup>41,10 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>79,33 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>39,25 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>96,17 </sup> </td></tr></tbody></table><br><p>         ,    .NET —     Jurassic  5,79 ,   Jint  1,75 a.      2     ,      2       .                .      Jurassic,          : Jurassic   JS-  IL-  Reflection.Emit,    .        ,          ,      . Jint           .NET-,    .    Jint      ,             .      ,  Jint    ,    ,            .  Jint  Jurassic        . </p><br><p>      ,   C++,  MSIE   Chakra IE JsRT —     26,93%.    ChakraCore (18,96%),  V8 (4,71%)  MSIE   Chakra Edge JsRT    (0,85%).           Internet Explorer    Edge.            .          (   )      .   ,      -         12-17  (       ).         .       .         . </p><br><p>     .NET Core 2.0    ( V8 ,    Microsoft ClearScript,    ,   .NET Core): </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup>. </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td rowspan="2"> <sup>ChakraCore</sup> </td><td> <sup></sup> </td><td align="right"> <sup>43,65 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>18,07 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>36,37 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>16,59 </sup> </td></tr><tr><td rowspan="2"> <sup>Jint</sup> </td><td> <sup></sup> </td><td align="right"> <sup>24,87 </sup> </td><td align="right"> <sup>2 750,00</sup> </td><td align="right"> <sup>1 375,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>16 300,25 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>15,25 </sup> </td><td align="right"> <sup>1 281,25</sup> </td><td align="right"> <sup>593,75</sup> </td><td align="right"> <sup>62,50</sup> </td><td align="right"> <sup>7 447,44 </sup> </td></tr><tr><td rowspan="2"> <sup>Jurassic</sup> </td><td> <sup></sup> </td><td align="right"> <sup>469,97 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>15 511,70 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>80,72 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>7 845,98 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra IE JsRT</sup> </td><td> <sup></sup> </td><td align="right"> <sup>31,50 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>20,28 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>24,52 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>18,78 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra Edge JsRT</sup> </td><td> <sup></sup> </td><td align="right"> <sup>35,54 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>20,45 </sup> </td></tr><tr><td> <sup></sup> </td><td align="right"> <sup>31,44 </sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>18,99 </sup> </td></tr></tbody></table><br><p>      . ,     —  MSIE   Chakra Edge JsRT  (7,69%).           Chakra    . </p><br><h2>        ChakraCore  MSIE </h2><br><p>    ,  Microsoft,    ,    .     IIS    (256   32-   512   64-),     ASP.NET  JS- (,  TypeScript)   .       JavaScript Engine Switcher        .             ,        Node.js (492   32-   984   64-).   ,      ,  -    .        ChakraCore  MSIE    <code>MaxStackSize</code> ,          .         Node.js.       ,             . </p><br><h2>     NiL.JS </h2><br><p>      - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">NiL</a> ,      <a href="">NiL.JS</a> . NiL.JS —    JS-,    .NET.      2014 ,        Jurassic  Jint.    —  .         ,       . </p><br><p>     .NET Framework 4.7.2    : </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td> <sup>Jint</sup> </td><td align="right"> <sup>27,19 </sup> </td><td align="right"> <sup>2 812,50</sup> </td><td align="right"> <sup>1 343,75</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>16 374,58 </sup> </td></tr><tr><td> <sup>Jurassic</sup> </td><td align="right"> <sup>455,70 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>15 575,28 </sup> </td></tr><tr><td> <sup>NiL</sup> </td><td align="right"> <sup>17,80 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>4 424,09 </sup> </td></tr></tbody></table><br><p>     .NET Core 2.0  : </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td> <sup>Jint</sup> </td><td align="right"> <sup>24,87 </sup> </td><td align="right"> <sup>2 750,00</sup> </td><td align="right"> <sup>1 375,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>16 300,25 </sup> </td></tr><tr><td> <sup>Jurassic</sup> </td><td align="right"> <sup>469,97 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>15 511,70 </sup> </td></tr><tr><td> <sup>NiL</sup> </td><td align="right"> <sup>19,67 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center">  <sup>-</sup> </td><td align="center">  <sup>-</sup> </td><td align="right"> <sup>4 419,95 </sup> </td></tr></tbody></table><br><p>       .        ,     (     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   </a> ).   ,   Jint        2016       ,       .   <a href="">   3.0.0 Beta 1353</a> ,    Jint    2,4  ,  NiL.JS  2.5.1200,        . </p><br><p>   NiL.JS  .         -  ,      -  ,    .    Bundle Transformer,  JavaScript Engine Switcher,     Hogan  Handlebars,      ReactJS.NET.              NiL.JS. </p><br><h2>  Referensi </h2><br><ol><li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JavaScript Engine Switcher</a>  GitHub </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> JavaScript Engine Switcher</a> </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">«  JavaScript Engine Switcher 2.X»</a> </li><li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JSPool</a>  GitHub </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  ReactJS.NET</a> </li><li>   <a href="">ReactJS.NET</a>  GitHub </li></ol><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439446/">https://habr.com/ru/post/id439446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439432/index.html">Bagaimana menjadi pengembang Java dalam 1,5 tahun</a></li>
<li><a href="../id439434/index.html">NestJS - backend nyata yang sama pada nodejs</a></li>
<li><a href="../id439436/index.html">Pengurangan biaya seri kecil elektronik di Rusia. WOLNA Internet Radio Case</a></li>
<li><a href="../id439440/index.html">Terapkan Sumber Terbuka Kolaborasi Zimbra, otorisasi melalui AD dan pembuatan kotak pesan otomatis</a></li>
<li><a href="../id439442/index.html">Julia. Pembuat Laporan dan Dokumen</a></li>
<li><a href="../id439448/index.html">Apa pertanyaan tentang virtualisasi yang Anda harapkan dari lulusan?</a></li>
<li><a href="../id439450/index.html">RS-485 menggunakan mikrokontroler domestik dari perusahaan Milander</a></li>
<li><a href="../id439454/index.html">Program sebagai Seni - Paradigma Manajemen Perangkat Lunak Baru</a></li>
<li><a href="../id439456/index.html">Podcast Hipster # 2</a></li>
<li><a href="../id439458/index.html">Bagaimana kami menerjemahkan situs web Republic ke Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>