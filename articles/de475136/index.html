<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèà üé≥ ü§∏üèø Maschinelles Lernen f√ºr Ihre Wohnungssuche. Teil 3: Der letzte Schubs ‚ö†Ô∏è ü•Ö üéôÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foto von Dugan Arnett auf Boston Globe 


 Suchen Sie noch eine neue Wohnung? Bereit f√ºr den letzten Versuch? Wenn ja - folgen Sie mir und ich zeige I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maschinelles Lernen f√ºr Ihre Wohnungssuche. Teil 3: Der letzte Schubs</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475136/"><p><img src="https://habrastorage.org/webt/yj/dy/xa/yjdyxaijfwrdh4wzjpx1fyphbuw.jpeg" alt="Foto von Dugan Arnett auf Boston GlobeAre"><br>  <em>Foto von Dugan Arnett auf Boston Globe</em> </p><br><p>  Suchen Sie noch eine neue Wohnung?  Bereit f√ºr den letzten Versuch?  Wenn ja - folgen Sie mir und ich zeige Ihnen, wie Sie die Ziellinie erreichen. </p><a name="habracut"></a><br><h1 id="short-introduction-and-references">  Kurze Einf√ºhrung und Referenzen </h1><br><p> Es ist der dritte Teil des Zyklus, in dem erl√§utert wird, wie Sie die optimale Wohnung auf dem Immobilienmarkt finden k√∂nnen.  In wenigen Worten die Hauptidee - Finden Sie das beste Angebot unter den Wohnungen in Jekaterinburg, wo ich vorher gelebt habe.  Aber ich denke, die gleiche Idee kann im Kontext einer anderen Stadt betrachtet werden. </p><br><p>  Wenn Sie die vorherigen Teile nicht gelesen haben, ist es eine gute Idee, sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil1</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil2</a> zu lesen. </p><br><p>  Dort k√∂nnen Sie auch Ipython-Notizb√ºcher <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">finden</a> . <br>  Dieser Teil musste viel k√ºrzer sein als die vorherigen, aber der Teufel steckt im Detail. </p><br><h1 id="consequences">  Folgen </h1><br><p>  Als Ergebnis aller Aktionen haben wir ein ML-Modell (Random Forest) erhalten, das recht gut funktioniert.  Nicht so gut wie erwartet (der Score liegt √ºber 87%), aber f√ºr echte Daten ist es gut genug.  Und ... lassen Sie mich ehrlich sein, diese Gedanken √ºber das Ergebnis hatten einen seltsamen Einfluss auf mich.  Ich wollte mehr Punkte, die L√ºcke zwischen dem erwarteten Ergebnis und der tats√§chlichen Vorhersage war kleiner als 3%.  Optimismus, gemischt mit Gier, ist mir in den Sinn gekommen </p><br><p><img src="https://habrastorage.org/webt/9l/m9/lk/9lm9lkw5g9pcbkeeolew26yakkw.jpeg" alt="MOAR!"><br>  <em>Ich will mehr</em> <del>  <em>Gold</em> </del>  <em>Genauigkeit</em> </p><br><p>  Es ist allgemein bekannt, dass es wahrscheinlich entgegengesetzte Ans√§tze geben wird, wenn Sie etwas verbessern m√∂chten.  Normalerweise sieht es nach einer Wahl aus zwischen: </p><br><ul><li>  Evolution gegen Revolution </li><li>  Quantit√§t gegen Qualit√§t </li><li>  Umfangreich gegen intensiv </li></ul><br><p>  Und wegen des mangelnden Willens, die Pferde im Midstream zu wechseln, habe ich mich f√ºr RF (Random Forest) entschieden und ein paar neue Funktionen hinzugef√ºgt. </p><br><p>  Es schien eine Idee zu sein, "wir brauchen nur mehr Funktionen", um die Punktzahl zu verbessern.  Zumindest dachte ich das. </p><br><h1 id="per-aspera-ad-astra-through-hardships-to-the-stars">  Per aspera ad astra (durch Strapazen zu den Sternen) </h1><br><p>  Lassen Sie uns versuchen, √ºber verwandte Funktionen nachzudenken, die den Preis einer Wohnung beeinflussen k√∂nnten.  Es gibt Eigenschaften von Wohnung wie Balkon oder Alter des Hauses und geo-bezogene Eigenschaften wie Entfernung zur n√§chsten U-Bahn / Bus-Station.  Was k√∂nnte f√ºr den gleichen Ansatz mit RF als N√§chstes kommen? </p><br><h2 id="idea-1-distance-to-centre">  Idee Nr. 1.  Entfernung zum Zentrum </h2><br><p>  Wir k√∂nnten L√§ngen- und Breitengrade (flache Koordinaten) wiederverwenden.  Anhand dieser Informationen k√∂nnen wir die Entfernung zum Stadtzentrum berechnen.  Die gleiche Idee wurde f√ºr Stadtteile verwendet. Je weiter wir vom Zentrum entfernt sind, desto billiger sollte es sein.  Und raten Sie mal, was ... es funktioniert!  Kein so gro√ües Wachstum ( <strong>+ 1%</strong> der Punktzahl), aber es ist besser als nichts. </p><br><p>  Es gibt nur ein Problem: Dieselbe Idee ist f√ºr sehr weit entfernte Stadtteile nicht sinnvoll.  Wenn Sie au√üerhalb einer Stadt leben, wissen Sie, dass es f√ºr den Preis andere Regeln gibt. </p><br><p>  Die Interpretation wird nicht einfach, wenn wir diesen Ansatz extrapolieren. </p><br><h2 id="idea-2-near-metro">  Idee Nr. 2.  In der N√§he der U-Bahn </h2><br><p>  Die U-Bahn hat einen erheblichen Einfluss auf den Preis.  Vor allem, wenn es sich in einer Fu√üg√§ngerzone befindet.  Aber die Bedeutung von "zu Fu√ü" ist nicht klar.  Jede Person kann diesen Parameter auf unterschiedliche Weise interpretieren.  Ich k√∂nnte das Limit manuell einstellen, aber eine Erh√∂hung der Punktzahl w√ºrde nicht √ºber <strong>0,2% liegen.</strong> </p><br><p>  Gleichzeitig klappt es mit Flat aus der bisherigen Idee nicht.  Es gibt keine U-Bahn in der N√§he. </p><br><h2 id="idea-3-rationality-and-equilibrium-of-the-market">  Idee # 3.  Rationalit√§t und Marktgleichgewicht </h2><br><p>  Das Marktgleichgewicht ist eine Kombination aus Nachfrage und Angebot.  Adam Smith hat dar√ºber gesprochen.  Nat√ºrlich kann der Markt √ºberfordert sein.  Aber im Allgemeinen funktioniert diese Idee gut.  Zumindest f√ºr H√§user, die sich im Bau befinden. </p><br><p>  Mit anderen Worten - je mehr Konkurrenten Sie haben, desto geringer ist die Wahrscheinlichkeit, dass die Leute Ihre Wohnung kaufen (andere Dinge sind gleich).  Und das f√ºhrt zu der Vermutung: "Wenn um mich herum andere Wohnungen stehen, muss ich den Preis senken, um mehr K√§ufer zu bekommen." </p><br><p>  Und es klingt nach einer ganz logischen Schlussfolgerung, nicht wahr? </p><br><p>  Also z√§hlte ich √ÑHNLICHE Wohnungen in der N√§he von jeder von ihnen, im selben Haus und in einem Umkreis von 200 Metern.  Die Ma√ünahmen wurden zum Zeitpunkt des Verkaufs getroffen.  Welches Ergebnis w√ºrden Sie erwarten?  Nur <strong>0,1%</strong> bei gegenseitiger Validierung.  Traurig aber wahr. </p><br><hr><br><h1 id="rethinking">  Umdenken </h1><br><blockquote>  Beenden ist ... manchmal einen Schritt zur√ºck zu machen, um zwei Schritte vorw√§rts zu machen. <br><br>  - eine unbekannte weise Person </blockquote><p>  Okay, ein Frontalangriff funktioniert nicht.  Betrachten wir diese Situation aus einem anderen Blickwinkel. </p><br><p>  Nehmen wir an, Sie sind jemand, der eine Wohnung in der N√§he eines Flusses weit weg von der lauten Stadt kaufen m√∂chte.  Sie haben drei Werbevarianten, die einander √§hnlich sind und den gleichen Preis haben (mehr oder weniger).  Formale Metriken, die flat beschreiben, geben keinen Aufschluss √ºber die Umgebung. Sie sind nur Metriken auf einem Bildschirm.  Aber es gibt etwas Wichtiges. </p><br><p><img src="https://habrastorage.org/webt/zg/9j/jm/zg9jjmx04quhqfqcwqiko-q_hna.png" alt="Eine Wohnungsbeschreibung ist eine tolle Gelegenheit"><br>  <em>Eine Wohnungsbeschreibung ist eine tolle Gelegenheit.</em> </p><br><p>  Eine flache Beschreibung k√∂nnte alles bieten, was Sie brauchen.  Es k√∂nnte Ihnen eine Geschichte √ºber eine Wohnung, √ºber Nachbarn und erstaunliche Gelegenheiten erz√§hlen, die mit diesem bestimmten Wohnort zusammenh√§ngen.  Und manchmal kann eine Beschreibung sinnvoller sein als langweilige Zahlen. <br>  Aber im wirklichen Leben ist etwas anders als unsere Erwartungen.  Lassen Sie sich von mir zeigen, was und warum nicht funktioniert. </p><br><h2 id="what-will-not-work-and-why">  Was wird nicht funktionieren und warum? </h2><br><p>  <strong>Erwartungen</strong> - "Whoa! Ich kann versuchen, Text zu klassifizieren und 'gute' und 'schlechte' Wohnungen zu finden. Ich werde die gleiche Methode anwenden, die normalerweise f√ºr die Stimmungsanalyse verwendet wird." </p><br><p>  <strong>Realit√§t</strong> - "Nein, du wirst es nicht tun. Die Leute schreiben nichts Schlechtes gegen ihre Wohnung. Eine reale Situation oder L√ºge kann besch√∂nigt werden." </p><br><p>  <strong>Erwartungen</strong> - "Okay. Dann kann ich versuchen, Muster zu finden und die Zielgruppe f√ºr eine Wohnung zu finden. Zum Beispiel k√∂nnten es √§ltere Menschen oder Studenten sein." </p><br><p>  <strong>Realit√§t</strong> - "Nein, Sie werden es nicht tun. Manchmal wird in einer Anzeige √ºber verschiedene Altersgruppen und soziale Gruppen gesprochen, es handelt sich nur um Marketing." </p><br><h2 id="what-probably-would-work-and-why">  Was w√ºrde wohl funktionieren und warum? </h2><br><p>  <strong>Einige Stichw√∂rter</strong> - Es gibt W√∂rter, die auf bestimmte Dinge oder Momente im Zusammenhang mit der Wohnung hinweisen.  Wenn es sich beispielsweise um ein Studio handelt, ist der Preis niedriger.  Verben sind im Allgemeinen nutzlos, aber Substantive und Adverbien k√∂nnen mehr Kontext ergeben. </p><br><p>  <strong>Die alternative Informationsquelle</strong> - Verwenden Sie die Beschreibung, um leere oder NaN-Werte korrekter auszuf√ºllen.  Manchmal enth√§lt die Beschreibung mehr Informationen als formale Merkmale der Werbung. </p><br><p>  Ich vermute es aufgrund menschlicher Faulheit, nicht ben√∂tigte Felder wie "Balkon" auszuf√ºllen.  Alles in die Beschreibung einzuf√ºgen, scheint eine vorzuziehende Idee zu sein </p><br><h1 id="getting-information">  Informationen einholen </h1><br><p>  Ich √ºberspringe die Beschreibung des typischen Prozesses der Tokenisierung / Lemmatisierung / Stemmung.  Ich glaube auch, dass es Autoren gibt, die es besser beschreiben k√∂nnen als ich. </p><br><p>  Obwohl ich denke, dass das Toolset zum Extrahieren von Features erw√§hnt werden sollte.  Kurz gesagt sieht es so aus. </p><br><p><img src="https://habrastorage.org/webt/lr/e8/53/lre853kpee2cyuwnu6wqo8y6sio.png" alt="Trennung-> √úbereinstimmung nach Wortart"><br>  <em>Trennung-&gt; √úbereinstimmung nach Wortart</em> </p><br><p>  Nach der Vorverarbeitung des Anzeigentextes habe ich eine Reihe solcher russischer W√∂rter erhalten. </p><br><p><img src="https://habrastorage.org/webt/sb/0q/lx/sb0qlxyhx4n_50go7u4ryofkg_m.png" alt="Der Originaltext ist unter https://pastebin.com/Pxh8zVe3 abgelegt"><br>  <em>Der Originaltext ist unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://pastebin.com/Pxh8zVe3</a> abgelegt</em> </p><br><p>  Ich habe versucht, den Ansatz von Word2Vec zu verwenden, aber es gab kein spezielles W√∂rterbuch f√ºr Wohnungen und Werbung, sodass das allgemeine Bild seltsam aussah </p><br><p><img src="https://habrastorage.org/webt/uh/we/ls/uhwelsmg_mgtfamtjdtuncts9lo.png"><br>  <em>Der Abstand zwischen den W√∂rtern entspricht nicht den Erwartungen</em> </p><br><p>  Deshalb habe ich es so einfach wie m√∂glich gehalten und beschlossen, mehrere neue Spalten f√ºr den Datensatz zu erstellen </p><br><hr><br><h1 id="a-little-less-conversation-a-little-more-action">  Ein bisschen weniger Konversation, ein bisschen mehr Action </h1><br><p>  Zeit, uns die H√§nde schmutzig zu machen und ein paar praktische Dinge zu tun.  Informieren Sie sich √ºber neue Funktionen.  Mehrere wichtige Faktoren wurden durch einen Einfluss auf den Preis getrennt. </p><br><h2 id="positive-impact">  positive auswirkung </h2><br><ul><li>  <strong>M√∂bel</strong> - manchmal konnten Leute ein Bett, eine Waschmaschine und so weiter verlassen. </li><li>  <strong>Luxus</strong> - Wohnungen mit luxuri√∂sen Dingen wie Whirlpool oder exklusivem Interieur </li><li>  <strong>Videokontrolle</strong> - sie gibt den Menschen das Gef√ºhl, sicher zu sein, und betrachtet sie h√§ufig als Vorteil </li></ul><br><h2 id="negative-impact">  negative Auswirkungen </h2><br><ul><li>  <strong>Wohnheim</strong> - ja, manchmal ist es eine Wohnung in einem Wohnheim.  Nicht so beliebt, aber deutlich g√ºnstiger als eine durchschnittliche Wohnung </li><li>  <strong>Eile</strong> - Wenn Leute eilen, um ihre Wohnung zu verkaufen, sind sie normalerweise bereit, den Preis zu senken. </li><li>  <strong>Studio</strong> - wie ich schon sagte - sie sind billiger als ihre Wohnungen-Analoga. </li></ul><br><p>  Sammeln wir sie in etwas Universalem </p><br><pre><code class="python hljs">df3 = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'flats3.csv'</span></span>) positive_impact = [<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'luxury'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>] negative_impact = [<span class="hljs-string"><span class="hljs-string">'studio'</span></span>, <span class="hljs-string"><span class="hljs-string">'rush'</span></span>,<span class="hljs-string"><span class="hljs-string">'dorm'</span></span>] geo_features = [<span class="hljs-string"><span class="hljs-string">'metro'</span></span>,<span class="hljs-string"><span class="hljs-string">'num_of_stops_1km'</span></span>,<span class="hljs-string"><span class="hljs-string">'num_of_shops_1km'</span></span>,<span class="hljs-string"><span class="hljs-string">'num_of_kindergarden_1km'</span></span>, <span class="hljs-string"><span class="hljs-string">'num_of_medical_1km'</span></span>,<span class="hljs-string"><span class="hljs-string">'center_distance'</span></span>] flat_features=[<span class="hljs-string"><span class="hljs-string">'total_area'</span></span>, <span class="hljs-string"><span class="hljs-string">'repair'</span></span>,<span class="hljs-string"><span class="hljs-string">'balcony_y'</span></span>, <span class="hljs-string"><span class="hljs-string">'walls_y'</span></span>,<span class="hljs-string"><span class="hljs-string">'district_y'</span></span>, <span class="hljs-string"><span class="hljs-string">'age_y'</span></span>] competitors_features = [<span class="hljs-string"><span class="hljs-string">'distance_200m'</span></span>, <span class="hljs-string"><span class="hljs-string">'same_house'</span></span>] cols = [<span class="hljs-string"><span class="hljs-string">'cost'</span></span>] cols+=flat_features cols+=geo_features cols+=competitors_features cols+=positive_impact cols+=negative_impact df3 = df3[cols]</code> </pre> <br><h2 id="general-impact">  allgemeine Auswirkungen </h2><br><p>  Es ist nur eine Kombination aus negativen und positiven Eigenschaften.  Anf√§nglich ist es f√ºr jede Wohnung gleich 0. Beispielsweise hat ein Studio mit Videokontrolle immer noch eine allgemeine Wirkung von 0 ( <em>1 [positiv] ‚Äì1 [negativ] = 0</em> ). </p><br><pre> <code class="python hljs">df3[<span class="hljs-string"><span class="hljs-string">'impact'</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> df3.iterrows(): impact = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> positive <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> positive_impact: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> row[positive]: impact+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> negative <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> negative_impact: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> row[negative]: impact-=<span class="hljs-number"><span class="hljs-number">1</span></span> df3.at[i, <span class="hljs-string"><span class="hljs-string">'impact'</span></span>] = impact</code> </pre> <br><p>  Okay, wir haben Daten, neue Funktionen und ein altes Ziel mit 10% des mittleren Fehlers f√ºr die Vorhersage.  Machen Sie eine typische Operation wie zuvor </p><br><pre> <code class="python hljs">y = df3.cost X = df3.drop(columns=[<span class="hljs-string"><span class="hljs-string">'cost'</span></span>]) X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number"><span class="hljs-number">0.2</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>)</code> </pre> <br><h1 id="old-approachextensive-growth-of-features">  Alter Ansatz (umfangreiches Feature-Wachstum) </h1><br><p>  Wir werden ein neues Modell bauen, das auf alten Ideen basiert </p><br><pre> <code class="python hljs">data = [] max_features = int(X.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>): regressor = RandomForestRegressor(verbose=<span class="hljs-number"><span class="hljs-number">0</span></span>, n_estimators=<span class="hljs-number"><span class="hljs-number">128</span></span>, max_features=max_features, max_depth=x, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) model = regressor.fit(X_train, y_train) score = do_cross_validation(X, y, model) data.append({<span class="hljs-string"><span class="hljs-string">'max_depth'</span></span>:x,<span class="hljs-string"><span class="hljs-string">'score'</span></span>:score}) data = pd.DataFrame(data) f, ax = plot.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) sns.lineplot(x=<span class="hljs-string"><span class="hljs-string">"max_depth"</span></span>, y=<span class="hljs-string"><span class="hljs-string">"score"</span></span>, data=data) max_result = data.loc[data[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].idxmax()] ax.set_title(<span class="hljs-string"><span class="hljs-string">f'Max score - </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{max_result.score}</span></span></span><span class="hljs-string">\nDepth </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{max_result.max_depth}</span></span></span><span class="hljs-string"> '</span></span>)</code> </pre> <br><p>  Und das Ergebnis war etwas ... unerwartet. <br><img src="https://habrastorage.org/webt/us/et/xv/usetxvj9vr4pjrsfnx-7jzcruqm.png" alt="92% ist √ºberw√§ltigendes Ergebnis"></p><br><p>  92% ist √ºberw√§ltigendes Ergebnis.  Ich meine, zu sagen, dass ich geschockt war, w√§re eine Untertreibung. </p><br><p>  Aber warum hat es so gut funktioniert?  Werfen wir einen Blick auf neue Funktionen. </p><br><pre> <code class="python hljs">regressor = RandomForestRegressor(random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>, max_depth=max_result.max_depth, n_estimators=<span class="hljs-number"><span class="hljs-number">128</span></span>, max_features=max_features) rf3 = regressor.fit(X_train, y_train) feat_importances = pd.Series(rf3.feature_importances_, index=X.columns) feat_importances.nlargest(X.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]).plot(kind=<span class="hljs-string"><span class="hljs-string">'barh'</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/lj/27/a8/lj27a8esi5qhxqdycqwgduvq1ki.png" alt="Wichtig sind alle Funktionen f√ºr unser Modell"><br>  <strong>Wichtig sind alle Funktionen f√ºr unser Modell</strong> </p><br><p>  Die Wichtigkeit gibt keine Auskunft √ºber den Beitrag von Features (das ist eine andere Geschichte), sondern zeigt nur, wie aktive Modelle das eine oder andere Feature verwenden.  Aber f√ºr die aktuelle Situation sieht es informativ aus.  Einige der neuen Funktionen sind wichtiger als fr√ºhere, andere fast unbrauchbar. </p><br><h1 id="new-approachintensive-work-with-data">  Neuer Ansatz (intensive Arbeit mit Daten) </h1><br><p>  Nun ... die Ziellinie ist √ºberschritten, das Ergebnis ist erreicht.  K√∂nnte es besser sein? <br>  Kurze Antwort - <em>"Ja, es k√∂nnte"</em> </p><br><ul><li>  Erstens k√∂nnten wir die Tiefe eines Baumes reduzieren.  Es wird auch zu einer k√ºrzeren Zeit f√ºr Training und Vorhersage f√ºhren. </li><li>  Zweitens k√∂nnten wir die Vorhersage ein wenig verbessern. </li></ul><br><p>  F√ºr beide Momente verwenden wir <strong>XGBoost</strong> .  Manchmal bevorzugen die Leute andere Booster wie <strong>LightGBM</strong> oder <strong>CatBoost</strong> , aber meiner bescheidenen Meinung nach - der erste ist gut genug, wenn Sie viele Daten haben, ein zweiter ist besser, wenn Sie mit kategorialen Variablen arbeiten.  Und als Bonus - XGBoost scheint einfach schneller zu sein </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xgboost <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> XGBRegressor,plot_importance data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>): regressor = XGBRegressor(verbose=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_lambda=<span class="hljs-number"><span class="hljs-number">10</span></span>, n_estimators=<span class="hljs-number"><span class="hljs-number">1000</span></span>, objective=<span class="hljs-string"><span class="hljs-string">'reg:squarederror'</span></span>, max_depth=x, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) model = regressor.fit(X_train, y_train) score = do_cross_validation(X, y, model) data.append({<span class="hljs-string"><span class="hljs-string">'max_depth'</span></span>:x,<span class="hljs-string"><span class="hljs-string">'score'</span></span>:score}) data = pd.DataFrame(data) f, ax = plot.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) sns.lineplot(x=<span class="hljs-string"><span class="hljs-string">"max_depth"</span></span>, y=<span class="hljs-string"><span class="hljs-string">"score"</span></span>, data=data) max_result = data.loc[data[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].idxmax()] ax.set_title(<span class="hljs-string"><span class="hljs-string">f'Max score-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{max_result.score}</span></span></span><span class="hljs-string">\nDepth </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{max_result.max_depth}</span></span></span><span class="hljs-string"> '</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/zb/23/4j/zb234jravshc6z1zepkcc90gd0a.png" alt="Das Ergebnis ist besser als das vorherige."></p><br><p>  <em>Das Ergebnis ist besser als das vorherige.</em> </p><br><p>  Nat√ºrlich ist es der nicht gro√üe Unterschied zwischen Random Forest und XGBoost.  Und jeder von ihnen k√∂nnte als gutes Werkzeug zur L√∂sung unseres Problems mit der Vorhersage verwendet werden.  Es liegt an dir. </p><br><h1 id="conclusion">  Fazit </h1><br><p>  Ist das Ergebnis erreicht?  Auf jeden Fall ja. </p><br><p>  Die L√∂sung ist dort verf√ºgbar und kann von jedem kostenlos genutzt werden.  Wenn Sie sich f√ºr die Bewertung einer Wohnung mit diesem Ansatz interessieren, z√∂gern Sie bitte nicht und kontaktieren Sie mich. </p><br><p>  Als Prototyp wurde es dort platziert </p><br><p>  <strong>Danke f√ºrs Lesen!</strong>  . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de475136/">https://habr.com/ru/post/de475136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de475126/index.html">Moskau Node.js Meetup 10: Architektur von Node.js-Anwendungen, Hot Reload in Node.js und ein geheimer Bericht</a></li>
<li><a href="../de475128/index.html">NURBS-Modellierung in Rhino 3D und T-Spline</a></li>
<li><a href="../de475130/index.html">Gro√ües Interview √ºber Big Data: Warum folgen sie uns in sozialen Netzwerken und wer verkauft unsere Daten?</a></li>
<li><a href="../de475132/index.html">Blockierfreier Propeller an einer CNC-Maschine</a></li>
<li><a href="../de475134/index.html">Ein anderer Weg zum High-Tech-Betrug</a></li>
<li><a href="../de475138/index.html">5 M√∂glichkeiten, den Raspberry Pi vorteilhaft zu nutzen Teil zwei</a></li>
<li><a href="../de475140/index.html">Warum Top-Physiker schwache Quantenmessungen f√ºr eine Pseudowissenschaft halten</a></li>
<li><a href="../de475142/index.html">Schlaf, Entspannung und Musik: Wie Profisportler M√ºdigkeit √ºberwinden und was k√∂nnen wir dagegen tun?</a></li>
<li><a href="../de475144/index.html">Teilen Sie Laravel in Komponenten</a></li>
<li><a href="../de475146/index.html">Die Qual oder die lange Geschichte eines Datenwiederherstellungsversuchs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>