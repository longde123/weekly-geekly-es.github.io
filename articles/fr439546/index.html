<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏻 🏰 💅🏼 Les androïdes rêvent-ils de punk électrique? Comment j'ai appris à un réseau de neurones à écrire de la musique 🏝️ ⛴️ 🙏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors de cours d'apprentissage automatique à Artezio, j'ai rencontré un modèle d'apprentissage qui pouvait faire de la musique. La musique est une part...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Les androïdes rêvent-ils de punk électrique? Comment j'ai appris à un réseau de neurones à écrire de la musique</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/439546/">  Lors de cours d'apprentissage automatique à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Artezio,</a> j'ai rencontré un modèle d'apprentissage qui pouvait faire de la musique.  La musique est une partie essentielle de ma vie, pendant de nombreuses années j'ai joué dans des groupes (punk rock, reggae, hip hop, rock, etc.) et je suis un auditeur fanatique. <br><br>  Malheureusement, de nombreux groupes, dont j'étais un grand fan dans ma jeunesse, se sont séparés pour diverses raisons.  Ou ils n'ont pas rompu, mais ce qu'ils enregistrent maintenant ... en général, ce serait mieux s'ils se séparaient. <br><br>  J'étais curieux de savoir s'il existe maintenant un modèle prêt à l'emploi qui peut apprendre sur les pistes d'un de mes groupes préférés et créer des compositions similaires.  Puisque les musiciens eux-mêmes ne sont plus très performants, peut-être que le réseau de neurones peut les gérer? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/72f/844/01f/72f84401f2af035271021780fc848fe8.png"></div>  <a href="">Source</a> <br><a name="habracut"></a><br>  En étudiant les modèles finis, je suis rapidement tombé sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un tel article</a> avec un aperçu des six options les plus célèbres.  Il s'agit bien sûr des formats de musique numérique.  On peut voir dans l'article que deux approches principales de la génération de musique peuvent être distinguées: basée sur le flux audio numérisé (le son que nous entendons des haut-parleurs - audio brut, fichiers wav) et basé sur le travail avec MIDI (notation musicale). <br><br>  J'ai abandonné les options avec du son brut, et c'est pourquoi. <br><br><ul><li>  Les résultats ne sont pas impressionnants - l'utilisation de tels modèles pour la musique polyphonique donne un résultat très spécifique.  C'est inhabituel, vous pouvez créer des peintures intéressantes, mais cela ne convient pas à mes fins: cela semble étrange, mais je voulais entendre quelque chose de similaire à l'original. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d9/229/364/5d9229364d98bee837d9bcf7cb3e1bac.jpg"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br>  Un bon exemple avec la musique pour piano: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Et avec la musique orchestrale ou le rock, ça sonne beaucoup plus étrange: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Ici, les gars ont essayé de traiter le Black Metal et pas seulement en audio brut. <br><br><ul><li>  Dans les compositions de mes groupes préférés, divers instruments sonnent - voix, batterie, basse, guitares, synthétiseurs.  Chaque instrument sonne avec le reste.  Je recherche un modèle qui agirait de la même manière, c'est-à-dire qui fonctionnerait non seulement avec des instruments individuels, mais prendrait également en compte leur son commun. <br><br>  Lorsqu'un musicien a besoin d'apprendre une partie d'un instrument à l'oreille, il essaie d'isoler l'instrument dont il a besoin de l'ensemble du flux sonore.  Il répète ensuite son son jusqu'à ce qu'il obtienne un résultat similaire.  La tâche n'est pas la plus facile, même pour une personne ayant une bonne audition - la musique peut être difficile, les instruments «fusionnent». </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dcd/5d1/8eb/dcd5d18eb46a6d383ffbc378d3fc7adb.jpg"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br>  Je suis tombé sur des outils logiciels qui ont essayé de résoudre un problème similaire.  Il existe plusieurs projets basés sur l'apprentissage automatique.  Par exemple, pendant que j'écrivais ce texte, Magenta a sorti un nouvel instrument, Wave2Midi2Wave, capable de «prendre» des notes de piano et de «les reproduire» de façon réaliste.  Il existe d'autres outils, bien qu'en général cette tâche n'ait pas encore été résolue. <br><br>  Ainsi, afin d'apprendre une partie d'une œuvre, il est plus facile de prendre des notes toutes faites.  C'est le moyen le plus simple.  Il est logique de supposer qu'il sera plus facile pour les réseaux de neurones de travailler avec la représentation musicale de la musique, où chaque instrument est représenté par une piste distincte. <br><br><ul><li>  Dans le cas de l'audio brut, le résultat est un mélange de tous les instruments, les parties ne peuvent pas être chargées individuellement dans le séquenceur (éditeur audio), corrigées, modifiées le son, etc.  Je suis très content si le réseau de neurones compose un hit, mais fait une erreur dans quelques notes - lorsque je travaille avec des notes, je peux facilement les corriger, avec du son brut, cela est presque impossible. </li></ul><br>  La notation musicale a également ses inconvénients.  Il ne prend pas en compte la masse des nuances de performances.  En ce qui concerne le MIDI, on ne sait pas toujours qui étaient ces fichiers MIDI, à quel point ils sont proches de l'original.  Peut-être que le compilateur a simplement fait une erreur, car ce n'est pas une tâche facile de "supprimer" le jeu. <br><br>  Lorsque vous travaillez avec des notes polyphoniques, vous devez vous assurer que les instruments sont à tout moment accordés.  De plus, il est important que la séquence de ces moments soit logique du point de vue humain de la musique. <br><br>  Il s'est avéré qu'il n'y a pas tellement de solutions qui pourraient fonctionner avec des notes, et même pas avec un instrument, mais avec plusieurs sons en même temps.  J'ai d'abord ignoré le projet Magenta de Google TensorFlow, car il était décrit comme "non polyphonique".  A cette époque, la bibliothèque MusicVAE n'était pas encore publiée, donc je me suis installé sur le projet BachBot. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b7/fef/993/2b7fef9935afb9f001bf954dd0fc097b.jpg"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br><h2>  Bachbot </h2><br>  Il s'est avéré que la solution à mon problème existe déjà.  Écoutez le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">joyeux anniversaire</a> accordé par BachBot et sonnant comme un choral de Bach. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  La chorale est une musique spécifique, elle se compose de quatre voix: soprano, alto, ténor et basse.  Chacun des instruments peut produire une note à la fois.  Ici, vous devez aller un peu plus loin dans la musique.  Nous parlerons de musique dans la dimension des quatre quarts. <br><br>  Dans une notation musicale, une note a deux indicateurs - la hauteur (to, re, mi ...) et la durée (entier, demi, huitième, seizième, trente seconde).  En conséquence, une note entière dure un temps entier, deux demi-notes un temps entier, seize seizièmes un temps entier. <br><br>  Lors de la préparation des données pour la formation du réseau neuronal, les créateurs de BachBot ont pris en compte les éléments suivants: <br><br><ul><li>  afin de ne pas abattre le modèle avec des accords de touches différentes, qui ensemble ne sonneraient pas harmonieusement, tous les chorals ont conduit à la même touche; </li><li>  le réseau neuronal doit être alimenté en valeurs discrètes, et la musique est un processus continu, ce qui signifie qu'une discrétisation est nécessaire.  Un instrument peut jouer une longue note entière et l'autre en même temps quelques seizièmes.  Pour résoudre ce problème, toutes les notes ont été divisées en seizièmes.  En d'autres termes, si une quatrième note apparaît dans les notes, elle arrive quatre fois comme la même seizième entrée - la première fois avec le drapeau sur lequel elle a été pressée et les trois fois suivantes avec le drapeau qu'elle continue. </li></ul><br>  Le format des données est le suivant - (hauteur, nouvelle note | continuation du son de l'ancienne note) <br><br>  (56, Vrai) # Soprano <br>  (52, Faux) # Alt <br>  (47, Faux) # Ténor <br>  (38, Faux) # Basse <br><br>  Après avoir conduit tous les choraux de l'ensemble de données musical21 populaire à travers cette procédure, les auteurs de BachBot ont constaté qu'il n'y a pas beaucoup de combinaisons de combinaisons de quatre notes dans les chorales (si vous les amenez à la même tonalité), bien qu'il semble qu'il puisse y avoir potentiellement 128 x 128 x 128 x 128 (128 niveaux de hauteur utilisés en midi).  La taille d'un dictionnaire conditionnel n'est pas si grande.  C'est une remarque curieuse, nous y reviendrons lorsque nous parlerons de MusicVAE.  Ainsi, nous avons les chorales de Bach enregistrés sous la forme de séquences de ces quatuors. <br><br>  On dit souvent que la musique est une langue.  Par conséquent, il n'est pas surprenant que les créateurs de BachBot aient appliqué la technologie populaire en NLP (Natural Language Processing) à la musique, à savoir qu'ils ont formé le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réseau LSTM</a> sur l'ensemble de données généré et ont obtenu un modèle qui peut compléter un ou plusieurs instruments ou même créer des chorales à partir de zéro.  Autrement dit, vous définissez l'alt, le ténor et la basse, et BachBot ajoute la mélodie de soprano pour vous, et ensemble, cela ressemble à Bach. <br><br>  Voici un autre exemple: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Sonne bien! <br><br>  Vous pouvez regarder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette vidéo</a> plus en détail.  Il y a là une analyse intéressante, collectée sur la base d'une enquête sur le site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bachbot.com</a> <br><br>  Les utilisateurs sont encouragés à distinguer les chorals originaux de Bach de la musique créée par le réseau neuronal.  Les résultats mentionnent que si un réseau de neurones crée une partie basse pour tous les autres paramètres, alors seulement la moitié des utilisateurs peuvent distinguer les chorales créés par un réseau de neurones des originaux.  C'est drôle, mais surtout les experts en musique se confondent.  Avec d'autres outils, les choses vont un peu mieux.  Cela me semble insultant en tant que bassiste - le violoniste semble être nécessaire pour le moment, mais il est temps pour les bassistes de perfectionner leurs compétences en cloisons sèches. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/701/bb9/cc6/701bb9cc6cdff8a20f0ede768324cd81.png"></div><br><h1>  Magenta </h1><br>  En étudiant BachBot, j'ai trouvé qu'il était inclus dans le projet Magenta (Google TensorFlow).  J'ai décidé de l'examiner de plus près et j'ai constaté que dans le cadre de Magenta, plusieurs modèles intéressants ont été développés, dont l'un est juste consacré à travailler avec des compositions polyphoniques.  Magenta a fait ses merveilleux outils et a même déjà lancé le plugin pour l'éditeur audio Ableton, ce qui est particulièrement agréable en termes d'application pour les musiciens. <br><br>  Mes favoris: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">beat blender</a> (crée des variations sur une partie de batterie donnée) et <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">boucles latentes</a> (crée des transitions entre les mélodies). <br><br>  L'idée principale de l'outil MusicVAE, que j'ai décidé d'utiliser, est que les créateurs ont essayé de combiner le modèle et l'encodeur automatique variationnel - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VAE</a> sur le réseau LSTM. <br><br>  Si vous vous souvenez, dans une conversation sur Bach Bot, nous avons remarqué que le dictionnaire d'accords ne se compose pas d'éléments de 128x128x128x128, mais beaucoup moins.  Les créateurs de MusicVAE l'ont également remarqué et ont décidé d'utiliser un espace latent compressé. <br><br>  Soit dit en passant, ce qui est typique, pour la formation MusicVAE, vous n'avez pas besoin de traduire les sources en une seule clé.  La transposition n'est pas nécessaire, je suppose, car le code source sera toujours converti par l'auto-encodeur et les informations de tonalité disparaîtront. <br><br>  VAE est conçu de manière à permettre au décodeur de récupérer efficacement les données de l'ensemble de données d'apprentissage, tandis que l'espace latent est une distribution fluide des caractéristiques des données d'entrée. <br><br>  Ceci est un point très important.  Cela permet de créer des objets similaires et d'effectuer une interpolation logique significative.  Dans l'espace d'origine, nous avons 128x128x128x128 variantes de combinaison du son de quatre notes, mais en réalité, toutes ne sont pas utilisées (elles sonnent agréablement à l'oreille humaine).  Un encodeur automatique variationnel les transforme en un ensemble beaucoup plus petit dans un espace caché, et vous pouvez proposer des opérations mathématiques dans cet espace qui ont une signification significative du point de vue de l'espace d'origine, par exemple, les points voisins seront des fragments musicaux similaires. <br><br>  Un bon exemple est de savoir comment ajouter des lunettes à une photo à l'aide d'un encodeur automatique dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> .  Vous pouvez en savoir plus sur le fonctionnement de Muisc VAE sur le site officiel de Magenta dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> , il y a aussi un lien vers arXiv. <br><br>  Donc, l'instrument est sélectionné, il reste à l'utiliser avec mon objectif d'origine - créer de la nouvelle musique basée sur des pistes déjà enregistrées et évaluer combien cela sonnera comme le son du groupe d'origine.  Magenta ne fonctionne pas sur mon ordinateur portable Windows et depuis longtemps, il calcule un modèle sans GPU.  Après avoir souffert de machines virtuelles, d'un docker, etc., j'ai décidé d'utiliser le cloud. <br><br>  Google fournit des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">blocs-notes Colab</a> où vous pourrez vous adonner aux modèles magenta.  Cependant, dans mon cas, il n'a pas été possible de former le modèle, le processus s'est bloqué tout le temps en raison de diverses restrictions - la quantité de mémoire disponible, les arrêts de temporisation, l'absence d'une ligne de commande normale et les droits root pour installer les bibliothèques nécessaires.  Hypothétiquement, il est même possible d'utiliser le GPU, mais, je le répète, je n'ai pas pu installer le modèle et le démarrer. <br><br>  Je pensais acheter un serveur et, oh, bonne chance, j'ai trouvé que Google fournit des services cloud Google Cloud avec un GPU, et même il y a une période d'essai gratuite.  Certes, il s'est avéré qu'en Russie, ils ne sont officiellement accessibles qu'aux personnes morales, mais ils m'ont laissé entrer en mode d'essai gratuit. <br><br>  J'ai donc créé une machine virtuelle dans GoogleCloud avec un module GPU, trouvé sur Internet plusieurs fichiers midi de l'un de mes groupes préférés et les ai téléchargés dans le dossier midi du cloud. <br><br>  Installez Magenta: <br><br><pre><code class="plaintext hljs">pip install magenta-gpu</code> </pre> <br>  C'est génial que tout cela puisse être installé avec une seule équipe, pensais-je, mais ... des erreurs.  Il semble que vous deviez toucher la ligne de commande, désolé. <br><br>  Nous regardons les erreurs: la bibliothèque rtmidi n'est pas installée sur la machine cloud, sans laquelle Magenta ne fonctionne pas. <br><br>  Et cela, à son tour, se bloque en raison de l'absence du paquet libasound2-dev, et je n'ai pas non plus de privilèges root. <br><br>  Pas si effrayant: <br><br><pre> <code class="plaintext hljs">sudo su root apt-get install libasound2-dev</code> </pre> <br>  Hourra, maintenant pip install rtmidi fonctionne sans erreur, tout comme pip install magenta-gpu. <br><br>  On le retrouve sur Internet et télécharge les fichiers sources dans le dossier midi.  Ils sonnent quelque chose <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comme ça</a> . <br><br>  Nous convertissons midi en un format de données avec lequel le réseau peut déjà fonctionner: <br><br><pre> <code class="plaintext hljs">convert_dir_to_note_sequences \ --input_dir=midi\ --hparams=sampling_rate=1000.0\ --output_file=notesequences_R2Midi.tfrecord \ --log=DEBUG \ --recursive</code> </pre> <br>  et commencer la formation <br><br><pre> <code class="plaintext hljs">music_vae_train \ --config=hier-multiperf_vel_1bar_med \ --run_dir=/home/RNCDtrain/ \ --num_steps=1 \ --checkpoints_to_keep=2 \ --hparams=sampling_rate=1000.0 \ --hparams=batch_size=32,learning_rate=0.0005 \ --num_steps=5000 \ --mode=train \ --examples_path=notesequences_R2Midi.tfrecord</code> </pre> <br>  Encore une fois le problème.  Tensorflow se bloque avec une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">erreur</a> - il ne peut pas trouver la bibliothèque, heureusement, il y a quelques jours, quelqu'un a déjà décrit cette erreur, et les sources Python peuvent être corrigées. <br><br>  Nous montons dans le dossier <br><br><pre> <code class="plaintext hljs">/usr/local/lib/python2.7/dist-packages/tensorflow_probability/python/distributions#</code> </pre> <br>  et remplacez la ligne d'importation, comme décrit dans le bogue sur github. <br><br>  Lancez à nouveau music_vae_train et ... Hourra!  La formation est partie! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b5/46c/498/0b546c498699b6d4fbca1b95af41bd51.jpg"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br>  hier-multiperf_vel_1bar_med - J'utilise un modèle polyphonique (jusqu'à 8 instruments) qui produit une mesure chacun. <br><br>  Un paramètre important est checkpoints_to_keep = 2, la capacité du disque dans les nuages ​​est limitée, l'un des problèmes est que le processus d'apprentissage a été interrompu tout le temps en raison d'un débordement de disque, les points de contrôle sont assez lourds - 0,6-1 gigaoctets chacun. <br><br>  Quelque part dans les 5000 époques, l'erreur commence à sauter autour de 40 à 70.  Je ne sais pas si c'est un bon résultat ou non, mais il semble qu'avec un peu de données de formation, le réseau sera recyclé davantage et cela n'a aucun sens de passer le temps des GPU si gentiment fournis gratuitement dans les centres de données Google.  Nous passons à la génération. <br><br>  Pour une raison quelconque, lorsque l'installation de Magenta n'a pas installé le fichier de génération lui-même, j'ai dû le déposer de mes mains dans le dossier des autres: <br><br><pre> <code class="plaintext hljs">curl -o music_vae_generate.py https://raw.githubusercontent.com/tensorflow/magenta/master/magenta/models/music_vae/music_vae_generate.py</code> </pre> <br>  Enfin, créez les fragments: <br><br><pre> <code class="plaintext hljs">music_vae_generate --config=hier-multiperf_vel_1bar_med --checkpoint_file=/home/RNCDtrain/train/ --mode=sample --num_outputs=32 --output_dir=/home/andrey_shagal/  --temperature=0.3</code> </pre> <br>  config - type de génération, exactement le même que pendant la formation - multipiste, 1 horloge <br>  checkpoint_file - dossier où obtenir le dernier fichier avec le modèle formé <br>  mode - échantillon - créer un échantillon (il existe une autre option interpoler - créer une mesure de transition entre deux mesures) <br>  num_outputs - combien de pièces générer <br>  température - un paramètre de randomisation lors de la création d'un échantillon, de 0 à 1. À 0, le résultat est plus prévisible, plus proche de la source, à 1 - Je suis un artiste, tel que je le vois. <br><br>  En sortie, j'obtiens 32 fragments par mesure.  Ayant démarré le générateur plusieurs fois, j'écoute les fragments et colle le meilleur sur une piste: neurancid.mp3. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Alors "j'ai passé cet été."  Je suis satisfait.  Bien sûr, la radio Maximum est peu susceptible de l'emmener dans la liste de lecture, mais si vous écoutez, cela ressemble vraiment au groupe Rancid original.  Le son, bien sûr, est différent de l'enregistrement en studio, mais nous avons principalement travaillé avec des notes.  De plus, il y a de la place pour l'action - traitez le midi avec divers plug-ins VST, réenregistrez des parties avec des musiciens en direct ou attendez que les gars de Wave2Midi2Wave arrivent aux guitares avec une surcharge. <br><br>  Il n'y a rien à redire sur les notes.  Idéalement, j'aimerais que le réseau neuronal crée un chef-d'œuvre ou du moins un hit pour le top 100 du Billboard. Mais alors qu'elle a appris à <s>utiliser l'alcool et les drogues</s> des rockers <s>,</s> à jouer le rythme entier d'une note en huitièmes (en fait, non seulement, mais je suis fier de son père transition de 20 à 22 secondes).  Il y a des raisons à cela, et plus à leur sujet. <br><br><ol><li>  Petite quantité de données. </li><li>  Le modèle que j'ai utilisé produit des fragments de la taille d'une mesure.  Dans le punk rock, en règle générale, peu d'événements se déroulent au sein d'une même mesure. </li><li>  Les transitions et mélodies intéressantes fonctionnent juste dans le contexte des riffs de pitch, des transitions d'accord à accord, et l'auto-encodeur, avec une petite quantité de données, semble avoir perdu la plupart des morceaux, et même réduit tous les riffs à deux accords consonantiques et plusieurs accords atonaux.  Nous devons essayer un modèle qui fonctionne avec 16 mesures, c'est dommage que seules trois voix y soient disponibles. </li></ol><br>  J'ai contacté les développeurs, ils ont recommandé d'essayer de réduire la dimension de l'espace latent, car ils ont formé leur réseau sur 200000 pistes, et je me suis entraîné sur 15. Je n'ai pas pu obtenir l'effet visible de la réduction de l'espace z, mais il y a encore quelque chose à bricoler. <br><br>  Soit dit en passant, la monotonie et la monotonie est loin d'être toujours un inconvénient.  Des rituels chamaniques aux soirées techno, comme vous le savez, une seule étape.  Nous devons essayer de former le modèle sur quelque chose comme ça - contre, rave, techno, dub, reggae, hip-hop.  Certes, il y a une chance de créer quelque chose d'agréablement zombie.  J'ai trouvé une vingtaine de chansons de Bob Marley en midi et, voila la, une très belle boucle: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Les parties ci-dessus sont réenregistrées avec des basses et des guitares en direct, traitées par des synthétiseurs VST pour rendre le fragment plus juteux.  Dans l'original, le réseau n'a publié que des notes.  Si vous les jouez avec un lecteur midi standard, cela ressemble à ceci: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Certes, si vous créez un certain nombre de dessins de batterie thématiques de base, démarrez-les dans Beat Blender + parties de base de basse et synthés avec une boucle latente (il y en avait plus à leur sujet), il est tout à fait possible d'exécuter un algorithme pour la radio techno qui créera en continu de nouvelles pistes ou même une piste sans fin.  Buzz éternel! <br><br>  MusicVAE offre également la possibilité de former le réseau pour générer des fragments de trio de 16 mesures - batterie, basse et plomb.  Aussi assez intéressant.  Données d'entrée - fichiers midi multipistes - le système se divise en triples dans toutes les combinaisons possibles et plus loin, il forme le modèle.  Un tel réseau nécessite beaucoup plus de ressources, mais le résultat est immédiatement 16 cycles!  Impossible de résister.  J'ai essayé d'imaginer comment un groupe qui joue quelque chose entre Rancid et NOFX pourrait sonner, se chargeant pour la formation sur un nombre égal de pistes de chaque groupe: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Il y a aussi des parties midi réenregistrées sur des guitares live.  Lecteur midi standard comme celui-ci: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Intéressant!  C'est définitivement mieux que mon premier groupe!  Et en passant, ce même modèle nous donne un free jazz décent: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://w.soundcloud.com/player/" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Les problèmes que j'ai rencontrés: <br><br><ol><li>  Absence d'un bon support pratique qui réduirait le temps d'attente pour la formation.  Le modèle ne fonctionne que sous Linux, la formation est longue, sans GPU depuis très longtemps, et tout le temps je veux essayer de changer les paramètres et voir ce qui se passe.  Par exemple, un serveur cloud avec un processeur GPU de 100 époques pour le modèle «trio de 16 cycles» a compté 8 heures. </li><li>  Un problème typique d'apprentissage automatique est le manque de données.  Seulement 15 fichiers midi - c'est très petit pour comprendre la musique.  Le réseau neuronal, contrairement à moi dans ma jeunesse, n'a pas écouté 6 albums de Rancid avant les trous, je ne suis pas allé à des concerts, ce résultat a été obtenu à partir de 15 morceaux midi inconnus de quiconque est loin de l'original.  Maintenant, si vous restez autour du guitariste avec des capteurs et prenez chaque son de chaque note ... Voyons comment se développe l'idée Wave2Midi2Wave.  Peut-être que dans quelques années, il sera possible de refuser des notes pour résoudre un tel problème. </li><li>  Le musicien doit s'inscrire clairement dans le rythme, mais pas parfaitement.  Le week-end midi, il n'y a pas de dynamique dans les notes (par exemple, dans la batterie), elles sont toutes jouées au même volume, exactement en un clic (comme disent les musiciens, c'est-à-dire exactement dans le rythme), même si vous les diversifiez au hasard, la musique commence à sonner plus vivant et plus agréable.  Encore une fois, Wave2Midi2Wave traite déjà ce problème. </li></ol><br>  Vous avez maintenant une idée des possibilités de l'IA dans la création de musique et de mes préférences musicales.  Quel rôle pensez-vous que l'IA attend dans le processus créatif à l'avenir?  Une machine peut-elle créer de la musique sur un pied d'égalité ou même mieux qu'un être humain pour être un assistant dans le processus créatif?  Ou l'intelligence artificielle ne deviendra célèbre dans le domaine musical que pour l'artisanat primitif. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439546/">https://habr.com/ru/post/fr439546/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439534/index.html">Programmation des rendements et utilisation de drones dans la production de pétrole - 10 conférences de la conférence GIS Tech Russia</a></li>
<li><a href="../fr439538/index.html">Programmation de la société</a></li>
<li><a href="../fr439540/index.html">Etherblade.net - projet opensource pour créer un encapsulateur de trafic Ethernet sur FPGA (première partie)</a></li>
<li><a href="../fr439542/index.html">Nintendo indique clairement que seul le piratage peut sauvegarder l'historique des jeux vidéo</a></li>
<li><a href="../fr439544/index.html">Colonie. Chapitre 24: Départ</a></li>
<li><a href="../fr439550/index.html">Hackquest 2018. Résultats et écritures. Jour 1-3</a></li>
<li><a href="../fr439552/index.html">Extensions Chrome malveillantes</a></li>
<li><a href="../fr439556/index.html">TDMS Fairway. Méthodologies PMBOK et organisations de conception russes</a></li>
<li><a href="../fr439558/index.html">Nouveau vieux téléphone. Réinventez le téléphone PSTN</a></li>
<li><a href="../fr439560/index.html">Adaptateur Ethereum blockchain pour plate-forme de données InterSystems IRIS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>