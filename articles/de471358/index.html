<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✖️ 👏🏼 👨🏿‍🔬 Wie schreibe ich einen intelligenten Vertrag mit Python über Ontologie? Teil 4: Native API ⛹️ 👍🏿 🙎🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Zuvor habe ich den Ontology Smart Contract in eingeführt 
 Teil 1: Blockchain & Block API und 
 Teil 2: Speicher-API 
 Teil 3: Laufzeit-API 
 Lassen S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie schreibe ich einen intelligenten Vertrag mit Python über Ontologie? Teil 4: Native API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471358/"><img src="https://habrastorage.org/getpro/habr/post_images/a4a/df3/d06/a4adf3d06081f8a1b01c79140d5474f9.png" alt="Bild"><br><br>  Zuvor habe ich den Ontology Smart Contract in eingeführt <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1: Blockchain &amp; Block API</a> und <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2: Speicher-API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3: Laufzeit-API</a> <br>  Lassen Sie uns heute darüber sprechen, wie Sie einen nativen Smart-Vertrag für Ontology über die <b>native API</b> aufrufen.  Eine der typischsten Funktionen beim Aufrufen eines nativen Vertrags ist die Übertragung von Vermögenswerten. <br><a name="habracut"></a><br><h2>  Einführung </h2><br>  Die native API verfügt nur über eine API.  Wenn Sie die Invoke-Funktion verwenden, müssen Sie die integrierte Statusfunktion verwenden, um die Parameter zu kapseln.  Im Folgenden erfahren Sie, wie Sie die Funktionen verwenden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a86/1f4/e92/a861f4e929cd17a24e51eef11bd91ff8.png" alt="Bild"><br><br>  Lassen Sie uns nun näher auf die Verwendung dieser beiden APIs eingehen.  Zuvor können Sie im Ontology Smart Contract Development Tool <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SmartX</a> einen neuen Vertrag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellen</a> und die folgenden Anweisungen befolgen.  Wie üblich werde ich am Ende des Artikels einen Link zum Quellcode bereitstellen. <br><br><h3>  Verwendung der nativen API </h3><br>  Wie üblich müssen Sie die beiden Funktionen wie folgt importieren, bevor Sie sie verwenden können. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.Ontology.Native <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Invoke <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.builtins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> state</code> </pre> <br><h3>  Liste der Ontology Native Contract </h3><br>  Derzeit sind 6 native Ontology-Verträge für Entwickler verfügbar.  Unten finden Sie eine Liste der 6 nativen Verträge, die von der nativen API aufgerufen werden können. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/912/e50/28a/912e5028aa011e958a8d8ba8ab97501d.png" alt="Bild"><br><br>  Im Vertrag müssen Sie nur die Vertragsadresse in ein Bytearray-Format konvertieren und aufrufen. <br><br>  <b>Wenn Sie beispielsweise</b> einen ONT-Token-Vertrag aufrufen müssen, können Sie zuerst die Adresse des ONT-Token-Vertrags in das Bytearray-Format konvertieren und dann die Invoke-Funktion aufrufen.  Beim Aufruf der Invoke-Funktion sind die importierten Parameter die Versionsnummer, die Vertragsadresse, die aufgerufene Vertragsmethode und die von der Statusfunktion gekapselten transferbezogenen Parameter. <br><br>  Ein besonderer Punkt, der hier zu beachten ist, ist, dass bei einer Vertragsübertragung für ONG die gefüllte Menge das 10-fache der tatsächlichen Menge beträgt.  Das heißt, wenn Sie 10 ONG übertragen müssen, muss die Menge 10¹⁰ eingegeben werden.  Wenn Sie eine Brieftasche wie ONTO oder Cyano zum Überweisen verwenden, geben Sie als Überweisungsbetrag ein. <br><br><pre> <code class="python hljs">contract_address_ONT = bytearray(<span class="hljs-string"><span class="hljs-string">b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01'</span></span>) param = state(from_acct, to_acct, ont_amount) res = Invoke(<span class="hljs-number"><span class="hljs-number">1</span></span>, contract_address_ONT, <span class="hljs-string"><span class="hljs-string">'transfer'</span></span>, [param])</code> </pre> <br><h3>  Vertragscode übertragen </h3><br>  Im Folgenden finden Sie ein detailliertes Beispiel für die Verwendung von Python zur <b>Übertragung von ONT und ONG</b> .  Im folgenden Code ist der Parametertyp des importierten Sendekontos und der Empfangsadresse eine Zeichenfolge.  Darüber hinaus kann es auch mit einer Adresse mit Kontoparameter geliefert werden, wodurch die Gasgebühr für das Aufrufen des Vertrags gespart wird.  Der Prozess ist wie folgt: <br><br><ol><li>  Definieren Sie die Vertragsadressvariablen contract_address_ONT und contract_address_ONG. </li><li>  Konvertieren Sie die Sende- und Empfangsadresse vom base58-Format in das bytearray-Format. </li><li>  Überprüfen Sie die Unterschrift und stellen Sie sicher, dass die Absenderadresse mit der Vertragsaufrufadresse übereinstimmt. </li><li>  Die Statusfunktion kapselt die Übertragungsparameter. </li><li>  Die Invoke-Funktion ruft den nativen Vertrag ONT Token und ONG Token zur Übertragung auf. </li><li>  Stellen Sie fest, ob die Übertragung erfolgreich war, indem Sie res zurückgeben.  Wenn der Rückgabewert b '\ x01' ist, ist die Übertragung erfolgreich und das Ereignis "Übertragung erfolgreich" wird ausgegeben. </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.System.Runtime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Notify, CheckWitness <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.Ontology.Runtime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Base58ToAddress <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.Ontology.Native <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Invoke <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.builtins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> state <span class="hljs-comment"><span class="hljs-comment"># contract address contract_address_ONT = bytearray(b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01') contract_address_ONG = bytearray(b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02') def Main(operation, args): if operation == 'transfer': from_acct = args[0] to_acct = args[1] ont_amount = args[2] ong_amount = args[3] return transfer(from_acct,to_acct,ont_amount,ong_amount) return False def transfer(from_acct, to_acct, ont_amount, ong_amount): # convert base58 address to address in the form of byte array from_acct=Base58ToAddress(from_acct) to_acct=Base58ToAddress(to_acct) # check whether the sender is the payer if CheckWitness(from_acct): # transfer ONT if ont_amount &gt; 0: param = state(from_acct, to_acct, ont_amount) res = Invoke(1, contract_address_ONT, 'transfer', [param]) if res and res == b'\x01': Notify('transfer succeeded') else: Notify('transfer failed') # transfer ONG if ong_amount &gt; 0: param = state(from_acct, to_acct, ong_amount) res = Invoke(1, contract_address_ONG, 'transfer', [param]) if res and res == b'\x01': Notify('transfer succeeded') else: Notify('transfer failed') else: Notify('CheckWitness failed')</span></span></code> </pre> <br><h3>  Übe auf SmartX </h3><br>  Sie können das obige <b>Codebeispiel auch</b> unter <b>SmarX</b> kompilieren und ausführen, <b>indem Sie die</b> folgenden Schritte <b>ausführen</b> : <br><br><ul><li>  <b>Kompilieren Sie den Vertrag.</b>  Erstellen Sie zunächst ein Projekt unter SmartX und kompilieren Sie den Code in diesem Projekt. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/65b/854/62c/65b85462c94b84ed8cc386030dd6879d.png" alt="Bild"><br><ul><li>  <b>Stellen Sie den Vertrag bereit.</b>  Wenn Sie ein Test-Token benötigen, um den Vertrag bereitzustellen, bewerben Sie sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Das Bereitstellungsergebnis lautet wie folgt: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/93a/2df/922/93a2df9224c809fa603ef981394d518b.png" alt="Bild"><br><br><ul><li>  <b>Führen Sie die Übertragungsfunktion aus.</b>  Bevor Sie die Übertragungsfunktion ausführen, müssen Sie die Parameter nach Bedarf konfigurieren.  Im folgenden Beispiel müssen Sie die Sende- und Empfangsadresse sowie den übertragenen ONT- und ONG-Betrag eingeben: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/be6/a4f/3b6/be6a4f3b6ad6460ceabf1d4fba51378b.png" alt="Bild"><br><br><ul><li>  <b>Übertragung erfolgreich.</b>  Nachdem Sie die Parameter richtig konfiguriert haben, ist die Übertragung beim Ausführen der Übertragungsfunktion erfolgreich.  Das übertragene Token wird in der obigen Empfangsadresse angezeigt: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/6fb/9b9/0e4/6fb9b90e4ae451cf540e3294312f498b.png" alt="Bild"><br><br><h2>  Zusammenfassung </h2><br>  In diesem Artikel haben wir die <b>native API</b> der Ontology-Blockchain vorgestellt.  Entwickler können diese API verwenden, um native Ontology-Verträge aufzurufen.  Im nächsten Artikel werden wir die <b>Upgrade-API</b> vorstellen, um zu untersuchen, wie Sie einen Vertrag in Ontology Smart Contracts aktualisieren können. <br><br>  Das Tutorial auf GitHub finden Sie <a href="">hier</a> . <br><br><hr><br><blockquote>  Dies ist ein offizielles Tutorial, das zuvor im Ontology <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Medium-Blog veröffentlicht wurde</a> </blockquote>  Bist du ein Entwickler?  Stellen Sie sicher, dass Sie unserer Tech-Community auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Discord</a> beigetreten sind.  Besuchen Sie auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Developer Center</a> auf unserer Website. Dort finden Sie Entwicklertools, Dokumentation und mehr. <br><br><h4>  Finden Sie die Ontologie woanders </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ontologie-Website</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zwietracht</a> <br>  Telegramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Englisch</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Russisch</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Twitter</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reddit</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471358/">https://habr.com/ru/post/de471358/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471344/index.html">Noch einmal über ImmutableList in Java</a></li>
<li><a href="../de471346/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 384 (7. - 13. Oktober 2019)</a></li>
<li><a href="../de471348/index.html">Full-Stack-TypeScript-Apps</a></li>
<li><a href="../de471350/index.html">Reverse Engineering von rauscharmen Operationsverstärkern von einem analogen Computer im Jahr 1969</a></li>
<li><a href="../de471352/index.html">Präsentationen in LaTeX schreiben</a></li>
<li><a href="../de471360/index.html">Vervielfältigungsmethode. 11 Beispiele aus dem Design von ICE</a></li>
<li><a href="../de471364/index.html">Automatisiertes Testmanagement mit Telegramm</a></li>
<li><a href="../de471366/index.html">Das EU-Gericht lehnt Cookies standardmäßig ab - es sollten keine vorab aktivierten Kontrollkästchen vorhanden sein</a></li>
<li><a href="../de471372/index.html">Warum sollten Unternehmen Mitarbeiter-Smartphones verwalten?</a></li>
<li><a href="../de471374/index.html">Wir laden Sie zu NIXMultiConf # 3 in Kharkov ein</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>