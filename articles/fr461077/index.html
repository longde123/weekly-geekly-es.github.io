<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¦ğŸ½ ğŸ‚ ğŸ‘ƒğŸ¾ Comment les pentesters sont-ils cuits? Test d'entrÃ©e pour les stagiaires en sÃ©curitÃ© numÃ©rique ğŸ“ ğŸ‘¦ ğŸ¥«</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Summer of Hack 2019 en sÃ©curitÃ© numÃ©rique bat dÃ©jÃ  son plein, ce qui signifie qu'il est temps de dire comment nous avons recrutÃ© des personnes. 



 S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment les pentesters sont-ils cuits? Test d'entrÃ©e pour les stagiaires en sÃ©curitÃ© numÃ©rique</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/461077/">  <b>Summer of Hack 2019</b> en sÃ©curitÃ© numÃ©rique bat dÃ©jÃ  son plein, ce qui signifie qu'il est temps de dire comment nous avons recrutÃ© des personnes. <br><br><img src="https://habrastorage.org/webt/iv/ef/ud/ivefudzwssbwskpfaxaxkczsxvu.jpeg"><br><br>  Sous la coupe, du matÃ©riel volumineux et intÃ©ressant sur la faÃ§on dont nous sÃ©lectionnons les jeunes spÃ©cialistes pour notre stage Â«Summer of Hack 2019Â», et plus particuliÃ¨rement pour le dÃ©partement d'audit de sÃ©curitÃ©. <br><br>  ConsidÃ©rez ce que, Ã  notre avis, un pentester devrait savoir pour rÃ©ussir son travail. <br><br>  Analysons un certain nombre de tÃ¢ches difficiles que nous avons torturÃ©es les gars, y compris au nom de l'un d'eux. <br><a name="habracut"></a><br>  Peut-Ãªtre la partie la plus intÃ©ressante de la sÃ©lection pour un stage dans le dÃ©partement d'audit de sÃ©curitÃ© Ã©tait notre profil.  Chaque annÃ©e, nous nous rÃ©unissons dans tout le dÃ©partement et discutons des compÃ©tences qui, Ã  notre avis, sont recherchÃ©es pour un spÃ©cialiste moderne dans le domaine de la sÃ©curitÃ© pratique, rappelons les tÃ¢ches les plus intÃ©ressantes qui ont dÃ» Ãªtre rÃ©solues cette annÃ©e et rÃ©digeons des domaines de connaissances sans lesquels il est difficile d'imaginer un auditeur rÃ©ussi.  Lorsque toutes les blagues sont plaisantÃ©es et que les histoires sont racontÃ©es, le rÃ©sultat final reste un ensemble d'idÃ©es. <br><br>  Cette annÃ©e, nous avons Ã©tÃ© guidÃ©s par les exigences suivantes: <br><br><ul><li>  Connaissance de base des applications Web de l'appareil et des attaques contre celles-ci; </li><li>  Connaissance de base des mÃ©canismes de protection et de contrÃ´le d'accÃ¨s basÃ©s sur un navigateur (oui, les mÃªmes SOP et CORS, sans eux); </li><li>  CompÃ©tences de base en lecture de code et capacitÃ© de voir la logique derriÃ¨re; </li><li>  Comprendre le fonctionnement des rÃ©seaux informatiques et leur routage; </li><li>  ExpÃ©rience avec des systÃ¨mes de type Linux; </li><li>  La capacitÃ© de ne pas avoir peur d'une technologie inconnue.  La capacitÃ© de google et de systÃ©matiser les informations reÃ§ues; </li><li> Et une pincÃ©e d'Android (mais pas nÃ©cessaire, mais c'est notre petit caprice). </li></ul><br>  AprÃ¨s l'Ã©laboration des questions.  En partie, nous les avons empruntÃ©es aux questions que nous avons posÃ©es lors des entretiens, mais plus de la moitiÃ© ont Ã©tÃ© spÃ©cialement prÃ©parÃ©es pour ce questionnaire.  Nos experts ont passÃ© leur temps personnel Ã  prÃ©parer des dÃ©charges de trafic, Ã  discuter de la maniÃ¨re de mieux formuler la question et des vulnÃ©rabilitÃ©s Â«trop spÃ©cifiques, pourquoi tourmenter les stagiairesÂ».  Pour un tel zÃ¨le, on ne peut s'empÃªcher d'enlever notre chapeau (blanc, bien sÃ»r). <br><br>  L'analyse de chaque question se compose de deux parties.  La premiÃ¨re partie est la rÃ©ponse de l'un de nos stagiaires - Danila <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Korgik_0</a> Leontyeva (il est l'auteur de la publication), et la seconde est les commentaires des spÃ©cialistes qui empilaient le questionnaire. <br><br><hr><br>  <i>Bonjour, Habr!</i> <i><br><br></i>  <i>Tout d'abord, une petite digression lyrique.</i> <i><br></i>  <i>Plus prÃ©cisÃ©ment, Â«Comment ai-je dÃ©couvert Summ3r 0f h4ckÂ».</i> <i><br></i>  <i>J'ai entendu parler de l'annonce du stage par un discours de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Denis Rybin</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ilya Bulatov</a> lors de la confÃ©rence RuCTF2019.</i> <i><br><br></i>  <i>LittÃ©ralement aprÃ¨s 4 jours, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article a</a> Ã©tÃ© publiÃ© sur habr Ã  propos de l'ouverture d'un stage.</i> <i><br><br></i>  <i>Et le soir du mÃªme jour, j'ai ouvert la tÃ¢che, dans le dÃ©partement d'audit de sÃ©curitÃ©, et je me suis plongÃ© dans le travail.</i>  <i>Aujourd'hui, je partagerai avec le lecteur quelles difficultÃ©s j'ai eu Ã  affronter et quelle option de solution je pourrais proposer.</i> <br><br><hr><br><h1>  <strong><font color="#cc0000">N Â° 1.</font></strong>  <strong><font color="#cc0000">Code source php</font></strong> </h1><br>  Examinez le code.  DÃ©crivez les dÃ©fauts que vous voyez et comment vous les corrigeriez. <br><br><img src="https://habrastorage.org/webt/ne/0x/ku/ne0xkuq_5uz955i1rypa8or5spk.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  4Ã¨me ligne - utilisez le hachage md5. <br>  ProblÃ¨me - md5 peut Ãªtre brutalisÃ© en un temps raisonnable en utilisant hashcat. <br>  Comment rÃ©parer? <br><br>  Utilisation d'algorithmes de hachage plus "gourmands en ressources". <br>  Dans ce cas, vous devez refuser complÃ¨tement les cookies utilisateur et lier toute la logique Ã  phpsession. <br><br>  5Ã¨me ligne - PostgreSQL-injections. <br>  Comment rÃ©parer? <br>  Utilisation de la dÃ©claration prÃ©parÃ©e. <br>  ImplÃ©mentation d'une instruction prÃ©parÃ©e pour vÃ©rifier la connexion <br><br><pre><code class="plaintext hljs">$query = "SELECT username FROM login WHERE username=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($username)); $username = $stmt-&gt;fetchColumn(); if($username == FALSE) { die(" !"); }</code> </pre> <br>  11 ligne - un certain nombre de dÃ©cisions infructueuses. <br><br><ol><li>  DurÃ©e de vie trop longue.  Une annÃ©e entiÃ¨re, c'est beaucoup.  Si le cookie est piratÃ© avec succÃ¨s, un accÃ¨s long au compte utilisateur par l'attaquant est possible. </li><li>  Drapeau httpOnly manquant.  S'il est dÃ©fini sur TRUE, les cookies ne seront accessibles que via le protocole HTTP.  Autrement dit, les cookies dans ce cas ne seront pas disponibles pour les langages de script comme JavaScript. </li><li>  Aucun hachage de cookie. </li><li>  Absence de dÃ©finition du drapeau sÃ©curisÃ©.  L'indicateur sÃ©curisÃ© indique qu'un cookie doit Ãªtre envoyÃ© par le client via une connexion HTTPS sÃ©curisÃ©e.  S'il est dÃ©fini sur TRUE, le cookie du client sera envoyÃ© au serveur uniquement si une connexion sÃ©curisÃ©e est Ã©tablie. </li></ol><br>  Comment rÃ©parer? <br>  Par dÃ©faut, en php, la durÃ©e de vie de la session n'est que de 24 minutes, implÃ©mentons cela. <br>  DÃ©finissez l'indicateur sÃ©curisÃ©, httpOnly. <br><br>  Dans ce cas, vous devez refuser l'Ã©trange cookie utilisateur et lier toute la logique Ã  phpsession. <br><br>  18 lignes - XSS (English Cross-Site Scripting - "intersite scripting"). <br>  Comment rÃ©parer?  Convertissez tous les caractÃ¨res possibles en entitÃ©s HTML correspondantes. <br><br><pre> <code class="plaintext hljs">$query = htmlentities($query, ENT_QUOTES, "UTF-8");</code> </pre> <br>  Nous indiquerons explicitement l'encodage afin d'Ã©viter sa substitution par UTF-7. <br><br><pre> <code class="plaintext hljs">header("Content-Type: text/html; charset=utf-8");</code> </pre> <br>  Ligne 20 - dÃ©fauts du systÃ¨me d'authentification et de stockage de session. <br><br>  ProblÃ¨me - si vous dÃ©finissez l'ID utilisateur encodÃ© en base64 dans l'utilisateur cookie, vous pouvez vous connecter Ã  son compte! <br><br>  Comment rÃ©parer?  Lors de l'autorisation de l'utilisateur, nous enregistrons la session dans la base de donnÃ©es et lors de l'installation de la session, nous vÃ©rifions sa prÃ©sence dans la base de donnÃ©es. <br><br><pre> <code class="plaintext hljs"> $query = "SELECT sessions FROM login WHERE sessions=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($_COOKIE["user"])); $session = $stmt-&gt;fetchColumn(); if($session == TRUE) { do_login($_COOKIE["user"]); }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire d'expert D:</b> <div class="spoiler_text"><blockquote>  La premiÃ¨re question avec laquelle le questionnaire a rencontrÃ© les futurs stagiaires concerne les principales vulnÃ©rabilitÃ©s du Web.  La seule difficultÃ© ici est la nÃ©cessitÃ© de les voir dans le code source en PHP.  Cependant, personne n'a dÃ©fini la tÃ¢che de Â«cacher les boguesÂ». <br><br>  Voici une liste des vulnÃ©rabilitÃ©s qui peuvent Ãªtre dÃ©tectÃ©es dans cette liste par ordre de frÃ©quence de leur dÃ©tection: <br><br>  <b>Le hachage de mot de passe utilisant l'algorithme MD5 a Ã©tÃ©</b> remarquÃ© mÃªme par des candidats Ã©loignÃ©s du Web.  Cependant, il y avait aussi des nuances intÃ©ressantes, par exemple, de nombreux candidats ont utilisÃ© des termes trÃ¨s incorrects, essayant de dÃ©crire les problÃ¨mes dans leurs propres mots.  Les Â«vulnÃ©rabilitÃ©s des algorithmesÂ», les Â«fonctions Ã  sens uniqueÂ», Â«l'existence de collisionsÂ» et d'autres virages Ã©tranges sont entrÃ©s en bataille, aprÃ¨s un examen plus approfondi, ils s'avÃ¨rent n'Ãªtre rien de plus qu'un ensemble de grands mots qui ne rÃ©vÃ¨lent pas l'essence.  Bien sÃ»r, nous sommes allÃ©s ici Ã  une rÃ©union et nous n'avons pas trouvÃ© Ã  redire Ã  ces personnes qui se prÃ©parent Ã  se lancer sur la voie de l'apprentissage de la sagesse de la sÃ©curitÃ© de l'information.  Pour obtenir une "compensation", il suffit de mentionner la menace, en cas de compromission de la base de donnÃ©es, les hachages md5 peuvent Ãªtre triÃ©s par un attaquant dans un dÃ©lai acceptable et des mots de passe (ou des chaÃ®nes Ã©quivalentes) peuvent Ãªtre obtenus en texte clair.  Et, bien sÃ»r, beaucoup ont mentionnÃ© le manque de sel et de force brute basÃ© sur l'utilisation de tables arc-en-ciel.  Nous avons Ã©galement perÃ§u ces commentaires de faÃ§on positive, surtout si le rÃ©pondant a expliquÃ© pourquoi il s'agissait d'une menace. <br><br>  <b>Injection SQL potentielle.</b>  Il est difficile d'ajouter quelque chose;  lors de l'appel Ã  la base de donnÃ©es, la saisie de l'identifiant et du mot de passe par l'utilisateur est directement concatÃ©nÃ©e avec la demande.  S'il est peu probable que vous puissiez manipuler la valeur du mot de passe Ã  ce stade (un hachage en est extrait), l'introduction d'une injection dans le nom d'utilisateur ne sera pas difficile pour un attaquant potentiel. <br><br>  <b>Sortie d'informations de dÃ©bogage inutiles conduisant Ã  une attaque XSS.</b>  En lisant attentivement la liste, on pourrait prÃªter attention Ã  l'appel d'Ã©cho, qui affiche la demande gÃ©nÃ©rÃ©e Ã  la base de donnÃ©es dans les commentaires HTML sur la page.  Bien entendu, une telle conclusion d'informations supplÃ©mentaires sur la page est complÃ¨tement facultative et, trÃ¨s probablement, simplement oubliÃ©e par le dÃ©veloppeur aprÃ¨s avoir effectuÃ© les tests.  Ces informations supplÃ©mentaires sont trÃ¨s bÃ©nÃ©fiques pour l'attaquant et permettent une bien meilleure comprÃ©hension du fonctionnement de l'application.  Cependant, malheureusement, ce n'est que la moitiÃ© du problÃ¨me.  Le fait est qu'un attaquant peut manipuler le contenu de la variable de requÃªte, et que son contenu ne peut pas Ãªtre filtrÃ© ou Ã©chappÃ© avant d'Ãªtre affichÃ© Ã  l'utilisateur - il existe une attaque XSS potentielle.  Cependant, son exploitation peut s'avÃ©rer Ãªtre encore un casse-tÃªte en raison de la fonction strtoupper mal situÃ©e.  Le vecteur injectÃ© par l'attaquant sera en majuscule, et si ce n'est pas un problÃ¨me pour les balises HTML, Javascript est trÃ¨s offensÃ© par un tel appel.  Cela peut Ãªtre facilement vÃ©rifiÃ© Ã  l'aide de la console du navigateur. <br><br><img src="https://habrastorage.org/webt/cg/ev/oy/cgevoykot6pzht0mx5ppeqyxwne.png"><br><br>  Eh bien, au moins, apparemment, l'attaquant devra se tourner vers les soi-disant Â«attaques sans scriptÂ» ou des techniques sophistiquÃ©es pour contourner le filtrage (dans ce cas, JSFUCK le ferait), donc le fait d'un risque de sÃ©curitÃ© n'annule pas cela. <br><br>  <b>Une erreur dans la logique du mÃ©canisme de gestion de session</b> Ã©tait la partie la plus intÃ©ressante de la tÃ¢che.  Sa dÃ©couverte a nÃ©cessitÃ© non seulement de lire la source ligne par ligne, mais aussi de comprendre la logique de l'ensemble du listing.  On pouvait sentir que quelque chose n'allait pas en remarquant la configuration d'un cookie contenant l'ID utilisateur encodÃ© en base64 dans le bloc Remember-me.  Une analyse plus approfondie de la logique de ce mÃ©canisme nous amÃ¨ne Ã  la rÃ©flexion: Â«Il s'avÃ¨re qu'un attaquant qui connaÃ®t ou passe par l'identifiant peut se connecter Ã  n'importe quel compte sans entrer de nom d'utilisateur et de mot de passe?!Â».  Oui, en effet, un attaquant peut gÃ©nÃ©rer indÃ©pendamment un utilisateur de cookie de son cÃ´tÃ© et lui attribuer toute valeur d'ID codÃ©e par base64.  L'envoi d'une demande avec un tel cookie sans nom d'utilisateur et mot de passe dÃ©clencherait la fonction do_login et se connecterait au compte de quelqu'un d'autre. <br><br>  La mention de ces 4 vulnÃ©rabilitÃ©s dans la rÃ©ponse des candidats a directement influencÃ© leurs scores. <br><br>  Cependant, beaucoup dÃ©pendait de la qualitÃ© de la rÃ©ponse.  Mentionner des moyens de rectifier la situation, des commentaires sur des facteurs supplÃ©mentaires affectant la faisabilitÃ© d'une attaque, l'utilisation des bons termes et la capacitÃ© de structurer vos pensÃ©es, des commentaires sur des faiblesses supplÃ©mentaires ou des menaces potentielles - tout cela nous a rÃ©chauffÃ© le cÅ“ur et conduit Ã  une augmentation de la note finale. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">N Â° 2.</font></strong>  <strong><font color="#cc0000">Jwt</font></strong> </h1><br>  Lors de la recherche d'une application Web, vous avez constatÃ© que l'application utilise un jeton JWT comme autorisation. <br><br>  Quels problÃ¨mes de sÃ©curitÃ© voyez-vous, quel genre de contrÃ´les feriez-vous? <br><br>  Jeton JWT: <br><br><pre> <code class="plaintext hljs">eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6InNla2EiL CJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiRmFsc2UiLCJwYX Nzd29yZCI6IjFkMDBjYUgifQ.F7Y1mCAmg5-QFok-rkpLdwe8prCyiKsCyJ-3Z5f7luI</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  Jetons Web Dan JSON (JWT). <br>  Sa structure -&gt; [base64url (HEADER)]. [Base64url (PAYLOAD)]. [Base64url (SIGNATURE)] <br>  [base64url (HEADER)] = eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0 <br>  dÃ©codage base64url -&gt; {"alg": "None", "typ": "JWT"} <br>  On peut noter immÃ©diatement que l'algorithme de signature (Â«algÂ»: Â«NoneÂ») de la signature n'est pas utilisÃ©.  Certaines bibliothÃ¨ques JWT ne prennent pas en charge l'algorithme Â«aucunÂ», c'est-Ã -dire l'algorithme de signature.  Lorsque l'en-tÃªte alg est Â«aucunÂ», le cÃ´tÃ© serveur n'effectuera pas de vÃ©rification de signature. <br>  Autrement dit, vous pouvez Ã©crire n'importe quelle charge utile dans base64url, et sa signature ne sera pas vÃ©rifiÃ©e. <br>  Ce qui nous permet de crÃ©er un utilisateur avec des droits d'administrateur. <br><br>  De plus, le fait que la partie charge utile n'utilise pas des en-tÃªtes tels qu'aud (dÃ©finit les destinataires auxquels le jeton JWT est destinÃ©) et exp (la durÃ©e de vie du jeton) simplifie nos vies. <br><br>  Charge utile estimÃ©e <br>  eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6ImhhY2siLCJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiVHJ1ZSIsInBhc3N3b3JkIjoiaGFjayJ9 <br><br>  base64url dÃ©coder la charge utile -&gt; {"sub": "1234567890", "name": "hack", "iat": 1516239022, "role": "nobody", "isAdmin": "True", "password": "hack Â»} <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire d'expert D:</b> <div class="spoiler_text"><blockquote>  Dans le travail de l'auditeur doivent souvent faire face aux nouvelles technologies, et la capacitÃ© de les comprendre est trÃ¨s importante.  En incluant cette question dans le questionnaire, nous avons supposÃ© que la plupart des candidats avaient Ã  peine entendu parler de la technologie des jetons JWT, Ã  l'exception du nom.  Par consÃ©quent, cette question, tout d'abord, visait la capacitÃ© de rechercher et d'analyser des informations provenant de sources publiques.  En consÃ©quence, une personne qui a ratÃ© l'Ã©mission de Google Ã  la demande de Â«JWTÂ» et Â«vulnÃ©rabilitÃ© jwtÂ» pourrait tirer les conclusions suivantes: <br><br>  1. Ce jeton n'a pas d'algorithme de signature, donc un attaquant est en mesure de modifier tous les champs Ã  l'intÃ©rieur du jeton, ce qui n'est pas supposÃ© par le concept de jetons JWT. <br><br>  2. Les champs Ã  l'intÃ©rieur du jeton contiennent le mot de passe de l'utilisateur en texte clair, le stockage de ces informations dans le jeton est, au minimum, une mauvaise pratique.  Dans la plupart des cas, vous pouvez refuser une telle dÃ©cision et ainsi augmenter votre niveau de sÃ©curitÃ©. <br><br>  3. En se souvenant de l'absence de signature et de notre capacitÃ© Ã  modifier les champs Ã  l'intÃ©rieur du jeton, il est logique de supposer que la modification de la valeur de isAdmin peut augmenter nos privilÃ¨ges en privilÃ¨ges d'administrateur. <br><br>  4. Une autre idÃ©e intÃ©ressante que peu de personnes ont mentionnÃ©e dans leur rÃ©ponse concerne le fait mÃªme de la possibilitÃ© de transfÃ©rer les entrÃ©es des utilisateurs dans les champs d'un jeton JWT.  Dans une situation normale, un attaquant ne peut en aucune faÃ§on influencer les donnÃ©es du jeton, ce qui signifie que les dÃ©veloppeurs peuvent souvent nÃ©gliger l'introduction de vÃ©rifications supplÃ©mentaires dans le code des gestionnaires.  Cela demande une idÃ©e simple: mais essayons de mener des attaques classiques non pas Ã  travers les paramÃ¨tres GET / POST, mais Ã  travers les champs de jetons.  Cela peut donner un bon rÃ©sultat inattendu.  Une telle approche crÃ©ative avec la justification correcte de nos actions a Ã©tÃ© trÃ¨s apprÃ©ciÃ©e par nous dans l'Ã©valuation de cette question et d'autres. <br><br>  De nombreux candidats dans leurs rÃ©ponses ont organisÃ© une brÃ¨ve explication de la faÃ§on dont le jeton JWT est structurÃ© et oÃ¹ il est utilisÃ©, c'Ã©tait intÃ©ressant pour nous de lire, et pourtant, tout d'abord, nous avons Ã©valuÃ© les aspects de la rÃ©ponse concernant la sÃ©curitÃ©. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">NumÃ©ro 3.</font></strong>  <strong><font color="#cc0000">CORS / CSRF / IDOR / ???</font></strong> </h1><br><br>  Dans l'application Web, le mot de passe utilisateur est modifiÃ© Ã  l'aide de la demande suivante (voir option 1).  Quelles menaces de sÃ©curitÃ© potentielles voyez-vous?  Quels contrÃ´les effectueriez-vous?  La situation changera-t-elle dans le cas du comportement suivant (voir Option 2)?  Expliquez votre rÃ©ponse. <br><img src="https://habrastorage.org/webt/mr/b-/se/mrb-seaadzkgqbmqvsq-zcqflyo.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  <b>Option 1</b> <br>  "Quelles menaces de sÃ©curitÃ© potentielles voyez-vous?" <br><br>  1) Absence de contrÃ´le d'accÃ¨s. <br>  Si le numÃ©ro d'utilisateur-a auquel la demande de changement de mot de passe est effectuÃ©e n'est pas vÃ©rifiÃ©, le mot de passe peut Ãªtre modifiÃ© pour tout utilisateur enregistrÃ© dans le systÃ¨me. <br>  Comment rÃ©parer?  - Correspondance de JSESSION Ã  partir de la base de donnÃ©es et de l'id-shnik demandÃ©. <br><br>  2) La capacitÃ© de mener des attaques CSRF <br>  Nous attirons un utilisateur autorisÃ© vers un hÃ´te que nous contrÃ´lons et, aprÃ¨s avoir fait une demande, vers example.com au nom de la victime, pour changer le mot de passe. <br>  Comment rÃ©parer?  - Ajout d'un jeton CSRF. <br><br>  <b>Option 2</b> <br>  "Quelles menaces de sÃ©curitÃ© potentielles voyez-vous?" <br>  Une faille dans la politique CORS. <br>  Il est recommandÃ© de mettre en liste blanche l'en-tÃªte Access-Control-Allow-Origin. <br><br>  Comment rÃ©parer?  - <br><br>  1) Modification du fichier .htaccess <br><br><pre> <code class="plaintext hljs">&lt;ifmodule mod_headers.c&gt; Header always set Access-Control-Allow-Origin: "https://whitelist.domain.ru" Header always set Access-Control-Allow-Methods "PUT" &lt;/ifmodule&gt;</code> </pre><br>  2) PHP <br><br><pre> <code class="plaintext hljs">&lt;?php header('Access-Control-Allow-Origin: â€œhttps://whitelist.domain.ruâ€); header('Access-Control-Allow-Methods: PUT'); ?&gt;</code> </pre><br>  "La situation changera-t-elle avec le comportement suivant?" <br><br>  Oui  Ã‰tant donnÃ© que dans le deuxiÃ¨me cas, une demande PUT est utilisÃ©e, ce qui est important, car l'utilisation d'une demande PUT rend la demande CORS Â«difficileÂ», ce qui Ã  son tour nous prive complÃ¨tement de la possibilitÃ© de mener une attaque CSRF + l'absence d'un en-tÃªte tel que Access-Control-Allow-Credentials: true nous prive la possibilitÃ© d'envoyer en place avec d'autres en-tÃªtes http et cookies utilisateur. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire d'expert I:</b> <div class="spoiler_text"><blockquote>  ConsidÃ©rons, dans l'ordre, quels sont les principaux problÃ¨mes visibles sur les requÃªtes donnÃ©es: <br><br>  1) En effet, lâ€™identifiant numÃ©rique de lâ€™utilisateur Â«10012Â» Ã©tant observÃ© dans la requÃªte, la premiÃ¨re Ã©tape consiste Ã  vÃ©rifier sâ€™il est possible de changer le mot de passe dâ€™un autre utilisateur?  Puis-je <b>spÃ©cifier</b> suffisamment l' <b>identifiant de quelqu'un d'autre</b> ? <br>  Les vulnÃ©rabilitÃ©s de la classe IDOR sont assez faciles Ã  exploiter et prÃ©sentent souvent une criticitÃ© Ã©levÃ©e. <br><br>  2) La demande de changement de mot de passe se produit par la mÃ©thode POST, le jeton CSRF n'est pas respectÃ© et le type de contenu est Â«texte / simpleÂ».  Il est possible de <b>truquer une telle demande.</b> <br><br>  Par consÃ©quent, pour changer le mot de passe de la victime, il suffit Ã  lâ€™attaquant de le convaincre de simplement visiter le lien Â«malveillantÂ». <br><br>  3) Dans les en-tÃªtes de rÃ©ponse, le serveur <b>rÃ©vÃ¨le la version du logiciel utilisÃ©</b> .  Cela peut Ãªtre appelÃ© une vulnÃ©rabilitÃ© Ã  la longue, mais il est prÃ©fÃ©rable de masquer de telles banniÃ¨res - les attaquants peuvent facilement y trouver des exploits connus d'un jour, plus la valeur du logiciel utilisÃ© simplifie considÃ©rablement la planification d'autres attaques. <br><br>  4) Nous serions trÃ¨s heureux de voir la phrase "Que se passera-t-il si nous <b>changeons le format de donnÃ©es de JSON en XML</b> ?" <br><br>  Le fait est que les cadres modernes sont intelligents, omnivores et peuvent traiter des donnÃ©es dans diffÃ©rents formats.  Et lors de l'analyse de XML, une vulnÃ©rabilitÃ© XXE dangereuse est souvent autorisÃ©e.  Avec son aide, l'intrus peut "aller" sur le rÃ©seau interne, lire les fichiers de configuration du serveur et parfois exÃ©cuter RCE. <br><br>  5) Je voulais Ã©galement voir une remarque comme Â«Pourquoi <b>la connaissance de l'ancien n'est-elle pas vÃ©rifiÃ©e</b> lors du changement de mot de passe?Â» <br><br>  Quant Ã  la Â«variante n Â° 2Â», elle contient un Â«piÃ¨geÂ» - les en-tÃªtes CORS sont utilisÃ©s ici et le type de contenu de la demande est dÃ©jÃ  dÃ©fini sur Â«application / jsonÂ». <br><br>  L'erreur que la grande majoritÃ© des candidats a faite est la rÃ©ponse du formulaire "-C'est l'astÃ©risque dans Allow-Origin, ce qui signifie que vous pouvez envoyer des demandes depuis n'importe quel site!" <br><br>  Non, tu ne peux pas.  Tout d'abord, l'en-tÃªte Allow-Credentials: True est manquant, ce qui signifie que le navigateur doit exÃ©cuter la demande Â«avec des cookiesÂ», de sorte que la demande serait anonyme, sans session.  Et deuxiÃ¨mement, mÃªme si un tel en-tÃªte Ã©tait prÃ©sent, le navigateur interdirait toujours d'envoyer des cookies - simplement Ã  cause de l'astÃ©risque.  Leur combinaison est interdite et le navigateur est ignorÃ©. <br></blockquote></div></div><br><hr><br><h1>  <strong><font color="#cc0000">NumÃ©ro 4.</font></strong>  <strong><font color="#cc0000">Vidage rÃ©seau</font></strong> </h1><br>  Imaginez que vous Ãªtes entrÃ© dans le rÃ©seau interne de l'entreprise et avez interceptÃ© le trafic dont le vidage est joint ci-dessous.  DÃ©crivez quelles attaques vous tenteriez de mener et avec quels outils? <br><br>  Dump: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">yadi.sk/d/qkLcfwSCzdxcwg</a> <br><br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  1) Usurpation de LLMNR &lt; <br>  Un attaquant du sous-rÃ©seau local peut Ã©couter et rÃ©pondre aux messages diffusÃ©s, affirmant que le nom d'hÃ´te demandÃ© est sa propre adresse IP. <br>  Cela conduit au fait que l'ordinateur client demandeur est connectÃ© Ã  l'ordinateur de l'attaquant et, selon le protocole, peut tenter de s'authentifier. <br><br>  Les utilitaires utilisÃ©s sont Intercepter-NG, un projet sur githab VindicateTool. <br><br>  2) Abus HSRP. <br>  ProblÃ©matique - lorsque le paramÃ¨tre Â«preemptÂ» est dÃ©fini sur 1, l'attaquant a la possibilitÃ© Â«d'Ã©vincerÂ» les autres routeurs, en raison de la prioritÃ© plus Ã©levÃ©e.  AprÃ¨s avoir envoyÃ© HSRP Ã  la multidiffusion, le routeur contrÃ´lÃ© devient le routeur principal (routeur actif) du rÃ©seau et tout le trafic y passera.  En fait, nous sommes arrivÃ©s Ã  la mise en Å“uvre d'attaques mitm. <br><br>  Pour ce vecteur d'attaque, nous devons connaÃ®tre le groupe et le mot de passe. <br>  A partir du vidage de trafic qui nous est donnÃ©, nous reconnaissons le groupe (c'est-Ã -dire 3) et le mot de passe.  Le mot de passe dans notre cas est par dÃ©faut - Cisco. <br><br>  Les utilitaires utilisÃ©s sont yersinia, scapy. <br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire de l'expert X:</b> <div class="spoiler_text"><blockquote>  L'objectif de la question Ã©tait de dÃ©terminer la familiaritÃ© du stagiaire avec les techniques modernes (et pas si) pour mener des attaques MitM.  Examinons les scÃ©narios potentiels basÃ©s sur un vidage de trafic existant: <br><br>  <b>1) Usurpation ARP</b> <br>  L'usurpation ARP est le moyen le plus ancien et le plus simple de mettre en Å“uvre des attaques MitM.  Elle consiste Ã  envoyer une requÃªte ARP gratuite Ã  l'hÃ´te A. <br><br>  L'adresse IP de l'hÃ´te B est l'adresse IP et notre adresse MAC est l'adresse MAC.  Une telle demande vous permet de modifier la table ARP sur l'hÃ´te A, le forÃ§ant Ã  envoyer des demandes Ã  notre appareil lorsque vous essayez de contacter l'hÃ´te B. L'hÃ´te B est gÃ©nÃ©ralement la passerelle par dÃ©faut. <br><br>  Outils recommandÃ©s: bettercap, arpspoof <br><br>  <b>2) Usurpation LLMNR, NBNS</b> <br>  Link-Local Multicast Name Resolution et NetBIOS Name Service sont les protocoles utilisÃ©s pour rÃ©soudre les noms d'hÃ´tes sur le rÃ©seau local.  Contrairement au protocole DNS, il n'y a pas de serveur dÃ©diÃ© qui stocke toutes les informations; Ã  la place, la demande est diffusÃ©e Ã  tous les hÃ´tes du rÃ©seau, si le nom d'hÃ´te dans la demande correspond au nom d'hÃ´te du pÃ©riphÃ©rique, il enverra une rÃ©ponse. <br><br>  Comme cela a Ã©tÃ© correctement notÃ© dans la rÃ©ponse, l'attaquant peut rÃ©pondre Ã  de telles demandes en envoyant son adresse IP dans la rÃ©ponse, ce qui conduira Ã  l'avenir Ã  ce que la victime contacte l'appareil de l'attaquant, au lieu de l'appareil dont le nom d'hÃ´te est apparu dans la demande.  De plus, un attaquant peut demander l'authentification NTLM Ã  la victime, ce qui oblige le pÃ©riphÃ©rique victime Ã  envoyer un hachage NTLM, qui peut ensuite Ãªtre utilisÃ© pour la force brute. <br><br>  Outils recommandÃ©s: RÃ©pondeur <br><br>  <b>3) Usurpation de WPAD</b> <br>  L'usurpation WPAD peut Ãªtre attribuÃ©e Ã  un cas spÃ©cial d'usurpation LLMNR et NBNS.  Le protocole Web Proxy Auto Discovery est utilisÃ© pour configurer automatiquement un serveur proxy HTTP. <br><br>  Le pÃ©riphÃ©rique envoie une demande LLMNR / NBNS avec le nom d'hÃ´te wpad, reÃ§oit l'adresse IP correspondante et essaie d'accÃ©der au fichier wpad.dat via HTTP, qui stocke des informations sur les paramÃ¨tres du proxy. <br><br>  En consÃ©quence, l'attaquant peut effectuer une usurpation LLMNR / NBNS et fournir Ã  la victime son fichier wpad.dat, par consÃ©quent, tout le trafic HTTP et HTTPS passera par l'attaquant. <br><br>  Outils recommandÃ©s: RÃ©pondeur, mitm6 <br><br>  <b>4) PublicitÃ© du routeur</b> <br>  Comme vous pouvez le voir sur le vidage, il existe des pÃ©riphÃ©riques avec IPv6 activÃ© sur le rÃ©seau.  Sur le rÃ©seau, vous pouvez essayer d'envoyer des messages Ã  l'annonce du routeur IPv6 victime afin de changer la passerelle ou le serveur DNS par dÃ©faut. <br><br>  Les messages d'annonce de routeur (RA) font partie du mÃ©canisme SLAAC (Stateless Address Autoconfiguration), qui est nÃ©cessaire pour obtenir automatiquement des adresses IPv6 sur un rÃ©seau, sans utiliser de serveur DHCPv6 ou conjointement avec lui.  Ceci est rÃ©alisÃ© en envoyant pÃ©riodiquement des messages RA de multidiffusion au routeur, qui contiennent l'adresse de passerelle par dÃ©faut, le prÃ©fixe de rÃ©seau, l'adresse du serveur DNS, le prÃ©fixe de domaine. <br><br>  Outils recommandÃ©s: paquet brut <br><br>  <b>5) Usurpation DHCP</b> <br>  En outre, dans un vidage, les demandes de dÃ©couverte DHCP du mÃªme pÃ©riphÃ©rique sont rÃ©pÃ©tÃ©es Ã  certains intervalles.  Vous pouvez tirer des conclusions sur l'absence d'un serveur DHCP dans ce rÃ©seau et rÃ©pondre Ã  la prochaine demande Discover en spÃ©cifiant la victime comme passerelle par dÃ©faut vers le pÃ©riphÃ©rique. <br><br>  Outils recommandÃ©s: Yersinia <br><br>  <b>6) Usurpation HSRP</b> <br>  De plus, les paquets HSRP peuvent Ãªtre vus dans le vidage.  Le protocole de redondance d'UC peut augmenter la disponibilitÃ© des routeurs qui agissent comme passerelle par dÃ©faut.          IP-,     -.   Hello -        ,           .           HSRP, ,      ,      HSRP         . <br><br>  : Yersinia <br><br> <b>7) STP-</b> <br> Spanning Tree Protocol      L2-  .    BPDU-,           ,     .          BPDU-,   ,   ,    ,    ,         ,   ,   ,     STP,    ,    . <br><br>  : Yersinia <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">â„–5. NGINX config</font></strong> </h1><br><br>    - nginx.  ,       ? <br><br> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pastebin.com/nYp7uVbB</a> <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">   nginx,          : <br> 1)  86 ,   http  X-Managed      secured,  nginx     /management/ <br> 2)        API  70  105 . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  J:</b> <div class="spoiler_text"><blockquote>        ,          .   nginx    ,     web-,       nginx    web-  /.           nginx ,  , ,     . <br><br> ,     ,   ,            .      ,         . ,    ,     . <br><br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gixy</a> . <br><br> Gixy  4    : <br><br> <b>1) Alias travesal:</b> <br><br>   80     : <br><br><pre> <code class="plaintext hljs">location /static { alias /prod_static/; }</code> </pre><br>     - ,    .  : //host/static../etc/passwd.   -     alias:     ,   /static,   /prod_static/,       : /prod_static/../etc/passwd,      /etc/passwd.    alias traversal  <a href=""></a> <br><br> <b>2) Http Splitting (CRLF injection)</b> <br>    nginx  ,   ,        .       HTTP-. <br> : <a href="https://github.com/yandex/gixy/blob/master/docs/ru/plugins/">github.com/yandex/gixy/blob/master/docs/ru/plugins/httpsplitting.md</a> <br><br> <b>3)   -   </b> <br>   75      Â«riginÂ»   .    , -       , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">production.host.evil.com</a> . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/origins.md</a> <br><br> <b>4)     add_header</b> <br>  nginx  :      add_header,       , ,    ,  .      CSP      . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/addheaderredefinition.md</a> <br><hr><br>  ,   gixy,          .       : <br><br> 1)   17     <b>default_type   text/html.</b>     :   ,     ,  nginx    Content-Type,    default_type.   ,         Content-Type: text/html.            HTML-  ,   , , XSS-   . <br><br> <b>2)    POST-</b> <br>  29-30   ,           .  ,   â€œâ€ POST-.       .  Mais!       SSRF  ,     ,   ,     , . <br><br> <b>3)   php-fpm</b> <br>   48  ,  FastCGI-    unix ,    9000.  ,    ,   .   ,      PHP-. <br><br> <b>4) â€œâ€ CSP</b> <br>  production.host  Content-Security-Policy,    Javascript,    . <br><br> <b>5) â€œâ€ CORS</b> <br>   76-77   CORS,          ,       cookie  . <br><br> 6)     ,   86   <b>  </b>  .       secured     /managed. <br><br> 7)      ,    ,        ,    -. ,   ,  ,    /user/{userid}  IDOR. <br><br>   ,       ,    ,     . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">â„–6. Linux Permissions</font></strong> </h1><br>     Linux      ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">  ~ ()  Debian <br> C              ( ,      /etc/passwd). <br> ,      ftp  ,     ~. <br><br>  Un exemple: <br> * root@server:~# ls ~ftp <br> * welcome.msg <br>      : <br> * root@server:~# cat ~ftp/welcome.msg <br> * Welcome, archive user %U@%R! <br>   ,    :      : <br> * root@amorale:~# echo ~ftp <br> * /srv/ftp <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  K:</b> <div class="spoiler_text"><blockquote>    ,        : <br><br><ul><li>       </li><li>  ACL      </li><li>    </li><li>      </li><li>  capabilities </li></ul><br>   ,      ,   : <br> â€œ ,   rootâ€   . <br><br>      ,     <code>Linux/Unix</code> . <br>    ,        â€œ â€ â€”           . <br>   ,     ,    <code>funky_test.txt</code>      <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br> ,    Linux/Unix   : <br><br><ul><li>  - â€”    â€œrwxâ€  alice </li><li>   â€”    â€œrwâ€   interns </li><li>    â€”    â€œrxâ€  others </li></ul><br>          <code>read, write, execute</code> . <br><br> ,     â€”       ,      : <br><br><ul><li>    ,      read </li><li>    ,      read </li><li>     read </li></ul><br>  ,       <code>read</code>            .      ,      execute  . <br><br>            ,    . <br><br>          , ,    .      : <br><br> 1.          ,       ls. <br><br> 2.      â€” <code>POSIX Access Control Lists</code> . <br><br><h4>    c   . </h4><br><h6>  1 </h6><br> ,   <code>alice</code>     <code>interns</code> .      <code>funny_test.txt</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami alice $ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied $</code> </pre><br><h5>  2 </h5><br>   â€”   <code>funky_test.txt</code>  604.    <code>bob</code> ,    <code>interns</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami bob $ id uid=1002(bob) gid=1003(bob) groups=1003(bob),1002(interns) $ ls -la funky_test.txt -rw----r-- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied</code> </pre><br><h5>  </h5><br>    <code>alice</code>       ,  .  , <code>permission_denied</code>    : <br><br><pre> <code class="plaintext hljs">$ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ chmod 777 funky_test.txt $ ls -la funky_test.txt -rwxrwxrwx 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt secret_pass</code> </pre><br>      bob    . <br><br><h5>   </h5><br>    ,          Â«  Â»,  : <br><br><ul><li>  ID      <code>effective UID</code> â€”      </li><li>  GID        <code>effective GID</code> â€”      </li><li>      others. </li></ul><br><h5>   </h5><br>  ,      â€”   ,       â€œâ€    ,        ,    , : <br><br><ul><li>    ,   ,          <code>others</code>     </li><li>   ,     ,   <code>others</code>     </li></ul><br>           . <br><br><h4> POSIX Access Control Lists </h4><br>      â€”         /.   ,     ACL,  ,       â€œ <code>+</code> â€ <br><br>      POSIX ACLs,    â€”     ,            .      ACL,        . <br><br><h5>  Exemple </h5><br>   .        <code>alice</code>   <code>funky_test.txt</code>  ,   <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br>      ACL.  <code>getfacl</code> , ,    ACL,   ,     <code>ls</code> . <br><br><pre> <code class="plaintext hljs">$ getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx group::rw- other::rx</code> </pre><br>   , ACL        .  ,     bob  : <br><br><pre> <code class="plaintext hljs">setfacl -mu:bob:rwx funky_test.txt</code> </pre><br>       â€œ <code>+</code> â€   <br><br><pre> <code class="plaintext hljs">ls -l funky_test.txt -rwxrwxr-x+ 1 alice interns 12  4 13:00 funky_test.txt</code> </pre><br>     : <br><br><pre> <code class="plaintext hljs">getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx user:bob:rwx group::rw- mask::rwx other::rx</code> </pre><br>  ACL     .  : <br><br><ol><li>     .      <code>effective UID</code>  <code>effective GID</code>  â€”  .        ,       ACL,       .  ,     ,   ,  ,         ,    . </li><li>   ACL  <code>mask</code> ,      ACL    <code>owner, group, others</code> </li></ol><br><h5>   </h5><br>  ,         ,  ,     â€”      . <br><br>   ,  ACL,     , : <br><br><ul><li>        ACL,     ; </li><li>   ,         ACL,     . </li></ul><br></blockquote></div></div><br><br><hr><br><h1> <strong><font color="#cc0000">â„–7. Network Dump II</font></strong> </h1><br>            .  ,        ,   ,       . <br><br>  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">yadi.sk/d/e3gNme4MBo6tFQ</a> <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">   â€”      . <br>      ,     . <br>   ,     . <br><br><img src="https://habrastorage.org/webt/2t/zn/ip/2tznipywtpqwalr5drvxxr4z0sw.png"><br><br>   ,     SMB-,  ,    ,       .       SMB object list (File -&gt; Export objects -&gt; SMBâ€¦ ). <br><br>    â€”     . <br><br><img src="https://habrastorage.org/webt/fe/rt/xy/fertxyt0du3kv3qwcmivz1m6opg.png"><br> <i>(  SMB object list)</i> <br><br><img src="https://habrastorage.org/webt/xo/yd/t-/xoydt-qmcbddrx1lkoqmpplyslg.png"><br> <i>(NotTruePass.jpg)</i> <br><br>     . <br><br>        â€œâ€    TCP-â€¦     .    .  :( <br><br>    ,        .    . <br><br><img src="https://habrastorage.org/webt/fd/ch/fc/fdchfcsbkrwxmx08ltr_1qnoozg.png"><br> <i>(  desktop.ini)</i> <br><br>     â€œâ€     . ,      NTLM,   ,  ,  NTLM      â€œPass-the-hashâ€.               Â«-Â». <br><br>     â€œâ€    : <br><br><pre> <code class="plaintext hljs">1)User - 1 Account: IEUser Domain: WIN7 Host: WIN7 hex dump session key - 49 0c 38 3e f8 eb 63 88 79 0f 62 84 09 84 d2 dc 2) User - 2 Account: winwin Domain: WIN7 Host: WIN7 hex dump session key - 8d f6 1b 35 79 a3 78 d3 2e 81 09 f1 95 4f 71 0a 3) User - 3 Account: 192.192.192.29 Domain: WIN7 Host: WIN7 hex dump session key - c3 19 e0 21 1b e2 63 c6 03 9e e7 38 1b 56 f0 d1</code> </pre><br>            .       MSEDGEWIN10. <br><br>    â€”     : <br><br> 1) SMB Relay. <br>           . <br>      ,   MITM- <br> (.             ). <br><br>      â€”        ,      ,  . <br>      .       ,       . <br><br>    ,  ,  ,     . <br><br> 2) NTLM Relay. <br>         ,  NTLM-. <br><br>         ,   NTLM-. <br><br>          . <br>     ,     ,  ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">  K:</b> <div class="spoiler_text"><blockquote>   ,  ,    : <br><br><ol><li>    (    ) </li><li>        â€” / </li><li>      ,       </li></ol><br>       ,        : <br><br><ol><li>     </li><li>     </li><li>     </li></ol><br>     Wireshark,    <code>Protocol Hierarchy Statistics</code>  <code>Conversations</code> . <br><br> <code>Protocol Hierarchy Statistics</code> â€”           . <br><br><img src="https://habrastorage.org/webt/_3/sy/co/_3sycoln1juvmnzbdlzrug24fgq.png"><br><br> Conversations â€”   ,         . <br><br><img src="https://habrastorage.org/webt/31/xp/r7/31xpr7rmhyghnrctn3acyznwa9w.png"><br><br><img src="https://habrastorage.org/webt/rw/21/_d/rw21_dwv4digkin6kodypnfpl2w.png"><br><br>       : <br><br><ol><li>    (60%) â€”  TCP, ,  , SMB.   Protocol hierarchy  SMB  40%,        TCP,     ,     20%      SMB. </li><li>      192.192.192.128  192.192.192.129.   SMB      . </li></ol><br> <b>  </b> <br><br>    . <br><br>        â€”     SMB. <br><br>        ,    â€”     wireshark â€”  <code>ExportObject</code> . <br>              <code>tcp stream</code> .     ,     ,    <code>tcp stream</code> ,            .           ,      . <br><br>    , ,     ,     ,     .  ,         . <br><br> <b>  .</b> <br>     SMB       . <br><br>    NTLM-     â€œntlmsspâ€.    <code>info</code> ,  3    : <br><br><img src="https://habrastorage.org/webt/mm/gn/pj/mmgnpjekpvddsd1f6vdx5ih8hec.png"><br><br> ,        . <br><br><img src="https://habrastorage.org/webt/rk/ix/7m/rkix7mvmxaaxs09m0vvazlblvco.png"><br><br><img src="https://habrastorage.org/webt/tx/zc/hc/txzchc1u7ufdzoqkjxtnrnsvfd0.png"><br><br><img src="https://habrastorage.org/webt/pd/hg/vd/pdhgvdcc_obs9smchhmwidqmawy.png"><br><br>          Net-NTLMv2-,  : <br><br><ul><li> challenge  </li><li> response  </li><li>   </li></ul><br>  <code>Net-NTLMv2</code>       <code>hashcat</code> . <br><br> ,        <code>WIN7\winwin</code>  <code>WIN7\192.192.192.129</code> â€”      ,          .    <code>WIN7\IEUser</code> â€” ,       ,  ,  ,   ,  SMB. <br><br>  <code>Net-NTLM</code>   ,   ,    Wireshark.    ,  PCredz (https://github.com/lgandx/PCredz) <br><br><img src="https://habrastorage.org/webt/jd/gn/zj/jdgnzjzb6pgscawu43bxtf5wc0y.png"><br><br>     <code>IEUser</code> (   )     hashcat. <br><br><img src="https://habrastorage.org/webt/ky/i6/gf/kyi6gfki84pqjj4fgjximusk9qa.png"><br><br> <b>     ,      .</b> <br><br>        6,   ,   <code>SMB/NTLM</code> , <code>DNS</code> . <br><br> ,      ,    <code>NT</code>  <code>LM</code>  <code>NTLMv1 (Net-NTLMv1)</code> , <code>NTLMv2 (Net-NTLMv2)</code> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">     </a> ). <br><br> -    <code>NT</code>  <code>LM</code>  <code>NTLM</code> ,         <code>NTLM</code>  <code>NTLMv1</code>  <code>NTLMv2</code> . ,           .    . <br><br>     ,  <code>NTLMv1/NTLMv2</code> â€”    challenge-response .        ,    . <br><br>  NT  LM â€”   â€œ  â€ â€”        . <br><br>      : <br><br><ul><li> PassTheHash â€” ,        ,     .  Mais.     ,  <code>NT</code> .  PassTheHash  NTLMv2  â€”   .        ,      â€œâ€  ,       ,    . </li><li> NTLM Relay â€” ,        ,     NTLM.      ,    . </li><li> Spoofing,     Windows: LLMNR, NetBios </li><li>     : MS17-010,    /  ,   . </li></ul><br> <b></b> <br><br>     : <br><br><ul><li>    ( ) </li><li>       </li><li>       ,           </li><li>            eternalBlue </li><li>  NTLM relay </li><li>   NTLM relay    â€”   SMB </li><li>       </li><li>   ,     (ARP-spoofing,  DNS   )  </li></ul><br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">â„–8. SSH Pivoting Tricks</font></strong> </h1><br><img src="https://habrastorage.org/webt/ui/gy/a1/uigya1oqcd1poeuc6whph79ehzw.png"><br>      (10.0.10.0/24),      SSH  Linux- (10.0.20.5)    (10.0.20.0/24).   ,         .     ,         ,     //  Linux-. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> ,    ,   : <br>    <br> nmap      <br><br>    ? <br><br>  Option: <br><br> 1)  ping. <br>  -&gt; ping -b 10.0.20.255 <br>  ping  ,     ,    . <br>    ,               . <br>           . <br> ,     CentOS 7. <br>        . <br><br><img src="https://habrastorage.org/webt/7y/vu/rn/7yvurntbjwgei1q8rr6yth0kjww.png"><br> <i>(  )</i> <br><br>    ,           .  :( <br><br><img src="https://habrastorage.org/webt/nd/r1/jc/ndr1jchof8-_rzbgh-ru1xg7vh0.png"><br><br> 2)   ARP-  . <br>  -&gt; <br>  Debian â€” arp-scan --interface=/* */ 10.0.0.0/16 <br>  Linux      arp,    ( Debian) -   ,      arp-scan. <br> arp-scan,   ,      ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">  KryaKrya:</b> <div class="spoiler_text"><blockquote>       ,           ,  ,      Pivoting.      ,      ,   ,          ,      ,          . <br><br> ,       ping    ,  ARP- (arp -a),    (route).   ,     netcat (nc -h),  ,      (nc -vnz 10.0.20.3 0-1000).    ,      ,        , , ,   ,   -     bash,   python      . <br><br>     â€”    SSH-,   SOCKS-  SSH,          . <br> ssh -D 1337 user@10.0.20.5 -f -N <br><br>            .     nmap  SOCKS-   proxychains    . <br><br> proxychains nmap 10.0.20.0/24 <br> nmap 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br>     nmap       - SOCKS-.     SYN- ( nmap    )  SOCKS-,  SOCKS-    TCP-   ,  SYN-      ,    SYN,    SYN ACK.      CONNECT- (-sT),  nmap      SOCKS-. <br><br> nmap -sT 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br> ,    -  ,         ,        . ,       Linux-,   nmap  -sT  ,     ,     ,      ,    ,    ,        . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">â„–9. Android SSL pinning bypass</font></strong> </h1><br>      Android.  ,        HTTPS. <br><br> 1) ,           HTTP . <br><br> 2)  ,      SSL-pinning,        ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> Â«,           HTTP-.Â» <br><br>        . <br>        proxy host   wifi. <br><br>  Android     ,  ,      . <br><br>  â€”    (  )   â€”   ( ,  ). <br>  ,      MITM,   Android 6.0,      ,     . <br><br>       6.0,         . <br><br> Â« ,      SSL-pinning,        ?Â» <br><br>  ,    SSL-pinning. <br><br> SSL-pinning â€”   ,    ,   Â«Â»      . <br><br>        HTTPS-,   ,  Â«Â».      ,       . <br><br>   ,      MITM-,    . <br><br>   ,      ,     ,       . <br><br>   â€”  Frida. <br> Frida â€”    Dinamic Instrumentation Toolkit,    ,         . <br> , Frida        Javascript. <br>       Frida     ,    , ,  Â«TrueÂ»  Â«FalseÂ»,     . <br><br>     Frida: <br><br> 1.      ,      .      -. <br><br> 2.      Frida.        Root. <br><br>      . <br>  APK-           .  ,       ,      . <br>      .     apk  META-INF    . <br><br> â€œâ€ APK-. <br>       APK   smali   Java,     ,     . <br>     ,    ,     . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  I:</b> <div class="spoiler_text"><blockquote> ,     MITM HTTPS       . <br><br>      ,       Proxy   WiFi.      ProxyDroid,    iptables  . <br><br> ,      Root ,         , ? <br><br>    SSL-Pinning,    , ,  â€œFrida+Objectionâ€. ,           :) <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">â„–10.    ?</font></strong> </h1><br>          ,       . <br><br>    â€œ â€. ,      ,  dns-rebinding. <br><br>     .  Merci de votre attention! <br><br><hr><br> <b>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Digital Security</a></b> <br><br>    ,       . <br>       3  (  -      ).      0  5        2.5,   3.1337. <br><br>      .  ,     50 .        ,          â€œ <i>   </i> â€   -   ) <br><br>         .      29 ,     43.5.         24%    . <br><br>    : <br><br><img src="https://habrastorage.org/webt/fn/iq/fb/fniqfb7brnsnuqx08am8vx7xmtq.png"><br><br> ,         ,       ,    ,     ,              .    ,       ,     .         . <br><br>  ,     , ,  ,                  . <br><br> ,  ,          : <br><br><img src="https://habrastorage.org/webt/wn/z_/p9/wnz_p90qafczlytjrpuddurwkbc.jpeg"><br><br>          (  !),    ,          ,   ,         â€œ â€. <br><br>             -     ,        ,        . ,        ,   Summer of Hack 2019. <br><br>     ,                 .                    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr461077/">https://habr.com/ru/post/fr461077/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr461067/index.html">Les 65 principales questions SQL des entretiens d'embauche auxquelles vous devriez vous prÃ©parer en 2019. Partie I</a></li>
<li><a href="../fr461069/index.html">CamÃ©ras IP extÃ©rieures Nobelic: tests, technologies et capacitÃ©s des systÃ¨mes de vidÃ©osurveillance Ivideon</a></li>
<li><a href="../fr461071/index.html">Optimisation des requÃªtes de base de donnÃ©es sur l'exemple de service B2B pour les constructeurs</a></li>
<li><a href="../fr461073/index.html">Nous connectons des cartes en ligne au navigateur sur le smartphone. Partie 3 - OverpassTurbo</a></li>
<li><a href="../fr461075/index.html">Intelligence d'affaires. Objets informatiques, composants, outils</a></li>
<li><a href="../fr461079/index.html">Ville sans embouteillage</a></li>
<li><a href="../fr461081/index.html">Le jour oÃ¹ Dodo IS s'est arrÃªtÃ©. Script asynchrone</a></li>
<li><a href="../fr461083/index.html">Logiciel d'Ã©criture avec la fonctionnalitÃ© des utilitaires client-serveur Windows, partie 02</a></li>
<li><a href="../fr461085/index.html">Changer de langue dans l'application Android</a></li>
<li><a href="../fr461087/index.html">GÃ©nÃ©rer des donjons et des grottes pour mon jeu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>