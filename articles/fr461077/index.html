<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👦🏽 🎂 👃🏾 Comment les pentesters sont-ils cuits? Test d'entrée pour les stagiaires en sécurité numérique 🏓 👦 🥫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Summer of Hack 2019 en sécurité numérique bat déjà son plein, ce qui signifie qu'il est temps de dire comment nous avons recruté des personnes. 



 S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment les pentesters sont-ils cuits? Test d'entrée pour les stagiaires en sécurité numérique</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/461077/">  <b>Summer of Hack 2019</b> en sécurité numérique bat déjà son plein, ce qui signifie qu'il est temps de dire comment nous avons recruté des personnes. <br><br><img src="https://habrastorage.org/webt/iv/ef/ud/ivefudzwssbwskpfaxaxkczsxvu.jpeg"><br><br>  Sous la coupe, du matériel volumineux et intéressant sur la façon dont nous sélectionnons les jeunes spécialistes pour notre stage «Summer of Hack 2019», et plus particulièrement pour le département d'audit de sécurité. <br><br>  Considérez ce que, à notre avis, un pentester devrait savoir pour réussir son travail. <br><br>  Analysons un certain nombre de tâches difficiles que nous avons torturées les gars, y compris au nom de l'un d'eux. <br><a name="habracut"></a><br>  Peut-être la partie la plus intéressante de la sélection pour un stage dans le département d'audit de sécurité était notre profil.  Chaque année, nous nous réunissons dans tout le département et discutons des compétences qui, à notre avis, sont recherchées pour un spécialiste moderne dans le domaine de la sécurité pratique, rappelons les tâches les plus intéressantes qui ont dû être résolues cette année et rédigeons des domaines de connaissances sans lesquels il est difficile d'imaginer un auditeur réussi.  Lorsque toutes les blagues sont plaisantées et que les histoires sont racontées, le résultat final reste un ensemble d'idées. <br><br>  Cette année, nous avons été guidés par les exigences suivantes: <br><br><ul><li>  Connaissance de base des applications Web de l'appareil et des attaques contre celles-ci; </li><li>  Connaissance de base des mécanismes de protection et de contrôle d'accès basés sur un navigateur (oui, les mêmes SOP et CORS, sans eux); </li><li>  Compétences de base en lecture de code et capacité de voir la logique derrière; </li><li>  Comprendre le fonctionnement des réseaux informatiques et leur routage; </li><li>  Expérience avec des systèmes de type Linux; </li><li>  La capacité de ne pas avoir peur d'une technologie inconnue.  La capacité de google et de systématiser les informations reçues; </li><li> Et une pincée d'Android (mais pas nécessaire, mais c'est notre petit caprice). </li></ul><br>  Après l'élaboration des questions.  En partie, nous les avons empruntées aux questions que nous avons posées lors des entretiens, mais plus de la moitié ont été spécialement préparées pour ce questionnaire.  Nos experts ont passé leur temps personnel à préparer des décharges de trafic, à discuter de la manière de mieux formuler la question et des vulnérabilités «trop spécifiques, pourquoi tourmenter les stagiaires».  Pour un tel zèle, on ne peut s'empêcher d'enlever notre chapeau (blanc, bien sûr). <br><br>  L'analyse de chaque question se compose de deux parties.  La première partie est la réponse de l'un de nos stagiaires - Danila <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Korgik_0</a> Leontyeva (il est l'auteur de la publication), et la seconde est les commentaires des spécialistes qui empilaient le questionnaire. <br><br><hr><br>  <i>Bonjour, Habr!</i> <i><br><br></i>  <i>Tout d'abord, une petite digression lyrique.</i> <i><br></i>  <i>Plus précisément, «Comment ai-je découvert Summ3r 0f h4ck».</i> <i><br></i>  <i>J'ai entendu parler de l'annonce du stage par un discours de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Denis Rybin</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ilya Bulatov</a> lors de la conférence RuCTF2019.</i> <i><br><br></i>  <i>Littéralement après 4 jours, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article a</a> été publié sur habr à propos de l'ouverture d'un stage.</i> <i><br><br></i>  <i>Et le soir du même jour, j'ai ouvert la tâche, dans le département d'audit de sécurité, et je me suis plongé dans le travail.</i>  <i>Aujourd'hui, je partagerai avec le lecteur quelles difficultés j'ai eu à affronter et quelle option de solution je pourrais proposer.</i> <br><br><hr><br><h1>  <strong><font color="#cc0000">N ° 1.</font></strong>  <strong><font color="#cc0000">Code source php</font></strong> </h1><br>  Examinez le code.  Décrivez les défauts que vous voyez et comment vous les corrigeriez. <br><br><img src="https://habrastorage.org/webt/ne/0x/ku/ne0xkuq_5uz955i1rypa8or5spk.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  4ème ligne - utilisez le hachage md5. <br>  Problème - md5 peut être brutalisé en un temps raisonnable en utilisant hashcat. <br>  Comment réparer? <br><br>  Utilisation d'algorithmes de hachage plus "gourmands en ressources". <br>  Dans ce cas, vous devez refuser complètement les cookies utilisateur et lier toute la logique à phpsession. <br><br>  5ème ligne - PostgreSQL-injections. <br>  Comment réparer? <br>  Utilisation de la déclaration préparée. <br>  Implémentation d'une instruction préparée pour vérifier la connexion <br><br><pre><code class="plaintext hljs">$query = "SELECT username FROM login WHERE username=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($username)); $username = $stmt-&gt;fetchColumn(); if($username == FALSE) { die(" !"); }</code> </pre> <br>  11 ligne - un certain nombre de décisions infructueuses. <br><br><ol><li>  Durée de vie trop longue.  Une année entière, c'est beaucoup.  Si le cookie est piraté avec succès, un accès long au compte utilisateur par l'attaquant est possible. </li><li>  Drapeau httpOnly manquant.  S'il est défini sur TRUE, les cookies ne seront accessibles que via le protocole HTTP.  Autrement dit, les cookies dans ce cas ne seront pas disponibles pour les langages de script comme JavaScript. </li><li>  Aucun hachage de cookie. </li><li>  Absence de définition du drapeau sécurisé.  L'indicateur sécurisé indique qu'un cookie doit être envoyé par le client via une connexion HTTPS sécurisée.  S'il est défini sur TRUE, le cookie du client sera envoyé au serveur uniquement si une connexion sécurisée est établie. </li></ol><br>  Comment réparer? <br>  Par défaut, en php, la durée de vie de la session n'est que de 24 minutes, implémentons cela. <br>  Définissez l'indicateur sécurisé, httpOnly. <br><br>  Dans ce cas, vous devez refuser l'étrange cookie utilisateur et lier toute la logique à phpsession. <br><br>  18 lignes - XSS (English Cross-Site Scripting - "intersite scripting"). <br>  Comment réparer?  Convertissez tous les caractères possibles en entités HTML correspondantes. <br><br><pre> <code class="plaintext hljs">$query = htmlentities($query, ENT_QUOTES, "UTF-8");</code> </pre> <br>  Nous indiquerons explicitement l'encodage afin d'éviter sa substitution par UTF-7. <br><br><pre> <code class="plaintext hljs">header("Content-Type: text/html; charset=utf-8");</code> </pre> <br>  Ligne 20 - défauts du système d'authentification et de stockage de session. <br><br>  Problème - si vous définissez l'ID utilisateur encodé en base64 dans l'utilisateur cookie, vous pouvez vous connecter à son compte! <br><br>  Comment réparer?  Lors de l'autorisation de l'utilisateur, nous enregistrons la session dans la base de données et lors de l'installation de la session, nous vérifions sa présence dans la base de données. <br><br><pre> <code class="plaintext hljs"> $query = "SELECT sessions FROM login WHERE sessions=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($_COOKIE["user"])); $session = $stmt-&gt;fetchColumn(); if($session == TRUE) { do_login($_COOKIE["user"]); }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire d'expert D:</b> <div class="spoiler_text"><blockquote>  La première question avec laquelle le questionnaire a rencontré les futurs stagiaires concerne les principales vulnérabilités du Web.  La seule difficulté ici est la nécessité de les voir dans le code source en PHP.  Cependant, personne n'a défini la tâche de «cacher les bogues». <br><br>  Voici une liste des vulnérabilités qui peuvent être détectées dans cette liste par ordre de fréquence de leur détection: <br><br>  <b>Le hachage de mot de passe utilisant l'algorithme MD5 a été</b> remarqué même par des candidats éloignés du Web.  Cependant, il y avait aussi des nuances intéressantes, par exemple, de nombreux candidats ont utilisé des termes très incorrects, essayant de décrire les problèmes dans leurs propres mots.  Les «vulnérabilités des algorithmes», les «fonctions à sens unique», «l'existence de collisions» et d'autres virages étranges sont entrés en bataille, après un examen plus approfondi, ils s'avèrent n'être rien de plus qu'un ensemble de grands mots qui ne révèlent pas l'essence.  Bien sûr, nous sommes allés ici à une réunion et nous n'avons pas trouvé à redire à ces personnes qui se préparent à se lancer sur la voie de l'apprentissage de la sagesse de la sécurité de l'information.  Pour obtenir une "compensation", il suffit de mentionner la menace, en cas de compromission de la base de données, les hachages md5 peuvent être triés par un attaquant dans un délai acceptable et des mots de passe (ou des chaînes équivalentes) peuvent être obtenus en texte clair.  Et, bien sûr, beaucoup ont mentionné le manque de sel et de force brute basé sur l'utilisation de tables arc-en-ciel.  Nous avons également perçu ces commentaires de façon positive, surtout si le répondant a expliqué pourquoi il s'agissait d'une menace. <br><br>  <b>Injection SQL potentielle.</b>  Il est difficile d'ajouter quelque chose;  lors de l'appel à la base de données, la saisie de l'identifiant et du mot de passe par l'utilisateur est directement concaténée avec la demande.  S'il est peu probable que vous puissiez manipuler la valeur du mot de passe à ce stade (un hachage en est extrait), l'introduction d'une injection dans le nom d'utilisateur ne sera pas difficile pour un attaquant potentiel. <br><br>  <b>Sortie d'informations de débogage inutiles conduisant à une attaque XSS.</b>  En lisant attentivement la liste, on pourrait prêter attention à l'appel d'écho, qui affiche la demande générée à la base de données dans les commentaires HTML sur la page.  Bien entendu, une telle conclusion d'informations supplémentaires sur la page est complètement facultative et, très probablement, simplement oubliée par le développeur après avoir effectué les tests.  Ces informations supplémentaires sont très bénéfiques pour l'attaquant et permettent une bien meilleure compréhension du fonctionnement de l'application.  Cependant, malheureusement, ce n'est que la moitié du problème.  Le fait est qu'un attaquant peut manipuler le contenu de la variable de requête, et que son contenu ne peut pas être filtré ou échappé avant d'être affiché à l'utilisateur - il existe une attaque XSS potentielle.  Cependant, son exploitation peut s'avérer être encore un casse-tête en raison de la fonction strtoupper mal située.  Le vecteur injecté par l'attaquant sera en majuscule, et si ce n'est pas un problème pour les balises HTML, Javascript est très offensé par un tel appel.  Cela peut être facilement vérifié à l'aide de la console du navigateur. <br><br><img src="https://habrastorage.org/webt/cg/ev/oy/cgevoykot6pzht0mx5ppeqyxwne.png"><br><br>  Eh bien, au moins, apparemment, l'attaquant devra se tourner vers les soi-disant «attaques sans script» ou des techniques sophistiquées pour contourner le filtrage (dans ce cas, JSFUCK le ferait), donc le fait d'un risque de sécurité n'annule pas cela. <br><br>  <b>Une erreur dans la logique du mécanisme de gestion de session</b> était la partie la plus intéressante de la tâche.  Sa découverte a nécessité non seulement de lire la source ligne par ligne, mais aussi de comprendre la logique de l'ensemble du listing.  On pouvait sentir que quelque chose n'allait pas en remarquant la configuration d'un cookie contenant l'ID utilisateur encodé en base64 dans le bloc Remember-me.  Une analyse plus approfondie de la logique de ce mécanisme nous amène à la réflexion: «Il s'avère qu'un attaquant qui connaît ou passe par l'identifiant peut se connecter à n'importe quel compte sans entrer de nom d'utilisateur et de mot de passe?!».  Oui, en effet, un attaquant peut générer indépendamment un utilisateur de cookie de son côté et lui attribuer toute valeur d'ID codée par base64.  L'envoi d'une demande avec un tel cookie sans nom d'utilisateur et mot de passe déclencherait la fonction do_login et se connecterait au compte de quelqu'un d'autre. <br><br>  La mention de ces 4 vulnérabilités dans la réponse des candidats a directement influencé leurs scores. <br><br>  Cependant, beaucoup dépendait de la qualité de la réponse.  Mentionner des moyens de rectifier la situation, des commentaires sur des facteurs supplémentaires affectant la faisabilité d'une attaque, l'utilisation des bons termes et la capacité de structurer vos pensées, des commentaires sur des faiblesses supplémentaires ou des menaces potentielles - tout cela nous a réchauffé le cœur et conduit à une augmentation de la note finale. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">N ° 2.</font></strong>  <strong><font color="#cc0000">Jwt</font></strong> </h1><br>  Lors de la recherche d'une application Web, vous avez constaté que l'application utilise un jeton JWT comme autorisation. <br><br>  Quels problèmes de sécurité voyez-vous, quel genre de contrôles feriez-vous? <br><br>  Jeton JWT: <br><br><pre> <code class="plaintext hljs">eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6InNla2EiL CJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiRmFsc2UiLCJwYX Nzd29yZCI6IjFkMDBjYUgifQ.F7Y1mCAmg5-QFok-rkpLdwe8prCyiKsCyJ-3Z5f7luI</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  Jetons Web Dan JSON (JWT). <br>  Sa structure -&gt; [base64url (HEADER)]. [Base64url (PAYLOAD)]. [Base64url (SIGNATURE)] <br>  [base64url (HEADER)] = eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0 <br>  décodage base64url -&gt; {"alg": "None", "typ": "JWT"} <br>  On peut noter immédiatement que l'algorithme de signature («alg»: «None») de la signature n'est pas utilisé.  Certaines bibliothèques JWT ne prennent pas en charge l'algorithme «aucun», c'est-à-dire l'algorithme de signature.  Lorsque l'en-tête alg est «aucun», le côté serveur n'effectuera pas de vérification de signature. <br>  Autrement dit, vous pouvez écrire n'importe quelle charge utile dans base64url, et sa signature ne sera pas vérifiée. <br>  Ce qui nous permet de créer un utilisateur avec des droits d'administrateur. <br><br>  De plus, le fait que la partie charge utile n'utilise pas des en-têtes tels qu'aud (définit les destinataires auxquels le jeton JWT est destiné) et exp (la durée de vie du jeton) simplifie nos vies. <br><br>  Charge utile estimée <br>  eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6ImhhY2siLCJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiVHJ1ZSIsInBhc3N3b3JkIjoiaGFjayJ9 <br><br>  base64url décoder la charge utile -&gt; {"sub": "1234567890", "name": "hack", "iat": 1516239022, "role": "nobody", "isAdmin": "True", "password": "hack »} <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire d'expert D:</b> <div class="spoiler_text"><blockquote>  Dans le travail de l'auditeur doivent souvent faire face aux nouvelles technologies, et la capacité de les comprendre est très importante.  En incluant cette question dans le questionnaire, nous avons supposé que la plupart des candidats avaient à peine entendu parler de la technologie des jetons JWT, à l'exception du nom.  Par conséquent, cette question, tout d'abord, visait la capacité de rechercher et d'analyser des informations provenant de sources publiques.  En conséquence, une personne qui a raté l'émission de Google à la demande de «JWT» et «vulnérabilité jwt» pourrait tirer les conclusions suivantes: <br><br>  1. Ce jeton n'a pas d'algorithme de signature, donc un attaquant est en mesure de modifier tous les champs à l'intérieur du jeton, ce qui n'est pas supposé par le concept de jetons JWT. <br><br>  2. Les champs à l'intérieur du jeton contiennent le mot de passe de l'utilisateur en texte clair, le stockage de ces informations dans le jeton est, au minimum, une mauvaise pratique.  Dans la plupart des cas, vous pouvez refuser une telle décision et ainsi augmenter votre niveau de sécurité. <br><br>  3. En se souvenant de l'absence de signature et de notre capacité à modifier les champs à l'intérieur du jeton, il est logique de supposer que la modification de la valeur de isAdmin peut augmenter nos privilèges en privilèges d'administrateur. <br><br>  4. Une autre idée intéressante que peu de personnes ont mentionnée dans leur réponse concerne le fait même de la possibilité de transférer les entrées des utilisateurs dans les champs d'un jeton JWT.  Dans une situation normale, un attaquant ne peut en aucune façon influencer les données du jeton, ce qui signifie que les développeurs peuvent souvent négliger l'introduction de vérifications supplémentaires dans le code des gestionnaires.  Cela demande une idée simple: mais essayons de mener des attaques classiques non pas à travers les paramètres GET / POST, mais à travers les champs de jetons.  Cela peut donner un bon résultat inattendu.  Une telle approche créative avec la justification correcte de nos actions a été très appréciée par nous dans l'évaluation de cette question et d'autres. <br><br>  De nombreux candidats dans leurs réponses ont organisé une brève explication de la façon dont le jeton JWT est structuré et où il est utilisé, c'était intéressant pour nous de lire, et pourtant, tout d'abord, nous avons évalué les aspects de la réponse concernant la sécurité. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Numéro 3.</font></strong>  <strong><font color="#cc0000">CORS / CSRF / IDOR / ???</font></strong> </h1><br><br>  Dans l'application Web, le mot de passe utilisateur est modifié à l'aide de la demande suivante (voir option 1).  Quelles menaces de sécurité potentielles voyez-vous?  Quels contrôles effectueriez-vous?  La situation changera-t-elle dans le cas du comportement suivant (voir Option 2)?  Expliquez votre réponse. <br><img src="https://habrastorage.org/webt/mr/b-/se/mrb-seaadzkgqbmqvsq-zcqflyo.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  <b>Option 1</b> <br>  "Quelles menaces de sécurité potentielles voyez-vous?" <br><br>  1) Absence de contrôle d'accès. <br>  Si le numéro d'utilisateur-a auquel la demande de changement de mot de passe est effectuée n'est pas vérifié, le mot de passe peut être modifié pour tout utilisateur enregistré dans le système. <br>  Comment réparer?  - Correspondance de JSESSION à partir de la base de données et de l'id-shnik demandé. <br><br>  2) La capacité de mener des attaques CSRF <br>  Nous attirons un utilisateur autorisé vers un hôte que nous contrôlons et, après avoir fait une demande, vers example.com au nom de la victime, pour changer le mot de passe. <br>  Comment réparer?  - Ajout d'un jeton CSRF. <br><br>  <b>Option 2</b> <br>  "Quelles menaces de sécurité potentielles voyez-vous?" <br>  Une faille dans la politique CORS. <br>  Il est recommandé de mettre en liste blanche l'en-tête Access-Control-Allow-Origin. <br><br>  Comment réparer?  - <br><br>  1) Modification du fichier .htaccess <br><br><pre> <code class="plaintext hljs">&lt;ifmodule mod_headers.c&gt; Header always set Access-Control-Allow-Origin: "https://whitelist.domain.ru" Header always set Access-Control-Allow-Methods "PUT" &lt;/ifmodule&gt;</code> </pre><br>  2) PHP <br><br><pre> <code class="plaintext hljs">&lt;?php header('Access-Control-Allow-Origin: “https://whitelist.domain.ru”); header('Access-Control-Allow-Methods: PUT'); ?&gt;</code> </pre><br>  "La situation changera-t-elle avec le comportement suivant?" <br><br>  Oui  Étant donné que dans le deuxième cas, une demande PUT est utilisée, ce qui est important, car l'utilisation d'une demande PUT rend la demande CORS «difficile», ce qui à son tour nous prive complètement de la possibilité de mener une attaque CSRF + l'absence d'un en-tête tel que Access-Control-Allow-Credentials: true nous prive la possibilité d'envoyer en place avec d'autres en-têtes http et cookies utilisateur. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire d'expert I:</b> <div class="spoiler_text"><blockquote>  Considérons, dans l'ordre, quels sont les principaux problèmes visibles sur les requêtes données: <br><br>  1) En effet, l’identifiant numérique de l’utilisateur «10012» étant observé dans la requête, la première étape consiste à vérifier s’il est possible de changer le mot de passe d’un autre utilisateur?  Puis-je <b>spécifier</b> suffisamment l' <b>identifiant de quelqu'un d'autre</b> ? <br>  Les vulnérabilités de la classe IDOR sont assez faciles à exploiter et présentent souvent une criticité élevée. <br><br>  2) La demande de changement de mot de passe se produit par la méthode POST, le jeton CSRF n'est pas respecté et le type de contenu est «texte / simple».  Il est possible de <b>truquer une telle demande.</b> <br><br>  Par conséquent, pour changer le mot de passe de la victime, il suffit à l’attaquant de le convaincre de simplement visiter le lien «malveillant». <br><br>  3) Dans les en-têtes de réponse, le serveur <b>révèle la version du logiciel utilisé</b> .  Cela peut être appelé une vulnérabilité à la longue, mais il est préférable de masquer de telles bannières - les attaquants peuvent facilement y trouver des exploits connus d'un jour, plus la valeur du logiciel utilisé simplifie considérablement la planification d'autres attaques. <br><br>  4) Nous serions très heureux de voir la phrase "Que se passera-t-il si nous <b>changeons le format de données de JSON en XML</b> ?" <br><br>  Le fait est que les cadres modernes sont intelligents, omnivores et peuvent traiter des données dans différents formats.  Et lors de l'analyse de XML, une vulnérabilité XXE dangereuse est souvent autorisée.  Avec son aide, l'intrus peut "aller" sur le réseau interne, lire les fichiers de configuration du serveur et parfois exécuter RCE. <br><br>  5) Je voulais également voir une remarque comme «Pourquoi <b>la connaissance de l'ancien n'est-elle pas vérifiée</b> lors du changement de mot de passe?» <br><br>  Quant à la «variante n ° 2», elle contient un «piège» - les en-têtes CORS sont utilisés ici et le type de contenu de la demande est déjà défini sur «application / json». <br><br>  L'erreur que la grande majorité des candidats a faite est la réponse du formulaire "-C'est l'astérisque dans Allow-Origin, ce qui signifie que vous pouvez envoyer des demandes depuis n'importe quel site!" <br><br>  Non, tu ne peux pas.  Tout d'abord, l'en-tête Allow-Credentials: True est manquant, ce qui signifie que le navigateur doit exécuter la demande «avec des cookies», de sorte que la demande serait anonyme, sans session.  Et deuxièmement, même si un tel en-tête était présent, le navigateur interdirait toujours d'envoyer des cookies - simplement à cause de l'astérisque.  Leur combinaison est interdite et le navigateur est ignoré. <br></blockquote></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Numéro 4.</font></strong>  <strong><font color="#cc0000">Vidage réseau</font></strong> </h1><br>  Imaginez que vous êtes entré dans le réseau interne de l'entreprise et avez intercepté le trafic dont le vidage est joint ci-dessous.  Décrivez quelles attaques vous tenteriez de mener et avec quels outils? <br><br>  Dump: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">yadi.sk/d/qkLcfwSCzdxcwg</a> <br><br><div class="spoiler">  <b class="spoiler_title">Analyse du travail</b> <div class="spoiler_text">  1) Usurpation de LLMNR &lt; <br>  Un attaquant du sous-réseau local peut écouter et répondre aux messages diffusés, affirmant que le nom d'hôte demandé est sa propre adresse IP. <br>  Cela conduit au fait que l'ordinateur client demandeur est connecté à l'ordinateur de l'attaquant et, selon le protocole, peut tenter de s'authentifier. <br><br>  Les utilitaires utilisés sont Intercepter-NG, un projet sur githab VindicateTool. <br><br>  2) Abus HSRP. <br>  Problématique - lorsque le paramètre «preempt» est défini sur 1, l'attaquant a la possibilité «d'évincer» les autres routeurs, en raison de la priorité plus élevée.  Après avoir envoyé HSRP à la multidiffusion, le routeur contrôlé devient le routeur principal (routeur actif) du réseau et tout le trafic y passera.  En fait, nous sommes arrivés à la mise en œuvre d'attaques mitm. <br><br>  Pour ce vecteur d'attaque, nous devons connaître le groupe et le mot de passe. <br>  A partir du vidage de trafic qui nous est donné, nous reconnaissons le groupe (c'est-à-dire 3) et le mot de passe.  Le mot de passe dans notre cas est par défaut - Cisco. <br><br>  Les utilitaires utilisés sont yersinia, scapy. <br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Commentaire de l'expert X:</b> <div class="spoiler_text"><blockquote>  L'objectif de la question était de déterminer la familiarité du stagiaire avec les techniques modernes (et pas si) pour mener des attaques MitM.  Examinons les scénarios potentiels basés sur un vidage de trafic existant: <br><br>  <b>1) Usurpation ARP</b> <br>  L'usurpation ARP est le moyen le plus ancien et le plus simple de mettre en œuvre des attaques MitM.  Elle consiste à envoyer une requête ARP gratuite à l'hôte A. <br><br>  L'adresse IP de l'hôte B est l'adresse IP et notre adresse MAC est l'adresse MAC.  Une telle demande vous permet de modifier la table ARP sur l'hôte A, le forçant à envoyer des demandes à notre appareil lorsque vous essayez de contacter l'hôte B. L'hôte B est généralement la passerelle par défaut. <br><br>  Outils recommandés: bettercap, arpspoof <br><br>  <b>2) Usurpation LLMNR, NBNS</b> <br>  Link-Local Multicast Name Resolution et NetBIOS Name Service sont les protocoles utilisés pour résoudre les noms d'hôtes sur le réseau local.  Contrairement au protocole DNS, il n'y a pas de serveur dédié qui stocke toutes les informations; à la place, la demande est diffusée à tous les hôtes du réseau, si le nom d'hôte dans la demande correspond au nom d'hôte du périphérique, il enverra une réponse. <br><br>  Comme cela a été correctement noté dans la réponse, l'attaquant peut répondre à de telles demandes en envoyant son adresse IP dans la réponse, ce qui conduira à l'avenir à ce que la victime contacte l'appareil de l'attaquant, au lieu de l'appareil dont le nom d'hôte est apparu dans la demande.  De plus, un attaquant peut demander l'authentification NTLM à la victime, ce qui oblige le périphérique victime à envoyer un hachage NTLM, qui peut ensuite être utilisé pour la force brute. <br><br>  Outils recommandés: Répondeur <br><br>  <b>3) Usurpation de WPAD</b> <br>  L'usurpation WPAD peut être attribuée à un cas spécial d'usurpation LLMNR et NBNS.  Le protocole Web Proxy Auto Discovery est utilisé pour configurer automatiquement un serveur proxy HTTP. <br><br>  Le périphérique envoie une demande LLMNR / NBNS avec le nom d'hôte wpad, reçoit l'adresse IP correspondante et essaie d'accéder au fichier wpad.dat via HTTP, qui stocke des informations sur les paramètres du proxy. <br><br>  En conséquence, l'attaquant peut effectuer une usurpation LLMNR / NBNS et fournir à la victime son fichier wpad.dat, par conséquent, tout le trafic HTTP et HTTPS passera par l'attaquant. <br><br>  Outils recommandés: Répondeur, mitm6 <br><br>  <b>4) Publicité du routeur</b> <br>  Comme vous pouvez le voir sur le vidage, il existe des périphériques avec IPv6 activé sur le réseau.  Sur le réseau, vous pouvez essayer d'envoyer des messages à l'annonce du routeur IPv6 victime afin de changer la passerelle ou le serveur DNS par défaut. <br><br>  Les messages d'annonce de routeur (RA) font partie du mécanisme SLAAC (Stateless Address Autoconfiguration), qui est nécessaire pour obtenir automatiquement des adresses IPv6 sur un réseau, sans utiliser de serveur DHCPv6 ou conjointement avec lui.  Ceci est réalisé en envoyant périodiquement des messages RA de multidiffusion au routeur, qui contiennent l'adresse de passerelle par défaut, le préfixe de réseau, l'adresse du serveur DNS, le préfixe de domaine. <br><br>  Outils recommandés: paquet brut <br><br>  <b>5) Usurpation DHCP</b> <br>  En outre, dans un vidage, les demandes de découverte DHCP du même périphérique sont répétées à certains intervalles.  Vous pouvez tirer des conclusions sur l'absence d'un serveur DHCP dans ce réseau et répondre à la prochaine demande Discover en spécifiant la victime comme passerelle par défaut vers le périphérique. <br><br>  Outils recommandés: Yersinia <br><br>  <b>6) Usurpation HSRP</b> <br>  De plus, les paquets HSRP peuvent être vus dans le vidage.  Le protocole de redondance d'UC peut augmenter la disponibilité des routeurs qui agissent comme passerelle par défaut.          IP-,     -.   Hello -        ,           .           HSRP, ,      ,      HSRP         . <br><br>  : Yersinia <br><br> <b>7) STP-</b> <br> Spanning Tree Protocol      L2-  .    BPDU-,           ,     .          BPDU-,   ,   ,    ,    ,         ,   ,   ,     STP,    ,    . <br><br>  : Yersinia <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">№5. NGINX config</font></strong> </h1><br><br>    - nginx.  ,       ? <br><br> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pastebin.com/nYp7uVbB</a> <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">   nginx,          : <br> 1)  86 ,   http  X-Managed      secured,  nginx     /management/ <br> 2)        API  70  105 . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  J:</b> <div class="spoiler_text"><blockquote>        ,          .   nginx    ,     web-,       nginx    web-  /.           nginx ,  , ,     . <br><br> ,     ,   ,            .      ,         . ,    ,     . <br><br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gixy</a> . <br><br> Gixy  4    : <br><br> <b>1) Alias travesal:</b> <br><br>   80     : <br><br><pre> <code class="plaintext hljs">location /static { alias /prod_static/; }</code> </pre><br>     - ,    .  : //host/static../etc/passwd.   -     alias:     ,   /static,   /prod_static/,       : /prod_static/../etc/passwd,      /etc/passwd.    alias traversal  <a href=""></a> <br><br> <b>2) Http Splitting (CRLF injection)</b> <br>    nginx  ,   ,        .       HTTP-. <br> : <a href="https://github.com/yandex/gixy/blob/master/docs/ru/plugins/">github.com/yandex/gixy/blob/master/docs/ru/plugins/httpsplitting.md</a> <br><br> <b>3)   -   </b> <br>   75      «rigin»   .    , -       , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">production.host.evil.com</a> . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/origins.md</a> <br><br> <b>4)     add_header</b> <br>  nginx  :      add_header,       , ,    ,  .      CSP      . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/addheaderredefinition.md</a> <br><hr><br>  ,   gixy,          .       : <br><br> 1)   17     <b>default_type   text/html.</b>     :   ,     ,  nginx    Content-Type,    default_type.   ,         Content-Type: text/html.            HTML-  ,   , , XSS-   . <br><br> <b>2)    POST-</b> <br>  29-30   ,           .  ,   “” POST-.       .  Mais!       SSRF  ,     ,   ,     , . <br><br> <b>3)   php-fpm</b> <br>   48  ,  FastCGI-    unix ,    9000.  ,    ,   .   ,      PHP-. <br><br> <b>4) “” CSP</b> <br>  production.host  Content-Security-Policy,    Javascript,    . <br><br> <b>5) “” CORS</b> <br>   76-77   CORS,          ,       cookie  . <br><br> 6)     ,   86   <b>  </b>  .       secured     /managed. <br><br> 7)      ,    ,        ,    -. ,   ,  ,    /user/{userid}  IDOR. <br><br>   ,       ,    ,     . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">№6. Linux Permissions</font></strong> </h1><br>     Linux      ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">  ~ ()  Debian <br> C              ( ,      /etc/passwd). <br> ,      ftp  ,     ~. <br><br>  Un exemple: <br> * root@server:~# ls ~ftp <br> * welcome.msg <br>      : <br> * root@server:~# cat ~ftp/welcome.msg <br> * Welcome, archive user %U@%R! <br>   ,    :      : <br> * root@amorale:~# echo ~ftp <br> * /srv/ftp <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  K:</b> <div class="spoiler_text"><blockquote>    ,        : <br><br><ul><li>       </li><li>  ACL      </li><li>    </li><li>      </li><li>  capabilities </li></ul><br>   ,      ,   : <br> “ ,   root”   . <br><br>      ,     <code>Linux/Unix</code> . <br>    ,        “ ” —           . <br>   ,     ,    <code>funky_test.txt</code>      <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br> ,    Linux/Unix   : <br><br><ul><li>  - —    “rwx”  alice </li><li>   —    “rw”   interns </li><li>    —    “rx”  others </li></ul><br>          <code>read, write, execute</code> . <br><br> ,     —       ,      : <br><br><ul><li>    ,      read </li><li>    ,      read </li><li>     read </li></ul><br>  ,       <code>read</code>            .      ,      execute  . <br><br>            ,    . <br><br>          , ,    .      : <br><br> 1.          ,       ls. <br><br> 2.      — <code>POSIX Access Control Lists</code> . <br><br><h4>    c   . </h4><br><h6>  1 </h6><br> ,   <code>alice</code>     <code>interns</code> .      <code>funny_test.txt</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami alice $ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied $</code> </pre><br><h5>  2 </h5><br>   —   <code>funky_test.txt</code>  604.    <code>bob</code> ,    <code>interns</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami bob $ id uid=1002(bob) gid=1003(bob) groups=1003(bob),1002(interns) $ ls -la funky_test.txt -rw----r-- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied</code> </pre><br><h5>  </h5><br>    <code>alice</code>       ,  .  , <code>permission_denied</code>    : <br><br><pre> <code class="plaintext hljs">$ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ chmod 777 funky_test.txt $ ls -la funky_test.txt -rwxrwxrwx 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt secret_pass</code> </pre><br>      bob    . <br><br><h5>   </h5><br>    ,          «  »,  : <br><br><ul><li>  ID      <code>effective UID</code> —      </li><li>  GID        <code>effective GID</code> —      </li><li>      others. </li></ul><br><h5>   </h5><br>  ,      —   ,       “”    ,        ,    , : <br><br><ul><li>    ,   ,          <code>others</code>     </li><li>   ,     ,   <code>others</code>     </li></ul><br>           . <br><br><h4> POSIX Access Control Lists </h4><br>      —         /.   ,     ACL,  ,       “ <code>+</code> ” <br><br>      POSIX ACLs,    —     ,            .      ACL,        . <br><br><h5>  Exemple </h5><br>   .        <code>alice</code>   <code>funky_test.txt</code>  ,   <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br>      ACL.  <code>getfacl</code> , ,    ACL,   ,     <code>ls</code> . <br><br><pre> <code class="plaintext hljs">$ getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx group::rw- other::rx</code> </pre><br>   , ACL        .  ,     bob  : <br><br><pre> <code class="plaintext hljs">setfacl -mu:bob:rwx funky_test.txt</code> </pre><br>       “ <code>+</code> ”   <br><br><pre> <code class="plaintext hljs">ls -l funky_test.txt -rwxrwxr-x+ 1 alice interns 12  4 13:00 funky_test.txt</code> </pre><br>     : <br><br><pre> <code class="plaintext hljs">getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx user:bob:rwx group::rw- mask::rwx other::rx</code> </pre><br>  ACL     .  : <br><br><ol><li>     .      <code>effective UID</code>  <code>effective GID</code>  —  .        ,       ACL,       .  ,     ,   ,  ,         ,    . </li><li>   ACL  <code>mask</code> ,      ACL    <code>owner, group, others</code> </li></ol><br><h5>   </h5><br>  ,         ,  ,     —      . <br><br>   ,  ACL,     , : <br><br><ul><li>        ACL,     ; </li><li>   ,         ACL,     . </li></ul><br></blockquote></div></div><br><br><hr><br><h1> <strong><font color="#cc0000">№7. Network Dump II</font></strong> </h1><br>            .  ,        ,   ,       . <br><br>  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">yadi.sk/d/e3gNme4MBo6tFQ</a> <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">   —      . <br>      ,     . <br>   ,     . <br><br><img src="https://habrastorage.org/webt/2t/zn/ip/2tznipywtpqwalr5drvxxr4z0sw.png"><br><br>   ,     SMB-,  ,    ,       .       SMB object list (File -&gt; Export objects -&gt; SMB… ). <br><br>    —     . <br><br><img src="https://habrastorage.org/webt/fe/rt/xy/fertxyt0du3kv3qwcmivz1m6opg.png"><br> <i>(  SMB object list)</i> <br><br><img src="https://habrastorage.org/webt/xo/yd/t-/xoydt-qmcbddrx1lkoqmpplyslg.png"><br> <i>(NotTruePass.jpg)</i> <br><br>     . <br><br>        “”    TCP-…     .    .  :( <br><br>    ,        .    . <br><br><img src="https://habrastorage.org/webt/fd/ch/fc/fdchfcsbkrwxmx08ltr_1qnoozg.png"><br> <i>(  desktop.ini)</i> <br><br>     “”     . ,      NTLM,   ,  ,  NTLM      “Pass-the-hash”.               «-». <br><br>     “”    : <br><br><pre> <code class="plaintext hljs">1)User - 1 Account: IEUser Domain: WIN7 Host: WIN7 hex dump session key - 49 0c 38 3e f8 eb 63 88 79 0f 62 84 09 84 d2 dc 2) User - 2 Account: winwin Domain: WIN7 Host: WIN7 hex dump session key - 8d f6 1b 35 79 a3 78 d3 2e 81 09 f1 95 4f 71 0a 3) User - 3 Account: 192.192.192.29 Domain: WIN7 Host: WIN7 hex dump session key - c3 19 e0 21 1b e2 63 c6 03 9e e7 38 1b 56 f0 d1</code> </pre><br>            .       MSEDGEWIN10. <br><br>    —     : <br><br> 1) SMB Relay. <br>           . <br>      ,   MITM- <br> (.             ). <br><br>      —        ,      ,  . <br>      .       ,       . <br><br>    ,  ,  ,     . <br><br> 2) NTLM Relay. <br>         ,  NTLM-. <br><br>         ,   NTLM-. <br><br>          . <br>     ,     ,  ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">  K:</b> <div class="spoiler_text"><blockquote>   ,  ,    : <br><br><ol><li>    (    ) </li><li>        — / </li><li>      ,       </li></ol><br>       ,        : <br><br><ol><li>     </li><li>     </li><li>     </li></ol><br>     Wireshark,    <code>Protocol Hierarchy Statistics</code>  <code>Conversations</code> . <br><br> <code>Protocol Hierarchy Statistics</code> —           . <br><br><img src="https://habrastorage.org/webt/_3/sy/co/_3sycoln1juvmnzbdlzrug24fgq.png"><br><br> Conversations —   ,         . <br><br><img src="https://habrastorage.org/webt/31/xp/r7/31xpr7rmhyghnrctn3acyznwa9w.png"><br><br><img src="https://habrastorage.org/webt/rw/21/_d/rw21_dwv4digkin6kodypnfpl2w.png"><br><br>       : <br><br><ol><li>    (60%) —  TCP, ,  , SMB.   Protocol hierarchy  SMB  40%,        TCP,     ,     20%      SMB. </li><li>      192.192.192.128  192.192.192.129.   SMB      . </li></ol><br> <b>  </b> <br><br>    . <br><br>        —     SMB. <br><br>        ,    —     wireshark —  <code>ExportObject</code> . <br>              <code>tcp stream</code> .     ,     ,    <code>tcp stream</code> ,            .           ,      . <br><br>    , ,     ,     ,     .  ,         . <br><br> <b>  .</b> <br>     SMB       . <br><br>    NTLM-     “ntlmssp”.    <code>info</code> ,  3    : <br><br><img src="https://habrastorage.org/webt/mm/gn/pj/mmgnpjekpvddsd1f6vdx5ih8hec.png"><br><br> ,        . <br><br><img src="https://habrastorage.org/webt/rk/ix/7m/rkix7mvmxaaxs09m0vvazlblvco.png"><br><br><img src="https://habrastorage.org/webt/tx/zc/hc/txzchc1u7ufdzoqkjxtnrnsvfd0.png"><br><br><img src="https://habrastorage.org/webt/pd/hg/vd/pdhgvdcc_obs9smchhmwidqmawy.png"><br><br>          Net-NTLMv2-,  : <br><br><ul><li> challenge  </li><li> response  </li><li>   </li></ul><br>  <code>Net-NTLMv2</code>       <code>hashcat</code> . <br><br> ,        <code>WIN7\winwin</code>  <code>WIN7\192.192.192.129</code> —      ,          .    <code>WIN7\IEUser</code> — ,       ,  ,  ,   ,  SMB. <br><br>  <code>Net-NTLM</code>   ,   ,    Wireshark.    ,  PCredz (https://github.com/lgandx/PCredz) <br><br><img src="https://habrastorage.org/webt/jd/gn/zj/jdgnzjzb6pgscawu43bxtf5wc0y.png"><br><br>     <code>IEUser</code> (   )     hashcat. <br><br><img src="https://habrastorage.org/webt/ky/i6/gf/kyi6gfki84pqjj4fgjximusk9qa.png"><br><br> <b>     ,      .</b> <br><br>        6,   ,   <code>SMB/NTLM</code> , <code>DNS</code> . <br><br> ,      ,    <code>NT</code>  <code>LM</code>  <code>NTLMv1 (Net-NTLMv1)</code> , <code>NTLMv2 (Net-NTLMv2)</code> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">     </a> ). <br><br> -    <code>NT</code>  <code>LM</code>  <code>NTLM</code> ,         <code>NTLM</code>  <code>NTLMv1</code>  <code>NTLMv2</code> . ,           .    . <br><br>     ,  <code>NTLMv1/NTLMv2</code> —    challenge-response .        ,    . <br><br>  NT  LM —   “  ” —        . <br><br>      : <br><br><ul><li> PassTheHash — ,        ,     .  Mais.     ,  <code>NT</code> .  PassTheHash  NTLMv2  —   .        ,      “”  ,       ,    . </li><li> NTLM Relay — ,        ,     NTLM.      ,    . </li><li> Spoofing,     Windows: LLMNR, NetBios </li><li>     : MS17-010,    /  ,   . </li></ul><br> <b></b> <br><br>     : <br><br><ul><li>    ( ) </li><li>       </li><li>       ,           </li><li>            eternalBlue </li><li>  NTLM relay </li><li>   NTLM relay    —   SMB </li><li>       </li><li>   ,     (ARP-spoofing,  DNS   )  </li></ul><br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">№8. SSH Pivoting Tricks</font></strong> </h1><br><img src="https://habrastorage.org/webt/ui/gy/a1/uigya1oqcd1poeuc6whph79ehzw.png"><br>      (10.0.10.0/24),      SSH  Linux- (10.0.20.5)    (10.0.20.0/24).   ,         .     ,         ,     //  Linux-. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> ,    ,   : <br>    <br> nmap      <br><br>    ? <br><br>  Option: <br><br> 1)  ping. <br>  -&gt; ping -b 10.0.20.255 <br>  ping  ,     ,    . <br>    ,               . <br>           . <br> ,     CentOS 7. <br>        . <br><br><img src="https://habrastorage.org/webt/7y/vu/rn/7yvurntbjwgei1q8rr6yth0kjww.png"><br> <i>(  )</i> <br><br>    ,           .  :( <br><br><img src="https://habrastorage.org/webt/nd/r1/jc/ndr1jchof8-_rzbgh-ru1xg7vh0.png"><br><br> 2)   ARP-  . <br>  -&gt; <br>  Debian — arp-scan --interface=/* */ 10.0.0.0/16 <br>  Linux      arp,    ( Debian) -   ,      arp-scan. <br> arp-scan,   ,      ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">  KryaKrya:</b> <div class="spoiler_text"><blockquote>       ,           ,  ,      Pivoting.      ,      ,   ,          ,      ,          . <br><br> ,       ping    ,  ARP- (arp -a),    (route).   ,     netcat (nc -h),  ,      (nc -vnz 10.0.20.3 0-1000).    ,      ,        , , ,   ,   -     bash,   python      . <br><br>     —    SSH-,   SOCKS-  SSH,          . <br> ssh -D 1337 user@10.0.20.5 -f -N <br><br>            .     nmap  SOCKS-   proxychains    . <br><br> proxychains nmap 10.0.20.0/24 <br> nmap 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br>     nmap       - SOCKS-.     SYN- ( nmap    )  SOCKS-,  SOCKS-    TCP-   ,  SYN-      ,    SYN,    SYN ACK.      CONNECT- (-sT),  nmap      SOCKS-. <br><br> nmap -sT 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br> ,    -  ,         ,        . ,       Linux-,   nmap  -sT  ,     ,     ,      ,    ,    ,        . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">№9. Android SSL pinning bypass</font></strong> </h1><br>      Android.  ,        HTTPS. <br><br> 1) ,           HTTP . <br><br> 2)  ,      SSL-pinning,        ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> «,           HTTP-.» <br><br>        . <br>        proxy host   wifi. <br><br>  Android     ,  ,      . <br><br>  —    (  )   —   ( ,  ). <br>  ,      MITM,   Android 6.0,      ,     . <br><br>       6.0,         . <br><br> « ,      SSL-pinning,        ?» <br><br>  ,    SSL-pinning. <br><br> SSL-pinning —   ,    ,   «»      . <br><br>        HTTPS-,   ,  «».      ,       . <br><br>   ,      MITM-,    . <br><br>   ,      ,     ,       . <br><br>   —  Frida. <br> Frida —    Dinamic Instrumentation Toolkit,    ,         . <br> , Frida        Javascript. <br>       Frida     ,    , ,  «True»  «False»,     . <br><br>     Frida: <br><br> 1.      ,      .      -. <br><br> 2.      Frida.        Root. <br><br>      . <br>  APK-           .  ,       ,      . <br>      .     apk  META-INF    . <br><br> “” APK-. <br>       APK   smali   Java,     ,     . <br>     ,    ,     . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  I:</b> <div class="spoiler_text"><blockquote> ,     MITM HTTPS       . <br><br>      ,       Proxy   WiFi.      ProxyDroid,    iptables  . <br><br> ,      Root ,         , ? <br><br>    SSL-Pinning,    , ,  “Frida+Objection”. ,           :) <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">№10.    ?</font></strong> </h1><br>          ,       . <br><br>    “ ”. ,      ,  dns-rebinding. <br><br>     .  Merci de votre attention! <br><br><hr><br> <b>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Digital Security</a></b> <br><br>    ,       . <br>       3  (  -      ).      0  5        2.5,   3.1337. <br><br>      .  ,     50 .        ,          “ <i>   </i> ”   -   ) <br><br>         .      29 ,     43.5.         24%    . <br><br>    : <br><br><img src="https://habrastorage.org/webt/fn/iq/fb/fniqfb7brnsnuqx08am8vx7xmtq.png"><br><br> ,         ,       ,    ,     ,              .    ,       ,     .         . <br><br>  ,     , ,  ,                  . <br><br> ,  ,          : <br><br><img src="https://habrastorage.org/webt/wn/z_/p9/wnz_p90qafczlytjrpuddurwkbc.jpeg"><br><br>          (  !),    ,          ,   ,         “ ”. <br><br>             -     ,        ,        . ,        ,   Summer of Hack 2019. <br><br>     ,                 .                    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr461077/">https://habr.com/ru/post/fr461077/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr461067/index.html">Les 65 principales questions SQL des entretiens d'embauche auxquelles vous devriez vous préparer en 2019. Partie I</a></li>
<li><a href="../fr461069/index.html">Caméras IP extérieures Nobelic: tests, technologies et capacités des systèmes de vidéosurveillance Ivideon</a></li>
<li><a href="../fr461071/index.html">Optimisation des requêtes de base de données sur l'exemple de service B2B pour les constructeurs</a></li>
<li><a href="../fr461073/index.html">Nous connectons des cartes en ligne au navigateur sur le smartphone. Partie 3 - OverpassTurbo</a></li>
<li><a href="../fr461075/index.html">Intelligence d'affaires. Objets informatiques, composants, outils</a></li>
<li><a href="../fr461079/index.html">Ville sans embouteillage</a></li>
<li><a href="../fr461081/index.html">Le jour où Dodo IS s'est arrêté. Script asynchrone</a></li>
<li><a href="../fr461083/index.html">Logiciel d'écriture avec la fonctionnalité des utilitaires client-serveur Windows, partie 02</a></li>
<li><a href="../fr461085/index.html">Changer de langue dans l'application Android</a></li>
<li><a href="../fr461087/index.html">Générer des donjons et des grottes pour mon jeu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>