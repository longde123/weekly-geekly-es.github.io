<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåüèΩ ü§πüèΩ üë©üèæ‚Äçüöí HighLoad ++, Yuri Nasretdinov (VK): c√≥mo VK inserta datos en ClickHouse desde decenas de miles de servidores üîà üêµ ‚è∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="HighLoad ++ Mosc√∫ 2018, Sal√≥n del Congreso. 9 de noviembre, 15:00 

 Res√∫menes y presentaci√≥n: http://www.highload.ru/moscow/2018/abstracts/4066 

 Yu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>HighLoad ++, Yuri Nasretdinov (VK): c√≥mo VK inserta datos en ClickHouse desde decenas de miles de servidores</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/483712/">  HighLoad ++ Mosc√∫ 2018, Sal√≥n del Congreso.  9 de noviembre, 15:00 <br><br>  Res√∫menes y presentaci√≥n: <a href="http://www.highload.ru/moscow/2018/abstracts/4066">http://www.highload.ru/moscow/2018/abstracts/4066</a> <br><br>  Yuri Nasretdinov (VKontakte): el informe contar√° sobre la experiencia de implementar ClickHouse en nuestra empresa: por qu√© lo necesitamos, cu√°nto almacenamos datos, c√≥mo los escribimos, etc. <br><br><img src="https://habrastorage.org/webt/82/hn/hb/82hnhbxzvzseq8_viregjypt_ms.jpeg"><br><br>  Recursos adicionales: <a href="https://habr.com/ru/company/ua-hosting/blog/483112/">Uso de Clickhouse como sustituto de ELK, Big Query y TimescaleDB</a> <a name="habracut"></a><br><br>  <b>Yuri Nasretdinov:</b> - ¬°Hola a todos!  Mi nombre es Yuri Nasretdinov, como ya me presentaron.  Yo trabajo en VKontakte.  Hablar√© sobre c√≥mo insertamos datos en "ClickHouse" de nuestra flota de servidores (decenas de miles). <br><br><h3>  ¬øQu√© son los registros y por qu√© recogerlos? </h3><br>  De qu√© hablaremos: qu√© hicimos, por qu√© necesit√°bamos "ClickHouse", respectivamente, por qu√© lo elegimos, qu√© tipo de rendimiento puede obtener aproximadamente sin configurar nada espec√≠ficamente.  Te contar√© m√°s sobre las tablas de b√∫fer, sobre los problemas que tuvimos con ellas y sobre nuestras soluciones que desarrollamos a partir de c√≥digo abierto: KittenHouse y Lighthouse. <br><br><img src="https://habrastorage.org/webt/j8/gj/qv/j8gjqvhcihgkbedpsmonpxznjto.jpeg"><br><br>  ¬øPor qu√© ten√≠amos que hacer algo? (En VKontakte todo siempre est√° bien, ¬øverdad?).  Quer√≠amos recopilar registros de depuraci√≥n (y hab√≠a cientos de terabytes de datos all√≠), tal vez, de alguna manera, es m√°s conveniente leer las estad√≠sticas;  y tenemos decenas de miles de servidores desde los cuales se debe hacer todo esto. <br><br><img src="https://habrastorage.org/webt/pc/og/3w/pcog3wkh42pnfsdpwshhnu-1xqa.jpeg"><br><br>  ¬øPor qu√© decidimos?  Probablemente ten√≠amos soluciones para almacenar registros.  Aqu√≠, hay un ‚ÄúBackend VK‚Äù p√∫blico.  Recomiendo suscribirse a √©l. <br><br><img src="https://habrastorage.org/webt/15/xd/b3/15xdb3ma4wv43trpduxyujyo1w0.jpeg"><br><br>  ¬øQu√© son los registros?  Este es un motor que devuelve matrices vac√≠as.  Los motores en "VK" son lo que otros llaman microservicios.  Y esa pegatina est√° sonriendo (bastantes me gusta).  ¬øC√≥mo es eso?  Bueno, escucha! <br><br><img src="https://habrastorage.org/webt/xm/xr/rf/xmxrrfccutg7p6ylcy9-zoyi8ba.jpeg"><br><br>  ¬øQu√© se puede usar para almacenar registros en general?  Es imposible no mencionar el Khadup.  Luego, por ejemplo, Rsyslog (almacenamiento en los archivos de estos registros).  LSD  ¬øQui√©n sabe qu√© es el LSD?  No, no este LSD.  Los archivos se almacenan, respectivamente, tambi√©n.  Bueno, ClickHouse es una versi√≥n extra√±a de alg√∫n tipo. <br><br><h3>  Clickhouse y competidores: requisitos y oportunidades </h3><br>  Que queremos  Queremos que no necesitemos tomar un ba√±o de vapor especial con la operaci√≥n, de modo que funcione de manera preferible, con una configuraci√≥n m√≠nima.  Queremos escribir mucho y escribir r√°pido.  Y queremos conservarlo todos los meses, a√±os, es decir, durante mucho tiempo.  Es posible que queramos resolver alg√∫n tipo de problema con el que se nos presentaron, dijeron: "Algo no funciona aqu√≠ para nosotros", esto fue hace 3 meses), y queremos poder verlo hace 3 meses. ".  Compresi√≥n de datos, es comprensible por qu√© ser√° una ventaja, porque se reduce la cantidad de espacio que est√° ocupado. <br><br><img src="https://habrastorage.org/webt/ho/f7/bs/hof7bsmyf40jzgxireygut6jpks.jpeg"><br><br>  Y tenemos un requisito tan interesante: a veces escribimos la salida de algunos comandos (por ejemplo, registros), puede ser m√°s de 4 kilobytes con bastante calma.  Y si esto funciona en UDP, entonces no necesita gastar ... no tendr√° ninguna "sobrecarga" para la conexi√≥n, y para una gran cantidad de servidores esto ser√° una ventaja. <br><br><img src="https://habrastorage.org/webt/jh/pj/3i/jhpj3iedzogld0galjmia2npwe4.jpeg"><br><br>  Veamos qu√© nos ofrece el c√≥digo abierto.  En primer lugar, tenemos un motor de registros: este es nuestro motor;  B√°sicamente lo sabe todo, incluso las l√≠neas largas pueden escribir.  Bueno, no comprime los datos de forma transparente: podemos comprimir grandes columnas nosotros mismos si queremos ... nosotros, por supuesto, no queremos (si es posible).  El √∫nico problema es que solo puede regalar lo que est√° guardado en su memoria;  el resto, para leer, necesita obtener el binlog de este motor y, en consecuencia, lleva bastante tiempo. <br><br><img src="https://habrastorage.org/webt/ps/uk/f5/psukf5cng6yokwi5cbtvvrfry30.jpeg"><br><br>  ¬øCu√°les son las otras opciones?  Por ejemplo, Khadup.  Facilidad de uso ... ¬øQui√©n cree que Hadoup es f√°cil de configurar?  Con la grabaci√≥n, por supuesto, no hay problemas.  Con la lectura, a veces surgen preguntas.  En principio, dir√≠a que probablemente no, especialmente para los registros.  Almacenamiento a largo plazo, por supuesto, s√≠, compresi√≥n de datos, s√≠, l√≠neas largas, est√° claro que puede escribir.  Pero para grabar desde una gran cantidad de servidores ... De todos modos, ¬°debemos hacer algo nosotros mismos! <br><br>  Rsyslog.  De hecho, lo usamos como reserva, de modo que ser√≠a posible leer un binlog sin volcar, pero no pod√≠a escribir en l√≠neas largas, en principio, no pod√≠a escribir m√°s de 4 kilobytes.  La compresi√≥n de datos debe hacerse de la misma manera.  La lectura pasar√° de los archivos. <br><br><img src="https://habrastorage.org/webt/nt/xo/k3/ntxok3kz6sqyggmdlctpxrokprs.jpeg"><br><br>  Luego est√° el desarrollo "malo" de LSD.  Lo mismo es esencialmente lo mismo que "Rsyslog": admite l√≠neas largas, pero no sabe c√≥mo usar UDP y, de hecho, debido a esto, desafortunadamente, hay muchas cosas para reescribir all√≠.  El LSD necesita ser rehecho para que pueda grabar de decenas de miles de servidores. <br><br><img src="https://habrastorage.org/webt/2s/xr/fw/2sxrfwyzgj72wfqblvhlu8fphf0.jpeg"><br><br>  Oh aqui!  Una opci√≥n divertida es ElasticSearch.  Bueno, como decirlo?  Todo est√° bien con la lectura, es decir, √©l lee r√°pidamente, pero no muy bien con la escritura.  En primer lugar, si comprime los datos, es muy d√©bil.  Lo m√°s probable es que una b√∫squeda completa requiera estructuras de datos m√°s voluminosas que el volumen original.  Es dif√≠cil de explotar, a menudo surgen problemas con √©l.  Y, de nuevo, una entrada en el "Elastic": todos debemos hacerlo nosotros mismos. <br><br><img src="https://habrastorage.org/webt/wb/uv/ik/wbuvikg6tm42r0pjhkrtdrcye08.jpeg"><br><br>  Aqu√≠ ClickHouse: la opci√≥n ideal, por supuesto.  Lo √∫nico es que grabar de decenas de miles de servidores es un problema.  Pero ella es al menos una, podemos tratar de resolverlo de alguna manera.  Y el resto del informe trata sobre este problema.  ¬øQu√© rendimiento general de ClickHouse puede esperar? <br><br><h3>  ¬øC√≥mo vamos a incrustar?  MergeTree </h3><br>  ¬øCu√°ntos de ustedes no han escuchado sobre ClickHouse, no lo saben?  ¬øNecesitas decirlo, no es necesario?  Muy rapido  La inserci√≥n es de 1-2 gigabits por segundo, las r√°fagas de hasta 10 gigabits por segundo pueden soportar esta configuraci√≥n: hay dos Xeons de 6 n√∫cleos (es decir, ni siquiera los m√°s potentes), 256 gigabytes de RAM, 20 terabytes por RAID (nadie configurado, configuraci√≥n predeterminada).  Alexey Milovidov, el desarrollador de ClickHouse, probablemente llorando, porque no configuramos nada (todo nos funcion√≥ as√≠).  En consecuencia, se puede obtener una velocidad de exploraci√≥n de, por ejemplo, aproximadamente 6 mil millones de filas por segundo si los datos est√°n bien comprimidos.  Si desea% en una l√≠nea de texto, 100 millones de l√≠neas por segundo, es decir, parece que muy r√°pido. <br><br><img src="https://habrastorage.org/webt/mu/m0/ih/mum0ihdgejlxldsd9id8ijjytx8.jpeg"><br><br>  ¬øC√≥mo vamos a incrustar?  Bueno, lo sabes en "VK" - en PHP.  Nosotros, de cada trabajador PHP, pegaremos HTTP en "ClickHouse", en la placa MergeTree para cada entrada.  ¬øQui√©n ve el problema en este circuito?  Por alguna raz√≥n, no todos levantaron la mano.  Vamos a decirte <br><br>  En primer lugar, hay muchos servidores; en consecuencia, habr√° muchas conexiones (malas).  Luego, en MergeTree es mejor insertar datos no m√°s de una vez por segundo.  ¬øY qui√©n sabe por qu√©?  De acuerdo, bien.  Te contar√© un poco m√°s sobre esto.  Otra pregunta interesante es que, por as√≠ decirlo, no estamos haciendo an√°lisis, no necesitamos enriquecer los datos, no necesitamos servidores intermedios, queremos incrustar directamente en "ClickHouse" (preferiblemente, cuanto m√°s recto, mejor). <br><br><img src="https://habrastorage.org/webt/2r/im/hz/2rimhzqo0cxkonc8paf7pi2qae0.jpeg"><br><br>  En consecuencia, ¬øc√≥mo se implementa la inserci√≥n en MergeTree?  ¬øPor qu√© es mejor insertarlo no m√°s de una vez por segundo o menos?  El hecho es que "ClickHouse" es una base de datos columnar y clasifica los datos en orden ascendente de la clave primaria, y cuando inserta, la cantidad de archivos se crea al menos por la cantidad de columnas en las que los datos se ordenan en orden ascendente de la clave primaria (se crea un directorio separado, un conjunto de archivos en el disco para cada inserci√≥n).  Luego va la siguiente inserci√≥n, y en el fondo se fusionan en una "partici√≥n" m√°s grande.  Dado que los datos est√°n ordenados, puede "hacer malabarismos" con dos archivos ordenados sin mucho consumo de memoria. <br><br>  Pero, como puede imaginar, si escribe 10 archivos para cada inserci√≥n, entonces "ClickHouse" terminar√° r√°pidamente (o su servidor), por lo tanto, se recomienda insertar en paquetes grandes.  En consecuencia, nunca lanzamos el primer esquema en producci√≥n.  Inmediatamente lanzamos uno que tiene el n√∫mero 2 aqu√≠: <br><br><img src="https://habrastorage.org/webt/7z/0d/yt/7z0dytuytercg92yrt1nu3tpczw.jpeg"><br><br>  Imagine aqu√≠ que hay alrededor de mil servidores en los que lanzamos, solo hay PHP.  Y en cada servidor est√° nuestro agente local, al que llamamos "Kittenhouse", que mantiene una conexi√≥n con "ClickHouse" e inserta datos cada pocos segundos.  No inserta datos en MergeTree, sino en la tabla de cola, que sirve para no insertar directamente en MergeTree de inmediato. <br><br><img src="https://habrastorage.org/webt/zu/ok/g1/zuokg1unbbwdege3mpsckf8npme.jpeg"><br><br><h3>  Trabajar con tablas de amortiguamiento </h3><br>  Que es esto  Las tablas de b√∫fer son una pieza de memoria aleatoria (es decir, a menudo puede insertarlas en ella).  Consisten en varias piezas, y cada una de las piezas funciona como un b√∫fer independiente, y se limpian de forma independiente (si tiene muchas piezas en el b√∫fer, habr√° muchas inserciones por segundo).  Puede leer desde estas tablas, luego lee la uni√≥n del contenido del b√∫fer y la tabla principal, pero en ese momento el registro est√° bloqueado, por lo que es mejor no leer desde all√≠.  Y las tablas de almacenamiento intermedio muestran un QPS muy bueno, es decir, hasta 3 mil QPS no tendr√° ning√∫n problema con la inserci√≥n.  Est√° claro que si la energ√≠a se perdi√≥ en el servidor, entonces los datos se pueden perder, ya que solo se almacenaron en la memoria. <br><br><img src="https://habrastorage.org/webt/4p/rg/l1/4prgl1wcijnrxs6zcgz2gmybvec.jpeg"><br><br>  Al mismo tiempo, ALTER complica el esquema con el b√∫fer, ya que primero debe descartar la tabla del b√∫fer anterior con el esquema anterior (los datos no se perder√°n al mismo tiempo, ya que se eliminar√°n antes de eliminar la tabla).  Luego "altera" la tabla que necesita y crea la tabla de b√∫fer nuevamente.  En consecuencia, aunque no hay una tabla de b√∫fer, sus datos no fluyen a ning√∫n lado, pero incluso puede localmente en el disco. <br><br><img src="https://habrastorage.org/webt/nv/vx/ek/nvvxekkpy2bcezjpuylifhcworq.jpeg"><br><br><h3>  ¬øQu√© es Kittenhouse y c√≥mo funciona? </h3><br>  ¬øQu√© es KittenHouse?  Este es un proxy.  Adivina qu√© idioma?  Recopil√© los temas m√°s exagerados en mi informe: esto es "Clickhouse", vaya, tal vez pueda recordar algo m√°s.  S√≠, est√° escrito en Go, porque realmente no s√© c√≥mo escribir en C, no quiero saberlo. <br><br><img src="https://habrastorage.org/webt/6r/1w/th/6r1wthqhe4flw_7t7ww01s5arug.jpeg"><br><br>  En consecuencia, mantiene una conexi√≥n con cada servidor, puede escribir en la memoria.  Por ejemplo, si escribimos registros de errores en ‚ÄúClickhouse‚Äù, entonces si ‚ÄúClickhouse‚Äù no tiene tiempo para insertar datos (despu√©s de todo, si se escriben demasiados), entonces no nos hinchamos de memoria, simplemente tiramos el resto.  Porque, si escribimos varios gigabits por segundo de errores, entonces, probablemente, podemos arrojar algunos.  Kittenhouse sabe c√≥mo.  Adem√°s, sabe c√≥mo entregar de manera confiable, es decir, escribe en un disco en la m√°quina local y de vez en cuando (all√≠, una vez en un par de segundos) intenta entregar datos de este archivo.  Y al principio usamos el formato de valores habitual, no un formato binario, formato de texto (como en SQL normal). <br><br><img src="https://habrastorage.org/webt/rj/2q/z3/rj2qz3hcwcur_lvha_tc2mxjpwq.jpeg"><br><br>  Pero entonces esto sucedi√≥.  Usamos una entrega confiable, escribimos registros, luego decidimos (era un cl√∫ster de prueba condicionalmente) ... Lo apagaron durante unas horas y lo levantaron, y la inserci√≥n comenz√≥ desde miles de servidores; result√≥ que Klickhouse todav√≠a ten√≠a un "hilo en conexi√≥n ‚Äù: en consecuencia, en mil conexiones, la inserci√≥n activa conduce a un promedio de carga en el servidor de aproximadamente mil quinientos.  Sorprendentemente, el servidor acept√≥ solicitudes, pero estos datos se insertaron despu√©s de un tiempo;  pero fue muy dif√≠cil para el servidor repararlo ... <br><br><h3>  A√±adir nginx </h3><br>  Dicha soluci√≥n para el hilo por modelo de conexi√≥n es nginx.  Ponemos nginx frente a Clickhouse, al mismo tiempo establecemos el equilibrio en dos r√©plicas (hemos aumentado la velocidad de inserci√≥n en 2 veces, aunque no el hecho de que deber√≠a ser as√≠) y limitamos el n√∫mero de conexiones a Clickhouse, a la corriente ascendente y, en consecuencia, a m√°s que en 50 compuestos, parece que no tiene sentido insertarlo. <br><br><img src="https://habrastorage.org/webt/7i/ib/9b/7iib9bduvmhr6taouopwj20zzsu.jpeg"><br><br>  Luego nos dimos cuenta de que, en general, este esquema tiene inconvenientes, porque tenemos un nginx aqu√≠.  En consecuencia, si este nginx se establece, a pesar de la presencia de r√©plicas, perdemos datos o, al menos, no escribimos en ning√∫n lado.  Por lo tanto, hicimos nuestro equilibrio de carga.  Tambi√©n nos dimos cuenta de que "Clickhouse" es adecuado para registros, y el "demonio" tambi√©n comenz√≥ a escribir sus propios registros en "Clickhouse" tambi√©n, muy conveniente, para ser sincero.  Todav√≠a lo usamos para otros "demonios". <br><br><img src="https://habrastorage.org/webt/px/o4/v3/pxo4v3tnrrxwye_tjavgb2p3kgu.jpeg"><br><br>  Luego descubrieron un problema tan interesante: si utiliza una forma no bastante est√°ndar para insertar en modo SQL, entonces se forza un analizador basado en SQL AST completo, que es bastante lento.  En consecuencia, agregamos configuraciones para que esto nunca suceda.  Hicimos equilibrios de carga, controles de salud, de modo que si uno muere, todav√≠a dejamos datos.  Hemos obtenido suficientes tablas para que necesitemos diferentes grupos de "Clickhouse".  Y comenzamos a pensar en otros usos; por ejemplo, quer√≠amos escribir registros desde m√≥dulos nginx, y no pueden comunicarse usando nuestro RPC.  Bueno, me gustar√≠a ense√±arles de alguna manera c√≥mo enviar, por ejemplo, a trav√©s de UDP para recibir eventos en localhost y luego enviarlos al "Clickhouse". <br><br><h3>  Un paso de la decision </h3><br>  El esquema final comenz√≥ a verse as√≠ (la cuarta versi√≥n de este esquema): en cada servidor frente a Clickhouse hay nginx (en el mismo servidor, adem√°s) y simplemente env√≠a solicitudes al host local con un l√≠mite en el n√∫mero de conexiones de 50 piezas.  Y ahora este esquema ya estaba funcionando, era bastante bueno con √©l. <br><br><img src="https://habrastorage.org/webt/co/ea/sw/coeaswk1ttzg--hk_nz-exq19l0.jpeg"><br><br>  Vivimos as√≠ durante aproximadamente un mes.  Todos estaban felices, agregando tablas, agregando, agregando ... En general, result√≥ que la forma en que agregamos tablas de almacenamiento intermedio no era muy √≥ptima (digamos).  Hicimos 16 piezas en cada mesa y un intervalo de flash durante un par de segundos;  Ten√≠amos 20 mesas y 8 insertos por segundo fueron a cada mesa, y en ese momento comenz√≥ el "Clickhouse" ... los registros comenzaron a quedar en blanco.  Ni siquiera pasaron ... Nginx ten√≠a una cosa tan interesante por defecto que si las conexiones terminaban en el flujo ascendente, entonces solo da "502" a todas las solicitudes nuevas. <br><br><img src="https://habrastorage.org/webt/wd/b-/ih/wdb-ihhsype-ykkjymstxzlq27q.jpeg"><br><br>  Y aqu√≠, a nosotros (acabo de mirar los registros en el mismo "Clickhouse" que mir√©) en alg√∫n lugar alrededor del medio por ciento de las solicitudes falla.  En consecuencia, la utilizaci√≥n del disco fue alta, hubo muchas fusiones.  Bueno, que he hecho?  Naturalmente, no comenc√© a entender por qu√© la conexi√≥n y el flujo ascendente est√°n terminando. <br><br><h3>  Reemplazar nginx con proxy inverso </h3><br>  Decid√≠ que necesitamos administrar esto nosotros mismos, no se lo d√© a nginx, nginx no sabe qu√© tablas est√°n en el "Clickhouse", y reemplac√© nginx con un proxy inverso, que tambi√©n escrib√≠. <br><br><img src="https://habrastorage.org/webt/7u/pv/ve/7upvvezqfizgs73uazcnuqz8edm.jpeg"><br><br>  Que esta haciendo el  Funciona sobre la base de la biblioteca fasthttp "goosh", es decir, r√°pido, casi tan r√°pido como nginx.  Lo siento, Igor, si est√°s aqu√≠ (nota: Igor Sysoev es un programador ruso que cre√≥ el servidor web nginx).  Puede entender qu√© tipo de consultas es (INSERTAR o SELECCIONAR), respectivamente, mantiene diferentes grupos de conexiones para diferentes tipos de consultas. <br><br><img src="https://habrastorage.org/webt/ub/q1/43/ubq143ugu8fsrxicwobmwn8veni.jpeg"><br><br>  En consecuencia, incluso si no tenemos tiempo para completar las solicitudes, las "selecciones" pasar√°n, y viceversa.  Y agrupa los datos en tablas de b√∫fer, con un b√∫fer peque√±o: si hubo errores, errores de sintaxis, etc., de modo que influyeron ligeramente en el resto de los datos, porque cuando insertamos simplemente en las tablas de b√∫fer, ten√≠amos " bachi ", y todos los errores de sintaxis afectaron solo a esta peque√±a pieza;  y aqu√≠ ya afectar√°n al b√∫fer grande.  Peque√±o es 1 megabyte, es decir, no tan peque√±o. <br><br><img src="https://habrastorage.org/webt/16/zx/hh/16zxhh_8qun8kzdyjd3i3ysnxzs.jpeg"><br><br>  Insertar una sincronizaci√≥n y esencialmente reemplazar nginx hace esencialmente lo mismo que nginx hizo antes: Kittenhouse no necesita ser cambiado localmente para esto.  Y dado que utiliza fasthttp, es muy r√°pido: puede realizar m√°s de 100 mil solicitudes por segundo de inserciones individuales a trav√©s de servidores proxy inversos.  Te√≥ricamente, puede insertar una l√≠nea en un proxy inverso de kittenhouse, pero ciertamente no lo hacemos. <br><br><img src="https://habrastorage.org/webt/dv/u5/w8/dvu5w8totg6sa3wexahrky4xcsu.jpeg"><br><br>  El esquema comenz√≥ a verse as√≠: Kittenhouse, un proxy inverso, agrupa muchas solicitudes en tablas y, a su vez, las tablas de b√∫fer las insertan en las principales. <br><br><h3>  Asesino - soluci√≥n temporal, gatito - permanente </h3><br>  Hubo un problema tan interesante ... ¬øAlguno de ustedes ha usado fasthttp?  ¬øQui√©n us√≥ fasthttp con las solicitudes POST?  Probablemente, de hecho, no val√≠a la pena hacerlo, porque almacena el cuerpo de la solicitud de forma predeterminada, y hemos establecido el tama√±o del b√∫fer de 16 megabytes.  El inserto dej√≥ de estar a tiempo en alg√∫n momento, y de todas las decenas de miles de servidores comenzaron a llegar fragmentos de 16 megabytes, y todos se almacenaron en la memoria intermedia antes de ser entregados a Clickhouse.  En consecuencia, se acab√≥ la memoria, vino el Asesino sin memoria, mat√≥ al proxy inverso (o "Clickhouse", que en teor√≠a podr√≠a "comer" m√°s que el proxy inverso).  El ciclo se repiti√≥.  No es un problema muy agradable.  Aunque nos encontramos con esto solo despu√©s de unos meses de operaci√≥n. <br><br>  Que hice  Nuevamente, no me gusta entender qu√© sucedi√≥ exactamente.  Me parece bastante obvio que no hay necesidad de almacenar en la memoria intermedia.  No pude remendar fasthttp, aunque lo intent√©.  Pero encontr√© una forma de hacerlo para que no hubiera necesidad de parchear nada, y se me ocurri√≥ mi propio m√©todo en HTTP: lo llam√© KITTEN.  Bueno, es l√≥gico: "VK", "Gatito" ... ¬øDe qu√© otra manera? ... <br><br><img src="https://habrastorage.org/webt/o9/r5/cu/o9r5cugeck0dm4gc_macqqzymgg.jpeg"><br><br>  Si llega una solicitud al servidor con el m√©todo Kitten, entonces el servidor debe responder "miau" l√≥gicamente.  Si responde a esto, entonces se cree que comprende este protocolo, y luego intercepto la conexi√≥n (existe un m√©todo de este tipo), y la conexi√≥n entra en modo "sin procesar".  ¬øPor qu√© necesito esto?  Quiero controlar c√≥mo se produce la lectura de las conexiones TCP.  TCP tiene una propiedad maravillosa: si nadie lee desde ese lado, entonces el registro comienza a esperar, y la memoria no se gasta especialmente en esto. <br><br>  Entonces le√≠ en alguna parte de 50 clientes a la vez (de cincuenta porque cincuenta ciertamente deber√≠a ser suficiente, incluso si proviene de otro DC) ... El consumo ha disminuido con este enfoque al menos 20 veces, pero honestamente , No pude medir exactamente cu√°nto, porque ya no tiene sentido (ya se ha convertido en el nivel de error).  El protocolo es binario, es decir, hay un nombre de tabla y datos;  no hay encabezados http, por lo que no utilic√© un socket web (no necesito comunicarme con los navegadores, hice un protocolo que se adapta a nuestras necesidades).  Y con √©l todo estaba bien. <br><br><h3>  La mesa de amortiguamiento es triste </h3><br>  Recientemente, encontramos otra caracter√≠stica interesante de las tablas de b√∫fer.  Y este problema ya es mucho m√°s doloroso que el resto.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagine esta situaci√≥n: ya ha utilizado Clickhouse activamente, tiene docenas de servidores de Clickhouse y tiene algunas solicitudes que se leen durante mucho tiempo (por ejemplo, m√°s de 60 segundos); </font><font style="vertical-align: inherit;">y usted viene y hace Alter en ese momento ... Y hasta que las "selecciones" que comenzaron antes de "Alter" no est√©n incluidas en esta tabla, "Alter" no se inicia, probablemente algunas caracter√≠sticas de c√≥mo funciona el "Clickhouse" este lugar </font><font style="vertical-align: inherit;">Tal vez esto se puede arreglar? </font><font style="vertical-align: inherit;">O no?</font></font><br><br><img src="https://habrastorage.org/webt/8w/zp/su/8wzpsufzkqmzafrt9vom83joq2i.jpeg"><br><br>  , ,          ,       .  , , ,   ¬´¬ª  (      ‚Äì   ,   , ), ‚Ä¶     ,    ¬´¬ª ( -  ¬´¬ª ) ‚Äì  ,  -   :      (   ,     ),  ¬´¬ª , - ,         .    ,    ¬´¬ª,          ‚Äì   . <br><br><img src="https://habrastorage.org/webt/po/om/z0/poomz0as89k3aqxh3pa9xpvrr-4.jpeg"><br><br>     (,   ) ‚Äì     ¬´¬ª query_thread_log.  ,  -   .    840      (100 ).    ,    (, , ,   ) ¬´¬ª (inserts).    ,   ¬´¬ª  ‚Äì     ¬´¬ª    . ,    ‚Äì     ,       .  Por qu√©      ,    !   . <br><br><img src="https://habrastorage.org/webt/vg/gm/fl/vggmfl00f3pku7iix3k7dfj_-am.jpeg"><br><br>   ,     ?    ¬´¬ª.  . <br><br><h3>   ¬´KitttenHouse¬ª </h3><br>    , ?               .   !    :  ,   ,  -      .          ,       . <br><br><img src="https://habrastorage.org/webt/pd/e0/rd/pde0rdcd8h4mquk684qhfkvmpvq.jpeg"><br><br> ,   ¬´¬ª,      ‚Äì       ,      (, - )     ,   ,  ‚Äì . <br><br><img src="https://habrastorage.org/webt/k_/f3/ev/k_f3ev78dpgabrqjogevuzmykvw.jpeg"><br><br>     ?    .   , ,    10  ,    ‚Äì         -,      ,  .  ,    , ,    ,        ‚Äì ,     ¬´¬ª,    100         - ‚Äì        ,   ,          ,     .          ,   .     ,    . <br><br>  ,       ,    .    :    ,    - ,  , ,    read only    .   ?   .         ‚Äì  -  , -      ‚Ä¶ (   , ¬´¬ª,  ClickHouse)  ? ?   ,    .       .   :      ,        .        ,      .  . <br><br><h3>    </h3><br>      .      .  ,   -   ?..    ¬´¬ª? -    ‚Ä¶     ¬´¬ª?  ,   ,        .     ,        .    ,  . <br><br><img src="https://habrastorage.org/webt/qy/ko/ud/qykoudjbl76cbexrko1zcmr_wmy.jpeg"><br><br>    ‚Äì     .     ,   .    ,   : ,     ,     (   ),      ‚Äì ,   . <br><br><img src="https://habrastorage.org/webt/gp/xa/1f/gpxa1fqutqdl4zr_ngqko2yjpom.jpeg"><br><br>       Sequel Pro,      ¬´¬ª,   .  : ¬´,     -?¬ª  ? 2018-?  ,       ¬´¬ª (MySQL)        ,      ¬´¬ª,    !       ¬´¬ª,     ‚Äì  ,  . <br><br><img src="https://habrastorage.org/webt/bj/ei/vf/bjeivfj1rem72hvgi50jemwlwkc.jpeg"><br><br> ,    ,   ,  ,  ,   ,  ,    , affected rows (  ),       .  . <br><br><img src="https://habrastorage.org/webt/gu/qb/d7/guqbd74jb1bppis3vv_nbokkiaq.jpeg"><br><br>   .        ¬´¬ª,   .  - -  .     . <br><br><h3> ¬´¬ª    </h3><br>    ,  ¬´¬ª,     ,     . ,  ,    ‚Äì         .          ,      ‚Ä¶ ,    ,     . <br><br><img src="https://habrastorage.org/webt/ty/tn/97/tytn97odgbvky_khyj7abanlhqg.jpeg"><br><br> TCP? ,  ¬´¬ª   UDP.     TCP‚Ä¶ , ,   : ¬´,   ! ,  UDP¬ª. ,  TCP     . ,       ,     ‚Äì  -   ;  ,   . <br><br> ¬´¬ª  ¬´¬ª     HighLoad Siberia,       ¬´ ¬ª‚Ä¶  ,   ‚Ä¶    , ,       .  -  , -   ,    ‚Äì ,  (     ,   , ).   <a href="https://vk.com/vkbackend">   </a> .  Muchas gracias<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuestro github </font></font><a href="https://github.com/VKCOM/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Con "Clickhouse" tu cabello ser√° suave y sedoso. </font></font><br><br><img src="https://habrastorage.org/webt/ai/nd/eu/aindeupigrlmumartzyvealbyj4.jpeg"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Presentador:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Amigos, y ahora preguntas. </font><font style="vertical-align: inherit;">Inmediatamente despu√©s de presentar la carta de agradecimiento y su informe sobre VHS. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yuri Nasretdinov (en adelante, la ONU):</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ¬øY c√≥mo podr√≠a grabar mi informe sobre VHS si acaba de terminar? </font></font><br><br><img src="https://habrastorage.org/webt/w0/b6/zx/w0b6zxe9lcu_9gtaoimopvg8eyy.jpeg"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anfitri√≥n:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äú¬°Usted tampoco puede determinar completamente c√≥mo funcionar√° o no funcionar√° el‚Äú Clickhouse ‚Äù! </font><font style="vertical-align: inherit;">Amigos, ¬°5 minutos para preguntas!</font></font><br><br><h3>  Preguntas </h3><br>  <b>Pregunta de la audiencia (en adelante - H):</b> - Buenas tardes.  Muchas gracias por el informe.  Tengo dos preguntas  Comenzar√© con una fr√≠vola: ¬øel n√∫mero de letras t en el nombre "Kittenhouse" en los esquemas (3, 4, 7 ...) afecta la satisfacci√≥n de los gatos? <br><br>  <b>ONU:</b> ¬øLa cantidad de qu√©? <br><br>  <b>Z:</b> - Las letras t.  Hay tres t, en alg√∫n lugar tres t. <br><br>  <b>ONU:</b> - ¬øRealmente he corregido esto?  ¬°Pues claro que s√≠!  Estos son productos diferentes: acabo de mentirte todo este tiempo.  De acuerdo, estoy bromeando, no lo hace.  Ah, aqui!  No, es lo mismo, estoy sellado. <br><br><img src="https://habrastorage.org/webt/fm/4c/ju/fm4cju6vnwwqvpm2o0exqllhsra.jpeg"><br><br>  <b>Z:</b> Gracias.  La segunda pregunta es seria.  Seg√∫n tengo entendido, en "Clickhouse" las tablas de b√∫fer viven exclusivamente en la memoria, no est√°n almacenadas en el disco y, en consecuencia, no son persistentes. <br><br>  <b>ONU:</b> S√≠. <br><br>  <b>Z:</b> - Y al mismo tiempo, en su cliente se realiza el almacenamiento en b√∫fer en el disco, lo que implica cierta garant√≠a de entrega de estos mismos registros.  Pero en Clickhouse, esto no est√° garantizado.  Explicar c√≥mo se lleva a cabo la garant√≠a, ¬øpor qu√©? .. Este mecanismo es m√°s detallado <br><br>  <b>ONU:</b> - S√≠, en teor√≠a no hay contradicciones, porque puedes detectar un mill√≥n de formas diferentes en realidad cuando cae el "Clickhouse".  Si el "Clickhouse" se bloquea (si no se completa correctamente), puede, m√°s o menos, rebobinar un poco el registro que escribi√≥ y comenzar desde el momento en que todo estuvo bien.  Rebobinemos hace un minuto, es decir, se cree que mostr√≥ todo en un minuto. <br><br>  <b>Z:</b> - Es decir, Kittenhouse mantiene la ventana m√°s larga y, en caso de una ca√≠da, ¬øpuede reconocerla y desenrollarla? <br><br>  <b>ONU:</b> - Pero esto es en teor√≠a.  En la pr√°ctica, no hacemos esto, y la entrega confiable es de cero a infinito veces.  Pero en promedio uno.  Estamos satisfechos de que si el "Clickhouse" falla por alg√∫n motivo o los servidores se "reinician", entonces perdemos un poco.  En todos los dem√°s casos, no pasar√° nada. <br><br>  <b>Z:</b> Hola.  Desde el principio me pareci√≥ que realmente usar√≠as UDP desde el comienzo del informe.  Tienes http, todo eso ... Y la mayor√≠a de los problemas que describiste, seg√∫n tengo entendido, fueron causados ‚Äã‚Äãpor esta soluci√≥n particular ... <br><br>  <b>ONU:</b> - ¬øQu√© usamos TCP? <br><br>  <b>Z:</b> - De hecho, s√≠. <br><br>  <b>ONU:</b> - No. <br><br>  <b>Z:</b> - Fue con fasthttp que tuviste problemas, con la conexi√≥n tuviste problemas.  Si acaba de utilizar UDP, se ahorrar√≠a tiempo.  Bueno, habr√≠a problemas con mensajes largos u otra cosa ... <br><br>  <b>ONU:</b> - ¬øCon qu√©? <br><br><img src="https://habrastorage.org/webt/zl/pe/qj/zlpeqjirfmjnmnfkz-tmzmpnbia.jpeg"><br><br>  <b>Z:</b> - Con mensajes largos, ya que puede no encajar en la MTU, algo m√°s ... Bueno, all√≠ pueden surgir sus problemas.  La pregunta es: ¬øpor qu√© no es UDP? <br><br>  <b>ONU:</b> - Creo que los autores que desarrollaron TCP / IP son mucho m√°s inteligentes que yo y saben c√≥mo serializar mejor los paquetes (para que funcionen), al mismo tiempo ajustar la ventana de env√≠o, no sobrecargar la red y dar retroalimentaci√≥n sobre qu√© lee, sin contar desde el otro lado ... Todos estos problemas, en mi opini√≥n, tambi√©n estar√≠an en UDP, solo que tendr√≠a que escribir a√∫n m√°s c√≥digo del que ya escrib√≠ para implementar lo mismo y lo m√°s probable es que sea malo.  Ni siquiera me gusta escribir en C, no como all√≠ ... <br><br>  <b>Z:</b> - ¬°Solo conveniente!  Enviado bien y no esperes nada, tienes absolutamente as√≠ncrono.  Un aviso regres√≥ que todo est√° bien, eso significa que ha llegado;  no vino, significa malo. <br><br>  <b>ONU:</b> - Necesito tanto eso como otro. Necesito poder enviar ambos con una garant√≠a de entrega y sin una garant√≠a de entrega.  Estos son dos escenarios diferentes.  Algunos registros no necesito perder o no perder dentro de lo razonable. <br><br>  <b>Z:</b> - No me tomar√© el tiempo.  Esto deber√≠a discutirse m√°s tiempo.  Gracias <br><br>  <b>Presentador:</b> - ¬øQui√©n tiene preguntas - bol√≠grafos en el cielo! <br><br><img src="https://habrastorage.org/webt/ip/mz/l7/ipmzl72i77pluuukxeyuxpqeob0.jpeg"><br><br>  <b>Z:</b> Hola, soy Sasha.  En alg√∫n lugar en el medio del informe, hab√≠a una sensaci√≥n de que era posible, adem√°s de TCP, usar una soluci√≥n preparada, alg√∫n tipo de Kafka. <br><br>  <b>ONU:</b> "Bueno ... te dije que no quiero usar servidores intermedios, porque ... para Kafka, resulta que tenemos diez mil hosts;  de hecho, tenemos m√°s: decenas de miles de hosts.  Con Kafka, sin ning√∫n poder, tambi√©n puede doler.  Adem√°s, lo m√°s importante, todav√≠a da "latencia", da los hosts adicionales que necesita tener.  Y no quiero tenerlos, quiero ... <br><br>  <b>Z:</b> - Pero al final result√≥ de todos modos. <br><br>  <b>ONU:</b> - ¬°No, no hay anfitriones!  Todo funciona en los hosts de Clickhouse. <br><br>  <b>Z:</b> - Pero, ¬øqu√© pasa con el Kittenhouse, al contrario de lo cual es - d√≥nde vive? <br><br><img src="https://habrastorage.org/webt/bn/ew/lk/bnewlk0ozew0rhhlgtdwhkhjfcu.jpeg"><br><br>  <b>ONU:</b> - En el host de Klickhouse, no escribe nada en el disco. <br><br>  <b>Z:</b> - Bueno, digamos. <br><br>  <b>Presentador:</b> - ¬øTe satisface?  ¬øPodemos dar un salario? <br><br>  <b>Z:</b> S√≠, s√≠.  De hecho, hay muchas muletas para obtener lo mismo, y ahora, la respuesta anterior sobre el tema de TCP contradice, en mi opini√≥n, esta situaci√≥n.  Se siente como si pudieras hacer todo sobre tu rodilla en mucho menos tiempo. <br><br>  <b>ONU:</b> - ¬øY por qu√© no quer√≠a usar "Kafka", porque hab√≠a muchas quejas en el telegrama "Clickhouse" en Telegram que, por ejemplo, se perdieron mensajes de "Kafka".  No de Kafka en s√≠, sino en la integraci√≥n de Kafka y Klikhaus;  o algo no se conect√≥ all√≠.  En t√©rminos generales, ser√≠a necesario que Kafka escribiera en ese momento para el cliente.  No creo que se obtenga una soluci√≥n m√°s simple y confiable. <br><br>  <b>Z:</b> - Dime, ¬øpor qu√© no intentaste algunas l√≠neas o alg√∫n autob√∫s tan com√∫n?  ¬øYa que dice que fue posible con usted asincr√≥nicamente conducir a trav√©s de la cola los registros mismos y tambi√©n obtener asincr√≥nicamente a trav√©s de la cola en respuesta? <br><br><img src="https://habrastorage.org/webt/pn/4q/sz/pn4qszihp9ejs5aoua8swthjrqk.jpeg"><br><br>  <b>ONU:</b> - ¬øSugiere qu√© colas podr√≠an usarse? <br><br>  <b>Z:</b> - Cualquiera, incluso sin una garant√≠a de que van en orden.  Cualquier Redis, RMQ ... <br><br>  <b>UN:</b> - Tengo la sensaci√≥n de que Redis probablemente no podr√° extraer ese volumen de inserci√≥n incluso en un host (en el sentido de varios servidores) que extrae Clickhouse.  No puedo confirmar esto con ninguna evidencia (no lo compar√©), pero me parece que Redis no es la mejor soluci√≥n aqu√≠.  En principio, puede considerar este sistema como una cola de mensajes improvisada, pero que es solo para "Clickhouse" <br><br>  <b>Presentador:</b> - Yuri, muchas gracias.  Propongo finalizar las preguntas y respuestas sobre esto y decir cu√°l de las personas que hicieron la pregunta nos dar√° un libro. <br><br>  <b>ONU:</b> - Me gustar√≠a darle un libro a la primera persona que hizo una pregunta. <br><br>  <b>Presentador:</b> - ¬°Genial!  Genial  Genial  Muchas gracias <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/pbbcMcrQoXw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Un poco de publicidad :) </h3><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  Ap√≥yenos haciendo un pedido o recomendando a sus amigos <a href="https://ua-hosting.company/cloudvps/nl">VPS basado en la nube para desarrolladores desde $ 4.99</a> , un <b>an√°logo √∫nico de servidores de nivel b√°sico que inventamos para usted:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">toda la verdad sobre VPS (KVM) E5-2697 v3 (6 n√∫cleos) 10GB DDR4 480GB SSD 1Gbps desde $ 19 o c√≥mo dividir el servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br>  <b>Dell R730xd 2 veces m√°s barato en el centro de datos Equinix Tier IV en Amsterdam?</b>  ¬°Solo tenemos <b><a href="https://ua-hosting.company/serversnl">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV desde $ 199</a> en los Pa√≠ses Bajos!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - ¬°desde $ 99!</b></b>  Lea sobre <a href="https://habr.com/company/ua-hosting/blog/329618/">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a href="https://habr.com/ru/post/483712/">https://habr.com/ru/post/483712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483684/index.html">PHP Digest No. 171 (1 al 13 de enero de 2020)</a></li>
<li><a href="../483686/index.html">32 consejos para un desarrollador web que quiere crecer por encima de s√≠ mismo en 2020</a></li>
<li><a href="../483688/index.html">Aproximadamente 30x Concurrency Boost en Node.js</a></li>
<li><a href="../483698/index.html">C√≥mo LoRaWAN ayuda a construir una Internet moderna de las cosas</a></li>
<li><a href="../483704/index.html">Eventos digitales en Mosc√∫ del 13 al 19 de enero</a></li>
<li><a href="../483714/index.html">Premios y concursos para proyectos innovadores. Experiencia mundial de vendedores</a></li>
<li><a href="../483716/index.html">Uso del esc√°ner de vulnerabilidades en las bibliotecas de verificaci√≥n de dependencia utilizadas en GitlabCI</a></li>
<li><a href="../483718/index.html">C√≥mo VDI est√° transformando el entorno de la oficina</a></li>
<li><a href="../483720/index.html">Lo que nos trajo Pandas 1.0</a></li>
<li><a href="../483722/index.html">Geoanal√≠tica en el comercio minorista, parte 1: automatizamos el proceso de elegir un lugar para un negocio. 2GIS + MS Azure + ML</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>