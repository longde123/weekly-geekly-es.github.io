<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüé® üî¢ üòà OSPF (primera parte) ‚óΩÔ∏è üéÑ üåê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este art√≠culo fue escrito para m√≠, de modo que, si es necesario, actualice r√°pidamente mi memoria y comprenda la teor√≠a. Decid√≠ publicarlo, tal vez se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OSPF (primera parte)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418391/"> Este art√≠culo fue escrito para m√≠, de modo que, si es necesario, actualice r√°pidamente mi memoria y comprenda la teor√≠a.  Decid√≠ publicarlo, tal vez sea √∫til para alguien, o tal vez me equivoque en algo. <br><br>  En este art√≠culo intentaremos comprender la teor√≠a del protocolo OSPF.  No profundizaremos en la historia y el proceso de creaci√≥n del protocolo; esta informaci√≥n es abundante en casi todos los art√≠culos sobre OSPF.  Intentaremos comprender con m√°s detalle c√≥mo funciona OSPF y c√≥mo crea su tabla de enrutamiento.  Es importante dar una definici√≥n general del protocolo: <br><br>  <b>OSPF</b> (Open Shortest Path First) es un protocolo de enrutamiento din√°mico basado en tecnolog√≠a de estado de enlace y utiliza el algoritmo Dijkstra para encontrar la ruta m√°s corta. <br><br>  La pregunta surge de inmediato: ¬øqu√© es la tecnolog√≠a de seguimiento de canales?  Creo que este nombre no es del todo exitoso.  Dio la casualidad de que hay dos tipos de protocolos de enrutamiento din√°mico: estado de enlace y vector de distancia.  Considere sus principios de trabajo: <br><br>  En los protocolos de vector de distancia, el enrutador reconoce la informaci√≥n de ruta a trav√©s de enrutadores conectados directamente al mismo segmento de red.  Es decir, el enrutador tiene informaci√≥n sobre la topolog√≠a solo dentro de los l√≠mites de sus enrutadores vecinos y no tiene idea de c√≥mo est√° organizada la topolog√≠a detr√°s de estos enrutadores, centr√°ndose solo en las m√©tricas.  En los protocolos de estado de enlace, cada enrutador no debe conocer f√°cilmente las mejores rutas para todas las redes remotas, sino que tambi√©n debe tener en la memoria un mapa de red completo con todas las conexiones existentes entre otros enrutadores incluidos.  Esto se logra mediante la construcci√≥n de una base especial de LSDB, pero m√°s sobre esto m√°s adelante. <br><a name="habracut"></a><br>  Entonces, comencemos con c√≥mo se construye LSDB a partir del cual el enrutador aprende sobre todas las rutas.  Construimos la topolog√≠a inicial para el estudio.  Se ve as√≠: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea4/c83/539/ea4c835392207c07ca33dd8ec883a707.jpg" alt="imagen"><br><br>  Configuraremos OSPF.  ¬øD√≥nde comienza OSPF?  C establecer un vecindario entre enrutadores: despu√©s de activar OSPF en las interfaces del enrutador, los enrutadores comienzan a enviar mensajes de saludo.  Este mensaje se env√≠a a la direcci√≥n de multidifusi√≥n: 224.0.0.5 cada 10 segundos (Hello Timer).  Primero habilitaremos OSPF en el enrutador vIOS1. <br><br>  Veamos c√≥mo se ve el paquete Hello: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ca/3bf/881/6ca3bf881cddaf569bdfb54bd3913666.jpg" alt="imagen"><br><br>  En el mensaje, es importante prestar atenci√≥n a campos como ID de √°rea, Enrutador OSPF de origen.  Cuando se inicia el proceso OSPF, se selecciona la ID del enrutador, que es necesaria para identificar el enrutador entre otros enrutadores OSPF.  Las reglas para elegir este par√°metro son las siguientes: <br><br>  1. Configurado por un comando especial de identificaci√≥n de enrutador ABCD - en formato de direcci√≥n IP. <br>  2. Se configuran una interfaz de bucle invertido y varias interfaces con diferentes direcciones: <br><br><ul><li>  La direcci√≥n asignada a la interfaz de bucle invertido ser√° la ID del enrutador. </li></ul><br>  3. Configurado varias interfaces de bucle invertido con varias direcciones IP en cada una: <br><br><ul><li>  La direcci√≥n IP m√°s alta asignada a cualquiera de las interfaces de bucle invertido ser√° la ID del enrutador. </li></ul><br>  4. Configurado varias interfaces con una direcci√≥n IP en cada una: <br><br><ul><li>  La direcci√≥n IP m√°s grande de todas las interfaces activas ser√° la ID del enrutador. </li></ul><br>  Ahora pasemos al campo ID de √°rea: este es un concepto m√°s importante y fundamental en OSPF.  Para trabajar con una gran cantidad de enrutadores, OSPF utiliza zonas.  Cada una de las interfaces del enrutador debe pertenecer a cualquier zona.  En nuestra topolog√≠a, las interfaces Gi0 / 0 de los enrutadores vIOS1, vIOS2, vIOS3, vIOS4 pertenecen a la zona 0. El √°rea 0 se denomina Backbone y es el centro de todas las dem√°s zonas.  Cada otra zona debe estar conectada a la zona Backbone (todav√≠a no se considera el enlace virtual).  En un an√°lisis posterior, estos conceptos ser√°n m√°s claros. <br><br>  Entonces, activamos OSPF en vIOS1 y comenz√≥ a enviar paquetes de saludo cada 10 segundos.  Active OSPF en vIOS2 y vea c√≥mo se establecen las relaciones entre vecinos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c3/721/8d4/9c37218d473f4f96d9c762300ed21bd1.jpg" alt="imagen"><br><br>  Entonces, monitoreamos cuidadosamente la secuencia de mensajes.  Primero, Hello env√≠a solo el enrutador 1.1.1.1 (192.168.1.1), tan pronto como habilitemos OSPF en 192.168.1.2, se enviar√° un paquete Hello.  vIOS1 y vIOS2 recibir√°n paquetes Hello entre s√≠ y para que el vecindario tenga lugar, es importante que los siguientes par√°metros sean los mismos en la configuraci√≥n de OSPF en ambos enrutadores: <br><br><ul><li>  Intervalo de saludo: frecuencia de env√≠o de mensajes de saludo </li><li>  Intervalo muerto del enrutador: el per√≠odo de tiempo despu√©s del cual el vecino se considera no disponible si no hubo saludo. </li><li>  ID de √°rea: el vecindario solo se puede establecer a trav√©s de interfaces en una zona. </li><li>  Autenticaci√≥n: la contrase√±a utilizada para la autenticaci√≥n y el tipo de autenticaci√≥n, si existe. </li><li>  Indicador de √°rea de c√≥digo auxiliar: un indicador opcional que se establece en todos los enrutadores que pertenecen al √°rea de c√≥digo auxiliar </li></ul><br>  Si observa el paquete Hello que se muestra arriba, todos estos par√°metros se indican en el paquete Hello.  Tan pronto como uno de los enrutadores (vIOS1) reciba un nuevo paquete Hello y verifique todas las condiciones, enviar√° inmediatamente un paquete Hello donde indicar√° la direcci√≥n del nuevo enrutador (vIOS2) en el campo Vecino activo, vIOS2 se recibir√° y se ver√° en el campo de vecinos, agregar√° vIOS1 a los vecinos y enviar√° el paquete de unidifusi√≥n a 192.168.1.1 (vIOS1), donde lo indicar√° como vecino.  Por as√≠ decirlo, se han convertido en vecinos y ahora comienza la diversi√≥n: el intercambio de informaci√≥n y la construcci√≥n de la base LSDB.  Para el establecimiento del barrio, le aconsejo que lea el siguiente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> . <br><br>  La base LSDB contendr√° informaci√≥n sobre rutas y esta LSDB despu√©s del establecimiento del vecindario debe ser id√©ntica en todos los enrutadores dentro de la misma zona.  Y, en primer lugar, los enrutadores despu√©s de establecer un vecindario comienzan el proceso de sincronizaci√≥n de sus bases de datos entre s√≠ (vIOS1 con vIOS2).  Como puede ver, todo comienza con el intercambio de mensajes DB Descripci√≥n (DBD).  Para que quede m√°s claro, hablemos sobre los tipos de mensajes que usa OSPF: <br><br><ul><li>  Hola: sol√≠a descubrir vecinos, verificar par√°metros, construir relaciones de vecindad con ellos y monitorear la disponibilidad. </li><li>  Descripci√≥n de la base de datos (DBD): comprueba el estado de la sincronizaci√≥n de la base de datos en los enrutadores. </li><li>  Solicitud de estado de enlace (LSR): solicita registros espec√≠ficos sobre el estado de los canales del enrutador al enrutador para la sincronizaci√≥n. </li><li>  Actualizaci√≥n de estado de enlace (LSU): env√≠a registros de estado de canal espec√≠ficos en respuesta a una solicitud. </li><li>  Acuse de recibo de estado de enlace (LSAck): acusa recibo de otros tipos de paquetes. </li></ul><br>  Tambi√©n es importante introducir un concepto como LSA: <br><br>  <b>Anuncio de estado de enlace (LSA)</b> : una unidad de datos que describe el estado local de un enrutador o red.  Muchas de las LSA que describen enrutadores y redes forman una Base de datos de estado de enlace (LSDB).  LSDB consta de varios tipos de LSA.  Muy detallado sobre cada LSA est√° escrito en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> art√≠culo.  Los mensajes DBD usan muchos indicadores para determinar el estado de sincronizaci√≥n, y estos mensajes contienen informaci√≥n sobre su propia base de datos.  Es decir, vIOS1 informa en estos mensajes que en mi base de datos hay informaci√≥n sobre redes como 192.168.0 / 24, 1.1.1.0/24 (LSA Tipo 1), y vIOS2 a su vez informa que tiene registros sobre Redes: 192.168.2.0/24, 2.2.2.0/24 (LSA Tipo 1).  Despu√©s de recibir mensajes DBD, cada enrutador env√≠a LSAck en confirmaci√≥n del mensaje recibido y luego compara la informaci√≥n en la base de datos vecina con la suya.  Si se descubre que no hay informaci√≥n disponible, el enrutador env√≠a una Solicitud LS, donde solicita informaci√≥n completa sobre cualquier LSA.  Por ejemplo, vIOS1 solicit√≥ LS Request de vIOS2, vIOS2 responde con LS Update, que ya contiene informaci√≥n detallada sobre cada ruta.  A continuaci√≥n se muestra la actualizaci√≥n de LS: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a79/2cc/672/a792cc672c63e0a95c5b17951567b565.jpg" alt="imagen"><br><br>  Como puede ver, en esta publicaci√≥n, vIOS2 habla sobre las subredes que conoce y la informaci√≥n asociada con ellas.  Adem√°s, vIOS1 habla sobre su LSDB.  Y al final, los enrutadores tienen el mismo LSDB.  Una vez que se completa el proceso, se inicia el algoritmo de Dijkstra (Shortest Path First).  Calcula todas las rutas conocidas de LSDB y pone lo mejor de ellas en la tabla de enrutamiento.  El mejor con la m√©trica m√°s baja, pero m√°s sobre eso m√°s adelante. <br><br>  Pensemos en la pregunta, ¬øqu√© sucede si activamos OSPF en vIOS3?  Dado que vIOS3 tendr√° que construir LSDB y sincronizarlo con otros enrutadores, surge la pregunta con qui√©n exactamente sincronizar.  Con vIOS1 o vIOS2?  Con cada uno individualmente?  ¬øQu√© tan √≥ptimo es esto?  Por lo tanto, en OSPF existe un enrutador designado por DR.  Presentamos este concepto: <br><br>  <b>Enrutador dedicado (enrutador designado, DR)</b> : administra el proceso de distribuci√≥n de LSA en la red.  Cada enrutador de red establece una relaci√≥n de vecindad con DR.  El DR, el enrutador que detect√≥ este cambio, env√≠a la informaci√≥n sobre los cambios en la red, y el DR es responsable de garantizar que esta informaci√≥n se env√≠e a los otros enrutadores de la red. <br><br>  En otras palabras, si aparece un nuevo enrutador en el segmento de red, sincronizar√° su LSDB con DR.  Tambi√©n es importante tener en cuenta que no solo son nuevos, sino que todos los dem√°s enrutadores informar√°n al DR sobre esto cuando la red cambie o aparezca una nueva ruta, y el resto tomar√° esta informaci√≥n del DR.  Pero entonces surgen preguntas: ¬øqu√© suceder√° si DR falla?  ¬øC√≥mo se selecciona DR? <br><br>  Cuando falla, se debe seleccionar un nuevo DR.  Se deben formar nuevas relaciones de vecindad y, hasta que las bases de datos del enrutador est√©n sincronizadas con la nueva base de datos de DR, la red no estar√° disponible para el reenv√≠o de paquetes.  Para eliminar este inconveniente, seleccione BDR - Enrutador designado de respaldo: <br><br>  <b>Enrutador designado de respaldo (BDR).</b>  Cada enrutador de red establece una relaci√≥n de vecindad no solo con DR, sino tambi√©n con BDR.  DR y BDR tambi√©n establecen relaciones de vecindad entre s√≠.  Cuando DR falla, BDR se convierte en DR y realiza todas sus funciones.  Como los enrutadores de red han establecido relaciones de vecindad con los BDR, se minimiza el tiempo de indisponibilidad de la red.  Por lo tanto, en nuestra red obtenemos no solo DR, sino tambi√©n BDR.  Otros enrutadores recibir√°n e informar√°n informaci√≥n relevante sobre la red solo a trav√©s de ellos.  ¬°DR y BDR solo se pueden seleccionar dentro de un segmento, no en una zona!  Es decir, para los enrutadores vIOS1, vIOS2, vIOS3, vIOS4, se seleccionar√° un DR y BDR, y, por ejemplo, entre vIOS y vIOS1 su DR y BDR se determinar√°n en relaci√≥n con su segmento de red, incluso si est√°n en la misma √Årea 0. Para la comunicaci√≥n con DR y BDR, los enrutadores usan una direcci√≥n de multidifusi√≥n de 224.0.0.6. <br><br>  La siguiente pregunta es: ¬øC√≥mo se selecciona DR / BDR?  Se aplican los siguientes criterios: <br><br><ol><li>  DR: interfaz OSPF enrutador de m√°xima prioridad. </li><li>  BDR: enrutador con la segunda prioridad m√°s alta de la interfaz OSPF. </li><li>  Si las prioridades de las interfaces OSPF son iguales, se utiliza la ID de enrutador m√°s alta para realizar la selecci√≥n.  Como dijimos, los enrutadores definen su ID de enrutador.  Al principio, cuando OSPF se lanz√≥ en vIOS1 y vIOS2, adem√°s de establecer un vecindario, tambi√©n tuvieron lugar elecciones DR / BDR.  VIOS2 con ID - 2.2.2.2 gan√≥ en esta disputa, cuando vIOS1 ten√≠a ID - 1.1.1.1.  vIOS1 fue seleccionado como BDR.  Es importante tener en cuenta que el proceso de selecci√≥n de DR y BDR no ocurre inmediatamente despu√©s de recibir los primeros paquetes de saludo del segundo enrutador.  Para hacer esto, hay un temporizador especial igual al Intervalo muerto del enrutador: 40 segundos.  Si durante este tiempo no se recibe un paquete de saludo con la mejor ID, se realizar√° una selecci√≥n basada en los paquetes de saludo existentes. </li></ol><br>  Solo ahora podemos volver a la pregunta: ¬øqu√© suceder√° si activamos OSPF en vIOS3?  Despu√©s de activar OSPF, vIOS3 comenzar√° a enviar y escuchar paquetes Hello.  Recibir√° paquetes Hello de vIOS1 y vIOS2, que indicar√°n qu√© enrutadores son DR y BDR y comprender√°n con qui√©n debe sincronizar LSDB.  Es importante tener en cuenta que cuando aparece un enrutador con una mejor ID, DR / BDR no cambia hasta que uno de ellos falla.  Despu√©s de eso, vIOS3 comienza a sincronizar su LSDB con estos enrutadores. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8e/8b2/35a/f8e8b235a0eb24d311d6b745dac5910e.jpg" alt="imagen"><br><br>  Despu√©s de recibir nueva informaci√≥n de vIOS3, el DR env√≠a mensajes de actualizaci√≥n de LS a todos los enrutadores a la direcci√≥n 224.0.0.5, a los cuales otros enrutadores, despu√©s de haber recibido un paquete, env√≠an el acuse de recibo de LS al DR, pero a la direcci√≥n 224.0.0.6 (direcci√≥n para DR / BDR). <br><br>  Seg√∫n el mismo esquema, tambi√©n conectamos vIOS4.  Despu√©s de la sincronizaci√≥n, todos los enrutadores tienen el mismo LSDB.  Veamos c√≥mo se ven los estados vecinos de vIOS3.  Mostrar comando ip ospf neighbour: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf2/3eb/51f/bf23eb51f7a7ab94f64be8726dae9370.jpg" alt="imagen"><br><br>  Como podemos ver, DR es 2.2.2.2, BDR es 1.1.1.1 y 2WAY / DROTHER se selecciona con vIOS4.  Los estados vecinos se mencionaron <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">anteriormente</a> . <br><br>  Y aqu√≠ est√°n los estados vecinos en vIOS1 con el vecindario establecido con vIOS: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f3c/583/7e7/f3c5837e7b1d99243357857cc4cb1352.jpg" alt="imagen"><br><br>  Como puede ver, √©l tiene dos DR porque tiene un vecino en otro segmento de la red. <br><br><h3>  Multizona </h3><br>  Considere c√≥mo funciona OSPF cuando se utilizan m√∫ltiples zonas.  Cambie nuestra topolog√≠a agregando nuevos enrutadores: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54c/b16/f0c/54cb16f0c9293e15b65544b3b89573a4.jpg" alt="imagen"><br><br>  Para comenzar, configuraremos OSPF en vIOS1 y vIOS para que sus interfaces Gi0 / 1 en vIOS y vIOS1 est√©n en la zona 1. Veamos qu√© cambios.  vIOS1 ahora tiene interfaces tanto en el √Årea 0 (Gi0 / 0) como en el √Årea 1 (Gi0 / 0).  Tal enrutador se llama ABR - Area Border Router (a continuaci√≥n damos una definici√≥n m√°s correcta de ABR).  ABR enviar√° informaci√≥n de ruta de una zona a otra.  Esto se hace a trav√©s de LSA Tipo 3: <br><br>  <b>Tipo 3 LSA: resumen de red LSA</b> : anuncio resumido del estado de los canales de red: <br><br><ul><li>  Anuncio difundido por enrutadores perimetrales </li><li>  El anuncio describe rutas a redes fuera del √°rea local </li><li>  Contiene informaci√≥n sobre redes y el costo de la ruta a estas redes, pero no env√≠a informaci√≥n sobre la topolog√≠a de la red. </li><li>  Por defecto, el enrutador de borde env√≠a un anuncio separado para cada red que conoce.  Si es necesario, en la red ABR se puede resumir </li><li>  ID del estado del enlace: n√∫mero de red de destino. </li></ul><br>  En esencia, entre zonas, el principio de funcionamiento del protocolo se asemeja al del protocolo de vector de distancia, transmitiendo solo informaci√≥n de ruta con m√©tricas.  Aqu√≠ est√° la Actualizaci√≥n LS de vIOS1 en el √Årea 0, que contiene 3 piezas LSA Tipo 3: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f3/681/fa8/3f3681fa87bb1a94778d4bec031f37a1.jpg" alt="imagen"><br><br>  En esencia, la estructura de LSA Tipo 3 no es muy diferente de LSA Tipo 1, pero afectan el protocolo de diferentes maneras.  Cuando se recibe un LSA actualizado o si se pierde alg√∫n LSA Tipo 1 y 2, se reinicia el SPF (algoritmo de ruta m√°s corta) y se vuelve a calcular el LSDB. <br><br>  Al recibir un LSA Tipo 3, este proceso no ocurre: se obtiene una ruta con una m√©trica en LSA Tipo 3. Este LSA almacena datos a trav√©s de los cuales se recibi√≥ ABR una ruta determinada (ABR se especifica en el campo Enrutador de publicidad) y una m√©trica para lograr este ABR ya disponible en LSDB.  Por lo tanto, la m√©trica de LSA Tipo 3 se resume con la m√©trica de la ruta a ABR y obtenemos la ruta finalizada sin reiniciar el SPF.  Este proceso se llama <b>c√°lculo de SPF parcial</b> .  Esto es bastante importante porque en redes grandes, los tama√±os de LSDB pueden ser bastante grandes y ejecutar SPF a menudo no es bueno.  Adem√°s, la creaci√≥n de LSA Tipo 3 sugiere que cambiar y volver a calcular LSDB es un √°rea.  ABR solo informa que con alguna ruta lo que ha cambiado. <br><br>  Tambi√©n es importante tener en cuenta que cualquier ruta desde una zona distinta de cero a cualquier zona distinta de cero pasa por el √Årea 0. Si hay un ABR, no se puede conectar al √Årea 0 (excluimos la opci√≥n con enlace virtual).  El √Årea 0 es el n√∫cleo que conecta todas las otras zonas y proporciona enrutamiento entre las zonas.  La definici√≥n de ABR se ve as√≠: <br><br>  <b>Enrutador de borde (enrutador de borde de √°rea, ABR)</b> : conecta una o m√°s zonas a la zona troncal y act√∫a como una puerta de enlace para el tr√°fico entre zonas.  Un enrutador de borde siempre tiene al menos una interfaz en la zona troncal.  Para cada zona adjunta, el enrutador mantiene una base de datos de estado de canal separada. <br>  Nos ocupamos del establecimiento del barrio, la creaci√≥n de LSDB y SPF, con la zona habitual.  Ahora veamos la convergencia y la respuesta de OSPF a los cambios en la topolog√≠a. <br><br>  Veamos nuestra topolog√≠a e imaginemos que vIOS3 dej√≥ de funcionar (el estado de los canales no ha cambiado).  Ayudar√° a reconstruir la topolog√≠a del temporizador de intervalo muerto: 40 segundos.  Si durante este intervalo, el enrutador no recibe un paquete de saludo de un vecino, entonces el vecindario se colapsa.  En nuestro caso, DR enviar√° LS Update con LSA Tipo 2, lo que indica que no hay vIOS3 entre los enrutadores conectados, esto har√° que SPF se inicie y vuelva a contar LSDB sin LSA recibido de vIOS3.  Es importante tener en cuenta que en un enrutador vIOS4 normal, incluso el agotamiento del temporizador de intervalo muerto y la p√©rdida de proximidad a vIOS3 no conduce a un nuevo c√°lculo de la topolog√≠a, es el mensaje de actualizaci√≥n de LS con LSA Tipo 2 que inicia este proceso. <br><br>  <b>Tipo 2 LSA - Red LSA -</b> Anuncio de estado del <b>enlace de red</b> : <br><br><ul><li>  Distribuido por DR en redes de acceso m√∫ltiple </li><li>  La red LSA no se crea para redes en las que no se selecciona DR </li><li>  Distribuido solo dentro de una zona </li><li>  ID de estado de enlace: direcci√≥n IP de la interfaz DR </li></ul><br>  Por lo tanto, ignorar los datos que han dejado de funcionar ocurre con la ayuda de este mensaje.  Es esta indicaci√≥n de vecinos la que desencadena el descarte de rutas irrelevantes. <br><br>  Vuelva a encender vIOS3 y vuelva a establecer el vecindario.  El pr√≥ximo experimento ser√° una reacci√≥n a la desactivaci√≥n de la interfaz Gi0 / 1 en vIOS3.  Tan pronto como vIOS3 detecta la ca√≠da de enlaces, env√≠a instant√°neamente LS Update a DR a la direcci√≥n 224.0.0.6, donde se informa que ciertas rutas han ca√≠do al establecer una bandera en LSA - LS Age igual a 3600 segundos.  Para LSDB, esta es la edad m√°xima y todos los LSA con edad m√°xima no se tienen en cuenta en SPF, por lo que no estar√°n en la tabla de enrutamiento.  La pregunta es: cuando Age LSA llega naturalmente a Max Age, ¬øqu√© sucede?  Para hacer esto, OSPF tiene LSRefreshTime: igual a la mitad de la edad m√°xima, cada 1800 segundos se env√≠a LS Update desde el enrutador para actualizar los datos del temporizador: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43a/dd0/8c4/43add08c439f2826bb85e434a2280ae5.jpg" alt="imagen"><br><br>  Adem√°s, DR despu√©s de haber procesado esta actualizaci√≥n LS, env√≠a LS LS a todos los otros enrutadores a la direcci√≥n 224.0.0.5.  Tan pronto como los enrutadores obtienen nueva informaci√≥n, env√≠an LSAck.  Esto asegura una buena convergencia en OSPF. <br><br><h3>  Elegir la mejor ruta </h3><br>  El enrutador selecciona la mejor ruta en funci√≥n del valor m√©trico m√°s bajo.  Sin embargo, OSPF tambi√©n tiene en cuenta varios otros factores al elegir una ruta.  En este caso, la fuente de la ruta y su tipo son importantes.  La selecci√≥n de ruta prioritaria es la siguiente: <br><br><ul><li>  Rutas internas de una zona (dentro del √°rea) </li><li>  Rutas entre zonas (interarea) </li><li>  Rutas externas tipo 1 (E1) </li><li>  Rutas externas tipo 2 (E2) </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aunque el costo de la ruta E2 no cambia cuando se transfiere por zonas (no se agrega el costo de la ruta al ASBR), cuando el costo de las rutas E2 coincide, se compara el costo de la ruta al ASBR que anuncia la ruta. La m√©trica se tiene en cuenta cuando tiene que elegir entre las rutas del mismo tipo. Como m√©trica, se utiliza el concepto de costo. Se calcula mediante la f√≥rmula: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">costo = ancho de banda de referencia / ancho de banda del enlace. Ancho de banda de referencia: la base del ancho de banda. Por defecto, en Cisco es igual a 100Mbit. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prevenci√≥n ABR Loop.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como dijimos anteriormente, entre zonas, el principio de operaci√≥n de OSPF es similar al protocolo de vector de distancia. </font><font style="vertical-align: inherit;">Usando los mecanismos de prevenci√≥n de bucle, podemos lograr que se elija la ruta no √≥ptima. </font><font style="vertical-align: inherit;">Por ejemplo, entre zonas hay una regla como Split Horizon a partir de protocolos de vector de distancia. </font><font style="vertical-align: inherit;">Considere esto como un ejemplo, si cambiamos nuestra topolog√≠a en el borde de las zonas 0 y 4 de la siguiente manera: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/318/d56/328/318d56328823c86abf8df0b5439e76b7.jpg" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entonces obtenemos que vIOS18 elegir√° una ruta no √≥ptima con la m√©trica 100 a trav√©s de la interfaz Gi0 / 0. </font><font style="vertical-align: inherit;">Esto sucede debido al hecho de que vIOS18 no tendr√° en cuenta el LSA Tipo 3 recibido no de la zona 0. Adem√°s, la regla anterior proh√≠be transferir este LSA Tipo 3 a la zona 0.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418391/">https://habr.com/ru/post/es418391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418381/index.html">Novedades de DevTools en Chrome Versi√≥n 68</a></li>
<li><a href="../es418383/index.html">Animaciones de Android basadas en Kotlin y RxJava</a></li>
<li><a href="../es418385/index.html">C√≥mo ensambl√© una computadora para juegos antiguos</a></li>
<li><a href="../es418387/index.html">Di√°logo f√≠sico sobre el alma.</a></li>
<li><a href="../es418389/index.html">RabbitMQ vs. Kafka: uso de Kafka en aplicaciones orientadas a eventos</a></li>
<li><a href="../es418393/index.html">[Viernes] C√≥mo vimos Web 3D</a></li>
<li><a href="../es418395/index.html">Elon Musk: los generadores locales de campo electromagn√©tico proteger√°n a los colonos en Marte</a></li>
<li><a href="../es418397/index.html">Gesti√≥n del viernes: seminarios web gratuitos de Skillbox</a></li>
<li><a href="../es418399/index.html">En la ola de Selectel FM</a></li>
<li><a href="../es418401/index.html">C√≥mo no me convert√≠ en ti: una publicaci√≥n de amor para los administradores de sistemas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>