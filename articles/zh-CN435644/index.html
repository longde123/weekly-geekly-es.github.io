<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🏭 🔳 😠 动物园AFL移相器 🔭 🤙🏿 👃🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="关于哈布雷（Habré）的文章已经有好几次提出了美国模糊吊舱（AFL）（ 1，2 ）的话题。 但是在本文中，我们不会讨论经典的AFL，而是会讨论它的辅助实用程序及其修改，我们认为这可以显着提高模糊测试的质量。 如果您有兴趣学习如何升级AFL并寻找更快，更多的漏洞，欢迎使用！ 

 什么是AFL，为什...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>动物园AFL移相器</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/435644/"><img src="https://habrastorage.org/webt/l4/vc/qr/l4vcqrdnz0vgsseyssmztrfrvdg.jpeg" alt="图片"><br><br> 关于哈布雷（Habré）的文章已经有好几次提出了美国模糊吊舱（AFL）（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">1，2</a> ）的话题。 但是在本文中，我们不会讨论经典的AFL，而是会讨论它的辅助实用程序及其修改，我们认为这可以显着提高模糊测试的质量。 如果您有兴趣学习如何升级AFL并寻找更快，更多的漏洞，欢迎使用！ <br><a name="habracut"></a><br><h1> 什么是AFL，为什么这么好 </h1><br>  AFL-覆盖率指导的模糊器或基于反馈的模糊器。 您可以从诸如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Fuzzing：Art，Science和Engineering</a>的凉爽文章中了解有关这些概念的更多信息。 如果我们总结有关AFL的信息，那么我们可以这样说： <br><ul><li> 工具可执行文件以收集覆盖率信息 </li><li> 突变输入以最大化覆盖范围 </li><li> 重复上一步以查找程序崩溃。 <ul><li> 在实践中，被证明是非常有效的 <ul><li> 很好用 </li></ul></li></ul></li></ul><br><br> 在图形上，这可以表示如下： <br><br><img src="https://habrastorage.org/webt/iq/5z/au/iq5zaub6qftefx3x_q5te6d6guo.png" alt="图片"><br><br> 如果您不知道什么是AFL，那么我们建议您： <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">项目官方页面</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AFL培训</a> -短暂地学习AFL </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-demo-</a>有关如何使用AFL模糊C ++程序的简单演示 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-cve-</a>使用AFL发现的漏洞的集合（自2017年以来未更新） </li><li> 在此可以找到AFL在程序组装过程中添加到程序中的事实<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>模糊网络应用程序的一些有用技巧 </li></ol><br> 在撰写本文时，AFL的最新版本为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2.52b</a> 。  Fazzer一直在积极开发，随着时间的推移，一些第三方开发已包含在AFL的主要分支中，而与它们本身无关。 当前可以识别几种有用的辅助工具-下一部分列出了它们。 <br><br><div class="spoiler">  <b class="spoiler_title">比赛Rode0day</b> <div class="spoiler_text"> 另外，值得一提的是每月一次的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rode0day</a>竞赛，在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">移相</a>器之间存在竞争，这些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">移相</a>器将在预先准备好的可以访问源代码且没有源代码的情况下更快地发现漏洞。 总的来说，是各种修改和AFL分叉的对峙。 <br></div></div><br> 但是，一些AFL用户<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">注意到</a>移相器Michal Zalewski的作者进行了一场竞选活动，以支持他的想法，因为最新的更改是在2017年11月5日发布的。 据称这与他离开Goog​​le和新项目有关。 在这方面，人们开始独立收集并制作最新版本2.52b的补丁。 <br><br><img src="https://habrastorage.org/webt/fy/00/xa/fy00xat3cumh3iq9a5biou30czi.png" alt="图片"><br><br>  AFL还提供不同的选项和派生工具，它们可以使Python，Go，Rust，OCaml，GCJ Java，内核syscall甚至整个VM变得模糊。 <br><br><div class="spoiler">  <b class="spoiler_title">其他PL的AFL</b> <div class="spoiler_text"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-python-afl-</a>适用于Python。 <br>  <a href="">-afl.rs-</a>用于在Rust中模糊程序 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-afl-fuzz-js</a> -JavaScript的afl-fuzz。 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Java-</a> AFL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-</a> Java的AFL模糊测试 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-kelinci</a> -Java的另一个相位器，其中包含有关此主题的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-javan-warty-pig</a> -JVM的类似于AFL的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">模糊器</a> 。 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-afl-swift-在Swift上</a>模糊程序 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-ocamlopt-afl-</a>适用于OCaml。 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-sharpfuzz-</a>基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl</a>的.net <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">模糊工具</a> 。 <br></div></div><br><h1> 辅助工具 </h1><br> 在本节中，我们选择了用于AFL的各种脚本和工具，并将它们分为几类： <br><br>  <u>加工果肉</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-utils-</a>一组实用程序，用于自动处理/分析崩溃并最小化测试用例。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-crash-analyzer-</a>另一个AFL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">崩溃分析器</a> 。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">fuzzer-utils-</a>一组用于分析结果的脚本。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">atriage</a>是一种简单的分类工具。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-kit-</a>用python afl-cmin重写。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AFLize</a>是一种可自动生成友好的Debian软件包构建工具。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-fid-</a>一组用于处理输入数据的工具。 </li></ul><br>  <u>代码覆盖率</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-cov-</a>提供人类可读的覆盖率数据。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">计数呼叫</a> -比率得分。 该脚本计算二进制中已检测块的数量。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-sancov-</a>类似于afl-cov，但使用了clang消毒剂。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">covnavi</a>是Cisco Talos集团的代码覆盖和分析脚本。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LAF LLVM Passes</a>是afl的一些补丁集合，这些补丁会修改代码以使模糊测试人员更容易通过分支 </li></ul><br>  <u>几个脚本以最小化测试用例</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-pytmin</a> -afl-tmin的包装器，它试图通过使用多个CPU内核来加快最小化测试用例的过程。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-ddmin-</a> mod-基于ddmin算法的afl-tmin的变体。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">halfempty</a>是一种基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">并行</a>化的快速实用程序，可最大程度地减少Tavis Ormandy的测试用例。 </li></ul><br>  <u>分布式启动</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">disfuzz-afl-afl的</a>分布式模糊测试。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AFLDFF</a>是使用AFL进行分布式模糊<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">测试</a>的框架。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-launch</a>是用于启动许多afl实例的工具。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-mothership-</a>在AWS云上管理并启动多个同步的AFL模糊器。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">云端afl</a>是另一个在AWS中运行afl的脚本。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VU_BSc_project-</a>使用libFuzzer和AFL模糊测试开源库。 </li></ul><br> 另外，最近在该主题上发表了一篇非常不错的文章<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“将AFL扩展到256线程计算机”</a> ，它描述了在256线程上启动AFL。 <br><br>  <u>部署，管理，监控，报告</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-other-arch-</a>一组补丁和脚本，可轻松添加对AFL中各种（非x86）体系结构的支持。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-trivia-</a>一些简化AFL管理的小脚本。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-monitor-</a>用于监视AFL操作的脚本。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-manager-</a>用于管理多afl的python网络服务器。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-tools-</a>具有afl-latest，afl-dyninst和Triforce-afl的docker映像。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-</a> remote-用于远程afl实例管理的Web服务器。 </li></ul><br><h1>  AFL修改 </h1><br>  AFL极大地影响了漏洞搜索社区和模糊行业本身。 随着时间的流逝，最初的AFL启发了他的各种修改，这也就不足为奇了。 在本节中，我们将考虑它们。 与原始AFL版本相比，每种修改在不同情况下都有其优点和缺点。 <br><br> 只需说一下，如果安装存在问题或不想花费时间-几乎所有修改都可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">hub.docker.com</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">找到</a> <br><br> 怎么了 <br><br><ul><li> 提高速度和/或代码覆盖率 <br><ul><li> 演算法 </li><li> 环境 <br><ul><li> 操作系统 </li><li> 铁 </li></ul><br></li></ul><br></li><li> 在没有源代码的条件下工作 <br><ul><li> 代码仿真 </li><li> 代码检测 <br><ul><li> 静态的 </li><li> 动态的 </li></ul><br></li></ul><br></li></ul><br>  <u>内置AFL模式</u> <br><br> 在继续讨论各种AFL修改和派生之前，有必要讨论两个曾经也是修改的重要模式，并最终成为内置模式。 这是Syzygy模式和Qemu模式。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Syzygy</a>模式-是仪器instrument.exe中的操作模式 <pre><code class="bash hljs">instrument.exe --mode=afl --input-image=test.exe --output-image=test.instr.exe</code> </pre> 对于此模式，有必要：用AFL静态重写PE32二进制文件，需要使用符号，需要其他开发人员才能使WinAFL内核知道。 <br><br>  Qemu模式-在QEMU下如何工作可在此处<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ AFL模糊器的内部-QEMU仪器”中找到</a> 。 版本1.31b的上游AFL中提供了对使用QEMU处理二进制文件的支持。  Afl qemu模式可将二进制代码的检测功能添加到二进制翻译引擎qemu tcg（微型代码生成器）中。 为此，afl有一个qemu构建脚本，该脚本可下载特定（2.10.0）版本的qemu的源代码，在其上强加几个小补丁，并针对给定的体系结构进行编译。 此后，将返回afl-qemu-trace文件，它实际上是用户模式（仅ELF可执行文件的仿真）qemu仿真。 因此，您可以将模糊处理与有关elf二进制文件的反馈一起使用，并可以使用qemu支持的许多不同体系结构。 此外，您还可以获得所有很棒的afl工具，从一个方便的屏幕开始，显示有关当前会话的信息，然后以afl-analyze等高级功能结束。 但是请记住，您还会获得qemu限制。 同样，例如，如果文件是由使用SoC硬件功能的工具链编译的，则在其上启动了Binar并且qemu不支持该二进制功能，一旦遇到特定指令或例如使用特定的MMIO，模糊处理就会中断。 <br><br>  qemu模式也有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一个</a>有趣的分支，由于使用了TCG代码和缓存，速度提高了3到4倍。 <br><br>  <u>前叉</u> <br><br>  AFL前叉的外观主要与经典AFL本身的操作算法的变化和改进相关。 <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-cygwin</a>尝试使用Cygwin将经典AFL移植到Windows。 不幸的是，这种尝试非常繁琐，缓慢，可以说放弃了开发。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AFLFast</a> （将AFL扩展为Power Schedules） <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-AFL</a>的第一个分支之一，添加了各种启发式方法，这使它在短期内可以有更多发展。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FairFuzz</a>是AFL的扩展程序，其目的是尝试将更多的时间花在稀有分支上。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AFLGo</a>是AFL的扩展，它主要用于特定代码部分的目标实现，而不是程序代码的一般覆盖范围。 这可以用于测试补丁或新添加的代码部分。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PerfFuzz</a>是AFL扩展，用于查找可能会减慢程序速度的测试用例。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pythia</a>是AFL的扩展，其目的是在发现新路径的难度方面，将预测元素添加到定相过程中。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安哥拉（Angora）</a>是最近发布的用铁锈书写的模糊器之一。 使用他的新策略进行突变并扩大覆盖范围。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Neuzz-</a>使用神经网络进行模糊<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">测试</a>的尝试。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">UnTracer-AFL-</a>与UnTracer的afl集成，用于高效跟踪。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Qsym-</a>专为混合模糊测试而设计的实用Concolic执行引擎。 实际上，它是一个符号执行引擎（主要组件实现为intel引脚插件），与afl结合使用可实现混合模糊测试。 这是基于反馈的模糊测试主题的进一步发展，值得单独讨论。 他的主要优点是，他可以非常快速地（相对于其余部分）执行concolic执行。 这是由于命令的本机执行而没有代码的中间表示，摆脱了快照机制和许多试探法。 它使用旧的Intel引脚（由于libz3和其他DBT之间存在许多支持问题），并且当前可以与elf x86和x86_64体系结构一起使用。 </li></ul><br> 值得一提的是，有大量与实施新方法，模糊技术有关的学术著作，这些都是采用和修改AFL的方法。 除了白皮书之外，没有其他可用的内容，因此我们甚至没有提及此类实现。 如果您有兴趣，那么他们很容易谷歌。 例如，后者是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CollAFL：路径敏感模糊</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">EnFuzz</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Smart Greybox Fuzzing</a> ，afl的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ML</a> 。 <br><br>  <u>基于Qemu的修改</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TriforceAFL</a> -AFL / QEMU具有完整的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">系统</a>仿真功能。 来自nccgroup的叉子。 允许在qemu模式下模糊整个操作系统。 通过特殊指令（aflCall（0f 24））实现，该指令已添加到QEMU x64 CPU中。 不幸的是，它不再受支持，其中afl的最新版本是2.06b。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TriforceLinuxSyscallFuzzer-</a>模糊化Linux系统调用。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-qai</a>是QEMU Augmented Instrumentation（qai）的一个小型演示项目。 </li></ul><br><br>  <u>基于KLEE的修改</u> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">kleefl-</a>用于通过符号执行生成测试用例（在大型程序上非常慢）。 <br><br>  <u>基于独角兽的修改</u> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-unicorn-</a>允许您模糊代码段，并在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Unicorn Engine</a>上进行仿真。 我们还在实践中成功地使用了这种AFL变体，即在一个RTOS的代码部分中使用了该代码，该代码是在SOC上执行的，不可能使用QEMU模式。 建议在没有源（无法组装独立的二进制文件进行解析器分析）并且程序不直接接受输入数据（例如，它们被加密或像一个CGC二进制文件中表示信号样本）时使用此修改。反向查找拟议的places-functions，在该函数中以便于fuzzer使用的格式处理此数据，并且可以对其进行fuzzing。 这是最常见的AFL修改。 从某种意义上说，它使您可以模糊所有内容。 也就是说，它不依赖于体系结构，源代码的可用性，输入数据的格式以及二进制本身的格式（最引人注目的示例只是裸机-只是控制器内存中的部分代码）。 研究人员初步检查了这个二进制信息，并编写了一个模糊器，用于模拟解析器程序输入时的状态。 可以看出，与AFL不同，您需要对Binar进行某种研究。 对于Wi-Fi或基带之类的裸机固件，您仅需记住许多缺点： <br><br><ol><li> 有必要以某种方式本地化校验和检查。 </li><li> 必须记住，模糊器的状态是存储在内存转储中的内存的状态，这会阻止实现模糊器的某些路径。 </li><li> 不能动态访问动态内存，但是可以手动实现（也需要花费很多精力），并且它取决于RTOS（还需要事先进行调查）。 </li><li> 不模拟RTOS任务间的交互-您还可以防止模糊器找到某些路径。 </li></ol><br> 使用此修改的示例是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ afl-unicorn：模糊任意二进制代码”</a>和 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ Afl独角兽：第2部分-模糊化'不可模糊'”</a> 。 <br><br> 在继续进行基于动态二进制工具（DBI）框架的修改之前，我们立即回想起这些框架中最快的是DynamoRIO，然后是DynInst，最后是PIN。 <br><br>  <u>PIN修改</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">aflpin-</a>带有英特尔PIN仪器的AFL。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl_pin_mode-</a>通过Intel PIN实现的另一个AFL工具。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-</a> pin-带有PINtool的AFL。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NaFl</a> -AFL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">模糊器的</a> （基本核心）克隆。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PinAFL-</a>该工具的作者试图将AFL传输到Windows，以模糊已编译的二进制文件。 显然，在一晚上对风扇进行了更多操作，然后该项目无法开发。 该存储库不包含源，仅包含收集的二进制文件和启动说明。 未指定此工具所基于的AFL版本，仅支持32位应用程序。 </li></ul><br> 如您所见，有许多不同的修改，但实际上在现实生活中它们没有太多用处。 <br><br>  <u>基于Dyninst的修改</u> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-dyninst-</a>美国模糊圈+ Dyninst == AFL黑盒模糊测试。 此版本的功能是使用DynInst对最初研究的程序（不带源代码）进行静态检测（静态二进制检测，静态二进制重写），然后由经典AFL混淆，后者认为该程序是使用afl-gcc / afl构建的-g ++ / afl-as;）最后，它使我们有机会无需源代码就可以工作，并且具有非常好的性能-与本地编译相比，它的速度为0.25倍。 与QEMU相比，它具有显着的优势，即能够检测动态链接的库。 虽然QEMU仅能够检测静态链接到库的主要可执行文件。 不幸的是，现在这仅与Linux操作系统有关。 为了支持Windows，DynInst本身需要进行更改，并且该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">工作正在进行中</a> 。 <br><br> 您还可以注意这样的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">分支</a> ，它在各种功能（对AARCH64和PPC架构的支持）和速度方面都很好地发挥作用；） <br><br>  <u>基于DynamoRIO的修改</u> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">drAFL</a> -AFL + DynamoRIO =在Linux上没有源即可进行模糊测试。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-dr-基于DynamoRIO的</a>另一种实现，该实现已在Habr的开放空间上进行了详尽的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">绘制</a> 。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">afl-dynamorio</a> -vanhauser-thc的改良版（风扇，用于泵送和稳定AFL）。 他对这个版本说：“当普通的afl-dyninst崩溃了二进制文件并且qemu模式-Q不能运行时，用DynamoRIO运行AFL。” 令人高兴的是，此处添加了对ARM和AARCH64的支持。 关于性能：DynamoRIO比Qemu慢约10倍，比dyninst慢25倍-但是，比Pintool快10倍。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WinAFL</a>是Windows的afl最著名的分支。  （DynamoRIO，也有syzygy模式）。 这种修改的出现只是时间问题，因为希望在Windows下在没有源代码的应用程序上尝试AFL的愿望很多。 目前，该工具正在积极开发中，尽管使用了稍微落后的AFL代码库（在撰写本文时为2.43b），但已经发现了几个漏洞（CVE-2016-7212，CVE-2017-0073，CVE-2017- 0190，CVE-2017-11816）。 应该注意的是，主要开发人员是Google零项目团队和MSRC漏洞与缓解团队的专家，这给希望进一步积极开发该项目提供了理由。 为了实现该模糊器，开发人员已经从编译时间检测转变为使用动态检测（基于DynamoRIO），这有望减慢正在研究的软件的执行速度，但是所产生的开销（两倍）与二进制模式下的经典AFL相当。 开发人员还解决了流程启动时间长的问题，将其称为持久性模糊模式，他们选择需要模糊化的函数（通过文件中的偏移量或如果导出表中存在该函数则通过名称进行命名）并以可在循环中调用的方式对其进行检测，从而启动几个输入数据样本，而无需重新启动该过程。 最近出现了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一篇</a>有趣的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> ，研究人员展示了如何使用winafl在约50天的时间内发现约50个漏洞。 此外，几乎在WinAFL上的文章发表之前，还添加了Intel PT模式（稍后会对此进行详细介绍）-详细信息在<a href="">这里</a> 。 </li></ul><br> 高级/老练的读者可能会注意到，除了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Frida</a>以外，所有流行的检测框架都进行了修改-确实如此。 仅在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chizpurfle：针对供应商服务定制的灰色盒子Android Fuzzer中</a>找到了将Frida与AFL一起使用的唯一提及。 带有Frida的AFL版本非常有用，因为Frida很好地支持许多RISC体系结构。 <br><br>  Capstone，Unicorne，Keystone的创建者还期待着许多研究人员发布Scorpio DBI框架。 基于此框架，作者本人已经制作了模糊器（Darko），并据此成功地将其用于模糊嵌入式设备。 有关更多信息，请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">深入研究：使用代码覆盖率引导的模糊测试在嵌入式系统中查找0days</a> 。 <br><br>  <u>基于处理器硬件功能的修改</u> <br><br> 当涉及支持处理器硬件功能的AFL修改时，这主要表明可以对内核代码进行模糊处理，其次，可以对没有源代码的应用程序提高模糊处理速度。 <br><br> 而且，当然，首先，我们谈论的是处理器的硬件功能，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Intel PT</a> （处理器跟踪）。 从第六代处理器开始可用（大约从2015年开始）。 自然，为了使用以下模糊器，您将需要具有适当的Intel PT支持的硬件。 <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WinAFL-IntelPT</a>是第三方WinAFL修改，其中已使用Intel PT技术代替DynamoRIO。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">kAFL</a>是一项学术发展，旨在解决与操作系统无关的内<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">核定</a>相的覆盖率指导问题。 使用管理程序和英特尔PT技术解决了什么。 您可以从他们的白皮书<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ kAFL：OS内核的硬件辅助反馈模糊测试”中</a>了解更多信息。 </li></ul><br><h1> 结论 </h1><br> 您可能已经注意到，该主题正在积极发展中。 同时，创造力有很大的空间来创建AFL的新的，有趣的和有用的修改。 <br><br> 感谢您的关注和成功的测试！ <br><br>  <b>合著者：</b> Nikita Knizhov <br><br>  <i>PS感谢研究中心的整个团队在没有经验和帮助的情况下准备这种材料，因此不可能准备这种东西。</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN435644/">https://habr.com/ru/post/zh-CN435644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN435630/index.html">云中的网络IB：2019年的5个趋势</a></li>
<li><a href="../zh-CN435636/index.html">如何从Dota 2的专家那里学习机器学习</a></li>
<li><a href="../zh-CN435638/index.html">关于开发人员的幸福以及在哪里找到它</a></li>
<li><a href="../zh-CN435640/index.html">IT领域HR专业人员的事件摘要（2019年1月）</a></li>
<li><a href="../zh-CN435642/index.html">宾得汽车110：“相机在哪个拳头？”</a></li>
<li><a href="../zh-CN435646/index.html">NB-IoT，窄带物联网。 一般信息，技术功能</a></li>
<li><a href="../zh-CN435648/index.html">Bot从Wikipedia文章中生成教程</a></li>
<li><a href="../zh-CN435650/index.html">如何在Swift框架中嵌入C库</a></li>
<li><a href="../zh-CN435652/index.html">如何在Python脚本中不输入密码</a></li>
<li><a href="../zh-CN435654/index.html">自定义CSS属性的陷阱</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>