<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¼â€ğŸ¤ ğŸ˜© ğŸŒï¸ å¦‚ä½•ç®€åŒ–Oracleæ•°æ®åº“ç ”ç©¶ï¼šâ€œç»…å£«çš„è„šæœ¬â€é›† ğŸ‘¶ğŸ¼ ğŸ¦€ ğŸ§¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¸‹åˆå¥½ æˆ‘ä»¬æ˜¯Rostelecomæ•°æ®ç®¡ç†éƒ¨é—¨ä¹‹ä¸€çš„ç³»ç»Ÿåˆ†æå¸ˆå›¢é˜Ÿã€‚ æˆ‘ä»¬å…¬å¸æ‹¥æœ‰300å¤šç§å¼‚æ„æ•°æ®æº-å„ç§å„æ ·çš„æ•°æ®æºå¯¹äºæ”¯æŒRostelecomåœ¨æ‰€æœ‰ä¼—å¤šé¢†åŸŸçš„å·¥ä½œéƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ æˆ‘ä»¬ç ”ç©¶æ•°æ®æºï¼Œå¹¶åœ¨å¿…è¦æ—¶å°†å…¶éƒ¨åˆ†ä¸Šä¼ åˆ°å­˜å‚¨å¾ªç¯ã€‚ 


 è¡¨é¢ä¸Šçš„å¥½å¥‡å¿ƒæµæµªè€…ã€‚ å®ƒè¿˜å…·æœ‰è®¸å¤šå¼‚æ„æ•°æ®æºã€‚ å›¾ç‰‡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¦‚ä½•ç®€åŒ–Oracleæ•°æ®åº“ç ”ç©¶ï¼šâ€œç»…å£«çš„è„šæœ¬â€é›†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/442082/"> ä¸‹åˆå¥½ æˆ‘ä»¬æ˜¯Rostelecomæ•°æ®ç®¡ç†éƒ¨é—¨ä¹‹ä¸€çš„ç³»ç»Ÿåˆ†æå¸ˆå›¢é˜Ÿã€‚ æˆ‘ä»¬å…¬å¸æ‹¥æœ‰300å¤šç§å¼‚æ„æ•°æ®æº-å„ç§å„æ ·çš„æ•°æ®æºå¯¹äºæ”¯æŒRostelecomåœ¨æ‰€æœ‰ä¼—å¤šé¢†åŸŸçš„å·¥ä½œéƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ æˆ‘ä»¬ç ”ç©¶æ•°æ®æºï¼Œå¹¶åœ¨å¿…è¦æ—¶å°†å…¶éƒ¨åˆ†ä¸Šä¼ åˆ°å­˜å‚¨å¾ªç¯ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/179/59b/713/17959b71340ac8c7a82253ccca507579.png"><br>  <i>è¡¨é¢ä¸Šçš„å¥½å¥‡å¿ƒæµæµªè€…ã€‚</i>  <i>å®ƒè¿˜å…·æœ‰è®¸å¤šå¼‚æ„æ•°æ®æºã€‚</i>  <i>å›¾ç‰‡å–è‡ªtherahnuma.comã€‚</i> <br><br> åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼ŒåŒºåˆ†äº†ä¸¤ä¸ªå­ä»»åŠ¡ï¼šå®šä¹‰ä¸€ç§ç­–ç•¥ï¼Œç”¨äºæ ¹æ®æºè¡¨çš„å±æ€§ä»æºè¡¨æ”¶é›†æ•°æ®ï¼Œå¹¶å‡†å¤‡ä½œä¸ºæ•°æ®ä»“åº“â€œæ¥æ”¶æ–¹â€çš„è¡¨ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨å„ç§GUIå’Œåå‘å·¥ç¨‹å·¥å…·ã€‚ å¦å¤–ï¼Œåœ¨æ”¶é›†ä¿¡æ¯æ—¶ï¼Œç³»ç»Ÿåˆ†æå¸ˆå¼€å§‹è·å–å¯¹DBMSï¼ˆä¸»è¦æ˜¯Oracleï¼‰çš„ä¿¡æ¯è¡¨çš„è¾…åŠ©æŸ¥è¯¢æ± ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†åˆ†äº«æˆ‘ä»¬å›¢é˜Ÿä½¿ç”¨çš„æ­¤ç±»è„šæœ¬çš„â€œç»…å£«ç»„åˆâ€ã€‚ <br><a name="habracut"></a><br> é¦–å…ˆï¼Œç®€è¦åˆ—å‡ºæ‰€æœ‰è„šæœ¬ï¼š <br><br><ul><li> è®¸å¤šè„šæœ¬ä½¿ç”¨xmlaggæ¥èšåˆå­—ç¬¦ä¸²ï¼Œå› ä¸ºlistaggæ— æ³•å¤„ç†ä¸²è”å¯¼è‡´çš„å¤ªé•¿çš„å­—ç¬¦ä¸²ã€‚ <br></li><li> åœ¨é™¤â€œè¿‡ç¨‹ï¼Œå‡½æ•°å’ŒåŒ…â€ä¹‹å¤–çš„æ‰€æœ‰è„šæœ¬ä¸­ï¼Œç›®æ ‡è¡¨éƒ½æ˜¯é€šè¿‡â€œ withâ€å—ä¸­çš„è¿‡æ»¤å™¨è¡¨æŒ‡å®šçš„ã€‚ å¡«å†™æ–¹æ¡ˆåç§°å’Œè¡¨åç§°ã€‚ <br></li><li> æ¯ä¸ªè„šæœ¬éƒ½é™„å¸¦ä¸€ä¸ªæˆ–å¤šä¸ªç”¨ä¾‹ï¼Œè§„èŒƒè¯´æ˜ï¼ˆç»“æœé›†ï¼‰ä»¥åŠå·²ç”¨ç³»ç»Ÿè¡¨çš„åˆ—è¡¨ï¼ˆä»¥è¯„ä¼°åœ¨ç‰¹å®šæ•°æ®åº“ä¸Šä½¿ç”¨çš„å¯èƒ½æ€§ï¼‰ã€‚ <br></li></ul><br><h3> è„šæœ¬â€œå…³äºè¡¨çš„ä¿¡æ¯â€ </h3><br>  <i>è§„æ ¼</i> ï¼š <br><div class="scrollable-table"><table><tbody><tr><td width="250">  <b>æ å</b> <br></td><td>  <b>è¯„æ³¨</b> <br></td></tr><tr><td>  SCHEMA_NAME <br></td><td> æ•°æ®æ¶æ„åç§°ï¼ˆOWNERï¼‰ <br></td></tr><tr><td>  TABLE_NAME <br></td><td> è¡¨å <br></td></tr><tr><td> è¯„è®º <br></td><td> åœ¨æ¡Œå­ä¸Šè¯„è®º <br></td></tr><tr><td> èº«é«˜ <br></td><td> è¡¨ä¸­çš„è¡Œæ•°ï¼ˆå¤§çº¦ï¼‰ <br></td></tr><tr><td> å®½åº¦ <br></td><td> åˆ—æ•° <br></td></tr><tr><td> DATETIME_COLUMNS <br></td><td> å…·æœ‰ä¸´æ—¶æ•°æ®ç±»å‹çš„åˆ—å’ŒåŸºäºåç§°çš„åˆ—ï¼ˆå¤§æ¦‚æ˜¯æ—¶é—´æˆ³ï¼‰ï¼ˆæ¨¡å¼-ï¼…æœŸé—´ï¼…ï¼Œï¼…æ—¥æœŸï¼…ï¼Œï¼…æ—¶é—´ï¼…ï¼‰ <br></td></tr><tr><td>  AVG_ROW_LEN <br></td><td> å¹³å‡å­—ç¬¦ä¸²é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ <br></td></tr><tr><td>  PART_KEY <br></td><td> åˆ†åŒºåˆ— <br></td></tr><tr><td>  SUBPART_KEY <br></td><td> åˆ†åŒºåˆ— <br></td></tr></tbody></table></div><br>  <i>ä½¿ç”¨çš„ç³»ç»Ÿè¡¨ï¼š</i> all_tab_columnsï¼Œall_tab_commentsï¼Œall_tab_statisticsï¼Œall_part_key_columnsï¼Œall_subpart_key_columnsã€‚ <br><br> è¯¥æŸ¥è¯¢å¯¹äºç¡®å®šä»æºç³»ç»Ÿä¸Šè½½æ•°æ®çš„ç­–ç•¥å¾ˆæœ‰ç”¨ã€‚ å¦‚æœä¸»é”®å»ºç«‹åœ¨æ‰€è€ƒè™‘çš„è¡¨ä¸Šï¼Œåˆ™å¯ä»¥ç»„ç»‡å¸è½½å¹¶åœ¨å…¶ä¸Šéšååˆ†é…â€œå¢é‡â€ã€‚ å¦‚æœæœ‰æ—¶é—´æˆ³è®°ï¼ˆä¾‹å¦‚ï¼Œåœ¨æŠ€æœ¯é¢†åŸŸä¸­æä¾›æœ‰å…³æ’å…¥æ•°æ®æˆ–æ›´æ–°çš„ä¿¡æ¯ï¼‰ï¼Œåˆ™å¯ä»¥ç»„ç»‡ä¸€æ®µæ—¶é—´å†…ä»…ä¸Šè½½å·²æ›´æ”¹/æ·»åŠ çš„è®°å½•çš„ä¸Šè½½ã€‚ åˆ›å»ºç±»ä¼¼çš„è¡¨â€œæ¥æ”¶å™¨â€æ—¶ï¼Œæœ‰å…³åˆ†åŒºç»“æ„çš„ä¿¡æ¯ä¼šæ´¾ä¸Šç”¨åœºã€‚ <br><br>  <i>è¦æ±‚æ­£æ–‡ï¼š</i> <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> filter (owner, table_name) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (    <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-string"><span class="hljs-string">'SCHEMA_NAME_1'</span></span>, t.*    <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(        sys.odcivarchar2list(            <span class="hljs-string"><span class="hljs-string">'TABLE_NAME_1'</span></span>            , <span class="hljs-string"><span class="hljs-string">'TABLE_NAME_2'</span></span>        )    ) t    <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all    <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>        owner        , table_name    <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>        all_tables    <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> owner = <span class="hljs-string"><span class="hljs-string">'SCHEMA_NAME_2'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>    a.owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> schema_name    , a.table_name    , e.comments    , b.height    , c.width    , d.datetime_columns    , b.avg_row_len    , p.part_key    , s.subpart_key <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>    filter a    <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (        <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>            owner            , table_name            , num_rows <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> height            , avg_row_len        <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_tab_statistics        <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> object_type = <span class="hljs-string"><span class="hljs-string">'TABLE'</span></span>    ) b        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>            a.table_name = b.table_name            <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.owner = b.owner    <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (        <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>            owner            , table_name            , <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> width        <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_tab_columns        <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>            owner            , table_name    ) c        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>            a.table_name = c.table_name            <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.owner = c.owner    <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (        <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>            owner            , table_name            , <span class="hljs-keyword"><span class="hljs-keyword">listagg</span></span>(                column_name || <span class="hljs-string"><span class="hljs-string">' ('</span></span> || data_type || <span class="hljs-string"><span class="hljs-string">')'</span></span>                , <span class="hljs-string"><span class="hljs-string">', '</span></span>            ) <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> column_id) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> datetime_columns        <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_tab_columns        <span class="hljs-keyword"><span class="hljs-keyword">where</span></span>            data_type = <span class="hljs-string"><span class="hljs-string">'DATE'</span></span>            <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> data_type <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'TIMESTAMP%'</span></span>            <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> data_type <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'INTERVAL%'</span></span>            <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lower</span></span>(column_name) <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'%period%'</span></span>            <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lower</span></span>(column_name) <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'%date%'</span></span>            <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lower</span></span>(column_name) <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'%time%'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>            owner            , table_name    ) d        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>            a.table_name = d.table_name            <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.owner = d.owner    <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (        <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>            owner            , table_name            , comments        <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_tab_comments        <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> table_type = <span class="hljs-string"><span class="hljs-string">'TABLE'</span></span>    ) e        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>            a.table_name = e.table_name            <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.owner = e.owner    <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (        <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>            owner            , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name            , <span class="hljs-keyword"><span class="hljs-keyword">listagg</span></span>(                column_name                , <span class="hljs-string"><span class="hljs-string">', '</span></span>            ) <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> column_position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> part_key        <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_part_key_columns        <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> object_type = <span class="hljs-string"><span class="hljs-string">'TABLE'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>            owner            , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>    ) p        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>            a.owner = p.owner            <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.table_name = p.table_name    <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (        <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>            owner            , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name            , <span class="hljs-keyword"><span class="hljs-keyword">listagg</span></span>(                column_name                , <span class="hljs-string"><span class="hljs-string">', '</span></span>            ) <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> column_position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> subpart_key        <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_subpart_key_columns        <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> object_type = <span class="hljs-string"><span class="hljs-string">'TABLE'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>            owner            , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>    ) s        <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>            a.owner = s.owner            <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.table_name = s.table_name <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>    e.owner    , e.table_name ;</code> </pre> <br><h3> è„šæœ¬â€œåˆ†åŒºå’Œå­åˆ†åŒºâ€ </h3><br> è§„æ ¼ï¼š <br><br><div class="scrollable-table"><table><tbody><tr><td>  <b>æ å</b> <br></td><td>  <b>è¯„æ³¨</b> <br></td></tr><tr><td>  SCHEMA_NAME <br></td><td> æ•°æ®æ¶æ„åç§°ï¼ˆOWNERï¼‰ <br></td></tr><tr><td>  TABLE_NAME <br></td><td> è¡¨å <br></td></tr><tr><td>  PART_KEY <br></td><td> åˆ†åŒºåˆ— <br></td></tr><tr><td>  PARTITION_NAME <br></td><td> åˆ†åŒºåç§° <br></td></tr><tr><td>  PARTITION_POSITION <br></td><td> åˆ†åŒºå· <br></td></tr><tr><td>  PARTITION_HEIGHT <br></td><td> åˆ†åŒºä¸­çš„è¡Œæ•° <br></td></tr><tr><td>  SUBPART_KEY <br></td><td> åˆ†åŒºåˆ— <br></td></tr><tr><td>  SUBPARTITION_NAME <br></td><td> ç¼”çº¦æ–¹åç§° <br></td></tr><tr><td>  SUBPARTITION_POSITION <br></td><td> å­åˆ†åŒºå· <br></td></tr><tr><td>  SUBPARTITION_HEIGHT <br></td><td> å­æ–¹ä¸­çš„è¡Œæ•° <br></td></tr></tbody></table></div><br>  <i>ä½¿ç”¨çš„ç³»ç»Ÿè¡¨ï¼š</i> all_tab_partitionsï¼Œall_tab_subpartitionsï¼Œall_part_key_columnsï¼Œall_subpart_key_columnsã€‚ <br><br> å½“åˆ†åŒºç›´æ¥ç”¨ä½œæ•°æ®æºæ—¶ï¼Œè¯¥è„šæœ¬å¯¹äºè·å–åˆ†åŒºçš„ç‰¹å¾ï¼ˆåç§°ï¼Œå¤§å°ï¼‰å¾ˆæœ‰ç”¨ã€‚ <br><br>  <i>è¦æ±‚æ­£æ–‡ï¼š</i> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> filter (owner, table_name) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-string"><span class="hljs-string">'SCHEMA_NAME_1'</span></span>, t.*   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(       sys.odcivarchar2list(           <span class="hljs-string"><span class="hljs-string">'TABLE_NAME_1'</span></span>           , <span class="hljs-string"><span class="hljs-string">'TABLE_NAME_2'</span></span>       )   ) t   <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>       owner       , table_name   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>       all_tables   <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> owner = <span class="hljs-string"><span class="hljs-string">'SCHEMA_NAME_2'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>   f.owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> schema_name   , f.table_name   , p.part_key   , pc.partition_name   , pc.partition_position   , pc.num_rows <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> partition_height   , s.subpart_key   , sc.subpartition_name   , sc.subpartition_position   , sc.num_rows <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> subpartition_height <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>   filter f   <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (       <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>           owner           , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name           , <span class="hljs-keyword"><span class="hljs-keyword">listagg</span></span>(               column_name               , <span class="hljs-string"><span class="hljs-string">', '</span></span>           ) <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> column_position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> part_key       <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_part_key_columns       <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> object_type = <span class="hljs-string"><span class="hljs-string">'TABLE'</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>           owner           , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>   ) p       <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>           f.owner = p.owner           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> f.table_name = p.table_name   <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> all_tab_partitions pc       <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>           p.table_name = pc.table_name           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.owner = pc.table_owner   <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> (       <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>           owner           , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name           , <span class="hljs-keyword"><span class="hljs-keyword">listagg</span></span>(               column_name               , <span class="hljs-string"><span class="hljs-string">', '</span></span>           ) <span class="hljs-keyword"><span class="hljs-keyword">within</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> column_position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> subpart_key       <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_subpart_key_columns       <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> object_type = <span class="hljs-string"><span class="hljs-string">'TABLE'</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>           owner           , <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>   ) s       <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>           p.owner = s.owner           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.table_name = s.table_name   <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> all_tab_subpartitions sc       <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>           f.owner = sc.table_owner           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> f.table_name = sc.table_name           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> pc.partition_name = sc.partition_name   <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>       f.owner       , f.table_name ;</code> </pre><br><h3> è„šæœ¬â€œè¡¨çš„å±æ€§ç»„æˆâ€ </h3><br> è§„æ ¼ï¼š <br><br><div class="scrollable-table"><table><tbody><tr><td width="250">  <b>æ å</b> <br></td><td>  <b>è¯„æ³¨</b> <br></td></tr><tr><td>  SCHEMA_NAME <br></td><td> æ•°æ®æ¶æ„åç§°ï¼ˆOWNERï¼‰ <br></td></tr><tr><td>  TABLE_NAME <br></td><td> è¡¨å <br></td></tr><tr><td>  COLUMN_ID <br></td><td> åˆ—åºå· <br></td></tr><tr><td>  COLUMN_NAME <br></td><td> æ å <br></td></tr><tr><td>  DATA_TYPE <br></td><td> èµ„æ–™ç±»å‹ <br></td></tr><tr><td>  COLUMN_COMMENT <br></td><td> ä¸“æ è¯„è®º <br></td></tr><tr><td> æ ‡åº¦ <br></td><td> æ¯”ä¾‹å°ºï¼ˆæ•°æ®ç±»å‹ä¸ºNUMBERï¼‰ <br></td></tr><tr><td> ç²¾å¯†åº¦ <br></td><td> å‡†ç¡®æ€§ï¼ˆæ•°æ®ç±»å‹ä¸ºNUMBERï¼‰ <br></td></tr><tr><td>  BYTE_LENGTH <br></td><td> å­—æ®µé•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ <br></td></tr><tr><td> ç¼–ç  <br></td><td> ç¼–ç æ–‡æœ¬æ•°æ®ç±»å‹ï¼ˆCHARï¼ŒVARCHAR2ï¼ŒNCHARï¼ŒNVARCHAR2ï¼‰ <br></td></tr><tr><td>  CHAR_LENGTH <br></td><td> æ–‡æœ¬æ•°æ®ç±»å‹ï¼ˆCHARï¼ŒVARCHAR2ï¼ŒNCHARï¼ŒNVARCHAR2ï¼‰çš„æœ€å¤§å­—ç¬¦ä¸²é•¿åº¦ <br></td></tr><tr><td>  NOT_NULL <br></td><td> æ ‡è®°â€œå¿…å¡«â€ <br></td></tr><tr><td>  IS_PRIMARY <br></td><td> æ ‡è®°â€œåŒ…å«åœ¨ä¸»é”®ä¸­â€ <br></td></tr><tr><td>  DEFAULT_VALUE <br></td><td> é¢„è®¾å€¼ <br></td></tr><tr><td>  COLUMN_IMPACT <br></td><td> å…¶ä»–è¡¨ä¸­å¼•ç”¨åˆ—çš„åˆ—çš„åˆ—è¡¨ã€‚ <br></td></tr><tr><td>  COLUMN_DEPEND <br></td><td> è¯¥åˆ—å¼•ç”¨çš„å…¶ä»–è¡¨ä¸­çš„åˆ—åˆ—è¡¨ã€‚ <br></td></tr></tbody></table></div><br>  <i>ä½¿ç”¨çš„ç³»ç»Ÿè¡¨ï¼š</i> all_tablesï¼Œall_constraintsï¼Œall_cons_columnsï¼Œall_tab_columnsï¼Œall_col_commentsï¼Œv $ nls_parametersã€‚ <br><br> å½“éœ€è¦æœ‰å…³è¡¨ï¼Œè¡¨ä¸å…¶ä»–è¡¨çš„å…³ç³»ä»¥åŠå®Œæ•´çš„å±æ€§ç»„æˆçš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¯¥è„šæœ¬å¯¹äºåœ¨æ•°æ®ä»“åº“ä¸­å‡†å¤‡â€œæ¥æ”¶å™¨â€è¡¨å¾ˆæœ‰ç”¨ã€‚  filter2è¡¨ç”¨äºè¿‡æ»¤è¦æœç´¢é“¾æ¥ï¼ˆä»å’Œåˆ°ï¼‰çš„è¡¨ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¡¨æ˜¯ä»é™¤ç³»ç»Ÿæ–¹æ¡ˆä»¥å¤–çš„æ‰€æœ‰æ–¹æ¡ˆä¸­è·å–çš„ã€‚ <br><br>  <i>è¦æ±‚æ­£æ–‡ï¼š</i> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> filter (owner, table_name) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-string"><span class="hljs-string">'SCHEMA_NAME_1'</span></span>, t.*   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(       sys.odcivarchar2list(           <span class="hljs-string"><span class="hljs-string">'TABLE_NAME_1'</span></span>           , <span class="hljs-string"><span class="hljs-string">'TABLE_NAME_2'</span></span>       )   ) t   <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>       owner       , table_name   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>       all_tables   <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> owner = <span class="hljs-string"><span class="hljs-string">'SCHEMA_NAME_2'</span></span> ) , filter2 (owner, table_name) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> owner, table_name   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_tables   <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> owner <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'MDSYS'</span></span>, <span class="hljs-string"><span class="hljs-string">'CTXSYS'</span></span>, <span class="hljs-string"><span class="hljs-string">'SYSTEM'</span></span>, <span class="hljs-string"><span class="hljs-string">'XDB'</span></span>, <span class="hljs-string"><span class="hljs-string">'SYS'</span></span>) ) , refs <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>       b.constraint_type <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> from_constraint_type       , b.constraint_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> from_constraint_name       , d.position <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> from_position       , d.column_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> from_column_name       , b.table_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> from_table_name       , b.owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> from_owner       , a.owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> to_owner       , a.table_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> to_table_name       , c.column_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> to_column_name       , c.position <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> to_position       , a.constraint_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> to_constraint_name       , a.constraint_type <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> to_constraint_type   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>       all_constraints a       <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> all_constraints b           <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>               a.r_constraint_name = b.constraint_name               <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.r_owner = b.owner       <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> all_cons_columns c           <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>               a.constraint_name = c.constraint_name               <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.table_name = c.table_name               <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a.owner = c.owner       <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> all_cons_columns d           <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>               b.constraint_name = d.constraint_name               <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> b.table_name = d.table_name               <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> b.owner = d.owner       <span class="hljs-keyword"><span class="hljs-keyword">where</span></span>           a.constraint_type = <span class="hljs-string"><span class="hljs-string">'R'</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> b.constraint_type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'P'</span></span>, <span class="hljs-string"><span class="hljs-string">'U'</span></span>)           <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.position = d.position ) , depends <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">rtrim</span></span>(           <span class="hljs-keyword"><span class="hljs-keyword">xmlagg</span></span>(               <span class="hljs-keyword"><span class="hljs-keyword">xmlelement</span></span>(                   e                   , to_owner || <span class="hljs-string"><span class="hljs-string">'.'</span></span> || to_table_name || <span class="hljs-string"><span class="hljs-string">'.'</span></span> || to_column_name                   , <span class="hljs-string"><span class="hljs-string">', '</span></span>               ).extract(<span class="hljs-string"><span class="hljs-string">'//text()'</span></span>)               <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> to_owner           ).getclobval()           , <span class="hljs-string"><span class="hljs-string">', '</span></span>       ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> val       , from_owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> owner       , from_table_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name       , from_column_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> column_name   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> refs   <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> (to_owner, to_table_name) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> filter2)   <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>       from_table_name       , from_column_name       , from_owner ) , impacts <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">rtrim</span></span>(           <span class="hljs-keyword"><span class="hljs-keyword">xmlagg</span></span>(               <span class="hljs-keyword"><span class="hljs-keyword">xmlelement</span></span>(                   e                   , from_owner || <span class="hljs-string"><span class="hljs-string">'.'</span></span> || from_table_name || <span class="hljs-string"><span class="hljs-string">'.'</span></span> || from_column_name                   , <span class="hljs-string"><span class="hljs-string">', '</span></span>               ).extract(<span class="hljs-string"><span class="hljs-string">'//text()'</span></span>)               <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> from_owner           ).getclobval()           , <span class="hljs-string"><span class="hljs-string">', '</span></span>       ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> val       , to_owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> owner       , to_table_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name       , to_column_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> column_name   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> refs   <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> (from_owner, from_table_name) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> filter2)   <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>       to_table_name       , to_column_name       , to_owner ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>   f.owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> schema_name   , f.table_name   , a.column_id   , a.column_name   , a.data_type   , b.comments <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> column_comment   <span class="hljs-comment"><span class="hljs-comment">/*         precision  ,    38       (      )       ,    scale,    0 (  ). */</span></span>   , <span class="hljs-keyword"><span class="hljs-keyword">decode</span></span> (       a.data_type       , <span class="hljs-string"><span class="hljs-string">'NUMBER'</span></span>, nvl(a.data_scale, <span class="hljs-number"><span class="hljs-number">0</span></span>)       , <span class="hljs-string"><span class="hljs-string">''</span></span>   ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scale   , <span class="hljs-keyword"><span class="hljs-keyword">decode</span></span> (       a.data_type       , <span class="hljs-string"><span class="hljs-string">'NUMBER'</span></span>, nvl(a.data_precision, <span class="hljs-number"><span class="hljs-number">38</span></span>)       , <span class="hljs-string"><span class="hljs-string">''</span></span>   ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span>   <span class="hljs-comment"><span class="hljs-comment">/*             CHAR, VARCHAR2           DDL-   ,    NCHAR or NVARCHAR2        .*/</span></span>   , a.data_length <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> byte_length   , <span class="hljs-keyword"><span class="hljs-keyword">case</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a.data_type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'CHAR'</span></span>, <span class="hljs-string"><span class="hljs-string">'VARCHAR2'</span></span>, <span class="hljs-string"><span class="hljs-string">'NCHAR'</span></span>, <span class="hljs-string"><span class="hljs-string">'NVARCHAR2'</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> d.value   <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">encoding</span></span>   , <span class="hljs-keyword"><span class="hljs-keyword">case</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a.data_type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'CHAR'</span></span>, <span class="hljs-string"><span class="hljs-string">'VARCHAR2'</span></span>, <span class="hljs-string"><span class="hljs-string">'NCHAR'</span></span>, <span class="hljs-string"><span class="hljs-string">'NVARCHAR2'</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> a.char_length <span class="hljs-comment"><span class="hljs-comment">--a.char_col_decl_length   end as char_length   , decode(a.nullable, 'Y', 'N', 'Y') as not_null   , decode(c.is_primary, 1, 'Y', 'N') as is_primary   , a.data_default as default_value   , impacts.val as column_impact   , depends.val as column_depend from   filter f   left join all_tab_columns a       on           f.owner = a.owner           and f.table_name = a.table_name   left join all_col_comments b       on           a.owner = b.owner           and a.table_name = b.table_name           and a.column_name = b.column_name   left join (       select           1 as is_primary           , owner           , table_name           , column_name       from all_cons_columns       where (owner, constraint_name) in (           select owner, constraint_name           from all_constraints           where constraint_type = 'P'       )   ) c       on           a.owner = c.owner           and a.table_name = c.table_name           and a.column_name = c.column_name   left join v$nls_parameters d       on decode (           a.character_set_name           , 'CHAR_CS', 'NLS_CHARACTERSET'           , 'NCHAR_CS', 'NLS_NCHAR_CHARACTERSET'           , a.character_set_name       ) = d.parameter   left join depends       on           a.owner = depends.owner           and a.table_name = depends.table_name           and a.column_name = depends.column_name   left join impacts       on           a.owner = impacts.owner           and a.table_name = impacts.table_name           and a.column_name = impacts.column_name order by   f.owner   , f.table_name   , a.column_id ;</span></span></code> </pre><br><h3> è„šæœ¬â€œç¨‹åºï¼Œå‡½æ•°å’ŒåŒ…â€ </h3><br>  <i>è§„æ ¼ï¼š</i> <br><div class="scrollable-table"><table><tbody><tr><td>  <b>æ å</b> <br></td><td>  <b>è¯„æ³¨</b> <br></td></tr><tr><td>  SCHEMA_NAME <br></td><td> æ•°æ®æ¶æ„åç§°ï¼ˆOWNERï¼‰ <br></td></tr><tr><td> å§“å <br></td><td> è¿‡ç¨‹/åŠŸèƒ½/åŒ…/åŒ…å¤´çš„åç§° <br></td></tr><tr><td> èº«æ <br></td><td> èº«æ <br></td></tr><tr><td> å‹å¼ <br></td><td> ç±»å‹ï¼ˆåŒ…è£…ä½“ï¼ŒåŒ…è£…ï¼ŒåŠŸèƒ½ï¼Œç¨‹åºï¼‰ <br></td></tr><tr><td> åŒ…å¥½ <br></td><td> æ ‡è®°â€œæ˜¯å¦å·²ç¼–ç ä¸»ä½“ï¼ˆå·²åŒ…è£…ï¼‰â€ <br></td></tr></tbody></table></div><br>  <i>äºŒæ‰‹ç³»ç»Ÿè¡¨ï¼š</i> all_source <br><br> åœ¨åˆ†ææºæ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€é¡¹ä»»åŠ¡ï¼Œä»¥ç ”ç©¶ç³»ç»Ÿä¸­å¾ªç¯çš„æ•°æ®æµã€‚ æ²¡æœ‰è½¯ä»¶åŒ…ï¼ŒåŠŸèƒ½å’Œè¿‡ç¨‹çš„ä»£ç åº“ï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œå°¤å…¶æ˜¯åœ¨æ–‡æ¡£ä¸å®Œæ•´æˆ–ç¼ºå°‘çš„æƒ…å†µä¸‹ã€‚ ä¸ºæ–¹ä¾¿èµ·è§ï¼Œé€šè¿‡è„šæœ¬åˆ—å‡ºçš„å¯¹è±¡å¯ä»¥è¡¨çš„å½¢å¼è¡¨ç¤ºã€‚ å¯ä»¥ä½¿ç”¨æ§åˆ¶å°å®ç”¨ç¨‹åºå°†è¯·æ±‚çš„ç»“æœè¾“å‡ºåˆ°æµä¸­ï¼Œå¹¶é€šè¿‡ç®€å•çš„å¤„ç†ç¨‹åºï¼ˆbashè„šæœ¬ï¼‰å°†å…¶é‡å®šå‘åˆ°æ–‡ä»¶ï¼Œä»¥ä¾›æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨è¿›ä¸€æ­¥ç ”ç©¶ã€‚ æ­¤å¤–ï¼Œå„ç§å¤„ç†ç¨‹åºå¯ä»¥â€œæŒ‚â€åœ¨è¾“å‡ºæµä¸Š-ç¾åŒ–ï¼Œå±•å¼€ç­‰ã€‚ <br><br>  <i>è¦æ±‚æ­£æ–‡ï¼š</i> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span>   t.owner <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> schema_name   , t.name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>   , <span class="hljs-keyword"><span class="hljs-keyword">xmlagg</span></span>(       <span class="hljs-keyword"><span class="hljs-keyword">xmlelement</span></span>(           e           , t.text           , <span class="hljs-string"><span class="hljs-string">''</span></span>       ).extract(<span class="hljs-string"><span class="hljs-string">'//text()'</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> t.line <span class="hljs-keyword"><span class="hljs-keyword">asc</span></span>   ).getclobval() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>   , f.wrapped   , t.type <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (   <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>       owner, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>       , <span class="hljs-keyword"><span class="hljs-keyword">case</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lower</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'%wrapped%'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">wrapped</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> all_source   <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (       <span class="hljs-string"><span class="hljs-string">'PACKAGE BODY'</span></span>       , <span class="hljs-string"><span class="hljs-string">'PACKAGE'</span></span>       , <span class="hljs-string"><span class="hljs-string">'FUNCTION'</span></span>       , <span class="hljs-string"><span class="hljs-string">'PROCEDURE'</span></span>   )   <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> line = <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> owner <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'MDSYS'</span></span>, <span class="hljs-string"><span class="hljs-string">'CTXSYS'</span></span>, <span class="hljs-string"><span class="hljs-string">'SYSTEM'</span></span>, <span class="hljs-string"><span class="hljs-string">'XDB'</span></span>, <span class="hljs-string"><span class="hljs-string">'SYS'</span></span>) ) f <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> all_source t <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>   f.owner = t.owner   <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> f.name = t.name   <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> f.type = t.type <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>   t.owner   , t.name   , t.type   , f.wrapped <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span>   t.owner   , t.name   , t.type ;</code> </pre><br><h3> ç»“è®º </h3><br> ä¸Šé¢æè¿°çš„è„šæœ¬å¸®åŠ©æˆ‘ä»¬çš„ç³»ç»Ÿåˆ†æå‘˜æ‘†è„±äº†æ”¶é›†æ•°æ®åº“ä¿¡æ¯çš„è®¸å¤šå¸¸è§„ä»»åŠ¡ï¼Œå¹¶ä¸“æ³¨äºæ›´å…·åˆ›é€ æ€§çš„äº‹ç‰©ï¼Œä¾‹å¦‚åŠ è½½ç­–ç•¥å’Œâ€œæ¥æ”¶å™¨â€è¡¨çš„ç»“æ„ã€‚ æˆ‘å¸Œæœ›è¿™äº›è„šæœ¬ä¹Ÿå¯¹æ‚¨æœ‰ç”¨ã€‚ çŸ¥é“å¦‚ä½•è‡ªåŠ¨åŒ–è¿™äº›ä»»åŠ¡å’Œç±»ä¼¼ä»»åŠ¡å°†å¾ˆæœ‰è¶£ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN442082/">https://habr.com/ru/post/zh-CN442082/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN442070/index.html">å…¬å¸æœ€ç»ˆæ‹…å¿ƒç‰©è”ç½‘è®¾å¤‡åŠå…¶å®‰å…¨æ€§çš„å‘å±•</a></li>
<li><a href="../zh-CN442072/index.html">RxJava2 + Retrofit2ã€‚æˆ‘ä»¬ä¿®æ”¹äº†é€‚é…å™¨ï¼Œä»¥è§£å†³Androidä¸Šç¼ºå°‘InternetçŠ¶æ€çš„é—®é¢˜</a></li>
<li><a href="../zh-CN442074/index.html">RiMEåœ¨æ¸¸æˆå¼•æ“ä¸­çš„æ—¶å°šç€‘å¸ƒï¼šè®©æ°´æµ</a></li>
<li><a href="../zh-CN442078/index.html">é€šè¿‡Pythonä½¿ç”¨Jira API</a></li>
<li><a href="../zh-CN442080/index.html">Java Webåº”ç”¨ç¨‹åºçš„åƒåˆ†å°ºè¿æ¥</a></li>
<li><a href="../zh-CN442084/index.html">ä¸Šå¤ï¼šäºŒåå²çš„è½¯ç›˜ç…§ç›¸æœº</a></li>
<li><a href="../zh-CN442086/index.html">Love Kubernetesæ˜¯å¦‚ä½•åœ¨2æœˆ14æ—¥å‰å¾€Mail.ru Groupçš„</a></li>
<li><a href="../zh-CN442088/index.html">SECæŒ‡æ§Ilon Maskè¿åäº†ç¦æ­¢åœ¨ç¤¾äº¤ç½‘ç»œä¸Šå‘å¸ƒç‰¹æ–¯æ‹‰é‡è¦æ•°æ®çš„ç¦ä»¤</a></li>
<li><a href="../zh-CN442090/index.html">å¼€å‘AIåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æŒ‡å—</a></li>
<li><a href="../zh-CN442092/index.html">Delta-OMAï¼ˆD-OMAï¼‰ï¼šæ–°çš„6Gå¤§è§„æ¨¡å¤šè·¯è®¿é—®æ–¹æ³•ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>