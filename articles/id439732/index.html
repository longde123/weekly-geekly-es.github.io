<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍👦 🕵🏻 🙏🏻 Lazarus - animasi sederhana menggunakan komponen TImageFragment 👍🏿 😜 🐽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alih-alih kata pengantar 
 Dalam artikel Lazarus saya baru-baru ini - menulis komponen untuk animasi sprite, saya menjelaskan proses pembuatan kompone...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lazarus - animasi sederhana menggunakan komponen TImageFragment</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439732/"><h6>  Alih-alih kata pengantar </h6><br>  Dalam artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lazarus</a> saya baru-baru ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">- menulis komponen untuk animasi sprite,</a> saya menjelaskan proses pembuatan komponen <b>TImageFragment</b> sederhana yang memungkinkan Anda untuk menampilkan fragmen gambar tertentu. <br><br>  Melanjutkan topik yang dipilih, dalam artikel ini saya ingin menunjukkan betapa mudahnya membuat animasi sprite di lingkungan pengembangan <b>Lazarus</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs resmi</a> ) menggunakan komponen ini. <br><br>  Dengan pendekatan ini, masing-masing frame animasi dalam proyeksi yang berbeda ditempatkan pada gambar yang sama, dan komponen untuk menampilkan sprite hanya menunjukkan satu fragmen yang dipilih dari gambar ini menggunakan properti <b>OffsetX</b> dan <b>OffsetY</b> (offset sudut kiri atas fragmen gambar secara horizontal dan vertikal). <br><br>  Banyak dari gambar yang sudah jadi ini dapat ditemukan di Web - misalnya, di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini di situs ini</a> . <a name="habracut"></a><br><br><h6>  Pilih (dan siapkan) gambar </h6><br>  Sebagai contoh saya, saya memilih gambar ini: <br><img src="https://habrastorage.org/getpro/habr/post_images/909/e6e/661/909e6e661a0a47541735e88ce1adcb00.png"><br>  - Sangat ekspresif burung Phoenix ini mengepakkan sayapnya. <br><br>  Seperti yang Anda lihat, setiap baris berisi 4 bingkai untuk masing-masing dari 4 proyeksi.  Dengan mengubah hanya <b>OffsetX</b> , Anda dapat membuat burung mengepakkan sayapnya, dan untuk mengubah proyeksi itu cukup dengan hanya mengganti <b>OffsetY</b> .  Pemisahan bingkai demi baris ini sangat menyederhanakan pemrograman animasi. <br><br>  Ukuran gambar ini adalah 384x384, dan ukuran setiap frame adalah 96x96.  Sayangnya, penggunaan langsung gambar ini membuat kami kesal dengan artefak: beberapa bingkai gambar ditempatkan sehingga tepinya jatuh pada bingkai yang berdekatan, dan selama animasi, goresan kuning berkedip di tepi sprite. <br><br>  Untuk memperbaiki cacat ini, saya menggunakan editor grafis lintas platform gratis <b>GIMP</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs resmi</a> ).  Semua yang harus dilakukan adalah menghapus piksel yang menonjol dari gambar di tempat mereka jatuh pada bingkai yang berdekatan. <br><br>  File yang diperbaiki terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/vw/_a/44/vw_a44kabb9dlcz4ituzz2zumdi.png"><br><br>  - Dengan mata telanjang, perbedaannya tidak terlihat, tetapi opsi kedua bekerja tanpa artefak. <br><br><h6>  Buat proyek baru </h6><br>  1. Buat proyek jenis "Aplikasi" baru. <br><br>  Secara default, IDE membuat proyek yang disebut "project1", yang segera membuat satu modul program yang disebut "unit1", yang menggambarkan kelas yang disebut "" TForm1 "dan mendeklarasikan instance dengan nama" Form1 ". <br><br>  Secara umum, saat membuat objek baru, IDE memberinya nama yang mirip, terdiri dari nama tipe objek dan nomor seri.  Saya menganggap itu gaya yang baik untuk mengubah nama semua objek seperti itu, memberi mereka nama yang bermakna yang mencerminkan peran atau tujuan objek. <br><br>  Jadi, proyek kami tidak akan disebut "project1", tetapi "Phoenix" - sesuai dengan nama sprite yang dipilih. <br><br>  2. Simpan proyek baru kami. <br><br>  Dianjurkan untuk menyimpan setiap proyek dalam direktori terpisah dengan nama yang cocok dengan nama proyek.  Selama proses penyimpanan, kami menentukan direktori yang akan disimpan (jika perlu, kami membuatnya di sana), lalu nama file proyek dan nama file modul program.  Saya membuat folder "Phoenix" dan menyimpan file proyek di sana ("Phoenix.lpi" alih-alih yang diusulkan "project1.lpi") dan file modul program ("UnitMain.pas" alih-alih yang diusulkan "unit1.pas"). <br><br><div class="spoiler">  <b class="spoiler_title">Nuansa case karakter</b> <div class="spoiler_text">  Versi Lazarus untuk Windows mengarahkan nama file modul program ke huruf kecil: "unitmain.pas", tetapi nama program modul mempertahankan huruf asli karakter: "unit UnitMain;".  Ini tidak terjadi pada file proyek, nama file mempertahankan huruf asli karakter. </div></div><br>  3. Ganti nama formulir dan ubah judulnya. <br><br>  Formulir yang baru dibuat, disebut "Form1" (properti <b>Name</b> ), adalah turunan dari kelas "TForm1" dan berisi judul "Form1" (properti <b>Caption</b> ).  Ubah properti <b>Name</b> dari form menjadi "FormMain", dan nama kelas akan berubah menjadi "TFormMain". <br><br>  Ubah properti <b>Caption</b> menjadi "Phoenix" sehingga judul proyek ditampilkan dalam judul jendela. <br><br>  4. Sebagai hasilnya, saya mendapatkan teks berikut dari modul unitmain.pas: <br><br><pre><code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> UnitMain; <span class="hljs-meta"><span class="hljs-meta">{$mode objfpc}</span></span><span class="hljs-meta"><span class="hljs-meta">{$H+}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> Classes, SysUtils, FileUtil, Forms, Controls, Graphics, Dialogs; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-title"><span class="hljs-title">TFormMain</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TForm) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> FormMain: TFormMain; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-meta"><span class="hljs-meta">{$R *.lfm}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br><br>  5. Kompilasi, jalankan proyek (kunci &lt;F9&gt;): <br><br><img src="https://habrastorage.org/webt/v_/el/0s/v_el0s_ntalmovtpfkso3j-gqau.png"><br><br><h6>  Letakkan sprite di formulir </h6><br>  Dengan asumsi bahwa Anda telah menginstal komponen <b>TImageFragment yang</b> dijelaskan dalam artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lazarus</a> saya sebelumnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">- kami menulis komponen untuk animasi sprite</a> , pilih tab "Game" pada palet komponen dan tambahkan komponen "TImageFragment" ke formulir. <br><br>  Menggunakan properti <b>Picture</b> , memuat gambar (versi tetap burung Phoenix) ke dalam komponen.  Selain itu, kami juga mengubah properti objek baru berikut: <br><br><ul><li>  atur properti <b>Tinggi</b> dan <b>Lebar</b> ke 96 </li><li>  atur properti <b>Kiri</b> dan <b>Atas</b> ke 0 (nyaman untuk mencocokkan dengan tangkapan layar saya) </li><li>  Properti <b>nama</b> diubah dari "ImageFragment1" yang tidak nyaman menjadi "Sprite" yang sederhana dan dapat dimengerti. </li></ul><br>  Jika semuanya dilakukan dengan benar, komponen akan menampilkan bingkai pertama dari gambar: <br><img src="https://habrastorage.org/webt/br/zp/g2/brzpg25qbgjlrsoy20akjhdeox4.png"><br><br>  Teks modul <b>UnitMain</b> akan <b>mengalami</b> perubahan kecil: <br>  - modul <b>ImageFragment</b> ditambahkan ke bagian <b>penggunaan</b> <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> Classes, SysUtils, FileUtil, Forms, Controls, Graphics, Dialogs, ImageFragment;</code> </pre><br>  - objek baru akan muncul di deklarasi kelas <br><br><pre> <code class="delphi hljs"> <span class="hljs-title"><span class="hljs-title">TFormMain</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TForm) Sprite: TImageFragment; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><br><h6>  Tambahkan animasi - sayap sayap </h6><br>  1. Tambahkan komponen baru dari kelas <b>TTimer</b> ke <b>formulir</b> . <br><br>  Komponen ini terletak pada tab "Sistem" pada palet komponen.  Anda dapat menempatkannya di tempat yang nyaman di formulir, karena tidak ditampilkan di aplikasi yang sedang berjalan. <br><br>  2. Ganti nama objek yang ditambahkan. <br><br>  Objek baru secara otomatis mendapatkan nama "Timer1", tetapi kami menamainya menjadi "TimerLive".  Sering kali lebih mudah untuk memberi nama benda seperti itu, terdiri dari dua bagian: yang pertama mencerminkan kelas objek, dan yang kedua mencerminkan tujuannya. <br><br>  3. Ubah properti <b>Interval</b> dari 1000 menjadi 100. <br><br>  Biarkan bingkai animasi ini saling menggantikan setiap 100 milidetik, yaitu 10 kali per detik.  Di masa depan, properti ini dapat diubah untuk memperlambat atau mempercepat rentang sayap - sesuai kebijakan programmer. <br><br>  4. Tambahkan pengendali acara OnTimer. <br><br>  Cara termudah untuk melakukan ini adalah klik dua kali pada ikon objek <b>TimerLive</b> baru.  Sebagai hasil dari tindakan ini, IDE itu sendiri akan menambahkan prosedur baru ke deklarasi kelas bentuk, tautan ke prosedur ini ke properti objek, dan badan prosedur baru akan ditambahkan ke bagian <b>implementasi</b> (dan kursor akan ditempatkan di dalam prosedur baru ini, antara <b>kata kunci</b> <b>mulai</b> dan <b>akhir</b> ). <br><br>  5. Tambahkan satu baris kode ke prosedur baru. <br><br><pre> <code class="delphi hljs"> Sprite.OffsetX := (Sprite.OffsetX + <span class="hljs-number"><span class="hljs-number">96</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">mod</span></span> <span class="hljs-number"><span class="hljs-number">384</span></span>;</code> </pre><br>  Sebagai hasil dari tindakan ini, deklarasi kelas akan terlihat seperti ini: <br><br><pre> <code class="delphi hljs"> <span class="hljs-title"><span class="hljs-title">TFormMain</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TForm) Sprite: TImageFragment; TimerLive: TTimer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerLiveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  Dan prosedur baru - event <b>handler OnTimer</b> akan terlihat seperti ini: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFormMain</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerLiveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Sprite.OffsetX := (Sprite.OffsetX + <span class="hljs-number"><span class="hljs-number">96</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">mod</span></span> <span class="hljs-number"><span class="hljs-number">384</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  Setelah menyusun dan menjalankan aplikasi, Anda dapat menyaksikan burung Phoenix mengepakkan sayapnya. <br><br>  Ini terjadi karena pengendali peristiwa waktu setiap 100 milidetik mengubah siklus offset fragmen yang ditampilkan, dan frame yang dipilih digeser secara horizontal, secara berurutan menampilkan 4 frame dari garis atas gambar yang dimuat.  Operasi <b>mod</b> - mendapatkan sisa divisi - mencegah offset melampaui ukuran gambar, dan sebagai hasilnya, frame ke-4 kembali diikuti oleh frame ke-1. <br><br><h6>  Tambahkan gerakan sprite di sekitar jendela </h6><br>  1. Tambahkan modul <b>Matematika</b> ke bagian <b>penggunaan</b> <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> Classes, SysUtils, FileUtil, Forms, Controls, Graphics, Dialogs, ExtCtrls, ImageFragment, Math;</code> </pre><br>  2. Tambahkan variabel baru dan konstan ke deklarasi kelas. <br><br>  Untuk menyimpan vektor memindahkan sprite di sekitar jendela, tambahkan variabel tipe <b>TPoint</b> <br><br><pre> <code class="delphi hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FVector: TPoint;</code> </pre><br>  Di tempat yang sama, kami mendeklarasikan konstanta untuk mendefinisikan modul kecepatan <br><br><pre> <code class="delphi hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Speed = <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><br>  3. Tambahkan komponen lain dari kelas <b>TTimer</b> ke <b>formulir</b> . <br><br>  Saya mengingatkan Anda: komponen ini terletak di tab "Sistem" pada palet komponen. <br><br>  Objek baru lagi secara otomatis mendapatkan nama "Timer1", dan kami menamainya - kali ini menjadi "TimerMove".  Tujuan dari pengatur waktu kedua adalah untuk mengontrol pergerakan sprite.  Saya tidak mengikat kedua proses (animasi dan gerakan) ke timer yang sama sehingga masing-masing timer dapat diatur secara terpisah - misalnya, untuk memperlambat frekuensi ayunan sayap tanpa memperlambat gerakan, dan sebagainya. <br><br>  4. Ubah properti <b>Interval</b> dari 1000 menjadi 100. <br><br>  Biarkan timer ini juga menyala setiap 100 milidetik, yaitu 10 kali per detik.  Di masa depan, properti ini juga dapat diubah untuk memperlambat atau mempercepat frekuensi rendering fakta sprite move. <br><br>  5. Tambahkan <b>pengendali</b> acara <b>OnTimer</b> . <br><br>  Untuk perubahan, kali ini saya mengusulkan untuk melakukan ini dengan mengklik dua kali berlawanan dengan peristiwa <b>OnTimer</b> pada tab "Acara" pada objek <b>TimerMove yang</b> baru.  Seperti terakhir kali, sebagai hasil dari tindakan ini, IDE itu sendiri akan menambahkan prosedur baru ke deklarasi kelas bentuk, tautan ke prosedur ini ke properti objek, dan badan prosedur baru akan ditambahkan ke bagian <b>implementasi</b> (dan kursor akan ditempatkan di dalam prosedur baru ini, di antara kunci kata <b>-</b> kata <b>mulai</b> dan <b>berakhir</b> ). <br><br>  6. Tambahkan dua baris kode ke prosedur baru. <br><br><pre> <code class="delphi hljs"> Sprite.Left := Max(<span class="hljs-number"><span class="hljs-number">0</span></span>, Min(Width - Sprite.Width, Sprite.Left + FVector.x)); Sprite.Top := Max(<span class="hljs-number"><span class="hljs-number">0</span></span>, Min(Height - Sprite.Height, Sprite.Top + FVector.y));</code> </pre><br>  Menggunakan fungsi Max () dan Min () mencegah sprite keluar dari form (jendela aplikasi utama). <br>  Untuk menggunakan fungsi-fungsi ini kami menghubungkan modul <b>Matematika</b> ke bagian <b>penggunaan</b> . <br><br>  7. Tambahkan <b>pengendali</b> event <b>OnKeyPress</b> . <br><br>  Pilih formulir (klik pada persegi panjang abu-abu dari tata letak jendela di luar semua komponen yang ditambahkan) dan pada tab Acara kita menemukan acara <b>OnKeyPress</b> .  Dengan mengklik dua kali pada nilai kosong event handler, kami membuat dan menetapkan prosedur baru - event handler. <br><br>  8. Tambahkan beberapa baris kode ke prosedur baru. <br><br><pre> <code class="delphi hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'a'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(-Speed, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'d'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(Speed, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'w'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, -Speed) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'s'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, Speed) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br>  Sebagai hasil dari tindakan ini, deklarasi kelas akan terlihat seperti ini: <br><br><pre> <code class="delphi hljs"> <span class="hljs-title"><span class="hljs-title">TFormMain</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TForm) Sprite: TImageFragment; TimerMove: TTimer; TimerLive: TTimer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormKeyPress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Key: char)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerLiveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerMoveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FVector: TPoint; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Speed = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  Dan prosedur baru - Penangan event <b>OnTimer</b> dan <b>OnKeyPress</b> akan terlihat seperti ini: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFormMain</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerMoveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Sprite.Left := Max(<span class="hljs-number"><span class="hljs-number">0</span></span>, Min(Width - Sprite.Width, Sprite.Left + FVector.x)); Sprite.Top := Max(<span class="hljs-number"><span class="hljs-number">0</span></span>, Min(Height - Sprite.Height, Sprite.Top + FVector.y)); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFormMain</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormKeyPress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Key: char)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'a'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(-Speed, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'d'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(Speed, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'w'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, -Speed) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'s'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, Speed) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  Setelah mengkompilasi dan memulai aplikasi, Anda dapat memindahkan burung Phoenix di layar menggunakan tombol "a", "w", "s", "d" dan hentikan dengan spasi. <br><br><h6>  Kami menggunakan proyeksi sprite yang berbeda </h6><br>  Tambahkan kode berikut ke akhir prosedur <b>TFormMain.FormKeyPress</b> <br><br><pre> <code class="delphi hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FVector.x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">96</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FVector.x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">192</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FVector.y &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">288</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  Mengubah properti <b>OffsetY</b> tergantung pada vektor perpindahan menyebabkan gambar berputar ke arah gerakan. <br><br><div class="spoiler">  <b class="spoiler_title">Semua Teks Modul UnitMain</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> UnitMain; <span class="hljs-meta"><span class="hljs-meta">{$mode objfpc}</span></span><span class="hljs-meta"><span class="hljs-meta">{$H+}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> Classes, SysUtils, FileUtil, Forms, Controls, Graphics, Dialogs, ExtCtrls, ImageFragment, Math; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-comment"><span class="hljs-comment">{ TFormMain }</span></span> <span class="hljs-title"><span class="hljs-title">TFormMain</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TForm) Sprite: TImageFragment; TimerMove: TTimer; TimerLive: TTimer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormKeyPress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Key: char)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerLiveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerMoveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FVector: TPoint; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Speed = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> FormMain: TFormMain; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-meta"><span class="hljs-meta">{$R *.lfm}</span></span> <span class="hljs-comment"><span class="hljs-comment">{ TFormMain }</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFormMain</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerLiveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Sprite.OffsetX := (Sprite.OffsetX + <span class="hljs-number"><span class="hljs-number">96</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">mod</span></span> <span class="hljs-number"><span class="hljs-number">384</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFormMain</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimerMoveTimer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Sprite.Left := Max(<span class="hljs-number"><span class="hljs-number">0</span></span>, Min(Width - Sprite.Width, Sprite.Left + FVector.x)); Sprite.Top := Max(<span class="hljs-number"><span class="hljs-number">0</span></span>, Min(Height - Sprite.Height, Sprite.Top + FVector.y)); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFormMain</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormKeyPress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Key: char)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'a'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(-Speed, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'d'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(Speed, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'w'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, -Speed) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">'s'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, Speed) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Key = <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FVector := TPoint.Create(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FVector.x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">96</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FVector.x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">192</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> FVector.y &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">288</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Sprite.OffsetY := <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre></div></div><br><h6>  Alih-alih kata penutup </h6><br>  Contoh sederhana ini tidak mengklaim peringkat tinggi untuk kecepatan atau kegunaan.  Jika seseorang, seperti dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel sebelumnya</a> , ingin memberi tahu dalam komentar bahwa animasi perlu dilakukan salah - selamat datang, tulis artikel Anda.  Dan topik artikel ini adalah bagaimana membuat animasi dalam beberapa baris kode, tanpa menggunakan perpustakaan khusus, praktis “on the knee”.  Metode ini telah diuji dalam praktiknya, itu benar-benar berhasil, jadi sebelum mengkritik dan "minus", baca kembali artikel ini tentang apa dan mengapa. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439732/">https://habr.com/ru/post/id439732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439722/index.html">Efek filter SVG. Bagian 2. Garis besar teks dengan feMorphology</a></li>
<li><a href="../id439724/index.html">Ikhtisar solusi AI & ML pada 2018 dan perkiraan untuk 2019: Bagian 2 - Alat dan perpustakaan, AutoML, RL, etika dalam AI</a></li>
<li><a href="../id439726/index.html">Lock-in: benar atau fiksi?</a></li>
<li><a href="../id439728/index.html">Konfigurasikan cadangan dan pemulihan Zimbra OSE yang lengkap dan terpisah tanpa menggunakan Zextras</a></li>
<li><a href="../id439730/index.html">Organisasi peredam melalui kelas standar</a></li>
<li><a href="../id439734/index.html">Menyebarkan Kubernetes di desktop dalam hitungan menit dengan MicroK8s</a></li>
<li><a href="../id439736/index.html">Koneksi IPSec VPN antara MikroTik dan Kerio Control</a></li>
<li><a href="../id439738/index.html">Mencari tombol "Lakukan dengan baik". Zyxel dalam jaringan bisnis kecil dan menengah</a></li>
<li><a href="../id439742/index.html">Masuk ke program Master JetBrains di Universitas ITMO</a></li>
<li><a href="../id439744/index.html">Para peneliti dari MIT merancang "rectenna" yang mengubah sinyal Wi-Fi menjadi listrik</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>