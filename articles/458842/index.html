<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí≥ üë®üèΩ‚Äçüî¨ üí§ La paciencia y el trabajo extraer√°n todo el texto. üïµüèº üîé üí∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durante la sesi√≥n de capacitaci√≥n (mayo-junio y diciembre-enero), los usuarios nos solicitan que verifiquemos pr√©stamos de hasta 500 documentos por mi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La paciencia y el trabajo extraer√°n todo el texto.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/antiplagiat/blog/458842/"><p>  Durante la sesi√≥n de capacitaci√≥n (mayo-junio y diciembre-enero), los usuarios nos solicitan que verifiquemos pr√©stamos de hasta 500 documentos por minuto.  Los documentos vienen en archivos de varios formatos, la complejidad de trabajar con cada uno de ellos es diferente.  Para verificar si un documento est√° prestado, primero debemos extraer su texto del archivo y, al mismo tiempo, tratar con el formato.  La tarea es implementar una extracci√≥n de alta calidad de medio millar de textos con formato por minuto, mientras que caen con poca frecuencia (o mejor, no caen en absoluto), consumen pocos recursos y no pagan la mitad del presupuesto gal√°ctico para el desarrollo y operaci√≥n de la creaci√≥n final. </p><br><p>  S√≠, s√≠, por supuesto, sabemos que de tres cosas, de forma r√°pida, econ√≥mica y eficiente, debe elegir dos.  Pero lo m√°s desagradable es que en nuestro caso no podemos eliminar nada.  La pregunta es qu√© tan bien lo hicimos ... </p><br><p><img src="https://habrastorage.org/webt/us/nu/t4/usnut4dlt0wwlqzbkwhnmlud1uo.png"></p><br><p>  <sub><em>Fuente de la imagen: <a href="">Wikipedia</a></em></sub> <br></p><p><a name="habracut"></a></p><br><p>  A menudo se nos dice que el destino de las personas depende de la calidad de nuestro trabajo.  Por lo tanto, tienes que educar en ti mismo perfeccionistas.  Por supuesto, estamos mejorando constantemente la calidad del sistema (en todos los aspectos), ya que los autores sin escr√∫pulos encuentran nuevas formas de evitarlo.  Y espero que est√© cerca el d√≠a en que la complejidad del enga√±o, por un lado, y la sensaci√≥n de satisfacci√≥n de un trabajo bien hecho, por otro lado, incite a la gran mayor√≠a de los estudiantes a abandonar su amado deseo de perder el tiempo.  Al mismo tiempo, entendemos que el precio del error puede ser el posible sufrimiento de personas inocentes si de repente lo fingimos. </p><br><p>  ¬øPor qu√© soy yo?  Si fu√©ramos perfeccionistas, nos acercar√≠amos cuidadosamente a escribir una serie de art√≠culos sobre el trabajo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del sistema antiplagio</a> .  Formular√≠amos minuciosamente un plan de publicaci√≥n para indicar todo de la manera m√°s l√≥gica y esperada para el lector: </p><br><ul><li>  Primero, hablar√≠amos sobre c√≥mo est√° estructurado nuestro Sistema (la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">quinta publicaci√≥n</a> sobre Habr√©), y describir√≠amos las tres etapas principales del procesamiento de un documento cuando se verifica su pr√©stamo: <br><ol><li>  Extraiga el texto del documento (¬°est√° aqu√≠!); </li><li>  Busque pr√©stamos (las piezas ya est√°n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en varios de nuestros art√≠culos</a> ); </li><li>  Elaboraci√≥n de un informe sobre el documento (en planes). </li></ol></li><li>  Adem√°s, comenzar√≠amos a dedicar al lector al dispositivo de mecanismos auxiliares interesantes, como la b√∫squeda de pr√©stamos transferibles ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primer art√≠culo</a> ), la definici√≥n de par√°frasis ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cuarto</a> ) y la clasificaci√≥n tem√°tica ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">segundo</a> ). </li><li>  Y finalmente, llegamos al motor de b√∫squeda: el √≠ndice de herpes z√≥ster ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">s√©ptimo art√≠culo</a> ). </li></ul><br><p> Un lector atento debe haber notado que todav√≠a no sufrimos un perfeccionismo excesivo, por lo que es hora de pasar a la primera etapa: extraer texto y formatear documentos.  Esto es lo que haremos hoy, en el camino pensando en la fragilidad del ser y en la luz al final del t√∫nel, en la inexistencia de algo ideal y en la b√∫squeda de la excelencia, en tener un plan y seguirlo y en los compromisos a los que la vida siempre nos inclina. </p><br><h1>  Al principio era la palabra </h1><br><p>  Al principio, extrajimos de los documentos solo lo m√°s necesario para verificar su pr√©stamo: el texto de los documentos mismos.  Se admitieron los formatos principales: docx, doc, txt, pdf, rtf, html.  Luego se agregaron los ppt, pptx, odt, epub, fb2, djvu menos comunes, sin embargo, fue <abbr title="Dado que la muy baja demanda no justific√≥ el esfuerzo dedicado a soportar estos formatos">necesario negarse a</abbr> trabajar con la mayor√≠a de ellos <abbr title="Dado que la muy baja demanda no justific√≥ el esfuerzo dedicado a soportar estos formatos">en el futuro</abbr> .  Cada uno de ellos fue procesado a su manera, en alg√∫n lugar de una biblioteca separada, en alg√∫n lugar de su propio analizador.  En promedio, la extracci√≥n de texto dur√≥ aproximadamente cientos de milisegundos.  Parecer√≠a que la principal y casi la √∫nica dificultad para extraer texto es el "an√°lisis" del formato en s√≠, lo que es especialmente cierto para los formatos binarios pdf y doc (y la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">naturaleza propietaria de este</a> √∫ltimo hace que trabajar con √©l sea a√∫n m√°s problem√°tico).  Sin embargo, ya en esta etapa, cuando nuestros deseos se limitaban solo a extraer el texto, qued√≥ claro que cualquier forma de leer los formatos que necesit√°bamos conlleva una serie de caracter√≠sticas desagradables.  El m√°s significativo de ellos: </p><br><ul><li>  Las excepciones son incluso cuando se procesan algunos documentos v√°lidos, sin mencionar el procesamiento de documentos "rotos" formados incorrectamente.  Lo que crea a√∫n m√°s problemas es que el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo nativo</a> puede caerse, y manejar tales situaciones en c√≥digo .net es dif√≠cil; </li><li>  Consumo de memoria excesivamente alto, que puede da√±ar tanto los procesos vecinos como el actual que procesa el documento "problem√°tico" (sin memoria en el c√≥digo administrado o no administrado); </li><li>  Procesamiento demasiado largo de un documento, que se ve exacerbado por la falta de mecanismos de cancelaci√≥n para la mayor√≠a de las bibliotecas, y a veces por la complejidad (l√©ase: casi imposible) de cancelar una llamada de c√≥digo no administrada desde una administrada; </li><li>  "Extracci√≥n de texto de documentos".  Generar el texto de un documento pdf (y este formato es la clave para nosotros), cuyo an√°lisis ya se ha realizado, en contra de lo esperado, es una tarea no trivial.  El hecho es que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el formato pdf</a> se desarroll√≥ originalmente principalmente para la presentaci√≥n electr√≥nica de materiales de impresi√≥n.  El texto en PDF es un conjunto de bloques de texto ubicados en las p√°ginas de un documento.  Adem√°s, el bloque puede ser un p√°rrafo de texto o un solo car√°cter.  La tarea de restaurar el texto en su forma original de este conjunto de bloques recae en la biblioteca (c√≥digo / programa) que lee el documento.  S√≠, el formato, que comienza con una determinada versi√≥n, proporciona la capacidad de especificar el orden de los bloques, pero, desafortunadamente, los documentos con una secuencia marcada de bloques de texto son raros.  Por lo tanto, las bibliotecas de lectura de texto en PDF contienen una serie de heur√≠sticas (bueno, aqu√≠ es est√°ndar: aprendizaje autom√°tico, <s>bigdata, blockchain</s> , ...) que le permiten restaurar el texto en la forma correcta en un grado u otro, y, como se esperaba, el resultado obtenido difiere de una biblioteca a otra. . </li></ul><br><p><img src="https://habrastorage.org/webt/nr/hu/jb/nrhujbad4ji9xkwm5qzajzmvq24.png"></p><br><p>  <sub><em>Fuente de la imagen inferior: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a></em></sub> </p><br><p>  <sub><em>Fuente de la imagen superior: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hmm ...</a></em></sub> </p><br><h1>  ¬°Necesito m√°s datos! </h1><br><p>  Si, para analizar un documento para pr√©stamo, el fondo textual del documento fue suficiente para nosotros, entonces la implementaci√≥n de una serie de nuevas caracter√≠sticas es imposible o muy dif√≠cil sin extraer datos adicionales del documento.  Hoy, adem√°s del fondo del texto, tambi√©n extraemos el formato del documento y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">renderizamos las</a> im√°genes de la p√°gina.  Utilizamos este √∫ltimo para el reconocimiento √≥ptico de texto ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OCR</a> ), as√≠ como para identificar algunos tipos de derivaciones. </p><br><p>  El formateo de un documento incluye la disposici√≥n geom√©trica de todas las palabras y caracteres en las p√°ginas, as√≠ como el tama√±o de fuente de todos los caracteres.  Esta informaci√≥n nos permite: </p><br><ul><li>  Muestre maravillosamente el informe de verificaci√≥n del documento, dibujando los pr√©stamos detectados directamente en el documento original; <br><img src="https://habrastorage.org/webt/hk/uo/am/hkuoamt7hjscszy6lcgoc4vjeoy.png"><br></li><li>  Para determinar los bloques de documentos (p√°gina de t√≠tulo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bibliograf√≠a</a> ) con mayor precisi√≥n y recuperar sus metadatos (autores, t√≠tulo del trabajo, a√±o y lugar de trabajo, etc.); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Detectar intentos de derivaci√≥n del sistema.</a> </li></ul><br><p>  Para unificar el procesamiento de documentos y un conjunto de datos extra√≠dos, convertimos documentos de todos los formatos admitidos por nosotros a pdf.  Por lo tanto, el procedimiento para extraer datos del documento se lleva a cabo en dos etapas: </p><br><ul><li>  Convierte un documento a pdf; </li><li>  Extraer datos de pdf. </li></ul><br><h1>  Convierte a pdf.  Selecci√≥n de biblioteca </h1><br><p>  Dado que no es tan f√°cil tomar y convertir un documento a pdf, decidimos no reinventar la rueda y explorar soluciones ya preparadas, eligiendo la m√°s adecuada para nosotros.  Fue en 2017. </p><br><p>  Criterios para seleccionar candidatos: </p><br><ul><li>  Biblioteca en .net, idealmente .net core y multiplataforma <div class="spoiler">  <b class="spoiler_title">Spoiler!</b> <div class="spoiler_text">  Como resultado, en ese momento, el ideal era inalcanzable </div></div></li><li>  Soporte para formatos requeridos - doc, docx, rtf, odf, ppt, pptx </li><li>  Estabilidad </li><li>  Rendimiento </li><li>  Calidad de soporte t√©cnico </li><li>  Precio de emisi√≥n </li></ul><br><p>  Analizamos las soluciones disponibles, seleccionando entre ellas las 6 m√°s adecuadas para nuestras tareas: </p><br><div class="scrollable-table"><table><tbody><tr><th>  La biblioteca </th><th>  Problemas de superficie </th></tr><tr><td>  MS Word.  Interoperabilidad </td><td>  <b>Requiere:</b> MS Word.  Llame a Microsoft Word a trav√©s de COM.  El m√©todo tiene muchas desventajas: la necesidad de instalar MS Word, inestabilidad, bajo rendimiento.  Hay restricciones de licencia. </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DevExpress (17)</a> </td><td>  No es compatible con ppt, pptx </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Groupdocs</a> </td><td>  - </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Syncfusion</a> </td><td>  No es compatible con ppt, pptx, odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Neevia Document Converter Pro</a> </td><td>  Requiere: MS Word.  No es compatible con odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dynamicpdf</a> </td><td>  Requiere: MS Word, Internet Explorer.  No es compatible con odt </td></tr></tbody></table></div><br><p>  MS Word Interop, Neevia Document Converter Pro y DynamicPdf requieren la instalaci√≥n de MS Office en producci√≥n, lo que finalmente podr√≠a e irrevocablemente vincularnos con Windows.  Por lo tanto, ya no consideramos estas opciones. </p><br><p>  Por lo tanto, nos quedan tres candidatos principales, y solo uno de ellos es totalmente compatible con todos los formatos que necesitamos.  Bueno, es hora de ver de lo que son capaces. </p><br><p>  Para probar las bibliotecas, formamos una muestra de 120 mil documentos de usuarios reales, la proporci√≥n de los formatos en los que corresponde aproximadamente a lo que vemos todos los d√≠as en producci√≥n. </p><br><p>  Entonces la primera ronda.  Veamos qu√© proporci√≥n de documentos se puede convertir con √©xito en bibliotecas pdf en consideraci√≥n.  Con √©xito, en nuestro caso, no es lanzar una excepci√≥n, cumplir con el tiempo de espera de 3 minutos y devolver un texto no vac√≠o. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Convertidor </th><th rowspan="2">  Exitoso (%) </th><th colspan="5">  No exitoso (%) </th></tr><tr><th>  Total </th><th>  Texto en blanco </th><th>  Excepci√≥n </th><th>  Tiempo de espera (3 minutos) </th><th>  Ca√≠da del proceso </th></tr><tr><td>  Groupdocs </td><td>  99,012 </td><td>  0.988 </td><td>  0,039 </td><td>  0.873 </td><td>  0,076 </td><td>  0 0 </td></tr><tr><td>  DevExpress </td><td>  99,819 </td><td>  0,181 </td><td>  0.123 </td><td>  0,019 </td><td>  0,039 </td><td>  0 0 </td></tr><tr><td>  Syncfusion </td><td>  98,358 </td><td>  1.632 </td><td>  0,039 </td><td>  0.848 </td><td>  0,745 </td><td>  0,01 </td></tr></tbody></table></div><br><p>  Syncfusion se destac√≥ de inmediato, que no solo pudo procesar con √©xito la menor cantidad de documentos, sino que tambi√©n descarg√≥ todo el proceso en algunos documentos (generando excepciones como OutOfMemoryException o excepciones del c√≥digo nativo que no se detectaron sin bailar con una pandereta). </p><br><p>  GroupDocs no pudo procesar aproximadamente <b>5,5</b> veces m√°s documentos que DevExpress (todo se puede ver en la placa de arriba).  Esto a pesar del hecho de que una sola licencia de desarrollador de GroupDocs es aproximadamente 9 veces m√°s costosa que una sola licencia de desarrollador de DevExpress.  Esto es as√≠, por cierto. </p><br><p>  La segunda prueba seria es el tiempo de conversi√≥n, los mismos 120 mil documentos: </p><br><div class="scrollable-table"><table><tbody><tr><th>  Convertidor </th><th>  Media (seg.) </th><th>  Mediana (seg.) </th><th>  Est√°ndar (seg.) </th></tr><tr><td>  Groupdocs </td><td>  1.301966 </td><td>  0.328000 </td><td>  6.401197 </td></tr><tr><td>  DevExpress </td><td>  0.523453 </td><td>  0.252000 </td><td>  1.781898 </td></tr><tr><td>  Syncfusion </td><td>  8.922892 </td><td>  4.987000 </td><td>  12.929588 </td></tr></tbody></table></div><br><img src="https://habrastorage.org/webt/g5/2h/3k/g52h3klfh-leliffdwmrtmgapxy.png"><br><br><p>  Tenga en cuenta que DevExpress no solo procesa documentos m√°s r√°pido en promedio, sino que tambi√©n muestra un tiempo de procesamiento mucho m√°s estable. </p><br><p>  Pero la estabilidad y la velocidad de procesamiento no significan nada si el resultado es un pdf incorrecto.  ¬øQuiz√°s DevExpress se salta la mitad del texto?  Lo comprobamos  Entonces, los mismos 120 mil documentos, esta vez calcularemos el volumen total del texto extra√≠do y la participaci√≥n promedio de las palabras del diccionario (mientras m√°s palabras extra√≠das sean diccionario, menos basura / texto extra√≠do incorrectamente): </p><br><div class="scrollable-table"><table><tbody><tr><th>  Convertidor </th><th>  La cantidad total de texto (en caracteres) </th><th>  La proporci√≥n promedio de palabras de vocabulario </th></tr><tr><td>  Groupdocs </td><td>  6 321 145 966 </td><td>  0.949172 </td></tr><tr><td>  DevExpress </td><td>  6 135 668 416 </td><td>  0.950629 </td></tr><tr><td>  Syncfusion </td><td>  5,995,008,572 </td><td>  0.938693 </td></tr></tbody></table></div><br><p>  En parte, la suposici√≥n era correcta.  Result√≥ que GroupDocs, a diferencia de DevExpress, puede trabajar con notas al pie.  DevExpress simplemente los omite al convertir un documento a pdf.  Por cierto, s√≠, el texto del pdf'ok recibido en todos los casos se extrae usando DevExpress'a. </p><br><p>  Entonces, estudiamos la velocidad y la estabilidad de las bibliotecas en cuesti√≥n, ahora evaluamos cuidadosamente la calidad de la conversi√≥n de documentos pdf.  Para hacer esto, analizaremos no solo el volumen del texto que se extraer√° y la proporci√≥n de palabras del diccionario, sino que compararemos los textos extra√≠dos de los archivos PDF recibidos con los textos PDF obtenidos con MS Word.  Aceptamos el resultado de convertir un documento usando MS Word como <i>pdf de referencia</i> .  Se prepararon alrededor de 4.500 pares de " <i>documento, referencia pdf'ka</i> " para esta prueba. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Convertidor </th><th rowspan="2">  <abbr title="Porcentaje de documentos que la biblioteca pudo extraer">Texto extra√≠do (%)</abbr> </th><th colspan="3">  Proximidad a la longitud del texto. </th><th colspan="3">  Proximidad por frecuencia de palabra </th></tr><tr><th>  Media </th><th>  Mediana </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SKO</a> </th><th>  Media </th><th>  Mediana </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SKO</a> </th></tr><tr><td>  Groupdocs </td><td>  99,131 </td><td>  0.985472 </td><td>  0.999756 </td><td>  0,095304 </td><td>  0.979952 </td><td>  1.000000 </td><td>  0.102316 </td></tr><tr><td>  DevExpress </td><td>  99,726 </td><td>  0.971326 </td><td>  0.996647 </td><td>  0,075951 </td><td>  0.965686 </td><td>  0.996101 </td><td>  0,082192 </td></tr><tr><td>  Syncfusion </td><td>  89,336 </td><td>  0.880229 </td><td>  0.996845 </td><td>  0.306920 </td><td>  0.815760 </td><td>  0.998206 </td><td>  0.348621 </td></tr></tbody></table></div><br><p>  Para cada par " <i>pdf de referencia, resultado de conversi√≥n</i> ", calculamos la similitud en la longitud del texto extra√≠do y en las frecuencias de las palabras extra√≠das.  Naturalmente, estas m√©tricas se obtuvieron solo en aquellos casos en que la conversi√≥n fue exitosa.  Por lo tanto, no consideramos los resultados de Syncfusion aqu√≠.  DevExpress y GroupDocs mostraron aproximadamente el mismo rendimiento.  En el lado de DevExpress, hay un porcentaje significativamente mayor de conversiones exitosas, en el lado de GD, trabajo correcto con notas al pie. </p><br><p>  Dados los resultados, la elecci√≥n era obvia.  Hasta el d√≠a de hoy, estamos utilizando la soluci√≥n de DevExpress y pronto planearemos actualizar a su versi√≥n 19. </p><br><h1>  Hay un pdf, extrae el texto con formato </h1><br><p>  Entonces, podemos convertir documentos a pdf.  Ahora tenemos otra tarea: usar DevExpress para extraer el texto, conociendo cada palabra toda la informaci√≥n que necesitamos.  A saber: </p><br><ul><li>  En qu√© p√°gina est√° la palabra; </li><li>  La ubicaci√≥n de la palabra en la p√°gina (enmarcando un rect√°ngulo); </li><li>  El tama√±o de fuente de la palabra (caracteres de palabras). </li></ul><br><p>  La imagen muestra el desglose del texto en p√°ginas, y tambi√©n muestra la correspondencia de una palabra de texto con el √°rea de la p√°gina. </p><br><p><img src="https://habrastorage.org/webt/sv/zy/ja/svzyjafy1nmstmlbblte4uhdpwg.png"></p><br><p>  <sub><em>Fuente de la imagen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Extracci√≥n de metadatos de encabezado de documentos cient√≠ficos</a></em></sub> </p><br><p>  Parece que todo deber√≠a ser simple.  Miramos lo que API DevExpress nos proporciona: </p><br><ul><li>  Tenemos un m√©todo que devuelve el texto de todo el documento.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cadena</a> simple; </li><li>  Tenemos la capacidad de iterar de acuerdo con el documento.  Por cada palabra podemos obtener: <br><ul><li>  Texto de la palabra; </li><li>  La p√°gina en la que se encuentra la palabra; </li><li>  El rect√°ngulo enmarcado de la palabra; </li><li>  Informaci√≥n sobre los caracteres individuales de la palabra (el significado del car√°cter que enmarca el rect√°ngulo, el tama√±o de fuente, ...). </li></ul><br></li></ul><br><p>  Bien, todo parece estar ah√≠.  Solo aqu√≠ se explica c√≥mo obtener los datos necesarios para cada palabra en el texto del documento que devuelve DevExpress.  Realmente no queremos recopilar el texto del documento a partir de las palabras, ya que, por ejemplo, no tenemos informaci√≥n sobre el espacio entre las palabras y d√≥nde se encuentra el avance de l√≠nea.  Tendremos que proponer heur√≠sticas basadas en la ubicaci√≥n de las palabras ... El texto est√° aqu√≠, antes de nosotros, ya ensamblado. </p><br><p><img src="https://habrastorage.org/webt/ti/d9/ru/tid9ruengnw06fe0krbvfqbpfle.jpeg"></p><br><p>  <sub><em>Fuente de la imagen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Eureka!</a></em></sub> </p><br><p>  La soluci√≥n obvia es unir las palabras con el texto del documento.  Observamos, de hecho, en el texto del documento, las palabras est√°n ordenadas en el mismo orden en que son devueltas por el iterador de acuerdo con las palabras del documento. </p><br><p>  Implementamos r√°pidamente un algoritmo simple para unir palabras con el texto del documento, agregamos controles para que todo coincida correctamente, comenzamos ... </p><br><p><img src="https://habrastorage.org/webt/uc/xw/ks/ucxwkst9qdybxsrwsgrxi4qncyk.png"></p><br><p>  De hecho, todo funciona correctamente en la gran mayor√≠a de las p√°ginas, pero, desafortunadamente, no en todas las p√°ginas. </p><br><img src="https://habrastorage.org/webt/mm/sc/gb/mmscgb1gygbne-ail3tsccjs_ik.png"><br><p>  <sub><em>Fuente de la imagen superior: <a href="">¬øEst√°s seguro?</a></em></sub> </p><br><p>  Por parte de los documentos, vemos que las palabras en el texto no est√°n en el orden en que van al iterar sobre las palabras del documento.  Adem√°s, se puede ver que el corchete de apertura en el texto en la lista de palabras se representa como el corchete de cierre y est√° en otra "palabra".  La visualizaci√≥n correcta de este fragmento de texto se puede ver abriendo el documento en MS Word.  Lo que es m√°s interesante, si no convierte el documento a pdf, pero extrae directamente el texto del documento, obtenemos la tercera versi√≥n del fragmento de texto que no coincide con el orden correcto ni con los otros dos pedidos recibidos de la biblioteca.  En este fragmento, como en la mayor√≠a del resto, en el que surge un problema similar, el punto est√° en los caracteres invisibles "RTL", que cambian el orden de los caracteres / palabras adyacentes. </p><br><p>  Aqu√≠ vale la pena recordar que llamamos a la calidad del soporte t√©cnico importante al elegir una biblioteca.  Como la pr√°ctica ha demostrado, en este aspecto, la interacci√≥n con DevExpress es bastante efectiva.  El problema con el documento enviado se solucion√≥ r√°pidamente despu√©s de que creamos el ticket correspondiente.  Tambi√©n se solucionaron otros problemas relacionados con excepciones / alto consumo de memoria / procesamiento de documentos largos. </p><br><p>  Sin embargo, aunque DevExpress no proporciona una forma directa de obtener el texto con la informaci√≥n necesaria para cada palabra, seguimos comparando a veces incomparable.  Si no podemos construir una coincidencia exacta entre palabras y texto, usamos una serie de heur√≠sticas que permiten peque√±as permutaciones de palabras.  Si nada ayuda, el documento permanece sin formatear.  Raramente, pero esto sucede. </p><br><p>  Adios :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/458842/">https://habr.com/ru/post/458842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458830/index.html">Seminarios web de Dell Technologies: todos los detalles de nuestro tutorial</a></li>
<li><a href="../458832/index.html">Cinco estudiantes y tres tiendas distribuidas de valor clave</a></li>
<li><a href="../458834/index.html">Lado de la personalidad de Paul Allen, sobre el cual no tanta gente sab√≠a como me gustar√≠a</a></li>
<li><a href="../458836/index.html">√çndice de Borsch. Un enfoque sistem√°tico para evaluar, comparar y determinar la relaci√≥n calidad / precio.</a></li>
<li><a href="../458840/index.html">C√≥mo atravesamos el Gran Firewall chino (parte 2)</a></li>
<li><a href="../458844/index.html">Destrucci√≥n de silos a trav√©s del enfoque de adaptaci√≥n VeriSM ‚Ñ¢</a></li>
<li><a href="../458846/index.html">C√≥mo desarrollar otro juego de plataformas con Unity. Otro tutorial</a></li>
<li><a href="../458848/index.html">Lanzamiento de Rust 1.36.0: Rasgo futuro, estabilizaci√≥n de asignaci√≥n y Quiz√°sUninit <T></a></li>
<li><a href="../458850/index.html">Aprende ingl√©s de forma econ√≥mica y eficiente. Parte 2</a></li>
<li><a href="../458854/index.html">MotionLayout: las animaciones son mejores, menos c√≥digo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>