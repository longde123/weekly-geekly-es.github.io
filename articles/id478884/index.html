<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏻 🧑🏻‍🤝‍🧑🏻 🐈 Cara menyiapkan RTSP di situs pada tahun 2020, atau mengapa babi hutan tidak punya waktu untuk melarikan diri 👥 😚 🌬️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RTSP adalah protokol pensinyalan sederhana yang belum digantikan oleh apa pun selama bertahun-tahun, dan kita harus mengakui bahwa mereka tidak benar-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara menyiapkan RTSP di situs pada tahun 2020, atau mengapa babi hutan tidak punya waktu untuk melarikan diri</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/478884/"><p><img src="https://habrastorage.org/webt/0o/qj/i7/0oqji7xkok-ssze_oqdnr2kmfcg.jpeg"></p><br><p>  RTSP adalah protokol pensinyalan sederhana yang belum digantikan oleh apa pun selama bertahun-tahun, dan kita harus mengakui bahwa mereka tidak benar-benar mencoba. </p><br><p>  Katakanlah kita memiliki kamera IP dengan dukungan RTSP.  Siapa pun yang merasakan lalu lintas dengan kabel hiu akan memberi tahu Anda bahwa DESCRIBE berjalan lebih dulu, lalu MAIN, lalu lalu lintas dituangkan langsung melalui RTP atau dibungkus dalam saluran TCP yang sama. </p><a name="habracut"></a><br><p>  Pengaturan koneksi RTSP yang khas adalah sebagai berikut: </p><br><p><img src="https://habrastorage.org/webt/yi/i9/kw/yii9kwulxpxxz1dywpppxqdy0ko.png"></p><br><p>  Jelas bahwa untuk browser, dukungan protokol RTSP berlebihan dan membutuhkan kaki kelima seperti anjing, sehingga browser tidak terburu-buru untuk mengimplementasikannya secara besar-besaran dan kecil kemungkinannya untuk pernah melakukannya.  Di sisi lain, browser dapat membuat koneksi TCP langsung, dan ini akan menyelesaikan masalah, tetapi di sini semuanya tergantung pada keamanan - di mana Anda melihat browser yang memungkinkan skrip untuk menggunakan protokol transport secara langsung? </p><br><p>  Tetapi orang-orang memerlukan streaming di "browser apa pun tanpa menginstal perangkat lunak tambahan", dan startup menulis di situs mereka "Anda tidak perlu menginstal apa pun - itu bekerja di semua browser di luar kotak" ketika mereka ingin menunjukkan streaming dari kamera IP. </p><br><p>  Pada artikel ini, kita akan mencari cara untuk mencapai ini.  Dan karena ada angka bulat di halaman, kami akan memberikan relevansi artikel dan menggantung label 2020, terutama karena memang begitu. </p><br><p>  Jadi, teknologi apa untuk menampilkan video pada halaman web yang harus dilupakan pada tahun 2020?  Flash di browser.  Dia sudah mati.  Dia tidak lagi - dicoret. </p><br><h3 id="tri-godnyh-sposoba">  Tiga cara bagus </h3><br><p>  Alat yang memungkinkan Anda menonton streaming video di browser hari ini adalah: </p><br><ol><li>  WebRTC </li><li>  Hl </li><li>  Websocket + MSE </li></ol><br><h4 id="chto-ne-tak-s-webrtc">  Apa yang salah dengan WebRTC </h4><br><p>  Dua kata: padat sumber daya dan kompleks. </p><br><p> Nah, apa intensitas sumber daya?  - Anda melambaikannya, karena hari ini prosesornya kuat, ingatannya murah, apa masalahnya?  Yah, pertama-tama, ini adalah enkripsi paksa semua lalu lintas, bahkan jika Anda tidak membutuhkannya.  Kedua, WebRTC adalah komunikasi dua arah yang kompleks dan pertukaran umpan balik tentang kualitas saluran antara rekan dan rekan (dalam hal ini, antara rekan dan server) - pada setiap kali bitrate dihitung, paket loss dilacak, keputusan dibuat untuk mengirimnya, dan sekitar itu Secara total, sinkronisasi audio dan video, yang disebut lipsync, dihitung sehingga bibir pembicara tidak menyimpang dari kata-katanya.  Semua perhitungan ini, serta lalu lintas yang masuk ke server, mengalokasikan dan membebaskan RAM gigabyte waktu nyata dan, jika terjadi kesalahan, server 256-gigabyte dengan 48 core CPU akan dengan mudah menjadi tailspin meskipun semua gigahertz, nanometer, dan DDR 10 di atas kapal. </p><br><p>  Ternyata menembak Sparrows dari Iskander.  Kami hanya perlu menyedot aliran RTSP dan menunjukkannya, dan WebRTC mengatakan: ya, silakan, tetapi Anda harus membayar untuk itu. </p><br><h3 id="chem-horosh-webrtc">  Apa yang baik tentang WebRTC </h3><br><p>  Tunda  Dia sangat rendah.  Jika Anda bersedia membayar dengan kinerja dan kompleksitas untuk latensi rendah, WebRTC adalah pilihan terbaik. </p><br><h4 id="chem-horosh-hls">  Apa yang baik tentang HLS </h4><br><p>  Dua kata: bekerja di mana-mana </p><br><p>  HLS adalah kendaraan segala medan yang paling lambat di dunia tampilan konten langsung.  Di mana-mana ia bekerja berkat dua hal: transportasi HTTP dan perlindungan Apple.  Memang, protokol HTTP ada di mana-mana, saya merasakan keberadaannya, bahkan ketika saya menulis baris-baris ini.  Karena itu, di mana pun Anda berada dan apa pun yang dijelajahi tablet kuno, HLS (HTTP Live Streaming) akan menjangkau Anda dan mengirimkan video ke layar Anda, pastikan. </p><br><p>  Dan semuanya akan baik-baik saja, tetapi. </p><br><h4 id="chem-ploh-hls">  Dari HLS yang buruk </h4><br><p>  Tunda  Misalnya, ada proyek pengawasan video untuk lokasi konstruksi.  Objek telah dibangun selama bertahun-tahun, dan pada saat ini sebuah kamar malang, siang dan malam, melepas situs konstruksi 24 jam sehari.  Ini adalah contoh di mana latensi rendah tidak diperlukan. </p><br><p>  Contoh lain adalah babi hutan.  Babi hutan nyata.  Petani Ohio menderita dari invasi babi hutan, yang, seperti belalang, makan dan menginjak-injak tanaman, mengancam kesejahteraan keuangan ekonomi.  Startup yang giat telah meluncurkan sistem pengawasan video dengan kamera RTSP, yang secara real time memantau tanah dan menurunkan perangkap ketika diserang oleh tamu yang tidak diundang.  Dalam hal ini, penundaan rendah sangat penting dan, saat menggunakan HLS (dengan penundaan 15 detik), babi hutan akan lari sebelum perangkap diaktifkan. </p><br><p><img src="https://habrastorage.org/webt/g4/ha/iw/g4haiwkwu7jqrhh65c804phjt-q.jpeg"></p><br><p>  Contoh lain: presentasi video di mana Anda mendemonstrasikan produk dan mengharapkan respons yang cepat.  Dalam kasus keterlambatan besar, mereka akan menunjukkan barang-barang di kamera, lalu mereka akan bertanya "bagaimana?" Dan ini akan mencapai hanya dalam 15 detik.  Dalam 15 detik, sinyal dapat didorong 12 kali ke bulan dan kembali.  Tidak, kami tidak perlu penundaan seperti itu.  Ini lebih seperti menampilkan video yang direkam sebelumnya daripada di Live.  Tetapi tidak ada yang mengejutkan, HLS bekerja seperti ini: ia menulis potongan video ke disk atau ke memori server, dan pemain mengunduh potongan yang direkam.  Hasilnya adalah HTTP Live, yang bukan Live sama sekali. </p><br><p>  Mengapa ini terjadi?  Di mana-mana protokol HTTP dan kesederhanaannya akhirnya diterjemahkan menjadi hambatan - yah, HTTP tidak dimaksudkan untuk digunakan untuk mengunduh dan menampilkan ribuan video dalam jumlah besar (segmen HLS) dengan cepat.  Tentu saja, mereka mengunduh dan bermain dengan kualitas yang baik, tetapi sangat lambat - saat mengunduh, sambil buffering, pergi ke decoder, 15 detik atau lebih yang sama akan berlalu. </p><br><p>  Perlu dicatat bahwa Apple pada musim gugur 2019 mengumumkan HLS Low Latency, tapi itu cerita lain.  Kita akan melihat apa yang terjadi, lebih terinci nanti.  Dan kami masih memiliki stok MSE. </p><br><h4 id="chem-horosh-mse">  Apa itu MSE yang baik? </h4><br><p>  Media Source Extension adalah dukungan asli untuk memutar video batch di browser.  Kita dapat mengatakan pemain asli untuk H.264 dan AAC, yang dapat memberi makan segmen video dan yang tidak terikat dengan protokol transport, tidak seperti HLS.  Untuk alasan ini, transportasi dapat dipilih menggunakan protokol Websockets.  Dengan kata lain, segmen tidak lagi diunduh menggunakan teknologi Request-Response (HTTP) kuno, tetapi mengalir asyik melalui koneksi Websockets - saluran TCP yang hampir langsung.  Ini sangat membantu dengan mengurangi penundaan, yang dapat dikurangi menjadi 3-5 detik.  Penundaan tidak super, tetapi cocok untuk sebagian besar proyek yang tidak memerlukan waktu nyata yang sulit.  Kompleksitas dan konsumsi sumber daya juga relatif rendah - saluran TCP terbuka dan segmen HLS yang hampir sama mengalir seperti yang dikumpulkan oleh pemain dan ditempatkan untuk diputar. </p><br><h4 id="chem-ploh-mse">  Apa itu MSE yang buruk? </h4><br><p>  Itu tidak bekerja di mana-mana.  Seperti WebRTC, penetrasi browser kurang.  IPhones (iOS) terutama terlibat dalam tidak memainkan MSE, yang membuat MSE tidak cocok sebagai satu-satunya solusi untuk startup apa pun. </p><br><p>  Sepenuhnya tersedia di browser: Edge, Firefox, Chrome, Safari, Browser Android, Opera Mobile, Chrome untuk Android, Firefox untuk Android, UC Browser untuk Android </p><br><p><img src="https://habrastorage.org/webt/xt/oq/wn/xtoqwnjdoosqb6fhopu9rvoxsxy.png"></p><br><p>  IOS Safari memiliki dukungan terbatas untuk MSE baru-baru ini, dimulai dengan iOS versi 13. </p><br><p><img src="https://habrastorage.org/webt/fl/wd/-n/flwd-nksnux1tlprjriupeajyvm.png"></p><br><h3 id="rtsp-noga">  Kaki Rtsp </h3><br><p>  Kami membahas pengiriman ke server video&gt; browser.  Selain itu, dua hal lagi akan diperlukan: </p><br><p>  1) Kirim video dari kamera IP ke server. </p><br><p>  2) Konversi video yang diterima ke salah satu format / protokol di atas. </p><br><p>  Di sini sisi server memasuki lokasi. </p><br><p>  TaTam ... Web Call Server 5 (hanya untuk kenalan WCS).  Seseorang harus menerima lalu lintas RTSP, dengan benar meng-de-paketkan video, mengkonversinya menjadi WebRTC, HLS atau MSE, lebih disukai tanpa diperas oleh transcoder, dan memberikannya ke sisi browser secara layak, tidak dimanjakan oleh artefak dan membeku. </p><br><p>  Tugasnya, pada pandangan pertama, tidak sulit, tetapi ada begitu banyak jebakan, kamera Cina dan nuansa konversi yang mengerikan.  Secara umum, bukan tanpa peretasan, tetapi bekerja, dan berfungsi dengan baik.  Dalam produksi. </p><br><h4 id="shema-dostavki">  Skema Pengiriman </h4><br><p>  Akibatnya, skema holistik untuk mengirimkan konten RTSP dengan konversi pada server perantara muncul. </p><br><p><img src="https://habrastorage.org/webt/jm/7e/oj/jm7eojlfeztudqtrwzjebgu4t9e.png"></p><br><p>  Salah satu permintaan paling sering dari rekan kerja India kami “Apakah mungkin?  Langsung tanpa server? "  Tidak, itu tidak mungkin - Anda memerlukan bagian server yang akan melakukan pekerjaan ini.  Di awan, pada potongan besi, pada core7 di balkon, tetapi tanpa itu dengan cara apa pun. </p><br><h4 id="vernemsya-k-nashemu-2020-godu">  Kembali ke tahun 2020 kami </h4><br><p>  Jadi, resep untuk RTSP di browser: </p><br><ol><li>  Dapatkan WCS baru (Server Panggilan Web). </li><li>  Tambahkan secukupnya: WebRTC, HLS atau MSE. </li><li><p>  Lay out di halaman web. </p><br><p>  Bon appetit! </p><br></li></ol><br><h3 id="net-esche-ne-vse">  Tidak, belum semuanya </h3><br><p>  Neuron yang ingin tahu pasti akan memiliki pertanyaan "Bagaimana?"  Nah bagaimana cara melakukannya?  Seperti apa nantinya di browser? ”  Perhatian Anda adalah pemain WebRTC minimum yang dibuat di lutut: </p><br><p>  1) Kami menghubungkan skrip flashphoner.js dan skrip my_player.js ke halaman web API utama, yang akan kami buat nanti. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  2) Kami menginisialisasi API di badan halaman web </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  3) Kami membuang halaman div, yang akan menjadi wadah untuk video.  Kami akan menunjukkan kepadanya ukuran dan perbatasan. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  4) Tambahkan tombol Play, klik yang akan memulai koneksi ke server dan mulai pemutaran </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><p>  5) Sekarang buat skrip my_player.js - yang akan berisi kode utama pemain kami.  Kami menggambarkan konstanta dan variabel </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session;</code> </pre> <br><p>  6) Kami menginisialisasi API saat memuat halaman HTML </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_api</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"init api"</span></span>); Flashphoner.init({ }); }</code> </pre> <br><p>  7) Hubungkan ke server WCS melalui WebSocket.  Agar semuanya berfungsi dengan benar, ganti "wss: //demo.flashphoner.com" dengan WCS Anda </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ session = Flashphoner.createSession({<span class="hljs-attr"><span class="hljs-attr">urlServer</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://demo.flashphoner.com"</span></span>}).on(SESSION_STATUS.ESTABLISHED, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">session</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"connection established"</span></span>); playStream(session); }); }</code> </pre> <br><p>  8) Selanjutnya, kami melewati dua parameter: nama dan tampilan: nama - RTSP URL dari aliran yang sedang diputar.  display - elemen myVideo tempat pemain kita akan dipasang.  Di sini, tentukan juga URL aliran yang Anda butuhkan, bukan milik kami. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">"rtsp://b1.dnsdojo.com:1935/live/sys2.stream"</span></span>,<span class="hljs-attr"><span class="hljs-attr">display</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"myVideo"</span></span>)}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stream = session.createStream(options).on(STREAM_STATUS.PLAYING, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"playing"</span></span>); }); stream.play(); }</code> </pre> <br><p>  Kami menyimpan file dan mencoba memulai pemain.  Apakah streaming RTSP Anda diputar? </p><br><p>  Ketika kami menguji, kami memainkan yang ini: rtsp: //b1.dnsdojo.com: 1935 / live / sys2.stream. </p><br><p>  Dan terlihat seperti ini: </p><br><p>  Pemain sebelum menekan tombol "Mainkan" </p><br><p><img src="https://habrastorage.org/webt/pe/ej/6n/peej6nfw2lthkmmnsrypojl6bzq.png"></p><br><p>  Player dengan menjalankan video </p><br><p><img src="https://habrastorage.org/webt/w3/h8/yo/w3h8yozn6madl2tolxx_xg3yljs.png"></p><br><p>  Ada sedikit kode: </p><br><p>  HTML </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Javascript </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//Status constants var SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; var STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; //Websocket session var session; //Init Flashphoner API on page load function init_api() { console.log("init api"); Flashphoner.init({ }); } //Connect to WCS server over websockets function connect() { session = Flashphoner.createSession({urlServer: "wss://demo.flashphoner.com"}).on(SESSION_STATUS.ESTABLISHED, function(session){ console.log("connection established"); playStream(session); }); } //Playing stream with given name and mount the stream into myVideo div element function playStream() { var options = {"rtsp://b1.dnsdojo.com:1935/live/sys2.stream",display:document.getElementById("myVideo")}; var stream = session.createStream(options).on(STREAM_STATUS.PLAYING, function(stream) { console.log("playing"); }); stream.play(); }</span></span></code> </pre> <br><p>  Sisi server adalah demo.flashphoner.com.  Kode contoh lengkap tersedia di bawah ini di ruang bawah tanah dengan tautan.  Selamat streaming! </p><br><h3 id="ssylki">  Referensi </h3><br><p>  <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_api-2.0/examples/demo/streaming/player">Kode pemain di github</a> </p><br><p>  <a href="https://flashphoner.com/translyaciya-rtsp-kontenta-na-web-brauzery-cher/%3Flang%3Dru">Integrasi pemain RTSP ke halaman web atau aplikasi seluler</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id478884/">https://habr.com/ru/post/id478884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id478858/index.html">Membandingkan Sesi Pembuatan Profil di Admin XHProf</a></li>
<li><a href="../id478862/index.html">Bagaimana pengujian frontend diatur di Yandex.Market dan mengapa kami menolak rilis mingguan</a></li>
<li><a href="../id478866/index.html">Meet Space - Produk Baru dari JetBrains</a></li>
<li><a href="../id478872/index.html">DIY: cara kami mengotomatiskan pemantauan gudang</a></li>
<li><a href="../id478878/index.html">Sepotong kode paling populer dalam sejarah StackOverflow memiliki bug!</a></li>
<li><a href="../id478886/index.html">Komponen Sudut dengan Konten Inline</a></li>
<li><a href="../id478888/index.html">Beberapa pemikiran tentang modular css dan masalah dukungan kode</a></li>
<li><a href="../id478890/index.html">Di mana paket saya? AI akan memfasilitasi tugas pengiriman</a></li>
<li><a href="../id478892/index.html">Menjadi sukarelawan sebagai cara hidup</a></li>
<li><a href="../id478894/index.html">Pelajari Azure dalam Satu Bulan Makan Siang - e-book gratis baru kami</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>