<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐥 👡 ✈️ Shadowplay LED Watch auf der Arduino Uno Plattform 🃏 👩🏿‍🎨 👩‍❤️‍👨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anstatt mitzumachen
 
 
 Unser dreiköpfiges Team hatte also die Aufgabe, in kürzester Zeit ein kleines Hardwareprojekt zusammenzustellen, vorzugsweise...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Shadowplay LED Watch auf der Arduino Uno Plattform</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394107/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstatt mitzumachen</font></font></h3><br>
<img src="https://habrastorage.org/files/48b/451/4a6/48b4514a6fd144ba8e19798a1588bd87.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser dreiköpfiges Team hatte also die Aufgabe, in kürzester Zeit ein kleines Hardwareprojekt zusammenzustellen, vorzugsweise auf der Arduino-Plattform. </font><font style="vertical-align: inherit;">Es ist erwähnenswert, dass wir bis zu diesem Moment zum größten Teil theoretisch mit Schaltkreisen vertraut waren. </font><font style="vertical-align: inherit;">Und das bedeutet - weder Erfahrung mit einem Lötkolben (praktisch) noch insbesondere Erfahrung mit Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plötzlich stießen wir auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gewidmet dem Shadowplay Clock Projekt. </font><font style="vertical-align: inherit;">Dies ist eine Wanduhr, die von einem Team von Wiener Designern entworfen wurde. Die Zeit, zu der Sie sehen können, indem Sie einen Finger auf ihre Mitte legen. </font><font style="vertical-align: inherit;">Die LEDs leuchten so, dass der Schatten des Fingers in der Mitte die Zeit anzeigt. </font><font style="vertical-align: inherit;">Es wurde beschlossen, dasselbe (oder sehr ähnliche) zu erstellen, aber zu Hause. </font><font style="vertical-align: inherit;">Wie Sie sehen, enthält der obige Artikel keine detaillierte Beschreibung des Projekts. </font><font style="vertical-align: inherit;">Daraus folgte, dass wir selbst herausfinden mussten, wie dieses Gerät funktioniert, und es zum Leben erwecken mussten. </font><font style="vertical-align: inherit;">Was wir tatsächlich getan haben.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Materialien</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um eine Uhr zu erstellen, benötigen Sie:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Faserplattenrohlinge</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 60 LED Diodenstreifen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arduino uno</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Echtzeituhrmodul RTC DS1307</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Taste</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Steckbrett</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schieberegister 74HC595 (x2)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8-Bit-Register-Latch 74HC573N (x8)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Decoder 4-16 K155ID3 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> offener Abflusswechselrichter IN74HC05AN (x10)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Netzteil </font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fangen wir an</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, der Algorithmus des Geräts:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Strom angelegt wird, leuchten die LEDs in einer vorgegebenen Kombination. </font><font style="vertical-align: inherit;">Im ursprünglichen Shadowplay leuchteten alle LEDs auf, aber es schien uns interessanter, eine Kombination als Bildschirmschoner zu starten.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn die Taste gedrückt wird (ja, wir haben uns auch vom Original entfernt und eine kleine Taste in die Mitte eingefügt), wird die Zeit vom RTC-Modul abgelesen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Lesezeit wird in Binärcode (Maske) umgewandelt und in Register eingetragen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je nach Maske wird die gewünschte Diode gezündet.</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardware</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als wir uns schließlich für die Idee des Projekts entschieden hatten, versuchten wir zunächst, ungefähre Versionen der Schemata für deren Umsetzung zu skizzieren. Die Hauptfrage war, wie 60 LEDs angesprochen werden sollen. Tatsächlich bestimmte die Antwort auf diese Frage die Methode, fast das gesamte Schema zu konstruieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste Option, die mir in den Sinn kam, war die Verwendung von Decodern. Die kompilierte Schaltung bestand aus einer Kaskade von vier Decodern 4-16 und einem Decoder 2-4, beide mit Entschlüsselungsfreigabeeingängen. Eine solche Kaskade ermöglichte die Adressierung von 64 Ausgängen, was mehr als genug war, um 60 LEDs anzuschließen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann stellte sich jedoch die Frage, wie mehr als eine LED gleichzeitig funktionieren kann (Adresse) (schließlich mussten wir der Uhr mindestens die Minuten- und Uhrzeiger zur Verfügung stellen). Hier zeigte sich der Hauptnachteil dieses Schemas - der Decoder kann per Definition nicht mehr als einen Ausgang gleichzeitig adressieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Fehler zwang uns, die Idee mit einer Kaskade von Decodern aufzugeben. Darüber hinaus haben wir jetzt eine weitere Anforderung für die zukünftige Schaltung - die Unterstützung für den gleichzeitigen Betrieb einer anderen Anzahl von LEDs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese Anforderung zu erfüllen, dachten wir, dass es möglich ist, jeder LED zu ermöglichen, ihren Zustand zu speichern. Register sind für diesen Zweck gut geeignet, wobei jede einzelne Entladung dem Zustand einer der LEDs entspricht. Wir haben uns für 8-Bit-Register entschieden, da diese häufiger und praktischer sind. Dementsprechend benötigen wir in unserer Schaltung 8 solcher Register, um 60 LEDs zu unterstützen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes haben wir darüber nachgedacht, wie der Status von LEDs mit Arduino über Register gesteuert werden kann. Jedes Register für den normalen Betrieb sollte alle 8 Bits in seiner Gesamtheit empfangen. Arduino Uno bietet natürlich genügend Ausgänge, um mehrere Bits gleichzeitig zu übertragen, aber dieser Ansatz ist nicht rational. Darüber hinaus enthält das Schema nur 8 Register, was bedeutet, dass Sie sie irgendwie adressieren müssen. Zu diesem Zweck haben wir einen Decoder und zwei 8-Bit-Schieberegister hinzugefügt, die in Kaskade mit der Schaltung verbunden sind. Ein Schieberegister speichert eine 8-Bit-Zustandsmaske, die in eines von 8 regulären Registern geladen wird, deren Nummer im zweiten Schieberegister gespeichert ist. Dementsprechend ist ein Decoder mit dem zweiten Schieberegister verbunden. Für diese Zwecke reicht ein 3 x 8-Decoder völlig aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Inversion von der erforderlichen Anzahl von Ausgängen zu entfernen, haben wir zwei KR1533LN1-Wechselrichterschaltungen verwendet. Dies hat das Schema natürlich etwas kompliziert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere Aufgabe war die Arbeitsspannung der LEDs von 12 Volt im Vergleich zu 5 Volt Logikschaltungen. Die vorgeschlagene Lösung bestand darin, einen Wechselrichter mit offenem Abfluss zu verwenden. Eine solche Mikroschaltung spielt die Rolle eines Schlüssels, der einen der Kontakte der LED mit der Erde schließt (mit logischer 1) oder öffnet (mit logischer 0), wodurch die LED ein- oder ausgeschaltet wird. Die Schaltung nimmt einen Betrieb von 12 Volt entsprechend der Betriebsspannung der LEDs an. Um 5 Volt für Logikschaltungen zu erhalten, wurde der Schaltung der Stabilisator KR142EN5A mit zwei Kondensatoren hinzugefügt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einige Eingänge bestimmter Mikroschaltungen implizieren einen konstanten Wert am Eingang, sodass sie mit Masse oder einer Stromquelle verbunden waren. </font><font style="vertical-align: inherit;">In diesem Fall sind dies die folgenden Eingaben:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der inverse MR-Reset-Eingang in beiden Schieberegistern ist über das Lastregister mit dem Stabilisatorausgang bei 5 Volt verbunden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der inverse OE-Ausgangsfreigabeeingang in beiden Schieberegistern ist direkt mit Masse verbunden.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inverser Decoder-Freigabeeingang E0 mit Masse verbunden</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/files/994/7dc/3c6/9947dc3c61754b44b034f4670f846fbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Schaltung wird von vier Eingängen (E1, SH, ST, DS) gesteuert. </font><font style="vertical-align: inherit;">Der Zweck und die Signalpegel von jedem von ihnen werden nachstehend ausführlicher erörtert:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Eingang E1 dient zur Aktivierung des Decoders. In unserem Fall befinden sich anfangs am Decoder zwei Steuereingänge E1, E0, und beide sind invers. Es wird genug einen Ausgang geben, so dass der zweite (E0) zu Boden gebracht werden kann. Der "Standard" -Decoderstatus ist betriebsbereit, bis ein hoher Signalpegel an E1 angelegt wird. Um das Gegenteil zu erreichen, haben wir diesen Eingang mit dem Wechselrichter verbunden. Ohne dies kann der Decodierer den Registern beispielsweise zum Zeitpunkt der Aktualisierung der Daten im Schieberegister falsche Steuersignale geben. Wie bereits erwähnt, kann in der Schaltung ein 3 × 8-Decoder verwendet werden, der einen nicht inversen Steuereingang haben kann, wodurch es einfach wird, alle oben beschriebenen Probleme ohne zusätzliche Drähte und einen Lötkolben zu lösen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ein einzelner Signalpegel an E1 angelegt wird, decodiert der Decodierer die im entsprechenden Schieberegister befindliche Registeradresse und sendet ein Signal an den gewünschten Ausgang. Danach schaltet der Decoder wieder ab, indem er einen niedrigen Signalpegel an E1 anlegt. Ein solcher Schalter des Decoders erzeugt ein Signal am gewünschten Ausgang, dessen Flanke und Abfall als Registertaktimpuls zum Einrasten der auf dem Bus gespeicherten Daten in sich selbst dient.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die nächsten drei Eingänge sind bereits zur Steuerung von Schieberegistern vorgesehen. Es lohnt sich, mit der einfachsten Sache zu beginnen - der DS-Dateneingabe. Diese Eingabe ist, wie der Name schon sagt, für die Datenübertragung vorgesehen. Da die Schieberegister in der Schaltung in Kaskade geschaltet sind, repräsentiert der DS den entsprechenden Ausgang von einem von ihnen. Der Eingang des zweiten Schieberegisters ist mit dem Ausgang des letzten Bits des ersten Registers verbunden. Das Ergebnis ist ein Schieberegister für 16 Bit, von denen nur 12 Bit verwendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Eingang SH ist ein Takteingang. Diesem Eingang wird eine Rechteckwelle zugeführt, die für das Laden und Verschieben von Daten in jedes der Register verantwortlich ist. Dieser Kontakt der Schaltung ist mit den SHCP-Pins beider Register verbunden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der letzte ST-Pin dient als Daten-Latch an den Ausgängen des Registers. Dieser Eingang erhält einen Impuls, der jedoch erst dann geliefert wird, wenn die Daten im Schieberegister endgültig geladen sind und am Ausgang der Register fixiert werden müssen. Erst nach diesem Signal gelangen die heruntergeladenen Daten innerhalb des Registers in der ersten Triggerreihe in die zweite Triggerreihe und werden auf dem Bus verfügbar. ST ist ein Pin, der mit den STcp-Pins beider Register verbunden ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es bleibt die Verdrahtung der beiden Pins der Schieberegister MR und OE zu erklären. Der erste Eingang (MR) ist für das Speichern der Daten im Register verantwortlich. In dieser Schaltung ist eine solche Möglichkeit nicht erforderlich, daher wird diesem Ausgang über die Last ein hoher Signalpegel zugeführt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite Registereingang (OE) ist dafür verantwortlich, die zweite Reihe von Triggern innerhalb des Schieberegisters vom Bus zu trennen, d. H. Den Freigabeeingang. </font><font style="vertical-align: inherit;">Diese Funktion ist ebenfalls nicht erforderlich, daher wird der Ausgang auf Masse gewickelt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderer Kontakt, der oben nicht beschrieben wurde, dient zum Entfernen des Signalpegels von der Taste in der Mitte der Uhr. Die Tastenschaltung ist typisch und stellt eine Last und einen Schlüssel dar, abhängig von der Position, von der ein niedriger oder hoher Signalpegel an das Arduino gesendet wird. </font><font style="vertical-align: inherit;">Je nach Status der Taste arbeitet die Uhr entweder im Bildschirmschonermodus oder im Zeitanzeigemodus.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verbindung zum Arduino weist keine besonderen Merkmale auf, außer dass der SH-Pin idealerweise mit dem digitalen SCK-Pin verbunden ist. </font><font style="vertical-align: inherit;">Die restlichen Schaltungsausgänge können an jeden der verfügbaren digitalen Allzweckeingänge angeschlossen werden. </font><font style="vertical-align: inherit;">In unserem Fall hat die Verbindung die folgende Form:</font></font><br>
<br>
<ul>
<li>Arduino pin13 (SCK) –   SH</li>
<li>Arduino pin 11 –   ST Arduino pin 8 –   DS Arduino pin 5 –   E1 Arduino pin 3 –   Arduino pin GND –   (      )<br>
       ,      .<br>
<br>
    :   36  —   ;    36  ( ) \ 26  ( ) —  .   Shadowplay    72 ,     36.     ,    60  ( + ).     .   ,   ,     ,      .<br>
<br>
<img src="https://habrastorage.org/files/c46/3ff/f0b/c463fff0b95e402eaf9b4274301f04ba.jpg"><br>
<br>
  ,     .      ,    .   ,      .      ,  «»    50 — 60,        . , 60   .  :      —   .<br>
<br>
<img src="https://habrastorage.org/files/871/643/435/87164343503642ba802ead947d81ab6a.JPG"><br>
<br>
   ,  ,    ,  .      —     . ,         ,    .  ,   —  .<br>
<br>
<div class="spoiler"><b class="spoiler_title">      .</b><div class="spoiler_text"><img src="https://habrastorage.org/files/f95/9cc/f6d/f959ccf6d1c34b58ac31411eb3477a99.jpg"><br>
</div></div><br>
-,  .<br>
<br>
     Shadowplay.  ,       ,    . ,    ,       .      , ..     .        ,  ,       100% .    ,       .       .     ,         .  ,               .<br>
<br>
 ,      (       ),     ,    —    . ,  ,   !    .   ,  - -   . ,   ,    .             ,     ,           .   ,     ,    ,   .     .,     -         .    ,      ,   , ,   ,     . <br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/uy-cLHOz-5M%3Ffeature%3Doembed&amp;usg=ALkJrhgAgNwz0RBKegbyOKboEC1quCyZng" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 ,     .         . ..   ,     , ( ,      ,         ),      . <br>
<br>
<h4> </h4><br>
,     ().      Arduino.  ,    RTC,   —    .      DS1307,   — I2C.       2100     .          .     RTC  Arduino,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>.         RTC.<br>
<br>
<img src="https://habrastorage.org/files/c76/129/084/c761290840164f52a699e8f7d0c23a50.jpg"><br>
<br>
     ,      RTC,         .<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"> <pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Time.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DS1307RTC.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> REG [<span class="hljs-number"><span class="hljs-number">8</span></span>];<font></font>
tmElements_t te;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c,reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">13</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">11</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">8</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">5</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, INPUT);   <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
  <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//      RTC  </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Hour = 18;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Minute = 50;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Second = 0;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Day = 20; //</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Month = 4; // </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Year = CalendarYrToTm(2016); </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//RTC.write(te);</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{ 
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>))                    <span class="hljs-comment"><span class="hljs-comment">// ,     </span></span><font></font>
  {RTC.read(te);<font></font>
   SetShadowTime(te.Hour,te.Minute,te.Second,<span class="hljs-number"><span class="hljs-number">2</span></span>);        <span class="hljs-comment"><span class="hljs-comment">//         </span></span>
   delay(<span class="hljs-number"><span class="hljs-number">900</span></span>);<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>                                   <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span><font></font>
  {wait1();<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
                                         <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,<span class="hljs-number"><span class="hljs-number">0</span></span>); <font></font>
   <font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//======================================================================= </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUpLightByMask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RegNum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LightMask)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//         </span></span></span><span class="hljs-function">
</span></span>{<font></font>
  <font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, LOW);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, LOW);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, MSBFIRST, LightMask);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, LSBFIRST, RegNum);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, HIGH);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digitalClockDisplay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{  <span class="hljs-comment"><span class="hljs-comment">//    RTC  ,    RTC  </span></span><font></font>
  RTC.read(te);<font></font>
  Serial.print(te.Hour);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" : "</span></span>);<font></font>
  Serial.print(te.Minute);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" :"</span></span>);<font></font>
  Serial.print(te.Second);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Day);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Month);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(tmYearToCalendar(te.Year));<font></font>
  Serial.println();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ,     , ,        :</span></span>
<span class="hljs-comment"><span class="hljs-comment">//0 -  ,1 -   , 2 -    </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetShadowTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hours, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Minutes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Seconds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param)</span></span></span></span>{   
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h,hshift,m,s;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) REG[j] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Hours &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) Hours -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  h = Hours + <span class="hljs-number"><span class="hljs-number">6</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(h &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) h -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
    <font></font>
  hshift = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Minutes / <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  <font></font>
  REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
             <font></font>
   <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">1</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
   }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
     <font></font>
   s = Seconds + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(s &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) s -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(s%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,REG[j]);<font></font>
  }<font></font>
  <font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wait1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    </span></span></span><span class="hljs-function">
</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">0</span></span>;
     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       c = c | <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);  <font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);   <font></font>
      }<font></font>
   }<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">255</span></span>;
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);<font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);     <font></font>
      }<font></font>
    }  <font></font>
}<font></font>
</code></pre> <br>
</div></div><br>
<h4></h4><br>
    .         .      (Arduino, RTC)     .      ,   .       ,    «- ».   —   .  :<br>
<br>
    .<br>
<br>
<div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.slideshare.net/slideshow/embed_code/61634811&amp;usg=ALkJrhgjKwSUNh6tptBshQbUEmt8kdcz_g" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br>
<br>
   ,       «»:<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/KbbakER89U0%3Ffeature%3Doembed&amp;usg=ALkJrhj9OmgPcdoG87q6dKsXQF7WDgV-tQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 , ,    :<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/SIPI6ug_dls%3Ffeature%3Doembed&amp;usg=ALkJrhiF4oBSV67w5jhadizhtPWonjxU4w" frameborder="0" allowfullscreen=""></iframe><br>
<br>
    ,  ,   ,   . <br>
<br>
 ,  ,     .   ,    ?      .     :         ( ,     ,  ..). ,   ,  ,         .        . ,     .<br>
<br>
<h4></h4><br>
  ?<br>
<br>
<ul>
<li>,    ,   .</li>
<li>       .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Möglichkeit, die Reihenfolge der blinkenden LEDs einfach programmgesteuert zu ändern, bietet eine unendliche Vielfalt an Kombinationen.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir beanspruchen nicht die absolute Richtigkeit unserer Schaltungs- und Softwarelösungen. </font><font style="vertical-align: inherit;">Wie bereits erwähnt, ist negative Erfahrung auch Erfahrung. </font><font style="vertical-align: inherit;">Vielleicht hilft dieser Artikel jemandem, unsere Fehler zu vermeiden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihre Aufmerksamkeit!</font></font></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de394107/">https://habr.com/ru/post/de394107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de394095/index.html">Wie die Hackathon-Schulkinder der NASA ein Fitness-Armband zur Steuerung einer Drohne rückentwickeln</a></li>
<li><a href="../de394097/index.html">[HASS] Schmerz. Formatieren Sie RusMARC</a></li>
<li><a href="../de394101/index.html">Umfrage: Welche Sprache wird in Ihrem Betriebssystem verwendet?</a></li>
<li><a href="../de394103/index.html">Wind und Eis auf dem Mars</a></li>
<li><a href="../de394105/index.html">Der intelligente Bluetooth-Tupfer zeigt an, wann Änderungen erforderlich sind</a></li>
<li><a href="../de394111/index.html">Wie lange oder wo Informationen schnell auf der Festplatte gespeichert werden sollen</a></li>
<li><a href="../de394113/index.html">AOC und Jide haben All-in-One-PCs unter Remix OS veröffentlicht</a></li>
<li><a href="../de394115/index.html">Wie viel kostet deine Idee?</a></li>
<li><a href="../de394123/index.html">Minecraft Gameband - ein Armband für Gamer</a></li>
<li><a href="../de394125/index.html">Windows 7 auf Smartphones LG G Watch installiert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>