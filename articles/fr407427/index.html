<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖤 ⚖️ 👩‍💻 Rendre l'éclairage domestique un peu plus intelligent 🧖🏾 😳 🚮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au profit de f.lux, à un degré ou à un autre, ils ont écrit plusieurs fois à la fois sur le Habré et sur les giktimes. Ayant essayé ce programme il y ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rendre l'éclairage domestique un peu plus intelligent</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/407427/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/e3/4f/59e34fff9b95b632068800.jpeg"></div><br>  Au profit de f.lux, à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un</a> degré ou à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un autre,</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ils</a> ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">écrit</a> plusieurs fois à la fois sur le Habré et sur les giktimes.  Ayant essayé ce programme il y a quelque temps, j'avais une question - qu'en est-il du reste de l'éclairage dans la pièce?  Trop la nuit, l'écran orange du moniteur s'échappe de la lumière chaude et générale des lampes à incandescence. <br><br>  Nous allons essayer de corriger ce malentendu gênant. <br><a name="habracut"></a><br><h3>  Clause de non-responsabilité </h3><br>  L'auteur du texte ne comprend pas bien comment fonctionne la vision humaine et si les opérations décrites ci-dessous lui seront utiles ou nuisibles.  En outre, certains aspects des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tests des indicateurs des</a> lampes LED pour leur qualité restent à la mer.  Il a été décidé de les accepter comme «satisfaisants», remercie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">AlexeyNadezhin</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Tiberius</a> pour les études pertinentes. <br><br><h3>  Nous achetons des lampes </h3><br>  Une analyse rapide du marché a montré qu'il y avait beaucoup de choix.  À commencer par les lampes chinoises super-budgétaires «sans nom», pour finir avec Belkin et Philips, qui sont déjà de l'argent tout à fait impudique.  En conséquence, il a été décidé de prendre comme base l'ampoule LED intelligente Yeelight, produite sous la marque Xiaomi.  Leur avantage est la possibilité de fonctionner sans équipement supplémentaire de la catégorie «maison intelligente» et la possibilité de travailler de manière autonome, sans être lié aux serveurs de gestion de l'entreprise (après quelques astuces). <br><br>  Au moment d'écrire ces lignes, le coût d'une lampe est d'environ 20 $. <br><br><h3>  Partie logiciel </h3><br>  Nous allons écrire le code de contrôle des lampes en python, car il existe déjà un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">module</a> prêt à l'emploi qui vous permet de transférer des commandes de contrôle à ces lampes.  Il y a aussi un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">document</a> détaillant l'api.  Ainsi, il ne reste plus qu'à ajouter un petit serveur web afin de recevoir les commandes de contrôle de f.lux. <br><br>  Cependant, vous devez d'abord initialiser Smart Bulb.  Nous initialisons les lampes via l'application propriétaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MiHome</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">obtenons</a> l'apparence de l'icône Yeelight Color Bulb dans l'interface de l'application.  Des problèmes de connexion peuvent survenir en raison du DNS et du choix du serveur par défaut.  Ils sont résolus en écrivant 8.8.8.8 en DNS et en choisissant le serveur Chine (continentale). <br><br><img src="https://habrastorage.org/webt/59/e3/b6/59e3b6748362b958683285.png"><br><br>  Il est également nécessaire de déverrouiller la possibilité d'accéder directement aux appareils en activant le mode développeur sur eux, via la deuxième application, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yeelight</a> .  Après toutes ces opérations, les lampes apparaissent sur le réseau et sont déjà accessibles. <br><br><img src="https://habrastorage.org/webt/59/e3/b6/59e3b68d5a4a4577450855.png"><br><br>  En raison de la réticence à dire les mots de passe du Wi-Fi aux ampoules intelligentes, ils se déplacent vers un sous-réseau distinct, avec un SSID distinct et sans accès à Internet. <br><br>  Ainsi, les lampes sont suspendues au réseau, dans l'application, elles se sont déconnectées et vous pouvez essayer de leur transférer des commandes de contrôle. <br><br><h3>  Intégration avec f.lux </h3><br>  f.lux peut envoyer des données sur les changements de température de couleur et de luminosité à une URL donnée.  Les données arrivent sous forme de post-demande du formulaire: <br><blockquote>  POST /room_1?ct=6500&amp;bri=0.800000 HTTP / 1.1 </blockquote><br><img src="https://habrastorage.org/webt/59/e3/bf/59e3bf1ff110f565378927.png"><br><br>  Nous allons écrire un petit serveur web sur une bouteille qui traite ces paramètres: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> bottle <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> run, post, request <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> yeelight <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Bulb @post(<span class="hljs-string"><span class="hljs-string">'/room_1'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">room_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> post_dict = request.query.decode() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'ct'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> post_dict <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'bri'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> post_dict: ct = int(post_dict[<span class="hljs-string"><span class="hljs-string">'ct'</span></span>]) bri = int(float(post_dict[<span class="hljs-string"><span class="hljs-string">'bri'</span></span>]) * <span class="hljs-number"><span class="hljs-number">100</span></span>) bulb.set_color_temp(ct) bulb.set_brightness(bri) bulb = Bulb(<span class="hljs-string"><span class="hljs-string">"%lamp_ip%"</span></span>) run(host=<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>, port=<span class="hljs-number"><span class="hljs-number">8080</span></span>)</code> </pre> <br><br><h3>  Résultat final </h3><br>  Ayant travaillé pendant une semaine dans ce mode, j'ai du mal à dire s'il y a des changements positifs et si mon œil est fatigué.  La lumière réglable dynamiquement semble intéressante et la différence entre le moniteur et l'éclairage ambiant n'est pas si frappante.  En revanche, le fait même d'un changement constant de la lumière ambiante est inhabituel. <br><br><img src="https://habrastorage.org/webt/kn/om/fp/knomfpcb8kj4ysljmhbfe-9yy1e.png"><br><br><img src="https://habrastorage.org/webt/zi/ah/y0/ziahy0sgw_0ovnisucfvaslzo68.png"><br><br><img src="https://habrastorage.org/webt/aq/uk/8u/aquk8ubgjrf-lwttljrbg6t4-vc.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr407427/">https://habr.com/ru/post/fr407427/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr407415/index.html">Raspberry Pi transmettant des signaux radio: test</a></li>
<li><a href="../fr407417/index.html">Poutine a ordonné la libération de la crypto-monnaie russe - Crypto-monnaie</a></li>
<li><a href="../fr407419/index.html">Eh, marteau, jetons un coup d'œil: comment dans Salyut-7 ils ont fait une fiction non scientifique au lieu du cinéma historique</a></li>
<li><a href="../fr407423/index.html">Un peu sur le lien entre la pensée systémique et l'autopoïèse</a></li>
<li><a href="../fr407425/index.html">Sept erreurs majeures commises par les auteurs de prévisions d'IA</a></li>
<li><a href="../fr407431/index.html">La mise à jour iOS 11.0.3 a montré qu'Apple peut éteindre ses téléphones avec un écran non original</a></li>
<li><a href="../fr407433/index.html">Mise en service de la première centrale thermique négative au COЭС au monde</a></li>
<li><a href="../fr407435/index.html">Radio amateur de terrain ou théorie des champs</a></li>
<li><a href="../fr407437/index.html">Balances intelligentes MGB: quoi de neuf?</a></li>
<li><a href="../fr407439/index.html">Gardez vos économies ... dans le bunker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>