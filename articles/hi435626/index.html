<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тмЕя╕П тЖйя╕П ЁЯд░ЁЯП┐ рд╣рдордиреЗ AspNetCore.Mvc рдХреА рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреЗрджреНрдпрддрд╛ рдХреЛ рдХреИрд╕реЗ рдкрд╛рдпрд╛ рдФрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХреНрд░рдорд╛рдВрдХрди рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ ЁЯСйЁЯП╝тАНЁЯдЭтАНЁЯСиЁЯП╛ ЁЯЪБ ЁЯПЯя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! 

 рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдФрд░ AspNetCore.Mvc рдХреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреА рдЦреЛрдЬ рдореЗрдВ рдЕрдкрдиреЗ рдЕрдиреБрднрд╡ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред 



 рдкреНрд░рд╛рдЧрд┐рддрд┐рд╣...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╣рдордиреЗ AspNetCore.Mvc рдХреА рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреЗрджреНрдпрддрд╛ рдХреЛ рдХреИрд╕реЗ рдкрд╛рдпрд╛ рдФрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХреНрд░рдорд╛рдВрдХрди рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/retailrocket/blog/435626/">  рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! <br><br>  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдФрд░ AspNetCore.Mvc рдХреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреА рдЦреЛрдЬ рдореЗрдВ рдЕрдкрдиреЗ рдЕрдиреБрднрд╡ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/da/rm/2b/darm2bah850jodxea3wgdjr60qk.jpeg"><br><br><h2>  рдкреНрд░рд╛рдЧрд┐рддрд┐рд╣рд╛рд╕ </h2><br>  рдХрдИ рд╕рд╛рд▓ рдкрд╣рд▓реЗ, рд╣рдорд╛рд░реА рдПрдХ рднрд░реА рд╣реБрдИ рд╕реЗрд╡рд╛ рдкрд░, рд╣рдордиреЗ рд╕реАрдкреАрдпреВ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЦрдкрдд рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛ред  рдпрд╣ рдЕрдЬреАрдм рд▓рдЧ рд░рд╣рд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ рд╕реЗрд╡рд╛ рдХрд╛ рдХрд╛рд░реНрдп рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рдВрджреЗрд╢ рд▓реЗрдирд╛ рдерд╛ рдФрд░ рдЗрд╕реЗ рдХрддрд╛рд░ рдореЗрдВ рдЦрдбрд╝рд╛ рдХрд░рдирд╛ рдерд╛, рдкрд╣рд▓реЗ рдЗрд╕ рдкрд░ рдХреБрдЫ рдСрдкрд░реЗрд╢рди рдХрд┐рдП рдереЗ, рдЬреИрд╕реЗ рдХрд┐ рд╕рддреНрдпрд╛рдкрди, рдбреЗрдЯрд╛ рдЬреЛрдбрд╝, рдЖрджрд┐ред <br><br>  рдкреНрд░реЛрдлрд╛рдЗрд▓рд┐рдВрдЧ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдордиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рдордп рдореЗрдВ рдбреАрд░рд┐рдПрд░рд▓рд╛рдЗрдЬреЗрд╢рди "рдЦрд╛рддреА рд╣реИ"ред  рд╣рдордиреЗ рдорд╛рдирдХ рдзрд╛рд░рд╛рд╡рд╛рд╣рд┐рдХ рдХреЛ рдмрд╛рд╣рд░ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдФрд░ рдЬрд┐рд▓ рдкрд░ рдЕрдкрдирд╛ рд╕реНрд╡рдпрдВ рдХрд╛ рд▓рд┐рдЦрд╛, рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╕рдВрд╕рд╛рдзрди рдХреА рдЦрдкрдд рдХрдИ рдЧреБрдирд╛ рдХрдо рд╣реЛ рдЧрдИред  рд╕рдм рдХреБрдЫ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╣рдо рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓ рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗред <br><a name="habracut"></a><br><h2>  рд╕рдорд╕реНрдпрд╛ </h2><br>  рд╣рдо рд╕реБрд░рдХреНрд╖рд╛, рдкреНрд░рджрд░реНрд╢рди рдФрд░ рдЧрд▓рддреА рд╕рд╣рд┐рд╖реНрдгреБрддрд╛ рд╕рд╣рд┐рдд рд╕рднреА рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдЕрдкрдиреА рд╕реЗрд╡рд╛ рдореЗрдВ рд▓рдЧрд╛рддрд╛рд░ рд╕реБрдзрд╛рд░ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП "рд╕реБрд░рдХреНрд╖рд╛ рджрд▓" рд╣рдорд╛рд░реА рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╣реИрдВред  рдФрд░ рдХреБрдЫ рд╕рдордп рдкрд╣рд▓реЗ рд▓реЙрдЧ рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдЪреЗрддрд╛рд╡рдиреА "рдордХреНрдЦрд┐рдпреЛрдВ" рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ - рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╣рдо рдЖрдЧреЗ рдПрдХ рдЕрдорд╛рдиреНрдп рд╕рдВрджреЗрд╢ рдпрд╛рдж рдХрд┐рдпрд╛ред <br><br>  рдПрдХ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд╕рд╛рде, рд╕рдм рдХреБрдЫ рдЕрдЬреАрдм рд▓рдЧ рд░рд╣рд╛ рдерд╛ред  рдПрдХ рдЕрдиреБрд░реЛрдз-рдореЙрдбрд▓ рд╣реИ (рдпрд╣рд╛рдВ рдореИрдВ рдПрдХ рд╕рд░рд▓реАрдХреГрдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рджреВрдВрдЧрд╛): <br><br><pre><code class="json hljs">public class RequestModel { public string Key { get; set; } FromBody] Required] public PostRequestModelBody Body { get; set; } } public class PostRequestModelBody { [Required] [MinLength(1)] public IEnumerable&lt;long&gt; ItemIds { get; set; } }</code> </pre> <br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХреНрд╢рди рдкреЛрд╕реНрдЯ рдХреЗ рд╕рд╛рде рдПрдХ рдирд┐рдпрдВрддреНрд░рдХ рд╣реИ: <br><br><pre> <code class="json hljs">[Route(<span class="hljs-string"><span class="hljs-string">"api/[controller]"</span></span>)] public class HomeController : Controller { [HttpPost] public async Task&lt;ActionResult&gt; Post(RequestModel request) { if (this.ModelState.IsValid) { return this.Ok(); } return this.BadRequest(); } }</code> </pre> <br>  рд╕рдм рдХреБрдЫ рддрд╛рд░реНрдХрд┐рдХ рд▓рдЧрддрд╛ рд╣реИред  рдЕрдЧрд░ рдмреЙрдбреА рд╡реНрдпреВ рд╕реЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдЖрддреА рд╣реИ <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"itemIds"</span></span>:[<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span> тАж ] }</code> </pre> <br>  рдПрдкреАрдЖрдИ BadRequest рд▓реМрдЯрд╛рдПрдЧрд╛, рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рд╣реИрдВред <br><br>  рдлрд┐рд░ рднреА, рд▓реЙрдЧ рдореЗрдВ рд╣рдо рд╡рд┐рдкрд░реАрдд рджреЗрдЦрддреЗ рд╣реИрдВред  рд╣рдордиреЗ рд▓реЙрдЧ рд╕реЗ рд╕рдВрджреЗрд╢ рд▓рд┐рдпрд╛, рдЗрд╕реЗ рдПрдкреАрдЖрдИ рдХреЛ рднреЗрдЬрд╛ рдФрд░ рд╕реНрдерд┐рддрд┐ рдареАрдХ рдкрд╛рдИ ... рдФрд░ ... рд▓реЙрдЧ рдореЗрдВ рдПрдХ рдирдИ рддреНрд░реБрдЯрд┐ред  рд╣рдорд╛рд░реА рдЖрдБрдЦреЛрдВ рдкрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рди рдХрд░рддреЗ рд╣реБрдП, рд╣рдордиреЗ рдПрдХ рдЧрд▓рддреА рдХреА рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдХрд┐ рд╣рд╛рдБ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ ModelState.IsValid == рд╕рдЪ рд╣реИред  рдЙрд╕реА рд╕рдордп, рдЙрдиреНрд╣реЛрдВрдиреЗ рд▓рдЧрднрдЧ 500ms рдХреА рдЕрд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд▓рдВрдмреА рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛, рдЬрдмрдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдордп рд╢рд╛рдпрдж рд╣реА рдХрднреА 50ms рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рд╣рдЬрд╛рд░реЛрдВ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ! <br><br>  рдЗрд╕ рдЕрдиреБрд░реЛрдз рдФрд░ рд╣рдорд╛рд░реЗ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рдЕрдВрддрд░ рдХреЗрд╡рд▓ рдЗрддрдирд╛ рдерд╛ рдХрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ 600+ рдЦрд╛рд▓реА рд▓рд╛рдЗрдиреЗрдВ рдереАрдВ ... <br><br>  рдЖрдЧреЗ рдмрд╣реБрдд рд╕рд╛рд░реЗ bukaf рдХреЛрдб рд╣реЛрдВрдЧреЗред <br><br><h2>  рдХрд╛рд░рдг </h2><br>  рд╡реЗ рд╕рдордЭрдиреЗ рд▓рдЧреЗ рдХрд┐ рдХреНрдпрд╛ рдЧрд▓рдд рдерд╛ред  рддреНрд░реБрдЯрд┐ рдХреЛ рдЦрддреНрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЛрдВрдиреЗ рдПрдХ рд╕рд╛рдл рдЖрд╡реЗрджрди рд▓рд┐рдЦрд╛ рдерд╛ (рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдореИрдВрдиреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдерд╛), рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╣рдордиреЗ рд╡рд░реНрдгрд┐рдд рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреБрди: рдкреЗрд╢ рдХрд┐рдпрд╛ред  рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░, рд╣рдордиреЗ рдЕрдиреБрд╕рдВрдзрд╛рди, рдкрд░реАрдХреНрд╖рдг, рдорд╛рдирд╕рд┐рдХ рдбрд┐рдмрдЧ рдХреЛрдб AspNetCore.Mvc рдкрд░ рдорд╛рдирд╡-рджрд┐рди рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдЦрд░реНрдЪ рдХреА рдФрд░ рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рд╕рдорд╕реНрдпрд╛ <a href="">JsonInputFormatter рдореЗрдВ рд╣реИ</a> ред <br><br>  JsonInputFormatter рдПрдХ JsonSerializer рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ deserialization рдФрд░ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдзрд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣рд╛ рд╣реИ, рдпрджрд┐ рдпрд╣ рдПрдХ рд╕рд░рдгреА рд╣реИ - рдЗрд╕ рд╕рд░рдгреА рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ - рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрдкрддреНрддрд┐ рдХреЛ рдХреНрд░рдордмрджреНрдз рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред  рдЙрд╕реА рд╕рдордп, рдпрджрд┐ рдХреНрд░рдорд╛рдВрдХрди рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рд╣реИ, рддреЛ JsonInputFormatter рдкреНрд░рддреНрдпреЗрдХ рддреНрд░реБрдЯрд┐ рдФрд░ рдЙрд╕рдХреЗ рдкрде рдХреЛ рдмрдЪрд╛рддрд╛ рд╣реИ, рдЗрд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдЖрдк рдЖрдЧреЗ deserialize рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдЬрд╛рд░реА рд░рдЦ рд╕рдХреЗрдВред <br><br>  рдиреАрдЪреЗ JsonInputFormatter рддреНрд░реБрдЯрд┐ рд╣реИрдВрдбрд▓рд░ рдХреЗ рд▓рд┐рдП рдХреЛрдб рд╣реИ (рдпрд╣ рдКрдкрд░ рджрд┐рдП рдЧрдП рд▓рд┐рдВрдХ рдкрд░ Github рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИ): <br><br><pre> <code class="json hljs">void ErrorHandler(object sender, Newtonsoft.Json.Serialization.ErrorEventArgs eventArgs) { successful = false; // When ErrorContext.Path does not include ErrorContext.Member, add Member to form full path. var path = eventArgs.ErrorContext.Path; var member = eventArgs.ErrorContext.Member?.ToString(); var addMember = !string.IsNullOrEmpty(member); if (addMember) { // Path.Member case (path.Length &lt; member.Length) needs no further checks. if (path.Length == member.Length) { // Add Member in Path.Memb case but not for Path.Path. addMember = !string.Equals(path, member, StringComparison.Ordinal); } else if (path.Length &gt; member.Length) { // Finally, check whether Path already ends with Member. if (member[0] == '[') { addMember = !path.EndsWith(member, StringComparison.Ordinal); } else { addMember = !path.EndsWith(<span class="hljs-attr"><span class="hljs-attr">"."</span></span> + member, StringComparison.Ordinal); } } } if (addMember) { path = ModelNames.CreatePropertyModelName(path, member); } // Handle path combinations such as <span class="hljs-string"><span class="hljs-string">""</span></span>+<span class="hljs-string"><span class="hljs-string">"Property"</span></span>, <span class="hljs-string"><span class="hljs-string">"Parent"</span></span>+<span class="hljs-string"><span class="hljs-string">"Property"</span></span>, or <span class="hljs-string"><span class="hljs-string">"Parent"</span></span>+<span class="hljs-string"><span class="hljs-string">"[12]"</span></span>. var key = ModelNames.CreatePropertyModelName(context.ModelName, path); exception = eventArgs.ErrorContext.Error; var metadata = GetPathMetadata(context.Metadata, path); var modelStateException = WrapExceptionForModelState(exception); context.ModelState.TryAddModelError(key, modelStateException, metadata); _logger.JsonInputException(exception); // Error must always be marked as handled // Failure to do so can cause the exception to be rethrown at every recursive level and // overflow the stack for x<span class="hljs-number"><span class="hljs-number">6</span></span><span class="hljs-number"><span class="hljs-number">4</span></span> CLR processes eventArgs.ErrorContext.Handled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre><br>  рдкреНрд░реЛрд╕реАрдЬрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рд░реНрдХрд┐рдВрдЧ рдПрд░рд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рдмрд┐рд▓реНрдХреБрд▓ рдЕрдВрдд рдореЗрдВ рдмрдирд╛рдИ рдЧрдИ рд╣реИ <br><br><pre> <code class="json hljs">eventArgs.ErrorContext.Handled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre> <br><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕рднреА deserialization рддреНрд░реБрдЯрд┐рдпреЛрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкрде рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕ рдкрд░ рд╡реЗ рдлрд╝реАрд▓реНрдб / рддрддреНрд╡ рдереЗ, рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ "рд╕рднреА ... <br><br>  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ JsonSerializer рдореЗрдВ 200 рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреА рд╕реАрдорд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдпрд╣ рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рд╕рднреА рдХреЛрдб рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ ModelState рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ ... рдорд╛рдиреНрдп! ... рддреНрд░реБрдЯрд┐рдпрд╛рдВ рднреА рдЦреЛ рдЬрд╛рддреА рд╣реИрдВред <br><br><h2>  рдирд┐рд░реНрдгрдп </h2><br>  рдмрд┐рдирд╛ рдХрд┐рд╕реА рд╣рд┐рдЪрдХрд┐рдЪрд╛рд╣рдЯ рдХреЗ, рд╣рдордиреЗ Jil Deserializer рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Asp.Net Core рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ Json рдлреЙрд░реНрдореИрдЯрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ред  рдЪреВрдВрдХрд┐ рд╢рд░реАрд░ рдореЗрдВ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдмрд┐рд▓реНрдХреБрд▓ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рдХреЗрд╡рд▓ рдЙрдирдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рддрдереНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ (рдФрд░ рдЖрдорддреМрд░ рдкрд░ рдРрд╕реА рд╕реНрдерд┐рддрд┐ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ рдЬрдм рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛), рд╕реАрд░рд┐рдпрд▓ рдХреЛрдб рдХрд╛рдлреА рд╕рд░рд▓ рдирд┐рдХрд▓рд╛ред <br><br>  рдореИрдВ рдХрд╕реНрдЯрдо JilJsonInputFormatter рдХрд╛ рдореБрдЦреНрдп рдХреЛрдб рджреВрдВрдЧрд╛: <br><br><pre> <code class="json hljs">using (var reader = context.ReaderFactory(request.Body, encoding)) { try { var result = JSON.Deserialize( reader: reader, type: context.ModelType, options: this.jilOptions); if (result == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !context.TreatEmptyInputAsDefaultValue) { return await InputFormatterResult.NoValueAsync(); } else { return await InputFormatterResult.SuccessAsync(result); } } catch { // -   } return await InputFormatterResult.FailureAsync(); }</code> </pre> <br>  <b>рдЪреЗрддрд╛рд╡рдиреА!</b>  рдЬрд┐рд▓ рдорд╛рдорд▓рд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рд╢рд░реАрд░ рдХреА рд╕рд╛рдордЧреНрд░реА <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"ItemIds"</span></span>:[<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span> тАж ] }</code> </pre> <br>  рдФрд░ <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"itemIds"</span></span>:[<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span> тАж ] }</code> </pre> <br>  рдПрдХ рд╣реА рдмрд╛рдд рдирд╣реАрдВ рд╣реИред  рдкрд╣рд▓реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЕрдЧрд░ рдХреИрдорд▓рдХреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдЗрдЯрдордЖрдИрдбреНрд╕ рд╕рдВрдкрддреНрддрд┐ рдбреАрд░рд┐рдПрд░рд▓рд╛рдЗрдЬреЗрд╢рди рдХреЗ рдмрд╛рдж рд╢реВрдиреНрдп рд╣реЛ рдЬрд╛рдПрдЧреАред <br><br>  рд▓реЗрдХрд┐рди рдЪреВрдВрдХрд┐ рдпрд╣ рд╣рдорд╛рд░реА рдПрдкреАрдЖрдИ рд╣реИ, рд╣рдо рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИред  рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ рдпрд╣ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдПрдкреАрдЖрдИ рд╣реИ рдФрд░ рдХреЛрдИ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕реЗ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдХреИрдорд▓рдХреЗрд╕ рдореЗрдВ рдкреИрд░рд╛рдореАрдЯрд░ рдирд╛рдо рдирд╣реАрдВ рд╣реИред <br><br><h2>  рдкрд░рд┐рдгрд╛рдо </h2><br>  рдкрд░рд┐рдгрд╛рдо рд╣рдорд╛рд░реА рдЕрдкреЗрдХреНрд╖рд╛рдУрдВ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рдЧрдпрд╛, рдПрдкреАрдЖрдИ рдиреЗ рдЕрдкреЗрдХреНрд╖рд┐рдд рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдмреБрд░реА рддрд░рд╣ рд╕реЗ рд╡рд╛рдкрд╕реА рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджрд┐рдпрд╛ рдФрд░ рдЗрд╕реЗ рдмрд╣реБрдд рдЬрд▓реНрджреА рдХрд┐рдпрд╛ред  рдиреАрдЪреЗ рд╣рдорд╛рд░реЗ рдХреБрдЫ рд░реЗрдЦрд╛рдВрдХрди рдХреЗ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рд╣реИрдВ, рдЬреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдордп рдФрд░ рд╕реАрдкреАрдпреВ рдореЗрдВ рдмрджрд▓рд╛рд╡ рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ, рддреИрдирд╛рддреА рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВред <br>  рдЕрдиреБрд░реЛрдз рдХрд╛ рдиреЗрддреГрддреНрд╡ рд╕рдордп: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/62d/412/60a/62d41260a72b6a3c07c9aeb1e990a3ad.png" alt="рдЫрд╡рд┐"><br><br>  рд▓рдЧрднрдЧ 16:00 рдмрдЬреЗ рдПрдХ рддреИрдирд╛рддреА рдереАред  рддреИрдирд╛рддреА рд╕реЗ рдкрд╣рд▓реЗ, p99 рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп 30-57ms рдерд╛, рддреИрдирд╛рддреА рдХреЗ рдмрд╛рдж рдпрд╣ 9-15ms рд╣реЛ рдЧрдпрд╛ред  (рдЖрдк 18:00 рдХреА рджреЛрд╣рд░рд╛рдпрд╛ рдЪреЛрдЯрд┐рдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдирд╣реАрдВ рджреЗ рд╕рдХрддреЗ - рдпрд╣ рдПрдХ рдФрд░ рддреИрдирд╛рддреА рдереА) <br><br>  рдЗрд╕ рддрд░рд╣ рд╕реАрдкреАрдпреВ рдЧреНрд░рд╛рдл рдмрджрд▓ рдЧрдпрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/09c/95b/b8c/09c95bb8cf8bc500d0e7383ddbca8827.png" alt="рдЫрд╡рд┐"><br><br>  рдЗрд╕ рдХрд╛рд░рдг рд╕реЗ, рд╣рдо рдЧрд┐рддреБрдм рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореБрджреНрджрд╛</a> рд▓рд╛рдП, рд▓реЗрдЦрди рдХреЗ рд╕рдордп, рдЗрд╕реЗ рдорд╛рдЗрд▓рд╕реНрдЯреЛрди 3.0.0-рдкреНрд░реАрд╡реНрдпреВ 3 рдХреЗ рд╕рд╛рде рдПрдХ рдмрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ рдореЗрдВ </h2><br>  рдЬрдм рддрдХ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддрдм рддрдХ рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдорд╛рдирдХ рдбрд┐рд╕реЗрд░рд┐рдПрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдЫреЛрдбрд╝рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдПрдкреАрдЖрдИ рд╣реИред  рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЖрд╕рд╛рдиреА рд╕реЗ рдЖрдкрдХреА рд╕реЗрд╡рд╛ рдореЗрдВ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЙрд╕реА рддрд░рд╣ рдХреЗ рдЕрдорд╛рдиреНрдп рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдПрдХ рдЧреБрдЪреНрдЫрд╛ рдлреЗрдВрдХ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рддреНрд░реБрдЯрд┐рдкреВрд░реНрдг рд╕рд░рдгреА рдЬрд┐рддрдиреА рдЕрдзрд┐рдХ рд╣реЛрдЧреА, рдЙрддрдирд╛ рд╣реА рдЕрдзрд┐рдХ рдмреЙрдбреА, рдЬрд┐рддрдиреА рджреЗрд░ рддрдХ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг JsonInputFormatter рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред <br><br>  <b>рдЕрд░реНрдЯрд┐рдУрдо рдПрд╕реНрдЯрд╛рд╕реНрдХрд┐рди, рд╡рд┐рдХрд╛рд╕ рдЯреАрдо рд▓реАрдбрд░</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi435626/">https://habr.com/ru/post/hi435626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi435614/index.html">Rust News # 4 (рджрд┐рд╕рдВрдмрд░ 2018)</a></li>
<li><a href="../hi435616/index.html">рдкреАрдпрд░ рдЬрд╝реЛрдирд┐рдВрдЧ рдиреЗ рд╣рдорд╛рд░реЗ рдЬреАрд╡рди рдХреЛ рдХреИрд╕реЗ рд╕рд░рд▓ рдмрдирд╛рдпрд╛ рдФрд░ EMC VPLEX рдХреЗ рднрд╛рд░ рдХреЛ рд╕рдВрддреБрд▓рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХреА</a></li>
<li><a href="../hi435618/index.html">рдореЗрд░рд╛ Google рд░реЛрдЬрдЧрд╛рд░ рддреИрдпрд╛рд░реА рдЕрдиреБрднрд╡</a></li>
<li><a href="../hi435620/index.html">рднрд╡рд┐рд╖реНрдпрд╡рд╛рджрд┐рдпреЛрдВ рдХреЗ рд╡рд┐рдЪрд╛рд░ рдЬреЛ рд╕рдЪ рд╣реБрдП</a></li>
<li><a href="../hi435624/index.html">35C3 рд╕рдореНрдореЗрд▓рди рд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд░рд┐рдкреЛрд░реНрдЯ рдХрд╛ рдЪрдпрди</a></li>
<li><a href="../hi435628/index.html">Chrome рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрд╡рд░реЛрдзрдХ 9 рдЬреБрд▓рд╛рдИ рдХреЛ рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ</a></li>
<li><a href="../hi435630/index.html">рдХреНрд▓рд╛рдЙрдб рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдЖрдИрдмреА: 2019 рдХреЗ 5 рд░реБрдЭрд╛рди</a></li>
<li><a href="../hi435636/index.html">рдбреЙрдЯрд╛ 2 рдореЗрдВ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рд╕реЗ рдорд╢реАрди рд╕реАрдЦрдиреЗ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рд╕реАрдЦреЗрдВ</a></li>
<li><a href="../hi435638/index.html">рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреА рдЦреБрд╢реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЗрд╕реЗ рдХрд╣рд╛рдВ рдЦреЛрдЬрдирд╛ рд╣реИ</a></li>
<li><a href="../hi435640/index.html">рдЬрдирд╡рд░реА 2019 рдХреЗ рд▓рд┐рдП рдЖрдИрдЯреА рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдорд╛рдирд╡ рд╕рдВрд╕рд╛рдзрди рдкреЗрд╢реЗрд╡рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдкрд╛рдЪрди</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>