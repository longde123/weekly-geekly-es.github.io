<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•û ü§¶ üë∑üèª Creando la cara de un personaje para el juego "OnAir" üë©üèº‚Äçüíª üç¥ üå™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buenas tardes Mi nombre es Daria, soy artista 3d en el estudio de producci√≥n RainStyle. Actualmente estamos desarrollando un juego de terror de cienci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Creando la cara de un personaje para el juego "OnAir"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471288/">  Buenas tardes  Mi nombre es Daria, soy artista 3d en el estudio de producci√≥n RainStyle.  Actualmente estamos desarrollando un juego de terror de ciencia ficci√≥n llamado <b>"On Air"</b> . <br><br><img src="https://habrastorage.org/webt/kx/a4/x0/kxa4x0nk1p-invxwlnmddbywfkm.png" alt="imagen"><br><br>  El juego cuenta sobre misteriosos eventos que ocurrieron con el personaje principal, que accidentalmente se hosped√≥ en el hotel estadounidense Algol.  Este incidente cambiar√° completamente su vida y lo har√° enfrentar lo desconocido. <br><a name="habracut"></a><br>  Este es nuestro primer proyecto de juego y en √©l tratamos de lograr el m√°ximo realismo de los personajes, transmitir sus emociones y car√°cter.  Por lo tanto, para crearlos, se decidi√≥ utilizar la tecnolog√≠a de escaneo facial.  Como parte de los objetivos del proyecto, necesitamos dos grados de detalle para los personajes: para renderizar, para cinem√°tica y low poly, para usar en el juego en s√≠. <br><br>  El juego On Air se est√° desarrollando en Unreal Engine 4. Planeamos escribir varios art√≠culos en los que describiremos en detalle las etapas de preparaci√≥n del personaje. <br><br>  Por el momento, estamos creando una versi√≥n demo del juego, que pronto aparecer√° en Steam.  En este art√≠culo hablar√© sobre la etapa inicial de crear la cara del personaje principal de nuestro juego. <br><br><img src="https://habrastorage.org/webt/-e/ce/rh/-ecerhoq3v8iuxdyublvhwuwfd8.png" alt="imagen"><br><br><h4>  Parte 1 </h4><br>  La imagen a continuaci√≥n muestra algunas de las emociones que recibimos despu√©s de procesar los escaneos. <br><br><img src="https://habrastorage.org/webt/fd/tc/wt/fdtcwtsvrpdodfwomu8r6_np_g4.png" alt="imagen"><br><br>  B√°sicamente son exagerados y no parecen realistas.  Esto se hizo a prop√≥sito.  El hecho es que la base de este m√©todo para crear una cara es el principio de mezclar las formas de "Formar formas".  Es decir, cada una de estas emociones se aplicar√° no de forma "pura", sino en combinaci√≥n con otras.  Hablar√© m√°s sobre esto al final del art√≠culo.  Primero, debe averiguar qu√© hacer con el cabezal escaneado y c√≥mo podemos usarlo.  Obviamente, la topolog√≠a del escaneo no permite usarlo como modelo, pero al hornear el mapa normal obtenemos las caracter√≠sticas principales de la cara, arrugas, poros, golpes o cicatrices.  Tambi√©n del escaneo podemos extraer la textura del color base. <br><br><img src="https://habrastorage.org/webt/4l/ex/lr/4lexlrzmipmxepu4d2uqhs1ocgw.png" alt="imagen"><br><br>  El programa Wrap 3.3 nos ayudar√° con esto.  Es ampliamente utilizado para procesar modelos escaneados.  Con su ayuda, proyectaremos nuestro futuro modelo de cabeza en escaneos. <br><br><h4>  Parte 2 </h4><br>  Primero necesitas crear la llamada malla base.  Es decir, una expresi√≥n facial neutral que subyacer√° a todas las emociones.  Nuestro escaneo neutral de emociones se ve as√≠: <br><br><img src="https://habrastorage.org/webt/bf/zm/9r/bfzm9rnkwmw7whotrzfbolxmcym.png" alt="imagen"><br><br>  El programa Wrap 3.3 tiene un sistema de nodos, es decir, todas las funciones se presentan en forma de nodos (nodos) que est√°n conectados entre s√≠ por una cadena. <br><br>  La selecci√≥n de nodos se realiza con la tecla Tab.  Usando los nodos LoadGeom y LoadImage, se carga un escaneo con una emoci√≥n neutral y su textura correspondiente.  Para hacer esto, especifique la ruta en la ventana Nombres de archivo.  En la configuraci√≥n del nodo "LoadGeom", puede elegir varios modos de mostrar la geometr√≠a (la funci√≥n de estructura al√°mbrica est√° desactivada en la imagen a continuaci√≥n).  Aqu√≠ tambi√©n puede cambiar el color de la geometr√≠a (no funciona si la textura est√° conectada), las coordenadas y la escala. <br><br><img src="https://habrastorage.org/webt/jj/sa/ck/jjsacktagmrzkvs25xuhzuq0fos.png" alt="imagen"><br><br>  A continuaci√≥n, debe cargar la malla base, que se proyectar√° en este escaneo.  Puede encontrarlo en la pesta√±a "Galer√≠a".  Aqu√≠ hay muchas emociones preparadas.  En este caso, elijo Basemesh. <br><br><img src="https://habrastorage.org/webt/-v/lc/b7/-vlcb7otf7kgk5o4zzbnwhdkvq4.png" alt="imagen"><br><br>  Basemesh debe coincidir aproximadamente con un escaneo.  Para hacer esto, puede usar el eje de coordenadas. <br><br>  Para proyectar la malla base en el escaneo, utilizo el nodo Wrapping.  Cuando pasa el mouse sobre los nodos del nodo, se muestra una informaci√≥n sobre herramientas: el primer nodo, geometr√≠a flotante, para la geometr√≠a proyectada, el segundo nodo, geometr√≠a Fixet, para el objeto fijo sobre el cual se proyectar√° la geometr√≠a (en nuestro caso, es un escaneo con una emoci√≥n neutral). <br><br><img src="https://habrastorage.org/webt/xd/y0/mc/xdy0mcmzi9irpyydokryacbctla.png" alt="imagen"><br><br>  Para comenzar el c√°lculo, es necesario marcar los puntos en ambos modelos que se corresponder√°n entre s√≠.  Para esto, se utiliza el nodo Seleccionar puntos, que est√° conectado a los nodos correspondientes de los modelos.  Despu√©s de seleccionar este nodo, vaya a la pesta√±a Editor visual.  La funci√≥n Sync views incluida le permite sincronizar c√°maras para las ventanas izquierda y derecha. <br><br><img src="https://habrastorage.org/webt/8f/ow/uc/8fowucelwz7738je5jm2xp9gkxc.png" alt="imagen"><br><br>  Si el modelo proyectado contiene pol√≠gonos que deben permanecer en su lugar, debe seleccionarlos utilizando la funci√≥n Seleccionar pol√≠gonos.  De lo contrario, pueden surgir artefactos asociados con los detalles internos de la malla. <br><br><img src="https://habrastorage.org/webt/jr/zv/dz/jrzvdzuikyktk64wpo_cs4n62yi.png" alt="imagen"><br><br>  Para usar el nodo Seleccionar pol√≠gonos, use la pesta√±a Editor visual.  Aqu√≠ puede seleccionar los pol√≠gonos que los Modelos de la galer√≠a est√°n divididos en poligrupos, esto simplifica la tarea: se pueden seleccionar o deseleccionar en el panel superior. <br><br>  Destaco las partes internas de la garganta, las fosas nasales, los p√°rpados extremos y la parte inferior del cuello. <br><br><img src="https://habrastorage.org/webt/2v/nj/97/2vnj97z73izx0zdbnvvlefk4aja.png" alt="imagen"><br><br><img src="https://habrastorage.org/webt/so/ps/rc/sopsrc9xofh9bcneqnj8grhh2lm.png" alt="imagen"><br><br>  Despu√©s de eso, el modelo se proyectar√° correctamente. <br><br><img src="https://habrastorage.org/webt/i2/52/78/i25278qwzpx0x0a-s13wj4vn8wk.png" alt="imagen"><br><br>  Adem√°s, para una mayor granularidad, puede usar el nodo Subdivide.  Se conecta a la malla base y todos los nodos a continuaci√≥n est√°n conectados a su nodo inferior (Salida). <br><br><img src="https://habrastorage.org/webt/u7/s-/dd/u7s-ddnr9ctkghve6wicg-x7qic.png" alt="imagen"><br><br>  Luego, hornee la textura del escaneo a la malla base.  Para esto, se utiliza el nodo Transferir textura.  El nodo de geometr√≠a de origen se conecta al modelo con el que se hornear√° la textura.  En nuestro caso, este es un escaneo.  El nodo de geometr√≠a Target est√° conectado a la malla base, pero no al nodo LoadGeom, sino al nodo Wrapping, ya que usaremos la geometr√≠a proyectada ya modificada. <br><br><img src="https://habrastorage.org/webt/em/vj/ra/emvjrap3jv0drbe42u8lxjspjn8.png" alt="imagen"><br><br>  En la configuraci√≥n de este nodo, puede seleccionar la calidad de la textura horneada.  Despu√©s de eso, vale la pena agregar el nodo Extrapolar imagen para completar los lugares transparentes y guardar la textura resultante usando el nodo Guardar imagen y presionando el bot√≥n Calcular marco actual.  La geometr√≠a se guarda de la misma manera usando el nodo Guardar Geom. <br><br><img src="https://habrastorage.org/webt/q8/ol/xq/q8olxqwsxreywugalgqd5gfh1ek.png" alt="imagen"><br><br><h4>  Parte 3 </h4><br>  Despu√©s de obtener una emoci√≥n y textura neutrales, podemos pasar a obtener geometr√≠a para otras emociones.  Para hacer esto, cargue el modelo de escaneo y Basemesh con texturas. <br><br><img src="https://habrastorage.org/webt/sd/ey/nx/sdeynxlfx4nmbc9hefsxeq_y-v4.png" alt="imagen"><br><br>  A continuaci√≥n, debe alinear Basemesh de acuerdo con el escaneo.  Para empezar, puede comparar modelos aproximadamente utilizando ejes de coordenadas. <br><br><img src="https://habrastorage.org/webt/oh/ka/7x/ohka7x47eywbrue0da6kbhgc9e4.png" alt="imagen"><br><br>  Un nodo que le permite alinear con mayor precisi√≥n los modelos entre s√≠: alineaci√≥n r√≠gida.  El nodo de geometr√≠a flotante conecta la geometr√≠a que debe alinearse.  En el nodo Geometr√≠a fija, respectivamente, habr√° geometr√≠a est√°tica (en nuestro caso, esto es un escaneo). <br><br><img src="https://habrastorage.org/webt/-1/8f/an/-18fanskyoz3mzz3ispdjlsgt9k.png" alt="imagen"><br><br>  Cuando use el nodo Alineaci√≥n r√≠gida, debe usar el nodo Seleccionar puntos: <br><br><img src="https://habrastorage.org/webt/yx/nk/yz/yxnkyzv8vfifpocy9rezqo77sbq.png" alt="imagen"><br><br>  Mi modelo tiene marcadores de control que simplifican la tarea de seleccionar puntos.  Para alinear los modelos uno con respecto al otro, se deben colocar puntos en aquellas partes de la cara que cambian ligeramente al representar una emoci√≥n particular.  En el caso de esta emoci√≥n, esta es la frente, la parte superior de la nariz, el cuello, etc.  Adem√°s, es aconsejable colocar puntos en todos los lados del modelo (es decir, no solo en la cara, sino tambi√©n en la parte posterior de la cabeza y las orejas). <br><br><img src="https://habrastorage.org/webt/qy/88/yf/qy88yf5dndsigcayzn7cruu1m-4.png" alt="imagen"><br><br>  Como resultado, obtenemos modelos alineados entre s√≠: <br><br><img src="https://habrastorage.org/webt/bx/l9/ao/bxl9aog0pbuv2bap92i0sysyi9g.png" alt="imagen"><br><br>  En la configuraci√≥n del nodo Alineaci√≥n r√≠gida, hay una funci√≥n de "coincidencia de skale".  Se usa si los modelos necesitan ser escalados tambi√©n. <br><br>  Despu√©s de eso, puede comenzar a proyectar la malla base en el escaneo.  Para esto, usaremos el nodo Optical Flow Wrapping.  Le permite alinear la geometr√≠a de acuerdo con la textura del escaneo.  Al mismo tiempo, la textura resultante de las emociones coincidir√° completamente con la textura de la malla base, con la excepci√≥n de las arrugas, arrugas y otros cambios.  Todas las irregularidades de la piel y los poros al usar este m√©todo permanecen en su lugar. <br><br><img src="https://habrastorage.org/webt/mb/7m/iv/mb7mivt59e9su6kjmrpk1hnugwa.png" alt="imagen"><br><br>  Antes de usar la corriente √≥ptica, como en el primer caso, se usa el nodo Seleccionar pol√≠gonos: <br><br><img src="https://habrastorage.org/webt/ju/4v/to/ju4vto3ddusr5jsvugf6odd_qbi.png" alt="imagen"><br><br>  Por lo tanto, las partes fijas de la cabeza permanecer√°n en su lugar. <br><br>  Tambi√©n puede usar el nodo Seleccionar puntos.  Aqu√≠ est√°n los puntos en las partes m√≥viles de la cara: <br><br><img src="https://habrastorage.org/webt/ph/3h/gw/ph3hgwcigqpzp7k8phlpe-n-d78.png" alt="imagen"><br><br>  A continuaci√≥n, vaya a la configuraci√≥n del flujo √≥ptico.  Las c√°maras que se pueden ajustar aparecieron en la ventana del Editor visual alrededor del modelo. <br><br><img src="https://habrastorage.org/webt/kf/lk/gs/kflkgszewb1rqqb5mruaw2fpo38.png" alt="imagen"><br><br>  En la parte superior hay un men√∫ desplegable con el que puede ir a la vista desde la c√°mara.  Hay 13 por defecto. Debe configurarlos para que la cara encaje completamente en el marco. <br><br><img src="https://habrastorage.org/webt/nk/rz/da/nkrzdal-nf0bmdccxubbr2jfgnk.png" alt="imagen"><br><br>  Por recomendaci√≥n de los desarrolladores, dejo casi todas las configuraciones de forma predeterminada con la excepci√≥n de los par√°metros finales Resoluci√≥n final y Flujo √≥ptico final: <br><br><img src="https://habrastorage.org/webt/rs/og/t3/rsogt301d29-fmdkw3-w_ikb4f8.png" alt="imagen"><br><br>  Despu√©s de eso, puede hacer clic en Calcular y ver el resultado: <br><br><img src="https://habrastorage.org/webt/oq/sh/wv/oqshwvwqspwpktcdmrtcdaan0ru.png" alt="imagen"><br><br>  Despu√©s de que la malla se proyecta exactamente sobre el escaneo, debe hornear la textura.  Esto se hace de acuerdo con el mismo principio que en la primera parte del art√≠culo: <br><br><img src="https://habrastorage.org/webt/5q/i3/ua/5qi3uariv6ry89ideprjf9yonmo.png" alt="imagen"><br><br>  Como resultado, si combina la textura resultante con la textura de la malla base, se agregar√°n algunos detalles, pero al mismo tiempo, los puntos de control coincidir√°n: <br><br><img src="https://habrastorage.org/webt/fs/ws/tk/fswstkeyd2cmmu2xdzdja_3ffbg.png" alt="imagen"><br><br>  Despu√©s de eso, la textura y la geometr√≠a resultante se pueden guardar. <br><br><img src="https://habrastorage.org/webt/fg/o1/sz/fgo1szpef_fqluip7uf4uqgehko.png" alt="imagen"><br><br>  Como resultado, obtuvimos una malla de una nueva emoci√≥n con una textura. <br><br><h4>  Parte 4 </h4><br>  El m√©todo de formas de mezcla le permite "mezclar emociones".  Para hacer esto, cargue las mallas ya recibidas en el nodo Formas de fusi√≥n. <br><br><img src="https://habrastorage.org/webt/jl/fi/i2/jlfii24nzvg4ptcyfl7bawhwbbc.png" alt="imagen"><br><br>  Cargu√© una emoci√≥n neutral en el primer nudo.  Al mover los controles deslizantes en la configuraci√≥n del nodo, puede elegir qu√© tan fuerte se expresar√° esta o aquella emoci√≥n.  Para que este m√©todo funcione, los modelos deben tener la misma topolog√≠a. <br><br><img src="https://habrastorage.org/webt/zx/0k/o5/zx0ko5teguiqiogh4qcsc8cyw_u.png" alt="imagen"><br><br><img src="https://habrastorage.org/webt/vi/ld/uq/vilduqi1jwtzgr662xx4nsyh85q.png" alt="imagen"><br><br><h4>  Resultado </h4><br>  El proceso anterior es solo una peque√±a parte de un trabajo muy voluminoso.  Despu√©s de recibir los modelos de cabeza LowPoly, fue necesario crear mapas normales, aspereza, subsuperficie, etc., as√≠ como configurar el sombreador (en nuestro caso, configuramos el sombreador para el renderizado y el motor).  Los ojos, la ropa y el cabello tambi√©n se crearon por separado.  Tambi√©n vale la pena se√±alar que solo tres personas realizaron esta tarea.  Esta fue nuestra primera experiencia en la creaci√≥n de un personaje muy detallado.  Quedamos satisfechos con el resultado, pero nos esforzaremos por obtener m√°s. <br><br><img src="https://habrastorage.org/webt/25/wo/-m/25wo-m_68qxmzq4wtff-2px721u.jpeg" alt="imagen"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471288/">https://habr.com/ru/post/471288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471268/index.html">Comprender los corredores de mensajes. Aprendiendo la mec√°nica de la mensajer√≠a a trav√©s de ActiveMQ y Kafka. Cap√≠tulo 2. ActiveMQ</a></li>
<li><a href="../471270/index.html">Automatizamos la recepci√≥n de datos sobre la velocidad de carga de un sitio desde Google PageSpeed ‚Äã‚ÄãInsights [plantilla]</a></li>
<li><a href="../471272/index.html">Los beneficios de escribir fuerte en C ++: experiencia pr√°ctica</a></li>
<li><a href="../471278/index.html">Generaci√≥n de texto en ruso por plantillas</a></li>
<li><a href="../471282/index.html">Buscando neumon√≠a en rayos X con Fast.ai</a></li>
<li><a href="../471294/index.html">Poemas sobre Haskell, C ++ y programadores.</a></li>
<li><a href="../471296/index.html">Lean Manufacturing: una herramienta para la eficiencia</a></li>
<li><a href="../471298/index.html">Bieber y Bilan agitan un bol√≠grafo. AI ahora est√° cantando canciones</a></li>
<li><a href="../471300/index.html">Reaccionar: levantar el estado est√° matando tu aplicaci√≥n</a></li>
<li><a href="../471302/index.html">Verificaci√≥n de usuario en China y cr√©dito social</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>