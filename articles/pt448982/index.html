<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèóÔ∏è üöµ „Ä∞Ô∏è CMS sem cabe√ßa. Por que estou escrevendo o meu üë©üèº‚Äçü§ù‚Äçüë®üèø üë®üèª‚Äçüî¨ üêøÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! 

 Este artigo recente me levou a escrever esta publica√ß√£o (eu a vi ontem). 

 Recontar os principais recursos do Headless / conte√∫do pri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CMS sem cabe√ßa. Por que estou escrevendo o meu</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448982/"> Ol√° pessoal! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Este artigo recente</a> me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">levou</a> a escrever esta publica√ß√£o (eu a vi ontem). <br><br>  Recontar os principais recursos do Headless / conte√∫do primeiro / API primeiro, etc.  N√£o serei CMS, o material est√° cheio e provavelmente muitos j√° est√£o familiarizados com essa tend√™ncia.  E quero lhe dizer por que e como escrevo meu sistema, por que n√£o pude escolher entre os existentes, o que penso sobre outros sistemas que j√° encontrei antes e quais s√£o as perspectivas para tudo isso.  A fic√ß√£o ser√° volumosa (para o material em dois anos), mas tentarei escrever mais interessante e √∫til.  Quem se importa, por favor, debaixo do gato. <br><a name="habracut"></a><br>  Em geral, a hist√≥ria √© realmente longa e tentarei contar primeiro.  Para deixar mais claro quais s√£o as verdadeiras raz√µes para a cria√ß√£o de seu pr√≥prio mecanismo, ou simplesmente porque sem isso ser√° dif√≠cil explicar por que estou fazendo dessa maneira, e n√£o de alguma maneira. <br><br>  Mas, para come√ßar, vou escrever brevemente os principais crit√©rios de sele√ß√£o para o CMS moderno sem cabe√ßa para mim pessoalmente, por que ainda n√£o consegui escolher uma solu√ß√£o pronta para mim.  <i>S√≥ para que as pessoas n√£o parem de ler muitas faias, sem entender o que ser√° dito.</i> <br><br>  Resumidamente: queria que tudo estivesse em um s√≥ lugar: na parte de tr√°s e na frente (e n√£o isso ou aquilo), e a API do GraphQL, e que o banco de dados fosse gerenciado e muito mais, incluindo o bot√£o "Make Beautiful".  Eu n√£o encontrei isso.  Tamb√©m eu tamb√©m n√£o fiz isso, mas, no geral, ficou bastante e, o mais importante, me permite fazer projetos reais. <br><br>  E assim, minha abordagem dificilmente pode ser chamada de cient√≠fica e justificada.  O fato √© que geralmente geralmente escrevo algo pr√≥prio.  Eu gosto de programar aqui.  E dois anos atr√°s (e antes disso outros 8 anos), sentei-me no MODX CMF (no qual tamb√©m inventei muitas das minhas muletas).  Por tr√™s anos, iniciamos um projeto de grande escala, no qual, ao que me parecia, eu poderia usar o MODX.  Mas, como se viu, n√£o pude ... O principal motivo foi que era uma startup sem requisitos t√©cnicos, com um monte de id√©ias que mudavam e eram complementadas todos os dias (e v√°rias vezes ao dia).  E agora, toda vez que, sob uma nova id√©ia, era necess√°rio adicionar uma nova entidade, registrar / alterar campos para os existentes, criar / excluir / alterar relacionamentos entre essas entidades (respectivamente, com uma altera√ß√£o na estrutura do banco de dados), eu tenho em algum momento Come√ßou a demorar v√°rias horas para mudar essas entidades.  De fato, al√©m de ser necess√°rio registrar essas altera√ß√µes no esquema, era necess√°rio alterar o banco de dados (quase manualmente), atualizar a API, reescrever o c√≥digo do programa etc. etc.  Consequentemente, a frente teve que ser atualizada sob tudo isso.  Como resultado, decidi que dever√≠amos procurar algo novo, mais conveniente, que de alguma forma simplificasse tudo isso.  Esclare√ßo mais uma vez que naquela √©poca eu era um back-end php, ent√£o n√£o se surpreenda ou ria que comecei a descobrir v√°rios construtores de front-end, menos processadores, npm etc.  etc.  Mas de qualquer maneira, gradualmente em nosso projeto, uma frente apareceu em react + less, uma API no GraphQL e um servidor no express. <br><br>  Mas nem tudo estava t√£o r√≥seo quanto parece para muitos agora.  Deixe-me lembr√°-lo, isso foi h√° mais de dois anos atr√°s.  Se voc√™ est√° na web JS moderna h√° menos de dois anos, recomendo a leitura deste artigo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">N raz√µes para usar o aplicativo Create React</a> (habr).  Muito pregui√ßoso, brevemente: com o advento dos scripts de rea√ß√£o, voc√™ n√£o pode se preocupar em configurar o webpack, etc.  Tudo isso entra em segundo plano.  Caras j√° configuraram o webpack para garantir que quase todos os projetos de rea√ß√£o trabalhem nele, e o desenvolvedor final se concentrou diretamente na programa√ß√£o do produto final, em vez de configurar v√°rias depend√™ncias, carregadores etc.  Mas isso √© mais tarde.  E antes disso, eu apenas tinha que configurar este webpack, seguir a atualiza√ß√£o de um monte de tudo o que voava com ele para alcan√ß√°-lo, etc.  etc.  Mas isso √© apenas parte do trabalho, apenas essencialmente a frente.  E voc√™ tamb√©m precisa de um servidor.  E voc√™ tamb√©m precisa de uma API.  E voc√™ tamb√©m precisa de SSR (renderiza√ß√£o do lado do servidor), que, a prop√≥sito, o react-script ainda n√£o fornece, tanto quanto eu sei.  Em geral, tudo estava muito mais complicado do que agora, n√£o havia muito e todo mundo se agachava da melhor maneira poss√≠vel.  E como eu muleta ent√£o ... <br><br>  Imaginem: <br><br><ul><li>  Configura√ß√£o nativa do webpack separadamente para front e server. </li><li>  Implementa√ß√£o pr√≥pria do SSR, para que o ass√≠ncrono funcione normalmente com o servidor de rea√ß√£o, e os estilos imediatamente prontos cheguem e sejam indexados normalmente, e os status do servidor para as p√°ginas n√£o encontradas foram fornecidos. </li><li>  Sem redux.  Bem, eu n√£o gostei do redux imediatamente.  Gostei da ideia de usar meu fluxo de rea√ß√£o nativo (embora eu tenha que reescrev√™-lo um pouco para mim). </li><li>  Esquemas e resolvedores GraphQL prescritos manualmente, sem implanta√ß√£o autom√°tica do banco de dados (o servidor API foi usado como meio para um site MODX). </li><li>  N√£o reage-apollo / apollo-client, etc.  Tudo √© escrito de forma independente com solicita√ß√µes atrav√©s de busca, reposit√≥rios em um navegador baseado no fluxo personalizado. </li></ul><br>  Como resultado: at√© agora, uma das primeiras vers√µes possui um projeto com mais de 500 participantes e, na temporada (inverno), mil a mil e mil e mil alunos por dia.  Uptime 2 meses.  Isso ocorre porque eu reiniciei o servidor manualmente ap√≥s uma atualiza√ß√£o de software preventiva.  E antes dessa reinicializa√ß√£o, o tempo de atividade era de mais de 6 meses.  Mas o mais interessante √© o consumo de mem√≥ria.  Atualmente, existem quase 700 megabytes de processo js.  Sim, sim, eu tamb√©m estou rindo com voc√™ aqui :) Claro, isso √© muito.  E antes disso eu fiz um pouco de preven√ß√£o e aprimorei esse indicador.  Anteriormente, havia um total de 1000M + por processo ... No entanto, funcionava e era bastante toler√°vel.  E antes que o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google alterasse os algoritmos do PageSpeed ‚Äã‚ÄãInsights</a> em novembro, o site tinha uma m√©trica de desempenho 97/100.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prova</a> <br><br>  Uma conclus√£o intermedi√°ria baseada neste projeto, baseada em um sistema que se desenvolveu mais sem esse projeto (o projeto foi deixado para tr√°s): <br><br>  <b>Pr√≥s</b> <br><br><ol><li>  A API do projeto tornou-se mais flex√≠vel com o uso do GraphQL, e o n√∫mero de solicita√ß√µes do servidor foi reduzido significativamente. </li><li>  O projeto tem acesso a um grande n√∫mero de componentes no npm. </li><li>  O gerenciamento de projetos se tornou mais transparente atrav√©s do uso de depend√™ncias, git, etc. </li><li>  Os scripts e estilos criados s√£o certamente mais agrad√°veis ‚Äã‚Äãdo que v√°rios scripts separados em sites antigos, quando voc√™ n√£o sabe o que pode remover deste zool√≥gico sem consequ√™ncias (e muitas vezes v√™ v√°rias vers√µes de um bug em um site). </li><li>  O site tornou-se mais interativo, as p√°ginas funcionam sem reinicializar. O retorno √†s p√°ginas visualizadas anteriormente n√£o requer repetidas chamadas para o servidor. </li><li>  A edi√ß√£o de dados ocorre diretamente na p√°gina, com o princ√≠pio de "editar o que voc√™ v√™ e onde v√™", sem nenhum painel de administra√ß√£o separado. </li></ol><br>  <b>Contras (principalmente para o desenvolvedor)</b> <br><br><ol><li>  Tudo √© muito complicado.  S√©rio.  √â simplesmente irreal conectar um desenvolvedor de terceiros ao projeto.  Eu mesmo mal conseguia descobrir o que e como funciona e de onde minhas pernas crescem.  Se voc√™ olhar para a p√°gina 3 das vantagens, onde se diz sobre transpar√™ncia, a transpar√™ncia √© apenas uma vez que, se voc√™ conectar algo a algum lugar, poder√° ver imediatamente o que est√° quebrado (scripts n√£o s√£o constru√≠dos etc.), mas por commit e diffs Voc√™ pode encontrar onde isso viciado.  Bem, se voc√™ conseguiu adicionar algo novo e funciona, pelo menos voc√™ entende claramente que, sim, tudo correu bem.  Mas no geral ainda √© um inferno infernal. </li><li>  Dificuldades com o cache.  Mais tarde, descobri o apollo-client para mim.  E antes disso, como eu disse, escrevi meus armazenamentos baseados em fluxo.  Devido a esses armazenamentos, foi poss√≠vel obter os dados necess√°rios para renderiza√ß√£o de diferentes componentes, mas o volume do cache no lado do cliente era muito grande (cada conjunto de entidades t√≠picas tinha seu pr√≥prio reposit√≥rio).  Como resultado, foi dif√≠cil verificar se o objeto foi solicitado anteriormente ou n√£o (ou seja, vale a pena fazer uma solicita√ß√£o ao servidor para encontr√°-lo), se todos os dados relacionados est√£o dispon√≠veis etc. </li><li>  Dificuldades com esquemas, estrutura de banco de dados e resolvedores (fun√ß√µes de API para recebimento / modifica√ß√£o de dados).  Como eu disse, escrevi esquemas manualmente e resolvedores tamb√©m.  Em que resolvedores, tentei fornecer armazenamento em cache e processamento de solicita√ß√µes aninhadas e outras sutilezas.  Naquele momento, tive que me aprofundar na ess√™ncia e no c√≥digo do programa GraphQL.  A vantagem √© que geralmente entendo muito bem como o GraphQL funciona, quais s√£o seus pr√≥s e contras e como prepar√°-lo melhor.  A desvantagem √© que, √© claro, voc√™ n√£o pode escrever todas essas comodidades e p√£es escritos por comandos como o Apollo em um.  Como resultado, quando descobri a Apollo, √© claro, comecei a usar seus componentes com muito prazer (mas principalmente na frente, vou lhe dizer o porqu√™ abaixo). </li></ol><br>  Em geral, esse projeto usando tecnologias desatualizadas √© pessoalmente meu em 100%, para que eu possa abandon√°-lo at√© tempos melhores.  Mas existem outros projetos para os quais eu tive que ir al√©m e desenvolver a plataforma.  E v√°rias vezes tive que reescrever tudo do zero.  Al√©m disso, falarei com mais detalhes sobre as tarefas individuais que encontrei e quais solu√ß√µes desenvolvi e apliquei como resultado. <br><br>  <b>Esquema primeiro.</b>  <b>Primeiro o circuito, e depois todo o resto</b> <br><br>  Um site (interface da web, thin client, etc.) √© toda a exibi√ß√£o de informa√ß√µes (bem, gerenciamento de informa√ß√µes, se permitido e funcionalidade permitida).  Mas primeiro, mesmo assim, um banco de dados (tabelas, colunas, etc.).  Tendo encontrado v√°rias abordagens diferentes para trabalhar com o banco de dados no meu caminho, gostei mais da abordagem Schema-first.  Ou seja, voc√™ descreve o esquema de entidades e tipos de dados (manualmente ou por meio da interface), implanta o esquema e imediatamente possui as altera√ß√µes descritas no banco de dados (tabelas / colunas s√£o criadas / exclu√≠das, bem como os relacionamentos entre elas).  Dependendo da implementa√ß√£o, voc√™ tamb√©m gerar√° todas as fun√ß√µes de resolu√ß√£o necess√°rias para gerenciar esses dados.  Acima de tudo, nessa dire√ß√£o, gostei do projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">prisma.io</a> . <br><br>  Com sua permiss√£o, j√° que mesmo no hub eu n√£o vi um √∫nico artigo sobre o prisma, chamarei a aten√ß√£o um pouco, pois o projeto √© realmente muito interessante e, sem eles, n√£o teria agora uma plataforma que me deixou t√£o feliz .  Na verdade, foi por isso que chamei minha plataforma de prisma-cms, porque o prisma.io desempenha um papel muito importante nela. <br><br>  Na verdade, o prisma.io √© um projeto SaaS, mas com uma grande ressalva: eles colocam quase tudo o que fazem no github.  Ou seja, voc√™ pode usar os servidores deles por uma taxa bastante razo√°vel (e configurar seu pr√≥prio banco de dados e API em quest√£o de minutos) ou pode implantar totalmente tudo em casa.  Nesse caso, o prisma deve ser logicamente dividido em duas partes separadas importantes: <br><br><ol><li>  Prisma-server, ou seja, o servidor em que o banco de dados tamb√©m est√° girando. </li><li>  Prisma-cliente.  √â essencialmente tamb√©m um servidor, mas em rela√ß√£o √† fonte de dados (prisma-server) √© um cliente. </li></ol><br>  Agora vou tentar explicar essa situa√ß√£o confusa.  Em geral, a ess√™ncia do prisma √© que, usando um √∫nico terminal de API, voc√™ pode trabalhar com diferentes fontes de dados.  Sim, aqui algu√©m dir√° que todos criaram o GraphQL e o prisma n√£o √© necess√°rio aqui.  Em geral, todos estar√£o certos, mas h√° um ponto s√©rio: o GraphQL define apenas os princ√≠pios e o trabalho geral, mas, por si s√≥, ele n√£o fornece trabalho com as fontes de dados finais prontas para uso.  Ele diz: "Voc√™ pode criar uma API para descrever quais solicita√ß√µes os usu√°rios podem enviar, mas como voc√™ lida com essas solicita√ß√µes √© seu trabalho".  E o prisma tamb√©m, √© claro, usa o GraphQL (a prop√≥sito, e muitas outras coisas, incluindo v√°rios produtos Apollo).  Mas o prisma mais a isso apenas fornece trabalho com o banco de dados.  Ou seja, descrevendo o esquema e sua implanta√ß√£o, as tabelas e colunas necess√°rias (bem como os relacionamentos entre elas) ser√£o criadas imediatamente no banco de dados especificado e geram imediatamente todas as fun√ß√µes CRUD necess√°rias.  Ou seja, com um prisma, voc√™ n√£o apenas obt√©m um servidor GraphQL, mas uma API de trabalho completa que imediatamente permite que voc√™ trabalhe com o banco de dados.  Portanto, o Prisma-server fornece um banco de dados e a intera√ß√£o com ele, e o prisma-client permite que voc√™ escreva seus resolvedores e envie solicita√ß√µes ao prisma-server (ou a algum outro lugar, mesmo para alguns servidores prisma).  Acontece que voc√™ s√≥ pode implantar o prisma-client por conta pr√≥pria (e o SaaS prisma.io ser√° usado como prisma-server), e voc√™ pode implantar o prisma-server por conta pr√≥pria e geralmente n√£o depende de um prisma de forma alguma, isso √© tudo seu. <br><br>  Aqui eu escolhi um prisma para mim, como base para minha plataforma.  Mas ent√£o eu tive que girar para mim, a fim de obter uma plataforma completa. <br><br><h4>  1. Esquemas de mesclagem </h4><br>  Naquela √©poca, o prisma n√£o era capaz de combinar circuitos.  Ou seja, a tarefa √© a seguinte: <br><br>  Voc√™ tem um modelo de usu√°rio descrito em um m√≥dulo <br><br><pre><code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> @unique }</code> </pre> <br>  e em outro m√≥dulo <br><br><pre> <code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique firstname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> lastname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> }</code> </pre><br>  Como parte de um projeto, voc√™ deseja combinar esses dois esquemas automaticamente para obter a sa√≠da <br><br><pre> <code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> @unique firstname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> lastname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> }</code> </pre><br>  Mas ent√£o esse prisma n√£o poderia funcionar.  Acabou implementando isso usando a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">biblioteca merge-graphql-schemas</a> . <br><br><h4>  Trabalhe com um servidor prisma arbitr√°rio. </h4><br>  No prisma, a configura√ß√£o √© gravada em um arquivo de configura√ß√£o especial.  Se voc√™ deseja alterar o endere√ßo do servidor prisma usado, voc√™ deve editar o arquivo.  Um pouco, n√£o √© agrad√°vel.  Eu queria tornar poss√≠vel o URL especificar no comando, por exemplo, endpoint = http: // endpoint-end yarn deploy (in√≠cio do fio).  Isso foi morto por v√°rios dias ... Mas agora voc√™ pode usar um projeto de prisma para qualquer n√∫mero de terminais.  A prop√≥sito, at√© agora o prisma-cms funciona facilmente mesmo com um banco de dados local, mesmo com servidores Prism SaaS. <br><br><h4>  M√≥dulos / Plugins </h4><br>  Isso geralmente n√£o era suficiente.  Como eu disse, a principal tarefa do prisma √© fornecer trabalho com v√°rios bancos de dados.  E eles fazem um excelente trabalho nisso.  Eles j√° suportam trabalhar com MySQL, PostgreSQL, Amazon RDS e MongoDB, v√°rios outros tipos de fontes no caminho.  Mas eles n√£o fornecem nenhuma infraestrutura modular.  At√© o momento, n√£o existe mercado ou algo do tipo.  Existem apenas alguns espa√ßos em branco t√≠picos.  Mas voc√™ n√£o pode escolher dois ou tr√™s de v√°rios espa√ßos em branco e instalar em um projeto.  N√≥s vamos ter que escolher um.  Eu queria que fosse poss√≠vel instalar um n√∫mero diferente de m√≥dulos no projeto final e que, ao implantar os circuitos e os resolvedores, se divertissem e obtivessem um projeto √∫nico com a funcionalidade total.  E, embora ainda n√£o exista uma interface gr√°fica, j√° existem mais de duas d√∫zias de m√≥dulos e componentes em funcionamento que podem ser combinados no projeto final.  Aqui, decidirei imediatamente um pouco sobre as defini√ß√µes pessoais: um m√≥dulo √© o que √© instalado na parte traseira (expandindo o banco de dados e a API) e um componente √© o que √© instalado na frente (para adicionar v√°rios elementos da interface).  At√© o momento, n√£o h√° interface gr√°fica para conectar m√≥dulos, mas n√£o √© dif√≠cil escrever dessa maneira (isso geralmente n√£o √© feito): <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(options = {}) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mergeModules([ LogModule, MailModule, UploadModule, SocietyModule, EthereumModule, WebrtcModule, UserModule, RouterModule, ]); }</code> </pre><br>  Depois de adicionar novos m√≥dulos, basta executar uma implanta√ß√£o com um comando novamente e √© isso, aqui j√° temos novas tabelas / colunas e funcionalidade aumentada. <br><br><h4>  5 frente, sens√≠vel √†s mudan√ßas no back-end </h4><br>  Isso n√£o foi suficiente.  Isto ser√° seguido por uma digress√£o.  O fato √© que todo o CMS da primeira API que eu vi diz "N√≥s somos incr√≠veis para fornecer a API, e voc√™ estraga a frente que quiser".  Esse √© o "parafuso que voc√™ quiser" de fato significa "incomodar o quanto quiser".  Exatamente o mesmo que os frameworks de interface do usu√°rio dizem: ‚Äúveja como bot√µes legais somos e fa√ßa tudo isso, e confunda-se com o back-end‚Äù.  Isso sempre matava.  Eu s√≥ queria encontrar um CMS abrangente escrito em javascript, usando o GraphQL e fornecendo tanto a parte traseira quanto a frontal.  Mas n√£o encontrei um assim.  Eu realmente queria que as altera√ß√µes na API fossem percebidas imediatamente na frente.  E para isso, v√°rias subetapas foram conclu√≠das: <br><br><h4>  5.1 Gerando fragmentos de API </h4><br>  Na frente, fragmentos do arquivo de esquema s√£o registrados nas solicita√ß√µes.  Quando a API √© reconstru√≠da no servidor, um novo arquivo JS com fragmentos da API tamb√©m √© gerado.  E nos pedidos est√° escrito assim: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { UserNoNestingFragment, EthAccountNoNestingFragment, NotificationTypeNoNestingFragment, BatchPayloadNoNestingFragment, } = queryFragments; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userFragment = <span class="hljs-string"><span class="hljs-string">` fragment user on User { ...UserNoNesting EthAccounts{ ...EthAccountNoNesting } NotificationTypes{ ...NotificationTypeNoNesting } } </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${UserNoNestingFragment}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${EthAccountNoNestingFragment}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${NotificationTypeNoNestingFragment}</span></span></span><span class="hljs-string"> `</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> usersConnection = <span class="hljs-string"><span class="hljs-string">` query usersConnection ( $where: UserWhereInput $orderBy: UserOrderByInput $skip: Int $after: String $before: String $first: Int $last: Int ){ objectsConnection: usersConnection ( where: $where orderBy: $orderBy skip: $skip after: $after before: $before first: $first last: $last ){ aggregate{ count } edges{ node{ ...user } } } } </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${userFragment}</span></span></span><span class="hljs-string"> `</span></span>;</code> </pre><br><h4>  5.2 Um contexto para todos os componentes </h4><br>  O React 16.3 apresenta uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nova API de contexto</a> .  Eu fiz isso para que, nos componentes filhos de qualquer n√≠vel, voc√™ pudesse acessar um √∫nico contexto sem listar os tipos pr√©-desejados do contexto, mas simplesmente especificando contextType = PrismaCmsContext est√°tico e obtendo todos os encantos atrav√©s deste-&gt; contexto (incluindo o cliente da API, o esquema , solicita√ß√µes etc.). <br><br><h4>  5.3 filtros din√¢micos </h4><br>  Eu tamb√©m realmente queria.  O GraphQL permite criar consultas complexas com uma estrutura aninhada.  Eu tamb√©m queria que os filtros fossem din√¢micos, formados a partir do esquema da API e nos permitissem criar condi√ß√µes aninhadas.  Aqui est√° o que aconteceu: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YOCF3ttK2Mg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  5.4 Construtor de sites </h4><br>  E, finalmente, o que me faltava era um editor de site externo, ou seja, um designer.  Eu queria que o servidor tivesse apenas um m√≠nimo de a√ß√µes a serem executadas e todo o design final deveria ser feito na frente (incluindo a configura√ß√£o de roteamento, a gera√ß√£o de sele√ß√µes etc.).  Este √© um t√≥pico para um artigo separado, porque, entre outras coisas, eu tamb√©m escrevi meu editor crysy wysiwyg para ele em puro contentEditable, e h√° muitas sutilezas.  Se me restabelecerem os meus direitos e quem estiver interessado, escreverei um artigo separado. <br><br>  Bem, finalmente, um pequeno v√≠deo de demonstra√ß√£o do designer em a√ß√£o.  Ainda bastante cru, mas eu gosto. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4j9ePxDhHGU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Eu vou terminar com isso.  Ainda n√£o escrevi muito, o que gostaria de escrever, mas muita coisa aconteceu.  Ficarei feliz em comentar. <br><br>  PS: todos os c√≥digos-fonte, incluindo os c√≥digos-fonte do pr√≥prio site, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√£o aqui</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt448982/">https://habr.com/ru/post/pt448982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt448968/index.html">PHP ass√≠ncrono. Porque</a></li>
<li><a href="../pt448970/index.html">Autentica√ß√£o de dois fatores para SSH</a></li>
<li><a href="../pt448974/index.html">Abordagem sem servidor para o r√°pido desenvolvimento de um servi√ßo de v√≠deo em funcionamento</a></li>
<li><a href="../pt448976/index.html">Eventos de primavera Gamedev em HSE</a></li>
<li><a href="../pt448980/index.html">Nosso primeiro almo√ßo juntos: por que e como passamos o dia do teste</a></li>
<li><a href="../pt448986/index.html">Engenharia reversa 3D com digitaliza√ß√£o 3D</a></li>
<li><a href="../pt448992/index.html">Hash vers√°til e perfeito</a></li>
<li><a href="../pt448994/index.html">√â t√£o dif√≠cil iniciar o caminho de um recrutador de TI?</a></li>
<li><a href="../pt448996/index.html">Criando uma pol√≠tica de senha no Linux</a></li>
<li><a href="../pt448998/index.html">Se a conex√£o √© apenas estanque, √© necess√°rio enterr√°-la</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>