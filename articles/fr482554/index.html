<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘ğŸ¼ ğŸŒˆ ğŸ¬ Maison intelligente avec Xiaomi sur l'exemple d'un bain ğŸ‘¨â€ğŸ¤ ğŸš¦ ğŸ¥˜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sur Internet, il y a beaucoup de critiques et de vidÃ©os sur la construction de maisons intelligentes. Il y a une opinion que tout cela est assez cher ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maison intelligente avec Xiaomi sur l'exemple d'un bain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plesk/blog/482554/"> Sur Internet, il y a beaucoup de critiques et de vidÃ©os sur la construction de maisons intelligentes.  Il y a une opinion que tout cela est assez cher et gÃªnant dans l'organisation, c'est-Ã -dire, en gÃ©nÃ©ral, le lot des geeks.  Mais les progrÃ¨s ne s'arrÃªtent pas.  Les appareils deviennent moins chers, tandis que plus fonctionnels, et la conception et l'installation sont assez simples.  Cependant, fondamentalement, les critiques se concentrent sur 1-2 exemples d'utilisation, ne couvrant pratiquement pas les nuances et sans crÃ©er une image holistique.  Par consÃ©quent, dans cet article, je veux passer en revue le projet terminÃ©, dÃ©montrer les scÃ©narios d'utilisation et les piÃ¨ges dans la construction d'une maison intelligente Ã  l'aide d'appareils Xiaomi en utilisant l'exemple d'une baignoire.  Les idÃ©es dÃ©crites avec de lÃ©gÃ¨res variations peuvent Ãªtre appliquÃ©es Ã  l'automatisation de l'appartement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="image" width="400" height="400"></div><br><a name="habracut"></a><br><h2>  Contexte ou pourquoi tout cela est nÃ©cessaire </h2><br>  Pour commencer, un peu de fond pour clarifier le contexte.  Au dÃ©but de l'automne 2018, la finition du bain a Ã©tÃ© achevÃ©e et mise en service.  Le bain public est un bÃ¢timent autonome avec chauffage et approvisionnement en eau toute l'annÃ©e. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="image"></div><br>  Pour des raisons Ã©videntes, personne ne vit constamment dans les bains et ne contrÃ´le pas l'Ã©tat des lieux.  Autant que je voudrais, une visite au bain n'est pas non plus un Ã©vÃ©nement trÃ¨s frÃ©quent.  En consÃ©quence, des rÃ©flexions sur la crÃ©ation d'un bain Â«intelligentÂ» Ã©taient prÃ©sentes dÃ¨s le dÃ©but du projet.  Tout d'abord, pour des raisons de sÃ©curitÃ© (incendie, inondation, contrÃ´le d'accÃ¨s).  Par exemple, Ã©teindre le chauffage Ã  -35 degrÃ©s dans la rue (j'habite Ã  Novossibirsk) est une situation trÃ¨s dangereuse.  Cependant, contrairement Ã  la maison principale, je n'ai pas rÃ©flÃ©chi au projet d'automatisation de la baignoire dÃ¨s le dÃ©but et je n'ai pas fait de cÃ¢blage supplÃ©mentaire aux bons endroits.  En revanche, Internet a Ã©tÃ© rÃ©alisÃ© dans les bains publics et une surveillance vidÃ©o est en cours pour l'apparition de deux autres bÃ¢timents (vous pouvez Ã©valuer visuellement ce qui se passe). <br><br>  De retour d'un voyage d'affaires en novembre 2019, le soir je suis allÃ© aux bains publics, j'ai ouvert la porte d'entrÃ©e et j'ai Ã©tÃ© choquÃ© par ce que j'ai vu.  Les LED du point WiFi m'ont clignotÃ© dans l'obscuritÃ© et un jet d'eau a jailli de mes pieds.  Autrement dit, des inondations se sont produites, alors que l'Ã©lectricitÃ© n'a pas Ã©tÃ© coupÃ©e.  L'eau dans les bains est organisÃ©e Ã  l'aide de son propre puits, d'une pompe submersible et d'une automatisation qui contrÃ´le le processus.  Comme il s'est avÃ©rÃ© plus tard, l'un des raccords de l'Ã©changeur des toilettes a Ã©tÃ© perturbÃ© et a inondÃ© toutes les piÃ¨ces.  Je n'ai jamais dÃ©couvert pourquoi l'automatisation Ã©tait dommage et toujours dÃ©sactivÃ©e, mais elle a rÃ©ussi Ã  pomper 15 cm d'eau en 30 carrÃ©s.  Dans la rue ce jour-lÃ , il faisait -14 degrÃ©s.  Le sol chaud a fait face, continuant Ã  maintenir la tempÃ©rature ambiante au niveau appropriÃ©, mais 100% d'humiditÃ© est apparue.  Il Ã©tait impossible de tergiverser davantage sur l'organisation d'une maison intelligente - vous devez commencer Ã  le faire. <br><br><h2>  SÃ©lection d'Ã©quipement </h2><br>  Lors de la construction de la maison principale, j'ai acquis une expÃ©rience de travail avec les appareils <a href="https://eldesalarms.com/">Eldes</a> (le cÃ¢blage correspondant a Ã©tÃ© crÃ©Ã©).  Une partie de l'automatisation se fait sur le <a href="https://www.raspberrypi.org/">Raspberry PI</a> .  Une autre partie <a href="https://www.aqara.com/en/home.html">concerne les appareils Xiaomi Aqara</a> .  L'option avec Raspberry PI Ã©tait la plus attrayante pour moi et elle a d'abord Ã©tÃ© envisagÃ©e pour les bains publics.  Mais, malheureusement, cela nÃ©cessite beaucoup plus d'efforts d'organisation.  Ce n'est toujours pas un appareil plug-and-play - commenÃ§ant par des exercices avec du matÃ©riel et se terminant par un logiciel d'Ã©criture pour vos propres besoins.  Pour certaines raisons, <a href="https://mjdm.ru/">MajorDoMo n'Ã©tait</a> pas content.  Traverser Raspberry PI, ZigBee Adapter (pour utiliser les capteurs sans fil Xiaomi) et Apple HomeKit ont nÃ©cessitÃ© une Ã©tude (et l'interface Apple HomeKit n'est pas trÃ¨s heureuse pour le moment).  Il n'y avait pas beaucoup de temps (je ne voulais pas rÃ©pÃ©ter la situation), et il n'y avait pas de cÃ¢blage pour chaque point souhaitÃ©, j'ai donc dÃ©cidÃ© de tout faire sur les appareils Xiaomi. <br><br>  Le pÃ©riphÃ©rique principal dans cette situation est le concentrateur.  Dans le cas de Xiaomi, il existe deux options pour le concentrateur: Xiaomi Mi Smart Home Gateway 2 et Xiaomi Aqara Gateway.  Ce dernier est environ deux fois plus cher, plus adaptÃ© au marchÃ© local et est capable d'intÃ©grer des appareils dans Apple HomeKit.  Cependant, si vous installez l'application Aqara Home et sÃ©lectionnez la rÃ©gion Â«RussieÂ», au moment de la rÃ©daction de ces lignes, seuls 13 appareils diffÃ©rents (commutateurs, prises, capteurs) seront disponibles.  Si vous installez l'application Xiaomi Home, sÃ©lectionnez la rÃ©gion Â«Chine continentaleÂ», puis des centaines d'appareils seront disponibles pour la connexion.  Cependant, si vous sÃ©lectionnez la rÃ©gion Â«Chine continentaleÂ», vous ne pourrez pas connecter une prise europÃ©enne et vice versa.  La sÃ©lection de la rÃ©gion Â«Chine continentaleÂ» dans le cadre de l'application Aqara Home ne fournit pas l'intÃ©gralitÃ© des appareils prÃ©sents dans Xiaomi Home avec la mÃªme rÃ©gion.  Peur d'incompatibilitÃ©, j'ai dÃ©cidÃ© de m'arrÃªter sur le hub Xiaomi Mi Smart Home Gateway 2. Le prix d'Ã©mission est d'environ 2000 p.  Soit dit en passant, le moyeu lui-mÃªme agit comme une lampe - cela peut Ãªtre pris en compte lors de l'installation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="image"></div><br>  Une autre question intÃ©ressante est de savoir combien de temps cela fonctionnera.  Il ne s'agit mÃªme pas de capteurs et de batteries, mais de synchronisation et de stockage de donnÃ©es dans le cloud.  Le compte est actuellement gratuit.  Toutes les informations sont stockÃ©es sur les serveurs Xiaomi.  Si demain les gars dÃ©cident que les utilisateurs de Russie ne devraient pas stocker de donnÃ©es dans la rÃ©gion "Chine continentale" ou si Roskomnadzor interdit leurs serveurs pour une raison quelconque, alors toute la maison intelligente risque de se transformer en citrouille.  J'ai dÃ©cidÃ© moi-mÃªme que dans ce cas, les capteurs resteront et le concentrateur sera remplacÃ© par l'adaptateur Raspberri PI + ZigBee. <br><br><h2>  ContrÃ´le et prÃ©vention des fuites </h2><br>  Le premier et le plus important scÃ©nario d'automatisation Ã©tait une continuation naturelle du problÃ¨me - en cas de fuite, vous devez couper l'alimentation en eau, c'est-Ã -dire la pompe, et envoyer une notification du problÃ¨me au tÃ©lÃ©phone.  Il y avait deux endroits potentiellement dangereux pour l'apparition de fuites. <br><br>  En plus du concentrateur pour ce scÃ©nario, deux capteurs de fuite et une prise murale intelligente Ã©taient nÃ©cessaires.  Le prix du capteur de fuite est d'environ 1400 r.  Le prix d'une prise murale intelligente est d'environ 1700 p.  Les capteurs de fuite sont autonomes, ils fonctionnent sur piles.  Le fabricant prÃ©tend qu'une seule batterie suffit pour 2 ans. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="image"></div><br>  L'installation d'une prise intelligente Ã©tait un peu compliquÃ©e car des prises carrÃ©es sont nÃ©cessaires pour les points de vente chinois, qui ne sont pas vendus dans nos magasins habituels (mais peuvent Ãªtre commandÃ©s).  Percer des trous carrÃ©s est toujours un plaisir.  De plus, dans le bon sens, vous avez besoin d'un adaptateur, bien qu'il existe Ã©galement une prise pour une prise europÃ©enne.  Dans la version Aqara pour le marchÃ© local, il n'y a actuellement pas de prise murale pour le montage mural, ce qui nous relie Ã  la rÃ©gion Â«Chine continentaleÂ».  Alternativement, vous pouvez installer une prise ordinaire, brancher une prise intelligente avec une prise de Xiaomi, mais cela nÃ©cessiterait deux adaptateurs supplÃ©mentaires.  Une autre alternative est un relais.  Mais je me suis installÃ© sur une prise murale. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="image"></div><br>  Dans l'application Xiaomi Home, une prise et un capteur ont Ã©tÃ© ajoutÃ©s.  Ensuite, le scÃ©nario Â«en cas de fuiteÂ» est prescrit pour deux actions: fermer la prise et envoyer une alerte. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="image"></div><br>  Le premier capteur de fuite a Ã©tÃ© installÃ© Ã  cÃ´tÃ© de la pompe (et, en fait, Ã  cÃ´tÃ© du moyeu).  Pour le test, de l'eau a Ã©tÃ© versÃ©e dans une petite plaque et le capteur y a Ã©tÃ© abaissÃ©.  J'ai effectuÃ© toute l'action directement sur le site d'installation du capteur afin de rapprocher le plus possible la situation de la rÃ©alitÃ©.  Le test a rÃ©ussi: la prise s'est Ã©teinte, la notification est parvenue au tÃ©lÃ©phone, et le concentrateur a clignotÃ© en mode d'urgence. <br><br>  Le deuxiÃ¨me dÃ©tecteur de fuite devait Ãªtre installÃ© dans les toilettes Ã  cÃ´tÃ© de l'Ã©changeur.  Mais avec son installation, des nuances sont apparues - le moyeu n'a pas vu le capteur, bien que la distance soit petite.  La raison en est la configuration des locaux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="image"></div><br>  Il y avait un hammam entre le site d'installation du hub (salle de relaxation) et le site d'installation du deuxiÃ¨me capteur de fuite (toilettes).  Le hammam, dans les meilleures traditions, est cousu dans le cercle avec du papier d'aluminium, crÃ©ant des problÃ¨mes avec le passage du signal. <br><br>  Le fabricant affirme que les appareils peuvent former un rÃ©seau maillÃ©, c'est-Ã -dire qu'un appareil peut transmettre des donnÃ©es au concentrateur via un autre appareil.  Quelque part, je suis tombÃ© sur des informations selon lesquelles seuls les appareils connectÃ©s au rÃ©seau (et non sur piles) peuvent agir comme de tels Ã©metteurs dans un rÃ©seau maillÃ©.  Cependant, il me suffisait d'installer un capteur de tempÃ©rature dans le coin de la salle de bain pour que le signal du capteur de fuite cesse de disparaÃ®tre.  C'est peut-Ãªtre une coÃ¯ncidence, car plus tard dans la salle de bain sous le plafond, un relais de contrÃ´le de l'Ã©clairage public a Ã©tÃ© montÃ© (peut-Ãªtre qu'il agit comme un Ã©metteur dans le rÃ©seau maillÃ©).  Cependant, le problÃ¨me de la perte de signal du capteur de fuite dans les toilettes a Ã©tÃ© rÃ©solu.  De plus, vous pouvez vÃ©rifier la connexion de l'appareil avec le concentrateur en cliquant sur le capteur au centre.  Si tout va bien, alors en chinois pur, les informations pertinentes retentiront depuis le hub (dans le cas du hub Aqara, la communication se fera en anglais agrÃ©able). <br><br>  La vÃ©rification de l'arrÃªt, puis la mise sous tension Ã  l'aide de la machine ont montrÃ© que la prise intelligente passe Ã  l'Ã©tat Ã©teint.  Pour qu'il passe Ã  l'Ã©tat activÃ© lorsque l'Ã©lectricitÃ© apparaÃ®t, il existe un paramÃ¨tre correspondant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="image"></div><br>  Un signe supplÃ©mentaire de l'inondation de la piÃ¨ce Ã©tait une augmentation de l'humiditÃ© jusqu'Ã  100%.  Sur le contrÃ´le de ce symptÃ´me - dans la section suivante. <br><br><h2>  ContrÃ´le de la fumÃ©e et de la tempÃ©rature </h2><br>  Le bain public Ã©tant une piÃ¨ce Ã  risque d'incendie, le scÃ©nario suivant consistait Ã  identifier les signes d'incendie. <br><br>  Pour ce scÃ©nario, deux capteurs de tempÃ©rature (et d'humiditÃ©) et un capteur de fumÃ©e Ã©taient nÃ©cessaires.  Le prix du capteur de tempÃ©rature est d'environ 1000 r.  Le dÃ©tecteur de fumÃ©e coÃ»te environ 2000 p.  Dans la version Aqara pour la rÃ©gion locale, il n'y a actuellement aucun dÃ©tecteur de fumÃ©e, ce qui nous relie Ã  nouveau Ã  la rÃ©gion Â«Chine continentaleÂ». <br><br>  Le dÃ©tecteur de fumÃ©e Ã©tait montÃ© au plafond du couloir de la salle de lavage (en fait non loin du poÃªle et de la sortie du hammam).  Ensuite, dans l'application Xiaomi Home, un appareil a Ã©tÃ© ajoutÃ© et un scÃ©nario Â«en cas de dÃ©tection de fumÃ©eÂ» a Ã©tÃ© crÃ©Ã©, suivi de l'envoi d'une notification au tÃ©lÃ©phone.  Le test a Ã©tÃ© effectuÃ© par une cheminÃ©e.  Le capteur a rÃ©ussi le test.  Le moyeu cligna des yeux avec une alarme, plus une alerte sonore a fonctionnÃ©.  Le capteur lui-mÃªme Ã©tait Ã©galement trÃ¨s vil et un bip fort, avertissant du problÃ¨me. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="image"></div><br>  Un autre signe d'incendie est une augmentation de la tempÃ©rature.  Pour surveiller la tempÃ©rature, deux capteurs ont Ã©tÃ© installÃ©s: l'un dans les toilettes, l'autre dans les toilettes.  Ensuite, dans l'application, le scÃ©nario Â«dans le cas d'une tempÃ©rature supÃ©rieure Ã  l'ensembleÂ» a Ã©tÃ© configurÃ© avec la notification correspondante au tÃ©lÃ©phone.  Pour le moment, je fixe le seuil de la salle de relaxation Ã  30 degrÃ©s (en Ã©tÃ©, probablement, je devrai le reconfigurer). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="image"></div><br>  De plus, le scÃ©nario a Ã©tÃ© mis en place Â«dans le cas d'une tempÃ©rature infÃ©rieure Ã  l'ensembleÂ» avec un seuil de 18 degrÃ©s et des alertes au tÃ©lÃ©phone.  Si, pour une raison quelconque, le chauffage cesse de fonctionner, j'aimerais en Ãªtre informÃ© dÃ¨s que possible.  De mÃªme, les scÃ©narios Â«en cas d'augmentation de l'humiditÃ©Â» ont Ã©tÃ© crÃ©Ã©s pour les deux capteurs avec un seuil de 70%, une alerte au tÃ©lÃ©phone et un arrÃªt de la pompe d'alimentation en eau. <br><br>  Parmi les bonus agrÃ©ables pour les capteurs de tempÃ©rature et d'humiditÃ©, des graphiques historiques sont disponibles dans l'application.  Vous pouvez, par exemple, dÃ©terminer Ã  quels moments le bain a Ã©tÃ© utilisÃ© aux fins prÃ©vues (pics de tempÃ©rature dans le graphique ci-dessous) ou comparer si la tempÃ©rature actuelle est anormale. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="image"></div><br><br><h2>  ContrÃ´le de la ventilation </h2><br>  Un extrait forcÃ© des locaux est organisÃ© dans le hammam.  AprÃ¨s avoir terminÃ© les procÃ©dures, il est conseillÃ© de ventiler la piÃ¨ce.  La ventilation Ã©tait activÃ©e par un interrupteur Ã  clÃ© et la ventilation elle-mÃªme nÃ©cessitait au moins 30 minutes, mais les rassemblements dans les bains se terminaient souvent la premiÃ¨re ou la deuxiÃ¨me heure de la nuit.  Il n'est pas toujours possible de tout faire Ã  l'avance, et de s'asseoir Ã  la fin pendant 30 minutes supplÃ©mentaires et d'attendre que le hammam soit ventilÃ© est un plaisir en dessous de la moyenne car vous voulez dÃ©jÃ  dormir. <br><br>  Pour ce scÃ©nario, nous avions besoin d'un interrupteur Ã  clÃ© de Xiaomi avec une ligne zÃ©ro et un montage mural.  Le prix de l'Ã©mission est d'environ 1900 p.  Les commutateurs sont disponibles dans la version Aqara pour le marchÃ© local. <br><br>  Dans mon cas, il est impossible de remplacer simplement un interrupteur conventionnel par un interrupteur intelligent - une ligne Ã©lectrique est nÃ©cessaire.  En consÃ©quence, j'ai dÃ» Ã©tirer la ligne zÃ©ro jusqu'au trou de montage du commutateur, car il y avait une telle opportunitÃ©.  Dans le cas d'un interrupteur sans ligne zÃ©ro, l'installation serait plus facile. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="image"></div><br>  AprÃ¨s l'installation, un commutateur intelligent a Ã©tÃ© ajoutÃ© Ã  l'application en tant que pÃ©riphÃ©rique et ses performances ont Ã©tÃ© testÃ©es.  Il y a une minuterie dans les paramÃ¨tres du commutateur et vous pouvez rÃ©gler l'heure de dÃ©sactivation.  Autrement dit, avant de quitter le bain, la minuterie d'arrÃªt est rÃ©glÃ©e pour 30 minutes de ventilation supplÃ©mentaires, et vous pouvez vous endormir en toute sÃ©curitÃ©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="image"></div><br>  Une autre option d'automatisation des processus est possible.  AprÃ¨s le bain, en plus de la ventilation, la porte du hammam s'ouvre complÃ¨tement.  Cela entraÃ®ne une augmentation de la tempÃ©rature dans la salle de lavage, oÃ¹ un capteur de tempÃ©rature est installÃ©.  Sur la base des lectures de ce capteur, vous pouvez crÃ©er des scÃ©narios d'activation / dÃ©sactivation de la ventilation.  Mais je n'ai pas encore exÃ©cutÃ© cette option.  De plus, on pourrait expÃ©rimenter avec un capteur d'ouverture de porte de hammam.  Mais je crains qu'il ne meure ou ne tombe rapidement, car la porte est en verre et dans le hammam, elle peut Ã©galement Ãªtre Ã  120 degrÃ©s. <br><br><h2>  ContrÃ´le d'Ã©clairage public </h2><br>  Une autre tÃ¢che que je voulais automatiser Ã©tait de contrÃ´ler l'Ã©clairage public de la vÃ©randa.  Un des scÃ©narios typiques: allumez la lumiÃ¨re sur la vÃ©randa lorsque vous Ãªtes prÃ¨s du bÃ¢timent et il fait sombre Ã  l'extÃ©rieur.  La baignoire est verrouillÃ©e, l'interrupteur d'Ã©clairage public est situÃ© Ã  l'intÃ©rieur.  J'ai dÃ» aller chercher la clÃ© pour ouvrir la porte et allumer la lumiÃ¨re.  Ã‰teindre les lumiÃ¨res a nÃ©cessitÃ© une procÃ©dure similaire.  Un autre scÃ©nario qui se reproduisait rÃ©guliÃ¨rement: allumer ou Ã©teindre la lumiÃ¨re sur la vÃ©randa lorsque vous Ãªtes dans la maison principale.  Assez souvent, en sortant des bains, j'ai oubliÃ© d'Ã©teindre les lumiÃ¨res de la vÃ©randa et je l'ai trouvÃ© dÃ©jÃ  dans la maison: soit en regardant par la fenÃªtre, soit en regardant les camÃ©ras de surveillance.  Ã€ ce moment, la rÃ©ticence est gÃ©nÃ©ralement nulle part oÃ¹ aller, donc la lumiÃ¨re a continuÃ© Ã  brÃ»ler toute la nuit. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="image"></div><br>  Pour mettre en Å“uvre cette idÃ©e, un relais Ã  deux canaux a Ã©tÃ© achetÃ©.  Le prix de l'Ã©mission est d'environ 2000 p.  Il manque actuellement des relais dans la version Aqara pour le marchÃ© local.  Mais il peut Ãªtre remplacÃ© par un interrupteur Ã  clÃ© (il est clair que son installation dans une boÃ®te de distribution est un processus plus gÃªnant). <br><br>  Au dÃ©part, j'avais l'intention de monter le relais derriÃ¨re l'interrupteur Ã  clÃ©, cependant, il s'est avÃ©rÃ© trÃ¨s problÃ©matique de tirer la ligne d'alimentation au bon endroit (encore une fois, le relais a besoin d'alimentation).  Un endroit idÃ©al est une boÃ®te de jonction oÃ¹ la ligne Ã©lectrique, la ligne de l'interrupteur et la ligne des lampadaires ont convergÃ©.  Il se trouvait sous un faux plafond, ce qui a entraÃ®nÃ© le dÃ©montage de plusieurs rails de revÃªtement.  Il convenait de rÃ©flÃ©chir Ã  l'avance Ã  ce point.  Cependant, l'installation s'est terminÃ©e avec succÃ¨s.  Le schÃ©ma de cÃ¢blage est beaucoup plus compliquÃ© que pour les prises et interrupteurs (dans mon cas, quatre fils Ã  3 fils et 8 bornes sur le relais lui-mÃªme).  Afin de ne pas garder Ã  l'esprit et de ne rien confondre, j'ai dessinÃ© un schÃ©ma sur une feuille de papier avant de monter.  Ensuite, j'ai fait une installation d'essai pour tout vÃ©rifier: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="image"></div><br>  L'appareil Ã©tait connectÃ© dans l'application et la phase de test a commencÃ©.  Le rÃ©verbÃ¨re Ã©tait censÃ© Ãªtre allumÃ© / Ã©teint en tant qu'interrupteur Ã  clÃ© existant prÃ©cÃ©demment et utiliser l'application.  Il y a deux lumiÃ¨res dans la rue - une Ã  gauche, l'autre Ã  droite.  Le relais a deux canaux, mais il n'Ã©tait pas logique de les activer sÃ©parÃ©ment.  Par contre, je ne voulais pas les inclure tour Ã  tour en deux clics dans l'application.  Par consÃ©quent, le contrÃ´le a Ã©tÃ© effectuÃ© sur un canal de relais.  Par une Ã©trange coÃ¯ncidence, cette option ne fonctionnait pas normalement - il y avait coller dans l'une ou l'autre position.  Il n'y avait plus beaucoup de temps pour les expÃ©riences, car la lumiÃ¨re du jour se terminait et je voulais assembler la doublure au plafond.  Par consÃ©quent, j'ai juste attrapÃ© les lumiÃ¨res en parallÃ¨le sur les deux canaux et tout a fonctionnÃ© comme je le voulais.  Pour que les commutateurs physiques et logiciels fonctionnent comme des relais, l'option de verrouillage a Ã©tÃ© activÃ©e dans les paramÃ¨tres du relais. <br><br>  Il serait Ã©galement possible d'organiser le voyant de la minuterie marche / arrÃªt.  Mais ce scÃ©nario ne s'est pas encore intÃ©ressÃ©. <br><br><h2>  ContrÃ´le d'accÃ¨s </h2><br>  Un autre moment curieux a Ã©tÃ© le contrÃ´le de l'ouverture de la porte de la rue.  Tout d'abord, pour dÃ©terminer et notifier que quelqu'un a oubliÃ© de fermer cette porte normalement ou de la laisser complÃ¨tement ouverte. <br><br>  Pour ce scÃ©nario, un capteur d'ouverture de fenÃªtre / porte Ã©tait nÃ©cessaire.  Le prix d'Ã©mission est d'environ 1000 r.  Il existe des capteurs fabriquÃ©s par Aqara pour le marchÃ© local (ils ont des bords moins arrondis). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="image"></div><br>  L'installation est trÃ¨s simple - les capteurs sont montÃ©s sur du ruban adhÃ©sif double face.  Avant le montage, il est prÃ©fÃ©rable de connecter le capteur dans l'application pour voir Ã  quelle distance se produit l'opÃ©ration.  Les instructions Ã©crivent sur un espace pouvant atteindre 20 mm, mais ce n'est pas vrai, pour le moins, - le capteur et l'aimant de rÃ©ponse doivent Ãªtre montÃ©s presque Ã  fleur.  Dans la maison principale, un capteur similaire est installÃ© sur la porte du garage.  Entre le guide et le collier, il y a une gomme d'Ã©tanchÃ©itÃ© d'une largeur de 1 cm, Ã  cette distance, le capteur a montrÃ© la position Â«ouvertÂ» et a dÃ» augmenter l'aimant de rÃ©ponse. <br><br>  Une fois qu'un nouveau pÃ©riphÃ©rique a Ã©tÃ© ajoutÃ© Ã  l'application, vous pouvez passer Ã  l'automatisation.  Nous configurons le scÃ©nario Â«si la porte est ouverte pendant plus d'une minuteÂ» avec une notification au tÃ©lÃ©phone.  Dans la localisation en anglais, une partie de la phrase d'environ 1 minute n'est pas visible, mais le seuil de rÃ©ponse est exactement cela.  Dans le capteur Aqara et les applications Aqara Home, d'autres intervalles de dÃ©clenchement peuvent Ãªtre configurÃ©s.  Malheureusement, cela ne peut pas encore Ãªtre fait dans l'application Xiaomi Home.  Mais la pratique a montrÃ© qu'un intervalle de 1 minute est plus que suffisant - il n'y a pas de faux positifs, tous les positifs Ã©taient dans le cas.  Vous pouvez Ã©galement consulter les journaux par capteurs.  Ce capteur ne fait pas exception.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il est possible, par exemple, de dÃ©terminer par bÃ»che quand les bains sont arrivÃ©s (la premiÃ¨re porte a Ã©tÃ© ouverte ce jour-lÃ ) et quand elle est partie (la derniÃ¨re porte fermÃ©e), estimant ainsi le temps total passÃ© dans la piÃ¨ce. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="image"></div><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Impressions d'exploitation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'expÃ©rience d'exploitation globale est purement positive. </font><font style="vertical-align: inherit;">Bien sÃ»r, il y a quelques nuances mineures, mais l'objectif principal de l'automatisation a Ã©tÃ© atteint. </font><font style="vertical-align: inherit;">Tout d'abord, c'est un calme psychologique, confirmÃ© par les rÃ©sultats des tests. </font><font style="vertical-align: inherit;">Le confort est Ã©galement important - tÃ©lÃ©commande de l'Ã©clairage public, une hotte aspirante a Ã©tÃ© obtenue, une lampe de nuit supplÃ©mentaire est apparue. </font><font style="vertical-align: inherit;">AprÃ¨s Ãªtre parti en vacances, vous vous souvenez et coupez l'eau Ã  distance. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les coÃ»ts de tous les appareils ci-dessus sous une forme approximative (sans rÃ©fÃ©rence Ã  un magasin particulier) sont indiquÃ©s ci-dessous. </font><font style="vertical-align: inherit;">Lors de la commande sur AliExpress, les prix diffÃ©reront dans une direction plus petite.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors du choix d'un ensemble d'Ã©quipements, il est nÃ©cessaire de prendre en compte la compatibilitÃ© (pour quelle rÃ©gion cet Ã©quipement a Ã©tÃ© fabriquÃ© et Ã  quelle famille il appartient). Dans le cadre de l'application, il ne sera pas possible de crÃ©er un scÃ©nario qui, par exemple, par l'Ã©vÃ©nement dÃ©tecteur de fumÃ©e (pour la rÃ©gion Â«Chine continentaleÂ») contrÃ´lera le dÃ©bouchÃ© pour la rÃ©gion europÃ©enne. Si vous n'avez pas besoin d'un type exotique de dÃ©tecteur de fumÃ©e, il est prÃ©fÃ©rable de regarder les appareils Aqara pour le marchÃ© local. Au final, le relais peut Ãªtre remplacÃ©, par exemple, par un interrupteur Ã  deux touches. Un certain nombre de magasins vendant des appareils Xiaomi les importent apparemment en gris (ces appareils sont conÃ§us pour la rÃ©gion chinoise). Mais, par exemple, le Messenger, appareils chanceux conÃ§us pour notre marchÃ©. En plus de la compatibilitÃ© des mÃªmes prises, elles contiendront Ã©galement des instructions en anglais et en russe. Ci-dessous, une photo de deux capteurs identiques,mais pour diffÃ©rentes rÃ©gions (chinois interne - Ã  gauche et europÃ©en externe - Ã  droite):</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La rÃ©activitÃ© du contrÃ´le via l'application n'est pas toujours bonne. Par exemple, parfois, vous pouvez rencontrer une situation qui, au fil du temps, au lieu d'allumer la lumiÃ¨re, nous obtenons une erreur dans l'esprit de Â«la demande a Ã©chouÃ©Â». Le traitement identifiÃ© expÃ©rimentalement - dÃ©charger l'application de la mÃ©moire et la redÃ©marrer - rÃ©sout ce problÃ¨me plus rapidement que d'attendre une rÃ©ponse lors de la prochaine tentative. De plus, il y a parfois des retards notables (jusqu'Ã  20-30 secondes) avec la mise Ã  jour de l'Ã©tat d'un capteur. Ã€ ces moments, il est prÃ©fÃ©rable de ne pas appuyer Ã  nouveau sur les boutons de mise sous / hors tension, mais d'attendre que le statut soit mis Ã  jour. Lors du dÃ©marrage de l'application dans certaines situations, vous pouvez voir une liste vide au lieu d'une liste de pÃ©riphÃ©riques. Il n'y a pas lieu de paniquer - il apparaÃ®t gÃ©nÃ©ralement dans les prochaines secondes. Les notifications sur le tÃ©lÃ©phone ne sont pas localisÃ©es et la dÃ©nomination correcte des Ã©vÃ©nements est enregistrÃ©e.De plus, les auteurs de l'application utilisent rÃ©guliÃ¨rement le canal de notification push pour la publicitÃ© (toujours en chinois). Ceci, bien sÃ»r, je n'aime pas, mais il n'y a pas beaucoup de choix.</font></font><br><br> ,           Xiaomi         .     - ,    ,      . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482554/">https://habr.com/ru/post/fr482554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482540/index.html">Software VS Hardware: quelle est la tendance et qui est le futur?</a></li>
<li><a href="../fr482544/index.html">Rassembler une Ã©quipe de dÃ©marrage avec Â«0Â» - instructions Ã©tape par Ã©tape pour les plus petits</a></li>
<li><a href="../fr482546/index.html">VK Tech: une annÃ©e de dÃ©veloppement en chiffres Git</a></li>
<li><a href="../fr482548/index.html">Security Week 52 + 1: les 3 principales nouvelles non standard de l'annÃ©e</a></li>
<li><a href="../fr482550/index.html">Le mystÃ©rieux programme LyX. 2e partie</a></li>
<li><a href="../fr482556/index.html">Vers l'Ã©poque oÃ¹ l'herbe Ã©tait Â«plus verteÂ» et AKG produisait des Ã©couteurs dinostatiques</a></li>
<li><a href="../fr482558/index.html">Les scientifiques ont d'abord tuÃ© le virus de l'herpÃ¨s endormi dans les cellules humaines</a></li>
<li><a href="../fr482560/index.html">Comment Ã©crire des textes faciles</a></li>
<li><a href="../fr482562/index.html">L'ordinateur personnel devait mourir il y a dix ans: que s'est-il passÃ© Ã  la place</a></li>
<li><a href="../fr482564/index.html">Si toutes les histoires Ã©taient Ã©crites dans le style de la science-fiction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>