<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüöí üèÇ üë®üèª‚Äç‚úàÔ∏è SIEM-Tiefen: Out-of-Box-Korrelationen. Teil 5. Methodik zur Entwicklung von Korrelationsregeln ü§üüèª üéΩ üìî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir schlie√üen die Artikelserie ab, die sich mit den Regeln der Korrelation befasst, die sofort einsatzbereit sind. Wir haben uns zum Ziel gesetzt, ein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SIEM-Tiefen: Out-of-Box-Korrelationen. Teil 5. Methodik zur Entwicklung von Korrelationsregeln</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/446212/">  Wir schlie√üen die Artikelserie ab, die sich mit den Regeln der Korrelation befasst, die sofort einsatzbereit sind.  Wir haben uns zum Ziel gesetzt, einen Ansatz zu formulieren, mit dem wir Korrelationsregeln erstellen k√∂nnen, die mit einem Minimum an Fehlalarmen ‚Äûout of the box‚Äú funktionieren k√∂nnen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/bz/th/e6bzthq7bfspxncuni5hbtudz84.png" alt="Methodik zur Entwicklung von Korrelationsregeln"></div><br>  <i>Bild: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Software-Marketing</a></i> <br><a name="habracut"></a><br>  Alle wichtigen Punkte des Artikels sind in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schlussfolgerung</a> verf√ºgbar. An derselben Stelle wird diese Methodik in Form eines grafischen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Diagramms dargestellt</a> . <br><br>  Kurz dar√ºber, was in fr√ºheren Artikeln passiert ist: Sie beschrieben, wie eine Reihe von Feldern eines normalisierten Ereignisses aussehen sollte - ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Diagramm</a> ;  welches Ereigniskategorisierungssystem verwendet werden soll;  wie man mithilfe eines Kategorisierungssystems und eines Schemas den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Prozess der</a> Normalisierung von Ereignissen vereinheitlicht.  Wir haben auch den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kontext der</a> Implementierung von Korrelationsregeln untersucht und untersucht, was SIEM √ºber das von ihm √ºberwachte automatisierte System (AS) wissen sollte und warum. <br><br>  Alle oben genannten Ans√§tze und √úberlegungen sind die Bl√∂cke, aus denen die Methodik zur Entwicklung von Korrelationsregeln aufgebaut ist.  Es ist Zeit, sie zusammenzusetzen und das ganze Bild zu betrachten. <br><br>  Die gesamte Methode zur Entwicklung von Korrelationsregeln besteht aus vier Bl√∂cken: <br><br><ul><li>  Vorbereitung von Quellen und Umgebung; </li><li>  Normalisierung von Ereignissen und deren Bereicherung; </li><li>  Anpassung der Korrelationsregeln an den Kontext von AS; </li><li>  Bildung einer Vereinbarung √ºber Positive. </li></ul><br><h1>  Quellen und Umgebungen vorbereiten </h1><br>  Korrelationsregeln gelten f√ºr Ereignisse, die Quellen generieren.  In diesem Zusammenhang ist es √§u√üerst wichtig, dass die f√ºr die Korrelationsregeln erforderlichen Quellen in den Lautsprechern vorhanden und korrekt konfiguriert sind. <br><br><img src="https://habrastorage.org/webt/7r/ih/b5/7rihb5lksdmrzhpjpte5q9-3wls.png" alt="Quellen und Infrastrukturungen"><br>  <i>Quellen und Umgebungen vorbereiten</i> <br><br>  <b>Schritt 1</b> : <i>√úberlegen Sie sich die allgemeine Logik der Regel und verstehen Sie, welche Ereignisquellen ben√∂tigt werden.</i>  Wenn Sie von Grund auf neu entwickeln oder eine vorgefertigte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sigma-</a> Korrelationsregel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">anwenden</a> , m√ºssen Sie anhand der Ereignisse verstehen, aus welchen Quellen sie funktionieren. <br><br>  <b>Schritt 2</b> : <i>Stellen Sie sicher, dass alle erforderlichen Quellen im Unternehmen vorhanden sind und gesammelt werden k√∂nnen.</i>  Eine Situation ist m√∂glich, wenn eine Regel eine Kette von Ereignissen aus mehreren Quellen des Formulars (Ereignis A aus Quelle 1) - (Ereignis B aus Quelle 2) - (Ereignis C aus Quelle 3) 5 Minuten lang bearbeitet.  Wenn Ihr Unternehmen nicht √ºber mindestens eine Quelle verf√ºgt, wird eine solche Regel unbrauchbar, da sie niemals funktioniert.  Sie m√ºssen verstehen, ob es grunds√§tzlich m√∂glich ist, Ereignisse aus den erforderlichen Quellen zu sammeln und ob Ihr SIEM diese bereitstellen kann.  Beispielsweise schreibt die Quelle Ereignisse in eine Datei, die Datei wird jedoch verschl√ºsselt, oder es wird eine nicht standardm√§√üige Datenbank f√ºr die Speicherung der Quelle verwendet, auf die √ºber den Standard-ODBC / JDBC-Treiber kein Zugriff gew√§hrleistet werden kann. <br><br>  <b>Schritt 3</b> : <i>Schlie√üen Sie die Quellen an SIEM an.</i>  <i>Egal wie banal es klingen mag, in diesem Schritt ist es notwendig, die Sammlung von Ereignissen zu implementieren.</i>  Es gibt oft viele Probleme.  Zum Beispiel organisatorische Probleme, wenn das IT-Management die Verbindung zu gesch√§ftskritischen Systemen kategorisch verbietet.  Oder technisch gesehen, wenn der SIEM-Agent (SmartConnector, Universal Forwarder) ohne zus√§tzliche Einstellungen beim Sammeln von Ereignissen einfach die Quelle ‚Äût√∂tet‚Äú, was zu einem Denial-of-Service f√ºhrt.  Dies kann h√§ufig beobachtet werden, wenn hoch belastete DBMS an SIEM angeschlossen werden. <br><br>  <b>Schritt 4</b> : <i>Stellen Sie sicher, dass das Audit f√ºr die Quellen korrekt konfiguriert ist und die f√ºr die Korrelation erforderlichen Ereignisse in SIEM empfangen werden.</i>  Korrelationsregeln erwarten bestimmte Arten von Ereignissen.  Sie m√ºssen von der Quelle generiert werden.  Es kommt h√§ufig vor, dass zum Generieren der f√ºr die Regeln erforderlichen Ereignisse die Quelle zus√§tzlich konfiguriert werden muss: Die erweiterte √úberwachung ist aktiviert und die Protokollausgabe in einem bestimmten Format ist konfiguriert. <br><br>  Das Aktivieren der erweiterten √úberwachung wirkt sich h√§ufig auf den vom SIEM von der Quelle empfangenen Ereignisfluss (EPS) aus.  Aufgrund der Tatsache, dass die Quelle selbst und SIEM im Zust√§ndigkeitsbereich verschiedener Abteilungen liegen, besteht immer das Risiko, dass die erweiterte Pr√ºfung deaktiviert wird und die erforderlichen Arten von Ereignissen nicht mehr bei SIEM eingehen.  Dieses Problem kann teilweise erkannt werden, indem der Ereignisfluss f√ºr jede Quelle √ºberwacht wird oder vielmehr √Ñnderungen der Ereignisse pro Sekunde (EPS) √ºberwacht werden. <br><br>  <b>Schritt 5</b> : <i>Stellen Sie sicher, dass Ereignisse ausgef√ºhrt werden, und konfigurieren Sie die Quellen√ºberwachung.</i>  In jeder Infrastruktur treten fr√ºher oder sp√§ter Fehler im Netzwerk oder in der Quelle selbst auf.  Zu diesem Zeitpunkt verliert SIEM den Kontakt zur Quelle und kann keine Ereignisse empfangen.  Wenn die Quelle passiv ist und ihre Protokolle in eine Datei oder Datenbank schreibt, gehen bei einem Fehler keine Ereignisse verloren, und SIEM kann sie empfangen, wenn die Kommunikation wiederhergestellt ist.  Wenn die Quelle aktiv ist und Ereignisse beispielsweise √ºber Syslog an SIEM sendet, ohne sie zus√§tzlich irgendwo zu speichern, gehen die Ereignisse bei einem Fehler verloren und Ihre Korrelationsregel funktioniert einfach nicht, da das gew√ºnschte Ereignis nicht wartet.  Wenn Sie tiefer graben, k√∂nnen Sie sehen, dass selbst bei der Arbeit mit einer passiven Quelle beim Wiederherstellen der Kommunikation nach einem Fehler keine Garantie daf√ºr besteht, dass die Korrelationsregeln funktionieren, insbesondere bei solchen, die mit Zeitfenstern arbeiten.  Betrachten Sie das oben beschriebene Regelbeispiel: (Ereignis A von Quelle 1) - (Ereignis B von Quelle 2) - (Ereignis C von Quelle 3) f√ºr 5 Minuten.  Wenn nach Ereignis B ein Fehler auftritt und die Verbindung in einer Stunde wiederhergestellt wird, funktioniert die Korrelation nicht, da Ereignis C nicht in den erwarteten 5 Minuten eintrifft. <br><br>  Unter Ber√ºcksichtigung dieser Funktionen sollten Sie die √úberwachung der Quellen konfigurieren, aus denen Ereignisse erfasst werden.  Diese √úberwachung sollte die Verf√ºgbarkeit von Quellen, die Aktualit√§t des Eintreffens von Ereignissen aus ihnen und die St√§rke des Flusses gesammelter Ereignisse (EPS) √ºberwachen. <br><br>  Das Ausl√∂sen des √úberwachungssystems ist die erste Glocke, die vom Auftreten eines negativen Faktors spricht, der die Leistung aller oder eines Teils der Korrelationsregeln beeinflusst. <br><br><h1>  Normalisierung von Ereignissen und deren Bereicherung </h1><br>  Das Sammeln der f√ºr die Korrelation erforderlichen Ereignisse reicht nicht aus.  Ereignisse, die bei SIEM eintreffen, m√ºssen streng nach den anerkannten Regeln normalisiert werden.  Wir haben in einem separaten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> √ºber die Probleme der Normalisierung und die Bildung einer Normalisierungsmethode geschrieben.  Im Allgemeinen kann dieser Block als Kampf gegen M√ºll <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rein</a> , M√ºll raus ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GIGO</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">charakterisiert werden</a> . <br><br><img src="https://habrastorage.org/webt/1b/na/-x/1bna-xnslsomq5xp8shkaz7snr4.png" alt="Normalisierung und Bereicherung von Investitionen"><br>  <i>Normalisierung und Bereicherung von Ereignissen</i> <br><br>  <b>Schritt 6</b> und <b>Schritt 7</b> : <i>Kategorisierung von Ereignissen und Normalisierung von Ereignissen gem√§√ü der Kategorie basierend auf der Methodik.</i>  Wir werden nicht n√§her darauf eingehen, da wir diese Schritte im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûMethodik zur Normalisierung von Ereignissen‚Äú</a> ausf√ºhrlich betrachtet haben. <br><br>  <b>Schritt 8</b> : <i>Anreicherung von Ereignissen mit fehlenden und zus√§tzlichen Informationen gem√§√ü der Kategorie.</i>  Eingehende Ereignisse enthalten h√§ufig nicht immer Informationen in dem Umfang, in dem die Korrelationsregeln funktionieren.  Ein Ereignis enth√§lt beispielsweise nur die IP-Adresse des Hosts, es gibt jedoch keine Informationen zu seinem vollqualifizierten Dom√§nennamen oder Hostnamen.  Ein weiteres Beispiel: Ein Ereignis enth√§lt eine Benutzer-ID, das Ereignis enth√§lt jedoch keinen Benutzernamen.  In diesem Fall sollten die erforderlichen Informationen aus externen Quellen - Datenbanken, Dom√§nencontrollern oder anderen Verzeichnissen - extrahiert und dem Ereignis hinzugef√ºgt werden. <br><br>  Es ist wichtig zu beachten, dass die Kategorisierung von Ereignissen ganz am Anfang erfolgt - vor der Normalisierung.  Zus√§tzlich zu der Tatsache, dass die Kategorie die Regeln f√ºr die Normalisierung des Ereignisses definiert, legt sie auch die Liste der Daten fest, die in externen Quellen gesucht werden m√ºssen, wenn sie nicht im Ereignis selbst enthalten sind. <br><br><h1>  Anpassung der Korrelationsregeln an den AS-Kontext </h1><br>  Nachdem Sie die Eingabedaten (Ereignisse) vorbereitet und mit der Entwicklung von Korrelationsregeln fortgefahren haben, m√ºssen Sie die Besonderheiten der eingehenden Ereignisse, des AS selbst und seiner Variabilit√§t ber√ºcksichtigen.  Mehr dazu im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûSystemmodell als Kontext von Korrelationsregeln‚Äú</a> . <br><br><img src="https://habrastorage.org/webt/i6/tr/uk/i6trukg2z33jqm-lhuzuierlcbk.png" alt="Anpassung der Korrelationsregeln an den AS-Kontext"><br>  <i>Anpassung der Korrelationsregeln an den AS-Kontext</i> <br><br>  <b>Schritt 9</b> : <i>Verstehen Sie die H√§ufigkeit von Ereignissen aus jeder Quelle und bestimmen Sie das Zeitfenster f√ºr die Korrelation.</i>  Sehr oft verwenden Korrelationsregeln Zeitfenster, wenn das Eintreffen eines bestimmten Ereignisses innerhalb eines bestimmten Zeitintervalls erwartet werden muss.  Bei der Entwicklung solcher Regeln ist es wichtig, die Verz√∂gerung beim Empfang von Ereignissen zu ber√ºcksichtigen.  Sie werden normalerweise durch zwei Faktoren verursacht. <br><br>  <b>Erstens</b> schreibt die Quelle selbst m√∂glicherweise nicht sofort Ereignisse in die Datenbank, in eine Datei oder sendet sie √ºber Syslog.  Die Zeit dieser Verz√∂gerung muss gesch√§tzt und in der Regel ber√ºcksichtigt werden. <br><br>  <b>Zweitens</b> verz√∂gert sich die √úbermittlung von Ereignissen an SIEM.  Beispielsweise ist die Erfassung von Ereignissen aus der Datenbank so konfiguriert, dass die Anforderung von Ereignissen alle 10 Minuten ausgef√ºhrt wird. Nat√ºrlich ist das Korrelationsfenster von 5 Minuten in dieser Situation nicht die beste L√∂sung. <br><br>  Das Problem versch√§rft sich, wenn eine Korrelationsregel entwickelt werden muss, die mit Ereignissen aus mehreren Quellen gleichzeitig funktioniert.  In diesem Fall ist es wichtig zu verstehen, dass sie unterschiedliche Lieferzeiten haben k√∂nnen.  Im schlimmsten Fall werden Ereignisse in zuf√§lliger Reihenfolge mit einem Versto√ü gegen die Chronologie angezeigt.  In einer solchen Situation muss der Entwickler der Korrelationsregeln klar verstehen, zu welchem ‚Äã‚ÄãZeitpunkt das SIEM die Korrelation realisiert (in der Ereigniszeit oder wenn das Ereignis in SIEM eintrifft).  Ich stelle fest, dass die Korrelation in der Zeit des Eintreffens von Ereignissen die technisch einfachste und gebr√§uchlichste Option f√ºr die Verarbeitung von Ereignissen im Pseudo-Echtzeitmodus ist.  Diese Option versch√§rft jedoch nur die oben genannten Probleme und l√∂st sie nicht. <br><br>  Wenn Ihr SIEM eine Korrelation in der Ereigniszeit bereitstellt, gibt es h√∂chstwahrscheinlich Mechanismen zum Neuordnen von Ereignissen, mit denen die tats√§chliche Chronologie von Ereignissen wiederhergestellt werden kann. <br><br>  Wenn Sie verstehen, dass das Zeitfenster zu gro√ü ist, um eine Korrelation im Stream durchzuf√ºhren, m√ºssen Sie den Retro-Korrelationsmechanismus verwenden, bei dem bereits gespeicherte Ereignisse gem√§√ü dem Zeitplan aus der SIEM-Datenbank ausgew√§hlt und die Korrelationsregeln durchlaufen werden. <br><br>  <b>Schritt 10</b> : <i>Richten Sie einen Ausnahmemechanismus ein.</i>  In der realen Welt wird es immer ein Objekt mit speziellem Verhalten geben, das nicht von einer bestimmten Korrelationsregel behandelt werden sollte, da dies zu einem falsch positiven Ergebnis f√ºhrt.  Daher sollten in der Phase der Entwicklung der Regeln Mechanismen eingerichtet werden, um solche Objekte zu einer Ausnahme zu machen.  Wenn Ihre Regel beispielsweise mit den IP-Adressen von Computern arbeitet, ben√∂tigen Sie eine Tabellenliste, in der Sie Adressen hinzuf√ºgen k√∂nnen, f√ºr die die Regel nicht funktioniert.  Wenn eine Regel mit Benutzeranmeldungen oder Prozessnamen arbeitet, muss vorab mit Tabellenausschlusslisten in der Regellogik gearbeitet werden. <br><br>  Mit diesem Ansatz k√∂nnen Sie Ausnahmen automatisch oder manuell Objekte zu Ausnahmen hinzuf√ºgen, ohne den Hauptteil der Regel neu schreiben zu m√ºssen. <br><br>  <b>Schritt 11</b> : <i>Definieren Sie die physischen und logischen Grenzen der Anwendbarkeit der Korrelationsregel.</i>  Bei der Entwicklung einer Korrelationsregel ist es wichtig, zun√§chst die Grenzen der Anwendbarkeit (Umfang) der Regel zu verstehen und zu verstehen, ob sie √ºberhaupt existieren.  Wenn Sie die Logik ausarbeiten und die Regel debuggen, m√ºssen Sie sich auf die Besonderheiten dieses Bereichs konzentrieren.  Wenn eine Regel mit Daten arbeitet, die √ºber den Bereich dieses Bereichs hinausgehen, steigt die Wahrscheinlichkeit von Fehlalarmen. <br><br>  Es k√∂nnen zwei Arten von Bereichen unterschieden werden: physische und logische.  Der physische Bereich sind die Unternehmens- und angrenzenden Netzwerke, und der logische Bereich sind die Teile des AS, der Gesch√§ftsanwendungen oder der Gesch√§ftsprozesse.  Beispiele f√ºr den physischen Bereich: DMZ-Segment, interne und externe Subnetze, RAS-Netzwerke.  Beispiele f√ºr den logischen Geltungsbereich der Regeln: Prozesssteuerung, Buchhaltung, PCI-DSS-Segment, PD-Segment oder nur bestimmte Ger√§terollen - Dom√§nencontroller, Zugriffsschalter, Kernrouter. <br><br>  Sie k√∂nnen Bereiche f√ºr Korrelationsregeln √ºber Tabellenlisten festlegen.  Sie k√∂nnen entweder manuell oder automatisch gef√ºllt werden.  Wenn Sie in Ihrem Unternehmen Zeit f√ºr das Asset Management (Asset Management) finden, sind m√∂glicherweise alle erforderlichen Daten bereits in dem in SIEM erstellten AS-Modell enthalten.  Durch die automatische Generierung solcher Tabellenlisten k√∂nnen Sie neue Assets, die im Unternehmen angezeigt werden, dynamisch in den Geltungsbereich aufnehmen.  Wenn Sie beispielsweise eine Regel hatten, die ausschlie√ülich mit Dom√§nencontrollern funktioniert, wird das Hinzuf√ºgen eines neuen Controllers zur Dom√§nengesamtstruktur im Modell behoben und f√§llt in den Geltungsbereich Ihrer Regel. <br><br>  Im Allgemeinen k√∂nnen die f√ºr Ausnahmen verwendeten Tabellenlisten als schwarze Listen und die f√ºr den Geltungsbereich der Regeln verantwortlichen Listen als wei√üe Listen betrachtet werden. <br><br>  <b>Schritt 12</b> : <i>Verwenden Sie das Lautsprechermodell, um den Kontext zu verdeutlichen.</i>  Bei der Entwicklung einer Korrelationsregel, die b√∂swillige Aktionen identifiziert, ist es wichtig sicherzustellen, dass sie tats√§chlich implementiert werden k√∂nnen.  Wenn dies nicht ber√ºcksichtigt wird, erweist sich das Ausl√∂sen der Regel, die den potenziellen Angriff aufgedeckt hat, als falsch, da diese Art von Angriff m√∂glicherweise einfach nicht auf Ihre Infrastruktur anwendbar ist.  Ich werde mit einem Beispiel erkl√§ren: <br><br><ol><li>  Angenommen, wir haben eine Korrelationsregel, die Remote-RDP-Verbindungen zu Servern erkennt. </li><li>  Die Firewall ruft den Versuch auf, eine Verbindung zum TCP-Port 3389 des myserver.local-Servers herzustellen. </li><li>  Die Regel wird ausgel√∂st und Sie beginnen, einen potenziellen Vorfall mit hoher Priorit√§t zu analysieren. </li></ol><br>  W√§hrend der Untersuchung stellen Sie schnell fest, dass myserver.local 3389 geschlossen ist und von keinem Dienst ge√∂ffnet wurde und Linux vorhanden ist.  Dies ist ein falsches Positiv, f√ºr dessen Untersuchung Sie Zeit gebraucht haben. <br><br>  Ein weiteres Beispiel: IPS sendet ein Signatur-ausl√∂sendes Ereignis, wenn versucht wird, die Sicherheitsanf√§lligkeit CVE-2017-0144 auszunutzen. W√§hrend der Untersuchung stellt sich jedoch heraus, dass der entsprechende Patch auf dem angegriffenen Computer installiert ist und nicht auf einen solchen Vorfall mit der h√∂chsten Priorit√§t reagiert werden muss. <br>  Die Verwendung von Daten aus dem Lautsprechermodell hilft, dieses Problem zu l√∂sen. <br><br>  <b>Schritt 13</b> : <i>Verwenden Sie Entit√§tskennungen, nicht deren Quellschl√ºssel.</i>  Wie bereits im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûSystemmodell als Kontext von Korrelationsregeln‚Äú beschrieben, k√∂nnen sich die</a> IP-Adresse, der vollqualifizierte Dom√§nenname und sogar der MAC eines Assets √§ndern.  Wenn Sie also die Quellkennungen des Assets in der Korrelationsregel oder in der Tabellenliste verwenden, besteht nach einer Weile eine hohe Wahrscheinlichkeit, dass aus einem v√∂llig banalen Grund falsch positive Ergebnisse empfangen werden. Beispielsweise hat der DHCP-Server diese IP einfach an einen anderen Computer ausgegeben. <br><br>  Wenn Ihr SIEM √ºber einen Mechanismus zum Identifizieren von Assets, zum Verfolgen ihrer √Ñnderungen und zum Arbeiten mit deren Identifikatoren verf√ºgt, sollten Sie Identifikatoren verwenden, nicht die Quellschl√ºssel des Assets. <br><br><h1>  Bildung einer positiven Vereinbarung </h1><br>  Wenn wir uns dem letzten Block zum Erstellen der Korrelationsregel n√§hern, erinnern wir uns, dass das Ergebnis der Regel ein in SIEM angesprochener Vorfall ist.  Verantwortliche Fachkr√§fte m√ºssen auf einen solchen Vorfall reagieren.  Obwohl der Zweck dieser Artikelserie nicht die Ber√ºcksichtigung des Vorfallreaktionsprozesses umfasst, sollte beachtet werden, dass ein Teil der Informationen √ºber den Vorfall bereits in der Phase der Erstellung der entsprechenden Korrelationsregel generiert wird. <br><br>  Als n√§chstes betrachten wir die grundlegenden Punkte, die bei der Konfiguration der Parameter zum Ausl√∂sen der Korrelationsregel und zum Generieren eines Vorfalls ber√ºcksichtigt werden m√ºssen. <br><br><img src="https://habrastorage.org/webt/fg/z5/dj/fgz5djbyxha-uqiduo8ubym8ncq.png" alt="Bildung einer positiven Einstellung"><br>  <i>Bildung einer positiven Vereinbarung</i> <br><br>  <b>Schritt 14</b> : <i>Bestimmen Sie die Bedingungen f√ºr die Aggregation und das Herunterfahren bei einer gro√üen Anzahl von Fehlalarmen.</i>  Wenn Sie sich in der Debugging-Phase und w√§hrend des Funktionierens nicht an diese Technik halten :), k√∂nnen Fehlalarme der Regeln auftreten.  Es ist gut, wenn es ein oder zwei Fahrten pro Tag gibt, aber was ist, wenn eine Regel Tausende oder Zehntausende von Fahrten hat?  Dies deutet nat√ºrlich darauf hin, dass die Regel weiterentwickelt werden muss.  Es muss jedoch sichergestellt werden, dass in solchen Situationen ein derart massives falsches Positiv: <br><br><ol><li>  Die SIEM-Leistung wurde nicht beeinflusst. </li><li>  Bei der Masse der Fehlalarme gingen wirklich wichtige Vorf√§lle nicht verloren.  Es gibt sogar eine separate Art von Angriff, die darauf abzielt, die b√∂swilligen Hauptaktivit√§ten hinter vielen falschen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aktivit√§ten</a> zu verbergen. </li></ol><br>  Probleme dieser Art k√∂nnen gel√∂st werden, wenn beim Erstellen einer Korrelationsregel auf der Ebene des gesamten Systems als Ganzes oder f√ºr jede Regel einzeln Bedingungen f√ºr die Aggregation von Vorf√§llen und Bedingungen f√ºr eine Notabschaltung der Regel festgelegt werden k√∂nnen. <br><br>  Der Vorfallaggregationsmechanismus erm√∂glicht es nicht, Millionen identischer Vorf√§lle zu erstellen, sondern neue Vorf√§lle an einen zu ‚Äûkleben‚Äú, sofern sie identisch sind.  In extremen F√§llen, in denen selbst die Aggregation von Vorf√§llen eine erhebliche Belastung darstellt, wird empfohlen, die Korrelationsregel so einzustellen, dass sie sich automatisch ausschaltet, wenn die angegebene Anzahl von Vorg√§ngen pro Zeiteinheit (Minute, Stunde, Tag) √ºberschritten wird. <br><br>  <b>Schritt 15</b> : <i>Definieren Sie die Regeln zum Generieren des Namens des Vorfalls.</i>  Dieser Punkt wird h√§ufig vernachl√§ssigt, insbesondere wenn sie keine Regeln f√ºr ihr Unternehmen entwickeln, z. B. wenn ein Drittunternehmen f√ºr die Implementierung von SIEM und die Entwicklung von Regeln verantwortlich ist.  Der Name der Korrelationsregel sowie der von ihr erzeugte Vorfall sollten kurz sein und das Wesen einer bestimmten Regel klar widerspiegeln. <br><br>  Wenn in Ihrem Unternehmen mehr als eine Person mit Vorf√§llen und Korrelationsregeln arbeitet, wird empfohlen, Namensregeln zu entwickeln.  Sie m√ºssen vom gesamten Team, das mit SIEM zusammenarbeitet, verstanden und akzeptiert werden. <br><br>  <b>Schritt 16</b> : <i>Definieren Sie die Regeln f√ºr die Gestaltung der Wichtigkeit des Vorfalls.</i>  Bei den meisten SIEM-L√∂sungen in der letzten Phase der Erstellung eines Vorfalls k√∂nnen Sie dessen Bedeutung und Bedeutung festlegen.  Einige Entscheidungen berechnen die Wichtigkeit sogar automatisch, basierend auf dem Kontext des Vorfalls und den daran beteiligten Objekten. <br><br>  F√ºr den Fall, dass Ihr SIEM ausschlie√ülich automatisch die Wichtigkeit von Vorf√§llen berechnet, lohnt es sich, anhand dessen, welche und nach welcher Formel es berechnet wird, herauszufinden.  Wenn die Wichtigkeit beispielsweise auf der Grundlage der Wichtigkeit der an dem Vorfall beteiligten Verm√∂genswerte berechnet wird, m√ºssen Sie die Probleme der Verm√∂gensverwaltung in einem Unternehmen im Voraus ernst nehmen. <br><br>  Wenn Sie die Wichtigkeit eines Vorfalls manuell festlegen, wird empfohlen, eine Berechnungsformel zu entwickeln, die mindestens Folgendes ber√ºcksichtigt: <br><br><ol><li>  Die Bedeutung des Umfangs, in dem die Regel funktioniert.  Beispielsweise kann ein Vorfall in der gesch√§ftskritischen Zone von Systemen kritischer sein, als wenn genau derselbe Vorfall in der Zone gesch√§ftskritischer Systeme aufgetreten ist. </li><li>  Die Bedeutung der an dem Vorfall beteiligten Assets und Benutzerkonten. </li><li>  Die Wiederholung dieses Vorfalls im Unternehmen. </li></ol><br>  Ebenso wie bei der Benennung von Vorf√§llen ist es wichtig, dass alle interessierten Parteien die Regeln, nach denen die Bedeutung eines Vorfalls gebildet wird, klar und gleicherma√üen verstehen. <br><a name="Conclusions"></a><br><h1>  Schlussfolgerungen </h1><br>  Zusammenfassend fasse ich die Ergebnisse unserer Artikelserie zusammen und stelle fest, dass es meiner Meinung nach m√∂glich ist, Korrelationsregeln zu erstellen, die sofort funktionieren.  Die L√∂sung kann eine Verschmelzung von organisatorischen und technischen Ans√§tzen sein.  SIEM selbst muss in der Lage sein, etwas zu tun, aber Spezialisten, die es betreiben, m√ºssen etwas tun und wissen. <br><br>  Zusammenfassend: <br><br><ol><li>  Die Methode besteht aus folgenden Bl√∂cken: <br><ul><li>  Quellen und Umgebungen vorbereiten. </li><li>  Normalisierung von Ereignissen und deren Bereicherung. </li><li>  Anpassung der Korrelationsregeln an den AS-Kontext. </li><li>  Abschluss einer Vereinbarung √ºber Positive. </li></ul></li><li>  Jede Einheit hat organisatorische und technische Komponenten. </li><li>    ,        SIEM,        . </li><li>      ,     ,     SIEM-. </li><li>              .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . </li></ol><br><a name="Schema"></a><br><img src="https://habrastorage.org/webt/iw/gz/kz/iwgzkzilc0khjwsscaycz8mowes.png" alt="Methodik zur Entwicklung von Korrelationsregeln, die sofort einsatzbereit sind"><br> <i>   ,  ¬´ ¬ª</i> <br><br>   ,     ,       .      ‚Äî        .   . <br><a name="Articles"></a><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  2.      ¬´¬ª</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3.1.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br>  SIEM:  ¬´ ¬ª.  5.     ( <i> </i> ) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446212/">https://habr.com/ru/post/de446212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446202/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 358 (25. - 31. M√§rz 2019)</a></li>
<li><a href="../de446204/index.html">Prognose, wie Internetbeschr√§nkungen √ºberwunden werden</a></li>
<li><a href="../de446206/index.html">React Tutorial Teil 26: Anwendungsarchitektur, Container- / Komponentenmuster</a></li>
<li><a href="../de446208/index.html">React Tutorial Teil 25: Workshop zu Formularen</a></li>
<li><a href="../de446210/index.html">ADAM-3600 - eine multifunktionale industrielle Steuerung</a></li>
<li><a href="../de446214/index.html">OS1: Ein primitiver Kernel auf Rust f√ºr x86. Teil 3. Speicherkarte, Seitenfehlerausnahme, Heap und Zuordnungen</a></li>
<li><a href="../de446218/index.html">Game Designer unterscheidet sich nicht viel von einem Psycho. Wie wir das CMAN-Spiel gemacht haben</a></li>
<li><a href="../de446222/index.html">Nutzung thermischer Potentiale f√ºr die Gebietsanalyse</a></li>
<li><a href="../de446228/index.html">Verbesserung der Qualit√§t der Textklassifizierung durch Verbindung von Wikipedia</a></li>
<li><a href="../de446230/index.html">Die Fern√ºberwachung und -verwaltung von Linux / OpenWrt / Lede-basierten Ger√§ten √ºber Port 80 wurde fortgesetzt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>