<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø ‚èÆÔ∏è ü¶ó Comment nous avons d√©velopp√© l'informatique chez Leroy Merlin: reconstruire un moteur en d√©placement üñêüèª üë©‚Äçüöí ü¶å</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a quatre ans, une client√®le √©tait maintenue s√©par√©ment dans chaque magasin, plus une autre sur le site. 

 Dans la s√©rie pr√©c√©dente: il y a trois...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons d√©velopp√© l'informatique chez Leroy Merlin: reconstruire un moteur en d√©placement</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/leroy_merlin/blog/457466/"><img src="https://habrastorage.org/webt/cy/-z/2f/cy-z2fzscbxzwe8sybjnsqkg7j8.jpeg"><br><br>  Il y a quatre ans, une client√®le √©tait maintenue s√©par√©ment dans chaque magasin, plus une autre sur le site. <br><br>  Dans la s√©rie pr√©c√©dente: il y a trois ans, nous avions d√©cid√© que nous devions faire notre d√©veloppement en Russie.  Il y a deux ans, ils ont commenc√© √† √©crire leur propre code au lieu de modifier le code fork de la soci√©t√© m√®re.  L'histoire d'aujourd'hui portera sur la fa√ßon dont nous sommes pass√©s d'un grand monolithe h√©rit√© √† un tas de petits microservices connect√©s par une sorte de bus (orchestrateur). <br><br>  Le cas d'utilisation le plus simple: passez une commande sur le site et r√©cup√©rez-la dans la boutique r√©elle Leroy Merlin en Russie.  Auparavant, les commandes des boutiques en ligne √©taient trait√©es dans une autre application en g√©n√©ral et selon un sch√©ma diff√©rent.  D√©sormais, nous avions besoin d'une vitrine omnicanal pour que toute commande soit d√©compos√©e en interface: un caissier dans un magasin, une application mobile, un terminal dans un magasin, un site web - peu importe.  Si vous mettez Linux au micro-ondes, laissez le micro-ondes √™tre.  L'essentiel est que certaines interfaces puissent frapper l'API √† l'arri√®re et dire qu'ici vous devez passer telle ou telle commande.  Et ils ont re√ßu une r√©ponse claire √† cela.  La deuxi√®me histoire √©tait avec des demandes de disponibilit√© et de propri√©t√©s des marchandises de sa carte. <br><br>  √Ä l'avant (nous √©crirons √† ce sujet bient√¥t), nous avons un monstre - AEM, et derri√®re lui √† l'arri√®re se trouvaient deux grandes applications: OPUS et MoVe.  La premi√®re est une base de donn√©es des propri√©t√©s de chaque produit (des dimensions aux descriptions), la seconde est responsable de la caisse, c'est-√†-dire du monolithe de caisse.  Si grandement simplifi√©. <a name="habracut"></a><br><br><h3>  Quel √©tait le probl√®me avec Opus? </h3><br>  OPUS est une grande base distribu√©e.  Plus pr√©cis√©ment, il s'agit d'un logiciel qui fournit une interface pour acc√©der √† la base de donn√©es, c'est-√†-dire qu'il acc√®de √† la base de donn√©es et, par exemple, recherche ou expose simplement l'API afin que les clients ne se rendent pas directement dans la base de donn√©es.  Ce logiciel fonctionne et est support√© en France.  La deuxi√®me caract√©ristique, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comme nous l'avons d√©j√† dit</a> , est que la ligne d'am√©liorations est tr√®s longue, et nous ne sommes pas en priorit√© par rapport √† la business unit de la France. <br><br>  Avec beaucoup de difficult√©, nous avons pu comprendre comment les d√©veloppeurs pouvaient apporter des changements sans une √©quipe de France; de ‚Äã‚Äãtr√®s longues approbations ont eu lieu.  Fonctionnalit√© publi√©e pendant six mois.  En fait, au d√©but, nous voulions faire notre propre d√©veloppement et leur examen, puis nous sommes arriv√©s √† notre propre d√©veloppement, √† notre infrastructure, √† nos tests et en g√©n√©ral au n√¥tre.  Et en m√™me temps a jet√© pr√®s d'un tiers du code h√©rit√©. <br><br>  Mais revenons √† OPUS.  √âtant donn√© que le syst√®me stocke des informations pertinentes sur la disponibilit√©, les caract√©ristiques, les transactions et d'autres choses, nous y avons touch√© pour une raison quelconque.  Sp√©cifiquement pour le site, cela signifie que si l'utilisateur a trois produits dans le panier, vous devez frapper sur la base de donn√©es √† partir de chaque page, car la pertinence est v√©rifi√©e.  M√™me si vous frappez une fois pour le cache, puis le mettez √† jour intelligemment, il y avait encore des fonctionnalit√©s.  Lorsque vous ouvrez la page du catalogue en g√©n√©ral, toutes les sp√©cifications du produit ont √©t√© extraites d'OPUS. <br><br>  La prochaine √©tape logique est que nous avons commenc√© √† tirer OPUS moins souvent et √† faire notre base (plus pr√©cis√©ment, des microservices avec des bases).  Le syst√®me dans son ensemble s'appelait PUB russe. <br><br>  Ensuite, ils ont fait un orchestre, qui peut d√©j√† stocker des agr√©gats, c'est-√†-dire en fait - les donn√©es collect√©es pour les pages de construction.  En ce sens que lorsque l'utilisateur bascule l'affichage des pages des cartes vers les listes, il s'agit toujours du m√™me agr√©gat, seul le recto est diff√©rent. <br><br>  Autrement dit, nous avons quitt√© l'OPUS d'origine (il est toujours en France), mais notre miroir presque complet le ¬´suce¬ª, ce qui coupe la base en morceaux, pr√™t pour l'assemblage dans un orchestre.  Et l'orchestrateur collecte et stocke les agr√©gats (ou les re√ßoit rapidement et commence √† les stocker), dont d'autres syst√®mes ont besoin.  En cons√©quence, cette partie fonctionne comme il se doit.  De la fonctionnalit√© d'origine de l'OPUS fran√ßais, il reste environ 5%.  Bient√¥t, nous le remplacerons compl√®tement. <br><br><h3>  Quel √©tait le probl√®me avec MoVe? </h3><br>  Rien de sp√©cial, sauf que nous avons d√©cid√© de jeter tout le code, car il: <br><br><ol><li>  √âtait ancien sur une vieille pile. </li><li>  Il a pris en compte les caract√©ristiques de chaque r√©gion "Leroy Merlin" dans la cha√Æne des FI. </li><li>  Il √©tait si difficile √† lire et √† maintenir que la meilleure m√©thode de refactorisation √©tait de ¬´r√©√©crire et documenter imm√©diatement normalement¬ª. </li></ol><br>  Ce que nous avons fait.  Seulement, nous ne l'avons pas r√©√©crit comme un monolithe, mais nous avons commenc√© √† faire des microservices pour chaque fonction individuelle autour.  Et puis, une partie des fonctionnalit√©s de MoVe avec le passage au microservice a √©t√© supprim√©e en douceur.  Et ainsi - un par un, jusqu'√† ce que la fonctionnalit√© de MoVe se termine compl√®tement.  Autrement dit, cela fonctionne toujours, mais quelque part dans le vide et sans flux de donn√©es. <br><br>  Depuis que nous avons construit la plate-forme √† partir de morceaux, le projet a √©t√© nomm√© Lego. <br><br>  Lego a compl√®tement chang√© ce milieu.  Oui, clarifions: un vrai backend est un bus h√©rit√©, des syst√®mes de fichiers, des bases de donn√©es et d'autres niveaux d'infrastructure.  Les grandes applications autour de cela et les microservices de logique sont interm√©diaires.  La pr√©sentation est d√©j√† √† l'avant. <br><br><h3>  Pourquoi aviez-vous besoin de r√©√©crire tout cela? </h3><br>  Parce que nous vivions avec des clients diff√©rents pour chaque instance 15 ans apr√®s l'ouverture en Russie, et cela ne convenait √† personne.  Il n'y a pas eu non plus de synchronisation.  Dans d'autres pays, ils vivent toujours comme √ßa. <br><br>  La soci√©t√© m√®re fran√ßaise a fait la logistique g√©n√©rale, nous avons r√©utilis√© le syst√®me Pixis - c'est un seul magasin de re√ßus, c'est-√†-dire les commandes des clients: un magasin voit les commandes d'un autre magasin.  Mais cela n'a pas compl√®tement r√©solu le probl√®me de l'ordre omnicanal.  Il a donc fallu consolider la base et effectuer le traitement g√©n√©ral.  C'est l'essentiel. <br><br>  La deuxi√®me raison √©tait la loi f√©d√©rale sur le box-office: avec nos d√©lais de d√©veloppement pour un syst√®me commun (et des tests) pour tous les pays, nous aurions d√ª payer des amendes. <br><br>  Une option √† peu pr√®s similaire a √©t√© lanc√©e au Br√©sil: ils ont commenc√© Leroy Merlin l√†-bas sans aucun logiciel de la soci√©t√© m√®re, et ils ont r√©ussi.  C'√©tait avant la d√©cision partag√©e.  Soit dit en passant, ils s'engagent beaucoup envers les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">innersors</a> , ils ont un d√©veloppement tr√®s rapide. <br><br>  Pixis permettait de passer une commande uniquement √† partir de la caisse enregistreuse, en fait.  Nous avons chang√© la situation en trois √©tapes: <br><br><ol><li>  Nous avons d'abord fait une application mobile pour l'employ√©, ce qui simplifie grandement sa vie.  Sur cette base, ils ont commenc√© √† construire un √©cosyst√®me o√π les interfaces sont s√©par√©es par la logique. </li><li>  Pendant que tout √©tait mis en place, les commandes Internet √©taient achemin√©es manuellement √† la caisse. </li><li>  Ils ont mis des microservices √† leur tour, qui ont tout remplac√© au milieu. </li></ol><br>  Pourquoi aviez-vous besoin de commencer avec l'application Store?  Parce que nous avons encore des proc√©d√©s uniques par rapport √† la France.  Par exemple, une personne a d√©cid√© d'acheter six m√®tres dix centim√®tres d'une cha√Æne dans un magasin.  Le vendeur l'a coup√©, a donn√© un document sur la dur√©e et le co√ªt.  Vous allez au caissier avec ce papier, vous payez l√†-bas.  Du point de vue de la logique, la vente ne devrait pas √™tre au box-office, mais le vendeur devrait l'avoir, mais en fait c'est au box-office que la chose la plus int√©ressante commence: vous devez avoir √† la fois la marchandise et le papier. <br><br>  En fin de compte, nous allons √™tre une plate-forme pour passer des commandes: maintenant, par exemple, en plus de notre syst√®me principal, des services d'achat de services de ma√Ætres ont √©t√© ajout√©s (j'ai achet√© une cuisine - j'ai command√© l'installation √† un ma√Ætre externe, mais nous l'avons trouv√©e et nous avons donn√© une garantie de nous-m√™mes), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">place de march√©</a> ( achat direct aupr√®s d'un fournisseur sur une gamme plus large), et bient√¥t il doit y avoir une filiale pour que nos blocs puissent √™tre plac√©s n'importe o√π.  Quelque chose comme l'int√©gration de magasins Amazon dans des blogs, mais plus polyvalents. <br><br><h3>  Comment la d√©cision de remplacement a-t-elle √©t√© prise? </h3><br>  <b>Je marche.</b>  <b>Affinez le mod√®le d'entreprise.</b> <br><br>  Nous avons v√©rifi√©, et en effet: le mod√®le, comme en Russie - des prix bas tous les jours - est un succ√®s.  Leroy Merlin en Europe est beaucoup plus cher, mais c'est en Russie que c'est notre cr√©neau: un magasin de construction o√π vous pouvez certainement trouver des marchandises au meilleur prix. <br><br>  <b>II √©tape.</b>  <b>Cr√©ez un script client.</b> <br><br>  Autrement dit, pour construire des processus comme nous voulons qu'ils interagissent avec nous du point de vue du client.  Autrement dit, une vision unique de qui nous voulons √™tre dans quelques ann√©es et √† quoi cela ressemble du point de vue de l'architecture. <br><br>  <b>√âtape III.</b>  <b>Construisez une architecture.</b> <br><br>  D√©composez cette vision en savoirs traditionnels et en architecture avec plus de d√©tails.  Il s'est av√©r√© 110 projets, que nous avons r√©partis en cinq cat√©gories pendant cinq ans. <br><br>  Ils ont ensuite form√© des √©quipes sp√©cialis√©es.  Le plus souvent, ce sont leurs employ√©s et un entrepreneur.  Au d√©but, ils en ont beaucoup souffert: lorsqu'ils sont all√©s au prod, ils n'ont pas vraiment compris comment dig√©rer un si grand volume de changements.  Puis ils ont commenc√© √† faire une approche commune des t√¢ches et √† augmenter progressivement la part de leur d√©veloppement. <br><br>  Dans les endroits o√π l'erreur √©tait critique, ils ont travaill√© selon les plans de la NASA, o√π l'erreur est inacceptable, pas une option du tout.  Il s'agit de transactions d'argent. <br><br>  Et l√† o√π il √©tait possible de tomber, l'essentiel √©tait de se lever rapidement, nous avons utilis√© une approche proche du SRE de Google.  It√©rativement, avec des montants, mais les projets pourraient √™tre mis en ≈ìuvre d√®s que possible.  Et maintenant, nous faisons tellement, et c'est tr√®s cool de se d√©velopper. <br><br>  La troisi√®me approche est l'innovation.  Nous avons d√©velopp√© un bac √† sable d'id√©es pour r√©aliser rapidement les premiers MVP avec nos ressources internes, ce qui nous permet de tester rapidement et √† moindre co√ªt.  C'est le vrai ¬´essayez vite, √©chouez vite¬ª.  Cela vous a permis d'obtenir un budget et une autorit√© pour ceux qui ont propos√© un projet sympa. <br><br>  Le deuxi√®me axe important √©tait le g√©o-d√©veloppement.  Puis a ouvert 20 magasins par an (maintenant un peu plus lentement).  Six mille employ√©s.  De nombreuses r√©gions.  Il a fallu r√©√©crire toute la cha√Æne d'approvisionnement, pour d√©velopper rapidement des processus de rehaussement de l'infrastructure des magasins. <br><br>  En 2017, nous avons d√©cid√© de devenir une plateforme de commandes de construction: c'est une strat√©gie prometteuse pour plusieurs ann√©es √† venir. <br><br>  Pour la g√©ographie, nous avions besoin d'un grand back office informatique pour la croissance de l'entreprise et la croissance de la cha√Æne d'approvisionnement.  Pour l'omnicanal (ordre g√©n√©ral) - un niveau diff√©rent de SLA pour les syst√®mes internes, en temps r√©el, les microservices et la synchronisation entre des centaines de sous-syst√®mes.  Il s'agit g√©n√©ralement d'un niveau de maturit√© informatique diff√©rent.  Pour la plateforme, la vitesse du changement est √©galement importante. <br><br>  Au d√©but, tout le monde pensait que l'agilit√© sauverait le monde.  Avec les entrepreneurs, l'agilit√© peut ne pas √™tre aussi efficace.  D'o√π la volont√© de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recruter</a> 200 personnes dans le service informatique. <br><br>  Nous avons observ√© la rapidit√© avec laquelle nous pouvons tout mettre en ≈ìuvre sans perte pour la marque.  Quelque chose a pu √™tre √©crit rapidement, mais n'a pas eu le temps de pr√©parer le service.  Par exemple, s'il n'y a pas d'informations sur le stock, il n'y a aucun moyen de payer en ligne sans garantie que les marchandises seront r√©serv√©es.  Nous avons d√©compos√© la cha√Æne des interd√©pendances en plusieurs.  Maintenant, nous savons d√©j√† que nous devons raccourcir les cycles, car les comp√©tences de l'√©quipe sont toujours importantes.  Maintenant, nous scions des √©l√©ments en petits morceaux, nous collectons une connexion, maintenant seule l'ann√©e en cours est dans les plans.  Une strat√©gie √† long terme, mais par fonctionnalit√©s, est d'un an maximum, et de nombreuses √©quipes produit distinctes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457466/">https://habr.com/ru/post/fr457466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457450/index.html">Gartner: les 10 meilleures tendances technologiques en mati√®re de traitement et d'analyse des donn√©es en 2019</a></li>
<li><a href="../fr457458/index.html">Support mobile pour machines-outils chinoises. Ou comment les placer dans un appartement</a></li>
<li><a href="../fr457460/index.html">Carte de s√©curit√© du noyau Linux</a></li>
<li><a href="../fr457462/index.html">Uber: Pr√©sentation des algorithmes de gestion de plate-forme cl√©s</a></li>
<li><a href="../fr457464/index.html">D√©duplication des annonces sur Yandex.Immobilier</a></li>
<li><a href="../fr457468/index.html">M√©moire universelle: SRAM, DRAM et m√©moire flash dans une bouteille</a></li>
<li><a href="../fr457470/index.html">Calcul des feuilles: comment un buisson inhabituel a chang√© l'√©quation d'un mod√®le de croissance v√©g√©tale</a></li>
<li><a href="../fr457476/index.html">R√©duction de la taille d'une image Docker avec une application Spring Boot</a></li>
<li><a href="../fr457480/index.html">Cr√©ation d'une application d'√©coute pour visualiser le trafic MMORPG mobile</a></li>
<li><a href="../fr457490/index.html">Aisioshechka de Zuckerberg - bri√®vement et dans le cas de la Balance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>