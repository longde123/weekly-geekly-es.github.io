<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💧 👨‍👨‍👧‍👧 🤴🏿 Auswahl eines Data Warehouse für Prometheus: Thanos vs VictoriaMetrics 💬 😻 🕵🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits. Unten finden Sie eine Abschrift des Berichts mit Big Monitoring Meetup 4 . 


 Prometheus ist ein Überwachungssystem für verschieden...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Auswahl eines Data Warehouse für Prometheus: Thanos vs VictoriaMetrics</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482272/"><p>  Hallo allerseits.  Unten finden Sie eine Abschrift des <a href="https://www.youtube.com/watch%3Fv%3DHyOXAdQE0Pk" rel="nofollow">Berichts mit Big Monitoring Meetup 4</a> . </p><br><p>  <strong><a href="https://github.com/prometheus" rel="nofollow">Prometheus</a></strong> ist ein Überwachungssystem für verschiedene Systeme und Dienste, mit dem Systemadministratoren Informationen über die aktuellen Parameter von Systemen sammeln und Warnungen konfigurieren können, um Benachrichtigungen über Abweichungen im Betrieb von Systemen zu erhalten. </p><br><p>  In dem Bericht werden <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> und <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> , Projekte zur Langzeitspeicherung von Prometheus-Metriken, verglichen. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/vm/ha/hd/vmhahdu2edj4dsc6o3lvzaf-noo.png"></p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HyOXAdQE0Pk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p><img src="https://habrastorage.org/webt/op/ni/ao/opniaodpqcis34bw3f4-twdnsic.png"></p><br><p>  Zuerst werde ich über Prometheus sprechen.  Dies ist ein Überwachungssystem, das Metriken von bestimmten Zielen sammelt und diese im lokalen Speicher speichert.  Prometheus kann Metriken in ein Remote-Repository schreiben, Warnungen generieren und Regeln aufzeichnen. </p><br><p><img src="https://habrastorage.org/webt/dl/ji/yn/dljiynnywlw3fcjl7oc3m7lgstw.png"></p><br><h3 id="ogranicheniya-prometheus">  Prometheus Einschränkungen: </h3><br><ul><li>  Es gibt keine globale Abfrageansicht.  Dies ist, wenn Sie mehrere unabhängige Instanzen von Prometheus haben.  Sie sammeln Metriken.  Und Sie möchten zusätzlich zu all diesen Metriken, die von verschiedenen Prometheus-Instanzen gesammelt wurden, eine Anfrage stellen.  Prometheus erlaubt das nicht. </li><li>  Bei prometheus ist die Leistung auf nur einen Server beschränkt.  Prometheus kann nicht automatisch auf mehrere Server skalieren.  Sie können Ihre Ziele nur manuell auf mehrere Prometheus aufteilen. </li><li>  Das Volumen der Metriken in Prometheus ist aus demselben Grund auf nur einen Server beschränkt, da es nicht automatisch auf mehrere Server skaliert werden kann. </li><li>  In Prometheus ist es nicht so einfach, die Datensicherheit zu organisieren. </li></ul><br><p><img src="https://habrastorage.org/webt/t3/wi/lf/t3wilf2sbn7ndupjqbe1wgxqrzw.png"></p><br><h3 id="resheniya-etih-problemzadach">  Diese Probleme / Herausforderungen lösen? </h3><br><p>  Die Lösungen sind: </p><br><ul><li>  <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> </li><li>  <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> </li><li>  <a href="https://github.com/m3db" rel="nofollow">Uber m3</a> </li><li>  <a href="https://github.com/cortexproject/cortex" rel="nofollow">Cortex</a> </li></ul><br><p>  Alle diese Remote-Speicherlösungen wurden von Prometheus gesammelt.  Sie lösen das Remotespeicherproblem der vorherigen Folie auf unterschiedliche Weise.  In dieser Präsentation werde ich nur auf die ersten beiden Lösungen <a href="https://github.com/thanos-io/thanos" rel="nofollow">eingehen</a> : <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> und <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> . </p><br><p>  Zum ersten Mal erschienen Informationen über <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> unter <a href="https://improbable.io/blog/thanos-prometheus-at-scale" rel="nofollow">diesem Link</a> .  Es beschreibt die Architektur von <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> und wie es funktioniert. </p><br><p><img src="https://habrastorage.org/webt/wg/bq/-b/wgbq-b3pwr1emeewan-q5hszprs.png"></p><br><p>  Dann nimmt Prometheus die von Prometheus gespeicherten Daten auf die lokale Festplatte und kopiert sie in S3, in <a href="https://cloud.google.com/storage/" rel="nofollow">GCS</a> oder in einen anderen Objektspeicher. </p><br><p><img src="https://habrastorage.org/webt/p7/4g/rj/p74grj159fi9xb58vq-hphcrqyi.png"></p><br><p>  Auf diese Weise bietet Thanos eine globale Abfrageansicht.  Sie können im Objektspeicher gespeicherte Daten von mehreren Instanzen von Prometheus anfordern. </p><br><p><img src="https://habrastorage.org/webt/aj/3u/wi/aj3uwi8dd4wgy-fyogditn--kek.png"></p><br><p>  Thanos unterstützt PromQL und die <a href="https://prometheus.io/docs/prometheus/latest/querying/api/" rel="nofollow">Prometheus-Abfrage-API</a> . </p><br><p><img src="https://habrastorage.org/webt/sr/t7/ql/srt7qlyoruhbxr5wglfuyhi9jp4.png"></p><br><p>  Thanos verwendet Prometheus-Code zum Speichern von Daten. </p><br><p><img src="https://habrastorage.org/webt/3y/ws/ik/3ywsiklzziqimz1aig7uzieblqw.png"></p><br><p>  Thanos wird von denselben Entwicklern wie Prometheus entwickelt. </p><br><p>  Über <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> .  Hier ist der <a href="https://medium.com/faun/victoriametrics-creating-the-best-remote-storage-for-prometheus-5d92d66787ac" rel="nofollow">Link,</a> über den wir zuerst über <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics gesprochen haben</a> . </p><br><p><img src="https://habrastorage.org/webt/z9/q2/wv/z9q2wvhshsoqb1ron0jx47djiwc.png"></p><br><p>  VictoriaMetrics empfängt Daten von mehreren Prometheus über das von Prometheus unterstützte <a href="https://prometheus.io/docs/practices/remote_write/" rel="nofollow">Remote Write API-</a> Protokoll. </p><br><p><img src="https://habrastorage.org/webt/pl/xl/ad/plxladg1rdvyudc0wzs5oc2ljsa.png"></p><br><p>  VictoriaMetrics bietet eine globale Abfrageansicht, da mehrere Instanzen von Prometheus Daten in eine VictoriaMetrics schreiben können.  Dementsprechend können Sie alle diese Daten anfordern. </p><br><p><img src="https://habrastorage.org/webt/9l/cp/aw/9lcpawp68_pq2mrhzya9okprroy.png"></p><br><p>  VictoriaMetrics unterstützt auch Thanos, PromQL und die Prometheus-Abfrage-API. </p><br><p><img src="https://habrastorage.org/webt/d1/t1/ek/d1t1ek9rbq_ftlasl48scoriyq0.png"></p><br><p>  Im Gegensatz zu Thanos wird der VictoriaMetrics-Quellcode von Grund auf neu geschrieben und hinsichtlich Geschwindigkeit und Ressourcen optimiert. </p><br><p><img src="https://habrastorage.org/webt/ps/t6/gu/pst6guuoseu2dicx9tra1bvjhry.png"></p><br><p>  VictoriaMetrics skaliert im Gegensatz zu Thanos sowohl vertikal als auch horizontal.  Es gibt eine <a href="" rel="nofollow">Single-Node-Version</a> , die vertikal skaliert.  Sie können mit einem Prozessor und 1 GB Arbeitsspeicher beginnen und schrittweise auf Hunderte von Prozessoren und 1 TB Arbeitsspeicher anwachsen.  VictoriaMetrics kann all diese Ressourcen nutzen.  Die Leistung wird im Vergleich zu einem Single-Core-System um das 100-fache gesteigert. </p><br><p><img src="https://habrastorage.org/webt/tb/s7/t4/tbs7t4unnruaytt7duwambgofne.png"></p><br><p>  Die Geschichte von Thanos begann im November 2017, als das erste öffentliche Commit erschien.  Zuvor wurde Thanos intern von <a href="https://improbable.io/" rel="nofollow">improbable.io entwickelt</a> . </p><br><p><img src="https://habrastorage.org/webt/ik/g7/dg/ikg7dgnmbyiph40zo7v7kyhxrdy.png"></p><br><p>  Im Juni 2019 gab es eine wegweisende Version 0.5.0, in der das <a href="https://en.wikipedia.org/wiki/Gossip_protocol" rel="nofollow">Klatschprotokoll</a> <a href="https://thanos.io/proposals/201809_gossip-removal.md/" rel="nofollow">entfernt wurde</a> .  Er wurde von Thanos entfernt, weil er nicht sein Bestes gab.  Oft funktionierte der Thanos-Cluster nicht richtig, die Knoten, die aufgrund des Gossip-Protokolls falsch damit verbunden waren.  Deshalb beschlossen sie, es von dort zu entfernen.  Ich denke das ist die richtige Entscheidung. </p><br><p><img src="https://habrastorage.org/webt/5y/bu/cu/5ybucuovkh85tqwsrv3cjre-zmu.png"></p><br><p>  Ebenfalls im Juni 2019 sandten sie den Antrag Nr. <a href="https://github.com/cncf/toc/pull/256" rel="nofollow">256</a> an die <a href="https://www.cncf.io/" rel="nofollow">Cloud Native Computing Foundation</a> . </p><br><p><img src="https://habrastorage.org/webt/16/rz/x_/16rzx_bswddquoqw4cmw9txobxa.png"></p><br><p>  Und nach ein paar Monaten trat Thanos der <a href="https://www.cncf.io/" rel="nofollow">Cloud Native Computing Foundation bei</a> , zu der Prometheus, Kubernetes und andere beliebte Projekte gehören. </p><br><p><img src="https://habrastorage.org/webt/9c/i2/ic/9ci2ictg_n0xtgdcxtklghw4n2w.png"></p><br><p>  Im Januar 2018 begann die Entwicklung von VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/wi/li/co/wiliconuw5mwhyzizzthqk8a2og.png"></p><br><p>  Im September 2018 habe ich VictoriaMetrics zum ersten Mal öffentlich erwähnt. </p><br><p><img src="https://habrastorage.org/webt/gd/th/ka/gdthkaxubi8jzg8gedilcotjdje.png"></p><br><p>  Im Dezember 2018 wurde die Single-Node-Version veröffentlicht. </p><br><p><img src="https://habrastorage.org/webt/ui/r7/23/uir723wmd-l1dwxds6katr8cfco.png"></p><br><p>  Im Mai 2019 <a href="https://blog.usejournal.com/open-sourcing-victoriametrics-f31e34485c2b" rel="nofollow">wurden die</a> Quellen sowohl der Single-Node- als auch der Cluster-Version <a href="https://blog.usejournal.com/open-sourcing-victoriametrics-f31e34485c2b" rel="nofollow">veröffentlicht</a> . </p><br><p><img src="https://habrastorage.org/webt/a7/tk/ug/a7tkughz1ut9dmlfb6ued1irbh8.png"></p><br><p>  Im Juni 2019 haben wir uns wie Thanos unter der Nummer <a href="https://github.com/cncf/toc/pull/255" rel="nofollow">255</a> bei der CNCF-Stiftung beworben.  Wir haben uns einen Tag vor Thanos beworben. </p><br><p><img src="https://habrastorage.org/webt/pk/dm/zr/pkdmzr2xn880osldinx6sb10-ai.png"></p><br><p>  Leider sind wir dort noch nicht aufgenommen worden.  Brauche Hilfe von der Community. </p><br><p><img src="https://habrastorage.org/webt/mw/2w/we/mw2wwenfu8tecrrkyrkx-8dhf-8.png"></p><br><p>  Betrachten Sie die wichtigsten Folien zur Architektur von Thanos und VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/1w/by/96/1wby96ev7cqhx7-psbem1b-bf-i.png"></p><br><p>  Beginnen wir mit Thanos.  Gelbe Komponenten sind Prometheus-Komponenten.  Alles andere sind die Thanos-Komponenten.  Beginnen wir mit der wichtigsten Komponente.  Thanos Sidecar ist eine Komponente, die neben jedem Prometheus installiert wird.  Er ist verpflichtet, Prometheus-Daten aus dem lokalen Speicher in S3 oder einen anderen Objektspeicher zu laden. </p><br><p>  Es gibt auch eine Komponente wie Thanos Store Gateway, die diese Daten bei eingehenden Anforderungen von Thanos Query aus dem Objektspeicher lesen kann.  Thanos Query implementiert PromQL und die Prometheus-API.  Das heißt, von außen sieht es aus wie ein Prometheus.  Es akzeptiert PromQL-Abfragen, sendet sie an Thanos Store Gateway, Thanos Store Gateway ruft die erforderlichen Daten aus Object Storage ab und sendet sie zurück. </p><br><p>  Aufgrund der Besonderheit der Thanos Sidecar-Implementierung, die die letzten zwei Stunden nicht in Object Storage S3 hochladen kann, haben wir die Daten im Objektspeicher ohne die letzten zwei Stunden gespeichert, da Prometheus für diese zwei Stunden noch keine Dateien im lokalen Speicher erstellt hat. </p><br><p>  Wie haben sie beschlossen, das zu umgehen?  Thanos Query sendet zusätzlich zu den Anforderungen vom Thanos Store Gateway parallele Anforderungen an alle Thanos-Seitenwagen, die sich neben Prometheus befinden. </p><br><p>  Und Thanos Sidecar wiederum vertritt Anfragen in Prometheus und erhält Daten für die letzten zwei Stunden. </p><br><p>  Zusätzlich zu diesen Komponenten gibt es eine optionale Komponente, ohne die sich Thanos nicht wohlfühlt.  Dies ist Thanos Compact, bei dem kleine Dateien im Objektspeicher zu größeren Dateien zusammengeführt werden, die von Thanos Sidecar hier hochgeladen wurden.  Thanos Sidecar lädt dort in zwei Stunden Datendateien hoch.  Wenn Sie diese Dateien nicht zu größeren Dateien zusammenführen, kann ihre Anzahl erheblich zunehmen.  Je mehr solcher Dateien, desto mehr Speicher wird für Thanos Store Gateway benötigt, desto mehr Ressourcen werden zum Übertragen von Daten über das Netzwerk und von Metadaten benötigt.  Thanos Store Gateway wird ineffizient.  Daher müssen Sie auf jeden Fall Thanos Compact ausführen, bei dem kleine Dateien in größere zusammengeführt werden, damit weniger solche Dateien vorhanden sind, und um den Overhead auf dem Thanos Store Gateway zu verringern. </p><br><p>  Es gibt auch eine solche Komponente wie Thanos Ruler.  Es folgt den Prometheus-Warnregeln und kann die Prometheus-Aufzeichnungsregeln berechnen, um Daten in den Objektspeicher zurückzuschreiben.  Diese Komponente wird aber nicht empfohlen, weil  Er ist <a href="" rel="nofollow">geneigt, unvollständige Daten zurückzugeben</a> . </p><br><p>  Dies ist ein einfaches Schema für Thanos. </p><br><p><img src="https://habrastorage.org/webt/os/em/y4/osemy4ys_bkpy-ngxj7jg-gdmom.png"></p><br><p>  Vergleichen Sie nun mit dem VictoriaMetrics-Schema. </p><br><p>  VictoriaMetrics hat zwei Versionen: Einzelknoten- und Cluster-Version.  Einzelner Knoten wird auf einem einzelnen Computer ausgeführt.  Single-Node hat diese Komponenten nicht, nur eine Binärdatei.  Diese Binärdatei auf der Folie sieht aus wie dieses Quadrat.  Alles, was sich innerhalb des Quadrats befindet, ist der Inhalt der Binärdatei für die Single-Node-Version.  Du musst nichts über ihn wissen.  Starten Sie einfach die Binärdatei - und alles funktioniert für uns. </p><br><p>  Die Cluster-Version ist komplizierter.  Darin befinden sich drei verschiedene Komponenten: vmselect, vminsert und vmstorage.  Aus ihrem Namen sollte klar sein, was jeder von ihnen tut.  Die Insert-Komponente akzeptiert Daten in verschiedenen Formaten: von der Prometheus-Fernschreib-API, dem Influx-Leitungsprotokoll, dem Graphite-Protokoll und dem OpenTSDB-Protokoll.  Die Insert-Komponente akzeptiert sie, analysiert sie und verteilt sie auf vorhandene Speicherkomponenten, in denen die Daten bereits gespeichert sind.  Die Select-Komponente akzeptiert wiederum PromQL-Abfragen.  Es implementiert <a href="https://medium.com/%40valyala/promql-tutorial-for-beginners-9ab455142085" rel="nofollow">PromQL</a> sowie die Prometheus-Abfrage-API und kann als Ersatz für Prometheus in Grafana oder anderen Prometheus-API-Clients verwendet werden.  Select akzeptiert eine Promql-Anforderung, analysiert sie, liest die erforderlichen Daten zum Ausführen dieser Anforderung vom Speicherknoten, verarbeitet diese Daten und gibt eine Antwort zurück. </p><br><p><img src="https://habrastorage.org/webt/sb/co/mx/sbcomx2usdrwzbyfgqjubvoichg.png"></p><br><p>  Vergleichen Sie die Schwierigkeiten bei der Installation von Thanos und VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/hv/gw/r6/hvgwr6nk7yh4nog7rpjac4fn0se.png"></p><br><p>  Beginnen wir mit Thanos.  Bevor Sie mit Thanos arbeiten, müssen Sie in Object Storage einen Bucket erstellen, z. B. S3 oder GCS, damit Thanos Sidecar dort Daten schreiben kann. </p><br><p><img src="https://habrastorage.org/webt/st/hk/5s/sthk5swss1mkaalb4p3oiebnesq.png"></p><br><p>  Dann müssen Sie für jeden Prometheus Thanos Sidecar installieren.  Vorher müssen Sie daran denken, die Datenkomprimierung in Prometheus zu deaktivieren.  Durch die Datenkomprimierung werden die Daten im lokalen Speicher von Prometheus regelmäßig komprimiert, um den Ressourcenverbrauch zu senken. </p><br><p>  Wenn Sie Thanos Sidecar auf Ihrem Prometheus installieren, müssen Sie diese Datenkomprimierung deaktivieren, da Thanos Sidecar bei aktivierter Datenkomprimierung nicht normal funktioniert.  Dies bedeutet, dass Ihr Prometheus beginnt, Daten in Blöcken von zwei Stunden zu speichern und diese Blöcke nicht mehr zu größeren Blöcken zusammenführt.  Dementsprechend funktionieren Anforderungen, die länger als die letzten zwei Stunden sind, nicht so effizient wie bei aktivierter Datenkomprimierung. </p><br><p><img src="https://habrastorage.org/webt/gd/as/pw/gdaspwys_r63cegoxqovl9bcmie.png"></p><br><p>  Daher empfiehlt Thanos, die Datenaufbewahrungszeit im lokalen Speicher auf 6-8 Stunden zu reduzieren, um den Overhead einer großen Anzahl kleiner Blöcke zu verringern. </p><br><p>  Nach der Installation von Thanos Sidecar müssen Sie zwei Komponenten für jeden Object Storage Bucket installieren.  Dies sind Thanos Compactor und Thanos Store Gateway. </p><br><p><img src="https://habrastorage.org/webt/cw/4f/yk/cw4fyksvnkmp1tcn-clf-2gzx3q.png"></p><br><p>  Danach müssen Sie Thanos Query installieren und so konfigurieren, dass es weiß, wie eine Verbindung zu allen Thanos Store Gateways hergestellt wird und wie eine Verbindung zu allen Thanos Sidecar hergestellt wird. </p><br><p>  Möglicherweise liegt ein kleines Problem vor. </p><br><p><img src="https://habrastorage.org/webt/vf/sc/30/vfsc30z00pvcnupbdym2jztx09k.png"></p><br><p>  Sie müssen eine zuverlässige und sichere Verbindung von Thanos Query zu diesen Komponenten konfigurieren.  Befindet sich Ihr Prometheus in verschiedenen Rechenzentren oder in verschiedenen VPCs, sind externe Verbindungen zu diesen verboten.  Aber damit Thanos Query funktioniert, müssen Sie die Verbindung dort irgendwie konfigurieren und einen Weg finden. </p><br><p>  Wenn Sie viele solcher Rechenzentren haben, sinkt dementsprechend die Zuverlässigkeit des gesamten Systems.  Da Thanos Query ständig mit allen Thanos Sidecar verbunden bleiben muss, befinden sich diese in verschiedenen Rechenzentren.  Bei jeder eingehenden Anfrage wird er Anfragen an alle Thanos Sidecar weiterleiten.  Wenn die Verbindung unterbrochen wird, erhalten Sie entweder einen unvollständigen Datensatz oder die Antwort "Der Cluster funktioniert nicht". </p><br><p><img src="https://habrastorage.org/webt/rb/ka/aw/rbkaawevhardp1d85mhgdejylxg.png"></p><br><p>  In VictoriaMetrics ist es etwas einfacher.  Bei der Single-Node-Version reicht es aus, nur eine Binärdatei auszuführen, und alles funktioniert. </p><br><p><img src="https://habrastorage.org/webt/co/ui/ll/couillafhtmobnbutejgs6qvszu.png"></p><br><p>  In einer Cluster-Version reicht es aus, alle drei oben genannten Komponententypen in einer beliebigen Anzahl auszuführen oder den Start von Komponenten in Kubernetes mithilfe des <a href="https://github.com/VictoriaMetrics/helm-charts/" rel="nofollow">Steuerdiagramms</a> zu automatisieren.  Wir planen immer noch, einen Kubernetes-Betreiber zu machen.  Die Helmkarte deckt einige Fälle nicht ab und ermöglicht es Ihnen, Ihr Bein zu schießen.  So können Sie beispielsweise die Anzahl der Speicherknoten reduzieren, was zu Datenverlusten führt. </p><br><p><img src="https://habrastorage.org/webt/jb/ta/0t/jbta0t7qcko6jov_x1ximqkfni0.png"></p><br><p>  Nachdem Sie eine Binär- oder Cluster-Version gestartet haben, müssen Sie der Prometheus-Konfiguration lediglich die <a href="" rel="nofollow">Einstellung für die Remote-Schreib-URL</a> hinzufügen, damit Daten parallel zum lokalen Speicher und zum Remote-Speicher geschrieben werden.  Wie Sie bemerkt haben, sollte diese Konfiguration im Vergleich zur Thanos-Konfiguration wesentlich zuverlässiger funktionieren.  Wir müssen VictoriaMetrics nicht mit allen Prometheus in Verbindung halten, da die Prometheus selbst eine Verbindung zu VictoriaMetrics herstellen und die Daten übertragen. </p><br><p><img src="https://habrastorage.org/webt/u3/3a/if/u33aifuu7myx3vvs0mkbeysfnei.png"></p><br><p>  Betrachten Sie die Escorts Thanos und VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/fq/dt/d2/fqdtd27cjx-yktnyozgxoon2pte.png"></p><br><p>  Thanos muss Sidecar im Auge behalten, damit es nicht aufhört, Daten in Object Storage zu laden.  Sie können das Laden dieser Daten aufgrund von Ladefehlern stoppen, z. B. wenn Ihre Netzwerkverbindung mit dem Objektspeicher vorübergehend getrennt wird oder der Objektspeicher vorübergehend nicht verfügbar ist.  In diesem Moment wird Thanos Sidecar dies bemerken, einen Fehler melden, herunterfallen und dann aufhören zu arbeiten.  Wenn Sie es nicht überwachen, werden Ihre Daten nicht mehr in den Objektspeicher übertragen.  Wenn die Aufbewahrungszeit abgelaufen ist (6-8 Stunden empfohlen), gehen Daten verloren, die nicht in den Objektspeicher gefallen sind. </p><br><p><img src="https://habrastorage.org/webt/z7/bm/cx/z7bmcxgwyscnrnnehhtjvuqipho.png"></p><br><p>  Alsos Verdichter können aufhören zu arbeiten, weil sie <a href="https://github.com/thanos-io/thanos/issues/1919" rel="nofollow">mit Sidecar fahren</a> .  Komprimierer nehmen Daten aus dem Objektspeicher und führen sie zu größeren Datenblöcken zusammen.  Da die Kompaktoren nicht mit dem Beiwagen synchronisiert sind, kann dies passieren: Beiwagen hat den Block noch nicht fertig geschrieben, Kompaktor entscheidet, dass dieser Block vollständig aufgezeichnet ist.  Compactor beginnt es zu lesen.  Der Block wird nicht vollständig gelesen und funktioniert nicht mehr.  Details finden Sie <a href="https://thanos.io/proposals/201901-read-write-operations-bucket.md/" rel="nofollow">hier</a> . </p><br><p><img src="https://habrastorage.org/webt/_u/c6/hb/_uc6hbgr_kl9l2an5yl0cs9hfba.png"></p><br><p>  Store Gateway kann aufgrund des Wettlaufs zwischen Compactor und Sidecar inkonsistente Daten liefern.  Dies ist dasselbe, da das Store Gateway in keiner Weise mit dem von Compactor und Sidecar synchronisiert ist.  Dementsprechend kann eine Wettlaufsituation eintreten, wenn das Store Gateway einen Teil der Daten oder überschüssige Daten nicht sieht. </p><br><p><img src="https://habrastorage.org/webt/-y/20/ur/-y20urze7qgwxkrklj8ave_ct3i.png"></p><br><p>  Die Abfragekomponente in Thanos führt standardmäßig zu Teilergebnissen, wenn derzeit einige Sidecar- oder Store Gateway-Komponenten nicht verfügbar sind.  Sie erhalten einen Teil der Daten und wissen nicht einmal, dass nicht alle Daten empfangen wurden.  Dass es standardmäßig so funktioniert.  In einer ähnlichen Situation gibt VictoriaMetrics die markierten Daten als Teil zurück. </p><br><p><img src="https://habrastorage.org/webt/2g/op/wp/2gopwpbh41vviugdebarsjuql4w.png"></p><br><p>  Im Gegensatz zu Thanos verliert VictoriaMetrics selten Daten.  Auch wenn die Verbindung von Prometheus zu VictoriaMetrics unterbrochen wird, ist dies kein Problem, da Prometheus weiterhin eingehende neue Daten im Write Ahead Log aufzeichnet, das 2 Stunden groß ist.  Wenn Sie innerhalb von zwei Stunden erneut eine Verbindung zu VictoriaMetrics herstellen, gehen die Daten nicht verloren.  Prometheus <a href="https://grafana.com/blog/2019/03/25/whats-new-in-prometheus-2.8-wal-based-remote-write/" rel="nofollow">kann Daten hinzufügen, nachdem die Verbindung zu VictoriaMetrics wiederhergestellt wurde</a> . </p><br><p><img src="https://habrastorage.org/webt/kg/nl/mv/kgnlmvkqxfagsjhodoybpwzl7am.png"></p><br><p>  Im Gegensatz zu Thanos, bei dem Daten erst nach zwei Stunden in den Objektspeicher geschrieben werden, repliziert Prometheus Daten automatisch über das Remote-Schreibprotokoll in den Remote-Speicher, z. B. VictoriaMetrics.  Sie haben keine Angst, den lokalen Speicher in Prometheus zu verlieren.  Wenn er plötzlich den lokalen Speicher verloren hat, gehen im schlimmsten Fall die letzten Sekunden der Daten verloren, die keine Zeit zum Schreiben auf den Remotespeicher hatten. </p><br><p><img src="https://habrastorage.org/webt/ba/xj/90/baxj90beqmojti9xkubodbkbvdw.png"></p><br><p>  Im Gegensatz zu Thanos verwaltet Kubernetes den Cluster automatisch.  Im Gegensatz zu VictoriaMetrics-Cluster-Komponenten sind alle Thanos-Komponenten schwer in einen einzelnen Kubernetes-Cluster zu integrieren. </p><br><p><img src="https://habrastorage.org/webt/gz/lb/6l/gzlb6lg2dkrabcovqcohvovd-mk.png"></p><br><p>  VictoriaMetrics hat ein sehr einfaches Upgrade auf die neue Version.  Stoppen Sie einfach VictoriaMetrics, aktualisieren Sie die Binärdateien und führen Sie sie aus.  Wenn Sie ein SIGINT-Signal beenden, werden alle VictoriaMetrics-Binärdateien ordnungsgemäß heruntergefahren.  Sie speichern die erforderlichen Daten korrekt, schließen eingehende Verbindungen korrekt, um nichts zu verlieren.  Daher verlieren Sie beim Upgrade nichts. </p><br><p><img src="https://habrastorage.org/webt/qz/yf/8c/qzyf8cvpqlimwabno0zx7v5_rxw.png"></p><br><p>  VictoriaMetrics bietet eine sehr einfache Möglichkeit, einen Cluster zu erweitern.  Fügen Sie einfach die erforderlichen Komponenten hinzu und arbeiten Sie weiter. </p><br><p><img src="https://habrastorage.org/webt/hl/le/sj/hllesjwiv-f1wosgssd7wp6aclo.png"></p><br><p>  Über die Fallstricke in Thanos und Victoria Metrics. </p><br><p><img src="https://habrastorage.org/webt/xs/ec/b0/xsecb0yy15vimtsl9k9quqplyiw.png"></p><br><p>  Thanos hat die folgenden Tücken.  Prometheus sollte Daten für die letzten zwei Stunden speichern.  Wenn sie verloren gehen, verlieren Sie sie vollständig, da sie noch nicht im Objektspeicher registriert wurden, wie z. B. S3. </p><br><p><img src="https://habrastorage.org/webt/fg/xo/yo/fgxoyo1q8mihcdy7m_yyio_pyum.png"></p><br><p>  Die Store Gateway-Komponente und die Compactor-Komponente benötigen möglicherweise viel Speicher, um mit großem Objektspeicher zu arbeiten, wenn dort viele kleine Dateien gespeichert sind.  Je größer die Anzahl und das Volumen der Dateien ist, desto mehr Speicher für Store Gateway und Compactor ist erforderlich, um Metainformationen zu speichern.  Thanos hat eine Menge Probleme mit <a href="https://github.com/thanos-io/thanos/issues/448" rel="nofollow">Store Gateway und Compactor, die mit durchschnittlich aufgezeichneten Daten abfallen</a> . </p><br><p><img src="https://habrastorage.org/webt/-n/k3/rg/-nk3rgph8ghszyegz1j8jx89bio.png"></p><br><p>  Thanos wird angepriesen, dass es sich unbegrenzt nach der Höhe Ihres Prometheus skalieren lässt.  Das stimmt eigentlich nicht.  Da alle Anforderungen die Abfragekomponente durchlaufen, die gleichzeitig alle Store Gateway-Komponenten und alle Sidecar-Komponenten abfragen muss, ziehen Sie Daten von dort und verarbeiten Sie sie dann vor.  Offensichtlich wird die Abfragegeschwindigkeit durch das langsamste schwache Glied, das langsamste Store Gateway oder das langsamste Sidecar begrenzt. </p><br><p>  Diese Komponenten können ungleichmäßig belastet sein.  Zum Beispiel haben Sie einen Prometheus, der Millionen von Metriken pro Sekunde sammelt.  Und da ist Prometheus, der Tausende von Metriken pro Sekunde sammelt.  Prometheus, das Millionen von Metriken pro Sekunde sammelt, lädt den Server, auf dem es ausgeführt wird, viel mehr.  Dementsprechend ist Sidecar dort langsamer.  Im Allgemeinen arbeitet dort alles langsam.  Und die Abfragekomponente ruft Daten von dort sehr langsam ab.  Dementsprechend wird die Leistung Ihres gesamten Clusters durch diesen langsamen Beiwagen eingeschränkt. </p><br><p><img src="https://habrastorage.org/webt/mg/an/ra/mganracsmhkyz1_1aq014v_6cfc.png"></p><br><p>  Standardmäßig gibt Thanos Teildaten zurück, wenn einige Sidecars und Store Gateway nicht verfügbar sind.  Wenn beispielsweise Sidecar in verschiedenen Rechenzentren auf der ganzen Welt verteilt ist, steigt die Wahrscheinlichkeit einer Trennung und Nichtverfügbarkeit von Komponenten erheblich.  Dementsprechend erhalten Sie in den meisten Fällen Teildaten, ohne es überhaupt zu wissen. </p><br><p><img src="https://habrastorage.org/webt/1t/m2/j7/1tm2j75o5cpscbevahbz4m0wusk.png"></p><br><p>  VictoriaMetrics hat auch Fallstricke.  Der erste Nachteil ist eine Option, die den für den VictoriaMetrics-Cache verwendeten RAM-Speicher begrenzt.  Standardmäßig entspricht dies 60% des Arbeitsspeichers auf dem Computer, auf dem VictoriaMetrics ausgeführt wird, oder 60% des VictoriaMetrics-Pod-Arbeitsspeichers in Kubernetes. </p><br><p>  Wenn Sie diesen Wert falsch ändern, kann dies die Leistung von VictoriaMetrics beeinträchtigen.  Wenn Sie beispielsweise den Wert zu niedrig festlegen, passen die Daten möglicherweise nicht mehr in den VictoriaMetrics-Cache.  Aus diesem Grund muss sie zusätzliche Arbeit leisten und den Prozessor mit der Festplatte laden.  Wenn Sie diese Option zu groß wählen, erhöht sich zum einen die Wahrscheinlichkeit, dass VictoriaMetrics mit einem Speicherfehler abstürzt, und zum anderen verbleibt sehr wenig Arbeitsspeicher im Betriebssystem Speicher für den Dateicache.  Und VictoriaMetrics benötigt einen Dateicache für die Leistung.  Wenn dies nicht ausreicht, kann sich die Belastung der Festplatte erheblich erhöhen.  Daher ein Tipp: Ändern Sie den Parameter nicht, es sei denn, dies ist unbedingt erforderlich. </p><br><p><img src="https://habrastorage.org/webt/3q/eo/25/3qeo25x5juqpyquhllrhpt9eh34.png"></p><br><p>  Die zweite Möglichkeit.  Dies ist der Aufbewahrungszeitraum - der Zeitraum, der standardmäßig auf 1 Monat festgelegt ist.  Dies ist die Zeit, in der VictoriaMetrics Daten speichert.  Nach dieser Zeit löscht VictoriaMetrics die Daten. </p><br><p>  Viele führen VictoriaMetrics ohne diesen Parameter aus und zeichnen Daten für einen Monat auf.  Und dann fragen sie: Warum sind die Daten für den Vormonat verschwunden?  Da die Aufbewahrungsdauer standardmäßig 1 Monat beträgt.  Daher müssen Sie den richtigen Aufbewahrungszeitraum kennen und festlegen. </p><br><p><img src="https://habrastorage.org/webt/n1/5a/jm/n15ajmeqozq7zfzc0uv3imzfebw.png"></p><br><p>  Lassen Sie uns durch einzigartige Möglichkeiten gehen. </p><br><p><img src="https://habrastorage.org/webt/k8/b7/br/k8b7brhqxwy1fa1vdurx0yolgra.png"></p><br><p>  Thanos verfügt über eine Funktion wie das Downsampling: Intervalle von 5 Minuten und Stunden, die häufig <a href="https://github.com/thanos-io/thanos/issues%3Futf8%3D%25E2%259C%2593%26q%3Dis%253Aissue%2Bis%253Aopen%2Bdownsampling" rel="nofollow">nicht richtig funktionieren</a> .  Wenn Sie es googeln und sich das Problem auf Github ansehen, gibt es eine Menge Probleme im Zusammenhang mit diesem Downsampling, die manchmal nicht richtig funktionieren oder nicht so funktionieren, wie die Benutzer es erwarten. </p><br><p><img src="https://habrastorage.org/webt/iv/nq/4v/ivnq4vtxkkwf_1hs40ttkyhd1ie.png"></p><br><p>  Thanos verfügt über eine Datendeduplizierung für Prometheus HA-Paare.  Wenn zwei Prometheus'a dieselben Metriken vom selben Ziel sammeln und Thanos sie in den Objektspeicher legt. Thanos     ,    VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/wn/rv/jh/wnrvjhzqrcx6_o9hoojijeivb8o.png"></p><br><p>  Thanos  alert ,     Thanos.   <a href="" rel="nofollow">    production</a> . </p><br><p><img src="https://habrastorage.org/webt/ti/qp/ci/tiqpcidg_t_ahj9lornrey8_rda.png"></p><br><p>  Thanos ,    Thanos   Prometheus — . Thanos  Prometheus      .    Thanos  Prometheus   . </p><br><p><img src="https://habrastorage.org/webt/en/vo/o-/envoo-2amya3w4xo2c5lg-pa1bo.png"></p><br><p>  VictoriaMetrics    — MetricsQL.   VictoriaMetrics  PromQL,       big monitoring metup. </p><br><p><img src="https://habrastorage.org/webt/yk/xq/hi/ykxqhipgapygdv7ra2c6rmaitnk.png"></p><br><p> VictoriaMetrics       . VictoriaMetrics       Prometheus,     Influx, OpenTSDB  Graphite. </p><br><p><img src="https://habrastorage.org/webt/0k/zy/jp/0kzyjptb5sbscny1ffsdh2irqau.png"></p><br><p>  VictoriaMetrics         Thanos  Prometheus. </p><br><p>    ,     2-5          Prometheus  Thanos. </p><br><p><img src="https://habrastorage.org/webt/2y/xz/yg/2yxzygpbfnqt3ldibpggeo35rpw.png"></p><br><p>    VictoriaMetrics —    . </p><br><p><img src="https://habrastorage.org/webt/kk/jd/hy/kkjdhy-zae6bc_3uqu6yp3q1gwy.png"></p><br><p>    . </p><br><p><img src="https://habrastorage.org/webt/79/yz/yw/79yzywujo1uxm6zc5rti6ebjzpq.png"></p><br><p>    Thanos  ,      object storage,   . </p><br><p>     object storage,         ($10   ).      object storage,          ,       AWS —  .    ,    $10  $230  1.    ,        Thanos . </p><br><p><img src="https://habrastorage.org/webt/eg/--/mv/eg--mv_wpjcv4m-tojp8l9r60ea.png"></p><br><p>  Thanos      Compact, Store Gateway, Query ,    ,     . </p><br><p><img src="https://habrastorage.org/webt/pz/0v/np/pz0vnpflfebkxmaqi3sbbucktz0.png"></p><br><p>  VictoriaMetrics  .     GCE HDD ,   $40  1.  VictoriaMetrics   HDD ,    SSD,      . VictoriaMetrics   HDD. </p><br><p><img src="https://habrastorage.org/webt/dr/6q/lz/dr6qlzowqew8et2zpev1wkrq4cs.png"></p><br><p> VictoriaMetrics benötigt Server für Komponenten: entweder Single-Nod- oder Cluster-Komponenten, die im Gegensatz zu Thanos-Komponenten viel weniger CPU und RAM benötigen - entsprechend günstiger. </p><br><p><img src="https://habrastorage.org/webt/ja/72/cr/ja72crhogqpdixrt8jzj-komdcq.png"></p><br><p>  Beispiele für die Implementierung. </p><br><p><img src="https://habrastorage.org/webt/od/ji/fw/odjifwunkpjdwuqq-hbpwswu_cy.png"></p><br><p>  Das Implementierungsbeispiel von Thanos ist Gitlab.  Gitlab wird vollständig von Thanos unterstützt.  Aber es ist nicht so glatt.  Wenn Sie sich ihre <a href="https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8647" rel="nofollow">Probleme</a> ansehen, können Sie feststellen, dass sie ständig <a href="https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8413" rel="nofollow">Probleme mit Thanos haben</a> : Es ist nicht genügend Speicher für Store Gateway- oder Query-Komponenten vorhanden.  Sie müssen ständig die Speicherkapazität erhöhen. </p><br><p>  Aus diesem Grund steigen die Kosten zur Lösung dieser Probleme. </p><br><p>  Die zweite Implementierung, die erfolgreicher sein könnte, ist das Unternehmen Improbable, das mit der Entwicklung von Thanos begonnen hat.  Sie veröffentlichten die Quelle von Thanos.  Unwahrscheinlich ist ein Unternehmen, das Game-Engines entwickelt. </p><br><p><img src="https://habrastorage.org/webt/t4/yh/y4/t4yhy4gyfrimyzyfopgdwk1ixyc.png"></p><br><p>  Öffentliche Beispiele für die Implementierung von VictoriaMetrics sind: </p><br><ul><li>  wix.com site builder </li><li>  Adidas stellt VictoriaMetrics vor und hat sogar auf der letzten PromCon 2019 eine Präsentation gehalten </li><li>  TrafficStars - Werbenetzwerk </li><li>  Seznam.cz ist eine beliebte tschechische Suchmaschine. </li></ul><br><p>  Und dann ging es zum Firmennamen, den ich jetzt nicht nennen kann.  Sie stimmten nicht zu. </p><br><ul><li>  Ein großer Spieleentwickler.  Größer als sie Unwahrscheinlich. </li><li>  Ein bedeutender Grafik-Software-Entwickler. </li><li>  Große russische Bank. </li><li>  Europäischer Hersteller von Windkraftanlagen, der VictoriaMetrics erfolgreich getestet hat.  Dieser Hersteller implementiert VictoriaMetrics, um Daten von Windkraftanlagen mit einer Geschwindigkeit von 50 Abtastwerten pro Sekunde und Sensor zu überwachen.  Jede Windkraftanlage verfügt über mehrere hundert Sensoren.  Sie haben mehrere hundert Windkraftanlagen. </li><li>  Russische Fluggesellschaften, die VictoriaMetrics einführen wollen, können dies aber immer noch nicht.  Wir sind mit ihnen im Vertragsstadium. </li></ul><br><p><img src="https://habrastorage.org/webt/lw/0f/r3/lw0fr3hdyce3yw6n0i3ywjnpxhs.png">  Schlussfolgerungen </p><br><p>  VictoriaMetrics und Thanos lösen ähnliche Probleme auf unterschiedliche Weise: </p><br><ul><li>  Globale Abfrageansicht </li><li>  horizontale Skalierung </li><li>  willkürliche Aufbewahrung </li></ul><br><p><img src="https://habrastorage.org/webt/pv/-b/ob/pv-bobndxjkjrcukph5xm3sa-98.png"></p><br><p>  Vielen Dank. </p><br><p>  Auf unserem <a href="https://t.me/VictoriaMetrics_ru1" rel="nofollow">Telegrammkanal</a> warten wir auf Sie. </p><br><p><img src="https://habrastorage.org/webt/gu/0s/w5/gu0sw56ppge1icdy-ensv-wl3f4.png"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482272/">https://habr.com/ru/post/de482272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482260/index.html">TelegramBot. Die Grundfunktionalität. Aufkleber und Emoticons. (Teil 3)</a></li>
<li><a href="../de482262/index.html">So melden Sie sich bei Talend Open Studio an</a></li>
<li><a href="../de482264/index.html">Brasilien, dunkle Magie, Mortal Kombat, Mars und 15.000 Menschen. Ontiko Jahresergebnisse</a></li>
<li><a href="../de482268/index.html">Megastrukturen der Zukunft: Die Dyson-Kugel, der Sternmotor und die „Schwarze-Loch-Bombe“</a></li>
<li><a href="../de482270/index.html">WebRTC-Streaming in und um die virtuelle Realität</a></li>
<li><a href="../de482274/index.html">5 Gründe, warum Sie die Verwendung von System.Drawing in ASP.NET einstellen sollten</a></li>
<li><a href="../de482276/index.html">GOST R 57580. Vom Trend zur effizienten Automatisierung</a></li>
<li><a href="../de482280/index.html">Wie wird Cosplay gemacht? Isaac Clarkes Kostüm für Fortgeschrittene aus Dead Space 2</a></li>
<li><a href="../de482282/index.html">Das Ende der ARMv7-Ära oder ein bisschen über das Portieren von Spielen</a></li>
<li><a href="../de482284/index.html">"50 Brauntöne" oder "Wie sind wir dazu gekommen"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>