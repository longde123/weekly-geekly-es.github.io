<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßô üòû üßòüèª Gera√ß√£o de chave hier√°rquica üí° üçÅ üò¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, falaremos sobre carteiras determin√≠sticas, gera√ß√£o hier√°rquica de chaves e como ela funciona matematicamente e em quais casos √© convenie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gera√ß√£o de chave hier√°rquica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/distributedlab/blog/413627/">  Neste artigo, falaremos sobre carteiras determin√≠sticas, gera√ß√£o hier√°rquica de chaves e como ela funciona matematicamente e em quais casos √© conveniente colocar em pr√°tica.  Este material ser√° √∫til para especialistas cujas atividades est√£o relacionadas a gateways de pagamento, carteiras de Bitcoin e outras lojas de moedas.  Al√©m disso, o material ser√° de interesse para quem estiver interessado em criptografia el√≠ptica e esquemas de implanta√ß√£o de chaves de assinatura eletr√¥nica. <br><a name="habracut"></a><br><h2>  <b>Carteira determin√≠stica</b> </h2><br>  Primeiro de tudo, vamos definir o que √© uma carteira determin√≠stica.  Quando falamos sobre gera√ß√£o de chaves, geralmente usamos a palavra "carteira", porque no contexto de moedas criptografadas, possuir uma chave privada √© prova de propriedade de moedas e, nesse caso, carteira e chave t√™m um significado semelhante. <br><br>  Carteira determin√≠stica √© uma carteira na qual todas as chaves privadas usadas foram geradas a partir de um segredo compartilhado por todas as chaves.  A peculiaridade √© que √© poss√≠vel, a partir de um segredo, gerar qualquer n√∫mero de pares de chaves para assinatura eletr√¥nica.  Voc√™ pode usar novos endere√ßos para cada pagamento recebido e altera√ß√£o. <br><br>  Convenientemente, as chaves dessa carteira podem ser facilmente transferidas para outro dispositivo, feitas uma c√≥pia de backup e depois restauradas, porque na verdade voc√™ precisa reservar apenas um segredo principal.  Al√©m disso, todas as chaves privadas geradas a partir do segredo principal n√£o s√£o conectadas umas √†s outras.  √â imposs√≠vel rastrear a conex√£o entre os endere√ßos gerados (para determinar que todos pertencem a um usu√°rio) e, com a chave privada gerada, n√£o √© poss√≠vel restaurar o segredo compartilhado. <br><br><h3>  Codifica√ß√£o secreta b√°sica </h3><br>  Agora vamos falar sobre a codifica√ß√£o do segredo principal.  H√° alguma abordagem padronizada que foi definida no BIP39.  Essa √© a chamada codifica√ß√£o de verifica√ß√£o de codifica√ß√£o do segredo principal em uma frase mnem√¥nica - um conjunto de palavras f√°ceis de escrever no papel e, se necess√°rio, lembrar.  Ao entrar, √© poss√≠vel verificar a soma de verifica√ß√£o, ou seja, identificar um erro, se houver, com uma probabilidade bastante alta. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00e/c02/e0f/00ec02e0fe0b361673229ecc9fa59e14.png" alt="imagem"><br><br>  Como isso funciona?  Na verdade, voc√™ tem o segredo principal (Entropia) - os dados a partir dos quais todas as chaves pessoais da carteira s√£o expandidas.  Esse segredo pode ter comprimentos diferentes.  Quanto √† soma de verifica√ß√£o: para cada 32 bits de Entropia, h√° 1 bit da soma de verifica√ß√£o, ou seja, Checksum √© calculado pela f√≥rmula como o comprimento da Entropia em bits dividido por 32. <br><br>  A entropia concatena com uma soma de verifica√ß√£o, que √© calculada como um hash SHA-256 duplo (SHA-2 com um comprimento de 256 bits), ap√≥s o qual o n√∫mero necess√°rio de bits √© cortado.  Os dados concatenados s√£o transferidos para outro sistema num√©rico: do bin√°rio para o sistema num√©rico na base de 2048 (como voc√™ pode ver, 2048 √© <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> 2 ^ {11} </script>  )  E se voc√™ adicionar o comprimento dos bits da Entropia e a soma de verifica√ß√£o, obter√° um m√∫ltiplo de 11.  Assim, obtemos o n√∫mero de palavras na frase mnem√¥nica de sa√≠da. <br><br>  De fato, os dados s√£o "fatiados" em partes de 11 bits.  H√° um dicion√°rio de 2048 palavras ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2"> 2 ^ {11} </script>  ) aos quais se aplicam certos requisitos.  O idioma padr√£o do dicion√°rio √© o ingl√™s, mas qualquer pessoa pode ser usada.  As palavras n√£o devem exceder um determinado comprimento (geralmente um limite de at√© 7 caracteres).  Todos eles devem ser codificados em UTF-8 com uma certa normaliza√ß√£o de todos os caracteres.  Obrigat√≥rio √© a exclusividade de cada palavra nos quatro primeiros caracteres. <br><br>  Os quatro primeiros caracteres identificam exclusivamente a palavra no dicion√°rio, e os caracteres restantes s√£o usados ‚Äã‚Äãpara completar essa palavra em uma forma conveniente para leitura, memoriza√ß√£o etc. Assim, cada parte de dados composta por 11 bits recebe uma correspond√™ncia inequ√≠voca na forma de uma palavra. dicion√°rio.  Se a entropia do seu segredo for 256 bits, os dados para codifica√ß√£o ser√£o 264 bits e sua frase mnem√¥nica conter√° 24 palavras.  Essa √© a principal abordagem para criptografar segredos de carteira no BIP39, mais usada na pr√°tica. <br><br>  Para fazer uma c√≥pia de backup no futuro e us√°-la, voc√™ est√° convidado a escrever esta frase em uma m√≠dia externa.  O papel que voc√™ armazenar√° em um local seguro √© o melhor.  Assim, voc√™ pode restaurar o acesso total a todas as suas chaves. <br><br><h3>  Tipos de carteiras determin√≠sticas </h3><br>  As carteiras determin√≠sticas v√™m em dois tipos.  Considere suas principais diferen√ßas. <br><br>  O primeiro √© o mais simples.  O principal segredo aqui √© concatenado com o √≠ndice da chave filho que queremos obter, ap√≥s o qual os dados concatenados s√£o hash.  Na maioria das vezes, isso acontece usando a fun√ß√£o de hash SHA-256. <br><br>  O segundo tipo inclui carteiras determin√≠sticas hier√°rquicas (carteiras HD), cujos princ√≠pios s√£o definidos no BIP32 e s√£o uma abordagem muito comum para a gera√ß√£o de chaves hier√°rquicas. <br><br><h3>  Gera√ß√£o determinininista </h3><br>  Considere as diferen√ßas entre esses tipos de carteiras no diagrama. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/271/a5a/477/271a5a47790684700751178bcee9d340.png" alt="imagem"><br><br>  Uma carteira determin√≠stica comum possui alguma semente, da qual um grande n√∫mero de chaves privadas √© gerado diretamente.  Seu n√∫mero pode ser limitado apenas pela dimens√£o do √≠ndice, que concatena com o segredo antes do hash.  Normalmente, s√£o 4 bytes, ou seja, o espa√ßo de op√ß√µes poss√≠veis permite cerca de 4 bilh√µes de chaves determin√≠sticas exclusivas da carteira.  Na pr√°tica, isso deve ser suficiente para qualquer situa√ß√£o. <br><br><h3>  Gera√ß√£o determin√≠stica hier√°rquica </h3><br>  Vamos seguir para uma carteira determin√≠stica hier√°rquica, cujo principal esquema de implanta√ß√£o √© apresentado de uma forma simplificada at√© o momento.  H√° sementes, das quais √© obtido diretamente um par de chaves mestras.  Se em uma carteira determin√≠stica comum obtemos uma chave privada, ent√£o aqui temos um par de chaves.  Al√©m disso, existem n√≠veis de hierarquia, em cada um dos quais calculamos o √≠ndice para gerar a chave filha.  Tamb√©m podemos criar ramifica√ß√µes de chave p√∫blica e ramifica√ß√£o de chave privada. <br><br><h3>  N√≠veis de hierarquia </h3><br>  Em rela√ß√£o √†s carteiras HD, √© importante notar que, de acordo com as regras do BIP32 em cada n√≠vel da hierarquia, o n√≥ de gera√ß√£o possui tr√™s objetos: uma chave privada, uma chave p√∫blica e um c√≥digo de cadeia que √© usado para gerar o pr√≥ximo n√≠vel de hierarquia. <br><br><h3>  Esquema de gera√ß√£o hier√°rquica </h3><br>  Vamos considerar com mais detalhes o esquema de gera√ß√£o de chaves para o BIP32. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/685/e79/e3e/685e79e3eae45b867f3033aad03f1743.png" alt="imagem"><br><br>  Tudo come√ßa com a semente, tamb√©m √© chamado de semente principal, a partir da qual √© calculado o n√≠vel zero da hierarquia - um par de chaves mestras e c√≥digo de cadeia. <br><br>  Um grande n√∫mero de pares de chaves com √≠ndices espec√≠ficos pode ser gerado a partir de um par de chaves mestras.  Um novo n√≠vel de hierarquia est√° sendo formado, usado para gerar contas.  Suponha que um usu√°rio tenha semente e queira criar v√°rios endere√ßos que ser√£o diferentes um do outro.  As moedas desses endere√ßos n√£o ser√£o misturadas, n√£o ser√£o publicadas juntas e, nas transa√ß√µes conclu√≠das entre eles, n√£o ser√° poss√≠vel encontrar uma conex√£o.  Essas teclas ser√£o usadas completamente separadamente uma da outra.  Em uma das contas, o grupo-chave ser√° usado para o or√ßamento de trabalho, na outra para o or√ßamento pessoal e em outra conta para a escritura√ß√£o em preto.  As moedas n√£o se misturam. <br><br>  O pr√≥ximo n√≠vel de hierarquia define diferentes cadeias de gera√ß√£o de chaves.  Na maioria das vezes, s√£o usadas cadeias com os √≠ndices 0 e 1. Uma cadeia com o √≠ndice 0 gerar√° chaves finais para formar um endere√ßo para pagamentos recebidos, e uma cadeia com o √≠ndice 1 gerar√° carteiras de moedas enviadas pelo usu√°rio a eles mesmos, ou seja, altera√ß√µes.  Isso √© necess√°rio para que a carteira no n√≠vel do programa distinga os pagamentos enviados de fora da altera√ß√£o, calcule as altera√ß√µes no saldo de cada transa√ß√£o e compile uma lista visual com o hist√≥rico de todos os pagamentos.  Isso simplifica o desenvolvimento da carteira e seu uso para pagamentos di√°rios. <br><br><h3>  C√≥digo de autentica√ß√£o de mensagem com base em hash </h3><br>  Agora vamos para o componente matem√°tico dos processos hier√°rquicos de gera√ß√£o de chaves.  Para come√ßar, considere o c√≥digo de autentica√ß√£o de mensagens com base em hash.  Esta √© uma classe diferente para calcular fun√ß√µes de hash.  Difere na medida em que leva dois valores na entrada, e n√£o um.  O primeiro valor √© a chave privada e o segundo √© a pr√≥pria mensagem. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>K</mi><mo>,</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.281ex" height="3.021ex" viewBox="0 -987.6 19065.2 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-48" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-4D" x="888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-41" x="1940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-43" x="2690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-28" x="3451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-4B" x="3840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-2C" x="4730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-6D" x="5175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-29" x="6053" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-3D" x="6720" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-48" x="7777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-28" x="8665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-28" x="9055" y="0"></use><g transform="translate(9444,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-4B" x="0" y="0"></use><g transform="translate(901,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-70" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-61" x="989" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-64" x="1518" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-29" x="11890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-7C" x="12279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-7C" x="12558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-48" x="12836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-28" x="13725" y="0"></use><g transform="translate(14114,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-4B" x="0" y="0"></use><g transform="translate(901,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-70" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-61" x="849" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-64" x="1378" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-29" x="16461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-7C" x="16850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-7C" x="17129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-6D" x="17407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-29" x="18286" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-29" x="18675" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mi>K</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msup><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> HMAC (K, m) = H ((K ^ {opad}) || H (K ^ {ipad}) || m)) </script></p><br><br>  K √© a chave <br>  m - mensagem <br>  opad, ipad - alguns valores constantes necess√°rios para gerar chaves diferentes umas das outras em diferentes est√°gios do hash. <br>  Como uma fun√ß√£o hash, o SHA-512 √© usado. <br><br>  A peculiaridade √© que, para usar o HMAC, voc√™ precisa possuir uma chave secreta para obter o valor correto de hash da mensagem. <br><br>  Portanto, para calcular o valor do hash HMAC, o valor da chave XOR est√° com o valor constante do ipad, ap√≥s o qual o resultado √© hash.  Uma mensagem √© concatenada para esse valor, ap√≥s o qual a chave XOR √© calculada com um valor constante, concatenada com um valor de hash e, em seguida, hash novamente.  Como resultado, obtemos 512 bits do valor do hash. <br><br><h3>  Fun√ß√µes de deriva√ß√£o </h3><br>  Vejamos algumas fun√ß√µes usadas no c√°lculo de chaves hier√°rquicas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96e/f47/b41/96ef47b4141a2060395a9933dd56c52f.png" alt="imagem"><br><br>  Antes de tudo, estamos interessados ‚Äã‚Äãem converter a semente principal em um par de chaves principais.  Depois disso, voc√™ precisa obter a chave privada filho e a chave p√∫blica filho da chave pai pessoal.  No segundo caso, a mesma fun√ß√£o exata √© usada como no primeiro, mas a multiplica√ß√£o do n√∫mero pelo ponto base √© adicionada, portanto, n√£o ser√° considerada separadamente.  A pr√≥xima etapa √© obter o p√∫blico filho da chave pai p√∫blica.  Vale ressaltar que n√£o √© poss√≠vel obter um filho pessoal da chave p√∫blica pai.  Essa limita√ß√£o se deve a certas propriedades inerentes √†s carteiras HD, que consideraremos mais adiante. <br><br>  Ent√£o, vamos analisar cada uma das fun√ß√µes de gera√ß√£o separadamente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/736/372/31c/73637231c62a14b4bf5f8e7a5d498d01.png" alt="imagem"><br><br>  Para obter a chave mestra do master sid, √© usada a fun√ß√£o HMAC, onde a cadeia constante "Bitcoin seed" √© transmitida como a chave e os principais dados secretos em si como uma mensagem.  Assim, √© obtido um valor de hash de 512 bits, que consideramos como duas partes: esquerda e direita.  O lado esquerdo √© a chave privada mestra e o lado direito ser√° o c√≥digo da cadeia.  Al√©m disso, esses valores ser√£o usados ‚Äã‚Äãpara gerar n√≠veis subsequentes de chaves filho. <br><br>  Para tornar o mestre p√∫blico, basta multiplicar o valor do ponto base pelo valor da chave privada mestre.  Como voc√™ pode ver, isso acontece por analogia com chaves comuns em um grupo de pontos em uma curva el√≠ptica. <br><br>  Agora vamos ver como a chave privada filho vem do pai particular. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a6f/eeb/022/a6feeb0227ea2d2ba18ed42ce4d47d01.png" alt="imagem"><br><br>  Usaremos a fun√ß√£o HMAC novamente.  Como chave, passamos o c√≥digo da cadeia do n√≠vel atual da hierarquia e, como mensagem, concatena√ß√£o, onde a primeira parte ser√° a chave pai pessoal multiplicada pelo ponto base.  De fato, isso √© feito para um ponto e a serializa√ß√£o desse ponto.  A concatena√ß√£o ocorre com o √≠ndice da chave filha que queremos receber, serializado em 32 bits, ou seja, 4 bytes. <br><br>  Com base no resultado da fun√ß√£o HMAC, obtemos o valor I e, novamente, o consideramos separadamente: as partes esquerda e direita dos valores de sa√≠da s√£o 256 bits.  Em seguida, a chave privada filho <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>k</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.419ex" viewBox="0 -780.1 865.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-69" x="737" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>k</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> k_i </script>  calculamos adicionando ao valor de sa√≠da esquerdo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>l</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.746ex" height="2.419ex" viewBox="0 -780.1 751.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-6C" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>l</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5"> I_l </script>  valores da chave privada pai.  A adi√ß√£o √© feita no m√≥dulo n, onde n √© a ordem do ponto base da curva el√≠ptica, para n√£o exceder o valor m√°ximo da chave privada.  Assim, recebemos uma chave privada filho. <br><br>  Por conseguinte, o c√≥digo da cadeia filho ser√° igual ao valor de sa√≠da correto da fun√ß√£o HMAC, ou seja, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>R</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.503ex" height="2.419ex" viewBox="0 -780.1 1077.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-52" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>R</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6"> I_R </script>  .  Se quisermos encontrar a chave p√∫blica filha da chave pai pessoal, multiplicamos o valor <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>k</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.419ex" viewBox="0 -780.1 865.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-69" x="737" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>k</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> k_i </script>  pelo valor do ponto base na curva el√≠ptica.  Ent√£o, n√≥s obtemos a chave p√∫blica <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.773ex" height="2.419ex" viewBox="0 -780.1 1193.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMATHI-69" x="1201" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8"> K_i </script>  . <br><br>  Como calculamos a chave p√∫blica filha da chave pai p√∫blica? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39a/bbe/e55/39abbee5560b44abbe7a271a88153198.png" alt="imagem"><br><br>  Aqui o c√°lculo ser√° um pouco diferente.  Passamos a hierarquia da cadeia do n√≠vel atual da hierarquia como uma chave para a fun√ß√£o HMAC, ap√≥s a qual serializamos a chave p√∫blica pai e a concatenamos com o √≠ndice desejado serializado em 32 bits.  Os dados de entrada s√£o obtidos exatamente da mesma maneira que no caso anterior.  Para calcular a chave p√∫blica, pegamos o lado esquerdo do valor de sa√≠da da fun√ß√£o HMAC e consideramos como 256 bits modulados a ordem do ponto de base, levamos-o a um ponto na curva el√≠ptica, ou seja, multiplique pelo ponto de base e depois adicione o resultado com a chave p√∫blica pai .  O resultado da adi√ß√£o tamb√©m ser√° um ponto, e ser√° uma chave filho p√∫blica.  O c√≥digo da cadeia para essa chave ser√° o lado direito do valor de sa√≠da da fun√ß√£o HMAC. <br><br><h3>  Correspond√™ncia de teclas entre si </h3><br>  Isso pode levantar uma quest√£o l√≥gica sobre como as chaves p√∫blicas e privadas obtidas de maneiras diferentes corresponder√£o uma √† outra.  √â realmente poss√≠vel obter exatamente o mesmo valor de uma chave p√∫blica gerada por uma maneira p√∫blica, pegando uma chave privada obtida de outra maneira e multiplicando-a por um ponto base?  Isso √© f√°cil de verificar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e44/ac2/851/e44ac28516cc2774373bc76d94d0c244.png" alt="imagem"><br><br>  Se lembrarmos de como calculamos a chave filho pessoal e a multiplicarmos pelo ponto base, ou seja, traz√™-lo para a fun√ß√£o de ponto, e depois recordar o c√°lculo da chave p√∫blica filho e comparar esses c√°lculos, veremos que se considerarmos a chave p√∫blica pai como um produto do pai pessoal chave para o ponto base, veremos que os mesmos c√°lculos foram realizados, apenas em uma ordem diferente. <br><br>  Em um caso, adicionamos as chaves privadas e multiplicamos pelo ponto base, e no segundo caso, primeiro multiplicamos os valores pelo ponto base e depois os adicionamos e obtivemos o resultado.  Com base no fato de que a opera√ß√£o de adi√ß√£o de pontos em uma curva el√≠ptica √© aditiva, podemos dizer que esses dois valores s√£o iguais - obteremos a mesma chave p√∫blica calculada de duas maneiras. <br><br><h3>  Exemplo de chave p√∫blica </h3><br>  Por uma quest√£o de interesse, podemos ver um exemplo de uma chave p√∫blica que foi obtida para valores de teste e c√°lculos BIP32.  Se nossa Entropia consistir em 128 bits, no sistema num√©rico hexadecimal ser√° semelhante √† imagem abaixo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64c/ca1/01a/64cca101a12268bda803fd8f447c719e.png" alt="imagem"><br><br>  O mesmo valor codificado na frase mnem√¥nica do BIP39 ser√° semelhante √†s 12 palavras mostradas.  Se voc√™ usar esta frase mnem√¥nica como uma semente principal para a gera√ß√£o hier√°rquica de chaves, obter√° uma chave privada principal com o c√≥digo de cadeia de 256 bits correspondente. <br><br><h3>  Chaves estendidas </h3><br>  Tamb√©m existem conceitos como chave p√∫blica estendida e chave privada estendida.  Como √© usado?  Para entender melhor, descrevemos a situa√ß√£o visual. <br><br>  Digamos que temos um usu√°rio espec√≠fico e algum servi√ßo.  Um servi√ßo transfere pagamentos, por exemplo em bitcoins, para um usu√°rio com uma certa frequ√™ncia.  Tanto o usu√°rio quanto o servi√ßo est√£o interessados ‚Äã‚Äãem usar um novo endere√ßo para cada pagamento, a fim de dificultar para um observador externo estabelecer um fato e confundir o hist√≥rico de intera√ß√£o entre si. <br><br>  No caso mais simples, seria assim: o usu√°rio para cada pagamento recebido gera um novo par de chaves, calcula o endere√ßo que ele passa para o servi√ßo, ap√≥s o qual o servi√ßo pode gerar uma transa√ß√£o e concluir o pagamento.  No entanto, isso √© inconveniente para qualquer uma das partes se a intensidade desses pagamentos for alta. <br><br><h3>  Chave p√∫blica estendida </h3><br>  Em uma situa√ß√£o semelhante, a chave p√∫blica estendida (xPubKey) ajuda a se livrar do inconveniente.  O usu√°rio pode permitir que um servi√ßo de terceiros gere endere√ßos, em vez de si mesmos, que ser√£o conhecidos pelo servi√ßo, mas apenas o usu√°rio ter√° chaves privadas.  O servi√ßo pode gerar qualquer n√∫mero de endere√ßos sem o conhecimento do usu√°rio e enviar fundos para ele, e o usu√°rio pode, conforme sua conveni√™ncia, implantar chaves privadas e obter acesso a qualquer um desses endere√ßos. <br><br>  Como isso funciona?  O usu√°rio precisa gerar uma nova conta no segundo n√≠vel da hierarquia de chaves, calcular para ele a chave p√∫blica e o c√≥digo da cadeia para o n√≠vel atual.  Depois disso, voc√™ precisa transferir a chave p√∫blica e o c√≥digo da cadeia para o servi√ßo.  Por conveni√™ncia, foi introduzida a codifica√ß√£o Base58Check, sobre a qual falamos (h√° uma vers√£o especial aqui).  Em seguida, a chave p√∫blica, o c√≥digo da cadeia e a soma de verifica√ß√£o s√£o concatenados.  Tudo isso √© codificado no sistema de n√∫meros base 58 e obtemos uma chave p√∫blica estendida j√° codificada de acordo com um determinado padr√£o.  Come√ßa com os caracteres "xpub", que s√£o facilmente reconhecidos.  Aparecer√° como mostrado na imagem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c61/aae/082/c61aae082f6a423d35712fcf63246f68.png" alt="imagem"><br><br>  Um servi√ßo pode aceitar essa chave e implantar chaves p√∫blicas para o usu√°rio via BIP32, receber endere√ßos deles e pagar por eles.  No entanto, apenas o usu√°rio pode calcular as chaves privadas correspondentes. <br><br><h3>  Deriva√ß√£o endurecida </h3><br>  Na gera√ß√£o hier√°rquica de chaves, existe uma deriva√ß√£o endurecida.  Essa √© uma abordagem que n√£o permite o c√°lculo de chaves p√∫blicas filho da chave p√∫blica pai correspondente.  Isso difere da gera√ß√£o normal, pois usamos a concatena√ß√£o do ponto serializado como chave p√∫blica pai como uma mensagem para a fun√ß√£o HMAC, e na deriva√ß√£o refor√ßada usamos a serializa√ß√£o da chave privada pai. <br><br>  Al√©m disso, o c√°lculo do √≠ndice √© diferente.  O √≠ndice na gera√ß√£o normal √© serializado diretamente em 32 bits e na deriva√ß√£o endurecida √© ligeiramente convertido: um valor constante √© adicionado a ele <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>31</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-9"> 2 ^ {31} </script>  que define o bit mais significativo como 1 (torna-se f√°cil distinguir entre tipos de deriva√ß√£o).  Consequentemente, o espa√ßo de variantes de chaves poss√≠veis √© o mesmo para gera√ß√£o normal e deriva√ß√£o endurecida, e √© igual a <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>31</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhg3MTBZv_xt2FyD0S1emrlQFvCdRg#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-10"> 2 ^ {31} </script>  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cea/160/ab3/cea160ab30c57ea702407dd53893d25e.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assim, tendo uma chave p√∫blica pai e deriva√ß√£o refor√ßada, n√£o √© poss√≠vel calcular chaves p√∫blicas filho. </font><font style="vertical-align: inherit;">Se o invasor receber a chave p√∫blica pai, ele n√£o poder√° calcular as chaves filho. </font><font style="vertical-align: inherit;">Portanto, n√£o ser√° poss√≠vel calcular os endere√ßos e seus relacionamentos com a chave pai recebida. </font><font style="vertical-align: inherit;">No caso de deriva√ß√£o normal, ou seja, no habitual, essa fun√ß√£o pode ser usada e rastrear a rela√ß√£o de endere√ßos entre si.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Caminhos de gera√ß√£o </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos falar sobre as maneiras pelas quais as chaves podem ser geradas. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7d/0bc/006/c7d0bc0061acf64d206c73d305de73c4.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em cada n√≠vel da hierarquia, h√° um √≠ndice espec√≠fico que define aspectos da gera√ß√£o de chaves. O caminho da chave mestra at√© a chave final pode ser escrito atrav√©s de barras como √≠ndices. Se estamos falando de uma chave privada, a grava√ß√£o come√ßa com um pequeno "m" e, se estamos falando de gerar uma chave p√∫blica, ent√£o com um grande "M". Se o √≠ndice for indicado por um ap√≥strofo, deve-se entender que estamos falando de deriva√ß√£o endurecida, sem uma deriva√ß√£o ap√≥strofe - normal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considere um dos caminhos populares de gera√ß√£o de chaves usados ‚Äã‚Äãno BIP32, onde chaves hier√°rquicas foram definidas.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ab/564/b7c/1ab564b7cbe935bfbe5aa2075c1fce31.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ele usa um caminho em que a chave mestra √© o n√≠vel zero da hierarquia. A seguir, est√£o os √≠ndices de contas que designam o mesmo usu√°rio, seguidos por cadeias nas quais pode haver cadeias de endere√ßos publicadas fora para aceitar pagamentos recebidos e, com o √≠ndice 1, essas cadeias ser√£o criadas para as quais o usu√°rio envia pagamentos para si mesmo (com mais frequ√™ncia tudo isso √© rendi√ß√£o). O √≠ndice final ser√° usado para gerar as chaves a partir das quais os endere√ßos ser√£o calculados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para calcular a primeira chave com o √≠ndice 0 de acordo com o padr√£o BIP32, teremos m, 0 com a gera√ß√£o de cadeia endurecida - 0, √≠ndice - 0 (m / 0 '/ 0/0). Portanto, obtemos o caminho para a primeira chave gerada hierarquicamente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° uma sugest√£o para melhorar o Bitcoin, chamado BIP43, que envolve escrever para o primeiro n√≠vel da hierarquia o n√∫mero de melhoria, que oferece um novo caminho de desova (m / bip_number '/ *). </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/68c/652/61f/68c65261f576ac3e75c412c2de9b50b5.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assim, apareceu o BIP44, que utilizava o recurso da senten√ßa anterior, ou seja, o √≠ndice 44 √© escrito para o primeiro n√≠vel hier√°rquico e propunha as seguintes melhorias: no √≠ndice do segundo n√≠vel hier√°rquico, registre um determinado valor que corresponda ao tipo de moeda que usamos para esta carteira. Agora, chaves para diferentes moedas podem ser implantadas e usadas em uma carteira.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/23b/739/3bd/23b7393bd44abf5568d476c03d0a8bf8.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para Bitcoin, o caminho ser√° semelhante a "m / 44 '/ 0' / 0 '/ 0/0", para Bitcoin testnet - "m / 44' / 1 '/ 0' / 0/0", para Litecoin - "m / 44 '/ 2' / 0 '/ 0/0 ‚Äù, para Dash -‚Äú m / 44' / 5 '/ 0' / 0/0 ‚Äù. Curiosamente, o Ethereum usa exatamente a mesma curva el√≠ptica para calcular chaves e assinar digitalmente e, para a carteira, o caminho ser√° semelhante a ‚Äúm / 44 '/ 60' / 0 '/ 0/0‚Äù. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° outra melhoria - BIP45. A melhoria visa determinar as regras para a gera√ß√£o de chaves no caso de seu uso em carteiras com v√°rias assinaturas e a forma√ß√£o de endere√ßos usando o BIP16, isto √©, P2SH. Ele inclui a senten√ßa BIP43 e indica o √≠ndice 45 no primeiro n√≠vel da hierarquia; no segundo n√≠vel da hierarquia, requer uma indica√ß√£o de um assinante (co-signat√°rio).</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4bc/2c8/fd1/4bc2c8fd1c785ef5c9deb48417db9c53.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, h√° uma regra de 3 de 5 assinaturas m√∫ltiplas. Portanto, existem 5 signat√°rios, mas para gastar moedas, voc√™ precisa de pelo menos 3 assinaturas. Assim, cada um dos signat√°rios ter√° uma carteira HD com sua pr√≥pria semente principal e indicar√° seu n√∫mero de s√©rie em seu caminho. Pode ser calculado como um √≠ndice ao classificar as chaves geradas no primeiro n√≠vel da hierarquia de cada usu√°rio. Suponha que, no primeiro n√≠vel, cada usu√°rio gere chaves, eles troquem entre si, classifiquem e descubram quem possui qual √≠ndice para o segundo n√≠vel da hierarquia. Isso √© necess√°rio para eliminar ainda mais a necessidade de interagir dessa maneira, e imediatamente gerar corretamente endere√ßos e saber seu n√∫mero de s√©rie.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou seja, voc√™ pode trocar a chave p√∫blica estendida uma vez para poder independentemente, independentemente de outros membros do grupo, formar endere√ßos com v√°rias assinaturas e aceitar pagamentos por eles.</font></font><br><br><h3>  Perguntas </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos passar para as perguntas mais frequentes. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Como as sementes mestras diferem em moedas diferentes?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seed √© um n√∫mero gerado aleatoriamente, uma sequ√™ncia de bits, ou √© uma frase mnem√¥nica gerada, por exemplo, de acordo com o BIP39, que √© usado para gerar chaves. Pode ser usado para uma moeda e para qualquer outra - n√£o √© necess√°rio usar frases mnem√¥nicas diferentes para moedas diferentes. Al√©m disso, existe o BIP44, que define as regras para gerar chaves para diferentes moedas a partir da mesma frase mnem√¥nica. Essas chaves privadas n√£o se cruzam, mas ser√£o usadas para diferentes endere√ßos de diferentes moedas. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Dicion√°rio do BIP39, onde s√£o padronizadas 2048 palavras para uma frase mnem√¥nica? Posso us√°-lo em todas as carteiras e aplicativos?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O fato √© que esse padr√£o √© descrito para o BIP39. √â para o BIP39 que existem dicion√°rios: ingl√™s, dois japoneses, chineses, italianos, russos, ucranianos etc. Ou seja, se algum aplicativo afirma que usa o BIP39 e possibilita importar e exportar uma frase mnem√¥nica, significa que ele tamb√©m usa um conjunto de palavras o mesmo. No entanto, existem carteiras que n√£o usam o BIP39, mas suas pr√≥prias modifica√ß√µes. Voc√™ precisa examinar a descri√ß√£o da carteira e usar o desenvolvimento padronizado ou pr√≥prio, ou o desenvolvimento do servi√ßo que a carteira oferece. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Em trocas e armazenamentos centralizados como o Coinbase, as chaves da carteira de todos os usu√°rios s√£o geradas a partir da mesma frase comum para todos ou n√£o?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â dif√≠cil dizer porque eles n√£o abrem sua estrutura interna, mas esses novos servi√ßos que aparecem podem gerar chaves separadamente, usar o padr√£o BIP32 ou usar sua vers√£o modificada. Os servi√ßos que existiam antes dos padr√µes para gera√ß√£o de chave hier√°rquica pareciam, provavelmente, continuam gerando apenas chaves privadas separadas. Talvez seja assim que eles s√£o mais f√°ceis de gerenciar, se houver uma grande rotatividade de todas as chaves. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"A chave √© um ponto na curva el√≠ptica, ou seja, dois n√∫meros muito grandes X e Y?"</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A chave p√∫blica - sim, este √© um ponto na curva el√≠ptica, e a chave privada √© um n√∫mero natural que mostra quantas vezes voc√™ precisa adicionar o ponto base consigo mesmo. A chave p√∫blica em si consiste em dois valores - essas s√£o as coordenadas X e Y, cada uma com um tamanho de 256 bits. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- O que √© "convertido em ponto" e serializa√ß√£o de ponto e √≠ndice?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reduzir a um ponto significa que existe um n√∫mero natural, que consideramos uma chave privada. Adicionamos o ponto base conosco tantas vezes, ou seja, no grupo de pontos na curva el√≠ptica, apenas a opera√ß√£o de adi√ß√£o √© definida, e podemos multiplicar o ponto por um n√∫mero natural. Serializa√ß√£o de um ponto significa gravar de uma certa maneira duas coordenadas. Este pode ser um registro compactado, mas n√£o necess√°rio. Comprimido no sentido de que uma das coordenadas, ou seja, Y, √© convertida em um sinal, os dados s√£o substitu√≠dos na equa√ß√£o e examinam onde est√° o ponto: acima ou abaixo. No caso de serializa√ß√£o de √≠ndice, voc√™ precisa entender que um n√∫mero regular, que, dependendo do tamanho, pode ser escrito em bytes ou bits. Quanto maior o n√∫mero, mais dados ser√£o necess√°rios. No caso dos c√°lculos que examinamos,√© necess√°rio um n√∫mero de um determinado comprimento. Voc√™ precisa serializ√°-lo para um comprimento espec√≠fico - 4 bytes. Como resultado, isso se refere √† convers√£o do √≠ndice para um n√∫mero de 4 bytes. Se os valores s√™nior permanecerem vazios l√°, eles ser√£o zero.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Quem apresentou esses c√°lculos para as fun√ß√µes de deriva√ß√£o das carteiras HD? Por que essas f√≥rmulas onde existem justificativas e onde voc√™ pode ler mais sobre isso?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Voc√™ pode ler mais no BIP32, se estiver interessado em uma frase mnem√¥nica, depois no BIP39, etc. Voc√™ pode abrir o GitHub e encontrar um usu√°rio sob o apelido Bitcoin. Ele tem um reposit√≥rio Bitcoin onde o c√≥digo fonte do Bitcoin est√° armazenado e um reposit√≥rio BIPs (fonte prim√°ria), onde todas as sugest√µes para melhorar o Bitcoin s√£o registradas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eles tiveram a id√©ia de fazer c√°lculos dessa maneira, porque est√£o ligados a um grupo de pontos de uma curva el√≠ptica. Quando voc√™ desejava obter essa funcionalidade que permite calcular separadamente as ramifica√ß√µes das chaves p√∫blicas e privadas, mantendo a correspond√™ncia entre si, essa era a op√ß√£o de implementa√ß√£o mais f√°cil. De fato, os desenvolvedores usaram a op√ß√£o mais simples, que permite obter propriedades interessantes usando a criptografia que foi testada pelo tempo. Os autores das melhorias propostas s√£o muitos. A comunidade Bitcoin, cujos participantes oferecem algum tipo de desenvolvimento de melhorias e transforma√ß√µes matem√°ticas, √© bastante grande. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- A deriva√ß√£o endurecida √© sempre apenas no segundo n√≠vel da hierarquia?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tudo depende da situa√ß√£o. No caso de gerar chaves para v√°rias assinaturas, faz sentido fazer deriva√ß√µes protegidas apenas no primeiro n√≠vel da hierarquia. No BIP44, a deriva√ß√£o endurecida √© aplicada aos tr√™s primeiros n√≠veis: no primeiro n√≠vel √© o n√∫mero do BIP em si, no segundo √© o n√∫mero da conta em que √© relevante, no terceiro √© o n√∫mero da moeda em que tamb√©m faz sentido. Suponha que voc√™ provavelmente n√£o goste se publicar a chave p√∫blica e, atrav√©s dela, as pessoas poder√£o rastrear todos os seus endere√ßos no Bitcoin. Se voc√™ usar uma conta para receber pagamentos de determinados servi√ßos, poder√° divulgar essa chave e n√£o precisar√° de deriva√ß√£o refor√ßada aqui. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Onde √© poss√≠vel aplicar a gera√ß√£o hier√°rquica de chaves?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode aplic√°-lo ao trabalhar com a central para que a central sempre o pague em endere√ßos diferentes. </font><font style="vertical-align: inherit;">Embora, nesse caso, seja melhor organizar tudo isso manualmente. </font><font style="vertical-align: inherit;">Isso √© mais relevante para as carteiras digitais di√°rias, porque aqui √© um processo muito simples criar um backup de chaves privadas e restaurar uma carteira. </font><font style="vertical-align: inherit;">A gera√ß√£o de chaves para diferentes moedas tamb√©m √© suportada, e o pr√≥prio padr√£o j√° √© usado em diferentes implementa√ß√µes de carteiras digitais. </font><font style="vertical-align: inherit;">As chaves entre essas carteiras s√£o convenientes para transferir usando a mesma frase mnem√¥nica. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este t√≥pico √© abordado em uma das palestras do curso online de blockchain " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gera√ß√£o de chaves hier√°rquicas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt413627/">https://habr.com/ru/post/pt413627/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt413615/index.html">O v√≠rus VPNFilter, que infectou 500 mil roteadores, se mostrou ainda mais perigoso do que se pensava</a></li>
<li><a href="../pt413617/index.html">Alterou 30% dos termos de refer√™ncia e duas vezes excedeu o plano: como a VTB automatizou os relat√≥rios</a></li>
<li><a href="../pt413619/index.html">Novas informa√ß√µes sobre o VPNFilter: conduzindo um ataque aos dispositivos do usu√°rio, expandiu a lista de equipamentos de rede</a></li>
<li><a href="../pt413621/index.html">Viva isso. Die. Ressuscitar. Repetir</a></li>
<li><a href="../pt413623/index.html">Como fazer falar Omega 2 ou a lenda do I2S</a></li>
<li><a href="../pt413631/index.html">Criptografia de token de certificado em um token no Linux usando o exemplo de JaCarta, Debian e o cliente de correio Evolution</a></li>
<li><a href="../pt413633/index.html">Como eu dominei o ingl√™s</a></li>
<li><a href="../pt413635/index.html">N√≥s projetamos uma fazenda de gado. E usa o nanoCAD VK?</a></li>
<li><a href="../pt413637/index.html">O Google publicou 7 princ√≠pios de √©tica da IA</a></li>
<li><a href="../pt413639/index.html">Smartphones protegidos: quem precisa e como eles diferem um do outro?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>