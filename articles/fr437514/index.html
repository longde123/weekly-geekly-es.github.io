<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ö üë®üèΩ‚Äçüç≥ üë§ Recherche d'erreurs dans le code source du SDK Amazon Web Services pour .NET ü§üüèø ‚¨ÖÔ∏è üë≤üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bienvenue √† tous les fans de la corbeille du code de quelqu'un d'autre. :) Aujourd'hui, dans notre laboratoire, nous avons un nouveau mat√©riel pour un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Recherche d'erreurs dans le code source du SDK Amazon Web Services pour .NET</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/437514/"><p><img src="https://habrastorage.org/getpro/habr/post_images/188/292/f27/188292f271dd0648b09f848dbe66efa6.png" alt="Image 1"></p><br>  Bienvenue √† tous les fans de la corbeille du code de quelqu'un d'autre.  :) Aujourd'hui, dans notre laboratoire, nous avons un nouveau mat√©riel pour une recherche - le code source du projet AWS SDK for .NET.  √Ä l'√©poque, nous avons √©crit un article sur la v√©rification d'AWS SDK pour C ++.  Il n'y avait alors rien de particuli√®rement int√©ressant.  Voyons ce que vaut .NET de la version AWS SDK.  Encore une fois, c'est une excellente occasion de d√©montrer les capacit√©s de l'analyseur PVS-Studio et de rendre le monde un peu meilleur. <br><a name="habracut"></a><br>  Le SDK Amazon Web Services (AWS) pour .NET est un ensemble d'outils de d√©veloppeur, destin√© √† cr√©er des applications bas√©es sur .NET dans l'infrastructure AWS.  Cet ensemble permet de simplifier consid√©rablement le processus d'√©criture de code.  Le SDK comprend des ensembles API .NET pour divers services AWS, tels que Amazon S3, Amazon EC2, DynamoDB et autres.  Le code source du SDK est disponible sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> . <br><br>  Comme je l'ai mentionn√©, √† l'√©poque, nous avions d√©j√† √©crit l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> sur la v√©rification d'AWS SDK pour C ++.  L'article s'est av√©r√© √™tre petit - seulement quelques erreurs trouv√©es pour 512 000 lignes de code.  Cette fois, nous avons affaire √† une taille beaucoup plus grande du code, qui comprend environ 34 000 fichiers cs, et le nombre total de lignes de code (√† l'exclusion des lignes vides) est impressionnant de 5 millions.  Une petite partie du code (200 000 lignes dans des fichiers 664-cs) revient aux tests, je ne les ai pas pris en compte. <br><br>  Si la qualit√© du code .NET de la version SDK est approximativement la m√™me que celle de C ++ (deux erreurs par 512 KLOC), alors nous devrions obtenir un nombre d'erreurs environ 10 fois plus √©lev√©.  Bien s√ªr, il s'agit d'une m√©thodologie de calcul tr√®s inexacte, qui ne prend pas en compte les particularit√©s linguistiques et de nombreux autres facteurs, mais je ne pense pas que le lecteur veuille maintenant entrer dans un raisonnement ennuyeux.  Au lieu de cela, je sugg√®re de passer aux r√©sultats. <br><br>  La v√©rification a √©t√© effectu√©e √† l'aide de PVS-Studio 6.27.  C'est tout simplement incroyable, mais le fait est que dans l'AWS SDK pour .NET, l'analyseur a r√©ussi √† d√©tecter 40 erreurs, ce qui vaut la peine d'en parler.  Il d√©montre non seulement une haute qualit√© du code SDK (environ 4 erreurs pour 512 KLOC), mais √©galement une qualit√© comparable de l'analyseur C # PVS-Studio par rapport √† C ++.  Un super r√©sultat! <br><br>  Auteurs d'AWS SDK pour .NET, vous √™tes de vrais champions!  Avec chaque projet, vous d√©montrez une qualit√© exceptionnelle du code.  Cela peut √™tre un excellent exemple pour d'autres √©quipes.  Cependant, bien s√ªr, je ne serais pas un d√©veloppeur d'un analyseur statique, si je ne donnais pas mes 2 cents.  :) Nous travaillons d√©j√† avec une √©quipe Lumberyard d'Amazon sur l'utilisation de PVS-Studio.  Comme il s'agit d'une tr√®s grande entreprise avec un tas d'unit√©s dans le monde, il est tr√®s probable que l'√©quipe AWS SDK pour .NET n'ait jamais entendu parler de PVS-Studio.  Quoi qu'il en soit, je n'ai trouv√© aucun signe d'utilisation de notre analyseur dans le code SDK, bien qu'il ne dise rien.  Cependant, au moins, l'√©quipe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilise</a> l'analyseur int√©gr√© √† Visual Studio.  C'est g√©nial, mais les r√©visions de code peuvent toujours √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">am√©lior√©es</a> :). <br><br>  En cons√©quence, j'ai r√©ussi √† trouver quelques bugs dans le code SDK et, enfin, il est temps de les partager. <br><br>  <b>Erreur de logique</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3008</a> [CWE-563] La variable 'this.linker.s3.region' re√ßoit des valeurs successives deux fois.  C'est peut-√™tre une erreur.  V√©rifiez les lignes: 116, 114. AWSSDK.DynamoDBv2.Net45 S3Link.cs 116 <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> Region { get { .... } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (String.IsNullOrEmpty(value)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linker.s3.region = <span class="hljs-string"><span class="hljs-string">"us-east-1"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linker.s3.region = value; } }</code> </pre> <br>  L'analyseur met en garde contre l'attribution r√©p√©t√©e de valeurs √† la m√™me variable.  √Ä partir du code, il devient clair que cela est d√ª √† l'erreur qui viole la logique du travail du programme: la valeur de la variable <i>this.linker.s3.region</i> sera toujours √©gale √† la valeur de la valeur de la variable, quelle que soit la condition <i>if (String.IsNullOrEmpty (value))</i> .  <i>La</i> d√©claration de <i>retour a</i> √©t√© manqu√©e dans le corps du bloc <i>if</i> .  Le code doit √™tre corrig√© comme suit: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> Region { get { .... } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (String.IsNullOrEmpty(value)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linker.s3.region = <span class="hljs-string"><span class="hljs-string">"us-east-1"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linker.s3.region = value; } }</code> </pre> <br>  <b>R√©cursion infinie</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3110</a> [CWE-674] R√©cursion infinie possible dans la propri√©t√© 'OnFailure'.  AWSSDK.ElasticMapReduce.Net45 ResizeJobFlowStep.cs 171 <br><br><pre> <code class="cpp hljs">OnFailure? onFailure = null; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OnFailure? OnFailure { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.OnFailure; } <span class="hljs-comment"><span class="hljs-comment">// &lt;= set { this.onFailure = value; } }</span></span></code> </pre> <br>  Un exemple classique d'une faute de frappe, qui conduit √† une r√©cursion infinie dans l'accesseur <i>get</i> de la propri√©t√© <i>OnFailure</i> .  Au lieu de renvoyer la valeur d'un champ priv√© <i>onFailure,</i> l'acc√®s √† la propri√©t√© <i>OnFailure</i> a lieu.  Variante correcte: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OnFailure? OnFailure { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onFailure; } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onFailure = value; } }</code> </pre> <br>  Vous pouvez demander: "Comment cela a-t-il fonctionn√©?"  Jusqu'√† pr√©sent - pas comment.  La propri√©t√© n'est utilis√©e nulle part ailleurs, mais c'est temporaire.  √Ä un moment donn√©, quelqu'un commencera √† l'utiliser et recevra certainement un r√©sultat inattendu.  Pour √©viter de telles fautes de frappe, il est recommand√© de ne pas utiliser d'identifiants qui ne diff√®rent que dans le cas de la premi√®re lettre. <br><br>  Un autre commentaire √† cette construction est l'utilisation de l'identifiant, qui correspond compl√®tement au nom du type <i>OnFailure</i> .  Du point de vue du compilateur, c'est tout √† fait acceptable, mais cela complique la perception du code pour une personne. <br><br>  Une autre erreur similaire: <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3110</a> [CWE-674] Possible r√©cursion infinie √† l'int√©rieur de la propri√©t√© 'SSES3'.  AWSSDK.S3.Net45 InventoryEncryption.cs 37 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SSES3 sSES3; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SSES3 SSES3 { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SSES3; } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SSES3 = value; } }</code> </pre> <br>  La situation est identique √† celle d√©crite ci-dessus.  Cependant, ici une r√©cursion infinie se produira lors de l'acc√®s √† la propri√©t√© <i>SSES3 √† la</i> fois pour la lecture et l'attribution.  Variante correcte: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SSES3 SSES3 { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sSES3; } <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sSES3 = value; } }</code> </pre> <br>  <b>Test sur consid√©ration</b> <br><br>  Maintenant, je voudrais citer une t√¢che d'un d√©veloppeur, prise en utilisant la m√©thode Copy-Paste.  Jetez un ≈ìil √† l'apparence du code dans l'√©diteur Visual Studio et essayez de trouver une erreur. <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/bfa/71b/1ab/bfa71b1ab4af941c43e5349df51b1614.png" alt="Image 3"></p><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3029</a> Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 91, 95. AWSSDK.AppSync.Net45 CreateApiKeyResponseUnmarshaller.cs 91 <br><br>  J'ai r√©duit le corps de la m√©thode <i>UnmarshallException</i> , apr√®s avoir supprim√© tout ce qui n'√©tait pas n√©cessaire.  Vous pouvez maintenant voir que des v√©rifications identiques se succ√®dent: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override AmazonServiceException </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnmarshallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (errorResponse.Code != null &amp;&amp; errorResponse.Code.Equals(<span class="hljs-string"><span class="hljs-string">"LimitExceededException"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LimitExceededException(errorResponse.Message, innerException, errorResponse.Type, errorResponse.Code, errorResponse.RequestId, statusCode); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (errorResponse.Code != null &amp;&amp; errorResponse.Code.Equals(<span class="hljs-string"><span class="hljs-string">"LimitExceededException"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LimitExceededException(errorResponse.Message, innerException, errorResponse.Type, errorResponse.Code, errorResponse.RequestId, statusCode); } .... }</code> </pre> <br>  Il peut sembler que le bogue n'est pas brutal - juste une v√©rification suppl√©mentaire.  N√©anmoins, souvent un tel sch√©ma peut indiquer des probl√®mes plus graves dans le code, lorsqu'une v√©rification n√©cessaire ne sera pas effectu√©e. <br><br>  Dans le code, il existe plusieurs erreurs similaires. <br><br>  <b>Avertissements de PVS-Studio:</b> <br><br><ul><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 75, 79. AWSSDK.CloudDirectory.Net45 CreateSchemaResponseUnmarshaller.cs 75 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 105, 109. AWSSDK.CloudDirectory.Net45 GetSchemaAsJsonResponseUnmarshaller.cs 105 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 201, 205. AWSSDK.CodeCommit.Net45 PostCommentForPullRequestResponseUnmarshaller.cs 201 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 101, 105. AWSSDK.CognitoIdentityProvider.Net45 VerifySoftwareTokenResponseUnmarshaller.cs 101 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 72, 76. AWSSDK.Glue.Net45 UpdateConnectionResponseUnmarshaller.cs 72 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 123, 127. AWSSDK.Neptune.Net45 RestoreDBClusterFromSnapshotResponseUnmarshaller.cs 123 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 167, 171. AWSSDK.Neptune.Net45 RestoreDBClusterFromSnapshotResponseUnmarshaller.cs 167 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 127, 131. AWSSDK.RDS.Net45 RestoreDBClusterFromSnapshotResponseUnmarshaller.cs 127 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 171, 175. AWSSDK.RDS.Net45 RestoreDBClusterFromSnapshotResponseUnmarshaller.cs 171 </li><li>  V3029 Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 99, 103. AWSSDK.Rekognition.Net45 RecognizeCelebritiesResponseUnmarshaller.cs 99 </li></ul><br>  <b>Qu'est ce que c'est?</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3062</a> Un objet 'attributeName' est utilis√© comme argument de sa propre m√©thode.  Pensez √† v√©rifier le premier argument r√©el de la m√©thode ¬´Contient¬ª.  AWSSDK.MobileAnalytics.Net45 CustomEvent.cs 261 <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/// &lt;summary&gt; /// Dictionary that stores attribute for this event only. /// &lt;/summary&gt; private Dictionary&lt;string,string&gt; _attributes = new Dictionary&lt;string,string&gt;(); /// &lt;summary&gt; /// Gets the attribute. /// &lt;/summary&gt; /// &lt;param name="attributeName"&gt;Attribute name.&lt;/param&gt; /// &lt;returns&gt;The attribute. Return null of attribute doesn't /// exist.&lt;/returns&gt; public string GetAttribute(string attributeName) { if(string.IsNullOrEmpty(attributeName)) { throw new ArgumentNullException("attributeName"); } string ret = null; lock(_lock) { if(attributeName.Contains(attributeName)) // &lt;= ret = _attributes[attributeName]; } return ret; }</span></span></code> </pre> <br>  L'analyseur a d√©tect√© une erreur dans la m√©thode <i>GetAttribute</i> : une cha√Æne est v√©rifi√©e si elle se contient.  D'apr√®s la description de la m√©thode, il s'ensuit que si le nom d'attribut (cl√© d' <i>attributName</i> ) est trouv√© (dans le dictionnaire <i>_attributes</i> ), la valeur d'attribut doit √™tre retourn√©e, sinon - <i>null</i> .  En fait, comme la condition <i>attributeName.Contains (attributeName)</i> est toujours vraie, une tentative est faite pour renvoyer la valeur par une cl√© qui pourrait ne pas √™tre trouv√©e dans un dictionnaire.  Ensuite, au lieu de renvoyer <i>null,</i> une exception <i>KeyNotFoundException</i> sera lev√©e. <br><br>  Essayons de corriger ce code.  Pour mieux comprendre comment proc√©der, vous devez envisager une autre m√©thode: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/// &lt;summary&gt; /// Determines whether this instance has attribute the specified /// attributeName. /// &lt;/summary&gt; /// &lt;param name="attributeName"&gt;Attribute name.&lt;/param&gt; /// &lt;returns&gt;Return true if the event has the attribute, else /// false.&lt;/returns&gt; public bool HasAttribute(string attributeName) { if(string.IsNullOrEmpty(attributeName)) { throw new ArgumentNullException("attributeName"); } bool ret = false; lock(_lock) { ret = _attributes.ContainsKey(attributeName); } return ret; }</span></span></code> </pre> <br>  Cette m√©thode v√©rifie si le nom d'attribut (cl√© <i>attributeName</i> ) existe dans le dictionnaire <i>_attributes</i> .  Revenons √† la m√©thode <i>GetAttribute</i> et <i>corrigeons</i> l'erreur: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAttribute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attributeName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrEmpty(attributeName)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"attributeName"</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> ret = null; lock(_lock) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_attributes.ContainsKey(attributeName)) ret = _attributes[attributeName]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; }</code> </pre> <br>  Maintenant, la m√©thode fait exactement ce qui est indiqu√© dans la description. <br><br>  Encore un petit commentaire sur ce fragment de code.  J'ai remarqu√© que les auteurs utilisent le <i>verrouillage</i> lorsqu'ils travaillent avec le dictionnaire <i>_attributes</i> .  Il est clair que cela est n√©cessaire lorsque vous disposez d'un acc√®s multithread, mais la construction de la <i>serrure</i> est plut√¥t lente et encombrante.  Au lieu d'un <i>dictionnaire</i> , dans ce cas, il serait peut-√™tre plus pratique d'utiliser la version thread-safe du dictionnaire - <i>ConcurrentDictionary</i> .  De cette fa√ßon, il n'y aura pas besoin de <i>verrou.</i>  Mais je ne connais peut-√™tre pas les sp√©cificit√©s du projet. <br><br>  <b>Comportement suspect</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3063</a> [CWE-571] Une partie de l'expression conditionnelle est toujours vraie si elle est √©valu√©e: string.IsNullOrEmpty (inferredIndexName).  AWSSDK.DynamoDBv2.PCL ContextInternal.cs 802 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetQueryIndexName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> inferredIndexName = null; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrEmpty(specifiedIndexName) &amp;&amp; indexNames.Count == <span class="hljs-number"><span class="hljs-number">1</span></span>) { inferredIndexName = indexNames[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (indexNames.Contains(specifiedIndexName, StringComparer.Ordinal)) { inferredIndexName = specifiedIndexName; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrEmpty(inferredIndexName) &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= indexNames.Count &gt; 0) throw new InvalidOperationException("Local Secondary Index range key conditions are used but no index could be inferred from model. Specified index name = " + specifiedIndexName); .... }</span></span></code> </pre> <br>  L'analyseur √©tait pr√©occup√© par la <i>cha√Æne de</i> contr√¥le.IsNullOrEmpty <i>(inferredIndexName)</i> .  En effet, la cha√Æne <i>inferredIndexName</i> est affect√©e <i>null</i> , puis la valeur de cette variable n'est modifi√©e nulle part, puis pour une raison quelconque, elle est v√©rifi√©e pour <i>null</i> ou une cha√Æne vide.  Semble suspect.  Examinons de pr√®s le fragment de code ci-dessus.  Je ne l'ai pas d√©lib√©r√©ment r√©duit pour mieux comprendre la situation.  Ainsi, dans la premi√®re instruction <i>if</i> (et √©galement dans la suivante), la variable <i>specifiedIndexName</i> est en quelque sorte v√©rifi√©e.  En fonction des r√©sultats des v√©rifications, la variable <i>inferredIndexName</i> obtient une nouvelle valeur.  Examinons maintenant la troisi√®me instruction <i>if</i> .  Le corps de cette instruction (lev√©e de l'exception) sera ex√©cut√© au cas o√π <i>indexNames.Count&gt; 0,</i> comme premi√®re partie de la condition enti√®re, qui est <i>string.IsNullOrEmpty (inferredIndexName)</i> est toujours vrai.  Peut-√™tre que les variables <i>specifiedIndexName</i> et <i>inferredIndexName</i> sont m√©lang√©es ou que la troisi√®me v√©rification doit √™tre sans <i>autre</i> , repr√©sentant une instruction <i>if</i> autonome: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrEmpty(specifiedIndexName) &amp;&amp; indexNames.Count == <span class="hljs-number"><span class="hljs-number">1</span></span>) { inferredIndexName = indexNames[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (indexNames.Contains(specifiedIndexName, StringComparer.Ordinal)) { inferredIndexName = specifiedIndexName; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.IsNullOrEmpty(inferredIndexName) &amp;&amp; indexNames.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException(....);</code> </pre> <br>  Dans ce cas, il est difficile de donner une r√©ponse d√©finitive sur les options pour corriger ce code.  Quoi qu'il en soit, l'auteur doit le v√©rifier. <br><br>  <b>NullReferenceException</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3095</a> [CWE-476] L'objet 'conditionValues' a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 228, 238. AWSSDK.Core.Net45 JsonPolicyWriter.cs 228 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writeConditions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... foreach (....) { IList&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; conditionValues = keyEntry.Value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (conditionValues.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;= continue; .... if (conditionValues != null &amp;&amp; conditionValues.Count != 0) { .... } .... } }</span></span></code> </pre> <br>  C'est un classique.  La variable <i>conditionValues</i> est utilis√©e sans v√©rification pr√©alable de <i>null</i> .  Plus tard dans le code, cette v√©rification est effectu√©e.  Le code doit √™tre corrig√© comme suit: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writeConditions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... foreach (....) { IList&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; conditionValues = keyEntry.Value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (conditionValues != null &amp;&amp; conditionValues.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (conditionValues != null &amp;&amp; conditionValues.Count != <span class="hljs-number"><span class="hljs-number">0</span></span>) { .... } .... } }</code> </pre> <br>  J'ai trouv√© plusieurs erreurs similaires dans le code. <br><br>  <b>Avertissements de PVS-Studio:</b> <br><br><ul><li>  V3095 [CWE-476] L'objet 'ts.Listeners' a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 140, 143. AWSSDK.Core.Net45 Logger.Diagnostic.cs 140 </li><li>  V3095 [CWE-476] L'objet 'obj' a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 743, 745. AWSSDK.Core.Net45 JsonMapper.cs 743 </li><li>  V3095 [CWE-476] L'objet 'multipartUploadMultipartUploadpartsList' a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 65, 67. AWSSDK.S3.Net45 CompleteMultipartUploadRequestMarshaller.cs 65 </li></ul><br>  L'avertissement suivant est tr√®s similaire dans sa signification, mais le cas est oppos√© √† celui discut√© ci-dessus. <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3125</a> [CWE-476] L'objet '√©tat' a √©t√© utilis√© apr√®s avoir √©t√© v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 139, 127. AWSSDK.Core.Net45 RefreshingAWSCredentials.cs 139 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateToGeneratedCredentials</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( CredentialsRefreshState state)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> errorMessage; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ShouldUpdate) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state == null) errorMessage = <span class="hljs-string"><span class="hljs-string">"Unable to generate temporary credentials"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AmazonClientException(errorMessage); } state.Expiration -= PreemptExpiryTime; <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  L'un des fragments de code comprend la v√©rification de la valeur de la variable d' <i>√©tat</i> pour <i>null</i> .  Dans le code ci-dessous, la variable est utilis√©e pour se d√©sinscrire de l'√©v√©nement <i>PreemptExpiryTime</i> , cependant, une v√©rification de <i>null</i> n'est plus effectu√©e et le lancement de l'exception <i>NullReferenceException</i> devient possible.  Une version plus s√©curis√©e du code: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateToGeneratedCredentials</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( CredentialsRefreshState state)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> errorMessage; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ShouldUpdate) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state == null) errorMessage = <span class="hljs-string"><span class="hljs-string">"Unable to generate temporary credentials"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AmazonClientException(errorMessage); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state != null) state.Expiration -= PreemptExpiryTime; .... }</code> </pre> <br>  Dans le code, il existe d'autres erreurs similaires: <br><br>  <b>Avertissements de PVS-Studio:</b> <br><br><ul><li>  V3125 [CWE-476] L'objet 'wrappedRequest.Content' a √©t√© utilis√© apr√®s avoir √©t√© v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 395, 383. AWSSDK.Core.Net45 HttpHandler.cs 395 </li><li>  V3125 [CWE-476] L'objet 'datasetUpdates' a √©t√© utilis√© apr√®s avoir √©t√© v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 477, 437. AWSSDK.CognitoSync.Net45 Dataset.cs 477 </li><li>  V3125 [CWE-476] L'objet 'cORSConfigurationCORSConfigurationcORSRulesListValue' a √©t√© utilis√© apr√®s avoir √©t√© v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 125, 111. AWSSDK.S3.Net45 PutCORSConfigurationRequestMarshaller.cs 125 </li><li>  V3125 [CWE-476] L'objet 'lifecycleConfigurationLifecycleConfigurationrulesListValue' a √©t√© utilis√© apr√®s avoir √©t√© v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 157, 68. AWSSDK.S3.Net45 PutLifecycleConfigurationRequestMarshaller.cs 157 </li><li>  V3125 [CWE-476] L'objet 'this.Key' a √©t√© utilis√© apr√®s avoir √©t√© v√©rifi√© par rapport √† null.  V√©rifiez les lignes: 199, 183. AWSSDK.S3.Net45 S3PostUploadRequest.cs 199 </li></ul><br>  <b>R√©alit√© non alternative</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3009</a> [CWE-393] Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de 'true'.  AWSSDK.Core.Net45 Lexer.cs 651 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State19</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (....) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (....) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'"'</span></span>: .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'\\'</span></span>: .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: .... <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  La m√©thode renvoie toujours <i>true</i> .  Voyons √† quel point c'est critique pour le code appelant.  J'ai v√©rifi√© les cas d'utilisation de la m√©thode <i>State19</i> .  Il est impliqu√© dans le remplissage du tableau de gestionnaires <i>fsm_handler_table</i> √©galement avec d'autres m√©thodes similaires (il y en a 28 avec les noms, respectivement, en commen√ßant par <i>State1</i> √† <i>State28</i> ).  Ici, il est important de noter qu'en plus de <i>State19</i> , pour certains autres gestionnaires, les avertissements <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3009</a> [CWE-393] ont √©galement √©t√© √©mis.  Ce sont des gestionnaires: <i>State23, State26, State27, State28</i> .  Les avertissements, √©mis par l'analyseur pour eux: <br><br><ul><li>  V3009 [CWE-393] Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de 'true'.  AWSSDK.Core.Net45 Lexer.cs 752 </li><li>  V3009 [CWE-393] Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de 'true'.  AWSSDK.Core.Net45 Lexer.cs 810 </li><li>  V3009 [CWE-393] Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de 'true'.  AWSSDK.Core.Net45 Lexer.cs 822 </li><li>  V3009 [CWE-393] Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de 'true'.  AWSSDK.Core.Net45 Lexer.cs 834 </li></ul><br>  Voici √† quoi ressemblent la d√©claration et l'initialisation du tableau des gestionnaires: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> StateHandler[] fsm_handler_table; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PopulateFsmTables</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ fsm_handler_table = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StateHandler[<span class="hljs-number"><span class="hljs-number">28</span></span>] { State1, State2, .... State19, .... State23, .... State26, State27, State28 };</code> </pre> <br>  Pour compl√©ter l'image, voyons le code de l'un des gestionnaires pour lesquels l'analyseur n'a eu aucune revendication, par exemple, <i>State2</i> : <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State2</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br>  Voici comment l'appel des gestionnaires se produit: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NextToken</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { handler = fsm_handler_table[state - <span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (! handler (fsm_context)) <span class="hljs-comment"><span class="hljs-comment">// &lt;= throw new JsonException (input_char); .... } .... }</span></span></code> </pre> <br>  Comme nous pouvons le voir, une exception sera lev√©e en cas de retour <i>faux</i> .  Dans notre cas, pour les gestionnaires <i>State19, State23, State26 State27</i> et <i>State28,</i> cela ne se produira jamais.  Semble suspect.  D'un autre c√¥t√©, cinq gestionnaires ont un comportement similaire (retourneront toujours <i>vrai</i> ), alors peut-√™tre que c'√©tait tellement artificiel et n'est pas le r√©sultat d'une faute de frappe. <br><br>  Pourquoi vais-je si profond√©ment dans tout cela?  Cette situation est tr√®s significative dans le sens o√π l'analyseur statique ne peut souvent indiquer qu'une construction suspecte.  Et m√™me une personne (pas une machine), qui n'a pas suffisamment de connaissances sur le projet, n'est toujours pas en mesure de donner une r√©ponse compl√®te sur la pr√©sence de l'erreur, m√™me apr√®s avoir pass√© du temps √† apprendre le code.  Un d√©veloppeur doit revoir ce code. <br><br>  <b>Des contr√¥les sans signification</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> [CWE-571] L'expression 'doLog' est toujours vraie.  AWSSDK.Core.Net45 StoredProfileAWSCredentials.cs 235 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValidCredentialsExistInSharedFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... var doLog = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { doLog = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidDataException) { doLog = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doLog) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { .... } .... }</span></span></code> </pre> <br>  Faites attention √† la variable <i>doLog</i> .  Apr√®s l'initialisation avec la <i>fausse</i> valeur, cette variable obtiendra la <i>vraie</i> valeur dans tous les cas plus loin dans le code.  Par cons√©quent, la v√©rification <i>si (doLog)</i> est toujours vraie.  Peut-√™tre, plus t√¥t dans la m√©thode, il y avait une branche, dans laquelle la variable <i>doLog</i> n'avait re√ßu aucune valeur.  Au moment de la v√©rification, il pourrait contenir la <i>fausse</i> valeur re√ßue lors de l'initialisation.  Mais maintenant, il n'y a pas une telle branche. <br><br>  Une autre erreur similaire: <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022 L'</a> expression '! R√©sultat' est toujours fausse.  AWSSDK.CognitoSync.PCL SQLiteLocalStorage.cs 353 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PutValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result = PutValueHelper(....); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!result) &lt;= { _logger.DebugFormat(<span class="hljs-string"><span class="hljs-string">"{0}"</span></span>, @<span class="hljs-string"><span class="hljs-string">"Cognito Sync - SQLiteStorage - Put Value Failed"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { UpdateLastModifiedTimestamp(....); } .... }</code> </pre> <br>  L'analyseur pr√©tend que la valeur de la variable de <i>r√©sultat</i> est toujours vraie.  Cela n'est possible que si la m√©thode <i>PutValueHelper renvoie</i> toujours <i>true</i> .  Jetez un ≈ìil √† cette m√©thode: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PutValueHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (record == null) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre> <br>  En effet, la m√©thode retournera <i>true</i> dans toutes les conditions.  De plus, l'analyseur a √©mis un avertissement pour cette m√©thode.  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3009</a> [CWE-393] Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de 'true'.  SQLiteLocalStorage.cs 1016 <br><br>  Je n'ai d√©lib√©r√©ment pas cit√© cet avertissement plus t√¥t lorsque je cherchais d'autres bogues <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3009</a> et l'ai enregistr√© pour ce cas.  Ainsi, l'outil a eu raison de signaler l'erreur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> dans le code appelant. <br><br>  <b>Copiez-collez.</b>  <b>Encore une fois</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3001</a> Il existe des sous-expressions identiques 'this.token == JsonToken.String' √† gauche et √† droite de '||'  op√©rateur.  AWSSDK.Core.Net45 JsonReader.cs 343 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.token == JsonToken.ObjectEnd || <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.token == JsonToken.ArrayEnd || <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.token == JsonToken.String || <span class="hljs-comment"><span class="hljs-comment">// &lt;= this.token == JsonToken.Boolean || this.token == JsonToken.Double || this.token == JsonToken.Int || this.token == JsonToken.UInt || this.token == JsonToken.Long || this.token == JsonToken.ULong || this.token == JsonToken.Null || this.token == JsonToken.String // &lt;= )) { .... } .... }</span></span></code> </pre> <br>  Le champ <i>this.token</i> est compar√© deux fois avec la valeur <i>JsonToken.String</i> de l'√©num√©ration <i>JsonToken</i> .  Probablement, l'une des comparaisons devrait contenir une autre valeur d'√©num√©ration.  Si c'est le cas, une grave erreur a √©t√© commise ici. <br><br>  <b>Refactorisation + inattention?</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3025</a> [CWE-685] Format incorrect.  Un nombre diff√©rent d'√©l√©ments de format est attendu lors de l'appel de la fonction 'Format'.  Arguments non utilis√©s: AWSConfigs.AWSRegionKey.  AWSSDK.Core.Net45 AWSRegion.cs 116 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InstanceProfileAWSRegion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (region == null) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException( <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Format(CultureInfo.InvariantCulture, <span class="hljs-string"><span class="hljs-string">"EC2 instance metadata was not available or did not contain region information."</span></span>, AWSConfigs.AWSRegionKey)); } .... }</code> </pre> <br>  Peut-√™tre que la cha√Æne de format de la m√©thode <i>string.Format</i> contenait pr√©c√©demment l'√©l√©ment de format <i>{0},</i> pour lequel l'argument <i>AWSConfigs.AWSRegionKey a</i> √©t√© d√©fini.  Ensuite, la cha√Æne a √©t√© modifi√©e, l'√©l√©ment de format a disparu, mais un d√©veloppeur a oubli√© de supprimer l'argument.  L'exemple de code donn√© fonctionne sans erreur (l'exception a √©t√© lev√©e dans le cas contraire - l'√©l√©ment de format sans l'argument), mais il n'a pas l'air sympa.  Le code doit √™tre corrig√© comme suit: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (region == null) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException( <span class="hljs-string"><span class="hljs-string">"EC2 instance metadata was not available or did not contain region information."</span></span>); }</code> </pre> <br>  <b>Dangereux</b> <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3083</a> [CWE-367] L'appel non s√©curis√© de l'√©v√©nement 'mOnSyncSuccess', NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.CognitoSync.PCL Dataset.cs 827 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FireSyncSuccessEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Record&gt; records)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mOnSyncSuccess != null) { mOnSyncSuccess(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SyncSuccessEventArgs(records)); } }</code> </pre> <br>  Une situation courante d'un appel non s√©curis√© du gestionnaire d'√©v√©nements.  Un utilisateur peut se d√©sinscrire entre la v√©rification de la variable <i>mOnSyncSuccess</i> pour <i>null</i> et l'appel d'un gestionnaire, de sorte que sa valeur deviendra <i>nulle</i> .  La probabilit√© d'un tel sc√©nario est faible, mais il vaut toujours mieux s√©curiser le code: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FireSyncSuccessEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Record&gt; records)</span></span></span><span class="hljs-function"> </span></span>{ mOnSyncSuccess?.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SyncSuccessEventArgs(records)); }</code> </pre> <br>  Dans le code, il existe d'autres erreurs similaires: <br><br>  <b>Avertissements de PVS-Studio:</b> <br><br><ul><li>  V3083 [CWE-367] L'appel non s√©curis√© de l'√©v√©nement 'mOnSyncFailure', NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.CognitoSync.PCL Dataset.cs 839 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.PCL AmazonServiceClient.cs 332 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.PCL AmazonServiceClient.cs 344 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.PCL AmazonServiceClient.cs 357 </li><li>  V3083 [CWE-367] L'appel non s√©curis√© de l'√©v√©nement 'mExceptionEvent', NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.PCL AmazonServiceClient.cs 366 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.PCL AmazonWebServiceRequest.cs 78 </li><li>  V3083 [CWE-367] L'appel non s√ªr de l'√©v√©nement 'OnRead', NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.PCL EventStream.cs 97 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.Android NetworkReachability.cs 57 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.Android NetworkReachability.cs 94 </li><li>  V3083 [CWE-367] L'appel d'√©v√©nement √† risque, NullReferenceException est possible.  Pensez √† affecter un √©v√©nement √† une variable locale avant de l'invoquer.  AWSSDK.Core.iOS NetworkReachability.cs 54 </li></ul><br>  <b>Classe brute</b> <br><br>  <b>Avertissement PVS-Studio: le</b> type V3126 impl√©mentant l'interface IEquatable &lt;T&gt; de type 'JsonData' ne remplace pas la m√©thode 'GetHashCode'.  AWSSDK.Core.Net45 JsonData.cs 26 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JsonData</span></span></span><span class="hljs-class"> :</span></span> IJsonWrapper, IEquatable&lt;JsonData&gt; { .... }</code> </pre> <br>  La classe <i>JsonData</i> contient pas mal de code, donc je ne l'ai pas donn√© en entier, en ne citant que sa d√©claration.  Cette classe ne contient vraiment pas la m√©thode substitu√©e <i>GetHashCode,</i> qui n'est pas s√ªre, car elle peut conduire √† un comportement erron√© lors de l'utilisation du type <i>JsonData</i> pour travailler, par exemple, avec des collections.  Il n'y a probablement pas de probl√®me pour le moment, mais √† l'avenir ce type de strat√©gie pourrait changer.  Cette erreur est d√©crite plus en d√©tail dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> . <br><br>  <b>Conclusion</b> <br><br>  Ce sont tous des bogues int√©ressants que j'ai pu d√©tecter dans le code du kit AWS SDK pour .NET en utilisant l'analyseur statique PVS-Studio.  Je voudrais souligner encore une fois la qualit√© du projet.  J'ai trouv√© un tr√®s petit nombre d'erreurs pour 5 millions de lignes de code.  Bien qu'une analyse probablement plus approfondie des avertissements √©mis me permette d'ajouter quelques erreurs suppl√©mentaires √† cette liste.  N√©anmoins, il est √©galement tr√®s probable que j'ai ajout√© certains des avertissements aux erreurs pour rien.  Dans ce cas, les conclusions non ambigu√´s sont toujours faites uniquement par un d√©veloppeur qui se trouve dans le contexte du code v√©rifi√©. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437514/">https://habr.com/ru/post/fr437514/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437502/index.html">Je vais arr√™ter de jeter le bon √† la poubelle</a></li>
<li><a href="../fr437504/index.html">Petits composants: qu'est-ce qui pourrait mal tourner? Nous utilisons le principe de l'enti√®re responsabilit√©</a></li>
<li><a href="../fr437508/index.html">CVE-2019-6111 et autres vuln√©rabilit√©s scp</a></li>
<li><a href="../fr437510/index.html">Que se passe-t-il lorsque vous envoyez des SMS</a></li>
<li><a href="../fr437512/index.html">Quelles sont les fonctions pures en JavaScript?</a></li>
<li><a href="../fr437516/index.html">Recherche de bogues dans le code source Amazon Web Services SDK for .NET</a></li>
<li><a href="../fr437518/index.html">Attaque des col√©opt√®res</a></li>
<li><a href="../fr437520/index.html">¬´Ma lumi√®re est un miroir! - dites-moi, montrez-moi mon double ... ": concevez un bon cadre et obtenez le second en cadeau</a></li>
<li><a href="../fr437522/index.html">Colonie. Chapitre 22: D√©cision finale</a></li>
<li><a href="../fr437524/index.html">Cr√©er une IA d'√©checs simple: 5 √©tapes faciles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>