<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’†ğŸ» ğŸ“· ğŸ¼ Kerentanan dalam Telegram dapat membahayakan obrolan rahasia ğŸ§™ğŸ¾ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ» ğŸ¤²ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publikasi Peringatan Hari Jadi Telegram 
 Obrolan rahasia Telegram menggunakan enkripsi ujung ke ujung, jadi apa? Enkripsi ujung ke ujung Telegram den...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kerentanan dalam Telegram dapat membahayakan obrolan rahasia</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419551/"><h3>  Publikasi Peringatan Hari Jadi Telegram </h3><br>  Obrolan rahasia Telegram menggunakan enkripsi ujung ke ujung, jadi apa?  Enkripsi ujung ke ujung Telegram dengan lemah melindungi korespondensi pengguna.  Contoh sederhana: penyerang mendapatkan kunci pribadi Alice .pgp, tentu saja, untuk mendekripsi pesan yang dienkripsi untuk Alice, Anda memerlukan kata sandi untuk kunci ini, yang tidak dapat dihapus menggunakan doktrin perlindungan kata sandi modern.  Di Telegram ujung ke ujung enkripsi pada Android - ini menjadi mungkin dengan probabilitas 100%.  Bypass otentikasi dua faktor, pemulihan kode-pin dan pembajakan obrolan rahasia di Telegram tentang kerentanan ini akan menjadi artikel. <br><a name="habracut"></a><br>  Dalam pekerjaan saya, saya akan mencoba menggambarkan manual terperinci tentang kerentanan Telegram pada perangkat Android, memberikan contoh tentang cara mengembalikan kode Telegram lokal di Android, Desktop Linux / Windows.  Saya akan berkompromi dengan obrolan Telegram rahasia.  Perusahaan saya akan membantu saya dalam konfrontasi dengan tim Durov: I (Root);  Android 7.0;  Android 6.0 (root)  Android 4.4.2 (root)  PC dengan OS GNU / Linux / Windows (root).  Sekilas, sepertinya kekuatannya tidak sama, mari kita lihat ... <br><br><h4>  IMHO.  Bagaimana semuanya dimulai </h4><br>  Dalam kasus saya, saya juga merasakan kekuatan penuh kampanye PR di sekitar platform Telegram.  Pada roda besar "Kereta", hype bergulir dari bulan ke bulan, tanpa pusat dan tanpa batas.  Pengaruh E. Snowden pada popularisasi enkripsi korespondensi di mana-mana.  Ingat messenger ICQ cult dengan aplikasi QIP 2005 di Desktop, di mana semua korespondensi disimpan pada PC di domain publik dalam file .txt.  Telegram mengenai enkripsi korespondensi "yang pertama kali mulai mengenkripsi korespondensi pribadi secara massal" tidak segera, tetapi kemudian menyatakan bahwa ia adalah pelopor.  Sejarah Telegram tidak terlalu istimewa: sebuah kontes untuk keamanan protokol MTProto dari durov;  Kolyma untuk seniman dan pelukis (menggambar stiker);  API untuk membuat bot / aplikasi;  ICO TON, yang membawa banyak uang kepada para pemilik Telegram;  menghalangi utusan di Iran, Federasi Rusia dan lagi di Iran;  serta memasuki jaringan isian online langka seluk beluk Telegram.  Pada bulan Juli 2018  "Gerobak juga menyerbu saya."  Ketika "Telegram berikutnya" muncul di pasar massal pengirim pesan instan dengan slogan sendiri dan peringatan kecil (ini sangat cepat, sederhana, dan gratis).  "Telegram adalah aplikasi pengiriman pesan dengan fokus pada kecepatan dan keamanan."  Dengan mengorbankan yang terakhir, dalam slogan yang keren, durov dan timnya (karena sisi teknis Nikolai Durov yang kuat) secara terbuka berinteraksi dengan para pakar keamanan informasi / penggagas informasi yang menemukan / mencoba menemukan kerentanan dalam protokol MTProto atau bug pada platform Telegram.  Spesialis mengirim bahan mereka ke security@telegram.org - ini adalah metode resmi interaksi semacam itu oleh "pemburu hadiah" dan pengembang Telegram, juga disebutkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">di sini</a> <br><blockquote>  Faktanya, kami menyambut para pakar keamanan untuk mengaudit sistem kami dan akan berterima kasih <b>atas umpan balik</b> (security@telegram.org) </blockquote><br>  Format komunikasi tidak resmi, ketika surat diabaikan oleh pengembang Telegram, dan kemudian spesialis biasanya memposting tweet mereka di microblog, di mana durov mengomentari beberapa di antaranya. <br><br>  Pada layanan <s>Pangeran Hitam</s> pengguna, privasi pada platform seluler Telegram disajikan sebagai pengembangan MTProto yang tak tertembus, tangguh, dan baru dari Nikolai Durov.  Obrolan rahasia di Telegram (selanjutnya disebut MF) adalah obrolan yang ada di platform seluler Telegram dan dilindungi oleh enkripsi ujung ke ujung, kunci disimpan hanya pada perangkat yang dihasilkannya, dan ini juga merupakan kebanggaan Telegram-Dubai (saya akan menyebutnya kebanggaan).  Telegram midrange dianggap sebagai ruang obrolan yang sangat aman di seluruh dunia, di dunia Telegram-Dubai.  Beberapa kali durov mengguncang, membandingkan produknya dengan pesaing dalam bentuk suka perang publik dan selalu menang. <br><br>  Melewati enkripsi ujung ke ujung dari Telegram messenger di Android, laporan bug dikirim melalui email ke email tersebut.  Saya tidak menerima jawaban, beberapa hari kemudian saya menulis untuk dukungan teknis untuk sukarelawan Telegram.  Relawan menjawab saya bahwa mereka akan menyampaikan ide saya kepada pimpinan Telegram, meminta saya untuk klarifikasi: di mana dan kapan saya mengirim surat saya.  Setelah dua minggu hening, saya sekali lagi mengingat surat saya kepada para sukarelawan, kali ini sukarelawan kurir itu sama sekali mengabaikan pengingat saya.  Seminggu kemudian, saya kembali mengulangi pengiriman surat ke surat resmi Telegram - tidak ada jawaban.  Apa yang tersisa, apa yang harus dilakukan?  repot dengan laporan bug Telegram Anda melalui microblogging ?, mengepung sumber komunikasi tidak resmi dari tim durov?  Atau menulis dan memposting artikel untuk media?  Hanya semacam birokrasi dunia maya telah terbentuk di jajaran Telegram.  Saya tidak bisa tidak menyebutkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">w9w</a> dengan habr.com, yang, menurut pendapat saya, menemukan kerentanan terbaik pada platform Telegram: kerentanan di telegra.ph.  Intinya - "setiap" pengguna dapat mengedit artikel orang lain di telegra.ph.  Dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">laporan</a> kerentanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">w9w-</a> nya (dia menemukan beberapa dari mereka), dia juga tidak bisa menghubungi security@telegram.org.  Setelah menyelesaikan pencarian birokrasi, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">kami</a> menerima hadiah finansial kecil untuk kerentanan yang ditemukan.  Saya ingin tahu apakah ketamakan Telegram?  atau alasan lain?  Kembali ke Telegram, beberapa ulasan tentang itu. <br><br><img src="https://habrastorage.org/webt/bt/qy/qa/btqyqapjuur9cnzfm5itije2vgk.jpeg"><br><br>  Banyak orang memiliki album foto keluarga mereka sendiri, dan baghunter memiliki rekam jejak sendiri "bug yang ditemukan / kesalahan / kerentanan".  Di PS saya, setelah menyelesaikan artikel, saya akan dengan acuh tak acuh melukis sel B30 dengan warna merah, sehingga pertanyaan saya tetap terbuka pada tim Telegram. <br><br><h4>  Bagian 1. Kembalikan kode lokal Telegram pada OS Android Linux / Windows Desktop.  Berdasarkan kejadian nyata. </h4><br>  Pada bulan Juli, musim panas 2018  pada Github, salah satu pengembang <s>pengelompokan informal</s> versi John The Ripper (selanjutnya JTR) memposting kode sumber untuk modul parsing "telegram2john.py" yang ditulis dengan Python (berdasarkan tip dari pengguna "acak" yang membaca kode dari baris <a href="" rel="nofollow">411</a> ) .  Dari nama program, menjadi jelas mengapa dan kepada siapa modul ini melayani.  Siapa yang tidak mengerti arti dari modul tersebut, ini adalah modul yang memperluas fungsionalitas JTR.  JTR resmi dapat menghasilkan 8 format, dan JTR jumbo-1-bleeding - 263 format (tidak termasuk + seratus format sha1 / 2 / md5 / $ dinamis yang baik), dan salah satu format ini adalah kode lokal Telegram.  Setelah menguji "telegram2john.py", saya menemukan kesalahan di dalamnya: salah satu dari tiga kode lokal fungsi parsing Telegram tidak berfungsi dengan benar, yang saya laporkan kepada pengembang JTR di Github.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Perbaikan</a> untuk "telegram2john.py" keluar segera.  Ini bukan daya tarik pertama pada bug yang ditemukan untuk pengembang JTR, dan setiap kali respons cepat dan koreksi kesalahan yang tidak terlalu cepat hanya baik ketika ada saluran komunikasi yang didirikan setiap hari.  Setelah beberapa hari <s>di veche rahasia</s> , modul telegram2john.py disetujui dan dikirim ke repositori JTR. <br><br>  <b>Skema pemulihan kode lokal (Desktop-Telegram) adalah proses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">multi-langkah</a> :</b> <br><br> <code>Read the salt (32 bytes), encrypted data and sha1 of decrypted data from a file. <br> Compute a PKCS5_PBKDF2_HMAC_SHA1 on the UTF8 (passcode), using the salt, 4000 iterations, keysize of 256 bytes <br> Use a Telegram-specific KDF to get the AesKey and AesIV (Relatively cheap - bunch of memcpy and 4x sha1) <br> Perform an AES-IGE-DECRYPT on the encrypted data using the derived key and IV from step 3. <br> Compare sha1 of decrypted data with the sha1 read in step 1. If they match - passcode is correct. <br></code> <br>  <b>userconfing.xml (Android)</b> <br><br><img src="https://habrastorage.org/webt/mu/dw/rq/mudwrqg9shykcb2mxwddmbaf4g8.png"><br>  Internals <code>/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> <br><br>  Untuk pengguna JTR, operasi "perdarahan / Android-Telegram" disederhanakan menjadi proses dua tahap: menggunakan modul "telegram2john.py", "gambar hash" untuk prosesor John dari file userconfing.xml milik aplikasi Telegram (operasi waktu-instan), dan kekuatan kasar "hash" ini menggunakan JTR.  Dengan operasi seperti itu, probabilitas pemulihan kode lokal di Android e berhasil 100%, waktu tunggu beberapa milidetik.  Peluang memulihkan kode lokal di Desktop Linux / Windows adalah X% berhasil, waktu tunggu tidak ditentukan.  Mengapa  Karena, pertama, kode lokal adalah kode pin digital biasa pada Telegram empat digit (10 ^ 4 semua jenis kombinasi pin) tidak lebih dan tidak kurang, dan kedua, kode lokal algoritma enkripsi Telegram pada Android bukanlah <b>kriptografi [SHA256 ($ s. $ p. $ s)]</b> , maka kecepatan tebakan kata sandi yang tinggi.  Situasinya berbeda dengan aplikasi Telegram Desktop di mana tidak ada obrolan rahasia: dalam aplikasi Desktop, enkripsi kode lokal kuat (kecepatan pencarian pada hash CPU hash Desktop / Telegram 10.000 kali lebih lambat daripada kecepatan pencarian hash Anroid / Telegram), dan yang paling penting kode lokal pada Desktope / Telegram dapat diatur ke panjang "apa saja" dan menggunakan karakter apa pun. <br><br><img src="https://habrastorage.org/webt/ls/ub/b0/lsubb0cle23xy2pkv_wkzmm7fi4.png"><br>  <i>Kekuatan kriptografis dari kode lokal Desktop Telegram tinggi, kecepatan brute force 10k kali lebih lambat daripada kode lokal kasar Android Telegram.</i> <br><br>  Secara pribadi, saya mendapat kesan bahwa pengembang Telegram bekerja untuk menciptakan protokol MTProto yang unik dan aman, dan bukan pada privasi pengguna yang komprehensif, misalnya, cache terbuka aplikasi yang disimpan dalam direktori root non-Android atau kode lokal non-kriptografi, yang, pada gilirannya, pulih dengan probabilitas 100%. <br><br>  Pada saat penulisan, JTRs out of the box di Kali Linux dan Parrot Security OS terbaru belum diperbarui sejak 2015, mereka memiliki bug yang tidak memungkinkan untuk menguraikan kode Telegram lokal (JTR-jumbo-1-bleeding selalu memiliki beberapa bug, tetapi fungsinya. mengembangkan lebih curam daripada yang Anda pikirkan jika Anda memikirkan perangkat lunak Hashcat).  Jadi, pengguna Kali / Parrot yang berpengalaman tidak dapat meretas untuk mengembalikan Telegram kode lokal; di Windows / Android, JTR yang terpotong dalam fungsi juga tidak baik.  Karena itu, Anda harus menginstal JTR dengan Github di OS Anda (untuk sistem Linux).  Agar perangkat lunak JTR berhasil dikompilasi, sebelum mengkompilasi program, kirimkan paket ke OS Anda "libssl-dev", lalu <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/magnumripper/JohnTheRipper -b bleeding-jumbo john &amp;&amp; apt-get install libssl-dev &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> john/src &amp;&amp; ./configure &amp;&amp; make -s clean &amp;&amp; make -sj4 john/run/telegram2john.py userconfing.xml &gt;  <span class="hljs-comment"><span class="hljs-comment">#  "telegram2john.py"   GNU/Linux ,   : python telegram2john.py userconfing.xml &gt;  JohnTheRipper/run/john  --mask=?d?d?d?d #    â€“  local code Android Telegram   .</span></span></code> </pre><br><img src="https://habrastorage.org/webt/99/l7/mg/99l7mgbd_gjlbyfxzaae_f7tvwa.png"><br>  <i>Memulihkan kode lokal Android Telegram.</i>  <i>Pin 5369.</i> <br><br>  Demikian pula, dengan brute kode lokal dari aplikasi Linux / Windows lokal Telegram, alih-alih file userconfing.xml, jalur ke direktori Telegram ditunjukkan: <br><br>  (Linux): ~ / telegram2john.py ~ / .local / share / TelegramDesktop; <br>  (Windows): ~ / telegram2john.py â€œC: / Users / Name / AppData / Roaming / Telegram Desktopâ€ (untuk aplikasi Telegram yang ketinggalan zaman pada Windows); <br>  (Windows): ~ / telegram2john.py "Telegram Desktop" (untuk aplikasi Telegram yang diperbarui pada Windows). <br><br>  Harap dicatat, jika Anda ingin mem-parsing kode Telegram lokal lagi, JTR akan menampilkan "Tidak ada kata sandi".  Alasannya adalah karena kata sandi telah ditemukan sebelumnya.  Johnny, jangan pernah mengembalikan kata sandi kali kedua dan selanjutnya, alih-alih, gunakan opsi "--show hash", tetapi terkadang bug dapat terjadi, dan opsi "--show" tidak akan berfungsi sebagaimana mestinya (saya menemukan bug seperti itu dengan hash lainnya, tetapi semuanya sudah diperbaiki oleh pengembang JTR).  Dalam hal ini, lihat file ~ / john / run / john.pot, semua kata sandi yang ditemukan disimpan di dalamnya, jika Anda mengosongkannya, Anda dapat mem-brute hash dengan kata sandi yang ditemukan. <br><br><img src="https://habrastorage.org/webt/4l/ta/gz/4ltagz1y7hbtdec1le1mxt2pabi.png"><br>  <i>John The Ripper tidak akan mengotori tangannya <s>dengan darah</s> tentang kode lokal Android Telegram</i> <br><br>  <b>file userconfing.xml</b> , yang merupakan target untuk JTR, terletak di bawah direktori root Android: <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> </pre> <br>  Jadi Anda bisa mendapatkan file dengan hak root, baik melalui TWRP atau menggunakan forensik digital. <br><br>  Manual video terperinci untuk memulihkan kode Telegram lokal di tautan Android / Linux / Windows di akhir artikel. <br><br><h4>  Bagian 2. Putih dimulai dan kalah.  Pencurian obrolan rahasia di Telegram.  Berdasarkan juga pada peristiwa nyata. </h4><br>  <b>Bagaimana perlindungan berdasarkan Telegram:</b> <br><br><ol><li>  Masukkan nomor telepon; </li><li>  Menerima SMS atau kode dalam aplikasi pada perangkat lain - opsional, memasukkan kode SMS atau kode yang diterima dalam aplikasi pada perangkat lain. </li><li>  Pemblokiran akun sementara dengan pengguna yang sering (termasuk berhasil) masuk. </li></ol><br>  Ketika mencegat SMS semacam itu, Anda dapat masuk ke akun pengguna, tetapi Anda tidak bisa mendapatkan akses ke obrolan rahasia <s>teroris</s> , karena mereka ada dan hidup hanya pada perangkat <s>antek ISIS</s> , di mana mereka dihasilkan, yang berarti bahwa Anda tidak akan secara khusus waspada terhadap mereka yang menjaga operator seluler tetap di cek. <br><br>  <b>Opsional, dasar + perlindungan Telegram yang ditingkatkan:</b> <br><br><ol><li>  Masukkan nomor telepon; </li><li>  Menerima SMS atau kode dalam aplikasi di perangkat lain - sesuka hati, memasukkan kode atau kode SMS dari aplikasi; </li><li>  Masukkan kode cloud Telegram (disimpan di server Telegram dan dalam pikiran Anda, setel ulang / ditautkan melalui email); </li><li>  Pengaturan kode lokal (pada Android, pengaturan - privasi dan keamanan - kode kata sandi); </li><li>  Memeriksa sesi saat ini / saat memasuki messenger; </li><li>  Keluar dari semua sesi kecuali yang sekarang; </li><li>  Menghapus konten pengatur waktu menengah; </li><li>  Larangan layar / merekam layar midrange; </li><li>  Pemblokiran akun sementara dengan pengguna yang sering (termasuk berhasil) masuk; </li><li>  Ternyata selama pencurian midrange (masuk ke akun orang lain dari ip lain), larangan sementara akun nyata / dikompromikan ~ setelah 5 menit dan pembatalan midrange di Telegram.  Dalam jaringan akun nyata / kompromi yang sama, Telegram lupa untuk melarang pembajakan akun. </li></ol><br>  <b>Di bawah ini saya akan menunjukkan bahwa midrange rentan, saya akan membajak salah satu midrange ini (akun pengujian saya di Telegram) dan akan menyamar sebagai pengguna "Bos"</b> <b><br></b> <br>  Setelah berhasil memulihkan kode lokal Telegram, saya memutuskan untuk merasakan file di sebelah file userconfing.xml di Android.  Membuat obrolan rahasia, melihat file mana dan di mana subdirektori diperbarui pada waktunya.  Saya mencoba menyalin file-file ini dari OS Android 4.4.2 ke gadget lain dengan OS Android 6.0 (Saya mentransfer file antar gadget melalui rar; arsip zip).  Diinstal dengan GP versi terbaru Telegram pada Android 6.0.  Dipindahkan dari Android 4.4.2&gt; Android 6.0 memperbarui file ke direktori yang sama <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs /data/data/org.telegram.messenger/files /data/data/org.telegram.messenger/no_backup</code> </pre><br>  Menurut akun pengujian yang <s>dicuri</s> , Telegram mengembalikan hak (yang ada pada 4.4.2) untuk setiap file dan folder secara pribadi, operasi tidak cepat (file yang berbeda memiliki hak paling beragam), ditugaskan Telidram UID GID. <br><br><img src="https://habrastorage.org/webt/mg/lv/gf/mglvgf6i9sojpxamtme5sznrook.jpeg"><br><br>  Meluncurkan aplikasi.  Segera semua file yang dicuri diperbarui pada waktunya, dan layar "pengguna baru" menyambut saya.  Telegram berperilaku seolah-olah saya adalah pengguna baru dan menyarankan mendaftar atau masuk melalui telepon (prosedur standar untuk instalasi awal Telegram di Android).  Artinya, saya tidak bisa membobol akun orang lain.  Menyelinap lebih banyak dan beberapa kali dari sisi yang berbeda, tetapi pada akhirnya - <b>file</b> . <br><br>  <b>Saya mencoba cara lain - cadangan akun tes Telegram melalui cadangan Titanium.</b> <br>  Saya membuat cadangan aplikasi pada Android 4.4.2, menggunakan cadangan 4.4.2.  di Android 6.0. <br><br><img src="https://habrastorage.org/webt/iu/eb/7v/iueb7vcq3h-upyl2_xxyl3qewoc.jpeg"><br><br>  Hak atas aplikasi yang dicuri, mengubah UID / GID tidak diperlukan - Titanium Baseup akan melakukan segalanya.  Saya meluncurkan akun kompromi Telegram di Android 6.0 dan sulap!  Saya mendapat permintaan untuk memasukkan kode lokal pengguna "Host".  Middlegame semacam itu dengan cadangan menyediakan bypass otentikasi dua faktor tanpa korban dan trik.  Telegram, untuk bagiannya, hanya meminta kode lokal dari akun yang dicuri.  Kirim file curian <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> </pre> <br>  pada VDS dengan Kali Linux terinstal, di mana JohnTheRipper tidak lagi tidur dalam menjalankan proses, saatnya untuk bertindak.  Detik berikutnya, persetan dengan kode lokal!  Hash tidak tahan berdiri, retak. <br><br><img src="https://habrastorage.org/webt/vq/kz/s-/vqkzs-lt2vvyp1o7rw389sf7be0.jpeg"><br><br>  Red highlighted (atas ke bawah) diterima: <br><br><ul><li>  Hash untuk JTR menggunakan modul telegram2john.py; </li><li>  Kode lokal Android Telegram yang diperbarui; </li><li>  Pekerjaan penuh waktu Johnny (kata sandi brute force berkecepatan tinggi, opsi - - -mask =? D? D? D? D, memberi tahu Johnny bahwa ia memilih kode digital 4 digit, tidak menyalakannya, sehingga JTR mempercepat dan menunjukkan kecepatan <s>amarahnya</s> ); </li><li>  Minta JTR dari kode lokal yang dipulihkan. </li></ul><br>  Cool Johnny!  apakah itu tidak benar <br><br>  <s>Setelah menyalahgunakan "bagian" dari properti Telegram, setelah</s> memulihkan kode lokal Telegram menggunakan JTR Android, ia masuk dengan akun uji ip-nya ke akun <s>orang lain</s> , yang awalnya terletak di Android 4.4.2., Dan sekarang dibangun di Android 6.0.  Pada saat yang sama, saya melihat semua obrolan rahasia korban dan semua korespondensi di dalamnya.  Saya mencoba menulis, di midrange yang dibuat sebelumnya, ke pengguna Android 7.0 dan pesan berhasil dikirim.  Pengguna Android 7.0 mengirim respons, pesan respons tidak hanya diterima, tetapi diterima pada dua gadget: di Android 6.0 dan di Android 4.4.2.  Saya memeriksa sesi login terakhir: pengguna yang sebenarnya menampilkan ip-nya dan gadget Teclast Android 4.4.2 (pengaturan - privasi dan keamanan - sesi aktif);  penyerang Android 6.0 dalam "sesi aktif" menampilkan perangkat Teclast Android 4.4.2, ip Virginia.  Artinya, pengguna sebenarnya tidak menerima informasi melalui "Sesi Aktif" yang akunnya telah disusupi, tetapi menerima informasi "salah" bahwa ia online dari salah satu perangkatnya dan dari salah satu ip-nya. <br><br><img src="https://habrastorage.org/webt/ps/5h/vi/ps5hviqijte1q-4ltk_1ucmhc48.jpeg"><br><br>  Pengguna nyata melalui sesi aktif tidak melihat bahwa ia dikompromikan.  Sejarah sesi terakhir tidak mencatat titik masuk penyerang.  Selain itu, dalam akun nyata "Host", saya mengklik "logout dari semua sesi kecuali yang sekarang".  Pada saat yang sama, penyerang tidak dikeluarkan dari sesi, terlepas dari status penyerang online / offline. <br><br>  Saya mencoba operasi yang sama mengenai akun yang disusupi - hasilnya serupa: "Master" tidak dikeluarkan dari Telegram, kunci sesi adalah sama.  Luar biasa ya? <br><br>  Bisakah tombol grafis indikator keamanan midrange?  Kunci obrolan rahasia bukanlah indikator keamanan, dalam percobaan ini mereka bertiga saling mengalahkan. <br><br><img src="https://habrastorage.org/webt/am/ei/zy/ameizyvemokjmzivi6o6wf2ig1y.jpeg"><br>  <i>Semua kunci sama termasuk akun yang disusupi.</i> <br><br>  Telegram mengklaim bahwa jika kunci dipukuli pada 2 perangkat, Anda aman - ini tidak benar.  <i>(Digresi. Anda masih perlu memverifikasi kunci, setelah menginstal Telegram pada Android dan ketika membuat midrange pertama, pengguna midrange tidak memiliki snapshot kunci, dan gambar grafis dari tombol berbeda pada perangkat. Midrange bekerja seperti biasa, yang saya tidak mengerti, dan itu adalah kasus yang terisolasi ketika kunci tidak berdetak di antara mereka sendiri).</i> <br><br>  <b>Saya kembali ke metode pertama "copy-paste", yang awalnya saya tidak berhasil.</b> <br><br>  Saya ulangi semua langkah saya sebelumnya, menambahkan tindakan ke-3 menengah. <br><br>  1) Diinstal dengan GP versi terbaru Telegram. <br><br>  2) Direktori yang ditransfer dari OS 4.4.2 ke gadget lain dengan OS 6.0 (hanya mentransfer data sensitif. Saya tidak menyalin Telegram dan direktori lainnya) <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs /data/data/org.telegram.messenger/files /data/data/org.telegram.messenger/no_backup</code> </pre> <br>  3) <b>Menghapus folder pada Android 6.0</b> , periksa <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/code_cache</code> </pre> <br>  4) Saya tidak secara pribadi mengembalikan hak, melainkan, saya membagikan 777 hak (akses penuh) ke semua direktori yang dijelaskan di atas "secara rekursif".  Saya menetapkan direktori yang sama kepada pemilik dan pemilik grup (UID / GID) "Telegram" (sebenarnya, "secara rekursif" di direktori root tidak berfungsi dengan baik di TC, jadi saya harus memeriksa ulang penetapan hak). <br><br>  5) Maju!  Saya meluncurkan Telegram di jaringan lain dengan ip - kegagalan yang berbeda, sekali lagi ini adalah sambutan dari pengguna baru dalam bahasa Inggris. <br><br>  6) Maju!  Mulai ulang Telegram, skakmat!  Telegram mengeluarkan peringatan untuk memasukkan kode lokal pengguna yang menggunakan Android-e 4.4.2 (dan yang dipulihkan dengan probabilitas 100%), sementara tidak ada permintaan dari Telegram ke kode cloud atau SMS dan masih sama sekali tidak ada.  Bypass otentikasi dua faktor, tidak!  Memotong enkripsi ujung ke ujung Telegram berhasil. <br><br>  Hasil: pesan penyerang di midrange juga berhasil dikirim atas nama pengguna asli, dan semua korespondensi midrange juga tersedia.  Setelah ~ 400 detak jantung cemas saya, ketakutan itu dikonfirmasi: akun curian diblokir oleh Telegram dari seorang penyerang dan pengguna nyata;  MF - dibatalkan. <br><br><img src="https://habrastorage.org/webt/jr/ge/s2/jrges2a2eoeptmbpv5jm48j3g0s.jpeg"><br>  <i>Pemblokiran sementara akun Telegram.</i> <br><br>  Setelah masuk ke Telegram lagi (kadang-kadang larangan terjadi selama sehari, tapi saya beruntung, karena beberapa alasan semua lonceng dibagikan untuk yang kedua hari itu), pengguna sebenarnya memiliki segalanya seperti biasa, dan penyerang tidak bisa lagi mengendus akun yang disusupi (kunci sesi diperbarui). <br><br><h4>  Saya bisa membantah beberapa pernyataan Telegram </h4><br><blockquote>  telegram.org/faq - "MF hanya dapat di perangkat yang berasal dari MF." </blockquote>  I - "Seperti yang Anda lihat, midrange tidak hanya pada perangkat asal midrange, tetapi juga pada perangkat di mana ada kunci Root dan midrange, terlepas dari versi OS Android." <br><blockquote>  telegram.org/faq - â€œAnda dapat membandingkan gambar ini (catatan: gambar tengah) dengan yang dimiliki teman Anda - jika kedua gambar itu sama, Anda dapat yakin bahwa obrolan rahasia amanâ€ </blockquote>  I - "Ya, aman, tetapi hanya di dunia Telegram-Dubai";  "Kamu tidak bisa memastikan obrolan itu aman." <br><blockquote>  telegram.org/faq - "Kami juga menyarankan Anda mengaktifkan otentikasi dua langkah dan menetapkan kode akses yang kuat untuk memblokir aplikasi Anda, Anda akan menemukan kedua opsi di pengaturan - Privasi dan Keamanan." </blockquote>  I - â€œKode akses yang kuat hanya dapat ditetapkan di aplikasi Telegram Desktop Linux / Windows, tetapi tidak pin /â€œ kata sandi â€di aplikasi Androidâ€ <br><blockquote>  telegram.org/faq - â€œSeorang pengguna dengan akses root dapat dengan mudah mem-bypass fitur keamanan yang dibangun ke dalam sistem operasi, membaca memori proses, atau mengakses area terbatas seperti penyimpanan internal.  Setelah penyerang memiliki akses ke root, segala upaya mitigasi menjadi tidak berguna.  "Tidak ada aplikasi yang dapat disebut aman dalam keadaan ini, tidak peduli seberapa kuatnya enkripsi." </blockquote>  I - " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Omong kosong pemasaran</a> , karena kurangnya tenaga teknis yang memenuhi syarat kembali pada tahun 2013."  â€œKembalikan kode lokal Android dan dapatkan / tiruan akun.  Dengan setiap upaya baru yang salah untuk memasukkan pin, Telegram meningkatkan waktu tunggu antara upaya memasukkan pin.  Tampaknya, Telegram puas dengan algoritma yang demikian dalam melindungi pengguna dari brute force manual 10 ^ 4 dari semua kombinasi pin yang mungkin, tetapi apakah pengguna puas ketika mudah untuk berkompromi?  Jika pengembang Telegram ingin mengurangi ancaman dalam keadaan ini, mereka dapat mengimplementasikannya sebagai kunci sementara selama beberapa detik dengan memasukkan kode lokal secara tidak benar, dan mengganti fungsi pin "dummy" dengan Telegram pada kata sandi dengan kata sandi, dengan enkripsi PBKDF2 - ini sangat kuat akan memperlambat serangan brute force.  Sebagai contoh perlindungan yang baik - kata sandi untuk memasukkan basis data kata sandi terenkripsi Keepass2Android. <br><blockquote>  telegram.org/faq â€œAnda dapat mengakses pesan obrolan rahasia dari perangkat asal Anda.  Mereka aman selama perangkat Anda aman di saku Anda. " </blockquote>  Aku - â€œDi situlah kebenaran ternyata!â€ <br><br><h4>  Kesimpulan </h4><br><ul><li>  Kode lokal Telegram (pin) di Android e diretas ke JTR secara instan dan dengan probabilitas 100%, ini mengarah pada konsekuensi: mencuri obrolan rahasia, membuka pesan SC, menyampaikan penyerang sebagai pengguna nyata.  Perlindungan terhadap "trik" ini adalah larangan sementara dari Telegram dan kunci sesi baru untuk pengguna sebenarnya. </li><li>  Operasi untuk mencuri midrange mirip dengan pencurian cookie + pin peretasan + "masalah dengan hak" jika Anda menggunakan metode "salin-tempel". </li><li>  Untuk mengembalikan pin / kata sandi Telegram di Android, Anda harus bekerja dengan file aplikasi messenger yang berada di <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> </pre> <br>  Anda bisa mendapatkan "file sensitif" dengan hak akses root, baik melalui TWRP atau menggunakan forensik digital. </li><li>  Untuk seorang penyerang, pembajakan adalah peluang tidak hanya untuk membuang korespondensi, tetapi juga kesempatan untuk menyebabkan kerusakan pada pemilik akun yang sebenarnya: misalnya, untuk membersihkan awan "Anda".  Dalam hal ini, pengguna sebenarnya akan kehilangan data di "favorit".  Hapus akun Telegram secara resmi, dan jika, misalnya, Anda adalah administrator komunitas, maka Anda akan kehilangan hak admin. </li><li>  Seringkali pengguna menetapkan kode lokal pada Telegram Desktop-e sama dengan pin pada Android-e - ini adalah jebakan, kode lokal 4-digit Telegram pada Windows / Linux berlangsung lebih dari 1 menit, dan akses ke PC seringkali lebih mudah daripada mengakses gadget. </li><li>  UPD  Pengembang Telegram harus mengganti "pin" di Android-e dengan "kata sandi", dengan enkripsi kriptografi (seperti yang diterapkan pada Telegram Desktop-e atau dalam aplikasi seluler lainnya, misalnya Keepass ...) menggunakan, misalnya, PBKDF2 dan seterusnya ... <br>  Dan juga lepaskan fungsi buka kunci sidik jari (pada gadget di mana perangkat tidak memiliki sidik jari) ketika membuka database baru (ini adalah <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kerentanan</a> ketiga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di Telegram</a> / Android</b> yang saya abaikan dalam percobaan saya).  Tidak masalah pin / pass kode lokal apa yang dipasang pada akun yang dicuri (Anda bahkan tidak bisa memecahkannya), akun korban dapat diakses dengan sidik jari (sidik jari apa pun yang dipasang pada gadget penyerang bekerja melawan Telegram, tetapi serangan sidik jari tidak berhasil Uang Yandex, Keepass2android offline, Sberbank online). </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> security@telegram.org, dan secara umum dukungan teknis di Telegram, sebagai respons pengguna-pengembang dan layanan interaksi, tidak secara normal. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Selama periode "hening", Telegram merilis pembaruan di GP, tetapi pembaruan itu direncanakan dan dikaitkan dengan telegram Paspor, ada juga pembaruan, tetapi kerentanan yang saya tunjukkan dalam artikel ini masih valid, dan siapa pun dapat menggunakannya. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram tidak bereaksi terhadap laporan bug (kerentanan terdeteksi). </font><font style="vertical-align: inherit;">Jawabannya kemungkinan besar tidak akan mengikuti.</font></font></li></ul><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spoiler</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-p/zt/iq/-pztiqxrayw-cdrexspsi3hmf9y.jpeg"><br></div></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo pemulihan kode lokal Telegram di Android / Linux / Windows.</font></font></b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OzFAyOJ5MPw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peragaan kerentanan obrolan Telegram rahasia.</font></font></b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zRO_KsPZJto" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i>PS: /     -   ,     Telegram       ,  -   Telegram-    .</i> <br><br> <i>PPS:       root-.       root ( ),   -     root   .  ,    GNU/Linux     Â«  Â» (Android â€”  Linux  GNU   ).      Windows  Â«Â»       ?  Android-     ,   . <br>  :      gpg/pgp ,    keepass2android offline,       rar.  Â«Â»  /      root        .  Telegram Android    pin,          100% .</i> <br><div class="spoiler"> <b class="spoiler_title">...</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rz/cf/oy/rzcfoywf1y9lphimjjal0l-2nqe.jpeg"><br></div></div><br> <i>       local code  Android-e Â«passwordÂ»  Â«pinÂ». <u>    :</u> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> ...</a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id419551/">https://habr.com/ru/post/id419551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id419531/index.html">Memilih pasangan yang tepat untuk telinga Anda: sepuluh tips praktis</a></li>
<li><a href="../id419535/index.html">Perbarui pada Pemanggang Roti</a></li>
<li><a href="../id419537/index.html">CyberDemons: Kecerdasan Buatan DOOM 2016</a></li>
<li><a href="../id419539/index.html">Buka webinar "Pemrograman Asinkron dengan Python"</a></li>
<li><a href="../id419547/index.html">Mengelola log digest biasa dengan python dan dimungkinkan menggunakan asterisk sebagai contoh</a></li>
<li><a href="../id419559/index.html">Cara melakukan pencarian pengguna di GitHub menggunakan React + RxJS 6 + Komposisi Ulang</a></li>
<li><a href="../id419561/index.html">Operator seluler masih membatalkan biaya roaming nasional</a></li>
<li><a href="../id419567/index.html">Roskomnadzor dan Kantor Kejaksaan Agung melebihi otoritas mereka dalam memblokir Telegram</a></li>
<li><a href="../id419569/index.html">Slurm: video kelas dan aspek organisasi</a></li>
<li><a href="../id419571/index.html">Posisi itu bagus, tetapi mereka terus menanam untuk repost</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>