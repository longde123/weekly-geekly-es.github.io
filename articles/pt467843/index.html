<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÜ üë• ü•† Como economizar at√© meio milh√£o de d√≥lares na AWS? ü¶Ç ‚õ∑Ô∏è ‚ö´Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Apresento a voc√™ a tradu√ß√£o do artigo ‚ÄúComo reduzir seus custos da AWS? Economize at√© US $ 500 mil com essas diretrizes! ‚Äù autor George Bats...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como economizar at√© meio milh√£o de d√≥lares na AWS?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467843/"> Ol√° Habr!  Apresento a voc√™ a tradu√ß√£o do artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">‚ÄúComo reduzir seus custos da AWS?</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Economize at√© US $ 500 mil com essas diretrizes! ‚Äù</a>  autor George Batschinski. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/0.png" alt="imagem"><br><br>  Neste artigo, detalharemos como o Back4App reduziu suas despesas da AWS de US $ 55.492 por m√™s para US $ 20.074 por m√™s e economizou US $ 500.000 por ano.  Descreveremos etapas pr√°ticas com base em nossa pr√≥pria experi√™ncia de redu√ß√£o de custos na AWS e compartilharemos dicas que tamb√©m foram √∫teis para n√≥s. <br><a name="habracut"></a><br>  A AWS continua inovando e dominando o mercado de nuvem.  Ele cresceu tanto que se tornou uma parte essencial da estrat√©gia da Amazon.  Estou entusiasmado com a AWS, mas as d√∫vidas sobre a complexidade da nuvem e o custo me levaram √† id√©ia de otimizar o uso da nuvem.  Apesar de a AWS oferecer uma lista cada vez maior de servi√ßos especializados para diferentes tipos de desenvolvimento, nem sempre √© a maneira mais direta, r√°pida ou acess√≠vel.  Idealmente, assim que voc√™ for para a nuvem, precisar√° pensar imediatamente na arquitetura para reduzir custos.  Esse material ajudar√° a acelerar a otimiza√ß√£o de custos e cont√©m casos da vida real que encontramos durante nosso empreendimento de corte de custos. <br><br>  Uma breve vis√£o geral do que voc√™ encontrar√° neste artigo: <br><br><ul><li>  <b>Solicite empr√©stimos da AWS e receba at√© US $ 100.000;</b> </li><li>  <b>Transfira a transfer√™ncia de dados para o Cloud Front e economize at√© 75%;</b> </li><li>  <b>Use IP privado (n√£o Elastic IP) e pare de pagar pela transfer√™ncia de dados entre zonas de acesso;</b> </li><li>  <b>Economize at√© 90% com inst√¢ncias spot;</b> </li><li>  <b>Economize at√© 75% comprando Inst√¢ncias reservadas no AWS Marketplace;</b> </li><li>  <b>Obtenha n√≥s reservados do Elastic Cache e economize at√© 77%;</b> </li><li>  <b>Reserve seus dados no S3, mas n√£o no EBS, e economize at√© 75%;</b> </li><li>  <b>Configure o dimensionamento autom√°tico para recursos ociosos;</b> </li><li>  <b>Escolha a regi√£o da Virg√≠nia do Norte e fique longe de S√£o Paulo;</b> </li><li>  <b>Atualize para novas gera√ß√µes de inst√¢ncias e economize at√© 20%;</b> </li><li>  <b>Localize o terminal S3 na sua VPC e ative a Rede aprimorada no EC2.</b> </li></ul><br>  Veja como era a nossa conta da AWS em janeiro de 2019. O custo total da nuvem √© de US $ 55.492. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/1.png" alt="imagem"><br><br>  Veja como era a nossa conta da AWS em maio de 2019. O custo total foi de US $ 20.074. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/2.png" alt="imagem"><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/3.png" alt="imagem"><br><br><h2>  1. Empr√©stimos da AWS </h2><br>  Primeiro de tudo!  Antes de come√ßar a fazer qualquer coisa, verifique se sua empresa est√° qualificada para empr√©stimos da AWS.  Veja como voc√™ pode obter esses empr√©stimos: <br><br><h3>  Solicite empr√©stimos √† AWS </h3><br>  Assim foi no nosso caso!  Em 2016, nossa empresa cresceu bastante rapidamente.  Nossa fatura da AWS come√ßou a aumentar e n√£o t√≠nhamos id√©ia ou tempo para otimizar o uso da AWS.  Como n√£o t√≠nhamos financiamento, percebemos que receber√≠amos empr√©stimos da AWS ou desaparecer√≠amos.  Preparamos nosso argumento para nossa conta para gerentes da AWS, demonstrando a rapidez com que estamos crescendo e as vantagens da AWS em nos apoiar em nosso site.  Mostramos a ele que n√£o t√≠nhamos financiamento e que seria for√ßado a ir ao Google Cloud (eles nos ofereceram US $ 100.000 em empr√©stimos para a migra√ß√£o para a AWS) se n√£o receb√™ssemos empr√©stimos da AWS.  A resposta levou cerca de uma semana e a AWS nos forneceu US $ 100.000 para uso em 12 meses.  Tamb√©m foi um bom neg√≥cio para a AWS!  Desde que os empr√©stimos expiraram, gastamos mais de US $ 750.000 com a AWS. <br><br><h3>  Cr√©ditos para testar e lan√ßar a Prova de Conceito </h3><br>  Se voc√™ pretende testar um novo servi√ßo da AWS ou o tipo de inst√¢ncia, solicite empr√©stimos ao seu gerente de contas.  O n√∫mero de empr√©stimos depender√° dos seus custos mensais e do esfor√ßo geral para iniciar o POC.  Esses empr√©stimos geralmente s√£o v√°lidos apenas por tr√™s meses e voc√™ precisa garantir a velocidade do POC.  No nosso caso, conseguimos US $ 3.000 em empr√©stimos para testar a fam√≠lia de inst√¢ncias i3. <br><br><h3>  Cr√©ditos de inicializa√ß√£o </h3><br>  Se voc√™ fundou sua empresa ou lan√ßou uma startup, essa √© uma √≥tima maneira de avan√ßar.  O valor dos empr√©stimos varia de US $ 1.000 a US $ 100.000, dependendo de como voc√™ apresenta seu caso da AWS.  Existem v√°rias maneiras de obter esses empr√©stimos. <br><br><h4>  Aceleradores </h4><br>  Uma das principais vantagens dos aceleradores de inicializa√ß√£o nos b√¥nus que eles fornecem.  Um desses b√¥nus s√£o empr√©stimos de provedores de nuvem.  A quantia que voc√™ pode receber depender√° do Acelerador em que voc√™ est√° representado.  Alguns dos melhores, por exemplo, YC, Alchemist, Wayra e 500 Startups, oferecer√£o US $ 100.000 em empr√©stimos da AWS.  No nosso caso, fomos aceitos pelo Alchemist Accelerator e emitimos US $ 100.000 em empr√©stimos.  Infelizmente, n√£o conseguimos usar esses empr√©stimos, pois antes disso j√° t√≠nhamos aproveitado outros empr√©stimos.  Por exemplo, se voc√™ aceitar dois aceleradores por US $ 100.000 cada, n√£o poder√° usar US $ 200.000, apenas US $ 100.000. <br><br><h4>  Fundos de risco e grupos de anjos </h4><br>  Alguns grupos WF / Angel fornecem empr√©stimos como parte do programa de b√¥nus.  No nosso caso, conseguimos obter US $ 10.000 em empr√©stimos de marketing, v√°lidos por dois anos de um de nossos investidores.  Infelizmente, n√£o conseguimos us√°-los.  As empresas n√£o podem usar cr√©ditos promocionais da AWS se j√° tiverem recebido um montante igual ou superior a empr√©stimos. <br><br><h4>  Todos os principais provedores de nuvem fornecem empr√©stimos para startups </h4><br>  Todos os principais players do mercado de nuvem oferecem empr√©stimos para startups.  Com a AWS / Google, os empr√©stimos podem chegar a US $ 100.000.  No Azure, voc√™ pode obter US $ 360.000 por tr√™s anos. <br><br><h2>  2. Implementar economia de custos na AWS </h2><br>  A parte mais f√°cil acabou, e agora vamos aos desafios!  N√£o h√° p√≠lula m√°gica para reduzir custos na AWS, voc√™ precisa trabalhar duro e seguir um procedimento regular para monitorar os custos!  Reduzir os custos da nuvem deve ser sua rotina di√°ria!  Imagine quanto voc√™ economiza em 365 dias!  A quantidade de tempo que voc√™ investe depende do tamanho da sua organiza√ß√£o e dos custos da AWS.  Passo cerca de 30 minutos por dia monitorando minha conta e priorizando a√ß√µes de corte de custos.  Al√©m disso, os engenheiros da Back4App gastam pelo menos 1 hora por dia em iniciativas de redu√ß√£o de custos. <br><br>  A primeira iniciativa que conclu√≠mos: criar uma planilha simples no Excel para priorizar iniciativas de redu√ß√£o de custos. <br><br>  Os principais crit√©rios pelos quais determinamos a economia: <br><br><ul><li>  Potencial de economia - maiores ganhos com a economia </li><li>  Dificuldade - Qu√£o dif√≠cil √© aplicar o esfor√ßo e o trabalho necess√°rio </li><li>  Propriet√°rio - quem executar√° a a√ß√£o </li></ul><br>  No nosso caso, as maiores economias s√£o o uso do Elastic Compute Cloud (EC2), e esse foi o primeiro assunto que come√ßamos a entender. <br><br><h2>  3. EC2 - Nuvem de computa√ß√£o el√°stica </h2><br><h3>  Desativar inst√¢ncias n√£o utilizadas </h3><br>  O primeiro ponto a ser tomado para reduzir custos no EC2 √© desativar inst√¢ncias n√£o utilizadas.  N√£o h√° nada complicado, e a maior parte do trabalho √© bastante direta.  Tudo o que voc√™ precisa fazer √© fazer uma lista de todas as inst√¢ncias, carregar o arquivo do excel a partir do exemplo e definir cada uma.  No nosso caso, dividimos nossas inst√¢ncias em 3 categorias principais: <br><br><ul><li>  Inst√¢ncias que devem funcionar continuamente </li><li>  Inst√¢ncias que podem ser paradas </li><li>  Inst√¢ncias que podem ser exclu√≠das </li></ul><br>  <b>N√£o pare, mas exclua inst√¢ncias</b> <br><br>  Remova inst√¢ncias n√£o utilizadas quando poss√≠vel!  Se voc√™ apenas os interromper, continuar√° pagando pelo uso do EBS! <br><br><h3>  Reduzir o excesso de recursos </h3><br>  Essa a√ß√£o √© um pouco mais complicada e √© absolutamente necess√°rio selecionar corretamente o tamanho da inst√¢ncia.  Certifique-se de avaliar pelo menos uma semana de dados para aumentar a probabilidade de uma altera√ß√£o correta da inst√¢ncia.  A abordagem pela qual controlamos esse processo foi dividir as inst√¢ncias em tr√™s categorias principais: <br><br><ul><li>  Tamanho correto </li><li>  Reduzir tamanho da inst√¢ncia </li><li>  Aumentar tamanho da inst√¢ncia </li></ul><br>  A maneira de verificar os dados hist√≥ricos de uma inst√¢ncia √© extremamente simples.  No painel de controle da AWS, v√° para Servi√ßos&gt; EC2&gt; Inst√¢ncias&gt; Inst√¢ncias em execu√ß√£o, selecione Inst√¢ncia&gt; Monitoramento.  Por exemplo, voc√™ pode verificar a m√©trica de utiliza√ß√£o da CPU. <br><br>  <b>Reduza o tamanho da inst√¢ncia sequencialmente</b> <br><br>  Reduza o tamanho da inst√¢ncia passo a passo.  Por exemplo, n√£o reduza o tamanho de t2.xlarge para t2.medium.  Primeiro, reduza-o de t2.2xlarge para t2.xlarge.  Veja uma semana, verifique quantos recursos s√£o usados ‚Äã‚Äãe repita as etapas em uma nova.  Ao executar essas etapas, voc√™ minimizar√° as chances de erros ou tempo de inatividade. <br><br><h3>  Usar inst√¢ncias reservadas </h3><br>  A reserva de inst√¢ncias pode aumentar sua economia em at√© 70%.  Lembre-se de que, quando voc√™ reserva uma inst√¢ncia, paga 24/7 pela dura√ß√£o da reserva.  Voc√™ pagar√° independentemente de usar ou n√£o a inst√¢ncia. <br><br>  Existem dois tipos de capacidades redundantes: <br><br>  Padr√£o - que voc√™ pode vender no AWS Marketplace, n√£o √© poss√≠vel converter para outro tipo de inst√¢ncia, mais barato que as inst√¢ncias convers√≠veis. <br><br>  Convers√≠vel - voc√™ n√£o poder√° vend√™-lo no AWS Marketplace, mas poder√° convert√™-lo em uma inst√¢ncia de um tipo diferente, mais cara que as inst√¢ncias padr√£o. <br><br>  <b>Inst√¢ncias convers√≠veis podem ser confusas</b> <br><br>  Inst√¢ncias convers√≠veis s√£o muito dif√≠ceis!  Cada vez que voc√™ converte inst√¢ncias, voc√™ s√≥ pode aumentar o tamanho da inst√¢ncia.  Considere a seguinte situa√ß√£o: <br><br>  Voc√™ adquire t3.medium, uma inst√¢ncia reservada convers√≠vel. <br>  Voc√™ decide converter a inst√¢ncia t3.medium para m5.large. <br><br>  Voc√™ certamente ter√° sucesso!  Depois de usar a inst√¢ncia m5.large por algum tempo, voc√™ desejar√° retornar ao t3.medium. <br><br>  <b>E isso j√° √© imposs√≠vel!</b> <br><br>  Voc√™ n√£o poder√° reduzir o consumo da inst√¢ncia convers√≠vel, mas apenas aumentar o valor pago por ela.  Portanto, comece com uma pequena inst√¢ncia reservada e aumente-a com o tempo.  N√£o comece com uma inst√¢ncia grande, porque voc√™ n√£o pode reduzir seu consumo ou vend√™-lo no AWS Marketplace'e.  <b>Se voc√™ cometer um erro com uma inst√¢ncia reservada convers√≠vel, estar√° inscrito em um pagamento mensal de 12 ou 36 meses.</b>  No Back4App, sempre obtemos o t2.nano e aumentamos conforme necess√°rio. <br><br>  Prefiro inst√¢ncias reservadas padr√£o do que convers√≠veis pelos seguintes motivos: <br><br><ul><li>  Eles s√£o mais baratos </li><li>  Eles t√™m maior liquidez - podem ser vendidos no AWS Marketplace a qualquer momento. </li><li>  Eles podem ser comprados no AWS Marketplace com desconto. </li></ul><br><h3>  Use o AWS Marketplace para inst√¢ncias reservadas </h3><br>  Inst√¢ncias reservadas s√£o √≥timas, mas a compra de inst√¢ncias reservadas no AWS Marketplace √© ainda melhor! <br><br><h3>  O AWS Marketplace pode ser muito mais barato </h3><br>  O AWS Marketplace parece um mercado de valores mobili√°rios!  √Äs vezes, voc√™ pode comprar uma inst√¢ncia reservada padr√£o com um pre√ßo muito mais acess√≠vel do que comprar diretamente da AWS.  A raz√£o √© simples;  √Äs vezes, as empresas possuem inst√¢ncias redundantes que n√£o est√£o mais em uso, mas continuam pagando por elas.  A redu√ß√£o do pre√ßo da acomoda√ß√£o acelera o processo de compra. <br><br>  Aqui vou dar um exemplo do que aconteceu com o Back4App.  Eu estava procurando por 4 inst√¢ncias reservadas r4.large.  Consegui encontrar inst√¢ncias no AWS Marketplace com uma taxa efetiva de 75% mais barata em compara√ß√£o com os pre√ßos sob demanda.  A AWS vendeu o mesmo tipo de inst√¢ncias reservadas, mas com um desconto de 62%. <br><br><h3>  O AWS Marketplace possui condi√ß√µes flex√≠veis de compra </h3><br>  Outra vantagem do AWS Marketplace √© que voc√™ pode comprar inst√¢ncias com um per√≠odo de uso flex√≠vel.  A pr√≥pria AWS fornece apenas op√ß√µes por 12 e 36 meses para a compra de inst√¢ncias reservadas.  O AWS Marketplace √© muito mais flex√≠vel!  Voc√™ pode comprar, por exemplo, inst√¢ncias reservadas por 15 meses pelo mesmo pre√ßo que por 36 meses.  Algumas empresas preferem obriga√ß√µes de longo prazo (36 meses) e, antes que a obriga√ß√£o expire, elas as vendem no AWS Marketplace.  O novo cliente usar√° apenas a inst√¢ncia pelo per√≠odo restante, por exemplo: <br><br><ul><li>  Tempo total de aquisi√ß√£o: 36 meses </li><li>  Comprador inicial: usa inst√¢ncia por 21 meses </li><li>  Segundo comprador: o compra no mercado e o usa pelos 15 meses restantes. </li></ul><br>  A principal dificuldade √© encontrar as inst√¢ncias corretas no AWS Marketplace.  <b>Uma √≥tima maneira de simplificar a pesquisa de inst√¢ncias √© procur√°-las em v√°rias zonas de acesso, e n√£o apenas na onde voc√™ est√° localizado.</b>  Depois de adquirir uma inst√¢ncia, voc√™ pode modific√°-la e atribu√≠-la a outra zona de acessibilidade ou transform√°-la em uma inst√¢ncia regional.  Isso n√£o √© nada dif√≠cil, mas siga as instru√ß√µes abaixo: <br><br><ul><li>  Etapa 1 - V√° para o painel de inst√¢ncias reservadas </li><li>  Etapa 2 - Clique em Comprar inst√¢ncias reservadas </li><li>  Etapa 3 - na Classe da Oferta, selecione Padr√£o </li><li>  Etapa 4 - No canto superior direito da janela pop-up, selecione "Mostrar apenas ofertas que reservam capacidade" </li><li>  Etapa 5 - Clique em Pesquisar </li><li>  Etapa 6 - Obtenha uma inst√¢ncia da Zona de disponibilidade 1b </li><li>  Etapa 7 - Aguarde a inst√¢ncia se tornar ativa </li><li>  Etapa 8 - Selecione a inst√¢ncia que foi comprada </li><li>  Etapa 9 - Clique no bot√£o A√ß√µes </li><li>  Etapa 10 - Clique em Modificar inst√¢ncias reservadas </li><li>  Etapa 11 - Escopo - Alterar zona ou regi√£o de disponibilidade </li><li>  Etapa 12 - Clique em Continuar </li><li>  Etapa 13 - Clique em Enviar modifica√ß√µes </li></ul><br>  Seguir estas etapas permitir√° que voc√™ compre inst√¢ncias reservadas padr√£o em qualquer zona de disponibilidade e modifique-a para sua zona de disponibilidade. <br><br><h3>  AWS Marketplace para empresas fora dos EUA </h3><br>  Esclarecimentos importantes para usu√°rios fora da jurisdi√ß√£o dos EUA.  Voc√™ n√£o pode vender inst√¢ncias reservadas padr√£o no Marketplace, a menos que tenha uma entidade legal estadual.  Se sua empresa encontrar fora dos Estados Unidos, voc√™ poder√° comprar inst√¢ncias no Marketplace, mas n√£o poder√° vend√™-las. <br><br><h3>  Usar inst√¢ncias spot </h3><br>  Eu amo inst√¢ncias spot!  Voc√™ pode economizar at√© 90% usando-os, e isso n√£o exigir√° grandes investimentos!  O √∫nico ponto negativo de inst√¢ncias Spot √© que a AWS pode excluir essas inst√¢ncias rapidamente ou ap√≥s um aviso de dois minutos.  Nesse sentido, esse tipo de inst√¢ncia pode ser usado apenas para cargas tolerantes a falhas ou flex√≠veis. <br><br>  <b>Use o SpotInst para executar inst√¢ncias spot</b> <br><br>  Uma maneira segura de executar inst√¢ncias Spot e minimizar o risco de inatividade √© usar a plataforma SpotInst.  Este servi√ßo se conecta √† sua conta da AWS e gerencia a distribui√ß√£o de inst√¢ncias Spot.  Se a inst√¢ncia estiver desativada, o servi√ßo a substituir√° por On Demand e evitar√° o tempo de inatividade.  As tarifas tamb√©m s√£o bastante interessantes, elas cobram 20% do que foi economizado (entre a diferen√ßa no pre√ßo do On-demand e do Spot). <br><br>  Um √≥timo cen√°rio para inst√¢ncias Spot √© usar uma c√≥pia de servidores para bancos de dados ou para extens√µes de aplicativos flex√≠veis.  Use o SpotInst para controlar a aloca√ß√£o de inst√¢ncias Spot, e provavelmente voc√™ nunca encontrar√° tempo de inatividade associado ao uso dessa classe de inst√¢ncias. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/4.png" alt="imagem"><br><br><h3>  Escalonamento autom√°tico (recursos inativos, automa√ß√£o de inst√¢ncias de inicializa√ß√£o / parada do EC2) </h3><br>  O AWS Auto Scaling monitora seus aplicativos e ajusta automaticamente a energia para manter energia est√°vel e previs√≠vel pelo menor custo.  Voc√™ pode configurar o dimensionamento autom√°tico para iniciar e parar automaticamente as inst√¢ncias do EC2.  O dimensionamento autom√°tico leva em considera√ß√£o as m√©tricas de recursos, como CPU, solicita√ß√µes de API e tempos de ativa√ß√£o / desativa√ß√£o. <br><br>  Para minimizar os custos, voc√™ deve usar o dimensionamento autom√°tico + Inst√¢ncias spot + Inst√¢ncias reservadas.  Vamos dar uma olhada na situa√ß√£o real que encontramos no Back4App.  As cargas de trabalho mudam ao longo do dia.  O n√∫mero de solicita√ß√µes que recebemos n√£o √© uniforme e possui cargas de pico de uso em determinadas horas.  Para resolver esse problema, alocamos inst√¢ncias reservadas para o limite m√≠nimo de consumo e escalamos com inst√¢ncias spot.  A figura abaixo ajuda a entender a configura√ß√£o.  Aqui est√° o quanto voc√™ pode economizar: <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/5.png" alt="imagem"><br><br><ul><li>  Inst√¢ncias reservadas: no Back4App, usamos uma combina√ß√£o de 12/36 inst√¢ncias reservadas padr√£o mensais.  Nossa economia m√©dia √© de 50% em compara√ß√£o com os pre√ßos sob demanda. </li><li>  Escalonamento autom√°tico: iniciamos / paramos inst√¢ncias com base no n√∫mero total de solicita√ß√µes de API que cada inst√¢ncia recebe.  Temos tr√™s per√≠odos de pico durante o dia, e a economia comparada aos recursos inativos que funcionariam 24 horas com carga m√°xima √© de aproximadamente 75%. </li><li>  Inst√¢ncias spot: temos uma mistura de duas fam√≠lias de inst√¢ncias que funcionam no Spotinst para maximizar o tempo de atividade.  Nossa economia √© de 55% em compara√ß√£o com os pre√ßos sob demanda.  Essa √© a nossa economia, levando em considera√ß√£o todo o valor que pagamos ao SpotInst.  O uso de inst√¢ncias spot diretamente da AWS poderia economizar cerca de 70%, mas aumentaria os riscos.  Gostamos de jogar de forma moderada e decidimos devolver algumas de nossas economias ao SpotInst. </li></ul><br>  <b>Ajustar escala</b> <br><br>  Personalize sua escala vertical e horizontal (Cloudformation) <br><br><h3>  Escolha a regi√£o correta da AWS para salvar </h3><br><ul><li>  Os pre√ßos variam entre as regi√µes!  Escolha o errado e voc√™ pagar√° em excesso. </li><li>  As regi√µes mais baratas s√£o North Virginia, Ohio e Oregon. </li></ul><br>  Os mais caros: S√£o Paulo, Sydney e Hong Kong <br>  Considere o seguinte exemplo: <br><br><ul><li>  4 x inst√¢ncias t3.medium </li><li>  EBS de 30 Gb dedicado a cada inst√¢ncia </li><li>  Tr√°fego total de 1 TB </li></ul><br>  A mesma configura√ß√£o ser√° 102% mais cara em S√£o Paulo do que na Virg√≠nia do Norte. <br><br><ul><li>  $ 221.65 / m√™s em Virg√≠nia do Norte </li><li>  $ 449,05 / m√™s em S√£o Paulo </li></ul><br>  A centraliza√ß√£o das opera√ß√µes em uma regi√£o tamb√©m tem suas vantagens. <br><br><ul><li>  √â muito mais f√°cil controlar a aloca√ß√£o de inst√¢ncias reservadas. </li><li>  As tarifas de tr√°fego entre regi√µes n√£o ser√£o aplicadas </li></ul><br>  Na Back4App, n√£o conseguimos centralizar todas as opera√ß√µes na Virg√≠nia do Norte devido √† nossa cobertura comercial e aos requisitos do cliente.  Decidimos criar um cluster nos EUA, Europa e √Åsia.  Centralizamos nossas opera√ß√µes nesses clusters e expandimos cada regi√£o o m√°ximo poss√≠vel. <br><br><h3>  Atualizar gera√ß√µes anteriores de recursos </h3><br>  Ocasionalmente, a AWS lan√ßa novos tipos de inst√¢ncias.  Novas gera√ß√µes s√£o mais poderosas e baratas. <br><br>  <b>A velha gera√ß√£o de inst√¢ncias</b> <br><br>  C4.large <br><br>  2 n√∫cleos <br><br>  3,75 GB de mem√≥ria <br><br>  US $ 0,100 / hora <br><br>  <b>A nova gera√ß√£o de inst√¢ncias</b> <br><br>  C5.large <br><br>  2 n√∫cleos <br><br>  4 gb de mem√≥ria <br><br>  US $ 0,085 / hora <br><br>  A nova gera√ß√£o √© 15% mais barata e 6% mais poderosa! <br><br>  <b>Permitir rede aprimorada</b> <br><br>  Habilite a rede aprimorada para obter melhor desempenho da inst√¢ncia! <br><br><h2>  4. EBS - Elastic Block Store </h2><br>  O EBS fornece volumes de armazenamento seguro para uso com inst√¢ncias do EC2 na nuvem da AWS.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada volume EBS √© duplicado na zona de disponibilidade para proteg√™-lo contra falhas de hardware, fornecendo alta disponibilidade e confiabilidade. </font><font style="vertical-align: inherit;">O custo de cada gigabyte armazenado depende do tipo de volume que voc√™ usar√°. </font><font style="vertical-align: inherit;">Os tipos mais comuns s√£o SSD de uso geral e magn√©ticos. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSD de uso geral</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0,10 / GB-m√™s </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Magn√©tico</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0,05 / GB-m√™s</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tipo EBS - SSD x Magn√©tico </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comece a marcar suas inst√¢ncias e fa√ßa o download desta planilha para facilitar sua vida. </font><font style="vertical-align: inherit;">Por exemplo, determine se o volume √© magn√©tico ou SSD.</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha Magn√©tico em vez de SSD sempre que poss√≠vel. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Substitua o volume SSD sempre que poss√≠vel. </font></font></li></ul><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tamanho do EBS - reduza volumes excessivos </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O segundo ponto a ser salvo no EBS √© determinar o tamanho de cada volume anexado. </font><font style="vertical-align: inherit;">Volumes excessivos e gigabytes n√£o utilizados s√£o frequentemente usados.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Excluir inst√¢ncias - a interrup√ß√£o n√£o afetar√° o pagamento do EBS </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A interrup√ß√£o de inst√¢ncias n√£o o protege dos custos do EBS! </font><font style="vertical-align: inherit;">Seu volume continuar√° sendo armazenado e ser√° inclu√≠do no pagamento! </font><font style="vertical-align: inherit;">Se voc√™ n√£o precisar mais da inst√¢ncia e dos dados, exclua a inst√¢ncia! </font><font style="vertical-align: inherit;">Essa a√ß√£o reduzir√° os custos do EC2 e EBS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A AWS permite aumentar sequencialmente o tamanho do EBS, mas n√£o permite diminu√≠-lo. </font><font style="vertical-align: inherit;">Em geral, √© melhor ter volumes menores que os grandes e usar o EBS somente quando necess√°rio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos estimar o qu√£o caro pode ser. </font><font style="vertical-align: inherit;">Digamos que voc√™ use 10 inst√¢ncias t3.small e cada inst√¢ncia use 50 GB de armazenamento SSD EBS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A fatura mensal ser√°:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Custo mensal de EC2 = 10 x US $ 15,23 = 152,30 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Capacidade total do EBS: 10 x 50 GB = 500 GB </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pre√ßo por GB: US $ 0,10 por m√™s </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Custo mensal do EBS: US $ 50,00 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Custo total: $ 182.30 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este exemplo simples mostra que o EBS pode subir at√© 32% do custo do EC2 e constituir uma parte significativa da sua conta. </font><font style="vertical-align: inherit;">Este √© um valor oculto constante que precisa ser controlado. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√™ uma olhada no armazenamento ef√™mero</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avalie os pr√≥s e os contras do armazenamento ef√™mero. </font><font style="vertical-align: inherit;">Dos benef√≠cios, voc√™ n√£o precisa pagar custos ocultos para o EBS, o atraso ser√° menor e voc√™ poder√° obter descontos em inst√¢ncias reservadas. </font><font style="vertical-align: inherit;">Das desvantagens, √© prov√°vel que voc√™ n√£o use todo o armazenamento interno (pelo qual continua pagando), e o uso de inst√¢ncias Spot se tornar√° muito mais dif√≠cil.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Remova volumes n√£o utilizados </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outra a√ß√£o que economizar√° dinheiro √© a remo√ß√£o de volumes desconectados e n√£o utilizados. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use o S3 para manter os backups do</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EBS pelo menos duas vezes mais caros que o S3! </font><font style="vertical-align: inherit;">De fato, voc√™ deve salvar backups no S3, e n√£o no EBS. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro, verifique se seus backups s√£o salvos de forma incremental e se as vers√µes antigas s√£o exclu√≠das periodicamente.</font></font></b> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5. Servi√ßo de cache el√°stico - n√≥s reservados </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poucos sabem que voc√™ pode comprar inst√¢ncias reservadas para o Elastic Cache. </font><font style="vertical-align: inherit;">As economias s√£o bastante significativas:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reserva de 1 ano - 65% de desconto </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reserva de 3 anos - 77% de desconto </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O processo √© semelhante √† aquisi√ß√£o de inst√¢ncias do EC2. </font><font style="vertical-align: inherit;">Para comprar um n√≥ reservado, voc√™ deve fazer o seguinte:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V√° para o Elastic Cache (n√£o inst√¢ncias reservadas do EC2) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ir para n√≥s reservados </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Clique no bot√£o azul "Comprar n√≥ reservado" no canto superior direito </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha Redis ou Memcached </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Selecionar tipo de n√≥ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha o per√≠odo de reserva desejado </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha o tipo de oferta (1 ou 3 anos) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Clique em Next </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outras economias de custo com o Elastic Cache s√£o quase as mesmas do EC2. </font><font style="vertical-align: inherit;">Voc√™ precisa desativar os n√≥s n√£o utilizados e reduzir o tamanho dos pr√≥prios n√≥s. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o existe um AWS Marketplace para Elastic Cache.</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Observe que n√£o existe um Marketplace para n√≥s reservados! </font><font style="vertical-align: inherit;">Antes de comprar, certifique-se de us√°-lo por pelo menos um ano.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. Transfer√™ncia de dados </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa linha de custo pode sair de controle rapidamente! </font><font style="vertical-align: inherit;">J√° √© dif√≠cil controlar de onde e de onde v√™m os dados e o rastreamento √© ainda mais dif√≠cil. </font><font style="vertical-align: inherit;">Al√©m disso, existem v√°rios tipos de transfer√™ncia de dados. </font><font style="vertical-align: inherit;">Por exemplo, transfer√™ncia de dados da nuvem, transfer√™ncia de dados entre regi√µes, transfer√™ncia de dados entre zonas de acesso, transfer√™ncia de dados S3, etc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vou contar como o Back4App reduziu o custo da transfer√™ncia de dados e como os rastreou.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como reduzir os custos de transfer√™ncia de dados na AWS? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aqui est√£o algumas coisas que voc√™ pode fazer para reduzir os custos de dados. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conecte o terminal S3 ao Cloudflare e outros servi√ßos CDN. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CDN (rede de entrega de conte√∫do ou rede de dados) Essa a√ß√£o simples pode reduzir seus custos de transfer√™ncia de dados em at√© cinco vezes, dependendo da quantidade de cache que voc√™ mant√©m. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IPs el√°sticos - use seus pr√≥prios endere√ßos IP sempre que poss√≠vel </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este √© um √≥timo exemplo! </font><font style="vertical-align: inherit;">A calculadora da AWS diz que a transfer√™ncia de dados para a nuvem √© gratuita para inst√¢ncias do EC2, mas voc√™ tamb√©m precisa preencher o campo "Public IP / Elastic IP Data Transfer". </font><font style="vertical-align: inherit;">Se voc√™ selecionar uma conex√£o usando um endere√ßo IP p√∫blico ou el√°stico ou um Elastic Load Balancer na rede Amazon, pagar√° taxas de transfer√™ncia de dados inter-regionais, mesmo que as inst√¢ncias estejam dentro da mesma zona de disponibilidade. </font><font style="vertical-align: inherit;">Para transferir dados dentro de uma zona de acesso, voc√™ pode facilmente evitar esses custos (e melhorar o desempenho da rede) usando seus endere√ßos IP pessoais sempre que poss√≠vel.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Use uma zona de disponibilidade - zona de disponibilidade </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando uma zona de disponibilidade em vez de v√°rias, voc√™ pode economizar significativamente. </font><font style="vertical-align: inherit;">Evite ou interrompa a transfer√™ncia de dados entre regi√µes.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Use a API GraphQL </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma das vantagens significativas do GraphQL √© a redu√ß√£o da entrega em excesso de dados e, como resultado, a redu√ß√£o na quantidade total de dados transferidos. </font><font style="vertical-align: inherit;">Substituir o REST pode ser uma tarefa assustadora, dependendo de como seu aplicativo est√° estruturado; </font><font style="vertical-align: inherit;">Al√©m disso, vale a pena avaliar antecipadamente a viabilidade dessa transi√ß√£o. </font><font style="vertical-align: inherit;">Outra alternativa √© usar o GraphQL sequencialmente para novos produtos e recursos.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Descontos por Volume na Transfer√™ncia de Dados </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso √© pouco aplic√°vel, pois os volumes necess√°rios para descontos s√£o muito grandes. </font><font style="vertical-align: inherit;">Isso pode ser √∫til apenas para grandes empresas ou grandes contas.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Use o CloudFront! </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode economizar uma fortuna se aplicar esta a√ß√£o! </font><font style="vertical-align: inherit;">Tamb√©m permitir√° aumentar a velocidade de seus aplicativos e, geralmente, reduzir a lat√™ncia - uma oferta ganha-ganha. </font><font style="vertical-align: inherit;">Vou falar sobre isso um pouco abaixo.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como acompanhar os custos de transfer√™ncia de dados? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Existem duas maneiras f√°ceis de rastrear custos de dados. </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Explorador de custos </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contas </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eles representam os dados coletados de maneiras diferentes e, dadas as duas vers√µes, voc√™ pode entender melhor como o dinheiro √© gasto na transfer√™ncia de dados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para acessar o relat√≥rio do Explorador de custos, acesse Meu painel de cobran√ßa e selecione Explorador de custos. </font><font style="vertical-align: inherit;">Selecione o relat√≥rio Gastar por exibi√ß√£o de servi√ßo e uma nova janela ser√° aberta. </font><font style="vertical-align: inherit;">O relat√≥rio preparado para os √∫ltimos 6 meses ser√° aberto e come√ßaremos com ele. </font><font style="vertical-align: inherit;">Observe que, na coluna Servi√ßo, N√ÉO h√° contas de dados! </font><font style="vertical-align: inherit;">Esses custos est√£o ocultos pelos filtros e voc√™ precisa ir mais fundo para encontr√°-los. </font></font><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/6.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para exibir os custos de transfer√™ncia de dados, voc√™ precisar√° configurar os filtros da seguinte maneira:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Clique em Mais filtros para expandi-los. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha Grupo de tipos de uso </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As informa√ß√µes de transfer√™ncia de dados s√£o exibidas </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha Transfer√™ncia de dados - Inter AZ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Escolha Transfer√™ncia de dados - Sa√≠da da Internet </font></font></li><li>  Data Transfer ‚Äì Region to Region Out </li><li>  S3 Data Transfer Out </li><li>  Apply Filters </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de aplicar todos os filtros, o relat√≥rio ter√° a seguinte apar√™ncia: </font></font><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/7.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora voc√™ classificou as informa√ß√µes sobre o tr√°fego e de onde ele vem, de S3 ou EC2. </font><font style="vertical-align: inherit;">Se desejar, voc√™ pode aplicar um processo semelhante e dividir ainda mais os custos por regi√£o e zona de acessibilidade. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outra maneira de mostrar os custos de tr√°fego √© com um relat√≥rio de cobran√ßa. </font><font style="vertical-align: inherit;">V√° para Meu painel de cobran√ßa e clique em Contas √† esquerda. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O relat√≥rio ter√° a seguinte apar√™ncia: </font></font><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/8.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que h√° uma an√°lise interna mostrando os custos da transfer√™ncia de dados do EC2. </font><font style="vertical-align: inherit;">Clique em Transfer√™ncia de dados e a an√°lise por regi√£o ser√° exibida. </font></font><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/9.png" alt="imagem"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depois de selecionar uma regi√£o, ser√° exibida uma discrimina√ß√£o por tipo de dados transmitidos (tr√°fego de sa√≠da, entre zonas de disponibilidade, inter-regional).</font></font><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/10.png" alt="imagem"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. CloudFront </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os pre√ßos sob demanda do Cloudfront est√£o diminuindo rapidamente √† medida que o volume aumenta. </font><font style="vertical-align: inherit;">Vamos imaginar a transmiss√£o de tr√°fego de 100 TB. </font><font style="vertical-align: inherit;">Custar√° US $ 0,060 / Gb, que √© cerca de 15% menos comparado √† mesma quantidade de dados via ELB.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contrato Privado na Nuvem e Pre√ßos de Volume </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° a melhor maneira de reduzir os custos de dados! </font><font style="vertical-align: inherit;">A AWS prefere usar seu servi√ßo CloudFront e, dependendo do volume, voc√™ pode reduzir o pre√ßo do tr√°fego de sa√≠da do CloudFront para US $ 0,02 / Gb. </font><font style="vertical-align: inherit;">Provavelmente, isso exigir√° um compromisso de dois anos e, se voc√™ planeja usar a AWS por um longo tempo, √© uma √≥tima oferta. </font><font style="vertical-align: inherit;">Para fazer esse arranjo, voc√™ precisa entrar em contato com o gerente da sua conta e perguntar sobre o contrato privado do CloudFront.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Certificado SSL personalizado do Amazon CloudFront </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifique se voc√™ est√° usando este certificado. </font><font style="vertical-align: inherit;">Custa US $ 20 por dia, e o mesmo pode ser comprado da Cloudflare por US $ 25 por m√™s. </font><font style="vertical-align: inherit;">Com um contrato de Pre√ßos privados e de volume, voc√™ n√£o poder√° usar outros servi√ßos CDN (Cloud Delivery Network), e esta a√ß√£o n√£o estar√° dispon√≠vel para voc√™.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8. S3 - Servi√ßo de Armazenamento Simples </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algumas recomenda√ß√µes para reduzir os pre√ßos do armazenamento S3. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ponto final S3 VPC </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma √≥tima id√©ia de economia que poucas pessoas recebem √© o uso do terminal S3 VPC. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A coloca√ß√£o de um terminal S3 na sua VPC (Virtual Private Cloud) fornece acesso a dados ao S3 e oferece seu pr√≥prio caminho dentro da nuvem, e a AWS n√£o cobra como se fosse tr√°fego p√∫blico. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependendo do volume, essa t√©cnica pode economizar v√°rios milhares de d√≥lares por m√™s.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Use o modelo de armazenamento correto e a classe de armazenamento apropriada. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem cinco modelos de armazenamento no total: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Padr√£o S3</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0,023 / GB </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√¢metros:</font></font></b> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Failover entre zonas de disponibilidade </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Baixa lat√™ncia e alto rendimento </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resistente a eventos que afetam toda a zona de disponibilidade. </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acesso infrequente S3</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0,0125 / GB </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√¢metros:</font></font></b> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ideal para armazenamento a longo prazo, backups e arquivos em caso de recupera√ß√£o de backup </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Failover entre zonas de disponibilidade </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para acesso pouco frequente, j√° que quanto maior o custo de acessar arquivos </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acesso infrequente de uma zona S3</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0,010 / GB </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√¢metros:</font></font></b> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uma zona de disponibilidade </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para acesso pouco frequente </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ìtima op√ß√£o para backups de backup </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geleira S3</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0,004 / GB </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes:</font></font></b> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tipo de armazenamento seguro, confi√°vel e barato para arquivos de dados </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Failover entre zonas de disponibilidade </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As op√ß√µes de upload de dados podem levar de alguns minutos a v√°rias horas </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S3 Glacier Deep Archive</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 0.00099 / GB </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√¢metros:</font></font></b> <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O menor pre√ßo por gigabyte e suporte para armazenamento de longo prazo e preserva√ß√£o digital de dados que podem ser necess√°rios algumas vezes por ano. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tempo de descarregamento em 12 horas </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Failover entre zonas de disponibilidade </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os pre√ßos da API S3 podem ser confusos. </font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que toda vez que voc√™ altera a classe de armazenamento de objetos, paga pelo n√∫mero de solicita√ß√µes. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pode ser muito dif√≠cil! </font><font style="vertical-align: inherit;">Vou compartilhar a situa√ß√£o que ocorreu no Back4App. </font><font style="vertical-align: inherit;">Um de nossos clientes armazena milh√µes de objetos pequenos e os dados raramente s√£o procurados. </font><font style="vertical-align: inherit;">Inicialmente, mantivemos todos os objetos no S3 Standard e decidimos transferi-los para o S3 Glacier para salvar. </font><font style="vertical-align: inherit;">At√© a√≠ tudo bem! </font><font style="vertical-align: inherit;">Mas n√£o levamos em conta que a AWS cobra US $ 0,05 por cada 1000 chamadas para o Glacier! </font><font style="vertical-align: inherit;">No nosso caso, o n√∫mero de solicita√ß√µes era enorme; portanto, o custo da mudan√ßa n√£o compensava! </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de mover objetos entre as classes de armazenamento, √© necess√°rio considerar o pre√ßo das solicita√ß√µes ao S3 e realizar uma an√°lise de retorno.</font></font></b> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Excluir dados n√£o utilizados no S3 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A maneira mais f√°cil e eficaz de economizar no S3 √© simplesmente excluir dados antigos e n√£o utilizados. </font><font style="vertical-align: inherit;">D√™ uma olhada nos backups antigos e no balde S3 n√£o utilizado. </font><font style="vertical-align: inherit;">Fa√ßa uma an√°lise e, se poss√≠vel, exclua os dados.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9. Escolha o plano de suporte t√©cnico da AWS com sabedoria </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Existem 4 tipos de suporte t√©cnico no total: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> B√°sico - Gr√°tis </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Desenvolvedor - US $ 29 / m√™s ou 3% da fatura todo m√™s </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comercial - US $ 100 / m√™s ou 10 a 3% da conta, dependendo do volume </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Empresa - US $ 15.000 por m√™s </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tentamos o plano de neg√≥cios e ficamos insatisfeitos com o resultado. Em nossa opini√£o, √© muito caro para o n√≠vel de suporte e suporte que ele fornece. N√£o posso dizer nada sobre o n√≠vel Enterprise, pois n√£o o usamos. (O n√≠vel Enterprise √© adequado, por exemplo, para grandes empresas antes de lan√ßar grandes estreias ou produtos.) </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envolva o seu gerente regional da AWS</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use seu gerente regional e arquiteto de solu√ß√µes ao m√°ximo! </font><font style="vertical-align: inherit;">Eles trabalham separadamente da equipe de suporte central e podem fornecer servi√ßos muito mais adequados. </font><font style="vertical-align: inherit;">A equipe da AWS geralmente √© muito qualificada e ajuda muito! </font><font style="vertical-align: inherit;">As recomenda√ß√µes que eles forneceram sobre configura√ß√µes avan√ßadas de seguran√ßa e o uso do GDPR foram simplesmente as melhores! </font><font style="vertical-align: inherit;">Fiquei impressionado com a consci√™ncia t√©cnica e o desejo de nos ajudar a alcan√ßar melhores resultados. </font><font style="vertical-align: inherit;">Esse suporte faz voc√™ pensar duas vezes antes de alterar seu provedor de nuvem.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10. Monitoramento e Gerenciamento </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â dif√≠cil superestimar a import√¢ncia de calcular e conhecer os custos di√°rios. </font><font style="vertical-align: inherit;">Voc√™ deve configurar um monitoramento detalhado de seus custos e dedicar algum tempo todos os dias para se familiarizar com eles. </font><font style="vertical-align: inherit;">Imagine quanto voc√™ pode economizar em 365 dias! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O monitoramento di√°rio ajudar√° a detectar tend√™ncias suspeitas e a agir imediatamente. </font><font style="vertical-align: inherit;">As melhores pr√°ticas relacionadas ao monitoramento e gerenciamento est√£o listadas abaixo:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Monitoramento regular </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usando relat√≥rios como: </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Relat√≥rio de gerenciamento de faturamento e custo </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contas mensais </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Explorador de custos - custos mensais de servi√ßo </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Explorador de custos - usando o RI </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Explorador de custos - Cobertura do RI </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Marcar tudo </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Me√ßa a m√©dia, acompanhe, relate exce√ß√µes </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Relacione seu ambiente ao modelo de responsabilidade compartilhada da AWS </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Use CloudWatch e Trusted Advisor para monitorar custos </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Combine suas contas e obtenha descontos por volume </font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. Redesenho da arquitetura </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alterar a arquitetura geralmente √© o exerc√≠cio que consome mais tempo. </font><font style="vertical-align: inherit;">Pode levar de semanas a meses, dependendo do tamanho da sua arquitetura. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nossa experi√™ncia com o Back4App mostra que voc√™ deve tentar as etapas mais simples primeiro. </font><font style="vertical-align: inherit;">Em geral, mudan√ßas sucessivas proporcionam economias significativas no curto prazo. </font><font style="vertical-align: inherit;">Ganhe dinheiro com essas mudan√ßas e ganhe experi√™ncia para reconstruir sua arquitetura.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 12. Conclus√£o </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o existe uma f√≥rmula m√°gica para reduzir imediatamente os custos na AWS! </font><font style="vertical-align: inherit;">√â necess√°rio desenvolver um h√°bito rotineiro de verificar despesas, estabelecer prioridades e trabalhar duro para alcan√ßar seus objetivos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° uma breve vis√£o geral das etapas que nos ajudaram a reduzir nossa pontua√ß√£o na AWS.</font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excluir inst√¢ncias EC2 n√£o utilizadas</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reduzir o excesso de energia</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mover o fluxo de dados para o CloudFront</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alterne para novas gera√ß√µes de inst√¢ncias</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use t√©cnicas como rede aprimorada</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salvar backups no S3</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reservar inst√¢ncias no AWS Marketplace e n√≥s de cache el√°stico</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mantenha uma combina√ß√£o saud√°vel de inst√¢ncias Spot, Reservadas e Sob Demanda</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatize o dimensionamento autom√°tico</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use o S3 Standard e o Glacier</font></font></b> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt467843/">https://habr.com/ru/post/pt467843/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt467825/index.html">Algoritmos obrigat√≥rios de aprendizado de m√°quina</a></li>
<li><a href="../pt467827/index.html">Como fizemos nossa pequena Unidade a partir do zero</a></li>
<li><a href="../pt467831/index.html">O caminho espinhoso para a programa√ß√£o</a></li>
<li><a href="../pt467837/index.html">MCU ‚ÄúTerr√≠vel‚Äù de tr√™s centavos - uma breve vis√£o geral dos microcontroladores que custam menos de US $ 0,1</a></li>
<li><a href="../pt467841/index.html">Facilite a conclus√£o: Entrevista com John Romero, desenvolvedor do Doom</a></li>
<li><a href="../pt467847/index.html">"Evolu√ß√£o omnichannel da IoT" ou como a Internet das coisas pode afetar o omnichannel</a></li>
<li><a href="../pt467849/index.html">Peloton: pr√≥xima Apple ou outro golpe?</a></li>
<li><a href="../pt467851/index.html">Verifique a qualidade sem sair da caixa registradora</a></li>
<li><a href="../pt467853/index.html">Evolu√ß√£o do cart√£o de visita: do cart√£o √† aplica√ß√£o</a></li>
<li><a href="../pt467855/index.html">Novo 2GIS: um mapa completo da R√∫ssia e a busca de mercadorias em lojas offline</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>