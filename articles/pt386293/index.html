<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÇ üçú üöô Interfaces para dispositivo de balan√ßo de ber√ßo - do chaveiro √† Web üê® üö¥üèª üßòüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pouco mais de um ano se passou desde a reda√ß√£o do meu primeiro artigo sobre um dispositivo para balan√ßar um ber√ßo. Durante esse per√≠odo, desenvolvi um...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interfaces para dispositivo de balan√ßo de ber√ßo - do chaveiro √† Web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/386293/"><div style="text-align:center;"><img src="https://habrastorage.org/files/a17/b69/b13/a17b69b1341b4ba38455428341654685.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pouco mais de um ano se passou desde a reda√ß√£o do meu primeiro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre um dispositivo para balan√ßar um ber√ßo. </font><font style="vertical-align: inherit;">Durante esse per√≠odo, desenvolvi um novo painel de controle com uma tela e, em seguida, uma interface da web para esse dispositivo. </font><font style="vertical-align: inherit;">Se voc√™ estiver interessado em aprender mais, seja bem-vindo ao gato.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No come√ßo - algumas palavras sobre o dispositivo em si, um breve resumo da s√©rie anterior. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, o dispositivo foi projetado para balan√ßar um ber√ßo com um mecanismo de p√™ndulo. Uma unidade de acionamento com um eletro√≠m√£ e componentes eletr√¥nicos internos √© instalada na parte fixa do ber√ßo. Um √≠m√£ de neod√≠mio √© fixado na parte m√≥vel. Voando sobre um eletro√≠m√£, um √≠m√£ permanente induz um CEM, cuja forma determina o momento de conectar o mesmo eletro√≠m√£ a uma fonte de energia. Assim, o eletro√≠m√£ no momento certo empurra o √≠m√£ permanente e, portanto, a parte m√≥vel do ber√ßo. Ao mesmo tempo em que o eletro√≠m√£ n√£o √© alimentado, ele desempenha o papel de um sensor de posi√ß√£o para a parte m√≥vel do ber√ßo.</font></font><br>
<br>
<img src="https://habrastorage.org/files/79a/544/62a/79a54462afb845d7b06548478ca65f9e.gif" height="350" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/e80/6e9/0bd/e806e90bd42d464c72d0cef045499ea0.jpg" alt="imagem" height="350"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fiz a primeira c√≥pia do dispositivo para mim. Depois, descobriu-se que esses dispositivos podem ser vendidos e, por mais de tr√™s anos, venho fazendo isso com graus variados de sucesso. Agora, em pequenos lotes, quatro modelos do dispositivo s√£o fabricados e vendidos atrav√©s de um dos maiores fabricantes russos de m√≥veis infantis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No primeiro modelo do dispositivo para balan√ßar um ber√ßo, esse controle remoto √© usado como painel de controle. Existem quatro bot√µes com as funcionalidades "Iniciar", "Parar", "Mais forte" e "Mais fraco". Conseq√ºentemente, usando este controle remoto, voc√™ pode iniciar e parar o balan√ßo, al√©m de alterar sua intensidade - escolha um dos seis n√≠veis poss√≠veis. O chaveiro opera em uma frequ√™ncia de 433 MHz e n√£o possui feedback.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/845/aa6/11b/845aa611b6ee4769bed8bd30d1f63f4c.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s algum tempo, uma vers√£o simplificada do dispositivo (modelo 0) foi desenvolvida, geralmente sem um painel de controle. Eles apertaram o ber√ßo com a m√£o - e ele continua oscilando indefinidamente. Parado - balan√ßando parado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No desenvolvimento do pr√≥ximo, segundo modelo do dispositivo de oscila√ß√£o (modelo 2), a tarefa principal era adicionar um temporizador de enj√¥o e iniciar o balan√ßo com o choro da crian√ßa. E isso acabou sendo um problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O fato √© que o tempo de oscila√ß√£o deve ser definido de alguma forma, em horas e minutos. E a sensibilidade do microfone tamb√©m seria interessante de alguma forma. Mas tudo isso requer uma interface, e um controle remoto "cego" com quatro bot√µes claramente n√£o √© suficiente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, o primeiro pensamento foi fazer alguma indica√ß√£o no gabinete do dispositivo. Coloque alguns LEDs e / ou uma pequena tela. E controle tamb√©m, com a ajuda deste pequeno controle remoto. No entanto, a desvantagem desta solu√ß√£o √© que o dispositivo geralmente √© instalado em um local inacess√≠vel, em algum lugar na parede traseira do ber√ßo contra a parede. E as indica√ß√µes no caso neste caso simplesmente n√£o ser√£o vis√≠veis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por isso, foi decidido fazer um painel de controle com um monitor. Um pouco menos de um ano de desenvolvimento - e o dispositivo com o controle remoto est√° pronto!</font></font><br>
<br>
<img src="https://habrastorage.org/files/6a7/2bd/a6e/6a72bda6ecfa4102917ccc6e36500b74.gif" align="left" height="350"><img src="https://habrastorage.org/files/c9d/5ad/290/c9d5ad290d064d5ababcf7b905b865cf.gif" height="350"><div style="text-align:center;"><img src="https://habrastorage.org/files/a5f/177/1dc/a5f1771dccce41aebe3815e49227f58c.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dentro do console est√° o ATMega32A, a tela √© uma tela do Nokia 1202 e o transceptor √© NRF24L01 +. O case √© padr√£o pronto, o teclado √© filme. No controle remoto, voc√™ pode definir o tempo de enj√¥o, sensibilidade do microfone, intensidade do balan√ßo, al√©m de iniciar e interromper o processo. No caso de v√°rias camas no mesmo quarto, existe a possibilidade de alterar o canal de controle, pois o NRF24L01 + permite isso facilmente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O console e o dispositivo est√£o constantemente em di√°logo entre si. Isso √© feito para feedback - o status atual do dispositivo √© exibido na tela, a saber, se o processo de oscila√ß√£o est√° em andamento ou n√£o (se houver, a imagem do ber√ßo no controle remoto tamb√©m est√° oscilando), quanto tempo resta para bombear, quais s√£o as configura√ß√µes atuais para a intensidade da doen√ßa de movimento e a sensibilidade do microfone. Para que as baterias no painel de controle n√£o sejam descarregadas muito rapidamente, √© fornecido um modo de suspens√£o - se ningu√©m pressionar os bot√µes no controle remoto por meia hora, o controle remoto "adormecer√°".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s o desenvolvimento e o lan√ßamento do "Modelo 2", embora em uma produ√ß√£o modesta, mas ainda assim, continuei pensando em melhorar o dispositivo de giro. Seria √≥timo, pensei, se voc√™ pudesse controlar o dispositivo a partir de um telefone celular! Ou de um tablet. Por exemplo, quando durmo, coloco um telefone celular ao meu lado. H√° um despertador e correio, e voc√™ pode ler algo antes de dormir. E certamente muitos pais jovens tamb√©m. Por que usar um controle remoto separado para o dispositivo de oscila√ß√£o quando aqui est√° - algo universal - um smartphone ou tablet! Que ele seja o painel de controle, pensei.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quais interfaces de r√°dio mais ou menos adequadas existem em um smartphone moderno? Bluetooth e Wi-Fi. No come√ßo, considerei controlar o dispositivo de oscila√ß√£o via Bluetooth. Das vantagens - √© f√°cil de implementar a partir do lado do dispositivo. Voc√™ pode usar o m√≥dulo - o "bridge" Bluetooth-UART, e este √© o problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â verdade, do lado do smartphone - problemas cont√≠nuos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, mantendo o Bluetooth no telefone o tempo todo √© uma m√° id√©ia. Al√©m disso, para cada sistema operacional, voc√™ ter√° que escrever seu pr√≥prio software, esses s√£o pelo menos dois aplicativos - para Android e iPhone. Mas tamb√©m existem telefones no Windows Phone ... Depois de me aprofundar um pouco mais no assunto, descobri que nada pode funcionar com o iPhone, parece haver algumas limita√ß√µes. Bem, mesmo que tudo d√™ certo. Os pedidos devem ser escritos primeiro. Em seguida, publique nas lojas apropriadas. Em seguida, eles precisam ser mantidos em boas condi√ß√µes de funcionamento, para corrigir erros e responder aos coment√°rios do usu√°rio. O problema √© que nunca fiz nada disso, para mim √© uma "floresta sombria com guerrilheiros" e, para essa parte do trabalho, voc√™ precisa contratar uma pessoa experiente. E contratar n√£o apenas uma vez e, em seguida, colaborar constantemente com ele em termos de suporte ao programa.Bem, ou aprenda tudo sozinho. Acontece de alguma forma caro e tecnicamente feio. Portanto, o Bluetooth desaparece.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E ent√£o eu descobri a exist√™ncia do ESP8266. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, j√° foi escrito muito sobre esses m√≥dulos, al√©m disso, h√° um excelente f√≥rum em russo sobre eles. H√° pouco menos de um ano, tendo come√ßado a considerar este m√≥dulo para a minha aplica√ß√£o, durante muito tempo n√£o pude formar uma opini√£o sobre suas capacidades. E agora, a julgar pelas perguntas dos novatos no mesmo f√≥rum, vejo que muitos n√£o sabem do que esse m√≥dulo (chip) √© capaz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° uma coisa importante a dizer aqui - inicialmente o ESP8266 foi "equipado" com um SDK chin√™s muito "bruto" e "buggy" e, portanto, o chip n√£o p√¥de ser usado para resolver tarefas reais de "combate". Ent√£o, √© claro, era poss√≠vel jogar, piscar o LED, mas era imposs√≠vel fazer algo funcionando de maneira est√°vel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No ano passado, no entanto, a situa√ß√£o mudou fundamentalmente. Em um f√≥rum em russo dedicado a esse chip, um de seus participantes implementou um projeto - "Desenvolvimento de uma 'biblioteca' de um pequeno servidor da Web no ESP8266". Uma pessoa inc√≥gnita incr√≠vel que se esconde sob o apelido pvvx do firmware criado quase sozinho para o ESP8266, que permite revelar completamente os recursos desse chip. Os c√≥digos-fonte do projeto est√£o dispon√≠veis para acesso p√∫blico, o autor permite que sejam usados ‚Äã‚Äãcomo voc√™ desejar, inclusive para fins comerciais. Al√©m disso, o pvvx continua complementando a montagem com novos recursos e, muito importante, est√° presente ativamente no f√≥rum e n√£o se cansa (bem, provavelmente) de aconselhar iniciantes (e n√£o iniciantes tamb√©m).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado disso, n√£o tenho medo de um trabalho extraordin√°rio, tornou-se poss√≠vel (entre muitas outras coisas) fornecer a qualquer dispositivo uma interface da Web completa e est√°vel. Os recursos do chip e do firmware n√£o se limitam a este aplicativo, mas eu precisava resolver esse mesmo problema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As vantagens de usar o ESP8266 s√£o √≥bvias e, al√©m disso, atualmente n√£o h√° outras op√ß√µes compar√°veis ‚Äã‚Äãem pre√ßo e funcionalidade.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, a um pre√ßo de cerca de 170 rublos no m√≥dulo ESP8266, voc√™ pode organizar um servidor da Web com uma interface de controle de dispositivo, o que permite que voc√™ n√£o grave nenhum programa em nenhum sistema operacional, apenas uma vez para criar uma interface da Web. O m√≥dulo pode operar como um ponto de acesso e uma esta√ß√£o, bem como simultaneamente nesses dois modos. Por exemplo, conectando-se ao m√≥dulo como um ponto de acesso, voc√™ pode configurar seus par√¢metros de comunica√ß√£o e, se desejar, conectar o m√≥dulo como uma esta√ß√£o √† sua rede Wi-Fi dom√©stica. A montagem (‚Äúdespejo‚Äù, como o autor chama respeitosamente) tem muitas configura√ß√µes (mais de 250) dispon√≠veis na interface da web.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, h√° outro firmware para o ESP8266, mas nenhum deles possui recursos, estabilidade e qualidade de trabalho como a montagem do pvvx (esta √© minha opini√£o subjetiva, no que diz respeito √† minha tarefa). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com base nesse firmware, uma interface da web foi desenvolvida para um dispositivo de balan√ßo. A web part em si foi escrita de tal forma que o site foi exibido corretamente em v√°rias telas com tamanhos e resolu√ß√µes diferentes. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/e3b/b52/a67/e3bb52a67c6cf9fdf15a8298999d67c2.jpg" alt="imagem" height="800" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/f57/0b3/440/f570b344063bba844ebf23a8394eb634.jpg" alt="imagem" height="397" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/4a6/8db/1f4/4a68db1f4fad6a2bfaea052ef086adaa.jpg" alt="imagem" height="397"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, o hardware do dispositivo teve que ser refeito em grande escala (de fato - feito novamente). O algoritmo de oscila√ß√£o agora est√° implementado no microcontrolador Attiny441, interagindo com o ESP8266 via UART. A alimenta√ß√£o de 3,3 volts √© feita usando o ST1S10. Placa opcional com erro (corrigida pela montagem na superf√≠cie):</font></font><br>
<br>
<img src="https://habrastorage.org/files/469/e9d/477/469e9d477ad747f39a40291cfad1b0fa.gif" height="350" align="left"><img src="https://habrastorage.org/files/595/0b9/378/5950b9378053444ba6b86cdf831d5ad6.gif" height="350"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, agora ficou mais f√°cil do que nunca "amarrar" o Wi-Fi e a interface da Web a qualquer coisa. </font><font style="vertical-align: inherit;">Ao mesmo tempo, o sistema funcionar√° de maneira est√°vel e o custo dos componentes ser√° de apenas 250 rublos (se voc√™ calcular toda a liga√ß√£o, n√£o apenas o pr√≥prio m√≥dulo ESP8266). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E assim apareceu a interface web do dispositivo para balan√ßar um ber√ßo.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt386293/">https://habr.com/ru/post/pt386293/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt386281/index.html">Capta√ß√£o de recursos para um scanner incomum que pode lidar rapidamente mesmo com livros</a></li>
<li><a href="../pt386283/index.html">5 casos originais de marcas se promovendo atrav√©s de jogos</a></li>
<li><a href="../pt386285/index.html">Apresentando o LXBOX 3 Mini PC</a></li>
<li><a href="../pt386287/index.html">O sistema de resgate coletivo de avi√µes foi criado. Isso n√£o √© lucrativo - responda nas companhias a√©reas</a></li>
<li><a href="../pt386291/index.html">De que, de qu√™, de que s√£o feitos nossos rob√¥s?</a></li>
<li><a href="../pt386295/index.html">O Google Inbox agora ajuda a responder a e-mails usando alta tecnologia</a></li>
<li><a href="../pt386297/index.html">Aguardando um infospace compartilhado</a></li>
<li><a href="../pt386299/index.html">Samsung anunciou um novo bioprocessador para dispositivos vest√≠veis</a></li>
<li><a href="../pt386301/index.html">Virgin Galactic mostrar√° a nova vers√£o do SpaceShipTwo em fevereiro de 2016</a></li>
<li><a href="../pt386303/index.html">L√¢mpada inteligente que salvar√° dos ladr√µes. Embarques Beon iniciados</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>