<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∏üèø üëÉüèª ü§∏üèΩ Arquitetura pragm√°tica pura. Brainstorming üë©üèæ‚Äçü§ù‚Äçüë®üèº üëéüèø ‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A id√©ia surgiu na sua cabe√ßa para reescrever seu aplicativo corporativo ousado do zero? Se a partir do zero, ent√£o √© uau. Pelo menos duas vezes menos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arquitetura pragm√°tica pura. Brainstorming</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/419179/">  A id√©ia surgiu na sua cabe√ßa para reescrever seu aplicativo corporativo ousado do zero?  Se a partir do zero, ent√£o √© uau.  Pelo menos duas vezes menos c√≥digo, certo?  Mas alguns anos se passar√£o, e tamb√©m crescer√°, se tornar√° legado ... n√£o h√° muito tempo e dinheiro para que a reescrita funcione perfeitamente. <br><br>  Calma, as autoridades ainda n√£o permitir√£o reescrever nada.  Resta refatorar.  Qual √© a melhor maneira de gastar seus pequenos recursos?  Como refatorar onde limpar? <br><br>  O t√≠tulo deste artigo inclui uma refer√™ncia ao livro do tio Bob <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Arquitetura limpa"</a> , e foi feito com base em um maravilhoso relat√≥rio de Victor Rentea ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">twitter</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site</a> ) na JPoint (sob o gato que ele come√ßar√° a falar na primeira pessoa, mas por enquanto leia a introdu√ß√£o).  Lendo livros inteligentes, este artigo n√£o substitui, mas para uma descri√ß√£o t√£o curta √© apresentada muito bem. <br><br>  A id√©ia √© que coisas populares como ‚ÄúArquitetura Limpa‚Äù sejam realmente √∫teis.  Surpresa  Se voc√™ precisar resolver um problema muito espec√≠fico, um c√≥digo simples e elegante n√£o exige esfor√ßo extra e engenharia em excesso.  A arquitetura pura diz que voc√™ precisa proteger seu modelo de dom√≠nio contra efeitos externos e informa exatamente como isso pode ser feito.  Uma abordagem evolutiva para aumentar o volume de microsservi√ßos.  Testes que tornam a refatora√ß√£o menos assustadora.  Voc√™ j√° sabe tudo isso?  Ou voc√™ sabe, mas voc√™ tem medo de pensar nisso, porque √© um horror o que voc√™ ter√° que fazer ent√£o? <br><br>  Quem deseja obter uma p√≠lula m√°gica anti-procrastina√ß√£o que ajudar√° a parar de tremer e come√ßar√° a refatora√ß√£o - bem-vindo √† grava√ß√£o em v√≠deo do relat√≥rio ou abaixo do gato. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mBxpOvlbAow" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><a name="habracut"></a><br><br>  Meu nome √© Victor, sou da Rom√™nia.  Formalmente, sou consultor, especialista t√©cnico e arquiteto l√≠der da IBM romena.  Mas, se me pedissem para definir uma defini√ß√£o de minha atividade, sou um evangelista de c√≥digo puro.  Gosto de criar um c√≥digo bonito, limpo e com suporte - como regra, falo sobre isso nos relat√≥rios.  Ainda mais, sou inspirado pelo ensino: treinando desenvolvedores nas √°reas de Java EE, Spring, Dojo, Desenvolvimento Orientado a Testes, Desempenho em Java, bem como no campo do evangelismo mencionado - os princ√≠pios dos padr√µes de c√≥digo limpo e seu desenvolvimento. <br><br>  A experi√™ncia em que minha teoria se baseia √© principalmente o desenvolvimento de aplicativos corporativos para o maior cliente IBM da Rom√™nia - o setor banc√°rio. <br><br>  O plano para este artigo √© o seguinte: <br><br><ul><li>  Modelagem de dados: estruturas de dados n√£o devem se tornar nossos inimigos; <br></li><li>  Organiza√ß√£o da l√≥gica: o princ√≠pio da "decomposi√ß√£o do c√≥digo, que √© demais"; <br></li><li>  "Onion" √© a mais pura arquitetura de filosofia do Script de Transa√ß√£o; <br></li><li>  Testar como uma maneira de lidar com os medos dos desenvolvedores. <br></li></ul><br><br>  Mas primeiro, vamos relembrar os principais princ√≠pios que n√≥s, como desenvolvedores, devemos sempre lembrar. <br><br><h4>  Princ√≠pio da responsabilidade exclusiva </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/353/dd0/cd5/353dd0cd58012749b70e379e37231265.jpg"><br><br>  Em outras palavras, quantidade versus qualidade.  Por via de regra, quanto mais funcionalidade a sua turma contiver, pior ser√° a qualidade.  Ao desenvolver grandes classes, o programador come√ßa a ficar confuso, cometer erros na cria√ß√£o de depend√™ncias e o c√≥digo grande, entre outras coisas, √© mais dif√≠cil de depurar.  √â melhor dividir essa classe em v√°rias classes menores, cada uma das quais ser√° respons√°vel por alguma subtarefa.  √â melhor ter alguns m√≥dulos firmemente acoplados do que um - grande e lento.  A modularidade tamb√©m permite a reutiliza√ß√£o da l√≥gica. <br><br><h4>  Liga√ß√£o fraca do m√≥dulo </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f72/1c8/0f7/f721c80f7b3184be2218a01b66f7440a.jpg"><br><br>  O grau de liga√ß√£o √© uma medida de qu√£o estreitamente seus m√≥dulos interagem entre si.  Ele mostra qu√£o amplamente o efeito das altera√ß√µes que voc√™ faz em qualquer ponto do sistema √© capaz de se espalhar.  Quanto maior a vincula√ß√£o, mais dif√≠cil √© fazer modifica√ß√µes: voc√™ altera alguma coisa em um m√≥dulo e o efeito se estende para longe e nem sempre da maneira esperada.  Portanto, o indicador de liga√ß√£o deve ser o mais baixo poss√≠vel - isso fornecer√° mais controle sobre o sistema que est√° passando por modifica√ß√µes. <br><br><h4>  N√£o repita </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b9/9de/5c0/2b99de5c00257d6123553c7bfaed0519.jpg"><br><br>  Suas pr√≥prias implementa√ß√µes podem ser boas hoje, mas n√£o t√£o boas amanh√£.  N√£o permita copiar suas pr√≥prias pr√°ticas recomendadas e, assim, distribu√≠-las em uma base de c√≥digo.  Voc√™ pode copiar do StackOverflow, de livros - de qualquer fonte autorizada que (como voc√™ sabe com certeza) ofere√ßa uma implementa√ß√£o ideal (ou pr√≥xima disso).  Melhorar sua pr√≥pria implementa√ß√£o, que ocorre mais de uma vez, mas multiplicada por toda a base de c√≥digo, pode ser muito cansativo. <br><br><h4>  Simplicidade e concis√£o </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7d4/8d4/c85/7d48d4c85408c620ddcbe644c4acb6f9.jpg"><br><br>  Na minha opini√£o, esse √© o princ√≠pio principal que deve ser observado na engenharia e no desenvolvimento de software.  "O encapsulamento prematuro √© a raiz do mal", disse Adam Bien.  Em outras palavras, a raiz do mal est√° na "reengenharia".  O autor da cita√ß√£o, Adam Bien, ao mesmo tempo estava envolvido em aceitar aplicativos herdados e, reescrevendo completamente seu c√≥digo, recebeu uma base de c√≥digo 2-3 vezes menor que a original.  De onde vem tanto c√≥digo extra?  Afinal, surge por uma raz√£o.  Seus medos d√£o origem a n√≥s.  Parece-nos que, acumulando um grande n√∫mero de padr√µes, gerando indiretos e abstra√ß√µes, fornecemos nosso c√≥digo com prote√ß√£o - prote√ß√£o contra as inc√≥gnitas de amanh√£ e os requisitos de amanh√£.  Afinal, de fato, hoje n√£o precisamos de nada disso, inventamos tudo isso apenas em prol de algumas "necessidades futuras".  E √© poss√≠vel que essas estruturas de dados interfiram posteriormente.  Para ser sincero, quando alguns de meus desenvolvedores me procuram e dizem que ele encontrou algo interessante que pode ser adicionado ao c√≥digo de produ√ß√£o, eu sempre respondo da mesma maneira: "Cara, isso n√£o ser√° √∫til para voc√™". <br><br>  N√£o deve haver muito c√≥digo, e aquele que deve ser simples - a √∫nica maneira de trabalhar normalmente com ele.  Essa √© uma preocupa√ß√£o para seus desenvolvedores.  Voc√™ deve se lembrar que eles s√£o os √≠ndices do seu sistema.  Tente reduzir o consumo de energia, reduzir os riscos com os quais eles ter√£o que trabalhar.  Isso n√£o significa que voc√™ precise criar sua pr√≥pria estrutura, al√©m disso, eu n√£o o aconselharia a fazer isso: sempre haver√° erros em sua estrutura, todos precisar√£o estud√°-la, etc.  √â melhor usar os recursos existentes, dos quais existe uma massa hoje.  Estas devem ser solu√ß√µes simples.  Anote manipuladores de erro globais, aplique tecnologia de aspecto, geradores de c√≥digo, extens√µes Spring ou CDI, configure escopos de Solicita√ß√£o / Encadeamento, use manipula√ß√£o e gera√ß√£o de bytecodes em tempo real, etc. Tudo isso ser√° sua contribui√ß√£o para a coisa realmente mais importante - o conforto do seu desenvolvedor. <br><br>  Em particular, gostaria de demonstrar a voc√™ a aplica√ß√£o das √°reas Solicita√ß√£o / Encadeamento.  Eu observei v√°rias vezes como isso simplificou incrivelmente os aplicativos corporativos.  O ponto principal √© que ele oferece a oportunidade, como usu√°rio conectado, de salvar os dados do RequestContext.  Assim, o RequestContext armazenar√° os dados do usu√°rio em um formato compacto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/341/6c5/474/3416c54740aca3b8f514696bf9cf7f3d.jpg"><br><br>  Como voc√™ pode ver, a implementa√ß√£o requer apenas algumas linhas de c√≥digo.  Depois de escrever o pedido na anota√ß√£o necess√°ria (n√£o √© dif√≠cil faz√™-lo se voc√™ usar o Spring ou CDI), voc√™ se libertar√° da necessidade de passar o login do usu√°rio para os m√©todos e o que quer que seja: os metadados do pedido armazenados no contexto navegam de forma transparente no aplicativo.  O proxy com escopo definido permitir√° que voc√™ acesse os metadados da solicita√ß√£o atual a qualquer momento. <br><br><h4>  Testes de regress√£o </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5c5/edf/d7a/5c5edfd7a14d760bc335d8e65f0d5666.jpg"><br><br>  Os desenvolvedores t√™m medo de requisitos atualizados porque t√™m medo de procedimentos de refatora√ß√£o (modifica√ß√µes no c√≥digo).  E a maneira mais f√°cil de ajud√°-los √© criar um conjunto de testes confi√°vel para testes de regress√£o.  Com isso, o desenvolvedor ter√° a oportunidade, a qualquer momento, de testar seu tempo de opera√ß√£o - para garantir que n√£o interrompa o sistema. <br><br>  O desenvolvedor n√£o deve ter medo de quebrar nada.  Voc√™ deve fazer tudo para que a refatora√ß√£o seja percebida como algo bom. <br>  A refatora√ß√£o √© um aspecto cr√≠tico do desenvolvimento.  Lembre-se, exatamente no momento em que seus desenvolvedores t√™m medo de refatorar, o aplicativo pode ser considerado um legado. <br><br><h2>  Onde implementar a l√≥gica de neg√≥cios? </h2><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fb/8a2/08d/4fb8a208dc6d89279a663747de74369f.jpg"><br><br>  Iniciando a implementa√ß√£o de qualquer sistema (ou componentes do sistema), nos perguntamos: onde √© melhor implementar a l√≥gica do dom√≠nio, ou seja, os aspectos funcionais da nossa aplica√ß√£o?  Existem duas abordagens opostas. <br>  O primeiro √© baseado na filosofia do <i>Script de Transa√ß√£o</i> .  Aqui, a l√≥gica √© implementada em procedimentos que funcionam com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entidades an√™micas</a> (ou seja, com estruturas de dados).  Essa abordagem √© boa porque, no decorrer de sua implementa√ß√£o, √© poss√≠vel confiar nas tarefas de neg√≥cios formuladas.  Enquanto trabalhava em aplicativos para o setor banc√°rio, observei repetidamente a transfer√™ncia de procedimentos de neg√≥cios para software.  Posso dizer que √© realmente muito natural correlacionar cen√°rios com software. <br><br>  Uma abordagem alternativa √© usar os princ√≠pios do <i>Design Orientado a Dom√≠nio</i> .  Aqui voc√™ precisar√° correlacionar especifica√ß√µes e requisitos com uma metodologia orientada a objetos.  √â importante considerar cuidadosamente os objetos e garantir um bom envolvimento comercial.  A vantagem dos sistemas projetados dessa maneira √© que, no futuro, eles ser√£o facilmente mantidos.  No entanto, na minha experi√™ncia, dominar essa metodologia √© bastante dif√≠cil: voc√™ se sentir√° mais ou menos corajoso n√£o antes de seis meses estudando-a. <br><br>  Para meus desenvolvimentos, sempre escolhi a primeira abordagem.  Posso garantir que, no meu caso, funcionou perfeitamente. <br><br><h2>  Modelagem de dados </h2><br><br><h4>  Entidades </h4><br><br>  Como modelamos os dados?  Assim que o aplicativo tiver tamanhos mais ou menos decentes, <i>os dados persistentes</i> aparecer√£o necessariamente.  Esse √© o tipo de dados que voc√™ precisa armazenar por mais tempo que o restante - s√£o as <i>entidades de dom√≠nio do</i> seu sistema.  Onde armazen√°-los - seja no banco de dados, em um arquivo ou gerenciando diretamente a mem√≥ria - n√£o importa.  O importante √© <i>como</i> voc√™ os armazenar√° - em quais estruturas de dados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a8/56b/127/0a856b127ec938a8c17eb345610b0ee8.jpg"><br><br>  Essa op√ß√£o √© dada a voc√™ como desenvolvedor e depende apenas de voc√™ se essas estruturas de dados funcionar√£o a seu favor ou contra voc√™ ao implementar requisitos funcionais no futuro.  Para que tudo seja bom, voc√™ deve implementar entidades colocando neles gr√£os de <i>l√≥gica de dom√≠nio reutilizada</i> .  Como especificamente?  Vou demonstrar v√°rios m√©todos usando um exemplo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c73/e56/7da/c73e567da2fb69ceb3d627fb408530cd.jpg"><br><br>  Vamos ver o que eu forneci √† entidade Cliente.  Em primeiro lugar, implementei um <code>getFullName()</code> <i>sint√©tico</i> <code>getFullName()</code> <i>getter</i> que retornar√° a concatena√ß√£o de firstName e lastName.  Tamb√©m implementei o m√©todo <code>activate()</code> - para monitorar o estado da minha entidade, encapsulando-o.  Nesse m√©todo, coloquei, primeiramente, uma <i>opera√ß√£o de valida√ß√£o</i> e, em segundo lugar, <i>atribuir valores aos campos</i> status e enabledBy, para que n√£o haja necessidade de setters para eles.  Tamb√©m adicionei √† entidade Customer os <code>isActive()</code> e <code>canPlaceOrders()</code> , que implementam a valida√ß√£o lambda dentro de mim.  Isso √© chamado de encapsulamento de predicado.  Esses predicados s√£o √∫teis se voc√™ usar filtros Java 8: voc√™ pode transmiti-los como argumentos aos filtros.  Eu aconselho voc√™ a usar esses ajudantes. <br><br>  Talvez voc√™ esteja usando algum tipo de ORM como o Hibernate.  Suponha que voc√™ tenha duas entidades com comunica√ß√£o bidirecional.  A inicializa√ß√£o deve ser realizada em ambos os lados; caso contr√°rio, como voc√™ entende, voc√™ ter√° problemas ao acessar esses dados no futuro.  Mas os desenvolvedores geralmente esquecem de inicializar um objeto de uma das partes.  Ao desenvolver essas entidades, voc√™ pode fornecer m√©todos especiais que garantam a inicializa√ß√£o bidirecional.  D√™ uma olhada em <code>addAddress()</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c55/7fe/273/c557fe273cc1f2658573f9e78a70ca1d.png"><br><br>  Como voc√™ pode ver, esta √© uma entidade muito comum.  Mas por dentro est√° a l√≥gica do dom√≠nio.  Tais entidades n√£o devem ser escassas e superficiais, mas n√£o devem ser sobrecarregadas com a l√≥gica.  O excesso de l√≥gica ocorre com mais frequ√™ncia: se voc√™ decidir implementar toda a l√≥gica no dom√≠nio, para cada caso de uso, ser√° tentador implementar algum m√©todo espec√≠fico.  Como regra, existem muitos casos de uso.  Voc√™ n√£o receber√° uma entidade, mas uma grande pilha de todos os tipos de l√≥gica.  Tente observar a medida aqui: apenas a <i>l√≥gica reutilizada</i> √© colocada no dom√≠nio e apenas <i>em uma pequena quantidade.</i> <i><br><br></i> <h4>  <i>Objetos de valor</i> </h4> <i><br><br></i>  Al√©m das entidades, voc√™ provavelmente tamb√©m precisar√° de valores de objetos.  Essa √© apenas uma maneira de agrupar dados do dom√≠nio para que voc√™ possa mov√™-los posteriormente pelo sistema juntos. <br><br>  O objeto de valor deve ser: <br><br><ul><li>  <b>Pequeno</b> .  Sem <code>float</code> para vari√°veis ‚Äã‚Äãmonet√°rias!  Tenha cuidado ao escolher tipos de dados.  Quanto mais compacto seu objeto, mais f√°cil √© para um novo desenvolvedor descobrir isso.  Esta √© a base para uma vida confort√°vel. <br></li><li>  <b>Imut√°vel</b> .  Se o objeto for realmente imut√°vel, o desenvolvedor pode ficar calmo, pois seu objeto n√£o alterar√° seu valor e n√£o ser√° interrompido ap√≥s a cria√ß√£o.  Isso estabelece as bases para um trabalho calmo e confiante. <br></li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a0e/765/284/a0e76528432de8c55dc146805a8b286d.jpg"><br><br>  E se voc√™ adicionar uma chamada de m√©todo <code>validate()</code> ao construtor, o desenvolvedor poder√° se acalmar pela validade da entidade criada (ao passar, digamos, uma moeda inexistente ou uma quantia negativa de dinheiro, o construtor n√£o funcionar√°). <br><br><h4>  A diferen√ßa entre uma entidade e um objeto de valor </h4><br><br>  Os objetos de valor diferem das entidades por n√£o terem um ID fixo.  As entidades sempre ter√£o campos associados √† chave estrangeira de alguma tabela (ou outro armazenamento).  Objetos de valor n√£o possuem esses campos.  Surge a pergunta: os procedimentos para verificar a igualdade de dois objetos de valor e duas entidades s√£o diferentes?  Como os objetos de valor n√£o possuem um campo de ID, para concluir que dois desses objetos s√£o iguais, √© necess√°rio comparar os valores de todos os seus campos em pares (ou seja, examinar todo o conte√∫do).  Ao comparar entidades, basta fazer uma √∫nica compara√ß√£o - por ID do campo.  √â no procedimento de compara√ß√£o que reside a principal diferen√ßa entre entidades e objetos de valor. <br><br><h4>  Objetos de transfer√™ncia de dados (DTOs) </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/72a/d31/681/72ad31681509cdef20509d4514b02139.jpg"><br><br>  Qual √© a intera√ß√£o com a interface do usu√°rio (UI)?  Voc√™ deve passar os <i>dados para exibi√ß√£o para ele</i> .  Voc√™ realmente precisar√° de outra estrutura?  Assim √©.  E tudo porque a interface do usu√°rio n√£o √© sua amiga.  Ele tem seus pr√≥prios pedidos: ele precisa que os dados sejam armazenados de acordo com a forma como eles devem ser exibidos.  Isso √© maravilhoso - √†s vezes s√£o as interfaces de usu√°rio e seus desenvolvedores que nos exigem.  Ent√£o eles precisam obter dados para cinco linhas;  ent√£o, eles v√™m √† mente para criar um campo booleano <code>isDeletable</code> para o objeto (o objeto pode ter esse campo em princ√≠pio?) para saber se o bot√£o Excluir est√° ativo ou n√£o.  Mas n√£o h√° nada para se indignar.  As interfaces de usu√°rio simplesmente t√™m requisitos diferentes. <br><br>  A quest√£o √©: nossas entidades podem ser confiadas a eles para uso?  Muito provavelmente, eles os mudar√£o, e da maneira mais indesej√°vel para n√≥s.  Portanto, forneceremos a eles outra coisa - <i>Data Transfer Objects</i> (DTO).  Eles ser√£o especialmente adaptados aos requisitos externos e a uma l√≥gica diferente da nossa.  Alguns exemplos de estruturas de DTO s√£o: Formul√°rio / Solicita√ß√£o (proveniente da interface do usu√°rio), Visualiza√ß√£o / Resposta (enviada √† interface do usu√°rio), Crit√©rios de pesquisa / Resultados da pesquisa etc. Voc√™ pode, de certo modo, chamar isso de modelo de API. <br><br>  Primeiro princ√≠pio importante: o DTO deve conter um m√≠nimo de l√≥gica. <br>  Aqui est√° um exemplo de implementa√ß√£o do <code>CustomerDto</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ec/3bb/716/4ec3bb716c630f3b39ca82f8fe4c5e33.jpg"><br><br>  Conte√∫do: campos <i>particulares</i> , getters <i>p√∫blicos</i> e setters para eles.  Tudo parece estar super.  OOP em toda a sua gl√≥ria.  Mas uma coisa √© ruim: na forma de getters e setters, eu implementei muitos m√©todos.  No DTO, deve haver o m√≠nimo de l√≥gica poss√≠vel.  E ent√£o, qual √© a minha sa√≠da?  Eu fa√ßo os campos p√∫blicos!  Voc√™ dir√° que isso funciona mal com as refer√™ncias de m√©todo do Java 8, que haver√° limita√ß√µes etc. Mas, acredite ou n√£o, eu fiz todos os meus projetos (10 a 11 pe√ßas) com esses DTOs.  O irm√£o est√° vivo.  Agora, como meus campos s√£o p√∫blicos, posso definir facilmente o valor como <code>dto.fullName</code> simplesmente colocando um sinal de igual.  O que poderia ser mais bonito e mais simples? <br><br><h2>  Organiza√ß√£o l√≥gica </h2><br><br><h4>  Mapeamento </h4><br><br>  Portanto, temos uma tarefa: precisamos transformar nossas entidades em DTO.  Implementamos a transforma√ß√£o da seguinte maneira: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/995/dfd/ca8/995dfdca8c1945fb92a64cee09851259.jpg"><br><br>  Como voc√™ pode ver, declarando um DTO, passamos para as opera√ß√µes de mapeamento (atribui√ß√£o de valor).  Preciso ser desenvolvedor s√™nior para escrever tarefas regulares nesses n√∫meros?  Para alguns, isso √© t√£o incomum que eles come√ßam a trocar de sapatos em movimento: por exemplo, copie dados usando algum tipo de estrutura de mapeamento usando reflex√£o.  Mas eles sentem falta do principal - que mais cedo ou mais tarde, a interface do usu√°rio ir√° interagir com o DTO, como resultado da qual a entidade e o DTO divergem em seus significados. <br><br>  Pode-se, por exemplo, colocar opera√ß√µes de mapeamento no construtor.  Mas isso n√£o √© poss√≠vel para nenhum mapeamento;  em particular, o designer n√£o pode acessar o banco de dados. <br><br>  Portanto, somos for√ßados a deixar as opera√ß√µes de mapeamento na l√≥gica de neg√≥cios.  E se eles t√™m uma apar√™ncia compacta, n√£o h√° nada com que se preocupar.  Se o mapeamento n√£o demorar algumas linhas, mas mais, √© melhor coloc√°-lo no chamado <i>mapeador</i> .  Um mapeador √© uma classe projetada especificamente para copiar dados.  Isso, em geral, √© coisa antediluviana e clich√™.  Mas, por tr√°s deles, voc√™ pode ocultar nossas muitas tarefas - para tornar o c√≥digo mais limpo e mais fino. <br><br>  Lembre-se: um <i>c√≥digo que cresceu muito deve ser movido para uma estrutura separada</i> .  No nosso caso, as opera√ß√µes de mapeamento eram realmente um pouco demais, ent√£o as movemos para uma classe separada - o mapeador. <br><br>  Os mapeadores permitem acesso ao banco de dados?  Voc√™ pode ativ√°-lo por padr√£o - isso geralmente √© feito por raz√µes de simplicidade e pragmatismo.  Mas exp√µe voc√™ a certos riscos. <br><br>  Ilustrarei com um exemplo.  Com base no DTO existente, criamos a entidade <code>Customer</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef3/9e8/b82/ef39e8b82a023a2fad6afe8e3c22b5ec.png"><br><br>  Para o mapeamento, precisamos obter um link para o grupo de clientes no banco de dados.  Ent√£o, eu executo o m√©todo <code>getReference()</code> , e ele me devolve alguma entidade.  A solicita√ß√£o provavelmente ir√° para o banco de dados (em alguns casos, isso n√£o acontece, e a fun√ß√£o stub funciona). <br><br>  Mas o problema n√£o nos espera aqui, mas no m√©todo que executa a opera√ß√£o inversa - transformando a entidade em DTO. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6a/e27/7ff/e6ae277ff6b22588b5bc5aaffabf9d0e.png"><br><br>  Usando um loop, examinamos todos os endere√ßos associados ao Cliente existente e os convertemos em endere√ßos DTO.  Se voc√™ usa ORM, provavelmente, quando voc√™ chama o m√©todo <code>getAddresses()</code> , o carregamento lento ser√° realizado.  Se voc√™ n√£o usar o ORM, essa ser√° uma solicita√ß√£o aberta a todos os filhos desse pai.  E aqui voc√™ corre o risco de mergulhar no "problema N + 1".  Porque <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e54/001/2bb/e540012bbb4a242d84e55a2dffa5ca11.jpg"><br><br>  Voc√™ tem um conjunto de pais, cada um com filhos.  Por tudo isso, voc√™ precisa criar seus pr√≥prios an√°logos dentro do DTO.  Voc√™ precisar√° executar uma consulta <code>SELECT</code> para percorrer N entidades-pai e N consultas para selecionar os filhos de cada uma delas.  Pedido total de N + 1.  Para 1000 entidades pai do <code>Customer</code> , essa opera√ß√£o levar√° de 5 a 10 segundos, o que, √© claro, leva muito tempo. <br><br>  Suponha que, no entanto, nosso m√©todo <code>CustomerDto()</code> seja chamado dentro do loop, convertendo a lista de objetos Customer para a lista CustomerDto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58c/9c3/2b3/58c9c32b3e8a01a96d500920dfe5ef07.jpg"><br><br>  O problema com as consultas N + 1 tem solu√ß√µes padr√£o simples: no <i>JPQL,</i> voc√™ pode usar <code>FETCH</code> por customer.addresses para recuperar filhos e conect√°-los usando <code>JOIN</code> ; no SQL, voc√™ pode usar o desvio <code>IN</code> e a <code>WHERE</code> . <br><br>  Mas eu faria diferente.  Voc√™ pode descobrir qual √© o tamanho m√°ximo da lista de filhos (isso pode ser feito, por exemplo, com base em uma pesquisa com pagina√ß√£o).  Se a lista contiver apenas 15 entidades, precisaremos de apenas 16 consultas.  Em vez de 5ms, gastaremos em tudo, digamos, 15ms - o usu√°rio n√£o perceber√° a diferen√ßa. <br><br><h4>  Sobre otimiza√ß√£o </h4><br><br>  Eu n√£o o aconselharia a olhar para o desempenho do sistema no est√°gio inicial de desenvolvimento.  Como Donald Knud disse: "A otimiza√ß√£o prematura √© a raiz do mal".  Voc√™ n√£o pode otimizar desde o in√≠cio.  √â exatamente isso que precisa ser deixado para mais tarde.  E o que √© especialmente importante: <i>sem suposi√ß√µes - apenas medi√ß√µes e avalia√ß√£o de medi√ß√µes!</i> <br><br>  Tem certeza de que √© competente que √© um verdadeiro especialista?  Seja humilde em se avaliar.  N√£o pense que voc√™ entende a JVM at√© ler pelo menos alguns livros sobre a compila√ß√£o JIT.  Acontece que os melhores programadores da nossa equipe v√™m at√© mim e dizem que <i>acham</i> que encontraram uma implementa√ß√£o mais eficiente.  Acontece que eles novamente inventaram algo que apenas complica o c√≥digo.  Ent√£o eu respondo v√°rias vezes: YAGNI.  N√≥s n√£o precisamos disso. <br><br>  Freq√ºentemente, para aplicativos corporativos, nenhuma otimiza√ß√£o de algoritmos √© necess√°ria.  O gargalo para eles, em regra, n√£o √© compila√ß√£o e nem no que diz respeito ao processador, mas todos os tipos de opera√ß√µes de entrada e sa√≠da.  Por exemplo, lendo um milh√£o de linhas de um banco de dados, grava√ß√µes volumosas em um arquivo, intera√ß√£o com soquetes. <br><br>  Com o tempo, voc√™ come√ßa a entender quais gargalos o sistema cont√©m e, refor√ßando tudo com as medidas, come√ßar√° a otimizar gradualmente.  Por enquanto, mantenha o c√≥digo o mais limpo poss√≠vel.  Voc√™ descobrir√° que esse c√≥digo √© muito mais f√°cil de otimizar ainda mais. <br><br><h4>  Preferir composi√ß√£o sobre heran√ßa </h4><br><br>  Voltar ao nosso DTO.  Suponha que definamos um DTO como este: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/180/39d/f91/18039df91fd1cc76a2413b7f373e7c0b.png"><br><br>  Podemos precisar dele em muitos fluxos de trabalho.  Mas esses fluxos s√£o diferentes e, provavelmente, cada caso de uso assumir√° um grau diferente de preenchimento de campo.  Por exemplo, obviamente precisaremos criar um DTO mais cedo do que quando tivermos informa√ß√µes completas do usu√°rio.  Voc√™ pode deixar temporariamente os campos em branco.  Por√©m, quanto mais campos voc√™ ignorar, mais voc√™ desejar√° criar um novo DTO mais r√≠gido para esse caso de uso. <br><br>  Como alternativa, voc√™ pode criar c√≥pias de um DTO excessivamente grande (no n√∫mero de casos de uso dispon√≠veis) e, em seguida, remover campos extras para cada c√≥pia.  Mas para muitos programadores, em virtude de sua intelig√™ncia e alfabetiza√ß√£o, d√≥i muito pressionar Ctrl + V.  O axioma diz que copiar e colar √© ruim. <br><br>  Voc√™ pode recorrer ao princ√≠pio de <i>heran√ßa</i> conhecido na teoria OOP: basta definir um DTO b√°sico e criar um herdeiro para cada caso de uso. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f7/069/77f/6f706977fec8625d720323b64fe87ad8.png"><br><br>  Um princ√≠pio bem conhecido √©: "Prefira composi√ß√£o ao inv√©s de heran√ßa".  Leia o que diz: <i>"estende"</i> .  Parece que dever√≠amos ter ‚Äúexpandido‚Äù a classe de origem.  Mas se voc√™ pensar bem, o que fizemos n√£o √© "expans√£o".  Esta √© a verdadeira "repeti√ß√£o" - a mesma vista lateral de copiar e colar.  Portanto, n√£o usaremos heran√ßa. <br><br>  Mas o que devemos ent√£o ser?  Como ir para a composi√ß√£o?  Vamos fazer desta maneira: escreva um campo no CustomerView que aponte para o objeto do DTO subjacente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f2/d49/831/1f2d49831b9b286b8bc069c824ac2871.jpg"><br><br>  Assim, nossa estrutura b√°sica ser√° aninhada por dentro.  √â assim que a composi√ß√£o real sai. <br><br>  Independentemente de usarmos heran√ßa ou resolvermos o problema por composi√ß√£o - todos esses s√£o detalhes, sutilezas que surgiram profundamente no curso de nossa implementa√ß√£o.  Eles s√£o muito <i>fr√°geis</i> .  O que significa fr√°gil?  D√™ uma olhada neste c√≥digo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/921/eb1/ef2/921eb1ef20effd43b129ad5d28b88253.png"><br><br>  A maioria dos desenvolvedores para quem eu mostrei isso imediatamente deixou escapar que o n√∫mero "2" √© repetido e, portanto, precisa ser retirado como uma constante.  Eles n√£o perceberam que o empate nos tr√™s casos tem um significado completamente diferente (ou "valor comercial") e que sua repeti√ß√£o nada mais √© do que uma coincid√™ncia.  Colocar um dois em uma constante √© uma decis√£o leg√≠tima, mas muito fr√°gil.  Tente n√£o permitir l√≥gica fr√°gil no dom√≠nio.  Nunca trabalhe com estruturas de dados externas, em particular com o DTO. <br><br>  Ent√£o, por que o trabalho de eliminar a heran√ßa e introduzir a composi√ß√£o √© in√∫til?  Precisamente porque criamos o DTO n√£o para n√≥s mesmos, mas para um cliente externo.  E como o aplicativo cliente analisar√° o DTO recebido de voc√™ - voc√™ s√≥ pode adivinhar.  Mas, obviamente, isso ter√° pouco a ver com sua implementa√ß√£o.  Os desenvolvedores, por outro lado, podem n√£o fazer distin√ß√£o entre os DTOs b√°sicos e n√£o b√°sicos que voc√™ pensou cuidadosamente;  eles provavelmente usam heran√ßa, e talvez copiar e colar estupidamente isso √© tudo. <br><br><h4>  Fachadas </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/be7/31c/9e4/be731c9e4cfe002cb3b59c11a708f623.jpg"><br><br>  Vamos voltar √† imagem geral do aplicativo.  Aconselho voc√™ a implementar a l√≥gica do dom√≠nio atrav√©s do <i>padr√£o Facade</i> , expandindo fachadas com <i>servi√ßos de dom√≠nio,</i> conforme necess√°rio.  Um servi√ßo de dom√≠nio √© criado quando muita l√≥gica se acumula na fachada e √© mais conveniente coloc√°-lo em uma classe separada. <br>  Seus servi√ßos de dom√≠nio devem necessariamente falar o idioma do seu modelo de dom√≠nio (suas entidades e objetos de valor).  Em nenhum caso eles devem funcionar com o DTO, porque o DTO, como voc√™ se lembra, s√£o estruturas que mudam constantemente no lado do cliente, muito fr√°geis para um dom√≠nio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ad/eb8/657/3adeb86570a92f804ba491836c99b9e8.jpg"><br><br>  Qual √© o objetivo da fachada? <br><br><ol><li>  Convers√£o de dados.  Se temos entidades de um lado e DTO do outro, √© necess√°rio realizar transforma√ß√µes de um para o outro.  E esta √© a primeira coisa que as fachadas servem.  Se o procedimento de convers√£o aumentar em volume - use as classes do mapeador. <br></li><li>  A implementa√ß√£o da l√≥gica.  Na fachada, voc√™ come√ßar√° a escrever a l√≥gica principal do aplicativo.  Assim que se tornar muito - leve as pe√ßas ao servi√ßo de dom√≠nio. <br></li><li>  Valida√ß√£o de dados.  Lembre-se de que quaisquer dados recebidos do usu√°rio s√£o, por defini√ß√£o, incorretos (contendo erros).  A fachada tem a capacidade de validar dados.  Esses procedimentos, quando o volume √© excedido, geralmente s√£o levados aos <i>validadores</i> . <br></li><li>  Aspectos  Voc√™ pode ir al√©m e fazer com que cada caso de uso passe por sua fachada.  Depois, adicionar√° coisas como transa√ß√µes, log e manipuladores de exce√ß√µes globais aos m√©todos de fachada.Eu observo que √© muito importante ter manipuladores de exce√ß√µes globais em qualquer aplicativo que capture todos os erros n√£o capturados por outros manipuladores.  Eles ajudar√£o muito seus programadores - eles lhes dar√£o paz de esp√≠rito e liberdade de a√ß√£o. <br></li></ol><br><br><h4>  Decomposi√ß√£o de muito c√≥digo </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/604/a9c/8e8/604a9c8e859ff1dc3fb38208d6bf836d.jpg"><br><br>  Mais algumas palavras sobre esse princ√≠pio.  Se a classe alcan√ßou algum tamanho inconveniente para mim (digamos, 200 linhas), devo tentar dividi-la em peda√ßos.  Mas isolar uma nova classe de uma existente nem sempre √© f√°cil.  Precisamos apresentar algumas maneiras universais.  Um desses m√©todos √© procurar nomes: voc√™ est√° tentando encontrar um nome para um subconjunto dos m√©todos da sua classe.  Assim que voc√™ conseguir encontrar um nome, sinta-se √† vontade para criar uma nova classe.  Mas isso n√£o √© t√£o simples.  Na programa√ß√£o, como voc√™ sabe, existem apenas duas coisas complexas: isso est√° invalidando o cache e inventando nomes.  Nesse caso, inventar um nome envolve a identifica√ß√£o de uma subtarefa oculta e, portanto, n√£o previamente identificada por ningu√©m. <br><br>  Um exemplo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/81f/fe3/82b/81ffe382b74f6bbd4a91626d83249a97.jpg"><br><br>  Na fachada original do <code>CustomerFacade</code> alguns dos m√©todos est√£o diretamente relacionados ao cliente e outros relacionados √†s prefer√™ncias do cliente.  Com base nisso, poderei dividir a classe em duas quando atingir tamanhos cr√≠ticos.  Recebo duas fachadas: <code>CustomerFacade</code> e <code>CustomerPreferencesFacade</code> .  A √∫nica coisa ruim √© que essas duas fachadas pertencem ao mesmo n√≠vel de abstra√ß√£o.  A separa√ß√£o por n√≠veis de abstra√ß√£o implica em algo diferente. <br><br>  Outro exemplo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ac/84e/788/2ac84e788af60fb038091aed273a390e.jpg"><br><br>  Suponha que exista uma classe <code>OrderService</code> em nosso sistema na qual implementamos um mecanismo de notifica√ß√£o por email.  Agora, estamos criando um <code>DeliveryService</code> e gostar√≠amos de usar o mesmo mecanismo de notifica√ß√£o aqui.  Copiar e colar √© exclu√≠do.  Vamos fazer assim: extrair a funcionalidade de notifica√ß√£o para a nova classe <code>AlertService</code> e grav√°-la como uma depend√™ncia para as <code>OrderService</code> <code>DeliveryService</code> e <code>OrderService</code> .  Aqui, em contraste com o exemplo anterior, a separa√ß√£o ocorreu precisamente nos n√≠veis de abstra√ß√£o. <code>DeliveryService</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais abstrato que </font></font><code>AlertService</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque o usa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como parte de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seu fluxo </font><i><font style="vertical-align: inherit;">de</font></i><font style="vertical-align: inherit;"> trabalho. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A separa√ß√£o por n√≠veis de abstra√ß√£o sempre pressup√µe que a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe extra√≠da se torne uma depend√™ncia</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extra√ß√£o seja realizada para reutiliza√ß√£o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A tarefa de extra√ß√£o nem sempre √© f√°cil. </font><font style="vertical-align: inherit;">Tamb√©m pode acarretar algumas dificuldades e exigir alguma refatora√ß√£o de testes de unidade. </font><font style="vertical-align: inherit;">No entanto, de acordo com minhas observa√ß√µes, √© ainda mais dif√≠cil para os desenvolvedores procurar qualquer funcionalidade na enorme base de c√≥digo monol√≠tico do aplicativo.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Programa√ß√£o em par </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/625/5b2/346/6255b23467294d6224107235443379f1.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muitos consultores falar√£o sobre programa√ß√£o em pares, sobre o fato de que hoje √© uma solu√ß√£o universal para qualquer problema de desenvolvimento de TI. Durante isso, os programadores desenvolvem suas habilidades t√©cnicas e conhecimentos funcionais. Al√©m disso, o processo em si √© interessante, re√∫ne a equipe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Falando n√£o como consultores, mas humanamente, o mais importante √© o seguinte: a programa√ß√£o em pares melhora o "fator de barramento". A ess√™ncia do "fator de barramento" √© que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deve haver o maior n√∫mero poss√≠vel de pessoas com conhecimento sobre a estrutura do sistema</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Perder essas pessoas significa perder as √∫ltimas pistas para esse conhecimento.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A refatora√ß√£o de programa√ß√£o em pares √© uma arte que requer experi√™ncia e treinamento. √â √∫til, por exemplo, a pr√°tica de refatora√ß√£o agressiva, realiza√ß√£o de hackathons, cortes, codifica√ß√£o de Dojos, etc. A </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programa√ß√£o em pares funciona bem nos casos em que voc√™ precisa resolver problemas de alta complexidade. O processo de trabalho em conjunto nem sempre √© simples. Mas garante que voc√™ evitar√° a "reengenharia" - pelo contr√°rio, obter√° uma implementa√ß√£o que atenda aos requisitos definidos com o m√≠nimo de complexidade. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5a/5aa/666/a5a5aa666cb29c58dc9bb5b7d5bc6651.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organizar um formato de trabalho conveniente √© uma das suas principais responsabilidades para a equipe. Voc√™ deve cuidar constantemente das condi√ß√µes de trabalho do desenvolvedor - fornecer a ele total conforto e liberdade de criatividade, especialmente se forem necess√°rias para aumentar a arquitetura do design e sua complexidade.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sou arquiteto. </font><font style="vertical-align: inherit;">Por defini√ß√£o, eu estou sempre certo. ‚Äù</font></font></h4><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa estupidez √© periodicamente expressa publicamente ou nos bastidores. </font><font style="vertical-align: inherit;">Na pr√°tica de hoje, os arquitetos s√£o encontrados cada vez menos. </font><font style="vertical-align: inherit;">Com o advento do Agile, esse papel passou gradualmente aos desenvolvedores seniores, porque geralmente todo o trabalho, de uma maneira ou de outra, √© constru√≠do em torno deles. </font><font style="vertical-align: inherit;">O tamanho da implementa√ß√£o est√° aumentando gradualmente e, com isso, √© necess√°rio refatorar e novas funcionalidades est√£o sendo desenvolvidas.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arquitetura de cebola </font></font></h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cebola √© a mais pura filosofia do Script de Transa√ß√£o. Construindo-o, somos guiados pelo objetivo de proteger o c√≥digo que consideramos cr√≠tico e, para isso, o movemos para o m√≥dulo de dom√≠nio. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a45/bb4/94a/a45bb494a51b04ecfe92606b744c0857.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em nossa aplica√ß√£o, os mais importantes s√£o os servi√ßos de dom√≠nio: eles implementam os fluxos mais cr√≠ticos. Mova-os para o m√≥dulo de dom√≠nio. Obviamente, tamb√©m vale a pena mover todos os seus objetos de dom√≠nio para c√° - entidades e objetos de valor. Todo o resto que compilamos hoje - DTO, mapeadores, validadores etc. - se torna, por assim dizer, a primeira linha de defesa do usu√°rio. Porque o usu√°rio, infelizmente, n√£o √© nosso amigo, e √© necess√°rio proteger o sistema dele. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aten√ß√£o a esta depend√™ncia:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7d/273/6bd/c7d2736bdc016b732c5c431299bf32ea.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O m√≥dulo de aplicativo depender√° do m√≥dulo de dom√≠nio - ou seja, n√£o o contr√°rio. Ao registrar essa conex√£o, garantimos que o DTO nunca entrar√° no territ√≥rio sagrado do m√≥dulo de dom√≠nio: eles simplesmente n√£o s√£o vis√≠veis e inacess√≠veis a partir do m√≥dulo de dom√≠nio. Acontece que, em certo sentido, cercamos o territ√≥rio do dom√≠nio - restringimos o acesso a estranhos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, o dom√≠nio pode precisar interagir com algum servi√ßo externo. Com meios externos hostis, porque ele est√° equipado com seu DTO. Quais s√£o as nossas op√ß√µes? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro: pule o inimigo dentro do m√≥dulo. </font></font><br><br><img src="https://habrastorage.org/webt/un/tn/hk/untnhkiksv5id_i-6c4qwdjxy1c.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, essa √© uma op√ß√£o ruim: √© poss√≠vel que amanh√£ o servi√ßo externo n√£o atualize para a vers√£o 2.0 e tenhamos que redesenhar nosso dom√≠nio. N√£o deixe o inimigo dentro do dom√≠nio!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proponho uma abordagem diferente: criaremos um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> especial para intera√ß√£o </font><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/123/8b1/09c/1238b109c54ac8f19524e6d41b32e85e.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O adaptador receber√° dados de um servi√ßo externo, extrair√° os dados que nosso dom√≠nio precisa e os converter√° nos tipos de estruturas necess√°rios. </font><font style="vertical-align: inherit;">Nesse caso, tudo o que √© necess√°rio de n√≥s durante o desenvolvimento √© correlacionar as chamadas ao sistema externo com os requisitos do dom√≠nio. </font><font style="vertical-align: inherit;">Pense nisso como um grande </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptador</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como este </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Eu chamo essa camada de "anticorrup√ß√£o". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por exemplo, podemos precisar executar consultas LDAP de um dom√≠nio. </font><font style="vertical-align: inherit;">Para isso, estamos implementando o "m√≥dulo anticorrup√ß√£o" </font></font><code>LDAPUserServiceAdapter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/520/fdc/84a/520fdc84a53641a26b957ac010a19c42.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No adaptador, podemos:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ocultar chamadas de API feias (no nosso caso, oculte o m√©todo que utiliza a matriz Object); </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Embalar exce√ß√µes em nossas pr√≥prias implementa√ß√µes; </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Converta estruturas de dados de outras pessoas em suas pr√≥prias (em nossos objetos de dom√≠nio); </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifique a validade dos dados recebidos. </font></font><br></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esse √© o objetivo do adaptador. </font><font style="vertical-align: inherit;">Bom, na interface com cada sistema externo com o qual voc√™ precisa interagir, seu adaptador deve estar instalado. </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/b1a/663/9c5/b1a6639c58457537fb6a4d9c15e09eae.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portanto, o dom√≠nio n√£o direcionar√° a chamada para um servi√ßo externo, mas para o adaptador. </font><font style="vertical-align: inherit;">Para fazer isso, a depend√™ncia correspondente deve ser registrada no dom√≠nio (do adaptador ou do m√≥dulo de infraestrutura em que est√° localizado). </font><font style="vertical-align: inherit;">Mas esse v√≠cio √© seguro? </font><font style="vertical-align: inherit;">Se voc√™ instal√°-lo assim, um DTO de servi√ßo externo pode entrar em nosso dom√≠nio. </font><font style="vertical-align: inherit;">N√£o devemos permitir isso. </font><font style="vertical-align: inherit;">Portanto, sugiro outra maneira de modelar depend√™ncias.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Princ√≠pio de Invers√£o de Depend√™ncia </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/058/4a1/f7c/0584a1f7c309505e4e5ea0c2b0b26c21.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos criar uma interface, escrever nela a assinatura dos m√©todos necess√°rios e coloc√°-la dentro do nosso dom√≠nio. A tarefa do adaptador √© implementar essa interface. Acontece que a interface est√° dentro do dom√≠nio e o adaptador est√° fora, no m√≥dulo de infraestrutura que importa a interface. Assim, viramos a dire√ß√£o da depend√™ncia na dire√ß√£o oposta. No tempo de execu√ß√£o, o sistema de dom√≠nio chamar√° qualquer classe por meio de interfaces. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como voc√™ pode ver, ao introduzir interfaces na arquitetura, fomos capazes de implantar depend√™ncias e, assim, proteger nosso dom√≠nio de estruturas e APIs externas que caem nele. Essa abordagem √© chamada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">invers√£o de depend√™ncia</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2c/cc2/cd0/c2ccc2cd0309a4c8f97b7521cfc63fb7.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, a invers√£o de depend√™ncia pressup√µe que voc√™ coloque os m√©todos de seu interesse na interface dentro de seu m√≥dulo de alto n√≠vel (no dom√≠nio) e implemente essa interface de fora - em um ou outro m√≥dulo feio de baixo n√≠vel (infraestrutura). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A interface implementada dentro do m√≥dulo de dom√≠nio deve falar o idioma do dom√≠nio, ou seja, operar√° em suas entidades, par√¢metros e tipos de retorno. Em tempo de execu√ß√£o, o dom√≠nio chamar√° qualquer classe por meio de uma chamada polim√≥rfica para a interface. As estruturas de inje√ß√£o de depend√™ncia (como Spring e CDI) nos fornecem uma inst√¢ncia concreta da classe em tempo de execu√ß√£o.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas o principal √© que, durante a compila√ß√£o, o m√≥dulo de dom√≠nio n√£o ver√° o conte√∫do do m√≥dulo externo. </font><font style="vertical-align: inherit;">√â disso que precisamos. </font><font style="vertical-align: inherit;">Nenhuma entidade externa deve cair no dom√≠nio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segundo o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tio Bob</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o princ√≠pio da invers√£o de controle (ou, como ele chama, ‚Äúarquitetura de plug-in‚Äù) √© talvez o melhor que o paradigma OOP oferece em geral. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a96/3cf/e13/a963cfe13d030fb1d7ec2bf0f780fe43.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa estrat√©gia pode ser usada para integra√ß√£o com qualquer sistema, para chamadas e mensagens s√≠ncronas e ass√≠ncronas, para envio de arquivos etc.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vis√£o geral da l√¢mpada </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc3/64d/cdb/dc364dcdb589b35a0597b6e478aace46.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ent√£o, decidimos que protegeremos o m√≥dulo de dom√≠nio. </font><font style="vertical-align: inherit;">Dentro dele, h√° um servi√ßo de dom√≠nio, entidades, objetos de valor e agora interfaces para servi√ßos externos, al√©m de interfaces para o reposit√≥rio (para interagir com o banco de dados). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A estrutura fica assim: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/983/0c7/07e9830c76d3b263743f8514b13bf42a.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O m√≥dulo de aplicativo, o m√≥dulo de infraestrutura (por invers√£o de depend√™ncia), o m√≥dulo de reposit√≥rio (tamb√©m consideramos o banco de dados como um sistema externo), o m√≥dulo de lote e, possivelmente, alguns outros m√≥dulos s√£o depend√™ncias declaradas para o dom√≠nio. </font><font style="vertical-align: inherit;">Essa arquitetura √© chamada de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"cebola"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">tamb√©m √© chamado de "limpo", "hexagonal" e "portas e adaptadores".</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> M√≥dulo de reposit√≥rio </font></font></h4><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vou falar brevemente sobre o m√≥dulo do reposit√≥rio. A quest√£o de retir√°-lo do dom√≠nio √© uma quest√£o. A tarefa do reposit√≥rio √© tornar a l√≥gica mais limpa, escondendo de n√≥s o horror de trabalhar com dados persistentes. A op√ß√£o para os veteranos √© usar o JDBC para interagir com o banco de dados: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ed/d70/44a/7edd7044a76373b2c513e246bf6eabaa.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ tamb√©m pode usar o Spring e seu JdbcTemplate: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/64b/d68/749/64bd68749f5b3de16591a23a8acda193.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou MyBatis DataMapper: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/423/31b/aa1/42331baa178ff3ad8f0ea8fb92704265.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mas √© t√£o complicado e feio que desencoraja qualquer desejo de fazer mais alguma coisa. Portanto, sugiro usar JPA / Hibernate ou Spring Data JPA. Eles nos dar√£o a oportunidade de enviar consultas criadas n√£o no esquema do banco de dados, mas diretamente com base no modelo de nossas entidades. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementa√ß√£o para JPA / Hibernate: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/110/ebf/ef7/110ebfef7dad2a2bb278c50668eecda9.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No caso de Spring Data JPA:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/10b/e2a/0ff/10be2a0ff082a8c1ac962c4754ec55a8.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Spring Data JPA pode gerar m√©todos automaticamente em tempo de execu√ß√£o, como, por exemplo, getById (), getByName (). Tamb√©m permite executar consultas JPQL, se necess√°rio - e n√£o no banco de dados, mas no seu pr√≥prio modelo de entidade. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O c√≥digo JPA do Hibernate e Spring Data JPA realmente parece muito bom. Precisamos extra√≠-lo do dom√≠nio? Na minha opini√£o, isso n√£o √© t√£o e necess√°rio. Muito provavelmente, o c√≥digo ser√° ainda mais limpo se voc√™ deixar esse fragmento dentro do dom√≠nio. Ent√£o, aja sobre a situa√ß√£o.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/055/f04/37c/055f0437cf059c9f7001db6b3d231e70.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, se voc√™ criar um m√≥dulo de reposit√≥rio, para a organiza√ß√£o de depend√™ncias, √© melhor usar o princ√≠pio de invers√£o de controle da mesma maneira. </font><font style="vertical-align: inherit;">Para fazer isso, coloque a interface no dom√≠nio e implemente-a no m√≥dulo de reposit√≥rio. </font><font style="vertical-align: inherit;">Quanto √† l√≥gica do reposit√≥rio, √© melhor transferi-lo para o dom√≠nio. </font><font style="vertical-align: inherit;">Isso torna o teste conveniente, pois voc√™ pode usar objetos Mock no dom√≠nio. </font><font style="vertical-align: inherit;">Eles permitir√£o que voc√™ teste a l√≥gica r√°pida e repetidamente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tradicionalmente, apenas uma entidade √© criada para um reposit√≥rio em um dom√≠nio. </font><font style="vertical-align: inherit;">Eles o quebram em peda√ßos apenas quando se tornam muito volumosos. </font><font style="vertical-align: inherit;">Lembre-se de que as classes devem ser compactas.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c8/9e1/7e7/1c89e17e784e4db6fe8d7c713bcf1ab6.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode criar um m√≥dulo separado, colocar a interface extra√≠da da fachada e os DTOs que dependem dele, empacot√°-lo em um JAR e transferi-lo para seus clientes Java neste formul√°rio. </font><font style="vertical-align: inherit;">Com esse arquivo, eles poder√£o enviar solicita√ß√µes para as fachadas.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L√¢mpada pragm√°tica </font></font></h4><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m dos nossos ‚Äúinimigos‚Äù aos quais entregamos funcionalidades, ou seja, clientes, tamb√©m temos inimigos e, por outro lado, aqueles m√≥dulos dos quais dependemos. </font><font style="vertical-align: inherit;">Tamb√©m precisamos nos proteger desses m√≥dulos. </font><font style="vertical-align: inherit;">E para isso, ofere√ßo-lhe uma "cebola" levemente modificada - nela toda a infraestrutura √© combinada em um m√≥dulo. </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/265/1f1/481/2651f1481062cfe6c18974df9a6dde9b.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu chamo essa arquitetura de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"l√¢mpada pragm√°tica"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Aqui, a separa√ß√£o dos componentes √© realizada de acordo com o princ√≠pio ‚Äúmeu‚Äù e ‚Äúintegr√°vel‚Äù: separadamente, que se refere ao meu dom√≠nio, e separadamente, que se refere √† integra√ß√£o com colaboradores externos. Assim, apenas dois m√≥dulos s√£o obtidos: o dom√≠nio e o aplicativo. Essa arquitetura √© muito boa, mas apenas quando o m√≥dulo do aplicativo √© pequeno. Caso contr√°rio, √© melhor voc√™ voltar para a cebola tradicional.</font></font><br><br><h2>  Testes </h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como eu disse anteriormente, se todo mundo tem medo do seu aplicativo, considere que ele reabasteceu as fileiras do Legacy. </font></font><img src="https://habrastorage.org/getpro/habr/post_images/12a/508/d1b/12a508d1b9595239f6d9b9a8a72c9474.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas os testes s√£o bons. Eles nos d√£o uma sensa√ß√£o de confian√ßa que nos permite continuar refatorando. Infelizmente, por√©m, essa confian√ßa pode facilmente se tornar injustificada. Eu vou explicar o porqu√™. O TDD (desenvolvimento por meio de testes) assume que voc√™ √© o autor do c√≥digo e o autor dos casos de teste: voc√™ l√™ as especifica√ß√µes, implementa a funcionalidade e imediatamente escreve um conjunto de testes para ele. Testes, digamos, ter√£o sucesso. Mas e se voc√™ entendeu mal os requisitos das especifica√ß√µes? Em seguida, os testes n√£o verificar√£o o que √© necess√°rio. Portanto, sua confian√ßa √© in√∫til. E tudo porque voc√™ escreveu c√≥digo e testes sozinho.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas tente fechar os olhos para isso. </font><font style="vertical-align: inherit;">Os testes ainda s√£o necess√°rios e, de qualquer forma, eles nos d√£o confian√ßa. </font><font style="vertical-align: inherit;">Acima de tudo, √© claro, adoramos testes funcionais: eles n√£o implicam efeitos colaterais, n√£o dependem - apenas dados de entrada e sa√≠da. </font><font style="vertical-align: inherit;">Para testar um dom√≠nio, voc√™ precisa usar objetos simulados: eles permitir√£o que voc√™ teste as classes isoladamente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quanto √†s consultas ao banco de dados, test√°-las √© desagrad√°vel. </font><font style="vertical-align: inherit;">Esses testes s√£o fr√°geis, exigem que voc√™ adicione primeiro dados de teste ao banco de dados - e somente depois disso voc√™ poder√° prosseguir com o teste da funcionalidade. </font><font style="vertical-align: inherit;">Mas, como voc√™ entende, esses testes tamb√©m s√£o necess√°rios, mesmo se voc√™ usar o JPA.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Testes unit√°rios </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8bd/332/6ec/8bd3326ec6ca9886c78b4239491dc936.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu diria que o poder dos testes de unidade n√£o est√° na possibilidade de execut√°-los, mas no que o processo de escrev√™-los abrange. Enquanto voc√™ est√° escrevendo um teste, repensa e trabalha com o c√≥digo - reduz a conectividade, divide-o em classes - em uma palavra, realiza a pr√≥xima refatora√ß√£o. O c√≥digo em teste √© um c√≥digo puro; √© mais simples, a conex√£o √© reduzida nele; em geral, tamb√©m √© documentado (um teste de unidade bem escrito descreve perfeitamente como a classe funciona). N√£o √© de surpreender que seja dif√≠cil escrever testes de unidade, especialmente as primeiras pe√ßas. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/116/be7/361/116be7361d4d6a2dc8cac91983808378.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na fase dos primeiros testes de unidade, muitas pessoas t√™m realmente medo das perspectivas de que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente precisam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> testar alguma coisa. Por que eles recebem t√£o dif√≠cil? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Porque esses testes s√£o o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primeiro fardo para sua classe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Este √© o primeiro golpe no sistema, que talvez mostre que √© fr√°gil e fr√°gil. Mas voc√™ precisa entender que esses poucos testes s√£o os mais importantes para o seu desenvolvimento. Eles s√£o, em ess√™ncia, seus melhores amigos, porque dir√£o tudo sobre a qualidade do seu c√≥digo. Se voc√™ tem medo desse est√°gio, n√£o vai longe. Voc√™ deve executar os testes para o seu sistema. Depois disso, a complexidade diminuir√°, os testes ser√£o gravados mais rapidamente. Adicionando-os um por um, voc√™ criar√° uma </font><i><font style="vertical-align: inherit;">base de testes de regress√£o</font></i><font style="vertical-align: inherit;"> confi√°vel para o seu sistema</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">E isso √© incrivelmente importante para o trabalho futuro de seus desenvolvedores. </font><font style="vertical-align: inherit;">Ser√° mais f√°cil para eles refatorar; </font><font style="vertical-align: inherit;">Eles entender√£o que o sistema pode ser testado por regress√£o a qualquer momento, e √© por isso que trabalhar com a base de c√≥digo √© seguro. </font><font style="vertical-align: inherit;">E, garanto-lhe, eles se empenhar√£o na refatora√ß√£o com muito mais disposi√ß√£o. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/eb5/3d7/cbd/eb53d7cbdc3b190b2b597d6427088b1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meu conselho para voc√™: se voc√™ acha que hoje tem muita for√ßa e energia, dedique-se a escrever testes de unidade. </font><font style="vertical-align: inherit;">E certifique-se de que cada um seja limpo, r√°pido, tenha seu pr√≥prio peso e n√£o repita os outros.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dicas </font></font></h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resumindo tudo o que foi dito hoje, gostaria de advertir voc√™ com as seguintes dicas: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mantenha a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simplicidade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pelo maior tempo poss√≠vel (e n√£o importa quanto custe) </font><font style="vertical-align: inherit;">: evite a "reengenharia" e a otimiza√ß√£o tardia, n√£o sobrecarregue o aplicativo;</font></font><br></li><li> <i>   </i> ,        ,   ; <br></li><li>  ¬´¬ª           ‚Äî <i>     </i> ; <br></li><li>   ,        ‚Äî <i></i> :         ; <br></li><li>    ¬´¬ª,  ,     ‚Äî <i>           </i> ; <br></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o tenha medo dos testes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : d√™ a eles a oportunidade de derrubar seu sistema, sentir todos os benef√≠cios deles - no final, eles s√£o seus amigos, porque podem apontar problemas honestamente.</font></font><br></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao fazer essas coisas, voc√™ ajudar√° sua equipe e a si mesmo. </font><font style="vertical-align: inherit;">E ent√£o, quando chegar o dia da entrega do produto, voc√™ estar√° pronto para isso.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O que ler </font></font></h2><br><br><img src="https://habrastorage.org/getpro/habr/post_images/852/a4c/37d/852a4c37d17677fa3fb1e7e021f29e4a.jpg"><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7 virtudes de um bom objeto</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL √© o pior erro da Ci√™ncia da Computa√ß√£o</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A arquitetura limpa</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Novo jarg√£o de programa√ß√£o</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qualidade do c√≥digo: WTFs / minuto</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que cada elemento do SOLID est√° errado!</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bom software √© escrito 3 vezes</font></font></a> <br></li></ul><br><br><blockquote>  .        <b>JPoint</b> ‚Äî  ,  19-20   -  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Joker 2018</a> ‚Äî    Java-.       .        . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt419179/">https://habr.com/ru/post/pt419179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt419165/index.html">Enviamos SMS "an√¥nimo" do console para o n√∫mero desejado usando o servi√ßo bytehand e C ++</a></li>
<li><a href="../pt419169/index.html">"Mundo do Oeste Selvagem" atrav√©s dos olhos do desenvolvedor</a></li>
<li><a href="../pt419171/index.html">Desativando verifica√ß√µes de estado de tempo de execu√ß√£o em um aplicativo Android</a></li>
<li><a href="../pt419173/index.html">Arquitetura limpa no contexto do desenvolvimento de plataforma cruzada</a></li>
<li><a href="../pt419177/index.html">Padr√µes de luz da Amazon</a></li>
<li><a href="../pt419181/index.html">Programa√ß√£o do mouse: como fugimos da rotina do CRM</a></li>
<li><a href="../pt419183/index.html">Demopati em Helsinque ‚ÄúAssembl√©ia 2018‚Äù, reportagem fotogr√°fica, primeiro dia</a></li>
<li><a href="../pt419185/index.html">Vis√£o geral dos protocolos atuais de constru√ß√£o de consenso em um ambiente descentralizado</a></li>
<li><a href="../pt419189/index.html">Por que as ofertas de pacotes formar√£o em breve a base do varejo</a></li>
<li><a href="../pt419193/index.html">Lidamos com objetos em JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>