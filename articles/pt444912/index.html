<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úã üîâ üíò Controle LCD F-51543NFU-LW-ADN / PWB51543C-2-V0 (da biblioteca de fitas) üì≤ üë©‚Äçüåæ üïµüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° novamente, Habr! Tendo traduzido o artigo sobre o gerenciamento do m√≥dulo LCD com um driver, mas sem minha pr√≥pria RAM de v√≠deo, decidi traduzir o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Controle LCD F-51543NFU-LW-ADN / PWB51543C-2-V0 (da biblioteca de fitas)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444912/"><img src="https://habrastorage.org/webt/yz/yf/la/yzyflade5gq71l7xiakjzym4utg.jpeg"><br><br>  Ol√° novamente, Habr!  Tendo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">traduzido o</a> artigo sobre o gerenciamento do m√≥dulo LCD com um driver, mas sem minha pr√≥pria RAM de v√≠deo, decidi traduzir outra publica√ß√£o sobre o mesmo t√≥pico.  Aqui o m√≥dulo j√° √© mais simples, monocrom√°tico, mas "reviver" n√£o √© menos interessante. <a name="habracut"></a><br><br><h1>  Controle de LCD com driver, mas sem controlador </h1><br>  A exibi√ß√£o com a qual o autor vai trabalhar √© tirada de uma biblioteca de fitas antiga.  O controlador n√£o sobreviveu, mas uma pesquisa por qualquer coisa relacionada a "263645-001" mostrou que havia um FPGA.  Acredita-se que controle diretamente esses m√≥dulos de LCD do Arduino, etc.  imposs√≠vel, voc√™ precisa de um link intermedi√°rio - o controlador da s√©rie SEDxxxxx, que n√£o √© "amig√°vel" com a placa de ensaio e tem mais entradas do que o pr√≥prio m√≥dulo.  Mas isso n√£o √© verdade.  Aqui est√£o quatro projetos semelhantes: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">No ATmega8515</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nele</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Na foto</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">No ESP32</a> <br><br>  E alguns at√© operam com monitores AVR VGA de oito bits ... <br><br>  Em geral, o autor conseguiu, o software sob a licen√ßa MIT est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h1>  Imagem est√°tica </h1><br>  Para garantir que tudo funcione, voc√™ deve primeiro tentar gerar uma imagem rasterizada de bit √∫nico da mem√≥ria flash do microcontrolador.  Para obter uma tens√£o negativa, pegamos tr√™s "Crones", a tens√£o do divisor, que foi usada como um resistor de sintonia, foi aplicada ao terminal V0.  E aqui na tela √© Lenna: <br><br><img src="https://habrastorage.org/webt/yb/7-/fg/yb7-fgxw6yf64l_ylhqaccnhq-g.jpeg"><br><br>  O autor ainda n√£o consegue entender como conseguiu virar a imagem (veja de que lado est√° o cabo).  De qualquer forma, existe este exemplo na p√°gina do projeto no GitHub. <br><br><h1>  Modo de texto </h1><br>  Mas a ROM de v√≠deo √© de pouca utilidade e n√£o h√° 9600 bytes para a RAM de v√≠deo no Arduino.  O modo de texto √© √∫til, no qual a ROM do gerador de caracteres e a RAM de v√≠deo combinada s√£o menores que a RAM de v√≠deo no modo gr√°fico.  Os defensores da Rep√∫blica do Cazaquist√£o e o "especialista" podem quebrar lan√ßas sem parar sobre esse assunto. <br><br><img src="https://habrastorage.org/webt/yz/yf/la/yzyflade5gq71l7xiakjzym4utg.jpeg"><br><br>  Um pequeno exemplo na linguagem assembly AVR: <br><br><pre><code class="plaintext hljs">... lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ld r30, X+ swap r24; (CL2 rising edge) out %[data_port], r24 lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ...</code> </pre> <br><h1>  Hardware necess√°rio </h1><br><img src="https://habrastorage.org/webt/85/p_/52/85p_52apzq0nmbzcnde9vaphrxy.jpeg"><br><br>  Para o m√≥dulo F-51543NFU-LW-ADN / PWB51543C-2-V0, o autor aplicou: <br><br>  Arduino no AVR com uma frequ√™ncia de clock de 16 MHz (testado em Uno, Leonardo e um clone semelhante ao ProMicro). <br><br>  Fonte de tens√£o negativa.  Para o autor, este √© um conversor DC-DC n√£o estabilizado A0524S-1W com isolamento de entrada e sa√≠da.  Conversores para o MC34063 tamb√©m s√£o adequados (esse chip √© muito f√°cil de encontrar - basta desmontar o carregamento USB mais barato para um isqueiro) ou MAX749.  A estabiliza√ß√£o n√£o √© necess√°ria, a faixa de tens√µes permitidas nesta entrada para o m√≥dulo usado aqui √© bastante ampla.  O valor nominal √© menos 24 V, o m√°ximo √© menos 30 em rela√ß√£o ao fio comum e 35 entre Vdd e Vee.  O consumo atual √© de 6 mA. <br><br>  Dois transistores MOS de canal N com controle de n√≠vel l√≥gico.  O autor usou o IRL530n, o estoque, √© claro, √© grande, mas certamente n√£o queimar√°.  Um transistor controla a luz de fundo, o outro uma fonte de tens√£o negativa. <br><br>  Resistor de corte de 250 kŒ© para fornecer tens√£o √† entrada V0.  Defina de modo que -16,8 V a uma temperatura de +25 ¬∞ C no contato m√≥vel.  Isso √© de uma folha de dados e, portanto, √© claro, essa precis√£o n√£o √© necess√°ria. <br><br>  V√°rios resistores de 10 quilos para puxar para baixo. <br><br>  Layout e jumpers. <br><br>  O que voc√™ faria agora?  Rel√≥gio QR?  Pergunte ao kote: <br><br><img src="https://habrastorage.org/webt/lw/yv/qp/lwyvqp84jo4uvj5byzropcuzf7k.jpeg"><br><br>  O Kote oferece a implementa√ß√£o de uma simula√ß√£o de algum LCD comum com um controlador.  Para que outro "pensamento" que funcione com a tela do HD44780, apenas grande, possa ser conectado a este Arduino. <br><br><h1>  Fonte - tamb√©m na RAM </h1><br>  Tomamos um exemplo com EGA e VGA - l√°, ao trabalhar no modo de texto, foi feito exatamente isso.  S√≥ aqui havia 64 caracteres no total, mas pelo menos tudo entrou na RAM, ao contr√°rio do modo gr√°fico.  √â verdade que o ciclo principal de eventos ficou mais lento, mas voc√™ pode tentar gr√°ficos em bloco: <br><br><img src="https://habrastorage.org/webt/ie/5w/qa/ie5wqaezqkvosxnzrjhvu3bzpaa.jpeg"><br><br><h1>  Modo gr√°fico e meio-tom </h1><br>  No Arduino no AVR, n√£o h√° muita RAM, e esse √© o ponto.  Mesmo em Mega.  320x240, mesmo com um bit por pixel - j√° s√£o 9600 bytes.  Apenas quatro meios-tons exigir√£o o dobro.  Com a RAM externa, por exemplo, 23LC512 no modo SQI, voc√™ pode tentar implementar algo semelhante ao DMA, mas √© mais simples e lucrativo refazer tudo no ESP32, onde h√° mais RAM est√°tica e o DMA √© mais f√°cil. <br><br>  Se voc√™ quiser apenas conectar esse monitor a um PC via USB, tente usar o ATmega32u4 para isso - haver√° recursos suficientes mesmo para grada√ß√µes de brilho (usando FRC, o que est√° descrito na minha tradu√ß√£o anterior).  Mas n√£o com o "mega" usado como conversor de interface, mas com um PC que escaneia o LCD em tempo real a uma velocidade de 5,4 megabits por segundo. <br><br>  Quando o m√≥dulo ainda estava na biblioteca de fitas, havia uma GUI e grada√ß√µes de brilho - tudo estava l√°. <br><br>  Atualiza√ß√µes ser√£o.  Enquanto isso ... <br><br><img src="https://habrastorage.org/webt/9z/cu/p9/9zcup9llwkpyuzyzxky3wghu_hs.jpeg"><br><br>  E isso n√£o √© uma montagem de fotos, mas o resultado do controle de um PC.  E mudaremos do Hackaday.io para o GitHub - ainda h√° muitas coisas interessantes no README.md. <br><br><h1>  Sinais para controlar esses m√≥dulos </h1><br>  FLM - Marcador de primeira linha - marcador de primeira linha, tamb√©m pode ser chamado de FRAME, VSYNC, etc. <br>  CL1 - Pulso de trava de linha - pulso de seq√º√™ncia de grava√ß√£o, tamb√©m pode ser chamado.  CARGA, HSYNC, etc. <br>  CL2 - Clock de deslocamento de pixel - pulso de mudan√ßa de pixel, tamb√©m pode ser chamado.  CP (alterar pixel) etc. <br>  M - sinal alternativo, devido ao qual os pixels s√£o controlados por tens√£o alternada, tamb√©m pode ser chamado de BIAS (offset), etc. <br><br>  D0-D3 √© um barramento de dados paralelo de quatro bits. <br><br>  Linhas para fio comum, energia de luz de fundo (por exemplo, VLED ¬±), energia do m√≥dulo (VEE e V0) <br><br>  N√£o negligencie as planilhas de dados.  O m√≥dulo pode exigir outra voltagem negativa, ou pode ser positivo, ou o conversor pode estar embutido.  A l√≥gica pode diferir, por exemplo, com uma unidade no CL1, n√£o haver√° rea√ß√£o no CL2.  Pode haver uma luz de fundo diferente (CCFL (com cuidado, o inversor √© uma "mordida") em vez de LEDs) ou a pinagem n√£o √© indicada na placa, √© imposs√≠vel reconhec√™-la sem uma folha de dados.  Voc√™ n√£o pode conectar nada aleatoriamente. <br><br><h1>  O que h√° para fazer </h1><br>  Transmitir a cadeia em peda√ßos de quatro bits, a grava√ß√£o √© realizada no decl√≠nio na linha CL2.  Depois de passar a linha, anote a recess√£o na linha CL1 (sim, afinal, um pouco de RAM no m√≥dulo est√° em uma linha).  A pr√≥xima linha ser√° selecionada automaticamente.  Ap√≥s transmitir o quadro inteiro, retorne ao in√≠cio usando o sinal FLM.  Em uma folha de dados sobre LC79401, h√° um exemplo.  Grave a uma velocidade suficiente, aplique pulsos no CL1 uniformemente.  O controlador hesitou um pouco - a tela piscou feia. <br><br>  Ap√≥s cada quadro, altere o n√≠vel l√≥gico na entrada M para o oposto, para que os pixels sejam controlados por tens√£o alternada.  Caso contr√°rio, a tela se deteriora: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZP0KxZl5N2o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Voc√™ n√£o pode confiar nessa opera√ß√£o no microcontrolador, mas coloque um gatilho cont√°vel.  Entrada para FLM, sa√≠da para M - em geral, √© compreens√≠vel. <br><br>  Um exemplo para sa√≠da de imagens da mem√≥ria flash (consulte o in√≠cio do artigo) √© chamado clglcd_simple neste reposit√≥rio. <br><br>  Como j√° mencionado, √© imposs√≠vel fazer o mesmo com a RAM no Arduino no AVR - n√£o ser√° suficiente, portanto ... <br><br><h1>  E novamente - modo de texto </h1><br>  De acordo com a folha de dados, voc√™ pode transmitir dados em um barramento de quatro bits e "pull" CL2 com uma frequ√™ncia de at√© 6 MHz.  Portanto, voc√™ pode transferir a linha r√°pida e rapidamente, em seguida, o microcontrolador resolve um pouco outras tarefas e, conforme o timer o informa, "puxa" CL1 e repete o ciclo. <br><br>  Ao gerar caracteres para uma resolu√ß√£o horizontal de 320 pixels, tudo isso pode ser feito em 20 ¬µs (320 pixels / 4 bits = 80 pulsos, CL2 ‚Äúpuxa‚Äù com uma frequ√™ncia de 4 MHz).  Para as tarefas restantes, restam 39,5 Œºs.  O CL1 ‚Äúse move‚Äù a cada 59,5 Œºs e obt√©m uma taxa de quadros de 70 Hz.  Bem, haver√° mais procedimentos para lidar com interrup√ß√µes e assim por diante, em geral, o microcontrolador estar√° ocupado controlando a tela 45% do tempo.  "Total" 45 ou "total" 45?  Provavelmente o segundo: substituir dados na RAM de v√≠deo pode ser r√°pido o suficiente. <br><br>  Deseja que o microcontrolador gaste menos tempo gerenciando o indicador e mais em outras tarefas?  Voc√™ pode reduzir a taxa de quadros para 50 Hz, pode fazer um overclock do microcontrolador para 20 MHz.  Com qualquer um desses m√©todos, mais ciclos de clock ocorrer√£o entre as rotinas de interrup√ß√£o. <br><br>  Um timer de compara√ß√£o de sa√≠da alterna a linha CL2 a cada quatro pulsos de clock com um ciclo de trabalho de 50%.  Ao mesmo tempo, os dados v√£o para as sa√≠das da porta PORTB, conectadas ao barramento de dados de quatro bits do m√≥dulo, de forma que mudem no momento em que o n√≠vel sobe para CL2 e, no momento do decl√≠nio, permanecem inalteradas.  Obviamente, isso n√£o pode ser feito sem o assembler: <br><br><pre> <code class="plaintext hljs">... lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ld r30, X+ swap r24; (CL2 rising edge) out %[data_port], r24 lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ...</code> </pre> <br>  8 ciclos - e quatro petiscos s√£o transmitidos.  E o que exatamente transmitir depende de qual s√≠mbolo est√° na c√©lula de v√≠deo RAM correspondente, quais pixels correspondentes a esse s√≠mbolo devem ser transferidos da ROM do gerador de caracteres e o que √© armazenado nas c√©lulas correspondentes dessa ROM. <br><br>  A coisa mais inconveniente aqui √© a necessidade de parar o cron√¥metro ap√≥s exatamente 80 pulsos.  Alguns temporizadores, como o Timer4 em 32u4, n√£o podem. <br><br>  Para obter o sinal fornecido √† linha CL1, o autor aplicou uma sa√≠da diferente do microcontrolador, destinado tanto ao timer quanto ao PWM r√°pido.  Qual disso √© aplicado aqui √© compreens√≠vel.  Ele alterna a cada 952 medidas.  Ou, se voc√™ contar ap√≥s o divisor do rel√≥gio em 8, ocorre a cada 119 pulsos.  Nesse ponto, a rotina de processamento de interrup√ß√£o inicia e for√ßa o microcontrolador a enviar novos dados para a linha de controle que ser√£o necess√°rios durante o pr√≥ximo pulso para CL1.  Bem, o n√≠vel na linha M muda com metade da frequ√™ncia.  E o LCD n√£o se deteriora.  Todos os sinais juntos s√£o assim: <br><br><img src="https://habrastorage.org/webt/yt/_0/dh/yt_0dhpk4km7w-yml5spdz5ukl8.png"><br><br>  O gerador de caracteres consiste em 256 caracteres - o suficiente para 866, KOI-8R ou 1251. Os caracteres 40xN s√£o colocados na RAM de v√≠deo, onde N √© o n√∫mero de linhas, dependendo da altura do caractere.  A largura do s√≠mbolo √© sempre 8 pixels e a altura pode ser 6, 8, 10, 12, 15, 16. Quanto menor, menor a ROM necess√°ria para o gerador de caracteres e mais RAM de v√≠deo.  Com uma fonte 8x8 (40 caracteres por 30 linhas), voc√™ precisa de 1200 bytes de RAM e 2048 bytes de ROM.  Com uma fonte 8x16 (fica melhor neste m√≥dulo), a RAM precisa de 600 bytes e a ROM 4096. Do tradutor: voc√™ pode armazenar a fonte na forma de 8x8 e dimension√°-la verticalmente duas vezes por software, al√©m de custar 600 bytes de RAM e 2048 ROM.  Para armazenar v√°rias fontes na ROM, √© necess√°rio manter o endere√ßo inicial da fonte n√£o constante, mas em uma vari√°vel, mas n√£o funcionar√° para imprimir o texto em v√°rias fontes de uma s√≥ vez, a menos que, √© claro, voc√™ altere esse endere√ßo imediatamente, atrav√©s do procedimento de processamento de interrup√ß√£o diretamente durante a transfer√™ncia de pixels para a tela. <br><br>  A fonte √© armazenada assim: primeiro as linhas superiores de todos os 256 caracteres, depois uma linha abaixo e assim por diante.  H√° um script Python na pasta misc do reposit√≥rio que converte automaticamente a fonte TTF no arquivo de cabe√ßalho clglcd_font.h com a matriz PROGMEM no formato necess√°rio.  As fontes cl√°ssicas de pixel para o CC-BY-SA 4.0 podem ser encontradas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><h1>  E novamente - d√™ um exemplo com EGA e VGA </h1><br>  Mas desta vez com detalhes.  O gerador de caracteres na RAM, como indicado acima, acomoda um total de 64 caracteres; eles podem ser identificados por n√∫meros de 0 a n ou de 255 a 255. Eles s√£o armazenados da mesma maneira: as linhas principais de todos os caracteres, a seguir, e assim por diante.  Somente tudo isso est√° alinhado, levando em considera√ß√£o o fato de que os caracteres n√£o s√£o 256, mas 64. Para caracteres com tamanho de 8x16 pixels, s√£o necess√°rios 16 * 64 = 1024 bytes.  O reposit√≥rio tem um exemplo de trabalho com o gerador de caracteres na RAM. <br><br>  Se os dois geradores de caracteres forem usados ‚Äã‚Äãao mesmo tempo - 256 caracteres na ROM e 64 caracteres na RAM, voc√™ ter√° que aceitar que n√£o apenas haver√° menos RAM, mas tamb√©m a velocidade de transfer√™ncia de linhas das linhas no m√≥dulo diminuir√° - em vez de 8 ciclos de rel√≥gio, dois nibbles precisar√£o de 12, ou seja, n√£o 20 microssegundos, mas 30, e em vez de 45% do tempo para o controle de LCD, ser√£o necess√°rios 60. <br><br><h1>  Modo gr√°fico de meio-tom </h1><br>  Como indicado acima, neste caso, o microcontrolador funciona simplesmente como um conversor de interface.  Voc√™ precisar√° do ATmega32u4, e o que fazer √© descrito <a href="">aqui</a> .  Observe que o m√≥dulo pode ser danificado devido ao congelamento do programa no PC. <br><br>  Ent√£o, o que √© esse la√ßo de quatro fios - do sensor resistivo, ao que parece. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mMqvBnYOjEQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  Onde conectar </h1><br>  Conforme indicado acima, √© necess√°ria uma voltagem negativa, que nas primeiras experi√™ncias pode ser removida de tr√™s ‚Äúcrones‚Äù e, em seguida, monte o conversor, por exemplo, no MAX749.  Os sinais de controle de pot√™ncia, bem como o sinal DISPOFF (este √© um sinal inverso, o m√≥dulo √© ligado em um), puxe os resistores para baixo.  Durante o piscar e reiniciando o microcontrolador, a apar√™ncia de unidades l√≥gicas √© inaceit√°vel. <br><br>  Aplique tens√£o negativa ap√≥s tens√£o + 5V e uma unidade l√≥gica na linha DISPOFF - quando os dados j√° estiverem presentes nas linhas de controle: pelo menos uma unidade no barramento de dados, unidade no CL1.  Caso contr√°rio, o m√≥dulo poder√° falhar. <br><br>  As entradas D0-D3 podem ser conectadas √†s sa√≠das da mesma porta do microcontrolador, por exemplo, Px4-Px7, enquanto as sa√≠das Px0-Px3 n√£o podem ser usadas como GPIO.  Voc√™ pode atribuir-lhes outras fun√ß√µes, por exemplo, us√°-las como sa√≠das de temporizadores, interfaces seriais, etc.  Se voc√™ us√°-los como entradas, tenha cuidado: os resistores de pull-up embutidos podem alternar arbitrariamente se n√£o estiverem desativados (PUD - desativa√ß√£o de pull-up). <br><br>  Entrada M - para a sa√≠da do timer de compara√ß√£o ou PWM. <br><br>  Entrada CL1 - para outra sa√≠da do mesmo timer. <br><br>  Entrada CL2 - para a sa√≠da de outro cron√¥metro de compara√ß√£o. <br><br>  FLM - para qualquer sa√≠da digital. <br><br>  DISPOFF - para qualquer outra sa√≠da digital. <br><br>  O restante depende de como voc√™ liga o m√≥dulo.  O autor prefere controlar a luz de fundo e o Vee separadamente. <br><br><h1>  Como usar o firmware </h1><br>  Coloque os arquivos clglcd.he clglcd.cpp no ‚Äã‚Äãsketch <br><br>  Fa√ßa uma c√≥pia de backup do arquivo clglcd_config.h e edite-o levando em considera√ß√£o o que est√° conectado e as fun√ß√µes necess√°rias: um gerador de caracteres na RAM, etc.  Aten√ß√£o, o c√≥digo n√£o indica os nomes dos pinos do Arduino, mas os nomes dos pinos do microcontrolador de acordo com a folha de dados.  Os nomes das sa√≠das dos domadores de compara√ß√£o s√£o decifrados da seguinte forma: por exemplo, 2, B √© OC2B, que no Arduino Uno corresponde ao PD3.  Os exemplos mostram as op√ß√µes de conex√£o que foram obtidas pelo autor. <br><br>  Gere o arquivo de fonte clglcd_font.h com um script Python na pasta misc (veja acima). <br><br>  Veja nos exemplos como inicializar, ligar e desligar a tela.  Coloque na matriz da tela o texto que voc√™ deseja exibir para verifica√ß√£o. <br><br>  Compile e preencha o esbo√ßo.  Verifique com um analisador l√≥gico se os sinais corretos v√£o para a tela e, com um volt√≠metro, todas as tens√µes de alimenta√ß√£o s√£o normais.  Somente ent√£o conecte o monitor. <br><br>  Adicione um c√≥digo ao esbo√ßo que far√° algo, por exemplo, receba texto em uma porta serial e exiba-o. <br><br><h1>  Exibir interrup√ß√µes </h1><br>  A exibi√ß√£o precisa ser atualizada constantemente, e √© isso que os procedimentos de manipula√ß√£o de interrup√ß√£o fazem.  Se as interrup√ß√µes pararem por mais de 30 microssegundos, a tela piscar√° e, se mais de 60 microssegundos para uma unidade na linha FLM, ela poder√° falhar.  Se voc√™ precisar interromper as interrup√ß√µes por um longo tempo, primeiro desligue a tela com o sinal DISPOFF (repito, este √© um sinal inverso, o m√≥dulo √© ligado de uma s√≥ vez).  Obviamente, se ele desligar por dois segundos sempre que voc√™ precisar processar dados de um sensor de umidade e temperatura, poucos v√£o gostar, mas √© melhor do que arruinar o m√≥dulo.  Melhor ainda, carregue o restante em um microcontrolador separado.  A troca de informa√ß√µes pelo mesmo microcontrolador com dispositivos operando no LED de protocolo e endere√ßo de 1 fio √© especialmente inaceit√°vel.  Os clones do Arduino Pro Micro s√£o baratos o suficiente para comprar dois. <br><br><h1>  Comunica√ß√£o </h1><br>  Mas as interfaces implementadas por hardware funcionar√£o perfeitamente: portas seriais, barramento I <sup>2</sup> C, SPI no modo mestre.  No escravo - somente se o mestre permitir "roll-off" peri√≥dico do escravo em 25-35 Œºs.  Obviamente, ainda depende de quantas ‚Äúpernas‚Äù permanecem desocupadas ap√≥s conectar o monitor. <br><br>  O USB no 32u4 funciona bem se voc√™ n√£o interrogar o terminal de gerenciamento com muita frequ√™ncia (c√≥digo de rotina de interrup√ß√£o lenta).  O driver CDC e suas APIs foram r√°pidas o suficiente. <br><br>  Em seguida, no arquivo README.md no GitHub, a lista de projetos semelhantes √© repetida, da mesma forma que na p√°gina do projeto no Hackaday.io <br><br>  Obrigado pela aten√ß√£o! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444912/">https://habr.com/ru/post/pt444912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444902/index.html">Otimiza√ß√£o do projeto por m√©todos da teoria do controle autom√°tico</a></li>
<li><a href="../pt444904/index.html">Recuperando uma senha mestra de um gerenciador de senhas bloqueadas SafeInCloud</a></li>
<li><a href="../pt444906/index.html">Ler lixo</a></li>
<li><a href="../pt444908/index.html">Onde crescer smartphones</a></li>
<li><a href="../pt444910/index.html">A estimula√ß√£o sonora e luminosa ajuda no Alzheimer, enquanto em ratos, mas os resultados s√£o encorajadores</a></li>
<li><a href="../pt444916/index.html">N√£o comprou DLC: uma fun√ß√£o que salvaria o 737 ca√≠do, a Boeing vendeu como op√ß√£o</a></li>
<li><a href="../pt444918/index.html">Onde os smartphones crescem: um roteiro para se tornar um computador completo</a></li>
<li><a href="../pt444920/index.html">O novo algoritmo acelera 200 vezes o design autom√°tico de redes neurais</a></li>
<li><a href="../pt444922/index.html">Como se proteger do hipnov√≠rus</a></li>
<li><a href="../pt444924/index.html">O primeiro WIAD em Moscou: como foi e do que falaram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>