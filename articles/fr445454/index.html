<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐋 👨🏿‍🏭 🥒 Afficheur braille Raspberry Pi Zero Inside Handy Tech Active Star 40 🗳️ 🌥️ 👨🏿‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'auteur a placé le Raspberry Pi Zero, un «sifflet» Bluetooth et un câble à l'intérieur de son nouvel afficheur braille Handy Tech Active Star 40. Un ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Afficheur braille Raspberry Pi Zero Inside Handy Tech Active Star 40</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445454/"><img src="https://habrastorage.org/webt/5i/vv/tl/5ivvtlnh3-qi8x3gtk0kzgczlt4.jpeg"><br><br>  L'auteur a placé le Raspberry Pi Zero, un «sifflet» Bluetooth et un câble à l'intérieur de son nouvel afficheur braille Handy Tech Active Star 40. Un port USB intégré fournit de l'énergie.  Le résultat a été un ordinateur autonome sans moniteur sur ARM avec le système d'exploitation Linux, équipé d'un clavier et d'un afficheur braille.  Vous pouvez le charger / alimenter via USB, incl.  d'une banque d'alimentation ou d'un chargeur solaire.  Par conséquent, il peut se passer de l'alimentation secteur non pas pendant plusieurs heures, mais pendant plusieurs jours. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/so/yo/ky/soyokywncc6nvduroz7wnbngtly.jpeg"><br><br><h1>  Différenciation dimensionnelle des afficheurs braille </h1><br>  Tout d'abord, ils diffèrent par la longueur des cordes.  Les appareils 60 et plus familiers sont bons lorsque vous travaillez avec un ordinateur de bureau, 40 appareils sont pratiques à transporter avec un ordinateur portable.  Il existe maintenant des afficheurs braille qui se connectent aux smartphones et tablettes, avec une longueur de chaîne de 14 ou 18 familiarité. <br><br>  Dans le passé, les affichages en braille étaient assez massifs.  Le 40-familier, par exemple, avait les dimensions et le poids d'un ordinateur portable de 13 pouces.  Maintenant, avec le même degré de familiarité, ils sont suffisamment miniatures pour placer l'écran devant l'ordinateur portable, et non l'ordinateur portable sur l'écran. <br><br>  Bien sûr, c'est mieux, mais ce n'est pas très pratique de garder deux appareils séparés sur vos genoux.  Lorsque vous travaillez à table, il n'y a rien à redire, mais il convient de se rappeler que l'ordinateur portable est appelé un ordinateur portable d'une manière différente, et essayez de justifier son nom, car il s'avère que l'écran miniature de 40 places est encore moins pratique. <br><br>  L'auteur a donc attendu la sortie du nouveau modèle promis depuis longtemps dans la série Handy Tech Star.  En 2002, le précédent modèle Handy Tech Braille Star 40 a été publié, où la zone du corps est suffisante pour mettre un ordinateur portable sur le dessus.  Et s'il ne rentre pas, un support rétractable est fourni.  Maintenant, ce modèle est remplacé par Active Star 40, il est presque le même, mais avec une électronique améliorée. <br><br><img src="https://habrastorage.org/webt/mx/tx/ba/mxtxbaqpjfxzn_j_utlp5i8nxom.jpeg"><br><br>  Et le support rétractable est resté: <br><br><img src="https://habrastorage.org/webt/6-/ds/hq/6-dshqxvtaajiaqqddsv9jnyqaa.jpeg"><br><br>  Mais la chose la plus pratique dans la nouveauté est une niche d'environ la taille d'un smartphone (voir KDPV).  Il s'ouvre lorsque la plateforme recule.  Il s'est avéré peu pratique de garder le smartphone là-bas, mais vous devez en quelque sorte utiliser le compartiment vide, à l'intérieur duquel même une sortie de puissance est fournie. <br><br>  La première chose que l'auteur a trouvée a été d'y mettre le Raspberry Pi, mais lorsque l'écran a été acheté, il s'est avéré qu'avec le "framboise" le support, qui ferme le compartiment, ne bouge pas.  Maintenant, si la planche n'était plus mince que de 3 mm ... <br><br>  Mais un collègue a parlé de la sortie du Raspberry Pi Zero, qui s'est avéré si petit que deux pourraient entrer dans le compartiment ... ou peut-être même trois.  Il a été immédiatement commandé avec une carte mémoire de 64 Go, Bluetooth, un sifflet et un câble Micro USB.  Quelques jours plus tard, tout cela est arrivé et des amis voyants ont aidé l'auteur à préparer une carte.  Tout a immédiatement fonctionné comme il se doit. <br><br><h1>  Qu'est-ce qui a été fait pour cela </h1><br>  À l'arrière du Handy Tech Active Star 40 se trouvent deux ports USB pour des appareils tels que des claviers.  Un petit clavier magnétique est inclus.  Lorsque le clavier est connecté et que l'écran lui-même fonctionne via Bluetooth, l'ordinateur le reconnaît également comme un clavier Bluetooth. <br><br>  Ainsi, si vous connectez un «sifflet» Bluetooth au Raspberry Pi Zero placé dans le compartiment du smartphone, il peut échanger des données avec l'afficheur braille via Bluetooth à l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BRLTTY</a> , et si vous connectez également un clavier à l'écran, le «Malinka» fonctionnera et avec elle. <br><br>  Mais ce n'est pas tout.  Malinka lui-même, à son tour, peut accéder à Internet via Bluetooth PAN à partir de n'importe quel appareil qui le prend en charge.  L'auteur a configuré son smartphone et ses ordinateurs en conséquence à la maison et au travail, mais à l'avenir, il prévoit d'adapter une «framboise» de plus pour cela - une classique, pas Zero, connectée à Ethernet et un autre «sifflet» Bluetooth. <br><br><h1>  BlueZ 5 et PAN </h1><br>  La façon de configurer un PAN à l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BlueZ</a> n'était pas évidente.  L'auteur a trouvé le script pyhton bt-pan (voir ci-dessous) qui vous permet de configurer PAN sans interface graphique. <br><br>  Avec lui, vous pouvez configurer à la fois le serveur et le client.  Ayant reçu la commande D-Bus appropriée lorsqu'il travaille en mode client, il crée un nouveau périphérique réseau bnep0 immédiatement après avoir établi une connexion au serveur.  Normalement, DHCP est utilisé pour attribuer une adresse IP à cette interface.  En mode serveur, BlueZ requiert le nom du périphérique bridge auquel il peut être ajouté par l'esclave pour connecter chaque client.  La configuration de l'adresse du périphérique de pont et le démarrage du serveur DHCP plus le masquage IP sur le pont sont généralement tout ce qui est requis. <br><br><h1>  Point d'accès Bluetooth PAN avec Systemd </h1><br>  Pour configurer le pont, l'auteur a appliqué systemd-networkd: <br><br>  Fichier /etc/systemd/network/pan.netdev <br><br><pre><code class="plaintext hljs">[NetDev] Name=pan Kind=bridge ForwardDelaySec=0</code> </pre> <br>  Fichier /etc/systemd/network/pan.network <br><br><pre> <code class="plaintext hljs">[Match] Name=pan [Network] Address=0.0.0.0/24 DHCPServer=yes IPMasquerade=yes</code> </pre> <br>  Vous devez maintenant forcer BlueZ à configurer le profil NAP.  Il s'est avéré que les utilitaires réguliers de BlueZ 5.36 ne peuvent pas être utilisés.  Si l'auteur se trompe, corrigez-le: gourou mlang (sait comment bouger les oreilles) aveugle (parfois accès et quantique) <br><br>  Mais il a trouvé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article de blog</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un script Python</a> pour faire les appels nécessaires à D-Bus. <br><br>  Pour plus de commodité, l'auteur a utilisé le service Systemd pour exécuter le script et vérifier la résolution des dépendances. <br><br>  Fichier /etc/systemd/system/pan.service <br><br><pre> <code class="plaintext hljs">[Unit] Description=Bluetooth Personal Area Network After=bluetooth.service systemd-networkd.service Requires=systemd-networkd.service PartOf=bluetooth.service [Service] Type=notify ExecStart=/usr/local/sbin/pan [Install] WantedBy=bluetooth.target</code> </pre> <br>  Fichier / usr / local / sbin / pan <br><br><pre> <code class="plaintext hljs">#!/bin/sh # Ugly hack to work around #787480 iptables -F iptables -t nat -F iptables -t mangle -F iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE exec /usr/local/sbin/bt-pan --systemd --debug server pan</code> </pre> <br>  Le deuxième fichier ne serait pas nécessaire si Debian avait IPMasquerade = support (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="># 787480</a> ). <br><br>  Après avoir exécuté les commandes <i>systemctl daemon-reload</i> et <i>systemctl restart systemd-networkd,</i> vous pouvez démarrer le Bluetooth PAN avec la commande <i>systemctl start pan</i> <br><br><h1>  Client Bluetooth PAN utilisant Systemd </h1><br>  Le côté client est également facile à configurer à l'aide de Systemd. <br><br>  Fichier /etc/systemd/network/pan-client.network <br><br><pre> <code class="plaintext hljs">[Match] Name=bnep* [Network] DHCP=yes</code> </pre> <br>  Fichier /etc/systemd/system/pan@.service <br><br><pre> <code class="plaintext hljs">[Unit] Description=Bluetooth Personal Area Network client [Service] Type=notify ExecStart=/usr/local/sbin/bt-pan --debug --systemd client %I --wait</code> </pre> <br>  Maintenant, après avoir redémarré la configuration, vous pouvez vous connecter au point d'accès Bluetooth spécifié comme ceci: <br><br><pre> <code class="plaintext hljs">systemctl start pan@00:11:22:33:44:55</code> </pre> <br><h1>  Couplage en ligne de commande </h1><br>  Bien sûr, le serveur et les clients doivent être configurés après les avoir couplés via Bluetooth.  Sur le serveur, vous devez exécuter bluetoothctl et lui donner la commande: <br><br><pre> <code class="plaintext hljs">power on agent on default-agent scan on scan off pair XX:XX:XX:XX:XX:XX trust XX:XX:XX:XX:XX:XX</code> </pre> <br>  Après avoir lancé l'analyse, attendez quelques secondes jusqu'à ce que le périphérique dont vous avez besoin apparaisse dans la liste.  Notez son adresse et utilisez-la en émettant la commande pair et, si nécessaire, la commande trust. <br><br>  Le client doit faire de même, mais la commande trust ne sera pas nécessaire à coup sûr.  Le serveur en a besoin pour accepter la connexion sur le profil NAP sans confirmation manuelle de l'utilisateur. <br><br>  L'auteur n'est pas sûr qu'il s'agisse de la séquence optimale de commandes.  Peut-être que tout ce qui est nécessaire est de coupler le client avec le serveur et d'exécuter la commande de confiance sur le serveur, mais il ne l'a pas encore essayé. <br><br><h1>  Activation du profil Bluetooth HID </h1><br>  Il est nécessaire que le "Malinka" reconnaisse le clavier connecté à l'afficheur braille par un fil, et déjà transmis par l'afficheur lui-même via Bluetooth.  Cela se fait de la même manière, mais au lieu d' <i>agent,</i> vous devez donner la commande <i>Agent KeyboardOnly</i> , et bluetoothctl trouvera un appareil avec un profil HID. <br><br><h1>  Mais configurer Bluetooth via la ligne de commande est un peu compliqué </h1><br>  Bien que l'auteur ait réussi à tout configurer, il comprend que la configuration de BlueZ via la ligne de commande n'est pas pratique.  Au début, il pensait que les agents n'étaient nécessaires que pour entrer des codes PIN, mais il s'est avéré, par exemple, que pour activer le profil HID, il fallait taper «agent KeyboardOnly».  Étonnamment, pour lancer Bluetooth PAN, vous devez gravir les référentiels à la recherche du script souhaité.  Il se souvient que dans la version précédente de BlueZ, il y avait un outil de <i>pandémie</i> prêt à l'emploi pour cela - où l'a-t-il fait dans BlueZ 5?  Soudain, une nouvelle solution est apparue, inconnue de l'auteur, mais gisant à la surface? <br><br><h1>  Performances </h1><br>  Le taux de transfert de données était d'environ 120 kbps, ce qui est tout à fait suffisant.  Le processeur ARM 1 GHz est très rapide pour l'interface de ligne de commande.  L'auteur prévoit toujours d'utiliser principalement ssh et emacs sur l'appareil. <br><br><h1>  Polices de la console et résolution d'écran </h1><br>  La résolution d'écran par défaut utilisée par le framebuffer sur le Raspberry Pi Zero est plutôt étrange: fbset rapporte qu'il s'agit de 656x416 pixels (bien sûr, le moniteur n'est pas connecté).  Avec une police de console de 8x16, 82 caractères par ligne et 26 lignes ont été obtenus. <br><br>  Il n'est pas pratique de travailler avec un afficheur braille à 40 caractères dans ce mode.  De plus, l'auteur souhaite que les caractères Unicode soient affichés en braille.  Heureusement, Linux prend en charge 512 caractères et dans la plupart des polices de console, il y en a 256. Avec la configuration de la console, vous pouvez utiliser deux polices de 256 caractères ensemble.  L'auteur a ajouté les lignes suivantes au fichier / etc / default / console-setup: <br><br><pre> <code class="plaintext hljs">SCREEN_WIDTH=80 SCREEN_HEIGHT=25 FONT="Lat15-Terminus16.psf.gz brl-16x8.psf"</code> </pre> <br>  Remarque: pour que la police brl-16x8.psf soit disponible, vous devez installer la console braille. <br><br><h1>  Et ensuite? </h1><br>  Il y a une prise 3,5 mm sur l'afficheur braille, mais l'auteur n'est pas au courant des adaptateurs pour supprimer l'audio du Mini-HDMI.  L'auteur n'a pas pu utiliser la carte son intégrée à la "framboise" (étrange, le traducteur était sûr qu'il n'y en avait pas une dans Zero, mais il existe des moyens de produire du son PWM vers GPIO).  Il prévoit d'utiliser un concentrateur USB-OTG et de connecter une carte externe et de diffuser le son vers le haut-parleur intégré à l'afficheur braille.  Pour une raison quelconque, deux cartes externes ne fonctionnaient pas, maintenant il cherche un appareil similaire sur un autre chipset. <br><br>  Il n'est toujours pas pratique d'éteindre manuellement la «framboise», d'attendre quelques secondes et d'éteindre l'afficheur braille.  Et tout cela parce que lorsqu'il se déconnecte, il coupe l'alimentation du connecteur dans le compartiment.  L'auteur prévoit de mettre une petite batterie tampon dans le compartiment et, par le biais du GPIO, d'informer la "framboise" de l'extinction de l'écran afin qu'il commence à terminer le travail.  Un tel UPS miniature. <br><br><h1>  Image système </h1><br>  Si vous avez le même afficheur braille et que vous souhaitez en faire de même, l'auteur est prêt à fournir une image prête à l'emploi du système (basée sur l'étirement Raspbian).  Écrivez-lui à ce sujet à l'adresse ci-dessus.  S'il y a beaucoup de gens qui le souhaitent, il est même possible de produire des ensembles qui incluent tout ce dont vous avez besoin pour une telle modification. <br><br><h1>  Remerciements </h1><br>  Merci à Dave Mielke d'avoir relu le texte. <br><br>  Merci à Simon Kainz pour l'illustration photo. <br><br>  Merci à mes collègues de l'Université technique de Graz pour l'introduction rapide de l'auteur dans le monde du Raspberry Pi. <br><br>  PS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le premier tweet de l'</a> auteur sur ce sujet (il ne s'ouvre pas - le traducteur) a été rédigé cinq jours seulement avant la publication de l'original de cet article, et nous pouvons supposer que, à l'exception des problèmes de son, la tâche a été pratiquement résolue.  Soit dit en passant, l'auteur a édité la version finale du texte à partir de l '«afficheur braille autonome» qu'il a créé, en le connectant via SSH à l'ordinateur personnel. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr445454/">https://habr.com/ru/post/fr445454/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr445444/index.html">Mise à jour des modules solaires haute performance de REC et Trina (solaire)</a></li>
<li><a href="../fr445446/index.html">Comment nous avons utilisé la réplication différée pour la reprise après sinistre avec PostgreSQL</a></li>
<li><a href="../fr445448/index.html">Configuration de la réception automatique des certificats Letsencrypt à l'aide de Docker sous Linux</a></li>
<li><a href="../fr445450/index.html">Extension de navigateur pour toster.ru</a></li>
<li><a href="../fr445452/index.html">Référentiels utiles avec Eloquent?</a></li>
<li><a href="../fr445456/index.html">Recherche à 1 To / s</a></li>
<li><a href="../fr445458/index.html">Electronic Arts traitera avec 350 employés et «réduira sa présence» en Russie</a></li>
<li><a href="../fr445460/index.html">Interactivité sans gadget</a></li>
<li><a href="../fr445464/index.html">Diminution de la taille de l'échantillon des données expérimentales sans perte d'informations</a></li>
<li><a href="../fr445466/index.html">Félicitations aux champions de la finale régionale Imagine Cup EMEA: Team Finderr du Royaume-Uni! L'équipe russe est troisième</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>