<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸµï¸ ğŸš² ğŸŒ‰ Bekerja dengan Perintah APDU Menggunakan Contoh EToken â—»ï¸ âœğŸ¾ ğŸ¥©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""... Jalannya tidak begitu sulit untuk dipahami. Kekuatan alam, kecenderungan alami, pola peristiwa ... 
 Pemahaman primitif tentang dunia hanya mempe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bekerja dengan Perintah APDU Menggunakan Contoh EToken</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446552/">  <i>"... Jalannya tidak begitu sulit untuk dipahami. Kekuatan alam, kecenderungan alami, pola peristiwa ...</i> <i><br></i>  <i>Pemahaman primitif tentang dunia hanya memperhatikan empat elemen dan tidak melangkah lebih jauh dari ini.</i>  <i>Sepertinya alam semesta turun ke empat fenomena yang bisa dimengerti. "</i> <i><br></i>  <i>Stephen Erickson.</i> <i><br></i>  <i>"Midnight Tide."</i> <br><br><img src="https://habrastorage.org/webt/pn/ja/xv/pnjaxvu9xha1saqk36veq8bghhm.jpeg" alt="gambar"><br><br>  Halo, Habr! <br><br>  Topik APDU telah diangkat berulang kali, tetapi terutama menyangkut kartu pintar, yang untuknya Anda memerlukan pembaca kartu dan kartu yang tidak disayangkan, plus perangkat lunak, karena bekerja dengan antarmuka konsol OpenSC, setidaknya di Window $, tidak nyaman untuk sedikitnya. <br>  Untuk melakukan ini, saya menulis sebuah program kecil dengan antarmuka jendela yang berfungsi melalui kartu win. <br>  Sumber dan binari dapat diunduh di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Ini dikompilasi di bawah Visual studio 2008, Anda perlu menambahkan proyek WinSCard.Lib dari Microsoft Windows SDK ke proyek. <br><a name="habracut"></a><br>  Kemungkinan besar akan ada ikan biru EToken PRO Java 72 K dengan sertifikat EDS yang berakhir bertahun-tahun yang lalu (menggunakan "pertempuran" dengan EDS yang ada, token tidak direkomendasikan untuk percobaan!). <br>  Juga sesuai adalah JaCarta Pro, yang berbeda dari etigen hanya secara eksternal. <br>  Anda juga dapat mencoba bekerja dengan Gemalto SafeNet eToken 5100, mereka dapat melihat isi direktori, tetapi mereka tidak akan dapat membaca file karena batas waktu yang sangat kecil (mungkin beberapa milidetik) antara perintah untuk memilih dan membaca file, akibatnya perintah untuk membaca file merujuk secara manual sudah ada di tempat kosong (kode kesalahan 69 85).  Mungkin ini adalah salah satu alasan bahwa pada beberapa platform pada token ini mereka tidak lagi melihat kunci.  Mengenai SafeNet eToken 5100 (dengan tulisan jujur â€‹â€‹di samping â€œMade in Chinaâ€) Saya perhatikan yang berikut ini: â€œKlien Tunggal JaCartaâ€ tidak ingin bekerja dengannya dan menampilkan pesan bahwa produk ini tidak didukung, Klien 64-bit eToken PKI eToken Aladin yang 5.1 Dia tidak melihatnya, tetapi versi 32 untuk Win XP berfungsi dengannya, meskipun untuk token ini disarankan untuk menginstal Klien Otentikasi SafeNet asli. <br><br>  Token lain, termasuk keluarga JaCarta, tidak akan berfungsi, karena perintah APDU untuk mereka semua sangat berbeda dan nilai digital yang dijelaskan dalam standar ISO7816 tidak cocok. <br><br>  Rincian tentang format perintah APDU dapat ditemukan, misalnya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Seorang pembaca dengan ikan biru dapat berkenalan dengan karya APDU tanpa bangun dari sofa. <br>  Penting untuk menginstal driver untuk eToken eToken PKI Client 5.1 atau "JaCarta Single Client" dan menghubungkan token. <br><br>  Untuk tampilan terperinci dari isi token dalam bentuk yang mudah dan rekonsiliasi dengan apa yang diberikan perintah APDU, Anda dapat menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Editor</a> Autoit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JaCarta yang</a> saya tulis. <br><br>  Luncurkan APDUExplorer, pilih "Aladdin Token JC 0" atau "ARDS JaCarta 0" atau "SafeNet Token JC 0" dari daftar pembaca dan Anda dapat memasukkan perintah. <br>  Anda dapat memasukkan keduanya melalui titik dua dan melalui spasi atau semuanya. <br><br>  Pertama, Anda dapat memeriksa kinerja dengan mengklik "Periksa ATR" dan dapatkan respons token. <br><br>  Perintah pertama adalah memilih applet default dan pergi ke direktori root dengan pengenal 3f00 (pengidentifikasi ini mungkin satu-satunya yang umum untuk token dari vendor mana pun). <br>  00: A4: 00: 04: 00 <br><br>  Selanjutnya, kita mendapatkan daftar folder di direktori root <br>  80: 01: 01: 00: 04: 09: 02: 00: 00: CD (perintahnya adalah â€œdaftar folder laporanâ€ yang konstan)). <br>  Respons harus diterima: <br>  0a 02 66 66 0b 01 00 90 00 <br><br>  Byte kedua dalam respons adalah ukuran data yang diterima - dua byte, yaitu hanya satu folder (pengidentifikasi file atau folder dalam APDU selalu membutuhkan dua byte). <br>  Dan kita hanya melihat satu folder dengan pengidentifikasi 66, yang disebut direktori Aladdin AID. <br><br>  Laporkan daftar file (juga konstan) <br>  80: 01: 02: 00: 04: 09: 02: 00: 00: 00: CD <br>  Harus diterima <br>  0a 00 0b 01 00 90 00 <br>  Jawaban di posisi 01 adalah 00. <br><br>  Pergi ke direktori 66 66 <br>  00 A4 08 04 02 66 66 00 <br>  Ini adalah perintah SELECT FILE, formatnya: empat byte, perintah 00 A4 08 04 itu sendiri, kemudian ukuran bidang data dari path lengkap (dalam contoh 02 bytes), lalu path itu sendiri (dalam contoh 66 66) dan 00 harus diselesaikan. <br><br>  Laporkan daftar direktori 66 66 <br>  80: 01: 01: 00: 04: 09: 02: 00: 00: CD: <br>  Resv bytes: <br>  0a 04 50 01 50 00 0b 01 00 90 00 <br>  Bidang respons 01 (ukuran respons) menunjukkan 04, mis.  4 byte = dua folder 50 01 dan 50 00, dengan 50 01 sebagai folder layanan dan 50 00 yang utama, disebut direktori PKCS # 11, di mana semua data disimpan <br><br>  Laporkan daftar direktori 66 66 <br>  80: 01: 02: 00: 04: 09: 02: 00: 00: 00: CD <br>  Resv bytes: <br>  0a 00 0b 01 00 90 00 <br>  Tidak ada file di sini. <br><br>  Penelitian telah menunjukkan bahwa tidak ada folder dan file yang terlihat di direktori 50 01, jadi buka direktori utama 50 00 <br>  00 A4 08 04 04 66 66 50 00 00 <br>  Laporkan Daftar Folder <br>  80: 01: 01: 00: 04: 09: 02: 00: 00: CD: <br>  Jawabannya akan tergantung pada apa yang disimpan di token. <br>  Laporkan daftar file <br>  80: 01: 02: 00: 04: 09: 02: 00: 00: 00: CD <br>  Resv bytes: <br>  0a 14 00 0f 00 02 00 03 00 04 00 05 00 06 00 07 00 08 00 09 00 0a 0b 01 00 90 00 <br>  Kami melihat 14 file (bidang respons 01), lalu setiap 2 byte ini adalah nama file, maka ada informasi layanan. <br><br>  Setiap token dari model yang dipelajari selalu memiliki direktori sistem b000 dan file sistem 0002 di dalamnya, cobalah untuk membacanya, dan file lain dapat dibaca dengan prinsip yang sama. <br>  Pergi ke direktori b0 00 <br>  00 A4 08 04 06 66 66 50 00 B0 00 00 <br>  Dapatkan daftar file <br>  80: 01: 02: 00: 04: 09: 02: 00: 00: 00: CD <br>  Resv bytes: <br>  0a 02 00 02 0b 01 00 90 00 <br>  Kita melihat file 00 02 (byte dalam bidang respons 01 adalah ukuran nama (setiap nama selalu mengambil dua byte, bidang berikut adalah nama file, dalam hal ini hanya ada satu file, yang ditentukan oleh nilai bidang 01). <br><br>  Pilih file 0002 dari B000 untuk path lengkap <br>  00 A4 08 04 08 66 66 50 00 B0 00 00 02 00 <br>  Resv bytes: <br>  01 01 02 02 02 02 00 02 03 02 00 10 04 08 00 ff 00 00 ff ff ff ff 05 00 90 00 <br>  Format respons adalah sebagai berikut: pembukaan - 2 byte, tipe file - 1 byte (file 02, folder 01), pembatas - 2 byte, nama file - 2 byte, pembatas - 2 byte, ukuran file - 2 byte, pembatas - 2 byte, hak akses - 1 byte (00 - tersedia untuk semua orang, 63 dilindungi oleh kode PIN).  Kemudian muncul beberapa informasi overhead, diakhiri dengan kode untuk keberhasilan pelaksanaan perintah APDU - 90 00. <br><br>  Baca file ini, dua byte terakhir dari perintah adalah ukuran buffer berapa banyak untuk dibaca (dalam hal ini, itu sama dengan ukuran file). <br>  80 18 00 00 04 0E 02 00 00 10 <br>  Resv bytes: (nilai dalam setiap kasus akan berbeda): <br>  00 06 63 61 72 64 63 66 00 00 00 00 00 00 00 00 90 00 <br><br>  Saya tidak mempertimbangkan otentikasi pada etoken di sini, karena ini terdiri dari urutan perintah tanya-jawab dan dienkripsi (ada proyek Antitoken di mana masalah otorisasi pada produk ini secara mendasar diselesaikan). <br>  Beberapa token lain, seperti JaCarta GOST-2, mendukung otentikasi dengan hanya memberikan kode pin. <br><br>  Anda bisa mendapatkan nilai perintah APDU dari kartu pintar dan token apa pun dengan memotong lalu lintas WinSCard.dll dengan menjalankan sniffer yang dikompilasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari sini</a> (percobaan telah menunjukkan bahwa sniffer ini diinstal dan berjalan hanya di bawah Win XP). <br><br>  Untuk referensi, kemungkinan hasil menjalankan perintah APDU: <br>  90 00 - OK <br>  69 85 - Kondisi penggunaan tidak terpenuhi <br>  63 00 - Otentikasi kriptogram host gagal (Ext auth) <br>  64 00 - Tidak ada diagnosis khusus <br>  67 00 - Panjangnya salah di Lc <br>  67 XX - Kesalahan, salah parameter P3 (kode ISO) <br>  68 81 - Saluran logis tidak didukung atau tidak aktif <br>  69 82 - Status keamanan tidak terpenuhi <br>  69 83 - Kode rahasia terkunci <br>  69 85 - Tidak ada EF yang dipilih saat ini, tidak ada perintah untuk memantau / tidak ada File Manajer Transaksi <br>  6A 80 - Parameter di bidang data salah <br>  6A 81 - Kartu diblokir atau perintah tidak didukung <br>  6A 82 - File tidak ditemukan <br>  6A 85 - Lc tidak konsisten dengan struktur TLV <br>  6A 86 - P1 P2 salah <br>  6A 88 - Data yang direferensikan tidak ditemukan (Init upd) <br>  6D 00 - Instruksi tidak valid <br>  6E 00 - Kelas tidak valid </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446552/">https://habr.com/ru/post/id446552/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446538/index.html">PhotoGuru beralih ke "sisi gelap" dan "lebih bijaksana"</a></li>
<li><a href="../id446544/index.html">Microsoft memperluas Program Azure IP Advantage dengan manfaat IP baru untuk inovator dan startup Azure IoT</a></li>
<li><a href="../id446546/index.html">Microsoft Memperluas Azure IP Advantage dengan Manfaat IP Baru untuk Inovator dan Startup Azure IoT</a></li>
<li><a href="../id446548/index.html">Analisis statistik tentang kampanye iklan - buat metrik baru di DataFrame (python)</a></li>
<li><a href="../id446550/index.html">Masalah pola koordinator dan apa yang harus dilakukan RouteComposer dengannya</a></li>
<li><a href="../id446554/index.html">Program residen Yandex, atau How to back-end yang berpengalaman menjadi insinyur-ML</a></li>
<li><a href="../id446558/index.html">Struktur Data Eksotis: Modifikasi Merkle Patricia Trie</a></li>
<li><a href="../id446560/index.html">"Courtesy Exchange": inti dari konflik antara dua perusahaan streaming paling terkenal</a></li>
<li><a href="../id446562/index.html">Asynchrony dalam pemrograman</a></li>
<li><a href="../id446566/index.html">Project Zero. Bagaimana Amazon ingin berurusan dengan pemalsuan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>