<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝🏿 🔑 👉 Comment vendre un git dans un autre git ↕️ 🐙 🌖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Découverte de l'extension du git vendor . 


 Cross-post de mon blog moyen: https://medium.com/opsops/git-vendor-295db4bcec3a 


 Je voudrais présente...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment vendre un git dans un autre git</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442306/"><p> Découverte de l'extension du <code>git vendor</code> . </p><br><p>  <em>Cross-post de mon blog moyen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://medium.com/opsops/git-vendor-295db4bcec3a</a></em> </p><br><p>  Je voudrais présenter la bonne façon de gérer la vente de référentiels git. </p><br><h1 id="what-is-is-vendoring">  Qu'est-ce que la «vente»? </h1><br><p>  La vente est un moyen d'intégrer le travail des autres dans le vôtre.  C'est l'opposé de «lier» une bibliothèque tierce.  Au lieu d'avoir cette bibliothèque comme dépendance, l'application utilise cette bibliothèque en tant que partie de son propre code source et conserve ce code `` à l'intérieur '' lui-même. </p><br><p>  Normalement, la vente se fait par l'outillage linguistique: bundler, cargo, pip, etc.  Mais parfois, vous devez vendre quelque chose qui n'est couvert par aucun jeu d'outils existant, ou quelque chose de multilingue, qu'il est impossible de trouver l'outil de langage «de base» pour cela. </p><br><p>  La solution à cette situation est la vente au niveau git.  Vous avez votre propre référentiel git (je l'appelle « <em>destination repo</em> »), et vous souhaitez incorporer un autre référentiel (je l'appelle « <em>source repo</em> ») en tant que répertoire dans votre (destination repo). </p><br><p>  Les choses que vous attendez d'un système de vente bien conçu (peu importe Git ou non): </p><br><ul><li>  Visibilité  Vous voulez savoir qu'un certain code est vendu, cela signifie qu'il n'a pas été écrit par committer. <a name="habracut"></a></li><li>  Provenance  Vous voulez savoir d'où cela vient.  Quel était le référentiel que quelqu'un avait intégré à votre référentiel il y a deux ans?  Et quelle version / commit était? </li><li>  Mise à jour  Vous voulez pouvoir mettre à jour ce code quand il corrige un bug dans le référentiel d'origine (ou a une nouvelle fonctionnalité attendue depuis longtemps).  Comme cas particulier pour la mise à jour, vous voulez pouvoir supprimer le code commercial (et seulement lui). </li><li>  Répétabilité  La vente ne devrait pas être l'art, elle devrait être le processus rigide à l'abri des erreurs.  le vendeur foo dans la barre devrait donner le même résultat, peu importe qui l'a fait. </li><li>  Transportabilité.  Une personne qui clonera votre référentiel devrait pouvoir continuer à gérer la commercialisation exactement de la même manière que vous.  Cela signifie que toutes les informations liées au fournisseur doivent rester dans le git et être transférées pendant le push / pull. </li><li>  Gouvernance.  Toutes les modifications apportées par le fournisseur doivent rester «telles quelles» jusqu'à ce que quelqu'un les mette à jour.  De plus, vous ne voulez pas avoir de mises à jour inattendues (cassées), vous voulez absolument garder les choses vendues disponibles même si le dépôt source n'est plus disponible. </li><li>  Patchachabilité.  Vous voulez pouvoir modifier le code du fournisseur et toujours le mettre à jour vers une version plus récente.  De préférence, sans conflits, mais au moins, avec une visibilité claire où ces conflits se sont produits. </li></ul><br><p>  Et, étant donné la nature git de Git, vous voulez que ce système soit compatible avec les succursales.  Si la branche A a du code fournisseur à la version a1 et la branche B à la version b1, vous souhaitez basculer entre elles chaque fois que vous basculez entre A et B. De plus, vous voulez pouvoir changer la version a1 en a2 et la version b1 en b2 sans se soucier des versions dans une autre branche. </p><br><p>  ... Et vous voulez pouvoir vendre plus d'un référentiel externe, donc la vente ne doit pas être un événement unique par repo. </p><br><p>  Comme vous pouvez le voir, c'est une longue liste d'exigences.  J'ai analysé les (autres) solutions existantes avant d'arriver à la meilleure solution (git vendor). </p><br><h2 id="copy-paste">  Copier coller </h2><br><p>  Le copier-coller est un moyen si vicieux de vendre n'importe quoi que je n'ai rien de bon à dire à ce sujet.  Vous perdez la provenance, la visibilité, la possibilité de mise à jour.  Vous ne perdez pas la transportabilité, car il n'y a pas de lien avec l'ancien dépôt en premier lieu.  Ne faites pas de vente comme ça. </p><br><h2 id="git-in-git">  Git-in-git </h2><br><p>  C'est une astuce stupide mais quelque peu efficace.  Créez un dossier vendored_foobar dans votre référentiel, allez dans vendored_foobar et clonez cette foobar.  Revenez au niveau supérieur et validez toutes les modifications que vous avez. </p><br><p>  Avantages: simple à faire, fournit une provenance locale, une bonne gouvernance et une excellente patchablité. </p><br><p>  Inconvénients: il est fragile, il ne survit pas à la poussée (le dossier .git imbriqué n'est pas inclus dans votre référentiel, donc pour les observateurs externes, le code fourni par le vendeur est impossible à distinguer du vôtre).  Vous perdrez donc la transportabilité et la provenance à long terme. </p><br><h2 id="submodules">  Sous-modules </h2><br><p>  L'idée est que vous avez certains dossiers de votre git gérés dans un autre git.  C'est le plus ancien `` quelque chose '' que git avait fourni.  Malheureusement, il n'est pas favorable aux succursales et il manque de gouvernance sur le code commercial.  Si le dépôt à distance a disparu, vous ne pouvez pas utiliser vos sous-modules. </p><br><p>  Et n'oubliez pas combien il est difficile de cloner ce dépôt. </p><br><h2 id="git-subtree">  sous-arbre git </h2><br><p>  Git peut utiliser la méthode 'subtree' pour fusionner des gits externes en tant que dossiers dans le référentiel git local.  Il est presque parfait, à l'exception de la mise à jour, de la répétabilité, de la provenance et de la visibilité.  À moins que le manuel ne fouille dans une histoire git, il est impossible de voir quelle partie du dépôt git est vendue et laquelle ne l'est pas.  Et vous ne savez pas d'où viennent ces changements.  Si committer n'a pas écrit cela, les informations sont perdues.  Et si c'est le cas, ce n'est pas reproductible car des changements mineurs peuvent se produire lors du remplissage de ces informations. </p><br><p>  Alors, entrez le gagnant prisé, git vendor. </p><br><h1 id="git-vendor">  Vendeur Git </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Git vendor</a> est une extension étonnante pour git écrite par Brett Langdon il y a environ trois ans.  C'est juste environ 200 lignes en bash, mais c'est tellement bien écrit que je ne m'en plains pas du tout (il a tout ce qu'un bon programme devrait avoir: pages de manuel, aide, achèvement de bash, gestion raisonnable des erreurs et protections de sécurité). </p><br><p>  Il utilise git subtree et l'étend avec des fonctions pour couvrir les côtés lâches de la vente par git subtree. </p><br><p>  Chaque point important est vérifié: </p><br><ul><li>  visibilité.  Appelez simplement la <code>git vendor list</code> et voyez toutes les choses vendues. </li><li>  provenance.  Il montre le dépôt à distance et permet de voir quel commit a été vendu. </li><li>  possibilité de mise à jour.  <code>git vendor update</code> , et il prend en charge les branches, les balises et les commits comme un moyen de déterminer exactement ce qu'il faut prendre.  Et vous pouvez bien sûr <code>git vendor remove</code> . </li><li>  répétabilité.  Il n'y a aucune opération manuelle impliquée, donc tout le monde obtiendra le même résultat lors de la première livraison ou des mises à jour suivantes. </li><li>  transportabilité.  Toutes les modifications sont stockées sous forme de balises spéciales dans l'historique git, elles sont donc entièrement compatibles push / pull.  Et ils fonctionnent très bien avec les succursales et les retraits d'historique arbitraires. </li><li>  govenrance.  Tout le code commercial est stocké dans votre référentiel. </li><li>  patchachabilité.  C'est le cas (vous verrez une fusion claire des conflits avec vos modifications), mais c'est le côté le plus faible de git vendor.  Je préférerais avoir une 'file d'attente de correctifs' (comme dans debian / pathes pour les paquets deb), mais néanmoins, il y a un support minimal pour cela. </li></ul><br><p>  Il a une politique spécifique sur la façon dont les choses sont vendues: si vous voulez cloner <code>https://github.com/serverscom/dibctl</code> il va dans <code>vendor/github.com/serverscom/dibctl/</code> .  Vous pouvez changer la partie ' <code>vendor/</code> ', mais le reste est une politique difficile.  Les liens symboliques peuvent cependant faciliter cela. </p><br><p>  Il y a quelques bugs mineurs: vous ne pouvez pas l'utiliser sur des dépôts vides, vous ne pouvez pas utiliser les gits locaux comme sources, vous ne pouvez pas voir d'aide tant que vous n'êtes pas dans git repo.  Aucun d'entre eux ne pose de problèmes lors d'un travail normal avec de vrais repos. </p><br><h1 id="conclusion">  Conclusion </h1><br><p>  git-vendor est un outil parfait pour vendre un dépôt git dans un autre.  Il fournit toutes les fonctionnalités requises pour les meilleures pratiques de vente: conserver la provenance, assurer la visibilité et la mise à jour. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442306/">https://habr.com/ru/post/fr442306/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442292/index.html">Stage Sberseasons: Python, UX / UI, Data et bien plus encore pour les étudiants</a></li>
<li><a href="../fr442294/index.html">Ce qu'Oleg Artamonov a légèrement tort</a></li>
<li><a href="../fr442298/index.html">Gatsby.js en détail</a></li>
<li><a href="../fr442300/index.html">Je regarde et j'écoute où je veux. Intégration de Chromecast dans une application Android</a></li>
<li><a href="../fr442304/index.html">Smartphones pliants: qu'en est-il des applications?</a></li>
<li><a href="../fr442310/index.html">Micrologiciel Sonoff Basic via Raspberry Pi</a></li>
<li><a href="../fr442312/index.html">DoT pour la distribution RPZ</a></li>
<li><a href="../fr442316/index.html">Une bibliothèque C ++ compacte pour programmer des méthodes de différences finies de type opérateur. Partie 1. Sémantique</a></li>
<li><a href="../fr442318/index.html">Comment faire un changement avec une rétrospective</a></li>
<li><a href="../fr442320/index.html">Ordinateur portable Compaq LTE 5000, deuxième partie - sur les lacunes et leur traitement</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>