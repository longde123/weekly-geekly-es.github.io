<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè≠ üåï ‚úÖ Automatizaci√≥n de pruebas End-2-End de un sistema de informaci√≥n integrado. Parte 2. T√©cnica üíæ üêÉ üë®üèª‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Con este art√≠culo, continuamos una serie de publicaciones sobre c√≥mo automatizamos en uno de los grandes proyectos LANIT el autoprocesamiento de prueb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatizaci√≥n de pruebas End-2-End de un sistema de informaci√≥n integrado. Parte 2. T√©cnica</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/477044/">  Con este art√≠culo, continuamos una serie de publicaciones sobre c√≥mo automatizamos en uno de los grandes proyectos LANIT el autoprocesamiento de pruebas manuales (en lo sucesivo denominadas pruebas autom√°ticas) de un gran sistema de informaci√≥n (en lo sucesivo, Sistemas) y lo que surgi√≥ de √©l. <br><br>  La segunda parte de la publicaci√≥n se centra principalmente en los l√≠deres de los grupos de automatizaci√≥n de pruebas de interfaz de usuario de extremo a extremo y la automatizaci√≥n de pruebas l√≠der.  Aqu√≠ encontrar√°n recetas espec√≠ficas para la organizaci√≥n arquitect√≥nica del c√≥digo y la implementaci√≥n, lo que respalda el desarrollo paralelo en masa de grandes grupos de pruebas frente a la variabilidad constante de las especificaciones de prueba.  Esta parte contiene la lista completa de funciones necesarias para las pruebas de IU con algunos detalles de implementaci√≥n, as√≠ como una lista de sorpresas que puede encontrar. <br><br>  <i>Aqu√≠ encontrar√° la <a href="https://habr.com/ru/company/lanit/blog/473426/"><b>Parte 1. (¬øPor qu√© necesit√°bamos automatizaci√≥n? Organizaci√≥n del proceso de desarrollo y gesti√≥n. Organizaci√≥n de uso)</b></a></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e47/985/776/e4798577680ae78fcb67f4c6c8976800.jpg"></div>  <i><a href="https://www.dreamstime.com/">Fuente</a></i> <br><a name="habracut"></a><br><h1>  Pila de arquitectura y tecnolog√≠a </h1><br><h3>  Estructura general del sistema y su entorno: dise√±o de alto nivel </h3><br>  Las principales tecnolog√≠as y bibliotecas utilizadas en el proyecto: <br><br><ul><li>  JavaSE8 &amp; maven &amp; JUnit - pila de desarrollo; </li><li>  <a href="https://www.seleniumhq.org/">Selenium</a> : una biblioteca para automatizar las acciones de un navegador web; </li><li>  <a href="https://ru.selenide.org/">Selenide</a> : un complemento para Selenium, que tiene una API elegante que simplifica enormemente la interacci√≥n con el navegador y los elementos de la p√°gina; </li><li>  <a href="https://aerokube.com/selenoid/latest/">Selenoid y GGR</a> : implementaci√≥n de Selenium Grid y un equilibrador de carga para ejecutar pruebas en un servidor CI + contenedores preconfigurados con navegadores; </li><li>  <a href="http://allure.qatools.ru/">Yandex Allure</a> : para informes en el servidor CI. </li></ul><br>  Un diagrama general de los componentes de las pruebas autom√°ticas y la infraestructura selenoide se muestra en los diagramas a continuaci√≥n, incluidos los comentarios explicativos: <br><br>  <b>Marco de Autopruebas</b> <br>  Aplicaci√≥n para la automatizaci√≥n de la regresi√≥n de la interfaz de usuario. <br>  Entregado en c√≥digo fuente.  Utiliza JUnit4 <br><br>  <b>run.properties</b> <br>  Archivo de configuraci√≥n para ejecutar Autotests.  Define el nombre condicional del soporte utilizado y el tipo de ejecuci√≥n: local o mediante contenedores externos y otras variables. <br><br>  <b>Complemento Allure</b> <br>  Un archivo ejecutable especial que se instala en un servidor Bamboo. <br>  Crea un informe HTML de prueba accesible a trav√©s de un servidor Bamboo. <br><br>  <b>Informe de prueba</b> <br>  Pruebe el informe HTML disponible a trav√©s del servidor Bamboo. <br>  Se almacena en el servidor Bamboo en los resultados del plan en una pesta√±a separada. <br><br>  <b>De bamb√∫</b> <br>  Proporciona el lanzamiento de pruebas de integraci√≥n en modo autom√°tico y manual. <br>  Almacena informes de prueba en formato Allure. <br><br>  <b>servidor ggr</b> <br>  Equilibrador de servidores de servidores selenoides. <br>  Proporciona el equilibrio de las solicitudes de las pruebas autom√°ticas (RemoteWebDriver) a varias instancias de servidores de selenio. <br><br>  <b>Docker</b> <br>  Servidor Docker para ejecutar contenedores y navegadores del servidor selenoide. <br><br>  <b>Servidor selenoide</b> <br>  Servidor de prueba remota <br>  Proporciona el lanzamiento de pruebas en contenedores acoplados especializados utilizando un navegador "sin cabeza". <br>  Realiza pruebas en modo paralelo de acuerdo con el n√∫mero especificado de subprocesos simult√°neos. <br><br>  <b>Selenoid-ui</b> <br>  Interfaz de usuario del servidor al servidor selenoide. <br>  Permite el monitoreo sobre la marcha del progreso de la prueba a trav√©s de VNC. <br><br>  <b>Selenoide-webdriver</b> <br>  Un contenedor especializado con un navegador sin cabeza para ejecutar pruebas remotas. <br>  Proporcionado desde el repositorio selenoide. <br><br>  <b>Gitlab</b> <br>  Almacena el c√≥digo fuente de la aplicaci√≥n Autotests. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c5d/cac/f81/c5dcacf817e4aa1529d7cc4d64be740d.png"></div><br><h3>  Esquema de trabajo </h3><br>  El siguiente diagrama muestra el esquema general del servicio AutoTests en el nivel de dise√±o de alto nivel. <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/ye/e8/ue/yee8uexl8oqy5spoqirropxglha.png"></a> </div><br><h3>  Instalaci√≥n e Implementaci√≥n </h3><br>  Las pruebas autom√°ticas se basan en cuatro servidores, uno de los cuales es el servidor de ejecuci√≥n, y los otros tres proporcionan el lanzamiento de navegadores sin cabeza en contenedores.  El poder actual de las pruebas autom√°ticas proporciona 60 transmisiones simult√°neas y se puede ampliar si es necesario. <br><br>  El diagrama de implementaci√≥n actual se muestra en el siguiente diagrama.  En general, si no necesita m√°s de 20 navegadores simult√°neos (subprocesos de prueba), entonces es muy posible poner todo en un servidor 12 Kernels + 24 RAM.  Comenzamos con esta configuraci√≥n, pero a medida que crecieron los requisitos para el poder de las pruebas autom√°ticas, descubrimos emp√≠ricamente que la configuraci√≥n m√°s estable y rentable es un servidor "t√≠pico" 12 Kernel + 24 RAM. <br><br>  En nuestra experiencia, para probar sistemas con una interfaz web en Angular, la configuraci√≥n aceptable del contenedor con el navegador debe ser el piso del kernel + GB de memoria.  Una configuraci√≥n m√°s peque√±a ralentiza el navegador e incluso puede provocar bloqueos no identificables. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/152/65f/095/15265f09560a8abd9a744e5c06da1f61.png"></div><br><h1>  Estructura del c√≥digo y organizaci√≥n </h1><br>  Antes de pasar a la estructura y organizaci√≥n del c√≥digo, una vez m√°s enumerar√© las pol√≠ticas y restricciones que finalmente determinaron la direcci√≥n del desarrollo de la arquitectura: <br><br><ul><li>  Una gran cantidad de scripts de prueba complejos de extremo a extremo.  Alta intensidad de desarrollo; </li><li>  alta volatilidad de los escenarios de prueba (su variabilidad); </li><li>  alta velocidad continua de entrega de escenarios (desarrollo y revisi√≥n); </li><li>  calificaciones iniciales de desarrolladores de autotests; </li><li>  Alto desarrollo planificado de desarrolladores. </li></ul><br>  Con base en lo anterior, los principales impulsores arquitect√≥nicos son los siguientes: <br><br><ul><li>  asegurando un c√≥digo altamente estructurado para una f√°cil lectura y manejabilidad; </li><li>  separaci√≥n y aislamiento m√°ximos entre implementaciones de aplicaciones de pruebas espec√≠ficas y clases transversales de funcionalidad com√∫n; </li><li>  reducci√≥n m√°xima de dependencias requeridas para facilitar el cambio; </li><li>  Reutilizaci√≥n razonable de c√≥digo a nivel de clases transversales con posible duplicaci√≥n de c√≥digo aceptable a nivel de grupos de prueba independientes (subsistemas funcionales) para reducir dependencias y fusionar conflictos a nivel de desarrollo; </li><li>  rechazo de marcos complejos como spring, aspecto J para reducir el tiempo de "entrada" de desarrolladores novatos en el proyecto. </li></ul><br>  En general, este enfoque arquitect√≥nico permiti√≥ implementar un desarrollo r√°pido e independiente en condiciones de alta variabilidad de escenarios con un proceso pr√°cticamente continuo de entrega de nuevas pruebas a los productivos.  La arquitectura y ahora resisten con √©xito la "carga y el refinamiento" a pesar del hecho de que el sistema ya ha implementado m√°s de 1,500 escenarios comerciales. <br><br>  La estructura general del c√≥digo y las descripciones de soluciones espec√≠ficas clave se dan a continuaci√≥n. <br><br><h3>  Estructura general del c√≥digo y patrones de desarrollo. </h3><br>  La estructura general de la organizaci√≥n del c√≥digo se basa en una arquitectura "en capas" (ver diagrama), que generalmente hereda el patr√≥n de p√°gina recomendado por los desarrolladores de Selenium.  Expandimos este patr√≥n agregando un nivel de elementos web a la base y destacando el nivel del escenario de prueba: <br><br><ul><li>  prueba de nivel de clase </li><li>  nivel de escenario de prueba </li><li>  nivel de p√°gina web </li><li>  nivel de elemento web </li><li>  marco de prueba (se muestra atenuando en el diagrama). </li></ul><br>  Cada nivel en este esquema tiene un conjunto espec√≠fico de responsabilidades y funcionalidad.  La intersecci√≥n funcional entre capas o las dependencias ileg√≠timas entre ellas no estaban permitidas y eran la raz√≥n principal para la devoluci√≥n del commit para revisi√≥n como parte de una revisi√≥n de c√≥digo antes de la solicitud de fusi√≥n. <br><br>  Adem√°s, se arregl√≥ una estructura "en capas" en la divisi√≥n del c√≥digo en paquetes (ver diagrama a continuaci√≥n). <br><br>  Tal esquema hizo posible dividir todos los subsistemas (de los cuales hab√≠a significativamente m√°s que en el esquema) entre los desarrolladores y, como resultado, hizo posible el desarrollo independiente con un n√∫mero pr√°cticamente desaparecido de conflictos de fusi√≥n. <br><br>  El siguiente diagrama muestra la estructura general de la implementaci√≥n de la clase de prueba y el esquema de distribuci√≥n para la implementaci√≥n de los paquetes del proyecto. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c26/582/00e/c2658200ed322c07b65492aef2479074.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/caf/528/329/caf52832908c9f9d739b891d1aafb29d.png"></div><br><h3>  Prueba de nivel de clase </h3><br>  El nivel de clase de prueba incluye una sola clase para una prueba individual en particular (la prueba se describe en el sistema de gesti√≥n de prueba como una secuencia lineal de scripts de prueba).  La clase de prueba es una clase Junit con la anotaci√≥n @ Test del m√©todo correspondiente.  En general, una clase de prueba implementa solo un m√©todo de prueba. <br><br>  Cada clase de prueba hereda de una clase base cuya tarea es inicializar todas las TestRules en RuleChain, es decir, inicializar una infraestructura de prueba como inicializar un controlador web, configurar directorios temporales y otros manejadores de utilidad de prop√≥sito general. <br><br>  La clase de prueba es responsable de organizar la ejecuci√≥n del escenario de prueba a trav√©s de: <br><br><ol><li>  inicializaci√≥n de datos comerciales de prueba (escena de prueba), </li><li>  llamada secuencial de scripts de prueba individuales (Acciones) de acuerdo con el escenario requerido con la transferencia de datos de prueba inicializados a ellos desde el paso 2. </li></ol><br>  Adem√°s, en el paso 2 debe haber una secuencia lineal sin ramificaciones ni puntos de decisi√≥n.  La plantilla de implementaci√≥n de clase se muestra a continuaci√≥n. <br><br><h3>  Nivel de caso de prueba </h3><br>  El nivel de caso de prueba es responsable de la implementaci√≥n de casos de prueba espec√≠ficos como se describe.  Un escenario de prueba en este contexto es una secuencia de operaciones realizadas por un usuario en un sistema a trav√©s de la interacci√≥n con elementos en las p√°ginas web de la aplicaci√≥n. <br><br>  El objetivo principal de la clase de caso de prueba: <br><br><ul><li>  ejecute la secuencia dada del script de prueba accediendo a los m√©todos de las clases inferiores de P√°gina, usando <br><br>  o transmiti√≥ datos de la escena de prueba, <br>  o datos recibidos de p√°ginas web (de clases de p√°gina); </li><li>  Realice las pruebas comerciales requeridas para el √©xito de la prueba en el contexto del modelo comercial y la escena de prueba.  <b>En otras palabras, la clase de caso de prueba NO verifica el marcado, la disponibilidad y la accesibilidad de los elementos, sino que opera en el modelo comercial de la escena de prueba, en realidad realiza pruebas comerciales.</b> </li></ul><br>  La clase de caso de prueba est√° organizada como una "interfaz funcional": <br><br><ul><li>  contiene solo un m√©todo p√∫blico "aplicar" (@ Paso), que: <br><br>  o proporciona la implementaci√≥n del script como una llamada a una secuencia de "acciones" (m√©todos proporcionados por las clases de la p√°gina), <br>  o acepta todos los objetos comerciales necesarios como entrada, mientras que NO CREA ning√∫n objeto comercial en s√≠ mismo y NO INTERACCIONA directamente con nada que no sean clases de p√°gina; </li><li>  contiene X m√©todos privados (@ Step), cada uno de los cuales implementa un paso espec√≠fico por separado del script de prueba (como se describe en TMS - Test Management System); </li><li>  No interact√∫a (no llama a m√©todos) con otras actividades, incluso actividades de un subsistema similar; </li><li>  no acepta entradas y no funciona con datos de inicio de sesi√≥n.  En otras palabras, no sabe nada sobre los roles desde los que se inicia. </li></ul><br>  Esta organizaci√≥n de clase te permite: <br><br><ul><li>  Proporcionar informe autodocumentado.  Cada m√©todo corresponde a un punto espec√≠fico en la especificaci√≥n de prueba y est√° anotado por la anotaci√≥n de encanto @ Paso; </li><li>  reutilice las clases de script de prueba en diferentes pruebas, ya que el script de prueba 1) no crea una escena de prueba y 2) no depende del inicio de sesi√≥n del usuario (la operaci√≥n de inicio de sesi√≥n de inicio de sesi√≥n se realiza a nivel de clase de prueba) 3), la prueba no depende de otras clases secuencias de comandos </li></ul><br><h3>  Nivel de p√°gina web </h3><br>  El nivel de p√°gina web es un patr√≥n de p√°gina cl√°sico para probar en Selenium.  La clase de p√°gina contiene definiciones de elementos web espec√≠ficos y un conjunto de m√©todos p√∫blicos para realizar ciertas acciones grupales en el contexto de los pasos del caso de prueba. <br><br>  La clase de p√°gina es directamente responsable de ingresar datos comerciales en elementos de interfaz espec√≠ficos, trabajar con el controlador web (iniciar JS, por ejemplo) y, en consecuencia, probar formatos, verificar el dise√±o y la estructura de la p√°gina web para verificaciones b√°sicas como: el elemento no es encontrado / no disponible y el art√≠culo no contiene el valor requerido. <br><br>  La clase de p√°gina tampoco incluye y no puede acceder a otras p√°ginas y sus m√©todos.  Adem√°s, las clases de p√°gina no llevan a cabo verificaciones comerciales, limit√°ndose solo a verificaciones estructurales a nivel de elementos web en el caso general, proporcionando "hasta" al nivel de "script de prueba" datos recibidos de las p√°ginas. <br><br><h3>  Nivel de elemento web </h3><br>  La capa de elementos web incluye una biblioteca de elementos finitos que pueden estar en una p√°gina web.  Incluye primitivas espec√≠ficas y conglomerados m√°s complejos, que consta de varios elementos que llamamos widgets.  Ejemplos de widgets pueden ser construcciones como "pajinators", men√∫s globales, varios marcos y ventanas modales, elementos complejos como YandexMap o el reproductor de Youtube.  Los elementos web organizan la composici√≥n con clases de p√°gina espec√≠ficas y tampoco saben nada sobre otros elementos. <br><br>  En general, si el proyecto tiene alg√∫n tipo de identificaci√≥n global √∫nica de todos los elementos de la interfaz con su ID, entonces tiene sentido organizar el nivel de elementos web como una biblioteca global con solicitud de elementos espec√≠ficos por su ID a trav√©s de las clases de configuraci√≥n de f√°brica o \ xml en la biblioteca de Spring.  Pero no en todos los proyectos esto es posible. <br><br><h3>  Marco de prueba </h3><br>  El concepto de desarrollar pruebas autom√°ticas, como se muestra en el diagrama anterior, se basa en la idea de un marco en el que se proporciona un conjunto de funciones del sistema para todas las pruebas autom√°ticas: est√°n perfectamente integradas y permiten a los desarrolladores de pruebas autom√°ticas centrarse en cuestiones espec√≠ficas de implementaci√≥n comercial de clases de prueba. <br><br>  El marco incluye los siguientes bloques funcionales: <br><br><ul><li>  Reglas: inicializaci√≥n y finalizaci√≥n de componentes de infraestructura de prueba como inicializaci√≥n de WebDriver y recepci√≥n de una prueba de video (descrita con m√°s detalle a continuaci√≥n); </li><li>  WebDriverHandlers: funciones de ayuda para trabajar con un controlador web, como ejecutar Java Script o acceder a los registros del navegador.  Implementado como un conjunto de m√©todos est√°ticos sin estado; </li><li>  WebElements: una biblioteca de elementos web t√≠picos o sus grupos, contiene la funcionalidad de funci√≥n cruzada requerida y el comportamiento t√≠pico.  En nuestro caso, esta funcionalidad incluye una posible verificaci√≥n de la finalizaci√≥n de operaciones asincr√≥nicas en el lado del navegador web.  Implementado como extensiones de elementos web de las bibliotecas Selenium y Selenide. </li></ul><br><h3>  Inicializaci√≥n del entorno de prueba.  Reglas </h3><br>  La clase clave para todas las clases de prueba es BaseTest, de la cual se heredan todas las clases de prueba.  La clase BaseTest define el "corredor" de pruebas de Junit y el RuleChain utilizado, como se muestra a continuaci√≥n.  El acceso desde las clases de prueba de la aplicaci√≥n a las funciones proporcionadas por las clases de reglas se lleva a cabo a trav√©s de los m√©todos est√°ticos de las clases de reglas utilizando el identificador de hilo "hilo" como clave. <br><br>  Los detalles de la implementaci√≥n de las clases base para el marco de prueba autom√°tica se mostrar√°n en la siguiente parte del art√≠culo: consulte la Parte 2-1.  Implementaci√≥n de clase base para todas las pruebas y JUnit ChainRule. <br><br><h3>  Documentaci√≥n de resultados a trav√©s de informes de Allure. </h3><br>  Para obtener informes detallados sobre las pruebas realizadas, se utiliza Allure Framework, integrado con Bamboo a trav√©s de <a href="https://docs.qameta.io/allure/">Allure Plugin</a> .  Esto brinda una oportunidad para que consumidores espec√≠ficos de pruebas (equipo de pruebas funcionales) no solo reciban datos sobre el hecho de una falla de prueba espec√≠fica, sino tambi√©n para restaurar f√°cilmente y, si es necesario, repetir una prueba descartada en modo manual. <br><br>  Para documentar el informe de prueba, se utiliza la siguiente funcionalidad: <br><br><ul><li>  Anotaciones de Allure y Junit para marcar el informe por los pasos del gui√≥n de prueba, as√≠ como una descripci√≥n est√°tica de los metadatos para la prueba; </li><li>  Atraiga los archivos adjuntos para adjuntar al informe informaci√≥n adicional como una prueba de video, captura de pantalla, resultados de diagn√≥sticos adicionales de los motivos del bloqueo, registros del navegador web descargados al / del navegador de archivos. </li></ul><br>  Las siguientes anotaciones de Allure y Junit se utilizan para marcar el informe. <br><br><ul><li>  A nivel de clase de prueba: <br><br>  o @ Feature: el nombre del subsistema funcional al que pertenece la prueba; <br>  o @ Story: el nombre de un caso de prueba espec√≠fico; <br>  o @ Propietario: el nombre del desarrollador que realiz√≥ los √∫ltimos cambios a la prueba; <br>  o @ TmsLink: enlace a la descripci√≥n de la prueba en el "sistema de gesti√≥n de pruebas" utilizado. </li><li>  En el nivel del m√©todo de prueba (@ Prueba) de la clase de prueba: <br><br>  o @ DisplayName: nombre completo del script de prueba.  Se diferencia de @ Story en que le permite compartir los mismos guiones, que difieren solo en la composici√≥n de la escena de prueba; </li><li>  A nivel de m√©todos que corresponden a los pasos espec√≠ficos del escenario de prueba: <br><br>  o @ Step: el nombre significativo del paso de prueba que refleja la esencia comercial de lo que est√° sucediendo. </li></ul><br>  El nombramiento de los pasos de prueba a trav√©s de @ Step le permite crear un informe detallado que repite completamente todos los pasos y elementos descritos en el escenario de prueba.  Esto permite a los usuarios de pruebas autom√°ticas rastrear f√°cilmente el curso del escenario de prueba y ayuda a determinar el punto de incidencia. <br><br>  En general, usar Allure Framework demostr√≥ ser muy √∫til y f√°cil, con la excepci√≥n de algunas caracter√≠sticas relacionadas con la gran cantidad de datos que se generan en nuestro caso para una gran cantidad de scripts de prueba complejos largos (descritos m√°s adelante en la secci√≥n "Retrospectiva"). <br><br><h3>  ¬øQu√© podr√≠a haberse hecho de manera diferente de inmediato?  Use Spring Framework </h3><br>  A pesar del hecho de que al implementar las pruebas autom√°ticas, nos negamos intencionalmente a usar Spring Core, en general, considero que su uso est√° justificado y funciona.  El prototipo implementado mostr√≥ que usar Spring Core funciona para las siguientes tareas (aunque, por supuesto, no lo probamos completamente): <br><br><ul><li>  inicializaci√≥n de la escena de prueba; </li><li>  inicializaci√≥n de p√°ginas web y elementos. </li></ul><br>  La √∫nica caracter√≠stica es la necesidad de utilizar el contexto de alcance "predeterminado" del nivel de prototipo. <br><br>  Inicializaci√≥n de la escena de prueba.  En las pruebas autom√°ticas, la escena de prueba se inicializa mediante el m√©todo cl√°sico de crear instancias de clase directamente en la clase de prueba a trav√©s de una simple f√°brica nueva o de objetos.  Aqu√≠ es bastante razonable utilizar la inicializaci√≥n ya sea a trav√©s de clases de configuraci√≥n o mediante archivos xml o archivos externos.  Las ventajas son las siguientes: 1) simplifica el c√≥digo de revisi√≥n, ya que los cambios en la escena de prueba ya no se aplican a las clases clave, 2) le permite conectar diferentes escenas de prueba para diferentes soportes u otras condiciones.  Ahora el punto 2 no se usa con nosotros. <br><br>  Inicializaci√≥n de p√°ginas web y elementos.  La inyecci√≥n de clases de p√°ginas web y elementos web funciona en virtud de la inicializaci√≥n perezosa perezosa de elementos web de seleniuro. <br><br>  Por lo tanto, es posible crear una biblioteca de elementos web y p√°ginas de acuerdo con una determinada especificaci√≥n global de la interfaz de usuario y recibir en los enlaces de c√≥digo a estos elementos no por la ruta absoluta y la identificaci√≥n, sino por la identificaci√≥n del proyecto de acuerdo con la especificaci√≥n. <br><br>  Debo decir de inmediato que no prob√© esto con mucho cuidado, de hecho me limit√© a una implementaci√≥n de prueba de las "p√°ginas" del inicio de sesi√≥n y la p√°gina "informaci√≥n" del usuario sobre este principio. <br><br><h1>  Retrospectiva  Sorpresas </h1><br>  Aqu√≠ describ√≠ las sorpresas inesperadas que surgieron durante el desarrollo del proyecto, adem√°s de algunas consideraciones sobre lo que podr√≠a haberse hecho mejor si "no". <br><br><h3>  Marcado de front-end amigable con selenio (angular) </h3><br>  Una de las sorpresas m√°s serias que encontramos fue el dise√±o de p√°gina "flotante", lo que llev√≥ al hecho de que despu√©s de actualizar las aplicaciones de Angular, las pruebas cayeron porque Selenium no pudo encontrar los elementos debido a su ID (id, clase o ng-model) o rutas (para XPath).  Esto condujo a la inestabilidad de las pruebas y la ambig√ºedad de las razones de la ca√≠da. <br><br>  Desafortunadamente, este problema result√≥ ser generalmente insoluble.  Lo eludimos con medidas organizativas: 1) al comienzo de la prueba de un nuevo candidato para el lanzamiento, todos los desarrolladores de pruebas autom√°ticas se centran en la eliminaci√≥n y el refinamiento r√°pidos en t√©rminos de edici√≥n de los valores de los localizadores de elementos web;  2) al final, llegamos a usar XPath relativo, que, por desgracia, no mejora el rendimiento en absoluto. <br><br>       ‚Äì            ,         -        . <br><br><h3>     ¬´download¬ª  </h3><br>  ¬´¬ª        : <br><br><ul><li>  ¬´¬ª   (    ) ‚Äì   ¬´¬ª          .          ; </li><li>  ¬´¬ª  ( Bamboo)  ¬´¬ª       solenoid : <a href="http://selenoid-host.example.com:4444/download/%257BSESSION_ID%257D/%257BFILE_NAME%257D">selenoid-host.example.com:4444/download/{SESSION_ID}/{FILE_NAME}</a> </li></ul><br>    <a href="https://aerokube.com/selenoid/latest/"></a> . <br><br>            .     ,      ,         .           ,       . <br><br><h3>     </h3><br>         .        ,   ¬´¬ª          . ,                  ,  ,  ,     ,       - (    )  -     . <br><br>  ,       ,    ,       .             . <br><br>    ,    .         ¬´¬ª ,          ,     ,            . <br><br><h3>    </h3><br>              . ,      .      (~ 1000  )       6 . <br><br>          <a href="https://aerokube.com/ggr/latest/">Selenoid-ggr</a> .        junit  20 ( Selenoid-)  60 ( ),        . ¬´¬ª ,          60  . <br><br> ,    ,  ,         3-4 ,        preQA-.    . , ,   AWS c   ,    Selenoid-     ,         AWS   Selenoid,     in/out . <br>   ,       ,             E2E      .              preQA. <br><br><h3>  ¬´¬ª       </h3><br>        ,         60     60 . <br><br>    ¬´Timeline¬ª    ¬´ ¬ª (  ). ,             . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/580/84e/60b/58084e60b239a6157b54db4e8b9c496c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hubo dos razones. </font><font style="vertical-align: inherit;">El "enchufe" inicial fue causado por la apelaci√≥n masiva al servicio de autorizaci√≥n y cuenta personal. </font><font style="vertical-align: inherit;">Todos los navegadores comienzan simult√°neamente a iniciar sesi√≥n y sobrecargan el servicio en el banco de pruebas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las "columnas" posteriores resultaron estar relacionadas con el hecho de que las clases de prueba est√°n ubicadas en carpetas por subsistema y junit las ejecut√≥ casi simult√°neamente, cargando as√≠ un subsistema funcional espec√≠fico del soporte e ir m√°s all√° del l√≠mite de rendimiento de la configuraci√≥n del soporte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resolvimos el primer problema envolviendo el m√©todo del script de inicio de sesi√≥n en el equilibrador, que limit√≥ el n√∫mero m√°ximo de operaciones de inicio de sesi√≥n a una constante dada.</font></font><br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Step</span></span>(<span class="hljs-string"><span class="hljs-string">":    "</span></span>)     <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{     <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {         LoadCounter.get(); <span class="hljs-comment"><span class="hljs-comment">//   .              try {                 applyLogin(user); //          } catch (Throwable t) {             throw t; //                   } finally {             LoadCounter.release(); //            }         } catch (LoadCounterException e) { //                  throw new StandRuntimeException("Can not get loadcounter for Login action.", e);     }     }</span></span></code> </pre> <br>  El segundo problema se resolvi√≥ activando la opci√≥n de ejecuci√≥n de prueba aleatoria, que tiene el complemento junit maven. <br><br><pre> <code class="java hljs">   &lt;plugin&gt;               &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;         &lt;version&gt;‚Ä¶.&lt;/version&gt;            &lt;configuration&gt;                &lt;!-- Defines the order the tests will be run in. Supported values are <span class="hljs-string"><span class="hljs-string">"alphabetical"</span></span>,                     <span class="hljs-string"><span class="hljs-string">"reversealphabetical"</span></span>, <span class="hljs-string"><span class="hljs-string">"random"</span></span>,<span class="hljs-string"><span class="hljs-string">"hourly"</span></span>, <span class="hljs-string"><span class="hljs-string">"failedfirst"</span></span>, <span class="hljs-string"><span class="hljs-string">"balanced"</span></span> and <span class="hljs-string"><span class="hljs-string">"filesystem"</span></span>. --&gt;                &lt;runOrder&gt;random&lt;/runOrder&gt;                ‚Ä¶</code> </pre><br>  Cabe se√±alar que estos problemas estaban relacionados con el hecho de que no tuvimos la oportunidad de aumentar el rendimiento del banco de pruebas debido a los recursos limitados, y tambi√©n porque estos recursos estar√≠an inactivos la mayor parte del tiempo. <br><br>  En general, result√≥ que el sistema E2E incorporado de las autocomprobaciones de la interfaz de usuario web puede usarse para pruebas de carga sustitutas y para evaluar el rendimiento y la estabilidad del sistema probado en su conjunto. <br><br><h3>  Alta carga en el servidor Bamboo y su almacenamiento </h3><br>  Si tiene muchas pruebas con una gran cantidad de operaciones (por ejemplo, la cantidad de operaciones registradas a trav√©s del <a href="https://habr.com/ru/users/step/" class="user_link">Paso</a> es de 200 a 2000 con una cantidad de pruebas de aproximadamente 1300), entonces el volumen del informe Allure se vuelve m√°s que significativo.  Si agrega aqu√≠ tambi√©n varios archivos adjuntos, como capturas de pantalla y archivos cargados / cargados, el volumen ya llega a cientos de megabytes.  Por ejemplo, ahora para una regresi√≥n nocturna de 900 pruebas, la cantidad de datos cargados solo en Bamboo Allure es de aproximadamente 600 MB. <br><br>  Est√° claro que los ingenieros de DevOps no est√°n entusiasmados con la intensidad del consumo de espacio en disco y expresan activamente su insatisfacci√≥n, especialmente en relaci√≥n con la necesidad de almacenar datos durante al menos un a√±o. <br><br>  Vemos una salida a esta situaci√≥n mediante el uso de un servidor externo para almacenar y procesar informes, por ejemplo, como Allure Enterprise.  Este servidor ya est√° pagado, pero nos permite resolver este problema.  Actualmente estamos trabajando para probar e integrar Allure Enterprise en nuestro proyecto. <br><br><h1>  Para continuar </h1><br>  En el pr√≥ximo art√≠culo, mis colegas continuar√°n la historia y describir√°n la fascinante historia de las pruebas de servicios web utilizando Smartbear SoapUI Pro.  Las fuerzas de dos ingenieros de automatizaci√≥n lograron automatizar alrededor de 500 scripts de prueba; para este prop√≥sito, tuve que implementar un marco adicional que expande significativamente la funcionalidad de las funciones est√°ndar de la interfaz de usuario SOAP, pero m√°s sobre eso m√°s adelante. <br><br>  <b><i>Este art√≠culo fue escrito en colaboraci√≥n con el gerente del proyecto y el propietario del producto <a href="https://habr.com/ru/users/kotalesssk/" class="user_link">kotalesssk</a> .</i></b> <br><br>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Parte 1. Organizacional y gerencial.</a>  <a href="https://habr.com/ru/company/lanit/blog/473426/">¬øPor qu√© necesitamos automatizaci√≥n?</a>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Organizaci√≥n del proceso de desarrollo y gesti√≥n.</a>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Organizaci√≥n de uso</a> <br>  Parte 2. T√©cnica.  Arquitectura y pila t√©cnica.  Detalles de implementaci√≥n y sorpresas t√©cnicas. <br>  Parte 2-1.  Implementaci√≥n de clase base para todas las pruebas y JUnit ChainRule <br>  Parte 2-2.  Implementaci√≥n del proceso de carga de un archivo desde un contenedor con un navegador a un marco de prueba.  Busque el nombre del archivo descargado por el navegador <br><br><div class="spoiler">  <b class="spoiler_title">Tenemos vacantes, ven a nosotros!</b> <div class="spoiler_text"><ul><li>  <a href="https://job.lanit.ru/young/programs/Pages/dks2019testir.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Programa de pasant√≠as "Pruebas automatizadas"</a> </li><li>  <a href="https://job.lanit.ru/young/programs/Pages/dks-2019.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Programa de pr√°cticas "Pruebas de carga"</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/CH-165.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Aprendiz de ingeniero de pruebas</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/BS-72.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Especialista l√≠der en pruebas funcionales</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/BS-46.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Ingeniero principal de pruebas automatizadas</a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/477044/">https://habr.com/ru/post/477044/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../477026/index.html">S√©ptimo Hackathon anual de JetBrains</a></li>
<li><a href="../477032/index.html">De blockchain a DAG: deshacerse de los intermediarios</a></li>
<li><a href="../477038/index.html">El mejor lenguaje de programaci√≥n para principiantes.</a></li>
<li><a href="../477040/index.html">Gartner chart 2019: ¬øde qu√© se tratan todas estas palabras de moda?</a></li>
<li><a href="../477042/index.html">Optimizaci√≥n de estrategia de blackjack de Monte Carlo</a></li>
<li><a href="../477046/index.html">.Net Meetup en Raiffeisenbank 28/11 + Broadcast</a></li>
<li><a href="../477048/index.html">¬øPor qu√© una empresa con una capitalizaci√≥n de $ 55 mil millones pens√≥ en abandonar el intercambio?</a></li>
<li><a href="../477050/index.html">Black Friday 2019 para video vigilancia y nubes.</a></li>
<li><a href="../477052/index.html">Reactor, WebFlux, Kotlin Coroutines o Asynchrony con un ejemplo simple</a></li>
<li><a href="../477054/index.html">Webasto anuncia sistema modular de bater√≠as automotrices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>