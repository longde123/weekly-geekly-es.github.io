<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úèÔ∏è üíü üëèüèæ Castlevania Bot üìø ‚õàÔ∏è ü§±üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O que √© isso 
 O CastlevaniaBot √© um plug-in para o emulador NES Nintaco que √© reproduzido no Castlevania. Se voc√™ execut√°-lo na tela inicial, o plug-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Castlevania Bot</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432784/"><h1>  O que √© isso </h1><br>  O CastlevaniaBot √© um plug-in para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o emulador NES Nintaco</a> que √© reproduzido no Castlevania.  Se voc√™ execut√°-lo na tela inicial, o plug-in passar√° por todo o jogo do in√≠cio ao fim.  Ou voc√™ pode execut√°-lo em qualquer lugar do jogo para que ele passe por parte dele. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/UrtgTGmv1GQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Neste artigo, mostrarei como criar um bot capaz de passar pelo Castlevania e como criar algo semelhante para qualquer jogo no NES. <br><a name="habracut"></a><br><hr><br><h1>  Estrutura baseada no conhecimento </h1><br>  Este projeto n√£o utilizou aprendizado de m√°quina.  Em vez disso, o desenvolvimento pode ser chamado de "aprendizado de m√°quina".  Eu sei como passar Castlevania.  A dificuldade estava em escrever meus conhecimentos em um programa de computador.  O resultado foi um sistema que simula o mesmo processo de tomada de decis√£o que eu levo com o controlador em minhas m√£os.  Para cri√°-lo, foi necess√°rio declarar claramente os detalhes detalhados da f√≠sica que controla o pequeno mundo de Simon Belmont, e todas as t√°ticas necess√°rias para um ca√ßador de vampiros experiente. <br><br>  O CastlevaniaBot tem acesso a um conjunto de estrat√©gias para lidar com uma ampla variedade de situa√ß√µes.  A maioria deles √© projetada para trabalhar com um tipo espec√≠fico de objetos de jogo.  Por exemplo, existe uma estrat√©gia de controle do esqueleto, outra para os peixes, para quebrar velas, para reunir cora√ß√µes e assim por diante. <br><br>  O CastlevaniaBot monitora constantemente o estado do jogo e, se necess√°rio, alterna entre diferentes estrat√©gias.  No processo de tomada de decis√£o, a fun√ß√£o fitness √© usada, classificando todos os objetos do jogo na tela.  No topo da lista est√° o objetivo principal e, quando muda, o bot muda sua estrat√©gia.  Por exemplo, o CastlevaniaBot pode se preparar para acertar as velas quando um morcego voa para o quadro.  Dependendo da dist√¢ncia do bast√£o, o CastlevaniaBot pode reagir mudando de uma estrat√©gia de vela para uma estrat√©gia de bast√£o.  Destruindo o bast√£o, ele continuar√° a trabalhar com velas. <br><br>  Antes de decidir mudar, o CastlevaniaBot analisa seu objetivo e estrat√©gia atuais.  Se ele n√£o conseguir, pode ficar preso em um ciclo intermin√°vel, alternando entre dois objetivos com prioridade igual ou quase igual.  Para evitar isso, quando um novo objetivo principal aparecer, que √© apenas ligeiramente mais alto em prioridade do objetivo atual, o CastlevaniaBot pode decidir continuar a estrat√©gia atual. <br><br>  Algumas estrat√©gias s√£o iniciadas automaticamente quando caem em uma determinada √°rea.  Geralmente eles s√£o destinados ao processamento simult√¢neo de v√°rios objetos do jogo.  Por exemplo, em um corredor com v√°rias cabe√ßas de medusa voadoras, √© melhor seguir em frente e n√£o mirar cada cabe√ßa individualmente. <br><br>  Algumas estrat√©gias podem variar, dependendo da arma secund√°ria atual e do n√∫mero de copas coletadas, principalmente nas lutas contra chefes.  O CastlevaniaBot est√° tentando tomar a melhor decis√£o com base nas ferramentas que possui e na situa√ß√£o atual. <br><br><hr><br><h1>  Planejando um mundo de 8 bits </h1><br>  Ao trabalhar em tais projetos, busco principalmente simplificar a tarefa.  Imaginei como Castlevania seria se n√£o houvesse inimigos, velas ou itens para coletar nos n√≠veis.  Tudo o que seria necess√°rio nesse caso √© simplesmente chegar do in√≠cio ao fim do n√≠vel.  Eu me perguntava - se eu posso ensinar o bot a fazer isso, qu√£o dif√≠cil ser√° destruir v√°rios inimigos ao longo do caminho? <br><br>  Para ensinar o bot a se mover, eu precisava de mapas de segundo plano e uma compreens√£o de como os n√≠veis s√£o organizados.  O jogo consiste em seis n√≠veis, cada um dos quais termina com um chefe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/09b/644/665/09b644665551ebb424b3813af0205173.png"></div><br>  Cada n√≠vel √© dividido em 3 ou 4 etapas.  Os palcos s√£o geralmente separados por portas de madeira que se abrem com um rangido e batem atr√°s das costas do jogador. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/207/5fb/a46/2075fba46c9ef8ccd9a496df6aadcf07.png"></div><br>  Portas s√£o pontos de controle (pontos de verifica√ß√£o).  Se um jogador √© morto, ele volta ao in√≠cio do est√°gio, mas somente se ele n√£o tiver terminado a vida.  Se voc√™ continuar o jogo ap√≥s o t√©rmino do jogo, o jogador ser√° enviado para o in√≠cio do n√≠vel. <br><br>  O n√∫mero do est√°gio indica o n√∫mero total de pontos de verifica√ß√£o conclu√≠dos desde o in√≠cio do jogo.  O √∫ltimo est√°gio √© o n√∫mero 18. Mas se voc√™ matar Dr√°cula, o jogo come√ßa desde o in√≠cio no Modo Dif√≠cil, e o n√∫mero de est√°gios continua aumentando para 19 e mais al√©m.  Se voc√™ passar pelo Modo Dif√≠cil, o terceiro ciclo do jogo n√£o se torna mais dif√≠cil, mas o n√∫mero de est√°gios continua a aumentar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/447/6a5/3c5/4476a53c571dc062a4bc2287f5e02587.png"></div><br>  Cada est√°gio consiste em uma ou mais barras de rolagem horizontais do plano de fundo, que eu chamo de "subpasso".  Se voc√™ sair da tela pelas escadas que levam para cima ou para baixo, o jogo se move de um subest√°gio para outro e n√£o rola verticalmente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/760/751/5d8/7607515d8da99df95877d7eef8214f3f.png"></div><br>  O jogo usa 3 bytes para rastrear o n√∫mero do ciclo do jogo, o n√∫mero do est√°gio e o n√∫mero do subest√°gio.  O ciclo do jogo no modo normal (Modo Normal) tem um valor de 0;  os valores 1 e acima indicam o Modo dif√≠cil.  Independentemente do ciclo do jogo, as etapas sempre t√™m uma numera√ß√£o de 0 a 18. E as sub-etapas sempre t√™m um valor de 0 ou 1, porque as etapas nunca cont√™m mais de 2 barras horizontais.  O CastlevaniaBot rastreia esses bytes para saber onde est√°. <br><br>  Para minha conveni√™ncia, gravei a faixa de fundo de cada subest√°gio em um arquivo gr√°fico separado.  Se eu precisasse descobrir as coordenadas exatas de um objeto, poderia rapidamente descobri-las usando um editor gr√°fico.  Gravei os arquivos usando a ferramenta Map Maker incorporada ao Nintaco.  Liguei e depois passei por todo o jogo.  Algumas das imagens resultantes continham v√°rios sub-passos conectados entre si, que foram f√°ceis de separar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a53/3de/57e/a533de57e49c26f55eea024465dd3cf6.png" alt="Nintaco's Map Maker"></div><br>  Depois de examinar as imagens de fundo, percebi que os √∫nicos blocos importantes s√£o plataformas e escadas.  Tudo o resto pode ser considerado espa√ßo vazio.  As escadas s√£o de dois tipos: √† frente ou para tr√°s (elas podem ser representadas como as arestas esquerda e direita de um tri√¢ngulo is√≥sceles).  √Äs vezes, a escada termina com uma plataforma na qual o jogador pode andar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6e/6fa/76b/c6e6fa76bcd6d6c3457060763eb6f993.png"></div><br>  Existem apenas 5 tipos importantes de pe√ßas, e em cada n√≠vel eles t√™m uma apar√™ncia diferente.  Copiei e colei em arquivos de imagem 16 √ó 16 separados.  Depois, escrevi um programa comparando cada bloco em cada subpasso com o conjunto de imagens correspondente.  Ent√£o, eu tenho os tipos de matriz de blocos para todas as sub-etapas. <br><br>  As matrizes podem ser extra√≠das diretamente da ROM, mas n√£o consegui encontrar a documenta√ß√£o sobre como e onde os dados s√£o armazenados.  Como o espa√ßo da ROM √© limitado, os dados de n√≠vel geralmente s√£o apresentados em um formato compactado semelhante ao formato de gr√°ficos vetoriais.  Cada jogo usa seu pr√≥prio formato, ent√£o n√£o achei necess√°rio realizar pesquisas porque tinha o Map Maker.  Al√©m disso, eu ainda precisava de imagens gr√°ficas das sub-etapas.  Se eu n√£o tivesse capturado as faixas de fundo, teria que escrever um programa que gere imagens a partir de matrizes. <br><br><hr><br><h1>  Localiza√ß√£o de caminho </h1><br>  Ap√≥s criar as matrizes, quis aplicar o algoritmo de busca de caminhos, a saber, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o algoritmo de Floyd-Warshall</a> , que fornece uma tabela de sa√≠da contendo os caminhos mais curtos entre cada um dos pares de v√©rtices do gr√°fico direcionado com arestas ponderadas.  A id√©ia era pr√©-computar tabelas e grav√°-las em arquivos e carreg√°-las durante o jogo.  Com tabelas na mem√≥ria, o bot pode pesquisar e descobrir instantaneamente o caminho mais curto entre dois blocos de plataforma. <br><br>  O gr√°fico consiste em arestas e v√©rtices.  Se os blocos da plataforma s√£o v√©rtices, as arestas s√£o apenas as opera√ß√µes que o Simon pode executar para passar de uma plataforma para outra.  As opera√ß√µes executadas em apenas um bloco s√£o proibidas.  Por exemplo, em um plano a partir de blocos, o Simon pode mover apenas um bloco para a esquerda ou um bloco para a direita. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fe2/fa3/03d/fe2fa303d199d5c1cb826da8003acd3a.png"></div><br>  Da mesma forma, se Simon estiver na escada, ele poder√° mover um ladrilho em uma das duas dire√ß√µes poss√≠veis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a68/f17/502/a68f175026f789811cf3c7b032f76898.png"></div><br>  Estas s√£o opera√ß√µes v√°lidas.  Mas a√ß√µes como mover do ponto m√©dio do bloco para a borda do bloco s√£o muito fracion√°rias, porque n√£o correspondem √† transi√ß√£o de um v√©rtice do gr√°fico para outro. <br><br>  Al√©m de andar para a esquerda e direita, descer e subir escadas, Simon pode pular para outro ladrilho.  E ele pode pular para a esquerda ou direita, come√ßando em qualquer um dos 16 pixels da superf√≠cie do ladrilho.  Para reduzir o n√∫mero de arestas no gr√°fico (e o tamanho da tabela de consulta), considerei apenas cinco pontos de repuls√£o poss√≠veis: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/012/37d/aab/01237daabc08e79e6ccd6de83b6a1c0e.png"></div><br>  Adicionando a opera√ß√£o "n√£o fazer nada", obtive 15 opera√ß√µes.  Todos eles s√£o simples o suficiente para que o bot possa determinar facilmente a sequ√™ncia de pressionamentos de bot√£o necess√°ria para sua execu√ß√£o durante a execu√ß√£o do jogo. <br><br>  Para construir um gr√°fico completo, criei uma simula√ß√£o muito simples da f√≠sica do mundo de Simon.  Nesta simula√ß√£o, todas as 15 opera√ß√µes s√£o executadas a partir de cada bloco da plataforma.  O gr√°fico √© constru√≠do simplesmente observando onde est√° Simon.  Mais especificamente, ao especificar as coordenadas iniciais e a opera√ß√£o, a simula√ß√£o fornece as coordenadas finais na sa√≠da.  Se n√£o houver coordenadas finais, por exemplo, quando Simon tentar entrar em uma parede ou em um buraco, o programa retornar√° que a opera√ß√£o √© inv√°lida e essa borda n√£o faz parte do gr√°fico. <br><br>  Para criar essa simula√ß√£o, foi necess√°rio um estudo completo de Simon Belmont.  Ao contr√°rio de outros jogos de plataforma cl√°ssicos, nos quais o jogador pode acelerar de andar para correr, Simon, ao se mover horizontalmente, sempre move exatamente 1 pixel por quadro.  Isso √© v√°lido para caminhar, pular, subir escadas e at√© mesmo para recuar quando atacar inimigos. <br><br>  Limitar a velocidade horizontal simplifica bastante o reconhecimento de barreiras.  O jogo verifica se h√° uma parede em um pixel na frente do personagem e, se necess√°rio, interrompe o movimento.  O teste √© realizado abaixo do n√≠vel da cabe√ßa, o que permite que ela passe sob tetos baixos sem interferir no movimento horizontal. <br><br>  O movimento vertical √© um pouco mais complicado.  Se Simon sai da borda da plataforma, em vez de uma acelera√ß√£o gradual, ele cai instantaneamente a uma velocidade de 8 pixels por quadro.  Como cada bloco possui uma altura de 16 pixels (m√∫ltiplo de 8), o reconhecimento do solo √© simplificado.  Ao mesmo tempo, o jogador mant√©m uma velocidade horizontal de 1 pixel por quadro na dire√ß√£o obtida imediatamente antes da queda. <br><br>  O sprite de Simon tem 16 pixels de largura e, no entanto, pode pairar sobre o bloco em um m√°ximo de ¬± 4 pixels a partir do ponto m√©dio.  Se voc√™ se mover um pouco mais, ele cair√° abaixo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd8/b2a/0a4/fd8b2a0a48035271fc78e7209d980dd5.png"></div><br>  √â interessante que, se ele sair da plataforma e cair exatamente 1 pe√ßa a uma velocidade de 1 horizontal e 8 pixels verticais por quadro, ele n√£o ficar√° exatamente no bloco ao pousar.  Uma de suas pernas permanecer√° dentro da parede a uma profundidade de 2 pixels. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/da0/a27/458/da0a274588a45b4e448fbe46ef9e48ca.png"></div><br>  Depois disso, ele poder√° sair do muro, mas n√£o entrar nele. <br><br>  Simon n√£o pode mudar de dire√ß√£o durante o salto.  Depois de pressionar o bot√£o A, ele faz um caminho fixo ao longo da par√°bola. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/041/db3/a4a/041db3a4afa0f0f93e0533f0ee1dbd48.png"></div><br>  No topo, Simon sobe 36 pixels, o que lhe permite pular em plataformas com 2 ladrilhos de altura.  E o topo da "par√°bola" √© surpreendentemente plano.  Parece que congela no espa√ßo por 9 quadros completos, possivelmente para simplificar os golpes de chicote no ar.  Se Simon n√£o tem nada para pousar, o movimento da par√°bola continua at√© que ele retorne √† sua altura original.  Depois disso, come√ßa a cair a uma velocidade de 8 pixels por quadro, ou seja, com a mesma velocidade constante de queda da plataforma. <br><br>  Quando h√° uma plataforma diretamente acima da cabe√ßa do personagem, n√£o √© permitido pular. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e06/358/0ba/e063580bac81a0ec963336e2886c0e2a.png"></div><br>  Caso contr√°rio, ele "salta" parcialmente nos ladrilhos da plataforma. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/651/56a/f41/65156af41893e3c9008a4836d67efca1.png"></div><br>  Como afirmado anteriormente, se Simon toca mais do que o topo da cabe√ßa, ele para de se mover horizontalmente.  Isso √© bastante irritante no final da primeira etapa do n√≠vel 4, quando o jogador est√° tentando sair da caverna. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/d41/331/1c6d413312f17f67d6247f9a33000499.png"></div><br>  As escadas permitem que voc√™ se mova livremente verticalmente entre plataformas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/05c/5e1/2fc/05c5e12fc0bd66681054052354e13a14.png"></div><br>  Em um caso, Simon sobe as escadas, passando pelo ladrilho da plataforma.  Estar na escada, ele pode passar livremente pela parede. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/522/872/438/5228724383d3d908b5298c62dc73e015.png"></div><br>  Nas plataformas m√≥veis de n√≠vel 4, o jogador geralmente se agacha sob estalactites baixas.  No entanto, voc√™ pode se levantar e descansar contra eles.  Em tal situa√ß√£o, o jogo restringe o movimento horizontal, arrastando Simon rapidamente para uma armadilha de √°gua. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/feb/dcd/85f/febdcd85f8f47c08806d00343a74fc02.png"></div><br>  Um simulador de f√≠sica que gera gr√°ficos orientados considera Simon um ret√¢ngulo.  O movimento desse ret√¢ngulo √© limitado pelas regras de movimento descritas acima.  Para que o bot n√£o pule de um lugar para outro como um coelho, as bordas dos saltos do conde receberam um custo mais alto do que as bordas de caminhar e se mover ao longo das escadas. <br><br>  A tabela gerada pelo algoritmo de pesquisa de caminho cont√©m a menor dist√¢ncia para cada bloco inicial e final (custo total do caminho) e uma descri√ß√£o da primeira etapa do caminho.  Esta descri√ß√£o inclui a primeira opera√ß√£o que deve ser executada nesse caminho e o bloco no qual o personagem estar√° depois de conclu√≠do.  O caminho inteiro pode ser recriado por pesquisa repetida na tabela, cada uma das quais fornece o pr√≥ximo passo na dire√ß√£o do bloco final. <br><br>  Em algumas sub-etapas, as colunas n√£o est√£o totalmente conectadas.  Por exemplo, no n√≠vel 4, as plataformas s√£o a √∫nica maneira de atravessar o abismo.  Nessas sub-etapas, a tabela cont√©m m√©todos para se deslocar em cada uma das ilhas, mas n√£o entre elas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e0f/098/f72/e0f098f72ffb3a91bb86d2cf5fa1921b.png"></div><br>  Alguns blocos destrut√≠veis cont√™m objetos ocultos.  E a destrui√ß√£o dos blocos altera esse gr√°fico.  Para contornar esse problema, um algoritmo para encontrar caminhos com e sem blocos divididos foi aplicado √†s sub-etapas.  No tempo de execu√ß√£o, o CastlevaniaBot monitora os estados dos blocos a serem divididos e usa a tabela de pesquisa apropriada. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aca/ac4/8a1/acaac48a1c7f4acd0849f06dab3a9d0a.png"></div><br><hr><br><h1>  Estado do jogo </h1><br>  O CastlevaniaBot se integra ao Nintaco por meio de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sua API</a> .  Ele registra a implementa√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>FrameListener</code></a> para receber um retorno em cada quadro.  Como o emulador √© executado a cerca de 60 quadros por segundo, esse ouvinte precisa ser retornado no prazo;  c√°lculos longos ou tempo de inatividade diminuir√£o a velocidade ou bloquear√£o o emulador.  Em um curto per√≠odo de tempo, o CastlevaniaBot l√™ o estado do jogo, determina seu objetivo principal, muda de estrat√©gia se o objetivo mudou e cumpre a estrat√©gia atual. <br><br>  O CastlevaniaBot l√™ o estado atual de Simon Belmont diretamente da RAM do processador.  Mas n√£o consigo determinar como outros objetos do jogo s√£o representados na mem√≥ria.  Portanto, o CastlevaniaBot l√™ diretamente da mem√≥ria os atributos dos objetos (Mem√≥ria de Atributos do Objeto, OAM) - uma √°rea que armazena uma lista de sprites exibidos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/296/b58/46a/296b5846a26530aa657294d619e5ad63.png"></div><br>  Essa t√©cnica funciona e geralmente √© aplic√°vel a outros jogos, mas tem muitas desvantagens.  A ordem dos sprites no OAM est√° mudando constantemente.  Se houver v√°rias inst√¢ncias do mesmo tipo de inimigo na tela ao mesmo tempo, a √∫nica maneira de rastre√°-los √© determinar sua proximidade, comparar as √∫ltimas coordenadas do sprite com as coordenadas do quadro anterior. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/46d/236/258/46d23625808baf3abb91916e4f80baed.png"></div><br>  Alguns objetos do jogo consistem em sprites repetidos, como torres de ossos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b7/49a/dcb/1b749adcb05680e5a22247c783d8bac2.png"></div><br>  As plataformas m√≥veis consistem em um sprite repetindo 4 vezes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e0/f85/ea8/7e0f85ea889b5e824a010d04e26f03d2.png"></div><br>  A classifica√ß√£o desses dois casos requer l√≥gica adicional, f√°cil de implementar.  As atualiza√ß√µes secund√°rias de armas e alguns tipos de armas secund√°rias usam os mesmos sprites.  Pior, no n√≠vel 5, os Cavaleiros pegam emprestado os sprites de armas secund√°rias de Simon. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/44c/cd1/08e/44ccd108ea9b25c442a5653d79f0c49e.png"></div><br>  Felizmente, com exce√ß√£o da √°gua benta, o CastlevaniaBot usa apenas armas secund√°rias onde as atualiza√ß√µes geralmente n√£o est√£o dispon√≠veis, como nas lutas contra chefes.  E o sprite de atualiza√ß√£o da √°gua benta √© diferente do sprite usado ao lan√ß√°-lo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/014/1d2/faf/0141d2faf5e0168ae8d4046cdbfbe278.png"></div><br>  Alguns objetos do jogo piscam durante a cria√ß√£o, por exemplo, bolas de cristal no final das lutas contra chefes, tran√ßas da morte e corpo de Dr√°cula.  Sprites intermitentes aparecem e desaparecem do OAM, portanto, √© necess√°ria l√≥gica adicional para rastrear esses objetos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b80/5f1/f8b/b805f1f8bf89efb9c021b716a0d39e25.png"></div><br>  Tamb√©m √© importante notar que, devido a limita√ß√µes de hardware, o NES pode exibir apenas 8 sprites por linha raster.  Como a prioridade dos sprites depende parcialmente de seus √≠ndices no OAM, a ordem em cada quadro √© aleatoriamente misturada para evitar uma mudan√ßa que torna um sprite invis√≠vel constantemente.  V√°rios sprites piscam por sua vez, gradualmente mudando sua prioridade.  Esse piscar n√£o afeta a leitura de sprites do OAM.  Os dados ainda permanecem l√°, mas o hardware emulado n√£o os exibe.  Isso difere da situa√ß√£o descrita acima ao piscar ao criar sprites.  Al√©m disso, o Nintaco tem uma op√ß√£o que reduz significativamente a intermit√™ncia do hardware. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b9/527/fe6/6b9527fe61e614012f1fd50d1ad0625e.png"></div><br>  E, finalmente, uma pequena parte do estado do jogo √© lida nas tabelas de nomes da PPU - uma √°rea de mem√≥ria contendo todos os dados de segundo plano.  Isso inclui a verifica√ß√£o de blocos destrut√≠veis e o rastreamento das posi√ß√µes da ‚Äúqueda‚Äù no n√≠vel 2. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d35/f3c/378/d35f3c378b284474c8d2b5386a78fb57.png"></div><br><hr><br><h1>  M√°quinas de Estado Heur√≠sticas </h1><br>  Estrat√©gias s√£o m√°quinas de estado.  CastlevaniaBot define-os como uma classe abstrata com m√©todos <code>init</code> e <code>step</code> .  O m√©todo <code>init</code> √© chamado quando o CastlevaniaBot muda para a estrat√©gia apropriada, permitindo que a m√°quina de estado seja redefinida.  E o m√©todo <code>step</code> executa a estrat√©gia.  Por exemplo, o m√©todo de estrat√©gia por <code>step</code> para as pessoas que pescam verifica se um peixe est√° dentro do alcance de um chicote e, nesse caso, o bot bate com um chicote.  Caso contr√°rio, verifica se √© poss√≠vel alcan√ßar a dist√¢ncia do ataque com um salto e, se for, o bot salta.  E finalmente, se o bot estiver muito perto do inimigo, ele se afasta dele.  Com essas regras simples, CastlevaniaBot derrota o peixe humano. <br><br>  Para tornar as estrat√©gias de escrita o mais f√°cil poss√≠vel, criei uma biblioteca de poss√≠veis a√ß√µes a serem executadas.  Por exemplo, em vez de pressionar e soltar o bot√£o A para pular, o bot simplesmente chama o m√©todo de pulo da biblioteca.  E antes disso, ele pergunta √† biblioteca se Simon est√° na plataforma e pode pular. <br><br>  Aproximar-se e afastar-se do alvo s√£o a√ß√µes padr√£o executadas usando opera√ß√µes da tabela criada pelo algoritmo de busca de caminho.  Por exemplo, a estrat√©gia de vela usa o m√©todo de biblioteca <code>routeAndFace</code> , que n√£o apenas direciona o Simon para quaisquer coordenadas especificadas, mas tamb√©m o rotaciona para a esquerda ou direita ap√≥s pression√°-las.  Al√©m disso, dependendo da altura das velas, a estrat√©gia executa um salto ou agachamento antes de acertar um chicote.  Um objeto que caiu de velas ser√° criado no ar e cair√° ou cair√° lentamente no ch√£o.  Uma estrat√©gia de coleta direciona Simon para o bloco mais pr√≥ximo diretamente abaixo dele antes que o item toque o ch√£o. <br><br>  Para se afastar dos inimigos, a biblioteca precisa saber como se mover para a esquerda ou para a direita sem cair nas covas.  Em geral, isso √© feito procurando caminhos para as bordas esquerda ou direita do subest√°gio.  Mas em algumas √°reas, o caminho mais curto para a borda esquerda requer inicialmente o deslocamento para a direita e vice-versa.  Quando esses problemas surgiram, eu adicionei l√≥gica especificamente para os subest√°gios, direcionando Simon para as bordas esquerda e direita da plataforma atual. <br><br><hr><br><h1>  Passo a passo </h1><br>  Nesta se√ß√£o, descreverei em detalhes as estrat√©gias usadas pelo CastlevaniaBot, comentando toda a explica√ß√£o passo a passo. <br><br>  O jogo come√ßa no p√°tio em frente ao castelo.  Os objetos no quadro s√£o organizados para selecionar o alvo principal, que neste caso √© uma coluna com chamas.  A estrat√©gia da coluna diz ao bot para se aproximar da coluna e usar o chicote quando estiver ao seu alcance. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14c/647/750/14c6477507cee1d822e6cadbcafbda5a.png"></div><br>  Ap√≥s pressionar o chicote e destruir a coluna, um item √© criado.  A prioridade de todos os itens √© maior que a das colunas de chamas.  Consequentemente, o CastlevaniaBot reage a isso usando uma estrat√©gia para coletar o item que aparece antes de passar para as pr√≥ximas colunas. <br><br>  Ao classificar objetos, o CastlevaniaBot sempre leva em considera√ß√£o uma meta de longo prazo - concluir um n√≠vel antes que o tempo acabe.  Ao criar uma lista de objetivos em potencial, uma porta para o pr√≥ximo n√≠vel √© sempre adicionada a ele.  A porta recebe uma baixa prioridade, mas ap√≥s a destrui√ß√£o de todas as colunas e a cole√ß√£o de todos os objetos, ela se torna uma prioridade.  Com apenas uma exce√ß√£o: CastlevaniaBot sabe descobrir todos os tesouros escondidos e pula sobre a entrada do castelo para criar um saco de dinheiro piscando. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/200/7f5/eaa/2007f5eaa4405bd611bd8711017fbe24.png"></div><br>  Depois de entrar no castelo CastlevaniaBot v√™ fantasmas e velas.  Velas e itens criados t√™m preced√™ncia at√© os fantasmas se aproximarem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a7/9ab/843/8a79ab84345e6a16a9231c5a7f45ceae.png"></div><br>  Parece que o chicote destr√≥i os inimigos sem toc√°-los.  Encontrei uma tabela retangular de colis√£o na ROM do jogo, ent√£o o CastlevaniaBot sabe exatamente quando algo est√° dentro do escopo do chicote.  E como os ret√¢ngulos de colis√£o geralmente se projetam um pouco al√©m dos limites dos sprites, o chicote pode atingir a "parte invis√≠vel". <br><br>  Na maioria dos casos, ao destruir velas, o CastlevaniaBot salta verticalmente, em vez de avan√ßar.  Esta √© uma t√°tica de preven√ß√£o de riscos.  Como est√° no ar, √© imposs√≠vel mudar a dire√ß√£o do movimento, uma multid√£o de inimigos se aproximando pode complicar um pouso seguro ou impossibilit√°-lo.  Al√©m disso, com um salto vertical, o CastlevaniaBot permanece no mesmo bloco;  ele n√£o precisa verificar se o salto levar√° a uma queda na plataforma inferior ou no fundo do po√ßo. <br><br>  Quando n√£o h√° velas a serem destru√≠das ou objetos a serem coletados, o CastlevaniaBot come√ßa a perseguir fantasmas.  Mas a "Estrat√©gia Pantera" ordena que ele fique parado, esperando o inimigo cair dentro dos limites de um ataque de chicote. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/434/9a0/bd5/4349a0bd58a7078c6b0d1951845bfea2.png"></div><br>  Al√©m do fato de as velas servirem como fontes de cora√ß√µes e outros objetos, elas guiam o jogador ao longo do caminho pelo palco.  Por exemplo, na imagem abaixo, as velas no canto superior direito ‚Äúconvidam‚Äù o jogador a subir as escadas.  No entanto, para subir as escadas, o jogador inicialmente precisa ir para a esquerda, e √© por isso que as velas desaparecem da tela.  Como as solu√ß√µes CastlevaniaBot s√£o baseadas na prioriza√ß√£o de objetos vis√≠veis na tela, essa situa√ß√£o pode levar a um ciclo intermin√°vel, onde o bot seleciona alternadamente o caminho mais curto para as velas (√† esquerda) ou o caminho mais curto para a porta de sa√≠da (√† direita). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/309/d1a/8e7/309d1a8e7f1f5a39a8b34411108b94b8.png"></div><br>  Problemas semelhantes podem ser resolvidos de v√°rias maneiras.  Por exemplo, o CastlevaniaBot pode ser equipado com o armazenamento de objetos, entendendo que os objetos continuam a existir, mesmo que n√£o sejam vis√≠veis.  Mas para isso, mesmo assim, desde o come√ßo eles precisam ser vistos.  Se as velas estivessem ainda mais √† direita, depois da detec√ß√£o, seria necess√°rio voltar ainda mais. <br><br>  Com isso em mente, adicionei incentivos que pressionam o CastlevaniaBot a explorar √°reas do palco que ele normalmente ignoraria.  Esses incentivos funcionam de maneira semelhante √†s portas de sa√≠da, levando o CastlevaniaBot para onde ele precisa ir.  Al√©m disso, adicionei regras que o fazem ignorar velas e objetos muito distantes (em termos de dist√¢ncia percorrida, e n√£o em linha reta). <br><br>  Depois de subir as escadas e destruir as velas, a √°gua benta √© criada - a mais valiosa de todas as armas secund√°rias.  CastlevaniaBot o seleciona trocando uma adaga por ele. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c5/575/00a/4c557500adad3a899c43ea80b983d6fb.png"></div><br>  Assim como a sacola de dinheiro no in√≠cio do jogo, o CastlevaniaBot conhece todos os blocos destrut√≠veis com objetos ocultos e, para destruir blocos com um chicote, usa uma estrat√©gia semelhante √† estrat√©gia para velas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1eb/007/d43/1eb007d4384996127451979738a3c6ea.png"></div><br>  Com mais movimentos do CastlevaniaBot, voc√™ notar√° que ele come√ßa a usar √°gua benta para destruir fantasmas e velas.  Isso pode parecer redundante, mas serve a um prop√≥sito importante.  Castlevania recompensa os jogadores pelo uso de armas secund√°rias com exposi√ß√£o dupla e tripla.  Em outras palavras, CastlevaniaBot <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√≥i</a> atualiza√ß√µes secund√°rias de armas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a7/186/be0/6a7186be0588f46012a241cc9745d586.png"></div><br>  Depois de pressionar o bot√£o B, h√° um atraso de 16 quadros antes de tocar um chicote.  O chicote permanece longo por mais 10 quadros, mas √© v√°lido apenas no primeiro desses dez.  O CastlevaniaBot usa esse fato para melhorar a mira.  Em particular, ele rastreia a velocidade de todos os objetos no quadro, assumindo que o alvo principal continue a se mover ao longo de um caminho linear.  Em seguida, ele pressiona o bot√£o B 16 frames antes que o alvo precise encontrar um chicote.  O inimigo sempre pode mudar de dire√ß√£o durante esses 16 quadros, mas geralmente essa simples heur√≠stica funciona. <br><br>  No entanto, depois de passar pela porta, CastlevaniaBot encontra morcegos vermelhos.  Como as cabe√ßas das √°guas-vivas, os morcegos vermelhos voam pela tela, voando atrav√©s de um sinus√≥ide atrav√©s de plataformas e escadas.  Para prever onde o bast√£o vermelho estar√° depois de 16 quadros, gravei o movimento de um deles em uma tabela.  Durante a execu√ß√£o do jogo, o CastlevaniaBot rastreia morcegos e aguarda picos ou baixos da trajet√≥ria em que a velocidade vertical muda de sinal.  Em seguida, ele pode comparar as coordenadas com os valores em uma tabela pr√©-criada.  Isso permite que a estrat√©gia apropriada bata no bast√£o vermelho com um chicote, incline-se ou salte sobre ele. <br><br>  Durante a passagem (speedrana) do Castlevania, os jogadores realizam manobras que tornam o jogo o mais determin√≠stico poss√≠vel.  Por exemplo, eles descobriram que, no final do n√≠vel 1, para destruir um bloco e pegar uma atualiza√ß√£o de arma em uma determinada sequ√™ncia de tempo, o chefe se comportar√° de acordo com o padr√£o desejado, permitindo que ele derrote rapidamente. <br><br>  Por mais experientes que sejam, elas n√£o podem domesticar completamente o gerador de n√∫meros aleat√≥rios.  No entanto, como o CastlevaniaBot pode controlar o pressionamento de bot√µes com precis√£o quadro a quadro, ele pode levar o conceito de passagem de velocidade ao seu limite, cada vez que passa no jogo de uma maneira absolutamente id√™ntica.  Se o fizesse, n√£o seria melhor do que passar no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TAS</a> .  Portanto, o CastlevaniaBot adiciona arbitrariamente erros e atrasos √†s suas a√ß√µes usando um gerador externo de n√∫meros aleat√≥rios para evitar jogabilidade determin√≠stica.  Por exemplo, quando ele bate com um chicote uma vela localizada no alto, ele deliberadamente adiciona um atraso para um n√∫mero aleat√≥rio de quadros ao salto e batida.  Essas pequenas mudan√ßas afetam significativamente o progresso do jogo. <br><br>  Embora CastlevaniaBot busque evitar o determinismo, ele emprestou um conceito do speedrunning: o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aumento de danos</a> .  Em 50% dos casos, CastlevaniaBot evita completamente a passagem da masmorra de peixe humano pulando de volta para o morcego vermelho, que o joga em uma plataforma inacess√≠vel. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/375/733/1ed/3757331edfa439d3ed9eb1ef3be8443e.png"></div><br>  Na outra metade dos casos, CastlevaniaBot decide lutar com peixes humanos.  Suas bolas de fogo t√™m alta prioridade e CastlevaniaBot os acerta com um chicote, esquiva ou salta dependendo da situa√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e4/f51/077/6e4f51077f42c471bc0484e64aaa14b6.png"></div><br>  Devido √† imprevisibilidade de criar inimigos e suas bolas de fogo, a maioria dos jogadores costuma fazer parte de peixes humanos.  Mas CastlevaniaBot gasta tempo com eles, coleta todos os cora√ß√µes e at√© um tesouro escondido na extremidade direita.  O bot sabe exatamente quais itens est√£o contidos em cada vela e, como prefere usar √°gua benta, pula as velas nas quais os cron√¥metros est√£o escondidos.  No entanto, se voc√™ permanecer nesta parte e lutar com os peixes, √†s vezes poder√° inevitavelmente pegar um cron√¥metro. <br><br>  As etapas geralmente terminam com cruzes destruindo todos os inimigos na tela.  Caso voc√™ esteja curioso, direi que cruzes n√£o podem matar chefes no final de um n√≠vel.  De fato, √†s vezes, cruzamentos s√£o criados mesmo durante brigas de chefes.  Por exemplo, na batalha com a Medusa, √†s vezes aparecem cruzes ao matar cobras.  Mas essas cruzes s√≥ podem matar outras cobras. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c3e/328/e31/c3e328e311c90509ffc2450e4b991436.png"></div><br>  Depois de passar pela porta, CastlevaniaBot encontra fantasmas novamente.  Na captura de tela abaixo, ele quer pular para a plataforma inferior, mas fantasmas o impedem de se mover.  Quando uma tabela criada por um algoritmo de busca de caminho diz ao CastlevaniaBot para saltar, ela examina o espa√ßo em torno da plataforma de destino.  Se acontecer que ele aterrissa nos inimigos, o salto n√£o √© realizado.  Nesse caso, esse mecanismo faz o CastlevaniaBot esperar que os fantasmas liberem seu lugar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c3b/2ef/817/c3b2ef81726485f94f1f391efa1ab2e6.png"></div><br>  Essa regra de "verificar inimigos antes de pular" ilustra um dos princ√≠pios da estrutura do CastlevaniaBot: deve ser governada por regras simples, o mais generalizadas poss√≠vel.  Em algumas partes do jogo, √© necess√°rio usar estrat√©gias √∫nicas que resolvam problemas muito espec√≠ficos.  Mas na maior parte do jogo, as a√ß√µes de bot s√£o dirigidas por heur√≠sticas reutiliz√°veis.  N√£o escrevi um time que o fizesse parar naquele momento em particular e esperar os fantasmas sairem do caminho deles.  Esse comportamento surgiu como resultado de heur√≠sticas. <br><br>  CastlevaniaBot completa o n√≠vel matando o Phantom Bat com √°gua benta tripla.  Mas sua estrat√©gia de ataque √© determinada por sua arma secund√°ria.  De fato, se ele n√£o tinha uma arma secund√°ria, estava pronto para matar o chefe com um √∫nico chicote.  Um caso particularmente interessante √© o assassinato de um Phantom Bat com um machado.  Assim como no bast√£o vermelho, registrei na tabela o movimento do machado ao longo da par√°bola.  Durante a execu√ß√£o do jogo, o CastlevaniaBot executa um deslocamento da tabela, combinando-o com cada um dos ladrilhos.  Isso permite que voc√™ calcule o ponto ideal para matar o chefe com um machado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0c/480/2de/d0c4802de26d9629ca4376a67513106f.png"></div><br>  Pouco antes de pegar a bola de cristal, CastlevaniaBot lan√ßa a arma secund√°ria em dire√ß√µes diferentes, sabendo que ela congelar√° no ar depois de tocar na bola.  Ent√£o ele pula aleatoriamente repetidamente e bate com um chicote, esperando congelar em uma pose estranha. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f90/83b/d56/f9083bd561d92261d581128157bdf205.png"></div><br>  No in√≠cio do n√≠vel 2, CastlevaniaBot evita as primeiras velas nas quais o bumerangue est√° escondido.  A estrat√©gia de trabalhar com um cavaleiro-lanceiro √© uma campanha contra as estrat√©gias de fantasmas ou pescadores, mas esse √© o primeiro inimigo a matar que precisa de dois golpes.  O morcego preto est√° cochilando at√© chegar perto dele, ap√≥s o qual decola e se move linearmente o suficiente para ser morto com um chicote usando as heur√≠sticas simples mencionadas acima. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3e/d23/01e/a3ed2301ee4a6689ef64648439eb1939.png"></div><br>  Tendo destru√≠do os tijolos da parede, em 50% dos casos, CastlevaniaBot parece sair da sala sem levantar a coroa.  Mas √© assim?  De fato, nesses casos, ele pega a coroa, usando o bug do jogo.  Como o final da escada superior coincide horizontalmente com a localiza√ß√£o da coroa, o jogador, ao passar por cima e por tr√°s da tela, fica momentaneamente abaixado.  Se voc√™ ouvir o som ou olhar para os √≥culos, poder√° ver que o bot realmente leva a coroa. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/348/459/ef8/348459ef8dc72330b2d1bf99c63eb07d.png"></div><br>  No n√≠vel 2, os inimigos n√£o atacam o jogador quando ele est√° em uma plataforma m√≥vel.  O CastlevaniaBot s√≥ precisa esperar a plataforma se aproximar, entrar na plataforma, esperar que ela atinja o outro lado e, em seguida, des√ßa dela.  Por outro lado, existe uma ligeira varia√ß√£o para plataformas que n√£o tocam em ladrilhos.  Nesses casos, o CastlevaniaBot n√£o desce, mas salta da plataforma. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/161/7e3/f4c/1617e3f4c2b0f50832dba59992438aa7.png"></div><br>  Uma porta leva a um corredor cheio de cabe√ßas voadoras, e CastlevaniaBot reage a isso avan√ßando.  Como √© o caso das plataformas m√≥veis, o CastlevaniaBot sabe que essa estrat√©gia precisa ser aplicada com base em sua posi√ß√£o, em vez de priorizar os objetos de jogo na tela.  No entanto, assim que todas as cabe√ßas das √°guas-vivas voam, ele volta a essa t√©cnica para escolher a estrat√©gia que ser√° usada mais adiante. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c33/0ce/dd8/c330cedd8cdb3748b08988787e1b58df.png"></div><br>  Outra estrat√©gia, dependendo da posi√ß√£o, √© acionada ap√≥s subir a pr√≥xima escada que leva √† √°rea cheia de cabe√ßas de √°gua-viva.  Em 50% dos casos, o CastlevaniaBot pula intencionalmente a cabe√ßa de uma √°gua-viva para obter um aumento de dano, empurrando-o para a plataforma superior ao lado da porta que leva √† pr√≥xima etapa.  Estes s√£o os dois √∫nicos danos que CastlevaniaBot conhece.  Ao contr√°rio dos rotores de velocidade, ele n√£o o executa para economizar tempo, essa √© apenas mais uma contribui√ß√£o ao n√£o-determinismo da passagem. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ea/e45/c5c/0eae45c5c564301aa03fa376b85f43f2.png"></div><br>   ¬´¬ª ‚Äî      ,   . CastlevaniaBot ,   ¬´¬ª      ,     .     , ,   ,         ¬´¬ª.        ,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d2/2b4/303/7d22b4303c14e5f460b4b090918ef1fb.png"></div><br>  ¬´¬ª      .     ,       .      ,     .        ,     -. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b1/0ad/931/7b10ad9316ab8e0ef3f53007740ffd4a.png"></div><br>  2   ,  CastlevaniaBot       .           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/46a/02c/a28/46a02ca28233821148bd64afcf43ef65.png"></div><br>   3  . CastlevaniaBot    ,  ,       .    ,  CastlevaniaBot         ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/863/ec4/58e/863ec458ebc43b8c3959750018c9952e.png"></div><br>    .     .  ,   .   3 CastlevaniaBot    .   ,       ,      .  CastlevaniaBot    ‚Äî   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c4d/eaf/9e4/c4deaf9e44458c08487d89d22b5a9618.png"></div><br> CastlevaniaBot ,   .          ,     . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d0b/7ce/78c/d0b7ce78cf8ea65a6001ca63a0a1d087.png"></div><br>      CastlevaniaBot   ,    ,   ,    .       .       ,            . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb3/a6a/c85/fb3a6ac852c7633a530ea2666f3cf3c0.png"></div><br>      CastlevaniaBot    ,       .      ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2f4/62d/ebe/2f462debef355d502ee9969489c0fa9b.png"></div><br>  CastlevaniaBot    ,    .      ,   ,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/094/9c7/0fa/0949c70faa3fcc414107b04ae8e1be68.png"></div><br>  ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee4/0a6/75a/ee40a675a2432df6a4a3c24d2681c682.png"></div><br>      CastlevaniaBot     .   ,      ,   -    ,   .        , -      . <br><br>   4   .      ,       .     ,  ,           .        ,   CastlevaniaBot  ,       .           -,    ,           .  CastlevaniaBot     . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4a/cb3/35b/f4acb335ba2cf17e29d42dfffe51d689.png"></div><br>      .         ,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b0/42c/e0d/6b042ce0d1ee7845c83d5ff1ea5c65cf.png"></div><br>     ,      64    . ,   ,      ROM      ,  .   -        ,    .         .               . <br><br> ,   -     .            ,      ,     .                  .             50%,         .        . <br><br> CastlevaniaBot     ,        .     ,        ,        . <br><br>  CastlevaniaBot    .         . CastlevaniaBot  ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/50e/182/f5f/50e182f5fe39bc3e3145bb68aae819d7.png"></div><br>       CastlevaniaBot    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/093/45e/a6c/09345ea6ca0024888d7be0f8d25785f6.png"></div><br>         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5f/0e5/d57/d5f0e5d5706307c36d5d9dd9c19052e7.png"></div><br>            .       , CastlevaniaBot      ,    .        . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/23f/606/220/23f6062203ce695c2a38c9d2d170926e.png"></div><br>   5 CastlevaniaBot      .        ,     3.    ,   , CastlevaniaBot   ,    ,     .       ,    ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/64e/c6c/610/64ec6c6100a72265aab1f024c6561718.png"></div><br>   5     . CastlevaniaBot      ,  ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8b6/628/54c/8b662854cf5582b93cf299b0852964c9.png"></div><br>    14     .  CastlevaniaBot  .   ,     ,         .      ,     .   ,      ,       .      ,    .      , CastlevaniaBot   .          ,    . CastlevaniaBot    ,       ,         .  Viva! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/93a/727/488/93a727488c3cd37cd381668415c1261b.png"></div><br>   , CastlevaniaBot     .    ,   ,    .    ,    ,     ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/81c/992/8d6/81c9928d6a77554910fb989df1fd4932.png"></div><br>     5, CastlevaniaBot   ,       ,     .           .    ,    , CastlevaniaBot      ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/65a/cd8/ed8/65acd8ed8ae89e882702cb9387b8c432.png"></div><br>        ,       .  CastlevaniaBot      ,   ,     ,     ,       .   , CastlevaniaBot      ,      .            ,      .         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/446/82b/18d/44682b18de7a81b58d01dd734e4f57f3.png"></div><br>       ,   ,    ,      .   ,         ,   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cab/d68/587/cabd685876fb241b8362a9f2f83482d5.png"></div><br>    ,     CastlevaniaBot   .          ,     . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/444/738/a60/444738a60282b741af01e775ebfe70b2.png"></div><br> CastlevaniaBot    ,      ,   .       ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/72a/fdb/57a/72afdb57a40c4f9613a71c6edd5beb17.png"></div><br>   CastlevaniaBot      6 ‚Äî  .       ,   ,       ,  .  ,            ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/507/fa3/c82/507fa3c822d5a767e6b6a4916d1d2857.png"></div><br>     .    ,      . <br><br>    CastlevaniaBot         ,      .         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d06/4fd/3f3/d064fd3f3b249a76112632c100b34ccd.png"></div><br>  CastlevaniaBot    ,         ,    ,      20 . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/338/cf3/525/338cf3525c8b5c0361cb98c23681f8b3.png"></div><br>         ,        . <br><br>        16   . CastlevaniaBot     , ,     ,          . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8ad/47e/af9/8ad47eaf9a2a962288480bbf49b844fc.png"></div><br>   ,   Cookie Monster,           .    Cookie Monster   ,   CastlevaniaBot .  Cookie Monster   ,        .       .      Cookie Monster    ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bdf/05b/266/bdf05b2661aff44a2b0804865013b95b.png"></div><br> CastlevaniaBot    Difficult Mode,     .               ,    Normal Mode.   CastlevaniaBot  . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c6/3a6/c4a/4c63a6c4ad709d26e0256a6ecdf07a61.png"></div><br><hr><br><h1>  </h1><br> <a href="">CastlevaniaBot_2018-12-09.zip</a> <br><br>   <code>.zip</code> : <br><br><ul><li> <code>src</code> ‚Äî  . </li><li> <code>CastlevaniaBot.jar</code> ‚Äî   . </li><li> <code>lgpl-2.1.txt</code> ‚Äî    . </li></ul><br><hr><br><h1>  Lan√ßamento </h1><br><h2>   </h2><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nintaco</a> ‚Äî  NES. </li><li> <code>Castlevania (U) (PRG1) [!].nes</code> ‚Äî ROM . </li></ul><br><h2>   </h2><br><ol><li>  Nintaco   <code>Castlevania (U) (PRG1) [!].nes</code> . </li><li>  <code>CastlevaniaBot.jar</code>   <code>.zip</code> . </li><li>   Run Program,  Tools | Run Program... </li><li>       JAR   ,    Find JAR.... </li><li>  Load JAR,   . </li><li>  Run. </li></ol><hr><table><tbody><tr><td> Copyright ¬© 2018 meatfighter.com <br><br>      .     /      LGPLv2.1. </td></tr></tbody></table></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt432784/">https://habr.com/ru/post/pt432784/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt432774/index.html">Frontend DevDay. Grava√ß√£o de relat√≥rio</a></li>
<li><a href="../pt432776/index.html">O livro "Reaja em a√ß√£o"</a></li>
<li><a href="../pt432778/index.html">Desenvolvimento de um conversor buck no STM32F334: princ√≠pio de opera√ß√£o, c√°lculos, prototipagem</a></li>
<li><a href="../pt432780/index.html">Por que a empatia √© necess√°ria no mundo da tecnologia</a></li>
<li><a href="../pt432782/index.html">Instala√ß√£o multi-servidor do Zimbra Collaboration Suite</a></li>
<li><a href="../pt432786/index.html">.NET - localiza√ß√£o sem dor. (N) gettext + poedit</a></li>
<li><a href="../pt432788/index.html">Prot√≥tipos: como criar um produto de sucesso e salvar</a></li>
<li><a href="../pt432790/index.html">Supercondutor + ferro-√≠m√£: o estudo dos pares triplos de Cooper</a></li>
<li><a href="../pt432794/index.html">Bret Victor: Algumas palavras sobre Douglas Engelbart</a></li>
<li><a href="../pt432796/index.html">M√≥dulo de computa√ß√£o, modelos 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>