<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè∏ üë©üèæ‚Äçüíª üêó C√≥mo usar Control Inversion en JavaScript y Reactjs para simplificar el manejo del c√≥digo üï¥üèª üì∫ üë®üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inversion of Control es un principio de programaci√≥n bastante f√°cil de entender que, al mismo tiempo, puede mejorar significativamente su c√≥digo. Este...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo usar Control Inversion en JavaScript y Reactjs para simplificar el manejo del c√≥digo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485012/"><p><img src="https://habrastorage.org/getpro/habr/post_images/ca6/d2e/e7c/ca6d2ee7cdf0a14a1357e78d9f266507.webp" alt="C√≥mo usar Control Inversion en JavaScript y Reactjs para simplificar el manejo del c√≥digo"></p><br><p>  <em>Inversion of Control es un principio de programaci√≥n bastante f√°cil de entender que, al mismo tiempo, puede mejorar significativamente su c√≥digo.</em>  <em>Este art√≠culo demostrar√° c√≥mo aplicar la Inversi√≥n de control en JavaScript y en Reactjs.</em> </p><br><p>  Si ya ha escrito c√≥digo que se usa en m√°s de un lugar, entonces est√° familiarizado con esta situaci√≥n: </p><br><ol><li>  Crea un fragmento de c√≥digo reutilizable (puede ser una funci√≥n, un componente React, un React hook, etc.) y lo comparte (para colaboraci√≥n o publicaci√≥n en c√≥digo abierto). </li><li>  Alguien le pide que agregue nuevas funcionalidades.  Su c√≥digo no admite la funcionalidad propuesta, pero podr√≠a hacerlo si realizara un peque√±o cambio. </li><li>  Agrega un nuevo argumento / prop / opci√≥n a su c√≥digo y su l√≥gica asociada para mantener esta nueva funci√≥n funcionando. </li><li>  Repita los pasos 2 y 3 varias veces (o muchas, muchas veces). </li><li> Ahora su c√≥digo reutilizable es dif√≠cil de usar y mantener. </li></ol><br><p>  ¬øQu√© hace exactamente que el c√≥digo sea una pesadilla para usar y mantener?  Hay varios aspectos que pueden hacer que su c√≥digo sea problem√°tico: </p><a name="habracut"></a><br><ol><li>  <strong>Tama√±o y / o rendimiento del paquete:</strong> solo m√°s c√≥digo para ejecutar en dispositivos puede conducir a un bajo rendimiento.  A veces, esto puede hacer que las personas simplemente se nieguen a usar su c√≥digo. </li><li>  <strong>Dif√≠cil de mantener:</strong> Anteriormente, su c√≥digo reutilizable ten√≠a solo unas pocas opciones, y estaba enfocado en hacer una cosa bien, pero ahora puede hacer un mont√≥n de cosas diferentes, y debe documentarlo todo.  Adem√°s, las personas comenzar√°n a hacerle preguntas sobre c√≥mo usar su c√≥digo para ciertos casos de uso que pueden o no ser comparables con los casos de uso para los que ya ha agregado soporte.  Incluso puede tener dos casos de uso casi id√©nticos que son ligeramente diferentes, por lo que deber√° responder preguntas sobre qu√© es lo mejor para usar en una situaci√≥n dada. </li><li> <strong>Complejidad de implementaci√≥n</strong> : cada vez que esto <em>no</em> es <em>solo</em> otra <code>if</code> , cada rama de la l√≥gica de su c√≥digo coexiste con las ramas existentes de la l√≥gica.  De hecho, las situaciones son posibles cuando intenta mantener una combinaci√≥n de argumentos / opciones / accesorios que nadie usa, pero a√∫n necesita considerar cualquier opci√≥n posible, ya que no sabe exactamente si alguien usar√° o no estas combinaciones. </li><li>  <strong>API sofisticada</strong> : cada nuevo argumento / opci√≥n / accesorio que agregue a su c√≥digo reutilizable hace que sea dif√≠cil de usar, porque ahora tiene un enorme archivo README o un sitio donde se documenta toda la funcionalidad disponible, y las personas tienen que aprender todo esto para un uso efectivo tu c√≥digo  Usarlo no es conveniente, porque la complejidad de su API penetra el c√≥digo del desarrollador que lo usa, lo que complica su c√≥digo. </li></ol><br><p>  Como resultado, todos sufren.  Vale la pena se√±alar que la implementaci√≥n del programa final es una parte esencial del desarrollo.  Pero ser√≠a genial si pens√°ramos m√°s en la implementaci√≥n de nuestras abstracciones (lea sobre <a href="https://kentcdodds.com/blog/aha-programming" rel="nofollow">"programaci√≥n AHA"</a> ).  ¬øHay alguna manera de que podamos reducir los problemas con el c√≥digo reutilizable y aun as√≠ cosechar los beneficios del uso de abstracciones? </p><br><h2 id="inversiya-upravleniya">  Inversi√≥n de control </h2><br><p>  La inversi√≥n del control es un principio que realmente simplifica la creaci√≥n y el uso de abstracciones.  Esto es lo que Wikipedia dice al respecto: </p><br><blockquote>  ... en la programaci√≥n tradicional, el c√≥digo de usuario que expresa el prop√≥sito del programa se llama en bibliotecas reutilizables para resolver problemas comunes, pero con la inversi√≥n de control, es un entorno que llama a c√≥digo personalizado o espec√≠fico de la tarea, </blockquote><p>  Pi√©nselo de esta manera: "Reduzca la funcionalidad de su abstracci√≥n y haga que sus usuarios puedan implementar la funcionalidad que necesitan".  Esto puede parecer un completo absurdo, ya que utilizamos abstracciones para ocultar tareas complejas y repetitivas y, por lo tanto, hacer que nuestro c√≥digo sea m√°s "limpio" y "ordenado".  Pero, como hemos visto anteriormente, las abstracciones tradicionales no siempre simplifican el c√≥digo. </p><br><h1 id="chto-takoe-inversiya-upravleniya-v-kode">  ¬øQu√© es la inversi√≥n de gesti√≥n en el c√≥digo? </h1><br><p>  Para comenzar, aqu√≠ hay un ejemplo muy artificial: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Array.prototype.filter   function filter(array) { let newArray = [] for (let index = 0; index &lt; array.length; index++) { const element = array[index] if (element !== null &amp;&amp; element !== undefined) { newArray[newArray.length] = element } } return newArray } // : filter([0, 1, undefined, 2, null, 3, 'four', '']) // [0, 1, 2, 3, 'four', '']</span></span></code> </pre> <br><p>  Ahora juguemos un t√≠pico "ciclo de vida de la abstracci√≥n" agregando nuevos casos de uso a esta abstracci√≥n y "mejorando sin pensar" para admitir estos nuevos casos de uso: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Array.prototype.filter   function filter( array, { filterNull = true, filterUndefined = true, filterZero = false, filterEmptyString = false, } = {}, ) { let newArray = [] for (let index = 0; index &lt; array.length; index++) { const element = array[index] if ( (filterNull &amp;&amp; element === null) || (filterUndefined &amp;&amp; element === undefined) || (filterZero &amp;&amp; element === 0) || (filterEmptyString &amp;&amp; element === '') ) { continue } newArray[newArray.length] = element } return newArray } filter([0, 1, undefined, 2, null, 3, 'four', '']) // [0, 1, 2, 3, 'four', ''] filter([0, 1, undefined, 2, null, 3, 'four', ''], {filterNull: false}) // [0, 1, 2, null, 3, 'four', ''] filter([0, 1, undefined, 2, null, 3, 'four', ''], {filterUndefined: false}) // [0, 1, 2, undefined, 3, 'four', ''] filter([0, 1, undefined, 2, null, 3, 'four', ''], {filterZero: true}) // [1, 2, 3, 'four', ''] filter([0, 1, undefined, 2, null, 3, 'four', ''], {filterEmptyString: true}) // [0, 1, 2, 3, 'four']</span></span></code> </pre> <br><p>  Por lo tanto, nuestro programa funciona con solo seis casos de uso, pero de hecho admitimos cualquier combinaci√≥n posible de funciones, y hay hasta 25 combinaciones de este tipo (si calcul√© correctamente). </p><br><p>  En general, esta es una abstracci√≥n bastante simple.  Pero se puede simplificar.  A menudo sucede que la abstracci√≥n en la que se agreg√≥ la nueva funcionalidad podr√≠a simplificarse en gran medida para los casos de uso que realmente admite.  Desafortunadamente, tan pronto como la abstracci√≥n comience a admitir algo (por ejemplo, ejecutar <code>{ filterZero: true, filterUndefined: false }</code> ), tenemos miedo de eliminar esta funcionalidad debido a que puede romper el c√≥digo que se basa en ella. </p><br><p>  Incluso escribimos pruebas para casos de uso que en realidad no tenemos, simplemente porque nuestra abstracci√≥n admite estos escenarios, y es posible que tengamos que hacer esto en el futuro.  Y cuando estos u otros casos de uso se vuelven innecesarios para nosotros, no eliminamos su apoyo, ya que simplemente lo olvidamos, o pensamos que puede ser √∫til para nosotros en el futuro, o simplemente tenemos miedo de romper algo. </p><br><p>  Bien, ahora escribamos una abstracci√≥n m√°s elaborada para esta funci√≥n y apliquemos el m√©todo de inversi√≥n de control para admitir todos los casos de uso que necesitamos: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Array.prototype.filter   function filter(array, filterFn) { let newArray = [] for (let index = 0; index &lt; array.length; index++) { const element = array[index] if (filterFn(element)) { newArray[newArray.length] = element } } return newArray } filter( [0, 1, undefined, 2, null, 3, 'four', ''], el =&gt; el !== null &amp;&amp; el !== undefined, ) // [0, 1, 2, 3, 'four', ''] filter([0, 1, undefined, 2, null, 3, 'four', ''], el =&gt; el !== undefined) // [0, 1, 2, null, 3, 'four', ''] filter([0, 1, undefined, 2, null, 3, 'four', ''], el =&gt; el !== null) // [0, 1, 2, undefined, 3, 'four', ''] filter( [0, 1, undefined, 2, null, 3, 'four', ''], el =&gt; el !== undefined &amp;&amp; el !== null &amp;&amp; el !== 0, ) // [1, 2, 3, 'four', ''] filter( [0, 1, undefined, 2, null, 3, 'four', ''], el =&gt; el !== undefined &amp;&amp; el !== null &amp;&amp; el !== '', ) // [0, 1, 2, 3, 'four']</span></span></code> </pre> <br><p>  Genial  Result√≥ mucho m√°s f√°cil.  Acabamos de pasar el control sobre la funci√≥n, pasando la responsabilidad de decidir qu√© elemento pertenece a la nueva matriz, desde la funci√≥n de <code>filter</code> a la funci√≥n que llama a la funci√≥n de filtro.  Tenga en cuenta que la funci√≥n de <code>filter</code> sigue siendo una abstracci√≥n √∫til en s√≠ misma, pero ahora es mucho m√°s flexible. </p><br><p>  ¬øPero era tan mala la versi√≥n anterior de esta abstracci√≥n?  Probablemente no.  Pero desde que cambiamos el control, ahora podemos admitir casos de uso mucho m√°s √∫nicos: </p><br><pre> <code class="javascript hljs">filter( [ {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'dog'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'dolphin'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'eagle'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'elephant'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'robin'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'cat'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'salmon'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}, ], animal =&gt; animal.legs === <span class="hljs-number"><span class="hljs-number">0</span></span>, ) <span class="hljs-comment"><span class="hljs-comment">// [ // {name: 'dolphin', legs: 0, mammal: true}, // {name: 'salmon', legs: 0, mammal: false}, // ]</span></span></code> </pre> <br><p>  ¬øImag√≠nese si necesita agregar soporte para este caso de uso sin aplicar la inversi√≥n de control?  S√≠, eso ser√≠a simplemente rid√≠culo. </p><br><h1 id="plohoy-api">  API mala? </h1><br><p>  Una de las quejas m√°s comunes que escucho de las personas con respecto a las API que usan la inversi√≥n de control es: "S√≠, pero ahora es m√°s dif√≠cil de usar que antes".  Toma este ejemplo: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  filter([0, 1, undefined, 2, null, 3, 'four', '']) //  filter( [0, 1, undefined, 2, null, 3, 'four', ''], el =&gt; el !== null &amp;&amp; el !== undefined, )</span></span></code> </pre> <br><p>  S√≠, una de las opciones es claramente m√°s f√°cil de usar que la otra.  Pero uno de los beneficios de la inversi√≥n de control es que puede usar una API que usa la inversi√≥n de control para reimplementar su antigua API.  Esto suele ser bastante simple.  Por ejemplo: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filterWithOptions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> array, { filterNull = true, filterUndefined = true, filterZero = false, filterEmptyString = false, } = {}, </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> filter( array, element =&gt; !( (filterNull &amp;&amp; element === <span class="hljs-literal"><span class="hljs-literal">null</span></span>) || (filterUndefined &amp;&amp; element === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) || (filterZero &amp;&amp; element === <span class="hljs-number"><span class="hljs-number">0</span></span>) || (filterEmptyString &amp;&amp; element === <span class="hljs-string"><span class="hljs-string">''</span></span>) ), ) }</code> </pre> <br><p>  Genial, ¬øeh?  De esta manera, podemos crear abstracciones en la parte superior de la API en la que se aplica la inversi√≥n de control, y as√≠ crear una API m√°s simple.  Y si nuestra API "m√°s simple" no tiene suficientes casos de uso, nuestros usuarios pueden aplicar los mismos componentes b√°sicos que utilizamos para crear nuestra API de alto nivel para desarrollar soluciones para tareas m√°s complejas.  No necesitan pedirnos que agreguemos una nueva funci√≥n para <code>filterWithOptions</code> y esperar a que se implemente.  Ya tienen herramientas con las que pueden desarrollar independientemente la funcionalidad adicional que necesitan. </p><br><p>  Y, solo para el fan: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filterByLegCount</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">array, legCount</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> filter(array, animal =&gt; animal.legs === legCount) } filterByLegCount( [ {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'dog'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'dolphin'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'eagle'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'elephant'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'robin'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'cat'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'salmon'</span></span>, <span class="hljs-attr"><span class="hljs-attr">legs</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">mammal</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}, ], <span class="hljs-number"><span class="hljs-number">0</span></span>, ) <span class="hljs-comment"><span class="hljs-comment">// [ // {name: 'dolphin', legs: 0, mammal: true}, // {name: 'salmon', legs: 0, mammal: false}, // ]</span></span></code> </pre> <br><p>  Puede crear una funcionalidad especial para cualquier situaci√≥n que a menudo ocurra con usted. </p><br><h2 id="primery-iz-realnoy-zhizni">  Ejemplos de la vida real </h2><br><p>  Entonces, esto funciona en casos simples, pero ¬øes este concepto adecuado para la vida real?  Bueno, lo m√°s probable es que est√©s usando constantemente la inversi√≥n de control.  Por ejemplo, la funci√≥n <code>Array.prototype.filter</code> aplica control inverso.  Como la funci√≥n <code>Array.prototype.map</code> . </p><br><p>  Hay varios patrones con los que ya puede estar familiarizado, y que son solo una forma de inversi√≥n de control. </p><br><p>  Aqu√≠ hay dos de mis patrones favoritos que muestran que estos son <a href="https://kentcdodds.com/blog/compound-components-with-react-hooks" rel="nofollow">"Componentes Compuestos"</a> y <a href="https://kentcdodds.com/blog/the-state-reducer-pattern" rel="nofollow">"Reductores de Estado"</a> .  A continuaci√≥n se presentan breves ejemplos de c√≥mo se pueden aplicar estos patrones. </p><br><h3 id="sostavnye-komponenty-compound-components">  Componentes compuestos </h3><br><p>  Suponga que desea crear un componente de <code>Menu</code> que tenga un bot√≥n para abrir un men√∫ y una lista de elementos de men√∫ que se mostrar√°n cuando haga clic en el bot√≥n.  Luego, cuando se selecciona el elemento, realizar√° alguna acci√≥n.  Por lo general, para implementar esto, simplemente crean accesorios: </p><br><pre> <code class="xml hljs">function App() { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Menu</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">buttonContents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{</span></span></span><span class="hljs-tag"> &lt;&gt;</span></span> Actions <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-hidden</span></span></span><span class="hljs-tag">&gt;</span></span>‚ñæ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/&gt;</span></span> } items={[ {contents: 'Download', onSelect: () =&gt; alert('Download')}, {contents: 'Create a Copy', onSelect: () =&gt; alert('Create a Copy')}, {contents: 'Delete', onSelect: () =&gt; alert('Delete')}, ]} /&gt; ) }</code> </pre> <br><p>  Esto nos permite configurar muchas cosas en los elementos del men√∫.  Pero, ¬øqu√© sucede si queremos insertar una l√≠nea antes del elemento de men√∫ Eliminar?  ¬øDeber√≠amos agregar una opci√≥n especial a los objetos relacionados con los <code>items</code> ?  Bueno, no s√©, por ejemplo: <code>precedeWithLine</code> ?  M√°s o menos idea. </p><br><p>  Tal vez cree un tipo especial de elemento de men√∫, por ejemplo <code>{contents: &lt;hr /&gt;}</code> .  Creo que funcionar√≠a, pero luego tendr√≠amos que manejar casos donde no hay <code>onSelect</code> .  Y para ser honesto, esta es una API muy inc√≥moda. </p><br><p>  Cuando piense en c√≥mo crear una buena API para las personas que intentan hacer algo un poco diferente, en lugar de alcanzar la declaraci√≥n <code>if</code> , intente invertir el control.  ¬øQu√© pasa si transferimos la responsabilidad de la visualizaci√≥n del men√∫ al usuario?  Usamos uno de los puntos fuertes de la reacci√≥n: </p><br><pre> <code class="xml hljs">function App() { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Menu</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuButton</span></span></span><span class="hljs-tag">&gt;</span></span> Actions <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-hidden</span></span></span><span class="hljs-tag">&gt;</span></span>‚ñæ<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuButton</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuList</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuItem</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onSelect</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span><span class="hljs-tag"> =&gt;</span></span> alert('Download')}&gt;Download<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuItem</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onSelect</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span><span class="hljs-tag"> =&gt;</span></span> alert('Copy')}&gt;Create a Copy<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuItem</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onSelect</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span><span class="hljs-tag"> =&gt;</span></span> alert('Delete')}&gt;Delete<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MenuList</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Menu</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Un punto importante a tener en cuenta es que no hay estado de los componentes visibles para el usuario.  El estado se comparte impl√≠citamente entre estos componentes.  Este es el valor central del patr√≥n de componentes.  Aprovechando esta oportunidad, le dimos cierto control sobre el renderizado al usuario de nuestros componentes, y ahora agregar una l√≠nea adicional (o algo m√°s) es una acci√≥n simple e intuitiva.  Sin documentaci√≥n adicional, sin funciones adicionales, sin c√≥digo adicional o pruebas.  Todos ganan. </p><br><p>  Puedes leer m√°s sobre este patr√≥n <a href="https://kentcdodds.com/blog/compound-components-with-react-hooks" rel="nofollow">aqu√≠</a> .  Gracias a <a href="https://twitter.com/ryanflorence" rel="nofollow">Ryan Florence</a> , quien me ense√±√≥ esto. </p><br><h3 id="redyuser-sostoyaniya-state-reducer">  Reductor de estado </h3><br><p>  Se me ocurri√≥ este patr√≥n para resolver el problema de establecer la l√≥gica del componente.  Puede leer m√°s sobre esa situaci√≥n en mi blog <a href="https://kentcdodds.com/blog/the-state-reducer-pattern" rel="nofollow">, The State Reducer Pattern</a> , pero el punto principal es que tengo una biblioteca de b√∫squeda / autocompletar / escribir llamada <code>Downshift</code> , y uno de los usuarios de la biblioteca estaba desarrollando una versi√≥n de componentes de opci√≥n m√∫ltiple. , por lo que quer√≠a que el men√∫ permaneciera abierto incluso despu√©s de seleccionar un elemento. </p><br><p>  La l√≥gica detr√°s de <code>Downshift</code> sugiri√≥ que despu√©s de que se hizo la elecci√≥n, el men√∫ deber√≠a cerrarse.  Un usuario de la biblioteca que necesitaba cambiar su funcionalidad sugiri√≥ agregar prop <code>closeOnSelection</code> .  Rechac√© esta oferta, ya que una vez ya hab√≠a recorrido el camino que conduc√≠a a un <a href="https://twitter.com/gurlcode/status/1002110517094371328" rel="nofollow">prolapso</a> , y quer√≠a evitarlo. </p><br><p>  En cambio, hice la API para que los propios usuarios pudieran controlar c√≥mo ocurren los cambios de estado.  Piense en el reductor de estado como el estado de una funci√≥n que se llama cada vez que cambia el estado del componente, y le da al desarrollador de la aplicaci√≥n la capacidad de influir en el cambio de estado que est√° por suceder. </p><br><p>  Un ejemplo de uso de la biblioteca <code>Downshift</code> para que no cierre el men√∫ despu√©s de que el usuario haga clic en el elemento seleccionado: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stateReducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, changes</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (changes.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Downshift.stateChangeTypes.keyDownEnter: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Downshift.stateChangeTypes.clickItem: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...changes, <span class="hljs-comment"><span class="hljs-comment">//     Downshift   //       isOpen  highlightedIndex //      isOpen: state.isOpen, highlightedIndex: state.highlightedIndex, } default: return changes } } // ,   // &lt;Downshift stateReducer={stateReducer} {...restOfTheProps} /&gt;</span></span></code> </pre> <br><p>  Despu√©s de agregar este accesorio, comenzamos a recibir MUCHAS menos solicitudes para agregar nuevas configuraciones para este componente.  El componente se ha vuelto m√°s flexible y se ha vuelto m√°s f√°cil para los desarrolladores configurarlo seg√∫n lo necesiten. </p><br><h3 id="render-propsy-render-props">  Render Props </h3><br><p>  Vale la pena mencionar es el patr√≥n <a href="https://reactjs.org/docs/render-props.html" rel="nofollow">"render props"</a> .  Este patr√≥n es un ejemplo ideal del uso de la inversi√≥n de control, pero especialmente no lo necesitamos.  Lea m√°s sobre esto aqu√≠: <a href="https://kentcdodds.com/blog/react-hooks-whats-going-to-happen-to-render-props" rel="nofollow">por qu√© ya no necesitamos Render Props</a> . </p><br><h2 id="preduprezhdenie">  Advertencia </h2><br><p>  La inversi√≥n del control es una excelente manera de sortear el problema de la idea err√≥nea acerca de c√≥mo se usar√° su c√≥digo en el futuro.  Pero antes de terminar, me gustar√≠a darle algunos consejos. </p><br><p>  Volvamos a nuestro ejemplo descabellado: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Array.prototype.filter   function filter(array) { let newArray = [] for (let index = 0; index &lt; array.length; index++) { const element = array[index] if (element !== null &amp;&amp; element !== undefined) { newArray[newArray.length] = element } } return newArray } // : filter([0, 1, undefined, 2, null, 3, 'four', '']) // [0, 1, 2, 3, 'four', '']</span></span></code> </pre><br><p>  ¬øQu√© pasa si esto es todo lo que necesitamos de la funci√≥n de <code>filter</code> ?  ¬øY nunca nos enfrentamos a una situaci√≥n en la que necesitar√≠amos filtrar algo excepto <code>null</code> e <code>undefined</code> ?  En este caso, agregar la inversi√≥n de control para un solo caso de uso simplemente complicar√≠a el c√≥digo y no aportar√≠a muchos beneficios. </p><br><p>  ¬°Al igual que con cualquier abstracci√≥n, tenga cuidado de aplicar el principio de la <a href="https://kentcdodds.com/blog/aha-programming" rel="nofollow">programaci√≥n</a> de la <a href="https://kentcdodds.com/blog/aha-programming" rel="nofollow">AHA</a> y evitar abstracciones apresuradas! </p><br><h2 id="vyvody">  Conclusiones </h2><br><p>  Espero que el art√≠culo te haya sido √∫til.  Mostr√© c√≥mo puedes aplicar el concepto de Inversi√≥n de Control en una reacci√≥n.  Este concepto, por supuesto, se aplica no solo a React (como vimos con la funci√≥n de <code>filter</code> ).  La pr√≥xima vez que note que est√° agregando otra <code>if</code> a la funci√≥n <code>coreBusinessLogic</code> de su aplicaci√≥n, piense en c√≥mo puede invertir el control y transferir la l√≥gica a donde se usa (o, si se usa en varios lugares, puede crear una abstracci√≥n m√°s especializada para esto). caso espec√≠fico). </p><br><p>  Si lo desea, puede jugar con un ejemplo de un art√≠culo en <a href="https://codesandbox.io/s/inversion-of-control-qunm8%3Ffontsize%3D14%26hidenavigation%3D1%26theme%3Ddark" rel="nofollow">CodeSandbox</a> . </p><br><p>  ¬°Buena suerte y gracias por su atenci√≥n! </p><br><p>  PS.  Si te ha gustado este art√≠culo, puedes disfrutar esta charla: <a href="https://youtu.be/AiJ8tRRH0f8" rel="nofollow">youtube Kent C Dodds - Simply React</a> </p></div></div><p>Source: <a href="https://habr.com/ru/post/485012/">https://habr.com/ru/post/485012/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../485000/index.html">¬øEl tr√°fico en los Estados Unidos es costoso o no?</a></li>
<li><a href="../485002/index.html">Patr√≥n Flutter BloC + Proveedor + pruebas + recordar el estado</a></li>
<li><a href="../485006/index.html">Libro (de ser?). Reflexiones sobre la naturaleza de la mente. Parte II</a></li>
<li><a href="../485008/index.html">Contenedores de propiedad Swift</a></li>
<li><a href="../485010/index.html">¬°No llores, ni√±a! Responda al autor con vc.ru sobre la carta sobre Habr√©</a></li>
<li><a href="../485014/index.html">¬øDeber√≠a quejarme de entrevistas?</a></li>
<li><a href="../485016/index.html">Bases de datos administradas en Selectel: Bienvenido a Beta</a></li>
<li><a href="../485018/index.html">Escribir sombreadores con c√≥digo en Unity LWRP</a></li>
<li><a href="../485022/index.html">Playme Sigma: DVR funcional y asequible</a></li>
<li><a href="../485024/index.html">¬øQu√© hay debajo de las optimizaciones del compilador GraalVM?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>