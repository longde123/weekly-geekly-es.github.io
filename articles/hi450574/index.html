<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП┐тАНЁЯТ╝ ЁЯСйЁЯП┐тАНЁЯОд ЁЯзСЁЯП┐тАНЁЯдЭтАНЁЯзСЁЯП╜ рдПрдХ рдорд▓реНрдЯреАрдкреНрд▓реЗрдпрд░ .io рд╡реЗрдм рдЧреЗрдо рдмрдирд╛рдПрдВ ЁЯд╕ЁЯП╝ ЁЯЪЛ ЁЯР╖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2015 рдореЗрдВ рдЬрд╛рд░реА, Agar.io рдЦреЗрд▓реЛрдВ рдХреА рдирдИ рд╢реИрд▓реА рдХреЗ рдкреВрд░реНрд╡рдЬ рдмрди рдЧрдП редio , рдХреА рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХрд╛рдлреА рдмрдврд╝ рдЧрдИ рд╣реИред рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреА рд╡реГрджреНрдзрд┐ .io рдЦреЗрд▓ рдЬреЛ рдореИрдВрдиреЗ рдЦреБрдж рдЕрдиреБрднрд╡ рдХ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХ рдорд▓реНрдЯреАрдкреНрд▓реЗрдпрд░ .io рд╡реЗрдм рдЧреЗрдо рдмрдирд╛рдПрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450574/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c7c/405/7a7/c7c4057a7ab7333ee3cb9aba5ecc8c37.jpg" alt="рдЫрд╡рд┐"></div><br>  2015 рдореЗрдВ рдЬрд╛рд░реА, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">Agar.io</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer"><strong>рдЦреЗрд▓реЛрдВ</strong></a> рдХреА рдирдИ рд╢реИрд▓реА рдХреЗ рдкреВрд░реНрд╡рдЬ рдмрди рдЧрдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer"><strong>редio</strong></a> , рдХреА рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХрд╛рдлреА рдмрдврд╝ рдЧрдИ рд╣реИред  рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреА рд╡реГрджреНрдзрд┐ .io рдЦреЗрд▓ рдЬреЛ рдореИрдВрдиреЗ рдЦреБрдж рдЕрдиреБрднрд╡ рдХрд┐рдП рд╣реИрдВ: рдкрд┐рдЫрд▓реЗ рддреАрди рд╡рд░реНрд╖реЛрдВ рдореЗрдВ рдореИрдВрдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕ рд╢реИрд▓реА рдХреЗ рджреЛ рдЧреЗрдо рдмрдирд╛рдП рдФрд░ рдмреЗрдЪреЗ рд╣реИрдВред</a>  ред <br><br>  рдпрджрд┐ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рдХрднреА рдЗрд╕ рддрд░рд╣ рдХреЗ рдЦреЗрд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рд╕реБрдирд╛ рд╣реИ: рдпреЗ рдореБрдлреНрдд рдорд▓реНрдЯреАрдкреНрд▓реЗрдпрд░ рд╡реЗрдм рдЧреЗрдо рд╣реИрдВ рдЬреЛ (рдХреЛрдИ рдЦрд╛рддрд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ) рдореЗрдВ рднрд╛рдЧ рд▓реЗрдирд╛ рдЖрд╕рд╛рди рд╣реИред  рдЖрдорддреМрд░ рдкрд░ рд╡реЗ рдХрдИ рд╡рд┐рд░реЛрдзреА рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рдПрдХ рд╣реА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдзрдХреЗрд▓ рджреЗрддреЗ рд╣реИрдВред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">.Io</a> рд╢реИрд▓реА рдХреЗ рдЕрдиреНрдп рдкреНрд░рд╕рд┐рджреНрдз рдЦреЗрд▓ рд╣реИрдВ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">Slither.io</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">Diep.io.</a> <br><br>  рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ, рд╣рдо рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдПрдВрдЧреЗ рдХрд┐ <strong>рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рдПрдХ .io рдЧреЗрдо</strong> рдХреИрд╕реЗ <strong>рдмрдирд╛рдпрд╛ рдЬрд╛рдП</strong> ред  рдЗрд╕рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЬреНрдЮрд╛рди рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛: рдЖрдкрдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">ES6</a> рд╕рд┐рдВрдЯреИрдХреНрд╕, <code>this</code> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдкреНрд░реЙрдорд┐рд╕</a> рдЬреИрд╕реА рдЪреАрдЬреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рднрд▓реЗ рд╣реА рдЖрдк рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ, рдлрд┐рд░ рднреА рдЖрдк рдЕрдзрд┐рдХрд╛рдВрд╢ рдкреЛрд╕реНрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><a name="habracut"></a><br><h2>  рдЦреЗрд▓ рдЙрджрд╛рд╣рд░рдг .io </h2><br>  рдЖрдкрдХреЛ рд╕реАрдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдХ рдЙрджрд╛рд╣рд░рдг .io рдЧреЗрдо рдХрд╛</a> рдЙрд▓реНрд▓реЗрдЦ рдХрд░реЗрдВрдЧреЗред  рдЗрд╕реЗ рдЦреЗрд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЛ! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/um/yq/qj/umyqqjon22wmshrz8o8wtyeaxl0.png"></div><br>  рдЦреЗрд▓ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ: рдЖрдк рдПрдХ рдореИрджрд╛рди рдореЗрдВ рдПрдХ рдЬрд╣рд╛рдЬ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рдЕрдиреНрдп рдЦрд┐рд▓рд╛рдбрд╝реА рд╣реИрдВред  рдЖрдкрдХрд╛ рдЬрд╣рд╛рдЬ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЧреЛрд▓реЗ рджрд╛рдЧрддрд╛ рд╣реИ рдФрд░ рдЖрдк рдЕрдиреНрдп рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рдорд╛рд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдЙрдирдХреЗ рдЧреЛрд▓реЗ рд╕реЗ рдмрдЪрддреЗ рд╣реИрдВред <br><br><h2>  1. рдЕрд╡рд▓реЛрдХрди / рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕рдВрд░рдЪрдирд╛ </h2><br><blockquote>  рдореИрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer"><strong>рдПрдХ</strong></a> рдЙрджрд╛рд╣рд░рдг рдХреЗ рдЦреЗрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer"><strong>рдХреЗ рд▓рд┐рдП рд╕реНрд░реЛрдд рдХреЛрдб рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА</strong></a> рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВ рддрд╛рдХрд┐ рдЖрдк рдореЗрд░рд╛ рдЕрдиреБрд╕рд░рдг рдХрд░ рд╕рдХреЗрдВред </blockquote><br>  рдЙрджрд╛рд╣рд░рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдПрдХреНрд╕рдкреНрд░реЗрд╕</a> Node.js рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рд╡реЗрдм рдлреНрд░реЗрдорд╡рд░реНрдХ рд╣реИ рдЬреЛ рдЧреЗрдо рдХреЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИред </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">socket.io</a> - рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдХреЗ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реЗрдмрд╕реЛрдХреЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реАред </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реЗрдмрдкреИрдХ</a> рдПрдХ рдореЙрдбреНрдпреВрд▓ рдореИрдиреЗрдЬрд░ рд╣реИред  рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рд╡реЗрдмрдкреИрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред </li></ul><br>  рдпрд╣рд╛рдВ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ: <br><br><pre> <code class="hljs axapta"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/ assets/ ... src/ <span class="hljs-keyword"><span class="hljs-keyword">client</span></span>/ css/ ... html/ <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.js ... <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>/ <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>.js ... shared/ constants.js</code> </pre> <br><h3>  рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ / </h3><br>  <code>public/</code> рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕рдм рдХреБрдЫ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд░реВрдк рд╕реЗ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  <code>public/assets/</code> рдореЗрдВ рд╣рдорд╛рд░реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЫрд╡рд┐рдпрд╛рдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред <br><br><h3>  src / </h3><br>  рд╕рднреА рд╕реНрд░реЛрдд рдХреЛрдб <code>src/</code> folder рдореЗрдВ рд╣реИред  рдирд╛рдо <code>client/</code> рдФрд░ <code>server/</code> рдЦреБрдж рдХреЗ рд▓рд┐рдП рдмреЛрд▓рддреЗ рд╣реИрдВ, рдФрд░ <code>shared/</code> рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рджреЛрдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЖрдпрд╛рдд рдХреА рдЧрдИ рдПрдХ рд╕реНрдерд┐рд░ рдлрд╝рд╛рдЗрд▓ рд╣реЛрддреА рд╣реИред <br><br><h2>  2. рдЕрд╕реЗрдВрдмрд▓реА / рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ </h2><br>  рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реЗрдмрдкреИрдХ</a> рдореЙрдбреНрдпреВрд▓ рдкреНрд░рдмрдВрдзрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЖрдЗрдП рд╣рдорд╛рд░реЗ рд╡реЗрдмрдкреИрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ: <br><br><h5>  webpack.common.js: </h5><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = require(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MiniCssExtractPlugin = require(<span class="hljs-string"><span class="hljs-string">'mini-css-extract-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.exports = { entry: { game: <span class="hljs-string"><span class="hljs-string">'./src/client/index.js'</span></span>, }, output: { filename: <span class="hljs-string"><span class="hljs-string">'[name].[contenthash].js'</span></span>, path: path.resolve(__dirname, <span class="hljs-string"><span class="hljs-string">'dist'</span></span>), }, <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>: { rules: [ { test: /\.js$/, exclude: /node_modules/, use: { loader: <span class="hljs-string"><span class="hljs-string">"babel-loader"</span></span>, options: { presets: [<span class="hljs-string"><span class="hljs-string">'@babel/preset-env'</span></span>], }, }, }, { test: /\.css$/, use: [ { loader: MiniCssExtractPlugin.loader, }, <span class="hljs-string"><span class="hljs-string">'css-loader'</span></span>, ], }, ], }, plugins: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MiniCssExtractPlugin({ filename: <span class="hljs-string"><span class="hljs-string">'[name].[contenthash].css'</span></span>, }), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlWebpackPlugin({ filename: <span class="hljs-string"><span class="hljs-string">'index.html'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>: <span class="hljs-string"><span class="hljs-string">'src/client/html/index.html'</span></span>, }), ], };</code> </pre> <br>  рдпрд╣рд╛рдБ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд╛рдЗрдиреЗрдВ рд╣реИрдВ: <br><br><ul><li>  <code>src/client/index.js</code> рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреНрд▓рд╛рдЗрдВрдЯ (JS) рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдмрд┐рдВрджреБ рд╣реИред  рд╡реЗрдмрдкреИрдХ рдпрд╣рд╛рдВ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдЧрд╛ рдФрд░ рдЕрдиреНрдп рдЖрдпрд╛рддрд┐рдд рдлрд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░реЗрдЧрд╛ред </li><li>  рд╣рдорд╛рд░реЗ рд╡реЗрдмрдкреИрдХ рдЕрд╕реЗрдВрдмрд▓реА рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ JS <code>dist/</code> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрдЧрд╛ред  рдореИрдВ рдЗрд╕ рдлрд╛рдЗрд▓ рдХреЛ рд╣рдорд╛рд░реЗ <strong>рдЬреЗрдПрд╕ рдкреИрдХреЗрдЬ</strong> рдХрд╣реВрдВрдЧрд╛ред </li><li>  рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдмреИрдмрд▓ рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">@</a> рдЬреЗрд╕реНрд╕реЗрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">/ рдкреНрд░реАрд╕реЗрдЯ-рдПрдирд╡реА</a> рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреБрд░рд╛рдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдЬреЗрдПрд╕ рдХреЛрдб рдХреЛ рдЯреНрд░рд╛рдВрд╕рдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред </li><li>  рд╣рдо рдЬреЗрдПрд╕ рдлрд╛рдЗрд▓реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рд╕рднреА рд╕реАрдПрд╕рдПрд╕ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╕реНрдерд╛рди рдкрд░ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд▓рдЧрдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдореИрдВ рдЗрд╕реЗ рд╣рдорд╛рд░реЗ <strong>рд╕реАрдПрд╕рдПрд╕ рдкреИрдХреЗрдЬ</strong> рдХрд╣реВрдВрдЧрд╛ред </li></ul><br>  рдЖрдкрдиреЗ рдЕрдЬреАрдм рдкреИрдХреЗрдЬ рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ <code>'[name].[contenthash].ext'</code> ред  рд╡реЗ рд╡реЗрдмрдкреИрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдирд╛рдореЛрдВ рдХрд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХрд░рддреЗ рд╣реИрдВ</a> : <code>[name]</code> рдХреЛ рдЗрдирдкреБрдЯ рдмрд┐рдВрджреБ рдХреЗ рдирд╛рдо рд╕реЗ рдмрджрд▓рд╛ рдЬрд╛рдПрдЧрд╛ (рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдПрдХ <code>game</code> ), рдФрд░ <code>[contenthash]</code> рдХреЛ рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╣реИрд╢ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рд╣реИрд╢рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдпреЛрдЬрдирд╛</a> рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдЕрдиреБрдХреВрд▓рд┐рдд</a> рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ - рдЖрдк рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЛ рд╣рдорд╛рд░реЗ рдЬреЗрдПрд╕ рдкреИрдХреЗрдЬреЛрдВ рдХреЛ рдЕрдирд┐рд╢реНрдЪрд┐рдд рдХрд╛рд▓ рдХреЗ рд▓рд┐рдП рдХреИрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ <strong>рдпрджрд┐ рдкреИрдХреЗрдЬ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо</strong> рдмрджрд▓ рдЬрд╛рддрд╛ рд╣реИ ( <code>contenthash</code> рдкрд░рд┐рд╡рд░реНрддрди)ред  рд╕рдорд╛рдкреНрдд рдкрд░рд┐рдгрд╛рдо рдлреЙрд░реНрдо <code>game.dbeee76e91a97d0c7207.js</code> рдХрд╛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рд╣реЛрдЧрд╛ред <br><br>  <code>webpack.common.js</code> рдлрд╝рд╛рдЗрд▓ рдЖрдзрд╛рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рд╡рд┐рдХрд╛рд╕ рдФрд░ рддреИрдпрд╛рд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдЖрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд┐рдХрд╛рд╕ рд╡рд┐рдиреНрдпрд╛рд╕: <br><br><h5>  webpack.dev.js </h5><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> merge = require(<span class="hljs-string"><span class="hljs-string">'webpack-merge'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> common = require(<span class="hljs-string"><span class="hljs-string">'./webpack.common.js'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.exports = merge(common, { mode: <span class="hljs-string"><span class="hljs-string">'development'</span></span>, });</code> </pre> <br>  рджрдХреНрд╖рддрд╛ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд┐рдХрд╛рд╕ <code>webpack.dev.js</code> рдореЗрдВ <code>webpack.dev.js</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ <code>webpack.dev.js</code> , рдФрд░ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рддреИрдирд╛рдд рд╣реЛрдиреЗ рдкрд░ рдкреИрдХреЗрдЬ рдЖрдХрд╛рд░реЛрдВ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>webpack.prod.js</code> рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рддреЗ рд╣реИрдВред <br><br><h3>  рд╕реНрдерд╛рдиреАрдп рд╕реЗрдЯрд┐рдВрдЧ </h3><br>  рдореИрдВ рдПрдХ рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдкрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВ рддрд╛рдХрд┐ рдЖрдк рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░ рд╕рдХреЗрдВред  рд╕реЗрдЯрдЕрдк рд╕рд░рд▓ рд╣реИ: рдкрд╣рд▓реЗ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдиреЛрдб</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдирдкреАрдПрдо</a> рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЖрдЧреЗ рдЖрдкрдХреЛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ <br><br><pre> <code class="cpp hljs">$ git clone https:<span class="hljs-comment"><span class="hljs-comment">//github.com/vzhou842/example-.io-game.git $ cd example-.io-game $ npm install</span></span></code> </pre> <br>  рдФрд░ рдЖрдк рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВ!  рд╡рд┐рдХрд╛рд╕ рд╕рд░реНрд╡рд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдЪрд▓рд╛рдПрдВ <br><br><pre> <code class="cpp hljs">$ npm run develop</code> </pre> <br>  рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">:</a> рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд░ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">3000</a> ред  рдХреЛрдб рдмрджрд▓рддреЗ рд╣реА рдЬреЗрдПрд╕ рдФрд░ рд╕реАрдПрд╕рдПрд╕ рдкреИрдХреЗрдЬреЛрдВ рдХрд╛ рд╡рд┐рдХрд╛рд╕ рд╕рд░реНрд╡рд░ рдЕрдкрдиреЗ рдЖрдк рдлрд┐рд░ рд╕реЗ рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рдПрдЧрд╛ - рд╕рднреА рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкреГрд╖реНрда рдХреЛ рддрд╛рдЬрд╝рд╛ рдХрд░реЗрдВ! <br><br><h2>  3. рдЧреНрд░рд╛рд╣рдХ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ </h2><br>  рдЪрд▓реЛ рдЦреЗрд▓ рдХреЛрдб рдХреЗ рд▓рд┐рдП рд╣реА рдиреАрдЪреЗ рдЖрддреЗ рд╣реИрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ <code>index.html</code> рдкреЗрдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрдм рдЖрдк рд╕рд╛рдЗрдЯ рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд░реЗрдЧрд╛ред  рд╣рдорд╛рд░рд╛ рдкреГрд╖реНрда рдХрд╛рдлреА рд╕рд░рд▓ рд╣реЛрдЧрд╛: <br><br><h5>  index.html </h5><br><pre>  &lt;! DOCTYPE html&gt;
 &lt;Html&gt;
 &lt;Head&gt;
   &lt;рд╢реАрд░реНрд╖рдХ&gt; рдПрдХ рдЙрджрд╛рд╣рд░рдг .io рдЦреЗрд▓ &lt;/ рд╢реАрд░реНрд╖рдХ&gt;
   &lt;рд▓рд┐рдВрдХ рдкреНрд░рдХрд╛рд░ = "рдЯреЗрдХреНрд╕реНрдЯ / рд╕реАрдПрд╕рдПрд╕" rel = "рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ" href = "/ game.bundle.css"&gt;
 &lt;/ Head&gt;
 &lt;Body&gt;
   &lt;рдХреИрдирд╡рд╛рд╕ рдЖрдИрдбреА = "рдЧреЗрдо-рдХреИрдирд╡рд╛рд╕"&gt; &lt;/ рдХреИрдирд╡рд╛рд╕&gt;
   &lt;script async src = "/ game.bundle.js"&gt; &lt;/ script&gt;
   &lt;div id = "play-menu" рд╡рд░реНрдЧ = "рдЫрд┐рдкрд╛ рд╣реБрдЖ"&gt;
     &lt;рдЗрдирдкреБрдЯ рдкреНрд░рдХрд╛рд░ = "рдЯреЗрдХреНрд╕реНрдЯ" рдЖрдИрдбреА = "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо-рдЗрдирдкреБрдЯ" рдкреНрд▓реЗрд╕рд╣реЛрд▓реНрдбрд░ = "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо" /&gt;
     &lt;рдмрдЯрди рдЖрдИрдбреА = "рдкреНрд▓реЗ-рдмрдЯрди"&gt; рдкреНрд▓реЗ &lt;/ рдмрдЯрди&gt;
   &lt;/ Div&gt;
 &lt;/ Body&gt;
 &lt;/ Html&gt; </pre><br>  <i>рдпрд╣ рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рд╕реНрдкрд╖реНрдЯрддрд╛ рдХреЗ рд▓рд┐рдП рдереЛрдбрд╝рд╛ рд╕рд░рд▓ рд╣реИ, рдореИрдВ рдкреЛрд╕реНрдЯ рдХреЗ рдХрдИ рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рднреА рдРрд╕рд╛ рд╣реА рдХрд░реВрдВрдЧрд╛ред</i>  <i>рдкреВрд░реНрдг рдХреЛрдб рд╣рдореЗрд╢рд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Github</a> рдкрд░ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</i> <br><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣реИ: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдЪрдЯреАрдПрдордПрд▓ 5 рдХреИрдирд╡рд╕</a> ( <code>&lt;canvas&gt;</code> ) <code>&lt;canvas&gt;</code> рдЬреЛ рд╣рдо рдЧреЗрдо рдХреЛ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </li><li>  рд╣рдорд╛рд░реЗ рд╕реАрдПрд╕рдПрд╕ рдкреИрдХреЗрдЬ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП <code>&lt;link&gt;</code> ред </li><li>  <code>&lt;script&gt;</code> рд╣рдорд╛рд░реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреИрдХреЗрдЬ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдПред </li><li>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо <code>&lt;input&gt;</code> рдФрд░ "рдкреНрд▓реЗ" ( <code>&lt;button&gt;</code> ) <code>&lt;button&gt;</code> рд╕рд╛рде рдореБрдЦреНрдп рдореЗрдиреВред </li></ul><br>  рд╣реЛрдо рдкреЗрдЬ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛, рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдХреЗ рдЬреЗрдПрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрдЧрд╛: <code>src/client/index.js</code> ред <br><br><h5>  index.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect, play } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./networking'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { startRendering, stopRendering } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./render'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { startCapturingInput, stopCapturingInput } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./input'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { downloadAssets } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./assets'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { initState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./state'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { setLeaderboardHidden } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./leaderboard'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./css/main.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> playMenu = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'play-menu'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> playButton = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'play-button'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> usernameInput = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'username-input'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all([ connect(), downloadAssets(), ]).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { playMenu.classList.remove(<span class="hljs-string"><span class="hljs-string">'hidden'</span></span>); usernameInput.focus(); playButton.onclick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Play! play(usernameInput.value); playMenu.classList.add('hidden'); initState(); startCapturingInput(); startRendering(); setLeaderboardHidden(false); }; });</span></span></code> </pre> <br>  рдпрд╣ рдЬрдЯрд┐рд▓ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣рд╛рдВ рдмрд╣реБрдд рд╕рд╛рд░реА рдХреНрд░рд┐рдпрд╛рдПрдВ рдирд╣реАрдВ рд╣реЛ рд░рд╣реА рд╣реИрдВ: <br><br><ol><li>  рдХрдИ рдЕрдиреНрдп рдЬреЗрдПрд╕ рдлрд╛рдЗрд▓реЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВред </li><li>  рдЖрдпрд╛рдд рд╕реАрдПрд╕рдПрд╕ (рддрд╛рдХрд┐ рд╡реЗрдмрдкреИрдХ рд╣рдорд╛рд░реЗ рд╕реАрдПрд╕рдПрд╕ рдкреИрдХреЗрдЬ рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЬрд╛рдирддрд╛ рд╣реИ)ред </li><li>  рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░рдирд┐рдВрдЧ <code>connect()</code> рдФрд░ рдЧреЗрдо рдХреЛ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЫрд╡рд┐рдпрд╛рдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд╛рдЙрдирд▓реЛрдбрдЕрд╕реИрдЯ <code>downloadAssets()</code> рдЪрд▓ рд░рд╣рд╛ рд╣реИред </li><li>  <em>рдЪрд░рдг 3 рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж</em> , рдореБрдЦреНрдп рдореЗрдиреВ ( <code>playMenu</code> ) <code>playMenu</code> рдЬрд╛рддрд╛ <code>playMenu</code> ред </li><li>  PLAY рдмрдЯрди рджрдмрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВрдбрд▓рд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛ред  рдЬрдм рдмрдЯрди рджрдмрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреЛрдб рдЧреЗрдо рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдЦреЗрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВред </li></ol><br>  рд╣рдорд╛рд░реЗ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рд▓реЙрдЬрд┐рдХ рдХрд╛ рдореБрдЦреНрдп "рдорд╛рдВрд╕" рдЙрди рдлрд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ <code>index.js</code> рдлрд╝рд╛рдЗрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрдпрд╛рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдЕрдм рд╣рдо рдЙрди рд╕рднреА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗред <br><br><h2>  4. рдЧреНрд░рд╛рд╣рдХ рдбреЗрдЯрд╛ рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди </h2><br>  рдЗрд╕ рдЧреЗрдо рдореЗрдВ рд╣рдо рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕рд┐рджреНрдз <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реЙрдХреЗрдЯ.рдЖрдИрдУ</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  Socket.io рдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">WebSockets рдХреЗ</a> рд▓рд┐рдП рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕рдорд░реНрдерди рджрд┐рдпрд╛ рд╣реИ, рдЬреЛ рджреЛ-рддрд░рдлрд╝рд╛ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдиреБрдХреВрд▓ рд╣реИрдВ: рд╣рдо рд╕рд░реНрд╡рд░ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ <em>рдФрд░</em> рд╕рд░реНрд╡рд░ рд╣рдореЗрдВ рдЙрд╕реА рдХрдиреЗрдХреНрд╢рди рдкрд░ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред <br><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ <code>src/client/networking.js</code> рдлрд╝рд╛рдЗрд▓ рд╣реЛрдЧреА рдЬреЛ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде <strong>рд╕рднреА</strong> рд╕рдВрдЪрд╛рд░реЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓реЗрдЧреА: <br><br><h5>  networking.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'socket.io-client'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { processGameUpdate } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./state'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> socket = io(<span class="hljs-string"><span class="hljs-string">`ws://</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">window</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.location.host}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> connectedPromise = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { socket.on(<span class="hljs-string"><span class="hljs-string">'connect'</span></span>, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Connected to server!'</span></span>); resolve(); }); }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> connect = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onGameOver</span></span></span><span class="hljs-function"> =&gt;</span></span> ( connectedPromise.then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Register callbacks socket.on(Constants.MSG_TYPES.GAME_UPDATE, processGameUpdate); socket.on(Constants.MSG_TYPES.GAME_OVER, onGameOver); }) ); export const play = username =&gt; { socket.emit(Constants.MSG_TYPES.JOIN_GAME, username); }; export const updateDirection = dir =&gt; { socket.emit(Constants.MSG_TYPES.INPUT, dir); };</span></span></code> </pre> <br>  <i>рд╕реНрдкрд╖реНрдЯрддрд╛ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЛрдб рднреА рдереЛрдбрд╝рд╛ рдХрдо рд╣реИред</i> <br><br>  рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рддреАрди рдореБрдЦреНрдп рдХреНрд░рд┐рдпрд╛рдПрдВ рд╣реИрдВ: <br><br><ul><li>  рд╣рдо рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  <code>connectedPromise</code> рдХреА рдЕрдиреБрдорддрд┐ рдХреЗрд╡рд▓ рддрднреА рд╣реИ рдЬрдм рд╣рдордиреЗ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рд╣реЛред </li><li>  рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, рддреЛ рд╣рдо рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рдХреЙрд▓рдмреИрдХ рдлрд╝рдВрдХреНрд╢рдВрд╕ ( <code>processGameUpdate()</code> рдФрд░ <code>onGameOver()</code> ) рдкрдВрдЬреАрдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </li><li>  рд╣рдо <code>play()</code> рдФрд░ <code>updateDirection()</code> рдирд┐рд░реНрдпрд╛рдд рдХрд░рддреЗ <code>play()</code> рддрд╛рдХрд┐ рдЕрдиреНрдп рдлрд╛рдЗрд▓реЗрдВ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВред </li></ul><br><h2>  5. рдХреНрд▓рд╛рдЗрдВрдЯ рд░реЗрдВрдбрд░рд┐рдВрдЧ </h2><br>  рдпрд╣ рд╕реНрдХреНрд░реАрди рдкрд░ рдПрдХ рдЪрд┐рддреНрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ! <br><br>  ... рд▓реЗрдХрд┐рди рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╣рдо рдРрд╕рд╛ рдХрд░ рд╕рдХреЗрдВ, рд╣рдореЗрдВ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рднреА рдЪрд┐рддреНрд░реЛрдВ (рд╕рдВрд╕рд╛рдзрдиреЛрдВ) рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдПрдХ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдмрдВрдзрдХ рд▓рд┐рдЦрддреЗ рд╣реИрдВ: <br><br><h5>  assets.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ASSET_NAMES = [<span class="hljs-string"><span class="hljs-string">'ship.svg'</span></span>, <span class="hljs-string"><span class="hljs-string">'bullet.svg'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> assets = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> downloadPromise = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all(ASSET_NAMES.map(downloadAsset)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadAsset</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">assetName</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> asset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(); asset.onload = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Downloaded </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${assetName}</span></span></span><span class="hljs-string">`</span></span>); assets[assetName] = asset; resolve(); }; asset.src = <span class="hljs-string"><span class="hljs-string">`/assets/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${assetName}</span></span></span><span class="hljs-string">`</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> downloadAssets = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> downloadPromise; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getAsset = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">assetName</span></span></span><span class="hljs-function"> =&gt;</span></span> assets[assetName];</code> </pre> <br>  рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдмрдВрдзрди рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЗрддрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИ!  рдореБрдЦреНрдп рдмрд┐рдВрджреБ <code>assets</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдирд╛ рд╣реИ, рдЬреЛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдХреБрдВрдЬреА рдХреЛ <code>Image</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдореВрд▓реНрдп рдореЗрдВ рдмрд╛рдВрдз рджреЗрдЧрд╛ред  рдЬрдм рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЗрд╕реЗ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рддреНрд╡рд░рд┐рдд рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рд▓рд┐рдП <code>assets</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВред  рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдПрдЧреА (рдЕрд░реНрдерд╛рдд, <strong>рд╕рднреА</strong> рд╕рдВрд╕рд╛рдзрди рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ), рд╣рдо <code>downloadPromise</code> рд╕рдХреНрд╖рдо рдХрд░рддреЗ рд╣реИрдВред <br><br>  рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рдкреНрд░рддрд┐рдкрд╛рджрди рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рд╡реЗрдм рдкреЗрдЬ рдкрд░ рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдЪрдЯреАрдПрдордПрд▓ 5 рдХреИрдирд╡рд╕</a> ( <code>&lt;canvas&gt;</code> ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рд╣рдорд╛рд░рд╛ рдЦреЗрд▓ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдмрд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <br><br><ol><li>  рдкреГрд╖реНрдарднреВрдорд┐ </li><li>  рдЦрд┐рд▓рд╛рдбрд╝реА рдЬрд╣рд╛рдЬ </li><li>  рдЦреЗрд▓ рдореЗрдВ рдЕрдиреНрдп рдЦрд┐рд▓рд╛рдбрд╝реА </li><li>  рдЧреЛрд▓рд╛рдмрд╛рд░реВрдж </li></ol><br>  рдпрд╣рд╛рдБ <code>src/client/render.js</code> рдХреЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрдирд┐рдкреЗрдЯ рджрд┐рдП рдЧрдП рд╣реИрдВ рдЬреЛ рдКрдкрд░ рд╕реВрдЪреАрдмрджреНрдз рдЪрд╛рд░ рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реИрдВ: <br><br><h5>  render.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getAsset } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./assets'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getCurrentState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./state'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { PLAYER_RADIUS, PLAYER_MAX_HP, BULLET_RADIUS, MAP_SIZE } = Constants; <span class="hljs-comment"><span class="hljs-comment">// Get the canvas graphics context const canvas = document.getElementById('game-canvas'); const context = canvas.getContext('2d'); // Make the canvas fullscreen canvas.width = window.innerWidth; canvas.height = window.innerHeight; function render() { const { me, others, bullets } = getCurrentState(); if (!me) { return; } // Draw background renderBackground(me.x, me.y); // Draw all bullets bullets.forEach(renderBullet.bind(null, me)); // Draw all players renderPlayer(me, me); others.forEach(renderPlayer.bind(null, me)); } // ... Helper functions here excluded let renderInterval = null; export function startRendering() { renderInterval = setInterval(render, 1000 / 60); } export function stopRendering() { clearInterval(renderInterval); }</span></span></code> </pre> <br>  <i>рдЗрд╕ рдХреЛрдб рдХреЛ рд╕реНрдкрд╖реНрдЯрддрд╛ рдХреЗ рд▓рд┐рдП рднреА рдЫреЛрдЯрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</i> <br><br>  <code>render()</code> рдЗрд╕ рдлрд╛рдЗрд▓ рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░реНрдп рд╣реИред  <code>startRendering()</code> рдФрд░ <code>stopRendering()</code> 60 FPS рдкрд░ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдЪрдХреНрд░ рдХреА рд╕рдХреНрд░рд┐рдпрддрд╛ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред <br><br>  рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╕рд╣рд╛рдпрдХ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди (рдЙрджрд╛ред <code>renderBullet()</code> ) рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рдПрдХ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рд╣реИ: <br><br><h5>  render.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderBullet</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">me, bullet</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { x, y } = bullet; context.drawImage( getAsset(<span class="hljs-string"><span class="hljs-string">'bullet.svg'</span></span>), canvas.width / <span class="hljs-number"><span class="hljs-number">2</span></span> + x - me.x - BULLET_RADIUS, canvas.height / <span class="hljs-number"><span class="hljs-number">2</span></span> + y - me.y - BULLET_RADIUS, BULLET_RADIUS * <span class="hljs-number"><span class="hljs-number">2</span></span>, BULLET_RADIUS * <span class="hljs-number"><span class="hljs-number">2</span></span>, ); }</code> </pre> <br>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдо <code>getAsset()</code> рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ <code>asset.js</code> рдореЗрдВ рджреЗрдЦрд╛ рдЧрдпрд╛ рдерд╛ред <code>asset.js</code> ! <br><br><blockquote>  рдпрджрд┐ рдЖрдк рдЕрдиреНрдп рд╕рд╣рд╛рдпрдХ рдкреНрд░рддрд┐рдкрд╛рджрди рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдмрд╛рдХреА <a href="">src / client / render.js рдкрдврд╝реЗрдВ</a> ред </blockquote><br><h2>  6. рдЧреНрд░рд╛рд╣рдХ рдЗрдирдкреБрдЯ </h2><br>  рдпрд╣ рдЦреЗрд▓ рдХреЛ <em>рдЦреЗрд▓рдиреЗ рдпреЛрдЧреНрдп</em> рдмрдирд╛рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ!  рдирд┐рдпрдВрддреНрд░рдг рдпреЛрдЬрдирд╛ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реЛрдЧреА: рдЖрдк рдорд╛рдЙрд╕ (рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдВрджреЛрд▓рди рдХреА рджрд┐рд╢рд╛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░реАрди (рдореЛрдмрд╛рдЗрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░) рдХреЛ рдЫреВ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдорд╛рдЙрд╕ рдФрд░ рдЯрдЪ рдИрд╡реЗрдВрдЯ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╡реЗрдВрдЯ рд╢реНрд░реЛрддрд╛рдУрдВ</a> рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВрдЧреЗред <br>  <code>src/client/input.js</code> рдпрд╣ рд╕рдм рдХрд░реЗрдЧрд╛: <br><br><h5>  input.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { updateDirection } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./networking'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMouseInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ handleInput(e.clientX, e.clientY); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouchInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> touch = e.touches[<span class="hljs-number"><span class="hljs-number">0</span></span>]; handleInput(touch.clientX, touch.clientY); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x, y</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dir = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.atan2(x - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth / <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight / <span class="hljs-number"><span class="hljs-number">2</span></span> - y); updateDirection(dir); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startCapturingInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'mousemove'</span></span>, onMouseInput); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'touchmove'</span></span>, onTouchInput); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stopCapturingInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.removeEventListener(<span class="hljs-string"><span class="hljs-string">'mousemove'</span></span>, onMouseInput); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.removeEventListener(<span class="hljs-string"><span class="hljs-string">'touchmove'</span></span>, onTouchInput); }</code> </pre> <br>  <code>onMouseInput()</code> рдФрд░ <code>onTouchInput()</code> рдИрд╡реЗрдВрдЯ рд╢реНрд░реЛрддрд╛ рд╣реИрдВ рдЬреЛ рдПрдХ рдЗрдирдкреБрдЯ рдИрд╡реЗрдВрдЯ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рдорд╛рдЙрд╕ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ) рддрдм <code>updateDirection()</code> ( <code>updateDirection()</code> рд╕реЗ <code>updateDirection()</code> рдХреЙрд▓ <code>updateDirection()</code> ред  <code>updateDirection()</code> рдПрдХ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдореИрд╕реЗрдЬрд┐рдВрдЧ рдореЗрдВ рд▓рдЧрд╛ рд╣реБрдЖ рд╣реИ рдЬреЛ рдЗрдирдкреБрдЯ рдИрд╡реЗрдВрдЯ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реА рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЧреЗрдо рд╕реНрдЯреЗрдЯ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддрд╛ рд╣реИред <br><br><h2>  7. рдЧреНрд░рд╛рд╣рдХ рдХреА рд╕реНрдерд┐рддрд┐ </h2><br><blockquote>  рдпрд╣ рдЕрдиреБрднрд╛рдЧ рдкреЛрд╕реНрдЯ рдХреЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ рд╕рдмрд╕реЗ рдХрдард┐рди рд╣реИред  рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдкрд╣рд▓реЗ рдкрдврд╝рдиреЗ рд╕реЗ рдирд╣реАрдВ рд╕рдордЭрддреЗ рд╣реИрдВ, рддреЛ рдирд┐рд░рд╛рд╢ рди рд╣реЛрдВ!  рдЖрдк рдЗрд╕реЗ рдЫреЛрдбрд╝ рднреА рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдмрд╛рдж рдореЗрдВ рд╡рд╛рдкрд╕ рдЖ рд╕рдХрддреЗ рд╣реИрдВред </blockquote><br>  рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдХреЛрдб рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдкрд╣реЗрд▓реА рдХрд╛ рдЕрдВрддрд┐рдо рдЯреБрдХрдбрд╝рд╛ <strong>рд░рд╛рдЬреНрдп рд╣реИ</strong> ред  рдХреНрд▓рд╛рдЗрдВрдЯ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдЕрдиреБрднрд╛рдЧ рд╕реЗ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдпрд╛рдж рд░рдЦреЗрдВ? <br><br><h5>  render.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getCurrentState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./state'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { me, others, bullets } = getCurrentState(); <span class="hljs-comment"><span class="hljs-comment">// Do the rendering // ... }</span></span></code> </pre> <br>  <code>getCurrentState()</code> рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдЕрдкрдбреЗрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ <strong>рдХрд┐рд╕реА рднреА рд╕рдордп</strong> рдХреНрд▓рд╛рдЗрдВрдЯ <strong>рдореЗрдВ</strong> рдЧреЗрдо рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рд╣рдореЗрдВ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣рд╛рдБ рдПрдХ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬреЛ рдПрдХ рд╕рд░реНрд╡рд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs">{ <span class="hljs-string"><span class="hljs-string">"t"</span></span>: <span class="hljs-number"><span class="hljs-number">1555960373725</span></span>, <span class="hljs-string"><span class="hljs-string">"me"</span></span>: { <span class="hljs-string"><span class="hljs-string">"x"</span></span>: <span class="hljs-number"><span class="hljs-number">2213.8050880413657</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span>: <span class="hljs-number"><span class="hljs-number">1469.370893425012</span></span>, <span class="hljs-string"><span class="hljs-string">"direction"</span></span>: <span class="hljs-number"><span class="hljs-number">1.3082443894581433</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"AhzgAtklgo2FJvwWAADO"</span></span>, <span class="hljs-string"><span class="hljs-string">"hp"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> }, <span class="hljs-string"><span class="hljs-string">"others"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"bullets"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"RUJfJ8Y18n"</span></span>, <span class="hljs-string"><span class="hljs-string">"x"</span></span>: <span class="hljs-number"><span class="hljs-number">2354.029197099604</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span>: <span class="hljs-number"><span class="hljs-number">1431.6848318262666</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"ctg5rht5s"</span></span>, <span class="hljs-string"><span class="hljs-string">"x"</span></span>: <span class="hljs-number"><span class="hljs-number">2260.546457727445</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span>: <span class="hljs-number"><span class="hljs-number">1456.8088728920968</span></span> } ], <span class="hljs-string"><span class="hljs-string">"leaderboard"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"Player"</span></span>, <span class="hljs-string"><span class="hljs-string">"score"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> } ] }</code> </pre> <br>  рдкреНрд░рддреНрдпреЗрдХ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдореЗрдВ рдкрд╛рдБрдЪ рд╕рдорд╛рди рдлрд╝реАрд▓реНрдб рд╣реЛрддреЗ рд╣реИрдВ: <br><br><ul><li>  <strong>t</strong> : рдпрд╣ рдЕрджреНрдпрддрди рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЙрд╕ рд╕рдордп рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкред </li><li>  <strong>рдореБрдЭреЗ</strong> : рдЗрд╕ рдЕрдкрдбреЗрдЯ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реАред </li><li>  <strong>рдЕрдиреНрдп</strong> : рдПрдХ рд╣реА рдЦреЗрд▓ рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреНрдп рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдПрдХ рд╕рд░рдгреАред </li><li>  <strong>рдЧреЛрд▓рд┐рдпреЛрдВ</strong> : рдЦреЗрд▓ рдореЗрдВ рдЧреЛрд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдПрдХ рд╕рд░рдгреАред </li><li>  <strong>рд▓реАрдбрд░рдмреЛрд░реНрдб</strong> : рд╡рд░реНрддрдорд╛рди рд▓реАрдбрд░рдмреЛрд░реНрдб рдбреЗрдЯрд╛ред  рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдзреНрдпрд╛рди рдореЗрдВ рдирд╣реАрдВ рд▓реЗрдВрдЧреЗред </li></ul><br><h3>  7.1 рдЧреНрд░рд╛рд╣рдХ рдХреА рдЕрдиреБрднрд╡рд╣реАрди рдЕрд╡рд╕реНрдерд╛ </h3><br>  <code>getCurrentState()</code> рдХрд╛ рднреЛрд▓реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗрд╡рд▓ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдЧреЗрдо рдЕрдкрдбреЗрдЯ рд╕реЗ рд╕реАрдзреЗ рдбреЗрдЯрд╛ рд▓реМрдЯрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><h5>  рднреЛрд▓реА-state.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lastGameUpdate = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Handle a newly received game update. export function processGameUpdate(update) { lastGameUpdate = update; } export function getCurrentState() { return lastGameUpdate; }</span></span></code> </pre> <br>  рд╕реБрдВрджрд░ рдФрд░ рд╕реНрдкрд╖реНрдЯ!  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╕рдм рдХреБрдЫ рдЗрддрдирд╛ рд╕рд░рд▓ рдерд╛ред  рдЗрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдХрд╛рд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд рд╣реИ: <strong>рдпрд╣ рд╕рд░реНрд╡рд░ рдШрдбрд╝реА рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЛ рд░реЗрдВрдбрд░ рдХреА рдлреНрд░реЗрдо рджрд░ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ</strong> ред <br><br><blockquote>  <strong>рдлреНрд░реЗрдо рджрд░</strong> : <strong>рдлреНрд░реЗрдо</strong> рдХреА рд╕рдВрдЦреНрдпрд╛ (рдпрд╛рдиреА <code>render()</code> рдХреЙрд▓) рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдпрд╛ рдПрдлрдкреАрдПрд╕ред  рдЦреЗрд▓ рдЖрдорддреМрд░ рдкрд░ рдХрдо рд╕реЗ рдХрдо 60 рдПрдлрдкреАрдПрд╕ рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╣реИрдВред </blockquote><br><blockquote>  <strong>рдЯрд┐рдХ рджрд░</strong> : рд╡рд╣ рдЖрд╡реГрддреНрддрд┐ рдЬрд┐рд╕ рдкрд░ рд╕рд░реНрд╡рд░ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред  <strong>рдЕрдХреНрд╕рд░ рдпрд╣ рдлреНрд░реЗрдо рджрд░ рд╕реЗ рдХрдо рд╣реЛрддрд╛ рд╣реИ</strong> ред  рд╣рдорд╛рд░реЗ рдЦреЗрд▓ рдореЗрдВ, рд╕рд░реНрд╡рд░ 30 рдЪрдХреНрд░ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдХреА рдЖрд╡реГрддреНрддрд┐ рдкрд░ рдЪрд▓рддрд╛ рд╣реИред </blockquote><br>  рдпрджрд┐ рд╣рдо рдЧреЗрдо рдХреЗ рдирд╡реАрдирддрдо рдЕрдкрдбреЗрдЯ рдХреЛ рдХреЗрд╡рд▓ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдПрдлрдкреАрдПрд╕ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХрднреА рднреА 30 рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдПрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ <em>рд╣рдореЗрдВ рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 30 рд╕реЗ рдЕрдзрд┐рдХ рдЕрдкрдбреЗрдЯ рдХрднреА рдирд╣реАрдВ рдорд┐рд▓рддреЗ рд╣реИрдВ</em> ред  рднрд▓реЗ рд╣реА рд╣рдо <code>render()</code> рдХреЙрд▓ рдХрд░рддреЗ <code>render()</code> рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 60 рдмрд╛рд░, рдЗрдирдореЗрдВ рд╕реЗ рдЖрдзреЗ рдХреЙрд▓ рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдЪреАрдЬрд╝ рдХреЛ рдлрд┐рд░ рд╕реЗ рдХрд░реЗрдВрдЧреЗ, рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рднреЛрд▓реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдПрдХ рдФрд░ рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕рдореЗрдВ <strong>рджреЗрд░реА рд╣реЛрдиреЗ</strong> рдХрд╛ <strong>рдЦрддрд░рд╛ рд╣реИ</strong> ред  рдПрдХ рдЖрджрд░реНрд╢ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реНрдкреАрдб рдХреЗ рд╕рд╛рде, рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╣рд░ 33 рдПрдордПрд╕ (рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 30) рдХрд╛ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдорд┐рд▓реЗрдЧрд╛: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc3/815/7c9/bc38157c91d436b5fedf948b60c8a213.svg"></div><br>  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдХреБрдЫ рднреА рд╕рд╣реА рдирд╣реАрдВ рд╣реИред  рдПрдХ рдЕрдзрд┐рдХ рдпрдерд╛рд░реНрдерд╡рд╛рджреА рдЪрд┐рддреНрд░ рд╣реЛрдЧрд╛: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/836/45f/75e/83645f75e556bc5c1c38111a69510734.svg"></div><br>  рдПрдХ рднреЛрд▓реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рд╣реИ рдЬрдм рдЗрд╕рдореЗрдВ рджреЗрд░реА рд╣реЛрддреА рд╣реИред  рдпрджрд┐ рдЧреЗрдо рдЕрдкрдбреЗрдЯ 50 рдПрдордПрд╕ рдХреА рджреЗрд░реА рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ <strong>рдХреНрд▓рд╛рдЗрдВрдЯ</strong> рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд 50 рдПрдордПрд╕ рдХреЗ рд▓рд┐рдП <strong>рдзреАрдорд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ</strong> , рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрднреА рднреА рдкрд┐рдЫрд▓реЗ рдЕрдкрдбреЗрдЯ рд╕реЗ рдЧреЗрдо рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдкреНрд░рддрд┐рдкрд╛рджрди рдХрд░рддрд╛ рд╣реИред  рдЖрдк рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рд▓рд┐рдП рдпрд╣ рдХрд┐рддрдирд╛ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ: рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ рдмреНрд░реЗрдХ рд▓рдЧрд╛рдиреЗ рдХреЗ рдХрд╛рд░рдг, рдЦреЗрд▓ рдЪрд┐рдХреЛрдЯреА рдФрд░ рдЕрд╕реНрдерд┐рд░ рдкреНрд░рддреАрдд рд╣реЛрдЧрд╛ред <br><br><h3>  7.2 рдЧреНрд░рд╛рд╣рдХ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕реБрдзрд╛рд░ </h3><br>  рд╣рдо рдЕрдиреБрднрд╡рд╣реАрди рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕реБрдзрд╛рд░ рдХрд░реЗрдВрдЧреЗред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо <strong>рдПрдХ</strong> 100 рдПрдордПрд╕ <strong>рд░реЗрдВрдбрд░рд┐рдВрдЧ рджреЗрд░реА рдХрд╛</strong> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА "рд╡рд░реНрддрдорд╛рди" рд╕реНрдерд┐рддрд┐ рд╣рдореЗрд╢рд╛ рд╕рд░реНрд╡рд░ рдкрд░ рдЧреЗрдо рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ 100 рдПрдордПрд╕ рд╕реЗ рдкреАрдЫреЗ рд░рд╣ рдЬрд╛рдПрдЧреАред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдордп <strong>150 рд╣реИ</strong> , рддреЛ рд╡рд╣ рд╕реНрдерд┐рддрд┐ рдЬрд┐рд╕рдореЗрдВ рд╕рд░реНрд╡рд░ <strong>50 рдХреЗ</strong> рд╕рдордп рдХрд╛ рдерд╛, рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/788/1b5/c78/7881b5c789321648ff1ff70d15b881d4.svg"></div><br>  рдпрд╣ рд╣рдореЗрдВ 100 рдПрдордПрд╕ рдХрд╛ рдмрдлрд░ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдореЗрдВ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕рдордп рддрдХ рдЬреАрд╡рд┐рдд рд░рд╣рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c1e/494/615/c1e4946159c599c7a2a9196968755e4b.svg"></div><br>  рдЗрд╕рдХреЗ рд▓рд┐рдП рднреБрдЧрддрд╛рди рдХрд░рдирд╛ 100 рдПрдордПрд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдХреА</a> рдирд┐рд░рдВрддрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рдЗрдирдкреБрдЯ рджреЗрд░реА (рдЗрдирдкреБрдЯ рд▓реИрдЧ) рд╣реЛрдЧрд╛</a> ред  рдпрд╣ рдЪрд┐рдХрдиреА рдЧреЗрдордкреНрд▓реЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдореВрд▓реА рдмрд▓рд┐рджрд╛рди рд╣реИ - рдЕрдзрд┐рдХрд╛рдВрд╢ рдЦрд┐рд▓рд╛рдбрд╝реА (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЖрдХрд╕реНрдорд┐рдХ рд╡рд╛рд▓реЗ) рднреА рдЗрд╕ рджреЗрд░реА рдХреЛ рдиреЛрдЯрд┐рд╕ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред  рд▓реЛрдЧреЛрдВ рдХреЛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рджреЗрд░реА рдХреЗ рд╕рд╛рде рдЦреЗрд▓рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ 100 рдПрдордПрд╕ рдХреА рдирд┐рд░рдВрддрд░ рджреЗрд░реА рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИред <br><br><blockquote>  рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">"рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдлреЛрд░рдХрд╛рд╕реНрдЯрд┐рдВрдЧ"</a> рдирд╛рдордХ рдПрдХ рдЕрдиреНрдп рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">,</a> рдЬреЛ рдХрдерд┐рдд рджреЗрд░реА рдХреЛ рдХрдо рдХрд░рдиреЗ рдХрд╛ рдЕрдЪреНрдЫрд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </blockquote><br>  рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдФрд░ рд╕реБрдзрд╛рд░ <strong>рд░реИрдЦрд┐рдХ рдкреНрд░рдХреНрд╖реЗрдк рд╣реИ</strong> ред  рд╡рд┐рд▓рдВрдм рдХрд╛ рдкреНрд░рддрд┐рдкрд╛рджрди рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг, рд╣рдо рдЖрдорддреМрд░ рдкрд░ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рд╡рд░реНрддрдорд╛рди рд╕рдордп рдХреЛ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЕрдкрдбреЗрдЯ рд╕реЗ рдЖрдЧреЗ рдирд┐рдХрд▓ рдЬрд╛рддреЗ рд╣реИрдВред  рдЬрдм <code>getCurrentState()</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ рд╡рд░реНрддрдорд╛рди рд╕рдордп рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рддреБрд░рдВрдд рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдХреЗ рдмреАрдЪ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="noopener noreferrer">рд░реИрдЦрд┐рдХ рдкреНрд░рдХреНрд╖реЗрдк</a> рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ca/1c8/91c/2ca1c891ce7db0341dc78c2f88e16ce4.svg"></div><br>  рдпрд╣ рдлреНрд░реЗрдо рджрд░ рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ: рдЕрдм рд╣рдо рдХрд┐рд╕реА рднреА рдЖрд╡реГрддреНрддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рд╕рд╛рде рдЕрджреНрд╡рд┐рддреАрдп рдлреНрд░реЗрдо рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ! <br><br><h3>  7.3 рдПрдиреНрд╣рд╛рдВрд╕реНрдб рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реНрдерд┐рддрд┐ рд▓рд╛рдЧреВ рдХрд░рдирд╛ </h3><br>  <code>src/client/state.js</code> рдореЗрдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд░реЗрдВрдбрд░рд┐рдВрдЧ рджреЗрд░реА рдФрд░ рд░реИрдЦрд┐рдХ рдкреНрд░рдХреНрд╖реЗрдк рджреЛрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдирд╣реАрдВ рд╣реИред  рдХреЛрдб рдХреЛ рджреЛ рднрд╛рдЧреЛрдВ рдореЗрдВ рддреЛрдбрд╝рддреЗ рд╣реИрдВред  рдпрд╣рд╛рдБ рдкрд╣рд▓реЗ рдПрдХ рд╣реИ: <br><br><h5>  State.js рднрд╛рдЧ 1 </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> RENDER_DELAY = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gameUpdates = []; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gameStart = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstServerTimestamp = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ gameStart = <span class="hljs-number"><span class="hljs-number">0</span></span>; firstServerTimestamp = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processGameUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">update</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!firstServerTimestamp) { firstServerTimestamp = update.t; gameStart = <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now(); } gameUpdates.push(update); <span class="hljs-comment"><span class="hljs-comment">// Keep only one game update before the current server time const base = getBaseUpdate(); if (base &gt; 0) { gameUpdates.splice(0, base); } } function currentServerTime() { return firstServerTimestamp + (Date.now() - gameStart) - RENDER_DELAY; } // Returns the index of the base update, the first game update before // current server time, or -1 if N/A. function getBaseUpdate() { const serverTime = currentServerTime(); for (let i = gameUpdates.length - 1; i &gt;= 0; i--) { if (gameUpdates[i].t &lt;= serverTime) { return i; } } return -1; }</span></span></code> </pre> <br>  рдкрд╣рд▓рд╛ рдХрджрдо рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реИ рдХрд┐ <code>currentServerTime()</code> рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рджреЗрдЦрд╛, рд╣рд░ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдореЗрдВ рдПрдХ рд╕рд░реНрд╡рд░ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред  рд╣рдо рд╕рд░реНрд╡рд░ рдХреЗ рдкреАрдЫреЗ рдЫрд╡рд┐ 100 рдПрдордПрд╕ рдХреЛ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░реЗрдВрдбрд░рд┐рдВрдЧ рджреЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди <strong>рд╣рдо рдХрднреА рднреА рд╕рд░реНрд╡рд░ рдкрд░ рд╡рд░реНрддрдорд╛рди рд╕рдордп рдХреЛ рдирд╣реАрдВ рдЬрд╛рди рдкрд╛рдПрдВрдЧреЗ</strong> , рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдпрд╣ рдирд╣реАрдВ рдЬрд╛рди рд╕рдХрддреЗ рдХрд┐ рдХреЛрдИ рднреА рдЕрдкрдбреЗрдЯ рд╣рдореЗрдВ рдХрдм рддрдХ рдорд┐рд▓рд╛ред  рдЗрдВрдЯрд░рдиреЗрдЯ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╣реИ рдФрд░ рдЗрд╕рдХреА рдЧрддрд┐ рдмрд╣реБрдд рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИ! <br><br>  рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдПрдХ рдЙрдЪрд┐рдд рдЕрдиреБрдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рд╣рдо рдЗрд╕ рдмрд╛рдд рдХрд╛ <strong>рдвреЛрдВрдЧ</strong> рдХрд░реЗрдВрдЧреЗ <strong>рдХрд┐ рдкрд╣рд▓рд╛ рдЕрдкрдбреЗрдЯ рддреБрд░рдВрдд рдЖ рдЧрдпрд╛</strong> ред  рдпрджрд┐ рдпрд╣ рд╕рдЪ рд╣реЛрддрд╛, рддреЛ рд╣рдореЗрдВ рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рд╕рдордп рдореЗрдВ рд╕рд░реНрд╡рд░ рдХрд╛ рд╕рдордп рдкрддрд╛ рд╣реЛрддрд╛!  рд╣рдо рдкрд╣рд▓реЗ рд╕рд░реНрд╡рд░ рдореЗрдВ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЛ рд╕реЗрд╡ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ <code>firstServerTimestamp</code> рдореЗрдВ рдЙрд╕реА рд╕рдордп рдЕрдкрдиреЗ <strong>рд▓реЛрдХрд▓</strong> (рдХреНрд▓рд╛рдЗрдВрдЯ) рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЛ <code>gameStart</code> ред <br><br>  рдУрд╣ рд░реБрдХреЛред  <b>рдХреНрдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ рд╕рд░реНрд╡рд░ = рд╕рдордп рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП?</b>  рд╣рдо "рд╕рд░реНрд╡рд░ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк" рдФрд░ "рдХреНрд▓рд╛рдЗрдВрдЯ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк" рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреНрдпреЛрдВ рдХрд░рддреЗ рд╣реИрдВ?  рдпрд╣ рдПрдХ рдорд╣рд╛рди рдкреНрд░рд╢реНрди рд╣реИ!  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдпрд╣ рдПрдХ рд╣реА рдмрд╛рдд рдирд╣реАрдВ рд╣реИред  <code>Date.now()</code> рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рд▓реМрдЯрд╛рдПрдЧрд╛, рдФрд░ рдпрд╣ рдЗрди рдорд╢реАрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рдХрд╛рд░рдХреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  <strong>рдпрд╣ рдХрднреА рди рдорд╛рдиреЗрдВ рдХрд┐ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рд╕рднреА рдорд╢реАрдиреЛрдВ рдкрд░ рд╕рдорд╛рди рд╣реИрдВред</strong> <br><br>  рдЕрдм рд╣рдо рд╕рдордЭрддреЗ рд╣реИрдВ рдХрд┐ <code>currentServerTime()</code> рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ: рдпрд╣ <strong>рд╡рд░реНрддрдорд╛рди рд░реЗрдВрдбрд░рд┐рдВрдЧ рд╕рдордп рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдХрд╛ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк</strong> рд▓реМрдЯрд╛рддрд╛ рд╣реИред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╕рд░реНрд╡рд░ рд╕рдордп рд╣реИ ( </font></font><code>firstServerTimestamp &lt;+ (Date.now() - gameStart)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рдЛрдг рджреЗрдиреЗ рдореЗрдВ рджреЗрд░реА ( </font></font><code>RENDER_DELAY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдХреЛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рддреЗ рд╣реИрдВред рдЬрдм рд╕рд░реНрд╡рд░ рд╕реЗ рдХреЛрдИ рдЕрдкрдбреЗрдЯ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>processGameUpdate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рд╣рдо рдирдП рдЕрдкрдбреЗрдЯ рдХреЛ рдПрдХ рдЕрд░реИ рдореЗрдВ рд╕реЗрд╡ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>gameUpdates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдлрд┐рд░, рдореЗрдореЛрд░реА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рднреА рдкреБрд░рд╛рдиреЗ рдЕрдкрдбреЗрдЯ рдХреЛ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдзрд╛рд░ рдЕрдкрдбреЗрдЯ рдореЗрдВ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рдЕрдм рд╣рдореЗрдВ рдЙрдирдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ "рдмреБрдирд┐рдпрд╛рджреА рдЕрджреНрдпрддрди" рдХреНрдпрд╛ рд╣реИ? рдпрд╣ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдЕрдкрдбреЗрдЯ рд╣реИ рдЬреЛ рд╣рдо рд╡рд░реНрддрдорд╛рди рд╕рд░реНрд╡рд░ рд╕рдордп рд╕реЗ рдкреАрдЫреЗ рдХреА рдУрд░ рдмрдврд╝рддреЗ рд╣реБрдП рдкрд╛рддреЗ рд╣реИрдВ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдЗрд╕ рд╕рд░реНрдХрд┐рдЯ рдХреЛ рдпрд╛рдж рд░рдЦреЗрдВ?</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ca/1c8/91c/2ca1c891ce7db0341dc78c2f88e16ce4.svg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрд▓рд╛рдЗрдВрдЯ рд░реЗрдВрдбрд░ рдЯрд╛рдЗрдо рдХреЗ рдмрд╛рдИрдВ рдУрд░ рд╕реАрдзреЗ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдПрдХ рдмреБрдирд┐рдпрд╛рджреА рдЕрдкрдбреЗрдЯ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореВрд▓ рдЕрджреНрдпрддрди рдХрд┐рд╕рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ? </font><font style="vertical-align: inherit;">рд╣рдо рдЖрдзрд╛рд░ рд╕реЗ рдЕрдкрдбреЗрдЯ рдХреНрдпреЛрдВ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ? </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рджреЗрдЦреЗрдВ </font></font><code>getCurrentState()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> state.js рднрд╛рдЧ 2 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!firstServerTimestamp) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {}; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> base = getBaseUpdate(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> serverTime = currentServerTime(); <span class="hljs-comment"><span class="hljs-comment">// If base is the most recent update we have, use its state. // Else, interpolate between its state and the state of (base + 1). if (base &lt; 0) { return gameUpdates[gameUpdates.length - 1]; } else if (base === gameUpdates.length - 1) { return gameUpdates[base]; } else { const baseUpdate = gameUpdates[base]; const next = gameUpdates[base + 1]; const r = (serverTime - baseUpdate.t) / (next.t - baseUpdate.t); return { me: interpolateObject(baseUpdate.me, next.me, r), others: interpolateObjectArray(baseUpdate.others, next.others, r), bullets: interpolateObjectArray(baseUpdate.bullets, next.bullets, r), }; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рддреАрди рдорд╛рдорд▓реЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рддреЗ рд╣реИрдВ: </font></font><br><br><ol><li> <code>base &lt; 0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдореМрдЬреВрджрд╛ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдЯрд╛рдЗрдо (рдКрдкрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рджреЗрдЦреЗрдВ </font></font><code>getBaseUpdate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рдХреЛрдИ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рд╡рд┐рд▓рдВрдм рдХреЗ рдкреНрд░рддрд┐рдкрд╛рджрди рдХреЗ рдХрд╛рд░рдг рдЦреЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕рд╣реА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рд╕рдмрд╕реЗ рд╣рд╛рд▓рд┐рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред</font></font></li><li> <code>base</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд╡реАрдирддрдо рдЕрдкрдбреЗрдЯ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рд▓рдВрдмрддрд╛ рдпрд╛ рдЦрд░рд╛рдм рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдХреЗ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд╡реАрдирддрдо рдЕрдкрдбреЗрдЯ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рд░реЗрдВрдбрд░рд┐рдВрдЧ рд╕рдордп рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдЕрдкрдбреЗрдЯ рд╣реИ, рддрд╛рдХрд┐ рдЖрдк </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдВрдЯрд░рдкреЛрд▓</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд░ рд╕рдХреЗрдВ </font><font style="vertical-align: inherit;">!</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рдХреБрдЫ рднреА рд░рд╣рддрд╛ </font></font><code>state.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИ рд╡рд╣ рд░реИрдЦрд┐рдХ рдкреНрд░рдХреНрд╖реЗрдк рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИ, рдЬреЛ рдПрдХ рд╕рд░рд▓ (рд▓реЗрдХрд┐рди рдЙрдмрд╛рдК) рдЧрдгрд┐рдд рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рд╕реНрд╡рдпрдВ рд╕реАрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕реЗ </font><a href="" rel="noopener noreferrer"><font style="vertical-align: inherit;">рдЧреАрдереВрдм</font></a></font><code>state.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ </font><font style="vertical-align: inherit;">рдЦреЛрд▓реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><a href="" rel="noopener noreferrer"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднрд╛рдЧ 2. рдмреИрдХреЗрдВрдб рд╕рд░реНрд╡рд░ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рд╣рдорд╛рд░реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.io рдЧреЗрдо рдЙрджрд╛рд╣рд░рдг рдХреЛ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓реЗ Node.js рдмреИрдХрдПрдВрдб рдХреЛ рджреЗрдЦреЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1. рд╕рд░реНрд╡рд░ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд┐рдВрджреБ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо Node.js рдХреЗ рд▓рд┐рдП рд▓реЛрдХрдкреНрд░рд┐рдп рд╡реЗрдм рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХреНрд╕рдкреНрд░реЗрд╕</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рд╣рдорд╛рд░реЗ рд╕рд░реНрд╡рд░ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд┐рдВрджреБ рдлрд╝рд╛рдЗрд▓ рджреНрд╡рд╛рд░рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ </font></font><code>src/server/server.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> server.js, рднрд╛рдЧ 1 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpack = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpackDevMiddleware = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-dev-middleware'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpackConfig = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../../webpack.dev.js'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Setup an Express server const app = express(); app.use(express.static('public')); if (process.env.NODE_ENV === 'development') { // Setup Webpack for development const compiler = webpack(webpackConfig); app.use(webpackDevMiddleware(compiler)); } else { // Static serve the dist/ folder in production app.use(express.static('dist')); } // Listen on port const port = process.env.PORT || 3000; const server = app.listen(port); console.log(`Server listening on port ${port}`);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ рд╣рдордиреЗ рд╡реЗрдмрдкреИрдХ рдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рдереА? </font><font style="vertical-align: inherit;">рдпрд╣ рд╡рд╣ рдЬрдЧрд╣ рд╣реИ рдЬрд╣рд╛рдВ рд╣рдо рдЕрдкрдиреЗ рд╡реЗрдмрдкреИрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд╣рдо рдЙрдиреНрд╣реЗрдВ рджреЛ рддрд░реАрдХреЛрдВ рд╕реЗ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗ:</font></font><br><br><ul><li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реЗрдмрдкреИрдХ-рджреЗрд╡-рдорд┐рдбрд▓рд╡реЗрдпрд░</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рд╡рд┐рдХрд╛рд╕ рдкреИрдХреЗрдЬреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреБрдирд░реНрдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВ, рдпрд╛</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реИрдзрд╛рдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ </font></font><code>dist/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рд╣рд╕реНрддрд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП Webpack рдЙрддреНрдкрд╛рджрди рдХреА рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рдмрд╛рдж рд╣рдорд╛рд░реА рдлрд╛рдЗрд▓реЗрдВ рд▓рд┐рдЦреЗрдЧрд╛ред</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрд╛рд░реНрдп </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">socket.io</font></a></font><code>server.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд░реНрд╡рд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдЬреЛ рдмрд╕ рдПрдХреНрд╕рдкреНрд░реЗрд╕ рд╕рд░реНрд╡рд░ рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ:</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> server.js, рднрд╛рдЧ 2 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> socketio = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'socket.io'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Setup Express // ... const server = app.listen(port); console.log(`Server listening on port ${port}`); // Setup socket.io const io = socketio(server); // Listen for socket.io connections io.on('connection', socket =&gt; { console.log('Player connected!', socket.id); socket.on(Constants.MSG_TYPES.JOIN_GAME, joinGame); socket.on(Constants.MSG_TYPES.INPUT, handleInput); socket.on('disconnect', onDisconnect); });</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕реЙрдХреЗрдЯ.рдЖрдИрдУ рдХрдиреЗрдХреНрд╢рди рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдирдП рд╕реЙрдХреЗрдЯ рдХреЗ рд▓рд┐рдП рдИрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдЧреНрд░рд╛рд╣рдХреЛрдВ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢ рдХреЛ рд╕рд┐рдВрдЧрд▓рдЯрди рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ рднреЗрдЬрддреЗ рд╣реИрдВ </font></font><code>game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> server.js, рднрд╛рдЧ 3 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Game = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./game'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ... // Setup the Game const game = new Game(); function joinGame(username) { game.addPlayer(this, username); } function handleInput(dir) { game.handleInput(this, dir); } function onDisconnect() { game.removePlayer(this); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо .io рд╢реИрд▓реА рдХрд╛ рдПрдХ рдЧреЗрдо рдмрдирд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдЙрджрд╛рд╣рд░рдг </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">("рдЧреЗрдо") рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ - рд╕рднреА рдЦрд┐рд▓рд╛рдбрд╝реА рдПрдХ рд╣реА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЦреЗрд▓рддреЗ рд╣реИрдВ! </font><font style="vertical-align: inherit;">рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдпрд╣ рд╡рд░реНрдЧ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2. рдЦреЗрд▓ рд╕рд░реНрд╡рд░ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрд▓рд╛рд╕ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд▓реЙрдЬрд┐рдХ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рджреЛ рдореБрдЦреНрдп рдХрд╛рд░реНрдп рд╣реИрдВ: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝реА рдкреНрд░рдмрдВрдзрди</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЗрд▓ рд╕рд┐рдореБрд▓реЗрд╢рди</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝реА рдкреНрд░рдмрдВрдзрди рдХреЗ рд╕рд╛рде - рд╣рдо рдкрд╣рд▓реЗ рдХрд╛рд░реНрдп рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> game.js, рднрд╛рдЧ 1 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Player = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./player'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sockets = {}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.players = {}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bullets = []; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lastUpdateTime = <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.shouldSendUpdate = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; setInterval(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.update.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>), <span class="hljs-number"><span class="hljs-number">1000</span></span> / <span class="hljs-number"><span class="hljs-number">60</span></span>); } addPlayer(socket, username) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sockets[socket.id] = socket; <span class="hljs-comment"><span class="hljs-comment">// Generate a position to start this player at. const x = Constants.MAP_SIZE * (0.25 + Math.random() * 0.5); const y = Constants.MAP_SIZE * (0.25 + Math.random() * 0.5); this.players[socket.id] = new Player(socket.id, username, x, y); } removePlayer(socket) { delete this.sockets[socket.id]; delete this.players[socket.id]; } handleInput(socket, dir) { if (this.players[socket.id]) { this.players[socket.id].setDirection(dir); } } // ... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдЧреЗрдо рдореЗрдВ, рд╣рдо рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдирдХреЗ рд╕реЙрдХреЗрдЯ рд╕реЙрдХреЗрдЯ </font><font style="vertical-align: inherit;">рдХреЗ рдХреНрд╖реЗрддреНрд░ рджреНрд╡рд╛рд░рд╛ </font><font style="vertical-align: inherit;">рдкрд╣рдЪрд╛рдиреЗрдВрдЧреЗред (рдпрджрд┐ рдЖрдк рднреНрд░рдорд┐рдд рд╣реИрдВ, рддреЛ рд╡рд╛рдкрд╕ рд▓реМрдЯреЗрдВ </font></font><code>server.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)ред </font><font style="vertical-align: inherit;">Socket.io рд╣реА рдкреНрд░рддреНрдпреЗрдХ рд╕реЙрдХреЗрдЯ рдХреЛ рдПрдХ рдЕрдиреЛрдЦрд╛ рдЕрд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИ </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдореИрдВ рдЙрдирдХреА </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝реА рдЖрдИрдбреА</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдХреЙрд▓ рдХрд░реВрдВрдЧрд╛ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП, рдЖрдЗрдП рдХрдХреНрд╖рд╛ рдореЗрдВ рдЙрджрд╛рд╣рд░рдг рдЪрд░ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><ul><li> <code>sockets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдРрд╕реА рд╡рд╕реНрддреБ рд╣реИ рдЬреЛ рдЦрд┐рд▓рд╛рдбрд╝реА рдЖрдИрдбреА рдХреЛ рдЙрд╕ рд╕реЙрдХреЗрдЯ рд╕реЗ рдмрд╛рдВрдзрддреА рд╣реИ рдЬреЛ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╣рдореЗрдВ рд▓рдЧрд╛рддрд╛рд░ рд╕рдордп рдХреЗ рд▓рд┐рдП рдЙрдирдХреЗ рдЦрд┐рд▓рд╛рдбрд╝реА рдЖрдИрдбреА рджреНрд╡рд╛рд░рд╛ рд╕реЙрдХреЗрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</font></font></li><li> <code>players</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рд╡рд╕реНрддреБ рд╣реИ рдЬреЛ рдПрдХ рдЦрд┐рд▓рд╛рдбрд╝реА рдЖрдИрдбреА рдХреЛ рдХреЛрдб&gt; рдкреНрд▓реЗрдпрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдмрд╛рдВрдзрддреА рд╣реИ </font></font></li></ul><br> <code>bullets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╕реНрддреБрдУрдВ рдХреА рдПрдХ рд╕рд░рдгреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ </font></font><code>Bullet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рдо рдирд╣реАрдВ рд╣реИред </font></font><br> <code>lastUpdateTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдпрд╣ рдЙрд╕ рд╕рдордп рдХрд╛ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рд╣реИ рдЬрдм рдЧреЗрдо рдХреЛ рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЬрд▓реНрдж рд╣реА рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br> <code>shouldSendUpdate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рд╣рд╛рдпрдХ рдЪрд░ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЬрд▓реНрдж рд╣реА рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рджреЗрдЦреЗрдВрдЧреЗред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд░реАрдХреЗ </font></font><code>addPlayer()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>removePlayer()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>handleInput()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдордЭрд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ, рд╡реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>server.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдкрдХреЛ рдЕрдкрдиреА рд╕реНрдореГрддрд┐ рдХреЛ рддрд╛рдЬрд╝рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдереЛрдбрд╝реА рдЕрдзрд┐рдХ рдорд╛рддреНрд░рд╛ рдореЗрдВ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдБред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐ </font><font style="vertical-align: inherit;">рдЧреЗрдо </font><strong><font style="vertical-align: inherit;">рдЕрдкрдбреЗрдЯ рдЪрдХреНрд░</font></strong></font><code>constructor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╢реБрд░реВ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рддреА рд╣реИ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (60 рдЕрдкрдбреЗрдЯ / рдПрд╕ рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде):</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> game.js, рднрд╛рдЧ 2 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> applyCollisions = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./collisions'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... update() { // Calculate time elapsed const now = Date.now(); const dt = (now - this.lastUpdateTime) / 1000; this.lastUpdateTime = now; // Update each bullet const bulletsToRemove = []; this.bullets.forEach(bullet =&gt; { if (bullet.update(dt)) { // Destroy this bullet bulletsToRemove.push(bullet); } }); this.bullets = this.bullets.filter( bullet =&gt; !bulletsToRemove.includes(bullet), ); // Update each player Object.keys(this.sockets).forEach(playerID =&gt; { const player = this.players[playerID]; const newBullet = player.update(dt); if (newBullet) { this.bullets.push(newBullet); } }); // Apply collisions, give players score for hitting bullets const destroyedBullets = applyCollisions( Object.values(this.players), this.bullets, ); destroyedBullets.forEach(b =&gt; { if (this.players[b.parentID]) { this.players[b.parentID].onDealtDamage(); } }); this.bullets = this.bullets.filter( bullet =&gt; !destroyedBullets.includes(bullet), ); // Check if any players are dead Object.keys(this.sockets).forEach(playerID =&gt; { const socket = this.sockets[playerID]; const player = this.players[playerID]; if (player.hp &lt;= 0) { socket.emit(Constants.MSG_TYPES.GAME_OVER); this.removePlayer(socket); } }); // Send a game update to each player every other time if (this.shouldSendUpdate) { const leaderboard = this.getLeaderboard(); Object.keys(this.sockets).forEach(playerID =&gt; { const socket = this.sockets[playerID]; const player = this.players[playerID]; socket.emit( Constants.MSG_TYPES.GAME_UPDATE, this.createUpdate(player, leaderboard), ); }); this.shouldSendUpdate = false; } else { this.shouldSendUpdate = true; } } // ... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрднрд╡рддрдГ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд▓реЙрдЬрд┐рдХ рдХрд╛ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрджреЗрд╢ рдореЗрдВ, рд╣рдо рд╡рд╣ рд╕рдм рдХреБрдЫ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рд╡рд╣ рдХрд░рддрд╛ рд╣реИ:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрдгрдирд╛ рдХрд░рддрд╛ </font></font><code>dt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИ рдХрд┐ рдЖрдЦрд┐рд░реА рдХреЗ рдмрд╛рдж </font><font style="vertical-align: inherit;">рдХрд┐рддрдирд╛ рд╕рдордп </font><font style="vertical-align: inherit;">рдмреАрдд рдЪреБрдХрд╛ рд╣реИ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li><li>        .      .    ,  <code>bullet.update()</code> <strong> <code>true</code> ,     </strong> (    ). </li><li>        .       тАФ <code>player.update()</code> <strong>   <code>Bullet</code></strong> . </li><li>         <code>applyCollisions()</code> ,    ,    .        ,    (  <code>player.onDealtDamage()</code> ),       <code>bullets</code> . </li><li>      . </li><li>      <strong> </strong>    <code>update()</code> .         <code>shouldSendUpdate</code> .   <code>update()</code>  60 /,     30 /.  , <strong> </strong>   30 / (       ). </li></ol><br><blockquote> <strong>     <em> </em> ?</strong>   . 30     тАУ   ! </blockquote><br><blockquote> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд┐рд░ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 30 рдмрд╛рд░ </font><font style="vertical-align: inherit;">рдХреЙрд▓ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ </font><font style="vertical-align: inherit;">? </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЗрд▓ рдХреЗ рд╕рд┐рдореБрд▓реЗрд╢рди рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рдмрд╛рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдЦреЗрд▓ рдХрд╛ рдЕрдиреБрдХрд░рдг рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдХреЙрд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рджреВрд░ рдордд рдЬрд╛рдУ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рдХрдореНрдкреНрдпреВрдЯреЗрд╢рдирд▓ рд░реВрдк рд╕реЗ рдорд╣рдВрдЧрд╛ рдХрд╛рдо рд╣реИ - 60 рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдХрд╛рдлреА рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдХреНрд╖рд╛ рдореЗрдВ рд╢реЗрд╖ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣рд╛рдпрдХ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> game.js, рднрд╛рдЧ 3 </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... getLeaderboard() { return Object.values(this.players) .sort((p1, p2) =&gt; p2.score - p1.score) .slice(0, 5) .map(p =&gt; ({ username: p.username, score: Math.round(p.score) })); } createUpdate(player, leaderboard) { const nearbyPlayers = Object.values(this.players).filter( p =&gt; p !== player &amp;&amp; p.distanceTo(player) &lt;= Constants.MAP_SIZE / 2, ); const nearbyBullets = this.bullets.filter( b =&gt; b.distanceTo(player) &lt;= Constants.MAP_SIZE / 2, ); return { t: Date.now(), me: player.serializeForUpdate(), others: nearbyPlayers.map(p =&gt; p.serializeForUpdate()), bullets: nearbyBullets.map(b =&gt; b.serializeForUpdate()), leaderboard, }; } }</span></span></code> </pre> <br> <code>getLeaderboard()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рдлреА рд╕рд░рд▓ - рдпрд╣ рдЕрдВрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рдЫрд╛рдБрдЯрддрд╛ рд╣реИ, рдкрд╛рдБрдЪ рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рд╕реНрдХреЛрд░ рдХреЗ рд▓рд┐рдП рд░рд┐рдЯрд░реНрди рджреЗрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЦреЗрд▓ рдЕрджреНрдпрддрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><br><br> <code>createUpdate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░реНрдп </font></font><code>serializeForUpdate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдХреНрд╖рд╛рдУрдВ </font></font><code>Player</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font><font style="vertical-align: inherit;">рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ </font><font style="vertical-align: inherit;">рддрд░реАрдХреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реИ </font></font><code>Bullet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╡рд╣ рдкреНрд░рддреНрдпреЗрдХ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рдХреЗрд╡рд▓ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдХрдЯрддрдо</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдФрд░ рдЧреЛрд▓реЗ </font><font style="vertical-align: inherit;">рдкрд░ рдбреЗрдЯрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">- рдЦрд┐рд▓рд╛рдбрд╝реА рд╕реЗ рджреВрд░ рд╕реНрдерд┐рдд рдЦреЗрд▓ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ!</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3. рд╕рд░реНрд╡рд░ рдкрд░ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдЦреЗрд▓ рдореЗрдВ, рдЧреЛрд▓реЗ рдФрд░ рдЦрд┐рд▓рд╛рдбрд╝реА рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИрдВ: рд╡реЗ рдЕрдореВрд░реНрдд рдЧреЛрд▓ рдЪрд▓рддреА рд╣реБрдИ рдЦреЗрд▓ рд╡рд╕реНрддреБрдПрдВ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдФрд░ рдЧреЛрд▓реЗ рдХреА рдЗрд╕ рд╕рдорд╛рдирддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рдЖрдзрд╛рд░ рд╡рд░реНрдЧ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВ </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> object.js </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(id, x, y, dir, speed) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.x = x; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.y = y; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.direction = dir; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.speed = speed; } update(dt) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.x += dt * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.speed * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.direction); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.y -= dt * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.speed * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.cos(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.direction); } distanceTo(object) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dx = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.x - object.x; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dy = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.y - object.y; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(dx * dx + dy * dy); } setDirection(dir) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.direction = dir; } serializeForUpdate() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id, <span class="hljs-attr"><span class="hljs-attr">x</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.x, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.y, }; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╡рд░реНрдЧ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдЪреНрдЫрд╛ рд╕рдВрджрд░реНрдн рдмрд┐рдВрджреБ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╡рд░реНрдЧ рдХреИрд╕реЗ </font></font><code>Bullet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bullet.js </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> shortid = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'shortid'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ObjectClass = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./object'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bullet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObjectClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(parentID, x, y, dir) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(shortid(), x, y, dir, Constants.BULLET_SPEED); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.parentID = parentID; } <span class="hljs-comment"><span class="hljs-comment">// Returns true if the bullet should be destroyed update(dt) { super.update(dt); return this.x &lt; 0 || this.x &gt; Constants.MAP_SIZE || this.y &lt; 0 || this.y &gt; Constants.MAP_SIZE; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </font></font><code>Bullet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╣реБрдд рдХрдо рд╣реИ! </font><font style="vertical-align: inherit;">рд╣рдордиреЗ </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреЛрдВ </font><font style="vertical-align: inherit;">рдХреЛ рдЬреЛрдбрд╝рд╛ </font><font style="vertical-align: inherit;">:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рдПрдХ </font><font style="vertical-align: inherit;">рдкреНрд░рдХреНрд╖реЗрдкреНрдп </font><font style="vertical-align: inherit;">рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдПрдХ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЫреЛрдЯреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝рдирд╛ </font></font><code>parentID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдЖрдк рдЙрд╕ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рдЯреНрд░реИрдХ рдХрд░ рд╕рдХреЗрдВ рдЬрд┐рд╕рдиреЗ рдпрд╣ рдкреНрд░реЛрдЬреЗрдХреНрдЯрд╛рдЗрд▓ рдмрдирд╛рдпрд╛ рд╣реИред</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рдкрд╕реА рдореВрд▓реНрдп рдЬреЛрдбрд╝рдирд╛ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ рдмрд░рд╛рдмрд░ рд╣реИ </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдкреНрд░рдХреНрд╖реЗрдкреНрдп рдХреНрд╖реЗрддреНрд░ рдХреЗ рдмрд╛рд╣рд░ рд╣реИ (рдпрд╛рдж рд░рдЦреЗрдВ, рд╣рдордиреЗ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА рдереА?)ред</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд▓реЛ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВ </font></font><code>Player</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> player.js </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ObjectClass = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./object'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Bullet = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./bullet'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Player</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObjectClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(id, username, x, y) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(id, x, y, <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.PI, Constants.PLAYER_SPEED); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username = username; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.hp = Constants.PLAYER_MAX_HP; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fireCooldown = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.score = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// Returns a newly created bullet, or null. update(dt) { super.update(dt); // Update score this.score += dt * Constants.SCORE_PER_SECOND; // Make sure the player stays in bounds this.x = Math.max(0, Math.min(Constants.MAP_SIZE, this.x)); this.y = Math.max(0, Math.min(Constants.MAP_SIZE, this.y)); // Fire a bullet, if needed this.fireCooldown -= dt; if (this.fireCooldown &lt;= 0) { this.fireCooldown += Constants.PLAYER_FIRE_COOLDOWN; return new Bullet(this.id, this.x, this.y, this.direction); } return null; } takeBulletDamage() { this.hp -= Constants.BULLET_DAMAGE; } onDealtDamage() { this.score += Constants.SCORE_BULLET_HIT; } serializeForUpdate() { return { ...(super.serializeForUpdate()), direction: this.direction, hp: this.hp, }; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦрд┐рд▓рд╛рдбрд╝реА рдЧреЛрд▓реЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рд╡рд░реНрдЧ рдореЗрдВ рдХреБрдЫ рдФрд░ рдХреНрд╖реЗрддреНрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛рдиреЗ рдЪрд╛рд╣рд┐рдПред рдЙрдирдХреА рдкрджреНрдзрддрд┐ </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╣реБрдд рдХрд╛рдо рдХрд░рддреА рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдирдП рдмрдирд╛рдП рдЧрдП рд╢реЗрд▓ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрддреА рд╣реИ рдЕрдЧрд░ рдпрд╣ рдирд╣реАрдВ рдЫреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>fireCooldown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдпрд╛рдж рд░рдЦреЗрдВ, рд╣рдордиреЗ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА рдереА?)ред рд╡рд╣ рд╡рд┐рдзрд┐ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рднреА рдХрд░рддрд╛ рд╣реИ </font></font><code>serializeForUpdate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдЧреЗрдо рдЕрдкрдбреЗрдЯ рдореЗрдВ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдлрд╝реАрд▓реНрдб рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><strong><font style="vertical-align: inherit;">рдХреЛрдб рд░рд┐рдкреАрдЯреЗрдмрд┐рд▓рд┐рдЯреА рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП </font></strong></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреЗрд╕ рдХреНрд▓рд╛рд╕ </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реЛрдирд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрджрдо рд╣реИ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд░реНрдЧ рдХреЗ рдмрд┐рдирд╛, </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд░ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдПрдХ рд╣реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП </font></font><code>distanceTo()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдХрдИ рдлрд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЗрди рд╕рднреА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдХреА рдХреЙрдкреА-рдкреЗрд╕реНрдЯ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдПрдХ рдмреБрд░рд╛ рд╕рдкрдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╡рд┐рд╕реНрддрд╛рд░ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рд╕рдВрдЦреНрдпрд╛ </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрдврд╝рдиреЗ рдкрд░ </font><strong><font style="vertical-align: inherit;">рдпрд╣ рдмрдбрд╝реА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рдЬрд╛рддрд╛</font></strong><font style="vertical-align: inherit;"> рд╣реИред</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4. рд╕рдВрдШрд░реНрд╖ рдорд╛рдиреНрдпрддрд╛ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рдЪреАрдЬ рдмрдЪреА рд╣реИ, рдЬрдм рдпрд╣ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛ рдХрд┐ рдЧреЛрд▓реЗ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рдХрд┐рд╕ рддрд░рд╣ рдорд╛рд░рддреЗ рд╣реИрдВ! </font></font><code>update()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╡рд░реНрдЧ рдореЗрдВ рдПрдХ </font><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рд╕реЗ рдХреЛрдб рдХрд╛ рдпрд╣ рдЯреБрдХрдбрд╝рд╛ рдпрд╛рдж рд░рдЦреЗрдВ </font></font><code>Game</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> game.js </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> applyCollisions = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./collisions'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... update() { // ... // Apply collisions, give players score for hitting bullets const destroyedBullets = applyCollisions( Object.values(this.players), this.bullets, ); destroyedBullets.forEach(b =&gt; { if (this.players[b.parentID]) { this.players[b.parentID].onDealtDamage(); } }); this.bullets = this.bullets.filter( bullet =&gt; !destroyedBullets.includes(bullet), ); // ... } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдПрдХ рдРрд╕рд╛ рддрд░реАрдХрд╛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ </font></font><code>applyCollisions()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рд╣рд┐рдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдЧреЛрд▓реЗ рд▓реМрдЯрд╛рдПред </font><font style="vertical-align: inherit;">рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдРрд╕рд╛ рдХрд░рдирд╛ рдЗрддрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рднреА рдЯрдХрд░рд╛рдиреЗ рд╡рд╛рд▓реА рд╡рд╕реНрддреБрдПрдВ рдордВрдбрд▓рд┐рдпрд╛рдВ рд╣реИрдВ, рдФрд░ рдЯрдХрд░рд╛рд╡ рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдмрд╕реЗ рд╕рд░рд▓ рдЖрдВрдХрдбрд╝рд╛ рд╣реИред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ </font></font><code>distanceTo()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдХрдХреНрд╖рд╛ рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ </font></font><code>Object</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣рд╛рдВ рд╣рдорд╛рд░реА рдЯрдХреНрдХрд░ рдорд╛рдиреНрдпрддрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ: </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collisions.js </font></font></h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Constants = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../shared/constants'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Returns an array of bullets to be destroyed. function applyCollisions(players, bullets) { const destroyedBullets = []; for (let i = 0; i &lt; bullets.length; i++) { // Look for a player (who didn't create the bullet) to collide each bullet with. // As soon as we find one, break out of the loop to prevent double counting a bullet. for (let j = 0; j &lt; players.length; j++) { const bullet = bullets[i]; const player = players[j]; if ( bullet.parentID !== player.id &amp;&amp; player.distanceTo(bullet) &lt;= Constants.PLAYER_RADIUS + Constants.BULLET_RADIUS ) { destroyedBullets.push(bullet); player.takeBulletDamage(); break; } } } return destroyedBullets; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕рд╛рдзрд╛рд░рдг рдЯрдХреНрдХрд░ рдХреА рдорд╛рдиреНрдпрддрд╛ рдЗрд╕ рддрдереНрдп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдХрд┐ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЛ рд╡реГрддреНрдд рдЯрдХрд░рд╛рддреЗ рд╣реИрдВ рдпрджрд┐ рдЙрдирдХреЗ рдХреЗрдВрджреНрд░реЛрдВ рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдЙрдирдХреЗ рд░реЗрдбреА рдХреЗ рдпреЛрдЧ рд╕реЗ рдХрдо рд╣реЛ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рдРрд╕рд╛ рдорд╛рдорд▓рд╛ рд╣реИ рдЬрдм рджреЛ рд╕рд░реНрдХрд▓ рдХреЗ рдХреЗрдВрджреНрд░реЛрдВ рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдЙрдирдХреЗ рд░реЗрдбреА рдХреЗ рдпреЛрдЧ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/63f/e73/2c8/63fe732c87ed1872522787e3cc4d5ab2.svg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдХреБрдЫ рдкрд╣рд▓реБрдУрдВ рдкрд░ рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рдХреНрд╖реЗрдкреНрдп рдЙрд╕ рдЦрд┐рд▓рд╛рдбрд╝реА рдореЗрдВ рдирд╣реАрдВ рдЧрд┐рд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдиреЗ рдЗрд╕реЗ рдмрдирд╛рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рддреБрд▓рдирд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ </font></font><code>bullet.parentID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рд╕рд╛рде </font></font><code>player.id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рдХреНрд╖реЗрдкреНрдп рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХрдИ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рде рдЯрдХрд░рд╛рд╡ рдХреЗ рдЪрд░рдо рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рд┐рдЯ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд╣рдо рдСрдкрд░реЗрдЯрд░ рдХреА рдорджрдж рд╕реЗ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдХрд░реЗрдВрдЧреЗ </font></font><code>break</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: рдЬреИрд╕реЗ рд╣реА рдПрдХ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдЙрд╕реЗ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯрд╛рдЗрд▓ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рд╛ рд╣реИ, рд╣рдо рдЦреЛрдЬ рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдЧрд▓реЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯрд╛рдЗрд▓ рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВред</font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдВрдд </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╣ рд╕рдм рд╣реИ! </font><font style="vertical-align: inherit;">рд╣рдордиреЗ рдПрдХ .io рд╡реЗрдм рдЧреЗрдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЬреЛ рдХреБрдЫ рднреА рдЬрд╛рдирдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЙрд╕реЗ рдХрд╡рд░ рдХрд┐рдпрд╛ рд╣реИред</font></font> рдЖрдЧреЗ рдХреНрдпрд╛ рд╣реИ? <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ .io рдЦреЗрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг! </font></font></strong> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рд╕реИрдВрдкрд▓ рдХреЛрдб рдУрдкрди рд╕реЛрд░реНрд╕ рд╣реИрдВ рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдиреНрд╣реЗрдВ рдЬреАрдердм</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдкреЛрд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi450574/">https://habr.com/ru/post/hi450574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi450556/index.html">рд╡рд╛рд▓реНрд╡ рдЗрдВрдбреЗрдХреНрд╕ - рдирдП рд╡реАрдЖрд░ рд╕реЗрдЯ рдХреА рд╕рдореАрдХреНрд╖рд╛</a></li>
<li><a href="../hi450564/index.html">рдЪрдордХ рдФрд░ рдЧрд░реАрдмреА: рдХреИрд╕реЗ рдбрд┐рдЬрд┐рдЯрд▓ рдХреНрд░рд╛рдВрддрд┐ рдиреЗ рд╕рдВрдЧреАрддрдХрд╛рд░реЛрдВ рдХреЛ рдЧрд░реАрдм рдмрдирд╛ рджрд┐рдпрд╛</a></li>
<li><a href="../hi450566/index.html">OutOfMemory рдФрд░ Android рд╕реНрдЯреВрдбрд┐рдпреЛ рдореЗрдВ рд╡реЗрдХреНрдЯрд░ рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ</a></li>
<li><a href="../hi450568/index.html">рдкреНрд░рддреНрдпреЗрдХ рдЬрд╣рд░ рдХреА рдЕрдкрдиреА рдорд╛рд░рдХ рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред рдХреИрд╕реЗ рдмрдЪрд╛рдПрдВ рдпрд╛ рдХрдо рд╕реЗ рдХрдо рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ (рдЕрдкрдбреЗрдЯ: рдШрд░реЗрд▓реВ рд╡рд┐рд╖рд╛рдХреНрддрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдВрдЯреАрдбреЛрдЯреНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ)</a></li>
<li><a href="../hi450572/index.html">рд╡рд┐рдВрдбреЛрдЬ 2012R2 рдХреЗ AD рдбреЛрдореЗрди рдореЗрдВ рдПрдХ рджреВрд╕рд░реЗ рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╛рдВрдмрд╛ рдбреАрд╕реА рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рдФрд░ рд▓рд┐рдирдХреНрд╕ рдкрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд░реЛрдорд┐рдВрдЧ рдлрд╝реЛрд▓реНрдбрд░</a></li>
<li><a href="../hi450576/index.html">рдореИрд╕реЗрдВрдЬрд░ рдЧреБрдордирд╛рдореА рдХреЗ рд▓рд┐рдП рдирдП рдирд┐рдпрдо</a></li>
<li><a href="../hi450578/index.html">рд╣рд╡рд╛ рдкрд░ рдХреНрдпрд╛ рд╕реБрдирд╛рдИ рджреЗрддрд╛ рд╣реИ? рд╣рдо рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╕рдВрдХреЗрддреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдФрд░ рдбрд┐рдХреЛрдб рдХрд░рддреЗ рд╣реИрдВред рднрд╛рдЧ 2, рд╡реАрдПрдЪрдПрдл</a></li>
<li><a href="../hi450582/index.html">PIM рд╕рд┐рджреНрдзрд╛рдВрдд</a></li>
<li><a href="../hi450586/index.html">рдлрд┐рд╢ рд░рд┐рдбрдХреНрд╕ - рд╕реНрдкрдВрджрди рдХреЗ рд▓рд┐рдП рдиреНрдпреВ рд░реЗрдбрдХреНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА</a></li>
<li><a href="../hi450592/index.html">рдЬрд░реНрдордиреА рдореЗрдВ, рдбреАрдЬрд▓ рдХрд╛рд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЗрд▓реЗрдХреНрдЯреНрд░рд┐рдХ рдХрд╛рд░ рдкрд░ рдпрд╛рддреНрд░рд╛ рдХрд░рдиреЗ рдХреА рд▓рд╛рдЧрдд рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>