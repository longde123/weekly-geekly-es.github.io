<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçµ üçä ü§ë Implanta√ß√µes autom√°ticas de can√°rios com Flagger e Istio üëçüèΩ üë©üèæ‚Äç‚öïÔ∏è üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O CD √© reconhecido como uma pr√°tica de desenvolvimento de software corporativo; √© o resultado de uma evolu√ß√£o natural dos princ√≠pios estabelecidos de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implanta√ß√µes autom√°ticas de can√°rios com Flagger e Istio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/444808/"><p><img src="https://habrastorage.org/webt/ol/eo/lt/oleoltogrvhcuhjuil5zmvmbpxi.png"></p><br><p>  O CD √© reconhecido como uma pr√°tica de desenvolvimento de software corporativo; √© o resultado de uma evolu√ß√£o natural dos princ√≠pios estabelecidos de IC.  No entanto, o CD ainda √© uma ocorr√™ncia bastante rara, possivelmente devido √† complexidade do gerenciamento e ao medo de implanta√ß√µes malsucedidas que afetam a disponibilidade do sistema. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Flagger</a> √© um operador Kubernetes de c√≥digo aberto que visa eliminar relacionamentos confusos.  Ele automatiza a promo√ß√£o de implanta√ß√µes de can√°rios usando desvios de tr√°fego do Istio e m√©tricas do Prometheus para analisar o comportamento do aplicativo durante a implementa√ß√£o gerenciada. </p><br><p>  Abaixo est√° um guia passo a passo sobre como configurar e usar o Flagger no Google Kubernetes Engine (GKE). </p><a name="habracut"></a><br><h3 id="nastroyka-klastera-kubernetes">  Configurar o cluster Kubernetes </h3><br><p>  Voc√™ come√ßa criando um cluster GKE com o suplemento Istio (se voc√™ n√£o possui uma conta GCP, pode se registrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> para receber cr√©ditos gratuitos). </p><br><p> Fa√ßa login no Google Cloud, crie um projeto e ative o faturamento.  Instale o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">utilit√°rio de</a> linha de comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gcloud</a> e personalize seu projeto com o <code>gcloud init</code> . </p><br><p>  Defina o projeto padr√£o, a √°rea de c√°lculo e a zona (substitua <code>PROJECT_ID</code> pelo seu projeto): </p><br><pre> <code class="plaintext hljs">gcloud config set project PROJECT_ID gcloud config set compute/region us-central1 gcloud config set compute/zone us-central1-a</code> </pre> <br><p>  Ative o servi√ßo GKE e crie um cluster com os complementos HPA e Istio: </p><br><pre> <code class="plaintext hljs">gcloud services enable container.googleapis.com K8S_VERSION=$(gcloud beta container get-server-config --format=json | jq -r '.validMasterVersions[0]') gcloud beta container clusters create istio \ --cluster-version=${K8S_VERSION} \ --zone=us-central1-a \ --num-nodes=2 \ --machine-type=n1-standard-2 \ --disk-size=30 \ --enable-autorepair \ --no-enable-cloud-logging \ --no-enable-cloud-monitoring \ --addons=HorizontalPodAutoscaling,Istio \ --istio-config=auth=MTLS_PERMISSIVE</code> </pre> <br><p>  O comando acima criar√° um conjunto de n√≥s padr√£o que inclui duas VMs <code>n1-standard-2</code> (vCPU: 2, RAM 7,5 GB, disco: 30 GB).  Idealmente, vale a pena isolar os componentes do Istio de suas cargas de trabalho, mas n√£o h√° maneira f√°cil de executar pods do Istio em um conjunto de n√≥s dedicado.  Os manifestos do Istio s√£o considerados somente leitura e o GKE desfaz todas as altera√ß√µes, como vincular a um n√≥ ou desconectar-se de uma lareira. </p><br><p>  Configure credenciais para o <code>kubectl</code> : </p><br><pre> <code class="plaintext hljs">gcloud container clusters get-credentials istio</code> </pre> <br><p>  Crie a liga√ß√£o da fun√ß√£o de administrador de cluster: </p><br><pre> <code class="plaintext hljs">kubectl create clusterrolebinding "cluster-admin-$(whoami)" \ --clusterrole=cluster-admin \ --user="$(gcloud config get-value core/account)"</code> </pre> <br><p>  Instale a ferramenta de linha de comando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Helm</a> : </p><br><pre> <code class="plaintext hljs">brew install kubernetes-helm</code> </pre> <br><p>  Agora, o Homebrew 2.0 tamb√©m est√° dispon√≠vel para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linux</a> . </p><br><p>  Crie uma conta de servi√ßo e uma liga√ß√£o de fun√ß√£o de cluster para o Tiller: </p><br><pre> <code class="plaintext hljs">kubectl -n kube-system create sa tiller &amp;&amp; \ kubectl create clusterrolebinding tiller-cluster-rule \ --clusterrole=cluster-admin \ --serviceaccount=kube-system:tiller</code> </pre> <br><p>  Expanda <code>kube-system</code> : </p><br><pre> <code class="plaintext hljs">helm init --service-account tiller</code> </pre> <br><p>  Voc√™ deve considerar o uso de SSL entre Helm e Tiller.  Para obter mais informa√ß√µes sobre como proteger uma instala√ß√£o Helm, consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">docs.helm.sh</a> </p><br><p>  Confirme as configura√ß√µes: </p><br><pre> <code class="plaintext hljs">kubectl -n istio-system get svc</code> </pre> <br><p>  Ap√≥s alguns segundos, o GCP deve atribuir um endere√ßo IP externo para o <code>istio-ingressgateway</code> . </p><br><h3 id="nastroyka-vhodnogo-shlyuza-istio">  Configura√ß√£o do Gateway de Entrada Istio </h3><br><p>  Crie um endere√ßo IP est√°tico chamado <code>istio-gateway</code> usando o endere√ßo IP do gateway Istio: </p><br><pre> <code class="plaintext hljs">export GATEWAY_IP=$(kubectl -n istio-system get svc/istio-ingressgateway -ojson | jq -r .status.loadBalancer.ingress[0].ip) gcloud compute addresses create istio-gateway --addresses ${GATEWAY_IP} --region us-central1</code> </pre> <br><p>  Agora voc√™ precisa de um dom√≠nio da Internet e acesso ao seu registrador DNS.  Adicione duas entradas A (substitua <code>example.com</code> pelo seu dom√≠nio): </p><br><pre> <code class="plaintext hljs">istio.example.com A ${GATEWAY_IP} *.istio.example.com A ${GATEWAY_IP}</code> </pre> <br><p>  Verifique se o curinga do DNS est√° funcionando: </p><br><pre> <code class="plaintext hljs">watch host test.istio.example.com</code> </pre> <br><p>  Crie um gateway comum do Istio para fornecer servi√ßos fora da malha de servi√ßo sobre HTTP: </p><br><pre> <code class="plaintext hljs">apiVersion: networking.istio.io/v1alpha3 kind: Gateway metadata: name: public-gateway namespace: istio-system spec: selector: istio: ingressgateway servers: - port: number: 80 name: http protocol: HTTP hosts: - "*"</code> </pre> <br><p>  Salve o recurso acima como public-gateway.yaml e aplique-o: </p><br><pre> <code class="plaintext hljs">kubectl apply -f ./public-gateway.yaml</code> </pre> <br><p>  Nenhum sistema de produ√ß√£o deve fornecer servi√ßos na Internet sem SSL.  Para proteger o gateway Istio com o gerenciador de certificados, CloudDNS e Let's Encrypt, leia a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o</a> do Flagger GKE. </p><br><h3 id="ustanovka-flagger">  Instala√ß√£o do Flagger </h3><br><p>  O suplemento GKE Istio n√£o inclui a inst√¢ncia do Prometheus, que limpa o servi√ßo de telemetria do Istio.  Como o Flagger usa as m√©tricas HTTP do Istio para executar an√°lises de can√°rias, √© necess√°rio implantar a seguinte configura√ß√£o do Prometheus semelhante √† fornecida com o esquema oficial do Istio Helm. </p><br><pre> <code class="plaintext hljs">REPO=https://raw.githubusercontent.com/stefanprodan/flagger/master kubectl apply -f ${REPO}/artifacts/gke/istio-prometheus.yaml</code> </pre> <br><p>  Adicione o reposit√≥rio do Flagger Helm: </p><br><pre> <code class="plaintext hljs">helm repo add flagger https://flagger.app</code> </pre> <br><p>  Expanda Flagger no <code>istio-system</code> istio-system <code>istio-system</code> ativando as notifica√ß√µes do Slack: </p><br><pre> <code class="plaintext hljs">helm upgrade -i flagger flagger/flagger \ --namespace=istio-system \ --set metricsServer=http://prometheus.istio-system:9090 \ --set slack.url=https://hooks.slack.com/services/YOUR-WEBHOOK-ID \ --set slack.channel=general \ --set slack.user=flagger</code> </pre> <br><p>  Voc√™ pode instalar o Flagger em qualquer espa√ßo de nome se ele puder se comunicar com o servi√ßo Istio Prometheus pela porta 9090. </p><br><p>  O Flagger possui um painel Grafana para an√°lise de can√°rios.  Instale o Grafana no <code>istio-system</code> : </p><br><pre> <code class="plaintext hljs">helm upgrade -i flagger-grafana flagger/grafana \ --namespace=istio-system \ --set url=http://prometheus.istio-system:9090 \ --set user=admin \ --set password=change-me</code> </pre> <br><p>  Expanda o Grafana atrav√©s de um gateway aberto, criando um servi√ßo virtual (substitua <code>example.com</code> pelo seu dom√≠nio): </p><br><pre> <code class="plaintext hljs">apiVersion: networking.istio.io/v1alpha3 kind: VirtualService metadata: name: grafana namespace: istio-system spec: hosts: - "grafana.istio.example.com" gateways: - public-gateway.istio-system.svc.cluster.local http: - route: - destination: host: flagger-grafana</code> </pre> <br><p>  Salve o recurso acima como grafana-virtual-service.yaml e aplique-o: </p><br><pre> <code class="plaintext hljs">kubectl apply -f ./grafana-virtual-service.yaml</code> </pre> <br><p>  Ao acessar <code>http://grafana.istio.example.com</code> em um navegador, voc√™ deve ser direcionado para a p√°gina de login da Grafana. </p><br><h3 id="deploy-veb-prilozheniy-s-flagger">  Implanta√ß√£o de aplicativo Web com o Flagger </h3><br><p>  O Flagger implementa o Kubernetes e, se necess√°rio, o escalonamento autom√°tico horizontal (HPA) e cria uma s√©rie de objetos (implanta√ß√µes do Kubernetes, servi√ßos ClusterIP e servi√ßos virtuais Istio).  Esses objetos abrem o aplicativo na malha de servi√ßo e gerenciam a an√°lise e a promo√ß√£o do canary. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/la/cg/h5/lacgh59saaxevwtpgoiby77xe7u.png"></a> </p><br><p>  Crie um espa√ßo para nome de teste com a implementa√ß√£o do Istio Sidecar ativada: </p><br><pre> <code class="plaintext hljs">REPO=https://raw.githubusercontent.com/stefanprodan/flagger/master kubectl apply -f ${REPO}/artifacts/namespaces/test.yaml</code> </pre> <br><p>  Crie uma ferramenta de escala horizontal autom√°tica de implanta√ß√£o e aquecimento: </p><br><pre> <code class="plaintext hljs">kubectl apply -f ${REPO}/artifacts/canaries/deployment.yaml kubectl apply -f ${REPO}/artifacts/canaries/hpa.yaml</code> </pre> <br><p>  Implante um servi√ßo de carga de teste para gerar tr√°fego durante a an√°lise do canary: </p><br><pre> <code class="plaintext hljs">helm upgrade -i flagger-loadtester flagger/loadtester \ --namepace=test</code> </pre> <br><p>  Crie um recurso can√°rio personalizado (substitua <code>example.com</code> pelo seu dom√≠nio): </p><br><pre> <code class="plaintext hljs">apiVersion: flagger.app/v1alpha3 kind: Canary metadata: name: podinfo namespace: test spec: targetRef: apiVersion: apps/v1 kind: Deployment name: podinfo progressDeadlineSeconds: 60 autoscalerRef: apiVersion: autoscaling/v2beta1 kind: HorizontalPodAutoscaler name: podinfo service: port: 9898 gateways: - public-gateway.istio-system.svc.cluster.local hosts: - app.istio.example.com canaryAnalysis: interval: 30s threshold: 10 maxWeight: 50 stepWeight: 5 metrics: - name: istio_requests_total threshold: 99 interval: 30s - name: istio_request_duration_seconds_bucket threshold: 500 interval: 30s webhooks: - name: load-test url: http://flagger-loadtester.test/ timeout: 5s metadata: cmd: "hey -z 1m -q 10 -c 2 http://podinfo.test:9898/"</code> </pre> <br><p>  Salve o recurso acima como podinfo-canary.yaml e aplique-o: </p><br><pre> <code class="plaintext hljs">kubectl apply -f ./podinfo-canary.yaml</code> </pre> <br><p>  A an√°lise acima, se for bem-sucedida, ser√° realizada em cinco minutos, com as m√©tricas HTTP verificadas a cada meio minuto.  Voc√™ pode determinar o tempo m√≠nimo necess√°rio para verificar e promover uma implanta√ß√£o de can√°rio usando a seguinte f√≥rmula: <code>interval * (maxWeight / stepWeight)</code> .  Os campos Canary CRD est√£o documentados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </p><br><p>  Em alguns segundos, o Flagger criar√° objetos can√°rios: </p><br><pre> <code class="plaintext hljs"># applied deployment.apps/podinfo horizontalpodautoscaler.autoscaling/podinfo canary.flagger.app/podinfo # generated deployment.apps/podinfo-primary horizontalpodautoscaler.autoscaling/podinfo-primary service/podinfo service/podinfo-canary service/podinfo-primary virtualservice.networking.istio.io/podinfo</code> </pre> <br><p>  Abra um navegador e acesse <code>app.istio.example.com</code> . Voc√™ ver√° o n√∫mero da vers√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aplicativo de demonstra√ß√£o</a> . </p><br><h3 id="avtomaticheskiy-canary-analiz-i-prodvizhenie">  An√°lise e promo√ß√£o autom√°ticas de can√°rios </h3><br><p>  O Flagger implementa um loop de controle que gradualmente move o tr√°fego para o can√°rio, enquanto mede os principais indicadores de desempenho, por exemplo, a taxa de sucesso de solicita√ß√µes HTTP, a dura√ß√£o m√©dia das solicita√ß√µes e o desempenho da lareira.  Com base na an√°lise, o can√°rio do KPI progride ou √© interrompido, e os resultados da an√°lise s√£o publicados no Slack. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/bw/85/ua/bw85uavib13od3yhfyv7yaqbdmo.png"></a> </p><br><p>  A implanta√ß√£o do Canary √© iniciada quando um dos seguintes objetos √© alterado: </p><br><ul><li>  Implantar o PodSpec (imagem do cont√™iner, comando, portas, env, etc.) </li><li>  Os ConfigMaps s√£o montados como volumes ou convertidos em vari√°veis ‚Äã‚Äãde ambiente </li><li>  Segredos s√£o montados como volumes ou convertidos em vari√°veis ‚Äã‚Äãde ambiente </li></ul><br><p>  Iniciando uma implanta√ß√£o canary ao atualizar uma imagem de cont√™iner: </p><br><pre> <code class="plaintext hljs">kubectl -n test set image deployment/podinfo \ podinfod=quay.io/stefanprodan/podinfo:1.4.1</code> </pre> <br><p>  O Flagger descobre que a vers√£o de implanta√ß√£o foi alterada e come√ßa a analis√°-la: </p><br><pre> <code class="plaintext hljs">kubectl -n test describe canary/podinfo Events: New revision detected podinfo.test Scaling up podinfo.test Waiting for podinfo.test rollout to finish: 0 of 1 updated replicas are available Advance podinfo.test canary weight 5 Advance podinfo.test canary weight 10 Advance podinfo.test canary weight 15 Advance podinfo.test canary weight 20 Advance podinfo.test canary weight 25 Advance podinfo.test canary weight 30 Advance podinfo.test canary weight 35 Advance podinfo.test canary weight 40 Advance podinfo.test canary weight 45 Advance podinfo.test canary weight 50 Copying podinfo.test template spec to podinfo-primary.test Waiting for podinfo-primary.test rollout to finish: 1 of 2 updated replicas are available Promotion completed! Scaling down podinfo.test</code> </pre> <br><p>  Durante a an√°lise, os resultados das can√°rias podem ser rastreados usando o Grafana: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/so/xr/cr/soxrcrt3wvsgtnbwpukfwbzityy.png"></a> </p><br><p>  Observa√ß√£o: se novas altera√ß√µes forem aplicadas √† implanta√ß√£o durante a an√°lise de can√°rios, o Flagger reiniciar√° a fase de an√°lise. </p><br><p>  Fa√ßa uma lista de todos os "can√°rios" no seu cluster: </p><br><pre> <code class="plaintext hljs">watch kubectl get canaries --all-namespaces NAMESPACE NAME STATUS WEIGHT LASTTRANSITIONTIME test podinfo Progressing 15 2019-01-16T14:05:07Z prod frontend Succeeded 0 2019-01-15T16:15:07Z prod backend Failed 0 2019-01-14T17:05:07Z</code> </pre> <br><p>  Se voc√™ ativou as notifica√ß√µes do Slack, receber√° as seguintes mensagens: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/xx/0v/cn/xx0vcnpcarb8nb3xivkmfz_6pfw.png"></a> </p><br><h3 id="avtomaticheskiy-otkat">  Revers√£o autom√°tica </h3><br><p>  Durante a an√°lise do can√°rio, voc√™ pode gerar erros HTTP 500 sint√©ticos e um alto atraso de resposta para verificar se o Flagger interromper√° a implanta√ß√£o. </p><br><p>  Crie uma sub de teste e fa√ßa o seguinte: </p><br><pre> <code class="plaintext hljs">kubectl -n test run tester \ --image=quay.io/stefanprodan/podinfo:1.2.1 \ -- ./podinfo --port=9898 kubectl -n test exec -it tester-xx-xx sh</code> </pre> <br><p>  Gera√ß√£o de erro HTTP 500: </p><br><pre> <code class="plaintext hljs">watch curl http://podinfo-canary:9898/status/500</code> </pre> <br><p>  Atraso na gera√ß√£o: </p><br><pre> <code class="plaintext hljs">watch curl http://podinfo-canary:9898/delay/1</code> </pre> <br><p>  Quando o n√∫mero de verifica√ß√µes sem √™xito atinge o valor limite, o tr√°fego √© roteado de volta para o canal prim√°rio, o canary √© dimensionado para zero e a implanta√ß√£o √© marcada como sem √™xito. </p><br><p>  Erros can√°rios e picos de atraso s√£o registrados como eventos do Kubernetes e registrados pelo Flagger no formato JSON: </p><br><pre> <code class="plaintext hljs">kubectl -n istio-system logs deployment/flagger -f | jq .msg Starting canary deployment for podinfo.test Advance podinfo.test canary weight 5 Advance podinfo.test canary weight 10 Advance podinfo.test canary weight 15 Halt podinfo.test advancement success rate 69.17% &lt; 99% Halt podinfo.test advancement success rate 61.39% &lt; 99% Halt podinfo.test advancement success rate 55.06% &lt; 99% Halt podinfo.test advancement success rate 47.00% &lt; 99% Halt podinfo.test advancement success rate 37.00% &lt; 99% Halt podinfo.test advancement request duration 1.515s &gt; 500ms Halt podinfo.test advancement request duration 1.600s &gt; 500ms Halt podinfo.test advancement request duration 1.915s &gt; 500ms Halt podinfo.test advancement request duration 2.050s &gt; 500ms Halt podinfo.test advancement request duration 2.515s &gt; 500ms Rolling back podinfo.test failed checks threshold reached 10 Canary failed! Scaling down podinfo.test</code> </pre> <br><p>  Se voc√™ ativou as notifica√ß√µes do Slack, receber√° uma mensagem quando o prazo for atingido ou quando o n√∫mero m√°ximo de falhas de verifica√ß√£o durante a an√°lise for atingido: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/wo/te/dq/wotedqdhoxxyhjug_lcuy57wno0.png"></a> </p><br><h3 id="v-zaklyuchenie">  Em conclus√£o </h3><br><p>  O lan√ßamento de uma malha de servi√ßo, como o Istio, al√©m do Kubernetes, fornecer√° m√©tricas, logs e protocolos autom√°ticos, mas a implanta√ß√£o de cargas de trabalho ainda depende de ferramentas externas.  O Flagger procura mudar isso adicionando os recursos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entrega progressiva</a> do Istio. </p><br><p>  O Flagger √© compat√≠vel com qualquer solu√ß√£o de CI / CD da Kubernetes, e a an√°lise do can√°rio pode ser facilmente estendida usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">webhooks</a> para executar testes de integra√ß√£o / aceita√ß√£o do sistema, testes de estresse ou quaisquer outros testes do usu√°rio.  Como o Flagger √© declarativo e responsivo aos eventos do Kubernetes, ele pode ser usado nos pipelines do GitOps com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Weave Flux</a> ou o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JenkinsX</a> .  Se voc√™ estiver usando o JenkinsX, poder√° instalar o Flagger com complementos jx. </p><br><p>  O Flagger √© suportado pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Weaveworks</a> e fornece implementa√ß√µes de can√°rios para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Weave Cloud</a> .  O projeto √© testado em GKE, EX e bare metal com kubeadm. </p><br><p>  Se voc√™ tiver alguma sugest√£o para melhorar o Flagger, envie uma pergunta ou rela√ß√µes p√∫blicas ao GitHub em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">stefanprodan / flagger</a> .  As contribui√ß√µes s√£o mais que bem-vindas! </p><br><p>  Obrigado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ray Tsang</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444808/">https://habr.com/ru/post/pt444808/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444796/index.html">Engenharia reversa de trator: como acelerar o processo de medi√ß√£o pela metade</a></li>
<li><a href="../pt444798/index.html">Vis√£o geral da se√ß√£o Frontend na confer√™ncia DUMP: desenvolvimento do frontend em sua totalidade</a></li>
<li><a href="../pt444800/index.html">O c√≥digo aberto n√£o ganha dinheiro, porque n√£o foi criado para isso</a></li>
<li><a href="../pt444804/index.html">Operadora de c√¢mbio BTC-e pede extradi√ß√£o para a R√∫ssia</a></li>
<li><a href="../pt444806/index.html">Moira participa do Google Summer of Code 2019</a></li>
<li><a href="../pt444810/index.html">Processadores e marketing em inform√°tica</a></li>
<li><a href="../pt444814/index.html">Criptografia em Java. Cifra de classe</a></li>
<li><a href="../pt444816/index.html">Carpintaria de bricolage: expectativas e realidade</a></li>
<li><a href="../pt444818/index.html">Citymobil - um guia para startups para aumentar a estabilidade em meio ao crescimento. Parte 1</a></li>
<li><a href="../pt444820/index.html">Mockdown: a maneira mais r√°pida de criar wireframes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>