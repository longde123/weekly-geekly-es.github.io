<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тШЭЁЯП╗ ЁЯПе ЁЯЫХ рд░реЛрд╢рди рдкреБрдирд░реНрдЬрдиреНрдо рд╕рдордп рджреГрд╢реНрдп ЁЯЫая╕П тЫ╣ЁЯП╗ ЁЯМн</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрд╣ рдЖрд▓реЗрдЦ Dota 2 рдЧреЗрдо рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ x64 рдХреЗ рд▓рд┐рдП DirectX 9 рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрд┐рддреНрд░рдордп рдПрдкреАрдЖрдИ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрд╡рд░реЛрдзрди рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рддрд╛ рд╣реИред 

 рдпрд╣ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд░реНрдгрд┐рдд...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд░реЛрд╢рди рдкреБрдирд░реНрдЬрдиреНрдо рд╕рдордп рджреГрд╢реНрдп</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446516/">  рдпрд╣ рдЖрд▓реЗрдЦ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Dota 2</a> рдЧреЗрдо рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ x64 рдХреЗ рд▓рд┐рдП DirectX 9 рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрд┐рддреНрд░рдордп рдПрдкреАрдЖрдИ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрд╡рд░реЛрдзрди рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рддрд╛ рд╣реИред <br><br>  рдпрд╣ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдЦреЗрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдШреБрд╕рдкреИрда рдХреИрд╕реЗ рдХрд░реЗрдВ, рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдХреИрд╕реЗ рдмрджрд▓реЗрдВ, рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рддрд░реНрдХ рдХрд╛ рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╡рд┐рд╡рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЕрдВрдд рдореЗрдВ, рд╣рдо рдЗрдВрдЬрди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЕрдиреНрдп рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗред <br><br><img src="https://habrastorage.org/webt/b0/rp/kn/b0rpknk7iobhh3darfcrte8ncmo.jpeg"><br><br><blockquote>  <b>рдЕрд╕реНрд╡реАрдХрд░рдг: рд▓реЗрдЦрдХ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдЬреНрдЮрд╛рди рдХреЗ рдЖрдкрдХреЗ рдЙрдкрдпреЛрдЧ рдпрд╛ рдЙрдирдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдиреБрдХрд╕рд╛рди рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рдирд╣реАрдВ рд╣реИред</b>  <b>рдпрд╣рд╛рдВ рдкреНрд░рд╕реНрддреБрдд рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗрд╡рд▓ рд╢реИрдХреНрд╖рд┐рдХ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИред</b>  <b>рдЦрд╛рд╕рддреМрд░ рдкрд░ MOBA рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХрдВрдкрдирд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рддрд╛рдХрд┐ рд╡реЗ рд╕рд┐рдиреЗрдорд╛рдШрд░реЛрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХреЗрдВред</b>  <b>рдФрд░, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рд▓реЗрдЦ рдХреЗ рд▓реЗрдЦрдХ рдПрдХ рдмреЙрдЯ рд╕реНрд╡рд┐рдЪрд░, рдПрдХ рдЪреАрдЯрд░ рд╣реИ, рдФрд░ рд╡рд╣ рд╣рдореЗрд╢рд╛ рд╕реЗ рд░рд╣рд╛ рд╣реИред</b> </blockquote><a name="habracut"></a>  рдЕрдВрддрд┐рдо рд╡рд╛рдХреНрдп рд╕рдордЭрд╛рдиреЗ рд▓рд╛рдпрдХ рд╣реИ - рдореИрдВ рдирд┐рд╖реНрдкрдХреНрд╖ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рдХреЗ рд▓рд┐рдП рд╣реВрдВред  рдореИрдВ рдХреЗрд╡рд▓ рдПрдХ рдЦреЗрд▓ рд╣рд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдзреЛрдЦрд╛ рджреЗрддреА рд╣реВрдВ, рд░рд┐рд╡рд░реНрд╕ рд╕реНрдХрд┐рд▓ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддреА рд╣реВрдВ, рдПрдВрдЯреА-рдЪреАрдЯ рдХреЗ рдХрд╛рдо рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддреА рд╣реВрдВ рдФрд░ рдХреЗрд╡рд▓ рд░реЗрдЯрд┐рдВрдЧ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛рдУрдВ рдХреЗ рдмрд╛рд╣рд░ред <br><br><h2>  1. рдкрд░рд┐рдЪрдп </h2><br>  рдЗрд╕ рд▓реЗрдЦ рдХреЛ рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдкрд╣рд▓реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдпреЛрдЬрдирд╛рдмрджреНрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдпрд╣ рд╡рд┐рдЪрд╛рд░ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдкреНрд░рдпреЛрдЬрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдЧрд▓реЗ рднрд╛рдЧ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИред  рдореИрдВ рд╕реНрд░реЛрдд 2 рдореЗрдВ рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреА рд╕реВрдЪреА рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдХреЗрддрдХ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░рд╛ рд▓реЗрдЦ рд╕рдорд░реНрдкрд┐рдд рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реВрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ Dota 2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ) рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Source2Gen</a> рдХреЗ рд╕рд╛рде рд╕рдВрдпреЛрдЬрди рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ "рдЕрддрд┐рд░рд┐рдХреНрдд" рддрд░реНрдХ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП (рдХреБрдЫ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕</a> рддрд░рд╣ рд╕реЗ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ "рдирдХреНрд╢рд╛ рд╣реИрдХ" рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ) рдЙрджреНрдзрд░рдг рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ, рдЬреЛ рдХреБрдЫ рднреА рджрд╛рдВрд╡ рдкрд░ рд▓рдЧрд╛ рд╣реИ рд╡рд╣ рд╡реАрдбрд┐рдпреЛ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ), рдпрд╛ рдкрд╣рд▓реЗ рд▓реЗрдЦ рдХрд╛ рд╕реНрд╡рдЪрд╛рд▓рди)ред  рддреАрд╕рд░реЗ рд▓реЗрдЦ рдХреА рдпреЛрдЬрдирд╛ рдПрдХ рдбреНрд░рд╛рдЗрд╡рд░ рд▓рд┐рдЦрдиреЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИ, рдЗрд╕рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж (IOCTL) рд╣реИ, рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ VAC рд╕рдВрд░рдХреНрд╖рдг (рдЗрд╕рдХреЗ рд╕рдорд╛рди рдХреБрдЫ) рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</a> ред <br><br><h2>  2. рдореБрдЭреЗ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рдкрдбрд╝реА </h2><br>  рдореБрдЭреЗ рдЕрдкрдиреЗ рдмреЙрдЯ рдХреЛ рдиреЗрддреНрд░рд╣реАрди рд░реВрдк рд╕реЗ рдбреАрдмрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдПрдкреАрдЖрдИ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА, рдЬреЛ рдореИрдВрдиреЗ рдбреЛрдЯрд╛ 2 рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦрд╛ рдерд╛ (рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдХреА рджреГрд╢реНрдп рдЬрд╛рдирдХрд╛рд░реА рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ)ред  рдореИрдВ рдПрдХ рд╕реНрдирд╛рддрдХ рдЫрд╛рддреНрд░ рд╣реВрдВ рдФрд░ 3 рдбреА рд╕рд┐рд░ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрдорд╛рдг рдореЗрдВ рд▓рдЧрд╛ рд╣реВрдВ рдФрд░ рдЫрд╡рд┐рдпреЛрдВ рдФрд░ рдПрдХ рдЧрд╣рди рдХреИрдорд░реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрд░реНрдл рдХрд░ рд░рд╣рд╛ рд╣реВрдВ - рд╡рд┐рд╖рдп рдХрд╛рдлреА рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ, рд▓реЗрдХрд┐рди рдореЗрд░рд╛ рдкрд╕рдВрджреАрджрд╛ рдирд╣реАрдВ рд╣реИред  рдЪреВрдВрдХрд┐ рдореИрдВ рдкрд╛рдВрдЪрд╡реЗрдВ рд╡рд░реНрд╖ (рдорд╛рд╕реНрдЯрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╕рд╛рде рд╢реБрд░реВ) рдХрд░ рд░рд╣рд╛ рд╣реВрдВ, рдореБрдЭреЗ рдПрдХ рдмрд╛рдд рд╕рдордЭ рдореЗрдВ рдЖрдИ- рд╣рд╛рдВ, рдореИрдВрдиреЗ рдЗрд╕ рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ рд╣реИ, рдореИрдВ рдЖрд╕рд╛рдиреА рд╕реЗ рддрд░реАрдХреЛрдВ рдФрд░ рддрд░реАрдХреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЗрдЦреЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддрд╛ рд╣реВрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реВрдВред  рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдм, рдореИрдВ рд╕реНрд╡рдпрдВ рдХреЗрд╡рд▓ рдЕрдЧрд▓реЗ рд╕реАрдЦреЗ рд╣реБрдП рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ, рдкрд╣рд▓реЗ рд╕реЗ рдЕрдзреНрдпрдпрди рдХрд┐рдП рдЧрдП рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЧрдП рд▓реЛрдЧреЛрдВ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ рдФрд░ рдпрд╣ рддрдп рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ рдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХрд╛рд░реНрдп рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред  рдпрд╣ рдЕрдиреБрдХреВрд▓рди рдХрд╛ рдЕрдВрдд рд╣реИ, рдпрд╣ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреБрдЫ рдирдпрд╛ рдЦреБрдж рдХреЗ рд╕рд╛рде рдЖрдП, рдЬреЛ рд╕реНрдирд╛рддрдХ рд╡рд┐рджреНрдпрд╛рд▓рдп (рдЕрдзреНрдпрдпрди рдХреА рдирд╡реАрдирддрд╛) рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред  рдореИрдВрдиреЗ рд╕реЛрдЪрдирд╛ рд╢реБрд░реВ рдХрд┐рдпрд╛ - рдЬрдмрдХрд┐ рд╕рдордп рд╣реИ, рдЖрдк рдПрдХ рдирдпрд╛ рд╡рд┐рд╖рдп рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╡рд┐рд╖рдп рдХреЛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рд╡рд░реНрддрдорд╛рди рд╕реНрддрд░ рдкрд░) рдпрд╛ рдЖрдк рдЗрд╕реЗ рдЬрд▓реНрджреА рд╕реЗ рдЦреАрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЙрд╕реА рд╕рдордп, рдореИрдВрдиреЗ рдЦреЗрд▓ рджреЗрд╡ рдореЗрдВ рдХрд╛рдо рдХрд┐рдпрд╛, рдФрд░ рдпрд╣ рд╢рд╛рдпрдж рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ (рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░рд╛рдп) рдХреНрдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдЖрдИ, рдмреЙрдЯреНрд╕ рдХреЗ рд╡рд┐рд╖рдп рдореЗрдВ рдмрд╣реБрдд рд░реБрдЪрд┐ рд░рдЦрддрд╛ рдерд╛ред  рдЙрд╕ рд╕рдордп, рджреЛ рд╡рд┐рд╖рдп рдереЗ рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬрд╛рдирддрд╛ рдерд╛ - рддрдм рдореИрдВ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдЬрд╛рд▓ (рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░) рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд░рд╣рд╛ рдерд╛ рдФрд░ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд╢реВрдЯрд░ рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рднрд╛рдЧ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░ рд░рд╣рд╛ рдерд╛ред  рдбрд╛рдпрдиреЗрдорд┐рдХ рдиреЗрд╡рд┐рдЧреЗрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рд╖рдп рдПрдХрджрдо рд╕реЗ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реИ - рдореИрдВрдиреЗ рдХрд╛рдо рдХреЗ рдШрдВрдЯреЛрдВ рдХреЗ рджреМрд░рд╛рди рдРрд╕рд╛ рдХрд┐рдпрд╛ рдерд╛, рдореБрдЭреЗ рдкреНрд░рдмрдВрдзрди рд╕реЗ рдЕрдкрдиреЗ рдбрд┐рдкреНрд▓реЛрдорд╛ рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рд▓рд┐рдП рдкреВрдЫрдирд╛ рдерд╛, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдирд╡реАрдирддрд╛ рд╡рд┐рд╖рдп рдЦреБрд▓рд╛ рдерд╛ - рдореИрдВрдиреЗ рд▓реЗрдЦ рдХреЗ рд╕рд╛рде рдореМрдЬреВрджрд╛ рддрд░реАрдХреЛрдВ рдХрд╛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ рдФрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдХреЛрдИ рдирдИ рдмрд╛рдд рдирд╣реАрдВ рдереАред  рдбрд╛рдпрдиреЗрдорд┐рдХ рд╢реВрдЯрд░ рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рднрд╛рдЧ рдХреЗ рд╕рд╛рде рд╡рд┐рд╖рдп (рдореИрдВрдиреЗ рдЗрд╕реЗ рдЖрднрд╛рд╕реА рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдореЗрдВ рдмрд╛рддрдЪреАрдд рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ) рдлрд┐рд░ рд╕реЗ рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджреЛрдиреЛрдВ рдХреЛ рддреЛрдбрд╝ рджрд┐рдпрд╛ рдХрд┐ рдореИрдВ рдЗрд╕реЗ рдХрд╛рдо рдХреЗ рдШрдВрдЯреЛрдВ рдХреЗ рджреМрд░рд╛рди рдХрд░ рд░рд╣рд╛ рдерд╛, рдФрд░ рдирд╡реАрдирддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рдЖрдк Pixonic рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓реЗрдЦреЛрдВ рдХреА</a> рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╢реНрд░реГрдВрдЦрд▓рд╛</a> рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд╣рд╛рдВ рд▓реЗрдЦрдХ рдЦреБрдж рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рд╡рд┐рд╖рдп рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ, рдХреЗрд╡рд▓ 30 рд╕рд╛рд▓ рдкрд╣рд▓реЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЖрд╡рд┐рд╖реНрдХрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдмрд╣реБрдд рдХреБрдЫ рдмрджрд▓ рдирд╣реАрдВ рдЧрдпрд╛ рдерд╛ред <br><br>  рдЗрд╕ рд╕рдордп рдХреЗ рджреМрд░рд╛рди, OpenAI рдиреЗ рдЕрдкрдиреЗ рдмреЙрдЯ рдХреЛ рдЬрд╛рд░реА рдХрд┐рдпрд╛ред  рдпрд╣ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">5 рдмрд╛рдИ 5 рдирд╣реАрдВ рд╣реИ</a> , рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛ рдерд╛!  рдореИрдВ рдПрдХ рдмреЙрдЯ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдлреЗрдВрдХ рд╕рдХрд╛ рдФрд░ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдореИрдВрдиреЗ рдпрд╣ рд╕реЛрдЪрдирд╛ рд╢реБрд░реВ рдХрд░ рджрд┐рдпрд╛ рдХрд┐ рдЗрд╕реЗ рдПрдХ рд╢реЛрдз рдкреНрд░рдмрдВрдз рдХреЗ рд░реВрдк рдореЗрдВ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдирд╡реАрдирддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЗрд╕реЗ рдПрдХ рдиреЗрддрд╛ рдХреЛ рдХреИрд╕реЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рдПред  рдЗрд╕ рд╕рдВрдмрдВрдз рдореЗрдВ рдирд╡реАрдирддрд╛ рдХреЗ рд╕рд╛рде, рд╕рдмрдХреБрдЫ рдмрд╣реБрдд рдмреЗрд╣рддрд░ рдерд╛ - рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рджреЛ рдкрд┐рдЫрд▓реЗ рд╡рд┐рд╖рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдХреЗ рд╕рд╛рде рдЖрдирд╛ рд╕рдВрднрд╡ рдерд╛, рд▓реЗрдХрд┐рди рдЬрд╛рд╣рд┐рд░ рддреМрд░ рдкрд░ рдмреЙрдЯ рдиреЗ рдореБрдЭреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдЬрдХрдбрд╝рдирд╛, рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рдФрд░ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдЕрдзрд┐рдХ рдордЬрдмреВрдд рдмрдирд╛рдирд╛ рдмрддрд╛рдпрд╛ред  рдЗрд╕рд▓рд┐рдП, рдореИрдВрдиреЗ 1-рдСрди -1 рдмреЙрдЯ рдмрдирд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ (рдорд┐рдбрдП рдкрд░ рдПрдХ рд▓рдбрд╝рд╛рдИ, рдЬреИрд╕реЗ рдУрдкрдирдПрдЖрдИ), рдЗрд╕реЗ рдиреЗрддрд╛ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдВ, рдмрддрд╛рдПрдВ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ рд╢рд╛рдВрдд рд╣реИ, рдХрд┐рддрдиреЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг, рдЧрдгрд┐рдд рдФрд░ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд, рдирдпрд╛ред <br><br>  рдкрд╣рд▓реЗ рдЪрд░рдг рдореЗрдВ рдмреЙрдЯ рдХреА рд╕рдмрд╕реЗ рдЬрд╝рд░реВрд░реА рдЪреАрдЬрд╝ рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдЙрд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдЬреНрдЮрд╛рди рд╣реИ - рдЬрд┐рд╕рдореЗрдВ рдореИрдВ рдЦреЗрд▓ рдХреА рдпрд╛рджрджрд╛рд╢реНрдд рд╕реЗ рджреБрдирд┐рдпрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рд▓реЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдФрд░ рдкрд╣рд▓рд╛ рдЪрд░рдг рдПрдВрдЯрд┐рдЯреА рд▓рд┐рд╕реНрдЯ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдФрд░ рдкреНрд░рд╛рд░реНрдердирд╛ рдбреЙрдЧ 2 рдХреЗ рджрд┐рдорд╛рдЧ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдЦреЛрдЬрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдмрд┐рддрд╛рдпрд╛ рд╣реИред Source2Gen - рдпрд╣ рдмрд╛рдд Source2 рдЗрдВрдЬрди рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕реЗ рд╡рд╣ рд╕рд░реНрдХрд┐рдЯ рд╕реЗ рд▓реЗрддрд╛ рд╣реИред  рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рдЙрджреНрднрд╡ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рд╡рд┐рдЪрд╛рд░ рдФрд░ рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛ рдЧреНрд░рд╛рд╣рдХ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд░рд╛рдЬреНрдп рдХреА рдкреНрд░рддрд┐рдХреГрддрд┐ рд╣реИ, рд▓реЗрдХрд┐рди рдЬрд╛рд╣рд┐рд░ рддреМрд░ рдкрд░ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдпрд╣ рд╡рд┐рдЪрд╛рд░ рдкрд╕рдВрдж рдЖрдпрд╛ рдФрд░ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЗрд╕реЗ рдЕрдзрд┐рдХ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛, рдореИрдВ рдЖрдкрдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкрдврд╝рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВред <br><br>  рдореБрдЭреЗ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХрд╛ рдЕрдиреБрднрд╡ рдерд╛: рдореИрдВрдиреЗ рд╕рд╛рдЗрд▓реЗрдВрдЯ рд╕реНрдЯреЙрд░реНрдо рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">рдЪреАрдЯ</a> рдмрдирд╛рдпрд╛, рдореБрдЦреНрдп рдЬрдирд░реЗрдЯрд░ рдмрдирд╛рдпрд╛ (рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдмреНрд▓реИрдХ рдПрдВрдб рд╡реНрд╣рд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП рдерд╛) - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">рдХреЗрдЬреЗрди</a> рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">DrMefistO рд╕реЗ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдХреНрдпрд╛ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">рдХрд╛рдмрд▓</a> рдСрдирд▓рд╛рдЗрди рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЙрдореНрдмреЛ</a> рдирд┐рд╖реНрдкрд╛рджрди (рд╕рдм рдХреБрдЫ рдЗрд╕ рддрдереНрдп рд╕реЗ рдЬрдЯрд┐рд▓ рдерд╛ рдХрд┐ рдпрд╣ рдЧреЗрдо рдЧреЗрдо рдЧрд╛рд░реНрдб рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдерд╛ред (рдпрд╣ рдХрд░реНрдиреЗрд▓ рдореЛрдб рдореЗрдВ рдбреНрд░рд╛рдЗрд╡рд░ рдХреЗ рддрд╣рдд) ring0 рд╕реЗ рдкрд╣рд░рд╛ рджрд┐рдпрд╛, рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЫрд┐рдкрд╛рддреЗ рд╣реБрдП (рдЬреЛ рдХрдо рд╕реЗ рдХрдо рдЗрд╕реЗ рдШреБрд╕рдкреИрда рдХрд░рдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рдмрдирд╛рддрд╛ рд╣реИ) - рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> )ред <br>  рддрджрдиреБрд╕рд╛рд░, рдЗрд╕ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдореЗрд░рд╛ рд╡рд┐рдХрд╛рд╕ рд╣реБрдЖ, рдмреЙрдЯ рдХреЛ рдирд┐рдпреЛрдЬрд┐рдд рд╕рдордп рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рд╡рд░рдг рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓реАред  рдпрд╣ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд╣реИ рдХрд┐ рдмрдВрдХрд░ рд╕рд░реНрд╡рд░ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рдбреЗрд▓реНрдЯрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рддрдиреА рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ рдХрд┐рд╕реА рднреА рдЯреЗрд▓реАрдкреЛрд░реНрдЯрд░реНрд╕, рд╕реНрд╡рд╛рд╕реНрдереНрдп рдФрд░ рдПрдЬреЗрдВрдЯреЛрдВ рдХреЗ рдмреАрдЪ рдЗрд╕рдХреЗ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реИ (рд░реЛрд╢рди рдХреЛ рдЫреЛрдбрд╝рдХрд░, рд╡рд╣ рджреЛрд╣рд░рд╛рддрд╛ рдирд╣реАрдВ рд╣реИ) - рдпрд╣ рд╕рдм рдпреБрджреНрдз рдХреЗ рдХреЛрд╣рд░реЗ рдореЗрдВ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐ рдореБрдЭреЗ рдХреБрдЫ рдХрдард┐рдирд╛рдЗрдпреЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рд╛, рдпрд╣ рдореИрдВ рдЕрдЧрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдмрд╛рдд рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдБред <br>  рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдкреНрд░рд╢реНрди рд╣реИ рдХрд┐ рдореИрдВрдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЛрдЯрд╛ рдмреЙрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдореИрдВ рдкреНрд░рд▓реЗрдЦрди рд╕реЗ рдПрдХ рдЕрдВрд╢ рдХреЗ рд╕рд╛рде рдЙрддреНрддрд░ рджреВрдВрдЧрд╛: <br><blockquote>  API рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИ рдЬреИрд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдзреЛрдЦрд╛ рдирд╣реАрдВ рджреЗ рд╕рдХрддреА - FoW рдореЗрдВ рдпреВрдирд┐рдЯреНрд╕ рдХреЛ рдХреНрд╡реЗрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛, рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдХрдорд╛рдВрдбреНрд╕ рдЬрд╛рд░реА рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ, рдЖрджрд┐ред </blockquote>  рд▓реЗрдЦреЛрдВ рдХреА рдпрд╣ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЙрди рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖рд┐рдд рд╣реИ рдЬреЛ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рд╡рд┐рд╖рдп рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВред <br><br><h2>  3. рдореИрдВ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпреЛрдВ рд▓рд┐рдЦ рд░рд╣рд╛ рд╣реВрдВ </h2><br>  рдирддреАрдЬрддрди, рдореБрдЭреЗ рдорд┐рд▓реАрд▓реАрдЯрд░ рд╕реЗ рдмреЙрдЯ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рд╛, рдЬреЛ рдХрд┐ рдореБрдЭреЗ рдпрд╣ рд╕рдордЭрдиреЗ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рд╕рдордп рд▓рдЧрд╛ рдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдЕрдВрдд рд╕реЗ рджреЛ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рдореИрдВ рд╡рд░реНрддрдорд╛рди рд╡рд┐рд╖рдп рдореЗрдВ рдЕрдкрдиреЗ рдЬреНрдЮрд╛рди рдФрд░ рдЕрдиреБрднрд╡ рдХреЛ рдкрд╛рд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрд╛ред  Dota 2 рдореЗрдВ, рдореИрдВ Dota Auto Chess рд░рд┐рд╡рд╛рдЬ рдХреЗ рд░рд┐рд▓реАрдЬ рд╣реЛрдиреЗ рд╕реЗ рдирд╣реАрдВ рдЦреЗрд▓рддрд╛, рдореИрдВ рдЕрдм рдЕрдкрдирд╛ рдЦрд╛рд▓реА рд╕рдордп рдПрдкреЗрдХреНрд╕ рд▓реЗрдЬреЗрдВрдб рдХреЗ рдбрд┐рдкреНрд▓реЛрдорд╛ рдФрд░ рд░рд┐рд╡рд░реНрд╕ рдкрд░ рдмрд┐рддрд╛рддрд╛ рд╣реВрдВ (рдЬрд┐рд╕рдХреА рд╕рдВрд░рдЪрдирд╛ Dota 2 рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ)ред  рддрджрдиреБрд╕рд╛рд░, рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдп рд╕реЗ рдПрдХрдорд╛рддреНрд░ рд▓рд╛рдн рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ рдПрдХ рддрдХрдиреАрдХреА рд▓реЗрдЦ рдХрд╛ рдкреНрд░рдХрд╛рд╢рди рд╣реИред <br><br><h2>  4. рдбреЛрдЯрд╛ 2 </h2><br>  рдореИрдВ рдЗрди рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХреЛ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЧреЗрдо - рдбреЛрдЯрд╛ 2 рдкрд░ рджрд┐рдЦрд╛рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реВрдВред рдЦреЗрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдВрдЯреА-</a> рдЪреАрдЯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд╛рд▓реНрд╡ рдПрдВрдЯреА рдЪреАрдЯ</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдореБрдЭреЗ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдХрдВрдкрдиреА рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд╛рд▓реНрд╡ рдкрд╕рдВрдж рд╣реИ: рдмрд╣реБрдд рд╣реА рд╢рд╛рдВрдд рдЙрддреНрдкрд╛рдж, рдирд┐рд░реНрджреЗрд╢рдХ, рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд░рд╡реИрдпрд╛, рд╕реНрдЯреАрдо, рд╕реНрд░реЛрдд рдЗрдВрдЬрди 2, ... рд╡реАрдПрд╕реАред  рд╡реАрдПрд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдореЛрдб (рд░рд┐рдВрдЧ 3) рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд╕рдм рдХреБрдЫ рд╕реНрдХреИрди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдиреНрдп рдПрдВрдЯреА-рдЪреАрдЯ (рдЬреЛ рдХрд┐ рдПрд╕рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ (рд╡рд┐рд╢реЗрд╖рдХрд░ рдЙрдирдХреЗ рдПрдВрдЯреА-рдЪреАрдЯ рд╕реЗ) рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╣рд╛рдирд┐рд░рд╣рд┐рдд рд╣реИ, рдЗрд╕ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рднреА рдЗрдЪреНрдЫрд╛рдПрдВ рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рддреА рд╣реИрдВ)ред  рдореБрдЭреЗ рдпрдХреАрди рд╣реИ рдХрд┐ рд╡реАрдПрд╕реА рдЕрдкрдиреЗ рдХрд╛рд░реНрдп рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХрд░рддрд╛ рд╣реИ - рдпрд╣ рдХрд░реНрдиреЗрд▓ рдореЛрдб рд╕реЗ рдореЙрдирд┐рдЯрд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ (рдХреЗрд╡рд▓ рдПрдХ рдЦрд╛рддрд╛) рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рдирд╣реАрдВ рд▓рдЧрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдореЗрдВ рд╡реЙрдЯрд░рдорд╛рд░реНрдХ рд╕рдореНрдорд┐рд▓рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ - рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд╛рд▓реНрд╡ рдХреЗ рд░рд╡реИрдпреЗ рдХреЗ рд▓рд┐рдП, рд╡реЗ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ рдкреВрд░реНрдг рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рд╡реЗ рдХрд░рддреЗ рд╣реИрдВред рдЧреЗрдо рдЧрд╛рд░реНрдб, рдмреИрдЯрд▓рдПрдИ, рд╡рд╛рд░реНрдбрди рдФрд░ рдЕрдиреНрдп, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рднреА рд╣реИрдХ рд╣реЛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЦрд░реНрдЪ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЧреЗрдо рд▓реЗ рд╕рдХрддрд╛ рд╣реИ (рднрд▓реЗ рд╣реА рдпрд╣ рд╕рдордп-рд╕рдордп рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ), рдЭреВрдареА рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╣реИрдВ (рд╡рд┐рд╢реЗрд╖рдХрд░ рд▓реИрдкрдЯреЙрдк рдкрд░ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП)ред  рд╡рд╣рд╛рдБ рдПрдХ рджреАрд╡рд╛рд░ рд╣реИрдХ, aimbot, рдЧрддрд┐ рд╣реИрдХ, PUBG, рд╕рд░реНрд╡реЛрдЪреНрдЪ, Fortnite рдореЗрдВ ESP рдирд╣реАрдВ рд╣реИ? <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ Dota 2. рдЧреЗрдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">40Hz</a> (25 ms) рдХреА рдЖрд╡реГрддреНрддрд┐ рдкрд░ рдЪрд▓рддрд╛ рд╣реИ, рдХреНрд▓рд╛рдЗрдВрдЯ рдЧреЗрдо рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рдХреНрд╖реЗрдкрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЗрдирдкреБрдЯ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдЕрдВрддрд░рд╛рд▓ рд╣реИ, рддреЛ рдПрдХ рдЧреЗрдо - рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЧреЗрдо рднреА рдирд╣реАрдВ рд╣реИ, рдирд┐рдпрдВрддреНрд░рд┐рдд рдЗрдХрд╛рдЗрдпрд╛рдВ - рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдлреНрд░реАрдЬ рд╣реЛ рдЧрдИ рд╣реИрдВред  рдЧреЗрдо рдореИрдХреЗрдирд┐рдХреНрд╕ рд╕рд░реНрд╡рд░ RUDP (рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдпреВрдбреАрдкреА) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдХреНрд▓рд╛рдЗрдВрдЯ рдореВрд▓ рд░реВрдк рд╕реЗ рдЗрдирдкреБрдЯ рднреЗрдЬрддрд╛ рд╣реИ (рдпрджрд┐ рдЖрдк рд▓реЙрдмреА рд╣реЛрд╕реНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдХрдорд╛рдВрдб рднреЗрдЬреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ), рд╕рд░реНрд╡рд░ рдЧреЗрдо рдХреА рджреБрдирд┐рдпрд╛ рдФрд░ рдЯреАрдореЛрдВ рдХреА рдкреНрд░рддрд┐рдХреГрддрд┐ рднреЗрдЬрддрд╛ рд╣реИред  рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЛ 3D рдЧреНрд░рд┐рдб рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХрд╛ рдЕрдкрдирд╛ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдзреИрд░реНрдп рд╣реЛрддрд╛ рд╣реИред  рдиреЗрд╡рд┐рдЧреЗрд╢рди рдФрд░ рдлрд┐рдЬрд┐рдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдВрджреЛрд▓рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреЗ рдмрд░рддрди, рдХреЛрдЧреА рдХреНрд▓реЛрд╡реЗрд░реНрдХрд╛, рдЖрджрд┐ рдХреА рдлрд┐рд╕рд▓рди рд╕реЗ рдЧреБрдЬрд░рдиреЗ рдХреА рдЕрд╕рдВрднрд╡рддрд╛)ред <br><br>  рд╕рднреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЗ рд╕рд╛рде рджреБрдирд┐рдпрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рдмрд┐рдирд╛ рдЕрдкрдиреЗ рд╢реБрджреНрдзрддрдо рд░реВрдк рдореЗрдВ рд╕реНрдореГрддрд┐ рдореЗрдВ рд╣реИ - рдЖрдк рдЪреАрдЯ рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЗрд▓ рдХреА рдореЗрдореЛрд░реА рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╕реНрдЯреНрд░рд┐рдВрдЧ рдФрд░ рдХреЛрдб рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">DirectX9, DirectX11, Vulkan, OpenGL рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдПрдкреАрдЖрдИ рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xc/xq/kl/xcxqkl2qpwy3gved7_jblzsqumo.png"><br></div></div><br><h2>  5. рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдг </h2><br>  рдбреЛрдЯрд╛ 2 рдЧреЗрдо рдореЗрдВ рдПрдХ рддрдЯрд╕реНрде "рдкреНрд░рд╛рдЪреАрди" рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рд╣рддреНрдпрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдЗрдирд╛рдо рджреЗрддреА рд╣реИ: рдЕрдиреБрднрд╡, рд╕реЛрдирд╛, рдХреМрд╢рд▓ рдФрд░ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдХреЛрд▓реНрдбреЙрдмреНрд╕ рдХреЛ рд░реЛрд▓ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛, рдПрдЬрд┐рд╕ (рджреВрд╕рд░рд╛ рдЬреАрд╡рди), рдЙрд╕рдХрд╛ рдирд╛рдо рд░реЛрд╢рди рд╣реИред  рдПрдЬрд┐рд╕ рдореВрд▓ рд░реВрдк рд╕реЗ рдЦреЗрд▓ рдХреЛ рдЪрд╛рд░реЛрдВ рдУрд░ рдореЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдордЬрдмреВрдд рдкрдХреНрд╖ рдХреЛ рдФрд░ рднреА рдЕрдзрд┐рдХ рд▓рд╛рдн рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдХреНрд░рдорд╢рдГ, рдЦрд┐рд▓рд╛рдбрд╝реА рдПрдХ рд╕рд╛рде рдкрд╛рдиреЗ рдФрд░ рдЙрд╕ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ, рдпрд╛ рдЙрд╕рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕ рд╣реЛрдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреА рдореГрддреНрдпреБ рдХреЗ рд╕рдордп рдХреЛ рдпрд╛рдж рдХрд░рдиреЗ / рд░рд┐рдХреЙрд░реНрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рд╕рднреА рджрд╕ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рд░реЛрд╢рди рдХреА рдореМрдд рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рд╡рд╣ рдпреБрджреНрдз рдХреЗ рдХреЛрд╣рд░реЗ рдореЗрдВ рдЫрд┐рдкрд╛ рд╣реЛред  рд░рд┐рд╕реНрдкреЙрдиреНрд╕ рдЯрд╛рдЗрдо рдореЗрдВ рдЖрда рдорд┐рдирдЯ рдЕрдирд┐рд╡рд╛рд░реНрдп рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд░реЛрд╢рди рддреАрди рдорд┐рдирдЯ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддрд╛ рд╣реИред <br><br>  <i>рдХрд╛рд░реНрдп рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ</i> : рд░реЛрд╢рди рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ (рдЬреАрд╡рд┐рдд-рдЬреАрд╡рдВрдд, ressurect_base-revives рдЖрдзрд╛рд░ рд╕рдордп, ressurect_extra-revives рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдордп) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ред <br><br> <a href=""><img src="https://habrastorage.org/webt/qf/ef/3s/qfef3s2h4a6l_pfageiblxwqhd8.png"></a> <br>  <i>рдЪрд┐рддреНрд░рд╛ 1 - рд╕рдВрдХреНрд░рдордг рдХреЗ рджреМрд░рд╛рди рд░рд╛рдЬреНрдпреЛрдВ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдХреНрд░рдордг рдХреЗ рд▓рд┐рдП рд╢рд░реНрддреЗрдВ</i> <br><br>  рдЬрд┐рди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рд░реЛрд╢рди рдХреА рдореГрддреНрдпреБ рд╣реБрдИ рд╣реИ, рдЙрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд░рд╛рдЬреНрдп рдореЗрдВ рд░рд╣рдиреЗ рдХрд╛ рдЕрдВрддрд┐рдо рд╕рдордп рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдВред  рдЬреАрд╡рд┐рдд рдЕрд╡рд╕реНрдерд╛ рд╕реЗ ressurect_base рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рдореИрдиреБрдЕрд▓ рдореЛрдб рдореЗрдВ рдмрдЯрди рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  Ressurect_extra рд░рд╛рдЬреНрдп рдореЗрдВ рд░реЛрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ / рдореГрддреНрдпреБ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рджреБрд╢реНрдорди рдЯреАрдо рдЪреБрдкрдХреЗ рд╕реЗ рдорд╛рдВрдж рдореЗрдВ рдШреБрд╕ рдЧрдИ рдФрд░ рдЙрд╕реЗ рдорд╛рд░ рдбрд╛рд▓рд╛), рдЬреАрд╡рд┐рдд / ressurect_base рд░рд╛рдЬреНрдп рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд░реЛрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ (рдФрд░ рдкреБрдирд░реБрддреНрдерд╛рди рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реЛрдиреЗ рдХрд╛ рдЕрдВрддрд┐рдо рд╕рдордп) рдХреЛ рдкрд╛рда рд░реВрдк рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ (ressurect_extra рдХреЗ рд░рд╛рдЬреНрдп рдХреА рд╣рддреНрдпрд╛ рдФрд░ рд░реБрдХрд╛рд╡рдЯ) рдПрдХ рдмрдЯрди рдХреЗ рд╕рд╛рде рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><img src="https://habrastorage.org/webt/cb/xw/ne/cbxwneudadwlvbx4ch2gwumlona.png"><br>  <i>рдЪрд┐рддреНрд░рд╛ 2 - рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рддрддреНрд╡ - рд▓реЗрдмрд▓, рдмрдЯрди рдФрд░ рдХреИрдирд╡рд╛рд╕</i> <br><br>  рдпрд╣ рдПрдХрдорд╛рддреНрд░ рдРрд╕рд╛ рдХрд╛рд░реНрдп рд╣реИ рдЬреЛ рдореИрдВ рдХрд░ рд╕рдХрддрд╛ рдерд╛ рддрд╛рдХрд┐ рдореБрдЭреЗ рдЦреЗрд▓ рдХреА рд╕реНрдореГрддрд┐ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛ рдФрд░ рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗ рдХрдо рдХреБрдЫ рдореВрд▓реНрдп рд╣реЛ - рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдХрд┐рд╕реА рднреА рдкреНрд░рд╛рдердорд┐рдХ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ, рдЬреИрд╕реЗ рд╕реНрд╡рд╛рд╕реНрдереНрдп, рдорди рдФрд░ рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЗ рдкрджреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЙрдиреНрд╣реЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рдЦреЛрдЬрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред рдЪреАрдЯ рдЗрдВрдЬрди рдЦреЗрд▓ рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд░реВрдк рд╕реЗ рдФрд░ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдпрд╛ рд╕реЛрд░реНрд╕ 2 рдЧреЗрди рдХреА рдорджрдж рд╕реЗ рд╕рдордЭрд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдХреА рдЪрд░реНрдЪрд╛ рдЕрдЧрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдХреА рдЬрд╛рдПрдЧреАред  рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдмрдпрд╛рди рдЦрд┐рд▓рд╛рдбрд╝реА рдХреЛ рд░реЛрд╢рди рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрд╕рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реА рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпрд╛рдВ рд╣реЛрддреА рд╣реИрдВ, рдЬреЛ рдХрд┐ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ - рд▓реЗрдХрд┐рди рджреВрд╕рд░реЗ рднрд╛рдЧ рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  рд╣рдо рдЕрдкрдиреЗ рдЗрдВрдЬреЗрдХреНрд╢рди рдЗрдВрдЬреЗрдХреНрдЯ рд▓рд┐рдЦреЗрдВрдЧреЗред рдЬрд┐рд╕рдореЗрдВ MVC- рдЖрдзрд╛рд░рд┐рдд рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕реЗ Dota 2 рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред Dll рд╣рдорд╛рд░реА рд░реЗрд╢рдо_рд╡реЗ.рд▓рд┐рдм рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛, рдЬрд┐рд╕рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╡рд╛рд╣, рд▓рдХрдбрд╝рд╣рд╛рд░рд╛, рдореЗрдореЛрд░реА рд╕реНрдХреИрдирд░ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реИрдк рд▓реЙрдЬрд┐рдХ рд╣реЛрдЧрд╛ред ред <br><br><h2>  6. рдЗрдВрдЬреЗрдХреНрдЯрд░ </h2><br>  рд░рд┐рдХреНрдд C ++ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдБ, NativeInjector рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред  рдореБрдЦреНрдп рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╣реИред <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp; dllPath, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp; processName)</span></span></span><span class="hljs-function"> </span></span>{ DWORD processId = GetProcessIdentificator(processName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (processId == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> invalid_argument(<span class="hljs-string"><span class="hljs-string">"Process dont existed"</span></span>); HANDLE hProcess = OpenProcess(PROCESS_CREATE_THREAD | PROCESS_QUERY_INFORMATION | PROCESS_VM_OPERATION | PROCESS_VM_READ | PROCESS_VM_WRITE, FALSE, processId); HMODULE hModule = GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>); FARPROC address = GetProcAddress(hModule, <span class="hljs-string"><span class="hljs-string">"LoadLibraryA"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> payloadSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>) * dllPath.length() + <span class="hljs-number"><span class="hljs-number">1</span></span>; LPVOID allocAddress = VirtualAllocEx( hProcess, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, payloadSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE); SIZE_T written; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> writeResult = WriteProcessMemory(hProcess, allocAddress, dllPath.c_str(), payloadSize, &amp; written); DWORD treadId; CreateRemoteThread(hProcess, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, (LPTHREAD_START_ROUTINE) address, allocAddress, <span class="hljs-number"><span class="hljs-number">0</span></span>, &amp; treadId); CloseHandle(hProcess); }</code> </pre> <br>  рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрде рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд╛рдо рдорд┐рд▓рддрд╛ рд╣реИ, GetProcessIdentificator рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдирд╛рдо рд╕реЗ рдЗрд╕рдХреА рдЖрдИрдбреА рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред <br><br><div class="spoiler">  <b class="spoiler_title">рдлрд╝рдВрдХреНрд╢рди GetProcessIdentificator</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">DWORD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetProcessIdentificator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp; processName)</span></span></span><span class="hljs-function"> </span></span>{ PROCESSENTRY32 processEntry; processEntry.dwSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(PROCESSENTRY32); HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); DWORD processId = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Process32First(snapshot, &amp; processEntry)) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Process32Next(snapshot, &amp; processEntry)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_stricmp(processEntry.szExeFile, processName.c_str())) { processId = processEntry.th32ProcessID; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } CloseHandle(snapshot); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> processId; }</code> </pre> <br></div></div><br>  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, GetProcessIdentificator рд╕рднреА рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рд╕реЗ рдЧреБрдЬрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдЪрд┐рдд рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рддрд▓рд╛рд╢ рдХрд░рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/du/za/p1/duzap1ptnhys_gyk_e1zrjm436e.png"><br>  <i>рдЪрд┐рддреНрд░рд╛ 3 - рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐</i> <br><br>  рдЕрдЧрд▓рд╛, рдПрдХ рджреВрд░рд╕реНрде рд╕реНрдЯреНрд░реАрдо рдмрдирд╛рдХрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдкреНрд░рддреНрдпрдХреНрд╖ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиред <br><br><div class="spoiler">  <b class="spoiler_title">рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдорд╛рд░реЛрд╣ рдХреА рд╡рд┐рд╕реНрддреГрдд рд╡реНрдпрд╛рдЦреНрдпрд╛</b> <div class="spoiler_text">  рдорд┐рд▓реА рдЖрдИрдбреА рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдереНрд░реЗрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдУрдкрдирдкреНрд░реЛрд╕реЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЦреЛрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рд▓рд┐рдЦрдиреЗ рдФрд░ рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдкрдврд╝рддрд╛ рд╣реИред  GetModuleHandle рдлрд╝рдВрдХреНрд╢рди рдХрд░реНрдиреЗрд▓ 32 рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЙрдбреНрдпреВрд▓ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдпрд╣ GetProcAddress рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдЗрд╕рдореЗрдВ рд▓реЛрдб рдХрд┐рдП рдЧрдП LoadLibraryA рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  LoadLibrary рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣рдорд╛рд░реЗ рдЗрдВрдЬреЗрдХреНрдЯреЗрдб .ll рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд▓реЛрдб рдХрд░рдирд╛ рд╣реИред  рдпрд╣реА рд╣реИ, рд╣рдореЗрдВ рд╣рдореЗрдВ (тАЬDota2.exeтАЭ) рдХреЛ рдмреНрдпрд╛рдЬ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рд▓реЛрдбрд▓реНрд╡реЗрдЯреНрд╕ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо CreateRemoteThread рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рдереНрд░реЗрдб рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдмрдирд╛рддреЗ рд╣реИрдВред  рдЙрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдирдпрд╛ рдзрд╛рдЧрд╛ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рд╣рдо LoadLibraryA рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рдпрджрд┐ рдЖрдк LoadLibraryA рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЙрд╕реЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЛрдб рдХреА рдЧрдИ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд▓рд┐рдП рдкрде рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ - HMODULE LoadLibraryA (LPCSTR lpLibFileName)ред  рд╣рдо рдЗрд╕ рддрд░реНрдХ рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рджреЗрддреЗ рд╣реИрдВ: CreateRemoteThread рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдкреНрд░рд╛рд░рдВрдн рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдЗрд╕рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо WriteProcessMemory рдлрд╝рдВрдХреНрд╢рди (VirtualAllocExEx рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж) рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдХрд╛ рдорд╛рди рд▓рд┐рдЦрдХрд░ lpLibFileName рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдмрдирд╛рддреЗ рд╣реИрдВред <br></div></div><br><img src="https://habrastorage.org/webt/wx/8r/5v/wx8r5viycrlhjarivk-02dgh124.png"><br>  <i>рдЪрд┐рддреНрд░рд╛ 4 - рдПрдХ рджреВрд░рд╕реНрде рдзрд╛рд░рд╛ рдмрдирд╛рдирд╛</i> <br><br>  CloseHandle рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдЕрдВрдд рдореЗрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИрдВрдбрд▓рд░ рдХреЛ рдмрдВрдж рдХрд░рдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ, рдЖрдк рдЖрд╡рдВрдЯрд┐рдд рдореЗрдореЛрд░реА рдХреЛ рднреА рдореБрдХреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдорд╛рд░рд╛ рдЗрдВрдЬреЗрдХреНрдЯрд░ рддреИрдпрд╛рд░ рд╣реИ рдФрд░ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╝рд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реИ рдХрд┐ рд╣рдо рд╕рд┐рд▓реНрдХ рд▓реЙрд╡реЗ.рд▓рд┐рдм рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд╕рд╛рде рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/no/8c/tr/no8ctrxtn_vz31nad0uj25tb8zs.png"><br>  <i>рдЪрд┐рддреНрд░ 5 - рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛</i> <br><br>  рд╕рд┐рджреНрдзрд╛рдВрдд рдХреА рдмреЗрд╣рддрд░ рд╕рдордЭ рдХреЗ рд▓рд┐рдП, рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реАрдбрд┐рдпреЛ</a> рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдЕрдВрдд рдореЗрдВ, рдореИрдВ рдХрд╣реВрдВрдЧрд╛ рдХрд┐ рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореБрдЦреНрдп рд╕реВрддреНрд░</a> рдореЗрдВ рдХреЛрдб рдХреЗ рдкреНрд░рддреНрдпрдХреНрд╖ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИред <br><br><h2>  7. рд░реЗрд╢рдо рдорд╛рд░реНрдЧ </h2><br>  рдЪрд▓реЛ рд░реЗрд╢рдо_рд╡реЗ.рд▓рд┐рдм рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ рд╕реНрдерд┐рд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЬрд┐рд╕рдореЗрдВ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдВ, рдПрдХ рд▓рдХрдбрд╝рд╣рд╛рд░рд╛, рдПрдХ рдореЗрдореЛрд░реА рд╕реНрдХреИрдирд░ рдФрд░ рдЬрд╛рд▓ рд╣реЛрддреЗ рд╣реИрдВред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдореИрдВрдиреЗ рдЕрдкрдиреЗ рдХрд╛рдо рдХрд╛ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд▓рд┐рдпрд╛, рдХреБрдЫ рдРрд╕рд╛ рдЬрд┐рд╕реЗ рд╕рдмрд╕реЗ рд╕рд░рд▓ рддрд░реАрдХреЗ рд╕реЗ рд╕рдордЭрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдмрд╛рдХреА рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИред <br><br><h3>  7.1ред  рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдВред </h3><br>  рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ: рд╡реЗрдХреНрдЯрд░ - рдХреНрд▓рд╛рд╕рд┐рдХ рд╕реВрдЪреА, рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдФрд░ рд╡рд┐рд▓реЛрдкрди рд╕рдордп рдУ (рдПрди), рдЦреЛрдЬ рдУ (рдПрди), рдореЗрдореЛрд░реА рдУ (рдПрди);  рдХрддрд╛рд░ - рдПрдХ рдкрд░рд┐рдкрддреНрд░ рдХрддрд╛рд░, рдУ (1) рдХреЗ рд╕рдореНрдорд┐рд▓рди рдФрд░ рд╡рд┐рд▓реЛрдкрди рдХрд╛ рд╕рдордп, рдХреЛрдИ рдЦреЛрдЬ рдирд╣реАрдВ, рдореЗрдореЛрд░реА рдУ (рдПрди);  RBTree - рд▓рд╛рд▓-рдХрд╛рд▓рд╛ рдкреЗрдбрд╝, рд╕рдореНрдорд┐рд▓рди рдФрд░ рд╡рд┐рд▓реЛрдкрди рд╕рдордп O (logN), рдЦреЛрдЬ O (logN), рдореЗрдореЛрд░реА O (N)ред  рдореИрдВ C # рдФрд░ рдкрд╛рдпрдерди рдореЗрдВ рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╣реИрд╢ рдХреЛ рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реВрдВ, рдорд╛рдирдХ C ++ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓рд╛рд▓-рдХрд╛рд▓реЗ рдкреЗрдбрд╝ред  рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рд╣реИрд╢ рдПрдХ рдкреЗрдбрд╝ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реИ (рд▓рдЧрднрдЧ рд╣рд░ рдЖрдзреЗ рд╕рд╛рд▓ рдореЗрдВ рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдФрд░ рд╣реИрд╢ рдХреА рдХрд┐рд╕реНрдореЛрдВ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ), рдФрд░ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд╣реИрд╢ рдЕрдзрд┐рдХ рдореЗрдореЛрд░реА рд▓реЗрддрд╛ рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рддреЗрдЬреА рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)ред  рдЗрди рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рдФрд░ рдЬрд╛рд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдореИрдВ рдорд╛рдирдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╕реЗ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реНрд╡рдпрдВ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реВрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрд╣ рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдкрдХрд╛ рдбреАрдПрд▓ рдбреАрдмрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЕрд╕реЗрдВрдмрд▓реА рд╕реНрдкрд╖реНрдЯ рд╣реИ (рдпрд╣ рд╡рд╛рдгрд┐рдЬреНрдпрд┐рдХ рдзреЛрдЦрд╛ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рдХреА рдирд┐рдВрджрд╛ рдЕрдзрд┐рдХ рд╣реИ) )ред  рдореИрдВ рдЖрдкрдХреЛ рд╕рднреА рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ рд╕реНрд╡рдпрдВ рд▓рд┐рдЦрдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВ, рдЗрд╕рд╕реЗ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдЕрд╡рд╕рд░ рдорд┐рд▓рддреЗ рд╣реИрдВред <br>  рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, рдпрджрд┐ рдЖрдк рдПрдХ рдЧреЗрдо рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ "рд╕реНрдХреВрд▓реА рдмрдЪреНрдЪреЗ" рдЗрд╕реЗ рдЪреАрдЯ рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдХреИрди рдХрд░реЗрдВ, рддреЛ рдЖрдк рдкреНрд░рд╛рдЗрдорд░реА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рд░реИрдкрд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореЗрдореЛрд░реА рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб</a> рд╡реИрд▓реНрдпреВ рд╕реНрдЯреЛрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдПрдХ рдореЛрдХреНрд╖ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЙрди рд▓реЛрдЧреЛрдВ рдореЗрдВ рд╕реЗ рдХреБрдЫ рдХреЛ рдорд╛рдд рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЦреЗрд▓ рдХреА рд╕реНрдореГрддрд┐ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рдмрджрд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред <br><br><h3>  7.2ред  рд▓рдХрдбрд╝рд╣рд╛рд░рд╛ </h3><br>  рдХрдВрд╕реЛрд▓ рдХреЗ рд▓рд┐рдП рдЖрдЙрдЯрдкреБрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдФрд░ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗрдВред  рдЗрдВрдЯрд░рдлреЗрд╕: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ILogger</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: ILogger(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * _path) { path = path; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~ILogger() {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * format, ...)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * path; };</code> </pre> <br>  рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MemoryLogger</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ILogger { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: MemoryLogger(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * _path): ILogger(_path) { fopen_s( &amp; fptr, _path, <span class="hljs-string"><span class="hljs-string">"w+"</span></span>); } ~MemoryLogger() { fclose(fptr); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * format, ...)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>[MAX_LOG_SIZE]; <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>[MAX_LOG_SIZE - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; va_list args; va_start(args, format); vsprintf_s(<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>, MAX_LOG_SIZE, format, args); va_end(args); <span class="hljs-built_in"><span class="hljs-built_in">fprintf</span></span>(fptr, <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: FILE * fptr; };</code> </pre> <br>  рдХрдВрд╕реЛрд▓ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕рдорд╛рди рд╣реИред  рдпрджрд┐ рд╣рдо рд▓реЙрдЧрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ ILogger * рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЖрд╡рд╢реНрдпрдХ рд▓рдХрдбрд╝рд╣рд╛рд░рд╛ рдШреЛрд╖рд┐рдд рдХрд░реЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрд╡рд╢реНрдпрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд▓реЙрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ: <br><br><pre> <code class="cpp hljs">ILogger* logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemoryLogger(filename); logger-&gt;Log(<span class="hljs-string"><span class="hljs-string">"(%llu)%s: %d\n"</span></span>, GetCurrentThreadId(), <span class="hljs-string"><span class="hljs-string">"EnumerateThread result"</span></span>, result);</code> </pre> <br><h3>  7.3ред  рд╕реНрдХреИрдирд░ </h3><br>  рд╕реНрдХреИрдирд░ рдЗрд╕ рддрдереНрдп рдореЗрдВ рд▓рдЧрд╛ рд╣реБрдЖ рд╣реИ рдХрд┐ рдпрд╣ рд╣рд╕реНрддрд╛рдВрддрд░рд┐рдд рдкреЙрдЗрдВрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рдореЗрдореЛрд░реА рдореВрд▓реНрдп рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреА рддреБрд▓рдирд╛ рдореЗрдореЛрд░реА рдореЗрдВ рдирдореВрдиреЗ рд╕реЗ рдХрд░рддрд╛ рд╣реИред  рдкреИрдЯрд░реНрди рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдпрд╛рддреНрдордХ рддреБрд▓рдирд╛ рдкрд░ рдмрд╛рдж рдореЗрдВ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдЗрдВрдЯрд░рдлреЗрд╕: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IScanner</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: IScanner() {} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IScanner() {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintMemory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * title, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * memPointer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; };</code> </pre> <br>  рд╣реИрдбрд░ рдлрд╝рд╛рдЗрд▓ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileScanner</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IScanner { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: FileScanner(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* _path) : IScanner() { fopen_s(&amp;fptr, _path, <span class="hljs-string"><span class="hljs-string">"w+"</span></span>); } ~FileScanner() { fclose(fptr); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintMemory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* title, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* memPointer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: FILE* fptr; };</code> </pre> <br>  рд╕реНрд░реЛрдд рдлрд╝рд╛рдЗрд▓ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> FileScanner::PrintMemory(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* title, <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* memPointer, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size) { <span class="hljs-built_in"><span class="hljs-built_in">fprintf</span></span>(fptr, <span class="hljs-string"><span class="hljs-string">"%s:\n"</span></span>, title); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) <span class="hljs-built_in"><span class="hljs-built_in">fprintf</span></span>(fptr, <span class="hljs-string"><span class="hljs-string">"%x "</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(*(memPointer + i))); <span class="hljs-built_in"><span class="hljs-built_in">fprintf</span></span>(fptr, <span class="hljs-string"><span class="hljs-string">"\n"</span></span>, title); }</code> </pre> <br>  рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ IScanner * рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╡рд╛рдВрдЫрд┐рдд рд╕реНрдХреИрдирд░ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░реЗрдВ рдФрд░ PrintMemory рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ, рдЬрд╣рд╛рдВ рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╢реАрд░реНрд╖рдХ, рд╕реВрдЪрдХ рдФрд░ рд▓рдВрдмрд╛рдИ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs">IScanner* scan = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConsoleScanner(); scan-&gt;PrintMemory(<span class="hljs-string"><span class="hljs-string">"source orig"</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*)source, <span class="hljs-number"><span class="hljs-number">30</span></span>);</code> </pre> <br><h3>  7.4ред  рдЬрд╛рд▓ </h3><br>  рд░реЗрд╢рдо рдХрд╛ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣рд┐рд╕реНрд╕рд╛_рд╡реЗ.рд▓рд┐рдм рд▓рд╛рдЗрдмреНрд░реЗрд░реАред  рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдирд╛рдордХ рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рдЬрд╛рд▓ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдбрд┐рд╡рд╛рдЗрд╕ рдХреНрд▓рд╛рд╕ рд╣рдорд╛рд░реА рдбрдореА рд╣реЛрдЧреАред</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Unknown</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: Unknown() {} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: ~Unknown() {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> HRESULT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">QueryInterface</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> ULONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddRef</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> ULONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Release</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Device</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Unknown { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Device() : Unknown() {} ~Device() {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> HRESULT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">QueryInterface</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> ULONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddRef</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> ULONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Release</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Present</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Present()"</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; i &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndScene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> j)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"EndScene()"</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; i &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; j &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Dispose()"</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; i &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; };</code> </pre> <br></div></div><br>  рдбрд┐рд╡рд╛рдЗрд╕ рд╡рд░реНрдЧ IUnogn рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓рд╛ рд╣реИ, рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдп рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдХрд┐рд╕реА рднреА рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╡рд░реНрддрдорд╛рди рдФрд░ рдПрдВрдбрд╕реНрдХреАрди рдХрд╛рд░реНрдпреЛрдВ рдХреА рдХреЙрд▓ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдирд╛ рд╣реИ, рдФрд░ рд░рд┐рд╕реАрд╡рд░ рдореЗрдВ рдореВрд▓ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реИред  рд╣рдореЗрдВ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреЛрдб рдореЗрдВ рдпреЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╣рд╛рдБ рдФрд░ рдХреНрдпреЛрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрд┐рд╕ рдереНрд░реЗрдб рдореЗрдВ рд╣реИред <br><br>  рд╡рд░реНрддрдорд╛рди рдФрд░ рдПрдВрдбрд╕реНрдХрд┐рди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╡реЗ рдЖрднрд╛рд╕реА рд╣реИрдВред  рдЕрднрд┐рднрд╛рд╡рдХ рд╡рд░реНрдЧ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрднрд╛рд╕реА рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╝рдВрдХреНрд╢рдВрд╕, рд╕рд╛рде рд╣реА рдЧреИрд░-рдЖрднрд╛рд╕реА рд╡рд╛рд▓реЗ, рдПрдХ рдореЗрдореЛрд░реА рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдУрдкрдХреЛрдб рдФрд░ рддрд░реНрдХ рдорд╛рди рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВред  рдЪреВрдВрдХрд┐ рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╝рдВрдХреНрд╢рдВрд╕ рд╡рд╛рд░рд┐рд╕ рдФрд░ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреЗ рдмреАрдЪ рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рдЙрдирдХреЗ рдкрд╛рд╕ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреЙрдЗрдВрдЯрд░реНрд╕ рд╣реЛрддреЗ рд╣реИрдВ (рдпреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдлрд╝рдВрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ) рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдореЗрдердб рдЯреЗрдмрд▓ (рд╡реАрдПрдордЯреА) рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред  рдпрд╣ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ рдФрд░ рдХреНрд▓рд╛рд╕ рдкреЙрдЗрдВрдЯрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░ рд╣реИ, рд╣рдо рдЗрд╕реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рдкрд╛рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs">Device* device = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Device(); <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> vmt = **(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>**)&amp;device;</code> </pre> <br>  VMT рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреА рдУрд░ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ, рдЕрдЧрд░ рд╣рдо рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдЗрдирд╣реЗрд░рд┐рдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд╛рд░рд┐рд╕ рдореЗрдВ рдЕрдкрдирд╛ VMT рд╣реЛрдЧрд╛ред  VMT рд╕реНрдЯреЛрд░ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдмрд░рд╛рдмрд░ рдПрдХ рдХрджрдо рдХреЗ рд╕рд╛рде рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИ (x86 рдХреЗ рд▓рд┐рдП рдпрд╣ 4 рдмрд╛рдЗрдЯреНрд╕ рд╣реИ, x64 рдХреЗ рд▓рд┐рдП рдпрд╣ 8 рд╣реИ), рдЙрд╕ рдХреНрд░рдо рдХреЗ рдЕрдиреБрд░реВрдк рдЬрд┐рд╕рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреНрд▓рд╛рд╕ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╡рд░реНрддрдорд╛рди рдФрд░ EndScene рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯрд░реНрд╕ рдЦреЛрдЬреЗрдВ, рдЬреЛ рддреАрд╕рд░реЗ рдФрд░ рдЪреМрдереЗ рд╕реНрдерд╛рди рдкрд░ рд╕реНрдерд┐рдд рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*pPresent)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device*)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*pEndScene)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device*, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> j)</span></span></span></span>; pPresent ptrPresent = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; pEndScene ptrEndScene = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//declare Device and find pointer vmt ptrPresent = (pPresent)(*(unsigned long long*)(vmt + 8 * 3)); ptrEndScene = (pEndScene)(*(unsigned long long*)(vmt + 8 * 4)); }</span></span></code> </pre> <br>  рдпрд╣ рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдХрдХреНрд╖рд╛ рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рд╕реВрдЪрдХ рдХреЛ рд╡рд░реНрдЧ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╕рдВрджрд░реНрдн рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рд▓рд╛ рддрд░реНрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  C ++, C # рдореЗрдВ, рдпрд╣ рд╣рдорд╕реЗ рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╣реИ, рдФрд░ рдХрдВрдкрд╛рдЗрд▓рд░ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирддрд╛ рд╣реИ - рдкрд╛рдпрдерди рдореЗрдВ рд╕реНрд╡рдпрдВ рдХреЛ рдХрдХреНрд╖рд╛ рдкрджреНрдзрддрд┐ рдореЗрдВ рдкрд╣рд▓реЗ рдкреИрд░рд╛рдореАрдЯрд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдмреБрд▓рд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдореНрдореЗрд▓рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рдЖрдкрдХреЛ рдЗрд╕ рдХреЙрд▓ рдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред <br><br>  рдирд┐рд░реНрджреЗрд╢ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ e9 ff 3a fd ff - рдпрд╣рд╛рдБ e9 рдПрдХ рдУрдкрдХреЛрдб (JMP mnemonics рдХреЗ рд╕рд╛рде) рд╣реИ рдЬреЛ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИ (EIP for x86, RIP for x64), рд╡рд░реНрддрдорд╛рди рдкрддреЗ рд╕реЗ FFFD3AFF (4294785791) рдкрд░ рдЬрд╛рдПрдБред  рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдореЗрдореЛрд░реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ "рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд" рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВред  рдлрд╝рдВрдХреНрд╢рдВрд╕ рдореЗрдВ рдПрдХ рдкреНрд░рд╕реНрддрд╛рд╡рдирд╛ рдФрд░ рдЙрдкрд╕рдВрд╣рд╛рд░ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрдиреНрд╣реЗрдВ .code рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╕реНрдХреИрдирд░ рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рд╕реВрдЪрдХ рдХреЛ рд╡рд░реНрддрдорд╛рди рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреНрдпрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs">IScanner* scan = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConsoleScanner(); scan-&gt;PrintMemory(<span class="hljs-string"><span class="hljs-string">"Present"</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*)ptrPresent, <span class="hljs-number"><span class="hljs-number">30</span></span>);</code> </pre> <br>  рдХрдВрд╕реЛрд▓ рдореЗрдВ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">Present: 48 89 4c 24 8 48 83 ec 28 48 8d 15 40 4a 0 0 48 8b d 71 47 0 0 e8 64 10 0 0 48 8d</code> </pre> <br>  рдЗрди рдХреЛрдбреЛрдВ рдХреЗ рд╕реЗрдЯ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рддрд╛рд▓рд┐рдХрд╛</a> рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЙрдкрд▓рдмреНрдз рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдо рдПрдХ рд░реЗрдбреАрдореЗрдб <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">hde</a> (рд╣реИрдХрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░</a> рдЗрдВрдЬрди) рд▓реЗрдВрдЧреЗред  рдЖрдк рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбрд┐рд╕реНрдЯреЙрд░реНрдо</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреИрдкрд╕реНрдЯреЛрди</a> рдХреЛ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдХрд┐рд╕реА рднреА рдЕрд╕рд╣рдорддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реВрдЪрдХ рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдпрд╣ рдХрд╣реЗрдВрдЧреЗ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ opcodes рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддрд░реНрдХреЛрдВ рдХреЗ рдорд╛рди, рдФрд░ рдЗрд╕реА рддрд░рд╣ред <br><br><h4>  7.4.1 рдУрдкрдХреЛрдб рд╣реБрдХ </h4><br>  рдЕрдм рд╣рдо рд╕реАрдзреЗ рдЬрд╛рд▓ рдореЗрдВ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВред  рд╣рдо рдУрдкрдХреЛрдб рд╣реБрдХ рдФрд░ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рджреЗрдЦреЗрдВрдЧреЗред  рд╕рдмрд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЖрдо рдЬрд╛рд▓</a> рдЬреЛ рдореИрдВ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдФрд░ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВред <br><br>  рд╕рдВрднрд╡рддрдГ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдФрд░ рд╕рд░рд▓ рдЬрд╛рд▓ рдУрдкрдХреЛрдб рд╣реБрдХ рд╣реИ (рд▓реЗрдЦ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдЯреНрд░реИрдкреНрд╕ рдореЗрдВ рдЗрд╕реЗ рдмрд╛рдЗрдЯ рдкреИрдЪрд┐рдВрдЧ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ) - рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕рдХрд╛ рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдВрдЯреА-рдЪреАрдЯ рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдмрд┐рдирд╛ рдпрд╣ рд╕рдордЭреЗ рдХрд┐ рдПрдВрдЯреА-рдЪреАрдЯ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдмрд┐рдирд╛ рдХрд┐рд╕ рдХреНрд╖реЗрддреНрд░ рдФрд░ рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрднрд╛рдЧ рдХреЛ рд╕реНрдХреИрди рдХрд┐рдП рдмрд┐рдирд╛ред рд╡рд░реНрддрдорд╛рди рдХреНрд╖рдг рдФрд░ рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рдкреНрд░рддрд┐рдмрдВрдз рд╕реНрд╡рдпрдВ рдХреЛ рдзреАрдорд╛ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреА)ред  рдЬрдм рдХреБрд╢рд▓рддрд╛ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рдорд╣рд╛рди рдЬрд╛рд▓ рд╣реИ, рддреНрд╡рд░рд┐рдд рдФрд░ рд╕рдордЭрдиреЗ рдореЗрдВ рдЖрд╕рд╛рди рд╣реИред <br>  рдпрджрд┐ рдПрдХ рд▓реЗрдЦ рдХреЛ рдкрдврд╝рддреЗ рд╕рдордп рдЖрдк рдПрдХ рд╕рд╛рде рдХреЛрдб рдЦреЗрд▓ рд░рд╣реЗ рд╣реИрдВ рдФрд░ рдбрд┐рдмрдЧ рдореЛрдб рдореЗрдВ рд╣реИрдВ, рддреЛ рд░рд┐рд▓реАрдЬрд╝ рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ - рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред <br><br>  рддреЛ, рдореБрдЭреЗ рдЖрдкрдХреЛ рдпрд╛рдж рджрд┐рд▓рд╛рдирд╛ рд╣реИ, рд╣рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдФрд░ рдПрдВрдбрд╕реНрдХреАрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд░реЛрдХрдирд╛ рд╣реИред <br>  рд╣рдо рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯрд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ - рд╡реЗ рдХрд╛рд░реНрдп рдЬрд╣рд╛рдБ рд╣рдо рдирд┐рдпрдВрддреНрд░рдг рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PresentHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device* device)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"PresentHook"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndSceneHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device* device, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> j)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"EndSceneHook"</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; j &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }</code> </pre> <br>  рдЖрдЗрдП рдЙрди рд╕рд╛рд░ рддрддреНрд╡реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪреЗрдВ рдЬрд┐рдирдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╣рдореЗрдВ рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдПрдХ рдЬрд╛рд▓ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ, рдЗрд╕реЗ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░реЗрдЧрд╛ред  рдЬрд╛рд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди, рд░рд┐рд╕реАрд╡рд░ рдФрд░ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХрд╛ рд╕реВрдЪрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдЗрд╕ рддрдереНрдп рдХреЛ рдХрд┐ рд╣рдордиреЗ рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд┐рдпрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЕрдм рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд╣рдо рднреА рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - рдПрдХ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдореВрд▓ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛)ред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> pack(push, 1) struct HookRecord { HookRecord() { reservationLen = 0; sourceReservation = new void*[RESERV_SIZE](); } ~HookRecord() { reservationLen = 0; delete[] sourceReservation; } void* source; void* destination; void* pTrampoline; int reservationLen; void* sourceReservation; }; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> pack(pop) class IHook { protected: IHook() {} public: virtual ~IHook() {} virtual void SetExceptionHandler( PVECTORED_EXCEPTION_HANDLER pVecExcHandler) = 0; virtual int SetHook(void* source, void* destination) = 0; virtual int UnsetHook(void* source) = 0; virtual silk_data::Vector</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;HookRecord*&gt;* GetInfo() = 0; virtual HookRecord* GetRecordBySource(void* source) = 0; };</span></span></span></span></code> </pre> <br>  IHook рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣рдореЗрдВ рдРрд╕реА рдХреНрд╖рдорддрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЬрдм рдбрд┐рд╡рд╛рдЗрд╕ рд╡рд░реНрдЧ рдХрд╛ рдХреЛрдИ рднреА рдЙрджрд╛рд╣рд░рдг Present and EndScene рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗ (рдпрд╛рдиреА RIP рдкреЙрдЗрдВрдЯрд░ рдЗрди рдкрддреЛрдВ рдкрд░ рдЬрд╛рддрд╛ рд╣реИ), рд╣рдорд╛рд░реЗ PresentHook рдФрд░ EndSceneHook рдлрд╝рдВрдХреНрд╢рди рдХреЛ рддрджрдиреБрд╕рд╛рд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди, рд░рд┐рд╕реАрд╡рд░ рдФрд░ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХрд┐рд╕ рд╕рдордп рдореЗрдореЛрд░реА (.code рд╕реЗрдХреНрд╢рди) рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИрдВ, рдЬрдм рдирд┐рдпрдВрддреНрд░рдг рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/rc/sz/dw/rcszdw_mh77t0jlxithbmseq5i8.png"><br>  <i>рдЪрд┐рддреНрд░рд╛ 6 - рд╕реНрдореГрддрд┐ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐, рдирд┐рд╖реНрдкрд╛рджрди рдЕрд╡рд░реЛрдзрди рд╕рдорд╛рд░реЛрд╣ рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИ</i> <br><br>  рдЕрдм рд╣рдо рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ RIP (рд▓рд╛рд▓ рддреАрд░) рд╕реНрд░реЛрдд рд╕реЗ рдЧрдВрддрд╡реНрдп рдХреА рд╢реБрд░реБрдЖрдд рддрдХ рдЬрд╛рдПред  рдпрд╣ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ?  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рд╣реА рдКрдкрд░ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рд╕реНрд░реЛрдд рдореЗрдореЛрд░реА рдореЗрдВ рдПрдХ рдУрдкрдХреЛрдб рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдкреНрд░реЛрд╕реЗрд╕рд░ рддрдм рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдирд┐рд╖реНрдкрд╛рджрди рд╕реНрд░реЛрдд рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рд╣рдореЗрдВ рдЖрд░рдЖрдИрдкреА рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рднрд╛рдЧ рд╕реЗ рджреВрд╕рд░реЗ рднрд╛рдЧ рдореЗрдВ рдХреВрджрдирд╛ рд╣реЛрдЧрд╛ред  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рдУрдкрдХреЛрдб рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рд╡рд░реНрддрдорд╛рди рдкрддреЗ рд╕реЗ рд╡рд╛рдВрдЫрд┐рдд рдПрдХ рдХреЛ рдирд┐рдпрдВрддреНрд░рдг рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдпрд╣ рдЬреЗрдПрдордкреА mnemonics рдХрд╣рд▓рд╛рддрд╛ рд╣реИред <br><br>  рдЖрдк рд╕реАрдзреЗ рдЗрдЪреНрдЫрд┐рдд рдкрддреЗ рдкрд░ рдХреВрдж рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рд╡рд░реНрддрдорд╛рди рдкрддреЗ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖, рдпреЗ рдЫрд▓рд╛рдВрдЧреЗрдВ рдХреНрд░рдорд╢рдГ рдкреНрд▓реЗрдЯ - рдПрдлрдПрдл рдФрд░ рдИ 9 рдореЗрдВ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред  рдЗрди рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд░рдЪрдирд╛рдПрдБ рдмрдирд╛рдПрдБ: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> pack(push, 1) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 32-bit relative jump. typedef struct { unsigned char opcode; unsigned int delta; } JMP_REL; // 64-bit absolute jump. typedef struct { unsigned char opcode1; unsigned char opcode2; unsigned int dummy; unsigned long long address; } JMP_ABS; #pragma pack(pop)</span></span></span></span></code> </pre> <br>  рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрджрдиреЗ рдХрд╛ рдирд┐рд░реНрджреЗрд╢ рдЫреЛрдЯрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд╕реАрдорд╛ рд╣реИ - рдЕрд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд int рдХрд╛ рдХрд╣рдирд╛ рд╣реИ рдХрд┐ рдЖрдк 4,294,967,295 рдХреЗ рднреАрддрд░ рдХреВрдж рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ x64 рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИред <br>  рддрджрдиреБрд╕рд╛рд░, рдЧрдВрддрд╡реНрдп рд░рд┐рд╕реАрд╡рд░ рдХрд╛ рдЧрдВрддрд╡реНрдп рдлрд╝рдВрдХреНрд╢рди рдкрддрд╛ рдЖрд╕рд╛рдиреА рд╕реЗ рдЗрд╕ рдорд╛рди рдХреЛ рдкрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЗрдВрдЯ рдХреЗ рдмрд╛рд╣рд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ x64 рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдХрд╛рдлреА рд╕рдВрднрд╡ рд╣реИ (x86 рдХреЗ рд▓рд┐рдП рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ рдФрд░ рдЖрдк рдУрдкрд┐рди рд╣реБрдХ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдЗрд╕ рдмрд╣реБрдд рд╣реА рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рддрдХ рд╕реАрдорд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред  рдПрдХ рд╕реАрдзреА рдЫрд▓рд╛рдВрдЧ рдореЗрдВ 14 рдмрд╛рдЗрдЯреНрд╕ рд▓рдЧрддреЗ рд╣реИрдВ, рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рдХреЗрд╡рд▓ 5 рд╣реИ (рд╣рдордиреЗ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ рдкреИрдХ рдХрд┐рдпрд╛ рд╣реИ, #pragma рдкреИрдХ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ (рдзрдХреНрдХрд╛, 1))ред <br><br>  рд╣рдореЗрдВ рдЗрди рд╣реЙрдк рдирд┐рд░реНрджреЗрд╢реЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЗ рд▓рд┐рдП рд╕реНрд░реЛрдд рдкрд░ рдорд╛рди рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛ред <br>  рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрдХрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдЗрд╕рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП - рдРрд╕рд╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдПрдХ рдбрд┐рдмрдЧрд░ рдХреА рдорджрдж рд╕реЗ рд╣реИ (рдореИрдВ рдЖрдкрдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реВрдВ рдХрд┐ рдЗрд╕реЗ x64dbg рдХреЗ рд╕рд╛рде рдмрд╛рдж рдореЗрдВ рдХреИрд╕реЗ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП), рдпрд╛ рдПрдХ рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░ред  рд╡рд░реНрддрдорд╛рди рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ 30 рдмрд╛рдЗрдЯреНрд╕ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддреЗ рд╣реИрдВ, рдирд┐рд░реНрджреЗрд╢ 48 89 4c 24 8 рдореЗрдВ 5 рдмрд╛рдЗрдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВред <br>  рдЪрд▓реЛ рдПрдХ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрдж рд▓рд╛рдЧреВ рдХрд░реЗрдВред  рдирд┐рд░реНрджреЗрд╢ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдХрд╛рд░рдг рдореБрдЭреЗ рдпрд╣ рд╡рд┐рдХрд▓реНрдк рдЕрдзрд┐рдХ рдкрд╕рдВрдж рд╣реИред  рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ: рд╣рдо рдореВрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрд╣рд▓реЗ 5 рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдмрджрд▓ рджреЗрддреЗ рд╣реИрдВ, рдмрджрд▓реЗ рд╣реБрдП рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдирд┐рд░реНрджреЗрд╢ рдкрддреЗ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЕрд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЗрдВрдЯ рдХреЗ рднреАрддрд░ рд╕реНрдерд┐рдд рд╣реИред <br><br><img src="https://habrastorage.org/webt/sp/vm/gs/spvmgsf5iymwkeyncackpgaldty.png"><br>  <i>рдЪрд┐рддреНрд░ 7 - рд╕реНрд░реЛрдд рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕реНрд░реЛрдд 5 рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> <br><br>  рдЬреЛ рд╣рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд рдореЗрдореЛрд░реА (рдмреИрдВрдЧрдиреА рдХреНрд╖реЗрддреНрд░) рдХреЗ рд▓рд┐рдП рдХреВрджрддрд╛ рд╣реИ, рд╣рдо рдЗрд╕ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЗ рд╕рд╛рде рдЧрдВрддрд╡реНрдп рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЦреБрдж рдХреЛ рдХреИрд╕реЗ рдХрд░реАрдм рд▓рд╛рдП?  рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рдВрдЯрд┐рдд рдореЗрдореЛрд░реА рдореЗрдВ, рдПрдХ рд╕реАрдзреА рдЫрд▓рд╛рдВрдЧ рд╣реИ, рдЬреЛ рдЖрд░рдЖрдИрдкреА рдХреЛ рдЧрдВрддрд╡реНрдп рддрдХ рд▓реЗ рдЬрд╛рдПрдЧреАред <br><br><img src="https://habrastorage.org/webt/nl/-c/u2/nl-cu2sfhlsg-7nvfdmkzmlz8fq.png"><br>  <i>рдЪрд┐рддреНрд░ 8 - рдЖрд░рдЖрдИрдкреА рдХреЛ рд░рд┐рд╕реАрд╡рд░ рдлрд╝рдВрдХреНрд╢рди рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛</i> <br><br>  рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд░рд╣рддрд╛ рд╣реИ рдХрд┐ рдкрдХрдбрд╝реЗ рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреИрд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПред  рд╣рдореЗрдВ рдЬрд╛рдо рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдФрд░ рд╕реНрд░реЛрдд рдХреЗ рдЕрдЫреВрддреЗ рд╣рд┐рд╕реНрд╕реЗ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╣рдо рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВ - рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдЯреНрд░реИрдореНрдкреЛрд▓рд┐рди рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ, рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдХрд┐рддрдиреЗ рдмрд╛рдЗрдЯреНрд╕ рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рд╣реЛ рдЧрдП рдереЗ рдФрд░ "рд╕реНрд╡рд╕реНрде" рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рд╕реНрд░реЛрдд + рднреНрд░рд╖реНрдЯ рдореЗрдВ рдХреВрдж рдЧрдПред <br><br>  рдПрдХ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдЫрд▓рд╛рдВрдЧ рджреНрд╡рд╛рд░рд╛ рдорд┐рдЯрд╛рдП рдЧрдП рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди: <br><br><img src="https://habrastorage.org/webt/ea/yt/yc/eaytyckn1czk5ud3iid3fagbey0.png"><br>  <i>рдЪрд┐рддреНрд░ 9 - рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</i> <br><br>  рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдЖрдЧреЗ рдирд┐рд╖реНрдкрд╛рджрди рдЬреЛ рдореИрд╢рд┐рдВрдЧ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/mh/7f/-w/mh7f-wck4tzh20cj7jefie3yl3q.png"><br>  <i>рдЪрд┐рддреНрд░рд╛ 10 - рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдирд┐рд░рдВрддрд░ рдирд┐рд╖реНрдкрд╛рджрди</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╡рд┐рдЪрд╛рд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> OpcodeHook::SetHook(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* source, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* destination) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HookRecord(); record-&gt;source = source; record-&gt;destination = destination; info-&gt;PushBack(record); JMP_ABS pattern = {<span class="hljs-number"><span class="hljs-number">0xFF</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x00000000</span></span>, <span class="hljs-comment"><span class="hljs-comment">// JMP[RIP + 6] empty 0x0000000000000000 }; // absolute address pattern.address = (ULONG_PTR)source; int currentLen = 0; int redLine = sizeof(JMP_REL); while (currentLen &lt; redLine) { hde64s context; const void* pSource = (void*)((unsigned char*)source + currentLen); hde64_disasm(pSource, &amp;context); memcpy((unsigned char*)record-&gt;sourceReservation + currentLen, pSource, context.len); record-&gt;reservationLen += context.len; currentLen += context.len; } int trampolineMemorySize = 2 * sizeof(JMP_ABS) + record-&gt;reservationLen; record-&gt;pTrampoline = AllocateMemory(source, trampolineMemorySize); pattern.address = (unsigned long long)(unsigned char*)source + record-&gt;reservationLen; memcpy((unsigned char*)record-&gt;pTrampoline, record-&gt;sourceReservation, record-&gt;reservationLen); int offset = record-&gt;reservationLen; memcpy((unsigned char*)record-&gt;pTrampoline + offset, &amp;pattern, sizeof(JMP_ABS)); pattern.address = (ULONG_PTR)destination; ULONG_PTR relay = (ULONG_PTR)record-&gt;pTrampoline + sizeof(pattern) + record-&gt;reservationLen; memcpy((void*)relay, &amp;pattern, sizeof(pattern)); DWORD oldProtect = 0; VirtualProtect(source, sizeof(JMP_REL), PAGE_EXECUTE_READWRITE, &amp;oldProtect); JMP_REL* pJmpRelPattern = (JMP_REL*)source; pJmpRelPattern-&gt;opcode = 0xE9; pJmpRelPattern-&gt;delta = (unsigned int)((LPBYTE)relay - ((LPBYTE)source + sizeof(JMP_REL))); VirtualProtect(source, sizeof(JMP_REL), oldProtect, &amp;oldProtect); return SUCCESS_CODE; }</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">рд╕рдорд╛рд░реЛрд╣ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ SetHook</b> <div class="spoiler_text">  рдПрдХ рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЬрд╛рд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд░рд┐рдХреЙрд░реНрдб рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕реНрд░реЛрдд рдкрддреЗ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдирд┐рд░реНрджреЗрд╢ рдХреНрд░реЙрд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рдЕрдиреБрджреЗрд╢ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреНрд░рд╡реЗрд╢ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ (5 рдмрд╛рдЗрдЯреНрд╕), рдЬрд╛рдо рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдЖрд░рдХреНрд╖рдг рдореЗрдВ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрдирдХреА рд▓рдВрдмрд╛рдИ рдпрд╛рдж рдХреА рдЬрд╛рддреА рд╣реИред <br><blockquote>  рдПрдХ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдФрд░ рд░рд┐рд▓реЗ рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣рдо рд╕реНрд░реЛрдд рд╕реЗ рдЧрдВрддрд╡реНрдп рддрдХ рдзрд╛рд░рд╛ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕ рдореЗрдореЛрд░реА рдХреЗ рд▓рд┐рдП рдкрддрд╛ рд╕реАрдорд╛ рдХреЗ рднреАрддрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдПрдХ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрджрдиреЗ рдХреЗ рд▓рд┐рдП рдХреВрдж рд╕рдХрддрд╛ рд╣реИ (рдЕрд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд) рдкреВрд░реНрдгрд╛рдВрдХ)ред </blockquote><br>  рдпрд╣ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ AllocateMemory рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИред <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* OpcodeHook::AllocateMemory(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* origin, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MEMORY_RANGE = <span class="hljs-number"><span class="hljs-number">0x40000000</span></span>; SYSTEM_INFO sysInfo; GetSystemInfo(&amp;sysInfo); ULONG_PTR minAddr = (ULONG_PTR)sysInfo.lpMinimumApplicationAddress; ULONG_PTR maxAddr = (ULONG_PTR)sysInfo.lpMaximumApplicationAddress; ULONG_PTR castedOrigin = (ULONG_PTR)origin; ULONG_PTR minDesired = castedOrigin - MEMORY_RANGE; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (minDesired &gt; minAddr &amp;&amp; minDesired &lt; castedOrigin) minAddr = minDesired; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> test = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ULONG_PTR); ULONG_PTR maxDesired = castedOrigin + MEMORY_RANGE - size; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (maxDesired &lt; maxAddr &amp;&amp; maxDesired &gt; castedOrigin) maxAddr = maxDesired; DWORD granularity = sysInfo.dwAllocationGranularity; ULONG_PTR freeMemory = <span class="hljs-number"><span class="hljs-number">0</span></span>; ULONG_PTR ptr = castedOrigin; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (ptr &gt;= minAddr) { ptr = FindPrev(ptr, minAddr, granularity, size); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; LPVOID pAlloc = VirtualAlloc((LPVOID)ptr, size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pAlloc != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pAlloc; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (ptr &lt; maxAddr) { ptr = FindNext(ptr, maxAddr, granularity, size); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; LPVOID pAlloc = VirtualAlloc((LPVOID)ptr, size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pAlloc != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pAlloc; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; }</code> </pre> <br>  рд╡рд┐рдЪрд╛рд░ рд╕рд░рд▓ рд╣реИ - рд╣рдо рд╕реНрдореГрддрд┐ рд╕реЗ рдЬрд╛рдПрдВрдЧреЗ, рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдкрддреЗ рд╕реЗ рд╢реБрд░реВ (рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рд╕реНрд░реЛрдд рдХреЗ рд▓рд┐рдП рд╕реВрдЪрдХ) рдКрдкрд░ рдФрд░ рдиреАрдЪреЗ рддрдм рддрдХ рдЬрдм рддрдХ рдХрд┐ рд╣рдо рд╕реНрд╡рддрдВрддреНрд░ рдЖрдХрд╛рд░ рдХрд╛ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдЯреБрдХрдбрд╝рд╛ рди рдорд┐рд▓ рдЬрд╛рдПред <br><br>  рд╡рд╛рдкрд╕ SetHook рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдПред  рдЖрд╡рдВрдЯрд┐рдд рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рд╕реНрд░реЛрдд рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдореЗрдореЛрд░реА рдореЗрдВ рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдирд┐рд░реНрджреЗрд╢ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рддреБрд░рдВрдд рд╕реНрд░реЛрдд + рднреНрд░рд╖реНрдЯ рдореЗрдВ рд╕реАрдзреЗ рдХреВрдж рдбрд╛рд▓реЗрдВред <br><br>  рдЕрдЧрд▓рд╛ рд░рд┐рд▓реЗ рдкреЙрдЗрдВрдЯрд░ рдХреА рд╕реНрдерд╛рдкрдирд╛ рд╣реИ, рдЬреЛ рд╕реАрдзреЗ рд░рд┐рд╕реАрд╡рд░ рдХреЗ рдкрддреЗ рдкрд░ рдХреВрджрдХрд░ рдЧрдВрддрд╡реНрдп рддрдХ рдирд┐рд╖реНрдкрд╛рджрди рдереНрд░реЗрдб рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред  рдЕрдВрдд рдореЗрдВ, рд╣рдо рд╕реНрд░реЛрдд рдмрджрд▓рддреЗ рд╣реИрдВ - рд╣рдо рдореЗрдореЛрд░реА рдХреЗ рд╕реНрдерд╛рди рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬрд╣рд╛рдВ рдлрд╝рдВрдХреНрд╢рди рд╕реНрдерд┐рдд рд╣реИ рдФрд░ рд░рд┐рд▓реЗ рдкрддреЗ рдкрд░ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрдж рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ 5 рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдмрджрд▓реЗрдВред <br></div></div><br>  рд╣рдо рдПрдХ рдЬрд╛рд▓ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рднреА рд╕рд╛рдл рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдмреНрд░реЗрдХрд┐рдВрдЧ - рдирд┐рд░реНрдорд╛рдг рдирд╣реАрдВ, рд╡рд┐рдЪрд╛рд░ рд╕рд░рд▓ рд╣реИ - рд╣рдо рд╕реНрд░реЛрдд рдХреЗ рдЬрд░реНрдЬрд░ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдВрдЧреЗ, рд╕рдВрдЧреНрд░рд╣ рд╕реЗ рдЬрд╛рд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХреЛ рд╣рдЯрд╛ рджреЗрдВ, рдФрд░ рдЖрд╡рдВрдЯрд┐рдд рдореЗрдореЛрд░реА рдХреЛ рдореБрдХреНрдд рдХрд░реЗрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> OpcodeHook::UnsetHook(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* source) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = GetRecordBySource(source); DWORD oldProtect = <span class="hljs-number"><span class="hljs-number">0</span></span>; VirtualProtect(source, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(JMP_REL), PAGE_EXECUTE_READWRITE, &amp;oldProtect); <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(source, record-&gt;sourceReservation, record-&gt;reservationLen); VirtualProtect(source, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(JMP_REL), oldProtect, &amp;oldProtect); info-&gt;Erase(record); FreeMemory(record); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SUCCESS_CODE; }</code> </pre> <br>  рдХрд╛рд░реНрдп рдХрд╛ рдкрд░реАрдХреНрд╖рдгред  рддреБрд░рдВрдд рд╣рдорд╛рд░реЗ рд░рд┐рд╕реАрд╡рд░ рдХреЛ рдмрджрд▓ рджреЗрдВ рддрд╛рдХрд┐ рд╡реЗ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХреЗрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PresentHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device* device)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = hook-&gt;GetRecordBySource(ptrPresent); pPresent pTrampoline = (pPresent)record-&gt;pTrampoline; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> result = pTrampoline(device); <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"PresentHook"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndSceneHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device* device, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> j)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = hook-&gt;GetRecordBySource(ptrEndScene); pEndScene pTrampoline = (pEndScene)record-&gt;pTrampoline; pTrampoline(device, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"EndSceneHook"</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; j &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╣рдордиреЗ рд╕рдм рдХреБрдЫ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд┐рдпрд╛ рд╣реИ, рдХреНрдпрд╛ рд╕реНрдореГрддрд┐ рдмрд╣ рд░рд╣реА рд╣реИ, рдХреНрдпрд╛ рд╕рдм рдХреБрдЫ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { Device* device = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Device(); device-&gt;i = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> vmt = **(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>**)&amp;device; ptrPresent = (pPresent)(*(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>*)(vmt + <span class="hljs-number"><span class="hljs-number">8</span></span> * <span class="hljs-number"><span class="hljs-number">3</span></span>)); ptrEndScene = (pEndScene)(*(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>*)(vmt + <span class="hljs-number"><span class="hljs-number">8</span></span> * <span class="hljs-number"><span class="hljs-number">4</span></span>)); IScanner* scan = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConsoleScanner(); scan-&gt;PrintMemory(<span class="hljs-string"><span class="hljs-string">"Present"</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*)ptrPresent, <span class="hljs-number"><span class="hljs-number">30</span></span>); hook = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OpcodeHook(); hook-&gt;SetHook(ptrPresent, &amp;PresentHook); hook-&gt;SetHook(ptrEndScene, &amp;EndSceneHook); device-&gt;Present(); device-&gt;EndScene(<span class="hljs-number"><span class="hljs-number">7</span></span>); device-&gt;Present(); device-&gt;EndScene(<span class="hljs-number"><span class="hljs-number">7</span></span>); device-&gt;i = <span class="hljs-number"><span class="hljs-number">5</span></span>; ptrPresent(device); ptrEndScene(device, <span class="hljs-number"><span class="hljs-number">9</span></span>); hook-&gt;UnsetHook(ptrPresent); hook-&gt;UnsetHook(ptrEndScene); ptrPresent(device); ptrEndScene(device, <span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> hook; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> device; } }</code> </pre> <br></div></div><br>  рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдЕрддрд┐рд░рд┐рдХреНрдд рд░реВрдк рд╕реЗ x64dgb рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛рдж рд░рдЦреЗрдВ, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдореИрдВрдиреЗ рдЖрдкрдХреЛ рд░рд┐рд▓реАрдЬрд╝ рдмрд┐рд▓реНрдб рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ рдерд╛? </font><font style="vertical-align: inherit;">рдЕрдм рдбрд┐рдмрдЧ рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЪрд▓рд╛рдПрдВред </font><font style="vertical-align: inherit;">рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ ... рдЬрд╛рд▓ рдЯреНрд░рд┐рдЧрд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдПрдХ рдЕрдкрд╡рд╛рдж рдЙрдард╛рддрд╛ рд╣реИ, рдЬреЛ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдЬрд┐рд╕ рдкрддреЗ рдкрд░ рд╣рдо рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХрд╣рддреЗ рд╣реИрдВ рд╡рд╣ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдмрд┐рд▓реНрдХреБрд▓ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдХреНрдпрд╛ рдпрд╛рдж рдЖрдпрд╛? </font><font style="vertical-align: inherit;">рдбрд┐рдмрдЧ рдмрд┐рд▓реНрдб рдХреА рд╕рдорд╕реНрдпрд╛ рдХреНрдпрд╛ рд╣реИ? </font><font style="vertical-align: inherit;">рд╣рдо рд╡рд░реНрддрдорд╛рди рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдУрдкрдХреЛрдб рдХреЛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦрддреЗ рд╣реИрдВ:</font></font><br><br><pre> <code class="plaintext hljs">Present: e9 f4 36 0 0 e9 df 8d 0 0 e9 aa b0 0 0 e9 75 3e 0 0 e9 80 38 0 0 e9 da 81 0 0</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм x64dbg рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реЛ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 11 - рдбреАрдмрдЧ рдирд┐рд░реНрдорд╛рдг рдирд┐рд░реНрджреЗрд╢</font></i><font style="vertical-align: inherit;"> рдбреАрдмрдЧ рдореЗрдВ, рдУрдкрдХреЛрдб рдмрджрд▓ рдЧрдпрд╛ рд╣реИ, рдЕрдм рд╕рдВрдХрд▓рдХ рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рдИ 9 рдПрдл 4 36 рдЬреЛрдбрд╝рддрд╛ рд╣реИред рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдореБрдЦреНрдп рдФрд░ рдПрдВрдЯреНрд░реА рдкреЙрдЗрдВрдЯ рдЯреВ рдореЗрдирдЯреНрд░реЗрдЯрд░реНрдЯрдЕрдк рд╕рд╣рд┐рдд рдХреВрдж рдореЗрдВ рд▓рдкреЗрдЯрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдФрд░ рдУрдкрдХреЛрдб, рдареАрдХ рд╣реИ, рдареАрдХ рд╣реИ, рдЗрд╕реЗ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдореЗрдВ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдерд╛, рдЬрдм рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЗрд╕ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрдж рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдлрд┐рд░ рд╕реНрд░реЛрдд рдХреЗ undamaged рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реАрдзрд╛ рдХреВрджред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣рдордиреЗ рдЬреЛ рднреА рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ рд╡рд╣ рд╕рдм рдХреБрдЫ рд╣реИ, рдХреЗрд╡рд▓ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрджрддрд╛ рд╣реИ рдФрд░ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдПрдХ, рдХрд┐ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкрддреЗ, рд╕реНрд░реЛрдд рдФрд░ рдЯреНрд░реИрдореНрдкреЛрд▓рд┐рди рд╕реЗ рдЗрд╕рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди, рдЖрд░рдЖрдИрдкреА рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореВрд▓реНрдпреЛрдВ рд╕реЗ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/sq/ql/ea/sqqlealqgipytxtvqo65agm9ky8.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрд░реЗ рд╡рд┐рдирдореНрд░ рдЕрдиреБрднрд╡ рдореЗрдВ, рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрдж рдорд╛рдорд▓реЗ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ 99% рдЙрдкрдпреЛрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдХрдИ рдФрд░ рдЕрдзрд┐рдХ opcodes рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрд▓рдЧ рд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдПрдХ рдЬрд╛рд▓ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдмрд╣реБрдд рдЖрд▓рд╕реА рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдореИрдВ рдЖрдкрдХреЛ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ рдФрд░ 100 рдкреНрд░рддрд┐рд╢рдд рд╕рдВрд╕реНрдХрд░рдг (рдлрд┐рд░ рд╕реЗ, рдореЗрд░реЗ рд╡рд┐рдирдореНрд░ рдЕрдиреБрднрд╡ рдореЗрдВ) рдореЗрдВ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдЬреЛрдбрд╝реВрдВрдЧрд╛, рдЕрдЧрд░ рдЖрдкрдХреЛ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдпрд╛ рд░реБрдЪрд┐ рд╣реИ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХреИрд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╡реЗ рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ - рдпрд╣ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛрдЧрд╛ рдЕрдЧрд░ рдЖрдкрдХреЛ рдкрддрд╛ рдЪрд▓ рдЧрдпрд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрдж рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХрд╛рдлреА рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд░рддрд╛ рд╣реВрдВред </font><font style="vertical-align: inherit;">рдПрдХ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдХреВрдж рдореЗрдВ рдИ 9 рдУрдкрдХреЛрдб рдФрд░ рдореВрд▓реНрдп рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдХреЛ рд╡рд░реНрддрдорд╛рди рдкрддреЗ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрджрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рддрджрдиреБрд╕рд╛рд░, рдЖрдк рдмрд╕ рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрд╣рд╛рдВ рдХреВрджрдирд╛ рд╣реИ, рдФрд░ рд╕реАрдзреЗ рдХреВрдж рдХреЗ рд╕рд╛рде рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рд╕реЗ рд╡рд╣реАрдВ рдХреВрджрдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рд╣рдо рдПрдХ рдирдП рд░рд┐рд╢реНрддреЗрджрд╛рд░ рд╕реЗ рдорд┐рд▓рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд╣реА рдкрддреЗ рдкрд░ рд╣реЛрдЧрд╛ред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдкреЗрдХреНрд╖ рдХреВрдж рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП рдЬрд╛рд▓ рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> OpcodeHook::SetHook(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* source, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* destination) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HookRecord(); record-&gt;source = source; record-&gt;destination = destination; info-&gt;PushBack(record); JMP_ABS pattern = {<span class="hljs-number"><span class="hljs-number">0xFF</span></span>, <span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x00000000</span></span>, <span class="hljs-comment"><span class="hljs-comment">// JMP[RIP + 6] empty 0x0000000000000000 }; // address pattern.address = (ULONG_PTR)source; int currentLen = 0; bool isJmpOpcode = false; int redLine = sizeof(JMP_REL); while (currentLen &lt; redLine &amp;&amp; !isJmpOpcode) { hde64s context; const void* pSource = (void*)((unsigned char*)source + currentLen); hde64_disasm(pSource, &amp;context); if (context.opcode == 0xE9) { ULONG_PTR ripPtr = (ULONG_PTR)pSource + context.len + (INT32)context.imm.imm32; pattern.address = ripPtr; isJmpOpcode = true; } memcpy((unsigned char*)record-&gt;sourceReservation + currentLen, pSource, context.len); record-&gt;reservationLen += context.len; currentLen += context.len; } int trampolineMemorySize = isJmpOpcode ? 2 * sizeof(JMP_ABS) : 2 * sizeof(JMP_ABS) + record-&gt;reservationLen; record-&gt;pTrampoline = AllocateMemory(source, trampolineMemorySize); if (!isJmpOpcode) { pattern.address = (unsigned long long)(unsigned char*)source + record-&gt;reservationLen; memcpy((unsigned char*)record-&gt;pTrampoline, record-&gt;sourceReservation, record-&gt;reservationLen); } int offset = isJmpOpcode ? 0 : record-&gt;reservationLen; memcpy((unsigned char*)record-&gt;pTrampoline + offset, &amp;pattern, sizeof(JMP_ABS)); pattern.address = (ULONG_PTR)destination; ULONG_PTR relay = (ULONG_PTR)record-&gt;pTrampoline + sizeof(pattern) + record-&gt;reservationLen; memcpy((void*)relay, &amp;pattern, sizeof(pattern)); DWORD oldProtect = 0; VirtualProtect(source, sizeof(JMP_REL), PAGE_EXECUTE_READWRITE, &amp;oldProtect); JMP_REL* pJmpRelPattern = (JMP_REL*)source; pJmpRelPattern-&gt;opcode = 0xE9; pJmpRelPattern-&gt;delta = (unsigned int)((LPBYTE)relay - ((LPBYTE)source + sizeof(JMP_REL))); VirtualProtect(source, sizeof(JMP_REL), oldProtect, &amp;oldProtect); return SUCCESS_CODE; }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдХрдорд╛рдВрдб рдХрд╛ opcode e9 рд╣реИ, рддреЛ рд╣рдо (ULONG_PTR ripPtr = (ULONG_PTR) pSource + рд╕рдВрджрд░реНрдн.len + (INT32) рд╕рдВрджрд░реНрдн: .imm.imm32) рдкрд░ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрддреЗ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдореЗрдВ рдкрддрд╛ рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдкреНрд░рддреНрдпрдХреНрд╖ рдХреВрдж рддрд░реНрдХ рдХреЗ рдореВрд▓реНрдп рдХреЗ рд░реВрдк рдореЗрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрддрд╛ рд╣реВрдВ рдХрд┐ рдПрдХ рдмрд╣реБ-рдереНрд░реЗрдбреЗрдб рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ, рдПрдХ рд╣реБрдХ рд▓рдЧрд╛рдиреЗ / рд╣рдЯрд╛рдиреЗ рдХреЗ рд╕рдордп рдПрдХ рд╕реНрдерд┐рддрд┐ рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИ, рдереНрд░реЗрдбреНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рдЙрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдкрдХрдбрд╝рддреЗ рд╣реИрдВ - рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЧрд┐рд░ рдЬрд╛рдПрдЧреАред рдЗрд╕рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рд╕рд┐рджреНрдз рдЙрдкрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЖрдк рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХрд╛ рдЬрд╛рд▓ рдХрд╛рдо рдХрд░реЗрдЧрд╛, рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдкрдиреЗ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рдЖрдк рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд╛ рдЕрдзреНрдпрдпрди рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - рддреИрдпрд╛рд░ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Microsoft рдЕрдкрдиреА рд╕реНрд╡рдпрдВ рдХреА рдбреЗрдЯрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдореИрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реВрдВ рдФрд░ рдХрдИ рдХрд╛рд░рдгреЛрдВ рд╕реЗ рдПрдХ рдорд╛рд▓рд┐рдХрд╛рдирд╛ рд╕рдорд╛рдзрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдХреБрдЫ рд╕рд▓рд╛рд╣ рдирд╣реАрдВ рджреЗ рд╕рдХрддрд╛, рдореИрдВ рдХреЗрд╡рд▓ рдХреБрдЫ рдирдпрд╛ рдЦреЛрдЬрдиреЗ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЕрдзреНрдпрдпрди рдХрд┐рдП рдЧрдП рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдирд╛рдо рджреЗ рд╕рдХрддрд╛ рд╣реВрдВ: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЙрд▓рд╣реВрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд┐рдирд╣реВрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдЬреАрдмреВрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ) рдЕрдЧрд░ рдЖрдкрдХреЛ C # рдореЗрдВ рд╣реБрдХ рдХреА рдЬрд░реВрд░рдд рд╣реИ)ред</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.4.2ред </font><font style="vertical-align: inherit;">рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдУрдкрдХреЛрдб рд╣реБрдХ рдПрдХ рд╕рд░рд▓ рдФрд░ рддреНрд╡рд░рд┐рдд рдЬрд╛рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдмрд╕реЗ рдХреБрд╢рд▓ рдирд╣реАрдВ рд╣реИред рдПрдХ рдПрдВрдЯреА-рдЪреАрдЯ рдЖрд╕рд╛рдиреА рд╕реЗ рдореЗрдореЛрд░реА рдХреЗ рдПрдХ рдЯреБрдХрдбрд╝реЗ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХреЛ рдЯреНрд░реИрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдУрдкреЛрдб рд╣реБрдХ рдХреЛ рдПрдВрдЯреА-рдЪреАрдЯ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдпрд╛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, NtSetInformationThread) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдПрдХ рдЬрд╛рд▓ рд╣реИ рдЬреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдХреЛ рдирд╣реАрдВ рдмрджрд▓рддрд╛ рд╣реИред рдореИрдВрдиреЗ рдордВрдЪреЛрдВ рдкрд░ рдзрд╛рдЧреЗ рд╕реЗ рдкреВрдЫрд╛ рдХрд┐ рдХреНрдпрд╛ VAC рдЗрд╕ рдЬрд╛рд▓ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░ рд░рд╣рд╛ рд╣реИ - рдЬрд╡рд╛рдм рдЖрдорддреМрд░ рдкрд░ рдорд┐рд╢реНрд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ, рд╡реАрдПрд╕реА рдиреЗ рдореБрдЭреЗ рдЙрдирдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдмрдВрдз рдирд╣реАрдВ рд▓рдЧрд╛рдпрд╛ рдФрд░ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЛ рд░реАрд╕реЗрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ (рдпрд╣ рдЫрд╣ рдорд╣реАрдиреЗ рдкрд╣рд▓реЗ рдереЛрдбрд╝рд╛ рдХрдо рдерд╛, рд╢рд╛рдпрдж рдХреБрдЫ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ)ред</font></font><br><blockquote>    ,   ,  VAC   DR      /,  -      ,    .    HWBP  ,  -  ,     ,   ,        DR0-DR7    . </blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдереНрд░реЗрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HWBP рд╡рд┐рд╢реЗрд╖ рдкреНрд░реЛрд╕реЗрд╕рд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдкреНрд░рд╡рд╛рд╣ рд╕рдВрджрд░реНрдн рдореЗрдВ DR0-DR7 рд░рдЬрд┐рд╕реНрдЯрд░ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ RIP DR0-DR3 рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдЪрд╛рд░ рдкрддреЗ рдореЗрдВ рд╕реЗ рдПрдХ рдкрд░ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдЕрдкрд╡рд╛рдж рдлреЗрдВрдХрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЕрдкрд╡рд╛рдж рдХреЗ рдкреНрд░рдХрд╛рд░ рдФрд░ рд╕рдВрджрд░реНрдн рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдкрдХрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХрд┐рд╕ рдкрддреЗ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдиреЗ рдЕрдкрд╡рд╛рдж рдХреЛ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдФрд░ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓рд╛ред - рдПрдХ рдЬрд╛рд▓ рдпрд╛ рдирд╣реАрдВред рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реАрдорд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдПрдХ рд╕рдордп рдореЗрдВ рдХреЗрд╡рд▓ рдЪрд╛рд░ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдереНрд░реЗрдб рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЬрд╛рд▓ рд╕реЗрдЯ рд╣реЛрдиреЗ рдкрд░ рдЕрд╕реБрд╡рд┐рдзрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдПрдХ рдирдпрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ / рдкреБрд░рд╛рдиреЗ рдзрд╛рдЧреЗ рдХреЛ рдлрд┐рд░ рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЬрд╛рд▓ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдмрд╛рдзрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдпрд╣ рдмреЗрд╕рдЯрд╣реНрд░реЗрдбрдЗрдирдЯрд┐рдЯрд╣рдВрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрд╡рд░реЛрдзрди рджреНрд╡рд╛рд░рд╛ рд╢рд╛рд╕рд┐рдд рд╣реИ, 4 рдЬрд╛рд▓ рдХреЗ рдЙрдкрдпреЛрдЧ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдореБрдЭреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИредрдпрджрд┐ рд╣реБрдХ рдХреА рд╕рдВрдЦреНрдпрд╛ рдЖрдкрдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рддреЛ PageGuard рджреГрд╖реНрдЯрд┐рдХреЛрдг рджреЗрдЦреЗрдВред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЛ, рдХрд╛рд░реНрдп рд╕рдорд╛рди рд╣реИ - рд╣рдо рд╕реИрдВрдбрдмреЙрдХреНрд╕ (рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдЬреЗрдХреНрдЯ) рдореЗрдВ рд╣реИрдВ, рдбрд┐рд╡рд╛рдЗрд╕ рдкреНрд░реЗрдЬреЗрдВрдЯ рдФрд░ рдПрдВрдбрд╕реНрдХреАрди рдХреНрд▓рд╛рд╕ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдореВрд▓ рддрд░реАрдХреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЬрд╛рд▓ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣реИ - IHook, рдЪрд▓реЛ "рд▓реЛрд╣рд╛" рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдХреЗ рдХрд╛рдо рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд┐рджреНрдзрд╛рдВрдд рдпрд╣ рд╣реИ: рдЪрд╛рд░ "рдХрд╛рдо рдХрд░ рд░рд╣реЗ" DR0-DR3 рд░рдЬрд┐рд╕реНрдЯрд░ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдкрддрд╛ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, DR7 рдирд┐рдпрдВрддреНрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬрдм рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрддреЗ рдкрд░ рд▓рд┐рдЦрдиреЗ, рдкрдврд╝рдиреЗ рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рд╣реЛ рд░рд╣реА рд╣реИ, рддреЛ EXCECEION_SINGLE_STEP рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдкрд╡рд╛рдж рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рдкрд╣рд▓реЗ рдкрдВрдЬреАрдХреГрдд рд╣реИрдВрдбрд▓рд░ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред ред </font><font style="vertical-align: inherit;">рдЖрдк рдПрд╕рдИрдПрдЪ рд╣реИрдВрдбрд▓рд░ рдФрд░ рд╡реАрдИрдПрдЪ рджреЛрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ - рд╣рдо рдмрд╛рдж рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреА рдЙрдЪреНрдЪ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдЗрд╕ рд╡рд┐рдЪрд╛рд░ рдХрд╛ рдПрд╣рд╕рд╛рд╕ рд╣реИ:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> HardwareBPHook::SetHook(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* source, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* destination, HANDLE* hThread, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>* reg) { CONTEXT context; ZeroMemory(&amp;context, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(context)); context.ContextFlags = CONTEXT_DEBUG_REGISTERS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!GetThreadContext(*hThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_GET_CONTEXT; *(&amp;context.Dr0 + *reg) = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)source; context.Dr7 |= <span class="hljs-number"><span class="hljs-number">1U</span></span>LL &lt;&lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * (*reg)); context.Dr7 |= HW_EXECUTE &lt;&lt; ((*reg) * <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">16</span></span>); context.Dr7 |= HW_LENGTH &lt;&lt; ((*reg) * <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">18</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!SetThreadContext(*hThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_SET_CONTEXT; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SUCCESS_CODE; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдХреЛрдб рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдереНрд░реЗрдб рдХрд╛ рд╕рдВрджрд░реНрдн рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рд╕рдлрд▓ рд░рд╕реАрдж рдкрд░, рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХреЛ рдПрдХ рдореБрдлреНрдд рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдбрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, DR7 рдирд┐рдпрдВрддреНрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рд╣реИред</font></font><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DR6 рдФрд░ DR7 рдХреНрдпрд╛ рд╣реИрдВ, рд╕рд╛рде рд╣реА рдкреЗрдЬрдЧрд╛рд░реНрдб рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ, рдореИрдВ рдЧреНрд░реЗ рд╣реИрдЯ рдкрд╛рдпрдерди рдХреЛ рд╕рд▓рд╛рд╣ рджреЗ рд╕рдХрддрд╛ рд╣реВрдВ: рд╣реИрдХрд░реНрд╕ рдФрд░ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдкрд╛рдпрдерди рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧред рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, DR7 рдПрдХ "рд╡рд░реНрдХрд┐рдВрдЧ" рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рд╕рдХреНрд╖рдо / рдЕрдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИ - рднрд▓реЗ рд╣реА DR0-DR3 рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╕реЗ рдХреЛрдИ рдПрдХ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди DR7 рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд╛ рдзреНрд╡рдЬ рдЕрдХреНрд╖рдо рд╣реИ, рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред DR7 рдЙрд╕ рдкрддреЗ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рднреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕ рдкрд░ рдЕрдкрд╡рд╛рдж рдХреЛ рдлреЗрдВрдХрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ - рдЪрд╛рд╣реЗ рдкрддрд╛ рдкрдврд╝рд╛ рдЧрдпрд╛ рд╣реЛ, рдЪрд╛рд╣реЗ рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд╣рдо рдЕрдВрддрд┐рдо рд╡рд┐рдХрд▓реНрдк рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ)ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЬрд╛рд▓ рдХреЛ рдирд┐рдХрд╛рд▓рдирд╛ рднреА рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ рдФрд░ DR7 рдирд┐рдпрдВрддреНрд░рдг рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> HardwareBPHook::UnsetHook(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* source, HANDLE* hThread) { CONTEXT context; ZeroMemory(&amp;context, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(context)); context.ContextFlags = CONTEXT_DEBUG_REGISTERS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!GetThreadContext(*hThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_GET_CONTEXT; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; DEBUG_REG_COUNT; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)source == *(&amp;context.Dr0 + i)) { info-&gt;GetItem(i)-&gt;source = <span class="hljs-number"><span class="hljs-number">0</span></span>; *(&amp;context.Dr0 + i) = <span class="hljs-number"><span class="hljs-number">0</span></span>; context.Dr7 &amp;= ~(<span class="hljs-number"><span class="hljs-number">1U</span></span>LL &lt;&lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * i)); context.Dr7 &amp;= ~(<span class="hljs-number"><span class="hljs-number">3</span></span> &lt;&lt; (i * <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">16</span></span>)); context.Dr7 &amp;= ~(<span class="hljs-number"><span class="hljs-number">3</span></span> &lt;&lt; (i * <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">18</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!SetThreadContext(*hThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_SET_CONTEXT; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SUCCESS_CODE; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдереНрд░реЗрдбреНрд╕ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рд░рд╣рддрд╛ рд╣реИ - рдЬрд╛рд▓ рдХреЛ рдЙрди рдереНрд░реЗрдбреНрд╕ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдкрд░реЗрд╢рд╛рди рдирд╣реАрдВ рд╣реЛрдВрдЧреЗред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рднреА рдереНрд░реЗрдбреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЬрд╛рд▓ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> HardwareBPHook::SetHook(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* source, <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* destination) { THREADENTRY32 te32; HANDLE hThread = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hThread == INVALID_HANDLE_VALUE) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_ENUM_THREAD_START; te32.dwSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(THREADENTRY32); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Thread32First(hThread, &amp;te32)) { CloseHandle(hThread); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_ENUM_THREAD_START; } DWORD dwOwnerPID = GetCurrentProcessId(); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isRegDefined = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> freeReg = <span class="hljs-number"><span class="hljs-number">-1</span></span>; Freeze(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (te32.th32OwnerProcessID == dwOwnerPID) { HANDLE openThread = OpenThread(THREAD_ALL_ACCESS, FALSE, te32.th32ThreadID); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isRegDefined) { CONTEXT context; ZeroMemory(&amp;context, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(context)); context.ContextFlags = CONTEXT_DEBUG_REGISTERS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!GetThreadContext(openThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_GET_CONTEXT; freeReg = GetFreeReg(&amp;context.Dr7); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (freeReg == <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_GET_FREE_REG; isRegDefined = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } SetHook(source, destination, &amp;openThread, &amp;freeReg); CloseHandle(openThread); } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Thread32Next(hThread, &amp;te32)); CloseHandle(hThread); Unfreeze(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = info-&gt;GetItem(freeReg); record-&gt;source = source; record-&gt;destination = destination; record-&gt;pTrampoline = source; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SUCCESS_CODE; }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рд╕рднреА рджреГрд╢реНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд░реНрддрдорд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдЧрд▓реЗ рдзрд╛рдЧреЗ рдХреЗ рд▓рд┐рдП рдорд┐рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рд╣рдо рд╕реНрдЯреНрд░реАрдо рд╣реИрдВрдбрд▓рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдЪрд╛рд░ рдореБрдХреНрдд рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рдвреВрдВрдврддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдЬрд╛рд▓ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдлреНрд░реАрдЬ рдФрд░ рдЕрдирдлреНрд░реАрдЬ рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ - рдпрд╣ рд╡рд╣реА рд╣реИ рдЬреЛ рдУрдкреЛрдб рд╣реБрдХ рдиреЗ рдорд▓реНрдЯреАрдереНрд░реЗрдбрд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА рдереА - рд╡реЗ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдереНрд░реЗрдбреНрд╕ (рд╡рд░реНрддрдорд╛рди рдХреЛ рдЫреЛрдбрд╝рдХрд░) рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд░реЛрдХ рджреЗрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХреЛрдИ рднреА рд╕реНрдерд┐рддрд┐ рди рд╣реЛ рдЬрдм рдереНрд░реЗрдбреНрд╕ рдореЗрдВ рд╕реЗ рдХреЛрдИ рдПрдХ рдЕрд╡рд░реЛрдзрди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реБрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдзрд╛рдЧреЗ рдХреА рд░рдХреНрд╖рд╛ рдХрд░рдирд╛</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IHook::Freeze() { THREADENTRY32 te32; HANDLE hThread = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hThread == INVALID_HANDLE_VALUE) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_ENUM_THREAD_START; te32.dwSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(THREADENTRY32); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Thread32First(hThread, &amp;te32)) { CloseHandle(hThread); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ERROR_ENUM_THREAD_START; } DWORD dwOwnerPID = GetCurrentProcessId(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (te32.th32OwnerProcessID == dwOwnerPID &amp;&amp; te32.th32ThreadID != GetCurrentThreadId()) { HANDLE openThread = OpenThread(THREAD_ALL_ACCESS, FALSE, te32.th32ThreadID); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (openThread != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { SuspendThread(openThread); CloseHandle(openThread); } } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Thread32Next(hThread, &amp;te32)); CloseHandle(hThread); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SUCCESS_CODE; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IHook::Unfreeze() { <span class="hljs-comment"><span class="hljs-comment">// equal { HANDLE openThread = OpenThread(THREAD_ALL_ACCESS, FALSE, te32.th32ThreadID); if (openThread != NULL) { ResumeThread(openThread); CloseHandle(openThread); } } // equal return 0; }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рд▓ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдХрд╛рд░реНрдп рдореЗрдВ рдЗрд╕реА рддрд░рд╣ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╡реАрдИрдПрдЪ рдЕрдкрд╡рд╛рдж рд╣реИрдВрдбрд▓рд░ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╣реБрдЖ рд╣реИред </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рдирд╛ рдФрд░ рд╣рдЯрд╛рдирд╛ AddVectoredExceptionHandler рдФрд░ RemoveVectoredExceptionHandler рдлрд╝рдВрдХреНрд╢рди рдХрд┐рд╕реА рднреА рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> HardwareBPHook::SetExceptionHandler(PVECTORED_EXCEPTION_HANDLER pVecExcHandler) { pException = AddVectoredExceptionHandler(<span class="hljs-number"><span class="hljs-number">1</span></span>, pVecExcHandler); } ~HardwareBPHook() { info-&gt;Clear(); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> info; RemoveVectoredExceptionHandler(pException); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИрдВрдбрд▓рд░ рдХреЛ рдЕрдкрд╡рд╛рдж рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП (EXCEPTION_SINGLE_STEP рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ), рдЙрд╕ рдкрддреЗ рдХреЗ рдкрддреНрд░рд╛рдЪрд╛рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬрд┐рд╕ рдкрд░ рдЕрдкрд╡рд╛рдж рдХреНрдпрд╛ рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╣реИ рдФрд░ рдЕрдЧрд░ рдРрд╕рд╛ рдХреЛрдИ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, рддреЛ рд░рд┐рд╕реАрд╡рд░ рдХреЗ рдкрддреЗ рдкрд░ RIP рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдлрд┐рд░ рд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕реНрдЯреИрдХ рдХреА рд╕реНрдерд┐рддрд┐ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИ, рддрд╛рдХрд┐ рд░рд┐рд╕реАрд╡рд░ рдХреЗ рдЖрдЧреЗ рдирд┐рд╖реНрдкрд╛рджрди рдкрд░, рд╕реНрдЯреИрдХ рдкрд░ рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ рдмрд░рдХрд░рд╛рд░ рд░рд╣реЗрдВрдЧреЗред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рд╡рд░реНрдгрд┐рдд рд╣реИрдВрдбрд▓рд░ рдХреЛ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">LONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnExceptionHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( EXCEPTION_POINTERS* exceptionPointers)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exceptionPointers-&gt;ExceptionRecord-&gt;ExceptionCode != EXCEPTION_SINGLE_STEP) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXCEPTION_CONTINUE_EXECUTION; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; DEBUG_REG_COUNT; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exceptionPointers-&gt;ContextRecord-&gt;Rip == (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)hook-&gt;GetInfo()-&gt;GetItem(i)-&gt;source) { exceptionPointers-&gt;ContextRecord-&gt;Rip = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)hook-&gt;GetInfo()-&gt;GetItem(i)-&gt;destination; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXCEPTION_CONTINUE_EXECUTION; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рд╕рдм рдХреБрдЫ рддреИрдпрд╛рд░ рд╣реИ, рд╣рдо рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рдмрд┐рд▓реНрдХреБрд▓ OpcodeHook рдХреЗ рд╕рдорд╛рди рдХрд╛рд░реНрдп рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдореЗрдВред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЬрдо рдЬрд╛рддрд╛ рд╣реИ - рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рдпрд╣ рд▓рдЧрд╛рддрд╛рд░ PresentHook рдореЗрдВ рдЪрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЬрд┐рд╕ рд╕рдордп рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЙрд╕ рд╕рдордп рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдлрд┐рд░ рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ "рдЖрдпрд░рди" рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдЧрд╛рдпрдм рдирд╣реАрдВ рд╣реБрдЖ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдЖрдк рд╕реНрдкреНрд░рд┐рдВрдЧрдмреЛрд░реНрдб рдХрд╣рддреЗ рд╣реИрдВ (рдЬреЛ, "рдЖрдпрд░рди" рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореВрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ), рд╣рдо рдлрд┐рд░ рд╕реЗ рдЙрд╕реА рдкрддреЗ рдХреЛ рдЕрд▓рд╛рд░реНрдо рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдЕрдкрд╡рд╛рдж рдЙрдард╛рддреЗ рд╣реИрдВред рд╕рдорд╛рдзрд╛рди рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ: рдЬрдм рд╣рдо рд╣реИрдВрдбрд▓рд░ рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдереНрд░реЗрдб рдХреЗ рд▓рд┐рдП рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рд╡рд┐рд░рд╛рдо рдмрд┐рдВрджреБ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ, рдФрд░ рд╕рд╣реА рд╕рдордп рдкрд░ рд╣рдо рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗред рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХрд╛ рд╕реНрдерд╛рди рдЙрд╕ рдкрд▓ рдХреЛ рдЪреБрдиреЗрдЧрд╛ рдЬрдм рд░рд┐рд╕реАрд╡рд░ рдлрд╝рдВрдХреНрд╢рди рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд╕рд╛рде, рдПрдХ рд▓рдВрдмрд┐рдд рдХрдорд╛рдВрдб рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд░рд┐рд╕реАрд╡рд░ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрдВрдд рдореЗрдВ рдХрдорд╛рдВрдб рдЪрд▓рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cpp hljs">IDeferredCommands* hookCommands; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PresentHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device* device)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = hook-&gt;GetRecordBySource(ptrPresent); pPresent pTrampoline = (pPresent)record-&gt;pTrampoline; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> result = pTrampoline(device); <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"PresentHook"</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; hookCommands-&gt;Run(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndSceneHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Device* device, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> j)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = hook-&gt;GetRecordBySource(ptrEndScene); pEndScene pTrampoline = (pEndScene)record-&gt;pTrampoline; pTrampoline(device, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"EndSceneHook"</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; j &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; hookCommands-&gt;Run(); } <span class="hljs-function"><span class="hljs-function">LONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnExceptionHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(EXCEPTION_POINTERS* exceptionPointers)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exceptionPointers-&gt;ExceptionRecord-&gt;ExceptionCode != EXCEPTION_SINGLE_STEP) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXCEPTION_CONTINUE_EXECUTION; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; DEBUG_REG_COUNT; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exceptionPointers-&gt;ContextRecord-&gt;Rip == (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)hook-&gt;GetInfo()-&gt;GetItem(i)-&gt;source) { exceptionPointers-&gt;ContextRecord-&gt;Dr7 &amp;= ~(<span class="hljs-number"><span class="hljs-number">1U</span></span>LL &lt;&lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * i)); exceptionPointers-&gt;ContextRecord-&gt;Rip = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)hook-&gt;GetInfo()-&gt;GetItem(i)-&gt;destination; IDeferredCommand* cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SetD7Command(hook, GetCurrentThreadId(), i); hookCommands-&gt;Enqueue(cmd); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXCEPTION_CONTINUE_EXECUTION; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рдВрдмрд┐рдд рдХрдорд╛рдВрдб рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> silk_way { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IDeferredCommand</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: IDeferredCommand(silk_way::IHook* _hook) { hook = _hook; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IDeferredCommand() { hook = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: silk_way::IHook* hook; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SetD7Command</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IDeferredCommand { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: SetD7Command(silk_way::IHook* _hook, <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> _threadId, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _reg) : IDeferredCommand(_hook) { threadId = _threadId; reg = _reg; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ HANDLE hThread = OpenThread(THREAD_ALL_ACCESS, FALSE, threadId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hThread != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> res = SetD7(&amp;hThread); CloseHandle(hThread); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetD7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HANDLE* hThread)</span></span></span><span class="hljs-function"> </span></span>{ CONTEXT context; ZeroMemory(&amp;context, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(context)); context.ContextFlags = CONTEXT_DEBUG_REGISTERS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!GetThreadContext(*hThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; *(&amp;context.Dr0 + reg) = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)hook-&gt;GetInfo()-&gt;GetItem(reg)-&gt;source; context.Dr7 |= <span class="hljs-number"><span class="hljs-number">1U</span></span>LL &lt;&lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * reg); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!SetThreadContext(*hThread, &amp;context)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> threadId; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> reg; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IDeferredCommands</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> silk_data::Queue&lt;IDeferredCommand*&gt;, <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IDeferredCommand { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: IDeferredCommands() : Queue(), IDeferredCommand(<span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>) {} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IDeferredCommands() {} }; }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗрддреНрд░рд╣реАрди "рд▓реЛрд╣рд╛" рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдХреЗ рдХрд╛рдо рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВред </font></font><br><br><img src="https://habrastorage.org/webt/jv/p-/zz/jvp-zzjqnzwyp2ykl_99ujnhw0y.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 12 - рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдПрдХ рдЬрд╛рд▓ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ рд╡реАрдИрдПрдЪ рд╣реИрдВрдбрд▓рд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рд╕реНрд░реЛрдд рдлрд╝рдВрдХреНрд╢рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдВрддреНрд░рдг рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ: </font></font><br><br><img src="https://habrastorage.org/webt/5q/-e/eu/5q-eeucl59ysseiioktygfzl9bc.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░рд╛ 13 - рдЕрд╡рд░реЛрдзрди рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреЗрдЬ</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рдЕрдкрд╡рд╛рдж рдХреЛ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рд╣реИрдВрдбрд▓рд░ рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд░рд┐рд╕реАрд╡рд░ рдХреЛ рдЖрд░рдЖрдИрдкреА рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ: </font></font><br><br><img src="https://habrastorage.org/webt/te/rv/iw/terviwiealxn6xn1xvylzvfuhfe.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░рд╛ 14 - рдирд┐рд╖реНрдкрд╛рджрди рдереНрд░реЗрдб рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдлрд╝рдВрдХреНрд╢рди рд░рд┐рд╕реАрд╡рд░</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ рдЬрд╛рд▓ рд╕рдорд╛рдкреНрдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд╕реНрдереИрддрд┐рдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп Silk_way.lib рддреИрдпрд╛рд░ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЕрдиреБрднрд╡ рд╕реЗ рдореИрдВ рдХрд╣ рд╕рдХрддрд╛ рд╣реВрдВ рдХрд┐ рдореИрдВ рдЕрдХреНрд╕рд░ OpcodeHook, VMT Hook, Forced Exception рд╣реБрдХ (рд╢рд╛рдпрдж рд╕рдмрд╕реЗ "рдирдХрд╕реАрд░" рдЬрд╛рд▓), HardwareBreakpoint рдФрд░ PageGuard рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ (рдЬрдм рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдПрдХ-рдмрд╛рд░ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ)ред</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8. рддрд░реНрдХ рдХрд╛ рд╕реНрдерд╛рдкрддреНрдп </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд░реНрдХ рдХрд╛ рдЖрдзрд╛рд░ рдПрдорд╡реАрд╕реА (рдореЙрдбрд▓-рд╡реНрдпреВ-рдХрдВрдЯреНрд░реЛрд▓рд░) рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╕рднреА рдореБрдЦреНрдп рдЗрдХрд╛рдЗрдпрд╛рдВ ISilkObject рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓реА рд╣реИрдВред</font></font><br><br><h3>  8.1ред  рдЖрджрд░реНрд╢ </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдмреЙрдЯ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╕рдордп, рдореИрдВрдиреЗ рдкрд╣рд▓реА рдмрд╛рд░ рдИрд╕реАрдПрд╕ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ (рдЖрдк рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">)ред рдЬрдм рдореБрдЭреЗ рдПрд╣рд╕рд╛рд╕ рд╣реБрдЖ рдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдмреЙрдЯ рд▓реЙрдиреНрдЪ рдХрд░рдирд╛ рдПрдХ рд▓рдВрдмрд╛ рдХрд╛рдо рдерд╛, рддреЛ рдореИрдВрдиреЗ рдПрдХ рд╕рд┐рдореБрд▓реЗрд╢рди рд▓рд┐рдЦрд╛ рдЬрд╣рд╛рдВ рд╣рдордиреЗ рдорд┐рд▓реАрд▓реАрдЯрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ (рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЗ рд▓рд┐рдП рддреАрди рдЖрдпрд╛рдореА рдЧреНрд░рд┐рдб рдХреЗ рд╕рд╛рде (рдбреЛрдЯрд╛ 2 рд╕рд┐рд░реНрдл </font><font style="vertical-align: inherit;">рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдПрдХ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 рдбреА рдЧреНрд░рд┐рдб</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">) рдФрд░ рдмреЙрдбреА рдмреНрд▓реЙрдХ рдХреЗ рд▓рд┐рдП 2 рдбреА рднреМрддрд┐рдХреА рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдпрд╛ред рдЬрдм рд╕рд┐рдореБрд▓реЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЧрд╛рдпрдм рд╣реЛ рдЧрдИ рдФрд░ рдореБрдЭреЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдХреИрд╕реЗ рдФрд░ рдХреНрдпрд╛ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛ рд╣реИ, рддреЛ рд▓рдбрд╝рд╛рдИ рдХреЗ рджреМрд░рд╛рди рдХреНрдпрд╛ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдирд╛ рд╣реИ, рдИрд╕реАрдПрд╕ рдХреА рдЕрдм рдХреЛрдИ рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдФрд░ рдореЙрдбрд▓ рдореЗрдВ рдмрд╕ рдШрдЯрдХреЛрдВ рдХрд╛ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ (рд╕реНрдХрд╛рдЗрдлреЙрд░реНрдЧ рд╕реЗ рд▓реЛрдЧреЛрдВ рдХреА рддрд░рд╣ рдХреБрдЫ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avatars рдФрд░ рднреАрдбрд╝ "</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), рдЬрд┐рд╕рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, Source2Gen рд╕реЗ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдкрд░ рдЖрд╡рд░рдгред </font><font style="vertical-align: inherit;">рдЗрд╕ рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдореЙрдбрд▓ рдореЗрдВ рд╕реНрдХреАрдорд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рд╡рд┐рд╡рд░рдг рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдЗрд╕ рдмрд┐рдВрджреБ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдпреЛрдЬрдирд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдореЙрдбрд▓ рдирд╣реАрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпреЛрдЬрдирд╛ рдХреЗрд╡рд▓ рдЗрд╕рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддреА рд╣реИ (рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдореВрд▓реНрдпреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╣рд╛рд░реНрдбрдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) - рдЗрд╕рдХреА рддреБрд▓рдирд╛ xml / json рдореЗрдВ рдЦреЗрд▓ рд╕рд╛рдордЧреНрд░реА рдХреЗ рднрдВрдбрд╛рд░рдг рд╕реЗ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ )ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпреЛрдЬрдирд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдореЙрдбрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 15 -</font></i><font style="vertical-align: inherit;"> рдХреЛрдб рдореЗрдВ </font><i><font style="vertical-align: inherit;">рдореЙрдбрд▓</font></i><font style="vertical-align: inherit;"> рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </font><i><font style="vertical-align: inherit;">рдХрд╛ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡</font></i><font style="vertical-align: inherit;"> :</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/ci/of/ip/ciofipyg9fa-rcm0bavzy4ninb0.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SILK_OBJ</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IModel</span></span></span><span class="hljs-class">) {</span></span> ACCESSOR(IIdentity, Id) ACCESSOR(S, Schema) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: IModel(IIdentity * id, ISchema * schema) { Id = id; Schema = <span class="hljs-keyword"><span class="hljs-keyword">dynamic_cast</span></span>&lt;S*&gt;(schema); components = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> silk_data::RBTree&lt;SILK_STRING*, IComponent&gt;( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringCompareStrategy()); } ~IModel() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> Id; Schema = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; components-&gt;Clear(); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> components; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Get</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SILK_STRING</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (T*)components-&gt;Find(key); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: silk_data::RBTree&lt;SILK_STRING*, IComponent&gt;* components; };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреЛрдЬрдирд╛ рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбрд▓ рдХрд╛ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рд╡рд╣ рд╕рдВрджрд░реНрдн рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдореЙрдбрд▓ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IModelSchema</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> BaseSchema { ACCESSOR(ModelContext, Context) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: IModelSchema(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* type, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* name, IContext* context) : BaseSchema(type, name) { Context = <span class="hljs-keyword"><span class="hljs-keyword">dynamic_cast</span></span>&lt;ModelContext*&gt;(context); } ~IModelSchema() { Context = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ModelContext</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SilkContext { ACCESSOR(ILogger, Logger) ACCESSOR(IChrono, Clock) ACCESSOR(GigaFactory, Factory) ACCESSOR(IGameModel*, Model) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: ModelContext(SILK_GUID* guid, ILogger* logger, IChrono* clock, GigaFactory* factory, IGameModel** model) : SilkContext(guid) { Logger = logger; Clock = clock; Factory = factory; Model = model; } ~ModelContext() { Logger = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; Clock = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; Factory = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; Model = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } };</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЙрдбрд▓ рдХрд╛ рд╕рдВрдЧреНрд░рд╣ рдФрд░ рдпреЛрдЬрдирд╛рдУрдВ рдХрд╛ рд╕рдВрдЧреНрд░рд╣</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">S</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IModelCollection</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> silk_data::Vector&lt;T*&gt;, <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IModel&lt;S&gt; { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: IModelCollection(IIdentity* id, ISchema* schema) : Vector(), IModel(id, schema) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> factory = Schema-&gt;GetContext()-&gt;GetFactory(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> guid = Schema-&gt;GetContext()-&gt;GetGuid(); foreach (Schema-&gt;Length()) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> itemSchema = Schema-&gt;GetItem(i); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> item = factory-&gt;Build&lt;T&gt;(itemSchema-&gt;GetType()-&gt;GetValue(), guid-&gt;Get(), itemSchema); PushBack(item); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: ~IModelCollection() { Clear(); } <span class="hljs-function"><span class="hljs-function">T* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* name)</span></span></span><span class="hljs-function"> </span></span>{ foreach (Length()) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GetItem(i)-&gt;GetSchema()-&gt;CheckName(name)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetItem(i); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } };</code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд░реЛрд╢рди рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЙрдбрд▓ рдХрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs">DEFINE_IMODEL(IRoshanStatusModel, IRoshanStatusSchema) { VIRTUAL_COMPONENT(IStatesModel, States) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Resolve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: IRoshanStatusModel(IIdentity * id, ISchema * schema) : IModel(id, schema) {} }; DEFINE_MODEL(RoshanStatusModel, IRoshanStatusModel) { COMPONENT(IStatesModel, States) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> : RoshanStatusModel(IIdentity * id, ISchema* schema) : IRoshanStatusModel( id, schema) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> factory = Schema-&gt;GetContext()-&gt;GetFactory(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> guid = Schema -&gt; GetContext() -&gt; GetGuid(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> statesSchema = Schema -&gt; GetStates(); States = factory-&gt;Build&lt;IStatesModel&gt;( statesSchema-&gt;GetType()-&gt;GetValue(), guid-&gt;Get(), statesSchema); } ~RoshanStatusModel() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> States; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Resolve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> currentStateSchema = States-&gt;GetCurrent()-&gt;GetSchema(); Schema-&gt;GetContext()-&gt;GetLogger()-&gt;Log(<span class="hljs-string"><span class="hljs-string">"RESOLVE\n"</span></span>); foreach (currentStateSchema-&gt;GetTransitions()-&gt;Length()) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> transition = currentStateSchema-&gt;GetTransitions()-&gt;GetItem(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transition-&gt;GetRequirement()-&gt;Check()) { transition-&gt;GetAction()-&gt;Make(); States-&gt;SetCurrent(States-&gt;GetByName( transition-&gt;GetTo()-&gt;GetValue())); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } };</code> </pre> <br></div></div><br><h3>  8.2ред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЗрдЦреЗрдВ, рд╕реНрдерд┐рддрд┐ рдФрд░ рдирд┐рдпрдВрддреНрд░рдХ рджреЗрдЦреЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди, рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди рд╕реНрдЯреЗрдЯ рдФрд░ рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХрд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдХреБрдЫ рдирд╣реАрдВ рд╣реИ, рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЙрдбрд▓ рдХреЗ рд╕рдорд╛рди рд╣реИред </font><font style="vertical-align: inherit;">рдЗрдирдореЗрдВ рд╕реНрдХреАрдорд╛ рдФрд░ рд╕рдВрджрд░реНрдн рднреА рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">View, Canvas, ViewCollection, Label рдФрд░ Button рдХреЗ рд▓рд┐рдП рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд┐рдЫрд▓реЗ рджреЛ рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд░реЛрд╢рди рд╕реНрдерд┐рдд рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рднреА рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпреЛрдЬрдирд╛рдмрджреНрдз рджреГрд╢реНрдп</font></font></b> <div class="spoiler_text"> <a href=""><img src="https://habrastorage.org/webt/an/l2/_n/anl2_n7qxsihaoohxu4oa-kq2jm.png"></a> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 16 - рджреГрд╢реНрдп рдХрд╛ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡</font></font></i> <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреВ рд╕реНрдЯреЗрдЯ рдХрд╛ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡</font></font></b> <div class="spoiler_text"> <a href=""><img src="https://habrastorage.org/webt/zi/mz/pi/zimzpip_arq-gwgl87-lwriknmq.png"></a> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 17 - рджреГрд╢реНрдп рд░рд╛рдЬреНрдп рдХрд╛ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡</font></font></i> <br></div></div><br><h3>  8.3ред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛рд░рдЦрд╛рдирд╛ рд╣реИ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреИрдХреНрдЯреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпрд╛рдВ рдПрдХ рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдЕрдВрддрд░рдлрд▓рдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ, рдЗрд╕реЗ рдЯрд╛рдЗрдкрд┐рдб (рдЯреА) .raw_name () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдРрд╕рд╛ рдХрд░рдирд╛ рдмреБрд░рд╛ рд╣реИ, рдЖрдВрджреНрд░реЗрдИ рдЕрд▓реЗрдХреНрдЬреЗрдВрдбреНрд░реЗрд╕реНрдХреБ, рдореЙрдбрд░реНрди рд╕реА ++ рдбрд┐рдЬрд╝рд╛рдЗрди: рдЬреЗрдиреЗрд░рд┐рдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдореЗрдВ рдХреНрдпреЛрдВ рдФрд░ рдХреИрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛рдПред </font><font style="vertical-align: inherit;">рдлреИрдХреНрдЯрд░реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SilkFactory</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: SilkFactory() { items = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> silk_data::RBTree&lt;SILK_STRING*, IImplementator&gt;( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringCompareStrategy()); } ~SilkFactory() { items-&gt;Clear(); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> items; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Args</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ISILK_WAY_OBJECT</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Build</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Args</span></span></span><span class="hljs-class">... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> key = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_STRING(type); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> impl = items-&gt;Find(key)-&gt;payload; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> impl-&gt;Build(args...); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Register</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* type, IImplementator* impl)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> key = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_STRING(type); items-&gt;Insert(*items-&gt;MakeNode(key, impl)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: silk_data::RBTree&lt;SILK_STRING*, IImplementator&gt;* items; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GigaFactory</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: GigaFactory() { items = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> silk_data::RBTree&lt;SILK_STRING*, SilkFactory&gt;( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringCompareStrategy()); } ~GigaFactory() { items-&gt;Clear(); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> items; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Args</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Build</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">concreteType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Args</span></span></span><span class="hljs-class">... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> key = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_STRING(<span class="hljs-keyword"><span class="hljs-keyword">typeid</span></span>(T).raw_name()); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> factory = items-&gt;Find(key)-&gt;payload; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (T*)factory-&gt;Build(concreteType, args...); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Register</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SilkFactory</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">factory</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> key = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_STRING(<span class="hljs-keyword"><span class="hljs-keyword">typeid</span></span>(T).raw_name()); items-&gt;Insert(*items-&gt;MakeNode(key, factory)); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: silk_data::RBTree&lt;SILK_STRING*, SilkFactory&gt;* items; };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░рдЦрд╛рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдкрдВрдЬреАрдХрд░рдг рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЙрдбрд▓ рдкрдВрдЬреАрдХрд░рдг рдЙрджрд╛рд╣рд░рдг</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ModelRegistrator::Register( GigaFactory* factory) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> requirement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); requirement-&gt;Register(<span class="hljs-string"><span class="hljs-string">"true"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;TrueRequirement&gt;); requirement-&gt;Register(<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;FalseRequirement&gt;); requirement-&gt;Register(<span class="hljs-string"><span class="hljs-string">"roshan_killed"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;RoshanKilledRequirement&gt;); requirement-&gt;Register(<span class="hljs-string"><span class="hljs-string">"roshan_alive_manual"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;RoshanAliveManualRequirement&gt;); requirement-&gt;Register(<span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;TimeRequirement&gt;); requirement-&gt;Register(<span class="hljs-string"><span class="hljs-string">"roshan_state"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;RoshanStateRequirement&gt;); factory-&gt;Register&lt;IRequirement&gt;(requirement); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> action = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); action-&gt;Register(<span class="hljs-string"><span class="hljs-string">"action"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;EmptyAction&gt;); action-&gt;Register(<span class="hljs-string"><span class="hljs-string">"set_current_time"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;SetCurrentTimeAction&gt;); factory-&gt;Register&lt;IAction&gt;(action); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> transition = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); transition-&gt;Register(<span class="hljs-string"><span class="hljs-string">"transition"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;TransitionSchema&gt;); factory-&gt;Register&lt;ITransitionSchema&gt;(transition); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> transitions = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); transitions-&gt;Register(<span class="hljs-string"><span class="hljs-string">"transitions"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;TransitionsSchema&gt;); factory-&gt;Register&lt;ITransitionsSchema&gt;(transitions); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> stateSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); stateSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"state"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;StateSchema&gt;); factory-&gt;Register&lt;IStateSchema&gt;(stateSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> statesSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); statesSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"states"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;StatesSchema&gt;); factory-&gt;Register&lt;IStatesSchema&gt;(statesSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> roshanStatusSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); roshanStatusSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"roshan_status"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;RoshanStatusSchema&gt;); factory-&gt;Register&lt;IRoshanStatusSchema&gt;(roshanStatusSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> triggerSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); triggerSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"trigger"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;TriggerSchema&gt;); factory-&gt;Register&lt;ITriggerSchema&gt;(triggerSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> triggersSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); triggersSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"triggers"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;TriggersSchema&gt;); factory-&gt;Register&lt;ITriggersSchema&gt;(triggersSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> resourceSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); resourceSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"resource"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;ResourceSchema&gt;); factory-&gt;Register&lt;IResourceSchema&gt;(resourceSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> resourcesSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); resourcesSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"resources"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;ResourcesSchema&gt;); factory-&gt;Register&lt;IResourcesSchema&gt;(resourcesSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> gameSchema = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); gameSchema-&gt;Register(<span class="hljs-string"><span class="hljs-string">"game"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SchemaImplementator&lt;GameSchema&gt;); factory-&gt;Register&lt;IGameSchema&gt;(gameSchema); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> gameModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); gameModel-&gt;Register(<span class="hljs-string"><span class="hljs-string">"game"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;GameModel&gt;); factory-&gt;Register&lt;IGameModel&gt;(gameModel); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> resources = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); resources-&gt;Register(<span class="hljs-string"><span class="hljs-string">"resources"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;ResourceCollection&gt;); factory-&gt;Register&lt;IResourceCollection&gt;(resources); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> resource = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); resource-&gt;Register(<span class="hljs-string"><span class="hljs-string">"resource"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;Resource&gt;); factory-&gt;Register&lt;IResource&gt;(resource); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> triggers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); triggers-&gt;Register(<span class="hljs-string"><span class="hljs-string">"triggers"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;TriggerCollection&gt;); factory-&gt;Register&lt;ITriggerCollection&gt;(triggers); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> trigger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); trigger-&gt;Register(<span class="hljs-string"><span class="hljs-string">"trigger"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;Trigger&gt;); factory-&gt;Register&lt;ITrigger&gt;(trigger); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> roshanStatus = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); roshanStatus-&gt;Register(<span class="hljs-string"><span class="hljs-string">"roshan_status"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;RoshanStatusModel&gt;); factory-&gt;Register&lt;IRoshanStatusModel&gt;(roshanStatus); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> states = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); states-&gt;Register(<span class="hljs-string"><span class="hljs-string">"states"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;StatesModel&gt;); factory-&gt;Register&lt;IStatesModel&gt;(states); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> state = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SilkFactory(); state-&gt;Register(<span class="hljs-string"><span class="hljs-string">"state"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcreteImplementator&lt;StateModel&gt;); factory-&gt;Register&lt;IStateModel&gt;(state); }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреЛрдЬрдирд╛ рдХреЛ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рднрд░рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ - рдЖрдк рдЬрд╕рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рд╕реАрдзреЗ рдХреЛрдб рдореЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSON рдореЗрдВ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рд╕реНрдХреАрдорд╛ рдХреЛ рдкреЙрдкреНрдпреБрд▓реЗрдЯ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк</font></font></b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"game"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"roshan_status"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"states"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"alive"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"transitions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"alive"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_base"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"requirement"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"roshan_killed"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"set_current_time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resource"</span></span>: <span class="hljs-string"><span class="hljs-string">"roshan_killed_ts"</span></span> } } } ] }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_base"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"transitions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_base"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_extra"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"requirement"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resource"</span></span>: <span class="hljs-string"><span class="hljs-string">"roshan_killed_ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"offset"</span></span>: <span class="hljs-number"><span class="hljs-number">480</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"action"</span></span> } } ] }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_extra"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"transitions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_extra"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"alive"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"requirement"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resource"</span></span>: <span class="hljs-string"><span class="hljs-string">"roshan_killed_ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"offset"</span></span>: <span class="hljs-number"><span class="hljs-number">660</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"action"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"ressurect_extra"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"alive"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"requirement"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"roshan_alive_manual"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"typename"</span></span>: <span class="hljs-string"><span class="hljs-string">"action"</span></span> } } ] } ] }, <span class="hljs-attr"><span class="hljs-attr">"triggers"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"roshan_killed"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"roshan_alive_manual"</span></span>: {} }, <span class="hljs-attr"><span class="hljs-attr">"resources"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"roshan_killed_ts"</span></span>: {} } } }</code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб рд╕рдмрдорд┐рд╢рди рдХреЗ рд▓рд┐рдП рд╕реНрдХреАрдорд╛ рдХреЛ рдкреЙрдкреНрдпреБрд▓реЗрдЯ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> GameController::InitViewSchema(ICanvasSchema** schema) { *schema = factory-&gt;Build&lt;ICanvasSchema&gt;(<span class="hljs-string"><span class="hljs-string">"canvas_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"canvas_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"canvas_d9"</span></span>, viewContext); IViewCollectionSchema* elements = factory-&gt;Build&lt;IViewCollectionSchema&gt;( <span class="hljs-string"><span class="hljs-string">"elements"</span></span>, <span class="hljs-string"><span class="hljs-string">"elements"</span></span>, <span class="hljs-string"><span class="hljs-string">"elements"</span></span>, viewContext); (*schema)-&gt;SetElements(elements); ILabelSchema* labelSchema = factory-&gt;Build&lt;ILabelSchema&gt;( <span class="hljs-string"><span class="hljs-string">"label_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"label_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"roshan_status_label"</span></span>, viewContext); labelSchema-&gt;SetRecLeft(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">30</span></span>)); labelSchema-&gt;SetRecTop(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">100</span></span>)); labelSchema-&gt;SetRecRight(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">230</span></span>)); labelSchema-&gt;SetRecDown(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">250</span></span>)); labelSchema-&gt;SetColorR(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); labelSchema-&gt;SetColorG(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); labelSchema-&gt;SetColorB(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); labelSchema-&gt;SetColorA(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); labelSchema-&gt;SetText(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_STRING(<span class="hljs-string"><span class="hljs-string">"Roshan status: alive\0"</span></span>)); elements-&gt;PushBack((IViewSchema*&amp;)labelSchema); IButtonSchema* buttonSchema = factory-&gt;Build&lt;IButtonSchema&gt;( <span class="hljs-string"><span class="hljs-string">"button_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"button_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"roshan_kill_button"</span></span>, viewContext); ILabelSchema* buttonLabelSchema = factory-&gt;Build&lt;ILabelSchema&gt;( <span class="hljs-string"><span class="hljs-string">"label_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"label_d9"</span></span>, <span class="hljs-string"><span class="hljs-string">"button_text"</span></span>, viewContext); buttonLabelSchema-&gt;SetRecLeft(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">30</span></span>)); buttonLabelSchema-&gt;SetRecTop(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">115</span></span>)); buttonLabelSchema-&gt;SetRecRight(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">110</span></span>)); buttonLabelSchema-&gt;SetRecDown(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">130</span></span>)); buttonLabelSchema-&gt;SetColorR(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); buttonLabelSchema-&gt;SetColorG(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>)); buttonLabelSchema-&gt;SetColorB(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>)); buttonLabelSchema-&gt;SetColorA(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); buttonLabelSchema-&gt;SetText(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_STRING(<span class="hljs-string"><span class="hljs-string">"Kill Roshan\0"</span></span>)); buttonSchema-&gt;SetLabel(buttonLabelSchema); buttonSchema-&gt;SetBorderColorR(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetBorderColorG(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetBorderColorB(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetBorderColorA(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">70</span></span>)); buttonSchema-&gt;SetFillColorR(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">255</span></span>)); buttonSchema-&gt;SetFillColorG(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">119</span></span>)); buttonSchema-&gt;SetFillColorB(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetFillColorA(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">150</span></span>)); buttonSchema-&gt;SetPushColorR(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetPushColorG(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetPushColorB(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">0</span></span>)); buttonSchema-&gt;SetPushColorA(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_INT(<span class="hljs-number"><span class="hljs-number">70</span></span>)); buttonSchema-&gt;SetBorder(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SILK_FLOAT(<span class="hljs-number"><span class="hljs-number">5</span></span>)); elements-&gt;PushBack((IViewSchema*&amp;)buttonSchema); }</code> </pre> <br></div></div><br><h3>  8.4ред  рдШрдЯрдирд╛рдУрдВ </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреГрд╢реНрдп рдШрдЯрдирд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдореЙрдбрд▓ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реАрдЦрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдк рдХрдХреНрд╖рд╛ рдХреЗ рддрд░реАрдХреЛрдВ рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VIRTUAL_EVENT(e) public: virtual IEvent* Get##e() = 0; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> EVENT(e) private: IEvent* e; public: IEvent* Get##e() { return e; } const int MAX_EVENT_CALLBACKS = 1024; class IEventArgs {}; class ICallback { public: virtual void Invoke(IEventArgs* args) = 0; }; template </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;class A&gt; class Callback : public ICallback { typedef void (*f)(A*); public: Callback(f _pFunc) { ptr = _pFunc; } ~Callback() { delete ptr; } void Invoke(IEventArgs* args) { ptr((A*)args); } private: f ptr = nullptr; }; template &lt;typename T, class A&gt; class MemberCallback : public ICallback { typedef void (T::*f)(A*); public: MemberCallback(f _pFunc, T* _obj) { ptr = _pFunc; obj = _obj; } ~MemberCallback() { delete ptr; obj = nullptr; } void Invoke(IEventArgs* args) { (obj-&gt;*(ptr))((A*)args); } private: f ptr = nullptr; T* obj; }; class IEvent { public: virtual void Invoke(IEventArgs* args) = 0; virtual void Add(ICallback* callback) = 0; virtual bool Remove(ICallback* callback) = 0; virtual ~IEvent() {} };</span></span></span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдХреЛрдИ рд╡рд╕реНрддреБ рдЕрдкрдиреЗ рдЕрдВрджрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдШрдЯрдирд╛рдУрдВ рдХреА рд╕реВрдЪрдирд╛ рджреЗрдирд╛ рдЪрд╛рд╣рддреА рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдирд╛ рдХреЗ рд▓рд┐рдП IEvent * рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдПрдХ рдЕрдиреНрдп рдСрдмреНрдЬреЗрдХреНрдЯ рдЬреЛ рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдЕрдВрджрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдШрдЯрдирд╛рдУрдВ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддрд╛ рд╣реИ, рдЙрд╕реЗ ICallback * рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕реЗ IEvent * (рдИрд╡реЗрдВрдЯ рдХреА рд╕рджрд╕реНрдпрддрд╛) рдХреЗ рдЕрдВрджрд░ рдкрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдирд┐рдпрдВрддреНрд░рдХ рдореЗрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╕рджрд╕реНрдпрддрд╛рдПрдБ</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Attach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ statesChangedCallback = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemberCallback&lt;GameController, IEventArgs&gt;( &amp;GameController::OnStatesChanged, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); Model-&gt;GetRoshanStatus()-&gt;GetStates()-&gt;GetCurrentChanged()-&gt;Add( statesChangedCallback); buttonClickedCallback = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemberCallback&lt;GameController, IEventArgs&gt;( &amp;GameController::OnKillRoshanClicked, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); killButton-&gt;GetClickedEvent()-&gt;Add(buttonClickedCallback); }</code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдХрдХреНрд╖рд╛ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдШрдЯрдирд╛ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг - рдШрдбрд╝реА рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╣рд┐рдЯ (рдЯрд┐рдХ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ) рдХреЗ рд╕рд╛рде, рдПрдХ рд╕реНрдЯреНрд░рд╛рдЗрдХ рдЗрд╡реЗрдВрдЯ рдЙрдард╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IChrono</span></span></span><span class="hljs-class"> {</span></span> VIRTUAL_EVENT(Struck) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Tick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetStamp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDiffS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ts)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Chrono</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IChrono { EVENT(Struck) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Chrono() { start = time(<span class="hljs-number"><span class="hljs-number">0</span></span>); Struck = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Event(); } ~Chrono() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> Struck; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Tick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> cur = clock(); worked += cur - savepoint; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isStriking = savepoint &lt; cur; savepoint = cur; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isStriking) Struck-&gt;Invoke(<span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetStamp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> start * CLOCKS_PER_SEC + worked; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDiffS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ts)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (GetStamp() - ts) / CLOCKS_PER_SEC; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> worked = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> start; <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> savepoint; };</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореВрд▓ рдЖрджрд┐рдо рдкреНрд░рдХрд╛рд░ (SILK_INT, SILT_FLOAT, SILK_STRING, ...) Core.. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9. DirectX 9 </font></font></h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DirectX 9</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dota 2 рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдЧреНрд░рд╛рдлрд┐рдХ рдПрдкреАрдЖрдИ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред рдбрд┐рд╡рд╛рдЗрд╕ рдПрдХ рд╡рд░реНрдЧ рд╣реИ рдЬрд┐рд╕реЗ IUnogn рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓рд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВред рддрджрдиреБрд╕рд╛рд░, рдПрдХ рдЖрднрд╛рд╕реА рд╡рд┐рдзрд┐ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдХ рд╕рдВрдХреЗрддрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЙрди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдХреА рд╣рдореЗрдВ рдЬрд╝рд░реВрд░рдд рд╣реИред рдЧреИрд░-рд╡рд░реНрдЪреБрдЕрд▓ рдХреНрд▓рд╛рд╕ рдлрд╝рдВрдХреНрд╢рдВрд╕ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рд╡реЗ .code рдЦрдВрдб рдореЗрдВ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдХреЗрд╡рд▓ рд╡рд╣реА рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдУрд╡рд░рд░рд╛рдЗрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡реИрд╕реЗ, OpenGL рдФрд░ Vulkan рдореЗрдВ, рдбрд┐рд╡рд╛рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рд╡рд░реНрдЪреБрдЕрд▓ рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рдЖрдк GetProcAddress () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреЙрдЗрдВрдЯрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред DirectX 11 рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ 9 рд╕реЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рдмрд╣реБрдд рдЕрдзрд┐рдХ рдирд╣реАрдВред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрдЪреБрдЕрд▓ рдХреНрд▓рд╛рд╕ рдореЗрдердб (рд╕рд╛рде рд╣реА рдиреЙрди-рд╡рд░реНрдЪреБрдЕрд▓ рд╡рди) рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХреЗ рдХрд┐рд╕реА рднреА рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА рдЬрд░реВрд░рдд рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдЖрднрд╛рд╕реА рддрд░реАрдХреЛрдВ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдВрдХреЗрдд рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред рдХрдХреНрд╖рд╛ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЦреЛрдЬрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕реЗ рд╕реНрд╡рдпрдВ рдмрдирд╛рдПрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ Direct3DCreate9 рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ IDirect3D9 рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рд╣рдо CreateDevice рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдмрдирд╛рдПрдВрдЧреЗред рд╣рдо рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдбрд╛рдпрд░реЗрдХреНрдЯрдПрдХреНрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рд╕реАрдзреЗ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рд╛рдордЧреНрд░реА рдХреЛ рдордЬрдмреВрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗред рдЬреИрд╕рд╛ рдХрд┐ d3d9.h рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, Direct3DCreate9 рдПрдХ рдирд┐рдпрдорд┐рдд рдХрд╛рд░реНрдп рд╣реИ рдФрд░ рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдХреЗрддрдХ GetProcAddress рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдареАрдХ рдЙрд╕реА рддрд░рд╣ рдЬреИрд╕реЗ рд╣рдордиреЗ NativeInjector рдореЗрдВ рдПрдХ рд╕реВрдЪрдХ рдХреЛ рд▓реЛрдбрд░рд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдерд╛)ред</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/nr/fq/ai/nrfqai6vps7fc9lx_crerpvsbhq.png"></a> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 18 - d3d9.h рдореЗрдВ CreateDevice рдХрд╛ рд╡рд░реНрдгрди IDirect3D9 рдХрд╛</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдПрдБ:</font></font><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> IDirect3D9* (WINAPI *SILK_Direct3DCreate9) (UINT SDKVersion); <span class="hljs-comment"><span class="hljs-comment">//IDirect3D9* pD3D = Direct3DCreate9(D3D_SDK_VERSION); SILK_Direct3DCreate9 Silk_Direct3DCreate9 = (SILK_Direct3DCreate9)GetProcAddress(GetModuleHandle("d3d9.dll"), "Direct3DCreate9"); IDirect3D9* pD3D = Silk_Direct3DCreate9(D3D_SDK_VERSION);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDirect3D9 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо pD3D-&gt; CreateDevice (...) рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдПрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╡реАрдПрдордЯреА рд╕реЗ рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдХреЗрддрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЗрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 19 - IDirect3D9 рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреА CreateDevice рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛ рдЦреЛрдЬ</font></i><font style="vertical-align: inherit;"> 16 рд╡рд╛рдВ рд╕реВрдЪрдХрд╛рдВрдХ </font><i><font style="vertical-align: inherit;">рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ</font></i><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">CreateDevice рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрдВ рд░рд┐рд▓реАрдЬрд╝ рдФрд░ GetAdapterDisplayMode рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/ro/ap/ug/roapuggoav9xtztltqu8gs6zqiw.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдХреЛрдб рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HRESULT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WINAPI *SILK_GetAdapterDisplayMode)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3D9* direct3D9, UINT Adapter, D3DDISPLAYMODE* pMode)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HRESULT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WINAPI *SILK_CreateDevice)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3D9* direct3D9, UINT Adapter, D3DDEVTYPE DeviceType, HWND hFocusWindow, DWORD BehaviorFlags, D3DPRESENT_PARAMETERS* pPresentationParameters, IDirect3DDevice9** ppReturnedDeviceInterface)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ULONG</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WINAPI *SILK_Release)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3D9* direct3D9)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RELEASE_INDEX = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> GET_ADAPTER_DISPLAY_MODE_INDEX = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CREATE_DEVICE_INDEX = <span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-function"><span class="hljs-function">BOOL </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateSearchDevice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3D9** d3d, IDirect3DDevice9** device)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!d3d || !device) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FALSE; *d3d = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; *device = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-comment"><span class="hljs-comment">//IDirect3D9* pD3D = Direct3DCreate9(D3D_SDK_VERSION); SILK_Direct3DCreate9 Silk_Direct3DCreate9 = (SILK_Direct3DCreate9)GetProcAddress(GetModuleHandle("d3d9.dll"), "Direct3DCreate9"); IDirect3D9* pD3D = Silk_Direct3DCreate9(D3D_SDK_VERSION); if (!pD3D) return FALSE; D3DDISPLAYMODE displayMode; int pointerSize = sizeof(unsigned long long); unsigned long long vmt = **(unsigned long long **)&amp;pD3D; SILK_GetAdapterDisplayMode pGetAdapderDisplayMode = (SILK_GetAdapterDisplayMode)((*(unsigned long long *) (vmt + pointerSize * GET_ADAPTER_DISPLAY_MODE_INDEX))); pGetAdapderDisplayMode(pD3D, D3DADAPTER_DEFAULT, &amp;displayMode); //pD3D-&gt;GetAdapterDisplayMode(D3DADAPTER_DEFAULT, &amp;displayMode); HWND hWindow = GetDesktopWindow(); D3DPRESENT_PARAMETERS pp; ZeroMemory(&amp;pp, sizeof(pp)); pp.Windowed = TRUE; pp.hDeviceWindow = hWindow; pp.BackBufferCount = 0; pp.BackBufferWidth = 0; pp.BackBufferHeight = 0; pp.BackBufferFormat = displayMode.Format; pp.SwapEffect = D3DSWAPEFFECT_DISCARD; IDirect3DDevice9* pDevice = NULL; SILK_CreateDevice pCreateDevice = (SILK_CreateDevice) ((*(unsigned long long *)(vmt + pointerSize * CREATE_DEVICE_INDEX))); if(SUCCEEDED(pCreateDevice(pD3D, D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWindow, D3DCREATE_SOFTWARE_VERTEXPROCESSING | D3DCREATE_DISABLE_DRIVER_MANAGEMENT, &amp;pp, &amp;pDevice))) { //if (SUCCEEDED(pD3D-&gt;CreateDevice(D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWindow, D3DCREATE_SOFTWARE_VERTEXPROCESSING | D3DCREATE_DISABLE_DRIVER_MANAGEMENT, &amp;pp, &amp;pDevice))) { if (pDevice != NULL) { *d3d = pD3D; *device = pDevice; } } BOOL result = (*d3d != NULL); if (result == FALSE) if (pD3D) { SILK_Release pRelease= (SILK_Release)((*(unsigned long long *)(vmt + pointerSize * RELEASE_INDEX))); pRelease(pD3D); //pD3D-&gt;Release(); } return result; }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдареАрдХ рд╣реИ, рд╣рдордиреЗ рдбрд╛рдпрд░реЗрдХреНрдЯрдПрдХреНрд╕ 9 рдбрд┐рд╡рд╛рдЗрд╕ рдмрдирд╛рдпрд╛, рдЕрдм рд╣рдореЗрдВ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рджреГрд╢реНрдп рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рди рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдореЗрдВ рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд╣рдореЗрдВ рдЗрд╕ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: "рдбрд╛рдпрд░реЗрдХреНрдЯ 9 рд╣рдореЗрдВ рджреГрд╢реНрдп рдХреИрд╕реЗ рджрд┐рдЦрд╛рддрд╛ рд╣реИ?" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рджреГрд╢реНрдп рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣ рдлреНрд░рдВрдЯ рдмрдлрд╝рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдРрд╕реА рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЛ рдкреЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд╛рдпрдХ рднреА рд╣реИ (рдПрдХ рдмрдлрд░ рдЬреЛ рд╕реНрдХреНрд░реАрди рдкрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЧрдИ рд▓рдВрдмреА рдЕрд╡рдзрд┐ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ), рдмреИрдХ рдмрдлрд░ - рдЗрд╕рдореЗрдВ рд╡рд╣ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИ рдФрд░ рд╕рд╛рдордиреЗ рдмрдлрд░, рд╕реНрд╡реИрдк рдЪреЗрди рдмрдирдиреЗ рдХреА рддреИрдпрд╛рд░реА рдХрд░ рд░рд╣рд╛ рд╣реИ - рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдмрдлрд╝рд░реНрд╕ рдХрд╛ рдПрдХ рд╕реЗрдЯ рдЖрдЧреЗ рд╕реЗ рдкреАрдЫреЗ рдХреА рдУрд░ рдлреНрд▓рд┐рдкрд┐рдВрдЧ (DirectX 9 рдореЗрдВ рдХреЗрд╡рд▓ 1 рд╕реНрд╡реИрдк рдЪреЗрди рд╣реИ)ред рдкреНрд░реЗрдЬреЗрдВрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, BeginScene рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EndScene</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдПрдХ рдЬреЛрдбрд╝реЗ рдХреЛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ</font></a><font style="vertical-align: inherit;"> , рдЬрд╣рд╛рдВ рдЖрдк рдмреИрдХ рдмрдлрд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд▓реЛ рджреЛ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВ (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╡реНрдпрд╛рдкрд╛рд░ рддрд░реНрдХ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ): рдПрдВрдбрд╕реНрдХреИрди рдФрд░ рдкреНрд░реЗрдЬреЗрдВрдЯред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрди рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕реНрдерд╛рди рдХреЛ IDirect3DDevice9 рд╡рд░реНрдЧ </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 20 рдореЗрдВ рджреЗрдЦреЗрдВ -</font></i><font style="vertical-align: inherit;"> рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рдВрдХреНрд╢рди рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЗ рд╕рд╛рде </font><i><font style="vertical-align: inherit;">IDirect3DDiceice9 рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреА рдШреЛрд╖рдгрд╛ рдХреА рдШреЛрд╖рдгрд╛</font></i><font style="vertical-align: inherit;"> :</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/xa/ev/tk/xaevtkzg4h4whv7aejsfp025yr0.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HRESULT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*VirtualOverloadPresent)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pd3dDevice, CONST RECT* pSourceRect, CONST RECT* pDestRect, HWND hDestWindowOverride, CONST RGNDATA* pDirtyRegion)</span></span></span></span>; VirtualOverloadPresent oOverload = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HRESULT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*VirtualOverloadEndScene)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pd3dDevice)</span></span></span></span>; VirtualOverloadEndScene oOverloadEndScene = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> PRESENT_INDEX = <span class="hljs-number"><span class="hljs-number">17</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> END_SCENE_INDEX = <span class="hljs-number"><span class="hljs-number">42</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд╣реИрдВрдбрд▓рд░ рдХреЗ рд╕рд╛рде рддреБрд░рдВрдд рдПрдХ рдЬрд╛рд▓ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ HardwareBreakpoint рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рдорд╛рд░рд╛ рдПрдХрдорд╛рддреНрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрд╡рд░реЛрдзрди рд╡рд┐рдХрд▓реНрдк рд╣реИ рдЬреЛ VAC рдХреЛ рдЯреНрд░реИрдХ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ (рдЖрдк Opcode Hook рдХреЗ рд╕рд╛рде рднреА рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдкрдХрд╛ рдЦрд╛рддрд╛ рд╕рдВрднрд╡рддрдГ рдкреНрд░рддрд┐рдмрдВрдз рдореЗрдВ рдЙрдбрд╝ рдЬрд╛рдПрдЧрд╛) </font></font><br><br><pre> <code class="cpp hljs">silk_way::IDeferredCommands* deferredCommands; silk_way::IHook* hook; <span class="hljs-function"><span class="hljs-function">LONG </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnExceptionHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(EXCEPTION_POINTERS* exceptionPointers)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exceptionPointers-&gt;ExceptionRecord-&gt;ExceptionCode != EXCEPTION_SINGLE_STEP) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXCEPTION_EXIT_UNWIND; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; silk_way::DEBUG_REG_COUNT; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exceptionPointers-&gt;ContextRecord-&gt;Rip == (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>) hook-&gt;GetInfo()-&gt;GetItem(i)-&gt;source) { exceptionPointers-&gt;ContextRecord-&gt;Dr7 &amp;= ~(<span class="hljs-number"><span class="hljs-number">1U</span></span>LL &lt;&lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * i)); exceptionPointers-&gt;ContextRecord-&gt;Rip = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>) hook-&gt;GetInfo()-&gt;GetItem(i)-&gt;destination; silk_way::IDeferredCommand* cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> silk_way::SetD7Command(hook, GetCurrentThreadId(), i); deferredCommands-&gt;Enqueue(cmd); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXCEPTION_CONTINUE_EXECUTION; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдорд╛рд░реЗ рджреЛ рдЬрд╛рд▓реЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдзреНрд╡рдирд┐ рджреЗрдВ: </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">BOOL </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HookDevice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pDevice)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> vmt = **(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> **)&amp;pDevice; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pointerSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>); VirtualOverloadPresent pointerPresent= (VirtualOverloadPresent) ((*(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> *)(vmt + pointerSize * PRESENT_INDEX))); VirtualOverloadEndScene pointerEndScene = (VirtualOverloadEndScene) ((*(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> *)(vmt + pointerSize * END_SCENE_INDEX))); oOverload = pointerPresent; oOverloadEndScene = pointerEndScene; deferredCommands = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> silk_way::DeferredCommands(); <span class="hljs-comment"><span class="hljs-comment">//hook = new silk_way::HardwareBPHook(); hook = new silk_way::OpcodeHook(); hook-&gt;SetExceptionHandler(OnExceptionHandler); hook-&gt;SetHook(pointerPresent, &amp;PresentHook); hook-&gt;SetHook(pointerEndScene, &amp;EndSceneHook); return TRUE; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рд░реЛрд╣ рд░рд┐рд╕реАрд╡рд░: </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">HRESULT WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PresentHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pd3dDevice, CONST RECT* pSourceRect, CONST RECT* pDestRect, HWND hDestWindowOverride, CONST RGNDATA* pDirtyRegion)</span></span></span><span class="hljs-function"> </span></span>{ Capture(pd3dDevice); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = hook-&gt;GetRecordBySource(oOverload); VirtualOverloadPresent pTrampoline = (VirtualOverloadPresent) record-&gt;pTrampoline; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> result = pTrampoline(pd3dDevice, pSourceRect, pDestRect, hDestWindowOverride, pDirtyRegion); deferredCommands-&gt;Run(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-function">HRESULT WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndSceneHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pd3dDevice)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (controller == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>) { controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameController(); controller-&gt;SetDevice(pd3dDevice); } controller-&gt;Update(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> record = hook-&gt;GetRecordBySource(oOverloadEndScene); VirtualOverloadEndScene pTrampoline = (VirtualOverloadEndScene) record-&gt;pTrampoline; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> result = pTrampoline(pd3dDevice); deferredCommands-&gt;Run(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд▓ рдХреИрдкреНрдЪрд░ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реАрдбрд┐рдпреЛ рдХрд╛рд░реНрдб рдмрдлрд░ (рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП) рд╕реЗ рдПрдХ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рд▓реЗрддрд╛ рд╣реИ</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">VOID WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Capture</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pd3dDevice)</span></span></span><span class="hljs-function"> </span></span>{ IDirect3DSurface9 *renderTarget = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; IDirect3DSurface9 *destTarget = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; HRESULT res1 = pd3dDevice-&gt;GetRenderTarget(<span class="hljs-number"><span class="hljs-number">0</span></span>, &amp;renderTarget); D3DSURFACE_DESC descr; HRESULT res2 = renderTarget-&gt;GetDesc(&amp;descr); HRESULT res3 = pd3dDevice-&gt;CreateOffscreenPlainSurface( descr.Width, descr.Height, <span class="hljs-comment"><span class="hljs-comment">/*D3DFMT_A8R8G8B8*/</span></span>descr.Format, D3DPOOL_SYSTEMMEM, &amp;destTarget, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); HRESULT res4 = pd3dDevice-&gt;GetRenderTargetData(renderTarget, destTarget); D3DLOCKED_RECT lockedRect; ZeroMemory(&amp;lockedRect, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(lockedRect)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (destTarget == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; HRESULT res5 = destTarget-&gt;LockRect(&amp;lockedRect, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, D3DLOCK_READONLY); HRESULT res7 = destTarget-&gt;UnlockRect(); HRESULT res6 = D3DXSaveSurfaceToFile(screenshootPath, D3DXIFF_BMP, destTarget, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); renderTarget-&gt;Release(); destTarget-&gt;Release(); }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EndScene рдПрдХ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рдирд┐рдпрдВрддреНрд░рдХ рдмрдирд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдирд┐рд░реНрдорд╛рдг рдХреЗ рдмрд╛рдж, рдирд┐рдпрдВрддреНрд░рдХ рдЕрдкрдбреЗрдЯ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рд╕рднреА рддрд░реНрдХ рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ рдзреНрдпрд╛рди рджреЗрддрд╛ рд╣реВрдВ рдХрд┐ рдЕрдм рд╣рдордиреЗ DirectX 9 рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХреЛ рд▓рд╛рдЧреВ рдХрд░ рджрд┐рдпрд╛ рд╣реИред рдпрджрд┐ рд╣рдо рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдореЙрдб, рдзреЛрдЦрд╛, рдЖрджрд┐ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╕рднреА рдЪрд╛рд░ рдПрдкреАрдЖрдИ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрдЪрд┐рдд рд╣реИ рдпрджрд┐ рд╢рд╕реНрддреНрд░рд╛рдЧрд╛рд░ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЖрдкрдХреЗ рдкрд╕рдВрджреАрджрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реИрдВ, UI рдХреЗ рд▓рд┐рдП рд░рд┐рдХреНрдд рд╣реИ, рдЕрдиреНрдпрдерд╛ рдЖрдк рдПрдХ рдФрд░ рддрд░реАрдХрд╛ - рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЧреЗрдо рдХреЛ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рднреА рдХрд╣рдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ EndScene () рд╕реЗ рд▓реЙрдЬрд┐рдХ рдЕрдкрдбреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИ - рдЖрдк рд╕рдордп-рд╕рдордп рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдЬрди рдлрд╝рдВрдХреНрд╢рди рдпрд╛ рдЕрдкрдиреА рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд▓реЙрдЬрд┐рдХ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрджрд┐, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдПрдВрдбрд╕реНрдХреАрди рдХреЗ рдХреЙрд▓ рд╕реЗ рд╕рдВрддреБрд╖реНрдЯ рд╣реИрдВ, рддреЛ рд▓реЙрдХрд╕реНрдЯреЗрдк рдХреЗ рд╕рд╛рде рдРрд╕рд╛ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдордиреЗ рд╡рд╣ рд╕рдм рдХреБрдЫ рд▓рд╛рдЧреВ рдХрд░ рджрд┐рдпрд╛ рд╣реИ рдЬрд┐рд╕рдХреА рд╣рдордиреЗ рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рдереАред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░реАрдХреНрд╖рдг рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ</font></font></b> <div class="spoiler_text">       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">DirectX SDK</a> ,    ,  DirectX 9  DirectX 11.           DirectX 11,    -      SDK,     (  ,         )   ,     ,     DXUT,      ,      тАФ   ,   FPS   . <br><br> <a href=""><img src="https://habrastorage.org/webt/o-/hq/zg/o-hqzgthdamhzrum5h8upaenqly.png"></a> <br> <i> 21 тАФ     DirectX SDK   StateManager.exe</i> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдЖрдк рд╕реНрдЯреАрдо рдореЗрдВ рдПрдХ рдирдХрд▓реА рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред Dota 2 рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ рддреБрд░рдВрдд рдХрд╣реВрдВрдЧрд╛, рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ "рдЖрдпрд░рди" рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреИрд╕реА рд╣реИ - рдУрдкрдХреЛрдб рд╣реБрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ рд╣рдо рдЗрд╕реЗ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХрд░рддреЗ рд╣реИрдВред рдлрд╛рд░реНрдо) рдЖрдкрдХреЛ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдмрдВрдз рдорд┐рд▓реЗрдЧрд╛ред рдореИрдВрдиреЗ рд▓рдЧрднрдЧ рдЫрд╣ рдорд╣реАрдиреЗ рдкрд╣рд▓реЗ рдРрд╕рд╛ рдХрд┐рдпрд╛ рдерд╛ - рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдмреНрд░реЗрдХрдкреНрд╡рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдкреНрд░рддрд┐рдмрдВрдз рдирд╣реАрдВ рдерд╛, рдореИрдВ рдпрд╣ рдирд╣реАрдВ рдХрд╣ рд╕рдХрддрд╛ рдХрд┐ рдЗрд╕ рд╕рдордп рд╕реНрдерд┐рддрд┐ рдХреНрдпрд╛ рд╣реИред рд▓реЗрдЦ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдореИрдВрдиреЗ рджреЛ рдЦрд╛рддреЛрдВ рдХреЛ рд▓рд┐рдпрд╛ рдФрд░ рдЙрди рдкрд░ рдУрдкрдХреЛрдб рд╣реБрдХ рдФрд░ рдПрдЪрдбрдмреНрд▓реНрдпреВрдмреАрдкреА рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдкрд╣рд▓рд╛ рдкреНрд░рддрд┐рдмрдВрдз рдореЗрдВ рдЙрдбрд╝ рдЧрдпрд╛ (рд▓рдЧрднрдЧ 2 рд╕рдкреНрддрд╛рд╣ рдмреАрдд рдЧрдП), рджреВрд╕рд░рд╛ рдирдВрдмрд░ (3 рд╕рдкреНрддрд╛рд╣ рдмреАрдд рдЧрдП)ред рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА рдЗрд╕ рдмрд╛рдд рдХреА рдХреЛрдИ рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рдмрдВрдз рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред рддрдм рдирд╛рд░рд╛рдЬ рдордд рд╣реЛрдЗрдП рдпрджрд┐ рдЖрдк рдЧрд▓рддреА рд╕реЗ рдЕрдкрдиреЗ рдореБрдЦреНрдп рдЦрд╛рддреЗ рд╕реЗ рдПрдХ рдкрд░рд┐рдЪрдп рдмрдирд╛рддреЗ рд╣реИрдВ рдпрд╛ рдирдХрд▓реА рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛ рднреВрд▓ рдЬрд╛рддреЗ рд╣реИрдВ - рддреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдкрдирд╛ рдЦреНрдпрд╛рд▓ рд░рдЦреЗрдВ рдФрд░ рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВред</font></font></b> <br><br><div class="spoiler"> <b class="spoiler_title">    ( )</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/d9/tw/44/d9tw44gqefmz8pvwr1c7y-ppbhq.png"><br> <i> 22 тАФ  </i> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/nk/v4/za/nkv4zafl57fjog_vqnsf5k1q-va.png"><br> <i> 23 тАФ    </i> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1x1 рдореЛрдб рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 24 - рдПрдХ рдореИрдЪ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди</font></i><font style="vertical-align: inherit;"> рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдЙрдкрдпреБрдХреНрдд рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рджреВрд╕рд░реА рд╡рд┐рдВрдбреЛ рдмрдирд╛рдХрд░ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ - рд╕рддрд╣ рд░реЗрдВрдбрд░рд┐рдВрдЧред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдореИрдВ рдлрд╝реБрд▓-рд╕реНрдХреНрд░реАрди рдореЛрдб рдХреЗ рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рддрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХрд╛ рдПрд╣рд╕рд╛рд╕ рдирд╣реАрдВ рдХрд░ рд╕рдХрд╛, рд▓реЗрдХрд┐рди рд▓реЗрдЦ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЖрдкрдХреЛ рдкреВрд░реНрдг рд╕реНрдХреНрд░реАрди рдФрд░ рд╡рд┐рдВрдбреЛ рдореЛрдб рджреЛрдиреЛрдВ рдореЗрдВ рд░реЗрдВрдбрд░рд┐рдВрдЧ рдХреЛ рдмрд┐рдирд╛ рдХрд┐рд╕реА рд╕рдорд╕реНрдпрд╛ рдХреЗ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдПрдореНрдмреЗрдбреЗрдб рдпреВрдЖрдИ рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдкрд╛рда рд▓реЗрдмрд▓ рдФрд░ рд╢реБрджреНрдз DirectX 9 рдкрд░ рд▓рд╛рдЧреВ рдПрдХ рдмрдЯрди рд╢рд╛рдорд┐рд▓ рд╣реИ - рдпрд╣ рд╡рд╣ рд╕рдм рд╣реИ рдЬреЛ рдХрд╛рд░реНрдп рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдЖрдк рдЬрдЯрд┐рд▓ рддрд╛рд▓рд┐рдХрд╛рдУрдВ, рд╕реБрдВрджрд░ рдореЗрдиреВ рдФрд░ рдЖрд░реЗрдЦреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ - рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ, рдХрд┐рд╕реА рднреА рдЬрдЯрд┐рд▓рддрд╛ рдХрд╛ рдПрдХ рдпреВрдЖрдИ, рд╢реБрджреНрдз рдПрдкреАрдЖрдИ рдкрд░ рдФрд░ рддреИрдпрд╛рд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдмреЗрд╢рдХ, рди рдХреЗрд╡рд▓ 2 рдбреАред</font></font><br> <a href=""><img src="https://habrastorage.org/webt/r2/6v/ix/r26vixlwxtaspaykchnffmpwexm.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10. рдЗрдВрдЬрди рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдПрдкреАрдЖрдИ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдмрд▓реНрдХрд┐ рдиреАрд░рд╕ рд╣реИ, рдбреЗрд╡рд▓рдкрд░реНрд╕ рдбреНрд░рд╛рдЗрдВрдЧ, рдпреВрдЖрдИ рдФрд░ рдЗрддрдиреЗ рдкрд░ рдХрд╛рд░реНрдп рдкреНрд░рджрд╛рди рдХрд░рдХреЗ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдЖрд╡рд░рдг рдмрдирд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдЦреЗрд▓ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд╛рд▓реНрд╡ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реБрдЖ рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдП рдбреЛрдЯрд╛ 2 рдПрдкреАрдЖрдИ рднреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдордзреНрдпрд╕реНрдереЛрдВ рдФрд░ рдЧреЗрдо рдбрд┐рдЬрд╛рдЗрдирд░реЛрдВ рдХреЗ рд▓рд┐рдП рдЬреАрд╡рди рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рдирдХреЗ рд▓рд┐рдП рд╕реА ++ рдЬрдЯрд┐рд▓ рд╣реИ (рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╕реА ++ рд╣реА рдирд╣реАрдВ, рд▓реЗрдХрд┐рди рдЗрдВрдЬрди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЙрдЪрд┐рдд рдЙрдкрдпреЛрдЧ)ред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдкреНрд░рддрд┐рдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдп рд╣реИрдВ, рдФрд░ рдЦреЗрд▓ рдХреЗ рддрд░реНрдХ рдХреЗ рд▓рд┐рдП - рдЖрдк рдЗрдХрд╛рдИ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдЗрдЯрдо рдХрд╛ рдЪрдпрди рдХрд░рдирд╛, рдХреМрд╢рд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рдФрд░ рдмрд╣реБрдд рдХреБрдЫред </font><font style="vertical-align: inherit;">рджрд░рдЕрд╕рд▓, рдЗрд╕рдХреА рдорджрдж рд╕реЗ рдХрд╕реНрдЯрдо рдЕрдХреНрд╖рд░ рд▓рд┐рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ DoIncludeScript рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд░реБрдЪрд┐ рд╣реЛрдЧреА, рдЬреЛ рдЖрдкрдХреЛ рдЕрдкрдиреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ Lua рдкрд░ рдЪрд▓рд╛рдиреЗ рдФрд░ рд╡рд╣рд╛рдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдореИрдВрдиреЗ рдЕрдкрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛, рдХреНрдпреЛрдВрдХрд┐ рдореИрдВрдиреЗ рдЗрд╕рдореЗрдВ рдореВрд▓реНрдп рдирд╣реАрдВ рджреЗрдЦрд╛ рдерд╛, рд╕реА ++ рд╕реЗ рд╕реАрдзреЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдореИрдВрдиреЗ рдЗрд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or_75 рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рджреЗрдЦрд╛ </font><font style="vertical-align: inherit;">рдФрд░ рдЗрд╕реЗ рд▓реЗрдЦ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ред рдпрд╣ рдЖрдкрдХреЛ рджреВрд╕рд░реЗ рд╣рд┐рд╕реНрд╕реЗ рдореЗрдВ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕рдореЗрдВ рдЬрдЧрд╣ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдкреЗрд╢ рдХрд░реЗрдЧрд╛, рдЖрдкрдХреЛ рдбрд┐рдмрдЧрд░ рдХреЗ рдХреБрдЫ рдкрд╣рд▓реБрдУрдВ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдирд╣реАрдВ рдХрд░рдиреА рд╣реЛрдЧреАред</font></font><br><br>  рдЪрд▓рд┐рдП рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░реНрдп рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИ: рдЖрдкрдХреЛ DoIncludeScript рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдХреЗрддрдХ рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕реЗ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╣реИрдВрдбрд▓рд░ рдХрд╛ рдирд╛рдо рд▓реЗрддрд╛ рд╣реИред рд╣рдо рдЕрдкрдиреЗ рд╕рд┐рд▓реНрдХ_рд╡реЗ.рд▓рд┐рдм рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рд╕реНрдХреИрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЦреЛрдЬ рдХрд░реЗрдВрдЧреЗред рдлрд╝рдВрдХреНрд╢рдВрд╕, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдкрд╣рд▓реЗ рд╣реА рдкрддрд╛ рд▓рдЧрд╛ рдЪреБрдХреЗ рд╣реИрдВ, рдУрдкрдХреЛрдб рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЗрдореЛрд░реА рдореЗрдВ рдПрдиреНрдХреЛрдбреЗрдб рд╣реИрдВ - рдЖрдЗрдП рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рдореЗрдореЛрд░реА рдореЗрдВ рдЗрд╕рдХреЗ рднрдВрдбрд╛рд░рдг рдкреИрдЯрд░реНрди рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдЕрдм рд╕реНрдХреИрдирд░ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдирд╣реАрдВ рд╣реИ, рд╣рдореЗрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рдХреЛ рдЧрддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкреВрд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рдПрдХ рдкреИрдЯрд░реНрди рдХреА рдЦреЛрдЬ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ (рд╣рдорд╛рд░рд╛ рдлрд╝рдВрдХреНрд╢рди рдХреНрд▓рд╛рдЗрдВрдЯрдбреЙрд▓ рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ, рдпрд╣ рдбрд┐рдмрдЧрд░ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдиреАрдЪреЗ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреА)ред рд╣рдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рднреА рдореЙрдбреНрдпреВрд▓реЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рдХреЗ tlHelp32 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЙрдбреНрдпреВрд▓ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдо рд╡рд░реНрддрдорд╛рди GetModuleInfo рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛рдПрдВрдЧреЗред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetModuleInfo рдлрд╝рдВрдХреНрд╢рди рдХреЛрдб</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IScanner::GetModuleInfo(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* name, MODULEENTRY32* entry) { HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE32 | TH32CS_SNAPMODULE, GetCurrentProcessId()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (snapshot == INVALID_HANDLE_VALUE) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; entry-&gt;dwSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(MODULEENTRY32); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Module32First(snapshot, entry)) { CloseHandle(snapshot); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_stricmp(entry-&gt;szModule, name)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Module32Next(snapshot, entry)); CloseHandle(snapshot); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреИрдЯрд░реНрди рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реИ, рдмрд╛рдЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдирд╛ рдкреНрд░рддреАрдХ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ "??" </font><font style="vertical-align: inherit;">- рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, "j9 ??</font></font> ??  ??  ??<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рек режрей реж 48 ?? </font><font style="vertical-align: inherit;">f1 ff тАЭред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛, рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд╕реЗ рдкреИрдЯрд░реНрди рдХреЛ рдЕрд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЪрд╛рд░ рдореВрд▓реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдЭрдВрдбреЗ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВред</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* IScanner::Parse(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&amp; len, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* strPattern, <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* skipByteMask) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> strPatternLen = <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(strPattern); <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* pattern = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[strPatternLen]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; strPatternLen; i++) pattern[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; len = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; strPatternLen; i += <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> code = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strPattern[i] == SKIP_SYMBOL) skipByteMask[len] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> code = Parse(strPattern[i]) * <span class="hljs-number"><span class="hljs-number">16</span></span> + Parse(strPattern[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]); i++; pattern[len++] = code; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pattern; } <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> IScanner::Parse(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> byte) { <span class="hljs-comment"><span class="hljs-comment">// some magic values if (byte &gt;= '0' &amp;&amp; byte &lt;= '9') return byte - '0'; else if (byte &gt;= 'a' &amp;&amp; byte &lt;= 'f') return byte - 'a' + 10; else if (byte &gt;= 'A' &amp;&amp; byte &lt;= 'F') return byte - 'A' + 10; return 0; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рдХреЛрд░ FindPattern рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ, рдореЙрдбреНрдпреВрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЦреЛрдЬ рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рдкрддреЗ рд╕реЗрдЯ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЦреЛрдЬ рдХреА рдЧрдИ рдореЗрдореЛрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА VirtualQuery рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрд░реЛрдз рдХреА рдЧрдИ рд╣реИ, рдореЗрдореЛрд░реА рдХреЗ рд▓рд┐рдП рдХрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ рд╣реИрдВ - рдпрд╣ рд╡реНрдпрд╕реНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдпрд╣ рдореБрдлреНрдд рдореЗрдореЛрд░реА рдореЗрдВ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддреНрд░реБрдЯрд┐ рд╣реЛрдЧреА), рдореЗрдореЛрд░реА рдХреЛ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп, рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕рдореЗрдВ рдкреЗрдЬрдмреЛрд░реНрдб рдзреНрд╡рдЬ рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* pStart = moduleEntry.modBaseAddr; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* pFinish = moduleEntry.modBaseAddr + moduleEntry.modBaseSize; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* current = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*)pStart; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; current &lt; pFinish &amp;&amp; j &lt; patternLen; current++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!VirtualQuery((LPCVOID)current, &amp;info, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(info))) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> protectMask = PAGE_READONLY | PAGE_READWRITE | PAGE_EXECUTE_READWRITE | PAGE_EXECUTE | PAGE_EXECUTE_READ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (info.State == MEM_COMMIT &amp;&amp; info.Protect &amp; protectMask &amp;&amp; !(info.Protect &amp; PAGE_GUARD)) { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> finish = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)pFinish &lt; (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)info.BaseAddress + info.RegionSize ? (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)pFinish : (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>) info.BaseAddress + info.RegionSize; current = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*)info.BaseAddress; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* rip = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> k = (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)info.BaseAddress; k &lt; finish &amp;&amp; j &lt; patternLen; k++, current++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (skipByteMask[j] || pattern[j] == *current) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (j == <span class="hljs-number"><span class="hljs-number">0</span></span>) rip = current; j++; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pattern[<span class="hljs-number"><span class="hljs-number">0</span></span>] == *current) { rip = current; j = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (j == patternLen) { current = rip; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> current += sysInfo.dwPageSize; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рдирд╣реАрдВ рдкрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рджреЗрдЦрдирд╛ рд╣реИред рдлрд╝реЗрдХ рдЕрдХрд╛рдЙрдВрдЯ рдХреЗ рддрд╣рдд рд╕реНрдЯреАрдо рдЪрд▓рд╛рдПрдВ рдФрд░ рдЕрдкрдирд╛ рдкрд╕рдВрджреАрджрд╛ рдбреАрдмрдЧрд░ рдЦреЛрд▓реЗрдВ (рдЖрдЗрдП рд╕рд╣рдордд рд╣реИрдВ рдХрд┐ рд▓реЗрдЦ рдкрдврд╝рдиреЗ рдХреЗ рд╕рдордп рдХреЗ рд▓рд┐рдП x64dbg рдЖрдкрдХреЗ рд▓рд┐рдП рднреА рд╣реИ - рдореЗрд░реЗ рдкрд╛рд╕ рдЖрдИрдбреАрдП рдкреНрд░реЛ рдХреЗ рд▓рд┐рдП рднреБрдЧрддрд╛рди рд▓рд╛рдЗрд╕реЗрдВрд╕ рдирд╣реАрдВ рд╣реИ), рдЗрд╕рдореЗрдВ рд╕реЗ dota2.exe рдЪрд▓рд╛рдПрдВ ... \ рд╕реНрдЯреАрдо \ рд╕реНрдЯреАрдореИрдкреНрд╕ \ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдЖрдо \ dota 2 рдмреАрдЯрд╛ \ рдЧреЗрдо \ рдмрд┐рди \ рд╡рд┐рди ремрекред рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдпрд╣ рдирд╣реАрдВ рджреЗрдЦрд╛ рдХрд┐ рд╡реАрдПрд╕реА рдзреЛрдЦрд╛ рдЗрдВрдЬрди рдФрд░ x64dbg рдХреЗ рдкреНрд░рддрд┐ рдЙрджрд╛рд╕реАрди рдирд╣реАрдВ рдерд╛, рдореБрдЭреЗ рдпрд╛рдж рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдЦрд╛рддреЗ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд▓рдЧрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╡реИрд╕реЗ, рдбрд┐рдмрдЧрд░ рдореЗрдВ рдПрдХ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScyllaHide</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд▓рдЧрдЗрди рд╣реЛрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ NtCreateThreadEx, NtSetInformationThread, рдЖрджрд┐, рдЗрд╕рдХреЗ рдХрд╛рдо рдХреЗ рддрдереНрдп рдХреЛ рдЫрд┐рдкрд╛рддреЗ рд╣реБрдП, рдЖрдк рдЗрд╕ рдкреНрд▓рдЧрдЗрди рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдЯреЙрдк рдкрд░ (10-15 рд╣реЛрдЧрд╛), рд╣рдо рд░рди (F9) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВред рдЬрдм рдЦреЗрд▓ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдореЗрдиреВ рджреЗрдЦреЗрдВрдЧреЗ рдФрд░ рд╢реЛрдз рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЦреЗрд▓ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд▓рд╛рдЗрдиреЛрдВ рдкрд░ рдПрдХ рдЦреЛрдЬ рдХрд░реЗрдВ (рдЦреЛрдЬреЗрдВ-&gt; рд╕рднреА рдореЙрдбреНрдпреВрд▓-&gt; рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕рдВрджрд░реНрдн), "DoIncludeScript" рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗрдЯ рдХрд░реЗрдВред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 25 - рдЦреЗрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕реНрдореГрддрд┐ рдореЗрдВ рд▓рд╛рдЗрдиреЛрдВ рдХреА рдЦреЛрдЬ</font></i><font style="vertical-align: inherit;"> рдХрд░рдирд╛ рдкрд╣рд▓реЗ рдкрд░рд┐рдгрд╛рдо рдкрд░ рдбрдмрд▓-рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░ (рд╕реАрдкреАрдпреВ рдЯреИрдм) рдкрд░ рдЬрд╛рдПрдВред рдпрд╣ рд╣рдорд╛рд░рд╛ рд╢реБрд░реБрдЖрддреА рдкрддрд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ client.dll рдореЗрдВ рд╣реИ, рдмрд╛рдХреА рдХреЗ рдкрд░рд┐рдгрд╛рдо server.dll рдФрд░ animationsystem.dll рдореЗрдВ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдкреНрд░рд╛рдкреНрдд рдкрддреЗ рд╕реЗ рдХреЙрд▓ рдХрд╛ рдПрдХ рдЧреНрд░рд╛рдл рдмрдирд╛рддреЗ рд╣реИрдВред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 26 - рдХреЙрд▓ рдЧреНрд░рд╛рдлрд╝</font></i><font style="vertical-align: inherit;"> , рд╡рд┐рдШрдЯрди рдХреЗ рдмрд╛рдж, рд╣рдо рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдкрд╛рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдБ DoIncludeScript рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рдЧреНрд░рд╛рдлрд╝ рдХрд╛ рдЪреМрдерд╛ рдиреЛрдбред рджрд░рдЕрд╕рд▓, рдлрдВрдХреНрд╢рди рд╣реАред</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/nl/t2/x7/nlt2x7qovaunasqqpd6hqojgclw.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br> <a href=""><img src="https://habrastorage.org/webt/om/os/zo/omoszo_tqtleqsulp5c97sp7iwo.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br> <a href=""><img src="https://habrastorage.org/webt/ja/pp/zo/jappzokowbi-si2zm8zchka3pjk.png"></a> <br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 27 - DoIncludeScript</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреНрд░рд╛рдлрд╝ </font><i><font style="vertical-align: inherit;">рдлрд╝рдВрдХреНрд╢рди</font></i><font style="vertical-align: inherit;"> ред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 28 - DoIncludeScript рд╕реЗ рдХреЙрд▓ рдЧреНрд░рд╛рдл</font></i><font style="vertical-align: inherit;"> рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдХрдо рдХрд░рдирд╛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдФрд░ рдЗрд╕рдХреА рдХреЙрд▓ рдХреА рдЬрдЧрд╣ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ ( </font><i><font style="vertical-align: inherit;">рдбрд┐рдХрдореНрдкреЛрдЬрд╝рд┐рд▓реЗрд╢рди рдЧреНрд░рд╛рдлрд╝ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░</font></i><font style="vertical-align: inherit;"> рд╕реЗ рдирд╣реАрдВ)ред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 29 - DoIncludeScript рдлрд╝рдВрдХреНрд╢рди</font></i><font style="vertical-align: inherit;"> рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХреЛ рдШрдЯрд╛рдХрд░ DoIncludeScript рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХреЗ рдЪрд┐рддреНрд░ 27 рдореЗрдВ рджрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рд╕реЗ рдПрдХ рдЯреЗрдореНрдкрд▓реЗрдЯ рд▓рд┐рдЦреЗрдВред </font><font style="vertical-align: inherit;">рддрд░реНрдХ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрд░рдорд╢рдГ, рд╣рдо рдЦреЛрдЬ рдХрд░рддреЗ рд╕рдордп рдЯреЗрдореНрдкрд▓реЗрдЯ рдореЗрдВ рддрд░реНрдХреЛрдВ рдХреЛ рдЫреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╣рдо рдЙрдиреНрд╣реЗрдВ "??" рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реВрдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдореБрдЭреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд┐рд▓рд╛: 40 57 48 81 рдИрд╕реА ??</font></font><br><br> <a href=""><img src="https://habrastorage.org/webt/ji/q0/w9/jiq0w96b8mmvbuh7un7iyiffq_8.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><br><br> <a href=""><img src="https://habrastorage.org/webt/pb/rl/8h/pbrl8hdsnnowxoyfq-lz1xbq3xg.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font> ??  ??  ??<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 48 83 3 рдбреА ?? </font></font> ??  ??  ??  ??<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48 8B F9 0F 84. рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рдЪрд┐рддреНрд░ 28 рд╕реЗ рдЧреНрд░рд╛рдл рдХреЗ рдкрд╣рд▓реЗ рдиреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬрд┐рд╕рдХреЗ рдирд┐рд░реНрджреЗрд╢ рдЪрд┐рддреНрд░ 27 рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lua Silk_way.lua рдкрд░ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдПрдВ, рдЗрд╕реЗ "... рд╕реНрдЯреАрдо / рд╕реНрдЯреАрдо \ рд╕реНрдЯреАрдореНрдкреНрд╕ \ рдЖрдо 2 рдбреЙрдЯрд╛ 2 рдмреАрдЯрд╛" рдореЗрдВ рдбрд╛рд▓реЗрдВред \ game \ dota \ рд╕реНрдХреНрд░рд┐рдкреНрдЯ \ vscripts "ред</font></font><br><br><pre> <code class="lua hljs"><span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"SILK_WAY START"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> first = Entities:First() <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (first ~= <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> position = first:GetAbsOrigin() <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> strInfo = <span class="hljs-string"><span class="hljs-string">"["</span></span> .. <span class="hljs-string"><span class="hljs-string">"pos:"</span></span> .. <span class="hljs-built_in"><span class="hljs-built_in">tostring</span></span>(position.x) .. <span class="hljs-string"><span class="hljs-string">","</span></span> .. <span class="hljs-built_in"><span class="hljs-built_in">tostring</span></span>(position.y) .. <span class="hljs-string"><span class="hljs-string">","</span></span> .. <span class="hljs-built_in"><span class="hljs-built_in">tostring</span></span>(position.z) .. <span class="hljs-string"><span class="hljs-string">"]"</span></span> DebugDrawText(position, strInfo, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-number"><span class="hljs-number">300.0</span></span>) first = Entities:Next(first) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"SILK_WAY FINISH"</span></span>) <span class="hljs-comment"><span class="hljs-comment">--[[ListenToGameEvent("dota_roshan_kill",roshan_kill,nil)]]</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рднреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддреА рд╣реИ рдФрд░ рдЕрдкрдиреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреА рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдКрдкрд░ рдХреЗ рдкреНрд░рд▓реЗрдЦрди рдФрд░ рдЪрд┐рддреНрд░ 29 рд╕реЗ рд╡рд┐рдШрдЯрд┐рдд рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдШреЛрд╖рд┐рдд рдХрд░реЗрдВред</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*fDoIncludeScript)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">*, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрдВрдХреНрд╢рди рдХреЙрд▓ред </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">HRESULT WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EndSceneHook</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IDirect3DDevice9* pd3dDevice)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (controller == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>) { controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameController(); controller-&gt;SetDevice(pd3dDevice); fDoIncludeScript DoIncludeScript = (fDoIncludeScript) scanner-&gt;FindPattern(<span class="hljs-string"><span class="hljs-string">"client.dll"</span></span>, <span class="hljs-string"><span class="hljs-string">"40 57 48 81 EC ?? ?? ?? ?? 48 83 3D ?? ?? ?? ?? ?? 48 8B F9 0F 84"</span></span>); DoIncludeScript(<span class="hljs-string"><span class="hljs-string">"silk_way"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-comment"><span class="hljs-comment">//... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдмрд╛рдж, рд╣рдо рдЦреЗрд▓ рдХреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВрдЧреЗред </font><i><font style="vertical-align: inherit;">рдЪрд┐рддреНрд░ 30 - рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░рд┐рдгрд╛рдо</font></i><font style="vertical-align: inherit;"> рдЕрдм рд╣рдо рдЕрдкрдиреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╡реЗ рд▓реБрдЖ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдЖрдЗрдП рд╣рдо рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рд░реЛрд╢рди рдХреА рдореГрддреНрдпреБ C ++ рдХреЛрдб рдореЗрдВ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЙрд╕ рдкрд░ рд▓рд┐рдЦрд╛ рдореБрдЦреНрдп рддрд░реНрдХ рд╣реИ), рд╣рдореЗрдВ рдХреНрдпрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? </font><font style="vertical-align: inherit;">рд╣рдореЗрдВ рд╕реНрд░реЛрдд SDK рдФрд░ Source2Gen рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕реА рддрд░рд╣ (рдЬреИрд╕реЗ рд╣рдордиреЗ DoIncludeScript рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдерд╛), рдЗрдВрдЬрди рдлрд╝рдВрдХреНрд╢рдВрд╕, рдФрд░ рдмреНрдпрд╛рдЬ рдХреА рдЕрдиреНрдп рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯрд░реНрд╕ рдвреВрдВрдврдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдЬрд╣рд╛рдВ рд╣рдо рдПрдХ рд╕рдВрдХреЗрддрдХ рдХреЛ рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рдкрд╛рдПрдВрдЧреЗ рдФрд░ рдЦреЗрд▓ рдХреЗ рдпрд╛рдВрддреНрд░рд┐рдХреА рдХреЗ рдХрд░реАрдм рддрд░реНрдХ рд▓рд┐рдЦреЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЖрдк рдПрдХ рдмрд╛рд░ рдореЗрдВ рд╕рдм рдХреБрдЫ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЖрдк рдХреЗ рдПрдХ рд╕рд╛рдзрди рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдк рдХреЗ рд▓рд┐рдП рд╕рдВрд▓рдЧреНрди рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдЗрд╕</font></a><font style="vertical-align: inherit;"> , </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдпрд╣</font></a><font style="vertical-align: inherit;"> , </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдпрд╣</font></a><font style="vertical-align: inherit;"> рдФрд░ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдЗрд╕</font></a></font><br><br> <a href=""><img src="https://habrastorage.org/webt/en/x2/4l/enx24lrbff5j_6l0v4ydxhecm84.png"></a> <br> <i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдВрдХред </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. рдирд┐рд╖реНрдХрд░реНрд╖ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, рдореИрдВ рд╣рд░ рдХрд┐рд╕реА рдХреЛ рдзрдиреНрдпрд╡рд╛рдж рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдЬреЛ рдЕрдкрдиреА рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рдкреНрд░рдерд╛рдУрдВ рдФрд░ рдЬреНрдЮрд╛рди рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рддрд╛ рд╣реИ, рджреВрд╕рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЕрдкрдиреЗ рдЕрдиреБрднрд╡ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддрд╛ рд╣реИред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реЗрдЯреЙрдЧ рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрд┐рдирд╛ рдХреЗрд╡рд▓ рдбреЛрдЯрд╛ 2 рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмреЛрд▓рддреЗ рд╣реБрдП </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> рдореИрдВрдиреЗ рдЪреАрдЯ рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧреЗрдо рдХреА рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рдордп рдорд╛рд░рд╛ рд╣реЛрдЧрд╛, рдФрд░ рдХрд┐рдП рдЧрдП рдЙрдкрд▓рдмреНрдзрд┐рдпреЛрдВ рдХреЛ рдХрд┐рд╕реА рднреА рд╡рд╛рд▓реНрд╡ рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рддреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдкрдбреЗрдЯреНрд╕ рдиреЗ рд╕реНрдерд┐рд░ рд╕реНрдЯреЗрдЯрд░реНрд╕ рдХреЛ рдкрд╛рдпрд╛ рдФрд░ рдХрднреА-рдХрднреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ред рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or75</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореИрдВ рдЙрдкрдпреЛрдЧ DoIncludeScript рд╕рдорд╛рд░реЛрд╣ рджреЗрдЦрд╛ рдерд╛ рдФрд░ рдЗрд╕рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдЦреЗрд▓ рдЗрдВрдЬрди рдХреЗ рдкрд╛рда рдЙрддреНрдкрд╛рджрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рд╕реНрддреБрддрд┐ рдХреА рд╕рд╛рджрдЧреА рдХреА рдЦреЛрдЬ рдореЗрдВ, рдореБрдЭреЗ рдХреБрдЫ рдпрд╛рдж рдЖ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди рдорд╛рдорд▓реЛрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВрдиреЗ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рдорд╛рдирд╛, рдпрд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреЛ рдлреБрд▓рд╛рдпрд╛ - рдпрджрд┐ рдПрдХ рдЪреМрдХрд╕ рдкрд╛рдардХ рдХреЛ рдРрд╕реА рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдорд┐рд▓рддреА рд╣реИрдВ, рддреЛ рдореБрдЭреЗ рдЙрдиреНрд╣реЗрдВ рд╕реБрдзрд╛рд░рдиреЗ рдФрд░ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЛ рд╕реБрдирдиреЗ рдореЗрдВ рдЦреБрд╢реА рд╣реЛрдЧреАред </font><font style="vertical-align: inherit;">рд╕реНрд░реЛрдд рдХреЛрдб </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдВрдХ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдЦ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рдирд┐рдХрд╛рд▓рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдХрд╛ рдзрдиреНрдпрд╡рд╛рджред</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi446516/">https://habr.com/ru/post/hi446516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi446504/index.html">рдбреА-рд╡реЗрд╡ 2000Q рдХрд╛ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЙрдкрдпреЛрдЧ: рдХреНрд╡рд╛рдВрдЯрдо рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдордЬрдмреВрдд рд╕реАрдЦрдиреЗ рдХреА рдЕрд╡рд╕реНрдерд╛</a></li>
<li><a href="../hi446506/index.html">рд╣рдорд╛рд░реЗ рдмрд╛рджрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдкрд▓рд╛рдпрди рдХрд░рддреЗ рд╕рдордп рдЦреБрджрд░рд╛ рдХреЗ рд▓рд┐рдП рдкрд╛рдВрдЪ рдкреНрд░рдореБрдЦ рдкреНрд░рд╢реНрди</a></li>
<li><a href="../hi446508/index.html">.NET рдХреЛрд░ рд╡рд░реНрдХрд░реНрд╕ рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд┐рд╕реЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ</a></li>
<li><a href="../hi446512/index.html">.NET рдХреЛрд░ рд╡рд░реНрдХрд░реНрд╕ рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд┐рд╕реЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ</a></li>
<li><a href="../hi446514/index.html">рдЬреАрдореЗрд▓ 15 рд╕рд╛рд▓ рдкреБрд░рд╛рдирд╛ рд╣реИ</a></li>
<li><a href="../hi446518/index.html">рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдлрд╝рд╛рдпрд░рд╡реЙрд▓</a></li>
<li><a href="../hi446522/index.html">рд╕реНрд╡рд┐рдлреНрдЯ 5.1 - рдирдпрд╛ рдХреНрдпрд╛ рд╣реИ?</a></li>
<li><a href="../hi446532/index.html">Upwork рд╕рдВрднрд╛рд╡рд┐рдд рдЧреНрд░рд╛рд╣рдХ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреЗ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╢реБрд▓реНрдХ рдХрд╛ рдкрд░рд┐рдЪрдп рджреЗрддрд╛ рд╣реИ</a></li>
<li><a href="../hi446534/index.html">рд╡рд┐рдЬреБрдЕрд▓ рд╕реНрдЯреВрдбрд┐рдпреЛ 2019 рдХрд╛ рд╡рд┐рдореЛрдЪрди</a></li>
<li><a href="../hi446536/index.html">рдХрддрд╛рд░ рдФрд░ рдЬреЗрдореАрдЯрд░: рдкреНрд░рдХрд╛рд╢рдХ рдФрд░ рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдмрд░ рдХреЗ рд╕рд╛рде рдПрдХреНрд╕рдЪреЗрдВрдЬ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>