<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙎🏿 👩🏻‍🔬 🍋 Jalankan uji UI lintas-browser dengan Mentimun dan Selenoid di Gitlab CI dengan laporan Allure 🐴 🤭 🤮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mentimun adalah infrastruktur pengujian yang membantu menjembatani kesenjangan antara pengembang perangkat lunak dan manajer bisnis. Tes ditulis dalam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jalankan uji UI lintas-browser dengan Mentimun dan Selenoid di Gitlab CI dengan laporan Allure</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480940/"><p>  <a href="https://cucumber.io/" rel="nofollow">Mentimun</a> adalah infrastruktur pengujian yang membantu menjembatani kesenjangan antara pengembang perangkat lunak dan manajer bisnis.  Tes ditulis dalam bahasa pengembangan perilaku sederhana (BDD) dalam gaya Diberikan, Kapan, Lalu (kondisi, operasi, hasil), yang dapat dimengerti oleh pengguna mana pun.  Tes kontrol kemudian ditulis ke file fungsi yang menjangkau satu atau lebih skrip pengujian.  Mentimun menginterpretasikan tes dalam bahasa pemrograman yang ditentukan dan menggunakan Selenium untuk mengelola tes di browser. </p><br><p>  <a href="https://github.com/aerokube/selenoid" rel="nofollow">Selenoid</a> adalah solusi Selenium Server alternatif, meskipun intinya sama - organisasi driver. </p><br><p>  Posting ini akan meluncurkan tes browser sederhana menggunakan Mentimun dan Selenoid di Gitlab CI dengan laporan Allure di akhir. </p><a name="habracut"></a><br><h3 id="podgotovka">  Persiapan </h3><br><p>  Docker harus diinstal dan dijalankan pada sistem operasi Anda. </p><br><h3 id="ustanovka-selenoid">  Instal Selenoid </h3><br><p>  Jika Anda memiliki sistem operasi berbasis Redhat, Anda dapat menggunakan repositori saya untuk menginstal <a href="https://github.com/aerokube/cm" rel="nofollow">manajer Konfigurasi</a> . </p><br><pre><code class="bash hljs">yum -y install yum-plugin-copr yum copr <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> antonpatsev/aerokube-cm-rpm yum -y install aerokube-cm</code> </pre> <br><p>  Jika Anda tidak memiliki sistem operasi berbasis Redhat, maka Anda dapat <a href="https://github.com/aerokube/cm/releases" rel="nofollow">mengunduh</a> dan menggunakan biner <a href="https://github.com/aerokube/cm" rel="nofollow">manajer Konfigurasi</a> . </p><br><h3 id="zapusk-selenoid-ispolzuya-configuration-manager-i-formirovanie-browsersjson">  Menjalankan Selenoid menggunakan Configuration manager dan building browsers.json </h3><br><p>  Jika Anda tidak memiliki akses langsung ke Internet dan gambar buruh pelabuhan yang Anda unduh melalui registri. </p><br><pre> <code class="bash hljs">aerokube-cm selenoid start --force --browsers <span class="hljs-string"><span class="hljs-string">"firefox:70.0;firefox:71.0;chrome:78.0;chrome:79.0"</span></span> --registry -docker-registry</code> </pre> <br><p>  Jika Anda memiliki akses langsung ke Internet. </p><br><pre> <code class="bash hljs">aerokube-cm selenoid start --force --browsers <span class="hljs-string"><span class="hljs-string">"firefox:70.0;firefox:71.0;chrome:78.0;chrome:79.0"</span></span></code> </pre> <br><p>  <code>--force</code> menimpa file browsers.json. </p><br><p>  File browsers.json yang dihasilkan untuk menguji Chrome dan Firefox.  Perhatikan bahwa jalur berbeda untuk Chrome dan Firefox. </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"chrome"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"79.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"versions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"78.0"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"docker-registry/selenoid/chrome:78.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"port"</span></span>: <span class="hljs-string"><span class="hljs-string">"4444"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"/"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"79.0"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"docker-registry/selenoid/chrome:79.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"port"</span></span>: <span class="hljs-string"><span class="hljs-string">"4444"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"/"</span></span> } } }, <span class="hljs-attr"><span class="hljs-attr">"firefox"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"71.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"versions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"70.0"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"docker-registry/selenoid/firefox:70.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"port"</span></span>: <span class="hljs-string"><span class="hljs-string">"4444"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"/wd/hub"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"71.0"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"docker-registry/selenoid/firefox:71.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"port"</span></span>: <span class="hljs-string"><span class="hljs-string">"4444"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"/wd/hub"</span></span> } } } }</code> </pre> <br><h3 id="izmenenie-browsersjson">  Mengubah browsers.json </h3><br><p>  Saat mengubah versi peramban, Anda dapat mengubah file browser.json dan memuat ulang selenoid. </p><br><p>  Tetapi jika Anda menggunakan <code>--force</code> , maka browsers.json akan menimpa dengan versi browser yang lebih baru. </p><br><p>  Pastikan wadah buruh pelabuhan sudah mulai dan gambar sudah diunduh. </p><br><pre> <code class="bash hljs">docker ps docker images</code> </pre> <br><p><img src="https://habrastorage.org/webt/ti/bz/nh/tibznhc23bodj4jxrx1to95znbo.png"></p><br><h3 id="zapusk-selenoid-ui-ispolzuya-configuration-manager">  Menjalankan UI Selenoid menggunakan Manajer konfigurasi </h3><br><pre> <code class="bash hljs">aerokube-cm selenoid-ui start --registry https://docker-registry</code> </pre> <br><p>  Atau </p><br><pre> <code class="bash hljs">aerokube-cm selenoid-ui start</code> </pre> <br><p>  Pastikan wadah buruh pelabuhan sudah mulai dan gambar sudah diunduh. </p><br><pre> <code class="bash hljs">docker ps docker images</code> </pre> <br><p><img src="https://habrastorage.org/webt/mv/c9/g7/mvc9g78xgxhyy45cf3xxahdsy3i.png"></p><br><p>  Pergi ke selenoid-ui di ip-where-you-ran-selenoid-and-selenoid-ui: 8080 </p><br><p>  Anda harus memiliki 2 lampu TERHUBUNG hijau dan ditulis dalam firefox dan chrome. </p><br><p><img src="https://habrastorage.org/webt/-k/fi/dj/-kfidjzsisil5mdy8migutx-xro.png"></p><br><p>  Dalam kemampuan kami melihat browser yang tersedia. </p><br><p><img src="https://habrastorage.org/webt/ed/re/bp/edrebpyonygfiokgctqgy0catak.png"></p><br><p>  Tes demo </p><br><p>  Unduh <a href="https://github.com/andewBr/cucumber_selenium_test" rel="nofollow">https://github.com/andewBr/cucumber_selenium_test</a> </p><br><p><img src="https://habrastorage.org/webt/i-/6v/3_/i-6v3_qo-z7gaxzdx5t_nsdxyrm.png"></p><br><p>  atau ke alamat lain tempat Anda memulai selenoid. </p><br><p>  Dalam file WebdriverBeanConfig.java, tambahkan Kemampuan untuk menjalankan chrome.  Jika Anda menggunakan server proxy, tambahkan baris tentang proxy seperti pada tangkapan layar. </p><br><p><img src="https://habrastorage.org/webt/zw/vs/em/zwvsemk7jsrrxobacuqzg5hzvfu.png"></p><br><p>  Di setiap file java, Anda dapat mengaktifkan atau menonaktifkan rekaman video, melihat jarak jauh atau manajemen melalui VNC, dan masuk ke file.  Untuk menonaktifkan opsi, Anda perlu menambahkan 2 garis miring di awal baris. </p><br><p><img src="https://habrastorage.org/webt/ji/wx/mh/jiwxmhj3ezvbcf8eh-vlha3gpg4.png"></p><br><br><h3 id="zapusk-testov">  Menjalankan tes </h3><br><p>  Di direktori demo-test, jalankan tes: </p><br><p>  Jika Anda perlu menentukan pengaturan dan Anda menggunakan proxy pakar (Nexus, Artifactory) </p><br><pre> <code class="bash hljs">mvn -s settings.xml clean <span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre> <br><p>  Jika kita jalankan dengan akses langsung ke Internet dan tanpa pengaturan apa pun </p><br><pre> <code class="bash hljs">mvn clean <span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre> <br><h3 id="skorost">  Kecepatan </h3><br><p>  Total waktu yang dibutuhkan untuk memulai 1 tes membutuhkan waktu kurang dari 1 menit. </p><br><h3 id="zapusk-testov-v-gitlab-ci">  Menjalankan tes di Gitlab CI </h3><br><p>  Agar tidak memulai Selenoid dan Selenoid-UI setiap kali Anda menjalankan tes, Anda dapat menjalankan Selenoid dan Selenoid-UI satu kali ketika Anda memulai Gitlab Runner menggunakan Ansible, Wayang, Koki, atau alat lainnya. </p><br><p>  Final .gitlab-ci.yml </p><br><pre> <code class="plaintext hljs">--- variables: MAVEN_OPTS: "-Dhttps.protocols=TLSv1.2 -Dmaven.repo.local=/home/gitlab-runner/.m2/repository -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=WARN -Dorg.slf4j.simpleLogger.showDateTime=true -Djava.awt.headless=true" MAVEN_CLI_OPTS: "--batch-mode --errors --fail-at-end --show-version -DinstallAtEnd=true -DdeployAtEnd=true" before_script: - export PATH="/opt/rh/rh-maven33/root/usr/bin:$PATH" build: stage: build script: - aerokube-cm selenoid start --force --browsers "firefox:70;firefox:71;chrome:78;chrome:79" --registry docker-registry - aerokube-cm selenoid-ui start --registry docker-registry - cat ~/.aerokube/selenoid/browsers.json - set +e - mvn -s maven_settings.xml clean install -Dmaven.test.skip=true - mvn -s maven_settings.xml clean test || EXIT_CODE=$? - mvn -s maven_settings.xml allure:aggregate; - export PATH_WITHOUT_HOME=$(pwd | sed -e "s/\/home\/gitlab-runner\/builds//g") - echo '***********************************************************************' - echo "http://$HOSTNAME:9090$PATH_WITHOUT_HOME/target/site/allure-maven-plugin/" - echo '***********************************************************************' - set -e - exit ${EXIT_CODE}</code> </pre><br><p>  Setelah baris <code>echo "http://$HOSTNAME:9090$PATH_WITHOUT_HOME/target/site/allure-maven-plugin/"</code> </p><br><p>  Sebuah URL muncul di mana Anda dapat melihat laporan Allure. </p><br><p>  Untuk menampilkan laporan Allure, Anda harus menginstal nginx di gitlab runner dengan konfigurasi ini: </p><br><pre> <code class="plaintext hljs">server { listen 9090; listen [::]:9090; server_name _; root /home/gitlab-runner/builds; location / { autoindex on; } error_page 404 /404.html; location = /40x.html { } error_page 500 502 503 504 /50x.html; location = /50x.html { } }</code> </pre> <br><p>  Cuplikan layar Laporan Allure </p><br><p><img src="https://habrastorage.org/webt/1a/nk/-v/1ank-vhxpxd1fc2mkoykry6f8ja.png"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id480940/">https://habr.com/ru/post/id480940/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id480926/index.html">Teori Probabilitas untuk Rendering yang Akurat Secara Fisik</a></li>
<li><a href="../id480928/index.html">Apache Hadoop Code Quality: uji VS produksi</a></li>
<li><a href="../id480930/index.html">Ketikkan semuanya</a></li>
<li><a href="../id480936/index.html">IntelliJ IDEA konversi cepat UPPER_CASE ke camelCase</a></li>
<li><a href="../id480938/index.html">Cryptocurrency melalui mata para hakim Rusia</a></li>
<li><a href="../id480944/index.html">5 Tren Teratas dalam Pemasaran Email pada tahun 2020</a></li>
<li><a href="../id480946/index.html">Log di Kubernetes (dan tidak hanya) hari ini: harapan dan kenyataan</a></li>
<li><a href="../id480948/index.html">Pemasaran mitap dan PR di Ivanovo</a></li>
<li><a href="../id480950/index.html">Analisis kuis Android dari stand hh.ru di Mobius 2019 Moscow</a></li>
<li><a href="../id480954/index.html">Tugas nomor 1. Cari tahu jenis kelamin dan tingkat hubungan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>