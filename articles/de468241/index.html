<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçõ üßñüèΩ üîÅ TR-069 bei Mikrotik. Testen von Freeacs als Autokonfigurationsserver f√ºr RouterOS ü§® üßöüèª ü§¥üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werde ich versuchen, den Prozess der Installation des Testservers eines hervorragenden Freeacs- Projekts in einem voll funktionsf√§hi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TR-069 bei Mikrotik. Testen von Freeacs als Autokonfigurationsserver f√ºr RouterOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468241/">  In diesem Artikel werde ich versuchen, den Prozess der Installation des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Testservers</a> eines hervorragenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Freeacs-</a> Projekts in einem voll funktionsf√§higen Zustand Schritt f√ºr Schritt zu beschreiben und praktische Techniken f√ºr die Arbeit mit Mikrotik aufzuzeigen: Konfiguration durch Parameter, Skriptausf√ºhrung, Aktualisierung, Installation zus√§tzlicher Module usw. <br><br>  Der Zweck des Artikels ist es, Kollegen zu ermutigen, die Verwaltung von Netzwerkger√§ten mit schrecklichen Rechen und Kr√ºcken in Form von selbstgeschriebenen Skripten, Dude, Ansible usw. aufzugeben. In dieser Hinsicht verursachen sie Feuerwerk und massive Freude auf den Pl√§tzen. <br><a name="habracut"></a><br><h4>  0. Wahl </h4><br>  Warum sind Freeacs, nicht Genie-ACs, die im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mikrotik-Wiki erw√§hnt werden</a> , lebhafter? <br>  Denn laut Genie-ACs mit Mikrotik gibt es Ver√∂ffentlichungen der Spanier.  Hier sind ihr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PDF</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Video</a> von der letztj√§hrigen MUM.  Auto Caravans auf Folien sind cool, aber ich m√∂chte mich vom Konzept des Schreibens von Skripten, des Ausf√ºhrens von Skripten, des Ausf√ºhrens von Skripten entfernen ... <br><br><h4>  1. Installieren Sie Freeacs </h4><br>  Wir werden es in Centos7 installieren, und da die Ger√§te viele Daten √ºbertragen und ACS aktiv mit der Datenbank arbeitet, werden wir nicht mit Ressourcen gierig sein.  F√ºr komfortables Arbeiten weisen wir 2 CPU-Kerne, 4 GB RAM und 16 GB ssd raid10-Schnellspeicher zu.  Ich werde Freeacs im Proxmox VE lxc-Container installieren, und Sie k√∂nnen mit jedem f√ºr Sie geeigneten Tool arbeiten. <br>  Denken Sie daran, mit ACS die richtige Zeit am Ger√§t einzustellen. <br><br>  Das System wird ein Testsystem sein, daher werden wir nicht schlau sein und nur das freundlicherweise bereitgestellte Installationsskript verwenden, wie es ist. <br><br><pre><code class="bash hljs">wget https://raw.githubusercontent.com/freeacs/freeacs/master/scripts/install_centos.sh chmod +x install_centos.sh ./ install_centos.sh</code> </pre> <br>  Sobald das Skript abgeschlossen ist, k√∂nnen Sie sofort mit den Anmeldeinformationen admin / freeacs zur Weboberfl√§che auf dem IP-Computer gelangen <br><br><img src="https://habrastorage.org/webt/uf/w0/xn/ufw0xnstxoxejymip04wkk17sca.png"><br>  <i>Hier ist eine so sch√∂ne minimalistische Oberfl√§che, und wie cool und schnell sich alles herausstellte</i> <br><br><h4>  2. Ersteinrichtung der Freeacs </h4><br>  Die Basissteuereinheit f√ºr ACS ist eine Einheit oder CPE (Customer Premises Equipment).  Und am wichtigsten ist, dass wir zur Verwaltung von Einheiten ihren Einheitentyp ben√∂tigen, d. H.  Ger√§temodell, das eine Reihe anpassbarer Ger√§teparameter und deren Software definiert.  Obwohl wir nicht wissen, wie Sie den neuen Einheitentyp erhalten, fragen Sie am besten die Einheit selbst, indem Sie den Erkennungsmodus aktivieren. <br><br>  In der Produktion ist dieser Modus absolut unm√∂glich zu verwenden, aber wir m√ºssen den Motor bald starten und die F√§higkeiten des Systems erkennen.  Alle Grundeinstellungen werden in / opt / freeacs- * gespeichert.  √ñffnen Sie daher <br><br><pre> <code class="bash hljs"> vi /opt/freeacs-tr069/config/application-config.conf</code> </pre> <br>  wir finden <br><br><pre> <code class="bash hljs">discovery.mode = <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  und wechseln zu <br><br><pre> <code class="bash hljs">discovery.mode = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Dar√ºber hinaus m√∂chten wir die maximale Dateigr√∂√üe erh√∂hen, mit der Nginx und MySQL arbeiten.  F√ºgen Sie f√ºr MySQL die Zeile zu /etc/my.cnf hinzu <br><br><pre> <code class="bash hljs">max_allowed_packet=32M</code> </pre> <br>  und f√ºr nginx in /etc/nginx/nginx.conf hinzuf√ºgen <br><br><pre> <code class="bash hljs">client_max_body_size 32m;</code> </pre> <br>  zum http Abschnitt.  Ansonsten k√∂nnen wir mit Firmware nicht mehr als 1M arbeiten. <br><br>  Wir starten neu und sind bereit, mit Ger√§ten zu arbeiten. <br><br>  Und in der Rolle des Ger√§ts (CPE) werden wir das <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hAP</a></b> kid <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ACAP lite haben</a></b> . <br><br>  Vor der Testverbindung ist es ratsam, das CPE manuell auf die minimale Arbeitskonfiguration zu konfigurieren, damit die Parameter, die Sie in Zukunft konfigurieren m√∂chten, nicht leer sind.  F√ºr den Router k√∂nnen Sie den DHCP-Client auf ether1 minimal aktivieren, das Paket tr-069client installieren und Kennw√∂rter festlegen. <br><br><h4>  3. Wir verbinden Mikrotik </h4><br>  Es wird empfohlen, alle Ger√§te mit einer g√ºltigen Seriennummer als Login zu verbinden.  Dann wird Ihnen in den Protokollen alles klar sein.  Jemand r√§t, WAN MAC zu verwenden - glauben Sie nicht.  Jemand verwendet ein gemeinsames Login / Pass-Paar f√ºr alle - umgehen Sie sie. <br><br>  Wir √∂ffnen das tr-069-Protokoll zur √úberwachung von ‚ÄûVerhandlungen‚Äú. <br><br><pre> <code class="bash hljs">tail -f /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/freeacs-tr069/tr069-conversation.log</code> </pre> <br>  √ñffnen Sie die Winbox, Men√ºpunkt TR-069. <br>  ACS-URL: <code>http://10.110.0.109/tr069/prov</code> (durch Ihre IP ersetzen) <br>  Benutzername: 9249094C26CB (kopieren Sie die Seriennummer von System&gt; Routerboard) <br>  Passwort: 123456 (nicht f√ºr die Entdeckung ben√∂tigt, aber zu sein) <br>  Periodisches Informationsintervall √§ndern wir nicht.  Wir werden diese Einstellung √ºber unser ACS herausgeben <br><br>  Nachfolgend sind die Einstellungen f√ºr die Initialisierung der Remoteverbindung aufgef√ºhrt. Ich konnte jedoch nicht mit mikrotik zusammenarbeiten, um dies zu erreichen.  Obwohl die Fernanforderung mit sofort einsatzbereiten Telefonen funktioniert.  Es wird notwendig sein zu verstehen. <br><br><img src="https://habrastorage.org/webt/xo/xp/sx/xoxpsxqyjlnpjcuph3xhjjanrpc.png"><br><br>  Nachdem Sie auf die Schaltfl√§che √úbernehmen geklickt haben, werden die Daten im Terminal ausgetauscht. In der Freeacs-Weboberfl√§che sehen Sie unseren Router mit dem automatisch erstellten Einheitentyp ‚ÄûhAPaclite‚Äú. <br><br><img src="https://habrastorage.org/webt/ov/sc/nu/ovscnujrn-t5deekdeqgbpl-y6e.png"><br><br>  Der Router ist angeschlossen.  Sie k√∂nnen sich den automatisch erstellten Einheitentyp ansehen.  √ñffnen Sie <code>Easy Provisioning &gt; Unit Type &gt; Unit Type Overview &gt; hAPaclite</code> .  Was gibt es nicht nur!  Bis zu 928 Parameter (ich habe in der Shell ausspioniert).  Ob es viel oder wenig ist, wir werden es sp√§ter herausfinden, aber im Moment nur einen kurzen Blick darauf.  Dies ist, was Einheitentyp bedeutet.  Dies ist eine Liste der unterst√ºtzten Parameter mit Schl√ºsseln, aber ohne Werte.  Die Werte werden in den folgenden Ebenen festgelegt - Profile und Einheiten. <br><br><h4>  4. Konfigurieren Sie Mikrotik </h4><br>  Es ist Zeit, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Webinterface-</a> Leitfaden herunterzuladen. Dieser Leitfaden f√ºr 2011 ist wie eine Flasche guten, gereiften Weins.  √ñffnen wir es und lassen wir atmen. <br><br>  Und wir selbst klicken in der Weboberfl√§che auf den Stift neben unserem Ger√§t und wechseln in den Ger√§tekonfigurationsmodus.  Es sieht so aus: <br><br><img src="https://habrastorage.org/webt/it/3l/tf/it3ltfcesvywjovfuqgurxoj_co.png"><br><br>  Untersuchen Sie kurz, was auf dieser Seite interessant ist: <br><br>  <i>Ger√§tekonfigurationsblock</i> <br><br><ul><li>  Profil: Dies ist das Profil innerhalb des Einheitentyps.  Die Hierarchie lautet wie <code>UnitType &gt; Profile &gt; Unit</code> : <code>UnitType &gt; Profile &gt; Unit</code> .  Das hei√üt, wir k√∂nnen zum Beispiel Profile <code>hAPaclite &gt; hotspot</code> und <code>hAPaclite &gt; branch</code> , jedoch innerhalb des Ger√§temodells </li></ul><br>  <i>Tastenbereitstellung</i> <br>  Die Hinweise weisen darauf hin, dass alle Schaltfl√§chen im Bereitstellungsblock die Konfiguration sofort √ºber ConnectionRequestURL anwenden k√∂nnen.  Wie oben erw√§hnt, funktioniert dies jedoch nicht. Nach dem Klicken auf die Schaltfl√§chen m√ºssen Sie den tr-069-Client auf mikrotik neu starten, um die Bereitstellung manuell zu starten. <br><br><ul><li>  Freq / Spread: Wie oft pro Woche ¬±% Konfiguration bereitgestellt werden muss, um die Belastung des Servers und der Kommunikationskan√§le zu verringern.  Standardm√§√üig kostet es 7/20, d.h.  jeden Tag ¬± 20% und ein Hinweis wie dieser in Sekunden.  W√§hrend es keinen Sinn macht, die H√§ufigkeit der Lieferung zu √§ndern, tk.  Es gibt √ºberm√§√üiges Rauschen in den Protokollen und nicht immer die erwartete Anwendung der Einstellungen </li></ul><br>  <i>Blockbereitstellungsverlauf</i> (letzte 48 Stunden) <br><br><ul><li>  Es sieht aus wie eine Geschichte, wie eine Geschichte, aber wenn Sie auf den Titel klicken, gelangen Sie in ein praktisches Datenbanksuchwerkzeug mit regul√§ren Ausdr√ºcken und Br√∂tchen </li></ul><br>  <i>Parameter blockieren</i> <br><br>  Der gr√∂√üte und wichtigste Block, in dem tats√§chlich die Parameter f√ºr dieses Ger√§t eingestellt und gelesen werden.  Jetzt sehen wir nur die wichtigsten Systemparameter, ohne die ACS nicht mit dem Ger√§t arbeiten kann.  Aber wir erinnern uns, dass wir <i>928</i> in Unit Type haben.  Schauen wir uns alle Werte an und entscheiden, was alles mit Mikrotik isst. <br><br><h4>  4.1 Lesen Sie die Parameter </h4><br>  Klicken Sie im Block Bereitstellung auf die Schaltfl√§che Alle lesen.  Im Block - eine rote Inschrift.  Die Spalte <i>CPE (aktueller Wert) wird</i> rechts angezeigt.  In den Systemeinstellungen wurde ProvisioningMode in READALL ge√§ndert. <br><br><img src="https://habrastorage.org/webt/eu/tg/no/eutgnogavgnitu8wwhvtb7w4qcw.png"><br><br>  Und ... nichts passiert au√üer der Meldung in System.X_FREEACS-COM.IM.Message <code>Kick failed at...</code> <br><br>  Starten Sie den TR-069-Client neu oder starten Sie den Router neu und aktualisieren Sie die Browserseite weiter, bis Sie die Parameter in den fr√∂hlichen grauen Rechtecken rechts erhalten <br>  Wenn jemand einen Schluck von dem alten Gew√ºrz nehmen m√∂chte, wird dieser Modus im Handbuch als 10.2 Inspektionsmodus beschrieben.  Es schaltet sich ein und funktioniert ein wenig falsch, aber die Essenz ist ziemlich beschrieben <br><br><img src="https://habrastorage.org/webt/em/ut/g1/emutg1mnfctnq7vh5uoqr48wwiu.png"><br><br>  Der READALL-Modus selbst wird nach 15 Minuten ausgeschaltet und wir werden versuchen herauszufinden, was n√ºtzlich ist und was ‚Äûon the fly‚Äú korrigiert werden kann, w√§hrend wir uns in diesem Modus befinden. <br><br>  Sie k√∂nnen IP-Adressen √§ndern, Schnittstellen aktivieren / deaktivieren, Firewall-Regeln, die Kommentare enthalten (ansonsten ein komplettes Durcheinander), Wi-Fi usw. Kleinigkeiten. <br><br>  Das hei√üt, es ist noch nicht m√∂glich, mikrotik sane nur mit TR-069 zu konfigurieren.  Aber Sie k√∂nnen sehr gut √ºberwachen.  Verf√ºgbare Statistiken zu Schnittstellen und deren Status, freiem Speicher usw. <br><br><h4>  4.2 Lieferparameter </h4><br>  Versuchen wir nun, die Parameter auf "nat√ºrliche" Weise √ºber tr-069 an den Router zu senden.  Das erste Opfer ist Device.DeviceInfo.X_MIKROTIK_SystemIdentity.  Wir finden es in den Einheitsparametern Alle.  Anscheinend - es ist nicht eingestellt.  Dies bedeutet, dass jede Einheit selbst eine Identit√§t haben kann.  H√∂r auf! <br>  Setzen Sie eine Morgend√§mmerung in die Spalte "Erstellen", setzen Sie den Namen "Mr.White" und klicken Sie auf die Schaltfl√§che "Parameter aktualisieren".  Was als n√§chstes passieren wird, haben Sie bereits erraten.  Bei der n√§chsten Kommunikationssitzung mit der Zentrale muss der Router seine Identit√§t √§ndern. <br><br><img src="https://habrastorage.org/webt/yn/an/e8/ynane8pm3vt76wuvhwtfoqtxvis.png"><br><br>  Das reicht uns aber nicht.  Ein Parameter wie Identit√§t ist gut zur Hand, wenn Sie nach der gew√ºnschten Einheit suchen.  Wir geben den Parameternamen ein und setzen dort die D√§mmerung Display (D) und Searchable (S).  Der Parameterschl√ºssel √§ndert sich in RWSD (Denken Sie daran, dass Namen und Schl√ºssel auf der h√∂chsten Ebene des Einheitentyps festgelegt sind.) <br><br><img src="https://habrastorage.org/webt/40/yf/zg/40yfzgpolinlrvj6aqq0zxlw0js.png"><br><br>  Der Wert wird jetzt nicht nur in der allgemeinen Suchliste angezeigt, sondern steht auch f√ºr die Suche unter <code>Support &gt; Search &gt; Advanced form</code> <br><br><img src="https://habrastorage.org/webt/sd/p_/1g/sdp_1gntzb5ly1wnzrd0uvwbrza.png"><br><br>  Wir initiieren die Bereitstellung und betrachten die Identit√§t.  Hallo Mr.White!  Jetzt k√∂nnen Sie Ihre Identit√§t nicht mehr √§ndern, w√§hrend tr-069client ausgef√ºhrt wird <br><br><img src="https://habrastorage.org/webt/by/oc/j4/byocj4kosk_jiekvn8jgkuzi-y0.png"><br><br><h4>  4.3 Wir f√ºhren Skripte aus </h4><br>  Da wir herausgefunden haben, dass es ohne sie keinen Weg gibt, f√ºhren wir sie aus. <br><br>  Bevor wir jedoch mit Dateien arbeiten, m√ºssen wir die Direktive <code>public.url</code> in der Datei <code>/opt/freeacs-tr069/config/application-config.conf</code> <br>  Immerhin haben wir immer noch eine Testkonfiguration, die von einem Skript installiert wird.  Nicht vergessen? <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># --- Public url (used for download f. ex.) --- public.url = "http://10.110.0.109" public.url: ${?PUBLIC_URL}</span></span></code> </pre> <br><br>  Starten Sie ACS neu und gehen Sie direkt zu <code>Files &amp; Scripts</code> . <br><br><img src="https://habrastorage.org/webt/cb/ah/wk/cbahwkm8ckqb0r0gg3q2xsaiumi.png"><br><br>  Aber was wir jetzt √∂ffnen, geh√∂rt zum Einheitentyp, d. H.  global f√ºr alle hAP ac lite router, egal ob es sich um einen branch router, hotspot oder capsman handelt.  Wir brauchen noch kein so hohes Niveau, daher sollten Sie vor der Arbeit mit Skripten und Dateien ein Profil erstellen.  Sie k√∂nnen es selbst als "Position" des Ger√§ts bezeichnen. <br><br>  Machen wir unser Baby zu einem Zeitserver.  Ordentlicher Beitrag mit einem separaten Softwarepaket und einer kleinen Anzahl von Parametern.  Gehen Sie zu <code>Easy Provisioning &gt; Profile &gt; Create Profile</code> erstellen und erstellen Sie ein Zeitserverprofil unter Einheitentyp: <i>hAPaclite</i> .  Wir hatten keine Parameter im Standardprofil, daher gibt es nichts zu <i>kopieren. Kopieren Sie die Parameter von: "Nicht kopieren ..."</i> <br><br><img src="https://habrastorage.org/webt/vf/9y/nc/vf9yncecit2scfc9pezngwg9sz0.png"><br><br>  Es gibt noch keine Parameter, aber es wird m√∂glich sein, diejenigen festzulegen, die wir sp√§ter auf unseren Zeitservern sehen m√∂chten, die aus hAPaclite zusammengeschustert wurden.  Zum Beispiel die allgemeinen Adressen von NTP-Servern. <br>  Wechseln wir in die Ger√§tekonfiguration und in das Zeitserverprofil <br><br>  Schlie√ülich gehen wir zu <code>Files &amp; Scripts</code> , erstellen Skripte und warten hier auf erstaunlich praktische Br√∂tchen. <br><br>  Um das Skript auf dem Ger√§t auszuf√ºhren, m√ºssen Sie <i>Typ</i> ausw√§hlen <i>: TR069_SCRIPT</i> und <i>Name</i> und <i>Zielname</i> m√ºssen die Erweiterung .alter haben <br>  Gleichzeitig k√∂nnen Sie bei Skripten im Gegensatz zu Software entweder die fertige Datei laden oder sie einfach in das Feld <i>Inhalt</i> schreiben / bearbeiten <i>.</i>  Versuchen wir gleich dort zu schreiben. <br><br>  Und um das Ergebnis sofort zu sehen, f√ºgen Sie ether1 einen vlan-Router hinzu <br><br><pre> <code class="bash hljs">/interface vlan add interface=ether1 name=vlan1 vlan-id=1</code> </pre> <br><img src="https://habrastorage.org/webt/jr/lh/7s/jrlh7sk9y_benjwmujnnv1ypk_u.png"><br><br>  Fahren Sie hinein, klicken Sie auf <i>Hochladen</i> und Sie sind fertig.  Unser Skript <code>vlan1.alter</code> wartet in den <code>vlan1.alter</code> . <br><br>  Na, ist es gefahren?  Nein.  Wir m√ºssen unserem Profil auch eine Gruppe hinzuf√ºgen.  Gruppen sind nicht in der Ger√§tehierarchie enthalten, werden jedoch f√ºr die Suche nach Einheiten in UnitType oder Profile ben√∂tigt und m√ºssen Skripts √ºber Advanced Provisioning ausf√ºhren.  Normalerweise sind Gruppen Standorten zugeordnet und haben eine verschachtelte Struktur.  Machen wir eine Gruppe Russland. <br><br><img src="https://habrastorage.org/webt/mz/73/bj/mz73bjayacypyy98f3thi1oe8ng.png"><br><br>  Stellen Sie sich vor, wir konnten die Suche von "Alle Zeitserver der Welt auf hAPaclite" auf "Alle Zeitserver Russlands auf hAPaclite" eingrenzen.  Es gibt immer noch eine riesige Schicht von allem, was mit Gruppen interessant ist, aber wir haben keine Zeit.  Bereits in Skripte gefahren. <br><br><pre> <code class="plaintext hljs">Advanced Provisioning &gt; Job &gt; Create Job</code> </pre> <br><img src="https://habrastorage.org/webt/si/yh/b4/siyhb4rjztp3yyqi__zgetxhigi.png"><br><br>  Da wir uns schlie√ülich im erweiterten Modus befinden, k√∂nnen Sie hier eine Reihe verschiedener Bedingungen f√ºr das Starten des Jobs, Fehlerverhalten, Wiederholungsversuche und Zeit√ºberschreitungen angeben.  Ich empfehle, alles in Handb√ºchern zu lesen oder sp√§ter bei der Implementierung in der Produktion zu diskutieren.  Geben Sie vorerst einfach n1 in die Stoppregeln ein, damit die Aufgabe beendet wird, sobald sie auf unserer Einheit 1 abgeschlossen ist. <br><br>  Wir f√ºllen das Notwendige aus und es bleibt nur noch zu rennen! <br><br><img src="https://habrastorage.org/webt/xn/mw/3m/xnmw3mthgxsoyrj1jv7widfjfai.png"><br><br>  Dr√ºcken Sie START und warten Sie.  Jetzt l√§uft der Z√§hler der Ger√§te, die von einem unterentwickelten Skript get√∂tet wurden, z√ºgig!  Nein, nat√ºrlich.  Solche Aufgaben werden f√ºr eine lange Zeit gegeben, und dies ist ihr Unterschied zu Skripten, Ansible und so weiter.  Die Einheiten selbst bewerben sich nach einem Zeitplan oder wenn sie im Netzwerk angezeigt werden. ACS verfolgt, welche Einheiten bereits Aufgaben erhalten haben und wie sie beendet wurden, und schreibt diese in die Parameter der Einheit.  Es gibt 1 Einheit in unserer Gruppe, und wenn es 1001 von ihnen g√§be, w√ºrde der Administrator diese Aufgabe ausf√ºhren und angeln gehen <br><br>  Komm schon.  Starten Sie den Router bereits neu oder starten Sie den TR-069-Client neu.  Alles sollte reibungslos verlaufen und Mr.White wird einen neuen VLAN bekommen.  Und unsere Stop-Regelzuweisung wird in den Status PAUSED versetzt.  Das hei√üt, es kann immer noch neu gestartet oder ge√§ndert werden.  Wenn Sie auf BEENDEN klicken, wird die Aufgabe in das Archiv geschrieben <br><br><h4>  4.4 Software aktualisieren </h4><br>  Dies ist ein sehr wichtiger Punkt, da die Mikrotik-Firmware modular aufgebaut ist, das Hinzuf√ºgen von Modulen jedoch nichts an der allgemeinen Version der Ger√§te-Firmware √§ndert.  Unser ACS ist normal und ich bin nicht daran gew√∂hnt. <br>  Jetzt machen wir es schnell und schmutzig und schieben das NTP-Modul sofort in die allgemeine Firmware. Sobald die Version auf dem Ger√§t aktualisiert ist, k√∂nnen wir jedoch kein weiteres Modul auf die gleiche Weise hinzuf√ºgen. <br>  In der Produktion ist es besser, einen solchen Trick nicht anzuwenden und Module, die f√ºr Unit Type optional sind, nur mit Skripten zu installieren. <br><br>  Das erste, was wir tun m√ºssen, ist, die Softwarepakete der erforderlichen Versionen und Architektur vorzubereiten und auf einem zug√§nglichen Webserver abzulegen.  F√ºr den Test wird jeder gehen, den unser Mr.White erreichen kann, und f√ºr die Produktion ist es besser, einen Spiegel f√ºr die automatische Aktualisierung der erforderlichen Software zusammenzustellen, was nicht unheimlich ist, wenn man ihn ins Internet stellt <br>  Wichtig!  Denken Sie daran, immer ein Paket mit tr-069client in Updates aufzunehmen! <br><br>  Wie sich herausstellte, ist die Pfadl√§nge zu den Paketen sehr wichtig!  Als ich versuchte, so etwas wie <code>http://192.168.0.237/routeros/stable/mipsbe/routeros-mipsbe-6.45.6.npk</code> , geriet mikrotik in eine zyklische Verbindung zur Ressource und gab TRFERCOMPLETE an tr-069 log.  Und ich habe eine gewisse Menge Nervenzellen ausgegeben, um herauszufinden, was los war.  Deshalb, w√§hrend wir die Wurzel setzen, bis zur Kl√§rung <br><br>  Wir sollten also drei npk-Dateien √ºber http verf√ºgbar haben.  Es stellte sich f√ºr mich so heraus <br><br><pre> <code class="bash hljs">http://192.168.0.241/routeros-mipsbe-6.45.6.npk http://192.168.0.241/routeros/stable/mipsbe/ntp-6.45.6-mipsbe.npk http://192.168.0.241/routeros/stable/mipsbe/tr069-client-6.45.6-mipsbe.npk</code> </pre> <br>  Jetzt muss es in der XML-Datei mit FileType = "1 Firmware Upgrade Image" ausgegeben werden, das wir den Mikrotikern zuf√ºhren.  Der Name sei ros.xml <br><br>  Wir folgen den Anweisungen aus dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mikrotik-Wiki</a> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">upgrade</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"links"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">links</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://192.168.0.241/routeros-mipsbe-6.45.6.npk<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://192.168.0.241/ntp-6.45.6-mipsbe.npk<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://192.168.0.241/tr069-client-6.45.6-mipsbe.npk<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">links</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">upgrade</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Das Fehlen von <code>Username/Password</code> f√ºr den Zugriff auf den Download-Server ist auff√§llig.  Sie k√∂nnen entweder versuchen, dies wie in Abschnitt A.3.2.8 des tr-069-Protokolls einzugeben: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://192.168.0.237/routeros/stable/mipsbe/ntp-6.45.6-mipsbe.npk<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span>user<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Password</span></span></span><span class="hljs-tag">&gt;</span></span>pass<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Oder fragen Sie direkt den offiziellen Mikrotik sowie die maximale Pfadl√§nge zu * .npk <br><br>  Wir gehen zu den uns bekannten <code>Files &amp; Scripts</code> und erstellen eine Datei wie SOFTWARE mit dem <b>Namen:</b> ros.xml, dem Zielnamen <b>:</b> ros.xml und der <b>Version:</b> 6.45.6 <br>  Achtung!  Die Version muss hier in dem Format angegeben werden, in dem sie auf dem Ger√§t angezeigt und im Parameter <code>System.X_FREEACS-COM.Device.SoftwareVersion</code> . <br><br>  Wir w√§hlen unsere xm-Datei zum Download aus und Sie sind fertig. <br><br><img src="https://habrastorage.org/webt/th/w7/0-/thw70-pm9bruivrrcogyx1v2vig.png"><br><br>  Jetzt haben wir unz√§hlige M√∂glichkeiten, Ihr Ger√§t zu aktualisieren.  √úber den Assistenten im Hauptmen√º, √ºber Advanced Provisioning und Aufgaben mit dem SOFTWARE-Typ oder gehen Sie einfach in die Ger√§tekonfiguration und klicken Sie auf Upgrade.  Wir w√§hlen den einfachsten Weg, und selbst dann ist der Artikel geschwollen. <br><br><img src="https://habrastorage.org/webt/le/jk/fg/lejkfgwuolymtutzfswkpcnwel0.png"><br><br>  Klicken Sie auf die Schaltfl√§che, starten Sie die Bereitstellung und Sie sind fertig.  Das Testprogramm ist abgeschlossen.  Jetzt k√∂nnen wir mehr mit Mikrotik machen. <br><br><h4>  5. Fazit </h4><br>  Als ich anfing zu schreiben, wollte ich zuerst die Verbindung des IP-Telefons beschreiben und anhand seines Beispiels erkl√§ren, wie cool es sein kann, wenn tr-069 einfach und m√ºhelos funktioniert.  Aber dann, als ich mich weiterentwickelte und die Materialien durchforstete, dachte ich, dass f√ºr denjenigen, der Mikrotik verband, kein Telefon f√ºr ein unabh√§ngiges Studium be√§ngstigend sein w√ºrde. <br><br>  Grunds√§tzlich k√∂nnen die von uns getesteten Freeacs bereits in der Produktion verwendet werden. Dazu m√ºssen Sie jedoch die Sicherheit, SSL, Mikrotik f√ºr die automatische Konfiguration nach dem Zur√ºcksetzen konfigurieren, die korrekte Hinzuf√ºgung des Einheitentyps debuggen, die Arbeit von Webservices und der Fusion-Shell zerlegen und vieles mehr.  Versuchen, erfinden und schreiben Sie eine Fortsetzung! <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit!  Ich freue mich √ºber √Ñnderungsantr√§ge und Kommentare! <br><br>  Liste der verwendeten Materialien und n√ºtzliche Links: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der Forenthread, auf den ich zu Beginn der Suche nach dem Thema gesto√üen bin</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">TR-069 CPE WAN Management Protocol √Ñnderung-6</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Freeacs Wiki</a> <br>  <a href="">Parameter tr-069 in Mikrotik und deren Einhaltung von Terminalbefehlen</a> <br><br>  Update 10.13.2019: <br><br>  Beim Durchsehen der Informationen √ºber das FreeACS-Projekt stie√ü ich auf einen sehr interessanten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Patch,</a> der von polnischen Leuten vorgeschlagen wurde, die FreeACS f√ºr 20.000 Ger√§te haben. <br><br>  Der Patch wurde f√ºr verschiedene Hardwareversionen erstellt. Bei Mikrotik k√∂nnen Sie jedoch mehrere Einheitentypen f√ºr dieselben Router mit unterschiedlichen Softwaremodulen erstellen. <br>  Zum Beispiel hAPaclite-ntp, hAPaclite-ups usw.  Und dementsprechend, um die Einschr√§nkung "ein Modell == eine Firmware" zu umgehen </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468241/">https://habr.com/ru/post/de468241/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468231/index.html">Ist die Sicherheit in AEM ein Plattform- oder Implementierungsproblem?</a></li>
<li><a href="../de468233/index.html">Die M√∂glichkeit, 4 Millionen Zeilen Python-Code zu √ºberpr√ºfen. Teil 1</a></li>
<li><a href="../de468235/index.html">Die M√∂glichkeit, 4 Millionen Zeilen Python-Code zu √ºberpr√ºfen. Teil 2</a></li>
<li><a href="../de468237/index.html">Die M√∂glichkeit, 4 Millionen Zeilen Python-Code zu √ºberpr√ºfen. Teil 3</a></li>
<li><a href="../de468239/index.html">Auswahl der richtigen Datenstruktur in Swift</a></li>
<li><a href="../de468245/index.html">Wir brauchen keine √úbersetzungskorrekturen: Unser √úbersetzer wei√ü besser, wie dies √ºbersetzt werden soll</a></li>
<li><a href="../de468251/index.html">Es gibt keine Zukunft</a></li>
<li><a href="../de468253/index.html">Einfacher Bildschieberegler in CSS und Javascript</a></li>
<li><a href="../de468259/index.html">F√ºnf H√∂hepunkte des Helmgipfels 2019 in Amsterdam</a></li>
<li><a href="../de468261/index.html">Ein neues Spiel mit einer alten Atmosph√§re auf Three.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>