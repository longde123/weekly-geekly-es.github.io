<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚛️ 👨🏻‍🏫 📘 ThinkingHome.Migrator - ترحيل نسخة مخطط قاعدة البيانات على منصة .NET Core 👨‍👨‍👦 👠 🐇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="مرحبًا أصدرت اليوم إصدارًا جديدًا من ThinkingHome.Migrator - وهي أداة للترحيل المحدث لمخطط قاعدة البيانات إلى النظام الأساسي .NET Core. 



 الحزم الم...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ThinkingHome.Migrator - ترحيل نسخة مخطط قاعدة البيانات على منصة .NET Core</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414867/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  مرحبًا  أصدرت اليوم إصدارًا جديدًا من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ThinkingHome.Migrator</a> - وهي أداة للترحيل المحدث لمخطط قاعدة البيانات إلى النظام الأساسي .NET Core. <br><img src="https://habrastorage.org/webt/yi/xf/gf/yixfgf4_v0d3mrkmwa7nqbv2v_m.jpeg"></p><br><p style=";text-align:right;direction:rtl">  الحزم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المنشورة في NuGet</a> ، كتب <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وثائق مفصلة</a> .  يمكنك بالفعل استخدام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الترحيل</a> الجديد ، وسأخبرك كيف ظهر ، ولماذا يحتوي على الإصدار رقم 3.0.0 (على الرغم من أن هذا هو الإصدار الأول) ولماذا هو مطلوب عند وجود <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">EF Migrations</a> و <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">FluentMigrator</a> . </p><a name="habracut"></a><br><h2 id="kak-vsyo-nachinalos" style=";text-align:right;direction:rtl">  كيف بدأ كل شيء </h2><br><p style=";text-align:right;direction:rtl"> منذ 9 سنوات ، في عام 2009 ، عملت كمطور ASP.NET.  عندما أصدرنا مشروعنا ، بقي شخص خاص مستيقظًا حتى وقت متأخر ، وفي نفس الوقت قام بتحديث الملفات الموجودة على الخادم ، قام بتنفيذ نصوص SQL باستخدام يديه لتحديث قواعد البيانات في المنتج.  لقد بحثنا عن أداة تقوم بذلك تلقائيًا ووجدنا مشروع <a href="">Migrator.NET</a> . </p><br><p style=";text-align:right;direction:rtl">  اقترح المهاجر فكرة جديدة في ذلك الوقت - لتعيين تغييرات قاعدة البيانات في شكل عمليات الترحيل.  تحتوي كل عملية ترحيل على جزء صغير من التغييرات ولها رقم إصدار ستنتقل إليه قاعدة البيانات بعد اكتمالها.  تابع المهاجر نفسه النسخ وأجرى الترحيلات اللازمة بالترتيب الضروري.  كان الأمر الرائع بشكل خاص حقيقة أن المهاجر سمح بتعيين تغييرات عكسية لكل عملية ترحيل.  كان من الممكن في بداية الترحيل تعيين إصدار أقل من الإصدار الحالي ، وسوف يقوم تلقائيًا بإعادة قاعدة البيانات إلى هذا الإصدار ، وإجراء عمليات الترحيل اللازمة بالترتيب العكسي. </p><br><pre style=";text-align:right;direction:rtl"><code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">Migration(1)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AddAddressTable</span></span> : <span class="hljs-title"><span class="hljs-title">Migration</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Up</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Database.AddTable(<span class="hljs-string"><span class="hljs-string">"Address"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column(<span class="hljs-string"><span class="hljs-string">"id"</span></span>, DbType.Int32, ColumnProperty.PrimaryKey), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column(<span class="hljs-string"><span class="hljs-string">"street"</span></span>, DbType.String, <span class="hljs-number"><span class="hljs-number">50</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column(<span class="hljs-string"><span class="hljs-string">"city"</span></span>, DbType.String, <span class="hljs-number"><span class="hljs-number">50</span></span>) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Down</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Database.RemoveTable(<span class="hljs-string"><span class="hljs-string">"Address"</span></span>); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  كان هناك الكثير من الأخطاء في ذلك المهاجر.  لم يكن يعرف كيف يعمل مع مخططات قاعدة البيانات بخلاف المخطط الافتراضي.  في بعض الحالات ، قام بإنشاء استعلامات SQL غير صحيحة ، وإذا حددت رقم إصدار غير موجود ، فسيقع في حلقة لا نهائية.  ونتيجة لذلك ، قمت أنا وزملائي بتزوير المشروع وإصلاح الأخطاء هناك. </p><br><p style=";text-align:right;direction:rtl">  لم يكن موقع GitHub.com مع شوكاته وطلبات السحب موجودًا (كان رمز <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الهجرة</a> على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">code.google.com</a> ).  لذلك ، لم نتعب أنفسنا بشكل خاص للتأكد من عودة تغييراتنا إلى المشروع الأصلي - لقد شاهدنا نسختنا واستخدمناها بأنفسنا.  مع مرور الوقت ، أعدنا كتابة معظم المشروع ، وأصبحت المشرف الرئيسي عليه.  ثم قمت بنشر كود مهاجرنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">على كود جوجل</a> وكتبت <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مقالة عن هبر</a> .  لذلك كان هناك ECM7. </p><br><p style=";text-align:right;direction:rtl">  أثناء العمل على المهاجر ، نعيد كتابته بالكامل تقريبًا.  في نفس الوقت ، قاموا بتبسيط API قليلاً وغطوا كل شيء باختبارات تلقائية.  أنا شخصياً استمتعت حقًا باستخدام ما حدث.  على عكس المهاجر الأصلي ، كان هناك شعور بالموثوقية ولم يكن هناك شعور بأن السحر الغريب يحدث. </p><br><p style=";text-align:right;direction:rtl">  كما اتضح ، لم أحب فقط مهاجرنا.  على حد علمي ، تم استخدامه في الشركات الكبيرة إلى حد ما.  أعرف عن ABBYY و BARS Group و concert.ru.  إذا قمت بكتابة استعلام البحث "ecm7 ترحيل" ، يمكنك أن ترى في نتائج النتائج حوله ، الإشارات في السيرة الذاتية ، أوصاف الاستخدام في عمل الطالب.  في بعض الأحيان تلقيت رسائل من الغرباء مع أسئلة أو كلمات الامتنان. </p><br><p style=";text-align:right;direction:rtl">  بعد عام 2012 ، لم يتطور المشروع تقريبًا.  غطت قدراتها الحالية جميع المهام التي كانت لدي ولم أرى حاجة لإنهاء شيء ما. </p><br><h2 id="thinkinghomemigrator" style=";text-align:right;direction:rtl">  ThinkingHome.Migrator </h2><br><p style=";text-align:right;direction:rtl">  في العام الماضي ، بدأت العمل في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مشروع</a> على .NET Core.  كان من الضروري تمكين ربط المكونات الإضافية ، ويجب أن تكون المكونات الإضافية قادرة على إنشاء بنية قاعدة البيانات اللازمة لأنفسهم من أجل تخزين بياناتهم هناك.  هذه مجرد مهمة ، حيث يكون المهاجر مناسبًا تمامًا. </p><br><h3 id="ef-migrations" style=";text-align:right;direction:rtl">  هجرات Ef </h3><br><p style=";text-align:right;direction:rtl">  لقد استخدمت Entity Framework Core للعمل مع قاعدة البيانات ، لذلك كان أول شيء جربته هو EF Migrations.  لسوء الحظ ، اضطررت على الفور للتخلي عن فكرة استخدامها. </p><br><p style=";text-align:right;direction:rtl">  تقوم عمليات ترحيل Entity Framework بسحب مجموعة من التبعيات إلى المشروع ، وعند بدء التشغيل تقوم ببعض السحر الخاص.  خطوة إلى اليسار / خطوة إلى اليمين - تواجه قيودًا.  على سبيل المثال ، يجب أن تكون عمليات ترحيل Entity Framework لسبب ما بالضرورة في نفس التجميع مع <code>DbContext</code> .  هذا يعني أنه لن يكون من الممكن تخزين عمليات الترحيل داخل المكونات الإضافية. </p><br><h3 id="fluentmigrator" style=";text-align:right;direction:rtl">  Fluentmigrator </h3><br><p style=";text-align:right;direction:rtl">  عندما أصبح من الواضح أن EF Migrations لم تكن مناسبة ، بحثت عن حل في جوجل ووجدت العديد من المهاجرين مفتوح المصدر.  أكثرها تقدمًا ، استنادًا إلى عدد التنزيلات على NuGet والنجوم على GitHub ، تبين أنها <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">FluentMigrator</a> .  وزير الخارجية جيد جدا!  إنه يعرف الكثير ولديه واجهة برمجة تطبيقات مريحة للغاية.  قررت في البداية أن هذا هو ما أحتاجه ، ولكن تم اكتشاف العديد من المشاكل في وقت لاحق. </p><br><p style=";text-align:right;direction:rtl">  تكمن المشكلة الرئيسية في أن FluentMigrator لا يعرف كيف يأخذ في الاعتبار تسلسل العديد من الإصدارات داخل نفس قاعدة البيانات.  كما كتبت أعلاه ، كنت بحاجة إلى استخدام مهاجر في تطبيق معياري.  من الضروري تثبيت الوحدات (الإضافات) وتحديثها بشكل مستقل عن بعضها البعض.  FluentMigrator لديه ترقيم الإصدار من طرف إلى طرف.  ولهذا السبب ، من المستحيل تنفيذ / استعادة ترحيل مكون إضافي واحد من قاعدة البيانات دون التأثير على بنية قاعدة البيانات للمكونات الإضافية المتبقية. </p><br><p style=";text-align:right;direction:rtl">  حاولت تنظيم السلوك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المطلوب</a> باستخدام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">العلامات</a> ، ولكن هذا ليس بالضبط ما تحتاجه.  لا يخزن FluentMigrator معلومات العلامات لعمليات الترحيل المكتملة.  بالإضافة إلى ذلك ، ترتبط العلامات بعمليات الترحيل وليس التجميعات.  هذا غريب جدًا ، نظرًا لأن نقطة الدخول للهجرة هي بالضبط التجميع.  من حيث المبدأ ، ربما كان من الممكن عمل نسخ متوازية بهذه الطريقة ، ولكنك تحتاج إلى كتابة غلاف معقد إلى حد ما فوق المهاجر. </p><br><h3 id="portirovat-ecm7migrator-na-net-core" style=";text-align:right;direction:rtl">  منفذ ECM7.Migrator إلى .NET Core </h3><br><p style=";text-align:right;direction:rtl">  في البداية ، لم يؤخذ هذا الخيار في الاعتبار.  في ذلك الوقت ، كان الإصدار الحالي من .NET Core هو 1.1 وكانت واجهة برمجة التطبيقات الخاصة به غير متوافقة بشكل جيد مع .NET Framework ، حيث عملت ECM7.Migrator.  كنت متأكدًا من أن نقله إلى .NET Core سيكون صعبًا ويستغرق وقتًا طويلاً.  عندما لم تكن هناك خيارات لـ "أخذ النهاية" ، قررت أن أجربها.  كانت المهمة أسهل مما توقعت.  والمثير للدهشة ، أنها عملت على الفور تقريبا.  كانت التعديلات الطفيفة فقط مطلوبة.  منذ أن تم تغطية منطق المهاجر من خلال الاختبارات ، كانت جميع الأماكن التي اندلعت مرئية على الفور وقمت بإصلاحها بسرعة. </p><br><p style=";text-align:right;direction:rtl">  لقد قمت الآن بنقل محولات لأربع DBMS فقط: MS SQL Server و PostgreSQL و MySQL و SQLite.  لم أقم بتوصيل محولات لـ Oracle (حيث لا يوجد حتى الآن عميل مستقر لـ .NET Core) و MS SQL Server CE (نظرًا لأنه يعمل فقط ضمن Windows وليس لدي مكان لتشغيله) و Firebird (لأنه لا تحظى بشعبية كبيرة ، المنفذ لاحقًا).  من حيث المبدأ ، إذا كنت بحاجة إلى إنشاء موفري لهذه DBMS أو غيرها - فهذا أمر بسيط للغاية. </p><br><p style=";text-align:right;direction:rtl">  شفرة المصدر للمُرحِّل الجديد <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">موجودة على GitHub</a> .  تكوين <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إطلاق الاختبارات لكل DBMS</a> في Travis CI.  تمت كتابة أداة سطر أوامر ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">.NET Core Global Tool</a> ) يمكن <a href="">تثبيتها</a> بسهولة <a href="">من NuGet</a> .  تم كتابة الوثائق - حاولت جاهدة أن أكتب بالتفصيل وبشكل واضح ، ويبدو أن ذلك حدث.  يمكنك أن تأخذ واستخدام! </p><br><h3 id="nemnogo-pro-nazvanie" style=";text-align:right;direction:rtl">  قليلا عن الاسم ... </h3><br><p style=";text-align:right;direction:rtl">  المهاجر الجديد ليس لديه توافق عكسي مع القديم.  إنهم يعملون على منصات مختلفة ولديهم واجهة برمجة تطبيقات مختلفة.  لذلك ، تم نشر المشروع تحت اسم مختلف. </p><br><p style=";text-align:right;direction:rtl">  تم اختيار الاسم من خلال مشروع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ThinkingHome</a> ، الذي قمت بنقل مهاجر له.  في الواقع ، تم تسمية ECM7.Migrator أيضًا للمشروع الذي كنت أعمل عليه في تلك اللحظة. </p><br><p style=";text-align:right;direction:rtl">  ربما كان من الأفضل اختيار اسم محايد ، ولكن لم يخطر ببالي أن لدي أي خيارات جيدة.  إذا كنت تعرف هذا - اكتب في التعليقات.  لم يفت الأوان لإعادة تسمية كل شيء. </p><br><p style=";text-align:right;direction:rtl">  وأشار رقم الإصدار 3.0.0 ، لأنه  المهاجر الجديد هو استمرار منطقي للمسنين. </p><br><h2 id="bystryy-start" style=";text-align:right;direction:rtl">  بداية سريعة </h2><br><p style=";text-align:right;direction:rtl">  لذا ، دعنا نحاول استخدام مهاجر. </p><br><p style=";text-align:right;direction:rtl">  يتم تسجيل جميع تغييرات قاعدة البيانات في رمز الترحيل - الفئات مكتوبة بلغة برمجة (على سبيل المثال ، في C #).  ترث فئات الترحيل من فئة <code>Migration</code> الأساسية من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ThinkingHome.Migrator.Framework</a> package.  فيها ، تحتاج إلى تجاوز طرق الفئة الأساسية: <code>Apply</code> (تطبيق التغييرات) و <code>Revert</code> (استرجاع التغييرات).  داخل هذه الأساليب ، يصف المطور ، باستخدام <a href="">واجهة برمجة تطبيقات خاصة ،</a> الإجراءات التي يجب تنفيذها في قاعدة البيانات. </p><br><p style=";text-align:right;direction:rtl">  يجب أيضًا تمييز فئة الترحيل بسمة <code>[Migration]</code> والإشارة إلى الإصدار الذي ستذهب إليه قاعدة البيانات بعد إجراء هذه التغييرات. </p><br><h3 id="primer-migracii" style=";text-align:right;direction:rtl">  مثال الهجرة </h3><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ThinkingHome.Migrator.Framework; [Migration(<span class="hljs-number"><span class="hljs-number">12</span></span>)] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MyTestMigration : Migration { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-type"><span class="hljs-type">void</span></span> Apply() { //  :   <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>.AddTable("CustomerAddress", <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Column</span></span>("customerId", DbType.Int32, ColumnProperty.PrimaryKey), <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Column</span></span>("addressId", DbType.Int32, ColumnProperty.PrimaryKey)); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-type"><span class="hljs-type">void</span></span> Revert() { //  :   <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>.RemoveTable("CustomerAddress"); //     ,  //  Revert    } }</code> </pre> <br><h3 id="kak-zapustit" style=";text-align:right;direction:rtl">  كيف تركض </h3><br><p style=";text-align:right;direction:rtl">  يتم تجميع عمليات الترحيل في ملف .dll.  بعد ذلك ، يمكنك إجراء تغييرات قاعدة البيانات باستخدام أداة وحدة تحكم <code>migrate-database</code> .  للبدء ، قم بتثبيته <a href="">من NuGet</a> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">dotnet</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">tool</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">install</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-g</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">thinkinghome</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.migrator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.cli</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  قم بتشغيل <code>migrate-database</code> ، مع تحديد نوع DBMS المطلوب ، وسلسلة الاتصال ، والمسار إلى ملف .dll مع عمليات الترحيل. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">migrate-<span class="hljs-keyword"><span class="hljs-keyword">database</span></span> postgres "host=localhost;port=5432;database=migrations;" /<span class="hljs-type"><span class="hljs-type">path</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>/migrations.dll</code> </pre> <br><h3 id="zapuskaem-cherez-api" style=";text-align:right;direction:rtl">  يعمل من خلال API </h3><br><p style=";text-align:right;direction:rtl">  يمكنك تنفيذ عمليات الترحيل من خلال واجهة برمجة التطبيقات من تطبيقك الخاص.  على سبيل المثال ، يمكنك كتابة تطبيق ينشئ عند إنشائه بنية قاعدة البيانات المطلوبة. </p><br><p style=";text-align:right;direction:rtl">  للقيام بذلك ، قم بتوصيل حزمة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ThinkingHome.Migrator</a> من NuGet والحزمة مع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">موفر التحويل لنظام إدارة قواعد البيانات (DBMS) المطلوب</a> لمشروعك.  بعد ذلك ، قم بإنشاء مثيل من فئة <code>ThinkingHome.Migrator.Migrator</code> واستدعاء أسلوب <code>Migrate</code> الخاص بها ، بتمرير الإصدار المطلوب من قاعدة البيانات كمعلمة. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">var version = <span class="hljs-literal"><span class="hljs-literal">-1</span></span>; //  <span class="hljs-literal"><span class="hljs-literal">-1</span></span>     var provider = <span class="hljs-string"><span class="hljs-string">"postgres"</span></span>; var connectionString = <span class="hljs-string"><span class="hljs-string">"host=localhost;port=5432;database=migrations;"</span></span>; var assembly = Assembly.LoadFrom(<span class="hljs-string"><span class="hljs-string">"/path/to/migrations.dll"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (var migrator = new Migrator(provider, connectionString, <span class="hljs-keyword"><span class="hljs-keyword">assembly</span></span>)) { migrator.Migrate(version); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  بالمناسبة ، يمكنك المقارنة مع مثال <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إطلاق</a> FluentMigrator. </p><br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  الخلاصة </h2><br><p style=";text-align:right;direction:rtl">  حاولت أن أصنع أداة بسيطة بدون إدمان وسحر معقد.  يبدو أنها عملت بشكل جيد للغاية.  المشروع لم يكن خامًا لفترة طويلة ، كل شيء مغطى في الاختبارات ، هناك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وثائق مفصلة</a> باللغة الروسية.  إذا كنت تستخدم .NET Core 2.1 ، فجرّب <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ترحيلًا جديدًا</a> .  على الأرجح ستعجبك أيضًا. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar414867/">https://habr.com/ru/post/ar414867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar414855/index.html">مجموعة مختارة من كتب Python الطازجة لأي شخص على وشك تعلمها</a></li>
<li><a href="../ar414857/index.html">مقابلة مع إيليا ستينكوف ، مؤسس سوق التشفير</a></li>
<li><a href="../ar414859/index.html">كيفية استخدام كاميرا USB مع ROS على Raspberry Pi أو BeagleBone Blue - لدفق الفيديو إلى جهاز كمبيوتر كبير</a></li>
<li><a href="../ar414861/index.html">نمذجة النفق - الإصدار 1.0</a></li>
<li><a href="../ar414865/index.html">تحدي أثاث iMaterialist أو 50 درجة من الكراسي</a></li>
<li><a href="../ar414869/index.html">الأطر المختفية</a></li>
<li><a href="../ar414871/index.html">وصلت العاصفة الترابية على سطح المريخ إلى مستوى الكواكب ، حتى أثرت الفضول</a></li>
<li><a href="../ar414873/index.html">قابلة للتحديد - أن والدتك لم تتحدث عن تحرير الموارد. الجزء الأول</a></li>
<li><a href="../ar414875/index.html">تكامل حاوية Kubernetes لاستبدال Docker الجاهزة للإنتاج</a></li>
<li><a href="../ar414877/index.html">عدسة غير عادية لكاميرا عادية أو كيفية التوقف عن التفكير في التركيز</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>