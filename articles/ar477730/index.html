<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐พโ๐ญ ๐๐ผ โ๏ธ ChipWhisperer: ูุฌูู ุงูุทุงูุฉ ุนูู ุงูุตูุงุฑุฉ ๐ ๐ฉ๐ผโ๐คโ๐ฉ๐ป ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุชุจ ุจูุงุณุทุฉ rakf 





 ูุฌุฒุก ูู Summer of Hack 2019 ูู Digital Security ุ ุชุนุงููุช ูุน ูุฌูู ููู ูุนููุช ูุน ChipWhisperer. 
 ูุง ูุฐุง 


 ุชุญููู ุงูุทุงูุฉ ูู ููุน ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ChipWhisperer: ูุฌูู ุงูุทุงูุฉ ุนูู ุงูุตูุงุฑุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/477730/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/users/rakf/" class="user_link">ูุชุจ</a> ุจูุงุณุทุฉ <a href="https://habr.com/ru/users/rakf/" class="user_link">rakf</a> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/t1/qx/44/t1qx44fuppd2dlfmn-vvb6fsriq.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ูุฌุฒุก ูู Summer of Hack 2019 ูู Digital Security ุ ุชุนุงููุช ูุน ูุฌูู ููู ูุนููุช ูุน ChipWhisperer. </p><br><h2 id="chto-eto" style=";text-align:right;direction:rtl">  ูุง ูุฐุง </h2><br><p style=";text-align:right;direction:rtl">  ุชุญููู ุงูุทุงูุฉ ูู ููุน ูู ุงููุฌูู ูู ุฎูุงู ูููุงุช ุงูุทุฑู ุงูุซุงูุซ.  ุจูุนูู ุ ุงููุฌูุงุช ุงูุชู ุชุณุชุฎุฏู ุงููุนูููุงุช ุงูุชู ุชุธูุฑ ููุชูุฌุฉ ููุชูููุฐ ุงููุนูู ูููุธุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุง ุงููุนูููุงุช ุงูุชู ูุฏ ุชููู ูููุฏุฉ ููููุงุฌููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุช ุชุญููู ุงูุชุดููุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุงุณุชููุงู ุงูุทุงูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงููุฌุงูุงุช ุงูููุฑููุบูุงุทูุณูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุถูุถุงุก ุงูุฎ </li></ul><br><p style=";text-align:right;direction:rtl">  ูุนุชุจุฑ ูุฌูู ุงูุทุงูุฉ ุงูุฃูุซุฑ ุนุงูููุฉ. </p><a name="habracut"></a><br><h2 id="pochemu-rabotaet" style=";text-align:right;direction:rtl">  ููุงุฐุง ุชุนููุ </h2><br><p style=";text-align:right;direction:rtl">  ุชุนุชูุฏ ุงููุนุงูุฌุงุช ุงูุฏูููุฉ ููุญุฏุงุช ุงูุชุญูู ุงูุฏูููุฉ ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ูุงูุนุฏูุฏ ูู ุงูุฏูุงุฆุฑ ุงูููุทููุฉ ุงูุฃุฎุฑู ุนูู ุชูููุฉ CMOS.  ูุชููู ุงุณุชููุงู ุทุงูุฉ ุฏูุงุฆุฑ CMOS ูู ูููููู: ุซุงุจุช ูุฏููุงูููู.  ุงุณุชููุงู ุงูุทุงูุฉ ุงูุซุงุจุช ุตุบูุฑ ุฌุฏูุง ุ ููู ุฃุญุฏ ุฃุณุจุงุจ ุงุญุชูุงุฑ ุงูุชูููููุฌูุง.  ุงูุทุงูุฉ ุงูุฏููุงููููุฉ ูุงุชุฌุฉ ุนู ุชุจุฏูู ุงูุชุฑุงูุฒุณุชูุฑุงุช ูุชุนุชูุฏ ุนูู ุงูุจูุงูุงุช ุงููุนุงูุฌุฉ ูุงูุนูููุงุช ุงูููุฌุฒุฉ.  ูุธุฑูุง ูุฃู ุงููููู ุงูุซุงุจุช ุซุงุจุช ุจุดูู ุฃุณุงุณู ุ ูุฅู ุงูุชุบููุฑ ูู ุฅุฌูุงูู ุงูุทุงูุฉ ูุฑุฌุน ุจุดูู ุญุตุฑู ุฅูู ุงููุฏุฑุฉ ุงูุฏููุงููููุฉ ุ ูุจุงูุชุงูู ุ ูููู ุงุณุชุฎุฏุงู ุฅุฌูุงูู ุงุณุชููุงู ุงูุทุงูุฉ ููุชุญููู. </p><br><h2 id="instrumentariy" style=";text-align:right;direction:rtl">  ุฃุฏูุงุช </h2><br><p style=";text-align:right;direction:rtl">  <a href="https://newae.com/tools/chipwhisperer/">ChipWhisperer</a> ุ ุงุณุชุฎุฏูุช ุงูุฅุตุฏุงุฑ ุงููููู ูู ุฌุฒุฃูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/56/p3/p4/56p3p4nq89l3drktqn9c0eo1mta.jpeg" alt="ChipWhisperer 2-Part Version"></p><br><p style=";text-align:right;direction:rtl">  ChipWhisperer ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ุฃุฏูุงุช ููุชูุญุฉ ุงููุตุฏุฑ ููุจุญุซ ูู ุฃูุงู ุงูุฃุฌูุฒุฉ ุงููุฏูุฌุฉ.  ูุฃููุง ุชุชูุญ ุชุญููู ุงูุทุงูุฉ ูุงููุฌูุงุช ุงููุงุฆูุฉ ุนูู ุงูุฎุทุฃ. </p><br><p style=";text-align:right;direction:rtl">  ุณูู ุฑุณูู ุชูููุฉ 250 ุฏููุงุฑ.  ูุถุนู ุงููุทูุฑูู ูุญู ุซูุฑู ุ ูุฃู ูุฐู ุงููุฌูุนุงุช ุ ููููุง ูููุจุฏุนูู ุ ุชููู 30 ุฃูู ุฏููุงุฑ.  ูุชููู ุงูุฌูุงุฒ ูู ููุญูู: ููุญุฉ ุงููุฏู ูุงูุชูุงุท. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุฅุตุฏุงุฑุงุช ุฃุฎุฑู ุ ูุน ูุฒุงูุงูุง (ูููู ุฃูุถูุง ุจุชูููุฉ ูุจูุฑุฉ) ุ ููููู ุฃูุถูุง ุดุฑุงุก ูุฎุชูู ุงูููุญุงุช ุงููุณุชูุฏูุฉ ูุจุทุงูุงุช ุงูุชูุณูุน ูุงูุชุญููู ูุฅุฌุฑุงุก ุชุญููู ูุงูู ููุฃุฌูุฒุฉ ุงูุฎุงุตุฉ ุจู ูุงุณุชุฎุฏุงู ChipWhisperer ููุท ููุฅุฒุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ChipWhisperer ูุฏูู <a href="https://wiki.newae.com/Main_Page">ูููู</a> ููุชุงุฒุฉ ุ <a href="https://chipwhisperer.readthedocs.io/en/latest/tutorials.html">ููุฎุชุจุฑุงุช</a> ุชุทููุฑ ุตุบูุฑุฉ ุ ูุญุชู ุงูุฅุตุฏุงุฑ ุงูุฎุงูุณ ูุงููุง ุจุนูู <a href="https://chipwhisperer.readthedocs.io/en/latest/api.html">ูุซุงุฆู</a> API ุฌูุฏุฉ.  ุชุชู ุฅุฒุงูุฉ ุงููุณุงุฑุงุช ูู ุงูุฌูุงุฒ ุงููุชุตู ุจุงุณุชุฎุฏุงู ุจุฑุงูุฌูู ูุชุณุฌูููุง ูุตููู NumPy. </p><br><p style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุฃููุงู ุฅูู ูุชุงุจุฉ ุงูุจุฑูุงูุฌ ุงูุซุงุจุช ููุฌูุงุฒ ุงููุฏู.  ูุฌุฒุก ูู ุงููุฎุชุจุฑ ุ ุชุนุชุจุฑ ุงูุฃุตูุงุฑ AES ุ DES ุ TEA.  ุจุงููุณุจุฉ ููู ุ ููุงู ุจุงููุนู ุฅุนุฏุงุฏุงุช ูุฅุนุฏุงุฏุงุช ุซุงุจุชุฉ ุฌุงูุฒุฉ ูุฅุฒุงูุฉ ุงูุขุซุงุฑ (ุนุฏุฏ ุงูุนููุงุช ุงูุชู ูุฌุจ ุฃุฎุฐูุง ุ ุงูุฅุฒุงุญุฉ ุ ุชุฑุฏุฏ ADC ุ ุฅูุฎ).  ูุฅุนุฏุงุฏุงุช ุงูุจุญุซ ุงููุณุชููุฉ ุ ูุฌุจ ุชุญุฏูุฏูุง ุชุฌุฑูุจูุงู. </p><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑ ุฃุนูุงู ุ ููููู ุฅุซุงุฑุฉ ูุดู ุงูููุญุฉ ุงููุฏู: ุงูุชุณุจุจ ูู ุฎูู ูู ุฅุดุงุฑุฉ ุงูุณุงุนุฉ ุ ูุชุฎุทู ุงูุชุนูููุงุช ูุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช ุงูุณุฑูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุฌูุนุงุช ุงููุจูุฑุฉ ุ ูุณุชุฎุฏู ุงูุฐุจุฐุจุงุช ูุชุชุจุน ุงููุณุงุฑุงุช. </p><br><h2 id="analiz" style=";text-align:right;direction:rtl">  ุชุญููู </h2><br><p style=";text-align:right;direction:rtl">  ููุงู ุงูุนุฏูุฏ ูู ุทุฑู ุงูุชุญููู ุงูุฃุณุงุณูุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญููู ุงูุทุงูุฉ ุงูุจุณูุทุฉ (SPA) ุ </li><li style=";text-align:right;direction:rtl">  ุชุญููู ุงูููุฉ ุงูุชูุงุถููุฉ (DPA) ุ </li><li style=";text-align:right;direction:rtl"> ุชุญููู ุงุฑุชุจุงุท ุงูุทุงูุฉ (CPA). </li></ul><br><p style=";text-align:right;direction:rtl">  ูุชุถูู ุชุญููู ุงูุทุงูุฉ ุงูุจุณูุท ุชุญููููุง ูุฑุฆููุง ููุฑุณู ุงูุจูุงูู ููุทุงูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุงูุญุตูู ุนูู ูููุฉ ุงููุฑูุฑ ุญุฑููุง ูุงุญุฏูุง ูู ูู ูุฑุฉ ูู ุฎูุงู ููุงุญุธุฉ ููู ุชุนุฑูู ุงูุทุงูุฉ ุนูุฏ ุฅุฏุฎุงู ุงูุญุฑู ุงูุตุญูุญ ูููุงุฑูุชู ุจุงูุญุฑู ุงูุฎุทุฃ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ep/rf/tg/eprftggxt26idk5tq4uccp3p9kq.png" alt="ุชุญููู ููุฉ ูููุฉ ุงููุฑูุฑ"></p><br><p style=";text-align:right;direction:rtl">  ุฃู ููููู ุฑุคูุฉ ุฌููุงุช ุงูุชุดููุฑ ุนูู ุงููุณุงุฑุงุช.  ูุง ูููู ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ุ ูููู ูููู ุงูุชุฑุงุถ ุงูุฎูุงุฑุฒููุฉ ุงูุชู ูุชู ุชูููุฐูุง.  ููุถุญ ุงูุดูู ุจูุถูุญ 10 ุฌููุงุช ูู AES. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ib/pl/e7/ibple7hxooxtxb1bkah2d1k-i_s.png" alt="AES SPA"></p><br><p style=";text-align:right;direction:rtl">  ูุนุฏ ุงูุชุญููู ุงูุชูุงุถูู (DPA) ุฃูุซุฑ ูุนุงููุฉ ูู ุงูุชุญููู ุงูุจุณูุท ุ ุญูุซ ูุนุชูุฏ ุชุญููู DPA ุนูู ุทุฑู ุงูุชุญููู ุงูุฅุญุตุงุฆู ูุงูุชุดุงู ุงูุงุฎุชูุงูุงุช ูู ุขุซุงุฑ ุงูุทุงูุฉ.  ููุน ุฐูู ุ ูุฅู ุฃุฏุงุฉ ูุนุงูุฉ ููุบุงูุฉ "ููุชุญ" ุงูููุชุงุญ ุณุชุชุทูุจ ุนุฏุฏูุง ูุจูุฑูุง ูู ุงููุณุงุฑุงุช.  ูู ุฃุณุชุฎุฏู ูุฐู ุงูุทุฑููุฉ ููุชุญููู ุ ููู ูู ุงูููุงูุฉ ุณุฃูุฏู ุจุนุถ ุงูุฑูุงุจุท ุฅูู ุงููุตุงุฏุฑ ุงูุชู ุชู ูุตููุง ุฌูุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ุฃุณุงุณ ุชุญููู ุงูุงุฑุชุจุงุท ูู ุฌูุงุฒ ุฅุญุตุงุฆู ูุชุญุฏูุฏ ููุชุงุญ ุงูุชุดููุฑ ุงูุณุฑู.  ูู ุจุนุถ ุงูุฃุญูุงู ูุชู ุนุฒูู ูู ููุน ูููุตู ุ ูุดุงุฑ ุฅููู ุฃุญูุงููุง ุจุงุณู DPA.  ูุฐู ุงูุทุฑููุฉ ุชุชุทูุจ ุขุซุงุฑ ุฃูู ูู DPA ุ ููุฏ ุงุณุชุฎุฏูุชูุง ูุชุญููู ุงูุทุงูุฉ.  ุณูู ุฃุฎุจุฑูู ุงููุฒูุฏ ุญูู ูุฐุง ุงูููุถูุน. </p><br><p style=";text-align:right;direction:rtl">  ุงููููุฉ ุงูุฑุฆูุณูุฉ ูู ุจูุงุก ูููุฐุฌ ุฏููู ูุงุณุชููุงู ุงูุทุงูุฉ ููุฌูุงุฒ ููุฏ ุงูุฏุฑุงุณุฉ.  ุฅุฐุง ุชู ุจูุงุก ูููุฐุฌ ุฏููู ุ ูููุงู ุงุฑุชุจุงุท ูุงุถุญ ุจูู ุงููููุฉ ุงููุชููุนุฉ ูุงููููุฉ ุงููุนููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุงุญุฏ ูู ููุงุฐุฌ ุงูุทุงูุฉ ุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูู ูููุฐุฌ ุงููุฒู ูุงูููุบ.  ูุฒู Hamming ูู ุนุฏุฏ ุงูููู ุบูุฑ ุงูุตูุฑูุฉ ูู ุงูุชูุซูู ุงูุซูุงุฆู.  ููุชุฑุถ ูุฐุง ุงููููุฐุฌ ุฃู ุนุฏุฏ ูุญุฏุงุช ุงูุจุช ุงููุญุฏุฏุฉ ูู ุงูุณุฌู ุณูู ูุฑุชุจุท ุจุงูุทุงูุฉ ุงูุชู ูุณุชููููุง ุงูุฌูุงุฒ.  ูุณุชุฎุฏู ูุฒู ูุงูููุบ ููุณู ูููุง ุจุนุฏ ููุญุฏุฉ ุทุงูุฉ ุชูููุฏูุฉ.  ูุณุชุฎุฏู ูููุฐุฌ ูุณุงูุฉ Hamming ุฃูุถูุง - ุนุฏุฏ ุงูุจุชุงุช ุงููุฎุชููุฉ ูู ูููุชูู. </p><br><p style=";text-align:right;direction:rtl">  ูููุงุฑูุฉ ูููุฐุฌ ูุฒู Hamming ูุงุณุชููุงู ุงูุทุงูุฉ ุงูุญูููู ุ ูุชู ุงุณุชุฎุฏุงู ูุนุงูู Pearson ุงูุฎุทู.  ููุธูุฑ ุงูุงุนุชูุงุฏ ุงูุฎุทู ููููุฉ ูุงุญุฏุฉ ุนูู ุฃุฎุฑู.  ุจุงุณุชุฎุฏุงู ูููุฐุฌ ุชู ุฅูุดุงุคู ุจุดูู ุตุญูุญ ุ ูููู ูุฐุง ุงููุนุงูู ุฅูู 1. </p><br><p style=";text-align:right;direction:rtl">  ุชุชููู ุฎูุงุฑุฒููุฉ CPA ุงููุนููุฉ ูู ุงูุฎุทูุงุช ุงูุฑุฆูุณูุฉ ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฒุงูุฉ ุงุณุชููุงู ุงูุทุงูุฉ ุนูุฏ ุชุญููู ุงูุฑุณุงุฆู ุนูู ููุชุงุญ ุบูุฑ ูุนุฑูู ุ </li><li style=";text-align:right;direction:rtl">  ูุจูู ูููุฐุฌูุง ูุงุณุชููุงู ุงูุทุงูุฉ ููุฑูุงูุฉ ุนูุฏ ุชุญููู ุงูุฑุณุงุฆู ููุณูุง ุนูู ุฌููุน ุงููุชุบูุฑุงุช ุงููุญุชููุฉ ูููุชูุฉ ุงููุฑุนูุฉ ุงูุฑุฆูุณูุฉ (256 ุฎูุงุฑูุง ููู ุจุงูุช) ุ </li><li style=";text-align:right;direction:rtl">  ูุฌุฏ ูุนุงูู ุงูุงุฑุชุจุงุท ุงูุฎุทู ูุงุณุชููุงู ุงูุทุงูุฉ ุงููุญุงูู ูุงูุญูููู.  ูู ุญุงูุฉ ูุฌูุฏ ููุชุงุญ ุญูููู ุ ูููู ุงููุนุงูู ุฅูู 1 ุ </li><li style=";text-align:right;direction:rtl">  ูุชู ุชูุฑุงุฑ ุงูุฎูุงุฑุฒููุฉ ูููุชู ุงููุฑุนูุฉ ุงูุฑุฆูุณูุฉ ุงููุชุจููุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ูุชู ุงุณุชุนุงุฏุฉ ุงูููุชุงุญ ุจุงูุชุชุงุจุน ุ ูู ุฃุฌุฒุงุก ุตุบูุฑุฉ.  ุฅุฐุง ูุงุฌููุง ุจุงูุช ูุงุญุฏ ูู ุงูููุชุงุญ ูู ููุช ูุงุญุฏ ุ ูุฅููุง ูุณุชุฎุฏู 2 <sup>8</sup> ูุญุงููุงุช ููู ููุชุงุญ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ุงุฎุชุฑุช AES - 128 ุ ูุณูููู ุงูุนุฏุฏ ุงูุฅุฌูุงูู ููุญุงููุงุช 16 ุจุงูุช ูู ุงูููุชุงุญ ูู 2 <sup>12</sup> ุ ููู ุฃูุถู ุจูุซูุฑ ูู ุถุฑุจ 2 <sup>128</sup> . </p><br><h3 id="analiz-shifra-magma" style=";text-align:right;direction:rtl">  ุชุญููู ุงูุตูุงุฑุฉ ุงูุชุดููุฑ </h3><br><p style=";text-align:right;direction:rtl">  ุงูุตูุงุฑุฉ ูู ุฑูุฒ ุชู ุชุนุฑููู ูู GOST R 34.12-2015 ุ ูู ุงููุงูุน ููุณ GOST 28147-89 ุ ููุท ูู ุงูููู ุงูุดุฎุตู.  ุชูุฑ ุงููุชูุฉ ุงููุดูุฑุฉ ุฎูุงู 32 ุฌููุฉ ุชุญุฏุซ ูููุง ุจุนุถ ุงูุชุญูููุงุช.  ูุชููู ุงูููุชุงุญ ูู 256 ุจุช ุ ูู ููุชุงุญ ุฏุงุฆุฑู ุฌุฒุก ูู ุงูุฃุตู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/il/lf/jg/illfjg84nei10xf2xgboiifkmjy.png" alt="ูุธููุฉ ููุณุชู"></p><br><p style=";text-align:right;direction:rtl">  ุณูููู ุจุชุญููู ุงูุจูุงูุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงุชูุงู ุงูุณูุงู ุงูุดุงูู. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุชุญุชุงุฌ ุฅูู ุงุฎุชูุงุฑ ูููุฉ ูุณูุทุฉ ููุฎูุงุฑุฒููุฉ ุ ูุงูุชู ุชุนุชูุฏ ุนูู ุงูุจูุงูุงุช ุงููุนุฑููุฉ ูุฌุฒุก ุตุบูุฑ ูู ุงูููุชุงุญ ููููู ุญุณุงุจูุง ุจุชุญูููุงุช ุจุณูุทุฉ.  ุนุงุฏุฉู ูุง ุชููู ูุฐู ุงููููุฉ ูู ุฅุฎุฑุงุฌ S-box (ูุญุชูู Magma ุงูุขู ุนูู ุฌุฏูู ุจุฏูู ูุงุญุฏ ุ ูุฐูู ูู ุงูุฃุณูู ุชูููุฐ ูุซู ูุฐู ุงููุฌูุงุช) ูู ุงูุฃููู (ุงููุตูุต ุงูููุชูุญุฉ ูุนุฑููุฉ) ุฃู ุงูุฌููุฉ ุงูุฃุฎูุฑุฉ (ุชูุนุฑู ุงููุตูุต ุงููุดูุฑุฉ). </p><br><p style=";text-align:right;direction:rtl">  ููุฏ ุจุญุซุช ูู ููุชุงุญ ูุญุชูู ุนูู ูุตูุต ููุชูุญุฉ ูุนุฑููุฉ ุ ูุจุงูุชุงูู ุณูุชู ุงููุธุฑ ูู ูุฐุง ุงูุฎูุงุฑ.  ูู ุฎูุงุฑุฒููุฉ ุงูุตูุงุฑุฉ ุ ุนูู ุนูุณ DES ุ AES ุ ุชุญุฏุซ ุฅุถุงูุฉ ูุชูุฉ 32 ุจุช ูุน ููุชุงุญ ูุณุชุฏูุฑ ุงููุนูุงุฑ 2 <sup>32</sup> ุ ูุฐูู ุ ูู ุงูุฃูุถู ุฃู ุชุจุฏุฃ ุงูุชุญููู ูู ุขุฎุฑ ูุฎุฑุฌุงุช S-box ุ ูุฃู ุฅุถุงูุฉ ุฃุนูู ุงูููู ูุง ุชุคุซุฑ ุนูู ุงูุฃุตุบุฑ ุณูุงู.  ูุญู ูุนุชุจุฑ ุฅุฎุฑุงุฌ ูู ุตูุฏูู S: ุฃูู 8 ุ ุซู ูุนุทู 8 ุ 7 ูููุฐุง ุญุชู ุงูุฃูู.  ุชู ุชูููุฐ ุฅุฒุงูุฉ ุงููุณุงุฑ ุนูู ูุชุญูู 8 ุจุช ุ ููููููุง ุฃู ููุชุฑุถ ุฃููุง ุนููุช ูุน ุตูุงุฏูู S ูุฒุฏูุฌุฉ.  ูุฐูู ุ ุณุฃูุงุฌู ุนูู ุงูููุฑ ุจูุงุณุทุฉ 1 ุจุงูุช. </p><br><p style=";text-align:right;direction:rtl">  ุญุณุงุจ ูููุฐุฌ ุงูุทุงูุฉ ูุขุฎุฑ ุจุงูุช ุฑุฆูุณู: </p><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[leak("Gost28147_tc26_ParamZ", kguess, block2ns(text[tnum])[0], 0)]</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญูุซ ุชููู ุฏุงูุฉ ุงูุชุณุฑุจ ุจุจุณุงุทุฉ ุจุฅุฑุฌุงุน ุฅุฎุฑุงุฌ S-box ููุจุงูุช ุงูุฃุฎูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูุญุณุจ ูุนุงูู ุจูุฑุณูู ุงูุฎุทู ููููู ุงููุญุงูุงุฉ ูุงูุญููููุฉ ููููุง ููุตูุบุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yt/wd/f-/ytwdf-ah0p0fshbi-i83_tldkvs.png" alt="ุงุฑุชุจุงุท"></p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"> cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-comment"><span class="hljs-comment">#Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงุฎุชูุงุฑ ููุชุงุญ ูุฑุนู ุญูููู ุ ุณูููู ููุนุงูู ุงูุงุฑุชุจุงุท ุฒูุงุฏุฉ ููุญูุธุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/8o/7j/8z/8o7j8zrfxosgutb_eymflrxxhp0.png" alt="Correlation1"></p><br><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ูุชู ุชุญููู ูู ุจุงูุช ูู ููุชุงุญ ุงูุฌููุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number"><span class="hljs-number">8</span></span>) | best_round ...</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุงููุธุฑ ุฅูู ููุชุงุญ ุงูุฌููุฉ ุงูุฃููู ุ ูููููุง ุญุณุงุจ ููุงุชูุญ ุงูุฌููุฉ 2 ูุงููุงุญูุฉ ุจููุณ ุงูุทุฑููุฉ.  ูููู ุงูุญุตูู ุนูู ููุชุงุญ Magma ุงููุงูู ูู ุฎูุงู ุฅุฎุฑุงุฌ 8 ููุงุชูุญ ูุณุชุฏูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุนูููุฉ ุญู ูุฐู ุงููุดููุฉ ุ ุชูุดุฃ ุนุฏุฉ ูุฑูู ุฏูููุฉ.  ุนูู ุนูุณ AES ุ DES ุ ุงูุฃุตูุงุฑ Grasshopper ุ ุฅุถุงูุฉ ููุชุงุญ ูุณุชุฏูุฑ ุบูุฑ ุธุงูุฑ ูุญุฏุซ ูู ุงููุนุงูู 2 <sup>32</sup> .  ุชุคุซุฑ ุฅุถุงูุฉ ูุญุฏุงุช ุงูุจุช ุงูููุฎูุถุฉ ุนูู ุงููุณุจุฉ ุงูุนุงููุฉ ุ ุนูู ุนูุณ XORa.  ุนูุฏ ุญุณุงุจ ูู ููุชุงุญ ูุฑุนู ูุงุญู ุ ูุฌุจ ุนููู ูุฑุงุนุงุฉ ูุชุงุฆุฌ ุงููุงุถู.  ูุจุงููุซู ูุน ููุงุชูุญ ุงูุฌููุฉ.  ุงูุจูุงูุงุช ุญุณุงุณุฉ ููุบุงูุฉ.  ุฅุฐุง ุชู ุญุณุงุจ ุฅุญุฏู ุงูููู ุจุดูู ุบูุฑ ุตุญูุญ ุ ูุณูููู ุงูุญุณุงุจ ุงูุฅุถุงูู ููููุชุงุญ ุจุฃูููู ุบูุฑ ุตุญูุญ. </p><br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฃูุถูุง ุฅูู ุฃูู ูู ุงูุตุนุจ ููุบุงูุฉ ุงูุขู ุงูุนุซูุฑ ุนูู ุดุฑูุญุฉ ุจูุง ุจููุฉ ุฐุงุช ุฃุฑุจุนุฉ ุจุชุงุช: ูุนุธู ุงูุดุฑุงุฆุญ ุจูุง ุซูุงููุฉ ุจุชุงุช.  ุจุงูุทุจุน ุ ููุงู ุดุฑุงุฆุญ ุชุดููุฑ ูุชุฎุตุตุฉ ูุตููุฉ ูุฎูุงุฑุฒููุฉ ุชุญููู ุฃูุงู ูุนููุฉ (ุฃู ุนุฏุฉ ุฎูุงุฑุฒููุงุช) ููุฏููุง ุงูุจููุฉ ุงูุฃูุซุฑ ููุงุกุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุชูููุฐ ุชุดููุฑ DES ุ ูููู ุฃู ูููู ููุนุงูุฌ ุงูุชุดููุฑ ูุฐุง ุจููุฉ ูู ุณุชุฉ ุจุชุงุช ูู Magma - ูุงุญุฏุฉ ุจุฃุฑุจุนุฉ ุจุช ุ ูุงูุชู ุชุณูุญ ุจูุนุงูุฌุฉ ูู S-box ุจุดูู ูููุตู.  ุฌูุงุฒู ุงููุณุชูุฏู ูู 8 ุจุช ุ ููู ุญุงูุฉ "ุงูุตูุงุฑุฉ" ุ ุณูุชู ุฅุฌุฑุงุก ุงูุชุญููู ุนูู ุซูุงูู ุจุชุงุช ูู ุทุฑููุฉ ูุงุญุฏุฉ ุ ุฃู  ุณูุญุฏุซ ุงูุงุณุชุจุฏุงู ุนูู 2 S-box ุ ูุณูุชู ุงููุธุฑ ูู ุงุณุชููุงู ุงูุทุงูุฉ ููุฏุฉ 2 S-box.  ุฅุฐุง ุชุทุงุจู ุฃุญุฏ ุงูุตูุงุฏูู S ุ ูุจูุฑ ุฃู ุตุบูุฑ ุ ูุน ุงูููุชุงุญ ุงูุญูููู ุ ูุงูุขุฎุฑ ุบูุฑ ูุชุทุงุจู ุ ููุฏ ุชุญุฏุซ ุฑุดูุงุช ุงุฑุชุจุงุท ุนุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุธุฑ ุฅูู ูู ูุง ุณุจู ุ ูู ุงููุงุชุฌ ูุฏููุง ุงููุต ุงูุชุงูู ูุชุญููู ูุณุงุฑุงุช ุงุณุชููุงู ุงูุทุงูุฉ ูุดูุฑุงุช ุงูุตูุงุฑุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุจูุซูู ุงููุตู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np path = <span class="hljs-string"><span class="hljs-string">r'C:\Users\user\chipwhisperer\projects\gost_10000_2_data\traces\2019.08.11-19.53.25_'</span></span> traces = np.load(path + <span class="hljs-string"><span class="hljs-string">'traces.npy'</span></span>) text = np.load(path + <span class="hljs-string"><span class="hljs-string">'textin.npy'</span></span>) keys = np.load(path + <span class="hljs-string"><span class="hljs-string">'keylist.npy'</span></span>) HW = [bin(n).count(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">256</span></span>)] SBOXES = {<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>: ( (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), (<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), )} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_K</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s, _in)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" S-box substitution :param s: S-box :param _in: 32-bit word :returns: substituted 32-bit word """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (s[<span class="hljs-number"><span class="hljs-number">0</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">1</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">2</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">3</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">4</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">5</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">6</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">7</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">28</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block2ns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Convert block to N1 and N2 integers """</span></span> data = bytearray(data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( data[<span class="hljs-number"><span class="hljs-number">7</span></span>] | data[<span class="hljs-number"><span class="hljs-number">6</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">5</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, data[<span class="hljs-number"><span class="hljs-number">3</span></span>] | data[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addmod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, mod=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ** </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Modulo adding of two integers """</span></span> r = x + int(y) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r &lt; mod <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> r - mod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_shift11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 11-bit cyclic shift """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((x &lt;&lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) | ((x &gt;&gt; (<span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">11</span></span>)) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, byte)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] _in = addmod(data, key) sbox_leak = _K(s, _in); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sbox_leak &gt;&gt; (<span class="hljs-number"><span class="hljs-number">8</span></span> * byte)) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Feistel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, nround)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] w = bytearray(key) x = [ w[<span class="hljs-number"><span class="hljs-number">3</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] | w[<span class="hljs-number"><span class="hljs-number">2</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | w[<span class="hljs-number"><span class="hljs-number">1</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | w[<span class="hljs-number"><span class="hljs-number">0</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">8</span></span>) ] n1, n2 = block2ns(data) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(nround): n1, n2 = _shift11(_K(s, addmod(n1, x[i]))) ^ n2, n1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n1 numtraces = len(traces) numpoint = np.shape(traces)[<span class="hljs-number"><span class="hljs-number">1</span></span>] bestguess = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">32</span></span> round_data = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * numtraces <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[i] = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>): best_round = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tnum_r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[tnum_r][rnum] = Feistel(<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>, bestguess, text[tnum_r], rnum) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero best_round_key = kguess &lt;&lt; (bnum * 8) | best_round sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[round("Gost28147_tc26_ParamZ", best_round_key, round_data[tnum][rnum], bnum)] #Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess])) best_round = best_round | (np.argmax(maxcpa) &lt;&lt; (bnum * 8)) bestguess[((rnum + 1) * 4)-bnum - 1] = np.argmax(maxcpa) print "Best Key Guess: " for b in bestguess: print "%02x "%b,</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  <a href="https://github.com/rakf/ChipWhisperer/tree/master/GOST">ูุณุชูุฏุน ุฌูุซุจ ูููุชุงุฆุฌ</a> </p><br><h2 id="vyvody" style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br><p style=";text-align:right;direction:rtl">  ูุฌุฒุก ูู ุงูุฏุฑุงุณุฉ ุ ุนููุช ูุน ChipWhisperer.  ุนูู ุงูุฑุบู ูู ุฃููู ูู ุฃุฌุฑุจ ูู ุงูุฃุฏูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ุงูุชุฒููุฑ) ุ ูุฅููู ุจุงูุชุฃููุฏ ุฃุฌุฏ ChipWhisperer ูููุฏูุง ุ ุฎุงุตุฉ ุฅุฐุง ููุช ูุง ุชุฑุบุจ ูู ุดุฑุงุก ุฃุฌูุฒุฉ ุฎุงุตุฉ ุจุงูุธุฉ ุงูุซูู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุชุญููู ุงูุดูุฑุงุช ุงูุฎุงุต ุจูุง ูุงุณุชููุงู ุงูุทุงูุฉ ุ ููู ุฃูุซุฑ ููุงููุฉ ููุฐุง ุงููุฌูู ูู ุงูุฃุตูุงุฑ ุงูููุตููุฉ ุฃุนูุงู ุ ูููู ูุน ูุฌูุฏ ุจูุงูุงุช ูุงููุฉ ุ ูููู ุงูุญุตูู ุนูู ุงูููุชุงุญ ุฏูู ูุดุงูู. </p><br><p style=";text-align:right;direction:rtl">  ููุงุฏ ูุซูุฑุฉ ููุงูุชูุงู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  P. Kocher ุชุญููู ุงูููุฉ ุงูุชูุงุถููุฉ </li><li style=";text-align:right;direction:rtl">  "ูุฌูุงุช ุชุญููู ุงูุทุงูุฉ: ุงููุดู ุนู ุฃุณุฑุงุฑ ุงูุจุทุงูุงุช ุงูุฐููุฉ" </li><li style=";text-align:right;direction:rtl">  <a href="https://xakep.ru/2015/01/29/crypto-i-keys/">ุงูุชุดููุฑ ุชุญุช ุชูุฏูุฏ ุงูุณูุงุญ I: ุงูุจุญุซ ุนู ููุงุชูุญ ุฎูุงุฑุฒููุงุช ุงูุชุดููุฑ</a> R. Korkikyan. </li><li style=";text-align:right;direction:rtl">  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">ุงูุชุดููุฑ ุชุญุช ุชูุฏูุฏ ุงูุณูุงุญ ุงูุซุงูู: ุชุญููู ุงูุชุบุฐูุฉ ุงูุชูุงุถููุฉ</a> R. Korkikyan. </li><li style=";text-align:right;direction:rtl">  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">ุชูุฑูุฑ ูุน ZeroNights 2014</a> R. Korkikyan. </li><li style=";text-align:right;direction:rtl">  ุชุดููุฑ <a href="http://2014.zeronights.org/assets/files/slides/cryptocodingv2.pdf">v2</a> ูุน ZeroNights 2014 ุญูู ุชูููุฐ ุงูุจุฑูุงูุฌ. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar477730/">https://habr.com/ru/post/ar477730/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar477716/index.html">ูุญุณุจ ุนููุงุก ุงูุฑูุงุถูุงุช ุงูุฐูู ูุณุชุฎุฏููู ูุซุงู "ุงูุนูุงูุฉ" ููููุฉ ุญุฏูุซ ุงูุนุดูุงุฆูุฉ</a></li>
<li><a href="../ar477718/index.html">ุทุจูุฉ ุชูุงููููุฉ: ุงูุฅูุชูุงุก ุงูุณุฑูุน ููููุง ูุทุฑููุฉ ุดููุฆูู ููููุบุฑุงุฏ</a></li>
<li><a href="../ar477722/index.html">ุฏููู ุฃููุงุท Google ูู C ++. ุงูุฌุฒุก 8</a></li>
<li><a href="../ar477724/index.html">ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ habraseminar: ุญูู ุงูููุงูุจ ูุงูุตูุฏ ูุงููุญุชูู</a></li>
<li><a href="../ar477728/index.html">ูุง ูุฌุจ ุงูููุงู ุจู ูุคุฏู ุงููุฑูู ุญุชู ูุง ูุญุชุฑู ุงููุฑูู</a></li>
<li><a href="../ar477732/index.html">ุชุตููู ุฃุตุงุจุน ุฎุงุทุฆ ูุฃูุธูุฉ ุงูููุงุญุฉ ุชุญุช ุงููุงุก</a></li>
<li><a href="../ar477734/index.html">ููู UICollectionViewLayout ูุน ุชุทุจูู ุงูุตูุฑ</a></li>
<li><a href="../ar477736/index.html">ูุณุงุฑ ุงูุงุฎุชุจุงุฑ: ูู "ูุฑููุฉ ุงููุฏ" ุฅูู ุงูุฃุชูุชุฉ</a></li>
<li><a href="../ar477738/index.html">iKassa ุฃู ููู ูููุง ุจุชุฑููุถ "ุฃููู ุงูุตูุฏูู ุงูุฑููู"</a></li>
<li><a href="../ar477740/index.html">ูุฃูู ุชูุธุฑ ุฅูู ูุฐุง ุงูุชูุณููุจ ุจุนููููุ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>