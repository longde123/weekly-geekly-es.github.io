<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЩКя╕П ЁЯзСЁЯП╗ ЁЯГП рдПрдХрддрд╛ рдореЗрдВ рд╖рдЯреНрдХреЛрдг рдорд╛рдирдЪрд┐рддреНрд░: рдкрде рдЦреЛрдЬрдХ, рдЦрд┐рд▓рд╛рдбрд╝реА рджрд╕реНрддреЗ, рдПрдирд┐рдореЗрд╢рди ЁЯСйтАНЁЯТ╝ ЁЯЦЗя╕П ЁЯзЦЁЯП╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рднрд╛рдЧ 1-3: рдЬрд╛рд▓, рд░рдВрдЧ рдФрд░ рд╕реЗрд▓ рдКрдБрдЪрд╛рдИ 

 рднрд╛рдЧ 4-7: рдзрдХреНрдХреЛрдВ, рдирджрд┐рдпреЛрдВ рдФрд░ рд╕рдбрд╝рдХреЛрдВ 

 рднрд╛рдЧ 8-11: рдЬрд▓, рднреВ-рднрд╛рдЧ рдФрд░ рдкреНрд░рд╛рдЪреАрд░ 

 рднрд╛рдЧ 12-15: рдмрдЪрдд рдФрд░ рд▓реЛрдбрд┐рдВрдЧ, рдмрдирд╛рд╡рдЯ, рджреВрд░рд┐рдпрд╛рдВ 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХрддрд╛ рдореЗрдВ рд╖рдЯреНрдХреЛрдг рдорд╛рдирдЪрд┐рддреНрд░: рдкрде рдЦреЛрдЬрдХ, рдЦрд┐рд▓рд╛рдбрд╝реА рджрд╕реНрддреЗ, рдПрдирд┐рдореЗрд╢рди</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426481/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 1-3: рдЬрд╛рд▓, рд░рдВрдЧ рдФрд░ рд╕реЗрд▓ рдКрдБрдЪрд╛рдИ</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 4-7: рдзрдХреНрдХреЛрдВ, рдирджрд┐рдпреЛрдВ рдФрд░ рд╕рдбрд╝рдХреЛрдВ</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 8-11: рдЬрд▓, рднреВ-рднрд╛рдЧ рдФрд░ рдкреНрд░рд╛рдЪреАрд░</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 12-15: рдмрдЪрдд рдФрд░ рд▓реЛрдбрд┐рдВрдЧ, рдмрдирд╛рд╡рдЯ, рджреВрд░рд┐рдпрд╛рдВ</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 16-19: рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдирд╛, рдЦрд┐рд▓рд╛рдбрд╝реА рджрд╕реНрддреЗ, рдПрдирд┐рдореЗрд╢рди</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 20-23: рдХреЛрд╣рд░реЗ рдХреЗ рдпреБрджреНрдз, рдорд╛рдирдЪрд┐рддреНрд░ рдЕрдиреБрд╕рдВрдзрд╛рди, рдкреНрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рдкреАрдврд╝реА</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднрд╛рдЧ 24-27: рдЬрд▓ рдЪрдХреНрд░, рдЕрдкрд░рджрди, рдмрд╛рдпреЛрдо, рдмреЗрд▓рдирд╛рдХрд╛рд░ рдирдХреНрд╢рд╛</a> <br><br><h1>  рднрд╛рдЧ 16: рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдирд╛ </h1><br><ul><li>  рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░реЗрдВ </li><li>  рдЦреЛрдЬ рд▓рдХреНрд╖реНрдп рдЪреБрдиреЗрдВ </li><li>  рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬреЗрдВ </li><li>  рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрддрд╛рд░ рдмрдирд╛рдПрдВ </li></ul><br>  рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЙрдирдХреЗ рдмреАрдЪ рдХреЗ рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝реЗред <br><br>  рдЗрд╕ рднрд╛рдЧ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ, рд╖рдЯреНрднреБрдЬ рдорд╛рдирдЪрд┐рддреНрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдПрдХрддрд╛ 5.6.0 рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ 5.6 рдореЗрдВ рдПрдХ рдмрдЧ рд╣реИ рдЬреЛ рдХрдИ рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд╛рдирд╕рднрд╛рдУрдВ рдореЗрдВ рдмрдирд╛рд╡рдЯ рдХреЗ рд╕рд░рдгрд┐рдпреЛрдВ рдХреЛ рдирд╖реНрдЯ рдХрд░ рджреЗрддрд╛ рд╣реИред  рдЖрдк рдмрдирд╛рд╡рдЯ рд╕рд░рдгреА рдирд┐рд░реАрдХреНрд╖рдХ рдореЗрдВ <em>рдкрдардиреАрдп</em> рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗ рдЗрд╕рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d9/165/c4e/1d9165c4e1862b050015df3c9dcc48cd.jpg"></div><br>  <i>рдПрдХ рдпрд╛рддреНрд░рд╛ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реИ</i> <br><a name="habracut"></a><br><h2>  рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХреА рдЧрдИ рдХреЛрд╢рд┐рдХрд╛рдПрдВ </h2><br>  рджреЛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЗрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рд╕реЗрд▓ рдЪреБрдирдиреЗ рдФрд░ рдирдХреНрд╢реЗ рдкрд░ рдЦреЛрдЬ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдлрд┐рд░ рдЕрдВрддрд┐рдо рдПрдХред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЙрдирдХреЗ рд▓рд┐рдП рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛ред  рдЗрд╕рд▓рд┐рдП, рдЖрдЗрдП рдРрд╕реА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдЬреЛрдбрд╝реЗрдВред  рдЬрдм рддрдХ рд╣рдо рд╣рд╛рдЗрд▓рд╛рдЗрдЯрд┐рдВрдЧ рдХрд╛ рдПрдХ рдкрд░рд┐рд╖реНрдХреГрдд рдпрд╛ рдХреБрд╢рд▓ рддрд░реАрдХрд╛ рдирд╣реАрдВ рдмрдирд╛рддреЗ рд╣реИрдВ, рддрдм рддрдХ рд╣рдо рд╡рд┐рдХрд╛рд╕ рдХреЗ рд╕рд╛рде рд╣рдорд╛рд░реА рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдмрдирд╛рддреЗ рд╣реИрдВред <br><br><h3>  рдмрдирд╛рд╡рдЯ рдХреА рд░реВрдкрд░реЗрдЦрд╛ </h3><br>  рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕рд░рд▓ рддрд░реАрдХрд╛ рдЙрдирдХреЗ рд▓рд┐рдП рдПрдХ рд░рд╛рд╕реНрддрд╛ рдЬреЛрдбрд╝рдирд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдПрдХ рдмрдирд╛рд╡рдЯ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╣реЗрдХреНрд╕рд╛рдЧреЛрдирд▓ рд░реВрдкрд░реЗрдЦрд╛ рд╣реИред  <a href="">рдпрд╣рд╛рдВ</a> рдЖрдк рдЗрд╕ рддрд░рд╣ рдХреА рдмрдирд╛рд╡рдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рд╖рдЯреНрднреБрдЬ рдХреА рд╕рдлреЗрдж рд░реВрдкрд░реЗрдЦрд╛ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдкрд╛рд░рджрд░реНрд╢реА рд╣реИред  рдЗрд╕реЗ рд╕рдлреЗрдж рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, рднрд╡рд┐рд╖реНрдп рдореЗрдВ рд╣рдо рдЗрд╕реЗ рдЕрдкрдиреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдмрдирд╛ рдкрд╛рдПрдВрдЧреЗред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0j/4u/vs/0j4uvsbyjtxiavcwaajn73csp68.png"></div><br>  <i>рдХрд╛рд▓реА рдкреГрд╖реНрдарднреВрдорд┐ рдкрд░ рд╕реЗрд▓ рдХреА рд░реВрдкрд░реЗрдЦрд╛</i> <br><br>  рдмрдирд╛рд╡рдЯ рдХреЛ рдЖрдпрд╛рдд рдХрд░реЗрдВ рдФрд░ рдЗрд╕рдХреЗ <em>рдмрдирд╛рд╡рдЯ рдкреНрд░рдХрд╛рд░</em> рдХреЛ <em>рд╕реНрдкреНрд░рд╛рдЗрдЯ рдкрд░</em> рд╕реЗрдЯ рдХрд░реЗрдВред  рдЙрд╕рдХрд╛ <em>рд╕реНрдкреНрд░рд╛рдЗрдЯ рдореЛрдб</em> рдбрд┐рдлреЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде <em>рд╕рд┐рдВрдЧрд▓ рдкрд░</em> рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдЪреВрдВрдХрд┐ рдпрд╣ рдПрдХ рдЕрд╕рд╛рдзрд╛рд░рдг рд╕рдлреЗрдж рдмрдирд╛рд╡рдЯ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ <em>sRGB рдореЗрдВ</em> рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЕрд▓реНрдлрд╛ рдЪреИрдирд▓ рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕рдХреНрд╖рдо <em>рдЕрд▓реНрдлрд╛ рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛ рд╣реИ</em> ред  рдореИрдВрдиреЗ <em>рдЯреНрд░рд┐рд▓рд┐рдирд┐рдпрд░</em> рдХреЛ <em>рдлрд╝рд┐рд▓реНрдЯрд░ рдореЛрдб</em> рдмрдирд╛рд╡рдЯ рднреА рд╕реЗрдЯ рдХрд┐рдпрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреНрдпрдерд╛ рд░рд╛рд╕реНрддреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдордЖрдИрдкреА рд╕рдВрдХреНрд░рдордг рдмрд╣реБрдд рдЕрдзрд┐рдХ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ebb/e4a/a88/ebbe4aa88f93b71cf5946c4c011339dc.png"></div><br>  <i>рдмрдирд╛рд╡рдЯ рдЖрдпрд╛рдд рд╡рд┐рдХрд▓реНрдк</i> <br><br><h3>  рдкреНрд░рддрд┐ рд╕реЗрд▓ рдПрдХ рд╕реНрдкреНрд░рд╛рдЗрдЯ </h3><br>  рд╕рдмрд╕реЗ рддреЗрдЬрд╝ рддрд░реАрдХрд╛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдореЛрдЪреНрдЪ рдЬреЛрдбрд╝рдирд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рд╕реНрд╡рдпрдВ рд╕реНрдкреНрд░рд╛рдЗрдЯ рдХреЛ рдЬреЛрдбрд╝рдирд╛ рд╣реИред  рдПрдХ рдирдпрд╛ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ, рдЗрд╕рдореЗрдВ рдЗрдореЗрдЬ рдХрдВрдкреЛрдиреЗрдВрдЯ ( <em>рдХрдВрдкреЛрдиреЗрдВрдЯ / рдпреВрдЖрдИ / рдЗрдореЗрдЬ</em> ) рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдЗрд╕реЗ рд╣рдорд╛рд░реЗ рдЖрдЙрдЯрд▓рд╛рдЗрди рд╕реНрдкреНрд░рд╛рдЗрдЯ рдХреЛ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВред  рдлрд┐рд░ <em>рд╣реЗрдХреНрд╕ рд╕реЗрд▓ рд▓реЗрдмрд▓</em> рдкреНрд░реАрдлреИрдм рдЙрджрд╛рд╣рд░рдг рдХреЛ рджреГрд╢реНрдп рдореЗрдВ рдбрд╛рд▓реЗрдВ, рд╕реНрдкреНрд░рд╛рдЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдЗрд╕рдХрд╛ рдПрдХ рдмрдЪреНрдЪрд╛ рдмрдирд╛рдПрдВ, рдкреНрд░реАрдлреИрдм рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдкреНрд░реАрдлреИрдм рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдПрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c2/7f6/7f4/5c27f67f4596673f5b2e73b2db5073cd.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5da/f7c/ea8/5daf7cea84e2ff46829460e0523bfa91.png"></div><br>  <i>Prefab рдмрд╛рд▓ рдЪрдпрди рддрддреНрд╡</i> <br><br>  рдЕрдм рдкреНрд░рддреНрдпреЗрдХ рдХреЛрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ рд╕реНрдкреНрд░рд╛рдЗрдЯ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реЛрдЧрд╛ред  рдЖрдХреГрддрд┐ рдХреЛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдХреЗрдВрджреНрд░реЛрдВ рд╕реЗ рдорд┐рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдкреНрд░рд╛рдЗрдЯ рдХреЗ рдкрд░рд┐рд╡рд░реНрддрди рдШрдЯрдХ рдХреА <em>рдЪреМрдбрд╝рд╛рдИ</em> рдФрд░ <em>рдКрдБрдЪрд╛рдИ</em> рдХреЛ 17 рддрдХ рдмрджрд▓ рджреЗрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc1/069/e42/bc1069e4216435f1a30af953af5b948a.png"></div><br>  <i>рдЪрдпрди рд░рд╛рд╣рдд рд╕реЗ рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╣реИ</i> <br><br><h3>  рд╕рдм рдХреБрдЫ рдХреЗ рдКрдкрд░ рдЖрд░реЗрдЦрдг </h3><br>  рдЪреВрдВрдХрд┐ рд╕рдореЛрдЪреНрдЪ рдХреЛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдХрд┐рдирд╛рд░реЛрдВ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдкрд░ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЕрдХреНрд╕рд░ рд░рд╛рд╣рдд рдХреА рдЬреНрдпрд╛рдорд┐рддрд┐ рдХреЗ рддрд╣рдд рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред  рдЗрд╕ рд╡рдЬрд╣ рд╕реЗ, рд╕рд░реНрдХрд┐рдЯ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рд╕реНрдкреНрд░рд╛рдЗрдЯреНрд╕ рдХреЛ рдереЛрдбрд╝рд╛ рдКрдкрд░ рдЙрдард╛рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдмреНрд░реЗрдХ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдирд╣реАрдВред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рд╣рдореЗрд╢рд╛ рдмрд╛рдХреА рд╕рднреА рдЪреАрдЬреЛрдВ рдХреЗ рдКрдкрд░ рд╕реНрдкреНрд░рд╛рдЗрдЯреНрд╕ рдЦреАрдВрдЪреЗрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд╕реНрдкреНрд░рд╛рдЗрдЯ рд╢реЗрдбрд░ рдмрдирд╛рдПрдВред  рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛ рдХрд┐ рдорд╛рдирдХ рдпреВрдирд┐рдЯреА рд╕реНрдкреНрд░рд╛рдЗрдЯ рд╢реИрдбрд░ рдХреА рдирдХрд▓ рдХрд░реЗрдВ рдФрд░ рдЙрд╕рдореЗрдВ рдХреБрдЫ рдмрджрд▓рд╛рд╡ рдХрд░реЗрдВред <br><br><pre><code class="hljs powershell">Shader <span class="hljs-string"><span class="hljs-string">"Custom/Highlight"</span></span> { Properties { <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">PerRendererData</span></span></span><span class="hljs-function">] _</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainTex</span></span></span></span> (<span class="hljs-string"><span class="hljs-string">"Sprite Texture"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} _Color (<span class="hljs-string"><span class="hljs-string">"Tint"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">MaterialToggle</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PixelSnap</span></span></span></span> (<span class="hljs-string"><span class="hljs-string">"Pixel snap"</span></span>, Float) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">HideInInspector</span></span></span><span class="hljs-function">] _</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RendererColor</span></span></span></span> (<span class="hljs-string"><span class="hljs-string">"RendererColor"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">HideInInspector</span></span></span><span class="hljs-function">] _</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Flip</span></span></span></span> (<span class="hljs-string"><span class="hljs-string">"Flip"</span></span>, Vector) = (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">PerRendererData</span></span></span><span class="hljs-function">] _</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AlphaTex</span></span></span></span> (<span class="hljs-string"><span class="hljs-string">"External Alpha"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>D) = <span class="hljs-string"><span class="hljs-string">"white"</span></span> {} <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">PerRendererData</span></span></span><span class="hljs-function">] _</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnableExternalAlpha</span></span></span></span> (<span class="hljs-string"><span class="hljs-string">"Enable External Alpha"</span></span>, Float) = <span class="hljs-number"><span class="hljs-number">0</span></span> } SubShader { Tags { <span class="hljs-string"><span class="hljs-string">"Queue"</span></span>=<span class="hljs-string"><span class="hljs-string">"Transparent"</span></span> <span class="hljs-string"><span class="hljs-string">"IgnoreProjector"</span></span>=<span class="hljs-string"><span class="hljs-string">"True"</span></span> <span class="hljs-string"><span class="hljs-string">"RenderType"</span></span>=<span class="hljs-string"><span class="hljs-string">"Transparent"</span></span> <span class="hljs-string"><span class="hljs-string">"PreviewType"</span></span>=<span class="hljs-string"><span class="hljs-string">"Plane"</span></span> <span class="hljs-string"><span class="hljs-string">"CanUseSpriteAtlas"</span></span>=<span class="hljs-string"><span class="hljs-string">"True"</span></span> } Cull Off ZWrite Off Blend One OneMinusSrcAlpha Pass { CGPROGRAM <span class="hljs-comment"><span class="hljs-comment">#pragma vertex SpriteVert #pragma fragment SpriteFrag #pragma target 2.0 #pragma multi_compile_instancing #pragma multi_compile _ PIXELSNAP_ON #pragma multi_compile _ ETC1_EXTERNAL_ALPHA #include "UnitySprites.cginc" ENDCG } } }</span></span></code> </pre> <br>  рдкрд╣рд▓рд╛ рдмрджрд▓рд╛рд╡ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдЧрд╣рд░рд╛рдИ рдмрдлрд░ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЬреЗрдб-рдЯреЗрд╕реНрдЯ рд╣рдореЗрд╢рд╛ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИред <br><br><pre> <code class="hljs pgsql"> ZWrite <span class="hljs-keyword"><span class="hljs-keyword">Off</span></span> ZTest <span class="hljs-keyword"><span class="hljs-keyword">Always</span></span></code> </pre> <br>  рджреВрд╕рд░рд╛ рдкрд░рд┐рд╡рд░реНрддрди рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдмрд╛рдХреА рдкрд╛рд░рджрд░реНрд╢реА рдЬреНрдпрд╛рдорд┐рддрд┐ рдХреЗ рдмрд╛рдж рдкреНрд░рддрд┐рдкрд╛рджрди рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛ рдХрддрд╛рд░ рдореЗрдВ 10 рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред <br><br><pre> <code class="hljs objectivec"> <span class="hljs-string"><span class="hljs-string">"Queue"</span></span>=<span class="hljs-string"><span class="hljs-string">"Transparent+10"</span></span></code> </pre> <br>  рдПрдХ рдирдИ рд╕рд╛рдордЧреНрд░реА рдмрдирд╛рдПрдВ, рдЬрд┐рд╕реЗ рдпрд╣ рд╢реЗрдбрд░ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред  рд╣рдо рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рдиреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП, рдЗрд╕рдХреЗ рд╕рднреА рдЧреБрдгреЛрдВ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдлрд┐рд░ рд╕реНрдкреНрд░рд╛рдЗрдЯ рдкреНрд░реАрдлреИрдм рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/15b/d01/812/15bd01812d94f52ced67308dd000c430.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ef5/393/e24/ef5393e241252d81513a0ff5f8972b50.png"></div><br>  <i>рд╣рдо рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд╕реНрдкреНрд░рд╛рдЗрдЯ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ</i> <br><br>  рдЕрдм рдЪрдпрди рдХреА рд░реВрдкрд░реЗрдЦрд╛ рд╣рдореЗрд╢рд╛ рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИред  рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рд╕реЗрд▓ рдПрдХ рдЙрдЪреНрдЪ рд░рд╛рд╣рдд рдХреЗ рддрд╣рдд рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╣реИ, рддреЛ рднреА рдЗрд╕рдХреА рд░реВрдкрд░реЗрдЦрд╛ рд╕рдм рдХреБрдЫ рдХреЗ рдКрдкрд░ рдЦреАрдВрдЪреА рдЬрд╛рдПрдЧреАред  рдпрд╣ рд╕реБрдВрджрд░ рдирд╣реАрдВ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЪрдпрдирд┐рдд рдХреЛрд╢рд┐рдХрд╛рдПрдВ рд╣рдореЗрд╢рд╛ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреА, рдЬреЛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce2/8bc/418/ce28bc418dc0ec116cff1bcbaddf0363.png"></div><br>  <i>рдЧрд╣рд░рд╛рдИ рдмрдлрд░ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░реЗрдВ</i> <br><br><h3>  рдЪрдпрди рдирд┐рдпрдВрддреНрд░рдг </h3><br>  рд╣рдо рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рдХрд┐ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╢реБрд░реВ рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕рднреА рдХреЛ рдЕрдЪрдпрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╣рдо рдЗрд╕реЗ <em>рд╣рд╛рдЗрд▓рд╛рдЗрдЯ</em> рдкреНрд░реАрдлрд╝реИрдм рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдЫрд╡рд┐ рдШрдЯрдХ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82f/00e/164/82f00e164316900fb9d9694030298bcc.png"></div><br>  <i>рдЕрдХреНрд╖рдо рдЫрд╡рд┐ рдШрдЯрдХ</i> <br><br>  рд╕реЗрд▓ рдЪрдпрди рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>HexCell</code> рдореЗрдВ <code>HexCell</code> рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕реЗ рдЕрдкрдиреЗ <code>uiRect</code> рдХреЗ рдПрдХрдорд╛рддреНрд░ рдмрдЪреНрдЪреЗ рдХреЛ рд▓реЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕рдХреЗ рдЫрд╡рд┐ рдШрдЯрдХ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╣рдо <code>DisableHighlight</code> рдореЗрдердб рднреА рдмрдирд╛рдПрдВрдЧреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DisableHighlight</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Image highlight = uiRect.GetChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).GetComponent&lt;Image&gt;(); highlight.enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnableHighlight</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Image highlight = uiRect.GetChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).GetComponent&lt;Image&gt;(); highlight.enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  рдЕрдВрдд рдореЗрдВ, рд╣рдо рд░рдВрдЧ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЬрдм рдЪрд╛рд▓реВ рд╣реЛ, рддреЛ рдмреИрдХрд▓рд╛рдЗрдЯ рдХреЛ рдПрдХ рд╣реНрдпреВ рджреЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnableHighlight</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Color color</span></span></span><span class="hljs-function">)</span></span> { Image highlight = uiRect.GetChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).GetComponent&lt;Image&gt;(); highlight.color = color; highlight.enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">unitypackage</a> <br><br><h2>  рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВ </h2><br>  рдЕрдм рдЬрдм рд╣рдо рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдФрд░ рджреЛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЙрдирдХреЗ рдмреАрдЪ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬреЗрдВред  рдкрд╣рд▓реЗ рд╣рдореЗрдВ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдлрд┐рд░ рдЦреЛрдЬ рдХреЛ рдЙрдирдХреЗ рдмреАрдЪ рдПрдХ рдкрде рддрдХ рд╕реАрдорд┐рдд рд░рдЦреЗрдВ, рдФрд░ рдЕрдВрдд рдореЗрдВ рдЗрд╕ рдкрде рдХреЛ рджрд┐рдЦрд╛рдПрдВред <br><br><h3>  рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░реЗрдВ </h3><br>  рд╣рдореЗрдВ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЦреЛрдЬ рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рдмрд┐рдВрджреБред  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЦреЛрдЬ рд╕реЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдорд╛рдЙрд╕ рдХреЛ рдХреНрд▓рд┐рдХ рдХрд░рддреЗ рд╕рдордп рдмрд╛рдИрдВ Shift рдХреБрдВрдЬреА рджрдмрд╛рдП рд░рдЦреЗрдВред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕реЗрд▓ рдХреЛ рдиреАрд▓реЗ рд░рдВрдЧ рдореЗрдВ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╣рдореЗрдВ рдЖрдЧреЗ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╕реЗрд▓ рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рд╕рд╣реЗрдЬрдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬрдм рдПрдХ рдирдпрд╛ рд╢реБрд░реБрдЖрддреА рд╕реЗрд▓ рдЪреБрдирддреЗ рд╣реИрдВ, рддреЛ рдкреБрд░рд╛рдиреЗ рдХрд╛ рдЪрдпрди рдЕрдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ <code>HexMapEditor</code> рдлрд╝реАрд▓реНрдб рдлрд╝реАрд▓реНрдбред <br><br><pre> <code class="cs hljs"> HexCell previousCell, searchFromCell;</code> </pre> <br>  <code>HandleInput</code> рдЕрдВрджрд░ <code>HandleInput</code> рд╣рдо Shift рдХреБрдВрдЬреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>Input.GetKey(KeyCode.LeftShift)</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (editMode) { EditCells(currentCell); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftShift)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell) { searchFromCell.DisableHighlight(); } searchFromCell = currentCell; searchFromCell.EnableHighlight(Color.blue); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { hexGrid.FindDistancesTo(currentCell); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d50/a63/1c3/d50a631c3f4701e414b2e9a9078a57a2.png"></div><br>  <i>рдЬрд╣рд╛рдВ рджреЗрдЦреЛ</i> <br><br><h3>  рдЦреЛрдЬ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ </h3><br>  рдПрдХ рд╕реЗрд▓ рдореЗрдВ рд╕рднреА рджреВрд░рд┐рдпреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдЕрдм рджреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рддрд▓рд╛рд╢ рд░рд╣реЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, <code>HexGrid.FindDistancesTo</code> рдХрд╛ рдирд╛рдо рдмрджрд▓рдХрд░ <code>HexGrid.FindDistancesTo</code> рдХрд░ <code>HexGrid.FindPath</code> рдФрд░ рдЗрд╕реЗ рджреВрд╕рд░рд╛ <code>HexCell</code> рдкреИрд░рд╛рдореАрдЯрд░ рджреЗрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, <code>Search</code> рд╡рд┐рдзрд┐ рдХреЛ рдмрджрд▓реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell</span></span></span><span class="hljs-function">)</span></span> { StopAllCoroutines(); StartCoroutine(Search(fromCell, toCell)); } <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].Distance = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; } WaitForSeconds delay = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WaitForSeconds(<span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">60f</span></span>); List&lt;HexCell&gt; frontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;HexCell&gt;(); fromCell.Distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; frontier.Add(fromCell); тАж }</code> </pre> <br>  рдЕрдм <code>HexMapEditor.HandleInput</code> рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, <code>searchFromCell</code> рдФрд░ <code>currentCell</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдХреЗрд╡рд▓ рддрднреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╣рдо рдпрд╣ рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рд╕ рд╕реЗрд▓ рд╕реЗ рдЦреЛрдЬ рдХреА рдЬрд╛рдПред  рдФрд░ рдЕрдЧрд░ рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рдЕрдВрдХ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ рддреЛ рд╣рдореЗрдВ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рдЬрд╣рдордд рдирд╣реАрдВ рдЙрдард╛рдиреА рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (editMode) { EditCells(currentCell); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftShift)) { тАж } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell &amp;&amp; searchFromCell != currentCell) { hexGrid.FindPath(searchFromCell, currentCell); }</code> </pre> <br>  рдЦреЛрдЬ рдХреА рдУрд░ рдореБрдбрд╝рддреЗ рд╣реБрдП, рд╣рдореЗрдВ рдкрд╣рд▓реЗ рд╕рднреА рдкрд┐рдЫрд▓реЗ рдЪрдпрдиреЛрдВ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕рд▓рд┐рдП, рдЬрдм рджреВрд░реА рдХреЛ рд░реАрд╕реЗрдЯ рдХрд┐рдпрд╛ <code>HexGrid.Search</code> рддреЛ <code>HexGrid.Search</code> рдХреЛ рдмрдВрдж рдХрд░ <code>HexGrid.Search</code> ред  рдЪреВрдВрдХрд┐ рдпрд╣ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рдХреА рд░реЛрд╢рдиреА рдХреЛ рднреА рдмрдВрдж рдХрд░ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЪрд╛рд▓реВ рдХрд░реЗрдВред  рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╣рдо рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреЛ рднреА рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЪрд▓реЛ рдЙрд╕реЗ рд▓рд╛рд▓ рдХрд░реЛред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].Distance = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; cells[i].DisableHighlight(); } fromCell.EnableHighlight(Color.blue); toCell.EnableHighlight(Color.red); тАж }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/181/01c/5e5/18101c5e578322ea99598cbca70f60a9.png"></div><br>  <i>рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдкрде рдХреЗ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ</i> <br><br><h3>  рдЦреЛрдЬ рд╕реАрдорд┐рдд рдХрд░реЗрдВ </h3><br>  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рд╣рдорд╛рд░рд╛ рдЦреЛрдЬ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЕрднреА рднреА рдЙрди рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╢реБрд░реБрдЖрддреА рд╕реЗрд▓ рд╕реЗ рдкрд╣реБрдВрдЪ рдпреЛрдЧреНрдп рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЕрдм рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЬреИрд╕реЗ рд╣реА рд╣рдо рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдХреЛ рдЕрдВрддрд┐рдо рджреВрд░реА рдкрд╛рддреЗ рд╣реИрдВ, рд╣рдо рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣реА рд╣реИ, рдЬрдм рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдкрд░рд┐рдорд┐рдд рд╣реИ, рд╣рдо рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд▓реВрдк рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (frontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> delay; HexCell current = frontier[<span class="hljs-number"><span class="hljs-number">0</span></span>]; frontier.RemoveAt(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == toCell) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { тАж } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/424/6e0/d49/4246e0d491a1938dfb1e9b3a00080e42.png"></div><br>  <i>рдЕрдВрдд рдмрд┐рдВрджреБ рдкрд░ рд░реБрдХреЗрдВ</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдпрджрд┐ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ?</b> <div class="spoiler_text">  рддрдм рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛рдо рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рд╕рднреА рдкрд╣реБрдВрдЪ рдпреЛрдЧреНрдп рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рди рдЦреЛрдЬ рд▓реЗред  рд╕рдордп рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рдХрд▓рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗ рдмрд┐рдирд╛, рдпрд╣ рдкреБрд░рд╛рдиреЗ <code>FindDistancesTo</code> рд╡рд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </div></div><br><h3>  рдкрде рдкреНрд░рджрд░реНрд╢рди </h3><br>  рд╣рдо рдкрде рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрде рдХреНрдпрд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╣ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХреИрд╕реЗ рдкрд╣реБрдВрдЪрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣ рдХреИрд╕реЗ рдХрд░реЗрдВ? <br><br>  рд╕реАрдорд╛ рдкрд░ рдПрдХ рд╕реЗрд▓ рдЬреЛрдбрд╝рддреЗ рд╕рдордп, рд╣рдо рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХрд╛ рдкрдбрд╝реЛрд╕реА рд╣реИред  рдПрдХ рдЕрдкрд╡рд╛рдж рд╢реБрд░реБрдЖрддреА рд╕реЗрд▓ рд╣реИред  рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреНрдп рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЧрдпрд╛ рд╣реИред  рдпрджрд┐ рд╣рдо рдЗрд╕ рдмрд╛рдд рдкрд░ рдирдЬрд╝рд░ рд░рдЦрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХрд┐рд╕ рд╕реЗрд▓ рд╕реЗ рдкрд╣реБрдБрдЪрд╛ рдерд╛, рддреЛ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣рдореЗрдВ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдорд┐рд▓рддрд╛ рд╣реИред  рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рдПрдХ рдкреЗрдбрд╝ рдЬреИрд╕рд╛ рдиреЗрдЯрд╡рд░реНрдХ, рдЬрд┐рд╕рдХреА рдЬрдбрд╝ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдмрд┐рдВрджреБ рд╣реИред  рд╣рдо рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж рдкрде рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a71/331/153/a713311534e05f46c6fd22a632100494.png"></div><br>  <i>рдХреЗрдВрджреНрд░ рдореЗрдВ рдкрдереЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЯреНрд░реА рдиреЗрдЯрд╡рд░реНрдХ</i> <br><br>  рд╣рдо <code>HexCell</code> рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕реЗрд▓ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдЬреЛрдбрд╝рдХрд░ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдореЗрдВ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдХреНрд░рдордмрджреНрдз рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell PathFrom { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br>  <code>HexGrid.Search</code> рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╕рдордп рдкрдбрд╝реЛрд╕реА рдХреЗ <code>PathFrom</code> рдорд╛рди рдХреЛ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрдВ рдкрдбрд╝реЛрд╕реА рд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рдкрд░ рдЗрд╕ рд▓рд┐рдВрдХ рдХреЛ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.Distance == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { neighbor.Distance = distance; neighbor.PathFrom = current; frontier.Add(neighbor); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distance &lt; neighbor.Distance) { neighbor.Distance = distance; neighbor.PathFrom = current; }</code> </pre> <br>  рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЗрди рд▓рд┐рдВрдХ рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рдореЗрдВ рд╡рд╛рдкрд╕ рд▓рд╛рдХрд░ рдкрде рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == toCell) { current = current.PathFrom; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current != fromCell) { current.EnableHighlight(Color.white); current = current.PathFrom; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f89/9cc/8de/f899cc8de04e0c5666a2a05558b28042.png"></div><br>  <i>рдкрде рдорд┐рд▓ рдЧрдпрд╛</i> <br><br>  рдпрд╣ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдЕрдХреНрд╕рд░ рдХрдИ рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рд╣реЛрддреЗ рд╣реИрдВред  рдЬреЛ рдкрд╛рдпрд╛ рдЧрдпрд╛ рд╡рд╣ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреНрд░рдо рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  рдХреБрдЫ рд░рд╛рд╕реНрддреЗ рдЕрдЪреНрдЫреЗ рджрд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рджреВрд╕рд░реЗ рдмреБрд░реЗред  рд╣рдо рдмрд╛рдж рдореЗрдВ рдЗрд╕ рдкрд░ рд╡рд╛рдкрд╕ рдЖрдПрдВрдЧреЗред <br><br><h3>  рдЦреЛрдЬ рдХреА рд╢реБрд░реБрдЖрдд рдмрджрд▓реЗрдВ </h3><br>  рдкреНрд░рд╛рд░рдВрдн рдмрд┐рдВрджреБ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреЛ рдмрджрд▓рдиреЗ рд╕реЗ рдПрдХ рдирдИ рдЦреЛрдЬ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧреАред  рдПрдХ рд╣реА рдЪреАрдЬ рддрдм рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП рдЬрдм рдПрдХ рдирдпрд╛ рд╢реБрд░реБрдЖрддреА рд╕реЗрд▓ рдЪреБрдирдирд╛ рд╣реЛред  рдпрд╣ рд╕рдВрднрд╡ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <code>HexMapEditor</code> рдХреЛ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рднреА рдпрд╛рдж рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="cs hljs"> HexCell previousCell, searchFromCell, searchToCell;</code> </pre> <br>  рдЗрд╕ рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдПрдХ рдирдИ рдЦреЛрдЬ рдХреА рд╢реБрд░реБрдЖрдд рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftShift)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell) { searchFromCell.DisableHighlight(); } searchFromCell = currentCell; searchFromCell.EnableHighlight(Color.blue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchToCell) { hexGrid.FindPath(searchFromCell, searchToCell); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell &amp;&amp; searchFromCell != currentCell) { searchToCell = currentCell; hexGrid.FindPath(searchFromCell, searchToCell); }</code> </pre> <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрдВ рд╕рдорд╛рди рд╢реБрд░реБрдЖрдд рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рдмрд┐рдВрджреБрдУрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (editMode) { EditCells(currentCell); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( Input.GetKey(KeyCode.LeftShift) &amp;&amp; searchToCell != currentCell ) { тАж }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">unitypackage</a> <br><br><h2>  рд╣реЛрд╢рд┐рдпрд╛рд░ рдЦреЛрдЬ </h2><br>  рдпрджреНрдпрдкрд┐ рд╣рдорд╛рд░рд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рд╕рдордп рдмрд┐рддрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЗрд╕ рдмрд┐рдВрджреБ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд╣реАрдВ рдмрдиреЗрдЧрд╛ред  рдХрдо рд╕реЗ рдХрдо рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рд╕реНрдкрд╖реНрдЯ рд╣реИред  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рдиреАрдЪреЗ рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рджрд┐рд╢рд╛рдУрдВ рдореЗрдВ рдЦреЛрдЬ рдЕрд░реНрдерд╣реАрди рд╣реЛрдЧреАред  рд╡рд╣ рд╕рдбрд╝рдХреЛрдВ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рдирд╛ рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рд╡реЗ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рд╕реЗ рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛ рдореЗрдВ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред  рдХреНрдпрд╛ рдЦреЛрдЬ рдХреЛ рдЕрдзрд┐рдХ рд╕реНрдорд╛рд░реНрдЯ рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ? <br><br>  рдлрд┐рд▓рд╣рд╛рд▓, рдЬрдм рд╕реЗрд▓ рдХреЛ рдЖрдЧреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рд╕реЗрд▓ рд╕реЗ рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреЗрд╡рд▓ рджреВрд░реА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред  рдпрджрд┐ рд╣рдо рдЕрдзрд┐рдХ рд╕реНрдорд╛рд░реНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреА рджреВрд░реА рдкрд░ рднреА рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд╣рдо рдЙрд╕реЗ рдЕрднреА рддрдХ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╣рдо рд╢реЗрд╖ рджреВрд░реА рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рд╕реЗрд▓ рдореЗрдВ рджреВрд░реА рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЕрдиреБрдорд╛рди рдХреЛ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рд╣рдореЗрдВ рдЗрд╕ рд╕реЗрд▓ рд╕реЗ рдЧреБрдЬрд░рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рд░реНрдЧ рдХреА рдХреБрд▓ рд▓рдВрдмрд╛рдИ рдХреА рд╕рдордЭ рдорд┐рд▓рддреА рд╣реИред  рддрдм рд╣рдо рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реЗрд▓ рдЦреЛрдЬреЛрдВ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h3>  рдЦреЛрдЬ рдХреЗ рдЖрдВрдХрдбрд╝реЗ </h3><br>  рдЬрдм рд╣рдо рдмрд┐рд▓реНрдХреБрд▓ рдЬреНрдЮрд╛рдд рдбреЗрдЯрд╛ рдХреЗ рдмрдЬрд╛рдп рдЕрдиреБрдорд╛рди рдпрд╛ рдЕрдиреБрдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕реЗ рдЦреЛрдЬ рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдЕрдиреБрдорд╛рдиреА рдмрд╛рдИрдВ рджреВрд░реА рдХреЗ рд╕рд░реНрд╡реЛрддреНрддрдо рдЕрдиреБрдорд╛рди рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред  рд╣рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХреЗ рд▓рд┐рдП рдпрд╣ рдорд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рд╣рдо рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ <code>HexCell</code> рдкреВрд░реНрдгрд╛рдВрдХ рдЧреБрдг <code>HexCell</code> ред  рд╣рдореЗрдВ рдЗрд╕реЗ рдХреНрд░рдордмрджреНрдз рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ рдФрд░ рдорд╛рдирдХ рд╕рдВрдкрддреНрддрд┐ рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧреАред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SearchHeuristic { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br>  рд╣рдо рд╢реЗрд╖ рджреВрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдзрд╛рд░рдгрд╛ рдХреИрд╕реЗ рдмрдирд╛рддреЗ рд╣реИрдВ?  рд╕рдмрд╕реЗ рдЖрджрд░реНрд╢ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╕рдбрд╝рдХ рд╣реЛрдЧреА рдЬреЛ рд╕реАрдзреЗ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдЬрд╛рдПрдЧреАред  рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рдпрд╣ рджреВрд░реА рдЗрд╕ рд╕реЗрд▓ рдФрд░ рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреЗ рдмреАрдЪ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рджреВрд░реА рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред  рдЖрдЗрдП, рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рддреЗ рд╣реИрдВред <br><br>  рдЪреВрдВрдХрд┐ рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░ рдкрд╣рд▓реЗ рдХреА рдЧрдИ рдпрд╛рддреНрд░рд╛ рдкрде рдкрд░ рдирд┐рд░реНрднрд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдЦреЛрдЬ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╕реНрдерд┐рд░ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ рдЗрд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрдм <code>HexGrid.Search</code> рдмреЙрд░реНрдбрд░ рдкрд░ рдПрдХ рд╕реЗрд▓ рдЬреЛрдбрд╝рддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.Distance == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { neighbor.Distance = distance; neighbor.PathFrom = current; neighbor.SearchHeuristic = neighbor.coordinates.DistanceTo(toCell.coordinates); frontier.Add(neighbor); }</code> </pre> <br><h3>  рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдЦреЛрдЬреЗрдВ </h3><br>  рдЕрдм рд╕реЗ, рд╣рдо рд╕реЗрд▓ рдХреА рджреВрд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЦреЛрдЬ рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░реЗрдВрдЧреЗ рдФрд░ рд╕рд╛рде рд╣реА рдЗрд╕рдХреЗ рдЖрдВрдХрдбрд╝реЗ рднреАред  <code>HexCell</code> рдореЗрдВ рдЗрд╕ рдорд╛рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдкрддреНрддрд┐ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SearchPriority { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distance + SearchHeuristic; } }</code> </pre> <br>  рдЗрд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>HexGrid.Search</code> рддрд╛рдХрд┐ рдпрд╣ рдЗрд╕ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реАрдорд╛ рдХреЛ рдЫрд╛рдБрдЯрдиреЗ рдореЗрдВ рдХрд░реЗред <br><br><pre> <code class="cs hljs"> frontier.Sort( (x, y) =&gt; x.SearchPriority.CompareTo(y.SearchPriority) );</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b58/a22/c9a/b58a22c9a65a2088309a46c6cbc2d102.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b44/0a3/c0a/b440a3c0aa42dc771ba3a7a0948c835f.png"></div><br>  <i>рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рдмрд┐рдирд╛ рдФрд░ рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдЦреЛрдЬреЗрдВ</i> <br><br><h3>  рдорд╛рдиреНрдп рд╣реЗрдпреБрд░рд┐рд╕реНрдЯрд┐рдХ </h3><br>  рдирдИ рдЦреЛрдЬ рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдХрдо рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рджреМрд░рд╛ рдХрд░реЗрдВрдЧреЗред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рд╕рдорд╛рди рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЕрднреА рднреА рдЙрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЧрд▓рдд рджрд┐рд╢рд╛ рдореЗрдВ рд╣реИрдВред  рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдкреНрд░рддреНрдпреЗрдХ рдЪрд╛рд▓ рдЪрд░рдг рдХреА рд▓рд╛рдЧрдд 5 рд╣реИрдВ, рдФрд░ рдкреНрд░рддрд┐ рдЪрд░рдг рд╣реЗрдпреБрд░рд┐рд╕реНрдЯрд┐рдХ рдХреЗрд╡рд▓ 1 рдЬреЛрдбрд╝рддрд╛ рд╣реИред рдЕрд░реНрдерд╛рдд, рд╣реЗрдпреБрд░рд┐рд╕реНрдЯрд┐рдХ рдХрд╛ рдкреНрд░рднрд╛рд╡ рдмрд╣реБрдд рдордЬрдмреВрдд рдирд╣реАрдВ рд╣реИред <br><br>  рдпрджрд┐ рд╕рднреА рдХрд╛рд░реНрдбреЛрдВ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХреА рд▓рд╛рдЧрдд рд╕рдорд╛рди рд╣реИ, рддреЛ рд╣рдо рд╣реЗрд░рд╛рд╕реНрдЯрд┐рдХ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рддреЗ рд╕рдордп рд╕рдорд╛рди рд▓рд╛рдЧрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╣реЗрдпреБрд░рд┐рд╕реНрдЯрд┐рдХ 5 рд╕реЗ рдЧреБрдгрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рд╕рдВрд╕рд╛рдзрд┐рдд рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрд╛рдлреА рдХрдо рдХрд░ рджреЗрдЧрд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a4/6c7/ac3/9a46c7ac3c0df63797bfda1f143f9409.png"></div><br>  <i>Heuristics ├Ч 5 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</i> <br><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ рдирдХреНрд╢реЗ рдореЗрдВ рд╕рдбрд╝рдХреЗрдВ рд╣реИрдВ, рддреЛ рд╣рдо рд╢реЗрд╖ рджреВрд░реА рдХреЛ рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдирддреАрдЬрддрди, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЧрд▓рддрд┐рдпрд╛рдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХ рд░рд╛рд╕реНрддрд╛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рдирд╣реАрдВ рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cd2/7bb/dc7/cd27bbdc7043804a8d2a21ac096a6409.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0af/017/2a2/0af0172a264285358f99b0ece93833a3.png"></div><br>  <i>рдУрд╡рд░рд░реЗрдЯреЗрдб рдФрд░ рдорд╛рдиреНрдп рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░</i> <br><br>  рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдорд┐рд▓ рдЧрдпрд╛ рд╣реИ, рд╣рдореЗрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рд╢реЗрд╖ рджреВрд░реА рдХреЛ рдХрднреА рднреА рдЕрдирджреЗрдЦрд╛ рди рдХрд░реЗрдВред  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рд╡реИрдз рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдореВрд╡рд┐рдВрдЧ рдХреА рдиреНрдпреВрдирддрдо рд▓рд╛рдЧрдд 1 рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдореЗрдВ рд╕рдорд╛рди рд▓рд╛рдЧрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреЛрдИ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред <br><br>  рдХрдбрд╝рд╛рдИ рд╕реЗ рдмреЛрд▓рддреЗ рд╣реБрдП, рдХрдо рд▓рд╛рдЧрдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдХрд╛рдлреА рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХреЗрд╡рд▓ рд╣реЗрдпреБрд░рд┐рд╕реНрдЯрд┐рдХ рдХрдордЬреЛрд░ рдмрдирд╛ рджреЗрдЧрд╛ред  рдиреНрдпреВрдирддрдо рд╕рдВрднрд╡ рд╣реЗрдпреБрд░рд┐рд╕реНрдЯрд┐рдХ рд╢реВрдиреНрдп рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рд╕рд┐рд░реНрдл рджрд┐рдХреНрдЬрд╕реНрдЯреНрд░рд╛ рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рджреЗрддрд╛ рд╣реИред  рдиреЙрдирдЬрд╝рд░реЛ рд╣реНрдпреВрд░рд┐рд╕реНрдЯрд┐рдХ рдХреЗ рд╕рд╛рде, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдП <sup>*</sup> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЙрдЪреНрдЪрд╛рд░рдг "рдП рд╕реНрдЯрд╛рд░")ред <br><br><div class="spoiler">  <b class="spoiler_title">рдЗрд╕реЗ A * рдХреНрдпреЛрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ?</b> <div class="spoiler_text">  рдиреАрдЬрд▓реНрд╕ рдирд┐рд▓реНрд╕рди рджреНрд╡рд╛рд░рд╛ рдкрд╣рд▓реЗ рджрд┐рдХреНрдХреНрд╕реНрдЯреНрд░рд╛ рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ рд╣реЗрдпреВрд░рд┐рд╕реНрдЯрд┐рдХреНрд╕ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдерд╛ред  рдЙрд╕рдиреЗ рдЕрдкрдиреЗ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдирд╛рдо A1 рд░рдЦрд╛ред  рдмрд░реНрдЯреНрд░рд╛рдо рд░рд╛рдлреЗрд▓ рдмрд╛рдж рдореЗрдВ рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рдЖрдпрд╛ рдЬрд┐рд╕реЗ рдЙрдиреНрд╣реЛрдВрдиреЗ A2 рдХрд╣рд╛ред  рддрдм рдкреАрдЯрд░ рд╣рд╛рд░реНрдЯ рдиреЗ рдпрд╣ рд╕рд╛рдмрд┐рдд рдХрд░ рджрд┐рдпрд╛ рдХрд┐ рдПрдХ рдЕрдЪреНрдЫрд╛ рд╣реЗрдпреВрд░рд┐рд╕реНрдЯрд┐рдХ рдП 2 рдЗрд╖реНрдЯрддрдо рд╣реИ, рдпрд╛рдиреА рдЗрд╕рд╕реЗ рдмреЗрд╣рддрд░ рдХреЛрдИ рд╕рдВрд╕реНрдХрд░рдг рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ред  рдЗрд╕рдиреЗ рдЙрд╕реЗ рдпрд╣ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдЙрд╕реЗ рд╕реБрдзрд╛рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдП 3 рдпрд╛ рдП 4 рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрдЧрд╛, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдП <sup>*</sup> рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ред  рддреЛ рд╣рд╛рдВ, рдП <sup>*</sup> рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИ рдЬреЛ рд╣рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдЙрддрдирд╛ рд╣реА рдЕрдЪреНрдЫрд╛ рд╣реИ рдЬрд┐рддрдирд╛ рдХрд┐ рдЗрд╕рдХрд╛ рдЕрдиреБрдорд╛рдиред </div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow">unitypackage</a> <br><br><h2>  рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрддрд╛рд░ </h2><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐ рдП <sup>* рдПрдХ</sup> рдЕрдЪреНрдЫрд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣реИ, рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЗрддрдирд╛ рдкреНрд░рднрд╛рд╡реА рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рд╕реАрдорд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдкрд░ рд╣рд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдкрд┐рдЫрд▓реЗ рднрд╛рдЧ рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдореЗрдВ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрддрд╛рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдорд╛рдирдХ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЖрдЗрдП рдЗрд╕реЗ рд╕реНрд╡рдпрдВ рдмрдирд╛рдПрдВред <br><br>  рд╣рдорд╛рд░реА рдмрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХрддрд╛рд░ рд╕реЗ рд╕реЗрдЯрд┐рдВрдЧ рдФрд░ рдмрд╣рд┐рд╖реНрдХрд░рдг рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рднреА рдХрддрд╛рд░ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд╕реЗрд▓ рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рд╣рдо рдЗрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ, рдЫрдБрдЯрд╛рдИ рдФрд░ рдЖрд╡рдВрдЯрд┐рдд рд╕реНрдореГрддрд┐ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХреЛ рдХрдо рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рд╕рд░рд▓ рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><h3>  рдЕрдкрдиреА рдЦреБрдж рдХреА рдХрддрд╛рд░ рдмрдирд╛рдПрдВ </h3><br>  рдЖрд╡рд╢реНрдпрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ <code>HexCellPriorityQueue</code> рд╡рд░реНрдЧ рдмрдирд╛рдПрдВред  рд╣рдо рдПрдХ рдХрддрд╛рд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░рд▓ рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдХрддрд╛рд░ рдХреЛ рд╕рд╛рдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдореЗрдВ <code>Clear</code> рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗ рддрд╛рдХрд┐ рдЗрд╕реЗ рдмрд╛рд░-рдмрд╛рд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexCellPriorityQueue</span></span> { List&lt;HexCell&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;HexCell&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Enqueue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dequeue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Change</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { list.Clear(); } }</code> </pre> <br>  рд╣рдо рд╕реЗрд▓ рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдУрдВ рдХреЛ рд╕реНрд╡рдпрдВ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВред  рдпрд╛рдиреА рдХрддрд╛рд░ рдореЗрдВ рд╕реЗрд▓ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрд╕рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рддрдп рдХрд░рдиреА рд╣реЛрдЧреАред  рд▓реЗрдХрд┐рди рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдкрд░рд┐рд╡рд░реНрддрди рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдпрд╣ рдЬрд╛рдирдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ рдХрд┐ рдкреБрд░рд╛рдиреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреНрдпрд╛ рдереАред  рддреЛ рдЪрд▓реЛ рдЗрд╕реЗ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ <code>Change</code> рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Change</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldPriority</span></span></span><span class="hljs-function">)</span></span> { }</code> </pre> <br>  рдпрд╣ рдЬрд╛рдирдирд╛ рднреА рдЙрдкрдпреЛрдЧреА рд╣реИ рдХрд┐ рдХрддрд╛рд░ рдореЗрдВ рдХрд┐рддрдиреА рдХреЛрд╢рд┐рдХрд╛рдПрдБ рд╣реИрдВ, рддреЛ рдЪрд▓рд┐рдП рдЗрд╕рдХреЗ рд▓рд┐рдП <code>Count</code> рдЧреБрдг рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред  рдмрд╕ рдЙрд╕реА рдлрд╝реАрд▓реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдо рд╕рдВрдмрдВрдзрд┐рдд рд╡реЗрддрди рд╡реГрджреНрдзрд┐ рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Count { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Enqueue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { count += <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dequeue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { count -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { list.Clear(); count = <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><h3>  рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ </h3><br>  рдЬрдм рд╕реЗрд▓ рдХреЛ рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкрд╣рд▓реЗ рд╕реВрдЪреА рдХреЗ рдПрдХ рд╕рд░рд▓ рд╕рд░рдгреА рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирддреЗ рд╣реБрдП, рдПрдХ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкрдиреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Enqueue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { count += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> priority = cell.SearchPriority; list[priority] = cell; }</code> </pre> <br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬрдм рд╕реВрдЪреА рдкрд░реНрдпрд╛рдкреНрдд рд▓рдВрдмреА рд╣реЛ, рдЕрдиреНрдпрдерд╛ рд╣рдо рд╕реАрдорд╛рдУрдВ рд╕реЗ рдкрд░реЗ рдЬрд╛рдПрдВрдЧреЗред  рдЬрдм рддрдХ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд▓рдВрдмрд╛рдИ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪ рдЬрд╛рддрд╛ рддрдм рддрдХ рдЖрдк рд╕реВрдЪреА рдореЗрдВ рдЦрд╛рд▓реА рдЖрдЗрдЯрдо рдЬреЛрдбрд╝рдХрд░ рдЗрд╕рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВред  рдпреЗ рдЦрд╛рд▓реА рддрддреНрд╡ рд╕реЗрд▓ рдХрд╛ рд╕рдВрджрд░реНрдн рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдк рд╕реВрдЪреА рдореЗрдВ <code>null</code> рдЬреЛрдбрд╝рдХрд░ рдЙрдиреНрд╣реЗрдВ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> priority = cell.SearchPriority; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (priority &gt;= list.Count) { list.Add(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); } list[priority] = cell;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e77/000/fec/e77000feca5c0bfdb769062356ca9935.png"></div><br>  <i>рдЫреЗрдж рдХреЗ рд╕рд╛рде рд╕реВрдЪреА</i> <br><br>  рд▓реЗрдХрд┐рди рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдкреНрд░рддрд┐ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗрд╡рд▓ рдПрдХ рд╕реЗрд▓ рдХреИрд╕реЗ рд╕реНрдЯреЛрд░ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдХрдИ рд╣реЛрдВрдЧреЗред  рдПрдХ рд╣реА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рд╕рд╛рде рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рджреВрд╕рд░реА рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдпрджреНрдпрдкрд┐ рд╣рдо рд╣рд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╕рд╛рде рдмрд╛рдВрдзрдиреЗ рдХреЗ рд▓рд┐рдП <code>HexCell</code> рдПрдХ рд╕рдВрдкрддреНрддрд┐ рднреА рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рд╣рдореЗрдВ рдПрдХ рд▓рд┐рдВрдХреНрдб рд╕реВрдЪреА рдирд╛рдордХ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell NextWithSamePriority { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br>  рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <code>HexCellPriorityQueue.Enqueue</code> рдХреЛ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЙрд╕реА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рд╕рд╛рде рд╡рд░реНрддрдорд╛рди рдореВрд▓реНрдп рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирдП рдЬреЛрдбрд╝реЗ рдЧрдП рд╕реЗрд▓ рдХреЛ рдордЬрдмреВрд░ рдХрд░реЗрдВред <br><br><pre> <code class="cs hljs"> cell.NextWithSamePriority = list[priority]; list[priority] = cell;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45b/082/87c/45b08287cf76c4636d7a673869aa39b5.png"></div><br>  <i>рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪрд┐рдпреЛрдВ рдХреА рд╕реВрдЪреА</i> <br><br><h3>  рдХрддрд╛рд░ рд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВ </h3><br>  рдПрдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрддрд╛рд░ рд╕реЗ рд╕реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╕рдмрд╕реЗ рдХрдо рдЧреИрд░-рдЦрд╛рд▓реА рд╕реВрдЪрдХрд╛рдВрдХ рдореЗрдВ рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪреА рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЬрдм рддрдХ рд╣рдо рдЗрд╕реЗ рдирд╣реАрдВ рдвреВрдВрдврддреЗ, рд╣рдо рдПрдХ рд▓реВрдк рдореЗрдВ рд╕реВрдЪреА рдореЗрдВ рдШреВрдореЗрдВрдЧреЗред  рдпрджрд┐ рд╣рдо рдирд╣реАрдВ рдкрд╛рддреЗ рд╣реИрдВ, рддреЛ рдХрддрд╛рд░ рдЦрд╛рд▓реА рд╣реИ рдФрд░ рд╣рдо <code>null</code> ред <br><br>  рдорд┐рд▓реА рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╕реЗ, рд╣рдо рдХрд┐рд╕реА рднреА рд╕реЗрд▓ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЗрди рд╕рднреА рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕рдорд╛рди рд╣реИред  рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдПрдХ рд╕реЗрд▓ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dequeue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { count -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; list.Count; i++) { HexCell cell = list[i]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  рд╢реЗрд╖ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдЧрд▓реА рд╕реЗрд▓ рдЙрд╕реА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреИрд╕реЗ рдирдИ рд╢реБрд░реБрдЖрддред  рдпрджрд┐ рдЗрд╕ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реНрддрд░ рдкрд░ рдХреЗрд╡рд▓ рдПрдХ рд╕реЗрд▓ рдерд╛, рддреЛ рддрддреНрд╡ <code>null</code> рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЗрд╕реЗ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { list[i] = cell.NextWithSamePriority; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell; }</code> </pre> <br><h3>  рдиреНрдпреВрдирддрдо рдЯреНрд░реИрдХрд┐рдВрдЧ </h3><br>  рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рдПрдХ рд╕реЗрд▓ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рд╕реВрдЪреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреБрдирд░рд╛рд╡реГрддреНрдд рд╣реЛрддрд╛ рд╣реИред  рд╣рдо рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдЧреИрд░-рд░рд┐рдХреНрдд рд╕реВрдЪрдХрд╛рдВрдХ рдХреЛ рдЦреЛрдЬрдиреЗ рд╕реЗ рдмрдЪ рдирд╣реАрдВ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд╣рд░ рдмрд╛рд░ рдЦрд░реЛрдВрдЪ рд╕реЗ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдиреНрдпреВрдирддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЛ рдЯреНрд░реИрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдиреНрдпреВрдирддрдо рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдЕрдирдВрдд рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> minimum = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { list.Clear(); count = <span class="hljs-number"><span class="hljs-number">0</span></span>; minimum = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; }</code> </pre> <br>  рдХрддрд╛рд░ рдореЗрдВ рдПрдХ рд╕реЗрд▓ рдЬреЛрдбрд╝рддреЗ рд╕рдордп, рд╣рдо рдЖрд╡рд╢реНрдпрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдиреНрдпреВрдирддрдо рдмрджрд▓рддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Enqueue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { count += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> priority = cell.SearchPriority; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (priority &lt; minimum) { minimum = priority; } тАж }</code> </pre> <br>  рдФрд░ рдЬрдм рдХрддрд╛рд░ рд╕реЗ рд╣рдЯрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗ рдХрдо рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдЦрд░реЛрдВрдЪ рд╕реЗ рд╢реБрд░реВ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dequeue</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { count -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; minimum &lt; list.Count; minimum++) { HexCell cell = list[minimum]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { list[minimum] = cell.NextWithSamePriority; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  рдпрд╣ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реВрдЪреА рдХреЗ рд▓реВрдк рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓реЗ рд╕рдордп рдХреЛ рдХрд╛рдлреА рдХрдо рдХрд░ рджреЗрддрд╛ рд╣реИред <br><br><h3>  рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдПрдБ рдмрджрд▓реЗрдВ </h3><br>  рд╕реЗрд▓ рдХреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЛ рдмрджрд▓рддреЗ рд╕рдордп, рдЗрд╕реЗ рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪреА рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдХрд╛ рдпрд╣ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рд╣рдо рдЗрд╕реЗ рдвреВрдВрдв рдирд╣реАрдВ рд▓реЗрддреЗред <br><br>  рдЖрдЗрдП рдпрд╣ рдШреЛрд╖рдгрд╛ рдХрд░рдХреЗ рд╢реБрд░реВ рдХрд░реЗрдВ рдХрд┐ рдкреБрд░рд╛рдиреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реВрдЪреА рдХрд╛ рдкреНрд░рдореБрдЦ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рд╣реЛрдЧрд╛, рдФрд░ рд╣рдо рдЕрдЧрд▓реА рд╕реЗрд▓ рдХреЛ рднреА рдЯреНрд░реИрдХ рдХрд░реЗрдВрдЧреЗред  рд╣рдо рддреБрд░рдВрдд рдЕрдЧрд▓реА рд╕реЗрд▓ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕ рд╕реВрдЪрдХрд╛рдВрдХ рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ рд╕реЗрд▓ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Change</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldPriority</span></span></span><span class="hljs-function">)</span></span> { HexCell current = list[oldPriority]; HexCell next = current.NextWithSamePriority; }</code> </pre> <br>  рдпрджрд┐ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдПрдХ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╕реЗрд▓ рд╣реИ, рддреЛ рдпрд╣ рд╣реЗрдб рд╕реЗрд▓ рд╣реИ рдФрд░ рд╣рдо рдЗрд╕реЗ рдХрд╛рдЯ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рд╣рдордиреЗ рдЗрд╕реЗ рдХрддрд╛рд░ рд╕реЗ рдмрд╛рд╣рд░ рдЦреАрдВрдЪ рд▓рд┐рдпрд╛ рдерд╛ред <br><br><pre> <code class="cs hljs"> HexCell current = list[oldPriority]; HexCell next = current.NextWithSamePriority; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == cell) { list[oldPriority] = next; }</code> </pre> <br>  рдпрджрд┐ рдпрд╣ рдорд╛рдорд▓рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рд╣рдореЗрдВ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рд╣рдо рдмрджрд▓реЗ рд╣реБрдП рд╕реЗрд▓ рдХреЗ рд╕рд╛рдордиреЗ рд╕реЗрд▓ рдореЗрдВ рди рд╣реЛрдВред  рдЗрд╕рдореЗрдВ рд╕реЗрд▓ рдХрд╛ рдПрдХ рд▓рд┐рдВрдХ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == cell) { list[oldPriority] = next; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (next != cell) { current = next; next = current.NextWithSamePriority; } }</code> </pre> <br>  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рд╣рдо рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪреА рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╕реЗрд▓ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕реЗ рд╕реНрдХрд┐рдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (next != cell) { current = next; next = current.NextWithSamePriority; } current.NextWithSamePriority = cell.NextWithSamePriority;</code> </pre> <br>  рд╕реЗрд▓ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдЕрдкрдиреА рдирдИ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреА рд╕реВрдЪреА рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Change</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldPriority</span></span></span><span class="hljs-function">)</span></span> { тАж Enqueue(cell); }</code> </pre> <br>  <code>Enqueue</code> рд╡рд┐рдзрд┐ рдХрд╛рдЙрдВрдЯрд░ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рдо рдПрдХ рдирдпрд╛ рд╕реЗрд▓ рдирд╣реАрдВ рдЬреЛрдбрд╝ рд░рд╣реЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рдЗрд╕рдХреА рднрд░рдкрд╛рдИ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдХрд╛рдЙрдВрдЯрд░ рдХреЛ рдХрдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="cs hljs"> Enqueue(cell); count -= <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br><h3>  рдХрддрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ </h3><br>  рдЕрдм рд╣рдо <code>HexGrid</code> рдкрд░ рдЕрдкрдиреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрддрд╛рд░ рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рдПрдХ рдПрдХрд▓ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рднреА рдЦреЛрдЬ рдЕрднрд┐рдпрд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреБрди: рдкреНрд░рдпреЛрдЬреНрдпред <br><br><pre> <code class="cs hljs"> HexCellPriorityQueue searchFrontier; тАж <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HexCellPriorityQueue(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { searchFrontier.Clear(); } тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реВрдк рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╡рд┐рдзрд┐ </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рдкрд╣рд▓реЗ рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП </font></font><code>fromCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрддрд╛рд░ рд╕реЗ рд╕реЗрд▓ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдкреБрд░рд╛рдиреЗ рдмреЙрд░реНрдбрд░ рдХреЛрдб рдХреА рдЬрдЧрд╣ рд▓реЗрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> WaitForSeconds delay = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WaitForSeconds(<span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">60f</span></span>); <span class="hljs-comment"><span class="hljs-comment">// List&lt;HexCell&gt; frontier = new List&lt;HexCell&gt;(); fromCell.Distance = 0; // frontier.Add(fromCell); searchFrontier.Enqueue(fromCell); while (searchFrontier.Count &gt; 0) { yield return delay; HexCell current = searchFrontier.Dequeue(); // frontier.RemoveAt(0); тАж }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб рдмрджрд▓реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдФрд░ рдкрдбрд╝реЛрд╕реА рдХреЛ рдмрджрд▓рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдмрджрд▓рд╛рд╡ рд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рдкреБрд░рд╛рдиреА рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЛ рдпрд╛рдж рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.Distance == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { neighbor.Distance = distance; neighbor.PathFrom = current; neighbor.SearchHeuristic = neighbor.coordinates.DistanceTo(toCell.coordinates); <span class="hljs-comment"><span class="hljs-comment">// frontier.Add(neighbor); searchFrontier.Enqueue(neighbor); } else if (distance &lt; neighbor.Distance) { int oldPriority = neighbor.SearchPriority; neighbor.Distance = distance; neighbor.PathFrom = current; searchFrontier.Change(neighbor, oldPriority); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╣рдореЗрдВ рдЕрдм рд╕реАрдорд╛ рдХреЛ рдЫрд╛рдБрдЯрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред </font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// frontier.Sort( // (x, y) =&gt; x.SearchPriority.CompareTo(y.SearchPriority) // );</span></span></code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрддрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрдЬ рдХрд░реЗрдВ</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдкрд╛рдпрд╛ рдЧрдпрд╛ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреНрд░рдо рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реА рдмрд╛рд░реА рдХреНрд░рдордмрджреНрдз рд╕реВрдЪреА рдХреЗ рдХреНрд░рдо рд╕реЗ рдЕрд▓рдЧ рдПрдХ рдЖрджреЗрд╢ рдмрдирд╛рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЕрдиреНрдп рддрд░реАрдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪреА рдХреЗ рдкреНрд░рдореБрдЦ рд╕реЗ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ рд╣рдЯрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╡реЗ рдХрддрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдвреЗрд░ рдХреА рддрд░рд╣ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рдЬреЛрдбрд╝реЗ рдЧрдП рд╕реЗрд▓ рдХреЛ рдкрд╣рд▓реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдПрдХ рдкрдХреНрд╖ рдкреНрд░рднрд╛рд╡ рдпрд╣ рд╣реИ рдХрд┐ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЬрд╝рд┐рдЧрдЬрд╝реИрдЧ рдкреНрд░рд╡рдг рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЬрд╝рд┐рдЧрдЬрд╝реИрдЧ рдкрде рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рднреА рдмрдврд╝ рдЬрд╛рддреА рд╣реИред </font><font style="vertical-align: inherit;">рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдРрд╕реЗ рд░рд╛рд╕реНрддреЗ рдЖрдорддреМрд░ рдкрд░ рдмреЗрд╣рддрд░ рджрд┐рдЦрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рджреБрд╖реНрдкреНрд░рднрд╛рд╡ рд╣рдорд╛рд░реЗ рдкрдХреНрд╖ рдореЗрдВ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b44/0a3/c0a/b440a3c0aa42dc771ba3a7a0948c835f.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/908/1e9/cc5/9081e9cc5b0ea1d6f4309b6221eab1ac.png"></div><br> <i><font style="vertical-align: inherit;"></font></i> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдПрдХрддрд╛ рдХреА </font></a><i><font style="vertical-align: inherit;">рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХреЗ рд╕рд╛рде рдХреНрд░рдордмрджреНрдз рд╕реВрдЪреА рдФрд░ рдХрддрд╛рд░</font></i></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднрд╛рдЧ 17: рд╕реАрдорд┐рдд рдЖрдВрджреЛрд▓рди </font></font></h1><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдЪрд░рдг-рджрд░-рдЪрд░рдг рдЖрдВрджреЛрд▓рди рдХреЗ рд▓рд┐рдП рддрд░реАрдХреЗ рдвреВрдВрдврддреЗ рд╣реИрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддреБрд░рдВрдд рдкрде рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдПрдХ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рдЦреЛрдЬ рдмрдирд╛рддреЗ рд╣реИрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдХреЗрд╡рд▓ рдкрде рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рд╣рд░рдХрдд рдХреЛ рдЧрддрд┐ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЦреЛрдЬ рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рддреЗрдЬ рдХрд░реЗрдВрдЧреЗред </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c4d/572/9cc/c4d5729ccbf9cc994b7c8328950e6f5b.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдИ рдЪрд╛рд▓реЛрдВ рд╕реЗ рдпрд╛рддреНрд░рд╛</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрджрдо рд╕реЗ рдХрджрдо рдЖрдВрджреЛрд▓рди </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реЗрдХреНрд╕рд╛рдЧреЛрди рдиреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд░рдгрдиреАрддрд┐ рдЦреЗрд▓ рд▓рдЧрднрдЧ рд╣рдореЗрд╢рд╛ рдмрд╛рд░реА-рдмрд╛рд░реА рд╕реЗ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╡рд╛рд▓реА рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рдПрдХ рд╕реАрдорд┐рдд рдЧрддрд┐ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдПрдХ рдореЛрдбрд╝ рдореЗрдВ рдпрд╛рддреНрд░рд╛ рдХреА рдЧрдИ рджреВрд░реА рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддреА рд╣реИред</font></font><br><br><h3>  рдЧрддрд┐ </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реАрдорд┐рдд рдЖрдВрджреЛрд▓рди рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо </font><font style="vertical-align: inherit;">рдкреВрд░реНрдгрд╛рдВрдХ рдкреИрд░рд╛рдореАрдЯрд░ </font></font><code>HexGrid.FindPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ рдЪрд╛рд▓ рдХреЗ рд▓рд┐рдП рдЧрддрд┐ рдХреА рд╕реАрдорд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред</font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"></font><code>speed</code><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { StopAllCoroutines(); StartCoroutine(Search(fromCell, toCell, speed)); } <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЗрд▓ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреА рдЗрдХрд╛рдЗрдпрд╛рдБ рд╡рд┐рднрд┐рдиреНрди рдЧрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдХреИрд╡рд▓рд░реА рддреЗрдЬ рд╣реИ, рдкреИрджрд▓ рд╕реЗрдирд╛ рдзреАрдореА рд╣реИ, рдФрд░ рдЗрд╕реА рддрд░рд╣ред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЕрднреА рддрдХ рдЗрдХрд╛рдЗрдпрд╛рдВ рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЕрдм рд╣рдо рдПрдХ рдирд┐рд░рдВрддрд░ рдЧрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЪрд▓реЛ 24 рдХрд╛ рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВред рдпрд╣ рдПрдХ рдХрд╛рдлреА рдмрдбрд╝рд╛ рдореВрд▓реНрдп рд╣реИ, 5 рд╕реЗ рд╡рд┐рднрд╛рдЬреНрдп рдирд╣реАрдВ (рдЪрд▓рддреА рдХреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд▓рд╛рдЧрдд)ред </font><font style="vertical-align: inherit;">рдирд┐рд░рдВрддрд░ рдЧрддрд┐ </font></font><code>FindPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗ </font><font style="vertical-align: inherit;">рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ </font></font><code>HexMapEditor.HandleInput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (editMode) { EditCells(currentCell); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( Input.GetKey(KeyCode.LeftShift) &amp;&amp; searchToCell != currentCell ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell) { searchFromCell.DisableHighlight(); } searchFromCell = currentCell; searchFromCell.EnableHighlight(Color.blue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchToCell) { hexGrid.FindPath(searchFromCell, searchToCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell &amp;&amp; searchFromCell != currentCell) { searchToCell = currentCell; hexGrid.FindPath(searchFromCell, searchToCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд╛рд▓ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЗ рдХреЗ рд╕рд╛рде рдЪрд▓рдиреЗ рдХреА рдХреБрд▓ рд▓рд╛рдЧрдд рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрдВ рдЕрдм рдпрд╣ рднреА рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЗрд╕рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреЗ рдХрджрдо рдЙрдард╛рдиреЗ рд╣реЛрдВрдЧреЗред рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдореЗрдВ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рдЗрд╕реЗ рдЧрддрд┐ рджреНрд╡рд╛рд░рд╛ рддрдп рдХреА рдЧрдИ рджреВрд░реА рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рдпреЗ рдкреВрд░реНрдгрд╛рдВрдХ рд╣реИрдВ, рд╣рдо рдкреВрд░реНрдгрд╛рдВрдХ рд╡рд┐рднрд╛рдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЕрд░реНрдерд╛рддреН, 24 рд╕реЗ рдЕрдзрд┐рдХ рдХреА рдХреБрд▓ рджреВрд░реА рдкрд╛рдареНрдпрдХреНрд░рдо рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реВрдк рдирд╣реАрдВ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рдкреВрд░реЗ рд░рд╛рд╕реНрддреЗ рдХреЛ рд╡рд░реНрддрдорд╛рди рдкрд╛рдареНрдпрдХреНрд░рдо рдореЗрдВ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ 30 рдХреА рджреВрд░реА рдкрд░ рд╣реИ, рддреЛ рдпрд╣ 1 рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрдХрд╛рдИ рдХреЛ рдЪрд╛рд▓реВ рдореЛрдбрд╝ рдореЗрдВ рдФрд░ рдЕрдЧрд▓реЗ рдореЛрдбрд╝ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдореЗрдВ рдЕрдкрдиреЗ рд╕рднреА рдЖрдВрджреЛрд▓рди рдХреЛ рдЦрд░реНрдЪ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд▓реЛ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдФрд░ рдЙрд╕рдХреЗ рд╕рднреА рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рдкрд╛рдареНрдпрдХреНрд░рдо рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рддреЗ рд╣реИрдВ</font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЗ рдкрд╛рдареНрдпрдХреНрд░рдо рдХреА рдЧрдгрдирд╛ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдкрдбрд╝реЛрд╕реА рдЪрдХреНрд░ рдореЗрдВ рдШреВрдордиреЗ рд╕реЗ рдареАрдХ рдкрд╣рд▓реЗред </font><font style="vertical-align: inherit;">рдЬреИрд╕реЗ рд╣реА рд╣рдо рдЙрд╕рд╕реЗ рджреВрд░реА рдкрд╛рддреЗ рд╣реИрдВ, рдкрдбрд╝реЛрд╕реА рдХреА рдЪрд╛рд▓ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> currentTurn = current.Distance / speed; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { тАж <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distance = current.Distance; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current.HasRoadThroughEdge(d)) { distance += <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current.Walled != neighbor.Walled) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { distance += edgeType == HexEdgeType.Flat ? <span class="hljs-number"><span class="hljs-number">5</span></span> : <span class="hljs-number"><span class="hljs-number">10</span></span>; distance += neighbor.UrbanLevel + neighbor.FarmLevel + neighbor.PlantLevel; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turn = distance / speed; тАж }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЦреЛрдпрд╛ рд╣реБрдЖ рдЖрдВрджреЛрд▓рди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдкрдбрд╝реЛрд╕реА рдХреА рдЪрд╛рд▓ рд╡рд░реНрддрдорд╛рди рдЪрд╛рд▓ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рд╣рдордиреЗ рдЪрд╛рд▓ рдХреА рд╕реАрдорд╛ рдХреЛ рдкрд╛рд░ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдкрдбрд╝реЛрд╕реА рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЖрдВрджреЛрд▓рди 1 рдерд╛, рддреЛ рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЕрдЧрд▓реА рд╕реЗрд▓ рдореЗрдВ рдЬрд╛рдирд╛ рдЕрдзрд┐рдХ рдорд╣рдВрдЧрд╛ рд╣реИ, рддреЛ рд╕рдм рдХреБрдЫ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдо рдПрдХ рд╕рдЬрд╛рддреАрдп рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВ, рдЕрд░реНрдерд╛рдд, рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдореЗрдВ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЖрдВрджреЛрд▓рди рдХреА 5 рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реА рдЧрддрд┐ 24 рд╣реИред рдЪрд╛рд░ рдЪрд░рдгреЛрдВ рдХреЗ рдмрд╛рдж, рд╣рдордиреЗ рдЕрдкрдиреЗ рд╕реНрдЯреЙрдХ рдХреА рдЖрд╡рд╛рдЬрд╛рд╣реА рд╕реЗ 20 рдЗрдХрд╛рдЗрдпрд╛рдБ рдЦрд░реНрдЪ рдХреАрдВ, рдФрд░ 4 рдмрдЪреЗ рд╣реИрдВред рдЕрдЧрд▓реЗ рдЪрд░рдг рдореЗрдВ, 5 рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рдлрд┐рд░ рд╕реЗ рдЬрд╝рд░реВрд░рдд рд╣реИ, рдпрд╛рдиреА рдЙрдкрд▓рдмреНрдз рд▓реЛрдЧреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕реНрддрд░ рдкрд░ рд╣рдореЗрдВ рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рджреЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИрдВред рдкрд╣рд▓реА рдЗрдХрд╛рдИ рдЪрд╛рд▓реВ рдореЛрдбрд╝ рдореЗрдВ рдкрд╛рдВрдЪрд╡реАрдВ рд╕реЗрд▓ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рднрд▓реЗ рд╣реА рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЖрдВрджреЛрд▓рди рди рд╣реЛред рджреВрд╕рд░рд╛ рд╡рд░реНрддрдорд╛рди рдЪрд╛рд▓ рдХреЗ рджреМрд░рд╛рди рдЖрдВрджреЛрд▓рди рдХреЛ рд░реЛрдХрдирд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд, рд╢реЗрд╖ рдЖрдВрджреЛрд▓рди рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡реЗ рдЦреЛ рдЬрд╛рдПрдВрдЧреЗред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдХрд▓реНрдк рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдЦреЗрд▓ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдкрд╣рд▓рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЙрди рдЦреЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЙрдкрдпреБрдХреНрдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рдЗрдХрд╛рдЗрдпрд╛рдБ рдкреНрд░рддрд┐ рдореЛрдбрд╝ рдкрд░ рдХреЗрд╡рд▓ рдХреБрдЫ рдХрджрдо рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреА рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рднреНрдпрддрд╛ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдЦреЗрд▓ рдХреЗ рд▓рд┐рдПред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЗрдХрд╛рдЗрдпрд╛рдБ рд╣рдореЗрд╢рд╛ рдХрдо рд╕реЗ рдХрдо рдПрдХ рд╕реЗрд▓ рдкреНрд░рддрд┐ рдореЛрдбрд╝ рдкрд░ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдпрджрд┐ рдЗрдХрд╛рдЗрдпрд╛рдБ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдХрдИ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдРрдЬ рдСрдл рд╡рдВрдбрд░реНрд╕ рдореЗрдВ рдпрд╛ рд╡реЗрд╕рдиреЙрде рдХреЗ рд▓рд┐рдП рд▓рдбрд╝рд╛рдИ рдореЗрдВ, рддреЛ рджреВрд╕рд░рд╛ рд╡рд┐рдХрд▓реНрдк рдмреЗрд╣рддрд░ рд╣реИред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдо рдЧрддрд┐ 24 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЪрд▓реЛ рджреВрд╕рд░рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЪреБрдиреЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╡рд░реНрддрдорд╛рди рджреВрд░реА рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдЧрд▓реА рд╕реЗрд▓ рдореЗрдВ рдЖрдиреЗ рдХреА рд▓рд╛рдЧрдд рдХреЛ рдЕрд▓рдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// int distance = current.Distance; int moveCost; if (current.HasRoadThroughEdge(d)) { moveCost = 1; } else if (current.Walled != neighbor.Walled) { continue; } else { moveCost = edgeType == HexEdgeType.Flat ? 5 : 10; moveCost += neighbor.UrbanLevel + neighbor.FarmLevel + neighbor.PlantLevel; } int distance = current.Distance + moveCost; int turn = distance / speed;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣рдо рдХрджрдо рдХреА рд╕реАрдорд╛ рдХреЛ рдкрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкрд╣рд▓реЗ рд╣рдо рд╡рд░реНрддрдорд╛рди рдЪрд╛рд▓ рдХреЗ рд╕рднреА рдЖрдВрджреЛрд▓рди рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдЧрддрд┐ рджреНрд╡рд╛рд░рд╛ рдЧрддрд┐ рдХреЛ рдЧреБрдгрд╛ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХреА рд▓рд╛рдЧрдд рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distance = current.Distance + moveCost; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turn = distance / speed; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (turn &gt; currentTurn) { distance = turn * speed + moveCost; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо 4 рдЕрдкреНрд░рдпреБрдХреНрдд рдЖрдВрджреЛрд▓рди рдмрд┐рдВрджреБрдУрдВ рдХреЗ рд╕рд╛рде рдЪреМрдереЗ рд╕реЗрд▓ рдореЗрдВ рдкрд╣рд▓рд╛ рдХрджрдо рдкреВрд░рд╛ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрди рдЦреЛ рдЧрдП рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдкрд╛рдВрдЪрд╡реЗрдВ рд╕реЗрд▓ рдХреА рд▓рд╛рдЧрддреЛрдВ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХреА рджреВрд░реА 29 рд╣реЛ рдЬрд╛рддреА рд╣реИ, 25 рдирд╣реАрдВред рдирддреАрдЬрддрди, рджреВрд░реА рдкрд╣рд▓реЗ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рдЬрд╛рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рджрд╕рд╡реЗрдВ рд╕реЗрд▓ рдХреА рджреВрд░реА 50 рдереАред рд▓реЗрдХрд┐рди рдЕрдм рдЗрд╕рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рджреЛ рдЪрд╛рд▓ рдХреА рд╕реАрдорд╛рдУрдВ рдХреЛ рдкрд╛рд░ рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рдЬрд┐рд╕рд╕реЗ 8 рдЧрддрд┐ рдмрд┐рдВрджреБ рдЦреЛрддреЗ рд╣реИрдВ, рдпрд╛рдиреА рдЕрдм рдпрд╣ рджреВрд░реА 58 рд╣реЛ рдЬрд╛рддреА рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff3/7f4/1f1/ff37f41f11c85f7f759367fd2b33334d.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкреЗрдХреНрд╖рд╛</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ </font><i><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ</font></i><font style="vertical-align: inherit;"> рдЕрдкреНрд░рдпреБрдХреНрдд рдЖрдВрджреЛрд▓рди рдХреЗ рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рджреВрд░реА рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╕рдордп рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рд╕рдВрднрд╡ рдХреЗ рд░реВрдк рдореЗрдВ рдХреБрдЫ рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдмрд░реНрдмрд╛рдж рдХрд░ рд░рд╣рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЧрддрд┐ рд╕реЗ, рд╣рдо рдЕрд▓рдЧ-рдЕрд▓рдЧ рд░рд╛рд╕реНрддреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреВрд░рд┐рдпреЛрдВ рдХреЗ рдмрдЬрд╛рдп рдЪрд╛рд▓ рджрд┐рдЦрд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рд╣рдо рдЦреЗрд▓ рдЦреЗрд▓рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рджреВрд░реА рдХреЗ рдореВрд▓реНрдпреЛрдВ рдореЗрдВ рдмрд╣реБрдд рд░реБрдЪрд┐ рдирд╣реАрдВ рд░рдЦрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЪрд╛рд▓реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рджреВрд░реА рдХреЗ рдмрдЬрд╛рдп, рдЪрд▓реЛ рдЪрд╛рд▓реЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, </font></font><code>UpdateDistanceLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрд╕рдХреЗ рдХреЙрд▓ </font><font style="vertical-align: inherit;">рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдПрдВ </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Distance { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distance; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { distance = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-comment"><span class="hljs-comment">// UpdateDistanceLabel(); } } тАж // void UpdateDistanceLabel () { // UnityEngine.UI.Text label = uiRect.GetComponent&lt;Text&gt;(); // label.text = distance == int.MaxValue ? "" : distance.ToString(); // }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗ </font></font><code>SetLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рдПрдХ рдордирдорд╛рдирд╛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetLabel</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> text</span></span></span><span class="hljs-function">)</span></span> { UnityEngine.UI.Text label = uiRect.GetComponent&lt;Text&gt;(); label.text = text; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдирдИ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ </font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдлрд╛рдИ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдЙрдиреНрд╣реЗрдВ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВ </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].Distance = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; cells[i].SetLabel(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); cells[i].DisableHighlight(); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд┐рд░ рд╣рдо рдкрдбрд╝реЛрд╕реА рдХреЗ рдЪрд┐рд╣реНрди рдХреЛ рдЙрд╕рдХреА рдЪрд╛рд▓ рдХрд╛ рдорд╛рди рдмрддрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдпрд╣ рджреЗрдЦрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ рдХрд┐ рдкреВрд░реЗ рд░рд╛рд╕реНрддреЗ рдореЗрдВ рдХрд┐рддрдиреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрджрдо рдЙрдард╛рдП рдЬрд╛рдПрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.Distance == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { neighbor.Distance = distance; neighbor.SetLabel(turn.ToString()); neighbor.PathFrom = current; neighbor.SearchHeuristic = neighbor.coordinates.DistanceTo(toCell.coordinates); searchFrontier.Enqueue(neighbor); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distance &lt; neighbor.Distance) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> oldPriority = neighbor.SearchPriority; neighbor.Distance = distance; neighbor.SetLabel(turn.ToString()); neighbor.PathFrom = current; searchFrontier.Change(neighbor, oldPriority); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0d4/6d6/97d/0d46d697d7c08be6d3381ce030541e4d.png"></div><br> <i><font style="vertical-align: inherit;"></font></i> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">рдПрдХрддрд╛ </font></a><i><font style="vertical-align: inherit;">рдкрде рдХреЗ рд╕рд╛рде рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЪрд╛рд▓реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛</font></i></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЭрдЯрдкрдЯ рд░рд╛рд╕реНрддреЗ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬрдм рд╣рдо рдЧреЗрдо рдЦреЗрд▓рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЗрд╕ рдмрд╛рдд рдХреА рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдкрде рдЦреЛрдЬ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреИрд╕реЗ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЕрдиреБрд░реЛрдзрд┐рдд рдорд╛рд░реНрдЧ рдХреЛ рддреБрд░рдВрдд рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдлрд┐рд▓рд╣рд╛рд▓, рд╣рдо рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЗрдП рд╣рдо рдЦреЛрдЬ рджреГрд╢реНрдп рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдПрдВред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрд┐рдирд╛ рдХреЛрд░рдЯреАрди рдХреЗ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдзреАрдореА рдЧрддрд┐ рд╕реЗ рдЧреБрдЬрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рдХреЛрд░реБрдЯрд┐рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдЕрдм рдРрд╕рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдХреЙрд▓ </font></font><code>StartCoroutine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>StopAllCoroutines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА рд╕реЗ </font><font style="vertical-align: inherit;">рдЫреБрдЯрдХрд╛рд░рд╛ рдорд┐рд▓ рдЬрд╛рдПрдЧрд╛ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдЗрд╕реЗ </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдирд┐рдпрдорд┐рдд рд╡рд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ </font><font style="vertical-align: inherit;">рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// StopAllCoroutines(); тАж } public void FindPath (HexCell fromCell, HexCell toCell, int speed) { // StopAllCoroutines(); // StartCoroutine(Search(fromCell, toCell, speed)); Search(fromCell, toCell, speed); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдо рдЕрдм рдЗрд╕реЗ </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рд░реВрдк рдореЗрдВ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдЙрдкрдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕ рдСрдкрд░реЗрдЯрд░ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд▓реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдШреЛрд╖рдгрд╛ рдХреЛ рднреА рд╣рдЯрд╛ рджреЗрдВрдЧреЗ </font></font><code>WaitForSeconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рд╡рд╛рдкрд╕реА рдХреЗ рддрд░реАрдХреЗ рдХреЛ рдмрджрд▓ </font><font style="vertical-align: inherit;">рджреЗрдВрдЧреЗ </font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { тАж <span class="hljs-comment"><span class="hljs-comment">// WaitForSeconds delay = new WaitForSeconds(1 / 60f); fromCell.Distance = 0; searchFrontier.Enqueue(fromCell); while (searchFrontier.Count &gt; 0) { // yield return delay; HexCell current = searchFrontier.Dequeue(); тАж } }</span></span></code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреБрд░рдВрдд рдкрд░рд┐рдгрд╛рдо</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдордп рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдЦреЛрдЬреЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рддреБрд░рдВрдд рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрдирдХреА рдЧрдгрдирд╛ рдХрд┐рддрдиреА рддреЗрдЬреА рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ? рдЫреЛрдЯреЗ рд░рд╛рд╕реНрддреЗ рд▓рдЧрднрдЧ рддреБрд░рдВрдд рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдмрдбрд╝реЗ рдорд╛рдирдЪрд┐рддреНрд░реЛрдВ рдкрд░ рд▓рдВрдмреЗ рд░рд╛рд╕реНрддреЗ рдереЛрдбрд╝реЗ рдзреАрдореЗ рд▓рдЧ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдЗрдП рдорд╛рдкреЗрдВ рдХрд┐ рдкрде рдХреЛ рдЦреЛрдЬрдиреЗ рдФрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред рд╣рдо рдЦреЛрдЬ рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░реЛрдлрд╛рдЗрд▓рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдереЛрдбрд╝рд╛ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд▓рд╛рдЧрдд рдкреИрджрд╛ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font></font><code>Stopwatch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ рдирд╛рдо рд╕реНрдерд╛рди рдореЗрдВ рд╣реИ </font></font><code>System.Diagnostics</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдЪреВрдВрдХрд┐ рд╣рдо рдЗрд╕реЗ рдХреЗрд╡рд▓ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдореИрдВ рдирд┐рд░реНрдорд╛рдг </font></font><code>using</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдирд╣реАрдВ рдЬреЛрдбрд╝реВрдВрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рд╕реЗ рдареАрдХ рдкрд╣рд▓реЗ, рдПрдХ рдирдИ рд╕реНрдЯреЙрдкрд╡реЙрдЪ рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВред рдЦреЛрдЬ рдкреВрд░реНрдг рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╕реНрдЯреЙрдкрд╡реЙрдЪ рдмрдВрдж рдХрд░реЗрдВ рдФрд░ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдмреАрддрд╛ рд╣реБрдЖ рд╕рдордп рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { System.Diagnostics.Stopwatch sw = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Diagnostics.Stopwatch(); sw.Start(); Search(fromCell, toCell, speed); sw.Stop(); Debug.Log(sw.ElapsedMilliseconds); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдЗрдП рд╣рдорд╛рд░реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдЪреБрдиреЗрдВ - рдПрдХ рдмрдбрд╝реЗ рдирдХреНрд╢реЗ рдХреЗ рдирд┐рдЪрд▓реЗ рджрд╛рдПрдВ рдХреЛрдиреЗ рдХреЗ рдирд┐рдЪрд▓реЗ рдмрд╛рдПрдВ рд╕реЗ рдПрдХ рдЦреЛрдЬред рд╕рднреА рдХрд╛ рд╕рдмрд╕реЗ рдмреБрд░рд╛ рдПрдХ рд╕рдорд╛рди рдирдХреНрд╢рд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рд╕рднреА 4,800 рдорд╛рдирдЪрд┐рддреНрд░ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce1/c03/524/ce1c0352479d7d8cddcff0b014291662.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЦреЛрдЬреЗрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП рдЦреЛрдЬрд╛ рдЧрдпрд╛ рд╕рдордп</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдПрдХрддрд╛ рд╕рдВрдкрд╛рджрдХ рдХреЗрд╡рд▓ рдЖрдкрдХреЗ рдорд╢реАрди рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рд╣реИред рдЗрд╕рд▓рд┐рдП рдФрд╕рдд рдЕрд╡рдзрд┐ рдХреА рд╕рдордЭ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдмрд╛рд░ рдЗрд╕рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВред рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЦреЛрдЬ рдореЗрдВ рд▓рдЧрднрдЧ 45 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рд▓рдЧрддреЗ рд╣реИрдВред рдпрд╣ рдмрд╣реБрдд рдЬреНрдпрд╛рджрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 22.22 рд░рд╛рд╕реНрддреЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ; рдЗрд╕реЗ 22 pps (рдкрде рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб) рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реВрдкрд┐рдд рдХрд░реЗрдВред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЗрд╕ рдкрде рдХреА рдЧрдгрдирд╛ рд╣реЛрдиреЗ рдкрд░ рдЙрд╕ рдлреНрд░реЗрдо рдореЗрдВ рдЧреЗрдо рдХреА рдлреНрд░реЗрдо рджрд░ рдЕрдзрд┐рдХрддрдо 22 рдПрдлрдкреАрдПрд╕ рддрдХ рдШрдЯ рдЬрд╛рдПрдЧреАред рдФрд░ рдпрд╣ рдмрд┐рдирд╛ рдЕрдиреНрдп рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗ рд╣реБрдП рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлреНрд░реЗрдо рдХреЛ рд╣реА рдкреНрд░рд╕реНрддреБрдд рдХрд░рдирд╛ред рдпрд╣реА рд╣реИ, рд╣рдо рдлреНрд░реЗрдо рджрд░ рдореЗрдВ рдХрд╛рдлреА рдмрдбрд╝реА рдХрдореА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ 20 рдПрдлрдкреАрдПрд╕ рддрдХ рдЧрд┐рд░ рдЬрд╛рдПрдЧрд╛ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп, рдЖрдкрдХреЛ рдпрд╣ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХрддрд╛ рд╕рдВрдкрд╛рджрдХ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рддреИрдпрд╛рд░ рдЖрд╡реЗрджрди рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдЬрд┐рддрдирд╛ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдореИрдВ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рдкрд░реАрдХреНрд╖рдг рдХрд░рддрд╛ рд╣реВрдВ, рддреЛ рдФрд╕рддрди рдпрд╣ рдХреЗрд╡рд▓ 15 рдПрдордПрд╕ рд▓рдЧреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╡рд╣ 66 рдкреАрдкреАрдПрд╕ рд╣реИ, рдЬреЛ рдмрд╣реБрдд рдмреЗрд╣рддрд░ рд╣реИред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рднреА, рдпрд╣ рдЕрднреА рднреА рдкреНрд░рддрд┐ рдлреНрд░реЗрдо рдЖрд╡рдВрдЯрд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдлреНрд░реЗрдо рджрд░ 60 рдПрдлрдкреАрдПрд╕ рд╕реЗ рдХрдо рд╣реЛ рдЬрд╛рдПрдЧреАред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЗ рд▓рд┐рдП рдбрд┐рдмрдЧ рд▓реЙрдЧ рдХрд╣рд╛рдВ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реВрдВ?</font></font></b> <div class="spoiler_text">  Unity     ,    .     .  ,       ,   Unity  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Log Files</a> . </div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рд╣реА рдЦреЛрдЬреЗрдВред </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдПрдХ рд╕рд░рд▓ рдЕрдиреБрдХреВрд▓рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ - рдХреЗрд╡рд▓ рддрднреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛред </font><font style="vertical-align: inherit;">рдЬрдмрдХрд┐ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдлреНрд░реЗрдо рдореЗрдВ рдПрдХ рдирдИ рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдорд╛рдЙрд╕ рдмрдЯрди рдиреАрдЪреЗ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЦреАрдВрдЪрдиреЗ рдФрд░ рдЫреЛрдбрд╝рдиреЗ рдкрд░ рдлреНрд░реЗрдо рджрд░ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рдХрдо рдХрд░рдХреЗ рдЖрдВрдХрд╛ рдЬрд╛рдПрдЧрд╛ред </font></font><code>HexMapEditor.HandleInput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдирдП рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо </font><font style="vertical-align: inherit;">рдПрдХ рдирдИ рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░рдХреЗ рдЗрд╕рд╕реЗ рдмрдЪ рд╕рдХрддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рд╡рд░реНрддрдорд╛рди рджреГрд╢реНрдп рдкрде рдЕрднреА рднреА рдорд╛рдиреНрдп рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (editMode) { EditCells(currentCell); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( Input.GetKey(KeyCode.LeftShift) &amp;&amp; searchToCell != currentCell ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell != currentCell) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell) { searchFromCell.DisableHighlight(); } searchFromCell = currentCell; searchFromCell.EnableHighlight(Color.blue); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchToCell) { hexGrid.FindPath(searchFromCell, searchToCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFromCell &amp;&amp; searchFromCell != currentCell) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchToCell != currentCell) { searchToCell = currentCell; hexGrid.FindPath(searchFromCell, searchToCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗрд╡рд▓ рдкрде рдХреЗ рд▓рд┐рдП рд▓реЗрдмрд▓ рджрд┐рдЦрд╛рдПрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛рддреНрд░рд╛ рдЪрд┐рд╣реНрди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛ рдПрдХ рдорд╣рдВрдЧрд╛ рдСрдкрд░реЗрд╢рди рд╣реИ, рдЦрд╛рд╕рдХрд░ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдПрдХ рдЕрдбреЙрдкреНрдЯ рдХрд┐рдП рдЧрдП рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдСрдкрд░реЗрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╕реЗ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдзреАрдорд╛ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рддреЛ рдЪрд▓реЛ рдореЗрдВ рд▓реЗрдмрд▓рд┐рдВрдЧ рдЫреЛрдбрд╝реЗрдВ </font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.Distance == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { neighbor.Distance = distance; <span class="hljs-comment"><span class="hljs-comment">// neighbor.SetLabel(turn.ToString()); neighbor.PathFrom = current; neighbor.SearchHeuristic = neighbor.coordinates.DistanceTo(toCell.coordinates); searchFrontier.Enqueue(neighbor); } else if (distance &lt; neighbor.Distance) { int oldPriority = neighbor.SearchPriority; neighbor.Distance = distance; // neighbor.SetLabel(turn.ToString()); neighbor.PathFrom = current; searchFrontier.Change(neighbor, oldPriority); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдХреЗрд╡рд▓ рдкреНрд░рд╛рдкреНрдд рдкрде рдХреЗ рд▓рд┐рдП рджреЗрдЦрдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдкрд╛рдареНрдпрдХреНрд░рдо рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреЗрд╡рд▓ рдЙрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд▓реЗрдмрд▓ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рд░рд╛рд╕реНрддреЗ рдореЗрдВ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == toCell) { current = current.PathFrom; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current != fromCell) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turn = current.Distance / speed; current.SetLabel(turn.ToString()); current.EnableHighlight(Color.white); current = current.PathFrom; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/090/f8f/2f1/090f8f2f121b6fafdb7b95d48fb41c8d.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрд╡рд▓ рдкрде рдХрдХреНрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рд▓реЗрдмрд▓ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдм рд╣рдо рдХреЗрд╡рд▓ рдЖрд░рдВрдн рдФрд░ рдЕрдВрдд рдХреЗ рдмреАрдЪ рдХреЗ рд╕реЗрд▓ рд▓реЗрдмрд▓ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдВрдд рдмрд┐рдВрджреБ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рд╣реИ, рд╣рдореЗрдВ рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реЗрдмрд▓ рднреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЖрдк рдЧрдВрддрд╡реНрдп рд╕реЗрд▓ рд╕реЗ рдкрде рдЪрдХреНрд░ рд╢реБрд░реВ рдХрд░рдХреЗ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рдордиреЗ рд╕реЗрд▓ рд╕реЗ рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд▓рд╛рд▓ рд╕реЗ рдЕрдВрдд рдмрд┐рдВрджреБ рдХреА рд░реЛрд╢рдиреА рд╕рдлреЗрдж рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдЧреА, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЪрдХреНрд░ рдХреЗ рддрд╣рдд рдЗрд╕рдХреА рдмреИрдХрд▓рд╛рдЗрдЯрд┐рдВрдЧ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> fromCell.EnableHighlight(Color.blue); <span class="hljs-comment"><span class="hljs-comment">// toCell.EnableHighlight(Color.red); fromCell.Distance = 0; searchFrontier.Enqueue(fromCell); while (searchFrontier.Count &gt; 0) { HexCell current = searchFrontier.Dequeue(); if (current == toCell) { // current = current.PathFrom; while (current != fromCell) { int turn = current.Distance / speed; current.SetLabel(turn.ToString()); current.EnableHighlight(Color.white); current = current.PathFrom; } toCell.EnableHighlight(Color.red); break; } тАж }</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dda/273/ea9/dda273ea9b4aa1767db16c19abf512cd.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд░рдЧрддрд┐ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рдмрд╛рдж, рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдХрд╛ рд╕рдордп рд╕рдВрдкрд╛рджрдХ рдореЗрдВ 23 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдФрд░ 6 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпреЗ 43 рдкреАрдкреАрдПрд╕ рдФрд░ 166 рдкреАрдкреАрдПрд╕ рд╣реИрдВ - рдмрд╣реБрдд рдмреЗрд╣рддрд░ред </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдмрд╕реЗ рдЪрддреБрд░ рдЦреЛрдЬ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рднрд╛рдЧ рдореЗрдВ, рд╣рдордиреЗ A </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдЦреЛрдЬ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рд╕реНрдорд╛рд░реНрдЯ рдмрдирд╛рдпрд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рдо рдЕрднреА рднреА рд╕рдмрд╕реЗ рдЗрд╖реНрдЯрддрдо рддрд░реАрдХреЗ рд╕реЗ рдЦреЛрдЬ рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ, рд╣рдо рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рд╕реЗ рдЙрд╕рдХреЗ рд╕рднреА рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рд╣реИ рдЬреЛ рдЕрднреА рддрдХ рдирд╣реАрдВ рд╣реИрдВ рдпрд╛ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЦреЛрдЬ рд╕реАрдорд╛ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЬрд┐рди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдкрд╣рд▓реЗ рд╣реА рд╕реАрдорд╛ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрдм рдЙрди рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдЗрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд░рд╛рд╕реНрддрд╛ рдвреВрдВрдв рд▓рд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдП </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рд╕рд╣реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </font><font style="vertical-align: inherit;">рдЗрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗрд▓ рдЦреЛрдЬ рдЪрд░рдг </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдХреИрд╕реЗ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛ рдХрд┐ рдХреЛрдИ рд╕реЗрд▓ рдкрд╣рд▓реЗ рд╣реА рд╕реАрдорд╛ рд╕реЗ рдмрд╛рд╣рд░ рдЪрд▓реА рдЧрдИ рд╣реИ? </font><font style="vertical-align: inherit;">рдЬрдмрдХрд┐ рд╣рдо рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╣ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рд╕реЗрд▓ рдХрд┐рд╕ рдЪрд░рдг рдореЗрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд╣ рдЕрднреА рддрдХ рд╕реАрдорд╛ рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рдпрд╛ рдЕрднреА рдЗрд╕рдореЗрдВ рд╣реИ, рдпрд╛ рд╡рд┐рджреЗрд╢ рдореЗрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдПрдХ </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдзрд╛рд░рдг рдкреВрд░реНрдгрд╛рдВрдХ рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рдХрд░ рдЗрд╕реЗ рдЯреНрд░реИрдХ рдХрд░ рд╕рдХрддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SearchPhase { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 0 рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреЛрд╢рд┐рдХрд╛рдПрдВ рдЕрднреА рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪреА рд╣реИрдВ, 1 - рдХрд┐ рд╕реЗрд▓ рдЕрднреА рд╕реАрдорд╛ рдореЗрдВ рд╣реИ, рдФрд░ 2 - рдХрд┐ рдпрд╣ рдкрд╣рд▓реЗ рд╣реА рд╕реАрдорд╛ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реАрдорд╛ рдХреЛ рдорд╛рд░рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рд░реВрдк рдореЗрдВ </font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо 0 рдФрд░ 1 рдореЗрдВ рд╕рднреА рдХрдХреНрд╖реЛрдВ рд░реАрд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╣рдореЗрд╢рд╛ рд╕реАрдорд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╛ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдирдИ рдЦреЛрдЬ рдХреЗ рд╕рд╛рде рд╕реАрдорд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдЕрдЧрд░ рд╣рдо рд╣рд░ рдмрд╛рд░ рд╕реАрдорд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЛ рд╕реЗ рдмрдврд╝рд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдбрдВрдкрд┐рдВрдЧ рд╕реЗ рдирд╣реАрдВ рдирд┐рдкрдЯрдирд╛ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> searchFrontierPhase; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { searchFrontierPhase += <span class="hljs-number"><span class="hljs-number">2</span></span>; тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдореЗрдВ рд╕реЗрд▓ рдЦреЛрдЬ рдХреЗ рдЪрд░рдг рдХреЛ рдЙрдиреНрд╣реЗрдВ рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕реЗ рд╕реАрдорд╛ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> fromCell.SearchPhase = searchFrontierPhase; fromCell.Distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(fromCell);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рд╣рд░ рдмрд╛рд░ рдЬрдм рд╣рдо рд╕реАрдорд╛ рдкрд░ рдкрдбрд╝реЛрд╕реА рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.Distance == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { neighbor.SearchPhase = searchFrontierPhase; neighbor.Distance = distance; neighbor.PathFrom = current; neighbor.SearchHeuristic = neighbor.coordinates.DistanceTo(toCell.coordinates); searchFrontier.Enqueue(neighbor); }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реАрдорд╛ рдХреА рдЬрд╛рдБрдЪ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рддрдХ, рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕реЗрд▓ рдХреЛ рдЕрднреА рддрдХ рд╕реАрдорд╛ рдореЗрдВ рдирд╣реАрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдордиреЗ рдПрдХ рд╕рдорд╛рди рджреВрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ </font></font><code>int.MaxValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рд╡рд░реНрддрдорд╛рди рд╕реАрдорд╛ рдХреЗ рд╕рд╛рде рд╕реЗрд▓ рдЦреЛрдЬ рдХреЗ рдЪрд░рдг рдХреА рддреБрд▓рдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// if (neighbor.Distance == int.MaxValue) { if (neighbor.SearchPhase &lt; searchFrontierPhase) { neighbor.SearchPhase = searchFrontierPhase; neighbor.Distance = distance; neighbor.PathFrom = current; neighbor.SearchHeuristic = neighbor.coordinates.DistanceTo(toCell.coordinates); searchFrontier.Enqueue(neighbor); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдм рд╣рдореЗрдВ рдЦреЛрдЬ рд╕реЗ рдкрд╣рд▓реЗ рд╕реЗрд▓ рдХреА рджреВрд░реА рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЕрд░реНрдерд╛рдд рд╣рдореЗрдВ рдХрдо рдХрд╛рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдЕрдЪреНрдЫрд╛ рд╣реИред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { <span class="hljs-comment"><span class="hljs-comment">// cells[i].Distance = int.MaxValue; cells[i].SetLabel(null); cells[i].DisableHighlight(); }</span></span></code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реАрдорд╛ рдХреЛ рдЫреЛрдбрд╝рдХрд░ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рдПрдХ рд╕реЗрд▓ рд╕реАрдорд╛ рд╕реЗ рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИ, рддреЛ рд╣рдо рдЗрд╕рдХреЗ рдЦреЛрдЬ рдЪрд░рдг рдореЗрдВ рд╡реГрджреНрдзрд┐ рд╕реЗ рдЗрд╕реЗ рдирд┐рд░реВрдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрд╕реЗ рд╡рд░реНрддрдорд╛рди рд╕реАрдорд╛ рд╕реЗ рдкрд░реЗ рдФрд░ рдЕрдЧрд▓реЗ рд╕реЗ рдкрд╣рд▓реЗ рд░рдЦрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); current.SearchPhase += <span class="hljs-number"><span class="hljs-number">1</span></span>; тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдм рд╣рдо рд╕реАрдорд╛ рд╕реЗ рд╣рдЯрд╛рдИ рдЧрдИ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд╡реНрдпрд░реНрде рдЧрдгрдирд╛ рдФрд░ рджреВрд░рд┐рдпреЛрдВ рдХреА рддреБрд▓рдирд╛ рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { HexCell neighbor = current.GetNeighbor(d); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.SearchPhase &gt; searchFrontierPhase ) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рд╣рдорд╛рд░рд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЕрднреА рднреА рдПрдХ рд╣реА рдкрд░рд┐рдгрд╛рдо рдкреИрджрд╛ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдзрд┐рдХ рдХреБрд╢рд▓рддрд╛ рд╕реЗред </font><font style="vertical-align: inherit;">рдореЗрд░реА рдорд╢реАрди рдкрд░, рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рд╕рдВрдкрд╛рджрдХ рдореЗрдВ 20 рдПрдордПрд╕ рдФрд░ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдореЗрдВ 5 рдПрдордПрд╕ рд▓рдЧрддреА рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдпрд╣ рднреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕реЗрд▓ рдХрд┐рддрдиреА рдмрд╛рд░ рдПрд▓реНрдЧреЛрд░рд┐рдердо рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕реЗрд▓ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╕рдордп рдХрд╛рдЙрдВрдЯрд░ рдмрдврд╝рд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ, рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣рдорд╛рд░реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдиреЗ 28,239 рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХреАред </font><font style="vertical-align: inherit;">рддреИрдпрд╛рд░ рдП </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ, </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕рдХреА 14,120 рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд░рд╛рд╢рд┐ рдореЗрдВ 50% рдХреА рдХрдореА рд╣реБрдИред </font><font style="vertical-align: inherit;">рдЙрддреНрдкрд╛рджрдХрддрд╛ рдкрд░ рдЗрди рд╕рдВрдХреЗрддрдХреЛрдВ рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреА рдбрд┐рдЧреНрд░реА рдЪрд▓рддреА рдХреА рд▓рд╛рдЧрдд рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдореЗрдВ рд▓рд╛рдЧрдд рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣рд╛рдВ рдмрд╣реБрдд рдХрд╛рдо рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдмрд╣реБрдд рдмрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдВрдкрд╛рджрдХ рдореЗрдВ рдпрд╣ рдмрд╣реБрдд рд╣реА рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИред </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддрд╛ рд╕рд╛рдл рдХрд░рдирд╛ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдирдИ рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░рддреЗ рд╕рдордп, рд╣рдореЗрдВ рдкрд╣рд▓реЗ рдкрд┐рдЫрд▓реЗ рд░рд╛рд╕реНрддреЗ рдХреЗ рджреГрд╢реНрдп рдХреЛ рд╕рд╛рдл рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЬрдм рд╣рдо рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЪрдпрди рдмрдВрдж рдХрд░реЗрдВ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЧреНрд░рд┐рдб рд╕реЗрд▓ рд╕реЗ рд▓реЗрдмрд▓ рд╣рдЯрд╛ рджреЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ рдмрд╣реБрдд рд╣реА рдХрдард┐рди рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИред </font><font style="vertical-align: inherit;">рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЙрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рддреНрдпрд╛рдЧрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдкрд┐рдЫрд▓реЗ рд░рд╛рд╕реНрддреЗ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдереЗред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗрд╡рд▓ рдЦреЛрдЬреЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдЗрдП рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЛрдб рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╣рдЯрд╛рдХрд░ рд╢реБрд░реВ рдХрд░реЗрдВ </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЙрд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рдкрде рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╣рдо рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { searchFrontierPhase += <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HexCellPriorityQueue(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { searchFrontier.Clear(); } <span class="hljs-comment"><span class="hljs-comment">// for (int i = 0; i &lt; cells.Length; i++) { // cells[i].SetLabel(null); // cells[i].DisableHighlight(); // } // fromCell.EnableHighlight(Color.blue); fromCell.SearchPhase = searchFrontierPhase; fromCell.Distance = 0; searchFrontier.Enqueue(fromCell); while (searchFrontier.Count &gt; 0) { HexCell current = searchFrontier.Dequeue(); current.SearchPhase += 1; if (current == toCell) { // while (current != fromCell) { // int turn = current.Distance / speed; // current.SetLabel(turn.ToString()); // current.EnableHighlight(Color.white); // current = current.PathFrom; // } // toCell.EnableHighlight(Color.red); // break; } тАж } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ </font></font><code>Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдПрдХ рд░рд╛рд╕реНрддрд╛ рдорд┐рд▓ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдмреВрд▓рд┐рдпрди рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { searchFrontierPhase += <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (searchFrontier == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { searchFrontier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HexCellPriorityQueue(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { searchFrontier.Clear(); } fromCell.SearchPhase = searchFrontierPhase; fromCell.Distance = <span class="hljs-number"><span class="hljs-number">0</span></span>; searchFrontier.Enqueue(fromCell); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { HexCell current = searchFrontier.Dequeue(); current.SearchPhase += <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == toCell) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } тАж } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддрд╛ рдпрд╛рдж рд╣реИ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рд░рд╛рд╕реНрддрд╛ рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЗрд╕реЗ рдпрд╛рдж рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рд╣рдо рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЗрд╕реЗ рд╕рд╛рдл рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдЯреНрд░реИрдХ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреНрдпрд╛ рдЙрдирдХреЗ рдмреАрдЪ рдХреЛрдИ рд░рд╛рд╕реНрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> HexCell currentPathFrom, currentPathTo; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> currentPathExists; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { System.Diagnostics.Stopwatch sw = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Diagnostics.Stopwatch(); sw.Start(); currentPathFrom = fromCell; currentPathTo = toCell; currentPathExists = Search(fromCell, toCell, speed); sw.Stop(); Debug.Log(sw.ElapsedMilliseconds); }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд┐рд░ рд╕реЗ рд░рд╛рд╕реНрддрд╛ рджрд┐рдЦрд╛рдУ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдкрде рдХреЛ рдлрд┐рд░ рд╕реЗ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рджрд░реНрдЬ рдХрд┐рдП рдЧрдП рдЦреЛрдЬ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдирдИ рд╡рд┐рдзрд┐ рдмрдирд╛рддреЗ рд╣реИрдВ </font></font><code>ShowPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдЪрдХреНрд░ рдХреЗ рдЕрдВрдд рд╕реЗ рдкрде рдХреА рд╢реБрд░реБрдЖрдд рддрдХ рдЬрд╛рдПрдЧрд╛, рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░реЗрдЧрд╛ рдФрд░ рдЙрдирдХреЗ рд▓реЗрдмрд▓ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░реЛрдХ рдорд╛рди рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЧрддрд┐ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдмрдирд╛рдПрдВред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЛрдИ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рд╡рд┐рдзрд┐ рдХреЗрд╡рд▓ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рдХрд╛ рдЪрдпрди рдХрд░рддреА рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPathExists) { HexCell current = currentPathTo; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current != currentPathFrom) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turn = current.Distance / speed; current.SetLabel(turn.ToString()); current.EnableHighlight(Color.white); current = current.PathFrom; } } currentPathFrom.EnableHighlight(Color.blue); currentPathTo.EnableHighlight(Color.red); }</code> </pre> <br><font style="vertical-align: inherit;"></font><code>FindPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рдХреЗ рдмрд╛рдж </font><font style="vertical-align: inherit;">рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ </font><font style="vertical-align: inherit;">рдХрд░реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> currentPathExists = Search(fromCell, toCell, speed); ShowPath(speed);</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд┐рдЯрд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдлрд┐рд░ рд╕реЗ рд░рд╛рд╕реНрддрд╛ рджреЗрдЦрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрдм рдпрд╣ рджреВрд░ рдирд╣реАрдВ рдЬрд╛ рд░рд╣рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдЦрд╛рд▓реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд┐рдзрд┐ рдмрдирд╛рдПрдВ </font></font><code>ClearPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдПрдХ рдкреНрд░рддрд┐ рд╣реИ </font></font><code>ShowPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╕рд┐рд╡рд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рдпрд╣ рдЪрдпрди рдФрд░ рд▓реЗрдмрд▓ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЙрд╕реЗ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдП рдЧрдП рдкрде рдбреЗрдЯрд╛ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдЕрдм рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClearPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPathExists) { HexCell current = currentPathTo; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current != currentPathFrom) { current.SetLabel(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); current.DisableHighlight(); current = current.PathFrom; } current.DisableHighlight(); currentPathExists = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } currentPathFrom = currentPathTo = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдкрд░ рдЬрд╛рдХрд░ рдкреБрд░рд╛рдиреЗ рдкрде рдХреЗ рджреГрд╢реНрдп рдХреЛ рд╕рд╛рдл рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдорд╛рдирдЪрд┐рддреНрд░ рдХрд╛ рдЖрдХрд╛рд░ рдЕрдм рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИред </font></font><code>FindPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирдИ рдЦреЛрдЬ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> sw.Start(); ClearPath(); currentPathFrom = fromCell; currentPathTo = toCell; currentPathExists = Search(fromCell, toCell, speed); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPathExists) { ShowPath(speed); } sw.Stop();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдПрдХ рдирдпрд╛ рдирдХреНрд╢рд╛ рдмрдирд╛рддреЗ рд╕рдордп рд░рд╛рд╕реНрддрд╛ рд╕рд╛рдл рдХрд░реЗрдВрдЧреЗред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { тАж ClearPath(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (chunks != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; chunks.Length; i++) { Destroy(chunks[i].gameObject); } } тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рджреВрд╕рд░рд╛ рдХрд╛рд░реНрдб рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рднреАред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { ClearPath(); тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рд╕реЗ рдкрд╣рд▓реЗ, рдкрде рджреГрд╢реНрдп рдкреБрди: рд╕рд╛рдлрд╝ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдм рд╣рдо рдПрдХ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рдЦреЛрдЬ рдХреЗ рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕рдордп 14 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рддрдХ рдШрдЯ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рдмреБрджреНрдзрд┐рдорд╛рди рд╕рдлрд╛рдИ рдХреЗ рдХрд╛рд░рдг рдХреЗрд╡рд▓ рдЧрдВрднреАрд░ рд╕реБрдзрд╛рд░ред </font><font style="vertical-align: inherit;">рдЕрд╕реЗрдВрдмрд▓реА рдХрд╛ рд╕рдордп рдШрдЯрдХрд░ 3 ms рд╣реЛ рдЧрдпрд╛, рдЬреЛ рдХрд┐ 333 pps рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рд░рд╛рд╕реНрддреЛрдВ рдХреА рдЦреЛрдЬ рдмрд┐рд▓реНрдХреБрд▓ рд▓рд╛рдЧреВ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдЬрдм рд╣рдордиреЗ рдкрдереЛрдВ рдХреА рддреНрд╡рд░рд┐рдд рдЦреЛрдЬ рдХрд░ рд▓реА рд╣реИ, рддреЛ рд╣рдо рдЕрд╕реНрдерд╛рдпреА рдбреАрдмрдЧрд┐рдВрдЧ рдХреЛрдб рдХреЛ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// System.Diagnostics.Stopwatch sw = new System.Diagnostics.Stopwatch(); // sw.Start(); ClearPath(); currentPathFrom = fromCell; currentPathTo = toCell; currentPathExists = Search(fromCell, toCell, speed); ShowPath(speed); // sw.Stop(); // Debug.Log(sw.ElapsedMilliseconds); }</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднрд╛рдЧ 18: рдЗрдХрд╛рдЗрдпрд╛рдБ </font></font></h1><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рджрд╕реНрддреЛрдВ рдХреЛ рдирдХреНрд╢реЗ рдкрд░ рд░рдЦрддреЗ рд╣реИрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗрд╡ рдФрд░ рд▓реЛрдб рд╕реНрдХреНрд╡рд╛рдбред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рд╕реИрдирд┐рдХреЛрдВ рдХреЗ рд▓рд┐рдП рд░рд╛рд╕реНрддреЗ рддрд▓рд╛рд╢рддреЗ рд╣реИрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдЖрдЧреЗ рдмрдврд╝рд╛рддреЗ рд╣реИрдВред </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдм рд╣рдо рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рдЪреБрдХреЗ рд╣реИрдВ рдХрд┐ рд░рд╛рд╕реНрддреЗ рдХреА рдЦреЛрдЬ рдХреИрд╕реЗ рдХреА рдЬрд╛рдП, рдЪрд▓реЛ рд╕реНрдХреНрд╡рд╛рдб рдХреЛ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд░рдЦреЗрдВред </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/881/316/9bb/8813169bb32795f4ea1d0c4696fddde2.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реБрджреГрдврд╝реАрдХрд░рдг рдЖ рдЧрдпрд╛</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджрд╕реНрддреЗ рдмрдирд╛рдирд╛ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рддрдХ рд╣рдордиреЗ рдХреЗрд╡рд▓ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдФрд░ рдЙрдирдХреА рдирд┐рд╢реНрдЪрд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпрд╛рдБ рдЙрдирд╕реЗ рдЕрд▓рдЧ рд╣реИрдВ рдХрд┐ рд╡реЗ рдореЛрдмрд╛рдЗрд▓ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдПрдХ рджрд╕реНрддреЗ рдХрд╛ рдорддрд▓рдм рдХрд┐рд╕реА рднреА рдкреИрдорд╛рдиреЗ, рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рдпрд╛ рд╡рд╛рд╣рди рд╕реЗ рд▓реЗрдХрд░ рдкреВрд░реА рд╕реЗрдирд╛ рддрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ, рд╣рдо рдЦреБрдж рдХреЛ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рдкреНрд░рдХрд╛рд░ рдХреА рдЗрдХрд╛рдИ рддрдХ рд╕реАрдорд┐рдд рд░рдЦрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВрдЧреЗред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реАрдлрд╝реИрдм рд╕реНрдХреНрд╡рд╛рдб </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд╕реНрддреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдирдП рдкреНрд░рдХрд╛рд░ рдХрд╛ рдШрдЯрдХ рдмрдирд╛рдПрдВ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЕрднреА рдХреЗ рд▓рд┐рдП, рдЪрд▓реЛ рдПрдХ рдЦрд╛рд▓реА рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>MonoBehaviour</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдмрд╛рдж рдореЗрдВ рдЗрд╕рдореЗрдВ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexUnit</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдШрдЯрдХ рдХреЗ рд╕рд╛рде рдПрдХ рдЦрд╛рд▓реА рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ, рдЬреЛ рдПрдХ рдкреНрд░реАрдлреИрдм рдмрдирдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣ рджрд╕реНрддреЗ рдХрд╛ рдореВрд▓ рдЙрджреНрджреЗрд╢реНрдп рд╣реЛрдЧрд╛ред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8de/c85/2f2/8dec852f21d7aaa2c3002dc119d890ef.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реАрдлреИрдм рд╕реНрдХреНрд╡рд╛рдбред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ 3 рдбреА рдореЙрдбрд▓ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдПрдХ рдЪрд╛рдЗрд▓реНрдб рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЯреБрдХрдбрд╝реА рдХрд╛ рдкреНрд░рддреАрдХ рд╣реИред </font><font style="vertical-align: inherit;">рдореИрдВрдиреЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕реНрдХреЗрд▓реНрдб рдХреНрдпреВрдм рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдмреНрд▓реВ рдордЯреЗрд░рд┐рдпрд▓ рдмрдирд╛рдпрд╛ред </font><font style="vertical-align: inherit;">рд░реВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдЯреБрдХрдбрд╝реА рдХреЗ рдЬрдореАрдиреА рд╕реНрддрд░ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рд╣рдо рддрджрдиреБрд╕рд╛рд░ рдмрд╛рд▓ рддрддреНрд╡ рдХреЛ рд╡рд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/be6/157/db2/be6157db233e9e6fc0a40eae6747c731.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/be6/157/db2/be6157db233e9e6fc0a40eae6747c731.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╛рд▓ рдШрди рддрддреНрд╡</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдХреНрд╡рд╛рдб рдореЗрдВ рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ рдЬреЛрдбрд╝реЗрдВ рддрд╛рдХрд┐ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЪрдпрди рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛред </font><font style="vertical-align: inherit;">рдорд╛рдирдХ рдШрди рдХрд╛ рдХреЛрд▓рд╛рдЗрдбрд░ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХрд╛рдлреА рдЙрдкрдпреБрдХреНрдд рд╣реИ, рдмрд╕ рдПрдХ рд╕реЗрд▓ рдореЗрдВ рдХреЛрд▓рд╛рдЗрдбрд░ рдлрд┐рдЯ рдХрд░реЗрдВред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЕрднреА рддрдХ рдЧреЗрдордкреНрд▓реЗ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрдХрд╛рдЗрдпреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╕рдВрдкрд╛рджрди рдореЛрдб рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрд╕реЗ рдПрдХ рдкреНрд░реАрдлреИрдм рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдПрдХ рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝реЗрдВ </font></font><code>HexUnit unitPrefab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдЗрд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexUnit unitPrefab;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85c/b00/4bd/85cb004bd7bae06a6feaa8c93f144de9.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░реАрдлрд╝реИрдм рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдмрдирд╛рддреЗ рд╕рдордп, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдХрд░реНрд╕рд░ рдХреЗ рдиреАрдЪреЗ рд╕реЗрд▓ рдкрд░ рд░рдЦреЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдореЗрдВ </font></font><code>HandleInput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рдЗрд▓рд╛рдХреЗ рд╕рдВрдкрд╛рджрди рдХреБрдЫ рдХреЛрдб рдЗрд╕ рд╕реЗрд▓ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдореЗрдВ рджрд╕реНрддреЛрдВ рдХреЗ рд▓рд┐рдП рднреА рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╕рдВрдмрдВрдзрд┐рдд рдХреЛрдб рдХреЛ рдПрдХ рдЕрд▓рдЧ рд╡рд┐рдзрд┐ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCellUnderCursor</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Ray inputRay = Camera.main.ScreenPointToRay(Input.mousePosition); RaycastHit hit; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(inputRay, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hit)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hexGrid.GetCell(hit.point); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо </font></font><code>HandleInput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕рд░рд▓ рдмрдирд╛рдиреЗ </font><font style="vertical-align: inherit;">рдореЗрдВ рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleInput</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Ray inputRay = Camera.main.ScreenPointToRay(Input.mousePosition); // RaycastHit hit; // if (Physics.Raycast(inputRay, out hit)) { // HexCell currentCell = hexGrid.GetCell(hit.point); HexCell currentCell = GetCellUnderCursor(); if (currentCell) { тАж } else { previousCell = null; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрд╛рдж, рдПрдХ рдирдИ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ рдЬрд┐рд╕рдХрд╛ </font></font><code>CreateUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>GetCellUnderCursor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдХреЛрдИ рд╕реЗрд▓ рд╣реИ, рддреЛ рд╣рдо рдПрдХ рдирдИ рдЯреАрдо рдмрдирд╛рдПрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell) { Instantiate(unitPrefab); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрджрд╛рдиреБрдХреНрд░рдо рдХреЛ рд╕рд╛рдл рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реНрдХреНрд╡рд╛рдпрдб рдореЗрдВ рд╕рднреА рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рднрд╛рд╡рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЧреНрд░рд┐рдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell) { HexUnit unit = Instantiate(unitPrefab); unit.transform.SetParent(hexGrid.transform, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ </font><font style="vertical-align: inherit;">рдПрдХ рдХреБрдВрдЬреА рджрдмрд╛рдХрд░ рд╣реИред </font><font style="vertical-align: inherit;">рдпреВ рдХреБрдВрдЬреА рдХреЛ рджрдмрд╛рдП рдЬрд╛рдиреЗ рдкрд░ </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рдХреЙрд▓ </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐ рдмрджрд▓реЗрдВ </font></font><code>CreateUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдЬреИрд╕рд╛ рдХрд┐ c рдХреЗ рд╕рд╛рде </font></font><code>HandleInput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реЛрддрд╛ рд╣реИ, рдРрд╕рд╛ рддрдм рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рдХрд░реНрд╕рд░ GUI рддрддреНрд╡ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рди рд╣реЛред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЬрд╛рдБрдЪреЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рд╣рдореЗрдВ рдорд╛рдирдЪрд┐рддреНрд░ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рд╣рдо рдЬрд╛рдБрдЪреЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рд╣рдореЗрдВ рдПрдХ рджрд▓ рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рдХреЙрд▓ рдХрд░реЗрдВ </font></font><code>CreateUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// if ( // Input.GetMouseButton(0) &amp;&amp; // !EventSystem.current.IsPointerOverGameObject() // ) { // HandleInput(); // } // else { // previousCell = null; // } if (!EventSystem.current.IsPointerOverGameObject()) { if (Input.GetMouseButton(0)) { HandleInput(); return; } if (Input.GetKeyDown(KeyCode.U)) { CreateUnit(); return; } } previousCell = null; }</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/55e/b48/c86/55eb48c8601711d74720f29cfba7a4f3.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд╕реНрддреЗ рдХрд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдЙрджрд╛рд╣рд░рдг</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯреНрд░реВрдк рдкреНрд▓реЗрд╕рдореЗрдВрдЯ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рдЗрдХрд╛рдЗрдпрд╛рдБ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдирдХреНрд╢реЗ рдХреЗ рдореВрд▓ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕рд╣реА рдЬрдЧрд╣ рдкрд░ рд░рдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рд╕реИрдирд┐рдХ рдЕрдкрдиреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдЕрд╡рдЧрдд рд╣реЛрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЙрд╕ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкрддреНрддрд┐ </font></font><code>Location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдЬрд┐рд╕ </font><font style="vertical-align: inherit;">рдкрд░ рд╡реЗ рдХрдмреНрдЬрд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдВрдкрддреНрддрд┐ рд╕реЗрдЯ рдХрд░рддреЗ рд╕рдордп, рд╣рдо рджрд╕реНрддреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдмрджрд▓ рджреЗрдВрдЧреЗ рддрд╛рдХрд┐ рдпрд╣ рд╕реЗрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдореЗрд▓ рдЦрд╛рдПред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> location; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { location = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; transform.localPosition = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Position; } } HexCell location;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдореБрдЭреЗ </font></font><code>HexMapEditor.CreateUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реНрд╕рд░ рдХреЗ рдиреАрдЪреЗ рд╕реНрдХреНрд╡рд╛рдб рд╕реЗрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рдЗрдХрд╛рдЗрдпрд╛рдБ рд╡рд╣реА рд╣реЛрдВрдЧреА рдЬрд╣рд╛рдБ рдЙрдиреНрд╣реЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell) { HexUnit unit = Instantiate(unitPrefab); unit.transform.SetParent(hexGrid.transform, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); unit.Location = cell; } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf6/71f/92d/bf671f92d2e587bebec2bf08efafadbc.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирдХреНрд╢реЗ рдкрд░ рджрд╕реНрддреЗ</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреВрдирд┐рдЯ рдУрд░рд┐рдПрдВрдЯреЗрд╢рди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рддрдХ, рд╕рднреА рдЗрдХрд╛рдЗрдпреЛрдВ рдореЗрдВ рдПрдХ рд╣реА рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рд╣реИ, рдЬреЛ рдЕрдкреНрд░рд╛рдХреГрддрд┐рдХ рджрд┐рдЦрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЗрдВ рдкреБрдирд░реНрдЬреАрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font></font><code>Orientation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ рдлреНрд▓реЛрдЯ рдореВрд▓реНрдп рд╣реИ рдЬреЛ рд╡рд╛рдИ рдЕрдХреНрд╖ рдореЗрдВ рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рд░реЛрдЯреЗрд╢рди рдХреЛ рдбрд┐рдЧреНрд░реА рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕реЗрдЯ рдХрд░рддреЗ рд╕рдордп, рд╣рдо рддрджрдиреБрд╕рд╛рд░ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд░реЛрдЯреЗрд╢рди рдХреЛ рдмрджрд▓ рджреЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Orientation { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> orientation; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { orientation = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; transform.localRotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> orientation;</code> </pre> <br><font style="vertical-align: inherit;"></font><code>HexMapEditor.CreateUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 рд╕реЗ 360 рдбрд┐рдЧреНрд░реА рд╕реЗ рдЕрд╕рд╛рдЗрди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реЛрдЯреЗрд╢рдиред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell) { HexUnit unit = Instantiate(unitPrefab); unit.transform.SetParent(hexGrid.transform, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); unit.Location = cell; unit.Orientation = Random.Range(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">360f</span></span>); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/74f/c4a/8c9/74fc4a8c943830b4abd6049889b41843.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рднрд┐рдиреНрди рдЗрдХрд╛рдИ рдЭреБрдХрд╛рд╡</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рддрд┐ рд╕реЗрд▓ рдПрдХ рд╕реНрдХреНрд╡рд╛рдб </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпрд╛рдБ рдЕрдЪреНрдЫреА рд▓рдЧрддреА рд╣реИрдВ рдпрджрд┐ рд╡реЗ рдПрдХ рд╕реЗрд▓ рдореЗрдВ рдирд╣реАрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ рдЕрдЬреАрдм рджрд┐рдЦрдиреЗ рд╡рд╛рд▓реЗ рдХреНрдпреВрдмреНрд╕ рдХрд╛ рдПрдХ рд╕рдореВрд╣ рдорд┐рд▓рддрд╛ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f8/a68/4b6/9f8a684b6425be20e23ac65901bf5888.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдУрд╡рд░рд▓реИрдб рдЗрдХрд╛рдЗрдпрд╛рдВ</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреБрдЫ рдЦреЗрд▓ рдПрдХ рд╣реА рд╕реНрдерд╛рди рдкрд░ рдХрдИ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рдирд┐рдпреБрдХреНрддрд┐ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЕрдиреНрдп рдирд╣реАрдВред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдкреНрд░рддрд┐ рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ, рдореИрдВ рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ рдЪреБрдиреВрдВрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдПрдХ рдирдпрд╛ рджрд╕реНрддрд╛ рддрднреА рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдкрд░ рдХрдмреНрдЬрд╛ рди рд╣реЛред </font><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдЖрдк рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗрдВ, </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдирдХ рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font></font><code>Unit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexUnit Unit { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ </font></font><code>HexUnit.Location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд▓ рдХреЛ рдпрд╣ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдпреВрдирд┐рдЯ рдЙрд╕ рдкрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> location; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { location = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Unit = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; transform.localPosition = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Position; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдпрд╣ </font></font><code>HexMapEditor.CreateUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдореБрдХреНрдд рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell &amp;&amp; !cell.Unit) { HexUnit unit = Instantiate(unitPrefab); unit.Location = cell; unit.Orientation = Random.Range(<span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-number"><span class="hljs-number">360f</span></span>); } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡реНрдпрд╕реНрдд рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рд╕рдВрдкрд╛рджрди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЙрдирдХреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдмрд╛рдж рдореЗрдВ рд╕рдВрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рд╕рдм рдХреБрдЫ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╕реЗрд▓ рдХреА рдКрдВрдЪрд╛рдИ рдмрджрд▓рддреА рд╣реИ, рддреЛ рдЙрд╕ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЗрдХрд╛рдИ рдпрд╛ рддреЛ рдЗрд╕рдХреЗ рдКрдкрд░ рд▓рдЯрдХреЗрдЧреА рдпрд╛ рдЗрд╕рдореЗрдВ рдбреБрдмрдХреА рд▓рдЧрд╛рдПрдЧреАред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27b/b7d/1c1/27bb7d1c120bc1546dfa0fd42823d66c.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИрдВрдЧрд┐рдВрдЧ рдФрд░ рдбреНрд░реЙрд╡реНрдб рд╕реНрдХреНрд╡реИрдбреНрд╕</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рдзрд╛рди рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╕реНрдХреНрд╡рд╛рдб рд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЕрдм рддрдХ, рд╣рдо рдХреЗрд╡рд▓ рдЯреАрдо рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдкреВрдЫреЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValidateLocation</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { transform.localPosition = location.Position; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рд╕реЗрд▓ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╕рдордп рдЯреБрдХрдбрд╝реА рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рдордиреНрд╡рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрдм рд╡рд┐рдзрд┐рдпреЛрдВ </font></font><code>Refresh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛ </font></font><code>RefreshSelfOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ </font></font><code>HexCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ </font><font style="vertical-align: inherit;">рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдмреЗрд╢рдХ, рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЬрдм рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕реЗрд▓ рдореЗрдВ рдПрдХ рдЯреБрдХрдбрд╝реА рд╣реЛред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Refresh</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (chunk) { chunk.Refresh(); тАж <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Unit) { Unit.ValidateLocation(); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshSelfOnly</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { chunk.Refresh(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Unit) { Unit.ValidateLocation(); } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджрд╕реНрддреЛрдВ рдХреЛ рджреВрд░ рдХрд░рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдиреНрд╣реЗрдВ рдирд╖реНрдЯ рдХрд░рдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font></font><code>DestroyUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЙрд╕реЗ рдЬрд╛рдВрдЪрдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХрд░реНрд╕рд░ рдХреЗ рдиреАрдЪреЗ рд╕реЗрд▓ рдореЗрдВ рдПрдХ рдЯреБрдХрдбрд╝реА рд╣реИ, рдФрд░ рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рдЯреБрдХрдбрд╝реА рдХреЗ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдирд╖реНрдЯ рдХрд░ рджреЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DestroyUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell &amp;&amp; cell.Unit) { Destroy(cell.Unit.gameObject); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ, рдЯреАрдо рдореЗрдВ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕реЗрд▓ рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рджрд╕реНрддреЗ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдорд╛рдЙрд╕ рдХреЛ рдЙрд╕рдХреЗ рд╕реЗрд▓ рдкрд░ рд▓реЗ рдЬрд╛рдПрдБред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЗрд╕рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рджрд╕реНрддреЗ рдХреЗ рдкрд╛рд╕ рдХреЛрд▓рд╛рдЗрдбрд░ рд╣реЛрдирд╛ рдЬрд░реВрд░реА рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдЪрдпрди рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрди рдХрд┐рд░рдгреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЕрдиреНрдпрдерд╛ рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рдкреАрдЫреЗ рдХреЗ рд╕реЗрд▓ рд╕реЗ рдЯрдХрд░рд╛рдПрдВрдЧреЗред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдХреНрд╡рд╛рдб рдХреЛ рдирд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╛рдПрдВ Shift + U рдХреЗ рд╕рдВрдпреЛрдЬрди </font><font style="vertical-align: inherit;">рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKeyDown(KeyCode.U)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftShift)) { DestroyUnit(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CreateUnit(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрдм рд╣рдо рдХрдИ рдЗрдХрд╛рдЗрдпрд╛рдВ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдирд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрдХрд╛рдИ рдХреЛ рд╣рдЯрд╛рддреЗ рд╕рдордп рд╕рд╛рд╡рдзрд╛рдиреА рдмрд░рддреЗрдВ рдФрд░ рд╕рдВрдкрддреНрддрд┐ рдХреЛ рд╕рд╛рдл рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣реА рд╣реИ, рд╣рдо рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рд╕реЗрд▓ рд▓рд┐рдВрдХ рдХреЛ рд╕рд╛рдл рдХрд░ рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд░реАрдХреЗ рдХреЗ </font></font><code>Die</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рде-рд╕рд╛рде рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдирд╖реНрдЯ </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреА </font><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Die</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { location.Unit = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; Destroy(gameObject); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗ </font></font><code>HexMapEditor.DestroyUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рд╕реНрдХреНрд╡рд╛рдб рдХреЛ рд╕реАрдзреЗ рдирд╖реНрдЯ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DestroyUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell &amp;&amp; cell.Unit) { <span class="hljs-comment"><span class="hljs-comment">// Destroy(cell.Unit.gameObject); cell.Unit.Die(); } }</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрдЪрдд рдФрд░ рд▓реЛрдбрд┐рдВрдЧ рд╕реНрдХреНрд╡реЙрдб </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирдХреНрд╢реЗ рдкрд░ рдЗрдХрд╛рдЗрдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдмрдЪрдд рдФрд░ рд▓реЛрдбрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рджреЛ рддрд░реАрдХреЛрдВ рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕реЗрд▓ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддреЗ рд╕рдордп рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╕реНрдХреНрд╡рд╛рдб рдбреЗрдЯрд╛ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕реЗрд▓ рдФрд░ рд╕реНрдХреНрд╡рд╛рдб рдбреЗрдЯрд╛ рдорд┐рд╢реНрд░рд┐рдд рд╣реЛред </font><font style="vertical-align: inherit;">рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛ рд╕реЗрд▓ рдФрд░ рд╕реНрдХреНрд╡рд╛рдб рдбреЗрдЯрд╛ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реЗрд╡ рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐ рдРрд╕рд╛ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдкрд╣рд▓рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ, рджреВрд╕рд░рд╛ рд╣рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдВрд░рдЪрд┐рдд рдбреЗрдЯрд╛ рджреЗрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдо рдбреЗрдЯрд╛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЙрдирдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рдПрдЧрд╛ред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреВрдирд┐рдЯ рдЯреНрд░реИрдХрд┐рдВрдЧ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпреЛрдВ </font><font style="vertical-align: inherit;">рдХреА </font><font style="vertical-align: inherit;">рд╕реВрдЪреА рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рдХрд░ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕реВрдЪреА рдореЗрдВ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд╕рднреА рдЗрдХрд╛рдЗрдпрд╛рдБ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред</font></font><br><br><pre> <code class="cs hljs"> List&lt;HexUnit&gt; units = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;HexUnit&gt;();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирдпрд╛ рдирдХреНрд╢рд╛ рдмрдирд╛рддреЗ рдпрд╛ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп, рд╣рдореЗрдВ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рд╕рднреА рдЗрдХрд╛рдЗрдпреЛрдВ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдРрд╕рд╛ рддрд░реАрдХрд╛ рдмрдирд╛рдПрдВ </font></font><code>ClearUnits</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рд╕реВрдЪреА рдореЗрдВ рдореМрдЬреВрдж рд╕рднреА рдХреЛ рдорд╛рд░ рдбрд╛рд▓реЗ рдФрд░ рдЙрд╕реЗ рд╕рд╛рдл рдХрд░ рджреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClearUnits</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; units.Count; i++) { units[i].Die(); } units.Clear(); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ </font></font><code>CreateMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдореЗрдВ рдХрд╣рддреЗ рд╣реИрдВ </font></font><code>Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддрд╛ рд╕рд╛рдл рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateMap</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z</span></span></span><span class="hljs-function">)</span></span> { тАж ClearPath(); ClearUnits(); тАж } тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { ClearPath(); ClearUnits(); тАж }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреНрд░рд┐рдб рдореЗрдВ рд╕реНрдХреНрд╡рд╛рдб рдЬреЛрдбрд╝рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм, рдирдИ рдЗрдХрд╛рдЗрдпрд╛рдБ рдмрдирд╛рддреЗ рд╕рдордп, рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рд╕реВрдЪреА рдореЗрдВ рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдзрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ </font></font><code>AddUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреЛ рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рд╕реНрдерд╛рди рдФрд░ рдЗрд╕рдХреА рдореВрд▓ рд╡рд╕реНрддреБ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рд╕реЗ рднреА рдирд┐рдкрдЯреЗрдЧреАред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexUnit unit, HexCell location, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> orientation</span></span></span><span class="hljs-function">)</span></span> { units.Add(unit); unit.transform.SetParent(transform, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); unit.Location = location; unit.Orientation = orientation; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдпрд╣ </font><font style="vertical-align: inherit;">рдЯреБрдХрдбрд╝реА рдХреЗ рдирдП рдЙрджрд╛рд╣рд░рдг, рдЗрд╕рдХреЗ рд╕реНрдерд╛рди рдФрд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рд╕рд╛рде </font></font><code>HexMapEditor.CreatUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛ </font></font><code>AddUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell &amp;&amp; !cell.Unit) { <span class="hljs-comment"><span class="hljs-comment">// HexUnit unit = Instantiate(unitPrefab); // unit.transform.SetParent(hexGrid.transform, false); // unit.Location = cell; // unit.Orientation = Random.Range(0f, 360f); hexGrid.AddUnit( Instantiate(unitPrefab), cell, Random.Range(0f, 360f) ); } }</span></span></code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреНрд░рд┐рдб рд╕реЗ рджрд╕реНрддреЛрдВ рдХреЛ рд╣рдЯрд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдХреНрд╡рд╛рдб рдФрд░ рд╕реА рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдмрд╕ рд╕реВрдЪреА рд╕реЗ рджрд╕реНрддреЗ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рдФрд░ рдЗрд╕реЗ рдорд░рдиреЗ рдХрд╛ рдЖрджреЗрд╢ рджреЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexUnit unit</span></span></span><span class="hljs-function">)</span></span> { units.Remove(unit); unit.Die(); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ </font></font><code>HexMapEditor.DestroyUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реАрдзреЗ рджрд╕реНрддреЗ рдХреЛ рдирд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп </font><font style="vertical-align: inherit;">рдЕрдВрджрд░ рдмреБрд▓рд╛рддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DestroyUnit</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = GetCellUnderCursor(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell &amp;&amp; cell.Unit) { <span class="hljs-comment"><span class="hljs-comment">// cell.Unit.Die(); hexGrid.RemoveUnit(cell.Unit); } }</span></span></code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрдЪрдд рдЗрдХрд╛рдЗрдпреЛрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдо рд╕рднреА рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдпрд╣ рдпрд╛рдж рд░рдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ рдХрд┐ рд╡реЗ рдХрд┐рди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рддрд░реАрдХрд╛ рдЙрдирдХреЗ рд╕реНрдерд╛рди рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреЛ рд╕рд╣реЗрдЬрдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕рдВрднрд╡ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо </font><font style="vertical-align: inherit;">рдлрд╝реАрд▓реНрдб X рдФрд░ Z </font><font style="vertical-align: inherit;">рдХреЛ рдЙрд╕ </font></font><code>HexCoordinates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рд▓рд┐рдЦрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> HexCoordinates { тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryWriter writer</span></span></span><span class="hljs-function">)</span></span> { writer.Write(x); writer.Write(z); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рд▓рд┐рдП </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдм рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдФрд░ рдпреВрдирд┐рдЯ рдХреЗ рдЙрдиреНрдореБрдЦреАрдХрд░рдг рд░рд┐рдХреЙрд░реНрдб рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрди рд╕рднреА рдЗрдХрд╛рдЗрдпреЛрдВ рдХрд╛ рдбреЗрдЯрд╛ рд╣реИ рдЬреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЗрд╕ рд╕рдордп рд╣реИред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexUnit</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryWriter writer</span></span></span><span class="hljs-function">)</span></span> { location.coordinates.Save(writer); writer.Write(orientation); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдпрд╣ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХреА рд╡рд┐рдзрд┐ </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдЧреАред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд▓рд┐рдЦреЗрдВ, рдФрд░ рдлрд┐рд░ рдЙрди рд╕рднреА рдХреЛ рдПрдХ рд▓реВрдк рдореЗрдВ рдШреБрдорд╛рдПрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryWriter writer</span></span></span><span class="hljs-function">)</span></span> { writer.Write(cellCountX); writer.Write(cellCountZ); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cells.Length; i++) { cells[i].Save(writer); } writer.Write(units.Count); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; units.Count; i++) { units[i].Save(writer); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдордиреЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдЦреНрдпрд╛ </font></font><code>SaveLoadMenu.Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ 2 рддрдХ </font><font style="vertical-align: inherit;">рдмрдврд╝рд╛рдПрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред рдкреБрд░рд╛рдирд╛ рдмреВрдЯ рдХреЛрдб рдЕрднреА рднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реНрдХреНрд╡рд╛рдб рдбреЗрдЯрд╛ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдирд╣реАрдВ рдкрдврд╝реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЖрдкрдХреЛ рдпрд╣ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЗрдХрд╛рдИ рдЬрд╛рдирдХрд╛рд░реА рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ( BinaryWriter writer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryWriter(File.Open(path, FileMode.Create)) ) { writer.Write(<span class="hljs-number"><span class="hljs-number">2</span></span>); hexGrid.Save(writer); } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓реЛрдбрд┐рдВрдЧ рджрд╕реНрддреЗ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдпрд╣ </font></font><code>HexCoordinates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рдВрд░рдЪрдирд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрд░реНрде рдирд╣реАрдВ рд╣реИ </font></font><code>Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЗрд╕реЗ рдПрдХ рд╕реНрдерд┐рд░ рд╡рд┐рдзрд┐ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреЛ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рд▓реМрдЯрд╛рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> HexCoordinates </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader</span></span></span><span class="hljs-function">)</span></span> { HexCoordinates c; cx = reader.ReadInt32(); cz = reader.ReadInt32(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкрд░рд┐рд╡рд░реНрддрдирд╢реАрд▓ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рдЗрдХрд╛рдЗрдпрд╛рдБ рдирд╣реАрдВ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЙрдирдХреЗ рдбреЗрдЯрд╛ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рдирдП рдЙрджрд╛рд╣рд░рдг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ рдХрд┐ рд╣рдо </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреВрдЯ рд╕рдордп рдкрд░ рдирдИ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдПрдБред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдЫреЛрдбрд╝рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рдо рд╕реНрдереИрддрд┐рдХ рд╡рд┐рдзрд┐ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>HexUnit.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЪрд▓реЛ рдмрд╕ рдЗрди рджрд╕реНрддреЛрдВ рдХреЛ рдкрдврд╝рдХрд░ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдлреНрд▓реЛрдЯ рдХреЗ рдореВрд▓реНрдп рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>BinaryReader.ReadSingle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд┐рдВрдЧрд▓ рд╣реА рдХреНрдпреЛрдВ?</font></font></b> <div class="spoiler_text">  <code>float</code>        ,     .     ,   <code>double</code> ,     .  Unity   . </div></div><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader</span></span></span><span class="hljs-function">)</span></span> { HexCoordinates coordinates = HexCoordinates.Load(reader); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> orientation = reader.ReadSingle(); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЧрд▓рд╛ рдХрджрдо рдирдП рджрд╕реНрддреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдпреВрдирд┐рдЯ рдХреЗ рдкреНрд░реАрдлреИрдм рдХреЗ рд▓рд┐рдВрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдЕрднреА рддрдХ рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдереИрддрд┐рдХ рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> HexUnit unitPrefab;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рд▓рд┐рдВрдХ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рд╢реЛрд░ рдмрдирд╛рд╡рдЯ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЬрдм рд╣рдореЗрдВ рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА рдЗрдХрд╛рдЗрдпреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рд╣рдо рдмреЗрд╣рддрд░ рд╕рдорд╛рдзрд╛рди рдХреА рдУрд░ рдмрдврд╝реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexUnit unitPrefab; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexMetrics.noiseSource = noiseSource; HexMetrics.InitializeHashGrid(seed); HexUnit.unitPrefab = unitPrefab; CreateMap(cellCountX, cellCountZ); } тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!HexMetrics.noiseSource) { HexMetrics.noiseSource = noiseSource; HexMetrics.InitializeHashGrid(seed); HexUnit.unitPrefab = unitPrefab; } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/251/e2e/9c0/251e2e9c0e0f9ec8c6da0a0a7bce6f85.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдпреВрдирд┐рдЯ рдХреЗ рдкреНрд░реАрдлреИрдм рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд╖реЗрддреНрд░ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдЕрдм рд╕реАрдзреЗ рд▓рд┐рдВрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╡рд╣ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ </font></font><code>HexUnit.unitPrefab</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// public HexUnit unitPrefab; тАж void CreateUnit () { HexCell cell = GetCellUnderCursor(); if (cell &amp;&amp; !cell.Unit) { hexGrid.AddUnit( Instantiate(HexUnit.unitPrefab), cell, Random.Range(0f, 360f) ); } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рдирдП рджрд╕реНрддреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>HexUnit.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдЗрд╕реЗ рдЧреНрд░рд┐рдб рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЛрдб рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдФрд░ рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕рдВрднрд╡ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛрдбрд╝реЗрдВ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, HexGrid grid</span></span></span><span class="hljs-function">)</span></span> { HexCoordinates coordinates = HexCoordinates.Load(reader); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> orientation = reader.ReadSingle(); grid.AddUnit( Instantiate(unitPrefab), grid.GetCell(coordinates), orientation ); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдд рдореЗрдВ, </font></font><code>HexGrid.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рднреА рд╕рдВрдЧреНрд░рд╣реАрдд рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ, рдЦреБрдж рдХреЛ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BinaryReader reader, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> header</span></span></span><span class="hljs-function">)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> unitCount = reader.ReadInt32(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; unitCount; i++) { HexUnit.Load(reader, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмреЗрд╢рдХ, рдпрд╣ рдХреЗрд╡рд▓ 2 рд╕реЗ рдХрдо рд╕рдВрд╕реНрдХрд░рдг рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░реЗрдЧрд╛, рдпреБрд╡рд╛ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдЗрдХрд╛рдИ рдирд╣реАрдВ рд╣реИред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> unitCount = reader.ReadInt32(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; unitCount; i++) { HexUnit.Load(reader, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рд╕рдВрд╕реНрдХрд░рдг 2 рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП </font></font><code>SaveLoadMenu.Load</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдорд░реНрдерд┐рдд рд╕рдВрд╕реНрдХрд░рдг рдХреА рд╕рдВрдЦреНрдпрд╛ </font><font style="vertical-align: inherit;">2 рддрдХ </font><font style="vertical-align: inherit;">рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!File.Exists(path)) { Debug.LogError(<span class="hljs-string"><span class="hljs-string">"File does not exist "</span></span> + path); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(File.OpenRead(path))) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> header = reader.ReadInt32(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header &lt;= <span class="hljs-number"><span class="hljs-number">2</span></span>) { hexGrid.Load(reader, header); HexMapCamera.ValidatePosition(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Debug.LogWarning(<span class="hljs-string"><span class="hljs-string">"Unknown map format "</span></span> + header); } } }</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЯреНрд░реВрдк рдореВрд╡рдореЗрдВрдЯ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдХреНрд╡реИрдб рдореЛрдмрд╛рдЗрд▓ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдорд╛рдирдЪрд┐рддреНрд░ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рд▓реЗ рдЬрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдкрде рдЦреЛрдЬ рдХреЛрдб рд╣реИ, рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рд╣рдордиреЗ рдЗрд╕реЗ рдХреЗрд╡рд▓ рдордирдорд╛рдиреЗ рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдореЗрдВ рдкреБрд░рд╛рдиреЗ рдкрд░реАрдХреНрд╖рдг UI рдХреЛ рд╣рдЯрд╛рдиреЗ рдФрд░ рд╕реНрдХреНрд╡рд╛рдб рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ UI рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдирдЪрд┐рддреНрд░ рд╕рдВрдкрд╛рджрдХ рд╕рдлрд╛рдИ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдереЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рдЗрдХрд╛рдЗрдпрд╛рдБ рдЧреЗрдордкреНрд▓реЗ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИрдВ, рдпрд╣ рдорд╛рдирдЪрд┐рддреНрд░ рд╕рдВрдкрд╛рджрдХ рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рд╕реЗ рдЬреБрдбрд╝реЗ рд╕рднреА рдХреЛрдб рд╕реЗ </font><font style="vertical-align: inherit;">рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд▓реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// HexCell previousCell, searchFromCell, searchToCell; HexCell previousCell; тАж void HandleInput () { HexCell currentCell = GetCellUnderCursor(); if (currentCell) { if (previousCell &amp;&amp; previousCell != currentCell) { ValidateDrag(currentCell); } else { isDrag = false; } if (editMode) { EditCells(currentCell); } // else if ( // Input.GetKey(KeyCode.LeftShift) &amp;&amp; searchToCell != currentCell // ) { // if (searchFromCell != currentCell) { // if (searchFromCell) { // searchFromCell.DisableHighlight(); // } // searchFromCell = currentCell; // searchFromCell.EnableHighlight(Color.blue); // if (searchToCell) { // hexGrid.FindPath(searchFromCell, searchToCell, 24); // } // } // } // else if (searchFromCell &amp;&amp; searchFromCell != currentCell) { // if (searchToCell != currentCell) { // searchToCell = currentCell; // hexGrid.FindPath(searchFromCell, searchToCell, 24); // } // } previousCell = currentCell; } else { previousCell = null; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдХреЛрдб рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд╕рдВрдкрд╛рджрдХ рдХреЛ рд╕рдХреНрд░рд┐рдп рдЫреЛрдбрд╝рдиреЗ рдХрд╛ рдХреЛрдИ рдорддрд▓рдм рдирд╣реАрдВ рд╣реИ рдЬрдм рд╣рдо рд╕рдВрдкрд╛рджрди рдореЛрдб рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдПрдХ рдореЛрдб рдЯреНрд░реИрдХрд┐рдВрдЧ рдлрд╝реАрд▓реНрдб рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдмрд╕ рдШрдЯрдХ рдХреЛ рд╕рдХреНрд╖рдо рдпрд╛ рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдВрдкрд╛рджрдХ рдХреЛ рдЕрдм рдпреВрдЖрдИ рд▓реЗрдмрд▓ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// bool editMode; тАж public void SetEditMode (bool toggle) { // editMode = toggle; // hexGrid.ShowUI(!toggle); enabled = toggle; } тАж void HandleInput () { HexCell currentCell = GetCellUnderCursor(); if (currentCell) { if (previousCell &amp;&amp; previousCell != currentCell) { ValidateDrag(currentCell); } else { isDrag = false; } // if (editMode) { EditCells(currentCell); // } previousCell = currentCell; } else { previousCell = null; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪреВрдВрдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╣рдо рдореИрдк рдПрдбрд┐рдЯрд┐рдВрдЧ рдореЛрдб рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЕрд╡реЗрдХ рдореЗрдВ рд╣рдо рдПрдбрд┐рдЯрд░ рдХреЛ рдбрд┐рд╕реЗрдмрд▓ рдХрд░ рджреЗрдВрдЧреЗред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { terrainMaterial.DisableKeyword(<span class="hljs-string"><span class="hljs-string">"GRID_ON"</span></span>); SetEditMode(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдирдЪрд┐рддреНрд░ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп, рдФрд░ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реНрд╕рд░ рдХреЗ рдиреАрдЪреЗ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░реЗрдХрд╛рд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред </font><font style="vertical-align: inherit;">рд╢рд╛рдпрдж рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХрд┐рд╕реА рдФрд░ рдЪреАрдЬ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЪрд▓реЛ </font><font style="vertical-align: inherit;">рдХрд┐рд░рдг рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирдИ рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рд╕реЗ рд░реЗрдХрд╛рд╕реНрдЯрд┐рдВрдЧ рддрд░реНрдХ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ </font></font><code>GetCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ray ray</span></span></span><span class="hljs-function">)</span></span> { RaycastHit hit; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hit)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetCell(hit.point); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br> <code>HexMapEditor.GetCellUniderCursor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд░реНрд╕рд░ рдмреАрдо рдХреЗ рд╕рд╛рде рдмрд╕ рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">HexCell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCellUnderCursor</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hexGrid.GetCell(Camera.main.ScreenPointToRay(Input.mousePosition)); }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЦреЗрд▓ рдпреВрдЖрдИ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЗрдо рдореЛрдб UI рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдирдП рдШрдЯрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЬрдмрдХрд┐ рд╡рд╣ рдХреЗрд╡рд▓ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рдЪрдпрди рдФрд░ рдЖрдВрджреЛрд▓рди рд╕реЗ рдирд┐рдкрдЯреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдХрдВрдкреЛрдиреЗрдВрдЯ рдЯрд╛рдЗрдк рдмрдирд╛рдПрдВ </font></font><code>HexGameUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЕрдкрдирд╛ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЧреНрд░рд┐рдб рдХрд╛ рдПрдХ рд▓рд┐рдВрдХ рдЙрд╕рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.EventSystems; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexGameUI</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexGrid grid; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпреВрдЖрдИ рдкрджрд╛рдиреБрдХреНрд░рдо рдореЗрдВ рдЗрд╕ рдШрдЯрдХ рдХреЛ рдирдП рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред </font><font style="vertical-align: inherit;">рдЙрд╕рдХреЗ рдкрд╛рд╕ рдЕрдкрдиреА рд╡рд╕реНрддреБ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рд╕реНрдкрд╖реНрдЯ рд╣реЛрдЧрд╛ рдХрд┐ рдЦреЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рдпреВрдЖрдИ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/515/769/bdd/515769bdd0b6fbee9cb8451348595a57.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b3/b7c/0d7/9b3b7c0d719d05862a76ba8e70409970.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЗрдо рдпреВрдЖрдИ рдСрдмреНрдЬреЗрдХреНрдЯ</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ </font></font><code>HexGameUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font></font><code>SetEditMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬреИрд╕реЗ рдХрд┐ </font></font><code>HexMapEditor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЬрдм рд╣рдо рдПрдбрд┐рдЯ рдореЛрдб рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рддреЛ рдЧреЗрдо рдпреВрдЖрдИ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓реЗрдмрд▓ рдХреЛ рдпрд╣рд╛рдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЧреЗрдо рдпреВрдЖрдИ рдкрдереЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetEditMode</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> toggle</span></span></span><span class="hljs-function">)</span></span> { enabled = !toggle; grid.ShowUI(!toggle); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдбрд┐рдЯ рдореЛрдб рд╕реНрд╡рд┐рдЪ рдХреА рдЗрд╡реЗрдВрдЯ рд╕реВрдЪреА рдХреЗ рд╕рд╛рде рдЧреЗрдо рдпреВрдЖрдИ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реЛрдЧрд╛ рдХрд┐ рдЬрдм рдЦрд┐рд▓рд╛рдбрд╝реА рдореЛрдб рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рджреЛрдиреЛрдВ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/92b/dde/778/92bdde778bfc97ae4b5bdc1d49a2bb6b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрдИ рдЖрдпреЛрдЬрди рд╡рд┐рдзрд┐рдпрд╛рдБред </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЛ рдЯреНрд░реИрдХ рдХрд░реЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, </font></font><code>HexGameUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХрд░реНрд╕рд░ рдХреЗ рдиреАрдЪреЗ рдХреМрди рд╕реА рд╕реЗрд▓ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЗрд╕рдореЗрдВ рдПрдХ рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ </font></font><code>currentCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> HexCell currentCell;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдлрд╝реАрд▓реНрдб рдХреЛ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХреЗ </font></font><code>UpdateCurrentCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдП </font></font><code>HexGrid.GetCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реНрд╕рд░ рдмреАрдо рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА </font><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдмрдирд╛рдПрдБ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateCurrentCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { currentCell = grid.GetCell(Camera.main.ScreenPointToRay(Input.mousePosition)); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╕рдордп, рд╣рдореЗрдВ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдмрджрд▓ рдЧрдпрд╛ рд╣реИред </font></font><code>UpdateCurrentCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА </font><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рд╡рд╛рдкрд╕ </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдп </font><font style="vertical-align: inherit;">рдХрд░реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateCurrentCell</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { HexCell cell = grid.GetCell(Camera.main.ScreenPointToRay(Input.mousePosition)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell != currentCell) { currentCell = cell; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрдХрд╛рдИ рдЪрдпрди </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рджрд╕реНрддреЗ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЗрд╕реЗ рдЪреБрдирдирд╛ рдФрд░ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдПрдХ рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝реЗрдВ </font></font><code>selectedUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> HexUnit selectedUnit;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рд╣рдо рдЪрдпрди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдХреЗ рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рд╣реИ рддреЛ рдЗрд╕ рд╕реЗрд▓ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЗрдХрд╛рдИ рдЪрдпрдирд┐рдд рдЗрдХрд╛рдИ рдмрди рдЬрд╛рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╕реЗрд▓ рдореЗрдВ рдХреЛрдИ рдЗрдХрд╛рдИ рдирд╣реАрдВ рд╣реИ, рддреЛ рдХреЛрдИ рднреА рдЗрдХрд╛рдИ рдЪрдпрдирд┐рдд рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдзрд┐ рдмрдирд╛рддреЗ рд╣реИрдВ </font></font><code>DoSelection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoSelection</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { UpdateCurrentCell(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentCell) { selectedUnit = currentCell.Unit; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдорд╛рдЙрд╕ рдХреА рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреНрд▓рд┐рдХ рдХреЗ рд╕рд╛рде рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рдкрд╕рдВрдж рдХрд╛ рдПрд╣рд╕рд╛рд╕ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдПрдХ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛ рдорд╛рдЙрд╕ рдмрдЯрди рд╕рдХреНрд░рд┐рдп рд╣реЛрдиреЗ рдкрд░ рдПрдХ рдЪрдпрди рдХрд░рддрд╛ рд╣реИред рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рд╣рдореЗрдВ рдЗрд╕реЗ рддрднреА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрдм рдХрд░реНрд╕рд░ GUI рддрддреНрд╡ рд╕реЗ рдКрдкрд░ рди рд╣реЛред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!EventSystem.current.IsPointerOverGameObject()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>)) { DoSelection(); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╣рдордиреЗ рд╕реАрдЦрд╛ рдХрд┐ рдорд╛рдЙрд╕ рдХреЗ рдХреНрд▓рд┐рдХ рдХреЗ рд╕рд╛рде рдПрдХ рдмрд╛рд░ рдореЗрдВ рдПрдХ рдЗрдХрд╛рдИ рдХрд╛ рдЪрдпрди рдХреИрд╕реЗ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЬрдм рдЖрдк рдХрд┐рд╕реА рдЦрд╛рд▓реА рд╕реЗрд▓ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХрд┐рд╕реА рднреА рдЗрдХрд╛рдИ рдХрд╛ рдЪрдпрди рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЬрдмрдХрд┐ рд╣рдореЗрдВ рдЗрд╕рдХреА рдХреЛрдИ рджреГрд╢реНрдп рдкреБрд╖реНрдЯрд┐ рдирд╣реАрдВ рдорд┐рд▓рддреА рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджрд╕реНрддреЗ рдХреА рдЦреЛрдЬ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рдПрдХ рдЗрдХрд╛рдИ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдкрде рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕рдХреЗ рд╕реНрдерд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдорд╛рдЙрд╕ рдмрдЯрди рдХреЗ рдПрдХ рдФрд░ рдХреНрд▓рд┐рдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреАред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдХреНрд╡рд╛рдб рд╕реНрдерд┐рддрд┐ рдФрд░ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЗ рдмреАрдЪ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬреЗрдВрдЧреЗ рдФрд░ рджрд┐рдЦрд╛рдПрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд╣рдо рд╣рдореЗрд╢рд╛ рдРрд╕рд╛ рдХрд░реЗрдВрдЧреЗ </font></font><code>Update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╕рд┐рд╡рд╛рдп рдкрд╕рдВрдж рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рджред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдЯреБрдХрдбрд╝реА рд╣реЛрддреА рд╣реИ, рддреЛ рд╣рдо рд╡рд┐рдзрд┐ рдХрд╣рддреЗ рд╣реИрдВ </font></font><code>DoPathfinding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!EventSystem.current.IsPointerOverGameObject()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>)) { DoSelection(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (selectedUnit) { DoPathfinding(); } } }</code> </pre> <br> <code>DoPathfinding</code><font style="vertical-align: inherit;"></font><code>HexGrid.FindPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЧрд░ рдХреЛрдИ рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╣реИ рддреЛ </font><font style="vertical-align: inherit;">рдмрд╕ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреЙрд▓ рдХрд░рддрд╛ </font><font style="vertical-align: inherit;">рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдлрд┐рд░ рд╕реЗ 24 рдХреА рдирд┐рд░рдВрддрд░ рдЧрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoPathfinding</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { UpdateCurrentCell(); grid.FindPath(selectedUnit.Location, currentCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рднреА рд╣рдо рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдореЗрдВ рд╣рд░ рдмрд╛рд░ рдПрдХ рдирдпрд╛ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ рдорд┐рд▓рдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рддрдм рдЬрдм рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рдмрджрд▓ рдЬрд╛рдПред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoPathfinding</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UpdateCurrentCell()) { grid.FindPath(selectedUnit.Location, currentCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/39f/8d1/ce9/39f8d1ce9040ae5370fd12f447ecd8e7.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рджрд╕реНрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░рд╛рд╕реНрддрд╛ рдвреВрдБрдврдирд╛</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдм рд╣рдо рдЙрди рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ рдЬреЛ рддрдм рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ рдЬрдм рдЖрдк рдПрдХ рджрд╕реНрддреЗ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдХрд░реНрд╕рд░ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдХрд┐рд╕ рдЗрдХрд╛рдИ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рд░рд╛рд╕реНрддреЗ рд╣рдореЗрд╢рд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рд╛рдл рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкреБрд░рд╛рдиреЗ рд░рд╛рд╕реНрддреЗ рдХреЛ рд╕рд╛рдл рдХрд░реЗрдВ рдпрджрд┐ рдХрд░реНрд╕рд░ рдирдХреНрд╢реЗ рдХреЗ рдмрд╛рд╣рд░ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoPathfinding</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UpdateCurrentCell()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentCell) { grid.FindPath(selectedUnit.Location, currentCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { grid.ClearPath(); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреЗрд╢рдХ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдпрд╣ </font></font><code>HexGrid.ClearPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдо рд╣реЛ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдРрд╕рд╛ рдмрджрд▓рд╛рд╡ рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClearPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреВрд╕рд░реЗ, рд╣рдо рдПрдХ рдЯреБрдХрдбрд╝реА рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╕рдордп рдкреБрд░рд╛рдиреЗ рд░рд╛рд╕реНрддреЗ рдХреЛ рд╕рд╛рдл рдХрд░ рджреЗрдВрдЧреЗред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoSelection</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { grid.ClearPath(); UpdateCurrentCell(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentCell) { selectedUnit = currentCell.Unit; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдВрдд рдореЗрдВ, рд╣рдо рд╕рдВрдкрд╛рджрди рдореЛрдб рдХреЛ рдмрджрд▓рддреЗ рд╕рдордп рд░рд╛рд╕реНрддрд╛ рд╕рд╛рдл рдХрд░реЗрдВрдЧреЗред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetEditMode</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> toggle</span></span></span><span class="hljs-function">)</span></span> { enabled = !toggle; grid.ShowUI(!toggle); grid.ClearPath(); }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗрд╡рд▓ рдорд╛рдиреНрдп рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рд╣рдореЗрд╢рд╛ рд░рд╛рд╕реНрддрд╛ рдирд╣реАрдВ рдЦреЛрдЬ рд╕рдХрддреЗ, рдХреНрдпреЛрдВрдХрд┐ рдХрднреА-рдХрднреА рдЕрдВрддрд┐рдо рд╕реЗрд▓ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЕрд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдХрднреА-рдХрднреА рдЕрдВрддрд┐рдо рдХреЛрд╢рд┐рдХрд╛ рд╣реА рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рддрдп рдХрд┐рдпрд╛ рдХрд┐ рд░рд╛рд╕реНрддреЛрдВ рдореЗрдВ рдкрд╛рдиреА рдХреЗ рдиреАрдЪреЗ рдХреА рдХреЛрд╢рд┐рдХрд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рдЗрдХрд╛рдИ рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдПрдХ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">рдЬреЛ рд╣рдореЗрдВ рдмрддрд╛рддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╕реЗрд▓ рдПрдХ рдорд╛рдиреНрдп рд╕рдорд╛рдкрди рдмрд┐рдВрджреБ рд╣реИред </font><font style="vertical-align: inherit;">рдкрд╛рдиреА рдХреЗ рдиреАрдЪреЗ рдХреА рдХреЛрд╢рд┐рдХрд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsValidDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !cell.IsUnderwater; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдордиреЗ рдХреЗрд╡рд▓ рдПрдХ рдЗрдХрд╛рдИ рдХреЛ рд╕реЗрд▓ рдореЗрдВ рдЦрдбрд╝реЗ рд╣реЛрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреАред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рд╡рд╣ рд╡реНрдпрд╕реНрдд рд╣реИ рддреЛ рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsValidDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell cell</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !cell.IsUnderwater &amp;&amp; !cell.Unit; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ </font></font><code>HexGameUI.DoPathfinding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдорд╛рдиреНрдп рд╕рдорд╛рдкрди рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoPathfinding</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UpdateCurrentCell()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentCell &amp;&amp; selectedUnit.IsValidDestination(currentCell)) { grid.FindPath(selectedUnit.Location, currentCell, <span class="hljs-number"><span class="hljs-number">24</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { grid.ClearPath(); } } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рдкреНрддрд┐ рдмрд┐рдВрджреБ рдкрд░ рд▓реЗ рдЬрд╛рдПрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╡реИрдз рд░рд╛рд╕реНрддрд╛ рд╣реИ, рддреЛ рд╣рдо рджрд╕реНрддреЗ рдХреЛ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдкрд░ рд▓реЗ рдЬрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВред </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХрдм рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рдПрдХ рдирдИ рд░реАрдб-рдУрдирд▓реА рдкреНрд░реЙрдкрд░реНрдЯреА рдореЗрдВ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>HasPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> HasPath { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> currentPathExists; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рджрд╕реНрддреЗ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><code>HexGameUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font></font><code>DoMove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЬрдм рдХреЛрдИ рдЖрджреЗрд╢ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдПрдХ рдЗрдХрд╛рдИ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдХреЛрдИ рд░рд╛рд╕реНрддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рдЯреБрдХрдбрд╝реА рдХреЗ рд╕реНрдерд╛рди рдХреЛ рдмрджрд▓ рджреЗрдВред </font><font style="vertical-align: inherit;">рдЬрдмрдХрд┐ рд╣рдо рддреБрд░рдВрдд рджрд╕реНрддреЗ рдХреЛ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдкрд░ рднреЗрдЬ рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ, рд╣рдо рджрд╕реНрддреЗ рдХреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рднреА рддрд░рд╣ рд╕реЗ рдЬрд╛рдиреЗ рджреЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoMove</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (grid.HasPath) { selectedUnit.Location = currentCell; grid.ClearPath(); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдорд╛рдВрдб рд╕рдмрдорд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдЙрд╕ рдмрдЯрди 1 (рд░рд╛рдЗрдЯ рдХреНрд▓рд┐рдХ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЕрдЧрд░ рдЯреБрдХрдбрд╝реА рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рд╣рдо рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдмрдЯрди рджрдмрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!EventSystem.current.IsPointerOverGameObject()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">0</span></span>)) { DoSelection(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (selectedUnit) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetMouseButtonDown(<span class="hljs-number"><span class="hljs-number">1</span></span>)) { DoMove(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { DoPathfinding(); } } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ! </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдХрднреА-рдХрднреА рд╡реЗ рдХреБрдЫ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬрдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЙрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдЬрд┐рдирдореЗрдВ рдЯреБрдХрдбрд╝реА рд╣реБрдЖ рдХрд░рддреА рдереАред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирдпрд╛ рд╕реЗрдЯ рдХрд░рддреЗ рд╕рдордп рдкреБрд░рд╛рдиреЗ рд╕реНрдерд╛рди рдХреЛ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕реНрдХреНрд╡рд╛рдб рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рдЙрд╕рдХреЗ рдкреБрд░рд╛рдиреЗ рд╕реНрдерд╛рди рдкрд░ рд╕рд╛рдлрд╝ рдХрд░ рджреЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> HexCell Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> location; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location) { location.Unit = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } location = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Unit = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; transform.localPosition = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Position; } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджрд╕реНрддреЛрдВ рд╕реЗ рдмрдЪреЗрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ рдЕрдм рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЙрд╕реЗ рдЦреЛрдЬрдирд╛ рдФрд░ рдЗрдХрд╛рдЗрдпрд╛рдБ рдорд╛рдирдЪрд┐рддреНрд░ рдкрд░ рдЯреЗрд▓реАрдкреЛрд░реНрдЯ рдХрд░ рд╕рдХрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрджреНрдпрдкрд┐ рд╡реЗ рдЙрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдкрд░ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рджрд╕реНрддреЗ рд╣реИрдВ, рд░рд╛рд╕реНрддреЗ рдореЗрдВ рдЦрдбрд╝реЗ рдЯреБрдХрдбрд╝реА рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/519/3d8/7dd/5193d87dd25bfa2fbc9e0ba26529b926.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЗ рдореЗрдВ</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрдХрд╛рдЗрдпреЛрдВ </font><i><font style="vertical-align: inherit;">рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</font></i><font style="vertical-align: inherit;"> рдПрдХ рд╣реА рдЧреБрдЯ рдХреА рдЗрдХрд╛рдЗрдпрд╛рдВ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЛрдИ рдЧреБрдЯ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЖрдЗрдП рд╕рднреА рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдПрдХ-рджреВрд╕рд░реЗ рд╕реЗ рдЕрд▓рдЧ рд╣реЛрдиреЗ рдФрд░ рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рд╡реНрдпрд╕реНрдд рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд▓рдВрдШрди рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( neighbor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || neighbor.SearchPhase &gt; searchFrontierPhase ) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (neighbor.IsUnderwater || neighbor.Unit) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f3c/f3b/698/f3cf3b698191010f55c0c994d3e324d8.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрдЪреЗрдВ рдЯреБрдХрдбрд╝реА </font></font></i> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднрд╛рдЧ 19: рдореЛрд╢рди рдПрдирд┐рдореЗрд╢рди </font></font></h1><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛рддреНрд░рд╛ рдХреЗ рдорд╛рд░реНрдЧ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рд╕реЗрдирд╛ рдХреЛ рдХрд░реНрд╡реНрд╕ рдкрд░ рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВред </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рд╕реИрдирд┐рдХреЛрдВ рдХреЛ рдЖрдВрджреЛрд▓рди рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреЗ рд╣реИрдВред </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рдкрдЯрд░рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЗрд▓реАрдкреЛрд░реНрдЯреЗрд╢рди рдХреЗ рдмрдЬрд╛рдп рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдмрд╛рдзреНрдп рдХрд░реЗрдВрдЧреЗред </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a08/e41/a4f/a08e41a4fd0e90ea26dc11f16ff518f2.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЗ рдореЗрдВ рджрд╕реНрддреЗ</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддреЗ рдореЗрдВ рд╣рд▓рдЪрд▓ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рднрд╛рдЧ рдореЗрдВ, рд╣рдордиреЗ рдЗрдХрд╛рдЗрдпреЛрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЛ рдЬреЛрдбрд╝рд╛ред </font><font style="vertical-align: inherit;">рдпрджреНрдпрдкрд┐ рд╣рдордиреЗ рд╡реИрдз рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рд░реНрдЧ рдХреА рдЦреЛрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛, рдХрдорд╛рдВрдб рджреЗрдиреЗ рдХреЗ рдмрд╛рдж, рд╕реИрдирд┐рдХреЛрдВ рдиреЗ рдмрд╕ рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдХреЛ рдЯреЗрд▓реАрдкреЛрд░реНрдЯ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдкрд╛рдпрд╛ рдкрде рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЗрд╕ рдкрде рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдФрд░ рдПрдХ рдПрдиреАрдореЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рджрд╕реНрддреЗ рдХреЛ рд╕реЗрд▓ рд╕реЗ рд╕реЗрд▓ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдПрдирд┐рдореЗрд╢рди рджреЗрдЦрдиреЗ рдХреЗ рдмрд╛рдж рд╕реЗ рдпрд╣ рдиреЛрдЯрд┐рд╕ рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ рдХрд┐ рджрд╕реНрддреЗ рдХреИрд╕реЗ рдЪрд▓реЗ рдЧрдП, рд╣рдо рднреА рдЧрд┐рдЬрд╝реЛрд╕ рдХреА рдорджрдж рд╕реЗ рдпрд╛рддреНрд░рд╛ рдХрд┐рдП рдЧрдП рд░рд╛рд╕реНрддреЗ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╣рдо рдЖрдЧреЗ рдмрдврд╝реЗрдВ, рд╣рдореЗрдВ рддреНрд░реБрдЯрд┐ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЛрдбрд╝реЛрдВ рдХреЗ рд╕рд╛рде рддреНрд░реБрдЯрд┐ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдУрд╡рд░рд╕рд╛рдЗрдЯ рдХреЗ рдХрд╛рд░рдг, рд╣рдо рдЙрд╕ рдкрд╛рдареНрдпрдХреНрд░рдо рдХреА рдЧрд▓рдд рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕ рдкрд░ рд╕реЗрд▓ рдкрд╣реБрдВрдЪреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рджрд╕реНрддреЗ рдХреА рдЧрддрд┐ рд╕реЗ рдХреБрд▓ рджреВрд░реА рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдХреЗ рдкрд╛рдареНрдпрдХреНрд░рдо рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рддреЗ рд╣реИрдВ</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mrow" id="MJXp-Span-5"><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдФрд░ рд╢реЗрд╖ рдХреЛ рдЫреЛрдбрд╝рдирд╛ред </font><font style="vertical-align: inherit;">рддреНрд░реБрдЯрд┐ рддрдм рд╣реЛрддреА рд╣реИ рдЬрдм рд╕реЗрд▓ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдкреНрд░рддрд┐ рдЪрд╛рд▓ рдХреЗ рд╕рднреА рд╢реЗрд╖ рдЖрдВрджреЛрд▓рди рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдмрд┐рд▓реНрдХреБрд▓ рдЦрд░реНрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдХреА рд▓рд╛рдЧрдд 1 рд╣реЛрддреА рд╣реИ, рдФрд░ рдЧрддрд┐ 3 рд╣реЛрддреА рд╣реИ, рддреЛ рд╣рдо рдкреНрд░рддрд┐ рдмрд╛рд░реА рддреАрди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдореМрдЬреВрджрд╛ рдЧрдгрдирд╛ рдХреЗ рд╕рд╛рде, рд╣рдо рдкрд╣рд▓реЗ рдХрджрдо рдореЗрдВ рдХреЗрд╡рд▓ рджреЛ рдХрджрдо рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рддреАрд╕рд░реЗ рдЪрд░рдг рдХреЗ рд▓рд┐рдП</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.407ex" height="2.66ex" viewBox="0 -832 3189.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-64" x="1695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2F" x="2219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-73" x="2719" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1">t = d / s</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдШ </font></font></span><span class="MJXp-mrow" id="MJXp-Span-12"><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд╕ </font></font></span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 </font></font></span><span class="MJXp-mrow" id="MJXp-Span-17"><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3 </font></font></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-21"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.254ex" height="2.66ex" viewBox="0 -832 7859.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-64" x="1695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2F" x="2219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-73" x="2719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="3466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-33" x="4523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2F" x="5023" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-33" x="5524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="6302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-31" x="7358" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">t = d / s = 3 / 3 = 1</script>  ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d80/9ec/098/d809ec098cac1850cf16d47ce45ed030.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЪрд╛рд▓ рдХреЗ рд╕рд╛рде рдЪрд▓рдиреЗ рдХреА рдЕрднрд┐рд╡реНрдпрдХреНрдд рд▓рд╛рдЧрдд, рдЧрддрд┐ 3 рдЪрд╛рд▓</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рд╕рд╣реА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рд╕реЗ рд╕реАрдорд╛ рдХреЛ рдПрдХ рдХрджрдо </font><i><font style="vertical-align: inherit;">рдЖрдЧреЗ рдмрдврд╝рд╛рдиреЗ рдХреА</font></i><font style="vertical-align: inherit;"> рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕ рдХрджрдо рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рджреВрд░реА рдХреЛ рдХрдо рдХрд░рдХреЗ 1 рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдлрд┐рд░ рддреАрд╕рд░реЗ рдЪрд░рдг рдХреЗ рд▓рд┐рдП рдХрджрдо рд╣реЛрдЧрд╛</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3 </font></font></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.686ex" height="2.66ex" viewBox="0 -832 5031.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-32" x="1695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2F" x="2196" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-33" x="2696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="3474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-30" x="4531" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3">t = 2 / 3 = 0</script><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/656/291/37e/65629137e3267e033d1f5f6d3fd1f724.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣реА рдореВрд╡реНрд╕</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдЧрдгрдирд╛ рдлреЙрд░реНрдореВрд▓рд╛ рдХреЛ рдмрджрд▓рдХрд░ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mrow" id="MJXp-Span-39"><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд╕</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.219ex" height="2.66ex" viewBox="0 -832 5691.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-3D" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-28" x="1695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-64" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2212" x="2830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-31" x="3831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-29" x="4332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2F" x="4721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-73" x="5222" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4">t = (d - 1) / s</script>  ред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди Vnesom </font></font><code>HexGrid.Search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Search</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HexCell fromCell, HexCell toCell, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (searchFrontier.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { тАж <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> currentTurn = (current.Distance - <span class="hljs-number"><span class="hljs-number">1</span></span>) / speed; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexDirection d = HexDirection.NE; d &lt;= HexDirection.NW; d++) { тАж <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distance = current.Distance + moveCost; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turn = (distance - <span class="hljs-number"><span class="hljs-number">1</span></span>) / speed; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (turn &gt; currentTurn) { distance = turn * speed + moveCost; } тАж } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдЪрд╛рд▓ рдХреЗ рдирд┐рд╢рд╛рди рднреА рдмрджрд▓рддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPathExists) { HexCell current = currentPathTo; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current != currentPathFrom) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turn = (current.Distance - <span class="hljs-number"><span class="hljs-number">1</span></span>) / speed; тАж } } тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде, рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рдкрде ,1 рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдЗрд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдЦреЛрдЬ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЪрд╛рд▓реВ рд░рд╣рддрд╛ рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддрд╛ рдорд┐рд▓ рд░рд╣рд╛ рд╣реИ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд╛рд╕реНрддреЗ рдХреЗ рд╕рд╛рде рдЪрд▓рдирд╛ рд╕реНрдХреНрд╡рд╛рдб рдХрд╛ рдХрд╛рдо рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ рд░рд╛рд╕реНрддрд╛ рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣реИ </font></font><code>HexGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рддреЛ рдЪрд▓реЛ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдореЗрдВ рдПрдХ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╡рд╣ рдЗрд╕реЗ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рдкреВрд▓ рд╕реЗ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдЧрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рд░рд╛рд╕реНрддрд╛ рд╣реИ рддреЛ рд╡рд╛рдкрд╕ рдЖ рд╕рдХрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;HexCell&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!currentPathExists) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } List&lt;HexCell&gt; path = ListPool&lt;HexCell&gt;.Get(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдВрддрд┐рдо рд╕реЗрд▓ рд╕реЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдПрдХ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдкрде рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рдХреЗ рд╕реВрдЪреА рдХреЛ рднрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдкрде рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рддреЗ рд╕рдордп рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br><br><pre> <code class="cs hljs"> List&lt;HexCell&gt; path = ListPool&lt;HexCell&gt;.Get(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexCell c = currentPathTo; c != currentPathFrom; c = c.PathFrom) { path.Add(c); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ рдкреВрд░реЗ рд░рд╛рд╕реНрддреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (HexCell c = currentPathTo; c != currentPathFrom; c = c.PathFrom) { path.Add(c); } path.Add(currentPathFrom); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдореЗрдВ рд░рд╛рд╕реНрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЙрд╕рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рд╕рд╣рдЬ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рд╕реВрдЪреА рдХреЛ рдлреНрд▓рд┐рдк рдХрд░реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рд╢реБрд░реВ рд╕реЗ рдЕрдВрдд рддрдХ рдЪрд▓реЗред</font></font><br><br><pre> <code class="cs hljs"> path.Add(currentPathFrom); path.Reverse(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path;</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЛрд╢рди рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рдЙрд╕реЗ рдкрде рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рдиреЗ рдХрд╛ рдЖрджреЗрд╢ рджреЗ рд░рд╣реЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рд╣рдо рдмрд╕ рдЙрд╕реЗ рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдХреЗ рд▓рд┐рдП рдЯреЗрд▓реАрдкреЛрд░реНрдЯ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рд╕реВрдЪреА рдХреЛ рддреБрд░рдВрдд рдкреВрд▓ рдореЗрдВ рдирд╣реАрдВ рд▓реМрдЯрд╛рдПрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХреБрдЫ рд╕рдордп рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexUnit</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Travel</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;HexCell&gt; path</span></span></span><span class="hljs-function">)</span></span> { Location = path[path.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>]; } тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдВрджреЛрд▓рди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕реЗ рдмрджрд▓ рджреЗрддреЗ рд╣реИрдВ </font></font><code>HexGameUI.DoMove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдпрд╣ рд╡рд░реНрддрдорд╛рди рдкрде рдХреЗ рд╕рд╛рде рдПрдХ рдирдИ рд╡рд┐рдзрд┐ рдХреЛ рдмреБрд▓рд╛рдП, рдФрд░ рди рдХреЗрд╡рд▓ рдЗрдХрд╛рдИ рдХрд╛ рд╕реНрдерд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoMove</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (grid.HasPath) { <span class="hljs-comment"><span class="hljs-comment">// selectedUnit.Location = currentCell; selectedUnit.Travel(grid.GetPath()); grid.ClearPath(); } }</span></span></code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрде рджреГрд╢реНрдп </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╣рдо рджрд╕реНрддреЗ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ, рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд░рд╛рд╕реНрддреЗ рд╕рд╣реА рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ </font></font><code>HexUnit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрд╕ рдкрде </font><font style="vertical-align: inherit;">рдХреЛ </font><font style="vertical-align: inherit;">рдпрд╛рдж </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХрд╛ рдЖрджреЗрд╢ рджреЗрдХрд░ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЪрд▓рдирд╛ рд╣реЛрдЧрд╛, рддрд╛рдХрд┐ рдЗрд╕реЗ рдЧрд┐рдЬрд╝реНрдореЛрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд▓реНрдкрдирд╛ рдХреА рдЬрд╛ рд╕рдХреЗред</font></font><br><br><pre> <code class="cs hljs"> List&lt;HexCell&gt; pathToTravel; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Travel</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;HexCell&gt; path</span></span></span><span class="hljs-function">)</span></span> { Location = path[path.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>]; pathToTravel = path; }</code> </pre> <br><font style="vertical-align: inherit;"></font><code>OnDrawGizmos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рд░рд╛рд╕реНрддрд╛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдПрдХ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">(рдпрджрд┐ рдпрд╣ рдореМрдЬреВрдж рд╣реИ)ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЗрдХрд╛рдИ рдЕрднреА рддрдХ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдирд╣реАрдВ рд╣реБрдИ рд╣реИ, рддреЛ рдкрде рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП </font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдкреНрд▓реЗ рдореЛрдб рдореЗрдВ рдкреБрдирдГрд╕рдВрдХреНрд░рдордг рдХреЗ рдмрд╛рдж рд╕рдВрдкрд╛рджрди рдХреЗ рджреМрд░рд╛рди рдПрдХрддрд╛ рдХреА рдХреНрд░рдордмрджреНрдзрддрд╛ рдХреЗ рдХрд╛рд░рдг, рдпрд╣ рдПрдХ рдЦрд╛рд▓реА рд╕реВрдЪреА рднреА рд╣реЛ рд╕рдХрддреА рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmos</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pathToTravel == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || pathToTravel.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрде рджрд┐рдЦрд╛рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдкрде рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдХреНрд╖реЗрддреНрд░ рдмрдирд╛рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">2 рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рджрд╛рдпрд░реЗ рд╡рд╛рд▓рд╛ рдПрдХ рдЧреЛрд▓рд╛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmos</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pathToTravel == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || pathToTravel.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; pathToTravel.Count; i++) { Gizmos.DrawSphere(pathToTravel[i].Position, <span class="hljs-number"><span class="hljs-number">2f</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪреВрдВрдХрд┐ рд╣рдо рдЯреБрдХрдбрд╝реА рдХреЗ рд▓рд┐рдП рд░рд╛рд╕реНрддреЗ рджрд┐рдЦрд╛рдПрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХреЗ рд╕рднреА рдЕрдВрддрд┐рдо рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рджреЗрдЦ рдкрд╛рдПрдВрдЧреЗред </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dac/907/a7d/dac907a7da12a75436c7ae26956884bd.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрд┐рдЬрд╝рдореЛрд╕ рдиреЗ рдпрд╛рддреНрд░рд╛ рдХреЗ рдЕрдВрддрд┐рдо рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ред</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗрд▓ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдмреЗрд╣рддрд░ рдврдВрдЧ рд╕реЗ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд┐рдЫрд▓реА рдФрд░ рд╡рд░реНрддрдорд╛рди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдХреА рд░реЗрдЦрд╛ рдкрд░ рдПрдХ рд▓реВрдк рдореЗрдВ рдХрдИ рдЧреЛрд▓реЗ рдЦреАрдВрдЪрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рджреВрд╕рд░реА рд╕реЗрд▓ рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">0.1 рдЗрдХрд╛рдЗрдпреЛрдВ рдХреА рд╡реГрджреНрдзрд┐ рдХреЗ рд╕рд╛рде рд░реЗрдЦреАрдп рдкреНрд░рдХреНрд╖реЗрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддрд╛рдХрд┐ рд╣рдореЗрдВ рдкреНрд░рддрд┐ рдЦрдВрдб рджрд╕ рдЧреЛрд▓реЗ рдорд┐рд▓реЗрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { Vector3 a = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; Vector3 b = pathToTravel[i].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += <span class="hljs-number"><span class="hljs-number">0.1f</span></span>) { Gizmos.DrawSphere(Vector3.Lerp(a, b, t), <span class="hljs-number"><span class="hljs-number">2f</span></span>); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c2/46a/11c/5c246a11c0753d03b2572de5bfc297a4.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯ рддрд░реАрдХреЗ</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддреЗ рдореЗрдВ рдлрд┐рд╕рд▓рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЙрд╕реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЙрд░рдЖрдЙрдЯ рдмрдирд╛рдПрдВред </font><font style="vertical-align: inherit;">рдПрдХ рдЖрд░реЗрдЦрдг рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рджрд╕реНрддреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рд╡реЗрддрди рд╡реГрджреНрдзрд┐ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо 0.1 рд╕рдордп рдбреЗрд▓реНрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдФрд░ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдЬ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рджрд╕реНрддреЗ рдПрдХ рд╕реЗрд▓ рд╕реЗ рджреВрд╕рд░реЗ рдореЗрдВ рдПрдХ рд╕реЗрдХрдВрдб рдореЗрдВ рдЪрд▓реЗ рдЬрд╛рдПрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HexUnit</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { тАж <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { Vector3 a = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; Vector3 b = pathToTravel[i].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime) { transform.localPosition = Vector3.Lerp(a, b, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } } тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд▓рд┐рдП рд╡рд┐рдзрд┐ рдХреЗ рдЕрдВрдд рдореЗрдВ coroutine рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>Travel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рд╕рднреА рдореМрдЬреВрджрд╛ рдХреЛрд░рдЖрдЙрдЯреЛрдВ рдХреЛ рдмрдВрдж рдХрд░ рджреЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП рд╣рдо рдЧрд╛рд░рдВрдЯреА рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рджреЛ рдХреЛрд░рдЖрдЙрдЯ рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ, рдЕрдиреНрдпрдерд╛ рдпрд╣ рдмрд╣реБрдд рд╣реА рдЕрдЬреАрдм рдкрд░рд┐рдгрд╛рдо рджреЗрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Travel</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;HexCell&gt; path</span></span></span><span class="hljs-function">)</span></span> { Location = path[path.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>]; pathToTravel = path; StopAllCoroutines(); StartCoroutine(TravelPath()); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдПрдХ рд╕реЗрд▓ рдЪрд▓рдирд╛ рдмрд╣реБрдд рдзреАрдореА рд╣реИред </font><font style="vertical-align: inherit;">рдЦреЗрд▓ рдХреЗ рджреМрд░рд╛рди рдЦрд┐рд▓рд╛рдбрд╝реА рдЗрддрдиреЗ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЗрдВрддрдЬрд╛рд░ рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЖрдк рд╕реНрдХреНрд╡рд╛рдб рдЪрд╛рд▓ рдЧрддрд┐ рдХреЛ рдПрдХ рд╡рд┐рдиреНрдпрд╛рд╕ рд╡рд┐рдХрд▓реНрдк рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рдХреЗ рд▓рд┐рдП, рдЪрд▓реЛ рдПрдХ рд╕реНрдерд┐рд░рд╛рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдореИрдВрдиреЗ рдЙрд╕реЗ рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб 4 рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдореВрд▓реНрдп рд╕реМрдВрдкрд╛; </font><font style="vertical-align: inherit;">рдпрд╣ рдмрд╣реБрдд рддреЗрдЬрд╝ рд╣реИ, рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> travelSpeed = <span class="hljs-number"><span class="hljs-number">4f</span></span>; тАж <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { Vector3 a = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; Vector3 b = pathToTravel[i].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * travelSpeed) { transform.localPosition = Vector3.Lerp(a, b, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рд╕ рддрд░рд╣ рд╣рдо рдПрдХ рд╕рд╛рде рдХрдИ рд░рд╛рд╕реНрддреЛрдВ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕реА рддрд░рд╣ рд╣рдо рдХрдИ рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдпрд╛рддреНрд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЦреЗрд▓ рд░рд╛рдЬреНрдп рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рдЖрдВрджреЛрд▓рди рдЕрднреА рднреА рдЯреЗрд▓реАрдкреЛрд░реНрдЯреЗрд╢рди рд╣реИ, рдПрдирд┐рдореЗрд╢рди рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рджреГрд╢реНрдп рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпрд╛рдБ рддреБрд░рдВрдд рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░ рд▓реЗрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рддреБрдо рднреА рддрд░реАрдХреЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдПрдХ рдирдИ рдЪрд╛рд▓ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╡реЗ рдЖрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╡реЗ рдПрдХ рдирдП рд░рд╛рд╕реНрддреЗ рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд▓рд┐рдП рдиреЗрддреНрд░рд╣реАрди рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЪрд▓рддреЗ рд╕рдордп рдЗрдХрд╛рдЗрдпреЛрдВ рдпрд╛ рдкреВрд░реЗ рдпреВрдЖрдИ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдХреЗ рдЗрд╕рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдВрджреЛрд▓рдиреЛрдВ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдФрд░ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп рдРрд╕реА рддреНрд╡рд░рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛рдлреА рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрддреА рд╣реИред</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд▓рддреА рдЗрдХрд╛рдЗрдпрд╛рдБред </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдКрдВрдЪрд╛рдИ рдореЗрдВ рдЕрдВрддрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?</font></font></b> <div class="spoiler_text">        ,      .       ,           .        ,    .   ,      .      ,  Endless Legend,   ,         .     ,    . </div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрдХрд▓рди рдХреЗ рдмрд╛рдж рдХреА рд╕реНрдерд┐рддрд┐ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЙрд░рдЯреАрди рдХреА рдХрдорд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рд╣реИ рдХрд┐ рдкреНрд▓реЗ рдореЛрдб рдореЗрдВ рдкреБрди: рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдкрд░ рд╡реЗ "рдЬреАрд╡рд┐рдд" рдирд╣реАрдВ рд░рд╣рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЦреЗрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рд╣рдореЗрд╢рд╛ рд╕рдЪ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд╕реЗ рджрд╕реНрддреЛрдВ рдХреЛ рдЕрдкрдиреЗ рдЖрдЦрд┐рд░реА рд░рд╛рд╕реНрддреЗ рдореЗрдВ рдХрд╣реАрдВ рдЕрдЯрдХ рдЬрд╛рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рд╡реЗ рдЕрднреА рднреА рдШреВрдо рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдкреБрдирд░реНрдореВрд▓реНрдпрд╛рдВрдХрди рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдкреБрдирд░реНрд╕рдВрдпреЛрдЬрди рдХреЗ рдмрд╛рдж, рдЗрдХрд╛рдЗрдпрд╛рдВ рд╣рдореЗрд╢рд╛ рд╕рд╣реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реЛрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдореЗрдВ рдЙрдирдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдЕрджреНрдпрддрди рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>OnEnable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location) { transform.localPosition = location.Position; } }</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд┐рдХрдирд╛ рдЖрдВрджреЛрд▓рди </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрдВрджреНрд░ рд╕реЗ рдХреЛрд╢рд┐рдХрд╛ рдХреЗ рдХреЗрдВрджреНрд░ рддрдХ рдХреА рдЧрддрд┐ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдпрдВрддреНрд░рд╡рдд рджрд┐рдЦрддреА рд╣реИ рдФрд░ рджрд┐рд╢рд╛ рдореЗрдВ рддреЗрдЬ рдмрджрд▓рд╛рд╡ рдкреИрджрд╛ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдХрдИ рдЦреЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рдпрджрд┐ рдЖрдкрдХреЛ рдХрдо рд╕реЗ рдХрдо рдереЛрдбрд╝рд╛ рдпрдерд╛рд░реНрдерд╡рд╛рджреА рдЖрдВрджреЛрд▓рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рддреЛ рдЪрд▓рд┐рдП рдЖрдВрджреЛрд▓рди рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдереЛрдбрд╝рд╛ рдФрд░ рдЬреИрд╡рд┐рдХ рджрд┐рдЦреЗред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд╕рд▓реА рд╕реЗ рдкрд╕рд▓реА рдХреА рдУрд░ рдмрдврд╝рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд╕реНрддреЗ рдХреА рд╢реБрд░реБрдЖрдд рдХреЛрд╢рд┐рдХрд╛ рдХреЗ рдХреЗрдВрджреНрд░ рд╕реЗ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реЗрд▓ рдХрд┐рдирд╛рд░реЗ рдХреЗ рдордзреНрдп рдореЗрдВ рдЧреБрдЬрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЕрдЧрд▓реЗ рд╕реЗрд▓ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдХреЗрдВрджреНрд░ рдХреА рдУрд░ рдмрдврд╝рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╡рд╣ рдЕрдЧрд▓реЗ рдХрд┐рдирд╛рд░реЗ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рд╕рд┐рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЙрд╕реЗ рдкрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпреВрдирд┐рдЯ рдХреЛ рджрд┐рд╢рд╛ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреЗ рдкрд░ рд░рд╛рд╕реНрддрд╛ рдХрдЯ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣ рдкрде рдХреЗ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реИред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2bc/8f0/1b9/2bc8f01b93b55b7acab8d9f56dd6f4be.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рдирд╛рд░реЗ рд╕реЗ рдХрд┐рдирд╛рд░реЗ рддрдХ рдЬрд╛рдиреЗ рдХреЗ рддреАрди рддрд░реАрдХреЗ</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЙрддреНрдкрдиреНрди рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓ </font></font><code>OnDrawGizmos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрдирд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдХрд┐рдирд╛рд░реЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдкрдбрд╝реЛрд╕реА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдкрджреЛрдВ рдХреЗ рдФрд╕рдд рд╕реЗ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕реЗ рдореВрд▓реНрдп рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдкреНрд░рддрд┐ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдПрдХ рдХрд┐рдирд╛рд░реЗ рдХреА рдЧрдгрдирд╛ рдХрд░рдирд╛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХрд┐рдирд╛рд░реЗ рдХреЗ рдмрдЬрд╛рдп рд╣рдо рдЗрд╕рдХреА рд╕реНрдерд┐рддрд┐ рд▓реЗрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmos</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pathToTravel == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || pathToTravel.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Vector3 a, b = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { <span class="hljs-comment"><span class="hljs-comment">// Vector3 a = pathToTravel[i - 1].Position; // Vector3 b = pathToTravel[i].Position; a = b; b = (pathToTravel[i - 1].Position + pathToTravel[i].Position) * 0.5f; for (float t = 0f; t &lt; 1f; t += 0.1f) { Gizmos.DrawSphere(Vector3.Lerp(a, b, t), 2f); } } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдХреЗ рдХреЗрдВрджреНрд░ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рди рдХрд┐ рдХрд┐рдирд╛рд░реЗ рдкрд░ред </font><font style="vertical-align: inherit;">рдЖрдк рдЗрд╕ рдорд╛рдорд▓реЗ рдХреЗ рд╕рддреНрдпрд╛рдкрди рдХреЛ рд▓реВрдк рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдЗрддрдирд╛ рд╕рд░рд▓ рдХреЛрдб рд╣реИ рдХрд┐ рдХреЛрдб рдХреЛ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ рдереЛрдбрд╝рд╛ рдХрдо рдХрд░рдирд╛ рдЕрдзрд┐рдХ рд╕реНрдкрд╖реНрдЯ рд╣реЛрдЧрд╛ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmos</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { тАж } a = b; b = pathToTravel[pathToTravel.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += <span class="hljs-number"><span class="hljs-number">0.1f</span></span>) { Gizmos.DrawSphere(Vector3.Lerp(a, b, t), <span class="hljs-number"><span class="hljs-number">2f</span></span>); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/deb/466/4d4/deb4664d4f8bcffcc3839dddfaa0d792.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рдм-рдЖрдзрд╛рд░рд┐рдд</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрде рдкрд░рд┐рдгрд╛рдореА рдкрде zigzags рдХреА рддрд░рд╣ рдХрдо рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдЕрдзрд┐рдХрддрдо рдореЛрдбрд╝ рдХреЛрдг 120 ┬░ рд╕реЗ 90 ┬░ рддрдХ рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рдПрдХ рд╕реБрдзрд╛рд░ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо coroutine рдореЗрдВ рд╕рдорд╛рди рдкрд░рд┐рд╡рд░реНрддрди рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХреЗ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐ рдпрд╣ рдПрдиреАрдореЗрд╢рди рдореЗрдВ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a, b = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { <span class="hljs-comment"><span class="hljs-comment">// Vector3 a = pathToTravel[i - 1].Position; // Vector3 b = pathToTravel[i].Position; a = b; b = (pathToTravel[i - 1].Position + pathToTravel[i].Position) * 0.5f; for (float t = 0f; t &lt; 1f; t += Time.deltaTime * travelSpeed) { transform.localPosition = Vector3.Lerp(a, b, t); yield return null; } } a = b; b = pathToTravel[pathToTravel.Count - 1].Position; for (float t = 0f; t &lt; 1f; t += Time.deltaTime * travelSpeed) { transform.localPosition = Vector3.Lerp(a, b, t); yield return null; } }</span></span></code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдмрджрд▓рддреА рдЧрддрд┐ рдХреЗ рд╕рд╛рде рдЪрд▓рдирд╛</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдгреЛрдВ рдХреЛ рдХрд╛рдЯрдиреЗ рдХреЗ рдмрд╛рдж, рдкрде рдЦрдВрдбреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рджрд┐рд╢рд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛ рдЧрдИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╣рдо рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдЧрддрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдирддреАрдЬрддрди, рдЯреБрдХрдбрд╝реА рдХреА рдЧрддрд┐ рдЕрдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдмрджрд▓ рдЬрд╛рддреА рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдШрдЯрддрд╛ рд╣реИ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд▓ рд╕реАрдорд╛рдУрдВ рдХреЛ рдкрд╛рд░ рдХрд░рддреЗ рд╕рдордп рджрд┐рд╢рд╛ рдФрд░ рдЧрддрд┐ рдореЗрдВ рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдкрд░рд┐рд╡рд░реНрддрди рдХреБрд░реВрдк рджрд┐рдЦрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдмреЗрд╣рддрд░ рджрд┐рд╢рд╛ рдХрд╛ рдХреНрд░рдорд┐рдХ рдкрд░рд┐рд╡рд░реНрддрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рд╣рдо рд╕реИрдирд┐рдХреЛрдВ рдХреЛ рд╕реАрдзреА рд░реЗрдЦрд╛рдУрдВ рдХреЗ рдмрдЬрд╛рдп рдШрдЯрддрд╛ рдХреЗ рд╕рд╛рде рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдХреЗ рдЗрд╕рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдк рдЗрд╕рдХреЗ рд▓рд┐рдП рдмреЗрдЬрд╝рд┐рдпрд░ рдХрд░реНрд╡реНрд╕ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╣рдо рджреНрд╡рд┐рдШрд╛рддреАрдп рдмреЗрдЬрд╝рд┐рдпрд░ рд╡рдХреНрд░ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕ рдкрд░ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдХреЗрдВрджреНрд░ рдордзреНрдп рдирд┐рдпрдВрддреНрд░рдг рдмрд┐рдВрджреБ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрд╕рдиреНрди рдШрдЯрддрд╛ рдХреЗ рд╕реНрдкрд░реНрд╢рд░реЗрдЦрд╛ рдПрдХ рджреВрд╕рд░реЗ рдХреА рджрд░реНрдкрдг рдЫрд╡рд┐рдпрд╛рдВ рд╣реЛрдВрдЧреА, рдЕрд░реНрдерд╛рдд, рд╕рдВрдкреВрд░реНрдг рдкрде рдПрдХ рдирд┐рд░рдВрддрд░ рдЪрд┐рдХрдиреА рд╡рдХреНрд░ рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдЧрд╛ред</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a94/c46/0b8/a94c460b8e7b3fd2ecc3b4ea4e3225a9.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рдирд╛рд░реЗ рд╕реЗ рдХрд┐рдирд╛рд░реЗ рддрдХ</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рдХреНрд░ рдПрдХ рджреНрд╡рд┐рдШрд╛рдд рд╡рдХреНрд░ рдкрд░ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдПрдХ </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣рд╛рдпрдХ рд╡рд░реНрдЧ рдмрдирд╛рдПрдВ </font></font><code>Bezier</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЬреИрд╕рд╛ рдХрд┐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реНрд╡реНрд╕ рдФрд░ рд╕реНрдкреНрд▓рд┐рдиреНрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╕реВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-49" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдП </font></font></span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mn" id="MJXp-Span-52"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-54"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-63" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реА</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.208ex" height="2.901ex" viewBox="0 -935.7 12575.6 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="2112" y="0"></use><g transform="translate(2474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-32" x="550" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-41" x="3317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2B" x="4290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-32" x="5291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-28" x="5791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-31" x="6181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2212" x="6904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="7904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-29" x="8266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="8655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-42" x="9017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-2B" x="9998" y="0"></use><g transform="translate(10999,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMAIN-32" x="511" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/426481/&amp;usg=ALkJrhhxA8QMOXU2i37N8bERkojmL7GRaA#MJMATHI-43" x="11815" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5">(1 - t)^2 A + 2(1 - t) t B + t^2 C</script>  рдЬрд╣рд╛рдБ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mrow" id="MJXp-Span-66"><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> рдП </script>  ред <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mrow" id="MJXp-Span-69"><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдм</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> рдм </script>  рдФрд░ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рдпрдВрддреНрд░рдг рдмрд┐рдВрджреБ рд╣реИрдВ, рдФрд░ рдЯреА рдЗрдВрдЯрд░рдкреЛрд▓рд░ рд╣реИред</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8">C</script><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Bezier</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPoint</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 a, Vector3 b, Vector3 c, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> t</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> r = <span class="hljs-number"><span class="hljs-number">1f</span></span> - t; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r * r * a + <span class="hljs-number"><span class="hljs-number">2f</span></span> * r * t * b + t * t * c; } }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetPoint 0-1 рддрдХ рд╕реАрдорд┐рдд рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП?</font></font></b> <div class="spoiler_text">         0-1,    .          .  ,    <code>GetPointClamped</code> ,    <code>t</code> .      ,      <code>GetPointUnclamped</code> . </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рдХреНрд░ рдкрде рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><code>OnDrawGizmos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рд╣рдореЗрдВ рджреЛ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рддреАрди рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдВрджреБ - рдпрд╣, рд╕реЗрд▓, рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╣рдо рд╡рд░реНрддрдорд╛рди рдпрд╛рддреНрд░рд╛ рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣реЗ рдХрд╛ рдХреЗрдВрджреНрд░ рд╣реИ рдПрдХ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реИ </font></font><code>i - 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рдЪрдХреНрд░ 1. рдкрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдЕрдВрдХ рдХреЗ рд╕рднреА рдХреЗ рдмрд╛рдж, рд╣рдо рдЬрдЧрд╣ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ </font></font><code>Vector3.Lerp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░ </font></font><code>Bezier.GetPoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдЕрдВрдд рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ, рдЕрдВрдд рдФрд░ рдордзреНрдп рдмрд┐рдВрджреБ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдмрд╕ рд╕реЗрд▓ рдХреЗ рдХреЗрдВрджреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmos</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pathToTravel == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || pathToTravel.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { a = c; b = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = (b + pathToTravel[i].Position) * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * travelSpeed) { Gizmos.DrawSphere(Bezier.GetPoint(a, b, c, t), <span class="hljs-number"><span class="hljs-number">2f</span></span>); } } a = c; b = pathToTravel[pathToTravel.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = b; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += <span class="hljs-number"><span class="hljs-number">0.1f</span></span>) { Gizmos.DrawSphere(Bezier.GetPoint(a, b, c, t), <span class="hljs-number"><span class="hljs-number">2f</span></span>); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/140/79d/cae/14079dcae70b7b2522c137e0af848883.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреЗрдЬрд┐рдпрд░ рдХрд░реНрд╡реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдП рдЧрдП рд░рд╛рд╕реНрддреЗ рдПрдХ рдШреБрдорд╛рд╡рджрд╛рд░</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рд╛рд╕реНрддрд╛ рдЬреНрдпрд╛рджрд╛ рдмреЗрд╣рддрд░ рджрд┐рдЦрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдЙрд╕реА рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЗрдХрд╛рдЗрдпрд╛рдВ рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдПрдирд┐рдореЗрдЯреЗрдб рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { a = c; b = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = (b + pathToTravel[i].Position) * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * travelSpeed) { transform.localPosition = Bezier.GetPoint(a, b, c, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } a = c; b = pathToTravel[pathToTravel.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = b; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * travelSpeed) { transform.localPosition = Bezier.GetPoint(a, b, c, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } }</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдХрд░реНрд╡реНрд╕ рдХреЗ рд╕рд╛рде рдЪрд▓рддреЗ рд╣реИрдВред</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдиреАрдореЗрд╢рди рддрдм рднреА рд╕реБрдЧрдо рд╣реЛ рдЧрдпрд╛, рдЬрдм рдЯреБрдХрдбрд╝реА рдХреА рдЧрддрд┐ рдЕрд╕реНрдерд┐рд░ рд╣реИред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдЖрд╕рдиреНрди рдЦрдВрдбреЛрдВ рдХреЗ рд╡рдХреНрд░ рдХреА рд╕реНрдкрд░реНрд╢рд░реЗрдЦрд╛ рд╕рдВрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЧрддрд┐ рдирд┐рд░рдВрддрд░ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЧрддрд┐ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдзреАрд░реЗ-рдзреАрд░реЗ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ рдЯреБрдХрдбрд╝реА рд╕реЗрд▓ рд╕реЗ рдЧреБрдЬрд░рддреА рд╣реИ, рджрд┐рд╢рд╛ рдмрджрд▓рддреЗ рд╕рдордп рдзреАрдорд╛ рд╣реЛ рдЬрд╛рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╡рд╣ рд╕реАрдзрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЧрддрд┐ рд╕реНрдерд┐рд░ рд░рд╣рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рджрд╕реНрддреЗ рдиреЗ рд╢реВрдиреНрдп рдЧрддрд┐ рд╕реЗ рдЕрдкрдиреА рдпрд╛рддреНрд░рд╛ рд╢реБрд░реВ рдХреА рдФрд░ рд╕рдорд╛рдкреНрдд рдХреАред </font><font style="vertical-align: inherit;">рдпрд╣ рдкреНрд░рд╛рдХреГрддрд┐рдХ рд╣рд▓рдЪрд▓ рдХреА рдирдХрд▓ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдРрд╕реЗ рд╣реА рдЫреЛрдбрд╝ рджреЗрдВред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдордп рдЯреНрд░реИрдХрд┐рдВрдЧ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдмрд┐рдВрджреБ рддрдХ, рд╣рдордиреЗ 0 рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЦрдВрдб рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╢реБрд░реВ рдХрд░ рджреА, рдЬрдм рддрдХ рдХрд┐ рд╣рдо рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддреЗред 1. рд╕реНрдерд┐рд░ рдореВрд▓реНрдп рд╕реЗ рдмрдврд╝рдиреЗ рдкрд░ рдпрд╣ рдареАрдХ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░рд╛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕рдордп рдбреЗрд▓реНрдЯрд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдЬрдм рдПрдХ рдЦрдВрдб рдкрд░ рдЪрд▓рдирд╛ рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рд╕рдордп рдХреЗ рдбреЗрд▓реНрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреБрдЫ рд░рд╛рд╢рд┐ рд╕реЗ 1 рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред рдпрд╣ рдЙрдЪреНрдЪ рдлреНрд░реЗрдо рджрд░ рдкрд░ рдЕрджреГрд╢реНрдп рд╣реИ, рд▓реЗрдХрд┐рди рдХрдо рдлреНрд░реЗрдо рджрд░ рдкрд░ рдЭрдЯрдХреЗ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдордп рдХреА рд╣рд╛рдирд┐ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╢реЗрд╖ рд╕рдордп рдХреЛ рдПрдХ рд╕реЗрдЧрдореЗрдВрдЯ рд╕реЗ рджреВрд╕рд░реЗ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпрд╣ </font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреВрд░реЗ рдкрде рдХреЗ рд╕рд╛рде </font><font style="vertical-align: inherit;">рдЯреНрд░реИрдХрд┐рдВрдЧ </font><font style="vertical-align: inherit;">рдХреЗ </font><font style="vertical-align: inherit;">рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рди рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЦрдВрдб рдореЗрдВред рдлрд┐рд░ рдкреНрд░рддреНрдпреЗрдХ рдЦрдВрдб рдХреЗ рдЕрдВрдд рдореЗрдВ рд╣рдо рдЗрд╕реЗ 1 рд╕реЗ рдШрдЯрд╛рдПрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = <span class="hljs-number"><span class="hljs-number">0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; pathToTravel.Count; i++) { a = c; b = pathToTravel[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = (b + pathToTravel[i].Position) * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * travelSpeed) { transform.localPosition = Bezier.GetPoint(a, b, c, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } t -= <span class="hljs-number"><span class="hljs-number">1f</span></span>; } a = c; b = pathToTravel[pathToTravel.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].Position; c = b; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * traveSpeed) { transform.localPosition = Bezier.GetPoint(a, b, c, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдРрд╕рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдкрде рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕рдордп рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо рддреБрд░рдВрдд рдЪрд▓рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдВрдЧреЗ, рдФрд░ рдПрдХ рдлреНрд░реЗрдо рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдХреНрд░рд┐рдп рдирд╣реАрдВ рд░рд╣реЗрдВрдЧреЗред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Time.deltaTime * travelSpeed;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдЙрд╕ рд╕рдордп рдмрд┐рдВрджреБ рдкрд░ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдкрде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рдХреБрдЫ рд╕рдордп рдкрд╣рд▓реЗред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ, рдЕрдВрддрд░ рдлреНрд░реЗрдо рджрд░ рдкрд░ рднреА рдирд┐рд░реНрднрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЪрд▓реЛ рджрд╕реНрддреЗ рдХреЛ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдкрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкрде рдмрдирд╛рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж transform.localPosition = location.Position; }</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдУрд░рд┐рдПрдВрдЯреЗрд╢рди рдПрдиреАрдореЗрд╢рди </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдХрд╛рдЗрдпрд╛рдВ рдПрдХ рдЪрд┐рдХрдиреА рд╡рдХреНрд░ рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдмрдврд╝рдирд╛ рд╢реБрд░реВ рд╣реБрдИрдВ, рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЛрдВрдиреЗ рдЖрдВрджреЛрд▓рди рдХреА рджрд┐рд╢рд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдирд╣реАрдВ рдмрджрд▓рд╛ред </font><font style="vertical-align: inherit;">рдирддреАрдЬрддрди, рд╡реЗ рд╕рд░рдХрдирд╛ рд▓рдЧрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЖрдВрджреЛрд▓рди рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЖрдВрджреЛрд▓рди рдХреА рддрд░рд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдШреБрдорд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдЧреЗ рджреЗрдЦ рд░рд╣реЗ рд╣реИрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреИрд╕рд╛ рдХрд┐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реНрд╡реНрд╕ рдФрд░ рд╕реНрдкреНрд▓рд┐рдиреНрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рд╣рдо рдпреВрдирд┐рдЯ рдХреЗ рдУрд░рд┐рдПрдВрдЯреЗрд╢рди рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рдХреНрд░ рдХреЗ рд╡реНрдпреБрддреНрдкрдиреНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рджреНрд╡рд┐рдШрд╛рддреА рдмреЗрдЬрд╝рд┐рдпрд░ рд╡рдХреНрд░ рдХреЗ рд╡реНрдпреБрддреНрдкрдиреНрди рдХреЗ рд▓рд┐рдП рд╕реВрддреНрд░:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mn" id="MJXp-Span-74"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-77"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП </font></font></span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА </font></font></span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА </font></font></span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9">2 ((1 - t) (B - A) + t (C - B))</script>  ред<font style="vertical-align: inherit;"></font><code>Bezier</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рдЧрдгрдирд╛ </font><font style="vertical-align: inherit;">рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рд╡рд┐рдзрд┐ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDerivative</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector3 a, Vector3 b, Vector3 c, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> t </span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2f</span></span> * ((<span class="hljs-number"><span class="hljs-number">1f</span></span> - t) * (b - a) + t * (c - b)); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпреБрддреНрдкрдиреНрди рд╡реЗрдХреНрдЯрд░ рдЧрддрд┐ рдХреА рджрд┐рд╢рд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реАрдзреА рд░реЗрдЦрд╛ рдкрд░ рд╕реНрдерд┐рдд рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо </font></font><code>Quaternion.LookRotation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╕реНрдХреНрд╡рд╛рдб рдореЛрдбрд╝ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╣рдо рдЗрд╕реЗ рд╣рд░ рдХрджрдо рдкрд░ рдкреВрд░рд╛ рдХрд░реЗрдВрдЧреЗ </font></font><code>HexUnit.TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> transform.localPosition = Bezier.GetPoint(a, b, c, t); Vector3 d = Bezier.GetDerivative(a, b, c, t); transform.localRotation = Quaternion.LookRotation(d); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; тАж transform.localPosition = Bezier.GetPoint(a, b, c, t); Vector3 d = Bezier.GetDerivative(a, b, c, t); transform.localRotation = Quaternion.LookRotation(d); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>;</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпрд╛ рд░рд╛рд╕реНрддреЗ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреЛрдИ рдЧрд▓рддреА рдирд╣реАрдВ рд╣реИ?</font></font></b> <div class="spoiler_text">    ,        .    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mrow" id="MJXp-Span-95"><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0.278em; margin-right: 0.278em;">рдП</span></span></span></span><script type="math/tex" id="MathJax-Element-10"> рдП </script>  рдФрд░ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-mrow" id="MJXp-Span-98"><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0.278em; margin-right: 0.278em;">рдм</span></span></span></span><script type="math/tex" id="MathJax-Element-11"> рдм </script>  ,    .   ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">t</span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-103">0</span></span></span><script type="math/tex" id="MathJax-Element-12">t = 0</script> ,     ,      <code>Quaternion.LookRotation</code> .  ,    ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">t</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-107">0</span></span></span><script type="math/tex" id="MathJax-Element-13">t = 0</script>   .     .       ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">t</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-111">0</span></span></span><script type="math/tex" id="MathJax-Element-14">t > 0</script>    . <br>         ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">t</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-115">1</span></span></span><script type="math/tex" id="MathJax-Element-15">t < 1</script>  ред </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреБрдХрдбрд╝реА рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдкрде рдХреЗ рдЕрдВрдд рдореЗрдВ рдЗрд╕рдХреЗ рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдХреА рдЧреИрд░-рдЖрджрд░реНрд╢рддрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╣рдореЗрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдЗрд╕рдХреА рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдЕрдВрддрд┐рдо рд░реЛрдЯреЗрд╢рди рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рд╡рд╛рдИ рдореЗрдВ рдЗрд╕рдХреЗ рд░реЛрдЯреЗрд╢рди рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдХреА рдмрд░рд╛рдмрд░реА рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> transform.localPosition = location.Position; orientation = transform.localRotation.eulerAngles.y;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рдЗрдХрд╛рдЗрдпрд╛рдБ рдХреНрд╖реИрддрд┐рдЬ рдФрд░ рд▓рдВрдмрд╡рдд рджреЛрдиреЛрдВ рддрд░рд╣ рд╕реЗ рдЧрддрд┐ рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рджрд┐рдЦ рд░рд╣реА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╡реЗ рдЖрдЧреЗ рдФрд░ рдкреАрдЫреЗ рдХреА рдУрд░ рдЭреБрдХреЗрдВрдЧреЗ, рдврд▓рд╛рди рд╕реЗ рдЙрддрд░реЗрдВрдЧреЗ рдФрд░ рдЙрди рдкрд░ рдЪрдврд╝реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╡реЗ рд╣рдореЗрд╢рд╛ рд╕реАрдзреЗ рдЦрдбрд╝реЗ рд░рд╣рддреЗ рд╣реИрдВ, рд╣рдо рдпреВрдирд┐рдЯ рд╡реЗрдХреНрдЯрд░ рдХреЗ рдШрдЯрдХ Y рдХреЛ рдЗрдХрд╛рдИ рдХреЗ рд░реЛрдЯреЗрд╢рди рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╢реВрдиреНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> Vector3 d = Bezier.GetDerivative(a, b, c, t); dy = <span class="hljs-number"><span class="hljs-number">0f</span></span>; transform.localRotation = Quaternion.LookRotation(d); тАж Vector3 d = Bezier.GetDerivative(a, b, c, t); dy = <span class="hljs-number"><span class="hljs-number">0f</span></span>; transform.localRotation = Quaternion.LookRotation(d);</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реБрдП рджреЗрдЦрдирд╛</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдо рдмрд┐рдВрджреБ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреВрд░реЗ рд░рд╛рд╕реНрддреЗ рдореЗрдВ, рдЗрдХрд╛рдЗрдпрд╛рдБ рдЖрдЧреЗ рджреЗрдЦ рд░рд╣реА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╡реЗ рджреВрд╕рд░реА рджрд┐рд╢рд╛ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреА рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╡реЗ рддреБрд░рдВрдд рдЕрдкрдиреЗ рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВред рдЖрдВрджреЛрд▓рди рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╡реЗ рдорд╛рд░реНрдЧ рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рдореБрдбрд╝реЗрдВ рддреЛ рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣реА рджрд┐рд╢рд╛ рдореЗрдВ </font></font><code>LookAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрдЦрдирд╛ </font><font style="vertical-align: inherit;">рдЕрдиреНрдп рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдЗрдП рдПрдХ рд╡рд┐рдзрд┐ рдмрдирд╛рдПрдВ рдЬреЛ </font><font style="vertical-align: inherit;">рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдмрд┐рдВрджреБ рдкрд░ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рджрд╕реНрддреЗ рдХреЛ рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИред рдЖрд╡рд╢реНрдпрдХ рдШреБрдорд╛рд╡ рдХреЛ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>Transform.LookAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдкрд╣рд▓реЗ рдЯреБрдХрдбрд╝реА рдХреЗ рд╕рдорд╛рди рдКрд░реНрдзреНрд╡рд╛рдзрд░ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдмрд┐рдВрджреБ рдмрдирд╛рдХрд░ред рдЙрд╕рдХреЗ рдмрд╛рдж рд╣рдо рджрд╕реНрддреЗ рдХреЗ рдЙрдиреНрдореБрдЦреАрдХрд░рдг рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LookAt</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 point</span></span></span><span class="hljs-function">)</span></span> { point.y = transform.localPosition.y; transform.LookAt(point); orientation = transform.localRotation.eulerAngles.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдЯреБрдХрдбрд╝реА рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдмрджрд▓ рдЬрд╛рдП, рд╣рдо рд╡рд┐рдзрд┐ рдХреЛ рдПрдХ рдФрд░ рдХреЛрд░реБрдЯрд┐рди рдореЗрдВ рдмрджрд▓ рджреЗрдВрдЧреЗ рдЬреЛ рдЗрд╕реЗ рдПрдХ рд╕реНрдерд┐рд░ рдЧрддрд┐ рд╕реЗ рдШреБрдорд╛рдПрдЧрд╛ред рдореЛрдбрд╝ рдХреА рдЧрддрд┐ рдХреЛ рднреА рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдирд┐рд░рдВрддрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдШреБрдорд╛рд╡ рддреЗрдЬ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рд▓рдЧрднрдЧ 180 ┬░ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> rotationSpeed = <span class="hljs-number"><span class="hljs-number">180f</span></span>; тАж <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LookAt</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 point</span></span></span><span class="hljs-function">)</span></span> { тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЛрдбрд╝ рдХреЗ рддреНрд╡рд░рдг рдХреЗ рд╕рд╛рде рдЯрд┐рдВрдХрд░ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрдЧреЛрдЪрд░ рд╣реИред рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдмрд╕ рджреЛ рдЭреБрдХрд╛рд╡реЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛ред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдпрд╣ рджреЛ рдирдВрдмрд░реЛрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдЙрддрдирд╛ рд╕рд░рд▓ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреЛрдг рдкрд░рд┐рдкрддреНрд░ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 350 ┬░ рд╕реЗ 10 ┬░ рддрдХ рдХреЗ рд╕рдВрдХреНрд░рдордг рдХрд╛ рдкрд░рд┐рдгрд╛рдо 20 ┬░ рджрдХреНрд╖рд┐рдгрд╛рд╡рд░реНрдд рдШреБрдорд╛рд╡ рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рд╕рд░рд▓ рдкреНрд░рдХреНрд╖реЗрдк рдПрдХ рд╡рд╛рдорд╛рд╡рд░реНрдд рджрд┐рд╢рд╛ рдореЗрдВ 340 ┬░ рдШреВрдордиреЗ рдкрд░ рдордЬрдмреВрд░ рдХрд░реЗрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рд╣реА рд░реЛрдЯреЗрд╢рди рдмрдирд╛рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдЧреЛрд▓рд╛рдХрд╛рд░ рдкреНрд░рдХреНрд╖реЗрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреЛ рдЪрддреБрд░реНрдзрд╛рддреБрдХ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдирд╛ рд╣реИред рдЗрд╕рд╕реЗ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рдореЛрдбрд╝ рдЖрдПрдЧрд╛ред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рдХреЗ рдЪрддреБрд░реНрднреБрдЬ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрдирдХреЗ рдмреАрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕рдВрдХреНрд░рдордг рдмрдирд╛рддреЗ рд╣реИрдВ </font></font><code>Quaternion.Slerp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LookAt</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 point</span></span></span><span class="hljs-function">)</span></span> { point.y = transform.localPosition.y; Quaternion fromRotation = transform.localRotation; Quaternion toRotation = Quaternion.LookRotation(point - transform.localPosition); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Time.deltaTime; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime) { transform.localRotation = Quaternion.Slerp(fromRotation, toRotation, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } transform.LookAt(point); orientation = transform.localRotation.eulerAngles.y; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдХрд╛рдо рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рд░реЛрдЯреЗрд╢рди рдХреЗ рдХреЛрдг рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛, рдкреНрд░рдХреНрд╖реЗрдк рд╣рдореЗрд╢рд╛ 0 рд╕реЗ 1 рддрдХ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХрд╕рдорд╛рди рдХреЛрдгреАрдп рд╡реЗрдЧ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдкреНрд░рдХреНрд╖реЗрдк рдХреЛ рдзреАрдорд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рд░реЛрдЯреЗрд╢рди рдХрд╛ рдХреЛрдг рдмрдврд╝рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="cs hljs"> Quaternion fromRotation = transform.localRotation; Quaternion toRotation = Quaternion.LookRotation(point - transform.localPosition); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> angle = Quaternion.Angle(fromRotation, toRotation); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed = rotationSpeed / angle; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Time.deltaTime * speed; t &lt; <span class="hljs-number"><span class="hljs-number">1f</span></span>; t += Time.deltaTime * speed ) { transform.localRotation = Quaternion.Slerp(fromRotation, toRotation, t); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдг рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рдмрд╛рдж, рдпрджрд┐ рд╣рдо рд╢реВрдиреНрдп рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдореЛрдбрд╝ рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> angle = Quaternion.Angle(fromRotation, toRotation); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (angle &gt; <span class="hljs-number"><span class="hljs-number">0f</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed = rotationSpeed / angle; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( тАж ) { тАж } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм рд╣рдо </font><font style="vertical-align: inherit;">рджреВрд╕рд░реЗ рд╕реЗрд▓ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреА </font></font><code>LookAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд┐рддрд┐ рдХреЛ </font><font style="vertical-align: inherit;">рдЖрдЧреЗ рдмрдврд╝рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреЗрд╡рд▓ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдХреЗ </font><font style="vertical-align: inherit;">рдпреВрдирд┐рдЯ рдХреЗ рд░реЛрдЯреЗрд╢рди рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдПрдХрддрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреЙрд░рдЖрдЙрдЯ рд╢реБрд░реВ рдХрд░реЗрдЧреА </font></font><code>LookAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдЧреАред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LookAt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pathToTravel[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">].Position</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Time.deltaTime * travelSpeed; тАж }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕реНрдХреНрд╡рд╛рдб рдЕрдВрддрд┐рдо рд╕реЗрд▓ рдореЗрдВ рдЯреЗрд▓реАрдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, рд╡рд╣рд╛рдВ рдореБрдбрд╝рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рд░рд╛рд╕реНрддреЗ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╡рд╛рдкрд╕ рдЯреЗрд▓реАрдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдЪрд▓рдирд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо </font></font><code>Location</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрд░рдЯрд╛рдЗрди рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдкрд╣рд▓реЗ </font><font style="vertical-align: inherit;">рдПрдХ рд╕рдВрдкрддреНрддрд┐ рдХреЛ рдПрдХ рдореВрд▓реНрдп рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЯреЗрд▓реАрдкреЛрд░реНрдЯреЗрд╢рди рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╢реБрд░реБрдЖрдд </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдВ рдЯреБрдХрдбрд╝реА рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реЗрд▓ рдореЗрдВ рд╡рд╛рдкрд╕ </font><font style="vertical-align: inherit;">рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="cs hljs"> Vector3 a, b, c = pathToTravel[<span class="hljs-number"><span class="hljs-number">0</span></span>].Position; transform.localPosition = c; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LookAt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pathToTravel[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">].Position</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдореБрдбрд╝реЗрдВ</font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд┐рдЯрд╛рдирд╛ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдЬрд┐рд╕ рдЖрдВрджреЛрд▓рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рд╡рд┐рдзрд┐ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>OnDrawGizmos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ рд╣рдЯрд╛ рджреЗрдВ рдпрд╛ рд╣рдореЗрдВ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рд░рд╛рд╕реНрддреЗ рджреЗрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// void OnDrawGizmos () { // тАж // }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рд╣рдореЗрдВ рдЕрдм рдпрд╣ рдпрд╛рдж рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╣рдо рдХрд┐рд╕ рд░рд╛рд╕реНрддреЗ рдкрд░ рдмрдврд╝ рд░рд╣реЗ рдереЗ, рдЕрдВрдд рдореЗрдВ </font></font><code>TravelPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдХреЛ рдореБрдХреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TravelPath</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж ListPool&lt;HexCell&gt;.Add(pathToTravel); pathToTravel = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджрд╕реНрддреЗ рдХреЗ рдПрдирд┐рдореЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?</font></font></b> <div class="spoiler_text">         ,   .    3D-       .      .        ,     .       Mecanim,     <code>TravelPath</code> . </div></div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unitypackage</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi426481/">https://habr.com/ru/post/hi426481/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi426471/index.html">рдХреИрд╕реЗ рд╕реНрдкрд╛рдЗрд╡реЗрдпрд░ рдбреЗрдЯрд╛ рд▓реАрдХ</a></li>
<li><a href="../hi426473/index.html">Redux рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ред рд╣рд╛рдБ рдпрд╛ рдирд╣реАрдВ?</a></li>
<li><a href="../hi426475/index.html">рдорд┐рдпрд╛ - рд╕реНрдорд╛рд░реНрдЯрдлреЛрди рд╕реЗ рдЕрд╕рд┐рд╕реНрдЯреЗрдВрдЯ</a></li>
<li><a href="../hi426477/index.html">RTOS рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреВрд░реА рд╕рдЪреНрдЪрд╛рдИред рдЕрдиреБрдЪреНрдЫреЗрдж # 15ред рдореЗрдореЛрд░реА рд╡рд┐рднрд╛рдЬрди: рд╕реЗрд╡рд╛рдПрдБ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдБ</a></li>
<li><a href="../hi426479/index.html">рдорджрд░рдмреЛрд░реНрдб рдХреЗ рд▓рд┐рдП рд╣реЛрдордореЗрдб рдЯреЗрд╕реНрдЯ рдмреЗрдВрдЪ</a></li>
<li><a href="../hi426483/index.html">рдПрдХ рдЬреЛ рдЯреЗрд╕реНрд▓рд╛ рд╕реЗ рдЖрдЧреЗ рдирд┐рдХрд▓ рдЧрдпрд╛ред рдЕрдзрд┐рдХ рд▓рд╛рднрджрд╛рдпрдХ рдХреЗ рд▓рд┐рдП</a></li>
<li><a href="../hi426485/index.html">рдкреАрд╡реАрдПрд╕-рд╕реНрдЯреВрдбрд┐рдпреЛ рдХреЗ рд╕рд╛рде рддреАрд╕рд░рд╛ рдХреНрдпреВрдЯреА 5 рдЯреЗрд╕реНрдЯ</a></li>
<li><a href="../hi426487/index.html">рдЦрд░реЛрдВрдЪ рд╕реЗ рдкрд░реАрдХреНрд╖рдг рд╕реНрд╡рдЪрд╛рд▓рдиред рднрд╛рдЧ 1</a></li>
<li><a href="../hi426489/index.html">рдЕрднрд╛рдЬреНрдп рдФрд░ рдЕрдкрд░рд┐рдореЗрдп рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд╕рдВрдмрдВрдз рдкрд░</a></li>
<li><a href="../hi426491/index.html">рд╕реБрд░рдХреНрд╖рд╛ рд╕рдкреНрддрд╛рд╣ 39: Google+ рдХреА рдореГрддреНрдпреБ рдкрд░</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>