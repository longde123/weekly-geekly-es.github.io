<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚èÆÔ∏è üå± üîû Mettre √† jour la biblioth√®que SPPermission et hater ü§¥üèø üë©‚Äçüåæ üà∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- " Une sorte de biblioth√®que, quelqu'un mis √† jour ... Qu'est-ce que Haiter avait √† voir avec √ßa?" Pourquoi dois-je, un excellent d√©veloppeur, passer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mettre √† jour la biblioth√®que SPPermission et hater</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430886/">  - " <i>Une sorte de biblioth√®que, quelqu'un mis √† jour ... Qu'est-ce que Haiter avait √† voir avec √ßa?"</i>  <i>Pourquoi dois-je, un excellent d√©veloppeur, passer du temps sur cet article?</i>  " <br><br>  vous pourriez penser, mon cher ami.  Pas besoin de perdre du temps.  Ce n'est qu'une lecture en soir√©e avec une part de rires dr√¥les.  Le texte portera sur la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RequestPermission</a> et son myst√©rieux auteur. <br><a name="habracut"></a><br>  Commen√ßons par l'essentiel - le rebranding!  La biblioth√®que a √©t√© renomm√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SPPermission</a> .  Je ne sais pas si c'est le cas ou non, mais apr√®s avoir chang√© le nom, il s'est accroch√© au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sommet de GitHub</a> la deuxi√®me semaine.  Oui, il y a un tel sommet, il est conditionnel, mais des projets int√©ressants peuvent encore y √™tre trouv√©s.  L'auteur (personne myst√©rieuse), a mis √† jour les banni√®res sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page du projet</a> , la description, une √©norme section du <i>donat</i> ins√©r√©.  Quel gourmand! <br><br>  Mais passons au projet lui-m√™me: <br><br><img src="https://habrastorage.org/webt/g8/b4/pb/g8b4pbkznhzv5e-fhz_rifcodpo.gif" width="600"><br><br>  Comme vous pouvez le voir sur la taille √©norme des gifs <i>(4 m√©gaoctets non orthodoxes)</i> , le projet demande une liste d'autorisations, il y a des ic√¥nes, du texte.  Vous pouvez m√™me dire que √ßa a l'air bien. <br><br><h3>  Installer </h3><br>  Vous pouvez simplement faire glisser le code source vers votre projet, il s'agit d'un dossier de fichiers structur√©s.  Et vous <s>ne</s> pouvez <s>pas souffrir de b√™tises</s> pour construire la biblioth√®que en utilisant <i>SocoaPods</i> .  Je ne dirai pas le pour et le contre, pas cet article.  Ajoutez la ligne au fichier <i>pod</i> : <br><br><pre><code class="ruby hljs">pod <span class="hljs-string"><span class="hljs-string">'SPPermission'</span></span></code> </pre> <br>  et mettre √† jour les d√©pendances.  Il s'agit tr√®s probablement de l'√©tape la plus difficile √† venir) <br><br><h3>  Utiliser </h3><br>  Si vous venez de faire glisser les fichiers dans le projet, le module <i>SPPermission est</i> d√©j√† disponible.  Si vous <s>n'avez pas souffert de b√™tises, vous avez</s> utilis√© <i>ocoaPods</i> , alors vous devez importer la biblioth√®que dans le contr√¥leur: <br><br><pre> <code class="plaintext hljs">import SPPermission</code> </pre><br>  Maintenant, dans la fonction <i>viewDidAppear</i> , <i>nous</i> appelons la construction suivante: <br><br><pre> <code class="plaintext hljs">override func viewDidAppear(_ animated: Bool) { super.viewDidAppear(animated) SPPermission.Dialog.request( with: [.camera, .calendar, .notification], on: self ) }</code> </pre><br>  Nous passons la liste des autorisations et le contr√¥leur sur lequel nous pr√©senterons la bo√Æte de dialogue.  Reste √† d√©marrer le projet. <br><br><h3>  Personnalisation </h3><br>  Si vous, cher ami, avez travaill√© avec des tables ou des collections, les mots <i>Delegate</i> et <i>DataSource</i> ne vous feront pas peur.  Et si vous √™tes un peu obs√©d√© par les motifs, vous allez m√™me crier: <br><br>  - ¬´ <i>Wow!</i>  <i>Approche bas√©e sur le protocole!</i>  " <br><br>  Vous voyez!  Tu vois?  Mais j'ai dit que ce ne serait pas dr√¥le.  Mais une fois que j'ai lu cette ligne, passons √† autre chose. <br><br>  Commen√ßons par le protocole <i>SPPermissionDialogDataSource</i> , il sera responsable de la personnalisation de la bo√Æte de dialogue et permettra une int√©gration plus fid√®le de la biblioth√®que dans le projet.  Regardons les param√®tres: <br><br><pre> <code class="plaintext hljs">@objc public protocol SPPermissionDialogDataSource: class { @objc optional var dialogTitle: String { get } @objc optional var dialogSubtitle: String { get } @objc optional var dialogComment: String { get } @objc optional var allowTitle: String { get } @objc optional var allowedTitle: String { get } @objc optional var bottomComment: String { get } @objc optional var showCloseButton: Bool { get } @objc optional func name(for permission: SPPermissionType) -&gt; String? @objc optional func description(for permission: SPPermissionType) -&gt; String? @objc optional func image(for permission: SPPermissionType) -&gt; UIImage? }</code> </pre><br>  Pour √™tre honn√™te, je ne vois aucune raison de m'attarder sur tout le monde, puisque leurs noms parlent.  <i>Analysons</i> quelques uns ambigus: <i>bottomComment</i> et <i>showCloseButton</i> . <br><br>  Le premier param√®tre est responsable du commentaire sous la bo√Æte de dialogue, par exemple, vous pouvez mettre l'invite " <i>Glisser pour fermer</i> ": <br><br><img src="https://habrastorage.org/webt/o3/ju/ol/o3juolykpylxcrkpb1jumil_t5s.jpeg"><br><br>  Le deuxi√®me param√®tre, <i>showCloseButton</i> , est responsable du bouton de fermeture dans le coin sup√©rieur droit de l'√©cran.  J'ai aussi une photo avec un exemple: <br><br><img src="https://habrastorage.org/webt/dx/8z/va/dx8zva68cc4b6zwllgs5yk95ps0.jpeg"><br><br>  Certaines fonctions permettent de retourner <i>nil</i> , cela est n√©cessaire si vous n'avez pas besoin de personnaliser tous les en-t√™tes / ic√¥nes ou le texte.  Il suffit de retourner <i>nil</i> pour laisser la valeur par d√©faut: <br><br><pre> <code class="plaintext hljs">func description(for permission: SPPermissionType) -&gt; String? { if permission == .calendar { return "" } lse { return nil } }</code> </pre><br>  Il reste √† passer l'objet <i>DataSource</i> √† la structure principale: <br><br><pre> <code class="plaintext hljs">SPPermission.Dialog.request( with: [.camera, .calendar, .microphone, .notification], on: self, dataSource: self )</code> </pre><br><h3>  D√©l√©gu√© </h3><br>  Il vous permet de suivre certains √©v√©nements.  Regardons le protocole: <br><br><pre> <code class="plaintext hljs">@objc public protocol SPPermissionDialogDelegate: class { @objc optional func didHide() @objc optional func didAllow(permission: SPPermissionType) }</code> </pre><br>  Hmm, pas beaucoup ... Et pourtant, que faut-il d'autre?) Je ne pense pas que cela vaille la peine d'expliquer quels √©v√©nements les fonctions seront appel√©es.  Les noms parlent.  J'attire votre attention - le d√©l√©gu√© ne doit pas oublier d'indiquer: <br><br><pre> <code class="plaintext hljs">SPPermission.Dialog.request( with: [.camera, .calendar, .microphone, .notification], on: self, delegate: self dataSource: self )</code> </pre><br><h3>  Autorisations </h3><br><img src="https://habrastorage.org/webt/og/ow/qt/ogowqtraw3cz4vrwpjjupu4vmuo.jpeg"><br><br>  La liste sera r√©approvisionn√©e s'il y a des suggestions ou des critiques de la biblioth√®que, cela vaut la peine de cr√©er un nouveau num√©ro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br><br><h3>  Brioches </h3><br>  Il convient de pr√™ter attention √† une fonction utile: <br><br><pre> <code class="plaintext hljs">func isAllow(_ permission: SPPermissionType) -&gt; Bool</code> </pre><br>  Il vous fera savoir si l'utilisateur a donn√© l'autorisation.  Pour augmenter la fid√©lit√©, il est recommand√© de demander des autorisations non pas dans un bundle, mais avant utilisation.  Et pas plus de 3 ex!  Bien que je trouve difficile de trouver une situation o√π j'en ai besoin de plus) Utilisez ceci: <br><br><pre> <code class="plaintext hljs">let isAvailableCamera = SPPermission.isAllow(.amera)</code> </pre><br><h3>  Pourquoi mettre √† jour </h3><br>  L'ancienne version ressemblait √† √ßa, et il y a peut-√™tre un an, ce n'√©tait rien: <br><br><img src="https://habrastorage.org/files/270/1d0/037/2701d00370d74987ae03348cc59d24b0.gif" width="600"><br><br>  En fait, je ne l'ai pas mis √† jour pendant un an (enfin, ne pr√©tendez pas que vous ne compreniez pas que j'√©tais l'auteur de la biblioth√®que), mais plus r√©cemment, j'ai re√ßu une lettre ... bien que parlons de cette histoire un peu plus tard.  Nous faisons des affaires s√©rieuses ici! <br><br><h3>  L'architecture </h3><br>  Il y a environ un an, j'ai √©crit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article</a> dans lequel j'ai vaincu directement les amoureux de l'utilisation injustifi√©e de l'architecture.  Mais seulement je le pensais, et le message principal n'a pas √©t√© entendu.  Mon d√©sir de simplifier cette ann√©e ne s'est pas arr√™t√©.  Quand j'ai con√ßu la refonte, j'ai r√©alis√© que le projet devait √™tre r√©√©crit dans son ensemble.  Il s'agit d'une sorte de plate-forme de forage capable d'√©couter la radio, de couper des l√©gumes et un radiateur √† demi-d√©bit.  Je l'ai vu un an plus tard!  Maintenant, il me semble stupide d'√©crire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> , ayant un exemple si complexe.  Probablement dans une autre ann√©e, je vous faciliterai la t√¢che.  Voyons voir) <br><br><h3>  Alors, quelle est l'histoire? </h3><br>  Le tutoriel sobsna est termin√© et nous passons au bavardage.  Il y a quelques semaines, j'ai re√ßu une lettre me demandant d'expliquer le fonctionnement de la biblioth√®que.  C'√©tait une question √©trange, et depuis que j'ai abandonn√© la biblioth√®que, j'ai simplement r√©pondu avec un mod√®le: <br><br>  - ¬´ <i>Cher ami, je ne supporte pas la biblioth√®que maintenant, je n'ai pas de temps libre.</i>  <i>Meilleurs v≈ìux</i> ¬ª <br><br>  Je viens de l'√©crire correctement, uniquement √† Zabugorsk.  Et j'ai oubli√©.  En entrant dans le pavot, j'en ai vu une dizaine !!!  messages dans le dossier spam.  Eh bien, tout, √©videmment, certains portails ont diverg√©, comment puis-je me d√©sinscrire de leur mailing!  Et nnnet ... Le m√™me gars m'a √©crit, mais cette fois avec col√®re.  Dans des lettres, j'ai appris que je ne suis pas l'auteur de la biblioth√®que (par cons√©quent, je ne peux pas vous le dire), j'ai d√©couvert que des gens comme moi sont les personnes les plus terribles (et nous devons interdire l'enregistrement sur GitHub), j'ai d√©couvert que je voulais beaucoup d'argent pour mon travail sans valeur.  De l'argent?  Sur l'ancienne page, il n'y avait m√™me pas de formulaire de donut.  Mais j'ai compris le point, l'homme √©tait juste en col√®re. <br><br>  J'ai d√©cid√© d'aider, mais pas par gentillesse - j'√©tais incroyablement int√©ress√© par ce qui √©tait incroyable qui devait √™tre personnalis√©, ce qui a provoqu√© une √©norme vague de col√®re.  Il s'est av√©r√© qu'il cherchait une m√©thode qui est appel√©e lorsque la bo√Æte de dialogue est ferm√©e.  Il n'y avait aucune limite √† mon rire √† travers les larmes!  Le d√©l√©gu√© a √©t√© d√©crit dans la premi√®re version. <br><br>  L'histoire est triste, mais encore plus triste!  Oui oui  Je lui ai d√©crit en d√©tail personnellement comment utiliser les d√©l√©gu√©s, pour ainsi dire, le cours g√©n√©ral.  Je n'ai pas manqu√© l'occasion de m'amuser et j'ai dit que tout cela √©tait sur la page principale du projet depuis le tout d√©but.  J'ai eu la r√©ponse ... mais je voulais pleurer encore plus: <br><br>  ¬´ <i>J'ai r√©cemment commenc√© la programmation et je ne veux pas comprendre la documentation.</i>  <i>Au revoir</i> ¬ª <br><br>  J'ai ri longtemps. <br><br><h3>  Nous finissons </h3><br>  Un petit programme p√©dagogique a √©t√© introduit, pour les attentifs je laisserai des liens vers le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">laps de</a> temps <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">avec le design</a> (je l√®che sans scrupules les retraits et les couleurs des e-applications) et un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tutoriel</a> qui montrera tout ce que j'ai d√©crit ici, mais clairement. <br><br>  Toutes les migrations r√©ussies vers le nouveau Swift! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430886/">https://habr.com/ru/post/fr430886/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430876/index.html">D√©veloppement par le test: am√©liorer les comp√©tences</a></li>
<li><a href="../fr430878/index.html">PhpStorm disponible 2018.3</a></li>
<li><a href="../fr430880/index.html">Une autre impl√©mentation du traitement des donn√©es</a></li>
<li><a href="../fr430882/index.html">Xiaomi Aqara Switch refaire de ZigBee √† Z-Wave</a></li>
<li><a href="../fr430884/index.html">Imprimerie: pourquoi "LANIT-Integration" a ouvert sa propre "imprimerie"</a></li>
<li><a href="../fr430888/index.html">Est-il s√ªr d'utiliser des packages R pour travailler avec l'API des syst√®mes publicitaires</a></li>
<li><a href="../fr430890/index.html">O√π l'agilit√© est terrible, surtout la m√™l√©e</a></li>
<li><a href="../fr430892/index.html">La combinaison d'une approche multiplateforme et native dans le d√©veloppement d'applications mobiles</a></li>
<li><a href="../fr430894/index.html">Situation: les marques d√©pensent de plus en plus d'argent pour la publicit√© dans les podcasts - nous comprenons pourquoi</a></li>
<li><a href="../fr430896/index.html">Linux Foundation a √©tabli des fonds pour GraphQL et Ceph - pourquoi sont-ils n√©cessaires et √† quoi s'attendre d'eux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>