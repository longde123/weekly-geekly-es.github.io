<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤ğŸ» ğŸ˜® ğŸ˜® Sistem ISP, maafkan dan selamat tinggal! Mengapa dan bagaimana kami menulis panel kontrol server kami ğŸ’†ğŸ¾ ğŸ—£ï¸ ğŸ¤±ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai Kami adalah "Teknologi Hosting" dan 5 tahun yang lalu meluncurkan VDSina - hosting vds pertama yang dibuat khusus untuk pengembang. Kami berusaha ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistem ISP, maafkan dan selamat tinggal! Mengapa dan bagaimana kami menulis panel kontrol server kami</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/460107/"><img src="https://habrastorage.org/webt/af/l8/yk/afl8yk6hovufiwx1ml-8cwcgaoy.png" alt="gambar"><br><br>  Hai  Kami adalah "Teknologi Hosting" dan 5 tahun yang lalu meluncurkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">VDSina</a> - hosting vds pertama yang dibuat khusus untuk pengembang.  Kami berusaha untuk membuatnya nyaman, seperti DigitalOcean, tetapi dengan dukungan Rusia, metode pembayaran, dan server di Rusia.  Tapi DigitalOcean tidak hanya keandalan dan harga, tetapi juga layanan. <br><br>  Perangkat lunak dari ISPsystem ternyata adalah tali yang mengikat tangan kami dalam perjalanan ke layanan yang keren.  Tiga tahun lalu, kami menggunakan panel kontrol server Billmanager billing dan VMmanager dan dengan cepat menyadari bahwa hampir tidak mungkin menyediakan layanan yang baik tanpa panel kami sendiri. <br><a name="habracut"></a><br><br><h2>  Bagaimana ISPsystem membunuh kegunaan </h2><br>  <b>Bug</b> <br><br>  Kami tidak dapat memperbaiki bug sendiri - setiap kali kami harus menulis dukungan orang lain dan menunggu.  Solusi untuk masalah apa pun memerlukan respons dari perusahaan pihak ketiga. <br><br>  Dukungan sistem ISP merespons secara normal, tetapi perbaikan hanya datang melalui beberapa rilis, dan tidak selalu dan tidak semua.  Terkadang bug kritis diperbaiki selama beberapa minggu.  Kami harus meyakinkan pelanggan, meminta maaf, dan menunggu ISPsystem memperbaiki bug. <br><br>  <b>Ancaman downtime</b> <br><br>  Pembaruan dapat memunculkan downtime yang tidak terduga yang memicu bug baru. <br><br>  Setiap pembaruan adalah lotre: itu perlu untuk menutupi penagihan dan berkorban kepada para dewa pembaruan - beberapa kali pembaruan menyebabkan downtime selama 10-15 menit.  Pada saat itu, admin kami menjadi abu-abu di depan mata kami - kami tidak pernah tahu berapa lama downtime akan berlangsung dan tidak dapat memprediksi kapan ISPsystem memutuskan untuk merilis pembaruan baru. <br><br>  Pada generasi kelima, Billmanager menjadi lebih baik, tetapi untuk mendapatkan akses ke fitur yang diperlukan, saya harus menginstal beta, yang sudah diperbarui setiap minggu.  Jika ada yang rusak, Anda harus memberikan akses ke pengembang asing sehingga mereka memperbaiki sesuatu. <br><br>  <b>Antarmuka panel tidak nyaman</b> <br><br>  Semuanya dibagi menjadi panel yang berbeda dan dikendalikan dari tempat yang berbeda.  Misalnya, klien membayar melalui Billmanager, dan mereka harus reboot atau menginstal ulang VDS di VMManager.  Karyawan kami juga harus beralih antar windows untuk membantu klien, memeriksa beban di servernya atau melihat OS mana yang ia gunakan. <br><br>  Antarmuka seperti itu membutuhkan waktu - baik milik kita maupun pelanggan.  Tentang kenyamanan apa pun, seperti DigitalOcean, tidak ada pertanyaan dalam situasi seperti ini. <br><br>  <b>Siklus hidup pendek dengan pembaruan API yang sering</b> <br><br>  Kami menulis plugin kami sendiri - misalnya, sebuah plugin dengan metode pembayaran tambahan yang tidak ada di VMManager. <br><br>  Dalam beberapa tahun terakhir, VMManager memiliki siklus hidup yang relatif singkat, dan dalam versi baru nama-nama variabel atau fungsi di API dapat berubah secara sewenang-wenang - ini merusak plugin kami.  Dukungan untuk versi yang lebih lama dengan cepat diminimalkan dan harus diperbarui. <br><br>  <b>Anda tidak dapat memodifikasi</b> <br><br>  Lebih tepatnya, tetapi sangat tidak efisien.  Pembatasan lisensi tidak memungkinkan Anda untuk melakukan perubahan pada sumbernya, Anda hanya dapat menulis plugin.  Maksimum plugin adalah beberapa item menu, panduan langkah demi langkah.  Sistem ISP dipertajam untuk keserbagunaan, dan kami membutuhkan solusi khusus. <br><br>  Jadi keputusan untuk menulis panel Anda menjadi matang.  Kami menetapkan tujuan: <br><br><ul><li>  Cepat tanggapi kesalahan, bug, dan perbaiki sendiri, tanpa membuat klien menunggu. </li><li>  Secara bebas memodifikasi antarmuka untuk proses kerja dan kebutuhan pelanggan. </li><li>  Tingkatkan kegunaan dengan desain yang bersih dan mudah dipahami. </li></ul><br>  Dan mereka memulai pengembangan. <br><br><h2>  Arsitektur Panel Baru </h2><br>  Kami memiliki tim pengembangan mandiri, jadi kami menulis sendiri panel. <br>  Pekerjaan utama dilakukan oleh tiga insinyur - direktur teknis Sergey datang dengan arsitektur dan menulis agen server, Alexey membuat tagihan, dan Artysh frontend kami mengumpulkan frontend. <br><br><h3>  Langkah 1. Agen Server </h3><br><br>  Agen server adalah server web python yang mengelola perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">libvirt</a> , yang selanjutnya mengelola <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hypervisor Qemu-kvm</a> . <br><br>  Agen mengelola semua layanan di server: membuat, menghentikan, mencopot pemasangan vds, memasang sistem operasi, mengubah pengaturan, dan sebagainya melalui perpustakaan libvirt.  Pada saat publikasi, ini lebih dari empat puluh fungsi yang berbeda, yang kami pelengkap tergantung pada tugas dan kebutuhan klien. <br><br>  Pada prinsipnya, libvirt dapat dikelola langsung dari penagihan, tetapi memerlukan terlalu banyak kode tambahan dan kami memutuskan untuk mendistribusikan fungsi-fungsi ini antara agen dan penagihan-penagihan hanya membuat permintaan ke agen melalui API JSON. <br><br>  Agen adalah hal pertama yang kami lakukan, karena tidak memerlukan antarmuka apa pun dan dapat diuji langsung dari konsol server. <br><br>  <b>Apa yang diberikan agen server kepada kami:</b> sebuah layer muncul yang menyederhanakan masa pakai untuk semua orang - penagihan tidak perlu mengirim sejumlah besar perintah, tetapi hanya membuat permintaan.  Dan agen akan melakukan semua yang Anda butuhkan: misalnya, mengalokasikan ruang disk dan RAM. <br><br><h3>  Langkah 2. Penagihan </h3><br>  Untuk pengembang kami, Alex, ini bukan panel kontrol pertama - Alex sudah di hosting untuk waktu yang lama, jadi dia umumnya mengerti apa yang dibutuhkan klien dan apa yang dibutuhkan oleh hoster. <br><br>  Kami menyebut penagihan di antara kami sebagai "panel kontrol": ia tidak hanya berisi uang dan layanan, tetapi juga manajemen, dukungan pelanggan, dan banyak lagi lainnya. <br><br>  Untuk beralih dari perangkat lunak ISPSystem, perlu mempertahankan sepenuhnya fungsi sebelumnya untuk pelanggan, mentransfer semua tindakan pengguna keuangan dari tagihan lama ke yang baru, serta semua layanan dan komunikasi di antara mereka.  Kami mempelajari apa yang ada dalam produk saat ini, kemudian keputusan para pesaing, terutama DO dan Vultr.  Kami melihat kelemahan dan kelebihannya, mengumpulkan umpan balik dari orang-orang yang bekerja dengan produk lama dari ISPsystem. <br><br>  Dalam penagihan baru, dua tumpukan digunakan: PHP klasik, MySQL (dan di masa depan direncanakan untuk beralih ke PostgreSQL), Yii2 sebagai kerangka kerja di backend dan VueJS di depan.  Tumpukan bekerja secara independen satu sama lain, dikembangkan oleh orang yang berbeda, dan berkomunikasi menggunakan API JSON.  Untuk pengembangan, dulu dan sekarang kami menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PHPStorm</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">WebStorm</a> dari JetBrains dan sangat menyayangi mereka ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kawan</a> , halo!) <br><br>  Panel dirancang sesuai dengan prinsip modular: modul sistem pembayaran, modul pendaftar domain atau, misalnya, modul sertifikat SSL.  Anda dapat dengan mudah menambahkan fungsi baru atau menghapus yang lama.  Dasar untuk ekspansi diletakkan secara arsitektur, termasuk ke arah yang berlawanan, "ke besi." <br><img src="https://habrastorage.org/webt/b-/v7/7u/b-v77ugcsfi0zhdm3bbriq2oxsu.png" alt="gambar"><br>  <b>Apa yang kami dapatkan</b> : panel kontrol yang kami kontrol penuh.  Sekarang bug diperbaiki dalam hitungan jam, bukan minggu, dan fungsi baru diimplementasikan atas permintaan pelanggan, dan bukan atas permintaan ISPSystem. <br><br><h3>  Langkah 3. Antarmuka </h3><br><img src="https://habrastorage.org/webt/9i/n0/b2/9in0b2skk3doxpelwvckx7ebmei.png" alt="gambar"><br>  Antarmuka adalah gagasan tim kami. <br><br>  Pertama, kami melihat apa yang akan terjadi jika kami membuat add-on melalui ISPsystem API tanpa mengubah apa pun secara dramatis di antarmuka.  Ternyata begitu-begitu dan kami memutuskan untuk melakukan semuanya dari awal. <br><br>  Kami percaya bahwa hal utama adalah membuat antarmuka logis, dengan desain yang bersih dan minimalis, dan kemudian kami akan mendapatkan panel yang indah.  Susunan elemen dibahas dalam Megaplan, dan antarmuka yang dilihat pengguna di panel kontrol sekarang akan secara bertahap dilahirkan. <br><br>  Desain halaman penagihan pertama kali muncul, karena kami sudah membuat plugin pembayaran untuk ISPsystem. <br><br>  <b>Frontend</b> <br><br>  Mereka memutuskan untuk membuat panel aplikasi SPA - tidak menuntut sumber daya dan dengan pemuatan data yang cepat.  Artysh front-end kami memutuskan untuk menulisnya di Vue - pada saat itu Vue baru saja muncul.  Kami berasumsi bahwa kerangka kerja akan berkembang secara dinamis, seperti Bereaksi, setelah beberapa waktu komunitas Vue akan tumbuh dan lautan perpustakaan akan muncul.  Kami menginstalnya di Vue dan tidak menyesalinya - sekarang menambahkan ke depan fitur baru yang telah diprogram di backend membutuhkan sedikit waktu.  Kami akan memberi tahu Anda lebih banyak tentang panel frontend di artikel terpisah. <br><br>  <b>Komunikasi frontend dengan backend</b> <br><br>  Frontend diikat ke backend melalui pushies.  Saya harus berkeringat dan menulis handler saya sendiri, tetapi sekarang informasi pada halaman diperbarui hampir secara instan. <br><br>  <b>Apa yang terjadi:</b> antarmuka panel menjadi lebih mudah.  Kami membuatnya adaptif, dan pemuatan cepat memungkinkannya digunakan bahkan dari ponsel pada menit-menit terakhir sebelum take-off, tanpa menginstal aplikasi terpisah untuk bekerja dengan panel. <br><br><h3>  Langkah 4. Pengujian dan skema migrasi </h3><br>  Ketika semuanya dimulai dan tes pertama berlalu, pertanyaan tentang migrasi muncul.  Pertama-tama, kami menyiapkan penagihan dan mulai menguji kerjanya dengan agen server. <br><br>  Kemudian mereka menulis skrip sederhana yang mentransfer database dari tagihan lama ke yang baru. <br><br>  Saya harus menguji dan mengecek semuanya, karena data dituangkan ke dalam satu database baru dari tiga yang lama: Billmanager, VMmanager, dan manajer IPmanager.  Mungkin tes migrasi adalah hal yang paling sulit yang kami temui dalam proses pengembangan panel baru. <br><br>  Setelah memeriksa ulang, kami menutupi tagihan lama.  Migrasi data akhir adalah saat yang sangat mengkhawatirkan, tetapi, syukurlah, itu selesai dalam beberapa menit dan tanpa masalah nyata.  Ada bug kecil yang kami perbaiki dalam seminggu.  Waktu utama diambil dengan menguji apa yang terjadi. <br><br>  Kemudian kami mengirimkan surat kepada pelanggan dengan alamat panel baru dan penagihan dan melakukan pengalihan. <br><br>  <b>Intinya:</b> <b>IT'S HIDUP!</b> <br><br><h2>  Senang </h2><br>  Dari jam pertama perangkat lunak kami, kami merasakan semua kesenangan dari transisi.  Kode sepenuhnya milik kita dan dengan arsitektur yang nyaman, dan antarmuka yang bersih dan logis. <br><img src="https://habrastorage.org/webt/7a/hv/is/7ahvis7zx-1m4pcouleavsqbldo.png" alt="gambar"><br>  <i>Ulasan pertama setelah meluncurkan panel baru</i> <br><br>  Kami memulai proses transisi pada bulan Desember, menjelang Tahun Baru 2017, ketika ada beban paling sedikit untuk membuat transisi lebih mudah bagi pelanggan - hampir tidak ada yang bekerja pada malam liburan. <br><br>  Hal utama yang kami dapatkan selama transisi ke sistem kami (selain keandalan dan kenyamanan umum) adalah kemampuan untuk dengan cepat menambah fungsionalitas bagi pelanggan utama - untuk menjadi wajah mereka dan bukan keledai mereka. <br><br><h3>  Apa selanjutnya </h3><br>  Kami tumbuh, jumlah data, pelanggan, data pelanggan tumbuh.  Server memcached dan dua manajer antrian dengan tugas yang berbeda harus ditambahkan ke backend.  Ada caching dan antrian di ujung depan. <br><br>  Tentu saja, kami masih memiliki petualangan ketika kami mengembangkan dan mempersulit produk, misalnya, ketika kami menambahkan HighLoad. <br><br>  Pada artikel berikutnya kami akan memberi tahu Anda bagaimana tarif Hi-CPU diluncurkan: tentang perangkat keras, perangkat lunak, tugas apa yang kami selesaikan, dan apa yang kami lakukan. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/ud/xv/wf/udxvwfcz80j3nug11rxaguqelww.png"><br></a> <br><h3>  Berlangganan pengembang Instagram kami </h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/e5/as/-l/e5as-ltfnotkemk2dsqngygimra.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460107/">https://habr.com/ru/post/id460107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460091/index.html">Pencetakan langsung pada kaos dengan Epson SureColor SC - F dan perbedaannya dari pencetakan, decal, dan sublimasi layar sutra</a></li>
<li><a href="../id460095/index.html">Tertangkap larangan fork deepNude di gitlab.com</a></li>
<li><a href="../id460097/index.html">Matriks memiliki Anda: ikhtisar proyek menggunakan MITER ATT & CK</a></li>
<li><a href="../id460099/index.html">Penerapan pembelajaran mesin otomatis ke jaringan saraf dengan arsitektur transformator</a></li>
<li><a href="../id460101/index.html">Operasi XSS berbasis cookie | $ 2300 cerita Bug Bounty</a></li>
<li><a href="../id460109/index.html">Sudut: ketika Anda perlu melihat aplikasi, tetapi backend belum siap</a></li>
<li><a href="../id460111/index.html">Versi terbaru SAP Business One 9.3: apa yang telah berubah</a></li>
<li><a href="../id460113/index.html">Beberapa cerita dari kehidupan JSOC CERT, atau forensik Unbanal</a></li>
<li><a href="../id460115/index.html">Sepuluh tahun pemrograman di Erlang</a></li>
<li><a href="../id460117/index.html">Apakah pelanggan terbesar di Rusia jackpot besar atau sakit kepala? Pengalaman AGIMA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>