<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎨 🧛🏾 🚴🏾 À propos de l'étrange méthode pour économiser de l'espace sur le disque dur ▪️ 👃🏾 ☘️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un autre utilisateur souhaite écrire une nouvelle donnée sur le disque dur, mais il n'a pas assez d'espace libre pour cela. Je ne veux rien supprimer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>À propos de l'étrange méthode pour économiser de l'espace sur le disque dur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453332/"><p>  Un autre utilisateur souhaite écrire une nouvelle donnée sur le disque dur, mais il n'a pas assez d'espace libre pour cela.  Je ne veux rien supprimer non plus, car "tout est très important et nécessaire".  Et qu'en ferons-nous? </p><br><p>  Il n'a pas un tel problème.  Des téraoctets d'informations reposent sur nos disques durs, et cette quantité n'a pas tendance à diminuer.  Mais est-ce unique?  En fin de compte, après tout, tous les fichiers ne sont que des ensembles de bits d'une certaine longueur et, très probablement, le nouveau n'est pas très différent de celui qui est déjà stocké. </p><br><p> Il est clair que rechercher des informations déjà stockées sur le disque dur est une tâche, sinon un échec, du moins pas efficace.  D'un autre côté, parce que si la différence est petite, alors vous pouvez en ajuster un peu ... </p><br><p><img src="https://habrastorage.org/webt/sp/ho/gl/sphoglurqinhyzqmkyvbrgkox0y.jpeg" alt="Image de rematelier.ru"></p><br><p>  TL; DR - la deuxième tentative de parler d'une étrange méthode d'optimisation des données à l'aide de fichiers JPEG, maintenant sous une forme plus compréhensible. </p><a name="habracut"></a><br><h2 id="o-bitah-i-raznice">  À propos des bits et de la différence </h2><br><p>  Si nous prenons deux données complètement aléatoires, alors en moyenne la moitié des bits contenus y coïncident.  En effet, parmi les dispositions possibles pour chaque paire ('00, 01, 10, 11 '), exactement la moitié ont les mêmes valeurs, tout est simple ici. </p><br><p>  Mais bien sûr, si nous prenons simplement deux fichiers et en ajustons un sous le second, nous en perdrons un.  Si nous conservons les modifications, nous réinventerons simplement le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">codage delta</a> , qui même sans nous existe parfaitement, bien qu'il ne soit généralement pas utilisé dans le même but.  Vous pouvez essayer d'incorporer une séquence plus petite dans une plus grande, mais même ainsi, nous risquons de perdre des segments de données critiques lorsqu'ils sont utilisés de manière imprudente avec tout. </p><br><p>  Entre quoi et quoi alors la différence peut-elle être éliminée?  Eh bien, c'est-à-dire qu'un nouveau fichier enregistré par l'utilisateur n'est qu'une séquence de bits avec laquelle nous ne pouvons rien faire par lui-même.  Ensuite, il vous suffit de trouver ces bits sur le disque dur afin qu'ils puissent être modifiés sans avoir à stocker la différence, afin que vous puissiez survivre à leur perte sans conséquences graves.  Oui, et il est logique de modifier non seulement le fichier lui-même sur le FS, mais aussi certaines informations moins sensibles à l'intérieur.  Mais lequel et comment? </p><br><h3 id="metody-podgonki">  Méthodes d'ajustement </h3><br><p>  Les fichiers compressés avec perte viennent à la rescousse.  Tous ces fichiers jpeg, mp3 et autres, bien qu'ils soient à compression avec perte, contiennent un tas de bits disponibles pour un changement en toute sécurité.  Vous pouvez utiliser des techniques avancées en modifiant discrètement leurs composants dans différents domaines de codage.  Attends un instant.  Techniques avancées ... modification discrète ... de quelques morceaux à d'autres ... oui c'est presque de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">stéganographie</a> ! </p><br><p>  En effet, l'intégration d'une information dans une autre ressemble à ses méthodes, quoi qu'il arrive.  Il impressionne également l'invisibilité des changements apportés aux sens humains.  C’est là que les chemins divergent - c’est un secret: notre tâche est d’ajouter des informations supplémentaires sur le disque dur de l’utilisateur, cela ne fera que le blesser.  Oubliez plus. </p><br><p>  Par conséquent, bien que nous puissions les utiliser, nous devons apporter quelques modifications.  Et puis je vais les raconter et les montrer sur l'exemple d'une des méthodes existantes et du format de fichier commun. </p><br><h2 id="o-shakalah">  À propos des chacals </h2><br><p>  Si vous compressez, alors le plus compressible du monde.  Nous parlons bien sûr des fichiers JPEG.  Non seulement il y a une tonne d'outils et de méthodes existantes pour y incorporer des données, mais c'est le format graphique le plus populaire sur cette planète. </p><br><p><img src="https://habrastorage.org/storage/a555b701/12995be3/c44b46cd/8787f59d.png" alt="JPEG !!!"></p><br><p>  Néanmoins, afin de ne pas vous engager dans l'élevage de chiens, vous devez limiter votre champ d'activité dans des fichiers de ce format.  Personne n'aime les carrés monochromes dus à une compression excessive, vous devez donc vous limiter à travailler avec un fichier déjà compressé, en <strong>évitant le transcodage</strong> .  Plus précisément, avec des coefficients entiers qui subsistent après les opérations responsables de la perte de données - DCT et quantification, qui sont parfaitement affichés sur le schéma de codage (grâce au wiki de la Bibliothèque Nationale Bauman): <br><img src="https://habrastorage.org/webt/jj/zi/j8/jjzij8i5sln2tlbnyk6yibzbcb8.jpeg" alt="Encodage JPEG"></p><br><p>  Il existe de nombreuses méthodes d'optimisation possibles pour les fichiers JPEG.  Il y a une optimisation sans perte (jpegtran), il y a une optimisation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sans perte</a> , qui contribue en fait toujours, mais cela ne nous dérange pas.  En effet, si un utilisateur est prêt à intégrer une information dans une autre dans le but d'augmenter l'espace disque libre, il a soit optimisé ses images pendant une longue période, soit ne souhaite pas du tout le faire par crainte d'une perte de qualité. </p><br><h2 id="f5">  F5 </h2><br><p>  Dans de telles conditions, toute une famille d'algorithmes convient, que l'on retrouve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans cette bonne présentation</a> .  Le plus avancé d'entre eux est l'algorithme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F5</a> , rédigé par Andreas Westfeld, qui travaille avec les coefficients de la composante de luminosité, car l'œil humain est le moins sensible à ses changements.  De plus, il utilise une technique d'intégration basée sur l'encodage matriciel, qui permet de faire moins de changements lors de l'intégration de la même quantité d'informations, plus la taille du conteneur utilisé est grande. </p><br><p>  Les changements eux-mêmes se résument à une diminution de la valeur absolue des coefficients par unité dans certaines conditions (c'est-à-dire pas toujours), ce qui permet d'utiliser F5 pour optimiser le stockage des données sur le disque dur.  Le fait est que le coefficient après un tel changement occupera probablement un plus petit nombre de bits après le codage Huffman en raison de la distribution statistique des valeurs en JPEG, et les nouveaux zéros bénéficieront de leur codage en utilisant RLE. </p><br><p>  Les modifications nécessaires sont réduites à l'élimination de la partie responsable du secret (permutation de mot de passe), ce qui permet d'économiser des ressources et du temps d'exécution, et d'ajouter un mécanisme pour travailler avec de nombreux fichiers au lieu d'un à la fois.  Plus en détail, le processus de changement de lecteur est peu susceptible d'être intéressant, nous nous tournons donc vers la description de l'implémentation. </p><br><h2 id="vysokie-tehnologii">  Haute technologie </h2><br><p>  Pour démontrer le travail de cette approche, j'ai implémenté la méthode en C pur et effectué un certain nombre d'optimisations à la fois en termes de vitesse et de mémoire (vous ne pouvez pas imaginer combien ces images pèsent sans compression avant même DCT).  Les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">performances</a> multiplateformes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sont</a> obtenues en utilisant une combinaison des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bibliothèques libjpeg</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pcre</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tinydir</a> , pour lesquelles je les remercie.  Tout cela va être fait par make, donc les utilisateurs de Windows veulent installer Cygwin pour évaluation, ou gérer Visual Studio et les bibliothèques par eux-mêmes. </p><br><p>  L'implémentation est disponible sous la forme d'un utilitaire de console et d'une bibliothèque.  Plus d'informations sur l'utilisation de ce dernier peuvent être trouvées dans le fichier Lisez-moi dans le référentiel sur le github, un lien auquel je joindrai à la fin de l'article. </p><br><h3 id="kak-ispolzovat">  Comment utiliser? </h3><br><p>  Avec prudence.  Les images utilisées pour l'empaquetage sont sélectionnées par recherche d'expressions régulières dans le répertoire racine spécifié.  À la fin du fichier, vous pouvez déplacer, renommer et copier comme vous le souhaitez, modifier le fichier et les systèmes d'exploitation, etc. Cependant, vous devez être extrêmement prudent et ne pas modifier le contenu immédiat.  La perte de la valeur d'un seul bit peut entraîner l'impossibilité de restaurer les informations. </p><br><p>  À la fin du travail, l'utilitaire laisse un fichier d'archive spécial contenant toutes les informations nécessaires pour le déballage, y compris les données sur les images utilisées.  En soi, il pèse de l'ordre de quelques kilo-octets et n'a pas d'effet significatif sur l'espace disque occupé. </p><br><p>  Vous pouvez analyser la capacité possible en utilisant l'indicateur '-a': './f5ar -a [dossier de recherche] [expression régulière compatible Perl]'.  L'emballage se fait avec la commande './f5ar -p [dossier de recherche] [expression régulière compatible Perl] [fichier compressé] [nom d'archive]', et le décompactage avec './f5ar -u [fichier d'archive] [nom du fichier restauré]' ' . </p><br><h3 id="demonstraciya-raboty">  Démonstration de travail </h3><br><p>  Pour montrer l'efficacité de la méthode, j'ai téléchargé une collection de 225 photos de chiens absolument gratuites du service <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Unsplash</a> et déterré un grand pdf sur 45 mètres dans les documents du deuxième volume du Knut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Programming Art</a> . </p><br><p>  La séquence est assez simple: </p><br><pre><code class="bash hljs">$ du -sh knuth.pdf dogs/ 44M knuth.pdf 633M dogs/ $ ./f5ar -p dogs/ .*jpg knuth.pdf dogs.f5ar Reading compressing file... ok Initializing the archive... ok Analysing library capacity... <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 17.0s Detected somewhat guaranteed capacity of 48439359 bytes Detected possible capacity of upto 102618787 bytes Compressing... <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 39.4s Saving the archive... ok $ ./f5ar -u dogs/dogs.f5ar knuth_unpacked.pdf Initializing the archive... ok Reading the archive file... ok Filling the archive with files... <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 1.4s Decompressing... <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 21.0s Writing extracted data... ok $ sha1sum knuth.pdf knuth_unpacked.pdf 5bd1f496d2e45e382f33959eae5ab15da12cd666 knuth.pdf 5bd1f496d2e45e382f33959eae5ab15da12cd666 knuth_unpacked.pdf $ du -sh dogs/ 551M dogs/</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Captures d'écran pour les fans</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/-y/by/6h/-yby6h4ssyerd6uorenw23vfvu8.png" alt="Skrnsht"></p><br><p>  Le fichier décompressé est toujours possible et doit être lu: </p><br><p><img src="https://habrastorage.org/webt/0m/qu/js/0mqujsqlcrzzq3pdc1mook5znqq.png"></p></div></div><br><p>  Comme vous pouvez le voir, à partir des 633 + 36 == 669 mégaoctets de données d'origine sur le disque dur, nous sommes arrivés à un 551 plus agréable. Cette différence radicale s'explique par la diminution des valeurs de coefficient, qui affectent leur compression ultérieure sans perte: une diminution de seulement un par un peut calmement " couper "quelques octets du fichier résultant.  Cependant, il s'agit toujours d'une perte de données, bien que extrêmement faible, que vous devez supporter. </p><br><p>  Heureusement, ils ne sont pas complètement visibles à l'œil nu.  Sous le spoiler (parce que habrastorage ne peut pas gérer de gros fichiers), le lecteur peut évaluer la différence à la fois par l'œil et leur intensité, obtenue en soustrayant les valeurs du composant modifié de l'original: l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">original</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">avec les informations à l'intérieur</a> , la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">différence</a> (le gradateur de la couleur, la plus petite la différence dans le bloc ) </p><br><h2 id="vmesto-zaklyucheniya">  Au lieu d'une conclusion </h2><br><p>  En regardant toutes ces difficultés, acheter un disque dur ou tout télécharger sur le cloud peut sembler une solution beaucoup plus simple au problème.  Mais même si nous vivons maintenant dans une période aussi merveilleuse, rien ne garantit que demain, il sera toujours possible d'aller en ligne et de télécharger quelque part toutes vos données supplémentaires.  Ou venez au magasin et achetez-vous un autre disque dur de mille téraoctets.  Mais vous pouvez toujours utiliser des maisons déjà couchées. </p><br><p>  -&gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453332/">https://habr.com/ru/post/fr453332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr453322/index.html">Configurer le cluster nomade avec Consul et l'intégrer avec Gitlab</a></li>
<li><a href="../fr453324/index.html">Diode comme redresseur</a></li>
<li><a href="../fr453326/index.html">Comment automatiser la gestion de l'infrastructure informatique - discutez de trois tendances</a></li>
<li><a href="../fr453328/index.html">Dix ans sur un site distant</a></li>
<li><a href="../fr453330/index.html">Que faire si la RAM tombe en panne. Anamnèse et méthodes de traitement</a></li>
<li><a href="../fr453334/index.html">Parlez de PAKE</a></li>
<li><a href="../fr453336/index.html">Guide de sélection de la machine de gravure CNC</a></li>
<li><a href="../fr453338/index.html">Rust 1.35.0 Release: Implémentations de traits fonctionnels et autres innovations</a></li>
<li><a href="../fr453340/index.html">Perl 5.30 est sorti</a></li>
<li><a href="../fr453342/index.html">Mythes sur les employés distants que nous nous sommes détruits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>