<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¾â€ğŸ’¼ ğŸš¾ ğŸ‘ˆğŸ¾ æˆ‘ä»¬å‡»è´¥äº†Amperkaçš„GPRSæ¨¡å— ğŸ‘‹ ğŸŒ¿ ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨å‡»è´¥CANæ€»çº¿ä¹‹å‰ ï¼Œæˆ‘ä»¬å¿…é¡»ç ´åä¸‹ä¸€ä¸ªç¡¬ä»¶ï¼Œå³GPRSæ¨¡å—ã€‚ è¿™å°±æ˜¯å¥¹ä½œä¸ºå¼€å‘äººå‘˜çš„ç”Ÿæ´»-å§‹ç»ˆå¿…é¡»èµ¢å¾—åˆ«äººçš„æ”¯æŒï¼ˆåº”è¯¥ç¦æ­¢å¾®ç¬‘ï¼‰ã€‚ 

 å¯¹äºå…¶ä¸­ä¸€ä¸ªè‡ªå®šä¹‰é¡¹ç›®ï¼Œæˆ‘éœ€è¦æ·»åŠ ä½¿ç”¨SMSé€šè¿‡GSMæ§åˆ¶å’Œæ¥æ”¶é¥æµ‹åŠŸèƒ½ã€‚ æˆ‘æŸ¥çœ‹äº†å¯ç”¨é€‰é¡¹çš„åˆ—è¡¨ï¼Œå¹¶é€‰æ‹©äº†Amperkaçš„GPRS Shieldã€‚ ä¸ºä»€ä¹ˆä¸...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬å‡»è´¥äº†Amperkaçš„GPRSæ¨¡å—</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401721/"><img src="https://habrastorage.org/files/f8d/d05/ce9/f8dd05ce94d24dc283d1abcbffdb5906.jpg" alt="å›¾ç‰‡"><br> åœ¨å‡»è´¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CANæ€»çº¿ä¹‹å‰</a> ï¼Œæˆ‘ä»¬å¿…é¡»ç ´åä¸‹ä¸€ä¸ªç¡¬ä»¶ï¼Œå³GPRSæ¨¡å—ã€‚ è¿™å°±æ˜¯å¥¹ä½œä¸ºå¼€å‘äººå‘˜çš„ç”Ÿæ´»-å§‹ç»ˆå¿…é¡»èµ¢å¾—åˆ«äººçš„æ”¯æŒï¼ˆåº”è¯¥ç¦æ­¢å¾®ç¬‘ï¼‰ã€‚ <br><br> å¯¹äºå…¶ä¸­ä¸€ä¸ªè‡ªå®šä¹‰é¡¹ç›®ï¼Œæˆ‘éœ€è¦æ·»åŠ ä½¿ç”¨SMSé€šè¿‡GSMæ§åˆ¶å’Œæ¥æ”¶é¥æµ‹åŠŸèƒ½ã€‚ æˆ‘æŸ¥çœ‹äº†å¯ç”¨é€‰é¡¹çš„åˆ—è¡¨ï¼Œå¹¶é€‰æ‹©äº†Amperkaçš„GPRS Shieldã€‚ ä¸ºä»€ä¹ˆä¸å‘¢ å®ƒçœ‹èµ·æ¥åƒæ ·ï¼Œç”±ä¸€å®¶çŸ¥åå…¬å¸ç”Ÿäº§ï¼Œå…·æœ‰æŠ€æœ¯æ”¯æŒï¼Œä»·æ ¼ä¸ç«äº‰å¯¹æ‰‹æ²¡æœ‰å¤ªå¤§å·®å¼‚ï¼Œé€šå¸¸ç»™äººç•™ä¸‹å¾ˆå¥½çš„å°è±¡ã€‚ <br><br> ä½†äº‹å®ç¡®å®å¦‚æ­¤ã€‚ æ‚¨å¯ä»¥é€šè¿‡å•å‡»ä¸‹é¢çš„æŒ‰é’®å°†æ­¤GPRSæ¨¡å—ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduino Mega Server</a>é›†æˆï¼Œä»¥äº†è§£è¯¥ä»»åŠ¡ä»¥åŠæˆ‘å¿…é¡»ç»å†çš„ä»¤äººéš¾ä»¥ç½®ä¿¡çš„ç»§ç»­æ•™è‚²è¯¾ç¨‹ã€‚ <br><a name="habracut"></a><br><h2> æ¨¡å—æœ¬èº« </h2><br> æ­£å¦‚æˆ‘æ‰€è¯´ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯¥æ¨¡å—æœ¬èº«</a>çš„æ‰§è¡Œå‡†ç¡®æ€§ä»¥åŠä¸ä¸€å®¶çŸ¥åå…¬å¸çš„å…³ç³»éƒ½ç»™äººç•™ä¸‹äº†å¾ˆå¥½çš„å°è±¡ã€‚ åŒæ ·ï¼Œåˆ¶é€ å•†çš„ç½‘ç«™ä¸Šæœ‰ç”¨æ³•ç¤ºä¾‹å’Œæœ¬æœºåº“ã€‚ ç”±äºæ¨¡å—æ˜¯å“ç‰Œå•†æ ‡ï¼Œå› æ­¤å¸Œæœ›åœ¨æ¨¡å—å‡ºç°ä»»ä½•é—®é¢˜æ—¶è·å¾—è¶³å¤Ÿçš„æ”¯æŒã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/332/bf2/2b2/332bf22b21a64277b46f78d65e580b13.jpg" alt="å›¾ç‰‡"></div><br> å±•æœ›æœªæ¥ï¼Œæˆ‘ä¼šè¯´æŠ€æœ¯æ”¯æŒå¯ä»¥åœ¨ä¸¤å‘¨å†…æ­£ç¡®å›ç­”æˆ‘çš„é—®é¢˜ï¼Œåœ¨åº“ä¸­æŸ¥æ‰¾é”™è¯¯ï¼Œç”šè‡³æ ¹æ®ä¸æˆ‘äº¤æµçš„åŸå› å‘å¸ƒäº†æ–°ç‰ˆæœ¬ã€‚ ä½†æ˜¯...æˆ‘ä»ç„¶å¿…é¡»ä½¿æ¨¡å—è‡ªå·±å·¥ä½œã€‚ <br><br><h2> ä¸“æ¡ˆ </h2><br> å…³äºéœ€è¦GPRSæ¨¡å—çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GSM Coopé¡¹ç›®çš„</a>å‡ å¥è¯ã€‚ æœ‰å¿…è¦å‘å±•è‡ªåŠ¨åŒ–ç®¡ç†é¸¡èˆã€‚ ç¡®å®ï¼Œåœ¨æˆ‘ä»¬ç”Ÿæ´»çš„ç¾å¥½æ—¶å…‰ä¸­ï¼Œç°åœ¨éœ€è¦é€šè¿‡ç½‘ç»œæµè§ˆå™¨ï¼Œæ— çº¿æ™ºèƒ½ä¼ æ„Ÿå™¨å’ŒGSMé¥æµ‹æ¥æ§åˆ¶é¸¡èˆã€‚ è¿™æ˜¯æŸç§æˆ˜ç•¥ç›®æ ‡ï¼Œè€Œä¸æ˜¯é¸¡èˆã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a91/e3a/6a4/a91e3a6a4cd94a2cabc35ca7ebb381b1.png" alt="å›¾ç‰‡"></div><br> ä½†æ˜¯ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œé‚£å°±æœ‰å¿…è¦ã€‚ æˆ‘ä»¬è´­ä¹°ç»„ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬GPRSæ¨¡å—ï¼Œç„¶åç»§ç»­ã€‚ <br><br><h2> é˜¿å–€ç‰æ–¯ä¹‹heel </h2><br> ç°åœ¨ä»‹ç»è¯¥æ¨¡å—çš„åŠŸèƒ½ã€‚ åŸºæœ¬ä¸Šï¼Œå®ƒå¯ä»¥å·¥ä½œã€‚ ä»–ä½¿ç”¨åˆ¶é€ å•†ç½‘ç«™ä¸Šçš„ç¤ºä¾‹è¿›è¡Œå·¥ä½œï¼Œç”šè‡³å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šåˆ›å»ºä¸€äº›ç®€å•çš„è‰å›¾ã€‚ ä½†æ˜¯æœ‰ä¸‰ä¸ªâ€œ butsâ€ã€‚ <br><br>  <i><strong>æ³¨æ„äº‹é¡¹</strong></i>  <i>è¯¥é¡¹ç›®ä¸­ä½¿ç”¨äº†ä¸¤ä¸ªä¸»æ¿ï¼š <strong>Arduino Mega 2560</strong>å’Œ<strong>Arduino Dueï¼Œ</strong>ä»¥ä¸‹æ‰€æœ‰å†…å®¹ä»…é€‚ç”¨äºå®ƒä»¬ã€‚</i> <br><br>  <strong>ç¬¬ä¸€ä¸ªâ€œä½†æ˜¯â€ç¡¬ä»¶ã€‚</strong> è¯¥æ¨¡å—ä¸é€‚ç”¨äºArduino Dueã€‚ æ²¡åŠæ³• å³ä½¿ä¸Amperkaçš„æŠ€æœ¯æ”¯æŒè¿›è¡Œå¤šå¤©çš„é€šä¿¡ä¹Ÿæ— æµäºäº‹ã€‚ æˆ‘å’Œå…¬å¸çš„ä¸“å®¶éƒ½æ²¡æœ‰è®¾æ³•ä½¿GPRS Shieldä¸Arduino Dueä¸€èµ·ä½¿ç”¨ã€‚ è€Œä¸”è¿™éå¸¸ä»¤äººå¤±æœ›ï¼Œå› ä¸ºDueæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„å‡ºè‰²æ§åˆ¶å™¨ï¼Œå¸Œæœ›å°†å…¶ä¸GPRS Shieldä¸€èµ·ä½¿ç”¨ã€‚ <br><br>  <strong>ç¬¬äºŒä¸ªâ€œ butâ€æ˜¯ç³»ç»Ÿæ€§çš„ã€‚</strong> è¯¥æ¨¡å—éœ€è¦SoftwareSerialåº“æ‰èƒ½å·¥ä½œã€‚ å½“æˆ‘å¼€å§‹ä¸GPRS Shieldå’ŒAmperkaçš„æŠ€æœ¯æ”¯æŒè¿›è¡Œå¯¹è¯æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéæ›¿ä»£æ€§çš„è§£å†³æ–¹æ¡ˆã€‚ ç»è¿‡æˆ‘ä»¬çš„è¯‰è®¼ï¼Œè¯¥åº“çš„ä¿®è®¢ç‰ˆå¾—åˆ°äº†æ”¯æŒï¼Œå¯ä»¥åœ¨Iron Serialä¸Šè¿›è¡Œå·¥ä½œï¼Œä½†æ˜¯â€¦â€¦å®ƒä»æ¥æ²¡æœ‰èµšè¿‡Dueæˆ–Megaã€‚ é€šå¸¸å¾ˆéš¾è§£é‡Šä»€ä¹ˆ-å¦‚æœæ¨¡å—åœ¨SoftSerialä¸Šå·¥ä½œï¼Œé‚£ä¹ˆæ˜¯ä»€ä¹ˆé˜»æ­¢äº†å®ƒåœ¨Iron Serialä¸Šå·¥ä½œå‘¢ï¼Ÿ <br><br>  <strong>ç¬¬ä¸‰ä¸ªâ€œä½†æ˜¯â€ï¼Œæ¦‚å¿µä¸Šçš„ã€‚</strong> è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ã€‚ ä¸»è¦çš„åŸ‹ä¼åœ¨äºæ¨¡å—åº“çš„åŸç†ã€‚ å®ƒåœ¨å…³é—­æ¨¡å¼ä¸‹å·¥ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒåœ¨ç­‰å¾…SMSåˆ°è¾¾æ—¶ï¼ˆè¿™æ˜¯99ï¼…çš„æ—¶é—´ï¼‰ä»¥åŠæ¨¡å—çš„æ‰€æœ‰å…¶ä»–æ“ä½œæœŸé—´ï¼Œä¼šé˜»æ­¢æ§åˆ¶å™¨çš„æ“ä½œã€‚ è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ è¿™æ„å‘³ç€åœ¨åˆ¶é€ å•†çš„æ ‡å‡†åº“ä¸­ï¼Œæ‚¨åªèƒ½æ„å»ºæµ‹è¯•è‰å›¾ã€‚ æˆ˜ç•¥é¸¡èˆå¯¹æ‚¨è€Œè¨€å¹¶ä¸å‘å…‰ï¼Œå› ä¸ºåƒå®‰å…¨ç³»ç»Ÿï¼Œæ¸©å®¤ç®¡ç†ï¼Œé€šè¿‡GSMè¿›è¡Œçš„æ™ºèƒ½å®¶å±…æ§åˆ¶ç­‰æˆåƒä¸Šä¸‡çš„ç‚«é…·åº”ç”¨ç¨‹åºéƒ½ä¸ä¼šå‘å…‰ã€‚ <br><br><h2> æœ‰å…³SoftwareSerialçš„æ›´å¤šä¿¡æ¯ </h2><br> è¯¥æ¨¡å—ä¸é€‚ç”¨äºArduino Dueï¼Œå› æ­¤æˆ‘ä»¬å°†è®¨è®ºArduino Megaã€‚ è¿™ç§æƒ…å†µçš„éº»çƒ¦ä¹‹å¤„åœ¨äºï¼ŒMegaå…·æœ‰ä¸‰ä¸ªå…è´¹çš„ç¡¬ä»¶ç«¯å£Serial1ï¼ŒSerial2å’ŒSeria3ï¼Œæˆ‘ä»¬è¢«è¿«è¿æ¥å¹¶ä½¿ç”¨SoftwareSerialåº“ã€‚ ä»¥ä»»ä½•æ— æ³•æƒ³è±¡å’Œæ— æ³•æƒ³è±¡çš„æ–¹å¼ï¼ŒåŒ…æ‹¬é‡æ–°é…ç½®æ¨¡å—ä¸Šçš„è·³çº¿ä»¥åŠå¯¹Amperkaçš„æŠ€æœ¯æ”¯æŒè¿›è¡Œæ²‰æ€ï¼Œéƒ½æ— æ³•ä½¿GPRS Shieldä¸Arduino Megaä¸Šçš„ç¡¬ä»¶ç«¯å£é…åˆä½¿ç”¨ã€‚ <br><br> å¥½çš„...æˆ‘ä»¬ä½¿ç”¨SoftwareSerialï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬ç­‰å¾…ä¼å‡»ã€‚  SoftwareSerialå¯ä»¥åœ¨è®¸å¤šArduino Megaå¼•è„šä¸Šå·¥ä½œï¼Œä½†ç”±äºæŸäº›åŸå› ï¼Œå®ƒåªèƒ½åœ¨62å’Œ63å¼•è„šä¸Šå·¥ä½œã€‚ ä¸ºä»€ä¹ˆåªåœ¨ä»–ä»¬èº«ä¸Šï¼Ÿ è¿™ä¸ªè°œè¯­å¾ˆæ£’ã€‚ ä»è¡¨é¢ä¸Šçœ‹ï¼Œæˆ‘ä»¬æ°¸è¿œä¸ä¼šçŸ¥é“è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆã€‚ <br><br><h2> é€‰æ‹©çš„é¢ç²‰ </h2><br> ç°åœ¨ï¼Œåƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬é€æ¸äº†è§£åˆ°æ ‡å‡†åº“ä¸é€‚åˆå®é™…ä½¿ç”¨ã€‚ é€šè¿‡åœ¨æ§åˆ¶å™¨ç­‰å¾…æ¥æ”¶æ¥è‡ªGPRSæ¨¡å—çš„å“åº”çš„è¿‡ç¨‹ä¸­é˜»æ­¢æ§åˆ¶å™¨ï¼Œè¯¥åº“è¿˜é˜»æ­¢äº†æ‰€æœ‰å…¶ä»–è¿›ç¨‹ã€‚ æ§åˆ¶å™¨ä»…åœ¨99ï¼…çš„æ—¶é—´å†…å°±è„±ç¦»äº†ç°å®ï¼Œä¸€ç›´ç­‰åˆ°è¯·æ±‚æˆ–å“åº”åˆ°è¾¾æˆ–è¶…æ—¶ç»“æŸã€‚ <br><br> è¿™ç»“æŸäº†GPRS Shieldçš„æ‰€æœ‰åº”ç”¨ï¼Œé™¤äº†æµ‹è¯•ä¹‹ä¸€ï¼šå‘é€äº†ä¸€ä¸ªæ‰“å¼€å¥—æ¥å­—çš„è¯·æ±‚-å·²æ‰“å¼€ï¼Œå‘é€äº†ä¸€ä¸ªå…³é—­è¯·æ±‚-å·²å…³é—­ã€‚ è°ˆä¸ä¸ŠWebæœåŠ¡å™¨çš„ä»»ä½•å·¥ä½œï¼Œä¼ æ„Ÿå™¨çš„å·¥ä½œï¼Œæ‰§è¡Œå™¨çš„æ§åˆ¶ç­‰ï¼›è¿™äº›éƒ½ä¸èƒ½ç®€å•åœ°å·¥ä½œã€‚ <br><br> é—®é¢˜å‡ºç°äº†ï¼šè¦ä¹ˆæˆ‘ä»¬æ”¾å¼ƒåˆ¶é€ å•†çš„èµ„æ–™åº“ï¼Œç¼–å†™æˆ‘ä»¬çš„GPRS Shieldæ§åˆ¶ä»£ç ï¼ˆè¯´èµ·æ¥å®¹æ˜“ï¼‰ï¼Œè¦ä¹ˆæˆ‘ä»¬æ”¾å¼ƒæ¨¡å—æœ¬èº«ï¼Œå¯»æ‰¾æ›¿ä»£è§£å†³æ–¹æ¡ˆã€‚ ä½†æ˜¯æ¨¡å—å·²ç»åœ¨é‚£é‡Œï¼Œå› æ­¤å†³å®šæ”¾å¼ƒè¯¥åº“å¹¶ç¼–å†™æ‚¨çš„æ¨¡å—æ§åˆ¶ä»£ç ã€‚ <br><br><h2> å¾æœç ç©†æœ—ç›å³° </h2><br> æˆ‘è·³è¿‡äº†åˆ›å»ºä»£ç ä»¥æ›¿æ¢Amperkaæ ‡å‡†åº“çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘åªæ³¨æ„åˆ°è¿™éå¸¸éå¸¸éå¸¸å›°éš¾ï¼Œéœ€è¦å¤§é‡çš„ç ”ç©¶å·¥ä½œï¼Œå¤æ‚çš„ç®—æ³•ç¼–è¯‘ä»¥åŠå¤§é‡çš„å·¥ä½œæ¥æµ‹è¯•æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆã€‚ <br><br> ä¸€åˆ‡å¯¹æ‚¨æ¥è¯´éƒ½å¾ˆç®€å•-æœ‰ç‚¹ç¥å¥‡ï¼Œå¹¶ä¸”æ”¯æŒGPRS Shieldçš„AMSæ¨¡å—çš„ç°æˆå·¥ä½œä»£ç å·²ç»å‡†å¤‡å°±ç»ªã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/557/a58/157/557a58157e7b45589395e0a9d867ee52.jpg" alt="å›¾ç‰‡"></div><br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´çš„AMSæ¨¡å—ä»£ç æ›¿æ¢æ ‡å‡†åº“</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* Modul GPRS part of Arduino Mega Server project */</span></span> #ifdef GPRS_FEATURE #include &lt;SoftwareSerial.h&gt; #define ALWAYS <span class="hljs-number"><span class="hljs-number">1</span></span> #define GPRS_ON_PIN <span class="hljs-number"><span class="hljs-number">2</span></span> #define GPRS_STATE_PIN <span class="hljs-number"><span class="hljs-number">3</span></span> #define GPRS_RX_PIN <span class="hljs-number"><span class="hljs-number">62</span></span> #define GPRS_TX_PIN <span class="hljs-number"><span class="hljs-number">63</span></span> #define MASTER <span class="hljs-string"><span class="hljs-string">"+7yyyxxxxxxx"</span></span> #define MESSAGE <span class="hljs-string"><span class="hljs-string">"Hello"</span></span> #define CHECK_ERROR <span class="hljs-number"><span class="hljs-number">0</span></span> #define CHECK_MARKER <span class="hljs-number"><span class="hljs-number">1</span></span> #define CHECK_OK <span class="hljs-number"><span class="hljs-number">2</span></span> #define NO_CHECK <span class="hljs-number"><span class="hljs-number">3</span></span> #define MARKER_OK <span class="hljs-string"><span class="hljs-string">"OK"</span></span> #define MARKER_NO_CHECK <span class="hljs-string"><span class="hljs-string">"-"</span></span> <span class="hljs-comment"><span class="hljs-comment">// GPRS commands #define DATA_TEMP1 "temp1" #define DATA_CONT1 "cont1" #define DATA_LEAK1 "leak1" #define DATA_SMOKE1 "smoke1" #define DATA_ALL "all" #define DATA_RELAY1 "relay1" #define DATA_SERVO1 "servo1" #define DATA_PERIOD "period" #define CMD_RELAY1 "relay1=" #define CMD_SERVO1 "servo1=" #define CMD_PERIOD "period=" byte gprsPeriod = 24; SoftwareSerial GPRS(GPRS_RX_PIN, GPRS_TX_PIN); #define MAX_SOFT_SERIAL 128 char bufferGprs[MAX_SOFT_SERIAL]; int curBuf = 0; #define MESSAGE_LENGTH 20 char message[MESSAGE_LENGTH]; char phone[16]; char datetime[24]; void gprsInit() { initStart("GPRS", true); GPRS.begin(9600); gprsOnOff(); gprsStart(); sendGprs("AT+CFUN=1", "OK"); sendGprs("AT+CNMI=2,1", "OK"); sendGprs("AT+CMGF=1", "OK"); sendGprs("AT+CLIP=1", "OK"); modulGprs = MODUL_ENABLE; initDone(true); } void clearBufferGprs() { for (int i = 0; i &lt; curBuf; i++) { bufferGprs[i] = 0; } } void gprsStart() { while (ALWAYS) { delay(1000); curBuf = 0; GPRS.println("AT"); if (GPRS.available() &gt; 0) { while (GPRS.available() &gt; 0) { bufferGprs[curBuf++] = GPRS.read(); } bufferGprs[curBuf] = '\0'; if (strcmp(bufferGprs, "AT\r\n\r\nOK\r\n") == 0) { timeStamp(); Serial.println(" GPRS ON"); break; } else { Serial.print("."); } } clearBufferGprs(); } } // gprsStart() void gprsOnOff() { pinMode(GPRS_ON_PIN, OUTPUT); if (digitalRead(GPRS_STATE_PIN) != HIGH) { digitalWrite(GPRS_ON_PIN, HIGH); delay(3000); } digitalWrite(GPRS_ON_PIN, LOW); } bool clearSoftwareSerial() { if (GPRS.available() &gt; 0) { while (GPRS.available() &gt; 0) { char c = GPRS.read(); } } } #define DELAY_GPRS_COMMAND 2000 byte sendGprs(String command, char marker[]) { unsigned long timer = millis(); bool success = false; clearSoftwareSerial(); clearBufferGprs(); Serial.print(F("Send command: ")); //Serial.println(command); while (ALWAYS) { if (millis() - timer &gt; DELAY_GPRS_COMMAND) { Serial.print(F("Send error: ")); Serial.println(command); //clearBufferGprs(); return CHECK_ERROR; } curBuf = 0; GPRS.println(command); delay(280); if (GPRS.available() &gt; 0) { while (GPRS.available() &gt; 0) { char c = GPRS.read(); if (curBuf &gt; MAX_SOFT_SERIAL - 2) {break;} bufferGprs[curBuf++] = c; Serial.print(c); } Serial.println(); bufferGprs[curBuf] = '\0'; if (marker == MARKER_NO_CHECK) { Serial.print(F("Send no check, ")); Serial.println(millis() - timer); return NO_CHECK; } else if (StrContains(bufferGprs, marker)) { Serial.print(F("Send success, ")); Serial.println(millis() - timer); return CHECK_MARKER; } else if (StrContains(bufferGprs, MARKER_OK)) { Serial.print(F("Send success, ")); Serial.println(millis() - timer); return CHECK_OK; } else { Serial.println("."); } } // if (GPRS.available() &gt; 0) delay(500); } // while (ALWAYS) } // sendGprs( ) // +CMGR: "REC READ", "XXXXXXXXXXX", "", "16/10/01,10:00:00+12" // SMS text void parseSms(char *message, char *phone, char *datetime) { int i = 0; int j = 0; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {phone[j++] = bufferGprs[i++];} phone[j] = '\0'; i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; while (bufferGprs[i] != '\"') {i++;} i++; j = 0; while (bufferGprs[i] != '\"') {datetime[j++] = bufferGprs[i++];} datetime[j] = '\0'; i++; while (bufferGprs[i] != '\n') {i++;} i++; j = 0; //Serial.print(F("strlen(bufferGprs): ")); Serial.println(strlen(bufferGprs)); while (i &lt; strlen(bufferGprs) - 1) { if (j &gt; MESSAGE_LENGTH - 1) {break;} if ((byte)bufferGprs[i] == 13) {break;} message[j++] = bufferGprs[i++]; } Serial.print(F("strlen(message1): ")); Serial.println(strlen(message)); message[j] = '\0'; Serial.print(F("strlen(message2): ")); Serial.println(strlen(message)); for (int z = 0; z &lt; strlen(message); z++) { Serial.print((byte)message[z]); Serial.print(F(" ")); } Serial.println(); } void deleteSms() { if (sendGprs("AT+CMGDA=\"DEL ALL\"", "OK")) { Serial.println(F("All SMS deleted")); } else { Serial.println(F("Error delete all SMS")); } } String stringSens(byte v) { String s = ""; switch (v) { case 0: s = (F("OFF")); break; case 1: s = (F("ON")); break; default: s = (F("?")); } return s; } String stringLeak(byte v) { String s = ""; switch (v) { case 0: s = (F("LEAK!")); break; case 1: s = (F("OK")); break; default: s = (F("?")); } return s; } String stringSmoke(byte v) { String s = ""; switch (v) { case 0: s = (F("OK")); break; case 1: s = (F("SMOKE!")); break; default: s = (F("?")); } return s; } String mkTemp1() {String s = DATA_TEMP1; s += '='; s += String(lpTempTemp); s += '\n'; return s;} String mkCont1() {String s = DATA_CONT1; s += '='; s += stringSens(lpContCont1); s += '\n'; return s;} String mkLeak1() {String s = DATA_LEAK1; s += '='; s += stringLeak(lpLeakLeak1); s += '\n'; return s;} String mkSmoke1() {String s = DATA_SMOKE1; s += '='; s += stringSmoke(smokeSmoke); s += '\n'; return s;} String mkRelay1() {String s = DATA_RELAY1; s += '='; s += stringSens(relayRelay); s += '\n'; return s;} String mkServo1() {String s = DATA_SERVO1; s += '='; s += stringSens(servoState); s += '\n'; return s;} String mkPeriod() {String s = DATA_PERIOD; s += '='; s += String(gprsPeriod); s += '\n'; return s;} String mkAll() { String s = ""; s += mkTemp1(); s += mkCont1(); s += mkLeak1(); s += mkSmoke1(); s += mkRelay1(); s += mkServo1(); s += mkPeriod(); return s; } void gprsSetRelay(byte v) { switch (v) { case 0: if (relayRelay) { relayRelay = STATE_OFF; } break; case 1: if (!relayRelay) { relayRelay = STATE_ON; } break; } } void gprsSetServo(byte v) { switch (v) { case 0: servoState = STATE_OFF; break; case 1: servoState = STATE_ON; break; } } void gprsAnswer() { String s = ""; String mess = String(message); String data = ""; if (mess == DATA_TEMP1) {s += mkTemp1();} else if (mess == DATA_CONT1) {s += mkCont1();} else if (mess == DATA_LEAK1) {s += mkLeak1();} else if (mess == DATA_SMOKE1) {s += mkSmoke1();} else if (mess == DATA_RELAY1) {s += mkRelay1();} else if (mess == DATA_SERVO1) {s += mkServo1();} else if (mess == DATA_PERIOD) {s += mkPeriod();} else if (mess == DATA_ALL) {s += mkAll();} else if (mess.indexOf(F("=")) &gt;= 0) { byte p = mess.indexOf(F("=")); if (mess.indexOf(CMD_RELAY1) &gt;= 0) {data = mess.substring(p + 1); gprsSetRelay(data.toInt()); s += DATA_RELAY1; s += '='; s += stringSens(relayRelay);} else if (mess.indexOf(CMD_SERVO1) &gt;= 0) {data = mess.substring(p + 1); gprsSetServo(data.toInt()); s += DATA_SERVO1; s += '='; s += stringSens(servoState);} else if (mess.indexOf(CMD_PERIOD) &gt;= 0) {data = mess.substring(p + 1); gprsPeriod = data.toInt(); s += DATA_PERIOD; s += '='; s += String(gprsPeriod);} } else { Serial.println(F("Not command!")); } //Serial.print(F("mess: ")); Serial.println(mess); //Serial.print(F("answ: ")); Serial.println(s); if (s == "") {s = "Error";} Serial.println(F("Send answer... ")); if (sendSms(MASTER, s)) { Serial.println(F("success")); } else { Serial.println(F("error")); } } void readSms() { byte result = sendGprs("AT+CMGR=1,1", "+CMGR:"); if (result == CHECK_MARKER) { parseSms(message, phone, datetime); Serial.print(F("Number: ")); Serial.println(phone); Serial.print(F("Datetime: ")); Serial.println(datetime); Serial.print(F("Message: ")); Serial.println(message); deleteSms(); if (String(phone) == String(MASTER)) { Serial.println(F("Message from MASTER!")); gprsAnswer(); } } else if (result == CHECK_OK) { Serial.println(F("No SMS")); } else { Serial.println(F("Error read SMS")); } } bool sendSms(char *number, String data) { String numstr = "AT+CMGS=\"" + String(number) + "\""; String messtr = data + String((char)26); if (sendGprs(numstr, "&gt;")) { if (sendGprs(messtr, MARKER_NO_CHECK)) { return true; } } return false; } void sendPeriod() { Serial.println(F("Send period SMS... ")); if (sendSms(MASTER, mkAll())) { Serial.println(F("success")); } else { Serial.println(F("error")); } } void gprsWorks() { if (cycle20s) { readSms(); } switch (gprsPeriod) { case 1: if (cycle1h) {sendPeriod();} break; case 6: if (cycle6h) {sendPeriod();} break; case 12: if (cycle12h) {sendPeriod();} break; default: if (cycle24h) {sendPeriod();} break; } } #endif // GPRS_FEATURE</span></span></code> </pre> <br></div></div><br> è¯¥æ¨¡å—æ˜¯åœ¨Arduino Megaçš„AMSç‰ˆæœ¬0.16ä¸Šå¼€å‘å’Œæµ‹è¯•çš„ã€‚ æµ‹è¯•è¡¨æ˜ï¼Œåœ¨æ­¤æ¨¡å—çš„æ§åˆ¶ä¸‹ï¼ŒGPRS Shieldçš„è¿è¡Œç»å¯¹ç¨³å®šå¯é ã€‚ <br><br><h2> è¿æ¥åˆ°AMS GPRS Shieldæ”¯æŒæ¨¡å— </h2><br> ä¸ºäº†å°†GPRS Shieldæ¨¡å—è¿æ¥åˆ°Arduino Mega Serverï¼Œæ‚¨éœ€è¦æ‰§è¡Œä¸€äº›ç®€å•çš„æ­¥éª¤ã€‚ é¦–å…ˆï¼Œå°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°AMSä¸»æ–‡ä»¶ä¸­ <br><br><pre> <code class="java hljs">#define GPRS_FEATURE</code> </pre><br> å’Œ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> modulGprs = MODUL_NOT_COMPILLED;</code> </pre><br> åœ¨é€‚å½“çš„éƒ¨åˆ†ã€‚ åœ¨é‚£é‡Œï¼Œæ‚¨éœ€è¦æ·»åŠ æµ‹è¯•å˜é‡ï¼Œè¯¥å˜é‡åœ¨æ‚¨çš„å®é™…é¡¹ç›®ä¸­å°†è´Ÿè´£å—æ§å‚æ•°ï¼ˆæ¸©åº¦ï¼Œæ¥è§¦çŠ¶æ€ç­‰ï¼‰ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> lpTempTemp; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> lpContCont1; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> lpLeakLeak1; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> smokeSmoke; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> relayRelay; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> servoState;</code> </pre><br><h2> æ”¯æŒåŠŸèƒ½çš„è¯´æ˜ </h2><br> è¯¥æ¨¡å—åŒ…å«ä¸€ç»„åŸºæœ¬çš„æŸ¥è¯¢å’Œå‘½ä»¤ï¼Œä½†æ˜¯æ‚¨å¯ä»¥å°†è¿™äº›å‘½ä»¤æ›¿æ¢ä¸ºå…¶ä»–å‘½ä»¤å’Œ/æˆ–æ‰©å±•æ‰€éœ€çš„åŸºæœ¬å‘½ä»¤å’ŒæŸ¥è¯¢ã€‚ <br><br><h3> å’¨è¯¢å¤„ </h3><br> é€šè¿‡SMSå‘é€è¯·æ±‚ï¼Œç³»ç»Ÿï¼ˆä¹Ÿé€šè¿‡SMSï¼‰å‘é€åŒ…å«æœ‰å…³æ‰€è¯·æ±‚å‚æ•°ä¿¡æ¯çš„å“åº”ã€‚ éå¸¸ç®€å•ï¼šæˆ‘ä»¬ä»ç”µè¯å‘é€è¯·æ±‚â€œ temp1â€ï¼Œç³»ç»Ÿä½œä¸ºå“åº”å‘é€å½“å‰æ¸©åº¦å€¼<code>temp1=20.50</code> ã€‚ <br><br><blockquote>  <strong>temp1-</strong>æ¸©åº¦è¦æ±‚ <br>  <strong>cont1-</strong>è¯·æ±‚è”ç³»çŠ¶æ€ <br> æ³„æ¼<strong>1-</strong>è¯·æ±‚æ³„æ¼ä¼ æ„Ÿå™¨çš„çŠ¶æ€ <br>  <strong>smoke1-</strong>æŸ¥è¯¢çƒŸé›¾æ¢æµ‹å™¨çŠ¶æ€ <br>  <strong>relay1-</strong>è¯·æ±‚<strong>ç»§ç”µå™¨</strong>çš„çŠ¶æ€ï¼ˆé”®ï¼‰ <br> ä¼ºæœ<strong>1-</strong>è¯·æ±‚ä¼ºæœè¿›<strong>çº¸</strong>å™¨çš„çŠ¶æ€ <br>  <strong>period-</strong>è¯·æ±‚è‡ªåŠ¨é¥æµ‹è½¯ä»¶åŒ…çš„æœŸé™ <br>  <strong>å…¨éƒ¨</strong> -è¯·æ±‚æ‰€æœ‰ç³»ç»Ÿå‚æ•° </blockquote><br> å“åº”â€œ allâ€è¯·æ±‚ï¼Œç³»ç»Ÿå‘é€æ‰€æœ‰å‚æ•°çš„åˆ—è¡¨ã€‚ åœ¨å‘é€æœªæ³¨å†Œå‘½ä»¤çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå°†å‘é€â€œé”™è¯¯â€å“åº”ã€‚ å¦‚æœç›‘è§†çš„å‚æ•°è¶…å‡ºæ­£å¸¸èŒƒå›´ï¼Œåˆ™ç³»ç»Ÿæœ¬èº«å¯ä»¥å‘æ“ä½œå‘˜çš„æ™ºèƒ½æ‰‹æœºå‘é€è­¦æŠ¥æ¶ˆæ¯ã€‚ <br><br> ä¸ºäº†ä»…ç”±æ³¨å†Œæ“ä½œå‘˜æ¥ç®¡ç†ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå…·æœ‰é˜²æ­¢æœªæˆæƒè®¿é—®çš„ä¿æŠ¤-å®ƒä»…å“åº”æ¥è‡ªç‰¹å®šç”µè¯å·ç çš„å‘½ä»¤ã€‚ <br><br><h3> é˜Ÿä¼ </h3><br> é€šè¿‡SMSå‘é€å‘½ä»¤ï¼Œæ¥å—å‘½ä»¤åï¼Œç³»ç»Ÿä¼šæ›´æ”¹å…¶çŠ¶æ€å¹¶å‘é€åŒ…å«æœ‰å…³å…¶æ‰§è¡Œå™¨æˆ–è®¾ç½®çš„æ–°çŠ¶æ€ä¿¡æ¯çš„å“åº”ã€‚ <br><br><blockquote>  <strong>relay1 =</strong> -ç»§ç”µå™¨æ§åˆ¶å‘½ä»¤ï¼ˆé”®ï¼‰ <br>  <strong>ä¼ºæœ1 =</strong> -é¦ˆçº¿æ§åˆ¶å‘½ä»¤ <br>  <strong>period =</strong> -æ›´æ”¹é¥æµ‹è‡ªåŠ¨å‘é€å‘¨æœŸçš„å‘½ä»¤ </blockquote><br> ä¸€ä¸ªä¾‹å­ã€‚ å‘½ä»¤<code>relay1=1</code> ï¼Œå“åº”<code>relay1=ON</code> ã€‚ å‘½ä»¤<code>relay1=0</code> ï¼Œå“åº”<code>relay1=OFF</code> ã€‚ <br><br><h2> ä»£ç è¯´æ˜ </h2><br>  GPRSæ¨¡å—åˆå§‹åŒ–ã€‚  AMSæ¨¡å—çš„æ ‡å‡†åˆå§‹åŒ–ï¼ŒSoftwareSerialçš„å¯åŠ¨ä»¥åŠGSM ATå‘½ä»¤çš„é­”åŠ›ã€‚ è¯¥æ¨¡å—çš„ç›®çš„æ˜¯ä½¿GPRSæ¨¡å—æ ©æ ©å¦‚ç”Ÿï¼Œå¹¶ä»æ¶…rvä¸­é€€å›å®ƒï¼Œå‰ææ˜¯æ­¤æ—¶ç”±äºæŸç§åŸå› æˆ‘ä»¬å·²ç»ç¦»å¼€äº†å®ƒã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ initStart(<span class="hljs-string"><span class="hljs-string">"GPRS"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); GPRS.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>); gprsOnOff(); gprsStart(); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CFUN=1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CNMI=2,1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CMGF=1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CLIP=1"</span></span>, <span class="hljs-string"><span class="hljs-string">"OK"</span></span>); modulGprs = MODUL_ENABLE; initDone(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }</code> </pre><br> æ¨¡å—çš„ä¸»è¦å·¥ä½œåŠŸèƒ½ã€‚ æ¯éš”20ç§’ï¼ŒArduino Mega Serverå°±ä¼šæ£€æŸ¥ä¼ å…¥çš„SMSï¼Œå¹¶åœ¨æœ‰ä»»ä½•è¯·æ±‚æˆ–å‘½ä»¤çš„æƒ…å†µä¸‹æ‰§è¡Œå®ƒä»¬ã€‚ ç»“æœï¼Œå‘½ä»¤æ‰§è¡Œçš„å¹³å‡å»¶è¿Ÿä¸º10ç§’ï¼ˆä¸åŒ…æ‹¬ç”µä¿¡è¿è¥å•†å‘é€SMSæ¶ˆæ¯çš„å»¶è¿Ÿï¼‰ã€‚ å¯ä»¥é…ç½®æ­¤é—´éš”ï¼Œé€‰æ‹©20ç§’ä½œä¸ºå¯¹SMSå‘½ä»¤çš„å“åº”é€Ÿåº¦å’Œç³»ç»Ÿå¼•å¯¼ä¹‹é—´çš„æŠ˜è¡·ã€‚ <br><br> åœ¨è¿™20ç§’å†…ï¼ŒAMSå¯ä»¥åšä»»ä½•éœ€è¦çš„äº‹æƒ…ï¼Œå¹¶ä¸”åœ¨è¿™æ®µæ—¶é—´å†…åˆ°è¾¾çš„SMSä¸ä¼šä¸¢å¤±ã€‚ ä½¿ç”¨æ ‡å‡†åº“æ—¶ï¼Œç³»ç»Ÿåªèƒ½ç­‰å¾…SMSåˆ°è¾¾ï¼Œå¦åˆ™å°†ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼ˆå¦åˆ™æ§åˆ¶å™¨å°†æ— æ³•æ‰§è¡Œä»»ä½•æ“ä½œï¼‰ã€‚ <br><br> è¿˜æœ‰ä¸€ä¸ªé¥æµ‹å‘é€ä»£ç ï¼Œå…¶æŒ‡å®šæ—¶é—´é—´éš”ä¸º1å°æ—¶ï¼Œ6å°æ—¶ï¼Œ12å°æ—¶æˆ–24å°æ—¶ã€‚ å¯ä»¥é€šè¿‡SMSå‘é€é€‚å½“çš„å‘½ä»¤æ¥æ›´æ”¹æ­¤é—´éš”ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsWorks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle20s) { readSms(); } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (gprsPeriod) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle1h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle6h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle12h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cycle24h) {sendPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre><br>  GPRSæ¨¡å—å’Œæ§åˆ¶å™¨ä¹‹é—´çš„äº¤äº’æ˜¯é€šè¿‡ç‰¹æ®Šçš„ATå‘½ä»¤æ‰§è¡Œçš„ï¼Œä»¥ä¸‹åŠŸèƒ½ä»¥æ˜“äºç†è§£çš„ä»£ç å½¢å¼å½¢æˆäº†GPRSæ¨¡å—å‘½ä»¤ã€‚ <br><br> çŸ­ä¿¡å‘é€åŠŸèƒ½ã€‚ åœ¨åŠŸèƒ½çš„å‚æ•°ä¸­ï¼Œç›®æ ‡ç”µè¯å·ç å’Œå‘½ä»¤æˆ–è¯·æ±‚ä»¥æ–‡æœ¬å½¢å¼ä¼ è¾“ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">bool </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *number, String data)</span></span></span><span class="hljs-function"> </span></span>{ String numstr = <span class="hljs-string"><span class="hljs-string">"AT+CMGS=\""</span></span> + String(number) + <span class="hljs-string"><span class="hljs-string">"\""</span></span>; String messtr = data + String((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)<span class="hljs-number"><span class="hljs-number">26</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sendGprs(numstr, <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sendGprs(messtr, MARKER_NO_CHECK)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre><br> çŸ­ä¿¡é˜…è¯»åŠŸèƒ½ã€‚ æ¥å—çš„å€¼æ”¾åœ¨å˜é‡messageï¼Œphoneå’Œdatetimeä¸­ï¼Œå®ƒä»¬åˆ†åˆ«åŒ…å«æ¥æ”¶çš„å‘½ä»¤ï¼Œç”µè¯å·ç å’Œå‘é€æ—¶é—´ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readSms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> result = sendGprs(<span class="hljs-string"><span class="hljs-string">"AT+CMGR=1,1"</span></span>, <span class="hljs-string"><span class="hljs-string">"+CMGR:"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == CHECK_MARKER) { parseSms(message, phone, datetime); Serial.print(F(<span class="hljs-string"><span class="hljs-string">"Number: "</span></span>)); Serial.println(phone); Serial.print(F(<span class="hljs-string"><span class="hljs-string">"Datetime: "</span></span>)); Serial.println(datetime); Serial.print(F(<span class="hljs-string"><span class="hljs-string">"Message: "</span></span>)); Serial.println(message); deleteSms(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (String(phone) == String(MASTER)) { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"Message from MASTER!"</span></span>)); gprsAnswer(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == CHECK_OK) { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"No SMS"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"Error read SMS"</span></span>)); } }</code> </pre><br> å½¢æˆå¯¹SMSè¯·æ±‚å’Œå‘½ä»¤çš„å“åº”çš„åŠŸèƒ½ã€‚ æ­¤åŠŸèƒ½ç‰¹å®šäºæ¯ä¸ªé¡¹ç›®ï¼Œæ‚¨å¯ä»¥æ ¹æ®ç³»ç»Ÿé€»è¾‘åœ¨é¡¹ç›®ä¸­å¯¹å…¶è¿›è¡Œæ›´æ”¹ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsAnswer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ String s = <span class="hljs-string"><span class="hljs-string">""</span></span>; String mess = String(message); String data = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_TEMP1) {s += mkTemp1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_CONT1) {s += mkCont1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_LEAK1) {s += mkLeak1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_SMOKE1) {s += mkSmoke1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_RELAY1) {s += mkRelay1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_SERVO1) {s += mkServo1();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_PERIOD) {s += mkPeriod();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess == DATA_ALL) {s += mkAll();} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(F(<span class="hljs-string"><span class="hljs-string">"="</span></span>)) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> p = mess.indexOf(F(<span class="hljs-string"><span class="hljs-string">"="</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(CMD_RELAY1) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) {data = mess.substring(p + <span class="hljs-number"><span class="hljs-number">1</span></span>); gprsSetRelay(data.toInt()); s += DATA_RELAY1; s += <span class="hljs-string"><span class="hljs-string">'='</span></span>; s += stringSens(relayRelay);} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(CMD_SERVO1) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) {data = mess.substring(p + <span class="hljs-number"><span class="hljs-number">1</span></span>); gprsSetServo(data.toInt()); s += DATA_SERVO1; s += <span class="hljs-string"><span class="hljs-string">'='</span></span>; s += stringSens(servoState);} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mess.indexOf(CMD_PERIOD) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) {data = mess.substring(p + <span class="hljs-number"><span class="hljs-number">1</span></span>); gprsPeriod = data.toInt(); s += DATA_PERIOD; s += <span class="hljs-string"><span class="hljs-string">'='</span></span>; s += String(gprsPeriod);} } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Serial.println(F(<span class="hljs-string"><span class="hljs-string">"Not command!"</span></span>)); } <span class="hljs-comment"><span class="hljs-comment">//Serial.print(F("mess: ")); Serial.println(mess); //Serial.print(F("answ: ")); Serial.println(s); if (s == "") {s = "Error";} Serial.println(F("Send answer... ")); if (sendSms(MASTER, s)) { Serial.println(F("success")); } else { Serial.println(F("error")); } }</span></span></code> </pre><br> å½¢æˆç­”æ¡ˆçš„åŠŸèƒ½ã€‚ è¿™äº›åŠŸèƒ½æ„æˆäº†ç³»ç»Ÿæ ¹æ®æ‰€åˆ¶å®šçš„ç¨‹åºï¼Œé€šè¿‡SMSå“åº”ç”¨æˆ·çš„è¯·æ±‚æˆ–è‡ªè¡Œå†³å®šï¼Œé€šè¿‡SMSå‘é€åˆ°ç”¨æˆ·çš„æ™ºèƒ½æ‰‹æœºçš„å“åº”ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stringSens</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stringLeak</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stringSmoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkTemp1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkCont1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkLeak1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkSmoke1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkRelay1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkServo1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkPeriod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></code> </pre><br> ä»¥åŠå‘½ä»¤æ‰§è¡Œçš„åŠŸèƒ½ã€‚ è¿™äº›æ˜¯ç”±SMSå‘½ä»¤æ‰§è¡Œçš„åŠŸèƒ½ï¼Œå®ƒä»¬å¯ä»¥æ›´æ”¹ç³»ç»Ÿçš„çŠ¶æ€ï¼Œå³æ›´æ”¹å…¶è®¾ç½®æˆ–å¯ç”¨æˆ–ç¦ç”¨æ‰§è¡Œå™¨ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsSetRelay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gprsSetServo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span></code> </pre><br> å…¶ä½™åŠŸèƒ½çº¯å±æŠ€æœ¯ï¼Œå¯ä»¥å®ŒæˆGPRS Shieldä¸å¾®æ§åˆ¶å™¨ä¹‹é—´äº¤äº’çš„æ‰€æœ‰ç²—ç•¥å·¥ä½œã€‚ <br><br><h2> æœ‰å…³SoftwareSerialçš„æ›´å¤šä¿¡æ¯ </h2><br> ä»¥ä¸Šæ‰€æœ‰å†…å®¹ä¸è¶³ä»¥ä½¿GPRS Shieldé€æ˜æ¨¡å¼ä¸‹å·¥ä½œå¹¶åœæ­¢é˜»æ­¢å¾®æ§åˆ¶å™¨ä¸Šè¿è¡Œçš„å…¶ä»–è¿›ç¨‹ã€‚ è¿˜éœ€è¦ä¿®æ”¹SoftwareSerialåº“çš„ä»£ç ã€‚ äº‹å®æ˜¯ï¼Œå…¶æ ‡å‡†çš„64å­—èŠ‚ç¼“å†²åŒºä¸è¶³ä»¥æ¶ˆåŒ–å¤§å¤šæ•°AT GSMå‘½ä»¤å¹¶ç»´æŒæ¨¡å—ä¸æ§åˆ¶å™¨ä¹‹é—´çš„åŠ¨æ€äº¤äº’ã€‚ <br><br> æ‚¨éœ€è¦å°†è¯¥ç¼“å†²åŒºå¢åŠ åˆ°è‡³å°‘128ä¸ªå­—èŠ‚ï¼Œåªæœ‰åœ¨æ­¤ä¹‹åé­”æœ¯æ‰ä¼šèµ·ä½œç”¨ï¼Œå¹¶ä¸”GPRS Shieldå°†åœ¨é€æ˜æ¨¡å¼ä¸‹å¼€å§‹æ­£å¸¸å·¥ä½œã€‚ è¿™æ˜¯åœ¨<code>SoftwareSerial.h</code>æ–‡ä»¶ä¸­å®Œæˆçš„ã€‚ çº¿ <br><br><pre> <code class="java hljs">#define _SS_MAX_RX_BUFF <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-comment"><span class="hljs-comment">// RX buffer size</span></span></code> </pre><br> éœ€è¦æ›´æ”¹ä¸º <br><br><pre> <code class="java hljs">#define _SS_MAX_RX_BUFF <span class="hljs-number"><span class="hljs-number">128</span></span> <span class="hljs-comment"><span class="hljs-comment">// RX buffer size</span></span></code> </pre><br><h2> ç»“è®º </h2><br> æ‚¨ä¼šåœ¨æ™ºèƒ½æ‰‹æœºå±å¹•ä¸Šçœ‹åˆ°æ“ä½œå‘˜å‘½ä»¤å’Œç³»ç»Ÿå“åº”çš„äº¤æ¢ã€‚ å¹¶ä¸”ï¼Œç³»ç»Ÿä»¥ä¼ªå¤šä»»åŠ¡å¤„ç†æ¨¡å¼æ‰§è¡Œæ•°åä¸ªè¿‡ç¨‹ã€‚  GPRS Shieldå¼€å§‹å ç”¨ä¸åˆ°1ï¼…çš„å¤„ç†å™¨æ—¶é—´ï¼Œè€Œä¸æ˜¯ä»¥å‰çš„99ï¼…ï¼Œä»è€Œä¸ºWebæœåŠ¡å™¨å’Œç®¡ç†é¸¡èˆçš„å…¶ä»–ä»»åŠ¡è…¾å‡ºäº†å…¶ä½™æ—¶é—´ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2e1/615/a08/2e1615a08e2a4a29802805066509d3e4.png" alt="å›¾ç‰‡"></div><br> å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°†GPRS Shield Shieldé›†æˆåˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AMSä¸­</a> ï¼Œå…‹æœäº†æ‰€æœ‰éšœç¢ï¼Œä½¿å…¶ä»¥é€æ˜æ¨¡å¼å·¥ä½œï¼Œè€Œä¸ä¼šé˜»æ­¢å…¶ä»–è¿›ç¨‹ï¼ˆä¾‹å¦‚WebæœåŠ¡å™¨ï¼Œæ— çº¿ä¼ æ„Ÿå™¨å’Œæ‰§è¡Œå™¨çš„è¿è¡Œï¼‰ï¼Œè¿™ä¸ºæ„å»ºå…·æœ‰GSM SMSæ§åˆ¶åŠŸèƒ½çš„å¤§é‡ç³»ç»Ÿæ‰“å¼€äº†è¯±äººçš„å‰æ™¯ã€‚åŸºäºAMSçš„æ§åˆ¶-æ¸©å®¤ï¼Œå®‰å…¨å’Œä¾›æš–ç³»ç»Ÿï¼Œæ™ºèƒ½å®¶å±…çš„å„ç§é€‰é¡¹ç­‰ï¼Œå‡ ä¹æ˜¯æ— é™çš„ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN401721/">https://habr.com/ru/post/zh-CN401721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN401709/index.html">æ—å®ä¸šä¸æ­»å¿ƒ</a></li>
<li><a href="../zh-CN401711/index.html">æ°”é—¨è®­ç»ƒAIæ£€æµ‹CSä¸­çš„ä½œå¼Šè€…ï¼šGO</a></li>
<li><a href="../zh-CN401713/index.html">åœ¨é£æœºä¸Šæ— èŠæ—¶è¯¥æ€ä¹ˆåŠ-åœ¨æ¤…å­èƒŒé¢è¿è¡ŒGoogle Chrome</a></li>
<li><a href="../zh-CN401715/index.html">Robert Wingleeï¼ˆç¾å›½å®‡èˆªå±€ï¼‰çš„å¤ªç©ºé’“é±¼</a></li>
<li><a href="../zh-CN401719/index.html">Cyclone 10-è‹±ç‰¹å°”å“ç‰Œçš„FPGA</a></li>
<li><a href="../zh-CN401723/index.html">æ—§è®¡ç®—æœºè®¾å¤‡çš„è‰ºæœ¯å“ç¿»æ–°</a></li>
<li><a href="../zh-CN401725/index.html">æ¤å…¥æŠ€æœ¯çš„å†å²ã€‚ å‡ç‰™</a></li>
<li><a href="../zh-CN401727/index.html">é€‰æ‹©2æœˆ23æ—¥çš„æå®¢ç¤¼ç‰©ï¼šMadrobotsæŒ‡å—</a></li>
<li><a href="../zh-CN401729/index.html">æˆ‘ä»¬å‘¨å›´æœ‰ç”¨çš„ï¼ˆå±é™©çš„ï¼‰â€œå™ªéŸ³â€</a></li>
<li><a href="../zh-CN401735/index.html">å­¦ä¹ PartyFon Maxç§»åŠ¨éœ‡åŠ¨æ‰¬å£°å™¨çš„å†…éƒ¨çŸ¥è¯†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>