<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐จโ๐ฌ ๐จโ๐ณ ุงูุชุตุญูุญ ูุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง ูู ุงููุณุฎ ุงููุชูุงุซู ุฏูู PostgreSQL ๐ ๐ฆ๐ฝ ๐จโ๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฃุตุจุญ ุงููุณุฎ ุงููุชูุงุซู ููุฏูู ุ ุงูุฐู ุธูุฑ ูู ุนุงู 2010 ุ ุฅุญุฏู ููุฒุงุช ุงูุงุฎุชุฑุงู ูู PostgreSQL ููู ุงูููุช ุงูุญุงุถุฑ ุ ูุง ูููู ูุฃู ุชุซุจูุช ุชูุฑูุจูุง ุงูุงุณุชุบูุงุก ุนู ุงุณุชุฎุฏุงู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุชุตุญูุญ ูุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง ูู ุงููุณุฎ ุงููุชูุงุซู ุฏูู PostgreSQL</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/414111/" style=";text-align:right;direction:rtl">  ุฃุตุจุญ ุงููุณุฎ ุงููุชูุงุซู ููุฏูู ุ ุงูุฐู ุธูุฑ ูู ุนุงู 2010 ุ ุฅุญุฏู ููุฒุงุช ุงูุงุฎุชุฑุงู ูู PostgreSQL ููู ุงูููุช ุงูุญุงุถุฑ ุ ูุง ูููู ูุฃู ุชุซุจูุช ุชูุฑูุจูุง ุงูุงุณุชุบูุงุก ุนู ุงุณุชุฎุฏุงู ุงููุณุฎ ุงููุชูุงุซู ููุฏูู.  ุฅููุง ููุซููุฉ ูุณููุฉ ุงูุชููุฆุฉ ููุง ุชุชุฃุซุฑ ุจุงูููุงุฑุฏ.  ููุน ุฐูู ุ ุนูู ุงูุฑุบู ูู ูู ุตูุงุชู ุงูุฅูุฌุงุจูุฉ ุ ูุฏ ุชุธูุฑ ุฃุซูุงุก ุชุดุบููู ูุดุงูู ูุฎุชููุฉ ูุญุงูุงุช ุบูุฑ ุณุงุฑุฉ. <br><br>  <strong>ุฃุฎุจุฑ Alexey Lesovsky</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">lesovsky</a> ) ูู Highload ++ 2017 ููููุฉ <strong>ุชุดุฎูุต ุฃููุงุน ูุฎุชููุฉ ูู ุงููุดุงูู</strong> ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ูุฏูุฌุฉ ูุฃุฏูุงุช ุฎุงุฑุฌูุฉ <strong>ูููููุฉ ุฅุตูุงุญูุง</strong> .  ุชุญุช ุงูุชุฎููุถุงุช ุ ูุฅู ูู ุดูุฑุฉ ูุฐุง ุงูุชูุฑูุฑ ุ ูุจูู ุนูู ูุจุฏุฃ ุญูุฒููู: ุฃููุงู ุ ูููู ุจุฅุฏุฑุงุฌ ุฌููุน ุฃุฏูุงุช ุงูุชุดุฎูุต ุงูููููุฉ ุ ุซู ููุชูู ุฅูู ูุงุฆูุฉ ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุชุดุฎูุตูุง ุ ุซู ูุฑู ูุง ูู ุชุฏุงุจูุฑ ุงูุทูุงุฑุฆ ุงูุชู ูููู ุงุชุฎุงุฐูุง ุ ูุฃุฎูุฑูุง ููููุฉ ุงูุชุนุงูู ูุน ุงููุดููุฉ ุจุดูู ุฌุฐุฑู. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/on2yVvKejwc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <strong>ุญูู ุงููุชุญุฏุซ</strong> : ุฃูููุณู ููุณููุณูู ุ ูุฏูุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู Data Egret.  ุฃุญุฏ ุงูููุงุถูุน ุงูููุถูุฉ ูุฏู ุฃูููุณู ูู PostgreSQL ูู ุจุซ ุงููุณุฎ ุงููุชูุงุซู ูุงูุนูู ูุน ุงูุฅุญุตุงุฆูุงุช ุ ูุฐูู ุชู ุชุฎุตูุต ุงูุชูุฑูุฑ ูู Highload ++ 2017 ูููููุฉ ุงูุนุซูุฑ ุนูู ุงููุดุงูู ุจุงุณุชุฎุฏุงู ุงูุฅุญุตุงุฆูุงุช ููุง ูู ุงูุทุฑู ุงูุชู ูุฌุจ ุงุณุชุฎุฏุงููุง ูุญููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทุฉ <br></h2><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููู ูู ุงููุธุฑูุฉ ุ ุฃู ููู ูุนูู ุงููุณุฎ ุงููุชูุงุซู ูู PostgreSQL</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฏูุงุช ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง ุฃู ูุง ูุฏู PostgreSQL ูุงููุฌุชูุน</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุงูุงุช ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง:</a> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุดุงูู: ุฃุนุฑุงุถูุง ูุชุดุฎูุตูุง </li><li style=";text-align:right;direction:rtl">  ุงููุฑุงุฑุงุช </li><li style=";text-align:right;direction:rtl">  ุงูุชุฏุงุจูุฑ ุงููุงุฌุจ ุงุชุฎุงุฐูุง ุญุชู ูุง ุชูุดุฃ ูุฐู ุงููุดุงูู. </li></ul></li></ol><br>  <strong>ููุงุฐุง ูู ูุฐุงุ</strong>  ุณุชุณุงุนุฏู ูุฐู ุงูููุงูุฉ ุนูู ููู ุงููุณุฎ ุงููุชูุงุซู ููุจุซ ุจุดูู ุฃูุถู ุ ูุชุนูู ููููุฉ ุงูุนุซูุฑ ุนูู ุงููุดููุงุช ูุฅุตูุงุญูุง ุจุณุฑุนุฉ ูุชูููู ููุช ุฑุฏ ุงููุนู ููุญูุงุฏุซ ุบูุฑ ุงูุณุงุฑุฉ. <br><a name="habracut"></a><a name="replicationSql"></a><br><h2 style=";text-align:right;direction:rtl">  ุฌุฒุก ูู ุงููุธุฑูุฉ <br></h2><br>  ูุญุชูู PostgreSQL ุนูู ููุงู ูุซู ูุชุงุจุฉ ุณุฌู ููุฃูุงู (XLOG) ุ ุณุฌู ุงููุนุงููุงุช.  <em>ูุชู ุชุณุฌูู</em> ุฌููุน ุงูุชุบููุฑุงุช ุงูุชู ุชุญุฏุซ <em>ุชูุฑูุจูุง</em> ูุน ุงูุจูุงูุงุช ูุงูุจูุงูุงุช ุงููุตููุฉ ุฏุงุฎู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ูุฐุง ุงูุณุฌู.  ูู ุญุงูุฉ ุญุฏูุซ ุฃู ุญุงุฏุซ ูุฌุฃุฉ ุ ูุจุฏุฃ PostgreSQL ุ ูููุฑุฃ ุณุฌู ุงููุนุงููุงุช ููุณุชุนูุฏ ุงูุชุบููุฑุงุช ุงููุณุฌูุฉ ุนูู ุงูุจูุงูุงุช.  ููุฐุง ูุถูู ุงูููุซูููุฉ - ุฃุญุฏ ุฃูู ุฎุตุงุฆุต ุฃู ูุธุงู DBMS ู PostgreSQL ุฃูุถูุง. <br><br>  ูููู ููุก ุณุฌู ุงููุนุงููุงุช ุจุทุฑููุชูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุชุฑุงุถููุง ุ ุนูุฏูุง ุชูุฌุฑู ุงูุฎูููุฉ ุจุนุถ ุงูุชุบููุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (INSERT ุ UPDATE ุ DELETE ุ ุฅูุฎ.) ุ ูุชู ุชุณุฌูู ุฌููุน ุงูุชุบููุฑุงุช ูู ุณุฌู ุงููุนุงููุงุช <strong>ุจุดูู ูุชุฒุงูู</strong> : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃุฑุณู ุงูุนููู ุฃูุฑ COMMIT ูุชุฃููุฏ ุงูุจูุงูุงุช. <br></li><li style=";text-align:right;direction:rtl">  ูุชู ุชุณุฌูู ุงูุจูุงูุงุช ูู ุณุฌู ุงููุนุงููุงุช. <br></li><li style=";text-align:right;direction:rtl">  ุจูุฌุฑุฏ ุญุฏูุซ ุงูุชุซุจูุช ุ ูุชู ููุญ ุงูุชุญูู ูููุงุฌูุฉ ุงูุฎูููุฉ ุ ูููููู ุงูุงุณุชูุฑุงุฑ ูู ุชููู ุงูุฃูุงูุฑ ูู ุงูุนููู. <br></li></ul></li><li style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑ ุงูุซุงูู ูู <strong>ุงููุชุงุจุฉ ุบูุฑ ุงููุชุฒุงููุฉ</strong> ูู ุณุฌู ุงููุนุงููุงุช ุ ุนูุฏูุง ุชูุชุจ ุนูููุฉ ูุงุชุจ WAL ูุฎุตุตุฉ ูููุตูุฉ ุงูุชุบููุฑุงุช ูู ุณุฌู ุงููุนุงููุงุช ูุน ูุชุฑุฉ ุฒูููุฉ ูุนููุฉ.  ููุชูุฌุฉ ูุฐูู ุ ูุชู ุชุญููู ุฒูุงุฏุฉ ูู ุฃุฏุงุก ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ุญูุซ ูุง ุชูุฌุฏ ุญุงุฌุฉ ููุงูุชุธุงุฑ ุญุชู ููุชูู ุงูุฃูุฑ COMMIT. <br></li></ol><br>  ุงูุฃูู ูู ุฐูู ุ ูุณุชูุฏ ุฏูู ุงููุณุฎ ุงููุชูุงุซู ุฅูู ุณุฌู ุงููุนุงููุงุช ูุฐุง.  ูุฏููุง ุงูุนุฏูุฏ ูู ุฃุนุถุงุก ุงููุณุฎ ุงููุชูุงุซู ุงูุฏูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุชูุงู ุญูุซ ุชุชู ุฌููุน ุงูุชุบููุฑุงุช ุ <br></li><li style=";text-align:right;direction:rtl">  ุงูุนุฏูุฏ ูู ุงููุณุฎ ุงููุชูุงุซูุฉ ุงูุชู ุชูุจู ุณุฌู ุงููุนุงููุงุช ูู ุงูุฑุฆูุณู ูุชุนูุฏ ุฅูุชุงุฌ ูู ูุฐู ุงูุชุบููุฑุงุช ุนูู ุจูุงูุงุชูู ุงููุญููุฉ.  ูุฐุง ูู ุฏูู ุงููุณุฎ ุงููุชูุงุซู. <br></li></ul><br>  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู ุฌููุน ุณุฌูุงุช ุงููุนุงููุงุช ูุฐู ูุฎุฒูุฉ ูู ุฏููู pg_xlog ูู $ DATADIR - ุงูุฏููู ุงูุฐู ูุญุชูู ุนูู ูููุงุช ุจูุงูุงุช DBMS ุงูุฑุฆูุณูุฉ.  ูู ุงูุฅุตุฏุงุฑ ุงูุนุงุดุฑ ูู PostgreSQL ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ูุฐุง ุงูุฏููู ููุตุจุญ pg_wal / ุ ูุฃูู ููุณ ูู ุบูุฑ ุงููุฃููู ุฃู ุชุดุบู pg_xlog / ูุณุงุญุฉ ูุจูุฑุฉ ุ ููููู ุงููุทูุฑูู ุฃู ุงููุณุคูููู ุงูุฐูู ูุฎูุทูู ุจููู ุฏูู ุนูู ุจุงูุณุฌูุงุช ุ ููุญุฐูููู ุจูุง ูุจุงูุงุฉ ููุตุจุญ ูู ุดูุก ุณูุฆูุง. <br><br>  ูุญุชูู PostgreSQL ุนูู ุงูุนุฏูุฏ ูู ุฎุฏูุงุช ุงูุฎูููุฉ ุงูุชู ุชุดุงุฑู ูู ุฏูู ุงููุณุฎ ุงููุชูุงุซู.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูููุง ูู ูุฌูุฉ ูุธุฑ ูุธุงู ุงูุชุดุบูู. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุฌุงูุจ ุงูุณูุฏ - ุนูููุฉ ุงููุฑุณู WAL.  ูุฐู ุนูููุฉ ุชุฑุณู ุณุฌูุงุช ุงููุนุงููุงุช ุฅูู ุงููุณุฎ ุงููุชูุงุซูุฉ ุ ูุณูููู ููู ูุณุฎุฉ ูุชูุงุซูุฉ WAL Sender ุงูุฎุงุต ุจูุง. <br></li><li style=";text-align:right;direction:rtl">  ุชููู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุจุฏูุฑูุง ุจุชุดุบูู ุนูููุฉ ุงุณุชูุจุงู WAL ุ ูุงูุชู ุชุชููู ุณุฌูุงุช ุงููุนุงููุงุช ุนุจุฑ ุงุชุตุงู ุงูุดุจูุฉ ูู ูุฑุณู WAL ูุชูุฑูุฑูุง ุฅูู ุนูููุฉ ุจุฏุก ุงูุชุดุบูู. <br></li><li style=";text-align:right;direction:rtl">  ุชููู ุนูููุฉ ุจุฏุก ุงูุชุดุบูู ุจูุฑุงุกุฉ ุงูุณุฌูุงุช ูุฅุนุงุฏุฉ ุฅูุชุงุฌ ูุงูุฉ ุงูุชุบููุฑุงุช ุงูุชู ุชู ุชุณุฌูููุง ูู ุณุฌู ุงููุนุงููุงุช ูู ุฏููู ุงูุจูุงูุงุช. <br></li></ul><br><img src="https://habrastorage.org/webt/ek/g2/rd/ekg2rdtwkvfjw8hlpj0rhhzhogu.jpeg"><br>  ูู ุงููุงุญูุฉ ุงูุชุฎุทูุทูุฉ ุ ูุจุฏู ุงูุฃูุฑ ูุซู ูุฐุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุชู ูุชุงุจุฉ ุงูุชุบููุฑุงุช ุนูู ูุฎุงุฒู WAL ุ ูุงูุชู ุณูุชู ูุชุงุจุชูุง ุจุนุฏ ุฐูู ูู ุณุฌู ุงููุนุงููุงุช ุ <br></li><li style=";text-align:right;direction:rtl">  ุงูุณุฌูุงุช ูู ุงูุชุฎุฒูู ูู ุงูุฏููู pg_wal / ุ <br></li><li style=";text-align:right;direction:rtl">  ููุฑุฃ WAL Sender ุณุฌู ุงููุนุงููุงุช ูู ุงููุณุชูุฏุน ูููููู ุนุจุฑ ุงูุดุจูุฉ ุ <br></li><li style=";text-align:right;direction:rtl">  ูุณุชูุจู WAL Receiver ููุฎุฒู ูู ูุฎุฒูู - ูู pg_wal / ุงููุญููุฉ. <br></li><li style=";text-align:right;direction:rtl">  ุชูุฑุฃ ุนูููุฉ ุจุฏุก ุงูุชุดุบูู ูู ูุง ูุชู ูุจููู ูุฅุนุงุฏุฉ ุฅูุชุงุฌู. <br></li></ul><br>  ุงููุฎุทุท ุจุณูุท.  ูุนูู ูุณุฎ ุงูุฏูู ุจุดูู ููุซูู ุจู ุชูุงููุง ููุฏ ุชู ุงุณุชุบูุงูู ุจุดูู ููุชุงุฒ ูุณููุงุช ุนุฏูุฏุฉ. <br><a name="tools"></a><br><h2 style=";text-align:right;direction:rtl">  ุฃุฏูุงุช ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง <br></h2><br>  ุฏุนููุง ูุฑู ูุง ูู ุงูุฃุฏูุงุช ูุงููุฑุงูู ุงูุชู ููุฏููุง ุงููุฌุชูุน ู PostgreSQL ูู ุฃุฌู ุงูุชุญููู ูู ุงููุดุงูู ุงูุชู ุชูุงุฌููุง ูู ุงููุณุฎ ุงููุชูุงุซู ููุฏูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฃุฏูุงุช ุงูุทุฑู ุงูุซุงูุซ <br></h3><br>  ููุจุฏุฃ ุจุฃุฏูุงุช ุงูุทุฑู ุงูุซุงูุซ.  ูุฐู ุงููุฑุงูู ูู <strong>ุฎุทุฉ ุนุงูููุฉ</strong> ููุนูุง ูุง ุ ูููู ุงุณุชุฎุฏุงููุง ููุณ ููุท ููุชุญููู ูู ุงูุญูุงุฏุซ ุงููุชุนููุฉ ุจุชูุฑุงุฑ ุงูุฏูู.  ูุฐู <strong>ุฃุฏูุงุช ูุณุงุนุฏุฉ</strong> ุจุดูู <strong>ุนุงู ูุฃู ูุณุคูู ูุธุงู</strong> . <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>ุฃุนูู</strong> ูู ุญุฒูุฉ procps.  ูุจุฏูู ููุฃุนูู ุ ููููู ุงุณุชุฎุฏุงู ุฃู ุฃุฏูุงุช ูุณุงุนุฏุฉ ูุซู atop ู htop ููุง ุดุงุจู.  ุฃููุง ุชููุฑ ูุธุงุฆู ููุงุซูุฉ. </li></ul><br>  ุจูุณุงุนุฏุฉ ูู ุงูุฃุนูู ุ ููุธุฑ ุฅูู: ุงุณุชุฎุฏุงู ุงููุนุงูุฌุงุช (CPU) ููุชูุณุท โโุงูุญูู (ูุชูุณุท โโุงูุชุญููู) ูุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ููุณุงุญุฉ ุงูุชุจุฏูู. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  iostat ูู sysstat ู iotop.  ุชุธูุฑ ูุฐู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุงููุฑุต ููุง ูุชู ุฅูุดุงุคู ูู ูุจู ุงูุนูููุงุช ูู ูุธุงู ุงูุชุดุบูู I / O. </li></ul><br>  ุจูุณุงุนุฏุฉ iostat ุ ููุธุฑ ุฅูู: ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุ ูุนุฏุฏ iops ูู ุงูููุช ุงูุญุงูู ุ ููุง ุงูุฅูุชุงุฌูุฉ ูู ุงูุฃุฌูุฒุฉ ุ ููุง ุงูุชุฃุฎูุฑุงุช ุนูุฏ ูุนุงูุฌุฉ ุทูุจุงุช I / O (ุงููููู).  ูุชู ุฃุฎุฐ ูุฐู ุงููุนูููุงุช ุงูููุตูุฉ ุฅูู ุญุฏ ูุง ูู ูุธุงู ุงููููุงุช procfs ููุชู ุชูููุฑูุง ูููุณุชุฎุฏู ูู ุดูู ูุฑุฆู. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  nicstat ูู ูุธูุฑ iostat ุ ููุท ููุงุฌูุงุช ุงูุดุจูุฉ.  ูู ูุฐู ุงูุฃุฏุงุฉ ููููู ูุดุงูุฏุฉ ุงุณุชุฎุฏุงู ุงููุงุฌูุงุช. </li></ul><br>  ุจุงุณุชุฎุฏุงู nicstat ุ ููุธุฑ: ุจุงููุซู ุ ุงุณุชุฎุฏุงู ุงููุงุฌูุฉ ุ ุจุนุถ ุงูุฃุฎุทุงุก ุงูุชู ุชุญุฏุซ ุนูู ุงููุงุฌูุงุช ุ ุงูุฅูุชุงุฌูุฉ ูู ุฃูุถูุง ุฃุฏุงุฉ ูููุฏุฉ ุฌุฏูุง. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  pgCenter ูู ุฃุฏุงุฉ ููุนูู ููุท ูุน PostgreSQL.  ูุนุฑุถ ุฅุญุตุงุกุงุช PostgreSQL ูู ูุงุฌูุฉ ุชุดุจู ุฅูู ุญุฏ ูุจูุฑ ุ ูููููู ุฃูุถูุง ูุดุงูุฏุฉ ุงูุฅุญุตุงุกุงุช ุงููุชุนููุฉ ุจุชุฏูู ุงููุณุฎ ุงููุชูุงุซู ูููุง. </li></ul><br>  ุจูุณุงุนุฏุฉ pgCenter ููุธุฑ: ุฅุญุตุงุกุงุช ุงููุณุฎ ุงููุชูุงุซู.  ููููู ูุดุงูุฏุฉ ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ูุชููููู ุจุทุฑููุฉ ูุง ูุงูุชูุจุค ุจุงูุนูู ุงููุณุชูุจูู. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  perf ุฃุฏุงุฉ ูููุฏุฉ ูุฅุฌุฑุงุก ุชุญููู ุฃุนูู ูู ุฃุณุจุงุจ "ุงูุทุฑู ุชุญุช ุงูุฃุฑุถ" ุ ุนูุฏูุง ุชููู ููุงู ูุดููุงุช ุบุฑูุจุฉ ุนูู ูุณุชูู ุฑูุฒ PostgreSQL. </li></ul><br>  ุจูุณุงุนุฏุฉ ุงูุนุทูุฑ ูุจุญุซ ุนู: ุทุฑู ุชุญุช ุงูุฃุฑุถ.  ููู ูุนูู ุงูุฃุฏุงุก ุจุดูู ูุงูู ูุน PostgreSQL ุ ูุฌุจ ุฃู ูุชู ุชุฌููุน ูุฐุง ุงูุฃุฎูุฑ ุจุฃุญุฑู ุงูุชุตุญูุญ ุ ุจุญูุซ ููููู ุฅููุงุก ูุธุฑุฉ ุนูู ูุฌููุนุฉ ุงููุธุงุฆู ูู ุงูุนูููุงุช ูุงููุธุงุฆู ุงูุชู ุชุณุชุบุฑู ูุนุธู ููุช ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. <br><br>  ููุงู ุญุงุฌุฉ ุฅูู ุฌููุน ูุฐู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ <strong>ูุงุฎุชุจุงุฑ ุงููุฑุถูุงุช</strong> ุงูุชู ุชูุดุฃ ุนูุฏ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง - ุฃูู ููุงุฐุง ูุชุจุงุทุฃ ุ ูุฃูู ููุง ุชุญุชุงุฌ ุฅูู ุฅุตูุงุญู ุ ุชุญูู.  ุชุณุงุนุฏ ูุฐู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ุนูู ุงูุชุฃูุฏ ูู ุฃููุง ุนูู ุงูุทุฑูู ุงูุตุญูุญ. <br><br><h3 style=";text-align:right;direction:rtl">  ุฃุฏูุงุช ูุถููุฉ <br></h3><br>  ูุงุฐุง ุชูุฏู PostgreSQL ููุณูุงุ <br><br><h4 style=";text-align:right;direction:rtl">  ุทุฑู ุนุฑุถ ุงููุธุงู <br></h4><br>  ุจุดูู ุนุงู ุ ููุงู ุงููุซูุฑ ูู ุงูุฃุฏูุงุช ููุนูู ูุน PostgreSQL.  ุชูุฏู ูู ุดุฑูุฉ ููุฑุฏุฉ ุชููุฑ ุฏุนู PostgreSQL ุฃุฏูุงุชูุง ุงูุฎุงุตุฉ.  ูููู ุ ููุงุนุฏุฉ ุ ุชุณุชูุฏ ูุฐู ุงูุฃุฏูุงุช ุฅูู ุฅุญุตุงุกุงุช PostgreSQL ุงูุฏุงุฎููุฉ.  ูู ูุฐุง ุงูุตุฏุฏ ุ ูููุฑ PostgreSQL ุทุฑู ุนุฑุถ ุงููุธุงู ุงูุชู ููููู ูู ุฎูุงููุง ุชุญุฏูุฏ ุงูุนุฏูุฏ ูู ุงูุงุฎุชูุงุฑุงุช ูุงูุญุตูู ุนูู ุงููุนูููุงุช ุงูุชู ุชุญุชุงุฌูุง.  ุฃู ุ ุจุงุณุชุฎุฏุงู ุนููู ุนุงุฏู ุ ุนุงุฏุฉู ูุง ูููู psql ุ ูููููุง ุฅุฌุฑุงุก ุงูุงุณุชุนูุงูุงุช ููุนุฑูุฉ ูุง ูุญุฏุซ ูู ุงูุฅุญุตุงุฆูุงุช. <br><br>  ููุงู ุนุฏุฏ ุบูุฑ ูููู ูู ุทุฑู ุนุฑุถ ุงููุธุงู.  ูู ุฃุฌู ุงูุชุนุงูู ูุน ุงููุณุฎ ุงููุชูุงุซู ููุฏูู ูุงูุชุญููู ูู ุงููุดููุงุช ุ ูุญุชุงุฌ ููุท ุฅูู: pg_stat_replication ู pg_stat_wal_receiver ู pg_stat_database ู pg_stat_databases_conflicts ู auxiliary pg_stat_activity ู pg_stat_archiver. <br><br>  ููุงู ุงููููู ูููุง ุ ููู ูุฐู ุงููุฌููุนุฉ ูุงููุฉ ููุชุญูู ููุง ุฅุฐุง ูุงูุช ููุงู ุฃู ูุดุงูู. <br><br><h4 style=";text-align:right;direction:rtl">  ูุธุงุฆู ุงููุณุงุนุฏ <br></h4><br>  ุจุงุณุชุฎุฏุงู ุงููุธุงุฆู ุงูุฅุถุงููุฉ ุ ููููู ุฃุฎุฐ ุงูุจูุงูุงุช ูู ุชูุซููุงุช ุงููุธุงู ุงูุฅุญุตุงุฆู ูุชุญููููุง ุฅูู ุดูู ุฃูุซุฑ ููุงุกูุฉ ูู.  ุงููุธุงุฆู ุงูุฅุถุงููุฉ ูู ุฃูุถูุง ุจุถุน ูุทุน. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  pg_current_wal_lsn () (ุงููุธูุฑ ุงููุฏูู ูู pg_current_xlog_location ()) ูู ุงููุธููุฉ ุงูุฃูุซุฑ ุฃูููุฉ ุงูุชู ุชุณูุญ ูู ุจุฑุคูุฉ ุงูููุถุน ุงูุญุงูู ูู ุณุฌู ุงููุนุงููุงุช.  ุณุฌู ุงููุนุงููุงุช ูู ุชุณูุณู ูุณุชูุฑ ููุจูุงูุงุช.  ุจุงุณุชุฎุฏุงู ูุฐู ุงููุธููุฉ ุ ููููู ุฑุคูุฉ ุงูููุทุฉ ุงูุฃุฎูุฑุฉ ุ ุงูุญุตูู ุนูู ุงูููุถุน ุงูุฐู ุชููู ุณุฌู ุงููุนุงููุงุช ุงูุขู. <br></li><li style=";text-align:right;direction:rtl">  pg_last_wal_receive_lsn () ุ pg_last_xlog_receive_location () ูู ุฏุงูุฉ ููุงุซูุฉ ููุง ุณุจู ุ ููุท ูููุณุฎ ุงููุชูุงุซูุฉ.  ุชุชููู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุณุฌู ุงููุนุงููุงุช ุ ูููููู ุฑุคูุฉ ุขุฎุฑ ููุถุน ุณุฌู ูุนุงููุฉ ุชู ุชูููู ุ <br></li><li style=";text-align:right;direction:rtl">  pg_wal_lsn_diff () ุ pg_xlog_location_diff () ูู ูุธููุฉ ุฃุฎุฑู ูููุฏุฉ.  ูุนุทููุง ูููุนูู ูู ุณุฌู ุงููุนุงููุงุช ุ ูุชุธูุฑ ุงุฎุชูุงููุง - ุงููุณุงูุฉ ุจูู ูุงุชูู ุงูููุทุชูู ุจุงูุจุงูุช.  ูุฐู ุงููุธููุฉ ูููุฏุฉ ุฏุงุฆููุง ูู ุชุญุฏูุฏ ุงููุงุตู ุจูู ุงูุฑุฆูุณู ูุงููุณุฎ ุงููุชูุงุซูุฉ ุจุงูุจุงูุช. <br></li></ul><br>  ูููู ุงูุญุตูู ุนูู ูุงุฆูุฉ ูุงููุฉ ุจุงููุธุงุฆู ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ psql meta-command: \ df * (wal | xlog | lsn | location) *. <br><br>  ููููู ูุชุงุจุชู ูู psql ูุฑุคูุฉ ุฌููุน ุงููุธุงุฆู ุงูุชู ูุญุชูู ุนูููุง wal ุ xlog ุ Isn ุ location.  ุณูููู ููุงู ุญูุงูู 20-30 ูุซู ูุฐู ุงููุธุงุฆู ุ ููุง ุฃููุง ุชููุฑ ูุนูููุงุช ูุฎุชููุฉ ูู ุณุฌู ุงููุนุงููุงุช.  ุฃูุตู ุจุฃู ุชุชุนุฑู ุนูู ููุณู. <br><br><h4 style=";text-align:right;direction:rtl">  Pg_waldump ูุงุฆุฏุฉ <br></h4><br>  ูุจู ุงูุฅุตุฏุงุฑ 10.0 ุ ูุงู ูุทูู ุนููู ุงุณู pg_xlogdump.  ููุงู ุญุงุฌุฉ ุฅูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ pg_waldump ุนูุฏูุง ูุฑูุฏ ุงููุธุฑ ูู ููุงุทุน ุณุฌู ุงููุนุงููุงุช ุ ููุนุฑูุฉ ุณุฌูุงุช ุงูููุงุฑุฏ ุงูุชู ุญุตูุช ุนูููุง ุ ููุง ูุชุจ PostgreSQL ููุงู ุ ุฃู ูุฅุฌุฑุงุก ุฏุฑุงุณุฉ ุฃูุซุฑ ุชูุตููุงู. <br><br><blockquote style=";text-align:right;direction:rtl">  ูู ุงูุฅุตุฏุงุฑ 10.0 ุ ุชูุช ุฅุนุงุฏุฉ ุชุณููุฉ ุฌููุน ุทุฑู ุนุฑุถ ุงููุธุงู ูุงููุธุงุฆู ูุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ุงูุชู ุชุถููุช ูููุฉ xlog.  ุชู ุงุณุชุจุฏุงู ูู ุชูุฑุงุฑุงุช ุงููููุงุช xlog ูุงููููุน ุจุงููููุชูู wal ู lsn ุ ุนูู ุงูุชูุงูู.  ุชู ุนูู ููุณ ุงูุดูุก ูุน ุฏููู pg_xlog ุงูุฐู ุฃุตุจุญ ุฏููู pg_wal. <br></blockquote><br>  ุชููู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ pg_waldump ุจุจุณุงุทุฉ ุจูู ุชุดููุฑ ูุญุชููุงุช ููุงุทุน XLOG ุฅูู ุชูุณูู ูููู ูุฑุงุกุชู ุจูุงุณุทุฉ ุงูุฅูุณุงู.  ููููู ุฃู ุชุฑู ูุง ูุณูู ุณุฌูุงุช ุงูููุงุฑุฏ ุงูุชู ุชูุฏุฑุฌ ูู ุณุฌูุงุช ุงูููุทุน ุฃุซูุงุก ุนูู PostgreSQL ุ ูุงูุชู ุชู ุชุบููุฑ ุงูููุงุฑุณ ููููุงุช ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ ุ ููุง ูู ุงููุนูููุงุช ุงููุฎุตุตุฉ ููุงุณุชุฎุฏุงู ุงูุงุญุชูุงุทู.  ูุจุงูุชุงูู ุ ูููู ุนุฑุถ ุงููุซูุฑ ูู ุงููุนูููุงุช ุจุงุณุชุฎุฏุงู pg_waldump. <br><br><blockquote style=";text-align:right;direction:rtl">  ูููู ููุงู ุฅุฎูุงุก ูุณุคูููุฉ ููุชูุจ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> : ูุฏ ุชุธูุฑ pg_waldump ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ ููููุงู ุนูุฏ ุชุดุบูู PostgreSQL (ูููู ุฃู ุชุนุทู ูุชุงุฆุฌ ุฎุงุทุฆุฉ ุนูุฏ ุชุดุบูู ุงูุฎุงุฏู - ูููุง ูุงู ุฐูู) </blockquote><br>  ููููู ุงุณุชุฎุฏุงู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"><code class="sql hljs">pg_waldump -f - /wal_10 \ $(psql -qAtX - "<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> pg_walfile_name(pg_current_wal_lsn())<span class="hljs-string"><span class="hljs-string">")</span></span></code> </pre> <br>  ูุฐุง ุชูุงุธุฑู ููุฃูุฑ tail-f ูุณุฌูุงุช ุงููุนุงููุงุช ููุท.  ูุนุฑุถ ูุฐุง ุงูุฃูุฑ ุฐูู ุณุฌู ุงููุนุงููุงุช ุงูุฐู ูุญุฏุซ ุงูุขู.  ููููู ุชุดุบูู ูุฐุง ุงูุฃูุฑ ุ ูุณูู ูุฌุฏ ุงูุฌุฒุก ุงูุฃุฎูุฑ ูุน ุฅุฏุฎุงู ุณุฌู ุงููุนุงููุงุช ุงูุฃุญุฏุซ ุ ูุงูุงุชุตุงู ุจู ูุจุฏุก ุนุฑุถ ูุญุชููุงุช ุณุฌู ุงููุนุงููุงุช.  ูุฑูู ุตุนุจ ุจุนุถ ุงูุดูุก ุ ููููู ูุน ุฐูู ูุนูู.  ูุซูุฑุง ูุง ุชุณุชุฎุฏูู. <br><a name="cases"></a><br><h2 style=";text-align:right;direction:rtl">  ุชุญุฑูู ุงูุฎูู ูุฅุตูุงุญู <br></h2><br>  ููุง ูููู ูุธุฑุฉ ุนูู ุงููุดุงูู ุงูุฃูุซุฑ ุดููุนูุง ุงูุชู ุชูุดุฃ ูู ููุงุฑุณุฉ ุงูุงุณุชุดุงุฑููู ุ ููุง ูู ุงูุฃุนุฑุงุถ ูููููุฉ ุชุดุฎูุตูุง: <br><br>  <strong>ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ูู ุงููุดููุฉ ุงูุฃูุซุฑ ุดููุนูุง</strong> .  ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ูุงู ูุฏููุง ูุฑุงุณูุงุช ูุน ุงูุนููู: <br><br><blockquote style=";text-align:right;direction:rtl">  - <em>ููุฏ ูุณุฑูุง ุงููุณุฎ ุงููุชูุงุซู ููุนุจุฏ ุงูุฑุฆูุณู ุจูู ุงูุฎุงุฏููู.</em> <br><br>  - ุชุฃุฎุฑ ุงูุชุดุงูู ุณุงุนุชูู ุ ุจุฏุฃ pg_dump. <br><br>  - <em>ุญุณูุง ุ ูููุช.</em>  <em>ูุง ูู ุชุฃุฎุฑูุง ุงููุณููุญ ุจูุ</em> <br><br>  - 16 ุณุงุนุฉ ูู ุงูุญุฏ ุงูุฃูุตู ููุชุฃุฎูุฑ. <br><br>  <em>- ูุงุฐุง ุณูุญุฏุซ ุนูุฏูุง ูุชู ุชุฌุงูุฒ ูุฐุง ุงูุชุฃุฎุฑุ</em>  <em>ุตูุงุฑุงุช ุงูุฅูุฐุงุฑุ</em> <br><br>  - ูุง ุ ุณูุชู ุถุฑุจ ุงููุนุงููุงุช ุ ูุณูุชู ุงุณุชุฆูุงู ููุฉ WAL. <br></blockquote><br>  ูุฏููุง ูุดุงูู ูู ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู ุทูุงู ุงูููุช ุ ููู ุฃุณุจูุน ุชูุฑูุจูุง ูููู ุจุญููุง. <br><br>  <strong>ูุนุฏ ุชูุฑู ุงูุฏููู pg_wal /</strong> ุญูุซ ูุชู ุชุฎุฒูู ููุงุทุน ุณุฌู ุงููุนุงููุงุช ูุดููุฉ ุชุญุฏุซ ุจุดูู ุฃูู ุชูุฑุงุฑูุง.  ูููู ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงูุถุฑูุฑู ุงุชุฎุงุฐ ุฅุฌุฑุงุก ููุฑู ุญุชู ูุง ุชุชุญูู ุงููุดููุฉ ุฅูู ุญุงูุฉ ุทุงุฑุฆุฉ ุนูุฏ ุณููุท ุงููุณุฎ ุงููุชูุงุซูุฉ. <br><br>  <strong>ุชุคุฏู ุงูุงุณุชุนูุงูุงุช ุงูุทูููุฉ</strong> ุงูุชู ูุชู ุชุดุบูููุง ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุฅูู ุญุฏูุซ <strong>ุชุนุงุฑุถุงุช ุฃุซูุงุก ุงูุงุณุชุฑุฏุงุฏ</strong> .  ูุฐุง ูู ุงููุถุน ุนูุฏูุง ูุจุฏุฃ ููุนูุง ูู ุงูุชุญููู ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ููููู ุชูููุฐ ุงุณุชุนูุงูุงุช ุงููุฑุงุกุฉ ุนูู ุงููุณุฎ ุงููุชูุงุซูุฉ ุ ููู ูุฐู ุงููุญุธุฉ ุชุชุฏุงุฎู ูุฐู ุงูุงุณุชุนูุงูุงุช ูุน ุงุณุชูุณุงุฎ ุณุฌู ุงููุนุงููุงุช.  ููุงู ุชุนุงุฑุถ ุ ูุชุญุชุงุฌ PostgreSQL ุฃู ุชูุฑุฑ ูุง ุฅุฐุง ูุงูุช ุณุชูุชุธุฑ ุงูุชูุงู ุงูุงุณุชุนูุงู ุฃู ุฅููุงูู ูุงูุงุณุชูุฑุงุฑ ูู ุชุดุบูู ุณุฌู ุงููุนุงููุงุช.  ูุฐุง ุชุนุงุฑุถ ูู ุงููุณุฎ ุฃู ุชุนุงุฑุถ ูู ุงูุงุณุชุฑุฏุงุฏ. <br><br>  <strong>ุนูููุฉ ุงูุงุณุชุฑุฏุงุฏ: ุงุณุชุฎุฏุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุจูุณุจุฉ 100ูช -</strong> ุชุณุชุบุฑู ุนูููุฉ ุงุณุชุฑุฏุงุฏ ุณุฌู ุงููุนุงููุงุช ูู ุงููุณุฎ ุงููุชูุงุซูุฉ 100ูช ูู ููุช ุงููุนุงูุฌ.  ูุฐุง ุฃูุถูุง ูููู ูุงุฏุฑ ุ ููููู ูุฒุนุฌ ุฅูู ุญุฏ ูุง ุ ูุฃูู  ูุคุฏู ุฅูู ุฒูุงุฏุฉ ุชุฃุฎุฑ ุงููุณุฎ ููุตุนุจ ุงูุชุญููู ุจุดูู ุนุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ุชุฃุฎุฑ ุงููุณุฎ ุงููุชูุงุซู <br></h3><br>  ุชุญุฏุซ ุชุฃุฎูุฑุงุช ุงููุณุฎ ุงููุชูุงุซู ุนูุฏูุง ูููู ููุณ ุงูุทูุจ ุ ุงูุฐู ูุชู ุชูููุฐู ุนูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ุจุฅุฑุฌุงุน ุจูุงูุงุช ูุฎุชููุฉ.  ูุฐุง ูุนูู ุฃู ุงูุจูุงูุงุช ุบูุฑ ูุชูุงุณูุฉ ุจูู ุงูุฑุฆูุณูุฉ ูุงููุณุฎ ุงููุชูุงุซูุฉ ุ ูููุงู ุจุนุถ ุงูุชุฃุฎูุฑ.  ุชุญุชุงุฌ ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุฅูู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุฌุฒุก ูู ุณุฌูุงุช ุงููุนุงููุงุช ูู ุฃุฌู ุงููุญุงู ุจุงููุนุงูุฌ.  ุงูุนูุฑูุถ ุงูุฑุฆูุณู ูุจุฏู ุชูุงููุง ูุซู ูุฐุง: ููุงู ุงุณุชุนูุงู ุ ููุนุฑุถูู ูุชุงุฆุฌ ูุฎุชููุฉ. <br><br>  <strong>ููู ุชุจุญุซ ุนู ูุซู ูุฐู ุงููุดุงููุ</strong> <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุฌุฏ ุทุฑููุฉ ุนุฑุถ ุฃุณุงุณูุฉ ุญูู ุงููุนุงูุฌ ูุงููุณุฎ ุงููุชูุงุซูุฉ - <strong>pg_stat_replication</strong> .  ูุนุฑุถ ูุนูููุงุช ุนู ูู ูุฑุณู WAL ุ ุฃู ุนู ุงูุนูููุงุช ุงูุชู ุชุฑุณู ุณุฌูุงุช ุงููุนุงููุงุช.  ุณูููู ููู ูุณุฎุฉ ูุชูุงุซูุฉ ุณุทุฑ ูููุตู ูุนุฑุถ ุฅุญุตุงุฆูุงุช ูุฐู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุจุงูุชุญุฏูุฏ. <br></li><li style=";text-align:right;direction:rtl">  ุชุณูุญ ูู ุงููุธููุฉ ุงูุฅุถุงููุฉ <strong>pg_wal_lsn_diff ()</strong> ุจููุงุฑูุฉ ุงูููุงุถุน ุงููุฎุชููุฉ ูู ุณุฌู ุงููุนุงููุงุช ูุญุณุงุจ ุงูุชุฃุฎูุฑ ููุณู.  ุจูุณุงุนุฏุชูุง ุ ูููููุง ุงูุญุตูู ุนูู ุฃุฑูุงู ูุญุฏุฏุฉ ูุชุญุฏูุฏ ุฃูู ูุฏููุง ุชุฃุฎุฑูุง ูุจูุฑูุง ุ ูุฃูู ูููู ุตุบูุฑูุง ููุณุชุฌูุจ ุจุงููุนู ูููุดููุฉ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู. <br></li><li style=";text-align:right;direction:rtl">  ุชุนูู ูุธููุฉ <strong>pg_last_xact_replay_timestamp ()</strong> ููุท ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ูุชุณูุญ ูู ุจูุนุฑูุฉ ุงูููุช ุงูุฐู ุชู ููู ุชูููุฐ ุขุฎุฑ ูุนุงููุฉ ููููุฏุฉ.  ุชูุฌุฏ ุฏุงูุฉ ูุนุฑููุฉ ุงูุขู () ุชูุธูุฑ ุงูููุช ุงูุญุงูู ุ ููุทุฑุญ ุงูููุช ุงูุฐู ุชูุธูุฑู ููุง ุฏุงูุฉ pg_last_xact_replay_timestamp () ูู ุงูุฏุงูุฉ now () ููุญุตู ุนูู ูุงุฑู ุงูููุช. <br></li></ul><br>  ูู ุงูุฅุตุฏุงุฑ ุงูุนุงุดุฑ ูู pg_stat_replication ุ ุธูุฑุช ุญููู ุฅุถุงููุฉ ุชุธูุฑ ุงููุงุตู ุงูุฒููู ุจุงููุนู ุนูู ุงููุนุงูุฌ ุ ูุจุงูุชุงูู ูุฅู ูุฐู ุงูุทุฑููุฉ ูุฏููุฉ ุจุงููุนู ุ ูููู ูุน ุฐูู ุ ูููู ุงุณุชุฎุฏุงููุง. <br><br>  ููุงู ูุฃุฒู ุตุบูุฑ.  ุฅุฐุง ูู ุชูู ููุงู ูุนุงููุงุช ุนูู ุงููุนุงูุฌ ููุชุฑุฉ ุทูููุฉ ุ ููู ูุชู ุฅูุดุงุก ุณุฌูุงุช ูุนุงููุงุช ุ ูุณุชุธูุฑ ุงููุธููุฉ ุงูุฃุฎูุฑุฉ ุชุฃุฎุฑูุง ูุชุฒุงูุฏูุง.  ูู ุงููุงูุน ุ ุงููุธุงู ุฎุงูู ุจุจุณุงุทุฉ ุ ูุง ููุฌุฏ ุฃู ูุดุงุท ุนููู ุ ูููู ูู ุงููุฑุงูุจุฉ ูููููุง ุฃู ูุฑู ุฃู ุงููุงุฑู ูู ุงูููู.  ูุฐุง ุงููุฃุฒู ูุณุชุญู ุงูุชุฐูุฑ. <br><br>  ุงูุฑุฃู ุนูู ุงููุญู ุงูุชุงูู. <br><br><img src="https://habrastorage.org/webt/sb/jg/6k/sbjg6kswtdtymuecundldk180r8.jpeg"><br><br>  ูุญุชูู ุนูู ูุนูููุงุช ุนู ูู ูุฑุณู WAL ูุงูุนุฏูุฏ ูู ุงููุฌุงูุงุช ุงูุชู ุชูููุง.  ูุฐุง ูู ุงูููุงู ุงูุฃูู <strong>client_addr</strong> - ุนููุงู ุงูุดุจูุฉ <strong>ูููุณุฎุฉ</strong> ุงููุชูุงุซูุฉ ุงููุชุตูุฉ (ุนุงุฏุฉ ูุง ูููู ุนููุงู IP) ููุฌููุนุฉ ูู ุญููู <strong>lsn</strong> (ูู ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ ุชุณูู ุงููููุน) ุ ุณุฃุชุญุฏุซ ุนููุง ููููุงู. <br><br>  ูู ุงูุฅุตุฏุงุฑ ุงูุนุงุดุฑ ุ ุธูุฑุช ุญููู <strong>ุงูุชุฃุฎุฑ</strong> - ูุฐู ูู ุงููุฌูุฉ ุงูุชู ุชู ุงูุชุนุจูุฑ ุนููุง ูู ุงูููุช ุงูููุงุณุจ ุ ุฃู ุชูุณูู ุฃูุซุฑ ูุงุจููุฉ ูููุฑุงุกุฉ ูู ูุจู ุงูุฅูุณุงู.  ูููู ุงูุชุนุจูุฑ ุนู ุงูุชุฃุฎุฑ ุฅูุง ุจุงูุจุงูุช ุฃู ูู ุงูููุช ุงูููุงุณุจ - ููููู ุงุฎุชูุงุฑ ูุง ุชูุถูู. <br><br>  ููุงุนุฏุฉ ุ ุฃุณุชุฎุฏู ูุฐุง ุงูุทูุจ. <br><br><img src="https://habrastorage.org/webt/ff/8g/kv/ff8gkvz-kzdihuxabphcb0rfd4e.jpeg"><br><br>  ูุฐุง ููุณ ุงูุงุณุชุนูุงู ุงูุฃูุซุฑ ุชุนููุฏูุง ุงูุฐู ุชุทุจุนู pg_stat_replication ุจุชูุณูู ุฃูุซุฑ ููุงุกูุฉ ููููููุฉ.  ููุง ุฃุณุชุฎุฏู ุงููุธุงุฆู ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>pg_wal_lsn_diff ()</strong> ููุฑุงุกุฉ ุงููุฑูู.  ูููู ุจูู ูุง ุฃุนุชูุฏ ูุฎุชููุ  ูุฏููุง ุงูุนุฏูุฏ ูู ุงููุฌุงูุงุช - sent_lsn ู write_lsn ู flush_lsn ู replay_lsn.  ูู ุฎูุงู ุญุณุงุจ ุงููุฑู ุจูู ุงูุญูู ุงูุญุงูู ูุงูุญูู ุงูุณุงุจู ุ ูููููุง ุฃู ูููู ุจุฏูุฉ ุฃูู ุชุฃุฎุฑูุง ุ ูุฃูู ูุญุฏุซ ุงูุชุฃุฎุฑ ุจุงูุถุจุท. <br></li><li style=";text-align:right;direction:rtl">  <strong>pg_current_wal_lsn ()</strong> ุ ุงูุฐู ููุถุญ ุงูููุถุน ุงูุญุงูู ูุณุฌู ุงููุนุงููุงุช.  ููุง ููุธุฑ ุฅูู ุงููุณุงูุฉ ุจูู ุงูููุถุน ุงูุญุงูู ูู ุงูุณุฌู ูุงููุฑุณู - ุนุฏุฏ ุณุฌูุงุช ุงููุนุงููุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ูููู ูู ูุชู ุฅุฑุณุงููุง. <br></li><li style=";text-align:right;direction:rtl">  <strong>sent_lsn</strong> ุ <strong>write_lsn</strong> - ูุฐุง ูู ููุฏุงุฑ ูุง ูุชู ุฅุฑุณุงูู ุฅูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ูููู ูู ูุชู ุชุณุฌููู.  ุฃู ุฃูู ููุฌูุฏ ุงูุขู ูู ููุงู ูุง ุนูู ุงูุดุจูุฉ ุ ุฃู ุชู ุงุณุชูุงูู ุนู ุทุฑูู ูุณุฎุฉ ูุชูุงุซูุฉ ุ ูููู ูู ุชุชู ูุชุงุจุชู ุจุนุฏ ูู ุงููุฎุงุฒู ุงููุคูุชุฉ ููุดุจูุฉ ุฅูู ุชุฎุฒูู ุงููุฑุต. <br></li><li style=";text-align:right;direction:rtl">  <strong>write_lsn ุ flush_lsn</strong> - ูุฐุง ููุชูุจ ุ ูููู ูู ูุชู ุฅุตุฏุงุฑู ุจูุงุณุทุฉ ุงูุฃูุฑ fsync - ููุง ูู ูุงู ููุชูุจูุง ุ ูููู ูููู ูุถุนู ูู ููุงู ูุง ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุตูุญุฉ ููุธุงู ุงูุชุดุบูู.  ุจูุฌุฑุฏ ุฅุฌุฑุงุก fsync ุ ุชุชู ูุฒุงููุฉ ุงูุจูุงูุงุช ูุน ุงููุฑุต ุ ููุชู ุงููุตูู ุฅูู ุงูุชุฎุฒูู ุงููุณุชูุฑ ููุจุฏู ุฃู ูู ุดูุก ูููู ุงูุงุนุชูุงุฏ ุนููู. <br></li><li style=";text-align:right;direction:rtl">  <strong>replay_lsn ุ flush_lsn</strong> - ุชู ุชูุฑูุบ ุงูุจูุงูุงุช ุ ุชูููุฐ fsync ุ ูููู ูู ูุชู ูุณุฎูุง. <br></li><li style=";text-align:right;direction:rtl">  <strong>current_wal_lsn</strong> ู <strong>replay_lsn</strong> ูู ููุน ูู ุงูุชุฃุฎูุฑ ุงูููู ุงูุฐู ูุดูู ุฌููุน ุงูููุงูู ุงูุณุงุจูุฉ. <br></li></ul><br><h4 style=";text-align:right;direction:rtl">  <strong>ุจุนุถ ุงูุฃูุซูุฉ</strong> <br></h4><br><img src="https://habrastorage.org/webt/7c/9n/tt/7c9nttg6yp-uyimrxa4ji3ll1ha.jpeg"><br><br>  ุชู ุชูููุฒ ุงููุณุฎุฉ ุงููุชูุงุซูุฉ 10.6.6.8 ุฃุนูุงู.  ูุฏููุง <strong>ุชุฃุฎุฑ ูุนูู</strong> ุ ููุฏุช ุจุนุถ ุณุฌูุงุช ุงููุนุงููุงุช ุ ููููุง ูุง ุชุฒุงู ุบูุฑ ูุฑุณูุฉ ูุชููู ุนูู ุณูุฏ.  ุนูู ุงูุฃุฑุฌุญ ุ ููุงู ููุน ูู ุงููุดุงูู ูุน ุฃุฏุงุก ุงูุดุจูุฉ.  ุณูู ูุชุญูู ูู ุฐูู ุจุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ nicstat. <br><br>  ุณูููู ุจุชุดุบูู nicstat ุ ุฑุงุฌุน ุงุณุชุฎุฏุงู ุงููุงุฌูุฉ ุ ุฅุฐุง ูุงู ููุงู ุฃู ูุดุงูู ูุฃุฎุทุงุก ููุงู.  ุญุชู ูุชููู ูู ุงุฎุชุจุงุฑ ูุฐู ุงููุฑุถูุฉ. <br><br><img src="https://habrastorage.org/webt/co/-m/fj/co-mfjznunlrsuurikvz7xy9gh0.jpeg"><br><br>  <strong>ุชุฃุฎุฑ ุงููุชุงุจุฉ ุชู</strong> ูุถุน ุนูุงูุฉ ุนููู ุฃุนูุงู.  ูู ุงููุงูุน ุ ูุฐุง ุงูุชุฃุฎุฑ ูุงุฏุฑ ุฌุฏูุง ุ ูุง ุฃุฑู ุชูุฑูุจูุง ุฃูู ูุจูุฑ.  ูุฏ ุชููู ุงููุดููุฉ ูู ุงูุฃูุฑุงุต ุ ููุญู ูุณุชุฎุฏู ุฃุฏุงุฉ iostat ุฃู iotop - ููุญู ููุธุฑ ุฅูู ุงุณุชุฎุฏุงู ูุฎุงุฒู ุงููุฑุต ุ ุงูุชู ูุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ ุงูุนูููุงุช / ุงูุฅุฏุฎุงู ุ ุซู ููุชุดู ุงูุณุจุจ. <br><br><img src="https://habrastorage.org/webt/to/xw/2j/toxw2jutr7yaof38fwbohph9lva.jpeg"><br><br>  <strong>ูุณุญ</strong> ุงูุชุฃุฎูุฑ <strong>ูุฅุนุงุฏุฉ ุชุดุบููู</strong> - ุบุงูุจูุง ูุง ูุญุฏุซ ุงูุชุฃุฎุฑ ููุงู ุนูุฏูุง ูุง ูููู ูุฏู ุฌูุงุฒ ุงููุฑุต ุงูููุฌูุฏ ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูููุช ูููุฏุงู ุฌููุน ุงูุชุบููุฑุงุช ุงูุชู ุชุตู ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ. <br><br>  ุฃูุถูุง ูุน ุฃุฏูุงุช iostat ู iotop ุ ูููู ูุธุฑุฉ ุนูู ูุง ูุญุฏุซ ูุน ุงุณุชุฎุฏุงู ุงููุฑุต ูููุงุฐุง ุงููุฑุงูู. <br><br>  ูุฃุฎูุฑูุง <strong>total_lag</strong> ูู ูููุงุณ ูููุฏ ูุฃูุธูุฉ ุงููุฑุงูุจุฉ.  ุฅุฐุง ุชู ุชุฌุงูุฒ ุงูุญุฏ ุงูุฅุฌูุงูู ุงููุณููุญ ุจู ูุฏููุง ุ ูุณูุชู ุฑูุน ูุฑุจุน ุงุฎุชูุงุฑ ูู ุงููุฑุงูุจุฉ ุ ูุณูุจุฏุฃ ูู ุงูุชุญููู ูู ูุง ูุญุฏุซ ููุงู. <br><br><h4 style=";text-align:right;direction:rtl">  <strong>ุงุฎุชุจุงุฑ ุงููุฑุถูุงุช</strong> <br></h4><br>  ุชุญุชุงุฌ ุงูุขู ุฅูู ูุนุฑูุฉ ููููุฉ ุฅุฌุฑุงุก ุงููุฒูุฏ ูู ุงูุชุญููู ูู ูุดููุฉ ูุนููุฉ.  ุณุจู ุฃู ููุช ุฅุฐุง ูุงู ูุฐุง ุชุฃุฎุฑูุง ูู ุงูุดุจูุฉ ุ ูุนูููุง ุงูุชุญูู ููุง ุฅุฐุง ูุงู ูู ุดูุก ุนูู ูุง ูุฑุงู ูุน ุงูุดุจูุฉ. <br><br>  ุงูุขู ูููุฑ ุฌููุน ุงููุถูููู ุชูุฑูุจูุง 1 ุฌูุฌุงุจุช / ุซุงููุฉ ุฃู ุญุชู 10 ุฌูุฌุงุจุช / ุซุงููุฉ ุ ูุฐุง ูุฅู <strong>ุงููุทุงู ุงูุชุฑุฏุฏู ุงููุณุฏูุฏ ูู ุงูุณููุงุฑูู ุงูุฃูุซุฑ ุชุฑุฌูุญูุง</strong> .  ููุงุนุฏุฉ ุ ุชุญุชุงุฌ ุฅูู ุฅููุงุก ูุธุฑุฉ ุนูู ุงูุฃุฎุทุงุก.  ูุญุชูู nicstat ุนูู ูุนูููุงุช ุญูู ุงูุฃุฎุทุงุก ูู ุงููุงุฌูุงุช ุ ููููู ูุนุฑูุฉ ุฃู ููุงู ูุดุงูู ูุน ุจุฑุงูุฌ ุงูุชุดุบูู ุ ุฅูุง ูุน ุจุทุงูุฉ ุงูุดุจูุฉ ููุณูุง ุฃู ูุน ุงููุงุจูุงุช. <br><br>  ูุญู ูุญูู ูู <strong>ูุดุงูู ุงูุชุฎุฒูู</strong> ุจุงุณุชุฎุฏุงู iostat ู iotop.  ูุทููุจ iostat ูุนุฑุถ ุงูุตูุฑุฉ ุงูุนุงูุฉ ูุชุฎุฒูู ุงููุฑุต: ุฅุนุงุฏุฉ ุชุฏููุฑ ุงูุฌูุงุฒ ุ ุนุฑุถ ุงููุทุงู ุงูุชุฑุฏุฏู ููุฌูุงุฒ ุ ุงููููู.  iotop - ูุฅุฌุฑุงุก ุจุญุซ ุฃูุซุฑ ุฏูุฉ ุ ุนูุฏูุง ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุงูุนูููุฉ ุงูุชู ูุชู ุชุญููู ุงููุธุงู ุงููุฑุนู ูููุฑุต ุนูููุง.  ุฅุฐุง ูุงู ูุฐุง ููุนูุง ูู ุนูููุงุช ุงูุฌูุงุช ุงูุฎุงุฑุฌูุฉ ุ ููููู ุจุจุณุงุทุฉ ุงูุชุดุงูู ูุฅููุงูู ุ ูุฑุจูุง ุชุฎุชูู ุงููุดููุฉ. <br><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุญู ููุธุฑ ุฅูู <strong>ุชุฃุฎูุฑุงุช ุงูุงุณุชุฑุฏุงุฏ</strong> ูุชุนุงุฑุถุงุช <strong>ุงููุณุฎ ุงููุชูุงุซู ูู</strong> ุฎูุงู top ุฃู pg_stat_activity: ุงูุนูููุงุช ุงูุชู ูุชู ุชุดุบูููุง ุ ูุงูุทูุจุงุช ููุฏ ุงูุชุดุบูู ุ ูููุช ุชูููุฐูุง ุ ููุฏุฉ ุชุดุบูููุง.  ุฅุฐุง ูุงูุช ูุฐู ุจุนุถ ุงูุงุณุชูุณุงุฑุงุช ุงูุทูููุฉ ุ ูุฅููุง ููุธุฑ ุฅูู ุณุจุจ ุนูููุง ููุชุฑุฉ ุทูููุฉ ุ ููุทูู ุงููุงุฑ ุนูููุง ุ ููููููุง <strong>ููุญุณููุง</strong> - ุณููุญุต ุงูุงุณุชุนูุงูุงุช ููุณูุง. <br><br>  ุฅุฐุง ูุงูุช ูุฐู <strong>ูููุฉ ูุจูุฑุฉ ูู ุณุฌูุงุช ุงููุนุงููุงุช</strong> ุงูุชู ุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ ุงููุนุงูุฌ ุ ููููููุง ุงูุชุดุงู ุฐูู ุนู ุทุฑูู <strong>pg_stat_activity</strong> .  ุฑุจูุง ุจุฏุฃุช ุจุนุถ ุนูููุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู ููุงู ุ ุฃู ุจุฏุฃ ููุน ูู ุงููุฑุงุบ (pg_stat_progress_vacuum) ุ ุฃู ูุชู ุชูููุฐ ููุทุฉ ุงูุชูุชูุด.  ุฃู ุฃูู ุฅุฐุง ุชู ุฅูุดุงุก ุนุฏุฏ ูุจูุฑ ุฌุฏูุง ูู ุณุฌูุงุช ุงููุนุงููุงุช ุ ููู ููู ูุฏู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูููุช ุงููุงุฒู ููุนุงูุฌุชูุง ุ ููุฏ ุชุณูุท ูู ูุฑุญูุฉ ูุง ุ ูุณุชููู ูุฐู ูุดููุฉ ุจุงููุณุจุฉ ููุง. <br><br>  ูุจุงูุทุจุน <strong>pg_wal_lsn_diff ()</strong> ูุชุญุฏูุฏ ุงูุชุฃุฎุฑ ูุชุญุฏูุฏ ููุงู ุงูุชุฃุฎุฑ ุนูู ูุฌู ุงูุชุญุฏูุฏ - ุนูู ุงูุดุจูุฉ ุฃู ุนูู ุงูุฃูุฑุงุต ุฃู ุนูู ุงููุนุงูุฌุงุช. <br><br><h4 style=";text-align:right;direction:rtl">  <strong>ุฎูุงุฑุงุช ุงูุญู</strong> <br></h4><br>  <strong>ูุดุงูู ุงูุดุจูุฉ / ุงูุชุฎุฒูู</strong> <br><br>  ูู ุดูุก ุจุณูุท ููุบุงูุฉ ููุง ุ ูููู ูู ูุฌูุฉ ูุธุฑ ุงูุชูููู ุ ูุง ูุชู ุญู ูุฐุง ุนุงุฏุฉู.  ููููู ุชุดุฏูุฏ ุจุนุถ ุงูููุณุฑุงุช ุ ูููู ุจุดูู ุนุงู ููุงู ุฎูุงุฑุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุนุจุก ุงูุนูู </li></ul><br>  ุชุญูู ูู ุงูุทูุจุงุช ููุฏ ุงูุชุดุบูู.  ุฑุจูุง ูุชู ุฅุทูุงู ููุน ูู ุนูููุงุช ุงูุชุฑุญูู ุงูุชู ุชููุฏ ุงููุซูุฑ ูู ุณุฌูุงุช ุงููุนุงููุงุช ุ ุฃู ูููู ุฃู ุชููู ููู ุงูุจูุงูุงุช ุฃู ุงูุญุฐู ุฃู ุงูุฅุฏุฑุงุฌ.  <strong>ูููู ุฃู ุชุคุฏู ุฃู ุนูููุฉ ุชููุฏ ุณุฌูุงุช ุงููุนุงููุงุช ุฅูู ุชุฃุฎุฑ ุงููุนุงููุงุช</strong> .  ูุชู ุฅูุดุงุก ูุงูุฉ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุนูู ุงููุนุงูุฌ ูู ุฃุณุฑุน ููุช ูููู ุ ููููุง ุจุฅุฌุฑุงุก ุชุบููุฑ ุนูู ุงูุจูุงูุงุช ุ ูุฃุฑุณููุงูุง ุฅูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ููููู ูููุณุฎุฉ ุงููุชูุงุซูุฉ ุงูุชุนุงูู ูุนูุง ุฃู ูุดููุง - ููุฐุง ูุง ูุชุนูู ุจุงููุนุงูุฌ.  ูุฏ ูุธูุฑ ุชุฃุฎุฑ ููุง ูุนููู ุฃู ุชูุนู ุดูุฆูุง ูุนูุง. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฑููุฉ ุงูุฃุฌูุฒุฉ <br></li></ul><br>  ุงูุฎูุงุฑ ุงูุฃูุซุฑ ุบุจุงุก - ุฑุจูุง ูุงุฌููุง ุฃุฏุงุก ุงูุญุฏูุฏ ุ ูุชุญุชุงุฌ ููุท ุฅูู ุชุบููุฑู.  ูููู ุฃู ุชููู ุงูุฃูุฑุงุต ุงููุฏููุฉ ุฃู ูุญุฑูุงุช ุงูุฃูุฑุงุต ุฐุงุช ุงูุฌูุฏุฉ ุงูุฑุฏูุฆุฉ ุ ุฃู ูุงุจุณ ูู ุฃุฏุงุก ูุญุฏุฉ ุชุญูู RAID.  ููุง ูู ูุนุฏ ูุณุชูุดู ุงููุงุนุฏุฉ ููุณูุง ุ ูููู ูุชุญูู ูู ุฃุฏุงุก ุงูุบุฏุฏ. <br><br>  <strong>ุชุฃุฎูุฑุงุช ุงูุงุณุชุฑุฏุงุฏ</strong> <br><br>  ุฅุฐุง ูุงู ูุฏููุง ุฃู ููุน ูู ุชุนุงุฑุถุงุช ุงููุณุฎ ุงููุชูุงุซู ุจุณุจุจ ุงูุทูุจุงุช ุงูุทูููุฉ ุ ููุง ุฃุฏู ุฅูู ุฒูุงุฏุฉ ุชุฃุฎุฑ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ูุฅู <strong>ุฃูู ุดูุก</strong> ูููู ุจู ูู <strong>ุชุตููุฑ ุงูุทูุจุงุช ุงูุทูููุฉ</strong> ุงูุชู ูุชู ุชุดุบูููุง ุนูู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุ ูุฃููุง ุชุคุฎุฑ ุชุดุบูู ุณุฌูุงุช ุงููุนุงููุงุช. <br><br>  ุฅุฐุง ูุงูุช ุงูุงุณุชุนูุงูุงุช ุงูุทูููุฉ ูุชุนููุฉ ุจุนุฏู ุงููุซุงููุฉ ูุงุณุชุนูุงู SQL ููุณู (ูุฌุฏ ุฐูู ุจุงุณุชุฎุฏุงู EXPLAIN ANALYZE) ุ ูุง ุนููู ุณูู ุงูุชุนุงูู ูุน ูุฐุง ุงูุงุณุชุนูุงู ุจุดูู ูุฎุชูู ูุฅุนุงุฏุฉ ูุชุงุจุชู.  ุฃู ููุงู ุฎูุงุฑ ูุชูููู ูุณุฎุฉ <strong>ูุชูุงุซูุฉ ูููุตูุฉ ูุงุณุชุนูุงูุงุช ุงูุชูุงุฑูุฑ</strong> .  ุฅุฐุง ูููุง ุจุนูู ุฃู ุชูุงุฑูุฑ ุชุนูู ููุชุฑุฉ ุทูููุฉ ุ ููุฌุจ ุฅุฑุณุงููุง ุฅูู ูุณุฎุฉ ูุชูุงุซูุฉ ูููุตูุฉ. <br><br>  ูุง ูุฒุงู ููุงู ุฎูุงุฑ <strong>ุงูุงูุชุธุงุฑ ููุท</strong> .  ุฅุฐุง ูุงู ูุฏููุง ููุน ูู ุงูุชุฃุฎูุฑ ุนูู ูุณุชูู ุจุถุนุฉ ููููุจุงูุช ุฃู ุญุชู ุนุดุฑุงุช ุงูููุบุงุจุงูุช ุ ููููุง ูุนุชูุฏ ุฃู ูุฐุง ููุจูู ุ ููุญู ููุชุธุฑ ุงูุชูุงู ุงูุทูุจ ูุณูุญู ุงููุงุฑู ููุณู.  ูุฐุง ุฃูุถูุง ุฎูุงุฑ ุ ูุบุงูุจูุง ูุง ูููู ููุจูููุง. <br><br>  <strong>WAL ุนุงูู ุงูุญุฌู</strong> <br><br>  ุฅุฐุง ุฃูุดุฃูุง ุญุฌููุง ูุจูุฑูุง ูู ุณุฌู ุงููุนุงููุงุช ุ ููุญู ุจุญุงุฌุฉ ุฅูู ุชูููู ูุฐุง <strong>ุงูุญุฌู ููู ูุญุฏุฉ ุฒูููุฉ</strong> ุ ูุฌุนู ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุชุญุชุงุฌ ุฅูู ูุถุบ ุณุฌูุงุช ุฃูู ูููุนุงููุงุช. <br><br>  ูุชู ุฐูู ุนุงุฏุฉ ูู <strong>ุฎูุงู ุงูุชูููู</strong> .  ุงูุญู ุงูุฌุฒุฆู ูู ุชุนููู full_page_writes = ุฅููุงู ุงููุนููุฉ.  ูููู ูุฐุง ุงูุฎูุงุฑ ุจุชุดุบูู / ุฅููุงู ุชุณุฌูู ุงูุตูุฑ ุงููุงููุฉ ููุตูุญุงุช ุงููุชุบูุฑุฉ ูู ุณุฌู ุงููุนุงููุงุช.  ูุฐุง ูุนูู ุฃูู ุนูุฏูุง ูุงูุช ูุฏููุง ุนูููุฉ ุงูุฎุฏูุฉ ููุชุงุจุฉ ููุทุฉ ุชุญูู (CHECKPOINT) ุ ูู ุงููุฑุฉ ุงูุชุงููุฉ ุงูุชู ูุบูุฑ ูููุง ุจุนุถ ูุชูุฉ ุงูุจูุงูุงุช ูู ููุทูุฉ ุงููุฎุงุฒู ุงููุคูุชุฉ ุงููุดุชุฑูุฉ ุ ุณุชุฐูุจ ุงูุตูุฑุฉ ุงููุงููุฉ ููุฐู ุงูุตูุญุฉ ุฅูู ุณุฌู ุงููุนุงููุงุช ุ ูููุณ ููุท ุงูุชุบููุฑ ููุณู.  ูุน ุฌููุน ุงูุชุบููุฑุงุช ุงููุงุญูุฉ ุนูู ููุณ ุงูุตูุญุฉ ุ ุณูุชู ุชุณุฌูู ุงูุชุบููุฑุงุช ููุท ูู ุณุฌู ุงููุนุงููุงุช.  ูููุฐุง ุฅูู ููุทุฉ ุงูุชูุชูุด ุงูุชุงููุฉ. <br><br>  ุจุนุฏ ููุทุฉ ุงูุชูุชูุด ุ ูุณุฌู ุงูุตูุฑุฉ ุงููุงููุฉ ููุตูุญุฉ ุ ููุฐุง ูุคุซุฑ ุนูู ุญุฌู ุณุฌู ุงููุนุงููุงุช ุงููุณุฌู.  ุฅุฐุง ูุงู ููุงู ุงููุซูุฑ ูู ููุงุท ุงูุชูุชูุด ููู ูุญุฏุฉ ุฒูููุฉ ุ ููููุชุฑุถ ุฃู ููุงู 4 ููุงุท ุชูุชูุด ูู ุงูุณุงุนุฉ ุ ูุณูููู ููุงู ุงููุซูุฑ ูู ุตูุฑ ุงูุตูุญุฉ ุงููุงููุฉ ุ ูุณุชููู ูุฐู ูุดููุฉ.  ููููู ุชุนุทูู ุชุณุฌูู ุงูุตูุฑ ุงููุงููุฉ ููุฐุง ุณูุคุซุฑ ุนูู ุญุฌู WAL.  ูููู ูุฑุฉ ุฃุฎุฑู ุ ูุฐุง ูุตู ุฅุฌุฑุงุก. <br><br>  <i>ููุงุญุธุฉ: ูุฌุจ ุงููุธุฑ ุจุนูุงูุฉ ูู ุงูุชูุตูุฉ ุจุชุนุทูู full_page_writes ุ ุญูุซ ูุณู ุงููุคูู ุฃู ููุถุญ ุฃุซูุงุก ุงูุชูุฑูุฑ ุฃู ุชุนุทูู ุงููุนููุฉ ูููู ุ ูู ุจุนุถ ุงูุญุงูุงุช ุ ุฃู ูุญุฏุซ ูู ุญุงูุงุช ุงูุทูุงุฑุฆ (ุชูู ูุธุงู ุงููููุงุช ุฃู ุณุฌูู ุ ุงููุชุงุจุฉ ุงูุฌุฒุฆูุฉ ูููุชู ุ ุฅูุฎ.) ูููุงุช ูุงุนุฏุฉ ุจูุงูุงุช ูุญุชูู ุฃู ุชููู ูุงุณุฏุฉ.</i>  <i>ูุฐูู ุ ูู ุญุฐุฑูุง ุ ูุฏ ูุคุฏู ุชุนุทูู ุงููุนููุฉ ุฅูู ุฒูุงุฏุฉ ุฎุทุฑ ุชูู ุงูุจูุงูุงุช ูู ุญุงูุงุช ุงูุทูุงุฑุฆ.</i> <br><br>  ูููุงุณ ูุตู ุขุฎุฑ ูู <strong>ุฒูุงุฏุฉ ุงููุงุตู ุงูุฒููู ุจูู ููุงุท ุงูุชูุชูุด</strong> .  ุจุดูู ุงูุชุฑุงุถู ุ ุชุชู ููุทุฉ ุงูุชูุชูุด ูู 5 ุฏูุงุฆู ุ ููุฐุง ุฃูุฑ ุดุงุฆุน ุฌุฏูุง.  ููุงุนุฏุฉ ุ ูุชู ุฒูุงุฏุฉ ูุฐุง ุงููุงุตู ุงูุฒููู ุฅูู 30-60 ุฏูููุฉ - ููุฐุง ููุช ููุจูู ุชูุงููุง ุชููู ุฌููุน ุงูุตูุญุงุช ุงููุชุณุฎุฉ ูู ุฃู ุชุตุจุญ ูุชุฒุงููุฉ ูุน ุงููุฑุต. <br><br>  ููู ุงูุญู ุงูุฑุฆูุณู ุ ุจุงูุทุจุน ุ ูู <strong>ุฅููุงุก ูุธุฑุฉ ุนูู ุนุจุก ุงูุนูู ูุฏููุง</strong> - ุฃู ููุน ูู ุงูุนูููุงุช ุงูุซูููุฉ ุงูุฌุงุฑูุฉ ููุงู ุ ุงููุฑุชุจุทุฉ ุจุชุบููุฑ ุงูุจูุงูุงุช ุ ูุฑุจูุง ูุญุงููุฉ ุงูููุงู ุจูุฐู ุงูุชุบููุฑุงุช ุนูู ุฏูุนุงุช. <br><br>  ูููุชุฑุถ ุฃู ูุฏููุง ุฌุฏูููุง ุ ูุฑูุฏ ุญุฐู ุนุฏุฉ ููุงููู ูู ุงูุณุฌูุงุช ููู.  ุฃูุถู ุฎูุงุฑ ูู ุนุฏู ุญุฐู ูุคูุงุก ุงูููุงููู ูู ููุช ูุงุญุฏ ูุน ุทูุจ ูุงุญุฏ ุ ูููู ุชูุณูููู ุฅูู ุญุฒู ูู 100-200 ุฃูู ุจุญูุซ ุ ุฃููุงู ุ ูุชู ุฅูุดุงุก ูููุงุช ุตุบูุฑุฉ ูู WAL ุ ูุซุงูููุง ุ ูููู ุงููุฑุงุบ ููุชูุง ูุชูุฑูุฑ ุงูุจูุงูุงุช ุงููุญุฐููุฉ ุ ูุจุงูุชุงูู ูู ููู ุงููุงุฑู ุจุทูุฆูุง ูุจูุฑ ูุญุฑุฌ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูุฑู pg_wal / <br></h3><br>  ุงูุขู ุ ููุชุญุฏุซ ุนู ููู ููููู ุงูุนุซูุฑ ุนูู ุฃู ุงูุฏููู pg_wal / ูุชูุฑู. <br><br>  ูุธุฑููุง ุ ูุญุชูุธ PostgreSQL ุฏุงุฆููุง ูู ุญุงูุฉ ูุซูู ูููุณู ุนูู ูุณุชูู ูููุงุช ุชูููู ูุนููุฉ ุ ูููุงุนุฏุฉ ุนุงูุฉ ุ ูุฌุจ ุฃูุง ูููู ููู ุญุฏูุฏ ูุนููุฉ. <br><br>  ุชูุฌุฏ ูุนููุฉ max_wal_size ุ ุชุญุฏุฏ ุงููููุฉ ุงููุตูู.  ุจุงูุฅุถุงูุฉ ุฅูู ูุฌูุฏ ูุนููุฉ wal_keep_segments - ุนุฏุฏ ุฅุถุงูู ูู ุงูุฃุฌุฒุงุก ุงูุชู ูุฎุฒููุง ุงูุฑุฆูุณู ูููุณุฎุฉ ุงููุชูุงุซูุฉ ุฅุฐุง ูุงูุช ุงููุณุฎุฉ ุงููุชูุงุซูุฉ ุบูุฑ ูุชุงุญุฉ ูุฌุฃุฉ ููุชุฑุฉ ุทูููุฉ. <br><br>  ุจุนุฏ ุญุณุงุจ ูุฌููุน max_wal_size ู wal_keep_segments ุ ูููููุง ุชูุฏูุฑ ุงููุณุงุญุฉ ุงูุชู ุณูุดุบููุง ุงูุฏููู pg_wal /.  ุฅุฐุง ูุงู ูููู ุจุณุฑุนุฉ ููุณุชููู ูุณุงุญุฉ ุฃูุจุฑ ุจูุซูุฑ ูู ุงููููุฉ ุงููุญุณูุจุฉ ุ ููุฐุง ูุนูู ุฃู ููุงู ุจุนุถ ุงููุดุงูู ุ ูุนููู ุฃู ุชูุนู ุดูุฆูุง ุญูุงู ุฐูู. <br><br><h4 style=";text-align:right;direction:rtl">  ููู ุชูุดู ูุซู ูุฐู ุงููุดุงููุ <br></h4><br>  ุนูู ูุธุงู ุงูุชุดุบูู Linux ุ ููุฌุฏ ุฃูุฑ <strong>du-csh</strong> .  ูููููุง ุจุจุณุงุทุฉ ูุฑุงูุจุฉ ุงููููุฉ ููุฑุงูุจุฉ ุนุฏุฏ ุณุฌูุงุช ุงููุนุงููุงุช ุงูููุฌูุฏุฉ ูุฏููุง ุ  ุงุญุชูุธ ุจุนูุงูุฉ ูุญุณูุจุฉ ุ ููุฏูููู ููู ูุฃุฎุฐ ูู ุงููุงูุน ุ ูุงูุงุณุชุฌุงุจุฉ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ููุชุบูุฑุงุช ูู ุงูุฃุฑูุงู. <br><br>  ููุงู ุขุฎุฑ ููุธุฑ ุฅููู ูู <strong>ุทุฑู</strong> ุนุฑุถ <strong>pg_replication_slots</strong> ู <strong>pg_stat_archiver</strong> .  ุงูุฃุณุจุงุจ ุงูุฃูุซุฑ ุดููุนูุง ูุฑุงุก ุงุญุชูุงู pg_wal / ูุณุงุญุฉ ูุจูุฑุฉ ูู ูุณูุงู ูุชุญุงุช ุงููุณุฎ ุงููุชูุงุซู ุฃู ุงูุฃุฑุดูุฉ ุงููุนุทูุฉ.  ุฃุณุจุงุจ ุฃุฎุฑู ููุง ุฃูุถูุง ููุงู ุ ูููู ูู ููุงุฑุณุชู ูุงูุช ูุงุฏุฑุฉ ุฌุฏูุง. <br><br>  ูุจุงูุทุจุน ุ ููุงู ุฏุงุฆููุง ุฃุฎุทุงุก ูู ุณุฌูุงุช PostgreSQL ุงููุฑุชุจุทุฉ ุจุฃูุฑ ุงูุฃุฑุดูู.  ููุฃุณู ุ ูู ุชููู ููุงู ุฃุณุจุงุจ ุฃุฎุฑู ุชุชุนูู ุจู pg_wal / overflow.  ูููููุง ุงูุชูุงุท ุฃุฎุทุงุก ุงูุฃุฑุดูู ููุท ููุงู. <br><br><h4 style=";text-align:right;direction:rtl">  ุฎูุงุฑุงุช ุงููุดุงูู: <br></h4><br>  <strong>ุงูุซูููุฉ CRUD</strong> - ุนูููุงุช ุชุญุฏูุซ ุงูุจูุงูุงุช ุงูุซูููุฉ - INSERT ุ DELETE ุ UPDATE ุ ุงููุฑุชุจุทุฉ ุจุชุบููุฑ ุนุฏุฉ ููุงููู ูู ุงูุตููู.  ุฅุฐุง ูุงูุช PostgreSQL ุจุญุงุฌุฉ ุฅูู ุงูููุงู ุจูุฐู ุงูุนูููุฉ ุ ููู ุงููุงุถุญ ุฃูู ุณูุชู ุฅูุดุงุก ูููุฉ ูุจูุฑุฉ ูู ุณุฌู ุงููุนุงููุงุช.  ุณูุชู ุชุฎุฒููู ูู pg_wal / ุ ูุณูุคุฏู ุฐูู ุฅูู ุฒูุงุฏุฉ ุงููุณุงุญุฉ ุงููุดุบููุฉ.  ูุฐุง ุ ูุฑุฉ ุฃุฎุฑู ุ ููุง ููุช ุณุงุจููุง ุ ูู ุงูููุงุฑุณุงุช ุงูุฌูุฏุฉ ุชูุณูููุง ุจุจุณุงุทุฉ ุฅูู ุญุฒู ุ ูููุณ ุชุญุฏูุซ ุงูุตููู ุจุฃูููู ุ ูููู 100 ุ 200 ุ 300 ุฃูู ููู ููููุง. <br><br>  ูุดููุฉ <strong>ุงููุณุฎ ุงููุชูุงุซู ุงูููุณูุฉ ุฃู ุบูุฑ ุงููุณุชุฎุฏูุฉ</strong> ูุดููุฉ ุดุงุฆุนุฉ ุฃุฎุฑู.  ุบุงูุจูุง ูุง ูุณุชุฎุฏู ุงูุฃุดุฎุงุต ุงููุณุฎ ุงููุชูุงุซู ุงูููุทูู ูุจุนุถ ููุงููู: ูููููู ุจุชูููู ุงูุญุงููุงุช ุงูุชู ุชุฑุณู ุงูุจูุงูุงุช ุฅูู Kafka ุ ูุชุฑุณู ุงูุจูุงูุงุช ุฅูู ุชุทุจูู ุชุงุจุน ูุฌูุฉ ุฎุงุฑุฌูุฉ ูููู ุจูู ุดูุฑุฉ ุงููุณุฎ ุงููุชูุงุซู ุงูููุทูู ุฅูู ุชูุณูู ุขุฎุฑ ููุนุงูุฌูุง ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู.  <strong>ูุนูู ุงููุณุฎ ุงููุชูุงุซู ุงูููุทูู ุนุงุฏุฉู ูู ุฎูุงู ุงููุชุญุงุช</strong> .  ูุญุฏุซ ุฃู ูููุง ุจุฅุนุฏุงุฏ ูุชุญุฉ ูุณุฎ ูุชูุงุซู ุ ูุนุจูุง ูุน ุงูุชุทุจูู ุ ุฃุฏุฑููุง ุฃู ูุฐุง ุงูุชุทุจูู ูุง ููุงุณุจูุง ุ ููููุง ุจุฅููุงู ุชุดุบูู ุงูุชุทุจูู ุ ูุญุฐูู ุ <strong>ูุงุณุชูุฑุช ูุชุญุงุช ุงููุณุฎ ุงููุชูุงุซู ูู ุงูุนูู</strong> . <br><br>  ูุญูุธ PostgreSQL ููู ูุชุญุฉ ูุณุฎ ูุชูุงุซู ููุงุทุน ูู ุณุฌู ุงููุนุงููุงุช ูู ุญุงูุฉ ุงุชุตุงู ุชุทุจูู ุฃู ูุณุฎุฉ ูุชูุงุซูุฉ ุนู ุจุนุฏ ุจูุฐู ุงููุชุญุฉ ูุฑุฉ ุฃุฎุฑู ุ ููู ุซู ูููู ูููุนุงูุฌ ุฅุฑุณุงู ุณุฌูุงุช ุงููุนุงููุงุช ูุฐู ุฅูููู. <br><br>  ููู ุงูููุช ููุฑ ุ ูุง ุฃุญุฏ ูุชุตู ุจุงููุชุญุฉ ุ ููุชู ุชุฌููุน ุณุฌูุงุช ุงููุนุงููุงุช ุ ููู ููุช ูุง ุชุดุบู 90ูช ูู ุงููุณุงุญุฉ.  ูุญู ุจุญุงุฌุฉ ููุนุฑูุฉ ูุง ูู ุ ูููุงุฐุง ูุชู ุฃุฎุฐ ูุณุงุญุฉ ูุจูุฑุฉ.  ููุงุนุฏุฉ ุ ุชุญุชุงุฌ ููุท ุฅูู ุฅุฒุงูุฉ ูุฐู ุงููุชุญุฉ ุงูููุณูุฉ ูุบูุฑ ุงููุณุชุฎุฏูุฉ ุ ูุณูุชู ุญู ุงููุดููุฉ.  ููู ุงููุฒูุฏ ุนู ุฐูู ูุงุญููุง. <br><br>  ูุฏ ูููู ุฎูุงุฑ ุขุฎุฑ ูู ุฃูุฑ <strong>ุฃุฑุดูู ูุญููุธ</strong> .  ุนูุฏูุง ูููู ูุฏููุง ููุน ูู ูุณุชูุฏุน ุณุฌู ุงููุนุงููุงุช ุงูุฎุงุฑุฌูุฉ ุงูุฐู ูุญุชูุธ ุจู ูููุงู ุงูุงุณุชุฑุฏุงุฏ ุจุนุฏ ุนุทู ูุงุฏุญ ุ ุนุงุฏุฉ ูุง ูุชู ุฅุนุฏุงุฏ ุฃูุฑ ุฃุฑุดูู ุ ููู ูุซูุฑ ูู ุงูุฃุญูุงู ูุชู ุฅุนุฏุงุฏ pg_receivexlog.  ุบุงูุจูุง ูุง ูููู ุงูุฃูุฑ ุงููุณุฌู ูู archive_command ุฅูุง ุฃูุฑูุง ูููุตูุงู ุฃู ุจุนุถ ุงููุตูุต ุงูุจุฑูุฌูุฉ ุงูุชู ุชุฃุฎุฐ ุฃุฌุฒุงุก ูู ุณุฌู ุงููุนุงููุงุช ูู pg_wal / ูุชูุณุฎูุง ุฅูู ุชุฎุฒูู ุงูุฃุฑุดูู. <br><br>  ูุญุฏุซ ุฃููุง ุฃุฌุฑููุง ููุนูุง ูู ุงูุชุฑููุฉ ูุญุฒู ุงููุธุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู rsync ุชู ุชุบููุฑ ุงูุฅุตุฏุงุฑ ุ ุฃู ุชู ุชุญุฏูุซ ุงูุนูุงูุงุช ุฃู ุชุบููุฑูุง ุ ุฃู ูู ุฃูุฑ ุขุฎุฑ ุชู ุงุณุชุฎุฏุงูู ูู ุฃูุฑ ุงูุฃุฑุดูู ุ ุชู ุชุบููุฑ ุงูุชูุณูู ุฃูุถูุง - ูุงูุจุฑูุงูุฌ ุงููุตู ุฃู ุงูุจุฑูุงูุฌ ููุณู ุงููุญุฏุฏ ูู ููุงุตู archive_command.  ููุชูุฌุฉ ูุฐูู ุ ูุชููู ูุณุฎ ุงููุญููุธุงุช. <br><br>  ุฅุฐุง ูุงู ุงูุฃูุฑ archive ูุนูู ุจูุฎุฑุฌ ููุณ 0 ุ ูุณูุชู ูุชุงุจุฉ ุฑุณุงูุฉ ุญูู ูุฐุง ูู ุงูุณุฌู ุ ูุณูุจูู ุงูููุทุน ูู ุงูุฏููู pg_wal /.  <strong>ุญุชู ูุฌุฏ ุฃู ูุฑูู ุงูุฃุฑุดูู ูุฏ ุงููุณุฑ ุ ุณุชุชุฑุงูู ุงูุฃุฌุฒุงุก</strong> ุ ูููุชูู ุงูููุงู ุฃูุถูุง ูู ูุฑุญูุฉ ูุง. <br><br>  <strong>ูุฌููุนุฉ ูู ุชุฏุงุจูุฑ ุงูุทูุงุฑุฆ (ุงููุณุงุญุฉ ุงููุณุชุฎุฏูุฉ 100ูช):</strong> <br><br> 1. <strong>   CRUD </strong> ,        โ pg_terminate_backend(). <br>    -  ,  , ,      ..       ,      pg_wal/,     . <br><br> 2. <strong>    </strong>    root โ reserved space ratio (ext filesystems). <br>       ext      ext     5%.  ,         ,  5% โ  . ,   ,     1%  ,     tune2fs -m 1.       PostgreSQL     ,    .      100%     . <br><br> 3. <strong>  </strong> (LVM, ZFS,...). <br>    LVM  ZFS,        LVM  ZFS,            ,   ,           .       ,   . <br><br> 4.    โ <strong>, , HE    pg_wal/</strong> . <br>          ,     ,   ,   .     ! PostgreSQL     ,   .     ,  ,   ,    . <br><br> , pg_xlog/   pg_wal/     โ  log    ,   , , ,  -   โ  ! <br><br><h4 style=";text-align:right;direction:rtl">    <br></h4><br>  ,         100%  CPU,      . <br><br>   <strong> workload  </strong> .    ,       ?  ,     - ,      -.         :   ,   tablespace,    tablespace. <br><br>   <strong> </strong> .       ,  ,    ,    , ,  ,            . <strong>   โ      .</strong> <br><br>   <strong>  checkpoints_segments/max_wal_size, wal_keep_segments</strong> .  ,    ,      โ 10-20   wal_keep_segments,     max_wal_size.  ,        .  PostgreSQL       pg_wal/  . <br><br>  <strong>  </strong>   pg_replication_slots โ     .   ,   <strong> </strong> ,        โ      .   ,    ,    .    . <br><br>      WAL,       ,  <strong>    pg_stat_archiver</strong> ,    . ,  <strong>  </strong> , ,    ,    . <br><br>    <strong>   checkpoint</strong> .       ,        ,      . , PostgreSQL        . <strong>   ,    checkpoint</strong> . <br><br><h3 style=";text-align:right;direction:rtl">       <br></h3><br>    ,   ,   โ        .   -             ,       .      ,         . <br><br> <strong> </strong> โ    PostgreSQL  : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> User was holding shared bufer pin for too long. <br></li><li style=";text-align:right;direction:rtl"> User query might have needed to see row versions that must be removed. <br></li><li style=";text-align:right;direction:rtl"> User was holding a relation lock for too long. <br></li><li style=";text-align:right;direction:rtl"> User was or might have been using table space that must be dropped. <br></li><li style=";text-align:right;direction:rtl"> User transaction caused bufer deadlock with recovery. <br></li><li style=";text-align:right;direction:rtl"> User was connected to a database that must be dropped. <br></li></ul><br>  2  โ    ,       ,      .   :  ,   ,      .        (  30 ),  <strong>PostgreSQL       </strong> โ  . <br><br>    .  ,    ,             .    -    ,     timeout     .     โ    ALTER,    ,    . <br><br>     .     ,  tablespace     ,            tablespace.   ,    ,  -   โ   . <br><br><h4 style=";text-align:right;direction:rtl"> <strong> ?</strong> <br></h4><br>       <strong>pg_stat_databases, pg_stat_databases_conflicts</strong> .         ,    .     ,    . <br><br>  <strong>  </strong> ,       <strong> </strong> .  ,      .   ,    . ,       ,    ,    . <br><br><h4 style=";text-align:right;direction:rtl"> <strong> ?</strong> <br></h4><br>   ,    โ    : <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <strong> max_standby_streaming_delay</strong> (  ).     ,       .    <strong>   </strong> . <br></li><li style=";text-align:right;direction:rtl"> <strong> hot_stadby_feedback</strong> (  /).  ,  vacuum   - ,       .     <strong> bloat  </strong> .     ,    ,  ,   hot_stadby_feedback  . <br></li><li style=";text-align:right;direction:rtl">     DBA     โ  <strong>  </strong> .   <strong> </strong> ,    .  ,    ,     ,   -    ,  . <br></li><li style=";text-align:right;direction:rtl">  , ,  ,   ,  DBA โ  <strong>     </strong> , ,  .    max_standby_streaming_delay  .       ,   .      ,  ,    ,  .  <strong>   </strong> โ    ,     . <br></li></ol><br><h2 style=";text-align:right;direction:rtl"> Recovery process: 100% CPU usage <br></h2><br>  ,  ,    , <strong> 100%   </strong> .  ,      ,      100%.  ,    pg_stat_replication,  ,     replay,       ,    . <br><br> <strong></strong>  : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <strong>top</strong> โ       โ    100% CPU usage  recovery process; <br></li><li style=";text-align:right;direction:rtl"> <strong>pg_stat_replication</strong> โ  ,   ,     . <br></li></ul><br><h4 style=";text-align:right;direction:rtl"> <strong>   </strong> <br></h4><br>      ,    .  ,     : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> perf top/record/report ( debugโ); <br></li><li style=";text-align:right;direction:rtl"> GDB; <br></li><li style=";text-align:right;direction:rtl">  pg_waldump. <br></li></ul><br>  ,   ,       .     workload,   <strong>        </strong> .  ,    , PostgreSQL     shared buffers       ( ).        . <br><br><h4 style=";text-align:right;direction:rtl">  <strong>ุงูุญู</strong> <br></h4><br>    ,      <strong>   </strong> . -   workload, - , -    : ยซ      ,  -  ยป. <br><br>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pgsql-hackers</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pgsql-bugs</a> ,   ,   .  ,    . <br><br>     โ <strong>-   ,  , </strong> . <br><br><h2 style=";text-align:right;direction:rtl">  ุงูููุฎุต <br></h2><br> <strong>      </strong> .  ,             ,    ,      . <br><br> <strong>     </strong> .    , ,  ,    ,   ,   โ . <br><br>  , <strong>  </strong> ,   โ .   ,   ,  ,         . <br><br>  ,    ,  <strong>  </strong> โ  ,      ,   . <br><br><h3 style=";text-align:right;direction:rtl">  ุฑูุงุจุท ูููุฏุฉ <br></h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> PostgreSQL official documentation โ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">The Statistics Collector</a> </li><li style=";text-align:right;direction:rtl"> PostgreSQL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Mailing Lists</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">general</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">performance</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">hackers</a> ) </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PostgreSQL-Consulting company blog</a> </li></ul><br><blockquote style=";text-align:right;direction:rtl">             , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Highload++ Siberia</a> ,   <strong>25  26   </strong> .   ,     ,  . <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>     MySQL  ClickHouse. </li><li style=";text-align:right;direction:rtl">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> ,            Oracle. </li><li style=";text-align:right;direction:rtl">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>    ,     ,  โ  ,       . </li><li style=";text-align:right;direction:rtl">    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> ,   VK  ClickHouse,   ,   . </li></ul><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar414111/">https://habr.com/ru/post/ar414111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar414095/index.html">[ุชุฑุฌูุฉ] Elasticsearch 6.3.0 ุตุฏุฑ</a></li>
<li><a href="../ar414097/index.html">ุฃุฌูุฒุฉ ููุจููุชุฑ Apple ุชุบูู ุซุบุฑุฉ ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุงูุชู ูุฌุฏูุง ุฎุจุฑุงุก ุงูุชูููุงุช ุงูุฅูุฌุงุจูุฉ</a></li>
<li><a href="../ar414103/index.html">ูุฏูุฉ ููุชูุญุฉ ุนูู ุงูููุจ: "ุงูุดุจูุงุช ุงูุนุตุจูุฉ ููููุงู ุงูุตูุฏูุงููุฉ"</a></li>
<li><a href="../ar414105/index.html">ุชููุน ูุชุงุฆุฌ ูุฃุณ ุงูุนุงูู 2018 ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุงูุบุงุจุงุช ุงูุนุดูุงุฆูุฉ</a></li>
<li><a href="../ar414109/index.html">ุงุณุชุฎุฏุงู Docker ูุฅูุดุงุก ูุดุฑูุน C ++ ูุชุดุบููู</a></li>
<li><a href="../ar414115/index.html">ูุง ูู Lazy FP State Restore: ุซุบุฑุฉ ุฌุฏูุฏุฉ ุชู ุงูุชุดุงููุง ูู ูุนุงูุฌุงุช Intel</a></li>
<li><a href="../ar414117/index.html">ุชูุณูู ุซูุงุฆู ุนุดุฑู ูุฎุชูุท ููุงุจู IEEE754</a></li>
<li><a href="../ar414119/index.html">ููุช ุงููุฑุตุฉ ููููู ุจุณุจุจ ุนุงุตูุฉ ุฑูููุฉ ุนูู ุงููุฑูุฎ. ูู ุบูุฑ ุงููุงุถุญ ูุง ุฅุฐุง ูุงูุช ุงููุฑูุจุฉ ุณุชุชููู ูู ุงูุนูู ูุฑุฉ ุฃุฎุฑู</a></li>
<li><a href="../ar414121/index.html">DIY ุจุฏูู ุทูุงุฑ ุจุฏูู ุทูุงุฑ ูุน ุงูุชุญูู ูู ุงูุฅูุชุฑูุช</a></li>
<li><a href="../ar414123/index.html">ูููู ุจุชุฑููุฉ ุจุฑูุชููููุงุช ุงููุต ุฅูู ุซูุงุฆู ููุญุงุฑุจุฉ ุงูุฑูุฒ ุงููุฏูู ูู ุงุฌุชูุงุน ูุฌููุนุฉ ูุณุชุฎุฏูู C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>