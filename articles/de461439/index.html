<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìö üöé üí™ Starten der React- und TypeScript-Komponentenbibliothek üèáüèæ ‚õ≥Ô∏è üçµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die meiste Zeit meiner Arbeit schreibe ich Backends, aber neulich gab es eine Aufgabe, eine Bibliothek von Komponenten auf React zu starten. Vor einig...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Starten der React- und TypeScript-Komponentenbibliothek</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461439/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/57/zc/nc57zcknvdousryimpgxxqsiz1i.jpeg"></div><br><p>  Die meiste Zeit meiner Arbeit schreibe ich Backends, aber neulich gab es eine Aufgabe, eine Bibliothek von Komponenten auf React zu starten.  Vor einigen Jahren, als die React-Version so klein war wie meine Erfahrung in der Front-End-Entwicklung, habe ich mich bereits dem Projektil gen√§hert und es stellte sich als ungeschickt und ungeschickt heraus.  Angesichts der Reife des aktuellen React-√ñkosystems und meiner wachsenden Erfahrung wurde ich diesmal dazu inspiriert, alles gut und bequem zu machen.  Infolgedessen hatte ich eine L√ºcke f√ºr die zuk√ºnftige Bibliothek, und um nichts zu vergessen und alles an einem Ort zu sammeln, wurde dieser Spickzettelartikel geschrieben, der auch denen helfen sollte, die nicht wissen, wo sie anfangen sollen.  Mal sehen, was ich getan habe. </p><a name="habracut"></a><br><p>  <strong><em>TL / DR: Code f√ºr eine startbereite Bibliothek kann auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">github angezeigt werden</a></em></strong> </p><br><p>  Das Problem kann von zwei Seiten angegangen werden: </p><br><ol><li>  Finden Sie ein fertiges Starter-Kit, eine Boilerplate oder einen Cli-Generator </li><li>  Sammle alles selbst </li></ol><br><p>  Die erste Methode eignet sich f√ºr einen schnellen Start, wenn Sie sich absolut nicht mit der Konfiguration und Verbindung der erforderlichen Pakete befassen m√∂chten.  Diese Option eignet sich auch f√ºr Anf√§nger, die nicht wissen, wo sie anfangen sollen und was der Unterschied zwischen der Bibliothek und der regul√§ren Anwendung sein sollte. </p><br><p>  Zuerst ging ich den ersten Weg, aber dann beschloss ich, die Abh√§ngigkeiten zu aktualisieren und ein paar weitere Pakete zu befestigen, und dann regneten alle Arten von Fehlern und Inkonsistenzen.  Infolgedessen krempelte er die √Ñrmel hoch und machte alles selbst.  Aber ich werde den Bibliotheksgenerator erw√§hnen. </p><br><h2 id="create-react-library">  Erstellen Sie eine Reaktionsbibliothek </h2><br><p>  Die meisten Entwickler, die sich mit React besch√§ftigen, haben von einem praktischen React-Anwendungsstarter geh√∂rt, mit dem Sie die Projektkonfiguration minimieren und angemessene Standardeinstellungen bereitstellen k√∂nnen - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Create React App</a> (CRA).  Im Prinzip k√∂nnte es f√ºr die Bibliothek verwendet werden ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">es gibt einen Artikel √ºber das Habr√©</a> ).  Die Projektstruktur und der Ansatz zur Entwicklung des UI-Kits unterscheiden sich jedoch geringf√ºgig vom √ºblichen SPA.  Wir ben√∂tigen ein separates Verzeichnis mit Quellcodes von Komponenten (src), eine Sandbox f√ºr deren Entwicklung und Debugging (Beispiel), ein Dokumentations- und Demonstrationstool ("Schaufenster") und ein separates Verzeichnis mit f√ºr den Export vorbereiteten Dateien (dist).  Au√üerdem werden Bibliothekskomponenten nicht zur SPA-Anwendung hinzugef√ºgt, sondern √ºber eine Indexdatei exportiert.  Als ich dar√ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nachdachte</a> , machte ich mich auf die Suche und entdeckte schnell ein √§hnliches CRA-Paket - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Creat React Library</a> (CRL). </p><br><p>  CRL ist wie CRA ein benutzerfreundliches CLI-Dienstprogramm.  Mit ihm k√∂nnen Sie ein Projekt generieren.  Es wird enthalten: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rollup</a> zum Erstellen von cjs- und es-Modulen sowie einer Quellzuordnung mit Unterst√ºtzung f√ºr CSS-Module konfiguriert </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">babel</a> f√ºr die Transpilation in ES5 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Scherz</a> f√ºr Tests </li><li>  TypeScript (TS) als Option, die wir verwenden m√∂chten </li></ul><br><p>  Um das Bibliotheksprojekt zu generieren, k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wir</a> es tun ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">npx</a> erlaubt uns, Pakete nicht global zu installieren): </p><br><pre><code class="bash hljs">npx create-react-library</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Wir beantworten die vorgeschlagenen Fragen.</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/wd/ql/qq/wdqlqqfmjrgntiqz6zphcdyccdw.png" alt="CLR-Fragen"></p></div></div><br><p>  Als Ergebnis des Dienstprogramms erhalten wir ein generiertes und einsatzbereites Projekt der Komponentenbibliothek. </p><br><div class="spoiler">  <b class="spoiler_title">Mit einer bestimmten Struktur</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/vs/d4/l2/vsd4l2o2g1wn3n0folb_yr30ui8.png" alt="Clr Baum"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Und dann ging etwas schief ...</b> <div class="spoiler_text"><p>  Abh√§ngigkeiten sind heute etwas veraltet, daher habe ich beschlossen, sie alle mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">npm-check</a> auf die neuesten Versionen zu aktualisieren: </p><br><pre> <code class="bash hljs">npx npm-check -u</code> </pre> <br><p>  Eine weitere traurige Tatsache ist, dass die Sandbox-Anwendung im <code>example</code> in js generiert wird.  Sie m√ºssen es manuell in TypeScript <code>tsconfig.json</code> und <code>tsconfig.json</code> und einige Abh√§ngigkeiten hinzuf√ºgen (z. B. <code>@types</code> selbst und grundlegende <code>@types</code> ). </p><br><p>  Au√üerdem wird das Paket <code>react-scripts-ts</code> als <code>deprecated</code> deklariert und nicht mehr unterst√ºtzt.  Stattdessen sollten Sie React <code>react-scripts</code> installieren, da CRA (dessen Paket <code>react-scripts</code> ) seit einiger Zeit TypeScript aus der Box unterst√ºtzt (mit Babel 7). </p><br><p>  Infolgedessen habe ich es nicht geschafft, die <code>react-scripts</code> f√ºr meine Idee der Bibliothek <code>react-scripts</code> .  Soweit ich mich erinnere, erforderte der Jest aus diesem Paket die Compileroption <code>isolatedModules</code> , was meinem Wunsch <code>d.ts</code> aus der Bibliothek zu generieren und zu exportieren (all dies h√§ngt irgendwie mit den Einschr√§nkungen von Babel 7 zusammen, das von Jest und <code>react-scripts</code> zum Kompilieren von TS verwendet wird )  Also habe ich einen <code>eject</code> f√ºr <code>react-scripts</code> , mir das Ergebnis angesehen und alles mit meinen H√§nden √ºberarbeitet, wor√ºber ich sp√§ter schreiben werde. </p></div></div><br><h2 id="tsdx">  tsdx </h2><br><p>  Vielen Dank an den Benutzer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">StanEgo</a> , der √ºber eine hervorragende Alternative zu Create React Library - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">tsdx sprach</a> .  Dieses CLI-Dienstprogramm √§hnelt auch CRA und erstellt mit einem Befehl die Basis f√ºr Ihre Bibliothek mit konfiguriertem Rollup, TS, Prettier, Husky, Jest und React.  Und Reagieren ist eine Option.  Einfach genug zu tun: </p><br><pre> <code class="bash hljs">npx tsdx create mytslib</code> </pre> <br><p>  Infolgedessen werden die erforderlichen neuen Versionen der Pakete installiert und alle Einstellungen vorgenommen.  Holen Sie sich ein CRL-√§hnliches Projekt.  Der Hauptunterschied zu CRL ist Zero-Config.  Das hei√üt, die Rollup-Konfiguration ist in tsdx vor uns verborgen (genau wie CRA). </p><br><p>  Nachdem ich die Dokumentation schnell durchgearbeitet hatte, fand ich nicht die empfohlenen Methoden f√ºr eine feinere Konfiguration oder etwas wie Auswerfen wie in CRA.  Nachdem ich mir das Thema des Projekts angesehen hatte, stellte ich fest, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">es bisher keine solche M√∂glichkeit gibt</a> .  Bei einigen Projekten kann dies kritisch sein. In diesem Fall m√ºssen Sie ein wenig mit Ihren H√§nden arbeiten.  Wenn Sie es nicht ben√∂tigen, ist tsdx eine gro√üartige M√∂glichkeit, schnell loszulegen. </p><br><h2 id="beryom-upravlenie-v-svoi-ruki">  √úbernehmen Sie die Kontrolle selbst </h2><br><p>  Aber was ist, wenn Sie den zweiten Weg gehen und alles selbst sammeln?  Beginnen wir also von vorne.  F√ºhren Sie <code>npm init</code> und generieren Sie <code>package.json</code> f√ºr die Bibliothek.  F√ºgen Sie dort einige Informationen zu unserem Paket hinzu.  Zum Beispiel schreiben wir die Mindestversionen f√ºr Node und Npm in das <code>engines</code> Feld.  Die gesammelten und exportierten Dateien werden im <code>dist</code> Verzeichnis abgelegt.  Wir geben dies im Feld <code>files</code> .  Wir erstellen eine Bibliothek mit Reaktionskomponenten und hoffen, dass die Benutzer √ºber die erforderlichen Pakete verf√ºgen. Wir <code>peerDependencies</code> erforderlichen Mindestversionen von <code>peerDependencies</code> und <code>peerDependencies</code> <code>react-dom</code> im Feld <code>peerDependencies</code> . </p><br><p>  Installieren Sie nun die React- und React <code>react-dom</code> Pakete und die erforderlichen Typen (da wir Komponenten in TypeScript s√§gen werden) als devDependencies (wie alle Pakete in diesem Artikel): </p><br><pre> <code class="bash hljs">npm install --save-dev react react-dom @types/react @types/react-dom</code> </pre> <br><p>  Installieren Sie TypeScript: </p><br><pre> <code class="bash hljs">npm install --save-dev typescript</code> </pre> <br><p>  Erstellen wir Konfigurationsdateien f√ºr den <code>tsconfig.json</code> und die Tests: <code>tsconfig.json</code> und <code>tsconfig.test.json</code> .  Unser <code>target</code> wird in <code>es5</code> , wir werden <code>sourceMap</code> usw. generieren.  Eine vollst√§ndige Liste der m√∂glichen Optionen und ihrer Bedeutung finden Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> .  Vergessen Sie nicht, <code>include</code> Quellverzeichnis in das <code>include</code> , und f√ºgen Sie die <code>node_modules</code> und <code>dist</code> im <code>exclude</code> .  In <code>package.json</code> wir im Feld <code>typings</code> , wo die Typen f√ºr unsere Bibliothek <code>typings</code> werden sollen - <code>dist/index</code> . </p><br><p>  Erstellen Sie das <code>src</code> Verzeichnis f√ºr die Quellkomponenten der Bibliothek.  F√ºgen Sie alle m√∂glichen kleinen Dinge hinzu, wie <code>.gitignore</code> . <code>.editorconfig</code> <code>.gitignore</code> , <code>.editorconfig</code> , eine Datei mit einer Lizenz und <code>README.md</code> . </p><br><h3 id="rollup">  Rollup </h3><br><p>  Wir werden Rollup f√ºr die Montage verwenden, wie von CRL vorgeschlagen.  Erforderliche Pakete und Konfiguration, ich habe auch CRL ausspioniert.  Im Allgemeinen h√∂rte ich die Meinung, dass Rollup gut f√ºr Bibliotheken und Webpack f√ºr Anwendungen ist.  Ich habe Webpack jedoch nicht konfiguriert (was CRA f√ºr mich tut), aber Rollup ist wirklich gut, einfach und sch√∂n. </p><br><p>  Installieren: </p><br><pre> <code class="bash hljs">npm install --save-dev rollup rollup-plugin-babel rollup-plugin-commonjs rollup-plugin-node-resolve rollup-plugin-peer-deps-external rollup-plugin-postcss rollup-plugin-typescript2 rollup-plugin-url @svgr/rollup</code> </pre> <br><p>  <code>package.json</code> in <code>package.json</code> die Felder mit der Verteilung der gesammelten Bibliothekspakete hinzu, wie uns das <code>rollup</code> empfiehlt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pkg.module</a> : </p><br><pre> <code class="json hljs"> <span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"module"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.es.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"jsnext:main"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.es.js"</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Erstellen Sie die Konfigurationsdatei rollup.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> typescript <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-typescript2'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> commonjs <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-commonjs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> external <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-peer-deps-external'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> postcss <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-postcss'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> resolve <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-node-resolve'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-url'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> svgr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@svgr/rollup'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pkg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./package.json'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">input</span></span>: <span class="hljs-string"><span class="hljs-string">'src/index.tsx'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">file</span></span>: pkg.main, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'cjs'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'named'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourcemap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">file</span></span>: pkg.module, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'es'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'named'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourcemap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ external(), postcss({ <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">extract</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">minimize</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourceMap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }), url(), svgr(), resolve(), typescript({ <span class="hljs-attr"><span class="hljs-attr">rollupCommonJSResolveHack</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">clean</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }), commonjs() ] };</code> </pre> </div></div><br><p>  Die Konfiguration ist eine js-Datei oder vielmehr ein exportiertes Objekt.  Geben Sie im <code>input</code> die Datei an, in der die Exporte f√ºr unsere Bibliothek registriert sind.  <code>output</code> - beschreibt unsere Erwartungen an die Ausgabe - in welchem ‚Äã‚ÄãModul im Format kompiliert werden soll und wo es abgelegt werden soll. </p><br><div class="spoiler">  <b class="spoiler_title">Als n√§chstes folgt das Feld mit einer Liste und Konfiguration der Plugins</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rollup-plugin-peer-deps-external</a> - Erm√∂glicht das Ausschlie√üen von <code>peerDependencies</code> aus dem <code>bundle</code> , um dessen Gr√∂√üe zu verringern.  Dies ist sinnvoll, da vom Bibliotheksbenutzer <code>peerDependencies</code> erwartet werden </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rollup-plugin-postcss</a> - integriert <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PostCss</a> und Rollup.  Hier deaktivieren wir CSS-Module, f√ºgen CSS aus unserer Bibliothek in das Exportpaket ein, minimieren es und erm√∂glichen die Erstellung von SourceMap.  Wenn Sie kein anderes CSS als das von den Bibliothekskomponenten verwendete exportieren, kann das <code>extract</code> vermieden werden. Das erforderliche CSS in den Komponenten wird am Ende nach Bedarf zum Head-Tag auf der Seite hinzugef√ºgt.  In meinem Fall ist es jedoch erforderlich, einige zus√§tzliche CSS (Raster, Farben usw.) zu verteilen, und der Client muss die CSS-Bundle-Bibliothek explizit mit sich selbst verbinden. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rollup-Plugin-URL</a> - Erm√∂glicht das Exportieren verschiedener Ressourcen, z. B. Bilder </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">svgr</a> - wandelt svg in React-Komponenten um </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rollup-Plugin-Node-Resolution - Definiert</a> den Speicherort von Modulen von Drittanbietern in Node_Modules </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rollup-plugin-typescript2</a> - verbindet den TypeScript-Compiler und bietet die M√∂glichkeit, ihn zu konfigurieren </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rollup-plugin-commonjs</a> - konvertiert commonjs-Abh√§ngigkeitsmodule in es-Module, damit sie in das Bundle aufgenommen werden k√∂nnen </li></ul></div></div><br><p>  F√ºgen Sie im Feld <code>scripts</code> <code>package.json</code> einen Befehl zum Erstellen hinzu ( <code>"build": "rollup -c"</code> ) und starten Sie die Assembly w√§hrend der Entwicklung im <code>"start": "rollup -c -w &amp;&amp; npm run prettier-watch"</code> ( <code>"start": "rollup -c -w &amp;&amp; npm run prettier-watch"</code> ). . </p><br><h3 id="pervyy-komponent-i-eksportnyy-fayl">  Die erste Komponente und Exportdatei </h3><br><p>  Jetzt schreiben wir die einfachste Reaktionskomponente, um zu √ºberpr√ºfen, wie unsere Baugruppe funktioniert.  Jede Komponente in der Bibliothek wird in einem separaten Verzeichnis im √ºbergeordneten Verzeichnis <code>src/components/ExampleComponent</code> - <code>src/components/ExampleComponent</code> .  Dieses Verzeichnis enth√§lt alle Dateien, die der Komponente zugeordnet sind - <code>tsx</code> , <code>css</code> , <code>test.tsx</code> usw. <br>  Lassen Sie uns einige <code>tsx</code> f√ºr die Komponente und die <code>tsx</code> Datei der Komponente selbst erstellen. </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class ExampleComponent */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface Props { <span class="hljs-comment"><span class="hljs-comment">/** * Simple text prop **/</span></span> text: string; } <span class="hljs-comment"><span class="hljs-comment">/** My First component */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExampleComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Props</span></span></span><span class="hljs-class">&gt; </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { text } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"test"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Example Component: {text} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Coool!</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ExampleComponent;</code> </pre> </div></div><br><p>  Au√üerdem m√ºssen Sie in <code>src</code> eine Datei mit Typen erstellen, die Bibliotheken gemeinsam haben, wobei ein Typ f√ºr css und svg deklariert wird (siehe CRL). </p><br><div class="spoiler">  <b class="spoiler_title">typings.d.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Default CSS definition for typescript, * will be overridden with file-specific definitions by rollup */</span></span> declare <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> <span class="hljs-string"><span class="hljs-string">'*.css'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> content: { [className: string]: string }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> content; } interface SvgrComponent extends React.FunctionComponent&lt;React.SVGAttributes&lt;SVGElement&gt;&gt; {} declare <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> <span class="hljs-string"><span class="hljs-string">'*.svg'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> svgUrl: string; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> svgComponent: SvgrComponent; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> svgUrl; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { svgComponent <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ReactComponent }; }</code> </pre> </div></div><br><p>  Alle exportierten Komponenten und CSS m√ºssen in der Exportdatei angegeben werden.  Wir haben es - <code>src/index.tsx</code> .  Wenn einige CSS nicht im Projekt verwendet werden und nicht als Teil der in <code>src/index.tsx</code> importierten <code>src/index.tsx</code> , wird sie aus der Assembly entfernt, was in Ordnung ist. </p><br><div class="spoiler">  <b class="spoiler_title">src / index.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent, Props } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./export.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { ExampleComponent, Props };</code> </pre> </div></div><br><p>  Jetzt k√∂nnen Sie versuchen, die Bibliothek zu erstellen - <code>npm run build</code> .  Infolgedessen startet das <code>rollup</code> und sammelt unsere Bibliothek in Bundles, die wir im <code>dist</code> Verzeichnis finden. </p><br><p>  Als n√§chstes f√ºgen wir einige Tools hinzu, um die Qualit√§t unseres Entwicklungsprozesses und dessen Ergebnis zu verbessern. </p><br><h3 id="zabyvaem-o-formatirovanii-koda-s-prettier">  Vergessen Sie die Code-Formatierung mit Prettier </h3><br><p>  Ich hasse es, in einer Code√ºberpr√ºfung auf eine Formatierung hinzuweisen, die f√ºr ein Projekt nachl√§ssig oder nicht standardisiert ist, geschweige denn dar√ºber zu streiten.  Solche M√§ngel sollten nat√ºrlich behoben werden, aber Entwickler sollten sich darauf konzentrieren, was und wie der Code funktioniert und nicht wie er aussieht.  Diese Korrekturen sind der erste Kandidat f√ºr die Automatisierung.  F√ºr diese Aufgabe gibt es ein wunderbares Paket - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sch√∂ner</a> .  Installieren Sie es: </p><br><pre> <code class="bash hljs">npm install --save-dev prettier</code> </pre> <br><p>  F√ºgen Sie eine Konfiguration hinzu, um die Formatierungsregeln ein wenig zu verfeinern. </p><br><div class="spoiler">  <b class="spoiler_title">.prettierrc.json</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"tabWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"singleQuote"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"jsxBracketSameLine"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"arrowParens"</span></span>: <span class="hljs-string"><span class="hljs-string">"always"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"printWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"semi"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bracketSpacing"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> </div></div><br><p>  Die Bedeutung der verf√ºgbaren Regeln sehen Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> .  WebStrom schl√§gt nach dem Erstellen der Konfigurationsdatei selbst vor, beim Starten der Formatierung √ºber die IDE <code>prettier</code> .  Um zu verhindern, dass die Formatierung Zeit verschwendet, f√ºgen Sie das <code>/node_modules</code> und <code>/dist</code> mithilfe der Datei <code>.prettierignore</code> zu den Ausnahmen <code>.prettierignore</code> (das Format √§hnelt <code>.gitignore</code> ).  Jetzt k√∂nnen Sie <code>prettier</code> indem Sie Formatierungsregeln auf den Quellcode anwenden: </p><br><pre> <code class="bash hljs">prettier --write <span class="hljs-string"><span class="hljs-string">"**/*"</span></span></code> </pre> <br><p>  Um den Befehl nicht jedes Mal explizit mit Ihren H√§nden auszuf√ºhren und um sicherzustellen, dass der Code der anderen Projektentwickler auch <code>prettier</code> formatiert wird, f√ºgen Sie den <code>prettier</code> Lauf am <code>precommit-hook</code> f√ºr die als <code>staged</code> markierten Dateien hinzu (√ºber <code>git add</code> ).  Daf√ºr brauchen wir zwei Werkzeuge.  Erstens ist es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hasky</a> , verantwortlich f√ºr die Ausf√ºhrung von Befehlen vor dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Festschreiben</a> , Dr√ºcken usw.  Und zweitens ist es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fusselfrei</a> , wodurch verschiedene Linters f√ºr <code>staged</code> Dateien ausgef√ºhrt werden k√∂nnen.  Wir m√ºssen nur eine Zeile ausf√ºhren, um diese Pakete zu liefern und <code>package.json</code> zu <code>package.json</code> : </p><br><pre> <code class="bash hljs">npx mrm lint-staged</code> </pre> <br><p>  Wir k√∂nnen nicht vor dem Festschreiben auf die Formatierung warten, sondern stellen sicher, dass <code>prettier</code> w√§hrend unserer Arbeit st√§ndig an ge√§nderten Dateien arbeitet.  Ja, wir brauchen ein anderes Paket - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onchange</a> .  Sie k√∂nnen √Ñnderungen an Dateien im Projekt √ºberwachen und sofort den daf√ºr erforderlichen Befehl ausf√ºhren.  Installieren: </p><br><pre> <code class="bash hljs">npm install --save-dev --save-exact onchange</code> </pre> <br><p>  Dann f√ºgen wir den <code>scripts</code> Feldbefehle in <code>package.json</code> : </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"prettier-watch"</span></span>: <span class="hljs-string"><span class="hljs-string">"onchange 'src/**/*' -- prettier --write {{changed}}"</span></span></code> </pre> <br><p>  In diesem Zusammenhang k√∂nnen alle Streitigkeiten √ºber die Formatierung im Projekt als abgeschlossen betrachtet werden. </p><br><h3 id="izbegaem-oshibok-s-eslint">  Vermeiden von Fehlern mit ESLint </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ESLint ist</a> seit langem ein Standard und findet sich in fast allen js und ts-Projekten.  Er wird uns auch helfen.  In der ESLint-Konfiguration vertraue ich CRA. Nehmen Sie einfach die erforderlichen Pakete von CRA und schlie√üen Sie sie an unsere Bibliothek an.  F√ºgen Sie au√üerdem Konfigurationen f√ºr TS und <code>prettier</code> (um Konflikte zwischen <code>ESLint</code> und <code>prettier</code> zu vermeiden): </p><br><pre> <code class="bash hljs">npm install --save-dev eslint eslint-config-react-app eslint-loader eslint-plugin-flowtype eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser babel-eslint eslint-config-prettier eslint-plugin-prettier</code> </pre> <br><p>  <code>ESLint</code> mithilfe der Konfigurationsdatei. </p><br><div class="spoiler">  <b class="spoiler_title">.eslintrc.json</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"extends"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"plugin:@typescript-eslint/recommended"</span></span>, <span class="hljs-string"><span class="hljs-string">"react-app"</span></span>, <span class="hljs-string"><span class="hljs-string">"prettier"</span></span>, <span class="hljs-string"><span class="hljs-string">"prettier/@typescript-eslint"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"@typescript-eslint"</span></span>, <span class="hljs-string"><span class="hljs-string">"react"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/no-empty-interface"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/explicit-function-return-type"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/explicit-member-accessibility"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span> } }</code> </pre> </div></div><br><p>  F√ºgen Sie den Befehl <code>lint</code> - <code>eslint src/**/* --ext .ts,.tsx --fix</code> zum <code>package.json</code> von <code>package.json</code> .  Jetzt k√∂nnen Sie eslint bis <code>npm run lint</code> . </p><br><h3 id="testiruem-s-jest">  Testen mit Scherz </h3><br><p>  Installieren und konfigurieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jest</a> , eine Testbibliothek von Facebook, um Komponententests f√ºr Bibliothekskomponenten zu schreiben.  Da jedoch  wir kompilieren TS nicht √ºber babel 7, sondern √ºber tsc, dann m√ºssen wir auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ts-jest-</a> Paket installieren: </p><br><pre> <code class="bash hljs">npm install --save-dev jest ts-jest @types/jest</code> </pre> <br><p>  Damit Jest Importe von CSS oder anderen Dateien ordnungsgem√§√ü akzeptieren kann, m√ºssen Sie diese durch Mokami ersetzen.  Erstellen Sie das Verzeichnis <code>__mocks__</code> und erstellen Sie dort zwei Dateien. <br>  <code>styleMock.ts</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = {};</code> </pre> <br><p>  <code>fileMock.ts</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-string"><span class="hljs-string">'test-file-stub'</span></span>;</code> </pre> <br><p>  Erstellen Sie nun die Scherzkonfiguration. </p><br><div class="spoiler">  <b class="spoiler_title">jest.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">preset</span></span>: <span class="hljs-string"><span class="hljs-string">'ts-jest'</span></span>, <span class="hljs-attr"><span class="hljs-attr">testEnvironment</span></span>: <span class="hljs-string"><span class="hljs-string">'node'</span></span>, <span class="hljs-attr"><span class="hljs-attr">moduleNameMapper</span></span>: { <span class="hljs-string"><span class="hljs-string">'\\.(css|less|sass|scss)$'</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;rootDir&gt;/__mocks__/styleMock.ts'</span></span>, <span class="hljs-string"><span class="hljs-string">'\\.(gif|ttf|eot|svg)$'</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;rootDir&gt;/__mocks__/fileMock.ts'</span></span> } };</code> </pre> </div></div><br><p>  Wir werden den einfachsten Test f√ºr unsere <code>ExampleComponent</code> in ihr Verzeichnis schreiben. </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.test.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'is truthy'</span></span>, () =&gt; { expect(ExampleComponent).toBeTruthy(); }); });</code> </pre> </div></div><br><p>  F√ºgen Sie den Befehl <code>test</code> - <code>npm run lint &amp;&amp; jest</code> zum <code>package.json</code> von <code>package.json</code> .  Aus Gr√ºnden der Zuverl√§ssigkeit fahren wir auch den Linter.  Jetzt k√∂nnen Sie unsere Tests ausf√ºhren und sicherstellen, dass sie den <code>npm run test</code> .  Damit die Tests w√§hrend der Montage nicht in die <code>['src/**/*.test.(tsx|ts)']</code> , f√ºgen Sie das <code>exclude</code> im <code>Rollup</code> Konfigurations-Plugin zum <code>exclude</code> - <code>['src/**/*.test.(tsx|ts)']</code> .  Geben Sie die Ausf√ºhrung von Tests im <code>husky pre-commit hook</code> bevor Sie <code>lint-staged</code> <code>"pre-commit": "npm run test &amp;&amp; lint-staged"</code> - <code>"pre-commit": "npm run test &amp;&amp; lint-staged"</code> . </p><br><h3 id="razrabatyvaem-dokumentiruem-i-lyubuemsya-komponentami-s-storybook">  Entwerfen, Dokumentieren und Bewundern von Komponenten mit einem Storybook </h3><br><p>  Jede Bibliothek ben√∂tigt eine gute Dokumentation f√ºr ihre erfolgreiche und produktive Nutzung.  In der Bibliothek der Schnittstellenkomponenten m√∂chten Sie nicht nur dar√ºber lesen, sondern auch sehen, wie sie aussehen. Am besten ber√ºhren und √§ndern Sie sie.  Um eine solche Wunschliste zu unterst√ºtzen, gibt es verschiedene L√∂sungen.  Ich habe fr√ºher einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Styleguidist benutzt</a> .  Mit diesem Paket k√∂nnen Sie Dokumentation im Markdown-Format schreiben und Beispiele der beschriebenen React-Komponenten einf√ºgen.  Au√üerdem wird die Dokumentation gesammelt und daraus ein Site-Showcase-Katalog abgerufen, in dem Sie die Komponente finden, die Dokumentation dar√ºber lesen, sich √ºber ihre Parameter informieren und auch einen Zauberstab hineinstecken k√∂nnen. </p><br><p>  Diesmal habe ich mich jedoch entschlossen, seinen Konkurrenten - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Storybook</a> - genauer anzusehen.  Heute scheint es mit seinem Plugin-System leistungsf√§higer zu sein.  Dar√ºber hinaus entwickelt es sich st√§ndig weiter, hat eine gro√üe Community und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wird in K√ºrze</a> auch damit beginnen, seine Dokumentationsseiten mithilfe von Markdown-Dateien zu generieren.  Ein weiterer Vorteil des Storybooks ist, dass es sich um eine Sandbox handelt - eine Umgebung f√ºr die isolierte Komponentenentwicklung.  Dies bedeutet, dass wir f√ºr die Komponentenentwicklung keine vollwertigen Beispielanwendungen ben√∂tigen (wie CRL vorschl√§gt).  Im Storybook schreiben wir <code>stories</code> - ts-Dateien, in denen wir unsere Komponenten mit einigen Eingabest√ºtzen auf spezielle Funktionen √ºbertragen (es ist besser, den Code zu betrachten, um ihn klarer zu machen).  Aus diesen <code>stories</code> wird eine Showcase-Anwendung erstellt. </p><br><p>  F√ºhren Sie das Skript aus, das das Storybook initialisiert: </p><br><pre> <code class="bash hljs">npx -p @storybook/cli sb init</code> </pre> <br><p>  Freunde dich jetzt mit TS an.  Dazu ben√∂tigen wir einige weitere Pakete und gleichzeitig werden wir einige n√ºtzliche Add-Ons hinzuf√ºgen: </p><br><pre> <code class="bash hljs">npm install --save-dev awesome-typescript-loader @types/storybook__react @storybook/addon-info react-docgen-typescript-loader @storybook/addon-actions @storybook/addon-knobs @types/storybook__addon-info @types/storybook__addon-knobs webpack-blocks</code> </pre> <br><p>  Das Skript erstellte ein Verzeichnis mit der <code>storybook</code> Konfiguration - <code>.storybook</code> und ein Beispielverzeichnis, das wir r√ºcksichtslos l√∂schen.  Und im Konfigurationsverzeichnis √§ndern wir die Erweiterungs- <code>addons</code> und die <code>config</code> in <code>ts</code> .  Wir f√ºgen der Datei <code>addons.ts</code> Addons <code>addons.ts</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-actions/register'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-links/register'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs/register'</span></span>;</code> </pre> <br><p>  Jetzt m√ºssen Sie dem Storybook mithilfe der Webpack-Konfiguration im Verzeichnis <code>.storybook</code> . </p><br><div class="spoiler">  <b class="spoiler_title">webpack.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ config }</span></span></span><span class="hljs-function">) =&gt;</span></span> { config.module.rules.push({ <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(ts|tsx)$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>.resolve(<span class="hljs-string"><span class="hljs-string">'awesome-typescript-loader'</span></span>) }, <span class="hljs-comment"><span class="hljs-comment">// Optional { loader: require.resolve('react-docgen-typescript-loader') } ] }); config.resolve.extensions.push('.ts', '.tsx'); return config; };</span></span></code> </pre> </div></div><br><p>  Lassen Sie uns die <code>config.ts</code> Konfiguration ein wenig optimieren und Dekoratoren hinzuf√ºgen, um Add-Ons mit all unseren Geschichten zu verbinden. </p><br><div class="spoiler">  <b class="spoiler_title">config.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { configure } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { addDecorator } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withInfo } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-info'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withKnobs } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// automatically import all files ending in *.stories.tsx const req = require.context('../src', true, /\.stories\.tsx$/); function loadStories() { req.keys().forEach(req); } configure(loadStories, module); addDecorator(withInfo); addDecorator(withKnobs);</span></span></code> </pre> </div></div><br><p>  Wir werden unsere erste <code>story</code> in das Komponentenverzeichnis <code>ExampleComponent</code> </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.stories.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { storiesOf } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { text } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> stories = storiesOf(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>); stories.add(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, () =&gt; &lt;ExampleComponent text={text('text', 'Some text')} /&gt;, { info: { inline: true }, text: ` ### Notes Simple example component ### Usage ~~~js &lt;ExampleComponent text="Some text" /&gt; ~~~ ` });</code> </pre> <br><p>  Wir haben Addons verwendet: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kn√∂pfe</a> - Erm√∂glicht das √Ñndern von Requisiten in Echtzeit in der im Storybook angezeigten Komponente.  Wickeln Sie dazu Requisiten in spezielle Funktionen in Geschichten ein </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">info</a> - Erm√∂glicht das Hinzuf√ºgen von Dokumentation und Beschreibung von Requisiten zur Story-Seite </li></ul></div></div><br><p>  Beachten Sie nun, dass das Storybook-Initialisierungsskript den Befehl <code>package.json</code> zu <code>package.json</code> .  Verwenden Sie es, um das <code>npm run storybook</code> .  Das Storybook wird unter <code>http://localhost:6006</code> zusammengestellt und ausgef√ºhrt.  Vergessen Sie nicht, der Ausnahme f√ºr das <code>typescript</code> in der <code>Rollup</code> Konfiguration <code>'src/**/*.stories.tsx'</code> . </p><br><h3 id="razrabatyvaem">  Wir entwickeln uns </h3><br><p>  Nachdem Sie sich mit vielen praktischen Werkzeugen umgeben und auf die Arbeit vorbereitet haben, k√∂nnen Sie mit der Entwicklung neuer Komponenten beginnen.  Jede Komponente wird in ihrem Verzeichnis in <code>src/components</code> mit dem Namen der Komponente abgelegt.  Es enth√§lt alle damit verbundenen Dateien - CSS, die Komponente selbst in der TsX-Datei, Tests, Storys.  Wir starten das Storybook, erstellen Storys f√ºr die Komponente und schreiben dort Dokumentation daf√ºr.  Wir erstellen Tests und Tests.  Der Import-Export der fertigen Komponente wird in <code>index.ts</code> . </p><br><p>  Dar√ºber hinaus k√∂nnen Sie sich bei <code>npm</code> anmelden und Ihre Bibliothek als neues npm-Paket ver√∂ffentlichen.  Und Sie k√∂nnen es direkt aus dem Git-Repository von Master- und anderen Zweigen verbinden.  F√ºr mein Werkst√ºck k√∂nnen Sie beispielsweise Folgendes tun: </p><br><pre> <code class="bash hljs">npm i -s git+https://github.com/jmorozov/react-library-example.git</code> </pre> <br><p>  Damit in der Consumer-Anwendung der Bibliothek im Verzeichnis <code>node_modules</code> nur der Inhalt des Verzeichnisses <code>dist</code> im zusammengesetzten Zustand vorhanden ist, m√ºssen Sie dem <code>node_modules</code> den Befehl <code>"prepare": "npm run build"</code> hinzuf√ºgen <code>"prepare": "npm run build"</code> . </p><br><p>  Dank TS funktioniert auch die automatische Vervollst√§ndigung in der IDE. </p><br><h2 id="podvodim-itogi">  Zusammenfassend </h2><br><p>  Mitte 2019 k√∂nnen Sie mit praktischen Entwicklungstools ziemlich schnell mit der Entwicklung Ihrer Komponentenbibliothek auf React und TypeScript beginnen.  Dieses Ergebnis kann sowohl mit Hilfe eines automatisierten Dienstprogramms als auch im manuellen Modus erzielt werden.  Der zweite Weg wird bevorzugt, wenn Sie aktuelle Pakete und mehr Kontrolle ben√∂tigen.  Die Hauptsache ist, zu wissen, wo man gr√§bt, und anhand eines Beispiels in diesem Artikel hoffe ich, dass dies etwas einfacher geworden ist. </p><br><p>  Hier k√∂nnen Sie auch das resultierende Werkst√ºck aufnehmen. </p><br><p>  Unter anderem gebe ich nicht vor, die ultimative Wahrheit zu sein, und besch√§ftige mich im Allgemeinen mit Front-End, sofern.  Sie k√∂nnen alternative Pakete und Konfigurationsoptionen ausw√§hlen und Ihre Komponentenbibliothek erfolgreich erstellen.  Ich w√ºrde mich freuen, wenn Sie Ihre Rezepte in den Kommentaren teilen.  Viel Spa√ü beim Codieren! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461439/">https://habr.com/ru/post/de461439/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461425/index.html">Wie man ein Produktmanager wird und weiter w√§chst</a></li>
<li><a href="../de461431/index.html">"Liebt und mag nicht": DNS √ºber HTTPS</a></li>
<li><a href="../de461433/index.html">Verwenden von Identity Server 4 in Net Core 3.0</a></li>
<li><a href="../de461435/index.html">Emotionserkennung unter Verwendung eines Faltungs-Neuronalen Netzwerks</a></li>
<li><a href="../de461437/index.html">370 Gl√ºhbirnen</a></li>
<li><a href="../de461441/index.html">Berichte √ºber den Speicherstatus mithilfe von R. Parallel Computing, Grafiken, XLSX, E-Mail und all dies</a></li>
<li><a href="../de461443/index.html">Nachanalyse: Was ist √ºber den j√ºngsten Angriff auf das SKS Keyserver-Kryptoschl√ºsselservernetzwerk bekannt?</a></li>
<li><a href="../de461447/index.html">Das Epos √ºber Systemadministratoren als gef√§hrdete Spezies</a></li>
<li><a href="../de461449/index.html">PhpStorm 2019.2: Typisierte PHP 7.4-Eigenschaften, doppelter Finder, EditorConfig, Shell-Skripte und mehr</a></li>
<li><a href="../de461451/index.html">Mein zweiter Tag mit Haiku: begeistert, aber noch nicht bereit zu gehen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>