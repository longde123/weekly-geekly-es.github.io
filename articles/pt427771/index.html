<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🤝‍👨🏼 ⛴️ 👨🏽 Curso MIT "Segurança de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 2 🏴󠁧󠁢󠁷󠁬󠁳󠁿 💂 📇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnologia de Massachusetts. Curso de Aula nº 6.858. "Segurança de sistemas de computador". Nikolai Zeldovich, James Mickens. 2014 ano 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Segurança de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/427771/"><h3>  Instituto de Tecnologia de Massachusetts.  Curso de Aula nº 6.858.  "Segurança de sistemas de computador".  Nikolai Zeldovich, James Mickens.  2014 ano </h3><br>  Computer Systems Security é um curso sobre o desenvolvimento e implementação de sistemas de computador seguros.  As palestras abrangem modelos de ameaças, ataques que comprometem a segurança e técnicas de segurança baseadas em trabalhos científicos recentes.  Os tópicos incluem segurança do sistema operacional (SO), recursos, gerenciamento de fluxo de informações, segurança de idiomas, protocolos de rede, segurança de hardware e segurança de aplicativos da web. <br><br>  Palestra 1: “Introdução: modelos de ameaças” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 2: “Controle de ataques de hackers” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 3: “Estouros de Buffer: Explorações e Proteção” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 4: “Separação de Privilégios” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 5: “De onde vêm os sistemas de segurança?” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> <br>  Palestra 6: “Oportunidades” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 7: “Sandbox do Cliente Nativo” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 8: “Modelo de Segurança de Rede” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 9: “Segurança de aplicativos da Web” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 10: “Execução Simbólica” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 11: “Linguagem de Programação Ur / Web” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 12: Segurança de rede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 13: “Protocolos de Rede” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  <b>Aluno: o</b> cliente não pode descriptografar esse ticket porque ele é criptografado usando a chave de serviço. <br><br>  <b>Professor:</b> sim, isso é realmente inteligente, não é?  Temos a chave Kc, s que o cliente pode receber, mas aqui, no ticket Tc, s, há outra cópia dessa chave, criptografada com Ks. <br><br><img src="https://habrastorage.org/webt/kl/5n/6e/kl5n6e4epx_expi1zev6grsj30y.jpeg"><br><br>  O motivo disso é que o servidor Kerberos está realmente tentando proteger a comunicação do cliente com o outro cara.  Portanto, o Kerberos cria uma chave aleatória Kc, se fornece uma cópia para o cliente e outra para o servidor com o qual o cliente irá conversar.  Imagine que o Kerberos simplesmente chamasse o serviço com as palavras: “ei, serviço, esse cara quer falar com você, esta é a chave para isso!”  Isso seria lamentável, porque o servidor Kerberos acessaria o serviço repetidamente em todas as solicitações.  Portanto, o KDS cria duas cópias da chave da sessão: uma para o cliente e outra para o TGS. <br><br>  Portanto, em vez disso, os desenvolvedores criaram um bom truque, onde eles fornecem esse ticket ao cliente, e ele não pode fazer nada com ele, exceto entrar em contato com o serviço certo.  E se este serviço tiver a chave Ks correta, ele será descriptografado e dirá: "Sim, é a mesma chave que devo usar para conversar com esse cliente".  Assim, os dois participantes da conexão, o cliente e o serviço, estabelecerão uma chave comum para proteger sua conexão. <br><br>  <b>Estudante:</b> então o que é TGS? <br><br>  <b>Professor:</b> Existem duas visões sobre o que é TGS.  Do ponto de vista do cliente, este é apenas mais um serviço para o qual você pode obter um ticket.  Quanto mais recursos esse serviço fornece, mais tickets ele oferece.  Este é realmente um serviço de bilheteria. <br><br>  <b>Aluno:</b> desculpe, eu quis dizer que temos um ingresso chamado TGS. <br><br>  Professor: ah, sim, desculpe, a inscrição tgs sob a seta neste diagrama é apenas uma abreviação para todo o bloco de gravação, exceto os índices s no parâmetro Tc, s, que significa que o nome real desse serviço é TGS.  Você pode imaginar que temos um servidor Kerberos, existe esse serviço TGS e existe um serviço real que você deseja acessar.  Então, primeiro você precisa solicitar ao Kerberos um ticket para obter acesso a um serviço específico. <br><br><img src="https://habrastorage.org/webt/hw/zr/hw/hwzrhw6lhgb-pvgkiesyon92txs.jpeg"><br><br>  Você pode solicitar ao Kerberos que lhe forneça um ticket diretamente para o servidor de arquivos, e isso pode funcionar.  Mas para isso, você precisaria do seu Kc para descriptografia e pelo resto do tempo usando o servidor.  Em vez disso, você recebe um ingresso para o serviço TGS especial.  Parece o mesmo que outros serviços, exceto que é colocado em uma caixa separada.  E ele ficará feliz em fornecer a você mais ingressos posteriormente, sem fornecer novamente sua chave de cliente Kc original. <br><br>  <b>Aluno:</b> ou seja, a ideia dele é que, assim que você receber um bilhete TGS, você possa se livrar da sua chave Kc? <br><br>  <b>Professor:</b> sim, o mais interessante é que, assim que você recebe este bilhete Tc, s do serviço TGS, você se livra da senha e da chave Kc.  Assim, assim que você efetua login na estação de trabalho do Athena e após alguns segundos recebe um ticket T, s, sua senha é excluída da memória.  Portanto, mesmo que alguém o agarre, selecione o computador e saia com ele, tudo o que ele tem é o seu bilhete.  É bom que ele possa acessar suas informações por 10 horas ou pela duração do ticket, mas não mais, porque a senha não foi salva e na próxima vez que você digitar "Athena", será necessário digitá-las novamente. <br><br>  A única vez em que você precisa de uma senha é quando envia uma solicitação ao servidor Kerberos, recebe essa resposta com um ticket e descriptografa-a.  Depois disso, você pode esquecer a senha.  Mas é claro que você não pode soltar a senha antes de usá-la para descriptografar. <br>  Assim, a primeira interface superior C em nosso esquema é usada para obter um ticket com a chave inicial Kc, e a segunda interface inferior S é usada para acessar serviços, mas sem a necessidade de obter a chave inicial Kc. <br><br><img src="https://habrastorage.org/webt/p_/sa/co/p_sacoagwvxlzixm2wmfkxcrax8.jpeg"><br><br>  Portanto, já falamos sobre dois problemas específicos do protocolo Kerberos, que foram incorporados a ele, o que causou alguns inconvenientes.  Primeiro, os criadores assumiram que a criptografia também forneceria autenticação ou integridade da mensagem, mas isso não aconteceu.  Essa falha foi corrigida no Kerberos versão 5, onde a autenticação explícita de mensagens é realizada.  Em segundo lugar, para clientes arbitrários, eles tiveram a oportunidade de adivinhar as senhas de outras pessoas. <br><br>  Como isso pode ser corrigido?  Como evitar ataques adivinhando a senha em protocolos desse tipo?  O que podemos tentar? <br><br>  <b>Aluno:</b> Não tenho certeza, mas você pode tentar "salgar" a senha. <br><br>  <b>Professor:</b> “salgar” significa simplesmente que o cliente pode ter que hash a senha de maneiras diferentes.  Mas isso não custa tentar pegá-lo.  Portanto, pode ser mais caro construir um dicionário. <br><br>  <b>Aluno:</b> você pode tentar complicar a função de calcular a senha. <br><br>  <b>Professor:</b> sim, outra boa idéia é tornar o processo de hash muito caro.  Talvez isso seja razoável.  Portanto, se essa função hash demorar um segundo no tempo computacional, como vocês fizeram no segundo laboratório, nesse caso, selecionar senhas seria uma tarefa muito cara.  Portanto, este parece ser um plano razoável - usar uma combinação de “salga” e complicar o processo de adivinhação. <br><br>  Outra defesa pode ser complicar a resposta.  Você ouviu dizer que, nas primeiras versões do protocolo, o servidor Kerberos não fazia ideia se o cliente correto estava acessando ou não.  O que você poderia fazer é fornecer evidências de que você é o cliente certo, ou seja, criptografar o carimbo de data / hora atual com um hash de senha ou algo assim.  Em seguida, o servidor Kerberos pode apenas verificar se essas coisas estão corretas e, se elas corresponderem, fornecer um ticket. <br><br>  Você provavelmente não deseja adicionar mais etapas de teste, mas isso pode funcionar.  Por enquanto, suponha que você possa pegar um carimbo de data e hora e hash junto com a tecla Kc, além de adicionar um carimbo de data e hora. <br><br><img src="https://habrastorage.org/webt/_w/z8/tc/_wz8tcsw1hrju-q5dmxqomp6jto.jpeg"><br><br>  Nesse caso, o servidor pode ver que possui sua chave Kc e também pode fazer o hash do carimbo de data / hora atual.  Se ele receber o mesmo valor, provavelmente a solicitação será feita pelo usuário correto para quem o ticket pode ser enviado.  Caso contrário, era a senha errada. <br><br>  <b>Aluno:</b> você pode simplesmente limitar a emissão de tickets se os servidores registrarem muitos pedidos de provisão. <br><br>  <b>Professor:</b> muito bem, podemos introduzir uma restrição.  No entanto, não há razão para um hacker solicitar um ticket no servidor mais de uma vez.  Ele simplesmente pede um usuário específico, recebe esse bloco criptografado dele e pode tentar descriptografá-lo offline quantas vezes quiser, com senhas diferentes sem uma segunda solicitação.  Portanto, acho que o ponto principal da proteção é que o servidor reaja de alguma forma ao número de chamadas se o invasor solicitar repetidamente o servidor, tentando entrar no sistema com senhas diferentes.  Nesse caso, o limite de consulta pode ser atingido, o que fornecerá melhor proteção contra hackers. <br><br>  <b>Aluno:</b> como um invasor pode enviar uma solicitação ao servidor Kerberos? <br><br>  <b>Professor:</b> Eu acho que ele poderia reproduzir a mensagem do usuário correto, ou seja, vê-la, copiá-la, enviá-la e também receber uma resposta do servidor Kerberos.  Se um hacker verifica a rede, ele pode interceptar a mensagem durante a transmissão.  Portanto, limitar o número de solicitações é uma medida temporária que aumenta apenas ligeiramente a segurança.  Mas, é claro, se você estiver olhando para a rede de outra pessoa, verá como esse pacote é retornado do servidor, independentemente do que aconteceu no estágio de formação de Tc, s.  Assim, o hacker pode ver a resposta do servidor ao cliente e tentar atacá-lo. <br><br>  Provavelmente existem esquemas mais complexos que você poderia desenvolver, mas não acho que o Kerberos 5 implemente algo mais complicado do que o plano que analisamos, o que parece bom o suficiente para impedir que pessoas aleatórias tentem quebrar algo ou usar brutalidade. forçar a decifrar uma senha. <br><br>  <b>Aluno:</b> suponha que você possa fornecer autenticação ou outra coisa para estabelecer uma chave compartilhada.  E então você pode criptografar essa coisa e a chave compartilhada com o Kc. <br><br>  <b>Professor:</b> sim, é.  Se você realmente fizer isso corretamente, existe um protocolo chamado Exchange Authenticated Key Exchange, PAKE, que executa a autenticação por senha.  É exatamente o que acontece no Kerberos. <br><br><img src="https://habrastorage.org/webt/dd/ls/ol/ddlsolffyiktm0e4cevjbd1ugei.jpeg"><br><br>  Você pode olhar para o Google para que servem os protocolos SRP ou PAKE.  Esses protocolos e seus elementos associados se saem muito melhor com sua tarefa, na qual você deve provar a ambas as partes que instalou uma nova chave.  Nesse caso, as duas partes devem estar convencidas da exatidão uma da outra e de que não há como adivinhar essa senha offline e atacar o conjunto de pacotes de rede que você está observando, e assim por diante. <br><br>  Estes são protocolos que dependem muito da criptografia, por isso é difícil explicar no quadro por que eles funcionam. <br><br>  <b>Aluno:</b> Uma das razões pelas quais os desenvolvedores fizeram isso foi porque eles queriam oferecer suporte à capacidade de enviar apenas uma senha.  E os protocolos permitem enviar apenas uma coisa como autenticador. <br><br>  <b>Professor:</b> sim, existem muitos requisitos estranhos que esses caras levaram em conta.  Obviamente, na prática, esses servidores podem aceitar conexões Kerberos e não-Kerberos.  E para conexões não-Kerberos, você obtém a imagem como se alguém estivesse se conectando a um servidor de correio, mas não usando uma estação de trabalho Athena.  Ele só quer enviar sua senha. <br><br><img src="https://habrastorage.org/webt/xm/qm/lm/xmqmlmiopbrwqm9zyulycz6apz4.jpeg"><br><br>  E então o cliente de email aqui, digamos, vai pegar essa senha e obter um ticket em seu nome apenas para verificá-la, o que permitirá que você use esse cliente de email.  Portanto, você provavelmente ainda deseja que o próprio Kerberos verifique as senhas do Kerberos.  Eu não acho que isso esteja fora de questão, porque é claro que o Kerberos 5 implementa esses hashes de carimbo de data e hora e tudo mais. <br><br>  Acho que mais uma coisa que você deve prestar atenção nos materiais das palestras é que os desenvolvedores do Kerberos 4 escolheram um esquema de criptografia - DES, o algoritmo de criptografia mais popular da época.  Esta é uma cifra de bloco simétrica, bem rápida.  Naquele momento, ele fornecia segurança suficiente e eles simplesmente o incorporaram ao protocolo. <br><br>  Tudo no Kerberos deveria usar apenas DES, ou pelo menos tudo na versão 4. do Kerberos. Isso se tornou problemático, porque agora, 25 a 30 anos depois, a criptografia do DES pode ser facilmente quebrada usando o método de força bruta, uma vez que as chaves de criptografia têm tamanho muito pequeno - apenas 56 bits. <br><br>  Portanto, você pode simplesmente criar algum tipo de equipamento de usuário que calculará de 2 a 56 graus de combinação e descobrirá a senha real.  É isso que você deseja evitar em qualquer protocolo desenvolvido atualmente. <br><br>  O Kerberos versão 5 suporta vários esquemas de criptografia diferentes, incluindo AES e outros algoritmos criptográficos.  Portanto, essa parece ser uma maneira muito melhor de garantir a segurança.  Por outro lado, o MIT continuou a apoiar o DES há dois anos, mas agora o recusou, então hoje seu reitor está protegido, pelo menos contra esse tipo de ataque.  Agora, vamos ver o que acontece no serviço TGS do qual você recebe um ticket.  A interação com este serviço parece um pouco diferente. <br><br>  Por um lado, como cliente, você conversará com ele como se estivesse conversando com qualquer outro serviço habilitado para Kerberos.  Considere como você executa sua própria autenticação com um ticket para uma máquina.  Mas a resposta que você retornará é apenas um tíquete para outro princípio, com base no qual você se comunicará, por exemplo, com um servidor de arquivos. <br><br>  Portanto, as mensagens no nível do protocolo ficarão assim - à direita, desenharei o TGS e à esquerda - o cliente.  O cliente já possui um ticket para o TGS, obtido usando o protocolo mostrado na parte superior. <br><br><img src="https://habrastorage.org/webt/cj/cq/vy/cjcqvyserub_284vhbrrzie4v84.jpeg"><br><br>  Agora, o cliente enviará uma combinação de mensagens que provam que ele é o cliente certo, e essas mensagens estão relacionadas à emissão de uma solicitação em um princípio específico por meio do TGS. <br><br>  Portanto, o cliente enviará a seguinte mensagem para o TGS: S é o serviço com o qual ele se comunicará mais, pode ser um servidor de correio ou de arquivos; isso inclui o ticket do cliente Tc que ele recebeu para tgs, criptografado usando a chave K tgs e um autenticador criptografado com a chave Kc, tgs comum ao cliente e ao serviço TGS.  É assim que a mensagem que você vai enviar para o TGS se parece - ela diz: “olhe para esta mensagem, faça algo com ela e responda com um ticket para este novo serviço S.”  A resposta aqui parece quase a mesma da figura acima e, de fato, é a mesma - esse é um ticket entre o cliente e esse novo serviço, criptografado usando Ks.  Mas agora ficou um pouco diferente. <br><br><img src="https://habrastorage.org/webt/hl/hy/l2/hlhyl2wjl1jpd8oeptd4e3o9w0g.jpeg"><br><br>  Em vez de criptografar com a chave Kc, que o cliente deve ter esquecido desde então, agora a criptografia é realizada usando a chave comum Kc, tgs entre o cliente e o serviço TGS. <br><br>  Como o servidor descobre o que o cliente deseja e como o autentica?  O servidor TGS conhece sua própria chave Ktgs; portanto, primeiro ele descriptografa essa mensagem Tc, tgs, olha dentro do ticket e descobre o que acontece.  Por que precisamos de todos esses campos no ticket?  Por que é importante ter o nome do servidor S no ticket?  O que daria errado se não tivéssemos S? <br><br>  <b>Aluno:</b> se não houver, você poderá obter permissão para usar qualquer servidor. <br><br>  <b>Professor:</b> sim, é.  Em geral, é uma boa idéia criar os protocolos de rede para que você possa dizer exatamente o que essa mensagem significa.  No caso de você omitir S, você pode confiar no fato de que, se usar um ticket para o S errado, talvez tenha outra chave Ks e ela não será capaz de descriptografar ou algo assim.  Portanto, parece uma boa ideia incluir o nome do serviço para garantir que o servidor que recebe esses tickets os descriptografa e verifique se esse é um ticket para mim ou para outra pessoa? <br><br>  <b>Aluno:</b> o que o cliente faz com a chave Ktgs recebida? <br><br>  <b>Professor:</b> boa pergunta!  O cliente não tem idéia do que é.  Porque é uma chave extremamente secreta.  Se você soubesse, seria capaz de decifrar todo o Kerberos.  Portanto, o cliente não tem idéia do que é Ktgs. <br><br>  <b>Estudante: de</b> onde vem esse Ktgs? <br><br>  <b>Professor:</b> o próprio servidor Kerberos gera para você toda essa mensagem, que já possui Tc, tgs e Ktgs, você não a cria, mas simplesmente copia-a daqui. <br><br>  Então, por que o nome do cliente é tão importante?  É fácil descobrir isso.  Se você não colocar o nome do cliente no ticket, o servidor receberá essa mensagem, mas não fará ideia de quem ele está tentando conversar.  Ele não sabe para quem deve emitir um ingresso - para você ou para outra pessoa. <br><br>  E os outros campos?  Por que os desenvolvedores inserem o endereço addr no ticket Tc, s?  É apenas o endereço IP do cliente. Por que não usá-lo diretamente? <br><br><img src="https://habrastorage.org/webt/jc/qr/ar/jcqrarc608ehufc4cs094r5xwqw.jpeg"><br><br>  Penso que o significado desta solução é o desejo dos desenvolvedores de aumentar a segurança.  Eles queriam garantir que, se o cliente efetuasse login a partir de algum endereço IP, tudo o mais no mesmo ticket venha do mesmo endereço IP.  Por exemplo, se você estiver conectado a partir de algum endereço IP, por exemplo 18.26.4.9, cada conexão com um servidor de arquivos ou correio deverá ser do mesmo endereço IP.  Caso contrário, o servidor deve rejeitar sua conexão, pois isso pode sugerir que alguém roubou seu ticket.  Assim, nos protegemos aqui contra o uso de bilhetes roubados.  Se você ainda tiver o mesmo ticket, tudo bem, mas se você não usar o mesmo endereço IP, não terá êxito. <br><br>  Isso parece um equívoco no momento, e o Kerberos 5 ainda usa uma abordagem semelhante, embora isso não seja necessário.  Na verdade, você deve simplesmente confiar na criptografia em vez de proteger o endereço IP. <br><br>  Mas qual é o significado do carimbo de data e hora e do tempo de vida no ticket?  Para que servem e para que servem? <br><br>  <b>Aluno:</b> Eles são necessários para evitar ataques de repetição. <br>  Professor: os ataques de repetição nos ajudam a impedir o autenticador, porque isso é gerado toda vez que você faz uma nova solicitação.  Mas, por outro lado, o ticket permanece o mesmo, portanto, é claro, isso não interfere nos ataques de repetição. <br><br>  <b>Aluno:</b> isso impede que alguém roube seu bilhete e depois o use para seus próprios fins. <br>  Professor: sim, isso simplesmente limita o tempo durante o qual o ticket é válido, para que os danos causados ​​pelo roubo sejam reduzidos.  O registro de data e hora é o horário em que você recebeu o ticket e a vida útil mostra quantas horas esse ticket é válido a partir do registro de data e hora inicial.  Portanto, se você tentar usá-lo muito cedo ou muito tarde, qualquer servidor deverá rejeitar esse ticket usando o protocolo Kerberos.  Isso significa que cada servidor deve sincronizar seu relógio. <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aluno:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Você disse anteriormente que um cliente pode jogar fora sua chave inicial, descartar Kc, mas deve armazenar os Kc recebidos do TGS. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Professor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sim, o cliente descarta Kc após o login, mas deve manter Kc, s. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aluno:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> então, se alguém rouba Kc, s, então ele tem acesso ... </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Professor:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sim, vamos considerar o quão ruim isso é? </font><font style="vertical-align: inherit;">Por que é melhor para um hacker revelar esse Kc, tgs, do que Kc? </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aluno:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se você pegar Kc, s, poderá simplesmente roubar uma sessão entre esses dois interlocutores, mas se você roubar Kc, poderá se passar por um cliente. </font></font><br><br><img src="https://habrastorage.org/webt/qu/ty/mo/qutymopzmr5tvwkronozrqzsprw.jpeg"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Professor:</font></font></b>  .      ,  Kc,s —      ,    ,     .  ,       Tc,tgs,    .          ,       56     Kc,s.      .      ,     Tc,tgs ,    Kc,s    ,     - . <br><br> <b>:</b> ,  -      — Tc,tgs,   Kc,tgs,    Kc,tgs,  Kc —      . <br><br> <b>:</b> ,  -    ,       , ,           ,       10 .  Kc      ,      . <br><br> , ,           ,   IP-,      .  -     ,    ,     Kc,tgs,       TGS.         —  ,  ,   ,     . <br><br>   ,   , ,       . ,      ,    .        TGS        , , PO12,  TGS        PO12.    ,    ,       Kc,s       .      ,     ,            .                Kc,s. <br><br><img src="https://habrastorage.org/webt/z2/o5/dz/z2o5dz1vnusna6yrhblr8uzutn0.jpeg"><br><br>       ,       ,         Tc,mail,     Kmail,        ,      , ,   5 – DELETE 5,   Kc,mail. <br><br><img src="https://habrastorage.org/webt/qw/l1/br/qwl1brzfsy3qweaybqcpruubqao.jpeg"><br><br> ,          mail?              Kmail,          -  ,    ,   Kc,s,              Kerberos 5.         : «,  C    ,     ». <br><br> <b>:</b>  Kerberos    Tc,tgs   Kc,s.    ? <br><br> <b>:</b>  Ac   .  ,         Kc,s,       ,  .  ,              . <br><br><img src="https://habrastorage.org/webt/ka/ib/mn/kaibmnrhnyzcsu2pc6zo5nwl8-a.jpeg"><br><br>  ,  Kerberos 4  ,     ,    , ,    ,            ,    ,   . <br><br>     ,        ,   , ,     .      ,           .    ,   ,               .        , ,   ,   ,      .       ,    . <br>     .        Kerberos,      ,   ,  Kerberos 4.             ,   -   . <br><br>  ,   , ,     ,   ,  Kerberos 4,   ,    ,        K,mail.     ,        . <br><br><img src="https://habrastorage.org/webt/np/z1/wq/npz1wqybnymufipj4de08rpms9i.jpeg"><br><br>    ,     ,   .      ,        ,    .   -    : «,      ,           DELETE         5,       -  ». <br><br>  , Kerberos 5       -,     . , ,      ,   ,   ,     . <br><br> <b>:</b>    K,mail? <br><br> <b>:</b>      . <br><br><img src="https://habrastorage.org/webt/-t/ms/ii/-tmsii-dquroimeupnjef06p3uy.jpeg"><br><br>   ,  TGS   ,   ,   S –   mail,    S    Tc,s –   mail,   S   Kc,s —    mail.    Kc,s    K,mail.      ,          . <br><br> <b>:</b>      K,mail? <br><br> <b>:</b> ,        ?   , ,          .   K,mail    ? <br><br> <b>:</b>     ? <br><br> <b>:</b> , ,     !               Kmail,       T,mail,          ,      .    ,     ,      . <br><br> ,              .        .    Kerberos    ,     ,       30  . <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portanto, é inevitável que tenhamos problemas que você deve resolver. </font><font style="vertical-align: inherit;">Portanto, um problema interessante do Kerberos 4 diz respeito ao método de criptografar e autenticar mensagens para aplicativos. </font><font style="vertical-align: inherit;">Consiste no fato de que a mesma chave é usada aqui para criptografar mensagens do cliente para o servidor e para mensagens de resposta do servidor para o cliente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">54:00 min </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Curso do MIT "Computer Systems Security". </font><font style="vertical-align: inherit;">Aula 13: Protocolos de Rede, Parte 3</font></font></a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/QOtA76ga_fY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A versão completa do curso está disponível </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Obrigado por ficar conosco.  Você gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usuários da Habr em um análogo exclusivo de servidores básicos que inventamos para você:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 núcleos) 10GB DDR4 240GB SSD 1Gbps da US $ 20 ou como dividir o servidor?</a>  (as opções estão disponíveis com RAID1 e RAID10, até 24 núcleos e até 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 núcleos) 10GB DDR4 240GB SSD de 1Gbps até dezembro de graça</b> quando pagar por um período de seis meses, você pode fazer o pedido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente nós temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um prédio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427771/">https://habr.com/ru/post/pt427771/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427757/index.html">Backdoors de microcódigo montados no processador X86</a></li>
<li><a href="../pt427759/index.html">Sobre a resolubilidade de problemas na via em tempo polinomial</a></li>
<li><a href="../pt427761/index.html">Implementação do algoritmo k-means (k-means) usando o exemplo de trabalho com pixels</a></li>
<li><a href="../pt427763/index.html">Curso MIT "Segurança de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 1</a></li>
<li><a href="../pt427767/index.html">Situação: no Canadá, eles propuseram a introdução de um imposto sobre streaming - estamos discutindo qual é o problema.</a></li>
<li><a href="../pt427773/index.html">Eu escrevi uma extensão entre navegadores para guias, mas você não faz isso</a></li>
<li><a href="../pt427775/index.html">Um bot disfarçado de programador corrige erros no código</a></li>
<li><a href="../pt427779/index.html">Curso MIT "Segurança de sistemas de computadores". Aula 13: Protocolos de Rede, Parte 3</a></li>
<li><a href="../pt427781/index.html">Por que a ciência de dados das organizações de crédito</a></li>
<li><a href="../pt427783/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 14: “SSL e HTTPS”, parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>