<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜£ ğŸ•³ï¸ ğŸ‘œ Kotlinä¸Šçš„ç°ä»£Androidå¼€å‘ã€‚ ç¬¬äºŒéƒ¨åˆ† ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ¾ ğŸ•¦ ğŸ‘°ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ æˆ‘å‘æ‚¨ä»‹ç»Mladen Rakonjacæ’°å†™çš„æ–‡ç« â€œ ç”¨Kotlinè¿›è¡Œç°ä»£Androidå¼€å‘ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰ â€çš„ç¿»è¯‘ã€‚ 

 æ³¨æ„äº‹é¡¹ æœ¬æ–‡æ˜¯Mladen Rakonjacæ’°å†™çš„ç³»åˆ—æ–‡ç« çš„ç¿»è¯‘ï¼Œæ–‡ç« æ—¥æœŸï¼š09/23/2017ã€‚ Github å¼€å§‹é˜…è¯»SemperPeritusçš„ç¬¬ä¸€éƒ¨åˆ†æ—¶ï¼Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kotlinä¸Šçš„ç°ä»£Androidå¼€å‘ã€‚ ç¬¬äºŒéƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432826/"> å“ˆHaï¼ æˆ‘å‘æ‚¨ä»‹ç»Mladen Rakonjacæ’°å†™çš„æ–‡ç« â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”¨Kotlinè¿›è¡Œç°ä»£Androidå¼€å‘ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</a> â€çš„ç¿»è¯‘ã€‚ <br><br>  <i>æ³¨æ„äº‹é¡¹</i>  <i>æœ¬æ–‡æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Mladen Rakonjac</a>æ’°å†™çš„ç³»åˆ—æ–‡ç« çš„ç¿»è¯‘ï¼Œæ–‡ç« æ—¥æœŸï¼š09/23/2017ã€‚</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Github</a></i>  <i>å¼€å§‹é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">SemperPeritus</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬ä¸€</a>éƒ¨åˆ†æ—¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ï¼Œæˆ‘</a>å‘ç°è¯¥éƒ¨åˆ†çš„å…¶ä½™éƒ¨åˆ†ç”±äºæŸç§åŸå› æœªè¿›è¡Œç¿»è¯‘ã€‚</i>  <i>å› æ­¤ï¼Œæˆ‘æè¯·æ‚¨æ³¨æ„ç¬¬äºŒéƒ¨åˆ†ã€‚</i>  <i>åŸæ¥ï¼Œè¿™ç¯‡æ–‡ç« ç¯‡å¹…å¾ˆå¤§ã€‚</i> <br><br><img src="https://pbs.twimg.com/media/DIIHg0eV0AAl0u5.jpg" alt="å›¾ç‰‡"><br><br>  â€œåœ¨Android Studio 3.0ä¸­å¾ˆéš¾æ‰¾åˆ°ä¸€ä¸ªæ¶µç›–Androidå¼€å‘ä¸­æ‰€æœ‰æ–°äº‹ç‰©çš„é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘å†³å®šç¼–å†™å®ƒã€‚â€ <br><a name="habracut"></a><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åˆ†æä»¥ä¸‹å†…å®¹ï¼š <br><br><ol><li>  Android Studio 3 beta 1 <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1éƒ¨åˆ†</a></b> </li><li>  Kotlinç¼–ç¨‹è¯­è¨€<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1éƒ¨åˆ†</a></b> </li><li> æ„å»ºé€‰é¡¹<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1éƒ¨åˆ†</a></b> </li><li>  ConstraintLayout <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1éƒ¨åˆ†</a></b> </li><li> æ•°æ®ç»‘å®šåº“<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1éƒ¨åˆ†</a></b> </li><li>  <b>MVVMä½“ç³»ç»“æ„+å­˜å‚¨åº“+ Android Manager Wrappersæ¨¡å¼</b> </li><li>  RxJava2åŠå…¶åœ¨<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬3éƒ¨åˆ†</a></b>æ¶æ„ä¸­å¦‚ä½•å¸®åŠ©æˆ‘ä»¬ </li><li>  Dagger 2.11ï¼Œä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ­¤<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬4éƒ¨åˆ†</a></b> </li><li> æ”¹é€ ï¼ˆä½¿ç”¨Rx Java2ï¼‰ </li><li> ä¼šè®®å®¤ï¼ˆå¸¦æœ‰Rx Java2ï¼‰ </li></ol><br><h2>  MVVMä½“ç³»ç»“æ„+å­˜å‚¨åº“+ Android Manager Wrappersæ¨¡å¼ </h2><br><h3> å…³äºAndroidä¸–ç•Œä¸­çš„ä½“ç³»ç»“æ„çš„å‡ å¥è¯ </h3><br> ç›¸å½“é•¿ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼ŒAndroidå¼€å‘äººå‘˜åœ¨å…¶é¡¹ç›®ä¸­æœªä½¿ç”¨ä»»ä½•æ¶æ„ã€‚ åœ¨è¿‡å»çš„ä¸‰å¹´ä¸­ï¼Œå¥¹åœ¨Androidå¼€å‘äººå‘˜ç¤¾åŒºä¸­å¼•èµ·äº†å¾ˆå¤šç‚’ä½œã€‚  God Activityçš„æ—¶ä»£å·²ç»è¿‡å»ï¼ŒGoogleå·²å‘å¸ƒäº†<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android Architecture Blueprints</a></b>å­˜å‚¨åº“ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³å„ç§ä½“ç³»ç»“æ„æ–¹æ³•çš„è®¸å¤šç¤ºä¾‹å’Œè¯´æ˜ã€‚ æœ€åï¼Œåœ¨Google IO '17ä¸Šï¼Œä»–ä»¬å¼•å…¥äº†<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android Architecture Components</a></b> ï¼Œè¿™æ˜¯ä¸€ä¸ªåº“é›†åˆï¼Œæ—¨åœ¨å¸®åŠ©æˆ‘ä»¬åˆ›å»ºæ›´ç®€æ´çš„ä»£ç å¹¶æ”¹è¿›åº”ç”¨ç¨‹åºã€‚  <b>Component</b>è¯´æ‚¨å¯ä»¥ä½¿ç”¨æ‰€æœ‰è¿™äº›ï¼Œä¹Ÿå¯ä»¥åªä½¿ç”¨å…¶ä¸­ä¹‹ä¸€ã€‚ ä½†æ˜¯ï¼Œæˆ‘å‘ç°å®ƒä»¬éƒ½éå¸¸æœ‰ç”¨ã€‚ åœ¨æ­£æ–‡å’Œåç»­éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨å®ƒä»¬ã€‚ é¦–å…ˆï¼Œæˆ‘å°†è§£å†³ä»£ç ä¸­çš„é—®é¢˜ï¼Œç„¶åä½¿ç”¨è¿™äº›ç»„ä»¶å’Œåº“è¿›è¡Œé‡æ„ï¼Œä»¥æŸ¥çœ‹å®ƒä»¬åº”è§£å†³çš„é—®é¢˜ã€‚ <br><br> æœ‰ä¸¤ç§å…±äº«GUIä»£ç çš„ä¸»è¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¶æ„æ¨¡å¼</a> ï¼š <br><br><ul><li> æœ€æœ‰ä»·å€¼çƒå‘˜ </li><li>  MVVM </li></ul><br> å¾ˆéš¾è¯´å“ªä¸ªæ›´å¥½ã€‚ æ‚¨å¿…é¡»åŒæ—¶å°è¯•å¹¶å†³å®šã€‚ æˆ‘æ›´å–œæ¬¢<b>ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„MVVM</b> ï¼Œæˆ‘å°†å¯¹æ­¤è¿›è¡Œä»‹ç»ã€‚ å¦‚æœæ‚¨ä»æœªå°è¯•ä½¿ç”¨MVPï¼Œé‚£ä¹ˆåœ¨Mediumä¸Šä¼šæœ‰å¾ˆå¤šå…³äºæ­¤çš„å¥½æ–‡ç« ã€‚ <br><br><h3> ä»€ä¹ˆæ˜¯MVVMæ¨¡å¼ï¼Ÿ </h3><br>  MVVMæ˜¯ä¸€ç§å¯æ‰©å±•ä¸ºModel-View-ViewModelçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½“ç³»ç»“æ„æ¨¡å¼</a> ã€‚ æˆ‘è®¤ä¸ºè¿™ä¸ªåç§°ä½¿å¼€å‘äººå‘˜æ„Ÿåˆ°å›°æƒ‘ã€‚ å¦‚æœæˆ‘æ˜¯æå‡ºä»–åå­—çš„äººï¼Œæˆ‘å°†å…¶ç§°ä¸ºView-ViewModel-Modelï¼Œå› ä¸º<b>ViewModel</b>ä½äºä¸­é—´ï¼Œå°†<b>View</b>å’Œ<b>Model</b>è¿æ¥èµ·æ¥ã€‚ <br><br>  <b>è§†å›¾</b>æ˜¯<b>Activity</b> ï¼Œ <b>Fragment</b>æˆ–ä»»ä½•å…¶ä»–è‡ªå®šä¹‰è§†å›¾ï¼ˆ <b>Androidè‡ªå®šä¹‰è§†å›¾</b> ï¼‰çš„æŠ½è±¡ã€‚ è¯·æ³¨æ„ï¼Œè¯·å‹¿å°†æ­¤<b>è§†å›¾</b>ä¸Androidè§†å›¾æ··æ·†ã€‚  <b>è§†å›¾</b>åº”è¯¥æ˜¯æ„šè ¢çš„ï¼Œæˆ‘ä»¬ä¸åº”è¯¥ä¸ºå…¶ç¼–å†™ä»»ä½•é€»è¾‘ã€‚  <b>è§†å›¾</b>ä¸åº”åŒ…å«æ•°æ®ã€‚ å®ƒåº”è¯¥å­˜å‚¨å¯¹<b>ViewModel</b>å®ä¾‹çš„å¼•ç”¨ï¼Œå¹¶ä¸”<b>View</b>éœ€è¦çš„æ‰€æœ‰æ•°æ®éƒ½åº”æ¥è‡ªè¯¥å®ä¾‹ã€‚ å¦å¤–ï¼Œå½“<b>ViewModelä¸­</b>çš„æ•°æ®æ›´æ”¹æ—¶ï¼Œ <b>View</b>åº”è¯¥è§‚å¯Ÿåˆ°æ­¤æ•°æ®ï¼Œå¹¶ä¸”å¸ƒå±€ä¹Ÿåº”æ›´æ”¹ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œ <b>View</b>è´Ÿè´£ä»¥ä¸‹å·¥ä½œï¼šå„ç§æ•°æ®å’ŒçŠ¶æ€çš„å¸ƒå±€è§†å›¾ã€‚ <br><br>  <b>ViewModel</b>æ˜¯åŒ…å«æ•°æ®å’Œé€»è¾‘çš„ç±»çš„æŠ½è±¡åç§°ï¼Œåº”åœ¨ä½•æ—¶æ¥æ”¶æ­¤æ•°æ®ä»¥åŠä½•æ—¶æ˜¾ç¤ºè¯¥æ•°æ®ã€‚  <b>ViewModel</b>å­˜å‚¨å½“å‰<b>çŠ¶æ€</b> ã€‚  <b>ViewModel</b>è¿˜å­˜å‚¨ä¸€ä¸ªæˆ–å¤šä¸ª<b>Model</b>çš„é“¾æ¥ï¼Œå¹¶ä»ä¸­æ¥æ”¶æ‰€æœ‰æ•°æ®ã€‚ ä¾‹å¦‚ï¼Œå¥¹ä¸åº”è¯¥çŸ¥é“æ•°æ®æ¥è‡ªå“ªé‡Œï¼Œæ¥è‡ªæ•°æ®åº“è¿˜æ˜¯æ¥è‡ªæœåŠ¡å™¨ã€‚ å¦å¤–ï¼Œ <b>ViewModel</b>ä¸éœ€è¦äº†è§£æœ‰å…³<b>Viewçš„</b>ä»»ä½•ä¿¡æ¯ã€‚ è€Œä¸”ï¼Œ <u><b>ViewModel</b>åº”è¯¥å®Œå…¨ä¸äº†è§£Androidæ¡†æ¶ã€‚</u> <br><br>  <b>Model</b>æ˜¯ä¸º<b>ViewModel</b>å‡†å¤‡æ•°æ®çš„å±‚çš„æŠ½è±¡åç§°ã€‚ è¿™æ˜¯æˆ‘ä»¬å°†ä»æœåŠ¡å™¨æ¥æ”¶æ•°æ®å¹¶å°†å…¶ç¼“å­˜æˆ–å­˜å‚¨åœ¨æœ¬åœ°æ•°æ®åº“ä¸­çš„ç±»ã€‚ è¯·æ³¨æ„ï¼Œè¿™äº›ç±»åˆ«ä¸Userï¼ŒCarï¼ŒSquareå’Œå…¶ä»–ä»…å­˜å‚¨æ•°æ®çš„æ¨¡å‹ç±»åˆ«ä¸åŒã€‚ é€šå¸¸ï¼Œè¿™æ˜¯å­˜å‚¨åº“æ¨¡æ¿çš„å®ç°ï¼Œæˆ‘ä»¬å°†åœ¨ä»¥åè€ƒè™‘ã€‚  <b>æ¨¡å‹</b>ä¸åº”è¯¥å¯¹<b>ViewModel</b>ä¸€æ— æ‰€çŸ¥ã€‚ <br><br> å¦‚æœæ­£ç¡®å®æ–½ï¼Œ <b>MVVM</b>æ˜¯ç ´åä»£ç å¹¶ä½¿å…¶æ›´å…·å¯æµ‹è¯•æ€§çš„å¥½æ–¹æ³•ã€‚ è¿™æœ‰åŠ©äºæˆ‘ä»¬éµå¾ª<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SOLID</a></b>åŸåˆ™ï¼Œå› æ­¤æˆ‘ä»¬çš„ä»£ç æ›´æ˜“äºç»´æŠ¤ã€‚ <br><br><h3> ä»£ç ç¤ºä¾‹ </h3><br> ç°åœ¨ï¼Œæˆ‘å°†ç¼–å†™ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ¥è¯´æ˜å…¶å·¥ä½œåŸç†ã€‚ <br><br> é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿”å›ä¸€è¡Œçš„ç®€å•<b>æ¨¡å‹</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">RepoModel.kt</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refreshData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> : String </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Some new data"</span></span> } }</code> </pre> <br></div></div><br> é€šå¸¸ï¼Œæ¥æ”¶æ•°æ®æ˜¯<b>å¼‚æ­¥</b>è°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ç­‰å¾…å®ƒã€‚ ä¸ºäº†æ¨¡æ‹Ÿè¿™ä¸€ç‚¹ï¼Œæˆ‘å°†ç±»æ›´æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">RepoModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refreshData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onDataReadyCallback: OnDataReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ Handler().postDelayed({ onDataReadyCallback.onDataReady(<span class="hljs-string"><span class="hljs-string">"new data"</span></span>) },<span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnDataReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data : String)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br> æˆ‘ä½¿ç”¨<code><b>onDataReady</b></code>æ–¹æ³•åˆ›å»ºäº†<code><b>OnDataReadyCallback</b></code>æ¥å£ã€‚ ç°åœ¨<code><b>refreshData</b></code>æ–¹æ³•å®ç°ï¼ˆå®ç°ï¼‰ <code><b>OnDataReadyCallback</b></code> ã€‚ ä¸ºäº†æ¨¡æ‹Ÿç­‰å¾…ï¼Œæˆ‘ä½¿ç”¨<code><b>Handler</b></code> ã€‚  <code><b>onDataReady</b></code> 2ç§’ä¸€æ¬¡ï¼Œå°†åœ¨å®ç°<code><b>OnDataReadyCallback</b></code>æ¥å£çš„ç±»ä¸Šè°ƒç”¨<code><b>onDataReady</b></code>æ–¹æ³•ã€‚ <br><br> è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<b>ViewModel</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text: String = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isLoading: Boolean = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }</code> </pre> <br></div></div><br> å¦‚æ‚¨æ‰€è§ï¼Œæœ‰ä¸€ä¸ª<code><b>RepoModel</b></code>å®ä¾‹ï¼Œ <code><b>text</b></code>å®ä¾‹ï¼ˆå°†æ˜¾ç¤ºï¼‰å’Œä¸€ä¸ª<code><b>isLoading</b></code>å˜é‡æ¥å­˜å‚¨å½“å‰çŠ¶æ€ã€‚ è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè´Ÿè´£æ£€ç´¢æ•°æ®çš„<code><b>refresh</b></code>æ–¹æ³•ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ ... val onDataReadyCallback = object : OnDataReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: String)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) text.set(data) } } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.refreshData(onDataReadyCallback) } }</code> </pre> <br></div></div><br>  <code><b>refresh</b></code>æ–¹æ³•åœ¨<code><b>refreshData</b></code>ä¸Šè°ƒç”¨<code><b>refreshData</b></code> ï¼Œå®ƒåœ¨å‚æ•°ä¸­é‡‡ç”¨<code>OnDataReadyCallback</code>å®ç°ã€‚ å¥½çš„ï¼Œä½†æ˜¯ä»€ä¹ˆæ˜¯<code><b>object</b></code> ï¼Ÿ æ¯å½“æ‚¨è¦å®ç°æ¥å£æˆ–ç»§æ‰¿æ‰©å±•ç±»è€Œä¸è¿›è¡Œå­ç±»åŒ–æ—¶ï¼Œéƒ½å°†ä½¿ç”¨<b>å¯¹è±¡å£°æ˜</b> ã€‚ å¦‚æœè¦å°†æ­¤ä½œä¸ºåŒ¿åç±»ä½¿ç”¨ï¼Ÿ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æ­£åœ¨ä½¿ç”¨<b>å¯¹è±¡è¡¨è¾¾å¼</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text: String = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isLoading: Boolean = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">false</span></span></span><span class="hljs-function"> fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ repoModel.refreshData( object : OnDataReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: String)</span></span></span><span class="hljs-function"> </span></span>{ text = data }) } }</code> </pre> <br></div></div><br> è°ƒç”¨<code>refresh</code> ï¼Œå¿…é¡»å°†è§†å›¾æ›´æ”¹ä¸º<b>åŠ è½½</b>çŠ¶æ€ï¼Œå¹¶åœ¨æ•°æ®åˆ°è¾¾æ—¶å°†<code><b>isLoading</b></code>è®¾ç½®ä¸º<code>false</code> ã€‚ <br><br> æˆ‘ä»¬è¿˜å¿…é¡»å°†<code><b>text</b></code>æ›¿æ¢ä¸º <pre> <code class="hljs xml"><b>ObservableField<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">String</span></span></span><span class="hljs-tag">&gt;</span></span></b></code> </pre>  ï¼Œå¹¶ä¸”<code><b>isLoading</b></code> <pre> <code class="hljs pgsql"><b>ObservableField&lt;<span class="hljs-type"><span class="hljs-type">Boolean</span></span>&gt;</b></code> </pre>  ã€‚  <code><b>ObservableField</b></code>æ˜¯æ•°æ®ç»‘å®šåº“ä¸­çš„ä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»£æ›¿åˆ›å»ºObservableå¯¹è±¡ï¼Œå®ƒåŒ…è£…äº†æˆ‘ä»¬è¦è§‚å¯Ÿçš„å¯¹è±¡ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() val text = ObservableField&lt;String&gt;() val isLoading = ObservableField&lt;Boolean&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.refreshData(object : OnDataReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: String)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) text.set(data) } }) } }</code> </pre> <br></div></div><br> è¯·æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨<b>val</b>è€Œä¸æ˜¯<b>var</b> ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä»…æ›´æ”¹å­—æ®µä¸­çš„å€¼ï¼Œè€Œä¸æ›´æ”¹å­—æ®µæœ¬èº«ã€‚ å¦‚æœè¦åˆå§‹åŒ–å®ƒï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">initobserv.kt</b> <div class="spoiler_text"><pre> <code class="java hljs">val text = ObservableField(<span class="hljs-string"><span class="hljs-string">"old data"</span></span>) val isLoading = ObservableField(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)</code> </pre> <br></div></div><br><br> è®©æˆ‘ä»¬æ›´æ”¹å¸ƒå±€ï¼Œä½¿å…¶å¯ä»¥è§‚å¯Ÿ<b>æ–‡æœ¬</b>å’Œ<b>isLoading</b> ã€‚ é¦–å…ˆï¼Œç»‘å®š<b>MainViewModel</b>è€Œä¸æ˜¯<b>Repository</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">activity_main.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewModel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.mladenrakonjac.modernandroidapp.MainViewModel"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br> ç„¶åï¼š <br><br><ul><li> æ›´æ”¹TextViewä»¥è§‚å¯Ÿ<b>MainViewModelä¸­çš„</b> <b>æ–‡æœ¬</b> </li><li> æ·»åŠ ä¸€ä¸ªProgressBarï¼Œåªæœ‰åœ¨<b>isLoadingä¸º</b> trueæ—¶æ‰å¯è§ </li><li> æ·»åŠ æŒ‰é’®ï¼Œå•å‡»åå°†ä»<b>MainViewModel</b>è°ƒç”¨<b>refresh</b>æ–¹æ³•ï¼Œå¹¶ä¸”ä»…å½“<b>isLoadingä¸º</b> falseæ—¶æ‰å¯å•å‡» </li></ul><br><div class="spoiler">  <b class="spoiler_title">main_activity.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.text}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> /&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProgressBar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/loading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? View.VISIBLE : View.GONE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{() -&gt; viewModel.refresh()}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:clickable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? false : true}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> ...</code> </pre> <br></div></div><br> å¦‚æœç°åœ¨è¿è¡Œï¼Œ <code>View.VISIBLE and View.GONE cannot be used if View is not imported</code> ï¼Œå°†å‡ºç°<code>View.VISIBLE and View.GONE cannot be used if View is not imported</code> ã€‚ å¥½å§ï¼Œè®©æˆ‘ä»¬å¯¼å…¥ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">main_activity.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.view.View"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewModel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.fleka.modernandroidapp.MainViewModel"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br> å¥½çš„ï¼Œå®Œæˆå¸ƒå±€ã€‚ ç°åœ¨å®Œæˆç»‘å®šã€‚ å°±åƒæˆ‘è¯´çš„ï¼Œ <code><b>View</b></code>å¿…é¡»å…·æœ‰<code><b>ViewModel</b></code>çš„å®ä¾‹ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">() </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: ActivityMainBinding <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainViewModel = MainViewModel() <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) binding.viewModel = mainViewModel binding.executePendingBindings() } }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br> æ‚¨å¯ä»¥çœ‹åˆ°<b>æ—§æ•°æ®å·²</b>æ›¿æ¢ä¸º<b>æ–°æ•°æ®</b> ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªç®€å•çš„MVVMç¤ºä¾‹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬æ‰“å¼€å±å¹•</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  <b>æ—§æ•°æ®</b>ä»£æ›¿<b>æ–°æ•°æ®</b> ã€‚ è¿™æ€ä¹ˆå¯èƒ½ï¼Ÿ çœ‹ä¸€ä¸‹Activityçš„ç”Ÿå‘½å‘¨æœŸï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ´»åŠ¨ç”Ÿå‘½å‘¨æœŸ</b> <div class="spoiler_text"><img src="https://cdn-images-1.medium.com/max/1600/1*CGGROXWhl8dTko1GdDeFsA.png" alt="å›¾ç‰‡"><br></div></div><br> å½“æ‚¨æ‰“å¼€æ‰‹æœºæ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„Activityå®ä¾‹ï¼Œå¹¶è°ƒç”¨<code><b>onCreate()</b></code>æ–¹æ³•ã€‚ çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„æ´»åŠ¨ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">() </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: ActivityMainBinding <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainViewModel = MainViewModel() <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) binding.viewModel = mainViewModel binding.executePendingBindings() } }</code> </pre> <br></div></div><br> å¦‚æ‚¨æ‰€è§ï¼Œåˆ›å»ºActivityå®ä¾‹æ—¶ï¼Œä¹Ÿä¼šåˆ›å»º<b>MainViewModel</b>å®ä¾‹ã€‚ å¦‚æœä»¥æŸç§æ–¹å¼æˆ‘ä»¬ä¸ºæ¯ä¸ªé‡æ–°åˆ›å»ºçš„<b>MainActivity</b>å…·æœ‰ç›¸åŒçš„<b>MainViewModel</b>å®ä¾‹ï¼Œé‚£ä¼šå¾ˆå¥½å—ï¼Ÿ <br><br><h3> ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶ç®€ä»‹ </h3><br> å› ä¸º è®¸å¤šå¼€å‘äººå‘˜éƒ½é¢ä¸´è¿™ä¸ªé—®é¢˜ï¼ŒAndroidæ¡†æ¶å›¢é˜Ÿçš„å¼€å‘äººå‘˜å†³å®šåˆ›å»ºä¸€ä¸ªæ—¨åœ¨å¸®åŠ©è§£å†³æ­¤é—®é¢˜çš„åº“ã€‚  <b>ViewModel</b>ç±»å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚ è¿™æ˜¯æˆ‘ä»¬æ‰€æœ‰ViewModeléƒ½åº”ç»§æ‰¿çš„ç±»ã€‚ <br><br> è®©æˆ‘ä»¬ä»æ”¯æŒç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶çš„<b>ViewModel</b>ç»§æ‰¿<b>MainViewModel</b> ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†<b>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶</b>åº“æ·»åŠ åˆ°æˆ‘ä»¬çš„<b>build.gradle</b>æ–‡ä»¶ä¸­ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">build.gradle</b> <div class="spoiler_text"><pre> <code class="xml hljs">dependencies { ... implementation "android.arch.lifecycle:runtime:1.0.0-alpha9" implementation "android.arch.lifecycle:extensions:1.0.0-alpha9" kapt "android.arch.lifecycle:compiler:1.0.0-alpha9"</code> </pre> <br></div></div><br> ä½¿<b>MainViewModelæˆä¸º</b> <b>ViewModel</b> <b>çš„</b>ç»§æ‰¿è€…ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> me.mladenrakonjac.modernandroidapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.arch.lifecycle.ViewModel <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModel</span></span></span><span class="hljs-class">() </span></span>{ ... }</code> </pre> <br></div></div><br> æˆ‘ä»¬çš„MainActivityçš„<b>onCreateï¼ˆï¼‰</b>æ–¹æ³•å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">() </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: <span class="hljs-function"><span class="hljs-function">ActivityMainBinding override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) binding.viewModel = ViewModelProviders.of(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).get(MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binding</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">executePendingBindings</span></span></span><span class="hljs-class">() } }</span></span></code> </pre> <br></div></div><br> è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰åˆ›å»º<b>MainViewModel</b>çš„æ–°å®ä¾‹ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨<b>ViewModelProviders</b>è·å¾—å®ƒã€‚  <b>ViewModelProviders</b>æ˜¯ä¸€ä¸ªUtilityç±»ï¼Œå…·æœ‰ç”¨äºè·å–<b>ViewModelProvider</b>çš„æ–¹æ³•ã€‚ è¿™ä¸€åˆ‡éƒ½ä¸<b>èŒƒå›´</b>æœ‰å…³ã€‚ å¦‚æœæ‚¨åœ¨Activityä¸­è°ƒç”¨<b>ViewModelProviders.ofï¼ˆæ­¤æ–¹æ³•ï¼‰</b> ï¼Œåˆ™åªè¦è¯¥Activityå¤„äºæ´»åŠ¨çŠ¶æ€ï¼ˆç›´åˆ°å®ƒè¢«é”€æ¯è€Œä¸é‡æ–°åˆ›å»ºï¼‰ï¼Œ <b>ViewModel</b>å°†ä¸€ç›´å­˜åœ¨ã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨åœ¨ç‰‡æ®µä¸­è°ƒç”¨æ­¤å‡½æ•°ï¼Œåˆ™æ‚¨çš„<b>ViewModel</b>å°†åœ¨Fragmentå¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ä»ç„¶å­˜åœ¨ï¼Œç­‰ç­‰ã€‚ çœ‹ä¸€ä¸‹è¯¥å›¾ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">èŒƒå›´ç”Ÿå‘½å‘¨æœŸ</b> <div class="spoiler_text"><img src="https://cdn-images-1.medium.com/max/1600/1*BSzxfYGPAEvHoIs5v2ThKA.png" alt="å›¾ç‰‡"><br></div></div><br>  <b>ViewModelProvider</b>è´Ÿè´£åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œæˆ–è€…å¦‚æœé‡æ–°åˆ›å»ºäº†Activityæˆ–Fragmentåˆ™è¿”å›æ—§çš„å®ä¾‹ã€‚ <br><br> ä¸è¦æ··æ·† <br><br><pre> <code class="java hljs">MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span></span></code> </pre> <br> åœ¨ç§‘ç‰¹æ—ï¼Œå¦‚æœæ‚¨å…³æ³¨ <br><br><pre> <code class="java hljs">MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></code> </pre> <br> è¿™å°†è¿”å›<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">KClass</a> ï¼Œè¿™ä¸Javaä¸­çš„Classä¸åŒã€‚ å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ç¼–å†™<b>.java</b> ï¼Œé‚£ä¹ˆæ ¹æ®æ–‡æ¡£ï¼Œå®ƒæ˜¯ï¼š <br><blockquote> å°†è¿”å›ä¸æ­¤KClasså®ä¾‹ç›¸å¯¹åº”çš„Java <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç±»</a>å®ä¾‹ </blockquote><div class="spoiler">  <b class="spoiler_title">è®©æˆ‘ä»¬çœ‹çœ‹æ—‹è½¬å±å¹•æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br> æˆ‘ä»¬æ‹¥æœ‰ä¸å±å¹•æ—‹è½¬ä¹‹å‰ç›¸åŒçš„æ•°æ®ã€‚ <br><br> åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è¯´è¿‡æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†è·å–Githubå­˜å‚¨åº“çš„åˆ—è¡¨å¹¶æ˜¾ç¤ºå®ƒä»¬ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ <b>getRepositories</b>å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿”å›å‡çš„å­˜å‚¨åº“åˆ—è¡¨ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">RepoModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refreshData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onDataReadyCallback: OnDataReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ Handler().postDelayed({ onDataReadyCallback.onDataReady(<span class="hljs-string"><span class="hljs-string">"new data"</span></span>) },<span class="hljs-number"><span class="hljs-number">2000</span></span>) } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onDataReady(arrayList) },<span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnDataReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data : String)</span></span></span><span class="hljs-function"> } interface OnRepositoryReadyCallback </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data : ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br> æˆ‘ä»¬è¿˜éœ€è¦åœ¨<b>MainViewModel</b>ä¸­æœ‰ä¸€ä¸ªä»<b>RepoModel</b>è°ƒç”¨<b>getRepositories</b>çš„æ–¹æ³•ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModel</span></span></span><span class="hljs-class">() </span></span>{ ... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repositories = ArrayList&lt;Repository&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ ... } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.getRepositories(object : OnRepositoryReadyCallback{ <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) repositories = data } }) } }</code> </pre> <br></div></div><br> æœ€åï¼Œæˆ‘ä»¬éœ€è¦åœ¨RecyclerViewä¸­æ˜¾ç¤ºè¿™äº›å­˜å‚¨åº“ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ï¼š <br><br><ul><li> åˆ›å»ºå¸ƒå±€<b>rv_item_repository.xml</b> </li><li> å°†<b>RecyclerView</b>æ·»åŠ åˆ°å¸ƒå±€<b>activity_main.xml</b> </li><li> åˆ›å»ºRepositoryRecyclerViewAdapter </li><li> åœ¨recyclerviewå®‰è£…é€‚é…å™¨ </li></ul><br> ä¸ºäº†åˆ›å»º<b>rv_item_repository.xmlï¼Œ</b>æˆ‘ä½¿ç”¨äº†CardViewåº“ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†å…¶æ·»åŠ åˆ°build.gradleï¼ˆåº”ç”¨ç¨‹åºï¼‰ä¸­ï¼š <br><br><pre> <code class="xml hljs">implementation 'com.android.support:cardview-v7:26.0.1'</code> </pre> <br> çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">rv_item_repository.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.view.View"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"repository"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.mladenrakonjac.modernandroidapp.uimodels.Repository"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.CardView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"96dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{repository.repositoryName}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20sp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintLeft_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintRight_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.083"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Modern Android App"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_has_issues"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/has_issues"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bold"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{repository.hasIssues ? View.VISIBLE : View.GONE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_owner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{repository.repositoryOwner}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Mladen Rakonjac"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/number_of_starts"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{String.valueOf(repository.numberOfStars)}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintHorizontal_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_owner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0 stars"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.CardView</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br> ä¸‹ä¸€æ­¥æ˜¯å°†RecyclerViewæ·»åŠ åˆ°<b>activity_main.xmlä¸­</b> ã€‚ åœ¨æ‰§è¡Œæ­¤æ“ä½œä¹‹å‰ï¼Œè¯·ç¡®ä¿æ·»åŠ RecyclerViewåº“ï¼š <br><br><pre> <code class="xml hljs">implementation 'com.android.support:recyclerview-v7:26.0.1'</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">activity_main.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.view.View"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewModel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.fleka.modernandroidapp.MainViewModel"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"me.fleka.modernandroidapp.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProgressBar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/loading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:indeterminate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? View.VISIBLE : View.GONE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.RecyclerView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repository_rv"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:indeterminate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:visibility</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? View.GONE : View.VISIBLE}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:listitem</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@layout/rv_item_repository"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"160dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginEnd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginStart</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{() -&gt; viewModel.loadRepositories()}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:clickable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{viewModel.isLoading ? false : true}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Refresh"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintBottom_toBottomOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintEnd_toEndOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintStart_toStartOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintTop_toTopOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:layout_constraintVertical_bias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.constraint.ConstraintLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br><br> è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åˆ é™¤äº†ä¸€äº›TextViewå…ƒç´ ï¼Œç°åœ¨è¯¥æŒ‰é’®å¯åŠ¨<b>loadRepositories</b>è€Œä¸æ˜¯<b>refresh</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">button.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/refresh_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{() -&gt; viewModel.loadRepositories()}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br></div></div><br> è®©æˆ‘ä»¬åœ¨ä¸éœ€è¦æ—¶ä»MainViewModelä¸­åˆ é™¤<b>refresh</b>æ–¹æ³•ï¼Œä»RepoModelä¸­åˆ é™¤refreshDataã€‚ <br><br> ç°åœ¨ï¼Œæ‚¨éœ€è¦ä¸ºRecyclerViewåˆ›å»ºä¸€ä¸ªé€‚é…å™¨ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">RepositoryRecyclerViewAdapter.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">items</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayList</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Repository</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">listener</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecyclerView</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Adapter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-class">&gt;() </span></span>{ <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: ViewGroup?, viewType: Int)</span></span></span><span class="hljs-function">: ViewHolder </span></span>{ val layoutInflater = LayoutInflater.from(parent?.context) val binding = RvItemRepositoryBinding.inflate(layoutInflater, parent, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(binding) } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: ViewHolder, position: Int)</span></span></span><span class="hljs-function"> </span></span>= holder.bind(items[position], listener) <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: Int </span></span>= items.size <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> } class </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">private</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> binding: RvItemRepositoryBinding)</span></span></span><span class="hljs-function"> : RecyclerView.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(binding.root)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(repo: Repository, listener: OnItemClickListener?)</span></span></span><span class="hljs-function"> </span></span>{ binding.repository = <span class="hljs-function"><span class="hljs-function">repo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(listener != </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ binding.root.setOnClickListener({ _ -&gt; listener.onItemClick(layoutPosition) }) } binding.executePendingBindings() } } }</code> </pre> <br></div></div><br> è¯·æ³¨æ„ï¼ŒViewHolderé‡‡ç”¨çš„æ˜¯RvItemRepositoryBindingç±»å‹çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯<b>View</b> ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ViewHolderä¸­ä¸ºæ¯ä¸ªå…ƒç´ å®ç°æ•°æ®ç»‘å®šã€‚ ä¸è¦ä¸ºå•è¡ŒåŠŸèƒ½ï¼ˆonelineï¼‰æ„Ÿåˆ°å°´å°¬ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: ViewHolder, position: Int)</span></span></span><span class="hljs-function"> </span></span>= holder.bind(items[position], listener)</code> </pre> <br> è¿™åªæ˜¯ä»¥ä¸‹å†…å®¹çš„ç®€çŸ­æ¡ç›®ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: ViewHolder, position: Int)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> holder.bind(items[position], listener) }</code> </pre> <br>  <b>é¡¹ç›®[position]</b>æ˜¯ç´¢å¼•è¿ç®—ç¬¦çš„å®ç°ã€‚ å®ƒç±»ä¼¼äº<b>items.getï¼ˆpositionï¼‰</b> ã€‚ <br><br> å¦ä¸€è¡Œå¯èƒ½ä¼šä½¿æ‚¨æ„Ÿåˆ°å›°æƒ‘ï¼š <br><br><pre> <code class="java hljs">binding.root.setOnClickListener({ _ -&gt; listener.onItemClick(layoutPosition) })</code> </pre> <br> å¦‚æœä¸ä½¿ç”¨_ï¼Œåˆ™å¯ä»¥å°†å…¶æ›¿æ¢ä¸º_ã€‚ å¥½å§ <br><br> æˆ‘ä»¬åˆ›å»ºäº†é€‚é…å™¨ï¼Œä½†ä»æœªå°†å…¶åº”ç”¨äº<b>MainActivityä¸­</b>çš„<b>recyclerView</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class"> </span></span>{ lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: <span class="hljs-function"><span class="hljs-function">ActivityMainBinding override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) val viewModel = ViewModelProviders.of(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).get(MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binding</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">viewModel</span></span></span><span class="hljs-class"> </span></span>= viewModel binding.executePendingBindings() binding.repositoryRv.layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) binding.repositoryRv.adapter = RepositoryRecyclerViewAdapter(viewModel.repositories, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> </span></span>{ TODO(<span class="hljs-string"><span class="hljs-string">"not implemented"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//To change body of created functions use File | Settings | File Templates. } }</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">è¿è¡Œåº”ç”¨ç¨‹åº</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br> çœŸå¥‡æ€ª æ€ä¹ˆäº† <br><br><ul><li> æ´»åŠ¨å·²åˆ›å»ºï¼Œå› æ­¤è¿˜åˆ›å»ºäº†ä¸€ä¸ªæ–°é€‚é…å™¨ï¼Œå…¶ä¸­çš„<b>å­˜å‚¨åº“</b>å®é™…ä¸Šæ˜¯ç©ºçš„ </li><li> æˆ‘ä»¬æŒ‰ä¸‹æŒ‰é’® </li><li> ç§°ä¸ºloadRepositoriesï¼Œæ˜¾ç¤ºè¿›åº¦ </li><li>  2ç§’é’Ÿåï¼Œæˆ‘ä»¬å¾—åˆ°äº†å­˜å‚¨åº“ï¼Œè¿›åº¦è¢«éšè—äº†ï¼Œä½†æ˜¯æ²¡æœ‰å‡ºç°ã€‚ è¿™æ˜¯å› ä¸º<b>é€‚é…å™¨</b>ä¸­æœªè°ƒç”¨<b>notifyDataSetChanged</b> </li><li> å½“æˆ‘ä»¬æ—‹è½¬å±å¹•æ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ–°çš„Activityï¼Œå› æ­¤å°†ä½¿ç”¨å¸¦æœ‰ä¸€äº›æ•°æ®çš„<b>repositories</b>å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„é€‚é…å™¨ </li></ul><br> å› æ­¤ï¼Œç”±äº<b>MainViewModel</b>åº”è¯¥é€šçŸ¥<b>MainActivity</b>æ–°é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨<b>notifyDataSetChanged</b>å—ï¼Ÿ <br><br> æˆ‘ä»¬ä¸èƒ½ã€‚ <br><br> è¿™çœŸçš„å¾ˆé‡è¦ï¼Œ <b>MainViewModel</b>æ ¹æœ¬ä¸åº”è¯¥äº†è§£<b>MainActivity</b> ã€‚ <br><br>  <b>MainActivity</b>æ˜¯æ‹¥æœ‰<b>MainViewModel</b>å®ä¾‹çš„å®ä¾‹ï¼Œå› æ­¤å®ƒåº”è¯¥ä¾¦å¬æ›´æ”¹å¹¶å°†æ›´æ”¹é€šçŸ¥<b>Adapter</b> ã€‚ <br><br> ä½†æ˜¯æ€ä¹ˆåšå‘¢ï¼Ÿ <br><br> æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿ<b>å­˜å‚¨åº“</b> ï¼Œå› æ­¤åœ¨æ›´æ”¹æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹é€‚é…å™¨ã€‚ <br><br> è¿™ä¸ªå†³å®šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ <br><br> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä»¥ä¸‹æƒ…å†µï¼š <br><br><ul><li> åœ¨<b>MainActivityä¸­ï¼Œ</b>æˆ‘ä»¬è§‚å¯Ÿå­˜å‚¨åº“ï¼šå‘ç”Ÿæ›´æ”¹æ—¶ï¼Œæˆ‘ä»¬æ‰§è¡Œ<b>notifyDataSetChanged</b> </li><li> æˆ‘ä»¬æŒ‰ä¸‹æŒ‰é’® </li><li> åœ¨æˆ‘ä»¬ç­‰å¾…æ•°æ®æ›´æ”¹æ—¶ï¼Œç”±äº<b>é…ç½®æ›´æ”¹</b> ï¼Œå¯èƒ½ä¼šé‡æ–°åˆ›å»º<b>MainActivity</b> <b>ã€‚</b> </li><li> æˆ‘ä»¬çš„<b>MainViewModel</b>ä»ç„¶å­˜åœ¨ </li><li>  2ç§’åï¼Œâ€œ <b>å­˜å‚¨åº“â€</b>å­—æ®µå°†æ¥æ”¶æ–°é¡¹ç›®ï¼Œå¹¶é€šçŸ¥è§‚å¯Ÿè€…æ•°æ®å·²æ›´æ”¹ </li><li> è§‚å¯Ÿè€…å°è¯•åœ¨ä¸å†å­˜åœ¨çš„<b>é€‚é…å™¨</b>ä¸Šæ‰§è¡Œ<b>notifyDataSetChanged</b> ï¼Œå› ä¸º  <b>MainActivity</b>å·²é‡æ–°åˆ›å»º </li></ul><br> å¥½å§ï¼Œæˆ‘ä»¬çš„å†³å®šè¿˜ä¸å¤Ÿå¥½ã€‚ <br><br><h3>  LiveDataç®€ä»‹ </h3><br>  <b>LiveData</b>æ˜¯å¦ä¸€ä¸ª<b>äº†è§£ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶ï¼Œ</b>å®ƒåŸºäºå¯äº†è§£Viewç”Ÿå‘½å‘¨æœŸçš„å¯è§‚å¯Ÿå¯¹è±¡ã€‚ å› æ­¤ï¼Œå½“Activityç”±äº<b>é…ç½®æ›´æ”¹</b>è€Œè¢«é”€æ¯æ—¶ï¼Œ <b>LiveDataä¼š</b>çŸ¥é“å®ƒï¼Œå› æ­¤å®ƒä¹Ÿå°†ä»è¢«é”€æ¯çš„Activityä¸­åˆ é™¤è§‚å¯Ÿè€…ã€‚ <br><br> æˆ‘ä»¬åœ¨<b>MainViewModelä¸­</b>å®ç°ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainViewModel.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModel</span></span></span><span class="hljs-class">() </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repoModel: RepoModel = RepoModel() val text = ObservableField(<span class="hljs-string"><span class="hljs-string">"old data"</span></span>) val isLoading = ObservableField(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repositories = MutableLiveData&lt;ArrayList&lt;Repository&gt;&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) repoModel.getRepositories(object : OnRepositoryReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) repositories.value = data } }) } }</code> </pre> <br></div></div><br> å¹¶å¼€å§‹è§‚å¯ŸMainActivityï¼š <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LifecycleActivity</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepositoryRecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnItemClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> lateinit <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> binding: ActivityMainBinding <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> val repositoryRecyclerViewAdapter = RepositoryRecyclerViewAdapter(arrayListOf(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: Bundle?)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main) val viewModel = ViewModelProviders.of(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).get(MainViewModel::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binding</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">viewModel</span></span></span><span class="hljs-class"> </span></span>= viewModel binding.executePendingBindings() binding.repositoryRv.layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) binding.repositoryRv.adapter = repositoryRecyclerViewAdapter viewModel.repositories.observe(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Observer&lt;ArrayList&lt;Repository&gt;&gt; { it?.let{ repositoryRecyclerViewAdapter.replaceData(it)} }) } <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(position: Int)</span></span></span><span class="hljs-function"> </span></span>{ TODO(<span class="hljs-string"><span class="hljs-string">"not implemented"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//To change body of created functions use File | Settings | File Templates. } }</span></span></code> </pre> <br></div></div><br> è¿™ä¸ªè¯æ˜¯<b>ä»€ä¹ˆ</b>æ„æ€ï¼Ÿ å¦‚æœä¸€ä¸ªå‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨itå…³é”®å­—è®¿é—®æ­¤å‚æ•°ã€‚ å› æ­¤ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªlambdaè¡¨è¾¾å¼è¦ä¹˜ä»¥2ï¼š <br><br><pre> <code class="java hljs">((a) -&gt; <span class="hljs-number"><span class="hljs-number">2</span></span> * a)</code> </pre> <br> å¯ä»¥æ›¿æ¢ä¸ºï¼š <br><br><pre> <code class="java hljs">(it * <span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">å¦‚æœç«‹å³å¯åŠ¨è¯¥åº”ç”¨ç¨‹åºï¼Œåˆ™å¯ä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  ... <br><br><h3> ä¸ºä»€ä¹ˆæ¯”MVPæ›´å–œæ¬¢MVVMï¼Ÿ </h3><br><br><ul><li>  Viewæ²¡æœ‰æ— èŠçš„ç•Œé¢ï¼Œå› ä¸º  ViewModelæ²¡æœ‰å¼•ç”¨View </li><li>  Presenteræ²¡æœ‰æ— èŠçš„ç•Œé¢ï¼Œè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ </li><li> å¤„ç†é…ç½®æ›´æ”¹è¦å®¹æ˜“å¾—å¤š </li><li> ä½¿ç”¨MVVMï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘æ´»åŠ¨ï¼Œç‰‡æ®µç­‰çš„ä»£ç ã€‚ </li></ul><br>  ... <br><br><h3> å‚¨å­˜åº“æ¨¡å¼ </h3><br><div class="spoiler">  <b class="spoiler_title">æ–¹æ¡ˆ</b> <div class="spoiler_text"><img src="https://cdn-images-1.medium.com/max/1600/1*UDzzNYwInvHg25V_OtWejg.jpeg" alt="å›¾ç‰‡"><br></div></div><br> å¦‚å‰æ‰€è¿°ï¼Œ <b>Model</b>åªæ˜¯æˆ‘ä»¬å‡†å¤‡æ•°æ®çš„å±‚çš„æŠ½è±¡åç§°ã€‚ å®ƒé€šå¸¸åŒ…å«å­˜å‚¨åº“å’Œæ•°æ®ç±»ã€‚ æ¯ä¸ªå®ä½“ï¼ˆæ•°æ®ï¼‰ç±»éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„<b>å­˜å‚¨åº“</b>ç±»ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å…·æœ‰<b>User</b>å’Œ<b>Post</b>ç±»ï¼Œåˆ™è¿˜å¿…é¡»å…·æœ‰<b>UserRepository</b>å’Œ<b>PostRepository</b> ã€‚ æ‰€æœ‰æ•°æ®éƒ½æ¥è‡ªé‚£é‡Œã€‚ æˆ‘ä»¬ç»ä¸åº”è¯¥ä»Viewæˆ–ViewModelè°ƒç”¨å…±äº«é¦–é€‰é¡¹æˆ–æ•°æ®åº“çš„å®ä¾‹ã€‚ <br><br> å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†RepoModelé‡å‘½åä¸º<b>GitRepoRepository</b> ï¼Œå…¶ä¸­<b>GitRepo</b>å°†æ¥è‡ªGithubå­˜å‚¨åº“ï¼Œè€Œ<b>Repository</b>å°†æ¥è‡ªå­˜å‚¨åº“æ¨¡å¼ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">RepoRepositories.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGitRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onDataReady(arrayList) }, <span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br> å¥½çš„ï¼Œ <b>MainViewModel</b>ä»<b>GitRepoRepsitories</b>è·å–å­˜å‚¨åº“çš„Githubåˆ—è¡¨ï¼Œä½†æ˜¯ä»å“ªé‡Œè·å–<b>GitRepoRepositories</b>å‘¢ï¼Ÿ <br><br> æ‚¨å¯ä»¥ä»å®ä¾‹ç›´æ¥åœ¨å­˜å‚¨åº“ä¸Šè°ƒç”¨<b>å®¢æˆ·ç«¯</b>æˆ–<b>æ•°æ®åº“</b> ï¼Œä½†è¿™ä»ç„¶ä¸æ˜¯æœ€ä½³åšæ³•ã€‚ æ‚¨çš„åº”ç”¨ç¨‹åºåº”å°½å¯èƒ½æ¨¡å—åŒ–ã€‚ å¦‚æœæ‚¨å†³å®šä½¿ç”¨å…¶ä»–å®¢æˆ·ç”¨Retrofitä»£æ›¿Volleyæ€ä¹ˆåŠï¼Ÿ å¦‚æœæ‚¨å†…éƒ¨æœ‰æŸç§é€»è¾‘ï¼Œå°†å¾ˆéš¾è¿›è¡Œé‡æ„ã€‚ æ‚¨çš„å­˜å‚¨åº“ä¸éœ€è¦çŸ¥é“æ‚¨è¦ä½¿ç”¨å“ªä¸ªå®¢æˆ·ç«¯æ¥æ£€ç´¢è¿œç¨‹æ•°æ®ã€‚ <br><br><ul><li> å­˜å‚¨åº“å”¯ä¸€éœ€è¦çŸ¥é“çš„æ˜¯æ•°æ®æ˜¯è¿œç¨‹è¿˜æ˜¯æœ¬åœ°åˆ°è¾¾ã€‚ æ— éœ€çŸ¥é“æˆ‘ä»¬å¦‚ä½•è·å–æ­¤è¿œç¨‹æˆ–æœ¬åœ°æ•°æ®ã€‚ </li><li> å”¯ä¸€éœ€è¦çš„<b>è§†å›¾æ¨¡å‹</b>æ˜¯æ•°æ® </li><li>  <b>View</b>å”¯ä¸€è¦åšçš„å°±æ˜¯æ˜¾ç¤ºæ­¤æ•°æ®ã€‚ </li></ul><br> å½“æˆ‘åˆšå¼€å§‹åœ¨Androidä¸Šè¿›è¡Œå¼€å‘æ—¶ï¼Œæˆ‘æƒ³çŸ¥é“åº”ç”¨ç¨‹åºå¦‚ä½•è„±æœºå·¥ä½œä»¥åŠæ•°æ®åŒæ­¥å¦‚ä½•å·¥ä½œã€‚ å¥½çš„åº”ç”¨ç¨‹åºä½“ç³»ç»“æ„ä½¿æˆ‘ä»¬å¯ä»¥è½»æ¾åšåˆ°è¿™ä¸€ç‚¹ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå­˜åœ¨Internetè¿æ¥ï¼Œåˆ™åœ¨<b>ViewModel</b>ä¸­è°ƒç”¨<b>loadRepositories</b>æ—¶ï¼Œ <b>GitRepoRepositories</b>å¯ä»¥ä»è¿œç¨‹æ•°æ®æºæ¥æ”¶æ•°æ®å¹¶å°†å…¶ä¿å­˜åˆ°æœ¬åœ°æ•°æ®æºã€‚ å½“ç”µè¯ç¦»çº¿æ—¶ï¼Œ <b>GitRepoRepository</b>å¯ä»¥ä»æœ¬åœ°å­˜å‚¨æ¥æ”¶æ•°æ®ã€‚ å› æ­¤ï¼Œ <b>å­˜å‚¨åº“</b>å¿…é¡»å…·æœ‰<b>RemoteDataSource</b>å’Œ<b>LocalDataSourceçš„</b>å®ä¾‹ä»¥åŠè¯¥æ•°æ®åº”æ¥è‡ªçš„é€»è¾‘å¤„ç†ã€‚ <br><br> æ·»åŠ <b>æœ¬åœ°æ•°æ®æº</b> ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">GitRepoLocalDataSource.kt</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoLocalDataSource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepoLocalReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First From Local"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second From Local"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third From Local"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onLocalDataReady(arrayList) }, <span class="hljs-number"><span class="hljs-number">2000</span></span>) } <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(arrayList: ArrayList&lt;Repository&gt;)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//todo save repositories in DB } } interface OnRepoLocalReadyCallback { fun onLocalDataReady(data: ArrayList&lt;Repository&gt;) }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼šç¬¬ä¸€ç§è¿”å›è™šå‡çš„æœ¬åœ°æ•°æ®ï¼Œç¬¬äºŒç§ç”¨äºè™šæ‹Ÿæ•°æ®å­˜å‚¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ·»åŠ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿œç¨‹æ•°æ®æº</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRemoteDataSource.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRemoteDataSource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepoRemoteReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrayList = ArrayList&lt;Repository&gt;() arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"First from remote"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 1"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Second from remote"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 2"</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) arrayList.add(Repository(<span class="hljs-string"><span class="hljs-string">"Third from remote"</span></span>, <span class="hljs-string"><span class="hljs-string">"Owner 3"</span></span>, <span class="hljs-number"><span class="hljs-number">430</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) Handler().postDelayed({ onRepositoryReadyCallback.onRemoteDataReady(arrayList) }, <span class="hljs-number"><span class="hljs-number">2000</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepoRemoteReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRemoteDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åªæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è¿”å›ä¼ªé€ çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿œç¨‹</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°æ®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨æˆ‘ä»¬å¯ä»¥å‘å­˜å‚¨åº“æ·»åŠ ä¸€äº›é€»è¾‘ï¼š</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class"> </span></span>{ val localDataSource = GitRepoLocalDataSource() val remoteDataSource = GitRepoRemoteDataSource() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ remoteDataSource.getRepositories( object : OnRepoRemoteReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ localDataSource.saveRepositories(data) onRepositoryReadyCallback.onDataReady(data) } }) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œé€šè¿‡å…±äº«æºï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨æœ¬åœ°ä¿å­˜æ•°æ®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨åªéœ€è¦ç½‘ç»œæ•°æ®ï¼Œè¿˜éœ€è¦ä½¿ç”¨å­˜å‚¨åº“æ¨¡æ¿æ€ä¹ˆåŠï¼Ÿ</font></font>æ˜¯çš„<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿™ä½¿ä»£ç æµ‹è¯•æ›´åŠ å®¹æ˜“ï¼Œå…¶ä»–å¼€å‘äººå‘˜å¯ä»¥æ›´å¥½åœ°ç†è§£æ‚¨çš„ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥æ›´å¿«åœ°æ”¯æŒå®ƒï¼ </font></font><br><br>  ... <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Android ManageråŒ…è£…å™¨ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨æƒ³åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepositoryä¸­</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥æ‚¨çš„Internetè¿æ¥</font><font style="vertical-align: inherit;">ä»¥äº†è§£ä»ä½•å¤„è¯·æ±‚æ•°æ®ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</font><font style="vertical-align: inherit;">æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼Œæˆ‘ä»¬ä¸åº”åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ViewModelå’ŒModelä¸­</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ”¾ç½®ä»»ä½•ä¸Androidç›¸å…³çš„ä»£ç </font><font style="vertical-align: inherit;">ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä¸ºäº’è”ç½‘è¿æ¥ç¼–å†™ä¸€ä¸ªåŒ…è£…å™¨ï¼š</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetManager.ktï¼ˆç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆé€‚ç”¨äºå…¶ä»–ç®¡ç†å™¨ï¼Œä¾‹å¦‚ï¼Œé€‚ç”¨äºNfcManagerï¼‰</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NetManager</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">applicationContext</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> status: Boolean? = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> val isConnectedToInternet: Boolean? get() { val conManager = applicationContext.getSystemService(Context.CONNECTIVITY_SERVICE) as ConnectivityManager val ni = conManager.activeNetworkInfo <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ni != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; ni.isConnected } }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä»…å½“æˆ‘ä»¬æ·»åŠ æ¸…å•æƒé™æ—¶ï¼Œæ­¤ä»£ç æ‰æœ‰æ•ˆï¼š </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚ä½•åœ¨èµ„æºåº“ä¸­åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¸Šä¸‹æ–‡ï¼ˆ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šä¸‹æ–‡</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Ÿ</font><font style="vertical-align: inherit;">æˆ‘ä»¬å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­è¯·æ±‚å®ƒï¼š</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class">)</span></span>{ val localDataSource = GitRepoLocalDataSource() val remoteDataSource = GitRepoRemoteDataSource() val netManager = NetManager(context) <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ remoteDataSource.getRepositories(object : OnRepoRemoteReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ localDataSource.saveRepositories(data) onRepositoryReadyCallback.onDataReady(data) } }) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬åœ¨ViewModelä¸­çš„æ–°GitRepoRepositoryå®ä¾‹ä¹‹å‰åˆ›å»ºã€‚</font><font style="vertical-align: inherit;">æ­£å¦‚æˆ‘ä»¬ç°åœ¨å¯ä»¥</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetManager</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è§†å›¾æ¨¡å‹ï¼Œå½“</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºNetManagerå¿…è¦çš„æ¡ä»¶</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Ÿ</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥ä»å…·æœ‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸Šä¸‹æ–‡</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„Lifecycle-awareç»„ä»¶åº“ä¸­ä½¿ç”¨AndroidViewModel </font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ï¼Œè€Œä¸æ˜¯æ´»åŠ¨ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MainViewModel.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidViewModel</span></span></span><span class="hljs-class"> </span></span>{ constructor(application: Application) : <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(application) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gitRepoRepository: GitRepoRepository = GitRepoRepository(NetManager(getApplication())) val text = ObservableField(<span class="hljs-string"><span class="hljs-string">"old data"</span></span>) val isLoading = ObservableField(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> repositories = MutableLiveData&lt;ArrayList&lt;Repository&gt;&gt;() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) gitRepoRepository.getRepositories(object : OnRepositoryReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ isLoading.set(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) repositories.value = data } }) } }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨è¿™æ¡çº¿ </font></font><br><br><pre> <code class="java hljs">constructor(application: Application) : <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(application)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬ä¸º</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MainViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®šä¹‰äº†ä¸€ä¸ªæ„é€ å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å…¶æ„é€ å‡½æ•°ä¸­</font><font style="vertical-align: inherit;">è¯·æ±‚</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº”ç”¨ç¨‹åº</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„å®ä¾‹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨superæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è°ƒç”¨</font><font style="vertical-align: inherit;">æˆ‘ä»¬ç»§æ‰¿</font><font style="vertical-align: inherit;">çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidViewModel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ„é€ å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„ï¼šå¦‚æœè¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥æ‘†è„±ä¸€è¡Œï¼š</font></font><br><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidViewModel</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class">) </span></span>{ ... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepositoryä¸­</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰äº†NetManagerå®ä¾‹</font><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥Internetè¿æ¥äº†ï¼š</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitRepoRepository.kt</font></font></b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GitRepoRepository</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">netManager</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NetManager</span></span></span><span class="hljs-class">) </span></span>{ val localDataSource = GitRepoLocalDataSource() val remoteDataSource = GitRepoRemoteDataSource() <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRepositories</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(onRepositoryReadyCallback: OnRepositoryReadyCallback)</span></span></span><span class="hljs-function"> </span></span>{ netManager.isConnectedToInternet?.let { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it) { remoteDataSource.getRepositories(object : OnRepoRemoteReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRemoteDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ localDataSource.saveRepositories(data) onRepositoryReadyCallback.onDataReady(data) } }) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { localDataSource.getRepositories(object : OnRepoLocalReadyCallback { <span class="hljs-function"><span class="hljs-function">override fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLocalDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> </span></span>{ onRepositoryReadyCallback.onDataReady(data) } }) } } } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnRepositoryReadyCallback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">fun </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDataReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: ArrayList&lt;Repository&gt;)</span></span></span><span class="hljs-function"> }</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æœ‰Internetè¿æ¥ï¼Œæˆ‘ä»¬å°†æ”¶åˆ°å·²åˆ é™¤çš„æ•°æ®å¹¶å°†å…¶ä¿å­˜åœ¨æœ¬åœ°ã€‚å¦‚æœæ²¡æœ‰Internetè¿æ¥ï¼Œæˆ‘ä»¬å°†è·å–æœ¬åœ°æ•°æ®ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ³¨æ„åœ¨ç§‘ç‰¹æ—</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¿è¥å•†</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºnullæ£€æŸ¥å¹¶åœ¨è¿”å›å€¼</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ä»¥ä¸‹æ–‡ç« ä¹‹ä¸€ä¸­ï¼Œæˆ‘å°†ä»‹ç»ä¾èµ–é¡¹æ³¨å…¥ï¼Œåœ¨ViewModelä¸­åˆ›å»ºå­˜å‚¨åº“å®ä¾‹æœ‰å¤šç³Ÿï¼Œä»¥åŠå¦‚ä½•é¿å…ä½¿ç”¨AndroidViewModelã€‚æˆ‘è¿˜å°†å†™ä¸€äº›ä»£ç ä¸­ç°åœ¨å­˜åœ¨çš„è®¸å¤šé—®é¢˜ã€‚æˆ‘ç¦»å¼€å®ƒä»¬æ˜¯æœ‰åŸå› çš„... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘è¯•å›¾å‘æ‚¨å±•ç¤ºé—®é¢˜ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆæ‰€æœ‰è¿™äº›åº“éƒ½å¾ˆæµè¡Œä»¥åŠä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSæˆ‘æ”¹å˜äº†ä¸»æ„ï¼Œæ˜ å°„å™¨ï¼ˆ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜ å°„å™¨</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">æˆ‘å†³å®šåœ¨ä»¥ä¸‹æ–‡ç« ä¸­å¯¹æ­¤è¿›è¡Œä»‹ç»ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN432826/">https://habr.com/ru/post/zh-CN432826/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN432816/index.html">AXIS M3046-Vä¸IDIS DC-D3212Xï¼šæ¯”è¾ƒCCTVæ‘„åƒæœº</a></li>
<li><a href="../zh-CN432818/index.html">è‡ªåˆ¶ç»˜å›¾ä»ªï¼šä½¿ç”¨grbl-firmwareçš„åˆå­¦è€…æç¤º</a></li>
<li><a href="../zh-CN432820/index.html">åŠ¨æ€æµ‹è¯•Androidåº”ç”¨ç¨‹åº</a></li>
<li><a href="../zh-CN432822/index.html">æˆ‘ä¸ºå¼€å‘äººå‘˜ç ´åäº†æˆ‘çš„ä¸€ç”Ÿçš„ä»£ç ï¼Œæˆ‘ä¸å†æƒ³è¦è¿™æ ·åšäº†</a></li>
<li><a href="../zh-CN432824/index.html">åŠ å¿«ConcurrentReferenceHashMapçš„åˆ›å»º</a></li>
<li><a href="../zh-CN432828/index.html">æµ‹è¯•å’Œè°ƒè¯•MapReduce</a></li>
<li><a href="../zh-CN432830/index.html">è‡ªåŠ¨åŒ–ç³»ç»Ÿå¯¹åºŸå¼ƒåƒåœ¾å¤„ä»¥ç½šæ¬¾</a></li>
<li><a href="../zh-CN432832/index.html">å¦‚ä½•â€œç²˜åˆâ€åŸºäºè‹±ç‰¹å°”çš„æœåŠ¡å™¨å¹¶å…‹æœ8ä¸ªå¤„ç†å™¨çš„æ‰©å±•ä¸Šé™</a></li>
<li><a href="../zh-CN432834/index.html">C ++ä¸­çš„å†…éƒ¨å’Œå¤–éƒ¨é“¾æ¥</a></li>
<li><a href="../zh-CN432836/index.html">Aliexpressçš„ç¬¬ä¸€ä¸ªä¼˜è´¨ç¯æ³¡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>