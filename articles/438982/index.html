<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÜüèø ‚öñÔ∏è üë®‚Äçüç≥ Gu√≠a de Kubernetes, Parte 1: Aplicaciones, microservicios y contenedores üôé üçí üë©üèø‚Äçü§ù‚Äçüë©üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A petici√≥n nuestra, Habr cre√≥ el centro Kubernetes y nos complace publicar la primera publicaci√≥n en √©l. Suscribete! 
 Kubernetes es f√°cil. ¬øPor qu√© l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gu√≠a de Kubernetes, Parte 1: Aplicaciones, microservicios y contenedores</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/438982/"><blockquote>  A petici√≥n nuestra, Habr cre√≥ el centro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kubernetes</a> y nos complace publicar la primera publicaci√≥n en √©l.  Suscribete! </blockquote><br>  Kubernetes es f√°cil.  ¬øPor qu√© los bancos me pagan mucho dinero por trabajar en esta √°rea, mientras que cualquiera puede dominar esta tecnolog√≠a en solo unas pocas horas? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/d3/4l/ic/d34licaikjsxfxisetkc9arcpdi.jpeg"></a> <br><a name="habracut"></a><br>  Si duda de que se pueda aprender Kubernetes tan r√°pido, le sugiero que intente hacerlo usted mismo.  Es decir, habiendo dominado este material, podr√° ejecutar la aplicaci√≥n basada en microservicios en el cl√∫ster de Kubernetes.  Puedo garantizar esto, porque es precisamente por la metodolog√≠a utilizada aqu√≠ que entreno a Kubernetes para trabajar con nuestros clientes.  ¬øQu√© distingue este manual de otros?  De hecho, muchas cosas.  Por lo tanto, la mayor√≠a de estos materiales comienzan con una explicaci√≥n de cosas simples: conceptos de Kubernetes y caracter√≠sticas del equipo de kubectl.  Los autores de estos materiales creen que su lector est√° familiarizado con el desarrollo de aplicaciones, microservicios y contenedores Docker.  Nosotros iremos por el otro lado.  Primero, hablemos sobre c√≥mo ejecutar una aplicaci√≥n basada en microservicios en una computadora.  Luego considere el ensamblaje de las im√°genes del contenedor para cada microservicio.  Despu√©s de eso, conoceremos a Kubernetes y analizaremos la implementaci√≥n de una aplicaci√≥n basada en microservicios en un cl√∫ster administrado por Kubernetes. <br><br>  Tal enfoque, con un enfoque gradual a Kubernetes, le dar√° la profundidad de comprensi√≥n que le est√° sucediendo a una persona com√∫n para comprender cu√°n simple se arregla todo en Kubernetes.  Kubernetes es, por supuesto, una tecnolog√≠a simple, siempre que cualquiera que quiera aprenderlo sepa d√≥nde y c√≥mo se usa. <br><br>  Ahora, sin m√°s pre√°mbulos, pong√°monos a trabajar y hablemos sobre la aplicaci√≥n con la que trabajaremos. <br><br><h2>  <font color="#3AC1EF">Aplicaci√≥n experimental</font> </h2><br>  Nuestra aplicaci√≥n realizar√° solo una funci√≥n.  Acepta, como entrada, una oraci√≥n, y luego, utilizando los medios de an√°lisis de texto, realiza un an√°lisis de sentimientos de esta oraci√≥n, recibiendo una estimaci√≥n de la actitud emocional del autor de la oraci√≥n hacia un determinado objeto. <br><br>  As√≠ es como se ve la ventana principal de esta aplicaci√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/674/7e1/415/6747e14151585819867c880f52fa9d21.gif"></div><br>  <i><font color="#999999">Aplicaci√≥n web para an√°lisis de sentimiento de texto</font></i> <br><br>  Desde un punto de vista t√©cnico, la aplicaci√≥n consta de tres microservicios, cada uno de los cuales resuelve un cierto conjunto de tareas: <br><br><ul><li>  SA-Frontend es un servidor web Nginx que sirve React archivos est√°ticos. </li><li>  SA-WebApp es una aplicaci√≥n web basada en Java que procesa solicitudes desde el front-end. </li><li>  SA-Logic es una aplicaci√≥n de Python que realiza an√°lisis de sentimientos de texto. </li></ul><br>  Es importante tener en cuenta que los microservicios no existen de forma aislada.  Implementan la idea de "separaci√≥n de deberes", pero, sin embargo, necesitan interactuar entre s√≠. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94b/f93/0c0/94bf930c03220c1eec6957a0f7308046.gif"></div><br>  <i><font color="#999999">Flujos de datos de aplicaciones</font></i> <br><br>  En el diagrama anterior, puede ver las etapas numeradas del sistema, que ilustran los flujos de datos en la aplicaci√≥n.  Analic√©moslos: <br><br><ol><li> El navegador solicita el archivo <code>index.html</code> del servidor (que, a su vez, descarga el paquete de la aplicaci√≥n React). </li><li>  El usuario interact√∫a con la aplicaci√≥n, esto provoca una llamada a una aplicaci√≥n web basada en Spring. </li><li>  La aplicaci√≥n web redirige la solicitud de an√°lisis de texto a la aplicaci√≥n Python. </li><li>  La aplicaci√≥n Python analiza la tonalidad del texto y devuelve el resultado como respuesta a la solicitud. </li><li>  La aplicaci√≥n Spring env√≠a una respuesta a la aplicaci√≥n React (y, a su vez, muestra el resultado del an√°lisis de texto al usuario). </li></ol><br>  El c√≥digo para todas estas aplicaciones se puede encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Le recomiendo que ahora copie este repositorio para usted, ya que hay muchos experimentos interesantes por delante. <br><br><h2>  <font color="#3AC1EF">Inicio de una aplicaci√≥n basada en microservicios en una computadora local</font> </h2><br>  Para que la aplicaci√≥n funcione, necesitamos ejecutar los tres microservicios.  Comencemos con el m√°s lindo de ellos, con la aplicaci√≥n front-end. <br><br><h3>  <font color="#3AC1EF">‚ñçConfiguraci√≥n Reaccionar para el desarrollo local</font> </h3><br>  Para ejecutar la aplicaci√≥n React, debe instalar las plataformas Node.js y NPM en su computadora.  Despu√©s de instalar todo esto, vaya a trav√©s de la terminal a la carpeta del proyecto <code>sa-frontend</code> y ejecute el siguiente comando: <br><br><pre> <code class="plaintext hljs">npm install</code> </pre> <br>  Gracias a la ejecuci√≥n de este comando, las dependencias de la aplicaci√≥n React, cuyas entradas se encuentran en el archivo <code>package.json</code> , se cargar√°n en la carpeta <code>node_modules</code> .  Despu√©s de descargar las dependencias en la misma carpeta, ejecute el siguiente comando: <br><br><pre> <code class="plaintext hljs">npm start</code> </pre> <br>  Eso es todo  Ahora que la aplicaci√≥n React se est√° ejecutando, puede acceder a ella yendo a la direcci√≥n <code>localhost:3000</code> en el navegador.  Puedes cambiar algo en su c√≥digo.  Inmediatamente ver√° el efecto de estos cambios en el navegador.  Esto es posible gracias al llamado reemplazo "en caliente" de los m√≥dulos.  Gracias a esto, el desarrollo front-end se convierte en una tarea simple y agradable. <br><br><h3>  <font color="#3AC1EF">‚ñçPreparaci√≥n de una aplicaci√≥n React para salida a producci√≥n</font> </h3><br>  Para el uso real de la aplicaci√≥n React, necesitamos convertirla en un conjunto de archivos est√°ticos y entregarlos a los clientes que usan un servidor web. <br><br>  Para compilar la aplicaci√≥n React, nuevamente, usando el terminal, vaya a la carpeta <code>sa-frontend</code> y ejecute el siguiente comando: <br><br><pre> <code class="plaintext hljs">npm run build</code> </pre> <br>  Esto crear√° un directorio de <code>build</code> en la carpeta del proyecto.  Contendr√° todos los archivos est√°ticos necesarios para que la aplicaci√≥n React funcione. <br><br><h3>  <font color="#3AC1EF">‚ñçServicio de archivos est√°ticos con herramientas Nginx</font> </h3><br>  Primero debe instalar y ejecutar el servidor web Nginx.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aqu√≠</a> puede descargarlo y encontrar las instrucciones de instalaci√≥n y arranque.  Luego, debe copiar el contenido de la carpeta <code>sa-frontend/build</code> carpeta <code>[your_nginx_installation_dir]/html</code> . <br><br>  Con este enfoque, el archivo <code>index.html</code> generado durante la compilaci√≥n de la aplicaci√≥n React estar√° disponible en <code>[your_nginx_installation_dir]/html/index.html</code> .  Este es el archivo que, por defecto, el servidor Nginx emite al acceder.  El servidor est√° configurado para escuchar en el puerto <code>80</code> , pero puede configurarlo seg√∫n lo necesite editando el archivo <code>[your_nginx_installation_dir]/conf/nginx.conf</code> . <br><br>  Ahora abra su navegador y vaya a <code>localhost:80</code> .  Ver√° la p√°gina de la aplicaci√≥n React. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a50/b83/f39/a50b83f390ff0434ef817f357a041941.png"></div><br>  <i><font color="#999999">Reaccionar aplicaci√≥n servida por el servidor Nginx</font></i> <br><br>  Si escribe algo en el campo <code>Type your sentence</code> ahora y hace clic en el bot√≥n <code>Send</code> , no pasar√° nada.  Pero, si mira la consola, puede ver mensajes de error all√≠.  Para entender exactamente d√≥nde ocurren estos errores, analicemos el c√≥digo de la aplicaci√≥n. <br><br><h3>  <font color="#3AC1EF">‚ñçAn√°lisis del c√≥digo de aplicaci√≥n front-end</font> </h3><br>  <code>App.js</code> mirar el c√≥digo del archivo <code>App.js</code> , podemos ver que al hacer clic en el bot√≥n <code>Send</code> se llama al m√©todo <code>analyzeSentence()</code> .  El c√≥digo para este m√©todo se proporciona a continuaci√≥n.  Al mismo tiempo, preste atenci√≥n al hecho de que para cada l√≠nea para la cual hay un comentario del <code># </code> formulario, hay una explicaci√≥n debajo del c√≥digo.  Del mismo modo, analizaremos otras piezas de c√≥digo. <br><br><pre> <code class="plaintext hljs">analyzeSentence() {   fetch('http://localhost:8080/sentiment', {  // #1       method: 'POST',       headers: {           'Content-Type': 'application/json'       },       body: JSON.stringify({                      sentence: this.textField.getValue()})// #2   })       .then(response =&gt; response.json())       .then(data =&gt; this.setState(data));  // #3 }</code> </pre> <br>  <b>1.</b> URL en la que se ejecuta la solicitud POST.  Se entiende que esta direcci√≥n contiene una aplicaci√≥n que est√° esperando tales solicitudes. <br><br>  <b>2.</b> El cuerpo de la solicitud enviado a la aplicaci√≥n.  Aqu√≠ hay un ejemplo de cuerpo de solicitud: <br><br><pre> <code class="plaintext hljs">{   sentence: "I like yogobella!" }</code> </pre> <br>  <b>3.</b> Al recibir una respuesta a la solicitud, se actualiza el estado del componente.  Esto hace que el componente se vuelva a representar.  Si recibimos datos (es decir, un objeto JSON que contiene los datos ingresados ‚Äã‚Äãy la puntuaci√≥n de texto calculada), <code>Polarity</code> componente <code>Polarity</code> , ya que se cumplir√°n las condiciones correspondientes.  As√≠ es como describimos el componente: <br><br><pre> <code class="plaintext hljs">const polarityComponent = this.state.polarity !== undefined ?   &lt;Polarity sentence={this.state.sentence}             polarity={this.state.polarity}/&gt; :   null;</code> </pre> <br>  El c√≥digo parece estar funcionando bastante bien.  ¬øQu√© est√° mal aqu√≠, despu√©s de todo?  Si asume que en la direcci√≥n donde la aplicaci√≥n est√° tratando de enviar una solicitud POST, hasta ahora no hay nada que pueda aceptar y procesar esta solicitud, entonces tendr√° toda la raz√≥n.  Es decir, para procesar las solicitudes que llegan a la direcci√≥n <code>http://localhost:8080/sentiment</code> , necesitamos ejecutar una aplicaci√≥n web basada en Spring. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/848/f16/5a3/848f165a308f9ae73ffd3f8186b23aee.png"></div><br>  <i><font color="#999999">Necesitamos una aplicaci√≥n Spring que pueda aceptar una solicitud POST.</font></i> <br><br><h3>  <font color="#3AC1EF">‚ñç Configurar la aplicaci√≥n web basada en Spring</font> </h3><br>  Para implementar la aplicaci√≥n Spring, necesitar√° JDK8 y Maven y las variables de entorno configuradas correctamente.  Despu√©s de instalar todo esto, puede continuar trabajando en nuestro proyecto. <br><br><h3>  <font color="#3AC1EF">‚ñçPaquetear la aplicaci√≥n en un archivo jar</font> </h3><br>  Vaya, usando el terminal, a la carpeta <code>sa-webapp</code> e ingrese el siguiente comando: <br><br><pre> <code class="plaintext hljs">mvn install</code> </pre> <br>  Despu√©s de ejecutar este comando, el directorio de <code>target</code> se crear√° en la carpeta <code>sa-webapp</code> .  Habr√° una aplicaci√≥n Java empaquetada en un archivo jar representado por <code>sentiment-analysis-web-0.0.1-SNAPSHOT.jar</code> . <br><br><h3>  <font color="#3AC1EF">‚ñçInicie la aplicaci√≥n Java</font> </h3><br>  Vaya a la carpeta de <code>target</code> e inicie la aplicaci√≥n con el siguiente comando: <br><br><pre> <code class="plaintext hljs">java -jar sentiment-analysis-web-0.0.1-SNAPSHOT.jar</code> </pre> <br>  Se producir√° un error durante la ejecuci√≥n de este comando.  Para comenzar a solucionarlo, podemos analizar la informaci√≥n de excepci√≥n en los datos de seguimiento de la pila: <br><br><pre> <code class="plaintext hljs">Error creating bean with name 'sentimentController': Injection of autowired dependencies failed; nested exception is java.lang.IllegalArgumentException: Could not resolve placeholder 'sa.logic.api.url' in value "${sa.logic.api.url}"</code> </pre> <br>  Lo m√°s importante para nosotros aqu√≠ es la menci√≥n de la imposibilidad de determinar el significado de <code>sa.logic.api.url</code> .  Analicemos el c√≥digo en el que se produce el error. <br><br><h3>  <font color="#3AC1EF">‚ñç An√°lisis de c√≥digo de aplicaci√≥n Java</font> </h3><br>  Aqu√≠ est√° el fragmento de c√≥digo donde se produce el error. <br><br><pre> <code class="plaintext hljs">@CrossOrigin(origins = "*") @RestController public class SentimentController {   @Value("${sa.logic.api.url}")    // #1   private String saLogicApiUrl;   @PostMapping("/sentiment")   public SentimentDto sentimentAnalysis(       @RequestBody SentenceDto sentenceDto)   {       RestTemplate restTemplate = new RestTemplate();       return restTemplate.postForEntity(               saLogicApiUrl + "/analyse/sentiment",    // #2               sentenceDto, SentimentDto.class)               .getBody();   } }</code> </pre> <br><ol><li>  S <code>entimentController</code> tiene un campo <code>saLogicApiUrl</code> .  Su valor lo establece la propiedad <code>sa.logic.api.url</code> . </li><li>  La cadena <code>saLogicApiUrl</code> concatena con el valor <code>/analyse/sentiment</code> .  Juntos forman una direcci√≥n para acceder a un microservicio que realiza an√°lisis de texto. </li></ol><br><h3>  <font color="#3AC1EF">‚ñçConfigurar el valor de la propiedad</font> </h3><br>  En Spring, la fuente est√°ndar de valores de propiedad es el archivo <code>application.properties</code> , que se puede encontrar en <code>sa-webapp/src/main/resources</code> .  Pero su uso no es la √∫nica forma de establecer valores de propiedad.  Puede hacer esto con un comando como el siguiente: <br><br><pre> <code class="plaintext hljs">java -jar sentiment-analysis-web-0.0.1-SNAPSHOT.jar --sa.logic.api.url=WHAT.IS.THE.SA.LOGIC.API.URL</code> </pre> <br>  El valor de esta propiedad debe apuntar a la direcci√≥n de nuestra aplicaci√≥n Python. <br><br>  Al configurarlo, le decimos a la aplicaci√≥n web Spring d√≥nde debe ir para ejecutar solicitudes de an√°lisis de texto. <br><br>  Para no complicarnos la vida, decidimos que la aplicaci√≥n Python estar√° disponible en <code>localhost:5000</code> y tratamos de no olvidarnos de ella.  Como resultado, el comando para iniciar la aplicaci√≥n Spring se ver√° as√≠: <br><br><pre> <code class="plaintext hljs">java -jar sentiment-analysis-web-0.0.1-SNAPSHOT.jar --sa.logic.api.url=http://localhost:5000</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/30d/445/815/30d44581533865907366e867c029124e.png"></div><br>  <i><font color="#999999">Nuestro sistema carece de una aplicaci√≥n Python</font></i> <br><br>  Ahora solo tenemos que iniciar la aplicaci√≥n Python y el sistema funcionar√° como se espera. <br><br><h3>  <font color="#3AC1EF">‚ñçConfigurar una aplicaci√≥n Python</font> </h3><br>  Para ejecutar una aplicaci√≥n Python, debe tener Python 3 y Pip instalados, y debe configurar correctamente las variables de entorno adecuadas. <br><br><h3>  <font color="#3AC1EF">‚ñçInstalaci√≥n de dependencias</font> </h3><br>  Vaya a la carpeta del proyecto <code>sa-logic/sa</code> y ejecute los siguientes comandos: <br><br><pre> <code class="plaintext hljs">python -m pip install -r requirements.txt python -m textblob.download_corpora</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç Iniciar aplicaci√≥n</font> </h3><br>  Despu√©s de instalar las dependencias, estamos listos para iniciar la aplicaci√≥n: <br><br><pre> <code class="plaintext hljs">python sentiment_analysis.py</code> </pre> <br>  Despu√©s de ejecutar este comando, se nos informar√° lo siguiente: <br><br><pre> <code class="plaintext hljs">* Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)</code> </pre> <br>  Esto significa que la aplicaci√≥n se est√° ejecutando y est√° esperando solicitudes en <code>localhost:5000/</code> <br><br><h3>  <font color="#3AC1EF">‚ñç Investigaci√≥n de c√≥digo</font> </h3><br>  Considere el c√≥digo de la aplicaci√≥n Python para comprender c√≥mo responde a las solicitudes: <br><br><pre> <code class="plaintext hljs">from textblob import TextBlob from flask import Flask, request, jsonify app = Flask(__name__)                                   #1 @app.route("/analyse/sentiment", methods=['POST'])      #2 def analyse_sentiment():   sentence = request.get_json()['sentence']           #3   polarity = TextBlob(sentence).sentences[0].polarity #4   return jsonify(                                     #5       sentence=sentence,       polarity=polarity   ) if __name__ == '__main__':   app.run(host='0.0.0.0', port=5000)                #6</code> </pre> <br><ol><li>  Inicializando un objeto de <code>Flask</code> . </li><li>  Establecer la direcci√≥n para ejecutar solicitudes POST. </li><li>  Recuperando la propiedad de la <code>sentence</code> del cuerpo de la solicitud. </li><li>  Inicializando el objeto an√≥nimo <code>TextBlob</code> y obteniendo el valor de <code>polarity</code> para la primera oraci√≥n en el cuerpo de la solicitud (en nuestro caso, esta es la √∫nica oraci√≥n aprobada para el an√°lisis). </li><li>  El retorno de la respuesta, en cuyo cuerpo contiene el texto de la propuesta y el √≠ndice de <code>polarity</code> calculado para ella. </li><li>  Iniciando la aplicaci√≥n Flask, que estar√° disponible en <code>0.0.0.0:5000</code> (tambi√©n puede acceder a ella usando un <code>localhost:5000</code> construct). </li></ol><br>  Ahora se est√°n ejecutando los microservicios que componen la aplicaci√≥n.  Est√°n configurados para interactuar entre s√≠.  As√≠ es como se ve el diagrama de la aplicaci√≥n en esta etapa del trabajo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/75a/fcc/135/75afcc1352ed237efaf0a2280c2df295.png"></div><br>  <i><font color="#999999">Todos los microservicios que componen la aplicaci√≥n se llevan a un estado saludable.</font></i> <br><br>  Ahora, antes de continuar, abra la aplicaci√≥n React en un navegador e intente analizar alguna sugerencia al usarla.  Si todo se hace correctamente, despu√©s de hacer clic en el bot√≥n <code>Send</code> , ver√° los resultados del an√°lisis debajo del cuadro de texto. <br><br>  En la siguiente secci√≥n, hablaremos sobre c√≥mo ejecutar nuestros microservicios en contenedores Docker.  Esto es necesario para preparar la aplicaci√≥n para su lanzamiento en el cl√∫ster de Kubernetes. <br><br><h2>  <font color="#3AC1EF">Contenedores Docker</font> </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kubernetes</a> es un sistema para automatizar la implementaci√≥n, el escalado y la administraci√≥n de aplicaciones en contenedores.  Tambi√©n se le llama el "orquestador de contenedores".  Si Kubernetes trabaja con contenedores, primero debemos adquirir estos contenedores antes de usar este sistema.  Pero primero, hablemos sobre qu√© son los contenedores.  Quiz√°s la mejor respuesta a la pregunta de qu√© se puede encontrar en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> de Docker: <br><br>  <i>Una imagen de contenedor es un paquete liviano, independiente y ejecutable que contiene alg√∫n tipo de aplicaci√≥n que incluye todo lo que necesita para ejecutarlo: c√≥digo de aplicaci√≥n, tiempo de ejecuci√≥n, herramientas del sistema y bibliotecas, configuraciones.</i>  <i>Los programas en contenedores se pueden usar en entornos Linux y Windows, y siempre funcionar√°n igual independientemente de la infraestructura.</i> <br><br>  Esto significa que los contenedores se pueden ejecutar en cualquier computadora, incluidos los servidores de producci√≥n, y en cualquier entorno las aplicaciones incluidas funcionar√°n de la misma manera. <br><br>  Para explorar las caracter√≠sticas de los contenedores y compararlos con otras formas de iniciar aplicaciones, considere un ejemplo de servir una aplicaci√≥n React utilizando una m√°quina virtual y un contenedor. <br><br><h3>  <font color="#3AC1EF">‚ñçServir archivos est√°ticos de aplicaciones React usando una m√°quina virtual</font> </h3><br>  Al tratar de organizar el mantenimiento de archivos est√°ticos por medio de m√°quinas virtuales, encontraremos las siguientes desventajas: <br><br><ol><li>  Uso ineficiente de los recursos, ya que cada m√°quina virtual es un sistema operativo completo. </li><li>  Depende de la plataforma.  Lo que funciona en una determinada computadora local puede no funcionar en un servidor de producci√≥n. </li><li>  Escalado lento e intensivo en recursos de una soluci√≥n basada en m√°quina virtual. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c26/927/523/c26927523b6072ce65bfaf8b01a1e330.png"></div><br>  <i><font color="#999999">Servidor web de servidor est√°tico Nginx que se ejecuta en una m√°quina virtual</font></i> <br><br>  Si se usan contenedores para resolver un problema similar, entonces, en comparaci√≥n con las m√°quinas virtuales, se pueden observar sus siguientes puntos fuertes: <br><br><ol><li>  Uso eficiente de los recursos: trabajando con el sistema operativo usando Docker. </li><li>  Independencia de la plataforma.  Un contenedor que un desarrollador pueda ejecutar en su computadora funcionar√° en cualquier lugar. </li><li>  Despliegue ligero a trav√©s del uso de capas de imagen. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/28b/593/b01/28b593b01ce003c246843d9c9f2bd05f.png"></div><br>  <i><font color="#999999">Servidor web del servidor est√°tico Nginx que se ejecuta en un contenedor</font></i> <br><br>  Comparamos m√°quinas virtuales y contenedores en solo unos pocos puntos, pero incluso esto es suficiente para sentir las fortalezas de los contenedores.  Obtenga m√°s informaci√≥n sobre los contenedores Docker aqu√≠. <br><br><h3>  <font color="#3AC1EF">‚ñç Ensamblar una imagen de contenedor para una aplicaci√≥n React</font> </h3><br>  El bloque de construcci√≥n principal del contenedor Docker es el <code>Dockerfile</code> .  Al comienzo de este archivo, haga un registro de la imagen b√°sica del contenedor, luego incluya una secuencia de instrucciones que indique el orden en que se crear√° el contenedor que satisfaga las necesidades de una determinada aplicaci√≥n. <br><br>  Antes de comenzar a trabajar con el archivo <code>Dockerfile</code> , recordemos lo que hicimos para preparar los archivos de la aplicaci√≥n React para cargarlos en el servidor Nginx: <br><br><ol><li>  Cree un paquete de aplicaci√≥n React ( <code>npm run build</code> ). </li><li>  Iniciando el servidor Nginx. </li><li>  Copie el contenido del directorio de <code>build</code> de la carpeta del proyecto <code>sa-frontend</code> a la carpeta del servidor <code>nginx/html</code> . </li></ol><br>  A continuaci√≥n puede ver los paralelos entre la creaci√≥n del contenedor y las acciones anteriores realizadas en la computadora local. <br><br><h3>  <font color="#3AC1EF">‚ñçPreparaci√≥n de un Dockerfile para SA-Frontend</font> </h3><br>  Las instrucciones que se incluir√°n en el <code>Dockerfile</code> para la aplicaci√≥n <code>SA-Frontend</code> consisten en solo dos comandos.  El hecho es que el equipo de desarrollo de Nginx prepar√≥ una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">imagen</a> b√°sica para Nginx, que usaremos para crear nuestra imagen.  Estos son los dos pasos que debemos describir: <br><br><ol><li>  La base de la imagen que necesita para hacer la imagen de Nginx. </li><li>  El contenido de la carpeta <code>sa-frontend/build</code> debe copiarse en la carpeta de im√°genes <code>nginx/html</code> . </li></ol><br>  Si pasamos de esta descripci√≥n al <code>Dockerfile</code> , se ver√° as√≠: <br><br><pre> <code class="plaintext hljs">FROM nginx COPY build /usr/share/nginx/html</code> </pre> <br>  Como puede ver, aqu√≠ todo es muy simple, mientras que el contenido del archivo es incluso bastante legible y comprensible.  Este archivo le dice al sistema que tome la imagen <code>nginx</code> con todo lo que ya tiene y que copie el contenido del directorio de <code>build</code> directorio <code>nginx/html</code> . <br><br>  Aqu√≠ puede tener una pregunta sobre d√≥nde s√© exactamente d√≥nde necesito copiar los archivos de la carpeta de <code>build</code> , es decir, de d√≥nde vino la ruta <code>/usr/share/nginx/html</code> .  De hecho, y no hay nada complicado.  El hecho es que la informaci√≥n relevante se puede encontrar en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">descripci√≥n de la</a> imagen. <br><br><h3>  <font color="#3AC1EF">‚ñçCrear una imagen y subirla al repositorio</font> </h3><br>  Antes de que podamos trabajar con la imagen terminada, debemos enviarla al repositorio de im√°genes.  Para hacer esto, utilizaremos la plataforma en la nube gratuita para alojar im√°genes de Docker Hub.  En esta etapa del trabajo, debe hacer lo siguiente: <br><br><ol><li>  Instalar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Docker</a> . </li><li>  Reg√≠strese en el sitio web de Docker Hub. </li><li>  Inicie sesi√≥n en la cuenta ejecutando el siguiente comando en la terminal: <br><br><pre> <code class="plaintext hljs">docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"</code> </pre> </li></ol><br>  Ahora necesita usar el terminal para ir al directorio <code>sa-frontend</code> y ejecutar el siguiente comando all√≠: <br><br><pre> <code class="plaintext hljs">docker build -f Dockerfile -t $DOCKER_USER_ID/sentiment-analysis-frontend .</code> </pre> <br>  En lo sucesivo, en comandos similares, <code>$DOCKER_USER_ID</code> debe reemplazarse con su nombre de usuario en Docker Hub.  Por ejemplo, esta parte del comando podr√≠a verse as√≠: <code>rinormaloku/sentiment-analysis-frontend</code> . <br><br>  Al mismo tiempo, este comando puede acortarse eliminando <code>-f Dockerfile</code> , ya que este archivo ya existe en la carpeta en la que ejecutamos este comando. <br><br>  Para enviar la imagen terminada al repositorio, necesitamos el siguiente comando: <br><br><pre> <code class="plaintext hljs">docker push $DOCKER_USER_ID/sentiment-analysis-frontend</code> </pre> <br>  Despu√©s de su ejecuci√≥n, verifique la lista de sus repositorios en Docker Hub para comprender si la imagen se envi√≥ a la nube con √©xito. <br><br><h3>  <font color="#3AC1EF">‚ñçIniciar contenedor</font> </h3><br>  Ahora cualquiera puede descargar y ejecutar una imagen conocida como <code>$DOCKER_USER_ID/sentiment-analysis-frontend</code> .  Para hacer esto, debe ejecutar la siguiente secuencia de comandos: <br><br><pre> <code class="plaintext hljs">docker pull $DOCKER_USER_ID/sentiment-analysis-frontend docker run -d -p 80:80 $DOCKER_USER_ID/sentiment-analysis-frontend</code> </pre> <br>  Ahora se inicia el contenedor y podemos seguir trabajando, creando las otras im√°genes que necesitamos.  Pero, antes de continuar, echemos un <code>80:80</code> construcci√≥n <code>80:80</code> , que se encuentra en el comando de inicio de imagen y puede parecer incomprensible. <br><br><ul><li>  El primer n√∫mero <code>80</code> es el n√∫mero de puerto del host (es decir, la computadora local). </li><li>  El segundo n√∫mero <code>80</code> es el puerto del contenedor al que se debe redirigir la solicitud. </li></ul><br>  Considere la siguiente ilustraci√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/775/394/6cd/7753946cde3287113b82f00921ced889.png"></div><br>  <i><font color="#999999">Reenv√≠o de puertos</font></i> <br><br>  El sistema redirige las solicitudes desde el puerto <code>&lt;hostPort&gt;</code> puerto <code>&lt;containerPort&gt;</code> .  Es decir, el acceso al puerto <code>80</code> computadora se redirige al puerto <code>80</code> contenedor. <br><br>  Como el puerto <code>80</code> abierto en la computadora local, puede acceder a la aplicaci√≥n desde esta computadora en <code>localhost:80</code> .  Si su sistema no es compatible con Docker, puede ejecutar la aplicaci√≥n en la m√°quina virtual Docker, cuya direcci√≥n se ver√° como <code>&lt;docker-machine ip&gt;:80</code> .  Para averiguar la direcci√≥n IP de la m√°quina virtual Docker, puede usar el <code>docker-machine ip</code> . <br><br>  En esta etapa, despu√©s de iniciar con √©xito el contenedor de la aplicaci√≥n frontend, deber√≠a poder abrir su p√°gina en un navegador. <br><br><h3>  <font color="#3AC1EF">‚ñç archivo .dockerignore</font> </h3><br>  Al recopilar la imagen de la aplicaci√≥n <code>SA-Frontend</code> , podr√≠amos notar que este proceso es extremadamente lento.  Esto sucede debido al hecho de que el contexto de compilaci√≥n de la imagen debe enviarse al demonio Docker.  El directorio que representa el contexto de compilaci√≥n se especifica mediante el √∫ltimo argumento del <code>docker build</code> .  En nuestro caso, al final de este comando es un punto.  Esto da como resultado que la siguiente estructura se incluya en el contexto del ensamblaje: <br><br><pre> <code class="plaintext hljs">sa-frontend: |   .dockerignore |   Dockerfile |   package.json |   README.md +---build +---node_modules +---public \---src</code> </pre> <br>  Pero de todas las carpetas presentes aqu√≠, solo necesitamos la carpeta de <code>build</code> .  Descargar cualquier otra cosa es una p√©rdida de tiempo.  Las compilaciones pueden acelerarse dici√©ndole a Docker qu√© directorios ignorar.  Es para hacer esto que necesitamos un archivo <code>.dockerignore</code> .  Si est√° familiarizado con el archivo <code>.gitignore</code> , la estructura de este archivo seguramente le resultar√° familiar.  Enumera los directorios que el sistema de ensamblaje de im√°genes puede ignorar.  En nuestro caso, el contenido de este archivo se ve as√≠: <br><br><pre> <code class="plaintext hljs">node_modules src public</code> </pre> <br>  El archivo <code>.dockerignore</code> debe estar en la misma carpeta que el <code>Dockerfile</code> .  Ahora ensamblar la imagen tomar√° unos segundos. <br><br>  Ahora echemos un vistazo a la aplicaci√≥n Java. <br><br><h3> <font color="#3AC1EF">‚ñç    Java-</font> </h3><br>  ,           .       . <br><br>   <code>Dockerfile</code> ,      <code>sa-webapp</code> .      ,         ,     <code>ENV</code>  <code>EXPOSE</code> : <br><br><pre> <code class="plaintext hljs">ENV SA_LOGIC_API_URL http://localhost:5000 ‚Ä¶ EXPOSE 8080</code> </pre> <br>   <code>ENV</code>       Docker.  ,       URL    API ,   . <br><br>   <code>EXPOSE</code>   Docker  ,    .          .   ,   <code>Dockerfile</code>   <code>SA-Frontend</code>   .      ,  ,     ,    <code>Dockerfile</code> . <br><br>           ,    .           ‚Äî       <code>README.md</code>   <code>sa-webapp</code> . <br><br><h3> <font color="#3AC1EF">‚ñç    Python-</font> </h3><br>       <code>Dockerfile</code>   <code>sa-logic</code> ,         .               ,  ,        ,     <code>README.md</code>   <code>sa-logic</code> . <br><br><h3> <font color="#3AC1EF">‚ñç  </font> </h3><br>     - ,    ?    .   . <br><br><ol><li>    <code>sa-logic</code>       <code>5050</code> : <br><br><pre> <code class="plaintext hljs">docker run -d -p 5050:5000 $DOCKER_USER_ID/sentiment-analysis-logic</code> </pre> </li><li>    <code>sa-webapp</code>       <code>8080</code> .  ,    ,   Python-     Java-,    <code>SA_LOGIC_API_URL</code> : <br><br><pre> <code class="plaintext hljs">$ docker run -d -p 8080:8080 -e SA_LOGIC_API_URL='http://&lt;container_ip or docker machine ip&gt;:5000' $DOCKER_USER_ID/sentiment-analysis-web-app</code> </pre> </li></ol><br>      ,   IP-     Docker ‚Äî    <a href="">README</a> . <br><br>    <code>sa-frontend</code> : <br><br><pre> <code class="plaintext hljs">docker run -d -p 80:80 $DOCKER_USER_ID/sentiment-analysis-frontend</code> </pre> <br>     ,       <code>localhost:80</code>   . <br><br>    ,       <code>sa-webapp</code> ,        Docker,     <code>App.js</code>   <code>sa-frontend</code> ,  IP-      <code>analyzeSentence()</code> ,      .         . <br><br>       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/796/71e/87a/79671e87adea76c8873cac180e2fe8c0.png"></div><br> <i><font color="#999999">   </font></i> <br><br><h2> <font color="#3AC1EF">:    Kubernetes?</font> </h2><br>      <code>Dockerfile</code> ,   ,         Docker.  ,     ,   <code>.dockerignore</code> .         Docker.          ,   Kubernetes.          .      : <br> ,   -      .       .  ,   <code>sa-webapp</code>  <code>sa-logic</code>     .   ,    ? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/438982/">https://habr.com/ru/post/438982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../438972/index.html">El cerebro desde adentro (visualizaci√≥n del paso del patr√≥n a trav√©s del modelo de red neuronal artificial)</a></li>
<li><a href="../438974/index.html">La realidad virtual ayuda a lidiar con los trastornos mentales</a></li>
<li><a href="../438976/index.html">El libro "Primavera. Todos los patrones de dise√±o ¬ª</a></li>
<li><a href="../438978/index.html">¬°Aprendiendo siempre y en todas partes! Podcasts para desarrolladores en ingl√©s</a></li>
<li><a href="../438980/index.html">Spring Boot 2: ¬øqu√© hay de nuevo?</a></li>
<li><a href="../438984/index.html">Gu√≠a de Kubernetes, Parte 2: Crear y trabajar con un cl√∫ster</a></li>
<li><a href="../438986/index.html">React Tutorial Parte 14: Taller sobre componentes basados ‚Äã‚Äãen la clase, estado de los componentes</a></li>
<li><a href="../438988/index.html">Tutorial de React Parte 15: Talleres estatales de componentes</a></li>
<li><a href="../438992/index.html">Diario del desarrollador o malas decisiones</a></li>
<li><a href="../438994/index.html">Intel Xeon W-3175X, un baterista de moda. Prueba</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>