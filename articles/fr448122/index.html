<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õµÔ∏è üõ¨ üó≥Ô∏è Comment ReactJS fonctionne Forfait React üßô üíé üßôüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La plupart des personnes travaillant dans le frontend, d'une mani√®re ou d'une autre, ont rencontr√© une r√©action. Il s'agit d'une biblioth√®que JavaScri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment ReactJS fonctionne Forfait React</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448122/"><p> La plupart des personnes travaillant dans le frontend, d'une mani√®re ou d'une autre, ont rencontr√© une r√©action.  Il s'agit d'une biblioth√®que JavaScript qui aide √† cr√©er des interfaces sympas; ces derni√®res ann√©es, elle a gagn√© en popularit√©.  Cependant, peu de gens savent comment cela fonctionne √† l'int√©rieur. </p><br><p> Dans cette s√©rie d'articles, nous lisons le code et essayons de comprendre de quoi sont responsables les paquets qui se trouvent sous le capot de React, √† quoi ils servent et comment ils fonctionnent.  Les plus basiques que nous utilisons dans le navigateur sont <code>react</code> , <code>react-dom</code> , <code>events</code> et <code>react-reconciler</code> . </p><br><p>  Nous allons avancer dans l'ordre et nous avons aujourd'hui un article sur le paquet <code>react</code> .  Peu importe ce qui est dans ce paquet - passez sous le chat. </p><a name="habracut"></a><br><p>  Tout d'abord, nous allons faire un petit exemple, sur la base duquel nous consid√©rerons ce paquet.  Notre gadget ressemblera √† ceci: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [text, changeText] = React.useState(<span class="hljs-string"><span class="hljs-string">'Initial'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"app"</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;span&gt;{text}&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/span&gt; &lt;input type="text" value={text} onInput={(e) =&gt; changeText(e.target.value)} /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; ); } ReactDOM.render( &lt;App /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">document</span></span></span></span><span class="hljs-function"><span class="hljs-params">.getElementById(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'root'</span></span></span></span></span><span class="hljs-function">) ) ;</span></span></code> </pre> <br><p>  Jetons un coup d'≈ìil √† ce morceau de code.  Ici, nous voyons l'appel du hook via <code>React.useState('Initial')</code> , un peu de JSX et l'appel de la m√©thode de rendu pour obtenir tout cela sur la page. <br>  En fait, comme beaucoup de gens le savent, ce n'est pas le code final que le navigateur traite.  Avant d'√™tre ex√©cut√©, il est transpil√©, par exemple, avec un babel.  Dans ce cas, ce que la fonction retourne se transformera en ce qui suit: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> React.createElement( <span class="hljs-string"><span class="hljs-string">"div"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">className</span></span>: <span class="hljs-string"><span class="hljs-string">"app"</span></span> }, React.createElement(<span class="hljs-string"><span class="hljs-string">"span"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, text), React.createElement(<span class="hljs-string"><span class="hljs-string">"input"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">"text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: text, <span class="hljs-attr"><span class="hljs-attr">onInput</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onInput</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> changeText(e.target.value); } }) );</code> </pre> <br><p>  Qui se soucie d'exp√©rimenter et de voir en quoi votre code <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">babel</a> se transforme - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">babel repl</a> . </p><br><h3 id="reactcreateelement">  React.createElement </h3><br><p>  Nous avons donc eu beaucoup d'appels √† <code>React.createElement()</code> et du temps pour voir ce que fait cette fonction.  Nous le d√©crirons en mots (ou vous pouvez √©galement consulter le fichier - <a href="">ReactElement.js</a> ). </p><br><p>  Tout d'abord, il v√©rifie si nous avons des accessoires (dans le code, l'objet avec des accessoires que nous avons pass√© s'appelle <code>config</code> ). </p><br><p>  Ensuite, nous v√©rifions si nous avons <code>key</code> accessoires <code>key</code> et <code>ref</code> qui ne sont pas <code>undefined</code> , et les enregistrons, le cas √©ch√©ant. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasValidKey(config)) { key = <span class="hljs-string"><span class="hljs-string">''</span></span> + config.key; }</code> </pre> <br><p>  Un point int√©ressant est que <code>config.key</code> est <code>config.key</code> cha√Æne, ce qui signifie que vous pouvez passer n'importe quel type de donn√©es sous forme de cl√©, l'essentiel est qu'il impl√©mente la <code>.toString()</code> ou <code>.valueOf()</code> et renvoie une valeur unique √† un ensemble particulier. </p><br><p>  Voici les √©tapes suivantes: </p><br><ul><li>  copier les accessoires qui ont √©t√© transmis √† l'√©l√©ment; </li><li>  ajoutez-y le champ <code>children</code> si nous les avons pass√©s non pas avec des accessoires, mais comme √©l√©ment imbriqu√©; </li><li>  nous d√©finissons les valeurs par d√©faut de <code>defaultProps</code> pour les propri√©t√©s que nous n'avons pas <code>defaultProps</code> pr√©c√©demment. </li></ul><br><p>  Lorsque nous avons pr√©par√© toutes les donn√©es, nous appelons une fonction interne qui cr√©e un objet qui d√©crit notre composant.  Cet objet ressemble √† ceci: </p><br><pre> <code class="plaintext hljs">{ // This tag allows us to uniquely identify this as a React Element $$typeof: REACT_ELEMENT_TYPE, // Symbol // Built-in properties that belong on the element type: type, key: key, ref: ref, props: props, // Record the component responsible for creating this element. _owner: owner, }</code> </pre> <br><p>  Ici, nous avons la propri√©t√© <code>$$typeof</code> , qui est un symbole, alors glissez de toute fa√ßon quel objet √©chouera. </p><br><p>  La propri√©t√© <code>type</code> stocke le type de l'√©l√©ment √† cr√©er.  Dans le cas de notre exemple, ce sera la fonction <code>App()</code> et les lignes <code>'div'</code> , <code>'span'</code> et <code>'input'</code> . </p><br><p>  La propri√©t√© <code>key</code> contiendra la m√™me cl√©, √† cause de laquelle les warings volent vers la console. <br>  Les accessoires contiendront ce que nous avons transmis, les <code>children</code> et ce qui a √©t√© sp√©cifi√© dans <code>defaultProps</code> .  La propri√©t√© <code>_owner</code> n√©cessaire pour un travail correct avec <code>ref</code> . </p><br><p>  Traduit dans notre exemple, le r√©sultat de <code>React.createElement(App, null)</code> ressemblera √† ceci: </p><br><pre> <code class="plaintext hljs">{ $$typeof: REACT_ELEMENT_TYPE, type: App, key: null, ref: null, props: {}, _owner: null, }</code> </pre> <br><p>  De plus, en mode dev, nous aurons un champ suppl√©mentaire qui sera utilis√© pour afficher une belle pile avec le nom et la ligne du fichier: </p><br><pre> <code class="javascript hljs">_source: { <span class="hljs-attr"><span class="hljs-attr">fileName</span></span>: <span class="hljs-string"><span class="hljs-string">"/Users/appleseed/react-example/src/index.js"</span></span>, <span class="hljs-attr"><span class="hljs-attr">lineNumber</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> }</code> </pre> <br><p><img src="https://habrastorage.org/webt/l6/gm/fz/l6gmfzluaizdzwt-ywbhhpy8cui.png" alt="erreur de pile r√©agir"></p><br><p>  Pour r√©sumer un peu ce que nous avons vu ci-dessus.  Le package <code>react</code> agit comme un traducteur entre nous et le reste des packages qui travaillent plus loin sur notre application, traduisant nos appels en mots compr√©hensibles, par exemple, pour le r√©conciliateur. </p><br><h3 id="reactusestate">  React.useState </h3><br><p>  Dans la version 16.8, des crochets sont apparus.  Qu'est-ce que c'est et comment l'utiliser, vous pouvez lire le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> , mais maintenant nous regardons ce qui se trouve dans le paquet <code>react</code> . </p><br><p>  En fait, il n'y a pas grand-chose √† dire.  En substance, un package est une fa√ßade √† travers laquelle nos d√©fis vont aux entit√©s internes. </p><br><p>  Ainsi, <code>useState</code> n'est rien de plus que deux lignes de code: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">useState</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">S</span></span></span><span class="hljs-function">&gt;(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState: ((</span></span></span><span class="hljs-function">) =&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">S</span></span></span><span class="hljs-function">) | </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">S</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dispatcher = resolveDispatcher(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dispatcher.useState(initialState); }</code> </pre> <br><p>  Les crochets restants sont presque identiques.  Ici, nous obtenons le r√©partiteur actuel, qui est un objet et contient des champs, par exemple <code>useState</code> .  Ce r√©partiteur change selon que nous avons le premier rendu maintenant ou que nous voulons simplement mettre √† jour le composant. </p><br><p>  L'impl√©mentation r√©elle des hooks est stock√©e dans le package <code>react-reconciler</code> , dont nous parlerons dans l'un des articles suivants. </p><br><h3 id="chto-dalshe">  Et ensuite </h3><br><p>  Encore une chose.  Apr√®s avoir lu cet article, vous pouvez comprendre pourquoi nous importons toujours le package react, m√™me si nous ne l'utilisons pas directement.  Ceci est n√©cessaire pour qu'apr√®s avoir dig√©r√© notre jsx par la bulle, nous ayons une variable <code>React</code> . </p><br><p>  Les gars de l'√©quipe <code>createElement</code> pris soin de cela (et pas seulement) et travaillent maintenant √† remplacer <code>createElement</code> . </p><br><p>  Essayer d'expliquer en un mot: il y a un d√©sir de remplacer la m√©thode actuelle de cr√©ation d'√©l√©ments par deux - <code>jsx</code> et <code>jsxs</code> .  Cela est n√©cessaire pour plusieurs raisons: </p><br><ul><li>  nous avons discut√© ci-dessus comment fonctionne <code>createElement</code> .  Il copie constamment les accessoires et ajoute le champ <code>children</code> √† l'objet, dans lequel il enregistre les enfants que nous avons pass√©s comme arguments √† la fonction (3 arguments et plus).  Il est maintenant propos√© de le faire au stade de la conversion des <code>jsx</code> en <code>javascript</code> , car la cr√©ation d'un √©l√©ment est une fonction souvent appel√©e et il n'est pas libre d'effectuer √† chaque fois la modification des accessoires lors de l'ex√©cution; </li><li>  vous pouvez vous d√©barrasser de l'importation de l'objet <code>React</code> et importer uniquement des fonctions sp√©cifiques ( <code>import { jsx } from 'react'</code> , par exemple) et, en cons√©quence, ne pas pouvoir ajouter √† l'assembly ce que nous n'utilisons pas.  De plus, vous n'avez pas √† r√©soudre le champ <code>createElement</code> de l'objet <code>React</code> chaque fois, car il n'est pas non plus libre; </li><li>  Nous avons discut√© ci-dessus que nous avons un cas particulier lorsque nous retirons la <code>key</code> des accessoires et la faisons avancer.  Il est maintenant propos√© de prendre la <code>key</code> de <code>jsx</code> √† l'√©tape de transpiling et de lui passer le troisi√®me param√®tre √† la fonction de cr√©ation d'√©l√©ment. </li></ul><br><p>  Lisez plus <a href="">ici</a> .  Le package <code>jsx</code> poss√®de d√©j√† les <code>jsxs</code> <code>jsx</code> et <code>jsxs</code> .  Si vous souhaitez jouer avec cela, vous pouvez cloner le r√©f√©rentiel <code>enableJSXTransformAPI</code> , d√©finir l'indicateur <code>enableJSXTransformAPI</code> sur <code>true</code> dans le fichier <code>ReactFeatureFlags.js</code> du package <code>shared</code> et compiler votre version de react ( <code>yarn build</code> ) avec la nouvelle API activ√©e. </p><br><h3 id="final">  Finale </h3><br><p>  √Ä ce sujet, je terminerai l'histoire d'aujourd'hui sur le package <code>react</code> et la prochaine fois nous parlerons de la fa√ßon dont le package <code>react-dom</code> utilise ce que <code>react</code> cr√©e, et quelles m√©thodes et comment il impl√©mente. </p><br><p>  Merci d'avoir lu jusqu'au bout! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448122/">https://habr.com/ru/post/fr448122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448110/index.html">Solutions mat√©rielles de s√©curit√© de l'information USB sur IP</a></li>
<li><a href="../fr448114/index.html">8. Check Point Getting Started R80.20. NAT</a></li>
<li><a href="../fr448116/index.html">Disque hybride Intel Optane Memory H10 - Sp√©cifications des fonctionnalit√©s</a></li>
<li><a href="../fr448118/index.html">SEO et publicit√© contextuelle - conduit pour 175 mille roubles par jour √† Izhevsk</a></li>
<li><a href="../fr448120/index.html">√Ä propos de la proximit√© des sommets</a></li>
<li><a href="../fr448124/index.html">Mikrotik. Contr√¥le SMS √† l'aide du serveur WEB</a></li>
<li><a href="../fr448126/index.html">Secrets de l'API des appareils Android. Rapport Yandex</a></li>
<li><a href="../fr448128/index.html">9 conseils pour utiliser la biblioth√®que Cats √† Scala</a></li>
<li><a href="../fr448130/index.html">Conception de deckbuilding de jeux vid√©o</a></li>
<li><a href="../fr448136/index.html">Instructions: comment tester les r√¥les ansibles et d√©couvrir les probl√®mes avant la production</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>