<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õèÔ∏è üßú ü§πüèΩ Fischnetzf√§lle - wie Microsoft Azure bei der Durchf√ºhrung eines Phishing-Angriffs hilft üë®üèΩ‚Äçüç≥ üõåüèª üçÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir ver√∂ffentlichen einen Artikel, der den Spuren unserer Leistung auf der Fast Track OFFZONE-2019 folgt, mit dem Bericht ‚ÄûFishnet-Gesch√§fte - wie Mic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fischnetzf√§lle - wie Microsoft Azure bei der Durchf√ºhrung eines Phishing-Angriffs hilft</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458364/">  Wir ver√∂ffentlichen einen Artikel, der den Spuren unserer Leistung auf der Fast Track OFFZONE-2019 folgt, mit dem Bericht ‚ÄûFishnet-Gesch√§fte - wie Microsoft Azure bei der Durchf√ºhrung eines Phishing-Angriffs hilft‚Äú. <br><br>  Bei einem Phishing-Angriff mit der Verteilung b√∂sartiger Anh√§nge besteht das Hauptproblem darin, Spamfilter auf dem Mailserver des Opfers zu umgehen.  Viele Unternehmen haben E-Mails in der Microsoft-Cloud. Sie m√ºssen also wirklich ein Mailinglisten-Guru sein, damit ein b√∂swilliger Anhang an von Microsoft geschulten Spam-Filtern vorbeigeht. <br><br>  Bei der Durchf√ºhrung von RedTeam versuchen wir, legale Mittel zu verwenden, die Benutzer verwenden.  Zum Beispiel hilft uns das Vorhandensein eines VPN-Dienstes im Unternehmen, mit Benutzerrechten in das Unternehmen einzusteigen und gleichzeitig ein Minimum an Verdacht (oder gar keinen Grund) zu verursachen. <br><br>  Es gab eine Idee, wie Microsoft uns helfen kann.  Wir haben uns angesehen, welche Art von Schutz Microsoft bietet, und uns entschlossen, herauszufinden, um welche Art von Tier es sich bei Azure Information Protection handelt. <br><a name="habracut"></a><br><h3>  Azure-Informationsschutz </h3><br>  In dieser Studie werden wir uns mit Azure Information Protection (AIP) befassen, einem Tool, mit dem Sie Dokumente nach Vertraulichkeitsgraden klassifizieren und den Zugriff auf sie f√ºr verschiedene Benutzer der Organisation einschr√§nken k√∂nnen. <br><br>  Es ist sehr einfach zu bedienen - Software wird heruntergeladen, mit deren Hilfe bestimmte Rechte f√ºr jedes Dokument festgelegt werden k√∂nnen.  Labels und Datenschutzstufen werden f√ºr jedes Unternehmen konfiguriert - der Administrator hat solche Rechte und Pflichten.  Standardm√§√üig werden nur zwei Ebenen erstellt - Vertraulich und Sehr Vertraulich. <br><br><img src="https://habrastorage.org/webt/rx/3y/83/rx3y83hdtlaigtb2gyj8-7x8gjk.png"><br><br>  Es ist auch m√∂glich, einzelnen Benutzern Zugriff zu gew√§hren und ihnen Nutzungsrechte f√ºr das Dokument zuzuweisen.  Wenn Sie beispielsweise einen bestimmten Benutzer ben√∂tigen, um nichts in einem Dokument √§ndern zu k√∂nnen, aber um Informationen zu erhalten, k√∂nnen Sie den Viewer-Modus speziell f√ºr ihn festlegen. <br><br><img src="https://habrastorage.org/webt/oj/ci/3b/ojci3b_7akd9_4414puo1jf0yjq.png"><br><br>  Azure Information Protection ist in Office365 integriert und der Benutzer ben√∂tigt keine zus√§tzliche Software, um das Dokument zu √∂ffnen und die zul√§ssigen Aktionen damit auszuf√ºhren (vom Lesen bis zur Bearbeitung und vollst√§ndigen Rechten am Dokument). <br><br>  Wenn Sie AIP nicht f√ºr Office365 verwenden, hat das gesch√ºtzte Dokument die Erweiterung pfile und kann ohne den Azure Information Protection Viewer nicht ge√∂ffnet werden. <br>  Im Allgemeinen schien die L√∂sung interessant und wir beschlossen, eine Studie durchzuf√ºhren. <br><br>  F√ºr die Forschung brauchen wir: <br><br><ul><li>  W√§hlen und registrieren Sie ein geeignetes Microsoft-Konto f√ºr uns </li><li>  2 Unternehmen registrieren (Angreifer und Opfer) </li><li>  Erstellen Sie ein sch√§dliches Dokument, das wir in einer Phishing-E-Mail senden </li></ul><br><h3>  Registrierung eines Microsoft-Kontos </h3><br>  F√ºr diese Studie haben wir ein Microsoft-Gesch√§ftskonto ausgew√§hlt, da es √ºber Azure Information Protection verf√ºgt.  AIP ist auch in anderen Tarifpl√§nen enthalten, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> zu finden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sind</a> . <br><br>  Wir werden nicht im Detail beschreiben, auf welche Schwierigkeiten bei der Registrierung eines Kontos gesto√üen war.  Wir werden kurz schreiben - aus Russland ist es unm√∂glich, selbst ein Gesch√§ftskonto zu registrieren.  Alles wegen Sanktionen.  Sie k√∂nnen sich jedoch an Partner wenden (offizielle Unternehmen, davon gibt es 4 in Russland) oder sich im Urlaub aus Europa anmelden, nachdem Sie dort zuvor eine lokale SIM-Karte gekauft haben. <br><br>  Registrierte 2 Unternehmen.  1 Unternehmen - das Opferunternehmen MyMetalCompany mit der Domain mymetalcompany.club und zwei Benutzern - Petr Petrov, Vasya Vasechkin.  Die Opferfirma verwendet kein AIP. <br><br><img src="https://habrastorage.org/webt/y5/vn/sm/y5vnsmscgh6ujw-0aun3wwnwrts.png"><br><br>  2 Unternehmen - das angreifende Unternehmen - Gem Company mit einer Standarddomain von Microsoft - gemcompany.onmicrosoft.com und dem einzigen Benutzer - Evil User, der Phishing-E-Mails an Petrov und Vasechkin sendet. <br><br><img src="https://habrastorage.org/webt/qc/c1/hy/qcc1hygeifu80o-wgtvykdpr-10.png"><br><br>  Evil User f√ºhrt ein Experiment mit einem sch√§dlichen Dokument durch, das als DDEDownloader klassifiziert ist - ein Dokument mit einem integrierten Link, √ºber das das Power Shell-Skript heruntergeladen und √ºber die Befehlszeile gestartet wird.  Gem Company verwendet AIP. <br><br><h3>  Testen </h3><br>  Erinnern Sie sich daran, dass unser Hauptziel darin besteht, das sch√§dliche Dokument dazu zu bringen, Spamfilter zu passieren und den Benutzer im Posteingangsordner zu erreichen. <br><br>  Als erstes muss √ºberpr√ºft werden, ob ein sch√§dliches Dokument beim Benutzer eintrifft, wenn wir es in der sogenannten "sauberen Form" senden.  Wir werden das gerade von Evil User erstellte Dokument an den Genossen Vasechkin senden. <br><br>  Das Ergebnis war vorhersehbar - Microsoft mochte unseren Brief nicht und er entschied, dass Vasechkin wertlos war, um auf solchen M√ºll zu achten.  Eigentlich kam der Brief nicht nach Vasechkin. <br><br>  Wir werden versuchen, Azure Information Protection so zu gestalten, dass nur Vasechkin ein Dokument im Lesemodus lesen kann.  Warum nur im Lesemodus?  Weil es f√ºr uns wichtig ist, dass der Benutzer das Dokument √∂ffnet und welche Aktionen er mit diesem Dokument ausf√ºhren kann, ist v√∂llig gleichg√ºltig.  Daher ist der Lesemodus v√∂llig ausreichend.  Beachten Sie, dass wir im Dokument nichts √§ndern.  Wir legen einfach Einschr√§nkungen f√ºr die Arbeit mit dem Dokument fest.  Dann gibt es etwas Magie mit Verschl√ºsselung, die AIP organisiert, aber in dieser Studie ist uns das egal. <br><br><img src="https://habrastorage.org/webt/qx/ks/rl/qxksrlbqynti0r1_nddayqoqjfq.png"><br><br>  Wir werden ein solches Dokument an Petrov und Vasechkin senden.  Mal sehen, was f√ºr jeden von ihnen passieren wird.  Beachten Sie, dass Petrov im Allgemeinen keine Rechte zur Arbeit mit dem Dokument hat. <br><br>  Das erste, worauf Sie achten sollten, ist, dass das sch√§dliche Dokument sowohl in den Posteing√§ngen von Petrov als auch von Vasechkin landete! <br><br>  Vasechkin √∂ffnet das Dokument ruhig mit Microsoft Word.  Er ben√∂tigt keine zus√§tzliche Software. <br><br><img src="https://habrastorage.org/webt/v2/vl/dm/v2vldmd3njstqtb1vxgorpkjqw4.png"><br><br>  Wir sehen, dass der Zugriff begrenzt ist, aber alle Inhalte des Dokuments sind auch sichtbar. <br><br>  Ein weiterer Punkt: Ein durch AIP gesch√ºtztes Dokument kann nur in Word ge√∂ffnet werden, d. H.  Sie k√∂nnen es im Anzeigemodus im E-Mail-Client oder in einigen Onlinediensten nicht sehen. <br><br>  Petrovs Situation ist umgekehrt - er kann das Dokument nicht √∂ffnen, weil er ‚Äûkeine Dokumente‚Äú hat (wie es in einem ber√ºhmten Cartoon hei√üt). <br><br><img src="https://habrastorage.org/webt/53/ug/kg/53ugkgce8wfa0g6vgggxc2laahk.png"><br><br>  Von den Minuspunkten k√∂nnen Sie das Konto sehen, unter dem sie das Dokument mit AIP gesch√ºtzt haben.  Dies kann BlueTeam bei der Untersuchung des Vorfalls einen Hinweis geben.  Ansonsten funktioniert alles nach den von uns festgelegten Regeln. <br><br>  Gro√üartig, aber was passiert, wenn wir versuchen, nur die Datenschutzstufen festzulegen?  Wir brauchen niemanden, der das Dokument √∂ffnen kann - die Hauptsache in dieser Studie ist, in den Posteingang zu gelangen. <br><br>  Sie versuchten, die Vertraulichkeitsstufe des Dokuments festzulegen - das Dokument wurde mit einem Spamfilter geschnitten. <br><br>  Au√üerdem k√∂nnen Einschr√§nkungen f√ºr den Brief festgelegt werden.  Im Outlook-Client wird ein Add-On angezeigt, mit dem Sie Einschr√§nkungen f√ºr den Brief festlegen k√∂nnen. Diese gelten (je nachdem, wie Microsoft in der Dokumentation schreibt) f√ºr den gesamten Inhalt des Briefes, einschlie√ülich der Anh√§nge.  Das Add-On wird angezeigt, wenn der Benutzer AIP verwendet.  In unserem Fall verwendet Evil User es und es hat ein solches Add-On. <br><br>  Sie versuchten, das Etikett mit dem Anhang mit dem h√∂chst vertraulichen Etikett zu versehen - der Brief ging nicht in den Posteingang. <br><br>  Wir verstehen, dass "f√ºr alle Benutzer" nicht festgelegt werden sollte, da "alle Benutzer" auch Dienstkonten enthalten, die eingehende Briefe auf Malware pr√ºfen. <br><br><h3>  Tracking-System </h3><br>  Eine der coolen Funktionen von AIP ist das Tracking-System, mit dem Sie bestimmen k√∂nnen, wer, wann und von wo das Dokument ge√∂ffnet oder versucht wurde, es zu √∂ffnen. <br><br>  In diesem Fall sehen wir, dass Petrov versucht hat, das Dokument zu √∂ffnen, aber es gelang ihm nicht.  Und Vasechkin √∂ffnete das Dokument.  Wenn Sie einen Phishing-Angriff durchf√ºhren, m√ºssen Sie an ein solches System - nur an die Erl√∂sung - an nichts denken. Wir sehen sofort, ob der Freund, den Sie ge√∂ffnet haben, der Anhang ist oder nicht. <br><br><img src="https://habrastorage.org/webt/ii/ax/_f/iiax_fvdw_cvcr0mcrqtrltcwl8.png"><br><br>  Sie k√∂nnen das Benachrichtigungssystem auch so konfigurieren, dass beim √ñffnen eines Dokuments eine E-Mail eingeht. <br><br><h3>  Schlussfolgerungen </h3><br>  Ziel der Studie war es, Microsoft-Spamfilter mithilfe von Microsoft selbst zu umgehen (unter Verwendung der vom Unternehmen angebotenen Schutzma√ünahmen). <br><br><ul><li>  Das Ziel wurde mit einer Bemerkung erfolgreich erreicht: Sie m√ºssen AIP speziell zum Festlegen von Zugriffsrechten f√ºr bestimmte Benutzer verwenden.  Das Umgehen anderer Sicherheitsfunktionen - Virenschutzprogramme, Intrusion Detection-Systeme, die beim √ñffnen des Dokuments aktiviert werden (wir haben ein absichtlich b√∂swilliges Dokument verwendet, das von allen Sicherheitsfunktionen erkannt wird) - h√§ngt von Ihrer Vorstellungskraft ab.  Wir haben nur Briefe im Posteingang gesucht. </li><li>  Azure Information Protection funktioniert nur f√ºr autorisierte Office365-Benutzer (dies ist die Magie der Verschl√ºsselung).  In fast allen Organisationen sind Benutzer bei Office365 angemeldet, und es gibt keine Schwierigkeiten.  Aber bedenken Sie, dass diese Tatsache notwendig ist. </li><li>  Das Tracking-System ist im Allgemeinen eine gro√üartige Sache und es ist bequem und praktisch, es zu verwenden. </li><li>  Die Verwendung von AIP zum Schutz von Dokumenten (sozusagen f√ºr den beabsichtigten Zweck) ist ebenfalls cool und bereitet Angreifern Kopfschmerzen - der Zugriff auf Dokumente wird schwieriger. </li></ul><br>  Die Pr√§sentation aus der Pr√§sentation finden Sie auf unserem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> . <br><br>  Vielen Dank an die Organisatoren von OFFZONE f√ºr die Konferenz!  Es war interessant! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de458364/">https://habr.com/ru/post/de458364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de458352/index.html">[Peter] JUG.ru mit Cliff Click treffen - eine JVM macht das?</a></li>
<li><a href="../de458354/index.html">Einf√ºhrung in das Umkehren von Grund auf mit IDA PRO</a></li>
<li><a href="../de458356/index.html">Wir studieren den Kalender</a></li>
<li><a href="../de458358/index.html">Meins ist immer noch legal: die Erfahrung mit dem Abbau von Lightcoins im Jahr 2019</a></li>
<li><a href="../de458362/index.html">Einzeilige Multiplikationstabelle</a></li>
<li><a href="../de458370/index.html">Wie schnell die Ergebnisse Ivan geholfen haben</a></li>
<li><a href="../de458372/index.html">TestMace - eine leistungsstarke IDE f√ºr die Arbeit mit API</a></li>
<li><a href="../de458374/index.html">TJBOT als Beispiel f√ºr IBM Watson-Services</a></li>
<li><a href="../de458376/index.html">Keine andere Programmiersprache. Teil 1: Dom√§nenlogik</a></li>
<li><a href="../de458378/index.html">Verwenden von Avocode f√ºr das Site-Layout. Bewertung f√ºr Anf√§nger. Bonus - Registrieren Sie eine 30-t√§gige Testphase</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>