<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç¶ ‚óÄÔ∏è üë©üèª‚Äçü§ù‚Äçüë®üèΩ Introduction √† la programmation contextuelle de Kotlin üë®üèæ‚Äç‚úàÔ∏è üìß ü§öüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ceci est une traduction d' une introduction √† la programmation contextuelle dans Kotlin 

 Dans cet article, je vais essayer de d√©crire un nouveau ph√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introduction √† la programmation contextuelle de Kotlin</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/JetBrains-education/blog/477898/">  <i>Ceci est une traduction d' <a href="https://proandroiddev.com/an-introduction-context-oriented-programming-in-kotlin-2e79d316b0a2">une introduction √† la programmation contextuelle dans Kotlin</a></i> <br><br>  Dans cet article, je vais essayer de d√©crire un nouveau ph√©nom√®ne qui est apparu comme un sous-produit du d√©veloppement rapide du langage Kotlin.  Il s'agit d'une nouvelle approche de la conception de l'architecture des applications et des biblioth√®ques, que j'appellerai la programmation contextuelle. <br><br><h2>  Quelques mots sur les autorisations de fonction </h2><br>  Comme on le sait, il existe trois principaux paradigmes de programmation ( <i>note de Pedant</i> : il existe d'autres paradigmes): <br><br><ul><li>  Programmation proc√©durale </li><li>  Programmation orient√©e objet </li><li>  Programmation fonctionnelle </li></ul><a name="habracut"></a><br>  Toutes ces approches fonctionnent avec les fonctions d'une mani√®re ou d'une autre.  Examinons cela du point de vue de la r√©solution des fonctions, ou de l'ordonnancement de leurs appels (c'est-√†-dire du choix de la fonction √† utiliser √† cet endroit).  La programmation proc√©durale se caract√©rise par l'utilisation de fonctions globales et leur r√©solution statique en fonction du nom de la fonction et des types d'arguments.  Bien entendu, les types ne peuvent √™tre utilis√©s que dans le cas de langues typ√©es statiquement.  Par exemple, en Python, les fonctions sont appel√©es par leur nom et si les arguments sont incorrects, une exception est lev√©e lors de l'ex√©cution pendant l'ex√©cution du programme.  La r√©solution des fonctions dans les langues avec une approche proc√©durale est bas√©e uniquement sur le nom de la proc√©dure / fonction et de ses param√®tres, et dans la plupart des cas, elle se fait de mani√®re statique. <br><br>  Un style de programmation orient√© objet limite la port√©e des fonctions.  Les fonctions ne sont pas globales, elles font plut√¥t partie de classes et ne peuvent √™tre appel√©es que sur une instance de la classe correspondante ( <i>note de Pedant</i> : certains langages proc√©duraux classiques ont un syst√®me modulaire et, par cons√©quent, une port√©e; langage proc√©dural! = C). <br><br>  Bien s√ªr, nous pouvons toujours remplacer une fonction membre d'une classe par une fonction globale avec un argument suppl√©mentaire du type de l'objet appel√©, mais d'un point de vue syntaxique, la diff√©rence est assez significative.  Par exemple, dans ce cas, les m√©thodes sont regroup√©es dans la classe √† laquelle elles se r√©f√®rent, et par cons√©quent, il est plus clairement visible quel type de comportement les objets de ce type fournissent. <br><br>  Bien s√ªr, l'encapsulation est la plus importante ici, car certains champs d'une classe ou son comportement peuvent √™tre priv√©s et accessibles uniquement aux membres de cette classe (vous ne pouvez pas fournir cela dans une approche purement proc√©durale), et le polymorphisme, gr√¢ce auquel la m√©thode r√©ellement utilis√©e est d√©termin√©e non seulement en fonction du nom , mais √©galement en fonction du type d'objet √† partir duquel il est appel√©.  La distribution d'un appel de m√©thode dans une approche orient√©e objet d√©pend du type d'objet d√©fini dans l'ex√©cution, du nom de la m√©thode et du type d'arguments au stade de la compilation. <br><br>  Une approche fonctionnelle n'apporte rien de fondamentalement nouveau en termes de r√©solution de fonction.  Typiquement, les langages orient√©s fonctions ont de meilleures r√®gles pour distinguer les zones de visibilit√© ( <i>note p√©dante</i> : encore une fois, C n'est pas tous les langages proc√©duraux, il y a ceux dans lesquels les zones de visibilit√© sont bien d√©limit√©es) qui permettent un contr√¥le plus rigoureux de la visibilit√© des fonctions bas√©es sur le syst√®me modules, mais √† part cela, la r√©solution est effectu√©e au moment de la compilation en fonction du type d'arguments. <br><br><h2>  Qu'est-ce que c'est? </h2><br>  Dans le cas de l'approche objet, lors de l'appel d'une m√©thode sur un objet, nous avons ses arguments, mais en plus nous avons un param√®tre explicite (dans le cas de Python) ou implicite repr√©sentant une instance de la classe appel√©e (ci-apr√®s tous les exemples sont √©crits en Kotlin): <br><br><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ println(<span class="hljs-string"><span class="hljs-string">"    </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$this</span></span></span><span class="hljs-string">"</span></span>) } }</code> </pre> <br>  Les classes imbriqu√©es et les fermetures compliquent un peu les choses: <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doBSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doASomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>: B{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doBSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ println(<span class="hljs-string"><span class="hljs-string">"    </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$this</span></span></span><span class="hljs-string">  </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${this@A}</span></span></span><span class="hljs-string">"</span></span>) } } b.doBSomething() } }</code> </pre> <br>  Dans ce cas, il y en a deux implicitement pour la fonction <i>doBSomething</i> - l'un correspond √† une instance de classe <i>B</i> , et l'autre r√©sulte de la fermeture de l'instance <i>A.</i>  La m√™me chose se produit dans le cas beaucoup plus courant de fermeture lambda.  Il est important de noter que dans ce cas, cela fonctionne non seulement comme param√®tre implicite, mais aussi comme port√©e ou contexte pour toutes les fonctions et tous les objets appel√©s dans la port√©e lexicale.  Ainsi, la m√©thode doBSomething a r√©ellement acc√®s √† tous les membres de la classe <i>A</i> , publics ou priv√©s, ainsi qu'aux membres de <i>B</i> lui-m√™me. <br><br><h2>  Et voici Kotlin </h2><br>  Kotlin nous offre un tout nouveau ¬´jouet¬ª - des <a href="https://kotlinlang.org/docs/reference/extensions.html">fonctions d'extension</a> .  ( <i>Note de Pedant</i> : En fait, ils ne sont pas si nouveaux, ils existent aussi en C #).  Vous pouvez d√©finir une fonction comme <i>A.doASomething</i> () n'importe o√π dans le programme, pas seulement √† l'int√©rieur de <i>A.</i>  A l'int√©rieur de cette fonction, nous avons un param√®tre implicite, appel√© r√©cepteur, pointant vers l'instance <i>A</i> sur laquelle la m√©thode est appel√©e: <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fun</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">doASomthing</span></span></span></span>(){ println(<span class="hljs-string"><span class="hljs-string">" -   </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$this</span></span></span><span class="hljs-string">"</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> a = A() a.doASomthing() }</code> </pre> <br>  Les fonctions d'extension n'ont pas acc√®s aux membres priv√©s de leur destinataire, donc l'encapsulation n'est pas viol√©e. <br><br>  La prochaine chose importante que Kotlin a est des blocs de code avec des r√©cepteurs.  Vous pouvez ex√©cuter un bloc de code arbitraire en utilisant quelque chose comme destinataire: <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doInternalSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> A.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doASomthing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> a = A() with(a){ doInternalSomething() doASomthing() } }</code> </pre> <br>  Dans cet exemple, les deux fonctions peuvent √™tre appel√©es sans ¬´ <i>a</i> ¬ª suppl√©mentaire <i>.</i> Au d√©but, car la fonction with place tout le code du bloc suivant dans le contexte de a.  Cela signifie que toutes les fonctions de ce bloc sont appel√©es comme si elles √©taient appel√©es sur l'objet (explicitement transmis) <i>a</i> . <br><br>  La derni√®re √©tape √† ce stade de la programmation contextuelle est la possibilit√© de d√©clarer des extensions en tant que membres d'une classe.  Dans ce cas, la fonction d'extension est d√©finie dans une autre classe, comme ceci: <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> B.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doBSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> a = A() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> b = B() with(a){ b.doBSomething() <span class="hljs-comment"><span class="hljs-comment">//   } b.doBSomething() //   }</span></span></code> </pre> <br>  Il est important qu'ici <i>B</i> obtienne un nouveau comportement, mais uniquement lorsqu'il se trouve dans un contexte lexical sp√©cifique.  Une fonction d'extension est un membre r√©gulier de la classe <i>A.</i>  Cela signifie que la r√©solution de la fonction se fait statiquement en fonction du contexte dans lequel elle est appel√©e, mais la mise en ≈ìuvre r√©elle est d√©termin√©e par l'instance de <i>A</i> pass√©e en tant que contexte.  La fonction peut m√™me interagir avec l'√©tat de l'objet <i>a</i> . <br><br><h2>  Envoi contextuel </h2><br>  Au d√©but de l'article, nous avons discut√© de diff√©rentes approches pour r√©partir les appels de fonction, et cela a √©t√© fait pour une raison.  Le fait est que les fonctions d'extension de Kotlin vous permettent de travailler avec la r√©partition d'une nouvelle mani√®re.  Maintenant, la d√©cision concernant la fonction particuli√®re √† utiliser est bas√©e non seulement sur le type de ses param√®tres, mais √©galement sur le contexte lexical de son appel.  Autrement dit, la m√™me expression dans diff√©rents contextes peut avoir des significations diff√©rentes.  Bien s√ªr, rien ne change du point de vue de l'impl√©mentation, et nous avons toujours un objet r√©cepteur explicite qui d√©finit la r√©partition pour ses m√©thodes et extensions d√©crites dans le corps de la classe elle-m√™me (extensions membres) - mais du point de vue syntaxique, c'est une approche diff√©rente . <br><br>  Examinons en quoi l'approche orient√©e contexte diff√®re de l'approche orient√©e objet classique, en utilisant le probl√®me classique des op√©rations arithm√©tiques sur les nombres en Java comme exemple.  La classe <i>Number</i> en Java et Kotlin est le parent de tous les nombres, mais contrairement aux nombres sp√©cialis√©s comme Double, elle ne d√©finit pas ses op√©rations math√©matiques.  Vous ne pouvez donc pas √©crire, par exemple, comme ceci: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> n: Number = <span class="hljs-number"><span class="hljs-number">1.0</span></span> n + <span class="hljs-number"><span class="hljs-number">1.0</span></span> <span class="hljs-comment"><span class="hljs-comment">//  `plus`     `Number`</span></span></code> </pre><br>  La raison ici est qu'il n'est pas possible de d√©finir de mani√®re coh√©rente les op√©rations arithm√©tiques pour tous les types num√©riques.  Par exemple, la division enti√®re est diff√©rente de la division en virgule flottante.  Dans certains cas particuliers, l'utilisateur sait quel type d'op√©ration est n√©cessaire, mais g√©n√©ralement cela n'a aucun sens de d√©finir de telles choses globalement.  Une solution orient√©e objet (et, en fait, fonctionnelle) serait de d√©finir un nouveau type d'h√©ritier de la classe <i>Number</i> , les op√©rations n√©cessaires et de l'utiliser si n√©cessaire (dans Kotlin 1.3, vous pouvez utiliser des classes inline).  D√©finissons plut√¥t un contexte avec ces op√©rations et appliquons-le localement: <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NumberOperations</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> : Number <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> : Number <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">times</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> : Number <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">div</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> : Number } <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> DoubleOperations: NumberOperations{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toDouble() + other.toDouble() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toDouble() - other.toDouble() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">times</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toDouble() * other.toDouble() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Number.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">div</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(other: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toDouble() / other.toDouble() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> n1: Number = <span class="hljs-number"><span class="hljs-number">1.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> n2: Number = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> res = with(DoubleOperations){ (n1 + n2)/<span class="hljs-number"><span class="hljs-number">2</span></span> } println(res) }</code> </pre><br>  Dans cet exemple, le calcul de <i>res</i> est effectu√© dans un contexte qui d√©finit des op√©rations suppl√©mentaires.  Il n'est pas n√©cessaire de d√©finir un contexte localement; il peut au contraire √™tre transmis implicitement en tant que r√©cepteur d'une fonction.  Par exemple, vous pouvez faire ceci: <br><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> NumberOperations.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n1: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">, n2: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Number</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = (n1 + n2)/<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> res = DoubleOperations.calculate(n1, n2)</code> </pre><br>  Cela signifie que la logique des op√©rations dans le contexte est compl√®tement distincte de la mise en ≈ìuvre de ce contexte et peut √™tre √©crite dans une autre partie du programme ou m√™me dans un autre module.  Dans cet exemple simple, un contexte est un singleton sans √©tat, mais des contextes d'√©tat peuvent √©galement √™tre utilis√©s. <br><br>  Il convient √©galement de rappeler que les contextes peuvent √™tre imbriqu√©s: <br><br><pre> <code class="kotlin hljs">with(a){ with(b){ doSomething() } }</code> </pre><br>  Cela donne l'effet de combiner le comportement des deux classes, cependant, cette fonctionnalit√© est difficile √† contr√¥ler aujourd'hui en raison du manque d'extensions avec plusieurs destinataires ( <a href="https://youtrack.jetbrains.com/issue/KT-10468">KT-10468</a> ). <br><br><h2>  Le pouvoir des coroutines explicites </h2><br>  L'un des meilleurs exemples d'une approche contextuelle est utilis√© dans la biblioth√®que Kotlinx-coroutines.  Une explication de l'id√©e peut √™tre trouv√©e dans un <a href="https://medium.com/%40elizarov/explicit-concurrency-67a8e8fd9b25">article de</a> Roman Elizarov.  Ici, je veux juste souligner que <i>CoroutineScope</i> est un cas de conception orient√©e contexte avec un contexte avec √©tat.  CoroutineScope joue deux r√¥les: <br><br><ul><li>  Il contient le <i>CoroutineContext</i> , qui est n√©cessaire pour ex√©cuter la coroutine et est h√©rit√© lors du lancement d'une nouvelle coroutine. </li><li>  Il contient l'√©tat de la coroutine parent, ce qui vous permet de l'annuler si la coroutine g√©n√©r√©e g√©n√®re une erreur. </li></ul><br>  En outre, la concurrence structur√©e fournit un excellent exemple d'une architecture contextuelle: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> CoroutineScope.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomeWork</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} GlobalScope.launch{ launch{ delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) doSomeWork() } }</code> </pre><br>  Ici, <i>doSomeWork</i> est une fonction de contexte, mais d√©finie en dehors de son contexte.  Les m√©thodes de <i>lancement</i> cr√©ent deux contextes imbriqu√©s qui sont √©quivalents aux zones lexicales des fonctions correspondantes (dans ce cas, les deux contextes sont du m√™me type, donc le contexte interne masque le externe).  Un bon point de d√©part pour apprendre les coroutines Kotlin est le guide officiel. <br><br><h2>  DSL </h2><br>  Il existe une large classe de t√¢ches pour Kotlin, g√©n√©ralement appel√©es t√¢ches de construction DSL (Domain Specific Language).  Dans ce cas, DSL est compris comme un code fournissant un constructeur convivial d'une sorte de structure complexe.  En fait, l'utilisation du terme DSL n'est pas enti√®rement correcte ici, car  dans de tels cas, la syntaxe de base de Kotlin est simplement utilis√©e sans astuces sp√©ciales - mais utilisons toujours ce terme courant. <br><br>  Les constructeurs DSL sont orient√©s contextuellement dans la plupart des cas.  Par exemple, si vous souhaitez cr√©er un √©l√©ment HTML, vous devez d'abord v√©rifier si cet √©l√©ment particulier peut √™tre ajout√© √† cet endroit.  La biblioth√®que <a href="https://github.com/Kotlin/kotlinx.html">kotlinx.html le fait</a> en fournissant des extensions de classe bas√©es sur le contexte qui repr√©sentent une balise sp√©cifique.  En fait, la biblioth√®que enti√®re se compose d'extensions de contexte pour les √©l√©ments DOM existants. <br><br>  Un autre exemple est le <a href="https://github.com/edvin/tornadofx">g√©n√©rateur d'interface graphique TornadoFX</a> .  Le g√©n√©rateur entier du graphique de sc√®ne est organis√© comme une s√©quence de g√©n√©rateurs de contexte imbriqu√©s, o√π les blocs internes sont responsables de la construction des enfants pour les blocs externes ou du r√©glage des param√®tres des parents.  Voici un exemple tir√© de la documentation officielle: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> root = gridPane{ tabpane { gridpaneConstraints { vhGrow = Priority.ALWAYS } tab(<span class="hljs-string"><span class="hljs-string">"Report"</span></span>, HBox()) { label(<span class="hljs-string"><span class="hljs-string">"Report goes here"</span></span>) } tab(<span class="hljs-string"><span class="hljs-string">"Data"</span></span>, GridPane()) { tableview&lt;Person&gt; { items = persons column(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>, Person::idProperty) column(<span class="hljs-string"><span class="hljs-string">"Name"</span></span>, Person::nameProperty) column(<span class="hljs-string"><span class="hljs-string">"Birthday"</span></span>, Person::birthdayProperty) column(<span class="hljs-string"><span class="hljs-string">"Age"</span></span>, Person::ageProperty).cellFormat { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it &lt; <span class="hljs-number"><span class="hljs-number">18</span></span>) { style = <span class="hljs-string"><span class="hljs-string">"-fx-background-color:#8b0000; -fx-text-fill:white"</span></span> text = it.toString() } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { text = it.toString() } } } } } }</code> </pre><br>  Dans cet exemple, la r√©gion lexicale d√©finit son contexte (ce qui est logique, car elle repr√©sente la section GUI et sa structure interne) et a acc√®s aux contextes parents. <br><br><h2>  Et ensuite: plusieurs destinataires </h2><br>  La programmation contextuelle fournit aux d√©veloppeurs de Kotlin de nombreux outils et ouvre une nouvelle fa√ßon de concevoir l'architecture d'application.  Avons-nous besoin d'autre chose?  Probablement oui. <br><br>  √Ä l'heure actuelle, le d√©veloppement d'une approche contextuelle est limit√© par le fait que vous devez d√©finir des extensions afin d'obtenir une sorte de comportement de classe limit√© au contexte.  C'est bien quand il s'agit d'une classe personnalis√©e, mais que se passe-t-il si nous voulons la m√™me chose pour une classe d'une biblioth√®que?  Ou si nous voulons cr√©er une extension pour un comportement d√©j√† restreint (par exemple, ajouter une sorte d'extension dans CoroutineScope)?  Kotlin ne permet pas actuellement aux fonctions d'extension d'avoir plus d'un destinataire.  Mais plusieurs destinataires pourraient √™tre ajout√©s √† la langue sans rompre la compatibilit√© descendante.  La possibilit√© d'utiliser plusieurs destinataires est en cours de discussion ( <a href="https://youtrack.jetbrains.com/issue/KT-10468">KT-10468</a> ) et sera √©mise en tant que demande <a href="https://github.com/Kotlin/KEEP">KEEP</a> (UPD: <a href="https://github.com/Kotlin/KEEP/pull/176">d√©j√† √©mise</a> ).  Le probl√®me (ou peut-√™tre une puce) des contextes imbriqu√©s est qu'ils vous permettent de couvrir la plupart, sinon la totalit√©, des options d'utilisation des classes de <a href="https://github.com/Kotlin/KEEP/pull/87">types</a> (classes de <a href="https://github.com/Kotlin/KEEP/pull/87">types</a> ), une autre tr√®s souhaitable des fonctionnalit√©s propos√©es.  Il est peu probable que ces deux fonctionnalit√©s soient impl√©ment√©es dans le langage en m√™me temps. <br><br><h2>  Addition </h2><br>  Nous tenons √† remercier notre amant √† temps plein Pedant et Haskell <a href="https://research.jetbrains.org/researchers/shimuuar">Alexei Khudyakov</a> pour ses commentaires sur le texte de l'article et les modifications apport√©es √† mon utilisation plut√¥t libre des termes.  Je remercie √©galement Ilya Ryzhenkov pour ses pr√©cieux commentaires et la relecture de la version anglaise de l'article. <br><br>  Auteur de l'article original: <a href="https://research.jetbrains.org/researchers/altavir">Alexander Nozik</a> , chef adjoint du <a href="https://research.jetbrains.org/groups/npm">laboratoire de m√©thodes exp√©rimentales de physique nucl√©aire</a> de <a href="https://research.jetbrains.org/">JetBrains Research</a> . <br><br>  Traduit par: <a href="https://research.jetbrains.org/researchers/pklimai">Petr Klimay</a> , chercheur <a href="https://research.jetbrains.org/groups/npm">au laboratoire de m√©thodes d'exp√©rimentation en physique nucl√©aire</a> de <a href="https://research.jetbrains.org/">JetBrains Research</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477898/">https://habr.com/ru/post/fr477898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477878/index.html">Comment les jeux comp√©titifs vous aident √† mieux travailler</a></li>
<li><a href="../fr477882/index.html">40 canaux et chats pour les personnes int√©ress√©es par DevOps</a></li>
<li><a href="../fr477892/index.html">DevOps: r√©sultats 2019 et prochaine pr√©diction de la communaut√© DevOps</a></li>
<li><a href="../fr477894/index.html">travail et plaisir de dev (damentals) # 0. √Ä quoi s'attendre et comment aider un d√©veloppeur stagiaire √† devenir un junior confiant?</a></li>
<li><a href="../fr477896/index.html">Choisissez le segment budg√©taire des √©couteurs filaires</a></li>
<li><a href="../fr477906/index.html">Slurm: 50% de r√©duction sur les cours en ligne du Black Friday</a></li>
<li><a href="../fr477908/index.html">Puppetry 3: tests automatis√©s sans une seule ligne de code</a></li>
<li><a href="../fr477910/index.html">Black Friday 2019 - VDS √† Moscou et Amsterdam, serveurs avec GPU</a></li>
<li><a href="../fr477914/index.html">Projection au plafond: impressions apr√®s une semaine d'utilisation du projecteur, mettre ¬´√† la fin¬ª</a></li>
<li><a href="../fr477916/index.html">Comment les cr√©ateurs de logiciels malveillants tentent d'√©viter sa d√©tection: nous analysons Spy.GmFUToMitm comme exemple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>