<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🤝‍👨🏿 🔄 🕙 Blazor + MVVM = Silverlight schlägt zurück, weil das alte Böse unbesiegbar ist 🌵 🏠 👩🏽‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! 

 Also ja, Net Core 3.0 kommt bald und es wird eine Projektvorlage mit Blazor als einer der Standardvorlagen geben. Der Name des Framewor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blazor + MVVM = Silverlight schlägt zurück, weil das alte Böse unbesiegbar ist</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463197/">  Hallo Habr! <br><br>  Also ja, Net Core 3.0 kommt bald und es wird eine Projektvorlage mit Blazor als einer der Standardvorlagen geben.  Der Name des Frameworks ähnelt meiner Meinung nach dem Namen einiger Pokémon.  Blazor tritt in die Schlacht ein!  Ich beschloss zu schauen, was für ein Tier es ist und womit es gegessen wird, also machte ich ein Todo-Blatt darauf.  Nun, auch auf Vue.js zum Vergleich mit dem Thema, weil sie meiner Meinung nach sowohl in Bezug auf die Reaktivität als auch in Bezug auf die Reaktivität dem Komponentensystem ähnlich sind, und das ist alles.  Mehr Göttinnen Gott Götter!  Tatsächlich ist dies ein Leitfaden für junge, nicht starke Köpfe, die zu faul sind, um TypeScript oder JavaScript zu lernen, und Schaltflächen und Eingaben auf der Website vornehmen möchten.  Wie in diesem Mem - "Der Technikfreak wollte ein Buch schreiben, aber die Anweisung stellte sich heraus."  Wer interessiert sich für meine Abenteuer im Frontend oder findet heraus, welche Art von Blazor du bei Katze willkommen bist. <a name="habracut"></a><br><br><h2>  Einführung </h2><br>  Microsoft hatte einmal die Idee, C # in einem Browser zu arbeiten, und nannte diese Idee Silverlight.  Es ist nicht gestartet.  Diese Ihre Tyrnets waren dann anders als eigentlich Browser.  Warum denke ich, dass es jetzt abhebt?  Denn jetzt sind Web-Assemblys standardmäßig in allen modernen Browsern vorhanden.  Es ist nicht erforderlich, eine separate Erweiterung zu installieren.  Ein weiteres Problem sind die Anwendungsgrößen.  Wenn Vue.js SPA 1,7 Megabyte wiegt, ist dies bei Blazor 21 Megabyte genau dasselbe.  Jetzt ist das Internet schneller und zuverlässiger als während Silverlight und Sie müssen die Anwendung einmal herunterladen, und dann gibt es den Cache und die ganze Arbeit.  Im Allgemeinen schien Blazor Vue.js sehr ähnlich zu sein.  Als Hommage an Silverligtht, WPF und UWP und nur weil es unter Schärfern so häufig war, entschied ich mich, das MVVM-Muster für mein Projekt zu verwenden.  Also als Referenz - ich bin im Allgemeinen ein Back-End und ich mochte Blazor.  Ich warne schwache Nerven - Das Design und Layout in meinen Beispielen ist schrecklich, und im Projekt mit Vue.js kann ein erfahrener Front-End-Autor viel Govnokod sehen.  Nun, mit Rechtschreibung und Zeichensetzung sind die Dinge auch so lala. <br><br><h2>  Referenzen </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Todo Beispiel auf Vue + Vuex</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Todo Beispiel auf Blazor</a> <br><br><h2>  Platzierungsmodelle </h2><br><ol><li>  Auf der Client-Seite.  Ein Standard-SPA, das auf verschiedene Arten verteilt werden kann.  In meinem Beispiel habe ich eine Vorlage verwendet, in der die Anwendungsdateien an den Browserserver auf asp.net core gesendet werden.  Der Nachteil dieses Ansatzes liegt in den 21 Megabyte, die Sie in den Browser herunterladen müssen. </li><li>  Auf der Serverseite.  Alles geschieht auf dem Server, und das fertige DOM wird über Sockets an den Client übergeben.  Der Browser muss zu Beginn überhaupt nichts herunterladen, sondern lädt das aktualisierte DOM ständig in Teilen herunter.  Nun, die gesamte Last des Client-Codes fällt plötzlich auf den Server. </li></ol><br>  Ich persönlich mag die erste Option mehr und kann in all den Fällen verwendet werden, in denen Sie sich nicht um Benutzerkonvertierungen kümmern müssen.  Dies ist beispielsweise eine Art internes Informationssystem des Unternehmens oder eine spezialisierte B2B-Lösung, da Blazor zum ersten Mal seit langer Zeit heruntergeladen hat.  Wenn sich Ihre Benutzer ständig bei Ihrer Anwendung anmelden, werden sie keinen Unterschied zur JS-Version feststellen.  Wenn ein Benutzer auf einen Werbelink klickt, schauen Sie sich einfach an, welche Art von Website vorhanden ist. Wahrscheinlich wird er nicht lange auf das Laden der Website warten und diese einfach verlassen.  In diesem Fall ist es besser, die zweite Platzierungsoption zu verwenden, d.h.  Server Side Blazor <br><br><h2>  Projekterstellung </h2><br>  Laden Sie net core 3.0 <a href="">dotnet.microsoft.com/download/dotnet-core/3.0 herunter</a> <br>  Führen Sie den Befehl im Terminal aus, der die erforderlichen Vorlagen für Sie lädt. <br><br><pre><code class="bash hljs">dotnet new -i Microsoft.AspNetCore.Blazor.Templates</code> </pre> <br>  So erstellen Sie eine Serverseite <br><br><pre> <code class="bash hljs">dotnet new blazorserverside -o MyWebApp</code> </pre><br>  Für die Client-Seite, deren Dateien vom asp.net-Kernserver verteilt werden <br><br><pre> <code class="bash hljs">dotnet new blazorhosted -o MyWebApp</code> </pre><br>  Wenn Sie Exotik wollten und sich plötzlich entschieden haben, den asp.net-Kern nicht als Server zu verwenden, sondern etwas anderes (Benötigen Sie ihn überhaupt?) Mit diesem Befehl können Sie nur einen Client ohne Server erstellen. <br><br><pre> <code class="bash hljs">dotnet new blazor -o MyWebApp</code> </pre><br><h2>  Bindungen </h2><br>  Unterstützt Einweg- und Zweiwegbindung.  Also ja, Sie brauchen kein OnPropertichanged wie in WPF.  Beim Ändern des Ansichtsmodells ändert sich das Layout automatisch. <br><br><pre> <code class="cs hljs">&lt;label&gt;One way binding:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>=@Text /&gt; &lt;br /&gt; &lt;label&gt;Two way binding:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> @bind=@Text /&gt; &lt;br /&gt; &lt;label&gt;Two way binding         Text   oninput:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> @bind=@Text @bind:<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>=<span class="hljs-string"><span class="hljs-string">"oninput"</span></span> /&gt; <span class="hljs-comment"><span class="hljs-comment">//ViewModel @code{ string Text; async Task InpuValueChanged() { Console.WriteLine("Input value changed"); } }</span></span></code> </pre><br>  Und so haben wir hier ein ViewModel (anonym), das ein Textfeld hat. <br><br>  Bei der ersten Eingabe haben wir über "value = @ Text" eine Einwegbindung vorgenommen.  Wenn wir nun den Text im Code ändern, ändert sich der Text in der Eingabe sofort.  Nur damit wir unsere Eingaben nicht drucken, wirkt sich dies in keiner Weise auf unsere VM aus.  In der zweiten Eingabe haben wir über "@ bind = @ Text" eine bidirektionale Bindung durchgeführt.  Wenn wir nun etwas Neues in unsere Eingabe schreiben, ändert sich unsere VM sofort, und das Gegenteil ist auch der Fall, d. H.  Wenn wir das Textfeld im Code ändern, zeigt unsere Eingabe sofort den neuen Wert an.  Es gibt einen ABER - standardmäßig sind die Änderungen an das Ereignis onchange unserer Eingabe gebunden, sodass sich die VM erst ändert, wenn wir die Eingabe beendet haben.  In der dritten Eingabe "@bind: event =" oninput "" haben wir das Ereignis für die Übertragung von VM-Daten in oninput geändert. Jedes Mal, wenn wir ein Zeichen drucken, wird sofort ein neuer Wert an unsere VM übertragen.  Sie können beispielsweise auch ein Format für DateTime angeben. <br><br><pre> <code class="cs hljs">&lt;input @bind=@Today @bind:format=<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd"</span></span> /&gt;</code> </pre> <br><h2>  Modell anzeigen </h2><br>  Sie können es anonymisieren, dann müssen Sie es im Block "@code {}" stoppen. <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> &lt;p&gt;  @UserName &lt;/p&gt; @code{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName{<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} }</code> </pre><br>  oder Sie können es in einer separaten Datei ablegen.  Dann muss es von ComponentBase geerbt werden und oben auf der Seite einen Link zu unserer VM mit "@inherits" angeben. <br><br>  Zum Beispiel <br><br>  TodoViewModel.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TodoViewModel</span></span>: <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName{<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} }</code> </pre><br>  Todo.razor: <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits MyWebApp.ViewModels.TodoViewModel &lt;p&gt;  @UserName &lt;/p&gt;</code> </pre><br><h2>  Routing </h2><br>  Die Routen, auf die die Seite reagiert, werden am Anfang der Seite mit "@page" angegeben.  Darüber hinaus kann es mehrere geben.  Der erste wird genau passend in der Reihenfolge von oben nach unten ausgewählt.  Zum Beispiel: <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @page <span class="hljs-string"><span class="hljs-string">"/todo/delete"</span></span> &lt;h1&gt; Hello!&lt;/h1&gt;</code> </pre><br>  Diese Seite wird unter "/ todo" oder "todo / delete" geöffnet. <br><br><h2>  Layouts </h2><br>  Im Allgemeinen werden hier Dinge platziert, die für mehrere Seiten gleich sind.  Wie eine Seitenleiste und mehr. <br><br>  Um das Layout überhaupt verwenden zu können, müssen Sie es erstellen.  Es muss mit "@inherits" von LayotComponentBase geerbt werden.  Zum Beispiel <br><br><pre> <code class="cs hljs">@inherits LayoutComponentBase &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"sidebar"</span></span>&gt; &lt;NavMenu /&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"main"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"top-row px-4"</span></span>&gt; &lt;a href=<span class="hljs-string"><span class="hljs-string">"http://blazor.net"</span></span> target=<span class="hljs-string"><span class="hljs-string">"_blank"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"ml-md-auto"</span></span>&gt;About&lt;/a&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"content px-4"</span></span>&gt; @Body &lt;/div&gt; &lt;/div&gt;</code> </pre><br>  Zweitens muss es importiert werden.  Dazu müssen Sie in dem Verzeichnis mit den Seiten, auf denen es verwendet wird, die Datei _imports.razor erstellen und dieser Datei die Zeile "@layout" hinzufügen <br><br><pre> <code class="cs hljs">@layout MainLayout @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System</code> </pre><br>  Drittens können Sie auf der Seite angeben, welches Layout direkt verwendet wird <br><br><pre> <code class="cs hljs">@layout MainLayout @page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits BlazorApp.Client.Presentation.TodoViewModel &lt;h3&gt;Todo&lt;/h3&gt;</code> </pre><br>  Im Allgemeinen wirken _imports.razor und die Verwendung darin auf alle Seiten, die sich im selben Ordner befinden. <br><br><h2>  Routenoptionen </h2><br>  Geben Sie zunächst den Parameter und seinen Typ in geschweiften Klammern in unserer Route an (Groß- und Kleinschreibung wird nicht berücksichtigt).  Standardtypen werden unterstützt.  Also ja, es gibt keine optionalen Parameter, d.h.  Wert muss immer übergeben werden. <br><br>  Der Wert selbst kann erhalten werden, indem in unserem ViewModel eine Eigenschaft mit demselben Namen wie der Parameter und mit dem zuvor ausgeführten BTB-Attribut [Parameter] erstellt wird. Die Daten und Ereignisse in den übergeordneten Komponenten werden auch von den übergeordneten Komponenten mithilfe des Attributs [Parameter] sowie über kaskadierende Parameter übertragen.  Sie werden von der übergeordneten Komponente an alle untergeordneten Komponenten und deren untergeordnete Komponenten übergeben.  Sie werden hauptsächlich für Stile verwendet, aber es ist besser, nur Stile in CSS zu erstellen. Warum also nicht? <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo/delete/{id:guid}"</span></span> &lt;h1&gt; Hello!&lt;/h1&gt; @code{ [Parameter] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Guid Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><h2>  DI </h2><br>  Alles ist in Startup.cs registriert, wie in einer regulären asp.net-Kernanwendung.  Hier gibt es nichts Neues.  Die Implementierung von Abhängigkeiten für unsere VM erfolgt jedoch weiterhin über öffentliche Eigenschaften und nicht über den Konstruktor.  Die Eigenschaft muss nur mit dem Attribut [Inject] dekoriert werden <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteTodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { [Parameter] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Guid Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ICommandDispatcher CommandDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre><br>  Standardmäßig sind bereits 3 Dienste verbunden.  HttpClient - Nun, Sie wissen warum.  IJSRuntime - JS-Code von C # aufrufen.  IUriHelper - Mit dieser Funktion kann nicht auf andere Seiten umgeleitet werden. <br><br><h2>  Anwendungsbeispiel </h2><br><h3>  Todo Tabellenkalkulation </h3><br>  TodoTableComponent.razor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//1) &lt;table class="table table-hover"&gt; &lt;thead&gt; &lt;th&gt; &lt;/th&gt; &lt;th&gt;&lt;/th&gt; &lt;th&gt; &lt;/th&gt; &lt;th&gt;&lt;/th&gt; &lt;/thead&gt; &lt;tbody&gt; //2) @foreach (var item in Items) { //3) &lt;tr @onclick=@(()=&gt;ClickRow(item.Id)) class="@(item.Id == Current?"table-primary":null)"&gt; &lt;td&gt;&lt;input type="checkbox" checked="@item.IsComplite" disabled="disabled" /&gt;&lt;/td&gt; &lt;td&gt;@item.Name&lt;/td&gt; &lt;td&gt;@item.Created.ToString("dd.MM.yyyy HH:mm:ss")&lt;/td&gt; &lt;td&gt;&lt;a href="/todo/delete/@item.Id" class="btn btn-danger"&gt;&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; } &lt;/tbody&gt; &lt;/table&gt; @code { //4) [Parameter] private List&lt;BlazorApp.Client.Presentation.TodoDto&gt; Items { get; set; } [Parameter] private EventCallback&lt;UIMouseEventArgs&gt; OnClick { get; set; } [Parameter] private Guid Current { get; set; } private async Task ClickRow(Guid id) { //5 await OnClick.InvokeAsync(CreateArgs(id)); } private ClickTodoEventArgs CreateArgs(Guid id) { return new ClickTodoEventArgs { Id = id }; } //6) public class ClickTodoEventArgs : UIMouseEventArgs { public Guid Id { get; set; } } }</span></span></code> </pre><br><ol><li>  Da diese Komponente "@page" und "@layout" nicht benötigt, nimmt sie nicht am Routing teil und verwendet das Layout der übergeordneten Komponente </li><li>  Der C # -Code beginnt mit dem @ -Symbol.  Eigentlich das gleiche wie bei Razor </li><li><pre> <code class="cs hljs">@onclick=@(()=&gt;ClickRow(item.Id))</code> </pre>  Bindet ein Zeilenklickereignis an die ClickRow-Methode unseres ViewModel </li><li>  Geben Sie mit dem Attribut [Parameter] an, welche Parameter von der übergeordneten Komponente oder Seite zu unserer übertragen werden </li><li>  Wir rufen die Rückruffunktion auf, die von der übergeordneten Komponente empfangen wurde.  Die übergeordnete Komponente erfährt also, dass im untergeordneten Element ein Ereignis aufgetreten ist.  Funktionen können nur in EventCallback &lt;&gt; parametrisierten EventArgs verpackt übergeben werden.  Eine mögliche Liste von EventArgs finden Sie hier - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">docs.microsoft.com/ru-ru/aspnet/core/blazor/components?view=aspnetcore-3.0#event-handling</a> </li><li>  Da die Liste der möglichen Arten von EventArgs begrenzt ist und wir eine zusätzliche Id-Eigenschaft an den Ereignishandler auf der Seite der übergeordneten Komponente übergeben müssen, erstellen wir unsere eigene Parameterklasse, die von der Basis geerbt wurde, und übergeben sie an das Ereignis.  Also ja - in der übergeordneten Komponente fliegen die regulären UIMouseEventArgs in die Funktion des Ereignishandlers und müssen beispielsweise mit dem Operator as in unseren Typ konvertiert werden </li></ol><br>  Anwendungsbeispiel: <br><br><pre> <code class="cs hljs">&lt;TodoTableComponent Items=@Items OnClick=@Select Current=@(Selected?.Id??Guid.Empty)&gt;&lt;/TodoTableComponent&gt;</code> </pre> <br><h3>  Todo Entfernungsseite </h3><br>  Unser ViewModel aka VM ist DeleteTodoViewModel.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteTodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1) [Parameter] private Guid Id { get; set; } //2) [Inject] public ICommandDispatcher CommandDispatcher { get; set; } [Inject] public IQueryDispatcher QueryDispatcher { get; set; } [Inject] public IUriHelper UriHelper { get; set; } //3) public TodoDto Todo { get; set; } protected override async Task OnInitAsync() { var todo = await QueryDispatcher.Execute&lt;GetById,TodoItem&gt;(new GetById(Id)); if (todo != null) Todo = new TodoDto { Id = todo.Id, IsComplite = todo.IsComplite, Name = todo.Name, Created = todo.Created }; await base.OnInitAsync(); } //4) public async Task Delete() { if (Todo != null) await CommandDispatcher.Execute(new Remove(Todo.Id)); Todo = null; //5) UriHelper.NavigateTo("/todo"); } }</span></span></code> </pre><br><ol><li>  Der Routenparameter "/ todo / delete / {id: guid}" wird hier an Guid übergeben, wenn wir beispielsweise an localhost / todo / delete / ae434aae44 gehen ... </li><li>  Injizieren Sie Services aus dem DI-Container in unsere VM. </li><li>  Nur eine Eigenschaft unserer VM.  Wir setzen seinen Wert selbst, wie wir wollen. </li><li>  Diese Methode wird automatisch aufgerufen, wenn die Seite initialisiert wird.  Hier legen wir die notwendigen Werte für die Eigenschaften unserer VM fest </li><li>  Die Methode unserer VM.  Wir können es zum Beispiel an den Fall binden, dass wir auf eine beliebige Schaltfläche in unserer Ansicht klicken </li><li>  Gehen Sie zu einer anderen Seite unter der Adresse "/ todo", dh  sie hat am anfang die zeile "@page" / todo "" <br>  Unsere Ansicht ist DeleteTodo.razor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//1) @page "/todo/delete/{id:guid}" @using BlazorApp.Client.TodoModule.Presentation @using BlazorApp.Client.Shared; //2) @layout MainLayout //3) @inherits DeleteTodoViewModel &lt;h3&gt; Todo &lt;/h3&gt; @if (Todo != null) { &lt;div class="row"&gt; &lt;div class="col"&gt; &lt;input type="checkbox" checked=@Todo.IsComplite disabled="disabled" /&gt; &lt;br /&gt; &lt;label&gt;@Todo.Name&lt;/label&gt; &lt;br /&gt; //4) &lt;button class="btn btn-danger" onclick=@Delete&gt;&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; } else { &lt;p&gt;&lt;em&gt; Todo  &lt;/em&gt;&lt;/p&gt; }</span></span></code> </pre><br><ol><li>  Wir geben an, dass dieses Land unter der Adresse {Stammadresse unserer Website} + "/ todo / delete /" + {eine Art Guid} verfügbar sein wird.  Zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">localhost / todo / delete / ae434aae44</a> ... </li><li>  Geben Sie an, dass unsere Seite in MainLayout.razor gerendert wird </li><li>  Geben Sie an, dass unsere Seite die Eigenschaften und Methoden der DeleteTodoViewModel-Klasse verwendet </li><li>  Wenn Sie auf diese Schaltfläche klicken, wird die Delete () -Methode unserer VM aufgerufen </li></ol><br><h3>  Todo nach Hause </h3><br>  TodoViewModel.cs: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ICommandDispatcher CommandDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IQueryDispatcher QueryDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//1) [Required(ErrorMessage = "  Todo")] public string NewTodo { get; set; } public List&lt;TodoDto&gt; Items { get; set; } public TodoDto Selected { get; set; } protected override async Task OnInitAsync() { await LoadTodos(); await base.OnInitAsync(); } public async Task Create() { await CommandDispatcher.Execute(new Add(NewTodo)); await LoadTodos(); NewTodo = string.Empty; } //2) public async Task Select(UIMouseEventArgs args) { //3) var e = args as TodoTableComponent.ClickTodoEventArgs; if (e == null) return; var todo = await QueryDispatcher.Execute&lt;GetById, TodoItem&gt;(new GetById(e.Id)); if (todo == null) { Selected = null; return; } Selected = new TodoDto { Id = todo.Id, IsComplite = todo.IsComplite, Name = todo.Name, Created = todo.Created }; } public void CanselEdit() { Selected = null; } public async Task Update() { await CommandDispatcher.Execute(new Update(Selected.Id, Selected.Name, Selected.IsComplite)); Selected = null; await LoadTodos(); } private async Task LoadTodos() { var todos = await QueryDispatcher.Execute&lt;GetAll, List&lt;TodoItem&gt;&gt;(new GetAll()); Items = todos.Select(t =&gt; new TodoDto { Id = t.Id, IsComplite = t.IsComplite, Name = t.Name, Created = t.Created }) .ToList(); } }</span></span></code> </pre><br><ol><li>  Die Standardvalidierungsattribute von System.ComponentModel.DataAnnotations werden unterstützt.  Insbesondere geben wir hier an, dass dieses Feld erforderlich ist und der Text, der angezeigt wird, wenn der Benutzer keinen Wert in der Eingabe angibt, der diesem Feld zugeordnet wird. </li><li>  Methode zur Behandlung eines Ereignisses mit einem Parameter.  Diese Methode behandelt das Ereignis von der untergeordneten Komponente. </li><li>  Wir wandeln das Argument in den Typ um, den wir in der untergeordneten Komponente erstellt haben </li></ol><br>  Todo.razor: <br><br><pre> <code class="cs hljs">@layout MainLayout @page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits BlazorApp.Client.Presentation.TodoViewModel &lt;h3&gt;Todo&lt;/h3&gt; &lt;h4&gt;&lt;/h4&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"row"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"col"</span></span>&gt; @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Items == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { &lt;p&gt;&lt;em&gt;...&lt;/em&gt;&lt;/p&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Items.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { &lt;p&gt;&lt;em&gt;   .    .&lt;/em&gt;&lt;/p&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1) &lt;TodoTableComponent Items=@Items OnClick=@Select Current=@(Selected?.Id??Guid.Empty)&gt;&lt;/TodoTableComponent&gt; } &lt;/div&gt; &lt;/div&gt; &lt;br /&gt; &lt;h4&gt; Todo&lt;/h4&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; @if (Items != null) { //2) &lt;EditForm name="addForm" Model=@this OnValidSubmit=@Create&gt; //3) &lt;DataAnnotationsValidator /&gt; //4) &lt;ValidationSummary /&gt; &lt;div class="form-group"&gt; //5) &lt;InputText @bind-Value=@NewTodo /&gt; //6) &lt;ValidationMessage For="@(() =&gt; this. NewTodo)" /&gt; //7) &lt;button type="submit" class="btn btn-primary"&gt;&lt;/button&gt; &lt;/div&gt; &lt;/EditForm&gt; } &lt;/div&gt; &lt;/div&gt; &lt;br /&gt; &lt;h4&gt; Todo&lt;/h4&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; @if (Items != null) { @if (Selected != null) { &lt;EditForm name="editForm" Model=@Selected OnValidSubmit=@Update&gt; &lt;DataAnnotationsValidator /&gt; &lt;ValidationSummary /&gt; &lt;div class="form-group"&gt; &lt;InputCheckbox @bind-Value=@Selected.IsComplite /&gt; &lt;InputText @bind-Value=@Selected.Name /&gt; &lt;button type="submit" class="btn btn-primary"&gt;&lt;/button&gt; &lt;button type="reset" class="btn btn-warning" @onclick=@CanselEdit&gt;&lt;/button&gt; &lt;/div&gt; &lt;/EditForm&gt; } else { &lt;p&gt;&lt;em&gt;     &lt;/em&gt;&lt;/p&gt; } } &lt;/div&gt; &lt;/div&gt;</span></span></code> </pre><br><ol><li>  Wir rufen die untergeordnete Komponente auf und übergeben ihr die Eigenschaften und Methoden unserer VM als Parameter. </li><li>  Integrierte Formularkomponente mit Datenvalidierung.  Wir geben darin an, dass er als Modell unsere VM verwenden und beim Senden gültiger Daten die Create () -Methode aufrufen wird </li><li>  Die Validierung wird anhand von Modellattributen wie [Erforderlich] usw. durchgeführt. </li><li>  Hier werde ich die allgemeinen Validierungsfehler anzeigen </li><li>  Erstellt eine Eingabe mit Validierung.  Die Liste der möglichen Tags lautet InputText, InputTextArea, InputSelect, InputNumber, InputCheckbox, InputDate </li><li>  Hier werden Validierungsfehler für die öffentliche Zeichenfolgeeigenschaft NewTodo {get; set;} angezeigt </li><li>  Wenn Sie auf diese Schaltfläche klicken, wird das OnValidSubmit-Ereignis unseres Formulars ausgelöst </li></ol><br><h3>  Datei Startup.cs </h3><br>  Hier registrieren wir unsere Dienste <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IServiceCollection services</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// LocalStorage  SessionStorage       //    //     Nuget  Blazor.Extensions.Storage services.AddStorage(); services.AddSingleton&lt;ITodoRepository, TodoRepository&gt;(); services.AddSingleton&lt;ICommandDispatcher, CommandDispatcher&gt;(); services.AddSingleton&lt;IQueryDispatcher, QueryDispatcher&gt;(); services.AddSingleton&lt;IQueryHandler&lt;GetAll, List&lt;TodoItem&gt;&gt;, GetAllHandler&gt;(); services.AddSingleton&lt;IQueryHandler&lt;GetById, TodoItem&gt;, GetByIdHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Add&gt;, AddHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Remove&gt;, RemoveHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Update&gt;, UpdateHandler&gt;(); } public void Configure(IComponentsApplicationBuilder app) { //       App.razor //        &lt;app&gt;&lt;/app&gt; app.AddComponent&lt;App&gt;("app"); } }</span></span></code> </pre><br><h2>  Nachwort </h2><br>  Dieser Artikel wurde geschrieben, um Appetit zu machen und das weitere Studium von Blazor zu fördern.  Ich hoffe, dass ich mein Ziel erreicht habe.  Um es besser zu studieren, empfehle ich, das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offizielle Handbuch von Microsoft zu</a> lesen. <br><br><h2>  Danksagung </h2><br>  Vielen Dank an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">AndreyNikolin</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">win32nipuh</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">SemenPV</a> für die gefundenen Rechtschreib- und Grammatikfehler im Text. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463197/">https://habr.com/ru/post/de463197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463183/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 13. Konfigurieren Sie das VLAN</a></li>
<li><a href="../de463185/index.html">Wie starke bolivianische Erdbeben Berge in einer Tiefe von 660 Kilometern unter der Erde entdeckten</a></li>
<li><a href="../de463189/index.html">Über Anonymität im Internet, Leben und seine Relativität</a></li>
<li><a href="../de463193/index.html">Konvertieren Sie Schwarzweißbilder mit nicht negativer Matrixzerlegung in ASCII-Grafiken</a></li>
<li><a href="../de463195/index.html">Was passiert mit dem Tele2 Internet?</a></li>
<li><a href="../de463203/index.html">Die schwere Zeitlast. Yandex berichtet über häufige Fehler bei der Arbeit mit der Zeit</a></li>
<li><a href="../de463205/index.html">Zunächst nicht funktionsfähig: Wie man mit einem Laptop unter Windows 10 und einem 32-Gigabyte-Laufwerk überlebt</a></li>
<li><a href="../de463207/index.html">Chatbot-Entwicklung (Telegramm + Youtube)</a></li>
<li><a href="../de463215/index.html">Ingenieure und Architekten entwerfen bereits Mond-Siedlungen</a></li>
<li><a href="../de463221/index.html">Beobachten der Sonne: 5 Arten von Geräten, von 5 bis 5.000 US-Dollar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>