<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👊 🚵🏿 🐑 Wie ich Qiwi ohne Programmierkenntnisse gehackt habe 🉐 🐥 🌰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eintrag 
 Hallo nochmal. 

 Diesmal wirft der Artikel keine „ernsthaften“ Fragen auf. 

 Dies ist eine Geschichte darüber, wie Sie, ohne die Programmi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich Qiwi ohne Programmierkenntnisse gehackt habe</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463853/"><h2>  Eintrag </h2><br>  Hallo nochmal. <br><br>  Diesmal wirft der Artikel keine „ernsthaften“ Fragen auf. <br><br>  Dies ist eine Geschichte darüber, wie Sie, ohne die Programmierung zu kennen, aber sehr geschickt und aufmerksam sind, eine schwerwiegende Sicherheitslücke finden können, die es Ihnen beispielsweise ermöglicht, das gesamte Geld von einem Konto mit nur einem Benutzernamen und einem Passwort abzuschreiben (Lesen, Umgehen der Zwei-Faktor-Authentifizierung oder) gleiche Bestätigung per SMS). <br><br>  Im Moment hat Qiwi es bereits erfolgreich gepatcht, daher werde ich versuchen, die Erklärungen mit modernen Screenshots zu verstärken und manchmal zu erklären, wie es vor 2,5 Jahren aussah. <br><a name="habracut"></a><br><h2>  Nun zum Punkt </h2><br>  Angenommen, Sie haben einen Benutzernamen: das Passwort für die Qiwi-Brieftasche eines anderen. <br>  Nehmen wir an, es gibt 100.000 Rubel. <br>  Und du willst sie sooooo in Besitz nehmen. <br>  Sie können jedoch nicht nur Geld abschreiben, sondern benötigen eine Bestätigung per SMS. <br>  Aber wir sind schlau, das wird uns nicht aufhalten. <br><br>  <b>Schritt 1. Melden Sie sich bei Ihrem Konto an und erstellen Sie dort eine virtuelle Karte.</b> <br>  Wir sehen so ein Bild <br><br><img src="https://habrastorage.org/webt/ac/gc/sq/acgcsqo1opxni2aprzdntxhkq14.png"><br><br>  Es sieht so aus, als hätten wir sehr wenig Informationen.  Nur die letzten 4 Ziffern der Karte und die Dauer der Karte. <br><br>  Aber <u>vorher gab es 6 (!) Letzte Ziffern der Karte</u> .  Das heißt, weitere 10 Ziffern waren unbekannt. <br>  Und wir brauchen alle Zahlen auf der Karte.  Wo kann man mehr bekommen?  Sehr einfach. <br>  Alle Karten haben eine BIN - die ersten 6 Ziffern der Karten einer bestimmten Bank des gleichen Typs sollten gleich sein. <br><br>  <b>Schritt 2. Wir steigen in den Browser und googeln "Qiwi BIN"</b> <br><br>  Sofort stellen wir fest, dass der Behälter 489049 ist. <br>  Und jetzt haben wir schon 12 Ziffern!  Nur noch 4 übrig! <br><br>  Aber hier kommt die Schwierigkeit. <br>  Diese 4 Ziffern flackern nirgendwo und es scheint, dass es keinen Ort gibt, an dem man sie bekommen kann. <br>  Aber natürlich, wenn Sie sich anstrengen, können Sie finden :) <br><br>  <b>Schritt 3. Finden Sie die letzten 4 fehlenden Ziffern</b> <br><br>  Dazu müssen wir ein Konto in Qiwi mit 1000r haben und wissen, was der Mondalgorithmus <b>ist</b> . <br>  Lass uns in Ordnung gehen. <br>  Wenn Sie einen Vorgang in Qiwi öffnen, werden das Zahlungsdatum und die Belegnummer angezeigt. <br>  Vielleicht haben einige bereits erraten, warum wir 1k auf dem Konto benötigen. <br>  Ja, wir werden die Zahlen in der Reihenfolge anstelle der unbekannten 4 Ziffern ersetzen, die unbekannt geblieben sind, und sie in Rubel an die Kartennummern senden! <br>  Und bei einer der Operationen erhalten wir einen eingehenden 1 Pence auf das Konto, auf dem die geschätzten 100.000 Rubel liegen. <br>  Es bleibt nur die Zeit des Geldversands zu vergleichen. <br>  <u>Früher war es möglich, Operationsnummern abzugleichen, jetzt haben sie sie ausgeblendet.</u>  Und sie haben es richtig gemacht. <br>  Und jetzt wird der aufmerksamste sagen, dass tatsächlich 4 Ziffern 10.000 Operationen sind, nicht 1.000.  Sie benötigen also 10.000 Rubel und viel Zeit, um die richtigen 4 Ziffern zu finden. <br>  Und das ist nicht ganz richtig.  Ich präsentiere Ihnen den <b>Mondalgorithmus!</b> <br><br><blockquote>  Der Luhn-Algorithmus ist ein Algorithmus zur Berechnung der Prüfziffer einer Plastikkartennummer gemäß ISO / IEC 7812. Er ist kein kryptografisches Werkzeug, sondern dient in erster Linie dazu, Fehler zu erkennen, die durch versehentliche Datenbeschädigung verursacht werden (z. B. bei der manuellen Eingabe einer Nummer) Karten, wenn telefonisch Daten zur Sozialversicherungsnummer empfangen werden).  Es erlaubt nur mit einem gewissen Maß an Zuverlässigkeit, das Fehlen von Fehlern im Zahlenblock zu beurteilen, erlaubt jedoch nicht, die entdeckte Ungenauigkeit zu finden und zu korrigieren. </blockquote><br><br>  Wenn es sehr interessant ist - google, und ich werde Ihnen kurz den Algorithmus erläutern und wie er uns helfen wird. <br>  Mit diesem Algorithmus können Sie überprüfen, ob die Kartennummer gültig ist.  Das heißt, nachdem Sie unsere 10.000 Optionen durch diesen Algorithmus ausgeführt haben, können Sie nur die Anzahl der potenziell vorhandenen Karten belassen.  Ratet mal, wie viele es geben wird? <br>  Richtig, genau 1k. <br><br>  Natürlich scheint dies alles sehr praktisch zu sein, aber was hindert ein einfaches Skript daran, genau diese 1k-Optionen zu generieren? <br><br>  Hier einige Beispiele für die Implementierung von Wikipedia: <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel für einen Mondalgorithmus auf JS</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">luhnAlgorithm</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">digits</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; digits.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cardNum = <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(digits[i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((digits.length - i) % <span class="hljs-number"><span class="hljs-number">2</span></span> === <span class="hljs-number"><span class="hljs-number">0</span></span>) { cardNum = cardNum * <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cardNum &gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { cardNum = cardNum - <span class="hljs-number"><span class="hljs-number">9</span></span>; } } sum += cardNum; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum % <span class="hljs-number"><span class="hljs-number">10</span></span> === <span class="hljs-number"><span class="hljs-number">0</span></span>;}</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Beispiel Mondalgorithmus in PHP</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">luhnAlgorithm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($digit)</span></span></span><span class="hljs-function"> </span></span>{ $number = strrev(preg_replace(<span class="hljs-string"><span class="hljs-string">'/[^\d]/'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, $digit)); $sum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>, $j = strlen($number); $i &lt; $j; $i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($i % <span class="hljs-number"><span class="hljs-number">2</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { $val = $number[$i]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $val = $number[$i] * <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($val &gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { $val -= <span class="hljs-number"><span class="hljs-number">9</span></span>; } } $sum += $val; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (($sum % <span class="hljs-number"><span class="hljs-number">10</span></span>) === <span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre> <br></div></div><br>  Jetzt müssen wir diese 1k-Optionen mit der oben beschriebenen Methode sortieren. <br>  Und voila - wir haben die letzten 4 Ziffern. <br>  <b>Jetzt haben wir den vollständigen Code der Karte und ihre Gültigkeit.</b> <br>  Natürlich haben wir keinen CVV-Code (der auf der Rückseite geschrieben ist), aber an einigen Stellen wird er nicht benötigt. <br>  Zum Beispiel Amazon! <br>  Ja, wir gehen zu Amazon und bestellen alles mit Hilfe neu erstellter Daten. <br>  Zum Beispiel Steam-Codes für Geld oder ähnliches.  Im Allgemeinen gibt es etwas Elektronisches, das man schnell im Internet verkaufen kann.  Wir werden ein wenig Geld verlieren, aber höchstwahrscheinlich nicht mehr als 20%. <br>  Das ist alles!  Erhielt + 79.000 Gewinn! <br><br><h2>  Vergessen Sie nicht, dass dies nicht mehr funktioniert! </h2><br>  Aber wenn Sie etwas Ähnliches finden - sagen Sie es Qiwi, sie werden es (hoffentlich) reparieren. <br>  Ich habe es so angelegt, dass es coole Dinge und Sicherheitslücken findet, ohne überhaupt programmieren zu können.  Und für die allgemeine Entwicklung. <br><br>  Viel Glück an alle :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463853/">https://habr.com/ru/post/de463853/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463839/index.html">Museum DataArt. Lunolet und sowjetische Taschenrechner</a></li>
<li><a href="../de463845/index.html">Telegramm, wer ist das?</a></li>
<li><a href="../de463847/index.html">Zu was Faulheit führt oder wie man einen psd-Parser schreibt und was daraus werden kann</a></li>
<li><a href="../de463849/index.html">Wochenendlesung: 65 Artikel über Streaming, die Geschichte des alten "musikalischen Eisens" und die Audiotechnologie</a></li>
<li><a href="../de463851/index.html">Wie leben die Statistiken zu Internet und Domain Name Server zu Hause?</a></li>
<li><a href="../de463855/index.html">Neuralink als Mittel zur Unterstützung gelähmter Menschen und als Mittel zur Bekämpfung der bösen KI</a></li>
<li><a href="../de463857/index.html">Julia: benutzerdefinierte Typen</a></li>
<li><a href="../de463859/index.html">Leg dich nicht mit NULL an</a></li>
<li><a href="../de463861/index.html">Warum dieses Jahr zum 404 Festival gehen? Acht Gründe</a></li>
<li><a href="../de463871/index.html">Was sind die Arten von Scrum-Zeremonien und ihre Best Practices?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>