<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçë üéöÔ∏è üßîüèø Armazenamento russo AERODISK: teste de carga. Espremendo IOPS üë®üèæ‚Äçüíº üîç üí™üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! Conforme prometido, publicamos os resultados de um teste de carga de um sistema de armazenamento de dados fabricado na R√∫ssia - AERODISK ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Armazenamento russo AERODISK: teste de carga. Espremendo IOPS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/aerodisk/blog/451456/"><p><img src="https://habrastorage.org/webt/uj/gt/g3/ujgtg3hzch1rzeuhtxa240tpdsi.jpeg"></p><br><p>  Ol√° pessoal!  Conforme prometido, publicamos os resultados de um teste de carga de um sistema de armazenamento de dados fabricado na R√∫ssia - AERODISK ENGINE N2. </p><a name="habracut"></a><br><p>  No √∫ltimo artigo, quebramos os sistemas de armazenamento (ou seja, realizamos testes de falha) e os resultados do teste foram positivos (ou seja, nunca quebramos os sistemas de armazenamento).  Os resultados do teste de colis√£o podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AQUI</a> . </p><br><p>  Nos coment√°rios do artigo anterior, foram expressos desejos de testes de colis√£o adicionais - mais complicados.  N√≥s corrigimos todos e definitivamente os implementamos em um dos seguintes artigos.  Ao mesmo tempo, voc√™ pode visitar nosso laborat√≥rio em Moscou a qualquer momento (venha com os p√©s ou remotamente pela Internet) e realize esses testes voc√™ mesmo (voc√™ pode at√© fazer testes para um projeto espec√≠fico :-)).  Escreva para n√≥s, considere todos os cen√°rios! </p><br><p>  Al√©m disso, se voc√™ n√£o estiver em Moscou, poder√° conhecer melhor nosso sistema de armazenamento participando de um evento de treinamento gratuito no centro de compet√™ncia da cidade mais pr√≥xima de voc√™. </p><br><p>  Abaixo est√° uma lista dos pr√≥ximos eventos e datas de trabalho dos centros de compet√™ncia. </p><br><ul><li>  Ecaterimburgo  16 de maio de 2019.  Oficina de treinamento.  Voc√™ pode se registrar no link: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://aerodisk.promo/ekb/</a> </li><li>  Ecaterimburgo  20 de maio a 21 de junho de 2019.  Centro de Compet√™ncia.  Venha a qualquer momento para uma demonstra√ß√£o ao vivo dos sistemas de armazenamento AERODISK ENGINE N2.  O endere√ßo exato e o link de registro ser√£o posteriormente.  Acompanhe as informa√ß√µes. </li><li>  Novosibirsk  SIGA AS INFORMA√á√ïES NO NOSSO SITE ou na HABRA. <br>  Outubro 2019 </li><li>  Kazan.  SIGA AS INFORMA√á√ïES NO NOSSO SITE ou na HABRA. <br>  Outubro 2019 </li><li>  Krasnoyarsk  SIGA AS INFORMA√á√ïES NO NOSSO SITE ou na HABRA. <br>  Novembro 2019 </li></ul><br><p>  Tamb√©m queremos compartilhar outras boas not√≠cias: finalmente, nosso canal do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">YouTube</a> , onde voc√™ pode assistir a v√≠deos de eventos passados, ganhou totalmente.  L√°, enviamos regularmente nossos v√≠deos de treinamento. </p><br><h2 id="testovyy-stend">  Suporte de teste </h2><br><p>  Ent√£o, de volta aos testes.  Atualizamos nosso sistema de armazenamento de laborat√≥rio ENGINE N2 instalando unidades SSD SAS adicionais, bem como adaptadores Front-end Fibre Channel 16G.  De maneira sim√©trica, atualizamos o servidor a partir do qual iniciaremos o carregamento adicionando adaptadores FC 16G l√°. </p><br><p> Como resultado, em nosso laborat√≥rio, existe um sistema de armazenamento de 2 controladores com 24 discos SAS SSD de 800 GB e 3 DWPD, conectados via comutadores SAN a um servidor Linux f√≠sico via FC 16G. <br>  Teste o layout da bancada na figura abaixo. </p><br><p><img src="https://habrastorage.org/webt/y-/dh/_s/y-dh_snmgtnavcyq4bidjlagn94.png"></p><br><h2 id="metodika-testirovaniya">  Metodologia de teste </h2><br><p>  Para obter o melhor desempenho no acesso ao bloco, usaremos os pools DDP (Dynamic Disk Pool), que criamos para os sistemas ALL-FLASH. <br>  Para o teste, criamos dois LUNs de 1 TB, cada um com um n√≠vel de prote√ß√£o RAID-10.  ‚ÄúDistribu√≠mos‚Äù cada LUN em 12 discos (24 no total), a fim de usar totalmente o potencial de cada um dos discos instalados no sistema de armazenamento. </p><br><p>  Apresentamos LUNs ao servidor por meio de diferentes controladores para maximizar o uso de recursos de armazenamento. </p><br><p>  Cada um dos testes dura uma hora e os testes s√£o executados pelo programa Flexible IO (FIO), os dados da FIO s√£o automaticamente carregados no Excel, no qual os gr√°ficos j√° est√£o sendo constru√≠dos, para maior clareza. </p><br><h3 id="profili-nagruzki">  Carregar perfis </h3><br><p>  No total, realizaremos tr√™s testes em uma hora sem levar em considera√ß√£o o tempo de aquecimento, pelo qual levamos 15 minutos (√© o quanto √© necess√°rio para aquecer uma matriz de 24 discos SSD).  Esses testes simulam os perfis de carga mais comuns que encontramos, em particular aqueles ou outros DBMSs, sistemas de vigil√¢ncia por v√≠deo, conte√∫do de m√≠dia de difus√£o e backups. </p><br><p>  Al√©m disso, em todos os testes, desativamos deliberadamente a capacidade de armazenar em cache na RAM o sistema de armazenamento e o host.  Os resultados, √© claro, piorar√£o, mas, em nossa opini√£o, em tais condi√ß√µes, o teste ser√° mais honesto. </p><br><h2 id="rezultaty-testov">  Resultados do teste </h2><br><p>  <strong>Teste n√∫mero 1.</strong>  <strong>Carregamento aleat√≥rio em pequenos blocos.</strong>  Emula√ß√£o de um DBMS transacional altamente carregado. </p><br><ul><li>  Tamanho do bloco = 4k </li><li>  Leitura / Grava√ß√£o = 70% / 30% </li><li>  N√∫mero de empregos = 16 </li><li>  Profundidade da fila = 32 </li><li>  A natureza da carga = Aleat√≥rio completo </li></ul><br><p><img src="https://habrastorage.org/webt/ik/3-/ae/ik3-aerqgglbsfdws6ozlnzbpmg.png"></p><br><p><img src="https://habrastorage.org/webt/ss/3-/mj/ss3-mjplbuxjimcbevjyz6fjq8c.png"></p><br><p>  Resultados do teste: </p><br><p><img src="https://habrastorage.org/webt/ds/pr/h-/dsprh-xsreu3furbzl90m0dc4xy.png"></p><br><p>  No total, recebemos 438k IOPS com um atraso de 2,6 milissegundos do sistema N2 de motores intermedi√°rios j√∫nior.  Dada a classe do sistema, em nossa opini√£o, o resultado √© bastante decente.  Para entender se esse √© o limite do sistema, examinaremos a utiliza√ß√£o dos recursos dos controladores de armazenamento. </p><br><p>  Estamos interessados ‚Äã‚Äãprincipalmente na CPU, porque, como indicado acima, deliberadamente desabilitamos o cache da RAM para n√£o distorcer os resultados do teste. </p><br><p>  Nos dois controladores de armazenamento, vemos aproximadamente a mesma imagem. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/st/dr/r2/stdrr25vmyjtez-hc9kwlridbk0.png"></a> </p><br><p>  Ou seja, a carga na CPU √© de 50%.  Isso sugere que isso est√° longe do limite desse sistema de armazenamento e voc√™ ainda pode escal√°-lo facilmente.  Vamos correr um pouco √† frente: todos os testes a seguir tamb√©m mostraram uma carga no processador dos controladores na regi√£o de 50%, por isso n√£o os daremos novamente. </p><br><p>  Com base em nossos testes de laborat√≥rio, o limite confort√°vel do sistema AERODISK Engine N2, se voc√™ contar IOPS aleat√≥rios com blocos de 4k, √© de ~ 700.000 IOPS.  Se isso n√£o for suficiente e voc√™ precisar se esfor√ßar para obter um milh√£o, temos o modelo ENGINE N4 mais antigo. </p><br><p>  Ou seja, a hist√≥ria sobre milh√µes de IOPS √© ENGINE N4 e, se um milh√£o √© demais para voc√™, use o N2 com calma. </p><br><p>  Voltamos aos testes. </p><br><p>  <strong>Teste n√∫mero 2.</strong>  <strong>Grava√ß√£o seq√ºencial em grandes blocos.</strong>  Emula√ß√£o de sistemas de vigil√¢ncia por v√≠deo, carregando dados em um DBMS anal√≠tico ou gravando backups. </p><br><p>  Neste teste, n√£o estamos mais interessados ‚Äã‚Äãem IOPS, pois com uma carga sequencial de blocos grandes, eles n√£o fazem sentido.  Estamos interessados ‚Äã‚Äãprincipalmente em: o fluxo de grava√ß√£o (megabytes por segundo) e os atrasos, que com blocos grandes, √© claro, ser√£o maiores do que com blocos pequenos. </p><br><ul><li>  Tamanho do bloco = 128k </li><li>  Leitura / Grava√ß√£o = 0% / 100% </li><li>  N√∫mero de empregos = 16 </li><li>  Profundidade da fila = 32 </li><li>  A natureza da carga - Sequencial </li></ul><br><p><img src="https://habrastorage.org/webt/jx/g8/c1/jxg8c1sqy-xrvstsnywth1wypvw.png"></p><br><p><img src="https://habrastorage.org/webt/qo/kf/_k/qokf_knndwunfvn0pdle1geycf0.png"></p><br><p><img src="https://habrastorage.org/webt/z6/vp/rw/z6vprw755rfukhjqkqtackszndq.png"></p><br><p>  Total: temos um registro de cinco gigabytes e meio por segundo com atrasos de onze milissegundos.  Comparado com os concorrentes estrangeiros mais pr√≥ximos, o resultado, em nossa opini√£o, √© excelente e tamb√©m n√£o √© o limite do sistema ENGINE N2. </p><br><p>  <strong>Teste n√∫mero 3.</strong>  <strong>Leitura seq√ºencial em grandes blocos.</strong>  Emula√ß√£o de conte√∫do de m√≠dia de difus√£o, gerando relat√≥rios de um DBMS anal√≠tico ou recuperando dados de backups. </p><br><p>  Como no teste anterior, estamos interessados ‚Äã‚Äãem fluxos e atrasos. </p><br><ul><li>  Tamanho do bloco = 128k </li><li>  Leitura / Grava√ß√£o = 100% / 0% </li><li>  N√∫mero de empregos = 16 </li><li>  Profundidade da fila = 32 </li><li>  A natureza da carga - Sequencial </li></ul><br><p><img src="https://habrastorage.org/webt/ab/jr/ff/abjrffrngftgpvnplxuht65icgm.png"></p><br><p><img src="https://habrastorage.org/webt/1i/cy/ca/1icycakntgog_iqjvi1x7bl_o6e.png"></p><br><p><img src="https://habrastorage.org/webt/te/nw/0w/tenw0wp3cr8--e1dvqyxdm7dohw.png"></p><br><p>  As m√©tricas de leitura de streaming s√£o previsivelmente um pouco melhores que as m√©tricas de grava√ß√£o de streaming. </p><br><p>  Curiosamente, a taxa de atraso para todo o teste √© id√™ntica (linha reta).  Isso n√£o √© um erro; na leitura seq√ºencial em grandes blocos, no nosso caso, isso √© uma situa√ß√£o comum. </p><br><p>  Obviamente, se voc√™ deixar o sistema nesse formul√°rio por algumas semanas, veremos saltos peri√≥dicos nos gr√°ficos que ser√£o associados a fatores externos.  Mas, em geral, eles n√£o afetar√£o a imagem. </p><br><h2 id="vyvody">  Conclus√µes </h2><br><p>  No sistema de controlador duplo AERODISK ENGINE N2, conseguimos extrair indicadores bastante s√©rios (~ 438.000 IOPS e ~ 5-6 gigabytes por segundo).  Os testes de carga mostraram que, para nosso armazenamento, definitivamente n√£o temos vergonha.  Pelo contr√°rio, os indicadores s√£o muito decentes e correspondem a um bom armazenamento. </p><br><p>  Embora, como escrevemos acima, o Engine N2 seja um modelo mais novo e, al√©m disso, os resultados mostrados neste artigo n√£o sejam o seu limite.  Posteriormente publicaremos um teste semelhante em nosso sistema ENGINE N4 mais antigo. </p><br><p>  Naturalmente, no √¢mbito de um artigo, n√£o podemos cobrir todos os testes poss√≠veis; portanto, convidando repetidamente os leitores a compartilhar seus desejos de testes futuros nos coment√°rios, definitivamente os levaremos em considera√ß√£o em publica√ß√µes futuras. </p><br><p>  Al√©m disso, lembramos que este ano estamos envolvidos ativamente em treinamento, por isso convidamos voc√™ a nossos centros de compet√™ncia, onde voc√™ pode receber treinamento em sistemas de armazenamento da AERODISK e, ao mesmo tempo, √© interessante e divertido. </p><br><p>  Informa√ß√µes duplicadas sobre os pr√≥ximos eventos de treinamento. </p><br><ul><li>  Ecaterimburgo  16 de maio de 2019.  Oficina de treinamento.  Voc√™ pode se registrar no link: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://aerodisk.promo/ekb/</a> </li><li>  Ecaterimburgo  20 de maio a 21 de junho de 2019.  Centro de Compet√™ncia.  Venha a qualquer momento para uma demonstra√ß√£o ao vivo dos sistemas de armazenamento AERODISK ENGINE N2.  O endere√ßo exato e o link de registro ser√£o posteriormente.  Acompanhe as informa√ß√µes. </li><li>  Novosibirsk  SIGA AS INFORMA√á√ïES NO NOSSO SITE ou na HABRA. <br>  Outubro 2019 </li><li>  Kazan.  SIGA AS INFORMA√á√ïES NO NOSSO SITE ou na HABRA. <br>  Outubro 2019 </li><li>  Krasnoyarsk  SIGA AS INFORMA√á√ïES NO NOSSO SITE ou na HABRA. <br>  Novembro 2019 </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt451456/">https://habr.com/ru/post/pt451456/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt451442/index.html">Terraform it: revis√£o da Terrag√™nese</a></li>
<li><a href="../pt451446/index.html">Aux√≠lio Visual para Desenvolvimento de Produto: Design</a></li>
<li><a href="../pt451448/index.html">Por que n√£o rastrear pode ser necess√°rio</a></li>
<li><a href="../pt451452/index.html">Build2019, compreendendo o que vimos</a></li>
<li><a href="../pt451454/index.html">Alteramos o conte√∫do do aplicativo de notifica√ß√£o iOS</a></li>
<li><a href="../pt451458/index.html">N√≥s fabricamos um desenvolvedor de jogos. Parte 1</a></li>
<li><a href="../pt451460/index.html">Julia no labirinto</a></li>
<li><a href="../pt451462/index.html">Escreva menos c√≥digo duplicado usando binders no Laravel</a></li>
<li><a href="../pt451464/index.html">Frontend Weekly Digest (6-12 maio 2019)</a></li>
<li><a href="../pt451466/index.html">graphql - armadilhas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>