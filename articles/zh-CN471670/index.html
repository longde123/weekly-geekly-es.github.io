<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšš ğŸ•  ğŸ•¶ï¸ åœ¨æˆ˜æ–—ä¸­å°è¯•Jetpack Composeï¼Ÿ ğŸ‘©ğŸ¼â€ğŸ³ â¬…ï¸ ğŸ±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ€åï¼Œæ‚¨æ— éœ€è‡ªå·±æ„å»ºAndroid Studioå³å¯å°è¯•æ–°çš„Androidå£°æ˜å¼UIæ¡†æ¶ã€‚ ç°åœ¨ï¼ŒJetpack Composeå¯ä»¥ä½œä¸ºGoogle Mavenå­˜å‚¨åº“ä¸­çš„ç¬¬ä¸€ä¸ªå¼€å‘é¢„è§ˆã€‚ æœ‰äº†è¿™ä¸ªæ¶ˆæ¯ï¼Œæˆ‘çš„æ˜ŸæœŸä¸€æ—©æ™¨å¼€å§‹äº†ã€‚ ç«‹åˆ»å°±æƒ³çŸ¥é“ä»–ä»¬ä¸€ç›´åœ¨ç­‰å¾…ä»€ä¹ˆå·¥å…·ã€‚ 





æˆ‘å†³å®šç«‹å³å¼€å§‹è®¤è¯†ï¼Œå¹¶å°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨æˆ˜æ–—ä¸­å°è¯•Jetpack Composeï¼Ÿ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471670/"><p> æœ€åï¼Œæ‚¨æ— éœ€è‡ªå·±æ„å»ºAndroid Studioå³å¯å°è¯•æ–°çš„Androidå£°æ˜å¼UIæ¡†æ¶ã€‚ ç°åœ¨ï¼ŒJetpack Composeå¯ä»¥ä½œä¸ºGoogle Mavenå­˜å‚¨åº“ä¸­çš„ç¬¬ä¸€ä¸ªå¼€å‘é¢„è§ˆã€‚ æœ‰äº†è¿™ä¸ªæ¶ˆæ¯ï¼Œæˆ‘çš„æ˜ŸæœŸä¸€æ—©æ™¨å¼€å§‹äº†ã€‚ ç«‹åˆ»å°±æƒ³çŸ¥é“ä»–ä»¬ä¸€ç›´åœ¨ç­‰å¾…ä»€ä¹ˆå·¥å…·ã€‚ </p><br><p><img src="https://habrastorage.org/webt/f6/rx/jt/f6rxjtulw6xjtuy4ydf2wo_wvcy.png"></p><a name="habracut"></a><br><p>æˆ‘å†³å®šç«‹å³å¼€å§‹è®¤è¯†ï¼Œå¹¶å°è¯•å°†å…¶å¼•å…¥åœ¨Google Playä¸Šå‘å¸ƒçš„å® ç‰©é¡¹ç›®ä¸­ã€‚ è€Œä¸”ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼Œæˆ‘éƒ½æƒ³åˆ¶ä½œä¸€ä¸ªé¡µé¢â€œå…³äºåº”ç”¨ç¨‹åºâ€ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºComposeçš„ä¸»è¦ç»„ä»¶å’Œè¿æ¥æ­¥éª¤ï¼š </p><br><ol><li> ä¾èµ–è¿æ¥ </li><li> ä¸»é¢˜å’Œæ ·å¼ã€‚ ä¸é¡¹ç›®ä¸­ç°æœ‰çš„é›†æˆã€‚ </li><li> è¾…åŠ©åŠŸèƒ½å’ŒUIæµ‹è¯•ã€‚ </li><li>  Viewç»§æ‰¿äººçš„ä¸»è¦ç»„æˆéƒ¨åˆ†å’Œç±»ä¼¼ç‰©ã€‚ </li><li> ä¸å›½å®¶åˆä½œã€‚ </li></ol><br><h2 id="podklyuchenie-zavisimostey"> ä¾èµ–è¿æ¥ </h2><br><p> é¦–å…ˆï¼Œæˆ‘å°†Studioä»3.5æ›´æ–°åˆ°3.5.1ï¼ˆå¾’åŠ³ï¼‰ï¼Œæ·»åŠ äº†åŸºæœ¬ä¾èµ–é¡¹ã€‚ å®Œæ•´çš„åˆ—è¡¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Cyril</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">æ–‡ç« ä¸­</a>çœ‹åˆ°ã€‚ </p><br><pre><code class="plaintext hljs">// build.gradle ext.compose_version= '0.1.0-dev01' //build.gradle  dependencies{ ... implementation "androidx.compose:compose-runtime:$compose_version" kapt "androidx.compose:compose-compiler:$compose_version" implementation "androidx.ui:ui-layout:$compose_version" implementation "androidx.ui:ui-android-text:$compose_version" implementation "androidx.ui:ui-text:$compose_version" implementation "androidx.ui:ui-material:$compose_version" }</code> </pre> <br><p> ç„¶åï¼Œç”±äºFirebaseçš„ç‰ˆæœ¬åˆ†æ•£ï¼Œæˆ‘è¯•å›¾æ”¶é›†æ‰€æœ‰è¿™äº›ä¿¡æ¯ã€‚ ä¹‹åï¼Œæˆ‘é‡åˆ°äº†æ’°å†™éšœç¢ï¼š </p><br><pre> <code class="plaintext hljs">app/src/main/AndroidManifest.xml Error: uses-sdk:minSdkVersion 16 cannot be smaller than version 21 declared in library [androidx.ui:ui-layout:0.1.0-dev01] .../ui-layout-0.1.0-dev01/AndroidManifest.xml as the library might be using APIs not available in 16 Suggestion: use a compatible library with a minSdk of at most 16, or increase this project's minSdk version to at least 21, or use tools:overrideLibrary="androidx.ui.layout" to force usage (may lead to runtime failures)</code> </pre> <br><p> æ˜¯çš„ï¼ŒComposeä»…é€‚ç”¨äºminSdk 21ï¼ˆLolipopï¼‰ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªä¸´æ—¶æªæ–½ï¼Œä½†æ˜¯å¯ä»¥æ”¯æŒæ—©æœŸç‰ˆæœ¬çš„OSã€‚ </p><br><p> ä½†è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ã€‚  Composeå¯ä»¥åœ¨Reflectionä¸Šå·¥ä½œï¼Œè€Œä¸æ˜¯åƒå‰é¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">åœ¨æ­¤å¤„</a>æ‰€è¿°çš„Kotlinç¼–è¯‘å™¨æ’ä»¶ã€‚ å› æ­¤ï¼Œä¸ºäº†ä½¿ä¸€åˆ‡å¼€å§‹ï¼Œæ‚¨è¿˜éœ€è¦æ·»åŠ Kotlin Reflectï¼Œå…·ä½“å–å†³äºï¼š </p><br><pre> <code class="plaintext hljs">implementation "org.jetbrains.kotlin:kotlin-reflect"</code> </pre> <br><p> å¥½å§ï¼Œç”œç‚¹ã€‚  Compose dpä¸ºIntï¼ŒLongï¼ŒFloatå®ç°æ‰©å±•åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½ç”¨inlineå…³é”®å­—æ ‡è®°ã€‚ è¿™å¯èƒ½ä¼šå¯¼è‡´æ–°çš„ç¼–è¯‘é”™è¯¯ï¼š </p><br><pre> <code class="plaintext hljs">Cannot inline bytecode built with JVM target 1.8 into bytecode that is being built with JVM target 1.6. Please specify proper '-jvm-target' option * https://stackoverflow.com/questions/48988778/cannot-inline-bytecode-built-with-jvm-target-1-8-into-bytecode-that-is-being-bui</code> </pre> <br><p> è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨éœ€è¦ä¸ºKotlinæ˜ç¡®æ³¨å†ŒJVMç‰ˆæœ¬ï¼š </p><br><pre> <code class="plaintext hljs">android { â€¦ kotlinOptions { jvmTarget = "1.8" } }</code> </pre> <br><p> å¥½åƒå°±è¿™äº›äº†ã€‚ æ¯”å»ºç«‹è‡ªå·±çš„å·¥ä½œå®¤å®¹æ˜“å¾—å¤šï¼‰ </p><br><p> è®©æˆ‘ä»¬å°è¯•è¿è¡ŒHello Worldï¼ˆä¹Ÿæ¥è‡ªCyrilçš„æ–‡ç« ï¼Œä½†ä¸ä»–ä¸åŒçš„æ˜¯ï¼Œåœ¨Fragmentä¸­æ·»åŠ Composeï¼‰ã€‚ ç‰‡æ®µçš„å¸ƒå±€æ˜¯ä¸€ä¸ªç©ºçš„FrameLayoutã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inflater: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LayoutInflater</span></span></span></span><span class="hljs-function"><span class="hljs-params">, container: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>: View? { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> fragmentView = inflater.inflate(R.layout.fragment_about, container, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) (fragmentView <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ViewGroup).setContent { Hello(<span class="hljs-string"><span class="hljs-string">"Jetpack Compose"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fragmentView } <span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = MaterialTheme { FlexColumn { inflexible { <span class="hljs-comment"><span class="hljs-comment">// Item height will be equal content height TopAppBar&lt;MenuItem&gt;( // App Bar with title title = { Text("Jetpack Compose Sample") } ) } expanded(1F) { // occupy whole empty space in the Column Center { // Center content Text("Hello $name!") // Text label } } } }</span></span></code> </pre> <br><p> æˆ‘ä»¬å¼€å§‹ï¼Œå‡ºç°ä»¥ä¸‹å±å¹•ï¼š </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sg/a2/rz/sga2rzwcg7bxeymvbmllijqxerg.jpeg" alt="å›¾ç‰‡" width="300"></div><br><p> ç”±äºComposableä½¿ç”¨é»˜è®¤çš„Materialä¸»é¢˜ï¼Œå› æ­¤è·å¾—äº†ç´«è‰²çš„AppBarã€‚ å¥½äº†ï¼Œå¹¶ä¸”æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œå®ƒæ ¹æœ¬ä¸åº”ç”¨ç¨‹åºçš„é»‘æš—ä¸»é¢˜ä¸ä¸€è‡´ï¼š </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kb/mb/2u/kbmb2u-8rl7v3snwlcz6gwwtjjk.jpeg" alt="å›¾ç‰‡" width="300"></div><br><p> è®©æˆ‘ä»¬å°è¯•è§£å†³å®ƒã€‚ </p><br><h2 id="temy-i-stili-integraciya-s-suschestvuyuschimi-v-proekte"> ä¸»é¢˜å’Œæ ·å¼ã€‚ ä¸é¡¹ç›®ä¸­ç°æœ‰çš„é›†æˆã€‚ </h2><br><p> ä¸ºäº†åœ¨Composableå†…éƒ¨ä½¿ç”¨ç°æœ‰æ ·å¼ï¼Œæˆ‘ä»¬å°†å®ƒä»¬ä¼ é€’ç»™MaterialThemeæ„é€ å‡½æ•°ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = MaterialTheme(colors = MaterialColors( primary = resolveColor(context, R.attr.colorPrimary, MaterialColors().primary), secondary = resolveColor(context, R.attr.colorSecondary, MaterialColors().secondary), onBackground = resolveColor(context, R.attr.textColor, MaterialColors().onBackground) )){...}</code> </pre> <br><p>  MaterialThemeæœ¬èº«åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šMaterialColorså’ŒMaterialTypographyã€‚ <br> ä¸ºäº†è§£å†³é¢œè‰²ï¼Œæˆ‘åœ¨æ ·å¼ä¸Šä½¿ç”¨äº†åŒ…è£…å™¨ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveColor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@AttrRes</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attrRes: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, colorDefault: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Color</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = context?.let { Color(resolveThemeAttr(it, attrRes).<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.toLong()) } ?: colorDefault <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveThemeAttr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@AttrRes</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attrRes: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: TypedValue { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> theme = context.theme <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> typedValue = TypedValue() theme.resolveAttribute(attrRes, typedValue, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> typedValue }</code> </pre> <br><p> åœ¨æ­¤é˜¶æ®µï¼ŒAppBarå°†å˜ä¸ºç»¿è‰²ã€‚ ä½†æ˜¯è¦é‡æ–°ç²‰åˆ·æ–‡æœ¬ï¼Œæ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹ä¸€é¡¹æ“ä½œï¼š </p><br><pre> <code class="kotlin hljs">Text(<span class="hljs-string"><span class="hljs-string">"Hello </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$name</span></span></span><span class="hljs-string">!"</span></span>, style = TextStyle(color = +themeColor { onBackground }))</code> </pre> <br><p> ä½¿ç”¨ä¸€å…ƒåŠ å·æ“ä½œå°†ä¸»é¢˜åº”ç”¨äºçª—å£å°éƒ¨ä»¶ã€‚ ä¸å›½å®¶åˆä½œæ—¶ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šçœ‹åˆ°å®ƒã€‚ </p><br><p> ç°åœ¨ï¼Œæ–°å±å¹•çœ‹èµ·æ¥ä¸ä¸»é¢˜çš„ä¸¤ä¸ªå˜ä½“ä¸­çš„å…¶ä½™åº”ç”¨ç¨‹åºä¸€è‡´ï¼š </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4q/jy/en/4qjyenwrurz2agzupn9nfvlunmu.jpeg" alt="å›¾ç‰‡" width="300"></div><br><p>  Composeè¿˜åœ¨æºä»£ç ä¸­æ‰¾åˆ°DarkTheme.ktæ–‡ä»¶ï¼Œè¯¥å‡½æ•°å¯ç”¨äºç¡®å®šåœ¨Android På’Œ10ä¸Šæ‰“å¼€é»‘æš—ä¸»é¢˜çš„å„ç§è§¦å‘å™¨ã€‚ </p><br><h2 id="accessibility-i-ui-testy"> è¾…åŠ©åŠŸèƒ½å’ŒUIæµ‹è¯•ã€‚ </h2><br><p> åœ¨å±å¹•å¼€å§‹æ˜¾ç¤ºæ–°å…ƒç´ ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒåœ¨â€œå¸ƒå±€â€æ£€æŸ¥å™¨ä¸­çš„å¤–è§‚ä»¥åŠåœ¨â€œå¼€å‘æ¨¡å¼â€ä¸‹æ‰“å¼€å…ƒç´ è¾¹æ¡†çš„æ˜¾ç¤ºæƒ…å†µï¼š </p><br><p><img src="https://habrastorage.org/webt/x8/ss/x-/x8ssx-qi79amnzbygwwakvfqno0.jpeg"></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ik/l2/qv/ikl2qvufik8cwohrlat5oagyspq.jpeg" alt="å›¾ç‰‡" width="300"></div><br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†çœ‹åˆ°FrameLayoutï¼Œå…¶ä¸­åªæœ‰AndroidComposeViewã€‚ ç°æœ‰çš„Accebilityå’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">UIæµ‹è¯•</a>å·¥å…·ä¸å†é€‚ç”¨å—ï¼Ÿ ä¹Ÿè®¸ä¸æ˜¯å®ƒä»¬ï¼Œè€Œæ˜¯ç°åœ¨æœ‰äº†ä¸€ä¸ªæ–°çš„åº“ï¼š <code>androidx.ui:ui-test</code> ã€‚ </p><br><h2 id="osnovnye-komponenty-i-analogi-naslednikov-view">  Viewç»§æ‰¿äººçš„ä¸»è¦ç»„æˆéƒ¨åˆ†å’Œç±»ä¼¼ç‰©ã€‚ </h2><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•ä½¿å±å¹•ä¿¡æ¯æ›´ä¸°å¯Œã€‚ é¦–å…ˆï¼Œæ›´æ”¹æ–‡æœ¬ï¼Œæ·»åŠ ä¸€ä¸ªæŒ‡å‘Google Playä¸Šçš„åº”ç”¨ç¨‹åºé¡µé¢çš„æŒ‰é’®ï¼Œä»¥åŠå¸¦æœ‰å¾½æ ‡çš„å›¾ç‰‡ã€‚ æˆ‘å°†ç«‹å³å‘æ‚¨æ˜¾ç¤ºä»£ç ä»¥åŠå‘ç”Ÿçš„æƒ…å†µï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AboutScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = MaterialTheme(...) { FlexColumn { inflexible { TopAppBar&lt;MenuItem&gt;(title = { Text(getString(R.string.about)) }) } expanded(<span class="hljs-number"><span class="hljs-number">1F</span></span>) { VerticalScroller { Column { Image() Title() MyButton() } } } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Center { Padding(<span class="hljs-number"><span class="hljs-number">16</span></span>.dp) { Container( constraints = DpConstraints( minWidth = <span class="hljs-number"><span class="hljs-number">96</span></span>.dp, minHeight = <span class="hljs-number"><span class="hljs-number">96</span></span>.dp ) ) { imageFromResource(resources, R.drawable.ic_launcher) } } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Title</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Center { Padding(<span class="hljs-number"><span class="hljs-number">16</span></span>.dp) { Text(getString(R.string.app_name) + <span class="hljs-string"><span class="hljs-string">" "</span></span> + BuildConfig.VERSION_NAME, style = TextStyle(color = +themeColor { onBackground })) } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Center { Padding(<span class="hljs-number"><span class="hljs-number">16</span></span>.dp) { Button(getString(R.string.about_button), onClick = { openAppInPlayStore() }) } } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xx/1o/so/xx1oso944katkc-q5li8ymbylz8.jpeg" alt="å›¾ç‰‡" width="300"></div><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è‡ªä»Composeæºä»£ç é¦–æ¬¡å‡ºç°ä»¥æ¥</a> ï¼Œå°éƒ¨ä»¶ç»„æˆçš„åŸºæœ¬åŸç†å°±æ²¡æœ‰æ”¹å˜ã€‚ </p><br><p> æ¥è‡ªæœ‰è¶£çš„ï¼š </p><br><ul><li> ç”¨äºæ˜¾ç¤ºå•ä¸ªå…ƒç´ çš„åŠŸèƒ½ä¸å¿…ä½¿ç”¨@Composableè¿›è¡Œæ³¨é‡Šã€‚ </li><li> çª—å£å°éƒ¨ä»¶çš„å‡ ä¹æ‰€æœ‰å±æ€§éƒ½å˜æˆäº†å•ç‹¬çš„çª—å£å°éƒ¨ä»¶ï¼ˆå±…ä¸­è€Œä¸æ˜¯androidï¼šé‡åŠ›ï¼Œå¡«å……è€Œä¸æ˜¯androidï¼šè¾¹è·ï¼Œ...ï¼‰ </li><li> æˆ‘æ— æ³•æ˜¾ç¤ºå¯ç»˜åˆ¶å›¾åƒã€‚ </li><li> æŒ‰é’®çš„onClickå‚æ•°ä¸æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå› æ­¤ä¸å¯èƒ½åœ¨æ²¡æœ‰æ˜¾å¼åç§°çš„æƒ…å†µä¸‹å°†å…¶ä½œä¸ºlambdaä¼ é€’ï¼Œè¿™çœ‹èµ·æ¥æ›´åˆä¹é€»è¾‘ï¼š <br><pre> <code class="kotlin hljs">Button(â€œText<span class="hljs-string"><span class="hljs-string">"){ openAppInPlayStore() }</span></span></code> </pre> </li></ul><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬éå†ç°æœ‰çš„ä¸»è¦ViewGroupï¼Œå¹¶å°è¯•åœ¨Composeä¸­æŸ¥æ‰¾ç±»ä¼¼ç‰©ã€‚ </p><br><p> å¯ä»¥ä½¿ç”¨Stackä»£æ›¿FrameLayoutã€‚ è¿™é‡Œçš„ä¸€åˆ‡éƒ½å¾ˆç®€å•ï¼šå­çª—å£å°éƒ¨ä»¶é‡å å¹¶æ ¹æ®é™„ä»¶ä½¿ç”¨çš„åŠŸèƒ½è¿›è¡Œå®šä½ï¼šå¯¹é½ï¼Œå®šä½æˆ–æ‰©å±•ã€‚ </p><br><p>  LinearLayoutç«‹å³è¢«ä¸¤ä¸ªå°éƒ¨ä»¶å–ä»£ï¼šColumnå’ŒRowï¼Œè€Œä¸æ˜¯ä½¿ç”¨androidï¼šdirectionå‚æ•°ã€‚ åè¿‡æ¥ï¼Œå®ƒä»¬åŒ…å«FlexColumnå’ŒFlexRowï¼Œåœ¨åµŒå¥—å­æ ‘ä¸Šå…·æœ‰ä¸çµæ´»çš„åŠŸèƒ½å±‚ã€‚ å¥½å§ï¼ŒFlexColumnå’ŒFlexRowæœ¬èº«æ˜¯åœ¨Flexä¸Šæ„å»ºçš„ï¼Œå…¶å‚æ•°<code>orientation = LayoutOrientation.Vertical</code>æˆ–<code>Horizontal</code> ã€‚ </p><br><p>  FlowColumnï¼ŒFlowRowå’ŒFlowå°éƒ¨ä»¶çš„ç›¸ä¼¼å±‚æ¬¡ç»“æ„ã€‚ å®ƒä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼šå¦‚æœå†…å®¹ä¸é€‚åˆä¸€è¡Œæˆ–ä¸€è¡Œï¼Œåˆ™ä¸‹ä¸€ä¸ªå°†è¢«ç»˜åˆ¶ï¼Œå¹¶ä¸”åµŒå…¥å¼å°éƒ¨ä»¶å°†åœ¨æ­¤å¤„â€œæµåŠ¨â€ã€‚ æˆ‘å¾ˆéš¾æƒ³è±¡è¿™äº›å°éƒ¨ä»¶çš„çœŸæ­£ç”¨é€”ã€‚ </p><br><p> é€šè¿‡å°†Columnæˆ–Rowæ”¾åœ¨VerticalScrolleræˆ–Horizoâ€‹â€‹ntalScrollerå†…ï¼Œå¯ä»¥å®ç°ScrollViewæ•ˆæœã€‚ å®ƒä»¬éƒ½åœ¨Scrollerå†…éƒ¨<code>isVertical = true</code> ï¼Œä¼ å…¥å‚æ•°<code>isVertical = true</code>æˆ–<code>false</code> ã€‚ </p><br><p> ä¸ºäº†å¯»æ‰¾ConstraintLayoutçš„ç±»ä¼¼ç‰©ï¼Œæˆ–è€…è‡³å°‘RelativeLayouté‡åˆ°äº†ä¸€ä¸ªæ–°çš„Tableå°éƒ¨ä»¶ã€‚ æˆ‘è¯•å›¾åœ¨æˆ‘çš„åº”ç”¨ç¨‹åº<a href="" rel="nofollow">DataTableSamples.ktä¸­</a>è¿è¡Œç¤ºä¾‹ä»£ç ã€‚ ä½†æ˜¯ï¼Œç”±äºæˆ‘æ²¡æœ‰å°è¯•ç®€åŒ–ç¤ºä¾‹ï¼Œå› æ­¤æ— æ³•ä½¿å…¶æ­£å¸¸å·¥ä½œã€‚ </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wg/2u/md/wg2umdhpscl3xm3ejubkgcqor-i.jpeg" alt="å›¾ç‰‡" width="300"></div><br><h2 id="rabota-so-state"> ä¸å›½å®¶åˆä½œ </h2><br><p> æ¡†æ¶æœ€ä»¤äººæœŸå¾…çš„åˆ›æ–°ä¹‹ä¸€æ˜¯å®ƒå¯ä»¥ç«‹å³ä½¿ç”¨ï¼Œå¯ä»¥åœ¨åŸºäºå•ä¸€çŠ¶æ€çš„å•å‘æ¶æ„ä¸­ä½¿ç”¨ã€‚ å¹¶ä¸”è¿™åº”è¯¥å¼•å…¥@Modelæ³¨é‡Šæ¥æ ‡è®°æä¾›Stateæ¥å‘ˆç°UIçš„ç±»ã€‚ <br> è€ƒè™‘ä¸€ä¸ªä¾‹å­ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DialogVisibleModel</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> visible: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dismissPushed: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) ... <span class="hljs-meta"><span class="hljs-meta">@Composable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SideBySideAlertDialogSample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openDialog = +state { DialogVisibleModel(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) } Button(text = <span class="hljs-string"><span class="hljs-string">"Ok"</span></span>, onClick = { openDialog.value = DialogVisibleModel(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (openDialog.value.visible) { AlertDialog( onCloseRequest = { <span class="hljs-comment"><span class="hljs-comment">// Because we are not setting openDialog.value to false here, // the user can close this dialog only via one of the buttons we provide. }, title = { Text(text = "Title") }, text = { Text("This area typically contains the supportive text" + " which presents the details regarding the Dialog's purpose.") }, confirmButton = { Button("Confirm", onClick = { openDialog.value = DialogVisibleModel(false) }) }, dismissButton = { if (!openDialog.value.dismissPushed) Button("Dismiss", onClick = { openDialog.value = DialogVisibleModel(true, true) }) else { //hidden } }, buttonLayout = AlertDialogButtonLayout.SideBySide ) } }</span></span></code> </pre> <br><p> è¿™å°†ä¸ºçŠ¶æ€æ¨¡å‹åˆ›å»ºä¸€ä¸ªæ•°æ®ç±»ï¼Œå¹¶ä¸”ä¸å¿…ä½¿ç”¨@Modelæ‰¹æ³¨è¿›è¡Œæ ‡è®°ã€‚ <br> åˆå§‹çŠ¶æ€æœ¬èº«æ˜¯ä½¿ç”¨+ stateåœ¨@Composableå‡½æ•°å†…éƒ¨åˆ›å»ºçš„ã€‚ <br> å¯¹è¯æ¡†çš„å¯è§æ€§ç”±è°ƒç”¨valueå±æ€§è·å¾—çš„æ¨¡å‹çš„visibleå±æ€§ç¡®å®šã€‚ <br> å°±åƒä¸¤ä¸ªæŒ‰é’®çš„onClickä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å°†æ­¤å±æ€§è®¾ç½®ä¸ºæ–°çš„ä¸å¯å˜å¯¹è±¡ã€‚ ç¬¬ä¸€ä¸ªéšè—è‡ªèº«ï¼Œç¬¬äºŒä¸ªéšè—å¯¹è¯ã€‚ é€šè¿‡å•å‡»åœ¨åŒä¸€@Composableå‡½æ•°å†…éƒ¨å®šä¹‰çš„â€œç¡®å®šâ€æŒ‰é’®ï¼Œå¯ä»¥é‡æ–°æ‰“å¼€å¯¹è¯æ¡†ã€‚ <br> å°è¯•ä½¿æ­¤å‡½æ•°å¤–çš„çŠ¶æ€æ—¶ï¼Œå‘ç”Ÿé”™è¯¯ï¼š <br> <code>java.lang.IllegalStateException: Composition requires an active composition context.</code> <br> å¯ä»¥é€šè¿‡åœ¨onCreateViewä¸­åˆ†é…setContent {}å‡½æ•°çš„å€¼æ¥è·å–ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯ä¾‹å¦‚åœ¨Presenteræˆ–é™¤Fragmentæˆ–Activityä»¥å¤–çš„å…¶ä»–ç±»ä¸­å¦‚ä½•ä½¿ç”¨å®ƒæ¥æ›´æ”¹çŠ¶æ€ä»ä¸æ¸…æ¥šã€‚ </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w2/b_/__/w2b___zoyd6ypgp5ji78dpppsqg.jpeg" alt="å›¾ç‰‡" width="300"></div><br><p> è‡³æ­¤ï¼Œæˆ‘ä»¬å¯¹æ–°çš„Jetpack Composeåº“çš„è¯„è®ºç»“æŸäº†ã€‚ è¯¥æ¡†æ¶åœ¨ç»“æ„ä¸Šè¯æ˜äº†å…¶åç§°çš„åˆç†æ€§ï¼Œå°†æ‰€æœ‰ç»§æ‰¿ï¼ˆåœ¨Viewå±‚æ¬¡ç»“æ„ä¸­éå¸¸ä¸ä¾¿ï¼‰æ›¿æ¢ä¸ºâ€œ compositionâ€ã€‚ å…³äºå¦‚ä½•å®ç°æ›´å¤æ‚çš„ViewGroupç±»ä¼¼ç‰©çš„é—®é¢˜ä»ç„¶æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ConstraintLayoutå’ŒRecyclerViewã€‚ æ²¡æœ‰è¶³å¤Ÿçš„æ–‡æ¡£å’Œé¢„è§ˆã€‚ </p><br><p> ç»å¯¹æ¸…æ¥šï¼Œå³ä½¿åœ¨å°å‹æˆ˜æ–—åº”ç”¨ä¸­ï¼ŒComposeä¹Ÿæ— æ³•ä½¿ç”¨ã€‚ </p><br><p> ä½†è¿™åªæ˜¯Dev Previewçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚ è§‚å¯ŸåŸºäºComposeçš„ä¸å·æ”¿åºœå’Œç¤¾åŒºå›¾ä¹¦é¦†åˆä½œçš„æ¦‚å¿µçš„å‘å±•å°†ä¼šå¾ˆæœ‰è¶£ã€‚ </p><br><p> å¦‚æœæ‚¨æ‰¾åˆ°æ›´å¤šæˆåŠŸçš„ä»£ç ç¤ºä¾‹æˆ–æ— æ³•è·å¾—æ¡ˆä¾‹çš„æ–‡æ¡£ï¼Œè¯·åœ¨è¯„è®ºä¸­å†™ä¸‹ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN471670/">https://habr.com/ru/post/zh-CN471670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN471660/index.html">ç©å®¶å¿ƒç†è®²åº§</a></li>
<li><a href="../zh-CN471662/index.html">ç½‘ç»œ-javascriptèº«ä»½éªŒè¯ï¼Œæ··æ·†å’Œæœ¬æœºä»£ç ã€‚ ä½¿ç”¨r0ot-mi Webè§£å†³é—®é¢˜-å®¢æˆ·ç«¯ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN471664/index.html">åœ¨ABBYYå®ä¹ ï¼šæ‚¨å¯ä»¥æˆä¸ºâ€œæ‚¨â€çš„å…¬å¸</a></li>
<li><a href="../zh-CN471666/index.html">ä½“éªŒiOSå¼€å‘äººå‘˜é€šè¿‡å·¥ä½œç­¾è¯ç§»å±…å¾·å›½çš„ç»å†</a></li>
<li><a href="../zh-CN471668/index.html">checkm8æ¼æ´åˆ©ç”¨çš„æŠ€æœ¯åˆ†æ</a></li>
<li><a href="../zh-CN471676/index.html">ç”µè¯éª—å­ã€‚ ç¬¬äºŒæ­¥ï¼Œæˆ‘åˆ†è§£å¹¶è¿è¡Œåˆ°æœ€è¿‘çš„ATM</a></li>
<li><a href="../zh-CN471678/index.html">æŒ‰éœ€æ‰¿æ‹…æœåŠ¡</a></li>
<li><a href="../zh-CN471684/index.html">ä¸ºä»€ä¹ˆéœ€è¦ä¸ºNginxåˆ›å»ºæ¨¡å—</a></li>
<li><a href="../zh-CN471686/index.html">AWSå¦‚ä½•é…¿é€ å…¶å¼¹æ€§æœåŠ¡ã€‚ æœåŠ¡å™¨å’Œæ•°æ®åº“æ‰©å±•</a></li>
<li><a href="../zh-CN471688/index.html">AWSå¦‚ä½•é…¿é€ å…¶å¼¹æ€§æœåŠ¡ã€‚ ç½‘ç»œæ‰©å±•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>