<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚌 ⛽️ 🧢 Une liste exhaustive des différences entre VB.NET et C #. 2e partie 👩🏽‍🤝‍👨🏾 👩🏽‍✈️ 💜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la première partie de l'article, le sujet de la supériorité de VB.NET sur C # en termes de note TIOBE a trouvé une réponse vivante dans les comme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une liste exhaustive des différences entre VB.NET et C #. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/445580/">  Dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">première</a> partie de l'article, le sujet de la supériorité de VB.NET sur C # en termes de note TIOBE a trouvé une réponse vivante dans les commentaires.  Par conséquent, sur les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conseils d'</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">AngReload,</a> regardons les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tendances de</a> StackOverflow. <br><img src="https://habrastorage.org/webt/j-/h5/pb/j-h5pbwyspgmneebz20tzlway28.png"><br>  C # est toujours fort!  La révolution dont on a tant parlé la dernière fois est annulée!  Hourra, camarades!  Ou pas?  La note TIOBE est basée sur les requêtes des moteurs de recherche, et la note SO est basée sur les balises des questions posées.  Peut-être que les développeurs de VB.NET, qui incluent de nombreuses personnes qui n'ont pas de spécialités, ne connaissent tout simplement pas l'existence de StackOverflow?  Ou y être arrivé via Google, ou même Bing, ne comprends pas comment poser une question?  Ou peut-être qu'ils ont suffisamment de documentation Miscrosoft, et toutes les quelques questions ont déjà été répondues. <br><br>  D'une manière ou d'une autre, la part de VB.NET est perceptible et stable, mais pas en premier lieu en termes de volume.  Et, bien sûr, un tel résultat n'aurait pas été possible sans une solide équipe de concepteurs et de développeurs de langage.  Vous trouverez ci-dessous la deuxième partie de la traduction d'un article d'un membre de cette équipe, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anthony Green</a> . <br><a name="habracut"></a><br><h2>  Table des matières </h2><br><div class="spoiler">  <b class="spoiler_title">Texte masqué</b> <div class="spoiler_text"><h4>  Conversions </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">34. Transformations booléennes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">35. Les conversions entre les types Enum, ainsi qu'entre les types Enum et leurs types de base, sont totalement illimitées, même si Option Strict est défini sur On</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">36. Contrôle de dépassement / dépassement négatif pour l'arithmétique entière est complètement contrôlé par l'environnement de compilation (paramètres du projet), mais VB et C # utilisent des valeurs par défaut différentes;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans VB, la vérification du débordement est activée par défaut</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">37. La conversion de nombres à virgule flottante en types entiers utilise l'arrondi bancaire (arrondi des boulangers) plutôt que la troncature</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">38. Ce n'est pas une erreur de convertir des classes NotInheritable vers / depuis des interfaces qu'ils n'implémentent pas au moment de la compilation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">39. Essayer de décompresser (décompresser) null dans un type significatif entraîne une valeur de type par défaut, pas une NullReferenceException</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">40. Unboxing prend en charge les conversions de type primitif</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">41. Il y a des conversions entre String et Char</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">42. Il existe des conversions entre String et Char array</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">43 et 44. Les conversions de String en types numériques et date prennent en charge la syntaxe littérale (généralement)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">45. AUCUNE conversion entre les types Char et Entier</a> </li></ul><br><h4>  Expressions </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">46. ​​Rien &lt;&gt; null</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">47. Les crochets n'affectent pas seulement la priorité d'analyse;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ils reclassent les variables en valeurs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">48. Moi est toujours classé comme signifiant - même dans les structures</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">49. Les méthodes d'extension sont disponibles sous un nom simple.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">50. Les importations statiques ne fusionneront pas les groupes de méthodes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">51 et 52. Qualification partielle du nom et résolution du nom intelligent</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">53. Les méthodes d'ajout de l'initialiseur de collection peuvent être des méthodes d'extension.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">54. La création d'un tableau utilise une limite supérieure, pas une taille</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">55. Les littéraux de tableau VB cf. magic ne sont pas les mêmes que les expressions de création de tableau typées implicitement en C #</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">56. Les champs de type anonyme peuvent être mutables ET sont mutables par défaut</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">57. Ni CType ni DirectCast ne sont exactement la contrainte de type en C #</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">58. La priorité de certains opérateurs «équivalents» ne coïncide pas nécessairement.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">59. La concaténation de chaînes est différente;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">+ et &amp; diffèrent dans le contexte de la concaténation de chaînes;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">+ en VB &lt;&gt; + en C #</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">60. La division fonctionne correctement: 3/2 = 1,5</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">61. ^ pas tout à fait Math.Pow</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">62. Les opérateurs = / &lt;&gt; ne sont jamais égalité / inégalité de liens</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">63. Les opérateurs = / &lt;&gt; pour les chaînes sont différents (et tout autre opérateur de relation dans ce contexte)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">64. Les types significatifs nullables utilisent une logique à trois valeurs (propage null dans les opérateurs de relation)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">65. Les opérateurs surchargés ne correspondent pas toujours à 1: 1</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">66. La fonction () a = b est différente de () =&gt; a = b</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">67. La fonction asynchrone lambda ne sera jamais traitée comme async void lambda</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">68. Les demandes sont réelles (plus réelles) dans VB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">69 et 70. L'instruction As dans la demande From n'appelle pas toujours cast;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">en bonus, l'opérateur 'As' peut invoquer des conversions implicites d'utilisateurs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">71–75.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'instruction Select n'est pas du tout requise, elle peut apparaître au milieu d'une requête, elle peut apparaître plusieurs fois et elle peut déclarer plusieurs variables de plage avec des noms implicites ou explicites</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">76. LA CONCLUSION DEVRAIT ...</a> </li></ul></div></div><br><h2>  Conversions </h2><br><a name="section34"></a><h3>  34. Transformations booléennes </h3><br>  La conversion de la valeur <code>Boolean True</code> en n'importe quel type numérique signé donne <code>-1</code> , et en tout type non signé, elle donne la valeur maximale pour ce type, alors qu'en C # il n'y a pas de telles conversions.  Cependant, la méthode <code>Convert.ToInt32</code> , par exemple, convertit <code>True</code> en <code>1</code> , et c'est ainsi qu'elle est le plus souvent représentée en <code>IL</code> .  Dans le sens opposé, tout nombre autre que <code>0</code> est converti en <code>True</code> . <br><br>  <b>Pourquoi?</b>  La raison pour laquelle VB préfère utiliser de <code>-1</code> à <code>1</code> est que la négation au niveau du bit de 0 (tous les bits sont définis à 0) dans n'importe quelle langue est <code>-1</code> (tous les bits sont définis à <code>1</code> ), donc l'utilisation de cette valeur combine logique et bit à bit des opérations telles que <code>And</code> , <code>Or</code> et <code>Xor</code> . <br>  Les conversions vers et depuis les lignes "Vrai" et "Faux" sont également prises en charge (bien sûr, insensible à la casse). <br><br><a name="section35"></a><h3>  35. Les conversions entre les types Enum ainsi qu'entre les types Enum et leurs types de base sont totalement illimitées, même si Option Strict est réglé sur On </h3><br>  D'un point de vue philosophique, un langage fait référence aux types <code>Enum</code> plutôt comme un ensemble de constantes nommées d'un type entier de base.  L'endroit où cela est le plus évident est l'égalité.  Il est toujours permis de comparer n'importe quel entier avec une valeur d'énumération, alors qu'en C # cela donne une erreur. <br><br>  <b>Heure du</b> conte <b>:</b> L'API Roslyn a subi de nombreuses révisions internes.  Mais dans chacun d'eux, une énumération <code>SyntaxKind</code> été allouée pour chaque langue, qui vous indique quelle syntaxe le nœud représente (par exemple, <code>IfStatement</code> , <code>TryCastExpression</code> ).  Une fois, un développeur a utilisé une API qui a essayé d'abstraire de la langue et a renvoyé l'une des valeurs <code>SyntaxKind</code> , mais uniquement en tant <code>Integer</code> , et sans recevoir d'erreurs lors de la comparaison d' <code>Integer</code> brut et de <code>SyntaxKind</code> , ce développeur est immédiatement venu dans mon bureau et s'est plaint: <i>«int is détail de la mise en œuvre, j'aurais dû être obligé de faire un casting! "</i>  . <br><br>  Au fil des ans, lors de la prochaine révision de l'API, nous avons complètement supprimé les propriétés ( <code>Property Kind As SyntaxKind</code> ), qui pointaient vers un type spécifique à la langue, et toutes les API ont commencé à renvoyer <code>Integer</code> .  Tout le code C # s'est cassé et tout le code VB a continué de fonctionner comme si de rien n'était. <br><br>  Un peu plus tard, nous avons décidé de renommer cette propriété en <code>RawKind</code> et d'ajouter des méthodes d'extension spécifiques au langage <code>Kind()</code> .  Tout le code C # s'est cassé car des parenthèses étaient nécessaires pour appeler des méthodes, mais comme elles n'étaient pas nécessaires dans VB, tout le code VB a continué à fonctionner comme si de rien n'était. <br><br><a name="section36"></a><h3>  36. La vérification du débordement / débordement négatif pour l'arithmétique entière est entièrement contrôlée par l'environnement de compilation (paramètres du projet), mais VB et C # utilisent des valeurs par défaut différentes;  dans VB, la vérification du débordement est activée par défaut </h3><br>  Les types intégraux ont une plage, donc, par exemple, l' <code>Byte</code> peut représenter des valeurs de 0 à 255. Que se passe-t-il donc lorsque vous ajoutez l' <code>Byte</code> 1 à l' <code>Byte</code> 255?  Si la vérification de dépassement / dépassement est désactivée, la valeur défile jusqu'à 0. Si le type est signé, il défile jusqu'au nombre négatif le plus bas (par exemple, -128 pour <code>SByte</code> ).  Cela indique très probablement une erreur dans votre programme.  Si la vérification de dépassement / dépassement est activée, une exception est levée.  Pour comprendre ce que je veux dire, jetez un œil à cette boucle <code>For</code> inoffensive. <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i As Byte = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span> Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code source github</a> <br><br>  Par défaut, cette boucle lèvera une exception dans VB (puisque la dernière itération de la boucle va au-delà de la bordure d' <code>Byte</code> . Mais avec la vérification de débordement désactivée, elle boucle car après 255, je redeviens 0. <br>  Le sous-dépassement est la situation inverse lorsque la soustraction en dessous de la valeur minimale pour le type entraîne la valeur maximale. <br><br>  Une situation de débordement plus courante consiste simplement à ajouter deux chiffres.  Prenez les nombres 130 et 150, tous deux en <code>Byte</code> .  Si vous les assemblez, la réponse est 280, ce qui ne rentre pas dans l'octet.  Mais votre processeur ne le perçoit pas.  Au lieu de cela, il rapporte que la réponse est 24. <br><br>  Soit dit en passant, cela n'a rien à voir avec les conversions.  L'ajout de deux octets donne un octet;  c'est juste la façon dont les mathématiques binaires fonctionnent.  Bien que vous puissiez également obtenir un débordement en effectuant une conversion, par exemple, lorsque vous essayez de convertir Long en entier.  Sans vérifier le débordement, le programme coupe simplement les bits et les trucs supplémentaires autant qu'il tient dans cette variable. <br><br>  <b>Quelle est la différence?</b>  Performance.  La vérification du CLR pour le débordement nécessite un peu plus de temps de calcul par rapport à l'option de non-vérification, comme toutes les autres vérifications de sécurité.  VB est basé sur la philosophie selon laquelle la productivité des développeurs est plus importante que les performances de calcul, donc par défaut, le contrôle de sécurité est activé.  <i>Aujourd'hui, l'</i> équipe de développement C # <i>peut</i> prendre une décision différente sur les paramètres par défaut du projet, mais étant donné que les premiers développeurs C # sont venus de développeurs C / C ++, ce groupe de personnes exigerait probablement que le code ne fasse rien de plus, ce qui pourrait coûter des cycles de processeur ;  <b>c'est une différence philosophique difficile</b> . <br><br>  <b>Nuance:</b> même si la vérification de dépassement / dépassement est désactivée, la conversion des <code>NaN</code> <code>PositiveInfinity</code> , <code>NegativeInfinity</code> , <code>NaN</code> des types <code>Single</code> ou <code>Double</code> en <code>Decimal</code> lèvera une exception, car aucune de ces valeurs ne peut en principe être représentée en Decimal. <br><br><a name="section37"></a><h3>  37. La conversion de nombres à virgule flottante en types entiers utilise les arrondis bancaires plutôt que la troncature </h3><br>  Si vous convertissez 1,7 en entier en VB, le résultat sera 2. En C #, le résultat sera 1. Je ne peux rien dire sur les règles mathématiques en dehors de l'Amérique, mais lorsque je passe d'un nombre réel à un entier, je arrondis instinctivement.  Et aucun de ceux que je connais en dehors du cercle des programmeurs ne croit que l'entier le plus proche de 1,7 est 1. <br><br>  Il existe en fait plusieurs méthodes d'arrondi, et le type d'arrondi utilisé dans VB (et dans la méthode Math.Round) est appelé arrondi par banque ou arrondir les statisticiens par défaut.  Son essence est que pour un nombre au milieu entre deux entiers, VB arrondit au nombre pair le plus proche.  Donc 1,5 est arrondi à 2 et 4,5 est arrondi à 4. Ce qui ne fonctionne pas vraiment comme on nous a enseigné à l'école - on m'a appris à arrondir de 0,5 (techniquement, arrondir de zéro à côté).  Mais, comme son nom l'indique, l'arrondi bancaire a l'avantage qu'avec un grand nombre de calculs, vous divisez en arrondissant en deux et ne donnez pas toujours ou ne gardez pas toujours de l'argent.  En d'autres termes, sur un grand ensemble, cela limite la distorsion des données à l'écart statistique ultime. <br><br>  <b>D'où vient la différence?</b>  L'arrondi est plus intuitif et pratique, tronquant plus rapidement.  Si vous envisagez d'utiliser VB dans les applications LOB, et en particulier dans les applications telles que les macros Excel qui s'exécutent sur VBA, la simple suppression de décimales peut entraîner ... des problèmes. <br><br>  Je pense qu'il est évident que la méthode de conversion est toujours une question controversée et devrait être indiquée explicitement, mais si vous devez en choisir une seule ... <br><br><a name="section38"></a><h3>  38. Ce n'est pas une erreur de convertir des classes NotInheritable vers / depuis des interfaces qu'ils n'implémentent pas au moment de la compilation </h3><br>  De manière générale, si vous recherchez dans une classe NonInheritable une implémentation d'interface, vous pouvez comprendre au moment de la compilation si une telle conversion est possible car vous connaissez toutes les interfaces de ce type et tous ses types de base.  Si le type est hérité, vous ne pouvez pas être sûr qu'une telle conversion est impossible, car le type de l'objet d'exécution référencé peut en fait avoir un type plus dérivé qui implémente cette interface.  Cependant, il existe une exception en raison de l'interopérabilité COM, lors de la compilation, il peut ne pas être visible que le type a quelque chose à voir avec l'interface, mais au moment de l'exécution, il le sera.  Pour cette raison, le compilateur VB génère un avertissement dans de tels cas. <br><br>  <b>Pourquoi?</b>  VB et COM ont grandi ensemble quand ils étaient enfants dans le vieux quartier.  Il existe donc plusieurs solutions dans la conception de langage dans lesquelles VB accorde une grande attention aux choses qui n'existaient que dans COM au moment de la sortie de .NET 1.0. <br><br><a name="section39"></a><h3>  39. Essayer de décompresser (décompresser) null dans un type significatif entraîne une valeur par défaut du type, pas une NullReferenceException </h3><br>  Je crois que techniquement, cela est également vrai pour les types de référence, mais oui: <br><pre> <code class="vbscript hljs"><span class="hljs-built_in"><span class="hljs-built_in">CInt</span></span>(CObj(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  <b>Pourquoi?</b>  Parce que <code>CInt(Nothing) = 0</code> , et le langage a tendance à être quelque peu cohérent, que vous ayez tapé ou non vos variables.  Cela s'applique à n'importe quelle structure, pas seulement aux types significatifs intégrés.  Voir la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">justification au # 25</a> pour plus de détails. <br><br><a name="section40"></a><h3>  40. Unboxing prend en charge les conversions de type primitif </h3><br>  En VB et en C #, vous pouvez convertir <code>Short</code> en <code>Integer</code> , mais qu'en est-il si vous essayez de convertir un <code>Short</code> emballé en <code>Integer</code> ?  Dans VB, <code>Short</code> sera d'abord décompressé puis converti en <code>Integer</code> .  En C #, sauf si vous décompressez manuellement court avant de convertir en <code>int</code> , une <code>InvalidCastException</code> sera levée. <br>  Cela s'applique à toutes les conversions internes, c'est-à-dire les types numériques compressés, les conversions entre les chaînes et les types numériques, les chaînes et les dates (oui, Decimal et Date sont des types primitifs). <br><br>  <b>Pourquoi?</b>  Encore une fois, pour garantir un comportement cohérent, que votre programme soit entièrement tapé, tapé en tant qu'objet ou en cours de refactorisation d'une option à une autre.  Voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="># 39</a> ci-dessus. <br><br><a name="section41"></a><h3>  41. Il y a des conversions entre <code>String</code> et <code>Char</code> </h3><br><ul><li>  <code>String</code> convertie en <code>Char</code> , représentant son premier caractère. </li><li>  <code>Char</code> converti en <code>String</code> seule manière raisonnable. </li></ul><br>  Parce que personne sauf moi ne se souvient de la syntaxe d'un littéral de caractère en VB (et il ne devrait pas). <br><br><a name="section42"></a><h3>  42. Il existe des conversions entre <code>String</code> et <code>Char</code> array </h3><br><ul><li>  <code>String</code> convertie en un tableau de caractères composé de tous ses caractères. </li><li>  Le tableau <code>Char</code> est converti en une <code>String</code> composée de tous ses éléments. </li></ul><br>  Pour être précis: ces transformations créent de nouveaux objets, vous n'avez pas accès à la structure <code>String</code> interne. <br><br>  <b>Histoire amusante:</b> j'ai trouvé (ou peut-être signalé, et je faisais des recherches) un changement de rupture entre .NET 3.5 et 4.0, car entre ces versions, l'équipe .NET a ajouté le modificateur <code>ParamArray</code> au deuxième <code>String.Join</code> surcharge <code>String.Join</code> , qui prend un tableau de chaînes .  Les hypothèses exactes sont perdues dans le temps (probablement pour le mieux), mais, comme je le crois, la raison est qu'avec le modificateur <code>ParamArray</code> vous pouvez maintenant convertir un tableau <code>Char</code> en une chaîne et le passer en tant qu'élément séparé au tableau de paramètres.  Thème amusant. <br><br><a name="section43to44"></a><h3>  43 et 44. Les conversions de String en types numériques et date prennent en charge la syntaxe littérale (généralement) </h3><br><ul><li> <code>CInt("&amp;HFF") = 255</code> </li> <li> <code>CInt("1e6") = 1_000_000</code> </li> <li> <code>CDate("#12/31/1999#") = #12/31/1999#</code> </li> </ul><br>  Cela fonctionne avec les préfixes de base et permet d'utiliser un moyen très pratique pour convertir une entrée hexadécimale (ou octale) en un nombre: <code>CInt("&amp;H" &amp; input)</code> .  Malheureusement, cette symétrie se dégrade au moment d'écrire ces lignes, car le runtime VB n'a pas été mis à jour pour prendre en charge le préfixe binaire &amp; B ou le <code>1_000</code> groupe à <code>1_000</code> chiffres, mais j'espère que cela sera corrigé dans la prochaine version.  La notation scientifique fonctionne, mais sans suffixe de type, et les conversions de date prennent également en charge les formats de date standard, donc le format JSON utilisé dans ISO-8601 fonctionne également: <code>CDate("2012-03-19T07: 22Z") = #3/19/2012 02:22:00 AM#</code> . <br><br>  <b>Pourquoi?</b>  Je ne connais pas d'autre raison que la commodité.  Mais je voudrais <i>vraiment</i> offrir un support pour d'autres formats courants qui sont presque omniprésents dans le réseau aujourd'hui, tels que #FF, U + FF, 0xFF.  Je pense que cela pourrait grandement faciliter la vie dans certains types d'applications ... <br><br><a name="section45"></a><h3>  45. AUCUNE conversion entre les types <code>Char</code> et Entier </h3><br>  <b>QUOI?!?!?</b> <br>  Après avoir lu toutes ces transformations supplémentaires, êtes-vous surpris?  VB interdit les conversions entre <code>Char</code> et <code>Integer</code> : <br><br><ul><li>  <code>CInt("A"c)</code> ne compile pas. </li><li>  <code>CChar(1)</code> ne compile pas. </li></ul><br>  <b>Pourquoi?</b>  On ne sait pas ce qui va se passer.  Habituellement, VB dans de telles situations utilise une approche pragmatique et / ou intuitive, mais pour l'expression <code>CInt("1")</code> je pense que la moitié des lecteurs s'attendraient au chiffre 1 (valeur de caractère 1), et l'autre moitié s'attendrait au chiffre 49 (code ASCII / UTF pour caractère 1).  Au lieu de faire le mauvais choix dans la moitié des cas, VB a des fonctions spéciales pour convertir les caractères en codes ASCII / Unicode et vice versa, <code>AscW</code> et <code>ChrW</code> respectivement. <br><br><h2>  Expressions </h2><br><a name="section46"></a><h3>  46. ​​Rien &lt;&gt; null </h3><br>  Le littéral <code>Nothing</code> dans VB ne signifie pas <i>null</i> .  Cela signifie <i>"la valeur par défaut pour le type</i> pour lequel <i>il est utilisé",</i> et il se trouve que pour les types de référence, la valeur par défaut est nulle.  La différence n'a d'importance que lorsqu'elle est utilisée dans un contexte dans lequel: <br><br><ol><li>  Rien ne prend un type significatif, et ... </li><li>  Il ne ressort pas clairement du contexte qu'il le fait. </li></ol><br>  Regardons quelques exemples qui illustrent ce que cela signifie. <br><br>  Le premier, peut-être un peu étrange, mais je ne pense pas que la plupart des gens seront comblés par la compréhension que ce programme imprimera "Vrai": <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> i = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"True"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code source github</a> <br><br>  La raison est assez simple: vous comparez <code>Integer (0)</code> avec la valeur par défaut de son type (également 0).  Le problème se produit dans VB2005 / 2008 lorsque vous ajoutez des types significatifs nullables.  Jetez un œil à cet exemple: <br><br><pre> <code class="vbscript hljs"> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code source github</a> <br><br>  Compris, comment quelqu'un peut-il suggérer que le type <code>i</code> est un <code>Integer?</code>  ( <code>Nullable(Of Integer)</code> ).  Mais ce n'est pas le cas, car <code>Nothing</code> obtient le type à partir du contexte, et le seul type dans ce contexte provient du deuxième opérande, et il s'agit d'un simple <code>non-nullable Integer</code> (techniquement, <code>Nothing</code> n'a jamais de type).  Une autre façon de voir ce problème est avec l'exemple suivant: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() M(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(i As Integer) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Non-nullable"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(i As Integer?) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Nullable"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">code source github</a> <br><br>  Ici encore, intuitivement, il semble que <code>Nothing</code> ajoute un indice «nullable» et que le langage sélectionne une surcharge qui accepte <code>nullable</code> , mais ce n'est pas le cas (sélectionne <code>non-nullable</code> , car il est «le plus spécifique»).  Au minimum, on peut supposer que, comme null en C #, l'expression <code>Nothing</code> ne s'applique pas du tout à <code>Integer</code> , et que la surcharge nullable sera sélectionnée par la méthode d'exception, mais cela est à nouveau basé sur la mauvaise idée que <code>Nothing = null (Is null?)</code> . <br><br>  <b>Nuance:</b> Une nouvelle expression <code>default</code> a été ajoutée en C # 7.1 qui correspond à <code>Nothing</code> en VB.  Si vous réécrivez les trois exemples ci-dessus en C # en utilisant <code>default</code> au lieu de <code>null</code> , <b>vous obtenez exactement le même comportement</b> . <br><br>  Que peut-on faire à ce sujet?  Il y a plusieurs suggestions, mais aucune n'a encore gagné: <br><br><ul><li>  Afficher un avertissement à chaque fois que <code>Nothing</code> converti en un type significatif et qu'il n'est pas <code>null</code> dans un type significatif <code>nullable</code> . </li><li>  Développez magnifiquement <code>Nothing</code> à <code>0</code> , <code>0.0</code> , <code>ChrW(0)</code> , <code>False</code> , <code>#1/1/0001 12:00:00 AM#</code> <code>ChrW(0)</code> <code>#1/1/0001 12:00:00 AM#</code> ou <code>New T</code> (la valeur par défaut pour toute structure) à chaque fois que sa valeur à l'exécution est l'une des énumérés ci-dessus. </li><li>  Ajoutez une nouvelle syntaxe signifiant "Null, non, vraiment!" Comme <code>Null</code> ou <code>Nothing?</code> </li><li>  Ajoutez une nouvelle syntaxe sous la forme d'un suffixe (?) Qui encapsule la valeur dans nullable pour aider à déduire le type, par exemple <code>If(False, 0?, Nothing)</code> </li><li>  Ajoutez des opérateurs de conversion Nullable pour les types intégrés pour faciliter la fourniture d'indices pour l'inférence de type, par exemple, <code>If (False, CInt? (0), Nothing)</code> </li></ul><br>  J'aimerais avoir votre avis dans les commentaires et / ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur Twitter</a> . <br><br>  Donc, pour résumer: <br><br><ul><li>  Autrefois - VB6 et VBA ont "Nothing", "Null", "Empty" et "Missing", ce qui signifie des choses différentes. </li><li>  2002 - dans VB.NET il n'y a que <code>Nothing</code> (la valeur par défaut dans un contexte spécifique), et en C # - seulement <code>null</code> . </li><li>  2005 - C # ajoute <code>default(T)</code> (une valeur par défaut de type <code>T</code> ), car les génériques nouvellement ajoutés créent une situation où vous devez initialiser une valeur, mais vous ne savez pas s'il s'agit d'un type de référence ou significatif;  VB ne fait rien car ce script est déjà fermé par <code>Nothing</code> . </li><li>  2017 - C # ajoute la <code>default</code> (valeur <code>default</code> dans le contexte) car il existe de nombreux scénarios dans lesquels la spécification de <code>T</code> redondante ou impossible </li></ul><br>  VB continue de résister à l'ajout d'une expression <code>Null</code> (ou équivalent) car: <br><br><ul><li>  La syntaxe va briser le changement. </li><li>  La syntaxe ne cassera pas le changement, mais selon le contexte, cela signifiera différentes choses. </li><li>  La syntaxe sera trop discrète (par exemple, <code>Nothing?</code> );  Imaginez que vous ayez besoin de parler à voix haute de <code>Nothing</code> et de <code>Nothing?</code>  pour expliquer quelque chose à une personne. </li><li>  La syntaxe peut être trop laide (par exemple <code>Nothing?</code> ). </li><li>  Le script d'expression nulle est déjà fermé par <code>Nothing</code> , et cette fonction sera complètement redondante la plupart du temps. </li><li>  Partout, toute la documentation et toutes les instructions doivent être mises à jour pour recommander l'utilisation d'une nouvelle syntaxe, qui déclare fondamentalement <code>Nothing</code> obsolète pour la plupart des scénarios. </li><li>  <code>Nothing</code> et <code>Null</code> se comporteront toujours de la même manière lors de l'exécution en ce qui concerne les liaisons tardives, les transformations, etc. </li><li>  Cela peut être comme une arme à feu dans un coup de couteau. </li></ul><br>  Quelque chose comme ça. <br><br>  <b>Hors sujet (mais lié)</b> <br><br>  Voici un exemple très similaire au second ci-dessus, mais sans inférence de type: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer? = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">code source github</a> <br><br>  Ce programme affiche 0. Il se comporte exactement de la même manière que le deuxième exemple, pour la même raison, mais illustre un problème distinct, quoique connexe.  Intuitivement, qu'est-ce que <code>Dim i as Integer? = If(False, 1, Nothing)</code>  <code>Dim i as Integer? = If(False, 1, Nothing)</code> se comporte comme <code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code>  <code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code> .  Dans ce cas, ce n'est pas le cas, car l'expression conditionnelle <code>(If)</code> ne «transmet» pas les informations du type final à ses opérandes.  Il s'avère que cela décompose toutes les expressions dans VB qui s'appuient sur ce qu'on appelle le typage final (contextuel) ( <code>Nothing</code> , <code>AddressOf</code> , un tableau de littéraux, d'expressions lambda et de chaînes interpolées) avec des problèmes allant de la décompilation en général à la création silencieuse de valeurs incorrectes pour levant bruyamment des exceptions.  Voici un exemple d'une option non compilée: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer? = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> operation As Func(Of Integer, Integer, Integer) = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">True</span></span>, AddressOf Add, AddressOf Subtract) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Add(<span class="hljs-built_in"><span class="hljs-built_in">left</span></span> As Integer, <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> As Integer) As Integer Return <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Subtract(<span class="hljs-built_in"><span class="hljs-built_in">left</span></span> As Integer, <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> As Integer) As Integer Return <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">code source github</a> <br><br>  Ce programme ne se compilera pas.  Au lieu de cela, il signale une erreur dans l'expression <code>If</code> qu'il ne peut pas déterminer le type d'expression lorsque les deux expressions <code>AddressOf</code> sont <code>AddressOf</code> destinées à recevoir des délégués <code>Func(Of Integer, Integer, Integer)</code> . <br><br>     ,     <code>Nothing</code>    null (), <code>Nothing</code>    <code>nullability</code> ()  <code>If(,,)</code>       <code>Nothing</code> (  ) () —    ,    <b></b>  . <br><br><a name="section47"></a><h3> 47.       ;      </h3><br>      «3»: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer = <span class="hljs-number"><span class="hljs-number">3</span></span> M((i)) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(<span class="hljs-keyword"><span class="hljs-keyword">ByRef</span></span> variable As Integer) variable = -variable <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>    C#  «-3».   ,   VB           — ,   <i></i> .       ,      <code>M(3)</code> ,   <code>M(i)</code> ,      <code>i</code>  ,       .  C#     (  )      ,    M   . <br><br>  <b>Pourquoi?</b>  VB <i></i>   .          Quick Basic (Copyright 1985),     .   ,  <i>  </i>     2002 ,     . <br><br> <b> №1:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«    »</a>  ,   Visual Basic .NET. <br> <b> №2:</b>        Roslyn ( ,  <i></i>  ( )     (  )),       :         .  C#       ,       <code>((a + b) * c  a + (b * c))</code> . ,    C#,   C++,  ,      ,    ,    .      : «         VB?»  «       C#?»      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">source.roslyn.io</a>  — <code>BoundParenthesized</code>    VB     C#.  ,   ,      . <br><br><a name="section48"></a><h3> 48. <code>Me</code>     —    </h3><br>  VB.NET      <code>Me</code> .     ,  -  ,    —    ,     Me       Structure    .        Me      .  C#    <code>this</code>  ,     <code>this</code> <i> </i>    . <br><br><a name="section49"></a><h3> 49.       </h3><br>  VB,               ,             : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> C <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M() Extension() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Extension(c As C) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>  C#         (  something.Extension).  ,          C#,         ,   <code>this.Extension()</code> . <br><br>  <b>Pourquoi?</b>   ,               <code>'Me.'</code> , ,         , ,         . VB.NET   .     ,      . <br><br><a name="section50"></a><h3> 50.       (Static imports will not merge method groups) </h3><br> VB   « » (Java-,   C#   VB).  ,     <code>Imports System.Console</code>     <code>WriteLine()</code>      .  2015  C#    .   VB      Shared-   ,  <code>System.Console</code>  <code>System.Diagnostics.Debug</code> ,      <code>WriteLine</code> ,    . C#       ,     ,     . <br><br>  <b>Pourquoi?</b>  ,  ,   VB    ,  C# (   ).    ,                   (      ,  ),  …   ,          . <br><br>  ,  VB       ,  VB        , ,        ,        ,       ,        ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> #6</a> ). VB   .  , VB      2002 . <br><br><a name="section51to52"></a><h3> 51  52.         (Partial-name qualification &amp; Smart-name resolution) </h3><br>      : <br><br><ul><li>   ,    —          (    ).   <code>System</code>  <code>System.Windows.Forms</code> —  ,      ,  <code>System</code>   <code>System.Windows</code>  <code>System.Windows</code>   <code>System.Windows.Forms</code> . </li><li>   ,     ,   ,        .   <code>System</code>  <code>Windows</code> ,  <code>Windows</code>  <code>Form</code> . </li></ul><br>  ,  ,           .       .  VB    Imports   ,  <code>using</code>  C#    . <br><br> ,   VB     <code>System</code> ,          <code>System</code> ,      <code>System</code> .     ,    .      ,    <code>ExtensionAttribute</code> ,   <code>&lt;Runtime.CompilerServices.Extension&gt;</code>  <code>&lt;System.Runtime.CompilerServices.Extension&gt;</code> . <br><br>  C#   . <code>using System</code>   <code>System.Threading</code>       <code>Threading</code> . <br><br>    ,   C#          ,       .  ,     <b></b> <code>System</code> ,           <code>System.Threading</code>  <code>Threading</code> .    ,         ,      ,    ,          . <br><br>    ,  ,   VB,  C# ,          <code>Imports</code> / <code>using</code>  , C#     using    ,         ,     using        . <br><br> <b>    (Quantum Namespaces) ( )</b> <br><br>  ,    !  VB ,      .   ,  <code>System</code>    <code>ComponentModel</code>  <code>System.Windows.Forms</code>    <code>ComponentModel</code> ?  <code>ComponentModel</code>  .   ,        <code>ComponentModel.PropertyChangedEventArgs</code> ,     (  ,          ).     <code>System.Windows.Forms</code> (,  ,     ,         ,   ),        (ambiguity errors). <br><br>   VB2015      (Smart Name Resolution),      <code>System</code>  <code>System.Windows.Forms</code>   <code>ComponentModel</code> ,            ,     <code>System.ComponentModel</code>      <code>System.Windows.Forms.ComponentModel</code> ,      .           ,     ,    ,    ,      .     ,  ,     , .. <code>ComponentModel.PropertyChangedEventArgs</code>   <br> <code>System.ComponentModel.PropertyChangedEventArgs</code> ,   <code>System.Windows.Forms.ComponentModel.PropertyChangedEventArgs</code>  .     ,         . <br><br>       ,        <code>Windows</code>   ,       ( )     ( )    ( ).   <code>WinForms/WPF</code>  <code>UWP</code>        . <br><br><a name="section53"></a><h3> 53.  Add       </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  #33</a> ,  VB - ,      . ,     , —        , : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Contact <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Name As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> FavoriteFood As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> contacts = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Contact) From { {<span class="hljs-string"><span class="hljs-string">"Leo"</span></span>, <span class="hljs-string"><span class="hljs-string">"Chocolate"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Donnie"</span></span>, <span class="hljs-string"><span class="hljs-string">"Bananas"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Raph"</span></span>, <span class="hljs-string"><span class="hljs-string">"The Blood of his Enemies"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Mikey"</span></span>, <span class="hljs-string"><span class="hljs-string">"Pizza"</span></span>} } <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Add(collection As ICollection(Of Contact), name As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, favoriteFood As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) collection.Add(<span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Contact <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Name = name, .FavoriteFood = favoriteFood}) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   GitHub</a> <br><br>  C#       ,          Roslyn C#,    .   ,      ( <b></b> ,    ),        VS2015. <br><br><a name="section54"></a><h3> 54.     ,    </h3><br>    ,      VB   <code>Dim buffer(expression) As Byte</code>  <code>Dim buffer = New Byte(expression) {}</code>     <code>expression + 1</code> . <br><br>       Microsoft BASIC,     <code>DIM</code> ( dimension — ). ,  , ,    :    0  expression.     Microsoft BASIC          1 (        ,  1984),         (   ),      2002 . <br><br>    ,     -          ,  ,    VB     ,   BASIC   C     ,    ,    C,      C- .   ,   <code>buffer(10)</code>     0  10,    9! <br><br><a name="section55"></a><h3> 55.   VB <s>- </s>    ,        C# </h3><br>            ,   .     ,    VB      ( )     ,     —    .    : <br><br><ul><li> <code>CType({1, 2, 3}, Short())</code> <b></b>  <code>CType(New Integer() {1, 2, 3}, Short ())</code> ,     <code>Integer</code>   <code>Short</code> . </li><li> <code>CType({1, 2, 3}, Short())</code>     <code>New Short() {1, 2, 3}</code> .  . </li></ul><br>      ,   ,     VB   ,        C#. ,  : <br><br><ul><li> <code>Dim empty As Integer() = {}</code> </li> </ul><br>    : <br><br><ul><li> <code>Dim array As Predicate(Of Char)() = {AddressOf Char.IsUpper, AddressOf Char.IsLower, AddressOf Char.IsWhitespace}</code> </li> </ul><br>    (  ): <br><br><ul><li> <code>Dim byteOrderMark As Byte() = {&amp;HEF, &amp;HBB, &amp;HBF} '   </code> . </li></ul><br>          ,    <code>IList(Of T)</code> , <code>IReadOnlyList(Of T)</code> , <code>ICollection(Of T)</code> , <code>IReadOnlyCollection(Of T)</code>  <code>IEnumerable(Of T)</code> ,          ,     ,    <code>ParamArray IEnumerable</code> . <br><br>  <b>Pourquoi?</b>      ,            VB.    ,    .       2008  VB  C#         «» {},        -    ( ,  , ). ,      ,       ,          +   ,       .   . <br><br><a name="section56"></a><h3> 56.         </h3><br>      ,     LINQ.        ,    . <br><br>   ,   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . <br><br><a name="section57"></a><h3> 57.  CType,  DirectCast        C# </h3><br>      /  VB  C#. <br> VB <code>CType</code> : <br><br><ul><li>   ; </li><li>    (   ); </li><li>   , , <code>Long</code>  <code>Integer</code> (.  «»); </li><li>  (unboxes)    ; </li><li> <b></b>    ; </li><li> <b></b>    (  <code>CTypeDynamic</code> ). </li></ul><br> VB <code>DirectCast</code> : <br><br><ul><li> <b></b>   ; </li><li>   ; </li><li> <b></b>    (   <code>Integer  Byte</code> ); </li><li>     ; </li><li>     (  ); </li><li> <b></b>   . </li></ul><br>   C# — <code>(Type)expression</code> : <br><br><ul><li>   ; </li><li>   ; </li><li>   ; </li><li>     ; </li><li>    ; </li><li>   . </li></ul><br>    <code>CType</code>      C#   ,         .   ,       .  VB  C#     ,                IL   .      <i></i>    ,   C#,          ,           .    . <br><br>  ,    <code>CType</code> ,     (,        ). <code>CType</code>   ,   <code>DirectCast</code> ,   .  ,      ,        IL   :    <code>Object</code> ( <code>ValueType</code> )       CLR «unbox»     VB-,   ,                 (,  <code>Short</code>  <code>Integer</code> ).  ,      ,   C#.           .         ,      . <br><br>  <b>Pourquoi?</b>    .     ,   ,   ,    ,    . <br><br><a name="section58"></a><h3> 58.   «»     </h3><br>       ,       ,  <code>5 Mod 2 * 3</code>   5  VB,  «»   C# <code>5 % 2 * 3</code>   3. <br><br>   , ,      .        ,       (,   (\)  VB),    ,           ,    <b>  </b> . <b> !</b> <br><br><a name="section59"></a><h3> 59.   ; +  &amp;     ; +  VB &lt;&gt; +  C# </h3><br>     ,  + ()  &amp; ()  VB       +  C#. <br> <b> <code>String</code>   :</b> <br> <b>VB</b> <br><br><ul><li> “1” + 1 = 2.0 </li><li> “1” &amp; 1 = “11” </li></ul><br> <b>C#</b> <br><br><ul><li> «1» + 1 == «11» </li></ul><br> <b>   ,    +  &amp;</b> <br> <b>VB</b> <br><br><ul><li> “obj: “ + AppDomain.CurrentDomain ' Error: + not defined for String and AppDomain. </li><li> ”obj: “ &amp; AppDomain.CurrentDomain ' Error: &amp; not defined for String and AppDomain. </li><li> ”obj: “ + CObj(AppDomain.CurrentDomain) ' Exception, no + operator found. </li><li> ”obj: “ &amp; CObj(AppDomain.CurrentDomain) ' Exception, no &amp; operator found. </li></ul><br> <b>C#</b> <br><br><ul><li> «obj: » + AppDomain.CurrentDomain == «obj: » + AppDomain.CurrentDomain.ToString() </li><li> «obj: » + (object)AppDomain.CurrentDomain == «obj: » + AppDomain.CurrentDomain.ToString() </li><li> «obj: » + (dynamic)AppDomain.CurrentDomain == «obj: » + AppDomain.CurrentDomain.ToString() </li></ul><br> <b>  :</b> <br> <b>VB</b> <br><br><ul><li> 1 + 1 = 2 </li><li> 1 &amp; 1 = “11” </li></ul><br> <b>C#</b> <br><br><ul><li> 1 + 1 == 2 </li></ul><br> <b>  String  Enum:</b> <br> <b>VB</b> <br><br><ul><li> “Today: ” + DayOfWeek.Monday ' Exception: String «Today: » cannot be converted to Double. </li><li> “Today: ” &amp; DayOfWeek.Monday = “Today: 1” </li><li> “Today: ” &amp; DayOfWeek.Monday.ToString() = “Today: Monday” </li></ul><br> <b>C#</b> <br><br><ul><li> «Today: » + DayOfWeek.Monday == «Today: Monday» </li></ul><br> <b> :</b>    ,  +         VB,   -  . +   ,        ,   - .  Pourquoi?  : <br><br><ul><li> “10” — “1” = 9.0, </li><li> “5” * “5” = 25.0, </li><li> “1” &lt;&lt; “3” = 8,  </li><li> “1” + 1 = 2.0,  </li><li> “1” + “1” = “11” </li></ul><br>        .   —    . <br><br> <b>:</b>   +,    <i></i>    .     ,  &amp;,      ,     ( <b></b> ,   ).  ,      ,          . <br><br><a name="section60"></a><h3> 60.   : 3 / 2 = 1,5 </h3><br>       —       : <i>«     ?»</i>  .    «».           : <i>« .      ?»</i> <br>        VB  C#. <br><br>       C, ,  ,     <i>«  5    9?»</i> ,     \.   ,  ,   ,       ,     0 (   ,   -   <code>INumeric</code> ). <br><br><a name="section61"></a><h3> 61. ^   <code>Math.Pow</code> </h3><br>        <code>Math.Pow</code> .   ,         .  ,    ( <code>custom</code> )      (  , <code>System.Numerics.BigInteger</code> ). <br><br> <b>:</b> F#        **,     VB  F#   : <code>op_Exponent</code>  <code>op_Exponentiation</code> .  F#      <code>Pow</code>   .         .  ,       . <br><br><a name="section62"></a><h3> 62.  =/&lt;&gt;    /  </h3><br>  C# '=='   ()  ,   ,      (          ).  VB        . VB    ( <code>Is/IsNot</code> )   . <br><br> <b> :</b>  -    Roslyn     ,     .         .          .   VB        ,   =   ,    C#  ,     ,       ,        . <br><br><a name="section63"></a><h3> 63.  =/&lt;&gt;    (       ) </h3><br>    VB    . <br><br> -,      (  )  - (  ),   ,        <code>Option Compare Binary</code>  <code>Option Compare Text</code> . <code>Option Compare Binary</code> , ,         VS. <br><br>          (   ),    ,    <i></i>  API.  : <br><br><ul><li> /: “A” = “a”/“A” &lt;&gt; “a” </li><li> : “A” &gt; “a” </li><li>  <code>Select Case: Select Case “A” : Case “a”</code> </li></ul><br>  : <br><br><ul><li>  <code>Equals: “A”.Equals(“a”)</code> </li><li>  <code>Contains: ”A”.Contains(“a”)</code> </li><li>   <code>Distinct: From s In {“A”, “a”} Distinct</code> </li></ul><br>    ,    ,    :   VB      .  ,    <code>Option Compare</code> ,    «Empty». <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> s As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> s = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Empty"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>    s = ""  VB —    <code>String.IsNullOrEmpty(s)</code> . <br>  ,          ,     ,  ,        ,  .       ,      ,       . <br><br>  <b>Pourquoi?</b>   <code>Option Compare Text</code>    ,   ,    .   ,   ,       . <br>   ,   ,    ,  ,     . <br><br>  ,   ,     .   ,          . ,   ,    (collation)     SQL Server,      .   ,   VB      VB6,   VBA   Office,   Excel  Access,  VBScript  Windows,   -,  -…         .   ,  ,  .NET API     ,    Option Compare Text,        .    ,      .NET API,            . <br><br>   null,    ,    .  VB6    .     <code>String</code>  "".  , VB           <code>String</code>   .            VB,   <code>Left</code>  <code>Mid</code> ,   <code>String</code> .     null   .   <code>Len(CStr(Nothing)) = 0</code>  <code>Left(CStr(Nothing)</code> , <code>5) = ""</code> ,  <code>CStr(Nothing).Length</code>  <code>CStr(Nothing).Trim()</code>  . <br><br>  ,           <code>?</code>  . (       ). <br><br> <b>  :</b> <br>      ,     ,       ,        .   !    VB   ,   ,    <code>"String A" = "String B"</code> ,     <code>Microsoft.VisualBasic.CompilerServices.Operators.CompareString</code> ,         -    ,         ,     .     LINQ-      .      ,         VB (     ).   ,        ,  -    ,    .    LINQ-to-SQL, LINQ-to-Entities   ,         Microsoft.   ,   VB    ,  ! <br><br>    ,        C#,       VB,  LINQ   .  : 1)  ,  VB   ,   ,  2)  ,  VB  ,   ,     LINQ-.   ,      VB (). <br><br> <b>:</b>  ,    «  API».   <code>Option Compare</code>           VB,   <code>InStr.Replace</code>     <code>Microsoft.VisualBasic.Strings</code> .  ,          ? <br><br> ,  ,                 ,    ? ,  ,     ,        :   ,      ,   . <br><br><a name="section64"></a><h3> 64. Nullable      ( null   ) </h3><br> VB  C# -  nullable.  ,     (null-propagation). <br><br>      SQL, , ,      null.   ,      (, +),         null,      null.    <code>"?."</code> :    <code>obj?.Property obj</code>  null,       null,   . <br><br>   nullable       ,  VB,  C#  .     -   :  . <br><br>  VB,     nullable  ,      null,     null   .   1 + null  null  null + null  null.        ,      (, =  &lt;&gt;)      C#: <br><br><ul><li>    VB,  <code>Is/IsNot</code> ,  <code>Boolean?</code> </li><li>    C# (==, !=, &gt;, &lt;, &gt;=, &lt;=)  <code>bool</code>  <code>bool?</code> </li></ul><br>  VB (    nullable  )  null     <b> null</b> .     <code>Boolean</code>  =  <code>Boolean?</code> ,     <code>True</code> , <code>False</code>  <code>null</code> .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> .  C#    <code>non-nullable bool</code> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> . <br><br>  ,    <b></b> .      null.    VB <b>NULL</b> = <b>NULL</b> —  <b>NULL</b> ,   TRUE. <br> ,      : <br><img src="https://habrastorage.org/webt/rv/79/03/rv7903incqlt1soaqgm9dnxravg.png"><br>    . <b>Null  ,   ,    ,      <u></u>    C#</b> . <br><br>     .   C#   VB,      <i>«    null?»</i>  C# <code>(if (value == null))</code>    .  VB   ,   VB        (=/&lt;&gt;)     <code>(Is/IsNot)</code> ,         VB <code>Is Nothing</code>   <code>non-nullable Boolean</code> . <br><br>      ,    VB    null,     null.     <code>And/AndAlso</code>  <code>Or/OrElse</code> . <br><br>     <code>Integer?</code> (  ),  VB,  C#  null,    : <br><br><ul><li> 1 AND NULL  NULL </li><li> 1 OR NULL  NULL </li></ul><br>     <code>Boolean?</code> ,  VB  . <br><br><ul><li> FALSE AND NULL  FALSE </li><li> TRUE OR NULL  TRUE </li><li> TRUE AND NULL  NULL </li><li> FALSE OR NULL  NULL </li></ul><br>  , <b>  <code>True/False</code>        ,    , <u></u>     null.</b>   ,      <code>AndAlso</code>  <code>OrElse</code>   . <br><br>  C#         (&amp;&amp;/||)   (&amp;/|)   <code>nullable boolean (bool?)</code> .    ,    ,       non-nullable boolean   nullable boolean         . <br><br> <b>   ?</b> <br>   VB  ,  -   : <br><br><pre> <code class="vbscript hljs">Imports System.ComponentModel <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> BindableRange Implements INotifyPropertyChanged <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> _EndDate As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> EndDate As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> Return _EndDate <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(value As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>?) <span class="hljs-comment"><span class="hljs-comment">' This line here: If value = _EndDate Then Return _EndDate = value RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(NameOf(EndDate))) End Set End Property Public Event PropertyChanged As PropertyChangedEventHandler _ Implements INotifyPropertyChanged.PropertyChanged End Class Module Program WithEvents Range As New BindableRange Sub Main() Range.EndDate = Today Range.EndDate = Today Range.EndDate = Nothing Range.EndDate = Nothing End Sub Private Sub BindableRange_PropertyChanged(sender As Object, e As PropertyChangedEventArgs) _ Handles Range.PropertyChanged Console.WriteLine(e.PropertyName &amp; " changed.") End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   GitHub</a> <br><br> , , , ,     «EndDate change»    . ,  ,  <b> VB null    </b> ?      ,    <code>EndDate</code> ,       ,      ,      <code>Nothing</code> . <br><br>     VB  : <i>«,  ,   .   »</i> : <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value &lt;&gt; _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> _EndDate = value RaiseEvent PropertyChanged(<span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> PropertyChangedEventArgs(NameOf(EndDate))) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span></code> </pre> <br> <b>    !</b>           .     ,     <b>  non-nullable   </b> .     , <b>   </b> .   ,   : <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> AndAlso _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value &lt;&gt; _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return</code> </pre> <br> <b>     ?</b> <br>  ,   C#      ,         VB.     (  nullable  ,    ),         ,    null. <br><br>      null —  <b>  «»  « »</b> .         . <br><br>     <b>null  « »  «»</b> .   ,     ,    :          comparer,   ,    comparer  .        Roslyn,         <code>Optional(Of T)</code> ,         ,        ,     null,  ,     . <br><br>      , NULL  « »,      VB  : <br><br><ul><li>    , <b>« ,   ?»</b>     «  ». </li><li> : <i>«       ,      ?»</i> «  ». </li></ul><br> , ,    <b>     SQL- </b> .  ,     NULL  SQL   ,     NULL.        . ,     ,   NULL    .   ,       .     ,      ,   ( ).   ,       ,          ,     ,   ,   NULL   ,     SQL ( ). <br><br>     VB. <b>      nullable    2008 ,   VB      ?</b> <br> LINQ to SQL <br><br>  VB     ,  , ,   ,  ,    ,     LINQ-     .     ! <br><br>   .  SQL Server,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SET ANSI_NULLS OFF</a> ,   SQL-      C#,      <code>WHERE Column = NULL</code> . , ,        OFF (       ).       SQL Server (  )  .  : <i>«    ?   .    ,      -  Option ANSI_NULLS Off  VB.NET?»</i>  .         : <br><br><img src="https://habrastorage.org/webt/-q/hc/zl/-qhczlj3yptkha7zt5oz5_4mfi0.png"><br><br> ,      ,     ,    ,   ,  SQL Server,     VB. <br>  Quelque chose comme ça. <br><br><a name="section65"></a><h3> 65.      1:1 </h3><br>  ,  VB    ,       , ,    .       VB  -   ,    . <br><br> ,  ,        , ,          .    VB    ,    ,      ,    ,    , VB     . <br><br>  9.8.4      . <br><br><a name="section66"></a><h3> 66. Function() a = b   () =&gt; a = b </h3><br>        .    ,   <code>() =&gt; expression</code>  C#    <code>Function() expression</code>  VB.   <code>Function()</code>    -,  - ,       VB.       <code>a = b</code>    ,   <code>a</code>  <code>b</code> ( <code>Boolean</code> ),    <code>b</code>  <code></code> .  -   (delegate relaxation) VB       ( -)   Sub- (   ).         .   <code>() =&gt; a = b</code>  C#  VB —  <code>Sub() a = b</code> .   —  - <b></b> ,             . <br><br>    =,   ,   .    (  <code>Sub</code> -)   ,    (  <code>Function</code> -)   . <br><br><a name="section67"></a><h3> 67.  <code>Async Function</code>       <code>async void</code> </h3><br>  C#   <code>async</code> -,     ,  ,    <code>Task</code>  <code>void</code> ,        ,  <code>Task</code> ,   . <br><br>  VB.NET   , ..  <code>void Async</code>    <code>Async Sub</code> ,   <code>Task</code>  <code>Task(Of T)</code> —   <code>Async Function</code> .   ,   ,     VB,   (relaxing) <code>Task Async</code>   <code>void</code>        .   <b></b>     <code>Async Sub</code> ,       ,    . <br><br><a name="section68"></a><h3> 68.   ()  VB </h3><br>     ,      VB: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo <span class="hljs-comment"><span class="hljs-comment">'Function [Select](Of T)(selector As Func(Of String, T)) As Foo ' Return Me 'End Function Function Where(predicate As Func(Of String, Boolean)) As Integer Return 0 End Function End Class Module Program Sub Main() Dim c As New Foo Dim q = From x In c Where True Select x End Sub End Module</span></span></code> </pre> <br> <a href="">   GitHub</a> <br><br>         VB,  <i></i>  C#. -,  <code>Foo</code>    <code>Select</code> ,         ,          <code>Where</code> .      <code>Select</code> ,    ,      <code>Select</code> ,   <code>Integer</code>      .   C#     ,        <code>.Where</code> ( <code>Select</code> ).        ,    ,   . <br><br>            LINQ  API.  ,     VB  C#, .  ,  C#   ,      « »,  ,              ,       ,   .  -   ,   «»  ,     ,      -. <br><br>   ,  VB    <b></b>        ,        ,  C#          ,     . <br><br>  ,      Roslyn, : <b>«    (range variables)?»  «     ?»</b>  .        . ,  VB      ,     <code>Let</code> ,   C# — .      ,         VB,    C# 2012   ,   : <br><br><pre> <code class="vbscript hljs">using System; using System.Collections.Generic; using System.Linq; using System.Text; namespace CSharpExamples { struct Point { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { return <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { return <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Foo { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable&lt;Point&gt; <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>&lt;T&gt;(Func&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, T&gt; selector) { return <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } } static <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Program { static void Main(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>[] args) { var c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Foo(); var q = from X <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Y = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> Y.CompareTo(<span class="hljs-number"><span class="hljs-number">-1</span></span>); } } }</code> </pre> <br> <a href="">   GitHub</a> <br><br>  ,    — ?    X,   — <code>string</code> .   <code>let</code>     <code>Y</code> ,     string.         ,      Point,     <code>X</code>  <code>Y</code>    ,     ,     <code>int</code>      <code>X</code>  <code>Y</code> , «»  .        <code>Y</code>   <code>select</code> ,    <code>int</code>   <code>int</code> `,  … . <br><br>      ,   <i>«        ?»</i>  .  VS2015  C#  ,   «».   ,  Roslyn         C#,       .          ,          (  ,   ),    -  . <br><br>  <b>Pourquoi?</b>                     ,    ,    ,      .   ,         ,   VB  C#          . <br><br><a name="section69to70"></a><h3> 69  70.  <code>As</code>   <code>From</code>    <code>cast</code> ;     <code>'As'</code>      </h3><br> (     , …) <br><br>    <code>From x As Integer In y</code>  VB,      ,   <code>from int x in y</code>  C#. <br><br> -,  C#     ,    ( )  .    <code>.Cast&lt;T&gt;()</code> .  VB      ,    ,  ,       ,   . <br><br> -,    ,      <code>.Cast</code> (   ).      ,      ,       ,       <code>.Cast</code>  <code>.Select</code> . <br><br>  <b>Pourquoi?</b>  .   VB  . ,    <code>For Each x As T In collection</code> ,  <code>As T</code>          .      <code>From</code>   <code>As</code>    <code>For Each</code> ( ,    <code>As</code> ). <br><br><a name="section71to75"></a><h3> 71-75.  <code>Select</code>   ,     ,                </h3><br>  Par exemple: <br><br><ul><li> <code>From x In y Where x &gt; 10</code> .   ,  <code>Select</code> . </li><li> <code>From x In y Select x Where x &gt; 10</code>  . </li><li> <code>From x In y Select x</code>      ,   <code>From x In y Select x = x</code> ,  <code>x</code>  —       <code>x</code> ,  <code>x</code>  —       <code>Select</code> .  <code>Select</code>  <code></code>    . </li><li> <code>From x In y Select z = x.ToString()</code> ,  <code>x</code>  . </li><li> <code>From x In y Select x.FirstName</code>      ,   <code>From x In y Select FirstName = x.FirstName</code> . </li><li> <code>From x In y Select x.FirstName, x.LastName</code> —   <code>From x In y Select New With {x.FirstName, y.LastName}</code> ,   ,       .               <code>IEnumerable(Of $AnonymousType$)</code> ,         . </li></ul><br>  <b>Pourquoi?</b>    ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Amanda Silver</a> ).    ! <br><br><ul><li>  ,  <code>Select</code>    ,      SQL  ,  <code>Select</code>   ,       .      LINQ  VB       Select ,   SQL,        From   . </li><li>  ,     ,      . </li><li>  ,     <code>Select</code>   ,        SQL,       - -        .   VB     comma separated ( )  -. </li><li>  ,  <code>Select</code>   ,       ,     ,    ,  ,     ,          ,         —   . </li></ul><br> <b>   ?</b>  ,   ,  - ,         ,  : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> numbers = {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>} <span class="hljs-comment"><span class="hljs-comment">' BC36606: Range variable name cannot match the name of a member of the 'Object' class. Dim q = From n In numbers Select n.ToString() End Sub End Module</span></span></code> </pre> <br> <a href="">   GitHub</a> <br><br> <code>BC36606: Range variable name cannot match the name of a member of the 'Object' class</code>  <code>BC30978: Range variable '…' hides a variable in an enclosing block or a range variable previously defined in the query expression</code> —             ,     <code>Object</code> ,        ,   ,     ,   .       ( <code>n.ToString()</code> ),      .   ,            . <br><br><a name="section76"></a><h3> 76+.       </h3><br>        . …  … . …  20-25     ( <i>       — ..</i> ). <br><br><blockquote>  Minute de publicité. 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr445580/">https://habr.com/ru/post/fr445580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr445562/index.html">Bloomberg: McDonald's achètera un développeur de menu de technologie de personnalisation pour 300 millions de dollars</a></li>
<li><a href="../fr445566/index.html">Publication d'un projet de loi sur les profils numériques des Russes</a></li>
<li><a href="../fr445568/index.html">Surveillance et gestion à distance des périphériques Linux / OpenWrt / Lede via le port 80 ...</a></li>
<li><a href="../fr445570/index.html">Le condensé des événements pour les professionnels des RH dans le domaine des TI pour avril 2019</a></li>
<li><a href="../fr445572/index.html">Le gouvernement américain prévoit d'envoyer des gens sur la lune dans 5 ans</a></li>
<li><a href="../fr445582/index.html">Systèmes CRM: protection ou menace?</a></li>
<li><a href="../fr445584/index.html">OS1: un noyau primitif sur Rust pour x86. Partie 2. VGA, GDT, IDT</a></li>
<li><a href="../fr445586/index.html">Android Academy à Moscou - parler de comment c'était et partager des supports de cours</a></li>
<li><a href="../fr445588/index.html">Le scan 3D d'une personne en 30 secondes sera montré à l'exposition</a></li>
<li><a href="../fr445590/index.html">Grammaire anglaise. Qui vs Qui - comment comprendre quel mot utiliser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>