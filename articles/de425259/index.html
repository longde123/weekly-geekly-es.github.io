<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤳🏿 👨🏾‍✈️ 🕒 Sichern Sie Ihre Site mit git und Makefile 💯 👨🏼‍🚀 👩‍❤️‍💋‍👩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durch die Übersetzung einer Site in eine Reihe statischer Webseiten können Sie die Belastung des Servers verringern oder sogar den freien Speicherplat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sichern Sie Ihre Site mit git und Makefile</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425259/"><p>  Durch die Übersetzung einer Site in eine Reihe statischer Webseiten können Sie die Belastung des Servers verringern oder sogar den freien Speicherplatz nutzen sowie die Zuverlässigkeit, Geschwindigkeit und Sicherheit der Site erhöhen.  In diesem Artikel werde ich darüber sprechen, wie dies mit den bekannten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Git-</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Makefile-</a> Tools gemacht wird.  Ein Plus dieses Ansatzes ist die Möglichkeit, Versionen von Webseiteninhalten zu steuern. </p><br><p>  In diesem Artikel wird beschrieben, wie statische Versionen von Webseiten für die Serverausgabe erstellt und zur Versionskontrolle und Sicherung in ein Repository gestellt werden.  Gleichzeitig können statische und Mediendateien getrennt gespeichert und auf andere Weise archiviert werden (statische Dateien werden normalerweise im Repository für den Programmcode der Site abgelegt).  Die Methode funktioniert auch für Seiten mit Unicode-Namen (z. B. für kyrillische Domänen).  Am Ende steht ein funktionierendes Makefile. </p><br><p>  Der Autor verwendet den Stapel django / uwsgi / nginx, einen virtuellen dedizierten Server unter GNU / Linux. Der Inhalt des Artikels ist jedoch nahezu unabhängig von bestimmten Technologien. </p><a name="habracut"></a><br><h3 id="zagruzhaem-stranicy">  Seiten laden </h3><br><p>  Wir werden die Seiten der Site mit dem Standard- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wget-</a> Programm speichern.  Wir speichern jede Site in einem separaten Verzeichnis (das möglicherweise nicht mit dem Domainnamen der Site verknüpft ist). </p><br><p>  Innerhalb jedes Verzeichnisses werden Seiten rekursiv mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Taste wget</a> <em>-r</em> gespeichert (es wird davon ausgegangen, dass auf alle Seiten über Links von der Hauptseite aus zugegriffen werden kann).  Standardmäßig geht das rekursive Kopieren auf Stufe 5, dies kann jedoch mit der <em>Option -l</em> geändert werden. </p><br><p>  Wenn wir Medien und statische Dateien getrennt von Textseiten speichern, werden die entsprechenden Verzeichnisse mit dem Schalter <em>-X</em> ignoriert. </p><br><p>  Der vollständige Befehl sieht folgendermaßen aus: </p><br><pre><code class="bash hljs">mkdir primer <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> primer wget -r -nH -X ,static --restrict-file-names=nocontrol .</code> </pre> <br><p>  <em>-nH</em> bedeutet <em>--no-Host-Verzeichnisse</em> .  Standardmäßig legt <em>wget -r example.com</em> alles im Verzeichnis <em>example.com/ ab. Mit</em> dieser Option wird die Erstellung des Verzeichnisses mit dem Hostnamen abgebrochen. </p><br><p>  Die Option <em>--restrict-file-names</em> gibt an, dass beim Erstellen lokaler Dateien Zeichen in der URL <em>maskiert</em> werden.  Ein Wert von <em>nocontrol</em> bedeutet, dass das <em>Escapezeichen</em> deaktiviert wird, und ist sehr wichtig für das Speichern von Seiten mit kyrillischen Links.  Ohne sie werden die Seiten in Dateien mit leicht geänderten Namen gespeichert, und es ist nicht ganz klar, wie sie an den Server ausgegeben werden sollen.  Leider <em>funktioniert --restrict-file-names = nocontrol</em> für Windows-Benutzer nicht. Dies ist ein bekanntes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Problem</a> . </p><br><h3 id="dobavlyaem-v-git">  Zum Git hinzufügen </h3><br><p>  Mit dem Befehl <em>git init wird</em> ein neues Repository erstellt.  Standardmäßig wird es im aktuellen Verzeichnis im Ordner .git erstellt. Wir möchten jedoch, dass der Server nur auf die Dateien zugreifen kann, die den Namen der geöffneten Seiten der Site entsprechen.  Daher sieht der vollständige Befehl, der ein sauberes (nacktes) Repository im Ordner ../.git-primer erstellt, folgendermaßen aus: </p><br><pre> <code class="bash hljs">git init --bare ../.git-primer</code> </pre> <br><p>  Um dieses nicht standardmäßige Repository weiter zu verwenden, müssen Sie git die Optionen <em>git-dir</em> und <em>work-tree übergeben</em> : </p><br><pre> <code class="bash hljs">git --git-dir=../.git-primer --work-tree=. add .</code> </pre> <br><h3 id="pishem-makefile">  Makefile schreiben </h3><br><p>  Beginnen wir mit der Ankündigung unserer Projekte: </p><br><pre> <code class="hljs mel">SITES := example primer all : $(SITES) .PHONY : $(SITES)</code> </pre> <br><p>  Die Variable <em>SITES</em> enthält die Namen unserer Projekte.  Das Standardziel ist das erste Ziel, <em>dh</em> um alle Schritte auszuführen, geben Sie einfach einen <em>Befehl make ein</em> .  Alle Ziele in <em>SITES</em> sind fiktiv ( <em>PHONY</em> ): Das Rezept für jedes dieser Ziele wird unabhängig von der Existenz des Verzeichnisses und dem Zeitpunkt seiner Änderung ausgeführt. <br>  Die grundlegende Einführung zu machen kann zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> gelesen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> , und die grundlegende Anleitung ist <em>info make</em> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Original</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Übersetzung</a> ). </p><br><p>  Die Regel für jedes der Projekte sieht folgendermaßen aus: </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span>(SITES) : <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ -<span class="hljs-type"><span class="hljs-type">d</span></span> <span class="hljs-type"><span class="hljs-type">.git</span></span>-<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span> ]]; \ then \ <span class="hljs-variable"><span class="hljs-variable">$</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">get-data</span></span>); \ <span class="hljs-variable"><span class="hljs-variable">$</span></span>(mgit) add . &amp;&amp; \ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ -<span class="hljs-type"><span class="hljs-type">n</span></span> <span class="hljs-string"><span class="hljs-string">"`$(mgit) status --porcelain`" ]]; then \ </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(mgit) commit -m "</span></span><span class="hljs-type"><span class="hljs-type">Update</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span><span class="hljs-type"><span class="hljs-type">.</span></span><span class="hljs-string"><span class="hljs-string">"; \ fi \ else \ </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">(init-git); \ fi</span></span></code> </pre> <br><p>  Diese Regel ist im Wesentlichen ein einzelner Shell-Befehl. <br>  $ @ Ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">automatische Variable</a> , die den Namen des aktuellen Ziels enthält (z. B. Primer). <br>  Zuerst prüfen wir, ob das .git-primer-Verzeichnis existiert.  Wenn ja, gehen Sie zum Projektverzeichnis, laden Sie die Seiten herunter und fügen Sie sie zu git hinzu. <br>  Wenn sich der Inhalt der Seiten nicht geändert hat, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fügt</a> git <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nichts hinzu.</a> In diesem Fall führt <em>Commit</em> jedoch zu einem Fehler und die Ausführung des Makefiles wird gestoppt.  Daher rufen wir zuerst den <em>Git-Status</em> mit der Option <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Porzellan auf</a></em> , die für die Verwendung in Skripten vorgesehen ist.  Wenn die Länge der Ausgabezeile von <em>git status --porcelain</em> nicht Null ist, können wir ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von hier aus</a> ) ein Commit durchführen. </p><br><p>  get-data, mgit und init-git sind vorgefertigte Rezepte im Makefile.  Beispielsweise ist <em>mgit</em> ein <em>Git-</em> Aufruf, der ein Verzeichnis mit Repository- und Arbeitsverzeichnisdateien angibt: </p><br><pre> <code class="hljs powershell">define mgit = git -<span class="hljs-literal"><span class="hljs-literal">-git</span></span><span class="hljs-literal"><span class="hljs-literal">-dir</span></span>=../.git-<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span> -<span class="hljs-literal"><span class="hljs-literal">-work</span></span><span class="hljs-literal"><span class="hljs-literal">-tree</span></span>=. endef</code> </pre> <br><p>  Eingemachte Rezepte werden erstellt, wenn eine Befehlsfolge in mehreren Rezepten verwendet werden kann.  Sie können aus mehreren Zeilen bestehen, von denen jede automatisch mit einer Registerkarte in den Rezepten hervorgehoben wird (genauer gesagt mit dem Symbol <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.RECIPEPREFIX</a> ).  In unserem Beispiel dient der Einzug nur zur besseren Lesbarkeit des Makefiles. <br>  Während der Ausführung von Rezepten wird jede Zeile der vorbereiteten Sequenzen als separate Zeile des Rezepts interpretiert, dh sie können zu diesem <em>Zweck</em> insbesondere automatische Variablen <em>verwenden</em> . </p><br><p>  Das vollständige Makefile sieht folgendermaßen aus: </p><br><pre> <code class="hljs mel">SITES := primer example SERVERHOST := example # .  punicode SERVERHOSTNAME := xn--e1afmkfd.xn--p1ai SERVERPATH := ~/archive all : $(SITES) .PHONY : $(SITES) # target-specific variables primer : DOMAIN := . primer : EXCLUDEDIRS := ,static example : DOMAIN := example.com ifeq ($(SERVERHOSTNAME),$(shell hostname)) # Server define mgit = git --git-dir=../.git-$@ --work-tree=. endef define init-git = mkdir -p $@ &amp;&amp; \ $(get-data) &amp;&amp; \ git init --bare ../.git-$@ &amp;&amp; \ $(mgit) add . &amp;&amp; \ $(mgit) commit -m <span class="hljs-string"><span class="hljs-string">"Initial commit of $@."</span></span> endef define get-data = cd $@ &amp;&amp; \ wget -r -nH -X $(EXCLUDEDIRS) --restrict-<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>-names=nocontrol $(DOMAIN) endef <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> # Workstation define init-git = git clone $(SERVERHOST):$(SERVERPATH)/.git-$@ $@ endef endif $(SITES) : ifeq ($(SERVERHOSTNAME),$(shell hostname)) # Server <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ -d .git-$@ ]]; \ then \ $(get-data); \ $(mgit) add . &amp;&amp; \ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ -n <span class="hljs-string"><span class="hljs-string">"`$(mgit) status --porcelain`"</span></span> ]]; then \ $(mgit) commit -m <span class="hljs-string"><span class="hljs-string">"Update $@."</span></span>; \ fi \ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> \ $(init-git); \ fi <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> # Workstation <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ -d $@/.git ]]; \ then \ cd $@ &amp;&amp; git pull; \ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> \ $(init-git); \ fi endif</code> </pre> <br><p>  Im vierten Absatz gibt es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zielspezifische</a> Variablen: Für jedes Ziel können Sie einen eigenen Wert für diese Variable festlegen.  Diese Werte werden auch in Abhängigkeit von den <em>Voraussetzungen der</em> einzelnen Ziele und den verwendeten vorbereiteten Rezepten übertragen. Das heißt, wir können sicher sein, dass das Rezept für jede Site mit dem richtigen Site-Namen und ihrem Verzeichnis ausgeführt wird. <br>  Für jedes Projekt können wir unsere nicht archivierten Verzeichnisse über die Variable <em>EXCLUDEDIRS übertragen</em> oder leer lassen.  Ebenso können Sie den Servernamen für die Archivierung von einem funktionierenden Computer ( <em>SERVERHOST</em> ) und den Pfad auf dem Server zum Verzeichnis mit dem Site-Archiv ( <em>SERVERPATH</em> ) <em>ändern</em> .  In diesem Beispiel befinden sich der Einfachheit halber alle Sites auf demselben Server und werden im selben Verzeichnis archiviert. <br>  Da jede Zeile des Rezepts (einschließlich der vorbereiteten) in einer separaten <em>Shell ausgeführt wird</em> , sodass der Übergang zum Verzeichnis für die folgenden Befehle gültig bleibt, verwenden wir den Operator "und" <em>&amp;&amp;</em> und maskieren das Ende der Zeile \. </p><br><p>  Als nächstes folgt das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bedingte</a> Makefile- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konstrukt</a> : Mit dem Befehl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">shell</a> <em>hostname</em> prüfen wir, ob make auf dem Server oder auf dem lokalen Computer ausgeführt wird.  Zeilen, die den aktuellen Zweig der bedingten Direktive nicht erfüllen, werden vom Makefile vollständig ignoriert. </p><br><div class="spoiler">  <b class="spoiler_title">Der Unterschied zwischen lokalen und Server-Repositorys</b> <div class="spoiler_text"><p>  Der lokale Computer wird hauptsächlich zum Speichern von Daten verwendet, daher kopieren wir nur Daten vom Server ( <em>Git Pull</em> ) auf diesen und zur Erleichterung der lokalen Arbeit mit Git (Anzeigen von Protokollen oder Dateiversionen) verwenden wir die Standard-Repository-Struktur (das übliche Repository im Ordner .git) ) <br>  In beiden Fällen ist ein einziger Befehl <em>make</em> ausreichend.  Zum automatischen Kopieren können Sie den <em>Cron-</em> Scheduler verwenden.  Um nicht jedes Mal das Kennwort für den Zugriff auf den Server einzugeben, werden SSH-Schlüssel generiert. </p><br><p>  Um die Arbeit auf dem Server zu vereinfachen, können Sie aus dem Verzeichnis der aktuellen Site einen <em>Alias-</em> Git mit der angegebenen Konfiguration erstellen: </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> mgit=<span class="hljs-string"><span class="hljs-string">"git --work-tree=. --git-dir=../.git-</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${PWD##*/}</span></span></span><span class="hljs-string">"</span></span></code> </pre> <br><p>  Die Variable $ {PWD ## * /} enthält den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Namen des aktuellen Verzeichnisses ohne Pfad dazu</a> und ist Teil des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">POSIX-</a> Standards, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dh</a> sie kann in allen POSIX-fähigen Shells verwendet werden. </p></div></div><br><p>  Eine bedingte Direktive kann auch in Rezepten verwendet werden. Die einzige Einschränkung besteht darin, dass Anfang und Ende nicht in verschiedenen Dateien enthalten sein dürfen. </p><br><div class="spoiler">  <b class="spoiler_title">Server</b> <div class="spoiler_text"><p>  Nach dem Ausführen von make sieht das Archivverzeichnis folgendermaßen aus: </p><br><pre> <code class="bash hljs">$ ls -a . .. .git-example .git-primer Makefile example primer $ ls -a primer . .. index.html - - $ <span class="hljs-comment"><span class="hljs-comment"># ,     .    ./-  ./-</span></span></code> </pre> <br><p>  Die nginx-Konfigurationsdatei für example.rf könnte folgendermaßen aussehen: </p><br><pre> <code class="nginx hljs"><span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">server_name</span></span> xn--e1afmkfd.xn--p1ai; <span class="hljs-attribute"><span class="hljs-attribute">charset</span></span> utf-<span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> = / { <span class="hljs-attribute"><span class="hljs-attribute">root</span></span> /home/user/archive/primer; <span class="hljs-attribute"><span class="hljs-attribute">try_files</span></span> /index.html =<span class="hljs-number"><span class="hljs-number">404</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">root</span></span> /home/user/archive/primer; <span class="hljs-attribute"><span class="hljs-attribute">default_type</span></span> <span class="hljs-string"><span class="hljs-string">"text/html"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">try_files</span></span> <span class="hljs-variable"><span class="hljs-variable">$uri</span></span> =<span class="hljs-number"><span class="hljs-number">404</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> = /index.html { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> <span class="hljs-number"><span class="hljs-number">404</span></span>; } }</code> </pre> <br><p>  Der erste <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://nginx.org/en/docs/http/ngx_">Speicherort</a></em> entspricht der Hauptseite der Site, example.rf.  Es wird von <em>wget</em> als index.html-Datei gespeichert.  Ist dies nicht der Fall, wird ein Fehler 404 ausgegeben. </p><br><p>  Für alle anderen URIs werden Dateien im Primer-Verzeichnis mit dem Namen URI überprüft.  Wenn sie nicht gefunden werden, wird 404 zurückgegeben. </p><br><p>  Um Doppelarbeit zu vermeiden, verweigern wir am Ende ausdrücklich den Zugriff auf den Link example.rf / index.html (404).  Ein wenig mehr Details zu dieser Konfiguration finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </p></div></div><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>  Das Sichern von Websites kann mit den Standardtools <em>wget</em> , <em>git</em> , <em>make erfolgen</em> .  Sie können alle Seiten einer Site kopieren oder Medien und eine Reihe anderer Dateien so genau ausschließen, wie es <em>wget</em> zulässt.  In ähnlicher Weise können Sie mit <em>.gitignore</em> steuern, welche statischen Seiten dem Repository zur Sicherung hinzugefügt werden und welche nicht.  <em>Mit Makefile</em> können Sie verschiedene Konfigurationen für verschiedene Projekte flexibel verwalten.  Ein vollständiges Makefile-Beispiel für den Client und den Server oben enthält nur etwa 60 Zeilen. </p><br><p>  Es wird davon ausgegangen, dass die Änderung und Hinzufügung von Website-Inhalten über Standardmechanismen erfolgt, dh CMS oder CMF werden dafür gestartet.  Wenn dies selten vorkommt, können sie nach der Arbeit deaktiviert werden, wodurch Systemressourcen frei werden und gespeicherte statische Seiten angezeigt werden.  Ein Beispiel für eine vollständigere Automatisierung verdient möglicherweise einen separaten Artikel. </p><br><p>  Die vorgeschlagene Methode eignet sich hauptsächlich für kleine Projekte, die nur selten aktualisiert werden. Daher wurden Leistungs- und Sicherheitsprobleme hier kaum berücksichtigt.  Da wir <em>wget</em> angewiesen haben, keine Zeichen aus dem URI zu entfernen, sollte für den Fall, dass beliebige Benutzer Dateien zur Site hinzufügen können, das Escapezeichen oder das Verbot des Hinzufügens sofort erfolgen. </p><br><p>  Das Speichern von Versionen des Site-Inhalts kann auch über die Datenbank erfolgen, wenn die Seiten geändert werden.  Dies erfordert jedoch die Versionsunterstützung durch CMF-Modelle sowie eine bessere Kontrolle über den Datenbankspeicherauszug (kopieren Sie ihn nach jeder Seitenbearbeitung vollständig).  Bei der vorgeschlagenen Methode wird im Falle einer geringfügigen Änderung des Inhalts nur diese Änderung zum Repository hinzugefügt, und die Verwendung einer vollständigen Kopie der Datenbank ist nicht erforderlich.  Darüber hinaus können die generierten statischen Seiten direkt vom Server verwendet oder in einem Browser angezeigt werden (Änderungen des Designs oder anderer Site-Codes werden ebenfalls kopiert). </p><br><p>  Alternative Sicherungsprogramme sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> aufgelistet.  Um Mediendateien zu speichern und zu synchronisieren, sollten Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">git-annex</a> achten.  Das Trennen des .git-Repositorys vom Arbeitsbaum wurde auch erfolgreich zum Verwalten von Benutzerkonfigurationsdateien ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Punktedateien</a> ) verwendet.  Heute gibt es Server, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die die</a> Arbeit mit Git-Repositorys direkt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unterstützen</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de425259/">https://habr.com/ru/post/de425259/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de425247/index.html">Crowdsourcing beim Testen</a></li>
<li><a href="../de425249/index.html">Wie ist die Bekanntschaft mit LLP an der ITMO University: der Kurs "Low-Level Programming"</a></li>
<li><a href="../de425251/index.html">LoJax: Das erste bekannte UEFI-Rootkit, das in einer böswilligen Kampagne verwendet wird</a></li>
<li><a href="../de425253/index.html">Wir machen ein maschinelles Lernprojekt in Python. Teil 1</a></li>
<li><a href="../de425255/index.html">Broo verlustfreier Komprimierungsalgorithmus und Delta-Codierung, Vergleich mit Xdelta3. Home Projektentwicklung</a></li>
<li><a href="../de425261/index.html">EV-Zertifikate sind tot</a></li>
<li><a href="../de425263/index.html">Das Festival iFEST findet in Nischni Nowgorod statt</a></li>
<li><a href="../de425265/index.html">Entwicklungsregeln bei Yandex.Health</a></li>
<li><a href="../de425267/index.html">Arbeitsplatz des .NET-Entwicklers oder Schwierigkeiten bei der Auswahl der idealen Konfiguration Version 2.0</a></li>
<li><a href="../de425269/index.html">Hackathon GAZ - wie man den Autogiganten berührt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>