<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👬 📨 🙍🏽 Modulare und wiederverwendbare Docker-Umgebung mit Carnotzet 👨🏿‍🔧 🛄 🍋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir haben ein Tool entwickelt, das Docker und Maven integriert, um Hunderten unserer Entwickler dabei zu helfen, komplexe Entwicklungsumgebungen mit H...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modulare und wiederverwendbare Docker-Umgebung mit Carnotzet</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479326/"><img src="https://habrastorage.org/webt/65/yv/ag/65yvagstopvbk7lwipkyr_ybrxs.jpeg" alt="Bild"><br><br>  Wir haben ein Tool entwickelt, das Docker und Maven integriert, um Hunderten unserer Entwickler dabei zu helfen, komplexe Entwicklungsumgebungen mit Hunderten von Diensten zu verwalten und dabei nur ein Minimum an Aufwand zu betreiben.  Dies ist eine Geschichte darüber, wie eine verrückte Idee Wirklichkeit wurde.  Dies ist die Geschichte von <a href="https://github.com/swissquote/carnotzet" rel="nofollow">Carnotzet</a> . <br><a name="habracut"></a><br>  Angefangen hat alles vor rund fünf Jahren (ca. Erscheinungsdatum 3. August 2017). Swissquote ist schnell gewachsen und hat sich weiterentwickelt.  Zu dieser Zeit hatten wir ungefähr 70 Entwickler, die an großen (ca. monolithischen) Java-Projekten arbeiteten, wobei jeder von ihnen 1 bis 2 Tage benötigte, um den Start des Projekts lokal zu konfigurieren.  Wir hassen es, Zeit für sich wiederholende Aufgaben zu verschwenden!  Daher wurde beschlossen, diesen Prozess zu verbessern, indem Vagrant und Chef verwendet wurden, um die Bereitstellung unserer lokalen Entwicklungsumgebung zu automatisieren.  Dies war der Beginn unseres ersten Sandbox-Projekts (Sandbox, ca.). <br><blockquote>  Wir möchten leichte, reproduzierbare, isolierte und portable Entwicklungs- und Testumgebungen teilen. <br></blockquote>  Für eine Weile war alles glatt.  Entwickler können das Projekt einfach herunterladen, "vagrant up" ausführen und an die Arbeit gehen.  Wir haben diesen Ansatz etwa zwei Jahre lang angewendet und waren sehr zufrieden. <br><br>  In der Folge wurde die Arbeit an diesen großen Anwendungen schwieriger, da die Geschäftslogik komplexer wurde (White-Labeling unserer Handelsplattform).  Und wir haben beschlossen, das zu tun, was die meisten Unternehmen bereits 2014 getan haben: die Logik in Microservices zu unterteilen. <br><br>  Alles ist gut gelaufen und bis 2016 hatten wir ca. 150 (Mikro-) Services in der Produktion.  Die Chef-Skripte zur Konfiguration der virtuellen Maschinen sind jedoch gewachsen und außer Kontrolle geraten.  Entwicklungsumgebungen sind für einige Anwendungen mit etwa 30 Abhängigkeiten wesentlich komplizierter geworden.  Wir haben auch herausgefunden, dass das Wissen über Chefkoch nicht Teil der Standardfähigkeiten unserer Entwickler ist.  Aus diesem Grund haben viele Leute das Skript manchmal einfach zum Laufen gebracht, indem sie schlechte Beispiele kopierten.  Sie versuchten, die Konfiguration für andere Teams nicht zu unterbrechen, und erstellten langlebige Brunchs für ihre eigenen Teamanforderungen. Infolgedessen war der Konfigurationscode für die Entwicklungsumgebung nicht mehr öffentlich. <br><br><img src="https://habrastorage.org/webt/v1/av/xf/v1avxfdqpntzolgiwldjlug-3xg.jpeg" alt="Bild"><br><br>  Wir mussten es reparieren. <br><br>  Die folgenden Schwächen unserer Sandbox wurden festgestellt: <br><br><ul><li>  Muss Chef wissen.  Für bestehende Entwickler und für Anfänger war das Erlernen dieses Frameworks ein ziemlich teures Vergnügen. <br>  Auch dies war nur für die Entwicklungs- / Testumgebung überflüssig. </li><li>  Es gab keine Möglichkeit für eine einfache Abstraktion / Komposition oder Wiederverwendung eines Teils der Konfiguration der Umgebung.  Dies führte dazu, dass sich die Mitarbeiter mit allen Details und Nuancen der Abhängigkeitskonfiguration ihrer Projekte befassen mussten, die in der Regel von anderen Teams unterstützt wurden.  Dies führte zu Meinungsverschiedenheiten und unnötiger Interaktion zwischen den Teams. </li></ul><br>  Um den ersten Punkt zu beheben, wurde beschlossen, Docker zu verwenden.  Es hat eine niedrigere Eintrittsschwelle und bietet auch andere Vorteile, wie z. B. Standardisierung, PaaS-Unterstützung und einfachere Bereitstellung in mehreren Umgebungen. <br><br>  Wir haben auch in Betracht gezogen, nur Docker-Compose zu verwenden.  Es sah sehr vielversprechend aus, aber trotz seines Namens fehlten Dinge wie die Möglichkeit der Komposition und gleichzeitig Abstraktion und Wiederverwendung.  Es sind diese Aspekte, die wir brauchten.  Wir haben davon geträumt, die vorhandene Entwicklungs- / Testumgebung zu übernehmen, einen Service hinzuzufügen und optional einen Teil der Konfiguration neu zu definieren.  Wir wollten dies erreichen, ohne die Konfiguration des hinzugefügten Dienstes kopieren oder die Details der transitiven Abhängigkeiten und ihrer Konfiguration untersuchen zu müssen. <br><br>  Zu diesem Zeitpunkt hatten wir die Idee: „Was ist, wenn wir Maven, das Abhängigkeitsverwaltungssystem, mit dem wir unsere Java-Anwendungen erstellen, verwenden und damit beginnen, unsere Umgebungen zu erstellen?“  Dies würde es uns ermöglichen, unsere transitiven Abhängigkeiten zu abstrahieren, Konfigurationen zu verpacken, Versionen davon zu erstellen und sie wiederzuverwenden.  Es ist auch nicht erforderlich, ein neues Abhängigkeitsverwaltungssystem zu erlernen. <br><br>  Nach mehreren Versuchen kamen wir zu folgender Lösung: <br><br><ul><li>  Jedes Maven-Artefakt stellt eine voll funktionsfähige Umgebung dar, die als Abhängigkeit in anderen Umgebungen verwendet werden kann.  (Minimale Umgebung kann durch einen Dienst dargestellt werden, z. B. eine Datenbank.) </li><li>  JAR-Dateien enthalten Konfiguration.  Umgebungsvariablen, Anwendungskonfigurationsdateien, Image-Docker-Name usw. </li><li>  Diese Konfiguration kann bei Bedarf in Modulen überschrieben werden, die sich höher in der Abhängigkeitshierarchie befinden. </li><li>  Die Java-Bibliothek kann die gesamte Umgebung (mithilfe von Docker-Compose unter der Haube) aus einem Maven-Modul (GAV oder pom.xml) herausheben. </li></ul><br>  Maven ermöglicht es, diese Artefakte („Umgebungsartefakte“) zu verteilen und zu versionieren, und wir können den Quellcode problemlos zwischen den Teams teilen.  Der Prozess wurde einfacher und die Entwickler begannen, Module anderer Teams zu verwenden.  Und erstellen und pflegen Sie auch Ihre eigenen. <br><br>  Als Bonus können hier alle Tools verwendet werden, die die Arbeit mit Maven erleichtern.  Das mit IntelliJ IDEA generierte Abhängigkeitsdiagramm zeigt uns nun als Beispiel ein Diagramm der Architektur für die Interaktion unserer Abhängigkeiten :) <br><br><img src="https://habrastorage.org/webt/sq/b2/vm/sqb2vmxpahz9-zouvjdcd0ocfza.png" alt="Bild"><br>  Architektur eines <a href="https://github.com/dockersamples/example-voting-app" rel="nofollow">Voting-Anwendungsbeispiels von docker-compose</a> <br><br>  Gleichzeitig gab es einige Implementierungsschwierigkeiten, z. B. das Erzwingen, dass alle Teams Anwendungen mit Docker (Dockerize) packen und Konfigurationen in separate Maven-Module packen.  In jedem Fall ist es einfacher geworden, Anwendungen aus anderen Teams zu importieren und komplexe Entwicklungsumgebungen zu unterstützen. <br><br>  Wir haben vor ungefähr einem Jahr begonnen, in diese Richtung zu arbeiten, und jetzt haben wir ungefähr 200 dieser Module für die Entwicklung und das Testen verwendet.  Wir sind zu dem Schluss gekommen, dass diese Bibliothek auch hervorragend für die Verwaltung der temporären Umgebung für End-to-End-Tests auf unserer CI-Plattform geeignet ist. <br><br>  Wir prüfen derzeit, wie diese Technologie für die Verwaltung unserer UAT- / Integrationsumgebungen wiederverwendet werden kann, indem Container in Kubernetes anstelle von Docker-Compose gestartet werden, um auf diese Weise Aktualisierungen und die Elastizität der Datenverarbeitung in erheblich größeren Umgebungen sicherzustellen. <br><br>  Ich hoffe, Sie werden froh sein zu wissen, dass unser Projekt unter der Apache 2.0-Lizenz eröffnet wurde und auf Github verfügbar ist: <a href="https://github.com/swissquote/carnotzet" rel="nofollow">github.com/swissquote/carnotzet</a> <br><br>  Verwenden Sie :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479326/">https://habr.com/ru/post/de479326/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479316/index.html">Integrationsbus für die Bank SOYUZ (AO): Design und Autotest</a></li>
<li><a href="../de479318/index.html">CLion 2019.3 ist da! Verbesserte Editorgeschwindigkeit und die am meisten erwarteten neuen Funktionen</a></li>
<li><a href="../de479320/index.html">Ausgabe Nr. 28: IT-Schulung - Aktuelle Fragen und Herausforderungen führender Unternehmen</a></li>
<li><a href="../de479322/index.html">Android, Google und kostenlose Inhaltslizenzen. Wer ist schuld und was zu tun</a></li>
<li><a href="../de479324/index.html">So entwerfen Sie ein Benachrichtigungssystem. Schritt für Schritt Anleitung mit Beispielen</a></li>
<li><a href="../de479328/index.html">3 Gründe, um das Englischlernen auf Mittelstufe zu beenden</a></li>
<li><a href="../de479330/index.html">Eine neue Lösung für das alte Internetproblem</a></li>
<li><a href="../de479332/index.html">Was uns Uber und Vision Fund beibringen</a></li>
<li><a href="../de479336/index.html">Android, Google und kostenlose Inhaltslizenzen. Wer ist schuld und was kann getan werden?</a></li>
<li><a href="../de479340/index.html">„Vorsicht, FAS!“: Ein Versuch auf den Weihnachtsmann, die ganze Wahrheit über Verkäufe, Skistreitigkeiten und einen Neujahrswettbewerb mit Geschenken</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>