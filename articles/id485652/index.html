<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ğŸ½ ğŸ¥ ğŸ‘¨ğŸ¾â€ğŸ”¬ Statistik komentar inline pertemuan ğŸ™‡ğŸ½ ğŸ–•ğŸ¼ ğŸ¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bagaimana cara mengumpulkan statistik komentar halaman dalam Confluence? 

 Ya, dan mengapa ini diperlukan? 



 Kenapa dan mengapa 
 Dalam proyek di ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Statistik komentar inline pertemuan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485652/">  Bagaimana cara mengumpulkan statistik komentar halaman dalam Confluence? <br><br>  Ya, dan mengapa ini diperlukan? <br><br><img src="https://habrastorage.org/webt/c6/7x/uo/c67xuo6sop9dd7mpzxty_i7wj7s.png"><br><a name="habracut"></a><br><h2>  Kenapa dan mengapa </h2><br>  Dalam proyek di mana saya kebetulan bekerja, proses persiapan dan persetujuan persyaratan berikut lahir: <br><br><ul><li>  Confluence digunakan untuk dokumentasi. </li><li>  Tim pemasok menyiapkan deskripsi proses bisnis dan langkah-langkah mereka dalam bentuk halaman terpisah sesuai dengan templat. </li><li>  Sekali seminggu, sejumlah deskripsi yang telah disiapkan diserahkan kepada pelanggan untuk proofreading. </li><li>  Tim pelanggan meninggalkan semua pertanyaan dan tambahan pada halaman terkait dalam bentuk komentar bawaan. </li><li>  Dan tim pemasok melengkapi konten, merespons komentar, memperbaiki pertanyaan untuk studi tambahan. </li><li>  Jika pertanyaan dijawab dan konten diperbarui atau tugas untuk belajar diperbaiki, tim pelanggan harus menutup komentar. </li><li>  Pertanyaan pada kumpulan dokumen dari minggu ini harus ditutup pada saat batch berikutnya ditransfer minggu depan. </li></ul><br>  Setiap minggu, manajer proyek memiliki tugas untuk memahami seberapa banyak kumpulan dokumen yang dikirimkan telah berhasil dan apa yang dapat dianggap siap secara kondisional darinya.  Dan peserta tim pemasok secara berkala perlu memeriksa status komentar pada dokumen mereka dan bekerja dengan sengaja bersama yang lain.  Tetapi bagaimana cara menemukannya?  Anda dapat membuka setiap halaman, mencari komentar pertama dengan mata Anda (atau dengan bantuan <a href="https://community.atlassian.com/t5/Confluence-questions/Search-for-unresolved-inline-comments/qaq-p/971424">trik kecil</a> ), lalu klik semua komentar, karena  tim pelanggan tidak terburu-buru untuk menutupnya, pikirkan masing-masing dan periksa jawabannya. <br><br>  Batch mingguan berisi 50-100 halaman terpisah, dan melakukan ini dengan tangan Anda adalah pekerjaan yang sangat banyak.  Dan jika Anda masih mencoba mengumpulkan argumen untuk meyakinkan pihak lain, itu menjadi sangat menyedihkan.  Dan ada juga komentar menggantung yang dihasilkan dari pengeditan halaman yang tidak akurat ketika teks sumber terhapus secara tidak sengaja.  Komentar semacam itu terlihat di yang diselesaikan, tetapi tidak dapat dibuka kembali (Anda bisa, jika Anda membuat ulang penanda yang tidak terlihat dalam teks halaman). <br><br>  Pencarian alat tidak berhasil.  Selain itu, Confluence digunakan di sisi pelanggan, Anda tidak dapat menginstal plugin, belum lagi membeli.  Tidak ada keahlian pengembangan makro. <br><br>  Pada titik tertentu, saya ingat Confluence <a href="https://docs.atlassian.com/ConfluenceServer/rest/7.1.0/">REST API</a> dan pengalaman sebelumnya menggunakan <a href="https://docs.atlassian.com/software/jira/docs/api/REST/7.6.1/">Jira API yang</a> serupa.  Pencarian dan percobaan dengan fungsi panggilan dari browser menunjukkan bahwa Anda bisa mendapatkan komentar dan propertinya.  Selanjutnya, Anda harus memilih alat untuk otomatisasi, dan Anda dapat mulai menyelesaikannya.  Saya memiliki beberapa pengalaman membuat skrip pada alat yang lebih cenderung lebih dekat dengan administrator seperti Bash, Perl, JScript.  Saya bukan pengembang, saya tidak punya alat yang akrab atau akrab.  Saya ingin mencoba sesuatu yang lebih umum atau cocok.  Kemudian saya menemukan <a href="https://atlassian-python-api.readthedocs.io/en/latest/">pembungkus untuk API Python</a> dan memutuskan untuk mencobanya. <br><br><h2>  Prinsip umum </h2><br>  Masalahnya dirumuskan sebagai berikut.  Anda perlu menemukan semua halaman yang terkait dengan pengiriman mingguan tertentu.  Kumpulkan komentar pada mereka dalam daftar: halaman, tautan ke komentar, penulis dan tanggal komentar, teks sumber pada halaman, komentar dan jawaban, penulis dan tanggal balasan terakhir, status komentar.  Selain itu, kumpulkan statistik untuk setiap halaman, jumlah total komentar, berapa banyak bahaya, berapa banyak yang terbuka.  Simpan semuanya di halaman statistik khusus. <br><br>  Saya meletakkan Python, melihat dasar-dasar bekerja dengannya, dan mari kita pergi.  Pertama, buat koneksi: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> atlassian <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Confluence UserLogin = <span class="hljs-string"><span class="hljs-string">'xxxxxx'</span></span> <span class="hljs-comment"><span class="hljs-comment"># input("Login: ") UserPwd = 'xxxxxx' # input("Password: ") confluenceURL = 'http://wiki.xxxxxx' confluence = Confluence( url=confluenceURL, username=UserLogin, password=UserPwd)</span></span></code> </pre> <br>  Untuk mencari halaman dari kumpulan mingguan, saya memutuskan untuk menggunakan tag.  Cara menyampaikannya secara massal adalah tugas yang terpisah. <br><br><pre> <code class="python hljs">page_label = <span class="hljs-string"><span class="hljs-string">'week123'</span></span> cql = <span class="hljs-string"><span class="hljs-string">'space.key={} and label = "{}" and type = page '</span></span> <span class="hljs-string"><span class="hljs-string">'ORDER BY title '</span></span>.format(<span class="hljs-string"><span class="hljs-string">'YYY'</span></span>, page_label) pages = confluence.cql(cql, expand=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, start=<span class="hljs-number"><span class="hljs-number">0</span></span>, limit=<span class="hljs-number"><span class="hljs-number">200</span></span>)</code> </pre><br>  Jadi kami punya daftar halaman untuk diperiksa.  Selanjutnya, kami mulai memproses setiap halaman individual.  Kami mengumpulkan dari datanya di komentar dengan parameter mereka.  Berdasarkan data ini, kami membangun statistik tentang berapa banyak komentar yang ada di halaman dan dalam kondisi apa.  Selanjutnya, kami menghapus hasil untuk semua halaman dan mulai memformat hasilnya.  Kami membuat isi halaman dengan hasil dalam bentuk tabel statistik dan daftar rinci komentar terbuka. <br><br><div class="spoiler">  <b class="spoiler_title">Pemrosesan Daftar Halaman</b> <div class="spoiler_text"><pre> <code class="python hljs">statistics = [] open_comments = [] <span class="hljs-comment"><span class="hljs-comment">#  - ? if pages is not None: #    ? if pages['size'] &gt; 0: for page in pages['results']: print(page['title']) #       , #  page_comments = page_comments_data(page['content']['id']) #     statistics.append(page_statistics(page_comments)) #        #    . for comment in page_comments: if comment['Result'] not in ['resolved', 'nocomment']: if not (comment['Result'] == 'dangling' and comment['Author'] in excludeNames): open_comments.append(comment) #       . statistics.append(total_statistics(statistics)) #     page_id = confluence.get_page_id(space='YYY', title=page_title) #     ,    . page_body = ('&lt;p&gt;&lt;ac:structured-macro ac:name="toc" ac:schema-version="1"' '/&gt;&lt;/p&gt;' '&lt;h1&gt;Comments Statistics&lt;/h1&gt;{}' '&lt;h1&gt;Open Comments List&lt;/h1&gt;{}' ).format(create_table(statistics), create_table(open_comments)) #  if page_id is not None: status = confluence.update_page( page_id=page_id, title=page_title, body=page_body, representation='storage' )</span></span></code> </pre></div></div><br><h2>  Fitur API </h2><br>  Sekarang mari kita cari tahu cara memproses halaman.  Secara default, API hanya mengembalikan informasi dasar, seperti pengidentifikasi atau nama halaman.  Semua properti tambahan harus ditentukan secara eksplisit.  Mereka dapat dilihat dengan menganalisis hasil panggilan.  Data tambahan dapat ditemukan di bagian atau subbagian dari _expandable.  Kami menambahkan item yang diinginkan untuk diperluas dan melihat lebih jauh hingga kami menemukan data yang diperlukan. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh Masalah</b> <div class="spoiler_text"><pre> <code class="json hljs">http://wiki.xxxxxx/rest/api/content/<span class="hljs-number"><span class="hljs-number">101743895</span></span>?expand=body,children.comment { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"97517865"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"page"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"current"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"w2019-47 comments status"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"children"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"comment"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"results"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"start"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"limit"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_links"</span></span>: {} }, <span class="hljs-attr"><span class="hljs-attr">"_links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"_expandable"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"attachment"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/child/attachment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"page"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/child/page"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"body"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"_expandable"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"editor"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"export_view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"styled_view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"storage"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"anonymous_export_view"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"extensions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"position"</span></span>: <span class="hljs-string"><span class="hljs-string">"none"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"_links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"_expandable"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"metadata"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operations"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"restrictions"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/restriction/byOperation"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"history"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/history"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ancestors"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"descendants"</span></span>: <span class="hljs-string"><span class="hljs-string">"/rest/api/content/97517865/descendant"</span></span>, } }</code> </pre></div></div><br>  Dan ada juga batasan jumlah hasil yang dikeluarkan, pagination.  Ini dikonfigurasikan di sisi server (API?) Dan dalam kasus kami ini adalah 25. Untuk beberapa permintaan, itu dapat diubah dengan menetapkan secara eksplisit, tetapi hanya akan berfungsi untuk tingkat atas.  Dan mengungkap komentar ke halaman, kami mendapatkan semua yang sama hanya 25, sementara ukuran juga palsu.  Dalam contohnya ada 29 dalam kenyataan.  Kami berhasil menghindari pagination komentar menggunakan fungsi terpisah dalam modul Confluence - get_page_comments dengan kemampuan untuk menentukan ukuran halaman. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    import re #      XML def replace_chars2(in_text): text = re.sub(r'&amp;', '&amp;', in_text) text = re.sub(r'\'', ''', text) text = re.sub(r'&lt;', '&lt;', text) text = re.sub(r'&gt;', '&gt;', text) text = re.sub(r'"', '"', text) return text</span></span></code> </pre><br>  Jebakan berikutnya menunggu dalam fitur pelestarian dan penerbitan karakter khusus.  Isi halaman atau komentar dapat diperoleh dalam beberapa tampilan: XML internal - penyimpanan, HTML perantara tanpa output makro - tampilan dan HTML dengan output makro - export_view.  Tapi judul judul halaman dan teks asli yang dikomentari. Pemilihan selalu dikeluarkan dalam bentuk yang sesuai untuk dibaca.  Karena  di masa mendatang, data ini termasuk dalam tubuh laman dengan statistik, kemudian beberapa karakter menyebabkan kesalahan konversi.  Saya harus menulis prosedur penggantian di atas. <br><br><h2>  Komentar Halaman </h2><br>  Sekarang untuk mem-parsing halaman.  Ini adalah salah satu prosedur yang memuat halaman, mengumpulkan datanya, lalu mengeluarkan daftar komentar dengan jawaban dan mengumpulkannya dalam korespondensi.  Hasilnya adalah daftar kamus, di mana setiap elemen daftar sesuai dengan satu komentar dengan jawaban.  Dan semua atribut dari komentar ini terletak pada bidang kamus yang sesuai. <br><br><div class="spoiler">  <b class="spoiler_title">Pemrosesan satu halaman</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">page_comments_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(page_identifier)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#,      ,  , #   , #  ,    ,    #   (). expand_text = ('body.storage,extensions.inlineProperties' ',extensions.resolution,version,children.comment' ',children.comment.version,children.comment.body.storage' ) #    .     . conf_page = confluence.get_page_by_id(page_identifier, expand='body.storage') page_title = replace_chars2(conf_page['title']) #   . link_base = conf_page['_links']['base'] page_link = link_base + conf_page['_links']['webui'] page_code = '&lt;a href="{}"&gt;{}&lt;/a&gt;'.format(page_link, page_title) #   page_comments = confluence.get_page_comments(content_id=page_identifier, start=0, limit=1000, comments = [] #    for comment in page_comments['results']: #      - . if comment['extensions']['location'] == 'footer': continue #  comment_text = comment['body']['storage']['value'] comment_result = comment['extensions']['resolution']['status'] comment_link = '&lt;a href="{}"&gt;{}&lt;/a&gt;'\ .format(link_base + comment['_links']['webui'], 'link') #  comment_link = re.sub(r'&amp;focusedCommentId=', '&amp;focusedCommentId=', comment_link) #  created_when = re.sub(r'\.000\+', ' GMT+', re.sub(r'T', ' ', comment['version']['when'])) created_by = comment['version']['by']['displayName'] orig_text = replace_chars2(comment['extensions'] ['inlineProperties']['originalSelection']) #    /. thread = '&lt;b&gt;To text: &lt;/b&gt;{}&lt;br/&gt;&lt;b&gt;At: &lt;/b&gt;{}&lt;br/&gt;&lt;b&gt;By: ' '&lt;/b&gt;{}&lt;br/&gt;{}'.format(orig_text, created_when, created_by, comment_text) last_by = '' last_when = '' #  answers = comment['children']['comment']['size'] if answers &gt; 0: for message in comment['children']['comment']['results']: #  last_when = re.sub(r'\.000\+', ' GMT+', re.sub(r'T', ' ', message['version']['when'])) last_by = message['version']['by']['displayName'] #  thread += ('&lt;br/&gt;===next===&lt;br/&gt;&lt;b&gt;At: &lt;/b&gt;{}&lt;br/&gt;&lt;b&gt;By: ' '&lt;/b&gt;{}&lt;br/&gt;{}'.format(last_when, last_by, message['body']['storage']['value']) ) #  . row_comm = {"Page": page_code, "Comment": comment_link, "Thread": thread, "Result": comment_result, "Answers count": answers, "Creation Date": created_when, "Author": created_by, "Last Date": last_when, "Last Author": last_by} comments.append(row_comm) #   ,   , #     . if len(comments) == 0: row_comm = {"Page": page_code, "Comment": 'nolink', "Thread": 'nocomment', "Result": 'nocomment', "Answers count": 0, "Creation Date": 'never', "Author": 'nobody', "Last Date": 'never', "Last Author": 'nobody'} comments.append(row_comm) return comments</span></span></code> </pre></div></div><br><h2>  Statistik dan tabel </h2><br>  Untuk kejelasan penyajian data, kami mengumpulkan statistik dan mengaturnya dalam bentuk tabel. <br><br><div class="spoiler">  <b class="spoiler_title">Kami memproses statistik</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">page_statistics</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(comments_data)</span></span></span><span class="hljs-function">:</span></span> open_count = <span class="hljs-number"><span class="hljs-number">0</span></span> dang_count = <span class="hljs-number"><span class="hljs-number">0</span></span> comment_count = len(comments_data) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> comment_count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> comment <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> comments_data: <span class="hljs-comment"><span class="hljs-comment">#     if comment['Result'] not in ['resolved', 'nocomment']: if comment['Result'] in ['open', 'reopened']: open_count += 1 if comment['Result'] == 'dangling' and comment['Author'] not in excludeNames: dang_count += 1 res_dict = {'Page': comments_data[0]['Page'], 'Total': comment_count, 'Resolved': comment_count - open_count - dang_count, 'Dangling': dang_count, 'Open': open_count} return res_dict #   def total_statistics(stat_data): total_comment = 0 total_resolved = 0 total_open = 0 total_dangling = 0 for statRow in stat_data: total_comment += statRow['Total'] total_resolved += statRow['Resolved'] total_open += statRow['Open'] total_dangling += statRow['Dangling'] res_dict = {'Page': 'All Pages Total', 'Type': '', 'Jira': '', 'Status': '', 'Total': total_comment, 'Resolved': total_resolved, 'Dangling': total_dangling, 'Open': total_open} return res_dict</span></span></code> </pre></div></div><br>  Untuk membuat data dalam bentuk tabel, kami akan melakukan prosedur lain.  Ini membentuk kode HTML dari tabel dari daftar kamus, karena pos itu menambahkan baris dari nama-nama kunci kamus dan menambahkan kolom dengan nomor baris. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_table</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tab_data)</span></span></span><span class="hljs-function">:</span></span> tab_start = <span class="hljs-string"><span class="hljs-string">'&lt;table style="width: 100.00%;"&gt;&lt;colgroup&gt;&lt;col /&gt;'</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;col /&gt;&lt;/colgroup&gt;&lt;tbody&gt;'</span></span> tab_end = <span class="hljs-string"><span class="hljs-string">'&lt;/tbody&gt;&lt;/table&gt;'</span></span> tab_code = tab_start + <span class="hljs-string"><span class="hljs-string">'&lt;tr&gt;'</span></span> row_num = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(tab_data) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;th&gt;Num&lt;/th&gt;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tab_data[<span class="hljs-number"><span class="hljs-number">0</span></span>].keys(): tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;th&gt;{}&lt;/th&gt;'</span></span>.format(key) tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;/tr&gt;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tab_data: tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;tr&gt;&lt;td&gt;{}&lt;/td&gt;'</span></span>.format(row_num) row_num += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> field <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> row.values(): tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;td&gt;{}&lt;/td&gt;'</span></span>.format(field) tab_code += <span class="hljs-string"><span class="hljs-string">'&lt;/tr&gt;'</span></span> tab_code += tab_end + <span class="hljs-string"><span class="hljs-string">'\n'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tab_code</code> </pre><br>  Sekarang semuanya sudah siap.  Setelah memberi label dan menjalankan skrip, kami mendapatkan halaman yang terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/-1/if/af/-1ifafmgt3mqvbayphkq7opy4mq.png"><br><br><h2>  PS </h2>  Tentu saja, ini tidak semuanya ternyata pada akhirnya.  Ada parsing halaman dan mencari makro dengan nomor tugas di Jira.  Ada pelabelan otomatis berdasarkan nomor tugas di Jira dan tautan dari mereka ke Confluence.  Ada perbandingan dan verifikasi daftar pengiriman mingguan.  Ada penghematan komentar di Excel dan pengumpulan data umum dari beberapa file Excel mingguan.  Dan komentar parsing dari Word baru-baru ini telah ditambahkan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id485652/">https://habr.com/ru/post/id485652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id485636/index.html">Virus yang resistan terhadap CRISPR membangun tempat perlindungan untuk melindungi genom dari enzim penembus DNA</a></li>
<li><a href="../id485640/index.html">Metode penyembunyian halaman web</a></li>
<li><a href="../id485646/index.html">Kiat-kiat Python yang berguna yang belum pernah Anda temui sebelumnya. Bagian 2</a></li>
<li><a href="../id485648/index.html">Pendekatan pythonic untuk for: range () dan enumerate () loop</a></li>
<li><a href="../id485650/index.html">Teknik Pengurangan Gambar Docker</a></li>
<li><a href="../id485654/index.html">Sebuah ide yang diambil dari fisika membantu AI bekerja dalam dimensi yang lebih tinggi.</a></li>
<li><a href="../id485660/index.html">Perusahaan perlindungan DDoS sendiri meluncurkan serangan DDoS, diakui pendirinya</a></li>
<li><a href="../id485664/index.html">Membuat parameter dinamis dalam pekerjaan Jenkins, atau cara membuat tugas Anda lebih mudah digunakan</a></li>
<li><a href="../id485672/index.html">Redis Praktik Terbaik, Bagian 1</a></li>
<li><a href="../id485682/index.html">Manajemen waktu tidak akan membantu: penundaan adalah masalah mengatur emosi, bukan waktu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>