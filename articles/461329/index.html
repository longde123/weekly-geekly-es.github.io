<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì™ üöß ‚ôíÔ∏è Segmentaci√≥n autom√°tica de √≥rganos respiratorios. ‚§µÔ∏è ü§ë üÖ∞Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La segmentaci√≥n manual del pulm√≥n tarda unos 10 minutos y requiere cierta habilidad para obtener el mismo resultado de alta calidad que con la segment...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Segmentaci√≥n autom√°tica de √≥rganos respiratorios.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inobitec/blog/461329/"><p>  La segmentaci√≥n manual del pulm√≥n tarda unos 10 minutos y requiere cierta habilidad para obtener el mismo resultado de alta calidad que con la segmentaci√≥n autom√°tica.  La segmentaci√≥n autom√°tica tarda unos 15 segundos. </p><br><p>  Supuse que sin una red neuronal ser√≠a posible obtener una precisi√≥n de no m√°s del 70%.  Tambi√©n supuse que las operaciones morfol√≥gicas son solo la preparaci√≥n de una imagen para algoritmos m√°s complejos.  Pero como resultado del procesamiento de esas, aunque pocas, 40 muestras de datos tomogr√°ficos disponibles, el algoritmo segment√≥ los pulmones sin errores.  Adem√°s, despu√©s de probar en los primeros cinco casos, el algoritmo no cambi√≥ significativamente y funcion√≥ correctamente en los otros 35 estudios sin cambiar la configuraci√≥n. </p><br><p>  Adem√°s, las redes neuronales tienen una desventaja: para su entrenamiento necesitamos cientos de muestras de entrenamiento de pulmones, que deben marcarse manualmente. </p><br><p><img src="https://habrastorage.org/webt/fg/uv/-r/fguv-r_mn7ybraf34p_1ybbphwa.jpeg"></p><a name="habracut"></a><br><h1>  Contenido </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estructura del sistema respiratorio</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Escala de Haunsfield</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Morfolog√≠a matem√°tica</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Algoritmo de Lee y compresi√≥n RLE</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Transformaci√≥n umbral del volumen base</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Extracci√≥n de aire externo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Segmentaci√≥n del objeto de volumen m√°ximo.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cerrar los vasos dentro de los pulmones.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Algoritmo de segmentaci√≥n de √≥rganos respiratorios</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Implementaci√≥n de algoritmos en MATLAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conclusi√≥n</a> </li></ul><br><h1 id="paragraph1">  Estructura del sistema respiratorio </h1><br><p>  El sistema respiratorio incluye las v√≠as respiratorias y los pulmones.  Las v√≠as a√©reas se dividen en las v√≠as a√©reas superiores e inferiores.  El punto de separaci√≥n entre el tracto respiratorio inferior y superior es el punto de intersecci√≥n del es√≥fago y las v√≠as respiratorias.  Todos los √≥rganos que est√°n por encima de la laringe son el tracto superior y la laringe y los √≥rganos de abajo son el tracto inferior. </p><br><p>  Lista de los √≥rganos respiratorios: </p><br><p>  <strong>La cavidad nasal</strong> es una cavidad llena de aire entre la nariz y la faringe. <br>  <strong>La faringe</strong> es un canal a trav√©s del cual viaja la comida y el aire. <br>  <strong>La tr√°quea</strong> es un tubo conectado a la laringe y los bronquios. <br>  <strong>La laringe</strong> es responsable de la formaci√≥n de la voz.  Est√° al nivel de las v√©rtebras cervicales C4-C6. <br>  <strong>Los bronquios</strong> son los canales respiratorios, cuya parte principal se encuentra dentro de los pulmones. <br>  <strong>Los pulmones</strong> son el principal √≥rgano respiratorio. </p><br><p><img src="https://habrastorage.org/webt/kf/jv/kj/kfjvkjeioihehmpbzprc5bvgf8y.png"></p><br><h1 id="paragraph2">  Escala de Haunsfield </h1><br><p> Godfrey Hounsfield era un ingeniero el√©ctrico ingl√©s que, junto con el te√≥rico estadounidense Allan Cormack, desarroll√≥ la tomograf√≠a computarizada, por la cual comparti√≥ el Premio Nobel en 1979. </p><br><p><img src="https://habrastorage.org/webt/jv/bl/ho/jvblho_x-0woitx02gbfjuxxhju.jpeg"></p><br><p>  La escala de Hounsfield: es una escala cuantitativa para describir la radiodensidad, que se mide en unidades de Hounsfield, denotada como HU. </p><br><p>  La radiodensidad se calcula sobre la base del coeficiente de atenuaci√≥n de la radiaci√≥n.  El coeficiente de atenuaci√≥n caracteriza la facilidad con la que la radiaci√≥n puede penetrar un volumen de material. </p><br><p>  La radiodensidad se calcula mediante la f√≥rmula: </p><br><p><math> </math> $$ display $$ {Œº_ {X} -Œº_ {water} \ over Œº_ {water} -Œº_ {air}} \ times 1000 $$ display $$ </p><br><p>  donde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mi>X</mi></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>g</mi><mi>u</mi><mi>a</mi></mrow></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>i</mi><mi>r</mi><mi>e</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.783ex" height="2.298ex" viewBox="0 -520.7 6364.9 989.6" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-3BC" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-58" x="853" y="-357"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMAIN-2C" x="1306" y="0"></use><g transform="translate(1751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-3BC" x="0" y="0"></use><g transform="translate(603,-253)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-67" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-75" x="1010" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-61" x="1582" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMAIN-2C" x="3948" y="0"></use><g transform="translate(4393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-3BC" x="0" y="0"></use><g transform="translate(603,-253)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-69" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-72" x="874" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhi23c99vRkoR0NtXM-QnQiBmEeQCA#MJMATHI-65" x="1326" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mo>Œº</mo></mrow><mi>X</mi></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo>Œº</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>g</mi><mi>u</mi><mi>a</mi></mrow></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo>Œº</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>i</mi><mi>r</mi><mi>e</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2"> Œº_X, Œº_ {agua}, Œº_ {aire} </script>  son coeficientes de atenuaci√≥n lineal para el material medido, agua y aire. </p><br><p>  La radiodensidad puede ser negativa porque la radiodensidad cero corresponde al agua.  Esto significa que todos los materiales que tengan un coeficiente de atenuaci√≥n m√°s bajo que el coeficiente de atenuaci√≥n del agua (por ejemplo, tejido pulmonar, aire) tendr√°n una radiodensidad negativa. </p><br><p>  Las radiodensidades aproximadas para varios tejidos se enumeran a continuaci√≥n: </p><br><ul><li>  Aire: -1000 HU. </li><li>  √ìrganos respiratorios: de -950 a -300 HU. </li><li>  Sangre (sin contrastar los vasos): de 0 a 100 HU. </li><li>  Huesos: 100 a 1000 HU. </li></ul><br><p><img src="https://habrastorage.org/webt/zv/zz/v_/zvzzv_n2koandwhyv-nw1ciunou.png"></p><br><p>  Enlaces a Wikipedia: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escala Hounsfield</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Godfrey Hounsfield</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">coeficiente de atenuaci√≥n</a> . </p><br><h1 id="paragraph3">  Morfolog√≠a matem√°tica </h1><br><p>  <strong>Las operaciones morfol√≥gicas</strong> son las principales herramientas que se utilizaron en el algoritmo. <br>  En el campo de la visi√≥n por computadora, las operaciones morfol√≥gicas se denominan un grupo de algoritmos para la transformaci√≥n de la forma de los objetos.  Muy a menudo, las operaciones morfol√≥gicas se aplican a im√°genes binarizadas donde las unidades corresponden a v√≥xeles de objeto y ceros para vaciar. <br>  Las principales operaciones morfol√≥gicas incluyen: </p><br><p>  <strong>La dilataci√≥n morfol√≥gica</strong> es la adici√≥n de nuevos v√≥xeles a todos los v√≥xeles de borde de los objetos.  En otras palabras, el algoritmo escanea todos los v√≥xeles correspondientes al borde del objeto y los ampl√≠a usando un n√∫cleo con una forma dada (esfera, cubo, cruz, etc.).  El n√∫cleo tiene su propio radio (para la esfera), o el ancho del lado (para el cubo).  Esta operaci√≥n se usa a menudo para fusionar m√∫ltiples objetos cercanos en un solo objeto. </p><br><p>  <strong>La erosi√≥n morfol√≥gica</strong> es el corte de todos los v√≥xeles que se encuentran en el borde (l√≠mite) de los objetos.  Esta operaci√≥n es inversa a la dilataci√≥n.  Esta operaci√≥n es √∫til para eliminar el ruido que tiene la forma de muchos objetos peque√±os interconectados.  Sin embargo, este m√©todo de eliminaci√≥n de ruido solo debe usarse si el objeto de inter√©s tiene un espesor mucho mayor que el radio de erosi√≥n.  De lo contrario, se perder√° la informaci√≥n √∫til. </p><br><p>  <strong>El cierre morfol√≥gico</strong> es una dilataci√≥n seguida de una erosi√≥n.  Se utiliza para cerrar agujeros dentro de objetos y para fusionar objetos cercanos. </p><br><p>  <strong>La apertura morfol√≥gica</strong> es una erosi√≥n seguida de una dilataci√≥n.  Se utiliza para eliminar peque√±os objetos de ruido y para separar los objetos en varios objetos. </p><br><p><img src="https://habrastorage.org/webt/7n/tt/ux/7nttuxnqs66djkmrav1amhg4mei.gif"></p><br><h1 id="paragraph4">  Algoritmo de Lee y compresi√≥n RLE </h1><br><p>  Para seleccionar objetos en volumen de v√≥xel binarizado, se utiliza el algoritmo de Lie.  Originalmente, este algoritmo se invent√≥ para encontrar la forma m√°s corta de salir del laberinto.  Lo usamos para seleccionar el objeto y moverlo de un conjunto tridimensional de v√≥xeles a otro.  La idea b√°sica del algoritmo consiste en un movimiento paralelo en todas las direcciones posibles desde el punto de partida.  Para un caso tridimensional, es posible moverse en 26 o 6 direcciones desde un v√≥xel. </p><br><p>  Para optimizar el rendimiento, se aplic√≥ el algoritmo de codificaci√≥n de longitud de ejecuci√≥n.  La idea principal del algoritmo es que la secuencia de unos y ceros se reemplaza por un d√≠gito igual al n√∫mero de elementos en la secuencia.  Por ejemplo, la cadena "00110111" se puede reemplazar por: "2;  2;  1;  3 ".  Esto reduce el n√∫mero de accesos a la memoria. </p><br><p><img src="https://habrastorage.org/webt/if/kr/h6/ifkrh6br6sgi65g8sowexfxxsis.gif"><img src="https://habrastorage.org/webt/9f/rr/nc/9frrncdin9axwhdwgad8vndnlqy.gif"></p><br><p>  Enlaces de Wikipedia: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">algoritmo Lee</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">algoritmo RLE</a> . </p><br><h1 id="paragraph5">  Transformaci√≥n umbral del volumen base </h1><br><p>  Usando el tom√≥grafo se obtuvieron los datos sobre una radiodensidad en cada punto del espacio escaneado.  Los v√≥xeles a√©reos tienen una radiodensidad en el rango de -1100 a -900 HU, y los v√≥xeles de los √≥rganos respiratorios tienen radiodensidad de -900 a -300 HU.  Por lo tanto, podemos eliminar todos los v√≥xeles innecesarios con radiodensidad superior a -300 HU.  Como resultado, obtenemos un volumen de v√≥xel binarizado que contiene solo los √≥rganos respiratorios y el aire. </p><br><p><img src="https://habrastorage.org/webt/di/lv/ss/dilvssyv2do2rvjlbb3xov798rw.gif"></p><br><h1 id="paragraph6">  Extracci√≥n de aire externo </h1><br><p>  Para segmentar el aire interno del cuerpo, eliminamos todos los objetos adyacentes a las esquinas del volumen 3D.  Por lo tanto, eliminamos el aire externo. </p><br><p><img src="https://habrastorage.org/webt/_b/ol/mh/_bolmh5kdpm65pt0ysosn-zk4iu.png"></p><br><p>  Sin embargo, no en todos los casos se eliminar√° el aire dentro de la mesa del tom√≥grafo, ya que puede no tener una conexi√≥n con las esquinas del volumen 3D. </p><br><p><img src="https://habrastorage.org/webt/mu/m1/bi/mum1bidj1at0nvceitxh5jtzqs4.png"></p><br><p>  Por lo tanto, escanearemos no solo las esquinas, sino tambi√©n todos los v√≥xeles que se encuentran en cualquiera de los planos de borde de la f.  Pero, como podemos ver en la imagen a continuaci√≥n, tambi√©n se extrajeron los pulmones.  Resulta que la tr√°quea tambi√©n ten√≠a una conexi√≥n con el plano superior del volumen 3D. </p><br><p><img src="https://habrastorage.org/webt/fu/zb/3b/fuzb3bzxnvxvofjz-mxoelly5w4.gif"></p><br><p>  Tendremos que excluir el plano superior del √°rea de escaneo.  Tambi√©n hay estudios en los que los pulmones no se capturaron completamente y el plano inferior est√° conectado a los pulmones. <br>  Entonces, si lo desea, tambi√©n puede excluir el plano inferior. </p><br><p><img src="https://habrastorage.org/webt/uf/ja/mb/ufjambvoavwiks-09hms7wc02lg.png"></p><br><p>  Pero este m√©todo solo afecta los estudios de t√≥rax.  En el caso de la captura del volumen completo del cuerpo, aparecer√° la conexi√≥n de aire interno y externo a trav√©s de la cavidad nasal. Por lo tanto, es necesario aplicar erosi√≥n morfol√≥gica para separar el aire interno y externo. </p><br><p><img src="https://habrastorage.org/webt/zf/za/ej/zfzaejokke75l8wiqqj20ma_mjs.gif"></p><br><p>  Despu√©s de aplicar la erosi√≥n, podemos volver al m√©todo de segmentaci√≥n del aire externo previamente obtenido que se basa en la conectividad del aire externo con los planos laterales del volumen 3D. </p><br><p><img src="https://habrastorage.org/webt/yj/i7/nh/yji7nhiveqpxbky3_qgj9b6n0zq.png"></p><br><p>  Despu√©s de la segmentaci√≥n del aire externo, podr√≠amos restar inmediatamente el aire externo del volumen total del aire y los pulmones y obtener el aire interno del cuerpo y los pulmones.  Pero hay un problema.  Despu√©s de la erosi√≥n, se perdi√≥ parte de la informaci√≥n sobre el aire externo.  Para restaurarlo, aplicamos dilataci√≥n del aire externo. </p><br><p><img src="https://habrastorage.org/webt/vn/tu/ns/vntunsho-og3pm1at7dqi3_ltna.gif"></p><br><p>  Luego, restamos el aire externo del aire completo y los √≥rganos respiratorios y obtenemos el aire interno y los √≥rganos respiratorios. </p><br><p><img src="https://habrastorage.org/webt/fr/hx/df/frhxdfz7ax9fz-ps7x9zjrlgiqo.png"></p><br><p><img src="https://habrastorage.org/webt/mw/d6/qc/mwd6qcn4xkuj5m5xsp-trc0usk4.png"></p><br><h1 id="paragraph7">  Segmentaci√≥n del objeto de volumen m√°ximo. </h1><br><p>  A continuaci√≥n, segmentamos los √≥rganos respiratorios como el objeto m√°ximo en volumen.  Los √≥rganos respiratorios no tienen conexi√≥n con el aire dentro del tracto gastrointestinal. </p><br><p><img src="https://habrastorage.org/webt/7l/gt/bd/7lgtbdfvf0st73wqzlacvax1r-0.png"><img src="https://habrastorage.org/webt/5d/ce/8u/5dce8urp2qvopyat905ex9y_qqs.png"></p><br><p>  Vale la pena se√±alar que la elecci√≥n correcta del umbral de radiodensidad en el paso inicial es importante.  De lo contrario, en algunos casos, puede no haber conexi√≥n entre los dos pulmones como resultado de la baja resoluci√≥n.  Por ejemplo, si suponemos que los v√≥xeles de los √≥rganos respiratorios tienen una radiodensidad de -500 HU y menos, entonces, en el siguiente caso, la segmentaci√≥n de los √≥rganos respiratorios como el objeto m√°s grande en volumen conducir√° a un error, porque no hay conexi√≥n entre Los dos pulmones.  Por lo tanto, el umbral debe aumentarse a -300 HU. </p><br><p><img src="https://habrastorage.org/webt/jr/mi/m2/jrmim2de5siht6zo2nhoz8l1e5e.png"></p><br><h1 id="paragraph8">  Cerrar los vasos dentro de los pulmones. </h1><br><p>  Para capturar los vasos dentro de los pulmones, utilizaremos el cierre morfol√≥gico, es decir, dilataci√≥n seguida de erosi√≥n con el mismo radio.  La radiodensidad de los vasos (sin contraste) es de aproximadamente 0..100 HU. </p><br><p><img src="https://habrastorage.org/webt/po/1a/nz/po1anz0m9em66lsawok9fuwncvo.png"></p><br><p>  En la imagen podemos ver que los canales sangu√≠neos grandes no est√°n cerrados.  Pero esto no es necesario.  El prop√≥sito de esta operaci√≥n fue destruir los muchos agujeros peque√±os dentro de los pulmones para simplificar el proceso de segmentaci√≥n pulmonar en los pr√≥ximos pasos. </p><br><h1 id="paragraph9">  Algoritmo de segmentaci√≥n de √≥rganos respiratorios </h1><br><p>  Como resultado, obtenemos el siguiente algoritmo de segmentaci√≥n de √≥rganos respiratorios: </p><br><ol><li>  Transformaci√≥n de umbral del volumen base con el umbral "&lt;-300 HU". </li><li>  Erosi√≥n morfol√≥gica con un radio de 3 mm para la separaci√≥n del aire externo e interno. </li><li>  Segmentaci√≥n del aire externo basada en la conectividad del aire externo con los planos laterales del volumen 3D. </li><li>  Dilataci√≥n morfol√≥gica del aire externo para restaurar la informaci√≥n perdida despu√©s de la erosi√≥n. </li><li>  Resta del aire externo de todo el aire y los √≥rganos respiratorios para obtener el aire interno y los √≥rganos respiratorios. </li><li>  Segmentaci√≥n del objeto de volumen m√°ximo. </li><li>  Cierre morfol√≥gico de los vasos dentro de los pulmones. </li></ol><br><p><img src="https://habrastorage.org/webt/pv/xf/ee/pvxfee1i06siq8wa66ynzbuxku0.png"></p><br><h1 id="paragraph10">  Implementaci√≥n de algoritmos en MATLAB </h1><br><h3 id="function-getrespiratoryorgans">  Funci√≥n "getRespiratoryOrgans" </h3><br><pre><code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the whole respiratory organs volume (lung and airway volume) % without separating of the left and right lung. % V = base volume with radiodensity data in Hounsfield units. % cr = radius of vessels morphological closing. % ci = iteration count of vessels morphological closing (fe 3-times % make dilation and after that 3-times make erosion. function RO = getRespiratoryOrgans(V,cr,ci) % Threshold transform of the base volume with the threshold level "&lt;-300 HU". AL=~imbinarize(V,-300); % Morphological erosion with the 3 mm radius for the separation of external % and internal air. SE=strel('sphere',3); EAL=imerode(AL,SE); % Segmentation of external air based on external air connectivity with the % boundary side planes of the 3D volume. EA=getExternalAir(EAL); % Morphological dilation of the external air to restore the information lost % after the erosion. DEA=EA; for i=1:4 DEA=imdilate(DEA,SE); DEA=DEA&amp;AL; end % Subtraction of the external air from the whole air and respiratory organs to % obtain the internal air and respiratory organs. IAL=AL-DEA; % Segmentation of the maximum volume object. RO=getMaxObject(IAL); Morphological closing of the vessels inside the lungs. RO=closeVoxelVolume(RO,3,2);</span></span></code> </pre> <br><h3 id="function-getexternalair">  Funci√≥n "getExternalAir" </h3><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the volume which is connected with the edge surfaces of % the voxel scene (except the top surface, because lungs can have % a connection with the top surface). % EAL = eroded lung-and-air binarized volume. function EA = getExternalAir(EAL) % The ‚Äúbwlabeln‚Äù function segments objects: voxels of a one object % equates to 1, and of another one - to 2, etc. V=bwlabeln(EAL); % We request such characteristics of the objects as bounding box and % list of all object voxels. R=regionprops3(V,'BoundingBox','VoxelList'); n=height(R); % Create a 3D matrix for storing external air voxels. s=size(EAL); EA=zeros(s,'logical'); % Scan all the objects to find objects belonging to the external air. for i=1:n % Define the minimum and maximum x and y coordinates of the object. x0=R(i,1).BoundingBox(1); y0=R(i,1).BoundingBox(2); x1=x0+R(i,1).BoundingBox(4); y1=y0+R(i,1).BoundingBox(5); % If the edge voxels of the object are in contact with the side planes of % the 3D volume, then copy all the voxels of this object into the matrix EA. if (x0 &lt; 1 || x1 &gt; s(1)-1 || y0 &lt; 1 || y1 &gt; s(2)-1) % Convert the object voxel coordinates data to the matrix type: % [[x1 y1 z1] [x2 y2 z3] ... [xn yn zn]]. mat=cell2mat(R(i,2).VoxelList); ms=size(mat); % Fill the matrix containing the voxels of the external air. for j=1:ms(1) x=mat(j,2); y=mat(j,1); z=mat(j,3); EA(x,y,z)=1; end end end</span></span></code> </pre> <br><h3 id="function-getmaxobject">  Funci√≥n "getMaxObject" </h3><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the largest object in the voxel volume V. % O = the voxels of the largest object. % m = the volume of the largest object. function [O,m] = getMaxObject(V) % Segment the objects. V=bwlabeln(V); % Reqiest the information about the objects volume and objects voxel coordinates. R=regionprops3(V,'Volume','VoxelList'); % Determine the index of the maximum volume object. v=R(:,1).Volume; [m,i]=max(v); % Create the 3D matrix for storing the largest object voxels. s=size(V); O=zeros(s,'logical'); % Copy the largest object voxels to the new matrix. mat=cell2mat(R(i,2).VoxelList); ms=size(mat); for j=1:ms(1) x=mat(j,2); y=mat(j,1); z=mat(j,3); O(x,y,z)=1; end</span></span></code> </pre> <br><p>  El c√≥digo fuente puede ser descargado por la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">referencia</a> . </p><br><h1 id="paragraph11">  Conclusi√≥n </h1><br><p>  Los siguientes art√≠culos ser√°n: </p><br><ol><li>  segmentaci√≥n de tr√°quea y bronquios; </li><li>  segmentaci√≥n pulmonar; </li><li>  segmentaci√≥n de l√≥bulos pulmonares. </li></ol><br><p>  Se considerar√°n los siguientes algoritmos: </p><br><ol><li>  transformaci√≥n de distancia; </li><li>  transformaci√≥n vecina m√°s cercana, tambi√©n conocida como transformaci√≥n de caracter√≠sticas; </li><li>  c√°lculo de los valores propios de la matriz de Hesse para la segmentaci√≥n de objetos planos en 3D; </li><li>  segmentaci√≥n de cuencas hidrogr√°ficas. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/461329/">https://habr.com/ru/post/461329/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461319/index.html">¬øQu√© hace un dise√±ador de juegos?</a></li>
<li><a href="../461321/index.html">Modelos gen√©ricos y de metaprogramaci√≥n: Go, Rust, Swift, D y otros.</a></li>
<li><a href="../461323/index.html">Una explicaci√≥n accesible del algoritmo de colapso de la funci√≥n de onda</a></li>
<li><a href="../461325/index.html">Victoria en PHDays 9. Compartimos hacks de vida en tres partes. Parte 3</a></li>
<li><a href="../461327/index.html">Crisis de front-end?</a></li>
<li><a href="../461333/index.html">ITX5 mitap: JAVA en vivo, magia de Kotlin y yesca de tomate</a></li>
<li><a href="../461339/index.html">C√≥mo ser impulsado por los datos. Desde el principio</a></li>
<li><a href="../461341/index.html">Desarrollo m√≥vil hh.ru y d√≥nde vive</a></li>
<li><a href="../461345/index.html">C√≥mo convertimos el calor humano en electricidad</a></li>
<li><a href="../461349/index.html">T√≠mido, o all√° y de regreso</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>