<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•‹ ğŸ—ºï¸ ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ è´ªå©ªçš„æ–¹æ³•å’Œè€è™æœºã€‚ ç¼–ç¨‹å† å†›èµ›çš„MLè½¨é“ä»»åŠ¡åˆ†æ ğŸ¿ âœŒğŸ¾ ã€½ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬å°†ç»§ç»­å‘å¸ƒå¯¹æœ€è¿‘çš„å† å†›èµ›æå‡ºçš„ä»»åŠ¡çš„åˆ†æã€‚ æ¥ä¸‹æ¥çš„æ˜¯æœºå™¨å­¦ä¹ ä¸“å®¶çš„èµ„æ ¼å›åˆä¸­çš„ä»»åŠ¡ã€‚ è¿™æ˜¯å››ä¸ªï¼ˆåç«¯ï¼Œå‰ç«¯ï¼ŒMLï¼Œåˆ†æï¼‰çš„ç¬¬ä¸‰æ¡è½¨é“ã€‚ å‚ä¸è€…éœ€è¦å»ºç«‹ä¸€ä¸ªçº æ­£æ–‡æœ¬è¾“å…¥é”™è¯¯çš„æ¨¡å‹ï¼Œæå‡ºä¸€ç§åœ¨è€è™æœºä¸Šç©çš„ç­–ç•¥ï¼Œæƒ³åˆ°ä¸€ä¸ªé’ˆå¯¹å†…å®¹çš„æ¨èç³»ç»Ÿï¼Œå¹¶ç¼–å†™æ›´å¤šç¨‹åºã€‚ 

 A.é”™åˆ«å­— 
 æ¡ä»¶  æ‰€æœ‰è¯­è¨€  ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>è´ªå©ªçš„æ–¹æ³•å’Œè€è™æœºã€‚ ç¼–ç¨‹å† å†›èµ›çš„MLè½¨é“ä»»åŠ¡åˆ†æ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/461273/"><img src="https://habrastorage.org/webt/sd/i7/yd/sdi7ydyv5yabtpudjamnnmm2dge.jpeg"><br><br> æˆ‘ä»¬å°†ç»§ç»­å‘å¸ƒå¯¹æœ€è¿‘çš„å† å†›èµ›æå‡ºçš„ä»»åŠ¡çš„åˆ†æã€‚ æ¥ä¸‹æ¥çš„æ˜¯æœºå™¨å­¦ä¹ ä¸“å®¶çš„èµ„æ ¼å›åˆä¸­çš„ä»»åŠ¡ã€‚ è¿™æ˜¯å››ä¸ªï¼ˆåç«¯ï¼Œå‰ç«¯ï¼ŒMLï¼Œåˆ†æï¼‰çš„ç¬¬ä¸‰æ¡è½¨é“ã€‚ å‚ä¸è€…éœ€è¦å»ºç«‹ä¸€ä¸ªçº æ­£æ–‡æœ¬è¾“å…¥é”™è¯¯çš„æ¨¡å‹ï¼Œæå‡ºä¸€ç§åœ¨è€è™æœºä¸Šç©çš„ç­–ç•¥ï¼Œæƒ³åˆ°ä¸€ä¸ªé’ˆå¯¹å†…å®¹çš„æ¨èç³»ç»Ÿï¼Œå¹¶ç¼–å†™æ›´å¤šç¨‹åºã€‚ <br><br><a name="habracut"></a><h2>  A.é”™åˆ«å­— </h2><br><h4> æ¡ä»¶ </h4><div class="scrollable-table"><table><tbody><tr><td></td><td>  <b>æ‰€æœ‰è¯­è¨€</b> </td><td>  <b>python2.7 + numpyçš„</b> </td><td>  <b>python3.5 + numpyçš„</b> </td></tr><tr><td> æ—¶é—´é™åˆ¶ </td><td>  1ç§’ </td><td>  5ç§’ </td><td>  5ç§’ </td></tr><tr><td> å†…å­˜é™åˆ¶ </td><td>  64å…†å­—èŠ‚ </td><td>  256å…†å­—èŠ‚ </td><td>  256å…†å­—èŠ‚ </td></tr><tr><td> è¿›å…¥ </td><td colspan="3"> æ ‡å‡†è¾“å…¥æˆ–input.txt </td></tr><tr><td> ç»“è®º </td><td colspan="3"> æ ‡å‡†è¾“å‡ºæˆ–output.txt </td></tr></tbody></table></div>  ï¼ˆå²è¯—ï¼‰ï¼ˆæ¥è‡ªä¸€ä¸ªè®ºå›ï¼‰ <br>  -è°èƒ¡è¯´å…«é“ï¼Ÿ <br>  -å¤©ä½“ç‰©ç†å­¦å®¶ã€‚ ä»–ä»¬ä¹Ÿæ˜¯äººã€‚ <br>  -æ‚¨åœ¨â€œæ–°é—»è®°è€…â€ä¸€è¯ä¸­çŠ¯äº†10ä¸ªé”™è¯¯ã€‚ <br><br> è®¸å¤šç”¨æˆ·ä¼šè¾“å…¥é”™è¯¯ï¼Œæœ‰äº›æ˜¯å› ä¸ºæŒ‰ä¸‹é”®ï¼Œæœ‰äº›æ˜¯å› ä¸ºä»–ä»¬çš„æ–‡ç›²ã€‚ æˆ‘ä»¬è¦æ£€æŸ¥çš„æ˜¯ï¼Œç”¨æˆ·å®é™…ä¸Šæ˜¯å¦è¿˜è®°å¾—ä»–é”®å…¥çš„å…¶ä»–å•è¯ã€‚ <br><br> æ›´æ­£å¼åœ°ï¼Œå‡è®¾å‘ç”Ÿä»¥ä¸‹é”™è¯¯æ¨¡å‹ï¼šç”¨æˆ·ä»ä»–è¦å†™çš„å•è¯å¼€å§‹ï¼Œç„¶ååœ¨å…¶ä¸­äº§ç”Ÿè®¸å¤šé”™è¯¯ã€‚ æ¯ä¸ªé”™è¯¯éƒ½æ˜¯å°†å•è¯çš„æŸä¸ªå­å­—ç¬¦ä¸²æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­å­—ç¬¦ä¸²ã€‚ ä¸€ä¸ªé”™è¯¯å¯¹åº”äºä»…åœ¨ä¸€ä¸ªä½ç½®è¿›è¡Œæ›¿æ¢ï¼ˆå³ï¼Œå¦‚æœç”¨æˆ·å¸Œæœ›é€šè¿‡è§„åˆ™â€œ abcâ€â†’â€œ cbaâ€è¿›è¡Œå•ä¸ªé”™è¯¯ï¼Œåˆ™å¯ä»¥ä»å­—ç¬¦ä¸²â€œ abcabcâ€ä¸­è·å–â€œ cbaabcâ€æˆ–â€œ abccbaâ€ï¼‰ã€‚ æ¯ä¸ªé”™è¯¯ä¹‹åï¼Œè¯¥è¿‡ç¨‹éƒ½ä¼šé‡å¤ã€‚ ç›¸åŒçš„è§„åˆ™å¯ä»¥åœ¨ä¸åŒçš„æ­¥éª¤ä¸­å¤šæ¬¡ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸¤ä¸ªæ­¥éª¤è·å¾—â€œ cbacbaâ€ï¼‰ã€‚ <br><br> å¦‚æœç”¨æˆ·è®°ä½ä¸€ä¸ªç»™å®šçš„å•è¯å¹¶å†™å‡ºå¦ä¸€ä¸ªç»™å®šçš„å•è¯ï¼Œåˆ™éœ€è¦ç¡®å®šç”¨æˆ·å¯èƒ½çŠ¯çš„æœ€å°é”™è¯¯æ•°ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">I / Oæ ¼å¼å’Œç¤ºä¾‹</b> <div class="spoiler_text"><h4> è¾“å…¥æ ¼å¼ </h4><br> ç¬¬ä¸€è¡ŒåŒ…å«è¯¥å•è¯ï¼Œæ ¹æ®æˆ‘ä»¬çš„å‡è®¾ï¼Œè¯¥å•è¯æ˜¯ç”¨æˆ·æƒ³åˆ°çš„ï¼ˆå®ƒç”±å°å†™æ‹‰ä¸å­—æ¯ç»„æˆï¼Œé•¿åº¦ä¸è¶…è¿‡20ï¼‰ã€‚ <br><br> ç¬¬äºŒè¡ŒåŒ…å«ä»–å®é™…å†™çš„å•è¯ï¼ˆä¹Ÿç”±å°å†™æ‹‰ä¸å­—æ¯ç»„æˆï¼Œé•¿åº¦ä¸è¶…è¿‡20ï¼‰ã€‚ <br><br> ç¬¬ä¸‰è¡ŒåŒ…å«å•ä¸ªæ•°å­—Nï¼ˆN &lt;50ï¼‰-æè¿°å„ç§é”™è¯¯çš„æ›¿æ¢æ¬¡æ•°ã€‚ <br><br> æ¥ä¸‹æ¥çš„Nè¡ŒåŒ…å«ä»¥ä¸‹æ ¼å¼çš„å¯èƒ½æ›¿æ¢é¡¹ï¼š&lt;æ­£ç¡®çš„å­—æ¯åºåˆ—&gt; &lt;ç©ºæ ¼&gt; &lt;é”™è¯¯çš„å­—æ¯åºåˆ—&gt;ã€‚ åºåˆ—ä¸å¾—è¶…è¿‡6ä¸ªå­—ç¬¦ã€‚ <br><br><h4> è¾“å‡ºæ ¼å¼ </h4><br> éœ€è¦æ‰“å°ä¸€ä¸ªæ•°å­—-ç”¨æˆ·å¯èƒ½çŠ¯çš„æœ€å°é”™è¯¯æ•°ã€‚ å¦‚æœè¯¥æ•°å­—è¶…è¿‡4ï¼Œæˆ–è€…ä¸å¯èƒ½ä»ä¸€ä¸ªå•è¯ä¸­å¾—åˆ°å¦ä¸€ä¸ªï¼Œè¯·æ‰“å°-1ã€‚ <br><br><h4> ä¾‹å­ </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td><code>mlax <br> drum <br> 50 <br> lr <br> mlax gtwt <br> md <br> mlax ujoc <br> ml pq <br> mf <br> ml bf <br> mlax aruq <br> mlax nqdd <br> mlax fglm <br> mlax bfit <br> mlax mziq <br> mla hlb <br> au <br> mlax vmpa <br> mw <br> aw <br> ax ok <br> mla kqf <br> me <br> xx <br> ml if <br> ml gk <br> le <br> mla xrh <br> mj <br> ac <br> ab <br> mq <br> ax fr <br> ml sb <br> mlax gxxx <br> xm <br> mlax hczx <br> lq <br> la sv <br> lg <br> ax eh <br> lax mjh <br> la ec <br> la pv <br> ml iq <br> aq <br> lax jrs <br> la qn <br> lax bjo <br> lo <br> az <br> ln <br> ac</code> </td> <td> <code>4</code> </td> </tr></tbody></table></div></div></div><br><h4> è§£å†³æ–¹æ¡ˆ </h4><br> è®©æˆ‘ä»¬å°è¯•ä»æ­£ç¡®çš„æ‹¼å†™ä¸­ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„å•è¯ï¼Œä¸”é”™è¯¯ä¸è¶…è¿‡4ä¸ªã€‚ åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šæœ‰Oï¼ˆï¼ˆLï¹’Nï¼‰ <sup>4</sup> ï¼‰ã€‚ åœ¨é—®é¢˜çš„å±€é™ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“å¤§çš„æ•°ç›®ï¼Œå› æ­¤æ‚¨éœ€è¦å¼„æ¸…æ¥šå¦‚ä½•é™ä½å¤æ‚æ€§ã€‚ ç›¸åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸­é—´ç›¸é‡ç®—æ³•ï¼šç”Ÿæˆä¸è¶…è¿‡2ä¸ªé”™è¯¯çš„å•è¯ï¼Œä»¥åŠå¯ä»¥ä»ä¸­è·å–ä¸è¶…è¿‡2ä¸ªé”™è¯¯çš„ç”¨æˆ·ç¼–å†™å•è¯çš„å•è¯ã€‚ è¯·æ³¨æ„ï¼Œæ¯ä¸ªé›†åˆçš„å¤§å°ä¸ä¼šè¶…è¿‡10 <sup>6</sup> ã€‚ å¦‚æœç”¨æˆ·çŠ¯çš„é”™è¯¯æ•°é‡ä¸è¶…è¿‡4ï¼Œåˆ™è¿™äº›é›†åˆå°†ç›¸äº¤ã€‚ åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯é”™è¯¯æ•°é‡ä¸è¶…è¿‡3ã€2å’Œ1ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FromTo</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> from; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> to; }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::pair&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; applyRule(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&amp; word, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FromTo &amp;fromTo, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pos) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> from = word.find(fromTo.from, pos); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (from == <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos, {}}; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> to = from + fromTo.from.size(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> cpy = word; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = from; i &lt; to; i++) { cpy[i] = fromTo.to[i - from]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {from, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(cpy)}; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inverseRules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;FromTo&gt; &amp;rules)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; rule: rules) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::swap(rule.from, rule.to); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; wordOrig, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; wordMissprinted, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;FromTo&gt;&amp; replaces)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_map</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mapping; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_map</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; mappingInverse; mapping.emplace(wordOrig, <span class="hljs-number"><span class="hljs-number">0</span></span>); mappingInverse.emplace(<span class="hljs-number"><span class="hljs-number">0</span></span>, wordOrig); mapping.emplace(wordMissprinted, <span class="hljs-number"><span class="hljs-number">1</span></span>); mappingInverse.emplace(<span class="hljs-number"><span class="hljs-number">1</span></span>, wordMissprinted); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_map</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_set</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&gt; edges; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> buildGraph = [&amp;edges, &amp;mapping, &amp;mappingInverse](<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> startId, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;FromTo&gt;&amp; replaces, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> dir) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_set</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mappingLayer0; mappingLayer0 = {startId}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_set</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mappingLayer1; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; v: mappingLayer0) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; word = mappingInverse.at(v); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; fromTo: replaces) { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> from = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> [tmp, wordCpy] = applyRule(word, fromTo, from); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tmp == <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } from = tmp + <span class="hljs-number"><span class="hljs-number">1</span></span>; { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> w = mapping.size(); mapping.emplace(wordCpy, w); w = mapping.at(wordCpy); mappingInverse.emplace(w, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(wordCpy)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dir) { edges[v].emplace(w); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { edges[w].emplace(v); } mappingLayer1.emplace(w); } } } } mappingLayer0 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(mappingLayer1); } }; buildGraph(<span class="hljs-number"><span class="hljs-number">0</span></span>, replaces, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); inverseRules(replaces); buildGraph(<span class="hljs-number"><span class="hljs-number">1</span></span>, replaces, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">queue</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::pair&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&gt; q; q.emplace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; mask(mapping.size(), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> level{<span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (q.size()) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> [w, level] = q.front(); q.pop(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mask[w]) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } mask[w] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mappingInverse.at(w) == wordMissprinted) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> level; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; v: edges[w]) { q.emplace(v, level + <span class="hljs-number"><span class="hljs-number">1</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; }</code> </pre> <br><h2>  B.å¤šè‡‚åŒª </h2><br><h4> æ¡ä»¶ </h4><div class="scrollable-table"><table><tbody><tr><td> æ—¶é—´é™åˆ¶ </td><td>  2ç§’ </td></tr><tr><td> å†…å­˜é™åˆ¶ </td><td>  64å…†å­—èŠ‚ </td></tr><tr><td> è¿›å…¥ </td><td> æ ‡å‡†è¾“å…¥ </td></tr><tr><td> ç»“è®º </td><td> æ ‡å‡†è¾“å‡º </td></tr></tbody></table></div> è¿™æ˜¯ä¸€ä¸ªäº¤äº’å¼ä»»åŠ¡ã€‚ <br><br> æ‚¨è‡ªå·±ä¸çŸ¥é“å®ƒæ˜¯æ€ä¹ˆå‘ç”Ÿçš„ï¼Œä½†æ˜¯æ‚¨å‘ç°è‡ªå·±åœ¨ä¸€ä¸ªè£…æœ‰è€è™æœºå’Œæ•´è¢‹ä»¤ç‰Œçš„å¤§å…é‡Œã€‚ ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ç¥¨æˆ¿ä¸Šï¼Œä»–ä»¬æ‹’ç»æ¥å—ä»£å¸ï¼Œå› æ­¤æ‚¨å†³å®šå°è¯•ä¸€ä¸‹è¿æ°”ã€‚ å¤§å…é‡Œæœ‰å¾ˆå¤šè€è™æœºå¯ä»¥ç©ã€‚ å¯¹äºå¸¦æœ‰è€è™æœºçš„æ¸¸æˆï¼Œæ‚¨ä½¿ç”¨ä¸€ä¸ªä»¤ç‰Œã€‚ å¦‚æœèµ¢äº†ï¼Œæœºå™¨ç»™æ‚¨ä¸€ç¾å…ƒï¼Œå¦‚æœå‡ºç°æŸå¤±ï¼Œæ‚¨ä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚ æ¯å°æœºå™¨éƒ½æœ‰å›ºå®šçš„è·èƒœæ¦‚ç‡ï¼ˆæ‚¨ä¸çŸ¥é“ï¼‰ï¼Œä½†æ˜¯å¯¹äºä¸åŒçš„æœºå™¨è€Œè¨€ï¼Œè·èƒœçš„æ¦‚ç‡æ˜¯ä¸åŒçš„ã€‚ åœ¨ç ”ç©¶äº†è¿™äº›æœºå™¨åˆ¶é€ å•†çš„ç½‘ç«™ä¹‹åï¼Œæ‚¨å‘ç°åœ¨åˆ¶é€ é˜¶æ®µï¼Œä»å¸¦æœ‰æŸäº›å‚æ•°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">betaåˆ†å¸ƒä¸­</a>éšæœºé€‰æ‹©æ¯å°æœºå™¨è·èƒœçš„æ¦‚ç‡ã€‚ <br><br> æ‚¨æƒ³æœ€å¤§åŒ–æ‚¨çš„é¢„æœŸå¥–é‡‘ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">I / Oæ ¼å¼å’Œç¤ºä¾‹</b> <div class="spoiler_text"><h4> è¾“å…¥æ ¼å¼ </h4><br> ä¸€ä¸ªæ‰§è¡Œå¯èƒ½åŒ…å«å¤šä¸ªæµ‹è¯•ã€‚ <br><br> æ¯æ¬¡æµ‹è¯•éƒ½ä»¥è¿™æ ·çš„äº‹å®å¼€å§‹ï¼šè¯¥è¡Œä¸Šçš„ç¨‹åºåŒ…å«ä¸¤ä¸ªæ•´æ•°ï¼Œæ¯ä¸ªæ•´æ•°ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ï¼šæ•°å­—Næ˜¯åŒ…ä¸­ä»¤ç‰Œçš„æ•°é‡ï¼Œè€ŒMæ˜¯å¤§å…ä¸­çš„æœºå™¨æ•°é‡ï¼ˆNâ‰¤10 <sup>4</sup> ï¼ŒMâ‰¤minï¼ˆNï¼Œ100ï¼‰ ï¼‰ ä¸‹ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªå®æ•°Î±å’ŒÎ²ï¼ˆ1â‰¤Î±ï¼ŒÎ²â‰¤10ï¼‰-è·èƒœæ¦‚ç‡çš„betaåˆ†å¸ƒå‚æ•°ã€‚ <br><br> ä¸æ£€æŸ¥ç³»ç»Ÿçš„é€šä¿¡åè®®æ˜¯è¿™æ ·çš„ï¼šæ‚¨æ°å¥½å‘å‡ºäº†Nä¸ªè¯·æ±‚ã€‚ å¯¹äºæ¯ä¸ªè¯·æ±‚ï¼Œè¯·åœ¨å•ç‹¬çš„è¡Œä¸­æ‰“å°å°†è¦æ’­æ”¾çš„æœºå™¨çš„ç¼–å·ï¼ˆä»1åˆ°Mï¼‰ã€‚ ä½œä¸ºç­”æ¡ˆï¼Œåœ¨å•ç‹¬çš„ä¸€è¡Œä¸­å°†æ˜¯â€œ 0â€æˆ–â€œ 1â€ï¼Œåˆ†åˆ«è¡¨ç¤ºåœ¨ä½¿ç”¨è¯·æ±‚çš„è€è™æœºçš„æ¸¸æˆä¸­çš„è¾“èµ¢ã€‚ <br><br> åœ¨æœ€åä¸€æ¬¡æµ‹è¯•åï¼Œå°†ä¸å†æ˜¯æ•°å­—Nå’ŒMï¼Œè€Œæ˜¯ä¸¤ä¸ªé›¶ã€‚ <br><br><h4> è¾“å‡ºæ ¼å¼ </h4><br> å¦‚æœæ‚¨çš„å†³å®šä¸æ¯”é™ªå®¡å›¢çš„å†³å®šå·®å¾ˆå¤šï¼Œåˆ™è®¤ä¸ºè¯¥ä»»åŠ¡å·²å®Œæˆã€‚ å¦‚æœæ‚¨çš„å†³å®šæ¯”é™ªå®¡å›¢çš„å†³å®šå·®å¾ˆå¤šï¼Œæ‚¨å°†æ”¶åˆ°åˆ¤å†³â€œé”™è¯¯ç­”æ¡ˆâ€ã€‚ <br><br> å¯ä»¥ä¿è¯ï¼Œå¦‚æœæ‚¨çš„å†³å®šä¸å·®äºé™ªå®¡å›¢çš„å†³å®šï¼Œé‚£ä¹ˆæ”¶åˆ°åˆ¤å†³â€œé”™è¯¯ç­”æ¡ˆâ€çš„å¯èƒ½æ€§ä¸ä¼šè¶…è¿‡<sup>10-6</sup> ã€‚ <br><br><h4> æ³¨æ„äº‹é¡¹ </h4><br> äº’åŠ¨ç¤ºä¾‹ï¼š <br><br><pre> <code class="cpp hljs">____________________  <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>     <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span> ____________________ ____________________   <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>              <span class="hljs-number"><span class="hljs-number">2</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span>              <span class="hljs-number"><span class="hljs-number">2</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span>              <span class="hljs-number"><span class="hljs-number">2</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </div></div><br><h4> è§£å†³æ–¹æ¡ˆ </h4><br> è¿™ä¸ªé—®é¢˜æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ï¼Œå¯ä»¥ç”¨ä¸åŒçš„æ–¹æ³•è§£å†³ã€‚ é™ªå®¡å›¢çš„ä¸»è¦å†³å®šæ˜¯å®æ–½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ±¤æ™®æ£®ï¼ˆThompsonï¼‰æŠ½æ ·</a>ç­–ç•¥ï¼Œä½†ç”±äºåœ¨ç¨‹åºå¼€å§‹æ—¶å°±çŸ¥é“äº†æ­¥éª¤æ•°ï¼Œå› æ­¤æœ‰æ›´å¤šçš„æœ€ä½³ç­–ç•¥ï¼ˆä¾‹å¦‚UCB1ï¼‰ã€‚ è€Œä¸”ï¼Œç”šè‡³å¯ä»¥é€šè¿‡epsilon-greedy-strategyæ¥è§£å†³ï¼šä»¥ä¸€å®šçš„æ¦‚ç‡Îµç©éšæœºæœºå™¨ï¼Œä»¥ï¼ˆ1-Îµï¼‰çš„æ¦‚ç‡ç©å…·æœ‰æœ€ä½³èƒœåˆ©ç»Ÿè®¡æ•°æ®çš„æœºå™¨ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SolverFromStdIn</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.regrets = [<span class="hljs-number"><span class="hljs-number">0.</span></span>] self.total_win = [<span class="hljs-number"><span class="hljs-number">0.</span></span>] self.moves = [] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThompsonSampling</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SolverFromStdIn)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, bandits_total, init_a=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, init_b=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" init_a (int): initial value of a in Beta(a, b). init_b (int): initial value of b in Beta(a, b). """</span></span> SolverFromStdIn.__init__(self) self.n = bandits_total self.alpha = init_a self.beta = init_b self._as = [init_a] * self.n <span class="hljs-comment"><span class="hljs-comment"># [random.betavariate(self.alpha, self.beta) for _ in range(self.n)] self._bs = [init_b] * self.n # [random.betavariate(self.alpha, self.beta) for _ in range(self.n)] self.last_move = -1 random.seed(int(time.time())) def move(self): samples = [random.betavariate(self._as[x], self._bs[x]) for x in range(self.n)] self.last_move = max(range(self.n), key=lambda x: samples[x]) self.moves.append(self.last_move) return self.last_move def set_reward(self, reward): i = self.last_move r = reward self._as[i] += r self._bs[i] += (1 - r) return i, r while True: n, m = map(int, sys.stdin.readline().split()) if n == 0 and m == 0: break alpha, beta = map(float, sys.stdin.readline().split()) solver = ThompsonSampling(m) for _ in range(n): print &gt;&gt; sys.stdout, solver.move() + 1 sys.stdout.flush() reward = int(sys.stdin.readline()) solver.set_reward(reward)</span></span></code> </pre> <br><h2>  C.å¥å­å¯¹é½ </h2><br><h4> æ¡ä»¶ </h4><div class="scrollable-table"><table><tbody><tr><td> æ—¶é—´é™åˆ¶ </td><td>  2ç§’ </td></tr><tr><td> å†…å­˜é™åˆ¶ </td><td>  64å…†å­—èŠ‚ </td></tr><tr><td> è¿›å…¥ </td><td> æ ‡å‡†è¾“å…¥æˆ–input.txt </td></tr><tr><td> ç»“è®º </td><td> æ ‡å‡†è¾“å‡ºæˆ–output.txt </td></tr></tbody></table></div> è®­ç»ƒè‰¯å¥½çš„æœºå™¨ç¿»è¯‘æ¨¡å‹æœ€é‡è¦çš„ä»»åŠ¡ä¹‹ä¸€å°±æ˜¯å¹¶è¡Œå¥å­çš„æ¡ˆä¾‹ã€‚ é€šå¸¸ï¼Œå¹¶è¡ŒæŠ¥ä»·çš„æ¥æºæ˜¯å¹¶è¡Œæ–‡æ¡£ã€‚ äº‹å®è¯æ˜ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä¸ºäº†å»ºç«‹å¹³è¡Œå¥å­çš„ç‰¹å®šè¯­æ–™åº“ï¼Œæ‚¨ä¸éœ€è¦çŸ¥é“å…¶é•¿åº¦å³å¯ã€‚ ç‰¹åˆ«æ˜¯ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æºè¯­è¨€ä¸­çš„å¥å­è¶Šé•¿ï¼Œæœ€æœ‰å¯èƒ½è¢«ç¿»è¯‘çš„æ—¶é—´å°±è¶Šé•¿ã€‚ å›°éš¾ä¹‹å¤„åœ¨äºï¼Œåœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­ï¼Œæ–‡æœ¬ä¸­å¥å­çš„æ•°é‡ä¼šå‘ç”Ÿå˜åŒ–ï¼šæœ‰æ—¶å€™ï¼Œç¿»è¯‘ä¸­çš„ä¸¤ä¸ªç›¸é‚»å¥å­å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªï¼Œåä¹‹äº¦ç„¶-ä¸€ä¸ªå¥å­å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªã€‚ åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œç¿»è¯‘ä¸­çš„å¥å­å¯èƒ½ä¼šè¢«å®Œå…¨çœç•¥ï¼Œæˆ–è€…ç¿»è¯‘å¯èƒ½ä¼šå‡ºç°åœ¨åŸæ–‡ä»¥å¤–çš„è¯‘æ–‡ä¸­ã€‚ <br><br> æ›´æ­£å¼åœ°è¯´ï¼Œå‡è®¾ä»¥ä¸‹é’ˆå¯¹å¹¶è¡ŒæœºæŸœçš„ç”Ÿæˆæ¨¡å‹æ˜¯æ­£ç¡®çš„ã€‚ åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š <br><br>  <b>1. <i>åœæ­¢</i></b> <br><br> ä»¥æ¦‚ç‡p <sub>h</sub>ç»“æŸèˆ¹ä½“<sub>çš„</sub>ç”Ÿæˆã€‚ <br><br>  <b>2. [1-0] <i>è·³è¿‡æŠ¥ä»·</i></b> <br><br>  <sub>æˆ‘ä»¬</sub>ä»¥æ¦‚ç‡<sub>d d</sub>å°†ä¸€å¥è¯å½’äºåŸæ–‡ã€‚ æˆ‘ä»¬ä¸å°†ä»»ä½•ç¿»è¯‘å½’å› äºç¿»è¯‘ã€‚ ä»ç¦»æ•£åˆ†å¸ƒä¸­é€‰æ‹©åŸå§‹è¯­è¨€Lâ‰¥1çš„å¥å­é•¿åº¦ï¼š <br><br><img src="https://habrastorage.org/webt/bm/pe/t_/bmpet_y_ksvwgbohazpgctekbks.png" width="350">  ã€‚ <br><br> è¿™é‡Œï¼Œ <i><sub>Î¼s</sub></i> ï¼Œ <i>Ïƒs</i>æ˜¯åˆ†å¸ƒå‚æ•°ï¼Œè€Œ<i>Î±s</i>æ˜¯é€‰æ‹©çš„å½’ä¸€åŒ–ç³»æ•°ï¼Œå› æ­¤ <img src="https://habrastorage.org/webt/fm/ae/ns/fmaensnvy1nauvywiluibhryr6s.png" width="100">  ã€‚ <br><br>  <b>3. [0-1] <i>æ’å…¥ææ¡ˆ</i></b> <br><br>  <sub>æˆ‘ä»¬</sub>ä»¥æ¦‚ç‡p <sub>i</sub>ä¸ºç¿»è¯‘æŒ‡å®šä¸€ä¸ªå¥å­ã€‚ æˆ‘ä»¬æ²¡æœ‰å°†ä»»ä½•ä¸œè¥¿å½’å› äºåŸä»¶ã€‚ ä»ä¸è¿ç»­çš„åˆ†å¸ƒä¸­é€‰æ‹©ç¿»è¯‘è¯­è¨€ä¸­Lâ‰¥1çš„å¥å­é•¿åº¦ï¼š <br><br><img src="https://habrastorage.org/webt/yl/yn/kr/ylynkr3cs_t7dpedebtzqj3uryk.png" width="350">  ã€‚ <br><br> å…¶ä¸­ï¼Œ <i>Î¼t</i> ï¼Œ <i>Ïƒt</i>æ˜¯åˆ†å¸ƒå‚æ•°ï¼Œè€Œ<i>Î±t</i>æ˜¯é€‰æ‹©çš„å½’ä¸€åŒ–ç³»æ•°ï¼Œå› æ­¤ <img src="https://habrastorage.org/webt/bq/-k/p3/bq-kp37k-c-k5fpq9jrz4r8rkvy.png" width="100">  ã€‚ <br><br>  <b>4. <i>ç¿»è¯‘</i></b> <br><br> ä»¥æ¦‚ç‡ï¼ˆ1- p <sub>d</sub> -p <sub>i</sub> -p <sub>h</sub> ï¼‰ä»åˆ†å¸ƒpsä¸­å–åŸå§‹è¯­è¨€L sâ‰¥1çš„å¥å­é•¿åº¦ï¼ˆå››èˆäº”å…¥ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ ¹æ®æ¡ä»¶ç¦»æ•£åˆ†å¸ƒç”Ÿæˆç¿»è¯‘è¯­è¨€L tâ‰¥1çš„å¥å­é•¿åº¦ï¼š <br><br><img src="https://habrastorage.org/webt/ae/b6/mx/aeb6mx4cols1jplbs-di9emhxf8.png" width="500">  ã€‚ <br><br> åœ¨æ­¤ï¼Œ <i><sub>Î±st</sub></i>æ˜¯å½’ä¸€åŒ–ç³»æ•°ï¼Œå…¶ä½™å‚æ•°åœ¨å‰é¢çš„æ®µè½ä¸­è¿›è¡Œäº†æè¿°ã€‚ <br><br> ä¸‹ä¸€æ­¥æ˜¯å¦ä¸€ä¸ªæ­¥éª¤ï¼š <br><br>  1. [2-1]é€šè¿‡æ¦‚ç‡p <sub>split sï¼Œ</sub>åŸå§‹è¯­è¨€ä¸­ç”Ÿæˆçš„å¥å­è¢«åˆ†ä¸ºä¸¤ä¸ªéç©ºå¥å­ï¼Œå› æ­¤å•è¯çš„æ€»æ•°<b><i>æ­£å¥½å¢åŠ äº†ä¸€ä¸ª</i></b> ã€‚ é•¿åº¦ä¸ºL <sub>s</sub>çš„å¥å­åˆ†è§£ä¸ºé•¿åº¦ä¸ºL <sub>1</sub>å’ŒL <sub>2çš„éƒ¨åˆ†</sub> ï¼ˆå³L <sub>1</sub> + L <sub>2</sub> = L <sub>s</sub> +1ï¼‰çš„æ¦‚ç‡ä¸P <sub>s</sub> ï¼ˆL <sub>1</sub> ï¼‰â‹…P <sub>s</sub> ï¼ˆL <sub>2</sub> ï¼‰æˆæ¯”ä¾‹ã€‚ <br><br>  2. [1-2]é€šè¿‡æ¦‚ç‡p <sub>split tï¼Œ</sub>ç›®æ ‡è¯­è¨€ä¸­ç”Ÿæˆçš„å¥å­åˆ†ä¸ºä¸¤ä¸ªéç©ºå¥å­ï¼Œå› æ­¤å•è¯æ€»æ•°å¢åŠ äº†ä¸€ä¸ªã€‚ é•¿åº¦ä¸ºL <sub>t</sub>çš„å¥å­åˆ†è§£ä¸ºé•¿åº¦ä¸ºL1å’ŒL2çš„éƒ¨åˆ†ï¼ˆå³L <sub>1</sub> + L <sub>2</sub> = L <sub>t</sub> +1ï¼‰çš„æ¦‚ç‡ä¸P <sub>t</sub> ï¼ˆL <sub>1</sub> ï¼‰â‹…P <sub>t</sub> ï¼ˆL <sub>2</sub> ï¼‰æˆæ¯”ä¾‹ã€‚ <br><br>  3. 3. [1-1]ä»¥ï¼ˆ1-p <sub>split s</sub> -p <sub>split t</sub> ï¼‰çš„æ¦‚ç‡ï¼Œè¿™å¯¹ç”Ÿæˆçš„å¥å­éƒ½ä¸ä¼šè¡°å‡ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">I / Oæ ¼å¼ï¼Œç¤ºä¾‹å’Œæ³¨é‡Š</b> <div class="spoiler_text"><h4> è¾“å…¥æ ¼å¼ </h4><br> æ–‡ä»¶çš„ç¬¬ä¸€è¡ŒåŒ…å«åˆ†å¸ƒå‚æ•°ï¼šp <sub>h</sub> ï¼Œp <sub>d</sub> ï¼Œp <sub>i</sub> ï¼Œp <sub>split s</sub> ï¼Œp <sub>split t</sub> ï¼Œ <sub>Î¼s</sub> ï¼ŒÏƒsï¼ŒÎ¼tï¼ŒÏƒtã€‚  0.1â‰¤Ïƒs &lt;Ïƒtâ‰¤3. 0â‰¤Î¼sï¼ŒÎ¼tâ‰¤5ã€‚ <br><br> ä¸‹ä¸€è¡ŒåŒ…å«æ•°å­—N <sub>s</sub>å’ŒN <sub>t-</sub>åœ¨è¿™ç§æƒ…å†µä¸‹åˆ†åˆ«ä»¥åŸå§‹è¯­è¨€å’Œç›®æ ‡è¯­è¨€æ˜¾ç¤ºçš„å¥å­æ•°ï¼ˆ1â‰¤N <sub>s</sub> ï¼ŒN tâ‰¤1000ï¼‰ã€‚ <br><br> ä¸‹ä¸€è¡ŒåŒ…å«N <sub>sä¸ª</sub>æ•´æ•°-åŸå§‹è¯­è¨€ä¸­å¥å­çš„é•¿åº¦ã€‚ ä¸‹ä¸€è¡ŒåŒ…å«N <sub>tä¸ª</sub>æ•´æ•°-ç›®æ ‡è¯­è¨€ä¸­å¥å­çš„é•¿åº¦ã€‚ <br><br> ä¸‹ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•°å­—ï¼šjå’Œkï¼ˆ1â‰¤jâ‰¤N <sub>s</sub> ï¼Œ1â‰¤kâ‰¤N <sub>t</sub> ï¼‰ã€‚ <br><br><h4> è¾“å‡ºæ ¼å¼ </h4><br> éœ€è¦æ¨å¯¼åœ¨æ–‡æœ¬ä¸­åˆ†åˆ«å…·æœ‰ç´¢å¼•jå’Œkçš„å¥å­æ˜¯å¹³è¡Œçš„æ¦‚ç‡ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬æ˜¯åœ¨ç®—æ³•çš„ä¸€æ­¥ç”Ÿæˆçš„ï¼Œå¹¶ä¸”éƒ½ä¸æ˜¯è¡°å‡çš„ç»“æœï¼‰ã€‚ <br><br> å¦‚æœç»å¯¹è¯¯å·®ä¸è¶…è¿‡10 <sup>â€“4ï¼Œ</sup>æ‚¨çš„ç­”æ¡ˆå°†è¢«æ¥å—ã€‚ <br><br><h4> ä¾‹å­1 </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>0.05 0.08 0.07 0.15 0.1 1 0.3 3 0.5 <br> 1 1 <br> 4 <br> 20 <br> 1 1</code> </td> <td> <code>0.975037457809</code> </td> </tr></tbody></table></div><h4> ä¾‹å­2 </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>0.1 0.2 0.3 0.25 0.3 1 0.3 3 0.5 <br> 2 1 <br> 3 4 <br> 20 <br> 2 1</code> </td> <td> <code>0.247705779810</code> </td> </tr></tbody></table></div><h4> ä¾‹å­3 </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>0.2 0.2 0.2 0.3 0.3 3 0.3 1 1 <br> 5 3 <br> 16 35 24 19 23 <br> 5 6 7 <br> 2 1</code> </td> <td> <code>0.200961101684</code> </td> </tr></tbody></table></div><h4> æ³¨æ„äº‹é¡¹ </h4><br> åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼è·å¾—æ•°å­—çš„åˆå§‹åºåˆ—ï¼š <br><br>  â€¢é¦–å…ˆï¼Œä»¥æ¦‚ç‡p <sub>d</sub>åœ¨åŸå§‹æ–‡æœ¬ä¸­æ·»åŠ ä¸€ä¸ªå¥å­ï¼Œç„¶åä»¥æ¦‚ç‡p <sub>i</sub>å°†ä¸€å¥è¯æ·»åŠ åˆ°ç¿»è¯‘ä¸­ï¼Œç„¶åä»¥æ¦‚ç‡p <sub>h</sub>å®Œæˆç”Ÿæˆã€‚ <br><br> æ­¤äº‹ä»¶çš„æ¦‚ç‡ä¸ºP <sub>1</sub> = p <sub>d</sub> * P <sub>s</sub> ï¼ˆ4ï¼‰* p <sub>i</sub> * P <sub>t</sub> ï¼ˆ20ï¼‰* p <sub>h</sub> ã€‚ <br><br>  â€¢é¦–å…ˆï¼Œä»¥æ¦‚ç‡p <sub>d</sub>åœ¨åŸå§‹æ–‡æœ¬ä¸­æ·»åŠ ä¸€ä¸ªå¥å­ï¼Œç„¶åä»¥æ¦‚ç‡p <sub>i</sub>å°†ä¸€å¥è¯æ·»åŠ åˆ°ç¿»è¯‘ä¸­ï¼Œç„¶åä»¥æ¦‚ç‡p <sub>h</sub>å®Œæˆç”Ÿæˆã€‚ <br><br> æ­¤äº‹ä»¶çš„æ¦‚ç‡ç­‰äºP <sub>2</sub> = p <sub>i</sub> * P <sub>t</sub> ï¼ˆ20ï¼‰* p <sub>d</sub> * P <sub>s</sub> ï¼ˆ4ï¼‰* p <sub>h</sub> ã€‚ <br><br>  â€¢ä»¥æ¦‚ç‡ï¼ˆ1--p <sub>h</sub> -p <sub>d</sub> -p <sub>i</sub> ï¼‰ç”Ÿæˆä¸¤ä¸ªå¥å­ï¼Œç„¶åä»¥æ¦‚ç‡ï¼ˆ1--p <sub>split s</sub> -p <sub>split t</sub> ï¼‰ä¿ç•™ä¸€åˆ‡ï¼ˆå³ï¼Œä¸è¦å°†åŸæ–‡æˆ–è¯‘æ–‡åˆ†æˆä¸¤ä¸ªå¥å­ï¼‰ ï¼‰ï¼Œç„¶åä»¥p <sub>hçš„</sub>æ¦‚ç‡ç»“æŸç”Ÿæˆã€‚ <br><br> æ­¤äº‹ä»¶çš„æ¦‚ç‡ä¸º <br><img src="https://habrastorage.org/webt/xw/ka/ys/xwkayskmtg4g3tkt9pb3n-ieyoa.png" width="550">  ã€‚ <br><br> ç»“æœï¼Œç­”æ¡ˆè®¡ç®—ä¸º <img src="https://habrastorage.org/webt/zm/tw/xk/zmtwxkdjhhctfrcbiqsc0tur6g0.png" width="100">  ã€‚ </div></div><br><h4> è§£å†³æ–¹æ¡ˆ </h4><br> è¯¥ä»»åŠ¡æ˜¯ä½¿ç”¨éšè—é©¬å°”å¯å¤«æ¨¡å‹è¿›è¡Œå¯¹é½çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ˆHMMå¯¹é½ï¼‰ã€‚ ä¸»è¦æ€æƒ³æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤æ¨¡å‹å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­£å‘ç®—æ³•</a>æ¥è®¡ç®—ç”Ÿæˆä¸€å¯¹ç‰¹å®šæ–‡æ¡£çš„æ¦‚ç‡ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒçŠ¶æ€æ˜¯ä¸€å¯¹æ–‡æ¡£å‰ç¼€ã€‚ å› æ­¤ï¼Œå¯ä»¥é€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‘å‰-å‘å</a>ç®—æ³•æ¥è®¡ç®—ç‰¹å®šçš„å¹³è¡Œå¥å­å¯¹çš„å¯¹é½æ‰€éœ€çš„æ¦‚ç‡ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;iomanip&gt; #include &lt;cmath&gt; #include &lt;vector&gt; double p_h, p_d, p_i, p_tr, p_ss, p_st, mu_s, sigma_s, mu_t, sigma_t; double lognorm_cdf(double x, double mu, double sigma) { if (x &lt; 1e-9) return 0.0; double res = std::log(x) - mu; res /= std::sqrt(2.0) * sigma; res = 0.5 * (1 + std::erf(res)); return res; } double length_probability(int l, double mu, double sigma) { return lognorm_cdf(l, mu, sigma) - lognorm_cdf(l - 1, mu, sigma); } double translation_probability(int ls, int lt) { double res = length_probability(ls, mu_s, sigma_s); double mu = mu_t - mu_s + std::log(ls); double sigma = std::sqrt(sigma_t * sigma_t - sigma_s * sigma_s); res *= length_probability(lt, mu, sigma); return res; } double split_probability(int l1, int l2, double mu, double sigma) { int l_sum = l1 + l2; double total_prob = 0.0; for (int i = 1; i &lt; l_sum; ++i) { total_prob += length_probability(i, mu, sigma) * length_probability(l_sum - i, mu, sigma); } return length_probability(l1, mu, sigma) * length_probability(l2, mu, sigma) / total_prob; } double log_prob10(int ls) { return std::log(p_d * length_probability(ls, mu_s, sigma_s)); } double log_prob01(int lt) { return std::log(p_i * length_probability(lt, mu_t, sigma_t)); } double log_prob11(int ls, int lt) { return std::log(p_tr * (1 - p_ss - p_st) * translation_probability(ls, lt)); } double log_prob21(int ls1, int ls2, int lt) { return std::log(p_tr * p_ss * split_probability(ls1, ls2, mu_s, sigma_s) * translation_probability(ls1 + ls2 - 1, lt)); } double log_prob12(int ls, int lt1, int lt2) { return std::log(p_tr * p_st * split_probability(lt1, lt2, mu_t, sigma_t) * translation_probability(ls, lt1 + lt2 - 1)); } double logsum(double v1, double v2) { double res = std::max(v1, v2); v1 -= res; v2 -= res; v1 = std::min(v1, v2); if (v1 &lt; -30) { return res; } return res + std::log(std::exp(v1) + 1.0); } double loginc(double* to, double from) { *to = logsum(*to, from); } constexpr double INF = 1e25; int main(void) { using std::cin; using std::cout; cin &gt;&gt; p_h &gt;&gt; p_d &gt;&gt; p_i &gt;&gt; p_ss &gt;&gt; p_st &gt;&gt; mu_s &gt;&gt; sigma_s &gt;&gt; mu_t &gt;&gt; sigma_t; p_tr = 1.0 - p_h - p_d - p_i; int Ns, Nt; cin &gt;&gt; Ns &gt;&gt; Nt; using std::vector; vector&lt;int&gt; ls(Ns), lt(Nt); for (int i = 0; i &lt; Ns; ++i) cin &gt;&gt; ls[i]; for (int i = 0; i &lt; Nt; ++i) cin &gt;&gt; lt[i]; vector&lt; vector&lt; double&gt; &gt; fwd(Ns + 1, vector&lt;double&gt;(Nt + 1, -INF)), bwd = fwd; fwd[0][0] = 0; bwd[Ns][Nt] = 0; for (int i = 0; i &lt;= Ns; ++i) { for (int j = 0; j &lt;= Nt; ++j) { if (i &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i - 1][j] + log_prob10(ls[i - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 1][Nt - j] + log_prob10(ls[Ns - i])); } if (j &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i][j - 1] + log_prob01(lt[j - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i][Nt - j + 1] + log_prob01(lt[Nt - j])); } if (i &gt;= 1 &amp;&amp; j &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i - 1][j - 1] + log_prob11(ls[i - 1], lt[j - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 1][Nt - j + 1] + log_prob11(ls[Ns - i], lt[Nt - j])); } if (i &gt;= 2 &amp;&amp; j &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i - 2][j - 1] + log_prob21(ls[i - 1], ls[i - 2], lt[j - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 2][Nt - j + 1] + log_prob21(ls[Ns - i], ls[Ns - i + 1], lt[Nt - j])); } if (i &gt;= 1 &amp;&amp; j &gt;= 2) { loginc(&amp;fwd[i][j], fwd[i - 1][j - 2] + log_prob12(ls[i - 1], lt[j - 1], lt[j - 2])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 1][Nt - j + 2] + log_prob12(ls[Ns - i], lt[Nt - j], lt[Nt - j + 1])); } } } int j, k; cin &gt;&gt; j &gt;&gt; k; double rlog = fwd[j - 1][k - 1] + bwd[j][k] + log_prob11(ls[j - 1], lt[k - 1]) - bwd[0][0]; cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(12) &lt;&lt; std::exp(rlog) &lt;&lt; std::endl; }</span></span></span></span></code> </pre> </div></div><br><h2>  D.å»ºè®®å¸¦ </h2><br><h4> æ¡ä»¶ </h4><div class="scrollable-table"><table><tbody><tr><td> æ—¶é—´é™åˆ¶ </td><td>  2ç§’ </td></tr><tr><td> å†…å­˜é™åˆ¶ </td><td>  64å…†å­—èŠ‚ </td></tr><tr><td> è¿›å…¥ </td><td> æ ‡å‡†è¾“å…¥æˆ–input.txt </td></tr><tr><td> ç»“è®º </td><td> æ ‡å‡†è¾“å‡ºæˆ–output.txt </td></tr></tbody></table></div> è€ƒè™‘æœ‰å…³å¼‚æ„å†…å®¹çš„å»ºè®®çš„æè¦ã€‚ å®ƒæ··åˆäº†å„ç§ç±»å‹çš„å¯¹è±¡ï¼ˆå›¾ç‰‡ï¼Œè§†é¢‘ï¼Œæ–°é—»ç­‰ï¼‰ã€‚ è¿™äº›å¯¹è±¡é€šå¸¸æ˜¯æ ¹æ®ä¸ç”¨æˆ·çš„ç›¸å…³æ€§æ¥æ’åºçš„ï¼šä¸ç”¨æˆ·ç›¸å…³æ€§ï¼ˆå…´è¶£ï¼‰è¶Šé«˜çš„å¯¹è±¡ï¼Œåˆ™è¶Šæ¥è¿‘æ¨èåˆ—è¡¨çš„é¡¶éƒ¨ã€‚ ä½†æ˜¯ï¼Œé€šè¿‡è¿™ç§æ’åºï¼Œç»å¸¸ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼šç›¸åŒç±»å‹çš„å¤šä¸ªå¯¹è±¡å‡ºç°åœ¨å»ºè®®åˆ—è¡¨ä¸­ã€‚ è¿™æå¤§åœ°æ¶åŒ–äº†æˆ‘ä»¬å»ºè®®çš„å¤–éƒ¨ç§ç±»ï¼Œå› æ­¤ç”¨æˆ·ä¸å–œæ¬¢å®ƒã€‚ æ ¹æ®å»ºè®®åˆ—è¡¨ï¼Œæœ‰å¿…è¦å®ç°ä¸€ç§ç®—æ³•ï¼Œè¯¥ç®—æ³•å°†ç»„æˆä¸€ä¸ªæ–°åˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨å°†æ‘†è„±æ­¤é—®é¢˜å¹¶ä¸”æœ€ç›¸å…³ã€‚ <br><br> å‡è®¾åˆå§‹å»ºè®®åˆ—è¡¨ä¸ºa = [a <sub>0</sub> ï¼Œa <sub>1</sub> ï¼Œ...ï¼Œa <sub>n-1</sub> ]ï¼Œä¸”é•¿åº¦n&gt;0ã€‚ç¼–å·ä¸ºiçš„å¯¹è±¡çš„ç±»å‹ç¼–å·ä¸ºb iâˆˆ{0ï¼Œ...ï¼Œm-1}ã€‚ æ­¤å¤–ï¼Œç¼–å·ä¸ºiçš„å¯¹è±¡çš„ç›¸å…³æ€§ä¸ºrï¼ˆ <sub>ai</sub> ï¼‰= 2 <sub>-i</sub> ã€‚ è€ƒè™‘é€šè¿‡é€‰æ‹©å¯¹è±¡çš„å­é›†å¹¶é‡æ–°æ’åˆ—å¯¹è±¡è€Œä»åˆå§‹å¯¹è±¡ä¸­è·å¾—çš„åˆ—è¡¨ï¼šx = [a <sub>i <sub>0</sub></sub> ï¼Œ <sub>ai <sub>1</sub></sub> ï¼Œ...ï¼Œ <sub>ai <sub>k âˆ’ 1</sub></sub> ]ï¼Œé•¿åº¦ä¸ºkï¼ˆ0â‰¤kâ‰¤nï¼‰ã€‚ å¦‚æœåˆ—è¡¨ä¸­æ²¡æœ‰ä¸¤ä¸ªè¿ç»­çš„å¯¹è±¡åœ¨ç±»å‹ä¸Šé‡åˆï¼Œå³æ‰€æœ‰i = 0ï¼Œ...ï¼Œk âˆ’ 2çš„b <sub>i <sub>j</sub></sub> â‰ b <sub>i <sub>j + 1</sub></sub> ï¼Œåˆ™ç§°è¯¥åˆ—è¡¨ä¸ºå¯å…è®¸çš„ã€‚ åˆ—è¡¨çš„ç›¸å…³æ€§ç”±å…¬å¼è®¡ç®— <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>j</mi></mrow></msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mi>j</mi></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.158ex" height="3.503ex" viewBox="0 -987.6 8248.5 1508.3" role="img" focusable="false" style="vertical-align: -1.209ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMAIN-31" x="1300" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMAIN-30" x="1191" y="0"></use></g></g><g transform="translate(3543,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-6A" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-72" x="4986" y="0"></use><g transform="translate(5437,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ï¼ˆ</text></g><g transform="translate(6267,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjLC_ecZzAV_CWJD3whaiFWBDx-Wg#MJMATHI-6A" x="488" y="-213"></use></g></g><g transform="translate(7418,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ï¼‰</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>âˆ’</mo><mn>1</mn></mrow></msubsup><msub><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo>âˆ’</mo><mi>j</mi></mrow></msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo>ï¼ˆ</mo></mrow><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mi>j</mi></msub></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>ï¼‰</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ sum_ {j = 0} ^ {k-1} 2 _ {-j} rï¼ˆa_ {i_j}ï¼‰</script>  ã€‚ æ‚¨éœ€è¦æ‰¾åˆ°æ‰€æœ‰æœ‰æ•ˆçš„æœ€å¤§å…³è”åˆ—è¡¨ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">I / Oæ ¼å¼å’Œç¤ºä¾‹</b> <div class="spoiler_text"><h4> è¾“å…¥æ ¼å¼ </h4><br> åœ¨ç¬¬ä¸€è¡Œï¼Œæ•°å­—nå’Œmä»¥ç©ºæ ¼ï¼ˆ1â‰¤nâ‰¤100000ï¼Œ1â‰¤mâ‰¤nï¼‰ä¹¦å†™ã€‚ æ¥ä¸‹æ¥çš„nè¡ŒåŒ…å«æ•°å­—<sub>i</sub> ï¼Œå…¶ä¸­i = 0ï¼Œ...ï¼Œn-1ï¼ˆ0â‰¤b iâ‰¤m-1ï¼‰ã€‚ <br><br><h4> è¾“å‡ºæ ¼å¼ </h4><br> ç”¨ç©ºæ ¼å†™ä¸‹æœ€ç»ˆåˆ—è¡¨ä¸­çš„å¯¹è±¡æ•°ï¼ši <sub>0</sub> ï¼Œi <sub>1</sub> ï¼Œ...ï¼Œi <sub>k âˆ’ 1</sub> ã€‚ <br><br><h4> ä¾‹å­1 </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>1 1 <br> 0</code> </td> <td> <code>0</code> </td> </tr></tbody></table></div><h4> ä¾‹å­2 </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>2 2 <br> 1 <br> 1</code> </td> <td> <code>0</code> </td> </tr></tbody></table></div><h4> ä¾‹å­3 </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>10 2 <br> 1 <br> 1 <br> 1 <br> 0 <br> 0 <br> 1 <br> 0 <br> 1 <br> 1 <br> 1</code> </td> <td> <code>0 3 1 4 2 6 5</code> </td> </tr></tbody></table></div></div></div><br><h4> è§£å†³æ–¹æ¡ˆ </h4><br> ä½¿ç”¨ç®€å•çš„æ•°å­¦è®¡ç®—ï¼Œå¯ä»¥è¯æ˜ï¼Œå¯ä»¥é€šè¿‡â€œè´ªå¿ƒâ€æ–¹æ³•è§£å†³é—®é¢˜ï¼Œå³ï¼Œåœ¨æœ€ä½³å»ºè®®åˆ—è¡¨ä¸­ï¼Œæ¯ä¸ªé¡¹ç›®çš„æœ€ç›¸å…³å¯¹è±¡åœ¨åˆ—è¡¨çš„åŒä¸€å¼€å¤´éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ è¿™ç§æ–¹æ³•çš„å®ç°å¾ˆç®€å•ï¼šå¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬å°†å¯¹è±¡è¿ç»­æ”¾å…¥å¹¶æ·»åŠ åˆ°ç­”æ¡ˆä¸­ã€‚ å½“é‡åˆ°æ— æ•ˆçš„å¯¹è±¡ï¼ˆå…¶ç±»å‹ä¸ä¸Šä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ä¸€è‡´ï¼‰æ—¶ï¼Œæˆ‘ä»¬å°†å…¶æ”¾åœ¨å•ç‹¬çš„é˜Ÿåˆ—ä¸­ï¼Œç„¶åå°†å…¶ä»é˜Ÿåˆ—ä¸­å°½å¿«æ’å…¥åˆ°å“åº”ä¸­ã€‚ è¯·æ³¨æ„ï¼Œåœ¨æ¯ä¸ªæ—¶åˆ»ï¼Œæ­¤é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½å°†å…·æœ‰åŒ¹é…çš„ç±»å‹ã€‚ æœ€åï¼Œå‡ ä¸ªå¯¹è±¡å¯èƒ½ä¼šä¿ç•™åœ¨é˜Ÿåˆ—ä¸­ï¼Œå®ƒä»¬å°†ä¸åŒ…å«åœ¨å“åº”ä¸­ã€‚ <br><br><pre> <code class="cpp hljs"> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; blend(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&amp; types) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; result; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">queue</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; repeated; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; n; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.empty() || types[result.back()] != types[i]) { result.push_back(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!repeated.empty() &amp;&amp; types[repeated.front()] != types[result.back()]) { result.push_back(repeated.front()); repeated.pop(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { repeated.push(i); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><h2>  D.å­—ç¬¦åºåˆ—çš„èšç±» </h2><div class="scrollable-table"><table><tbody><tr><td></td><td>  <b>æ‰€æœ‰è¯­è¨€</b> </td><td>  <b>python2.7 + numpyçš„</b> </td><td>  <b>python3.5 + numpyçš„</b> </td></tr><tr><td> æ—¶é—´é™åˆ¶ </td><td>  1ç§’ </td><td>  6ç§’ </td><td>  6ç§’ </td></tr><tr><td> å†…å­˜é™åˆ¶ </td><td>  64å…†å­—èŠ‚ </td><td>  64å…†å­—èŠ‚ </td><td>  64å…†å­—èŠ‚ </td></tr><tr><td> è¿›å…¥ </td><td colspan="3"> æ ‡å‡†è¾“å…¥æˆ–input.txt </td></tr><tr><td> ç»“è®º </td><td colspan="3"> æ ‡å‡†è¾“å‡ºæˆ–output.txt </td></tr></tbody></table></div> æœ‰ä¸€ä¸ªæœ‰é™çš„å­—æ¯A = {a <sub>1</sub> ï¼Œa <sub>2</sub> ï¼Œ...ï¼Œa <sub>K-1</sub> ï¼Œa <sub>K</sub> = S}ï¼Œa iâˆˆ{aï¼Œbï¼Œ...ï¼Œz}ï¼ŒSæ˜¯è¡Œçš„ç»“å°¾ã€‚ <br><br> è€ƒè™‘ä»¥ä¸‹åœ¨å­—æ¯Aä¸Šç”Ÿæˆéšæœºå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼š <br><br>  1.ç¬¬ä¸€ä¸ªå­—ç¬¦x <sub>1</sub>æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œå…¶åˆ†å¸ƒä¸ºPï¼ˆx <sub>1</sub> = a <sub>i</sub> ï¼‰= q <sub>i</sub> ï¼ˆå·²çŸ¥q <sub>K</sub> = 0ï¼‰ã€‚ <br>  2.æ ¹æ®æ¡ä»¶åˆ†å¸ƒPï¼ˆx <sub>i</sub> = a <sub>j</sub> || x <sub>i-1</sub> = a <sub>l</sub> ï¼‰= p <sub>jl</sub> ï¼Œæ ¹æ®å‰ä¸€ä¸ªå­—ç¬¦ç”Ÿæˆæ¯ä¸ªä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ <br>  3.å¦‚æœx <sub>i</sub> = Sï¼Œåˆ™ç”Ÿæˆåœæ­¢ï¼Œç»“æœä¸ºx <sub>1</sub> x <sub>2</sub> ... x <sub>i âˆ’ 1</sub> ã€‚ <br><br> ç»™å‡ºäº†ç”±ä¸¤ä¸ªæè¿°çš„å…·æœ‰ä¸åŒå‚æ•°çš„æ¨¡å‹çš„æ··åˆç”Ÿæˆçš„çº¿ç»„ã€‚ æ¯è¡Œéƒ½å¿…é¡»ç»™å‡ºç”Ÿæˆå®ƒçš„é“¾çš„ç´¢å¼•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">I / Oæ ¼å¼ï¼Œç¤ºä¾‹å’Œæ³¨é‡Š</b> <div class="spoiler_text"><h4> è¾“å…¥æ ¼å¼ </h4><br> ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•°å­—1000â‰¤Nâ‰¤2000å’Œ3â‰¤Kâ‰¤27-åˆ†åˆ«æ˜¯è¡Œæ•°å’Œå­—æ¯çš„å¤§å°ã€‚ <br><br> ç¬¬äºŒè¡ŒåŒ…å«ç”±K-1ä¸ªä¸åŒçš„æ‹‰ä¸å­—æ¯å°å†™å­—æ¯ç»„æˆçš„è¡Œï¼ŒæŒ‡ç¤ºå­—æ¯è¡¨ä¸­çš„å‰K-1ä¸ªå…ƒç´ ã€‚ <br><br> éšåçš„Næ¡çº¿ä¸­çš„æ¯æ¡çº¿å‡æ ¹æ®æ¡ä»¶ä¸­æè¿°çš„ç®—æ³•ç”Ÿæˆã€‚ <br><br><h4> è¾“å‡ºæ ¼å¼ </h4><br> åœ¨ç¬¬Nè¡Œä¸­ï¼Œç¬¬iè¡ŒåŒ…å«è¾“å…¥æ–‡ä»¶çš„ç¬¬i + 1è¡Œä¸Šåºåˆ—çš„ç°‡å·ï¼ˆ0/1ï¼‰ã€‚ ä¸çœŸå®ç­”æ¡ˆçš„é‡åˆåº¦åº”è‡³å°‘ä¸º80ï¼…ã€‚ <br><br><h4> ä¾‹å­ </h4><div class="scrollable-table"><table><tbody><tr><td>  <b>è¿›å…¥</b> </td><td>  <b>ç»“è®º</b> </td></tr><tr><td> <code>100 3 <br> a <br> a <br> aa <br> a <br> aaa <br> a <br> aaaaaa <br> aa <br> a <br> a <br> a <br> aaa <br> a <br> a <br> aaa <br> aa <br> aaaa <br> aaa <br> a <br> aaaaa <br> aa <br> a <br> aaaa <br> a <br> a <br> a <br> a <br> a <br> a <br> aa <br> aaaa <br> aaa <br> a <br> aa <br> aaaa <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> aa <br> aaa <br> aaa <br> a <br> a <br> bbb <br> bb <br> bb <br> bbbbbbb <br> bb <br> bbb <br> b <br> bbbbbbb <br> bbbb <br> bbb <br> bb <br> bbb <br> bb <br> bb <br> bbb <br> bbbbbb <br> bbb <br> b <br> bbbbbb <br> b <br> bbbbb <br> b <br> b <br> bb <br> b <br> bb <br> bb <br> b <br> b <br> b <br> b <br> bb <br> bb <br> bb <br> b <br> b <br> b <br> bb <br> b <br> bbb <br> bb <br> b <br> bbbbbb <br> b <br> bb <br> bb <br> bb <br> b <br> bb <br> bbb</code> </td> <td> <code>0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1</code> </td> </tr></tbody></table></div><h4> æ³¨æ„äº‹é¡¹ </h4><br> è¯·ä»ä»¥ä¸‹æ¡ä»¶å¼€å§‹æµ‹è¯•ï¼šåœ¨å…¶ä¸­ï¼Œå‰50è¡Œæ˜¯ä»åˆ†å¸ƒç”Ÿæˆçš„ <br>  Pï¼ˆx <sub>i</sub> = a | x <sub>i-1</sub> = aï¼‰= 0.5ï¼ŒPï¼ˆx <sub>i</sub> = S | x <sub>i-1</sub> = aï¼‰= 0.5ï¼ŒPï¼ˆx <sub>1</sub> = aï¼‰= 1; ç¬¬äºŒ50-ä»å‘è¡Œ <br>  Pï¼ˆx <sub>i</sub> = b | x <sub>i-1</sub> = bï¼‰= 0.5ï¼ŒPï¼ˆx <sub>i</sub> = S | x <sub>i-1</sub> = bï¼‰= 0.5ï¼ŒPï¼ˆx <sub>1</sub> = bï¼‰= 1ã€‚ </div></div><br><h4> è§£å†³æ–¹æ¡ˆ </h4><br> ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">EMç®—æ³•</a>è§£å†³äº†è¯¥é—®é¢˜ï¼šå‡è®¾æ‰€æä¾›çš„æ ·æœ¬æ˜¯ç”±ä¸¤ä¸ªé©¬å°”å¯å¤«é“¾çš„æ··åˆç”Ÿæˆçš„ï¼Œå…¶å‚æ•°åœ¨è¿­ä»£è¿‡ç¨‹ä¸­å¾—ä»¥æ¢å¤ã€‚ é™åˆ¶äº†80ï¼…çš„æ­£ç¡®ç­”æ¡ˆï¼Œä»¥ä½¿è§£å†³æ–¹æ¡ˆçš„æ­£ç¡®æ€§ä¸å—ä¸¤ä¸ªé“¾ä¸­éƒ½å…·æœ‰é«˜æ¦‚ç‡çš„ç¤ºä¾‹çš„å½±å“ã€‚ å› æ­¤ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æ­£ç¡®è¿˜åŸåå¯ä»¥åˆ†é…ç»™åœ¨ç”Ÿæˆçš„å“åº”æ–¹é¢ä¸æ­£ç¡®çš„é“¾ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math EPS = <span class="hljs-number"><span class="hljs-number">1e-9</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">empty_row</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(size)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-number"><span class="hljs-number">0</span></span>] * size <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">empty_matrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rows, cols)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [empty_row(cols) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(rows)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">normalized_row</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(row)</span></span></span><span class="hljs-function">:</span></span> row_sum = sum(row) + EPS <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [x / row_sum <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> row] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">normalized_matrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mtx)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [normalized_row(r) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mtx] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">restore_params</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(alphabet, string_samples)</span></span></span><span class="hljs-function">:</span></span> n_tokens = len(alphabet) n_samples = len(string_samples) samples = [tuple([alphabet.index(token) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s] + [n_tokens - <span class="hljs-number"><span class="hljs-number">1</span></span>, n_tokens - <span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> string_samples] probs = [random.random() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n_samples)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">200</span></span>): old_probs = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> probs] <span class="hljs-comment"><span class="hljs-comment"># probs fixed p0, A = empty_row(n_tokens), empty_matrix(n_tokens, n_tokens) q0, B = empty_row(n_tokens), empty_matrix(n_tokens, n_tokens) for prob, sample in zip(probs, samples): p0[sample[0]] += prob q0[sample[0]] += 1 - prob for t1, t2 in zip(sample[:-1], sample[1:]): A[t1][t2] += prob B[t1][t2] += 1 - prob A, p0 = normalized_matrix(A), normalized_row(p0) B, q0 = normalized_matrix(B), normalized_row(q0) trans_log_diff = [ [math.log(b + EPS) - math.log(a + EPS) for b, a in zip(B_r, A_r)] for B_r, A_r in zip(B, A) ] # A, p0, B, q0 fixed probs = empty_row(n_samples) for i, sample in enumerate(samples): value = math.log(q0[sample[0]] + EPS) - math.log(p0[sample[0]] + EPS) for t1, t2 in zip(sample[:-1], sample[1:]): value += trans_log_diff[t1][t2] probs[i] = 1.0 / (1.0 + math.exp(value)) if max(abs(x - y) for x, y in zip(probs, old_probs)) &lt; 1e-9: break return [int(x &gt; 0.5) for x in probs] def main(): N, K = list(map(int, input().split())) string_samples = [] alphabet = list(input().strip()) + [''] for _ in range(N): string_samples.append(input().rstrip()) result = restore_params(alphabet, string_samples) for r in result: print(r) if __name__ == '__main__': main()</span></span></code> </pre> <br><hr><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN461273/">https://habr.com/ru/post/zh-CN461273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461261/index.html">æœ‰å…³RRCäº§å“çš„æœ‰ç”¨çš„RRCç½‘ç»œç ”è®¨ä¼šæ¸…å•</a></li>
<li><a href="../zh-CN461265/index.html">å…³äºåœ¨å¾®æ§åˆ¶å™¨é¡¹ç›®ä¸­æ»¥ç”¨æ“ä½œç³»ç»Ÿçš„ä½¿ç”¨</a></li>
<li><a href="../zh-CN461267/index.html">è‹±ç‰¹å°”æ–°çš„èŠ¯ç‰‡å°è£…æŠ€æœ¯</a></li>
<li><a href="../zh-CN461269/index.html">ä½¿ç”¨pwnable.kr 08çš„ä½œä¸šè§£å†³æ–¹æ¡ˆæ˜¯legå’Œ10æ˜¯shellshockã€‚ ARMæ±‡ç¼–å™¨ã€‚ Bashæ¼æ´</a></li>
<li><a href="../zh-CN461271/index.html">å¦‚ä½•åœ¨2019å¹´æ¨å¹¿ç§»åŠ¨åº”ç”¨ç¨‹åºï¼š4ç§å®ç”¨æ–¹æ³•+æœ‰ç”¨çš„å·¥å…·</a></li>
<li><a href="../zh-CN461277/index.html">å…è´¹çš„SQLIndexManagerå·¥å…·æ¦‚è¿°</a></li>
<li><a href="../zh-CN461279/index.html">å¦‚ä½•åœ¨Golangå’ŒgRPCä¸Šåˆ›å»ºç®€å•çš„å¾®æœåŠ¡å¹¶ä½¿ç”¨Dockerå¯¹å…¶è¿›è¡Œå®¹å™¨åŒ–</a></li>
<li><a href="../zh-CN461281/index.html">åœ¨chrootç¯å¢ƒä¸­ä¸ºRed Hatï¼ˆRHEL / CentOSï¼‰è®¾ç½®BIND DNSæœåŠ¡å™¨çš„æ¼”ç»ƒ7</a></li>
<li><a href="../zh-CN461283/index.html">è½¯ä»¶ä½“ç³»ç»“æ„å’Œç³»ç»Ÿè®¾è®¡ï¼šæ¦‚è¿°å’Œèµ„æºæŒ‡å—</a></li>
<li><a href="../zh-CN461285/index.html">5ç§ä¸»è¦é‡‡æ ·ç®—æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>