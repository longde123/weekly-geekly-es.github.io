<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚣🏿 💔 🤘 Docker Compose Starter Guide 🎅🏽 🏼 🔽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'auteur de l'article, dont nous publions la traduction aujourd'hui, dit qu'il est destiné aux développeurs qui souhaitent apprendre Docker Compose et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker Compose Starter Guide</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/450312/">  L'auteur de l'article, dont nous publions la traduction aujourd'hui, dit qu'il est destiné aux développeurs qui souhaitent apprendre Docker Compose et vont créer leur première application client-serveur à l'aide de Docker.  Le lecteur est censé connaître les bases de Docker.  Si ce n'est pas le cas, vous pouvez consulter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette</a> série de documents, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette</a> publication, où les bases de Docker sont discutées avec les bases de Kubernetes, et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article pour les débutants. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/b4c/71f/be9/b4c71fbe9634709b3e33a72eabca59af.png" alt="image"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Qu'est-ce que Docker Compose?</font> </h2><br>  Docker Compose est un outil inclus avec Docker.  Il est conçu pour résoudre les problèmes liés au déploiement de projets. <br><br>  En étudiant les bases de Docker, vous pourriez rencontrer la création d'applications simples qui fonctionnent de manière autonome, indépendamment, par exemple, des sources de données externes ou de certains services.  En pratique, de telles applications sont rares.  Les projets réels incluent généralement un ensemble complet d'applications collaboratives. <br><br>  Comment savoir si vous devez utiliser Docker Compose lors du déploiement d'un projet?  En fait - très simple.  Si plusieurs services sont utilisés pour assurer le fonctionnement de ce projet, Docker Compose peut être utile.  Par exemple, dans une situation où ils créent un site Web qui, pour authentifier les utilisateurs, doit se connecter à la base de données.  Un projet similaire peut comprendre deux services - l'un qui fournit le site et l'autre qui est responsable de la maintenance de la base de données. <br><br>  La technologie Docker Compose, si elle est décrite de manière simplifiée, permet, avec une seule commande, de lancer de nombreux services. <br><br><h2>  <font color="#3AC1EF">Différence entre Docker et Docker Compose</font> </h2><br>  Docker est utilisé pour gérer les conteneurs individuels (services) qui composent l'application. <br><br>  Docker Compose est utilisé pour gérer simultanément plusieurs conteneurs qui composent l'application.  Cet outil offre les mêmes fonctionnalités que Docker, mais vous permet de travailler avec des applications plus complexes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/859/489/407/85948940715022ca196b8ad6f1e810d0.png"></div><br>  <i><font color="#999999">Docker (conteneur unique) et Docker Compose (conteneurs multiples)</font></i> <br><br><h2>  <font color="#3AC1EF">Cas d'utilisation typique de Docker Compose</font> </h2><br>  Docker Compose est, entre de bonnes mains, un outil très puissant qui vous permet de déployer rapidement des applications avec une architecture complexe.  Nous allons maintenant examiner un exemple d'utilisation pratique de Docker Compose, dont l'analyse vous permettra d'évaluer les avantages qui vous permettront d'utiliser Docker Compose. <br><br>  Imaginez que vous êtes développeur d'un projet Web.  Ce projet comprend deux sites Web.  Le premier permet aux professionnels de créer, en quelques clics, des boutiques en ligne.  Le second est destiné au support client.  Ces deux sites interagissent avec la même base de données. <br><br>  Votre projet devient de plus en plus populaire, et il s'avère que la puissance du serveur sur lequel il fonctionne n'est plus suffisante.  En conséquence, vous décidez de transférer l'intégralité du projet sur une autre machine. <br><br>  Malheureusement, vous n'avez pas utilisé quelque chose comme Docker Compose.  Par conséquent, vous devrez transférer et reconfigurer les services un par un, en espérant que vous, dans le processus de ce travail, n'oublierez rien. <br><br>  Si vous utilisez Docker Compose, le transfert de votre projet vers un nouveau serveur peut être résolu en exécutant plusieurs commandes.  Afin de terminer le transfert du projet vers un nouvel emplacement, il vous suffit d'effectuer certains réglages et de télécharger une copie de sauvegarde de la base de données sur le nouveau serveur. <br><br><h2>  <font color="#3AC1EF">Développement d'une application client-serveur à l'aide de Docker Compose</font> </h2><br>  Maintenant que vous savez pourquoi nous allons utiliser Docker Compose, il est temps de créer votre première application client-serveur à l'aide de cet outil.  À savoir, nous parlons du développement d'un petit site Web (serveur) en Python, qui peut produire un fichier avec un fragment de texte.  Ce fichier est demandé au serveur par un programme (client), également écrit en Python.  Après avoir reçu le fichier du serveur, le programme affiche à l'écran le texte qui y est stocké. <br><br>  Veuillez noter que nous nous attendons à ce que vous possédiez les bases de Docker et que vous avez déjà installé la plate-forme Docker. <br><br>  Mettons-nous au travail sur le projet. <br><br><h3>  <font color="#3AC1EF">▍1.</font>  <font color="#3AC1EF">Création de projet</font> </h3><br>  Afin de construire votre première application client-serveur, je vous suggère de commencer par créer un dossier de projet.  Il doit contenir les fichiers et dossiers suivants: <br><br><ul><li> <code>docker-compose.yml</code> .  Il s'agit d'un fichier Docker Compose qui contiendra les instructions nécessaires pour démarrer et configurer les services. </li><li>  Dossier du <code>server</code> .  Il contiendra les fichiers nécessaires pour assurer le fonctionnement du serveur. </li><li>  <code>client</code> dossier.  Voici les fichiers de l'application client. </li></ul><br>  Par conséquent, le contenu du dossier principal de votre projet devrait ressembler à ceci: <br><br><pre> <code class="plaintext hljs">. ├── client/ ├── docker-compose.yml └── server/ 2 directories, 1 file</code> </pre> <br><h3>  <font color="#3AC1EF">▍2.</font>  <font color="#3AC1EF">Création de serveur</font> </h3><br>  Ici, dans le processus de création du serveur, nous aborderons certaines choses de base concernant Docker. <br><br><h4>  2a.  Création de fichiers </h4><br>  Accédez au dossier du <code>server</code> et créez-y les fichiers suivants: <br><br><ul><li>  Fichier <code>server.py</code> .  Il contiendra le code du serveur. </li><li>  Fichier <code>index.html</code> .  Ce fichier contiendra un morceau de texte que l'application cliente devrait afficher. </li><li>  Fichier <code>Dockerfile</code> .  Il s'agit d'un fichier Docker qui contiendra les instructions nécessaires pour créer un environnement de serveur. </li></ul><br>  Voici à quoi devrait ressembler le contenu de votre <code>server/</code> dossier: <br><br><pre> <code class="plaintext hljs">. ├── Dockerfile ├── index.html └── server.py 0 directories, 3 files</code> </pre> <br><h4>  2b.  Modification d'un fichier Python. </h4><br>  Ajoutez le code suivant au fichier <code>server.py</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 #    python. #       -. #     - ,      Python. import http.server import socketserver #         . handler = http.server.SimpleHTTPRequestHandler #   ,        1234. #    ,        ,    docker-compose. with socketserver.TCPServer(("", 1234), handler) as httpd:   #       ,    .  httpd.serve_forever()</span></span></code> </pre> <br>  Ce code vous permet de créer un simple serveur Web.  Il donnera aux clients le fichier <code>index.html</code> , dont le contenu sera ensuite affiché sur la page Web. <br><br><h4>  2c.  Édition de fichiers HTML </h4><br>  Ajoutez le texte suivant au fichier <code>index.html</code> : <br><br><pre> <code class="plaintext hljs">Docker-Compose is magic!</code> </pre> <br>  Ce texte sera transmis au client. <br><br><h4>  2d.  Modification du Dockerfile </h4><br>  Nous allons maintenant créer un <code>Dockerfile</code> simple, qui sera responsable de l'organisation du runtime pour le serveur Python.  Nous utiliserons l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">image officielle</a> destinée à l'exécution de programmes écrits en Python comme base de l'image créée.  Voici le contenu du Dockerfile: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,  Dockerfile       . #      'FROM'. #      python ( DockerHub). #   ,    ,  'python',     - 'latest'. FROM python:latest #       ,   Python,     'server.py'  'index.html'. #     ,     'ADD'. #  , 'server.py',    ,   . #  , '/server/',  ,        . #        '/server/'. ADD server.py /server/ ADD index.html /server/ #     'WORKDIR', ,   . #      . #    ,      ,   '/server/'. WORKDIR /server/</span></span></code> </pre> <br>  Maintenant, travaillons sur le client. <br><br><h3>  <font color="#3AC1EF">▍3.</font>  <font color="#3AC1EF">Création de client</font> </h3><br>  En créant la partie client de notre projet, nous rappellerons simultanément certaines des bases de Docker. <br><br><h4>  3a.  Création de fichiers </h4><br>  Accédez au dossier de votre projet <code>client</code> et créez-y les fichiers suivants: <br><br><ul><li>  Le fichier <code>client.py</code> .  Ce sera le code client. </li><li>  Fichier <code>Dockerfile</code> .  Ce fichier joue le même rôle qu'un fichier similaire dans le dossier du serveur.  À savoir, il contient des instructions décrivant la création d'un environnement pour exécuter du code client. </li></ul><br>  Par conséquent, votre <code>client/</code> dossier à ce stade du travail devrait ressembler à ceci: <br><br><pre> <code class="plaintext hljs">. ├── client.py └── Dockerfile 0 directories, 2 files</code> </pre> <br><h4>  3b.  Édition de fichier Python </h4><br>  Ajoutez le code suivant au fichier <code>client.py</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 #    Python. #      'index.html'  . #     ,      Python. import urllib.request #      'http://localhost:1234/'. # ,      ,   'http://localhost:1234'. # localhost   ,      . # 1234 -   ,        . fp = urllib.request.urlopen("http://localhost:1234/") # 'encodedContent'     ('index.html'). # 'decodedContent'     (  ,      ). encodedContent = fp.read() decodedContent = encodedContent.decode("utf8") #   ,    ('index.html'). print(decodedContent) #    . fp.close()</span></span></code> </pre> <br>  Grâce à ce code, l'application cliente peut télécharger des données depuis le serveur et les afficher à l'écran. <br><br><h4>  3c.  Modification du Dockerfile </h4><br>  Comme dans le cas du serveur, nous créons un <code>Dockerfile</code> simple pour le client, chargé de créer l'environnement dans lequel l'application client Python fonctionnera.  Voici le code <code>Dockerfile</code> client: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,     Dockerfile. FROM python:latest #  'client.py'   '/client/'. ADD client.py /client/ #      '/client/'. WORKDIR /client/</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍4.</font>  <font color="#3AC1EF">Docker compose</font> </h3><br>  Comme vous l'avez peut-être remarqué, nous avons créé deux projets différents: le serveur et le client.  Chacun d'eux a son propre <code>Dockerfile</code> .  Jusqu'à présent, tout ce qui se passe ne va pas au-delà des bases de l'utilisation de Docker.  Nous commençons maintenant avec Docker Compose.  Pour ce faire, nous nous tournons vers le fichier <code>docker-compose.yml</code> situé dans le dossier racine du projet. <br><br>  Veuillez noter qu'ici nous <code>docker-compose.yml</code> pas de considérer absolument toutes les commandes qui peuvent être utilisées dans <code>docker-compose.yml</code> .  Notre objectif principal est de vous donner un exemple pratique qui vous donne une connaissance de base de Docker Compose. <br><br>  Voici le code à mettre dans le <code>docker-compose.yml</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  docker-compose     . #   "3"    -        . version: "3" #  ,  docker-composes   . # 1  = 1 . #    , ,   ... # ,     ,   'services'. services: #    ,       . #  ,     . #   (): . #    ,   . #       . #  ,    ,    'server'. server:   #   "build"     #    Dockerfile,      ,   #    .   #  'server/'     ,   #    Dockerfile.   build: server/   # ,      .   #     "python ./server.py".   command: python ./server.py   #   ,      'server/server.py'   1234.   #          (   ),   #         .   #       'ports'.   #      : [ ]:[ ]   #        1234         # 1234  (         #   ).   ports:     - 1234:1234 #   (): . #    'client'. client:   #  'client/    ,     #  Dockerfile    .   build: client/   # ,      .   #     "python ./client.py".   command: python ./client.py   #   'network_mode'     .   #    ,      'localhost' .   network_mode: host   #   'depends_on'  ,   ,   #   , ,       .   #  ,   'client'       'server'.   depends_on:     - server</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍5.</font>  <font color="#3AC1EF">Montage du projet</font> </h3><br>  Une fois que toutes les instructions nécessaires sont incluses dans <code>docker-compose.yml</code> , le projet doit être assemblé.  Cette étape de notre travail ressemble à l'utilisation de la <code>docker build</code> , mais la commande correspondante est liée à plusieurs services: <br><br><pre> <code class="plaintext hljs">$ docker-compose build</code> </pre> <br><h3>  <font color="#3AC1EF">▍6.</font>  <font color="#3AC1EF">Lancement du projet</font> </h3><br>  Maintenant que le projet est terminé, il est temps de le lancer.  Cette étape de notre travail correspond à l'étape à laquelle, lors de l'utilisation de conteneurs individuels, la commande <code>docker run</code> est exécutée: <br><br><pre> <code class="plaintext hljs">$ docker-compose up</code> </pre> <br>  Après avoir exécuté cette commande, le terminal doit afficher le texte téléchargé par le client depuis le serveur: <code>Docker-Compose is magic!</code>  . <br><br>  Comme déjà mentionné, le serveur utilise le port informatique <code>1234</code> pour répondre aux demandes des clients.  Par conséquent, si vous allez sur le navigateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http: // localhost: 1234 /</a> , une page avec le texte <code>Docker-Compose is magic!</code> sera affichée dedans <code>Docker-Compose is magic!</code>  . <br><br><h2>  <font color="#3AC1EF">Commandes utiles</font> </h2><br>  Examinons certaines des commandes que vous pourriez trouver utiles lorsque vous travaillez avec Docker Compose. <br><br>  Cette commande vous permet d'arrêter et de supprimer des conteneurs et d'autres ressources créés par la commande <code>docker-compose up</code> : <br><br><pre> <code class="plaintext hljs">$ docker-compose down</code> </pre> <br>  Cette commande affiche les journaux de service: <br><br><pre> <code class="plaintext hljs">$ docker-compose logs -f [service name]</code> </pre> <br>  Par exemple, dans notre projet, il peut être utilisé sous la forme suivante: <code>$ docker-compose logs -f [service name]</code> . <br><br>  À l'aide de cette commande, vous pouvez répertorier les conteneurs: <br><br><pre> <code class="plaintext hljs">$ docker-compose ps</code> </pre> <br>  Cette commande vous permet d'exécuter une commande dans un conteneur d'exécution: <br><br><pre> <code class="plaintext hljs">$ docker-compose exec [service name] [command]</code> </pre> <br>  Par exemple, cela pourrait ressembler à ceci: <code>docker-compose exec server ls</code> . <br><br>  Cette commande vous permet d'afficher une liste d'images: <br><br><pre> <code class="plaintext hljs">$ docker-compose images</code> </pre> <br><h2>  <font color="#3AC1EF">Résumé</font> </h2><br>  Nous avons examiné les bases du travail avec la technologie Docker Compose, dont la connaissance vous permettra d'utiliser cette technologie et, si vous le souhaitez, de commencer son étude plus approfondie.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Voici le</a> référentiel avec le code du projet que nous avons examiné ici. <br><br>  <b>Chers lecteurs!</b>  Utilisez-vous Docker Compose dans vos projets? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450312/">https://habr.com/ru/post/fr450312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450300/index.html">Arrêtez de discuter de la programmation fonctionnelle et de la POO</a></li>
<li><a href="../fr450302/index.html">Amateur Radio Technology: fabrication d'un prototype de carte de circuit imprimé dans une usine chinoise</a></li>
<li><a href="../fr450304/index.html">Carapuzik chevauchant une fourmi: 100 millions d'années de myrmécophilie</a></li>
<li><a href="../fr450308/index.html">Traçage des rayons GPU dans Unity - Partie 3</a></li>
<li><a href="../fr450310/index.html">Fonctionnement de Philips VideoWRITER. Premières images de fer, puis un peu d'ennui</a></li>
<li><a href="../fr450314/index.html">TensorFlow pour les débutants. Partie 1: informations générales, installation de la bibliothèque</a></li>
<li><a href="../fr450316/index.html">TDD: une méthodologie de développement qui a changé ma vie</a></li>
<li><a href="../fr450318/index.html">Modèles de conception dans le développement JavaScript moderne</a></li>
<li><a href="../fr450320/index.html">Des jeux quantiques simples révèlent la complexité ultime de l'univers</a></li>
<li><a href="../fr450322/index.html">Pourquoi avons-nous besoin de tant de messagers?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>