<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ« ğŸ˜ âš¾ï¸ Planejamento de infraestrutura para recuperaÃ§Ã£o instantÃ¢nea de mÃ¡quinas virtuais RecuperaÃ§Ã£o instantÃ¢nea de VM: parte 2 ğŸ§œğŸ¾ ğŸ‘¨ğŸ¿â€âš•ï¸ ğŸš®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuamos o tÃ³pico, que comeÃ§ou a ser considerado na primeira parte . Hoje falaremos sobre conexÃµes de rede e servidores de destino, apresentaremos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Planejamento de infraestrutura para recuperaÃ§Ã£o instantÃ¢nea de mÃ¡quinas virtuais RecuperaÃ§Ã£o instantÃ¢nea de VM: parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/414547/">  Continuamos o tÃ³pico, que comeÃ§ou a ser considerado na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">primeira parte</a> .  Hoje falaremos sobre conexÃµes de rede e servidores de destino, apresentaremos possÃ­veis opÃ§Ãµes e opÃ§Ãµes de planejamento de infraestrutura para uma recuperaÃ§Ã£o ideal do Instant VM Recovery.  Bem-vindo ao gato. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_5/c2/_c/_5c2_c7beo7ac9tamvuvgr2-_c4.png" width="600" height="271"></div><a name="habracut"></a><br><h1>  Sobre conexÃµes de rede </h1><br>  Obviamente, Ã© bom ter um canal com largura de banda de 10 Gbit / s, atravÃ©s do qual os dados sÃ£o transferidos durante o backup.  No entanto, o canal Ã© mais modesto para restaurar a partir de um backup, mas Ã© recomendÃ¡vel usar a equipe da NIC com o LACP ou o SMB Multicanal, ou alguma outra opÃ§Ã£o com agregaÃ§Ã£o de largura de banda.  VocÃª pode usar, por exemplo, portas LOM na versÃ£o 4x1 Gbit / s.  Essa configuraÃ§Ã£o Ã© recomendada para a conexÃ£o â€œvÃ¡rios dispositivos de origem - 1 dispositivo de backup de destinoâ€, ou seja, ao conectar â€œmuitos para umâ€.  (Da mesma forma, a recuperaÃ§Ã£o paralela de um armazenamento de backup para os dispositivos de destino - como regra, esses sÃ£o os mesmos iniciais em que os backups foram executados - Ã© uma conexÃ£o um para muitos.) <br>  Por exemplo, vocÃª pode configurar vÃ¡rias tarefas de backup de vÃ¡rios hosts Hyper-V / LUNs e salvar backups no mesmo armazenamento de destino.  Se vocÃª possui 10 hosts com uma largura de banda total de canal de 4x1 Gbit / s, se possui um canal de 10 Gbit / s no dispositivo de destino, essa Ã© uma configuraÃ§Ã£o bastante adequada. <br><br>  No caso em que o armazenamento de backup Ã© compartilhamento SMB, o multicanal funciona muito bem (ele pode ser complementado pelo SMB Direct se vocÃª tiver NICs com suporte a RDMA configurado).  Esses recursos agora sÃ£o suportados em muitas implantaÃ§Ãµes de cluster do Hyper-V.  No entanto, o componente da soluÃ§Ã£o Veeam responsÃ¡vel pelo movedor de dados pode usar o SMB Multichannel e o SMB Direct (novamente, com NICs configuradas com suporte a RDMA) apenas no cenÃ¡rio em que vocÃª usa VMs armazenadas no compartilhamento de arquivos SMB para fazer backup. proxy fora do host.  Esses Veeam Data Movers funcionam respectivamente no proxy de backup off-host e no repositÃ³rio.  Esse cenÃ¡rio Ã© descrito em detalhes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Outro ponto importante: ao usar a equipe da NIC do Windows no <i>modo independente Switch</i> , Ã© permitida a transferÃªncia de dados de todos os participantes e o recebimento de apenas um.  Se vocÃª deseja obter a taxa de transferÃªncia ideal nas duas direÃ§Ãµes para um processo, nÃ£o Ã© necessÃ¡rio usar o LACP.  Mas, neste caso, vocÃª precisa garantir que vÃ¡rias restauraÃ§Ãµes sejam feitas no mesmo host. <br><br>  Como vocÃª pode ver, a agregaÃ§Ã£o de largura de banda traz vÃ¡rias limitaÃ§Ãµes e nÃ£o Ã© completamente idÃªntica a ter um bom canal.  De qualquer forma, vocÃª precisa aproveitar os cenÃ¡rios de uso planejado. <br><br>  Resumindo: dependendo da sua infraestrutura, vocÃª pode usar a equipe da NIC do Windows no modo LACP ou no modo Alternar Independente / SMB Multicanal.  A Ãºltima opÃ§Ã£o Ã© Ãºtil se vocÃª estiver trabalhando com o compartilhamento de arquivos SMB e quiser usar o SMB Direct (nÃ£o se esqueÃ§a dos recursos do trabalho mencionado acima). <br><br><img src="https://habrastorage.org/webt/mm/fr/eo/mmfreonnwcu0xo_g0b7qcd3hg-m.png"><br><br>  Ã‰ necessÃ¡ria alta largura de banda e baixa latÃªncia para fornecer o melhor desempenho durante a montagem de discos virtuais, ao acessar e copiar dados durante a RecuperaÃ§Ã£o InstantÃ¢nea da VM. <br><br>  VocÃª pode executar vÃ¡rias operaÃ§Ãµes de recuperaÃ§Ã£o ao mesmo tempo e ainda nÃ£o interromper as tarefas de backup.  Ou seja, novamente, na presenÃ§a de um canal decente, o principal papel Ã© desempenhado pelo recurso e armazenamento de computaÃ§Ã£o.  Se tudo isso for projetado corretamente para backup, a recuperaÃ§Ã£o serÃ¡ efetiva. <br><br><h1>  RecomendaÃ§Ãµes para dispositivos de destino </h1><br>  Considere vÃ¡rias opÃ§Ãµes, das quais, possivelmente, vocÃª escolherÃ¡ o melhor para si. <br><br><h3>  OpÃ§Ã£o 1: recuperar para hosts Hyper-V e diretamente para o LUN na infraestrutura de produÃ§Ã£o </h3><br>  Mesmo se vocÃª tiver um sistema de armazenamento de alto desempenho com armazenamento em cache de leitura / gravaÃ§Ã£o ou o nÃ­vel 1 estiver configurado, entÃ£o, conforme mencionado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em uma postagem anterior</a> , tenha cuidado para nÃ£o estourar.  Caso contrÃ¡rio, as VMs de produÃ§Ã£o serÃ£o afetadas.  E isso pode acontecer, por exemplo, se vocÃª tentar gravar grandes quantidades de dados no sistema de armazenamento o mais rÃ¡pido possÃ­vel - isso acontece ao migrar sistemas de armazenamento.  Nessas operaÃ§Ãµes, tentamos evitar o uso de sistemas de armazenamento de nÃ­vel 1.  ConsideraÃ§Ãµes semelhantes se aplicam Ã  restauraÃ§Ã£o de grandes VMs. <br><br>  VocÃª pode recomendar a recuperaÃ§Ã£o para separar LUNs com perfis diferentes.  VMs restauradas podem ser migradas lentamente para CSVs de produÃ§Ã£o.  Para garantir alta disponibilidade, vocÃª pode usar o cluster usando a migraÃ§Ã£o ao vivo do Storage (funcionalidade de migraÃ§Ã£o de armazenamento â€œao vivoâ€).  Naturalmente, vocÃª precisa se concentrar no desempenho da sua matriz de armazenamento. <br><br><h3>  OpÃ§Ã£o 2: recuperaÃ§Ã£o para hosts Hyper-V com unidades SSD / NMVe locais </h3><br>  Outro cenÃ¡rio de recuperaÃ§Ã£o em produÃ§Ã£o, bastante eficaz: usar o host Hyper-V do armazenamento local para SSD ou NVMe.  O tamanho do espaÃ§o em disco depende de quantas VMs vocÃª deseja recuperar em um determinado perÃ­odo de tempo e do tamanho dessas VMs. <br><br>  Em teoria, Ã© improvÃ¡vel que vocÃª precise restaurar tudo e todos, portanto essa configuraÃ§Ã£o deve ter um custo bastante econÃ´mico.  Por exemplo, vocÃª pode usar um SSD em cada um dos nÃ³s do cluster, ou apenas em alguns, ou em geral apenas em um.  Quanto mais SSD / NVMe vocÃª usar, mais orÃ§amento eles terÃ£o, mantendo uma distribuiÃ§Ã£o de carga bastante eficiente entre os hosts.  No estÃ¡gio final do procedimento de recuperaÃ§Ã£o instantÃ¢nea, as mÃ¡quinas virtuais podem ser facilmente transferidas para CSVs de produÃ§Ã£o, usando a mesma funcionalidade de migraÃ§Ã£o ao vivo do Storage. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fi/o9/bi/fio9bip9q5jezqbtx2xzb6t49lq.png" width="500" height="610"></div><br>  O diagrama mostra uma opÃ§Ã£o de planejamento de infraestrutura.  Obviamente, vocÃª pode combinar as abordagens acima a seu critÃ©rio. <br><br><h3>  OpÃ§Ã£o 3: recuperar para hosts Hyper-V dedicados com unidades SSD / NVMe locais </h3><br>  Nesta opÃ§Ã£o, alocamos um ou mais hosts especificamente para dar suporte Ã  recuperaÃ§Ã£o.  Isso evita uma possÃ­vel falta de recursos e o impacto na operaÃ§Ã£o dos hosts de produÃ§Ã£o no cluster.  VocÃª pode usar unidades NVMe.  Recomendamos que vocÃª teste os recursos de recuperaÃ§Ã£o nesta configuraÃ§Ã£o com antecedÃªncia para entender como os recursos estÃ£o acabando. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_5/c2/_c/_5c2_c7beo7ac9tamvuvgr2-_c4.png" width="600" height="271"></div><br>  Se vocÃª planeja aumentar o consumo deles, para a migraÃ§Ã£o final de mÃ¡quinas recondicionadas para a produÃ§Ã£o, Ã© possÃ­vel usar a chamada migraÃ§Ã£o sem compartilhar recursos MigraÃ§Ã£o compartilhada com nada ao vivo.  (Para isso, Ã© necessÃ¡rio definir configuraÃ§Ãµes de seguranÃ§a adicionais.) Quanto aos recursos de rede, vocÃª pode usar, por exemplo, os recursos SMB Multicanal e SMB Direct para migraÃ§Ã£o para CSV / Live Migration / S2D Hyper-V. <br>  Sim, a migraÃ§Ã£o dos sistemas de armazenamento (migraÃ§Ã£o ao vivo do Storage) nÃ£o Ã© o processo mais rÃ¡pido, Ã© um sinal de menos.  Mas hÃ¡ uma vantagem - suas mÃ¡quinas virtuais sÃ£o restauradas e continuam a trabalhar durante esse processo. <br><br><h1>  Em conclusÃ£o </h1><br>  Obviamente, todo mundo escolhe as opÃ§Ãµes preferidas, dependendo de qual Ã© o gargalo em uma infraestrutura especÃ­fica (servidor de origem, servidor de destino, recursos de rede).  AlÃ©m disso, Ã© bem possÃ­vel que um estudo cuidadoso seja necessÃ¡rio apenas para planejar a recuperaÃ§Ã£o das VMs mais crÃ­ticas ou para os consumidores que pagam por esse serviÃ§o. <br><br>  De qualquer forma, o objetivo principal sempre serÃ¡ a recuperaÃ§Ã£o mais rÃ¡pida possÃ­vel. <br>  Depois disso, jÃ¡ Ã© possÃ­vel migrar com seguranÃ§a para o sistema de armazenamento em cluster, garantindo alta disponibilidade e tolerÃ¢ncia a falhas.  E, Ã© claro, as mÃ¡quinas virtuais devem ser protegidas na forma de backup \ replicaÃ§Ã£o, caso precisem ser restauradas novamente em algum momento. <br><br><h1>  O que mais se pode ler: </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo da Habr sobre planejamento de infraestrutura para recuperaÃ§Ã£o instantÃ¢nea de VM (parte 1)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Guia do usuÃ¡rio do Veeam Backup &amp; Replication para Hyper-V (em russo)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Veeam Backup &amp; Replication User Guide for VMware (em russo)</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414547/">https://habr.com/ru/post/pt414547/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414531/index.html">NinguÃ©m sabe o que acontecerÃ¡ com as compras on-line a partir de 1Âº de julho</a></li>
<li><a href="../pt414535/index.html">Manchester: o berÃ§o do desÃ¢nimo, pÃ³s-punk e dois famosos clubes de futebol</a></li>
<li><a href="../pt414537/index.html">Como criamos um dos melhores jogos de realidade aumentada do mundo sem trÃ¡fego pago</a></li>
<li><a href="../pt414539/index.html">Cibercriminosos roubam cada vez mais dados pessoais de russos</a></li>
<li><a href="../pt414541/index.html">OtimizaÃ§Ã£o do aplicativo node.js.</a></li>
<li><a href="../pt414549/index.html">3.000 olhos para inteligÃªncia artificial. Qual Ã© o sistema de monitoramento de estrutura do Centro de Lakhta?</a></li>
<li><a href="../pt414551/index.html">InstruÃ§Ãµes para admissÃ£o de doutorado nos EUA</a></li>
<li><a href="../pt414555/index.html">Como transferimos 36 milhÃµes de clientes para um serviÃ§o de suporte tÃ©cnico digital</a></li>
<li><a href="../pt414557/index.html">Hacking medidores inteligentes no PHDays 8: anÃ¡lise do concurso MeterH3cker</a></li>
<li><a href="../pt414561/index.html">Escola francesa de videogame: outro mundo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>