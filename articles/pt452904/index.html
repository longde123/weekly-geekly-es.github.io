<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïå üß§ üì≥ Como as m√°quinas se comunicam - protocolo MQTT üëÜüèª üßëüèø‚Äçü§ù‚Äçüßëüèª üôÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em um artigo anterior, vimos o protocolo Modbus , que √© o padr√£o de fato do setor para intera√ß√£o M2M . Desenvolvido em 1979, possui v√°rias desvantagen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como as m√°quinas se comunicam - protocolo MQTT</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/advantech/blog/452904/"><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/nb/fv/om/nbfvom_zwqoyqg4e4bcxwl1ax7a.png"></div><br>  Em um artigo anterior, vimos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o protocolo Modbus</a> , que √© o padr√£o de fato do setor para intera√ß√£o <abbr title="M√°quina a m√°quina">M2M</abbr> .  Desenvolvido em 1979, possui v√°rias desvantagens significativas que o MQTT resolve. <br><br>  O protocolo MQTT √© bastante jovem (padronizado apenas em 2016), mas j√° conseguiu ser amplamente utilizado na ind√∫stria e na IoT.  Foi especialmente projetado para ser o mais compacto poss√≠vel, para canais inst√°veis ‚Äã‚Äãda Internet e dispositivos de baixa energia, e permite a entrega garantida de mensagens em caso de perda e desconex√£o de pacotes. <br><br>  Principais recursos do protocolo MQTT: <br><br><ul><li>  <b>Compacto e leve</b> - transfer√™ncia m√≠nima de dados para economizar tr√°fego. </li><li>  <b>Resist√™ncia a perdas</b> - entrega garantida nas condi√ß√µes de conex√µes de rede inst√°veis. </li><li>  <b>Ass√≠ncrono</b> - permite atender a um grande n√∫mero de dispositivos e n√£o depende de atrasos na rede. </li><li>  <b>Suporte a QoS</b> - a capacidade de controlar a prioridade da mensagem e garantir a entrega da mensagem ao destinat√°rio. </li><li>  <b>Configura√ß√£o din√¢mica</b> - n√£o requer coordena√ß√£o pr√©via de campos e formatos de dados, pode ser configurada em tempo real. </li><li>  <b>Funciona para NAT</b> - os clientes podem estar atr√°s do NAT, apenas o servidor (broker) deve ter um IP real.  Permite que voc√™ fa√ßa sem VPN e encaminhamento de porta. </li><li>  <b>Endere√ßamento conveniente</b> - os campos de dados t√™m nomes de texto compreens√≠veis para os seres humanos.  N√£o h√° necessidade de lembrar endere√ßos digitais e compensa√ß√µes de bits. </li></ul><a name="habracut"></a><br>  No artigo, compararemos o MQTT e o Modbus, analisaremos a estrutura do protocolo, os conceitos b√°sicos e tentaremos usar o broker MQTT na nuvem como exemplo em uma conex√£o √† Internet inst√°vel. <br><br><h2>  Hist√≥rico do Protocolo MQTT </h2><br>  O MQTT foi desenvolvido pela IBM em 1999 e foi inicialmente usado internamente para suas solu√ß√µes. <br><br>  Em novembro de 2011, a IBM e a Eurotech anunciaram sua participa√ß√£o no grupo de trabalho Eclipse M2M e a transfer√™ncia do c√≥digo MQTT para o projeto Eclipse Paho. <br><br>  Em 2013, o cons√≥rcio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OASIS</a> (Organiza√ß√£o para o Avan√ßo de Padr√µes Estruturados de Informa√ß√µes) iniciou o processo de padroniza√ß√£o do protocolo MQTT.  At√© esse momento, a especifica√ß√£o do protocolo foi publicada sob uma licen√ßa gratuita e empresas como a Eurotech (anteriormente conhecida como Arcom) j√° usam o protocolo em seus produtos. <br><br>  Em outubro de 2014, o OASIS publicou o primeiro padr√£o oficial do protocolo MQTT. <br><br>  Em 2016, o protocolo foi padronizado pela Organiza√ß√£o Internacional de Normaliza√ß√£o ISO e recebeu o n√∫mero ISO / IEC 20922. <br><br>  Desde 2014, o interesse no protocolo come√ßa a crescer rapidamente e, a julgar pela programa√ß√£o do Google Trends, hoje excede o interesse no Modbus. <br><br><img src="https://habrastorage.org/webt/ia/6q/cw/ia6qcwyvn9p6yi_10xrdgkwbcqu.png"><br>  <font color="999999">Refer√™ncia do Google Trends</font> <br><br><h2>  Conceitos b√°sicos </h2><br>  O MQTT possui uma arquitetura cliente-servidor.  As mensagens ocorrem atrav√©s de um servidor central chamado corretor.  Sob condi√ß√µes normais, os clientes n√£o podem se comunicar diretamente entre si e todas as trocas de dados ocorrem por meio de um broker. <br><br>  Os clientes podem atuar como provedores de dados (Publicador) e como destinat√°rios de dados (Assinante).  Em uma tradu√ß√£o para o russo, esses termos geralmente s√£o traduzidos como editor e assinante, mas, para evitar confus√£o, usaremos apenas a terminologia original. <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/ex/ri/7r/exri7rw8067vln4jiqq5ma9dine.png"></div><br>  <font color="999999">No protocolo MQTT, os clientes se comunicam por meio de um n√≥ central</font> <br><br>  No n√≠vel do aplicativo, o protocolo √© executado sobre TCP / IP e pode conectar facilmente objetos remotos diretamente pela Internet, sem a necessidade de t√∫neis VPN.  Basta que o broker tenha um endere√ßo IP real e todos os clientes possam se conectar a ele.  Nesse caso, os clientes podem estar localizados atr√°s do NAT.  Como os clientes iniciam a conex√£o no protocolo MQTT, o encaminhamento de porta n√£o √© necess√°rio para estabelecer uma conex√£o, enquanto no Modbus / TCP o servidor inicia uma conex√£o (principal), que requer acessibilidade direta √† rede. <br><br>  A porta do broker MQTT padr√£o para conex√µes TCP de entrada √© <b>1883</b> .  Ao usar uma conex√£o SSL segura, a porta <b>8883 √© usada</b> . <br><br><h4>  Corretor </h4><br>  Um broker √© o hub central do MQTT para intera√ß√£o com o cliente.  A troca de dados entre clientes ocorre apenas atrav√©s de um broker.  O broker pode ser um software de servidor ou um controlador.  Suas tarefas incluem receber dados de clientes, processar e armazenar dados, entregar dados a clientes e monitorar a entrega de mensagens. <br><br><h4>  Editor / Assinante </h4><br>  Para entender a diferen√ßa entre Publisher e Subscriber, vamos dar um exemplo simples: um sensor de umidade mede a umidade em uma sala e, se cair abaixo de um determinado n√≠vel, o umidificador √© ativado. <br><br>  Nesse caso, o sensor de umidade atua como um <b>Publicador</b> : sua tarefa √© apenas publicar dados no broker.  O umidificador atua como um <b>Assinante</b> : ele assina atualiza√ß√µes de dados de umidade e recebe dados atualizados do broker, enquanto o umidificador pode decidir em que ponto ativar a umidifica√ß√£o. <br><br>  Nesse esquema, os clientes MQTT, ou seja, o sensor e o umidificador, n√£o est√£o cientes da exist√™ncia um do outro e n√£o interagem diretamente.  O broker pode receber dados de v√°rias fontes, manipul√°-las, por exemplo, calcular o valor m√©dio de v√°rios sensores e retornar os dados processados ‚Äã‚Äãao assinante. <br><br><img src="https://habrastorage.org/webt/xc/pb/t8/xcpbt8th_jxzdzfglqwxt4wnpwo.png"><br>  <font color="9999999">O Publisher envia dados para o corretor, o Assinante assina atualiza√ß√µes desses dados</font> <br><br>  Ao mesmo tempo, a assincronia do protocolo MQTT prev√™ que o sensor e o umidificador possam estar online em momentos diferentes, perder pacotes e ficar inacess√≠veis.  O intermedi√°rio cuidar√° de armazenar os √∫ltimos dados recebidos do sensor na mem√≥ria e garantir√° sua entrega ao umidificador. <br><br><h4>  T√≥pico </h4><br>  O MQTT usa t√≥picos para identificar entidades, na tradu√ß√£o para o russo tamb√©m s√£o chamados de canais.  Os t√≥picos consistem em caracteres UTF8 e t√™m uma estrutura em √°rvore semelhante a um sistema de arquivos UNIX.  Esse √© um mecanismo conveniente para nomear entidades em uma forma leg√≠vel por humanos. <br><br>  Um exemplo de t√≥picos no MQTT <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     home/kitchen/temperature #     home/sleeping-room/temperature #     home/outdoor/light</span></span></code> </pre> <br>  Essa abordagem permite que voc√™ veja visualmente quais dados s√£o transmitidos, e √© conveniente desenvolver e depurar o c√≥digo sem precisar memorizar o endere√ßo digital da localiza√ß√£o dos dados, como √© feito no Modbus. <br><br>  Os t√≥picos tamb√©m incluem sintaxe curinga, familiar para aqueles que trabalharam com o sistema de arquivos UNIX.  O curinga pode ser de n√≠vel √∫nico e multin√≠vel. <br><br>  Um curinga de n√≠vel √∫nico √© indicado por um <b>+</b> . <br><br>  Por exemplo, para receber dados de sensores de temperatura em todas as salas da casa, o assinante precisa se inscrever em um t√≥pico: <br><br><pre> <code class="plaintext hljs">home/+/temperature</code> </pre><br>  Como resultado, ele se inscrever√° para receber dados de tais sensores: <br><br><pre> <code class="plaintext hljs">home/kitchen/temperature home/sleeping-room/temperature home/living-room/temperature home/outdoor/temperature</code> </pre><br>  Um curinga de v√°rios n√≠veis √© indicado pelo s√≠mbolo " <b>#</b> ". <br>  Um exemplo de obten√ß√£o de dados de todos os sensores em todos os c√¥modos da casa: <br><br><pre> <code class="plaintext hljs">home/#</code> </pre><br>  A inscri√ß√£o nesse t√≥pico permitir√° que voc√™ receba dados de tais sensores: <br><br><pre> <code class="plaintext hljs">home/kitchen/temperature home/kitchen/humidity home/kitchen/light home/sleeping-room/temperature home/sleeping-room/humidity home/sleeping-room/light ....</code> </pre><br><h3>  Identifica√ß√£o do cliente </h3><br>  Para controle de acesso, o MQTT fornece autentica√ß√£o de cliente, ao contr√°rio do protocolo Modbus, que n√£o possui essa fun√ß√£o.  Os seguintes campos s√£o usados ‚Äã‚Äãpara controle de acesso: <br><br>  <b>ClientId</b> - identificador exclusivo (campo obrigat√≥rio) do cliente.  Deve ser exclusivo para cada cliente.  A vers√£o atual do padr√£o MQTT 3.1.1 permite usar o campo ClientId vazio se voc√™ n√£o precisar salvar o status da conex√£o. <br><br>  <b>Nome de usu√°rio</b> - (campo opcional) login para autentica√ß√£o, no formato UTF-8.  Pode n√£o ser √∫nico.  Por exemplo, um grupo de clientes pode efetuar login com o mesmo nome de usu√°rio / senha. <br><br>  <b>Senha</b> - (campo opcional) pode ser enviada apenas junto com o campo Nome do usu√°rio, enquanto o Nome do usu√°rio pode ser transmitido sem o campo Senha.  65535 bytes no m√°ximo.  √â importante saber que o nome e a senha s√£o transmitidos de forma clara. Portanto, se os dados s√£o transmitidos por redes p√∫blicas, voc√™ deve usar o SSL para criptografar a conex√£o. <br><br><h3>  Estrutura do pacote </h3><br>  Como mencionado acima, no protocolo MQTT, os clientes sempre iniciam uma conex√£o, independentemente de serem destinat√°rios (Assinante) ou fornecedores (Publicador) de dados.  Analisaremos o pacote com a conex√£o que foi interceptada usando o programa Wireshark. <br><br><img src="https://habrastorage.org/webt/ep/0t/hv/ep0thv6e3zsvyzgizw89gpxgytg.png"><br>  <font color="999999">Pacote MQTT transmitido por um canal n√£o criptografado</font> <br><br>  O cabe√ßalho TCP mostra que o pacote foi enviado na porta 1883, ou seja, a criptografia n√£o √© usada, o que significa que todos os dados est√£o dispon√≠veis em formato claro, incluindo login e senha. <br><br><h4>  Manchete </h4><br>  <b>O tipo de mensagem</b> √© Connect (comando 0x0001), estabelecendo uma conex√£o com o broker.  Equipes principais: conectar, desconectar, publicar, inscrever-se, cancelar inscri√ß√£o.  Tamb√©m existem comandos de reconhecimento, manter vivos, etc. <br><br>  <b>Sinalizador DUP</b> - significa que a mensagem √© retransmitida, √© usada apenas nos tipos de mensagem PUBLISH, SUBSCRIBE, UNSUBSCRIBE, PUBREL, nos casos em que o broker n√£o recebeu confirma√ß√£o de recebimento da mensagem anterior. <br>  <b>N√≠vel de QoS</b> - sinalizador de Qualidade de servi√ßo.  Discutiremos esse t√≥pico com mais detalhes posteriormente. <br>  <b>Reter</b> - dados publicados com o sinalizador de reten√ß√£o s√£o armazenados no broker.  Ap√≥s a assinatura subsequente deste t√≥pico, o broker enviar√° imediatamente uma mensagem com esse sinalizador.  Usado apenas em mensagens do tipo Publicar. <br><br><h2>  Uso pr√°tico </h2><br><img width="100" src="https://habrastorage.org/webt/v9/m9/2k/v9m92kvqrkibu8zt9pfsdjkngg8.png"><br><br>  Agora, tendo nos familiarizado com a teoria, vamos tentar trabalhar com o MQTT na pr√°tica.  Para isso, usaremos o programa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mosquitto</a> aberto, que pode funcionar tanto no modo cliente quanto no modo servidor (broker).  Funciona no Windows, macOS, Linux.  O programa √© muito conveniente para depurar e estudar o protocolo MQTT, enquanto tamb√©m √© amplamente utilizado em opera√ß√µes industriais.  N√≥s o usaremos como um cliente para enviar e receber dados de um broker de nuvem remota. <br><br>  Muitos provedores de nuvem fornecem servi√ßos de broker MQTT, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Microsoft Azure IoT Hub</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Amazon AWS IoT</a> e outros.  Neste exemplo, usaremos o servi√ßo Cloudmqtt.com, pois ele tem o registro mais simples e uma tarifa gratuita √© suficiente para o treinamento. <br><br>  Ap√≥s o registro, os detalhes para conectar-se a um corretor est√£o dispon√≠veis em sua conta.  Como nos conectamos ao servidor por meio de redes p√∫blicas da Internet, √© razo√°vel usar uma porta SSL para criptografar o tr√°fego. <br><br><img src="https://habrastorage.org/webt/gh/rq/t5/ghrqt5ady8x8twccmfrtngm-htu.png"><br>  <font color="999999">Detalhes de acesso do broker MQTT na conta pessoal do provedor de nuvem</font> <br><br>  A flexibilidade do protocolo MQTT permite ao cliente transferir dados n√£o definidos anteriormente no broker.  Ou seja, n√£o h√° necessidade de pr√©-criar os t√≥picos necess√°rios nos quais o Publisher pode gravar dados.  Usando os dados recebidos da sua conta pessoal, tentaremos redigir manualmente uma solicita√ß√£o de publica√ß√£o de dados no <i>t√≥pico habr / test / random</i> e ler a partir dele. <br><br>  <b>mosquitto_sub</b> - utilit√°rio do cliente do assinante <br>  <b>mosquitto_pub</b> - utilit√°rio cliente do editor <br><br>  Primeiro, conecte-se ao broker como um assinante e assine para receber dados do t√≥pico <br>  <i>habr / teste / aleat√≥rio</i> . <br><br><pre> <code class="plaintext hljs">mosquitto_sub -d --capath /etc/ssl/certs/ --url mqtts://hwjspxxt:7oYugN7Fa5Aa@postman.cloudmqtt.com:27529/habr/test/random Client mosq/zEPZz0glUiR4aEipZA sending CONNECT Client mosq/zEPZz0glUiR4aEipZA received CONNACK (0) Client mosq/zEPZz0glUiR4aEipZA sending SUBSCRIBE (Mid: 1, Topic: habr/test/random, QoS: 0, Options: 0x00) Client mosq/zEPZz0glUiR4aEipZA received SUBACK</code> </pre><br>  Pode-se ver que a conex√£o foi bem-sucedida e <b>assinamos</b> o <b>t√≥pico habr / test / random</b> , e agora estamos aguardando dados neste t√≥pico do broker. <br><blockquote>  Como uma conex√£o SSL √© usada, para verificar o certificado, voc√™ deve especificar o caminho pelo qual o programa procurar√° por certificados de criptografia raiz.  Como o servi√ßo em nosso exemplo usa um certificado emitido por uma autoridade de certifica√ß√£o confi√°vel, indicamos o caminho para o armazenamento do sistema para certificados raiz: <i><b>--capath / etc / ssl / certs /</b></i> <br><br>  No caso de um certificado autoassinado, voc√™ deve especificar o caminho para a CA desejada.  Tamb√©m √© importante considerar a diferen√ßa no formato URI para conex√µes SSL - mqtt <b>s</b> : // e conex√µes n√£o criptografadas - mqtt: //.  No caso de um erro de verifica√ß√£o do certificado, o programa termina sem uma mensagem de erro.  Para uma sa√≠da mais detalhada, voc√™ pode usar a op√ß√£o --debug </blockquote>  Agora vamos tentar publicar os dados no t√≥pico sem interromper o primeiro programa. <br><br><pre> <code class="plaintext hljs">mosquitto_pub -d --capath /etc/ssl/certs/ --url mqtt://hwjspxxt:7oYugN7Fa5Aa@postman.cloudmqtt.com:27529/habr/test/random -m " !" Client mosq/sWjh9gf8DRASrRZjk6 sending CONNECT Client mosq/sWjh9gf8DRASrRZjk6 received CONNACK (0) Client mosq/sWjh9gf8DRASrRZjk6 sending PUBLISH (d0, q0, r0, m1, 'habr/test/random', ... (22 bytes)) Client mosq/sWjh9gf8DRASrRZjk6 sending DISCONNECT</code> </pre><br>  Pode-se observar que os dados foram recebidos com sucesso pelo servidor e publicados no t√≥pico desejado.  Ao mesmo tempo, na primeira janela em que o programa mosquitto_sub est√° em execu√ß√£o, vemos como a mensagem foi recebida, at√© mesmo o Unicode est√° funcionando, a mensagem est√° em russo. <br><br><pre> <code class="plaintext hljs">Client mosq/zEPZz0glUiR4aEipZA received PUBLISH (d0, q0, r0, m0, 'habr/test/random', ... (22 bytes))  !</code> </pre><br><h2>  QoS e garantia de entrega </h2><br>  No entanto, enviar uma mensagem em tempo real n√£o surpreender√° ningu√©m, porque o mesmo pode ser feito mesmo com o utilit√°rio banal <b>nc</b> .  Portanto, tentaremos simular uma conex√£o inst√°vel entre o assinante e o remetente.  Imagine que ambos os clientes trabalhem com GPRS, com uma enorme perda de pacotes e at√© uma conex√£o TCP bem-sucedida seja rara, e voc√™ precisa garantir que o assinante tenha a garantia de receber uma mensagem de remetente.  Nesse caso, as op√ß√µes de QoS s√£o √∫teis. <br><br>  Por padr√£o, o sinalizador <b>QoS</b> √© definido <b>como 0</b> para mensagens, o que significa "Disparar e esquecer": o Publisher publica a mensagem no broker, mas n√£o exige que a mensagem seja garantida para ser entregue ao assinante.  Isso √© adequado para dados cuja perda n√£o √© cr√≠tica, por exemplo, para medi√ß√µes regulares de umidade ou temperatura. <br><br>  <b>QoS 1: Pelo menos uma vez - pelo menos uma</b> .  Esse sinalizador significa que, at√© que o Publicador receba confirma√ß√£o de entrega ao assinante, essa publica√ß√£o ser√° enviada ao corretor e depois ao assinante.  Assim, o assinante deve receber esta mensagem pelo menos uma vez. <br><br>  <b>QoS 2: Exatamente uma vez - um garantido</b> .  O sinalizador QoS, que oferece a maior garantia de entrega de mensagens atrav√©s do uso de procedimentos adicionais para confirma√ß√£o e conclus√£o da publica√ß√£o (PUBREC, PUBREL, PUBCOMP).  Aplic√°vel a situa√ß√µes em que √© necess√°rio excluir qualquer perda e duplica√ß√£o de dados dos sensores.  Por exemplo, quando um alarme √© acionado a partir de uma mensagem recebida, √© feita uma chamada de emerg√™ncia. <br><br>  Para simular uma comunica√ß√£o ruim, desligue os dois clientes e tente enviar uma mensagem com a maior prioridade de QoS e tamb√©m adicione a op√ß√£o Reter para que a mensagem enviada seja salva no broker. <br><br><pre> <code class="plaintext hljs">mosquitto_pub --retain --qos 2 -d --capath /etc/ssl/certs/ --url mqtt://hwjspxxt:7oYugN7Fa5Aa@postman.cloudmqtt.com:27529/habr/test/random -m "  !" Client mosq/Xwhua3GAyyY9mMd05V sending CONNECT Client mosq/Xwhua3GAyyY9mMd05V received CONNACK (0) Client mosq/Xwhua3GAyyY9mMd05V sending PUBLISH (d0, q2, r1, m1, 'habr/test/random', ... (37 bytes)) Client mosq/Xwhua3GAyyY9mMd05V received PUBREC (Mid: 1) Client mosq/Xwhua3GAyyY9mMd05V sending PUBREL (m1) Client mosq/Xwhua3GAyyY9mMd05V received PUBCOMP (Mid: 1, RC:0) Client mosq/Xwhua3GAyyY9mMd05V sending DISCONNECT</code> </pre><br>  Agora, depois de algum tempo, nosso destinat√°rio finalmente conseguiu estabelecer uma conex√£o com a Internet e conectada ao broker: <br><br><pre> <code class="plaintext hljs">mosquitto_sub -d --capath /etc/ssl/certs/ -d --url mqtts://hwjspxxt:7oYugN7Fa5Aa@postman.cloudmqtt.com:27529/habr/test/random Client mosq/VAzcLVMB1MiWhYxoJS sending CONNECT Client mosq/VAzcLVMB1MiWhYxoJS received CONNACK (0) Client mosq/VAzcLVMB1MiWhYxoJS sending SUBSCRIBE (Mid: 1, Topic: habr/test/random, QoS: 0, Options: 0x00) Client mosq/VAzcLVMB1MiWhYxoJS received SUBACK Subscribed (mid: 1): 0 Client mosq/r6UwPnDvx8aNInpPF6 received PUBLISH (d0, q0, r1, m0, 'habr/test/random', ... (37 bytes))   !</code> </pre><br><h2>  Conclus√£o </h2><br>  O MQTT √© um protocolo moderno e avan√ßado, desprovido de muitos dos inconvenientes de seus antecessores.  Sua flexibilidade permite adicionar dispositivos clientes sem configurar um broker, o que economiza tempo significativamente.  O limiar de entrada para entender e configurar o protocolo √© bastante baixo, e a presen√ßa de bibliotecas para muitas linguagens de programa√ß√£o permite escolher qualquer pilha de tecnologia para desenvolvimento.  A garantia de entrega de mensagens distingue significativamente o MQTT de seus antecessores e permite que voc√™ n√£o perca tempo desenvolvendo desnecessariamente seus pr√≥prios mecanismos de controle de integridade no n√≠vel da rede. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt452904/">https://habr.com/ru/post/pt452904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt452890/index.html">23 de maio, 18:30 - transmiss√£o ao vivo da cozinha QIWI</a></li>
<li><a href="../pt452892/index.html">Como um n√£o programador pode se mudar para os EUA: instru√ß√µes passo a passo</a></li>
<li><a href="../pt452894/index.html">Enfrente o Anti-Spoofing ou reconhe√ßa tecnologicamente um trapaceiro entre mil</a></li>
<li><a href="../pt452900/index.html">√çndices no PostgreSQL - 9 (BRIN)</a></li>
<li><a href="../pt452902/index.html">Terminando 4 anos de treinamento como programador, entendo que estou longe de ser um programador</a></li>
<li><a href="../pt452906/index.html">Mecanismos JavaScript: como eles funcionam? Da pilha de chamadas √†s promessas, (quase) tudo o que voc√™ precisa saber</a></li>
<li><a href="../pt452908/index.html">Selenium WebDriver - M√©trica de teste em tempo real usando Grafana e InfluxDB</a></li>
<li><a href="../pt452910/index.html">Ol√° Habr! Ol√° Tercon</a></li>
<li><a href="../pt452914/index.html">ML em Scala com um sorriso, para aqueles que n√£o t√™m medo de experimenta√ß√£o</a></li>
<li><a href="../pt452916/index.html">Levante-se e v√° embora. Cirurgia da coluna vertebral: quando fazer, o que √© perigoso</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>