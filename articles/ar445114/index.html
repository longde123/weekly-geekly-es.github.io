<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฐ ๐ ๐ ุชุญุณูู ุงูุตูุฏูู ุงูุฑููู ูููุตูุต ุฑุงุฆุน ๐ก ๐ โฐ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงููุชุฑุฌู: ุนูุฏ ุชุทููุฑ ููุตุฉ CUBA ุ ูุถุน ูู ูุฐุง ุงูุฅุทุงุฑ ุงููุฏุฑุฉ ุนูู ุชูููุฐ ุงูุจุฑุงูุฌ ุงููุตูุฉ ุงููุฎุตุตุฉ ูู ุฃุฌู ุชูููู ุฃูุซุฑ ูุฑููุฉ ูููุทู ุฃุนูุงู ุงูุชุทุจูู. ุณูุงุก ูุงูุช ูุฐู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุญุณูู ุงูุตูุฏูู ุงูุฑููู ูููุตูุต ุฑุงุฆุน</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/445114/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/l7/d9/cg/l7d9cgoh4tjgptdfr68phnooab4.jpeg"></p><br><p style=";text-align:right;direction:rtl">  <em>ูู ุงููุชุฑุฌู: ุนูุฏ ุชุทููุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุตุฉ CUBA ุ</a> ูุถุน ูู ูุฐุง ุงูุฅุทุงุฑ ุงููุฏุฑุฉ ุนูู ุชูููุฐ ุงูุจุฑุงูุฌ ุงููุตูุฉ ุงููุฎุตุตุฉ ูู ุฃุฌู ุชูููู ุฃูุซุฑ ูุฑููุฉ ูููุทู ุฃุนูุงู ุงูุชุทุจูู.</em>  <em>ุณูุงุก ูุงูุช ูุฐู ุงููุฑุตุฉ ุฌูุฏุฉ ุฃู ุณูุฆุฉ (ููุญู ูุชุญุฏุซ ููุณ ููุท ุนู CUBA) ููุฏ ุงูููุงูุดุฉ ููุชุฑุฉ ุทูููุฉ ุ ูููู ุญูููุฉ ุฃู ุงูุณูุทุฑุฉ ุนูู ุชูููุฐ ุงูุจุฑุงูุฌ ุงููุตูุฉ ูููุณุชุฎุฏู ุถุฑูุฑูุฉ ูุง ุชุซูุฑ ุฃู ุฃุณุฆูุฉ.</em>  <em>ูุชู ุชูุฏูู ุฅุญุฏู ููุฒุงุช Groovy ุงููููุฏุฉ ูุฅุฏุงุฑุฉ ุชูููุฐ ุงูุจุฑูุงูุฌ ุงููุตู ุงููุฎุตุต ูู ูุฐู ุงูุชุฑุฌูุฉ ูู Cรฉdric Champeau.</em>  <em>ุนูู ุงูุฑุบู ูู ุฃูู ุบุงุฏุฑ ูุฑูู ุชุทููุฑ Groovy ูุคุฎุฑูุง ุ ูุจุฏู ุฃู ูุฌุชูุน ุงููุจุฑูุฌูู ูุณุชููุฏ ูู ุฌููุฏู ููุชุฑุฉ ุทูููุฉ ูุงุฏูุฉ.</em> </p><br><p style=";text-align:right;direction:rtl">  ุชุนุฏ ุงูุจุฑูุฌุฉ ุงููุตูุฉ ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุทุฑู ุดููุนูุง ูุงุณุชุฎุฏุงู Groovy ุ ุญูุซ ูุฌุนู ุชุทุจูู Groovy ูู ุงูุณูู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฏููุงูููููุง ูู ููุช ุงูุชุดุบูู.  ุงุนุชูุงุฏูุง ุนูู ุงูุชุทุจูู ุ ูููู ูุถุน ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู ุฃูุงูู ูุฎุชููุฉ: ูุธุงู ุงููููุงุช ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูุฎุฏูุงุช ุนู ุจุนุฏ ... ูููู ุงูุฃูู ูู ุฐูู ุฃู ูุทูุฑ ุงูุชุทุจูู ุงูุฐู ูููุฐ ุงูุจุฑุงูุฌ ุงููุตูุฉ ูุง ููุชุจูุง ุจุงูุถุฑูุฑุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ูููู ุฃู ุชุนูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู ุจูุฆุฉ ูุญุฏูุฏุฉ (ุฐุงูุฑุฉ ูุญุฏูุฏุฉ ุ ุชุญุฏ ูู ุนุฏุฏ ูุงุตูุงุช ุงููููุงุช ุ ููุช ุงูุชุดุบูู ...) ุ ุฃู ูุฏ ุชุฑุบุจ ูู ููุน ุงููุณุชุฎุฏู ูู ุงุณุชุฎุฏุงู ุฌููุน ููุฒุงุช ุงููุบุฉ ูู ุงูุจุฑูุงูุฌ ุงููุตู. </p><br><p style=";text-align:right;direction:rtl">  <strong>ูุฐุง ุงูููุตุจ ุณูู ุงููู ูู.</strong> </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุงุฐุง ุฑุงุฆุน ุฑุงุฆุน ููุชุงุจุฉ dsl ุฏุงุฎูู </li><li style=";text-align:right;direction:rtl">  ูุง ูู ููุฒุงุชู ูู ุญูุซ ุฃูุงู ุงูุชุทุจูู ุงูุฎุงุต ุจู </li><li style=";text-align:right;direction:rtl">  ููููุฉ ุชูููู ุชุฌููุน ูุชุญุณูู DSL </li><li style=";text-align:right;direction:rtl"> ุญูู ูููุฉ <code>SecureASTCustomizer</code> </li><li style=";text-align:right;direction:rtl">  ุญูู ููุญูุงุช ุงูุชุญูู ููุน </li><li style=";text-align:right;direction:rtl">  ููููุฉ ุงุณุชุฎุฏุงู ุงูุชุฏุงุฏุงุช ุงูุชุญูู ูู ุงููุชุงุจุฉ ูุฌุนู ุงูุตูุฏูู ูุนุงู </li></ul><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ุชุฎูู ูุง ุนููู ุงูููุงู ุจู ุญุชู ูุชููู ุงููุณุชุฎุฏู ูู ุญุณุงุจ ุงูุชุนุจูุฑุงุช ุงูุฑูุงุถูุฉ.  ูุชูุซู ุฃุญุฏ ุฎูุงุฑุงุช ุงูุชุทุจูู ูู ุชุถููู DSL ุฏุงุฎูู ุ ูุฅูุดุงุก ูุญูู ุ ูุฃุฎูุฑุง ูุชุฑุฌู ููุฐู ุงูุชุนุจูุฑุงุช.  ููููุงู ุจุฐูู ุ ุจุงูุทุจุน ุ ุณูููู ุนููู ุงูุนูู ุ ูููู ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุฒูุงุฏุฉ ุงูุฅูุชุงุฌูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนู ุทุฑูู ุฅูุดุงุก ุฑูุฒ ุซุงููู ููุชุนุจูุฑุงุช ุจุฏูุงู ูู ุญุณุงุจูุง ูู ุงููุชุฑุฌู ุงูุดููู ุฃู ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุคูุช ูููุฆุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ูู ููุช ุงูุชุดุบูู ุ ูุฅู Groovy ูุนุฏ ุฎูุงุฑูุง ุฑุงุฆุนูุง. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช ุงูููุถุญุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ุ ูููู ุงููุซุงู ุงูุฃุจุณุท ูู ูุฌุฑุฏ ุงุณุชุฎุฏุงู ูุฆุฉ <code>Eval</code> : </p><br><p style=";text-align:right;direction:rtl"> <code>Example.java</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = (Integer) Eval.me(<span class="hljs-string"><span class="hljs-string">"1+1"</span></span>);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชู ุชุญููู ุงูููุฏ <code>1+1</code> ุ ูุชุฌููุนู ูู ุงูููุฏ ุงูุซูุงุฆู ุ ูุชุญูููู ูุชูููุฐู ุจูุงุณุทุฉ Groovy ูู ููุช ุงูุชุดุบูู.  ุจุงูุทุจุน ุ ุงูููุฏ ุงูููุฌูุฏ ูู ูุฐู ุงูุนููุฉ ุจุณูุท ููุบุงูุฉ ุ ูุณุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุนููุงุช ุ ููู ุงูููุฑุฉ ุฃู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุงุจูุฉ ููุชูููุฐ ูููู ุฃู ุชููู ุนุดูุงุฆูุฉ.  ููุฐุง ูุฏ ูุง ูููู ุจุงูุถุจุท ูุง ุชุญุชุงุฌู.  ูู ุงูุขูุฉ ุงูุญุงุณุจุฉ ุชุญุชุงุฌ ุฅูู ุงูุณูุงุญ ุจุดูุก ูู ูุฐุง ุงููุจูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">1+1 x+y 1+(2*x)**y cos(alpha)*r v=1+x</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููู ุจุงูุชุฃููุฏ ูุง </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">println 'Hello' (0..100).each { println 'Blah' } Pong p = new Pong() println(new File('/etc/passwd').text) System.exit(-1) Eval.me('System.exit(-1)') // a script within a script!</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุง ุชุจุฏุฃ ุงูุตุนูุจุงุช ุ ููุชุถุญ ุฃูุถูุง ุฃููุง ุจุญุงุฌุฉ ุฅูู ุญู ุงูุนุฏูุฏ ูู ุงููุดููุงุช: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญุตุฑ ููุงุนุฏ ุงููุบุฉ ูู ูุฌููุนุฉ ูุฑุนูุฉ ูู ูุฏุฑุงุชูุง </li><li style=";text-align:right;direction:rtl">  ููุน ุงููุณุชุฎุฏููู ูู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ </li><li style=";text-align:right;direction:rtl">  ููุน ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุถุงุฑุฉ </li></ul><br><p style=";text-align:right;direction:rtl">  ุงููุซุงู ูุน ุงูุขูุฉ ุงูุญุงุณุจุฉ ุจุณูุท ููุบุงูุฉ ุ ููู ุจุงููุณุจุฉ ุฅูู DSL ุงูุฃูุซุฑ ุชุนููุฏูุง ุ ูุฏ ูุง ููุงุญุธ ุงูุฃุดุฎุงุต ุฃููู ููุชุจูู ุฑูุฒูุง ุฅุดูุงูููุง ุ ุฎุงุตุฉู ุฅุฐุง ูุงูุช DSL ุจุณูุทุฉ ุฌุฏูุง ุจุญูุซ <em>ูุง</em> ูุณุชุทูุน <em>ุงููุทูุฑูู</em> ุงุณุชุฎุฏุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุจู ุจุถุน ุณููุงุช ููุช ูู ูุฐู ุงูุญุงูุฉ.  ููุฏ ููุช ุจุชุทููุฑ ูุญุฑู ูููู ุจุชุดุบูู "ูุตูุต" ุฑุงุฆุนุฉ ูู Groovy ูุชุจูุง ุนููุงุก ุงููุบุฉ.  ูุดููุฉ ูุงุญุฏุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุฃููุง ูููู ุฃู ุชุฎูู ุนู ุบูุฑ ูุตุฏ ุญููุฉ ูุง ููุงูุฉ ููุง.  ุชู ุชูููุฐ ุงูููุฏ ุนูู ุงูุฎุงุฏู ุ ูุธูุฑ ูุคุดุฑ ุชุฑุงุจุท ููุชูู 100ูช ูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ูุจุนุฏ ุฐูู ูุงู ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ุชุดุบูู ุฎุงุฏู ุงูุชุทุจูู.  ุงุถุทุฑุฑุช ููุจุญุซ ุนู ุทุฑููุฉ ูุญู ุงููุดููุฉ ุฏูู ุงูุชุฃุซูุฑ ุนูู DSL ุฃู ุงูุฃุฏูุงุช ุฃู ุฃุฏุงุก ุงูุชุทุจูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูุซูุฑ ูู ุงููุงุณ ูุฏููู ุงุญุชูุงุฌุงุช ููุงุซูุฉ.  ุฎูุงู ุงูุณููุงุช ุงูุฃุฑุจุน ุงููุงุถูุฉ ุ ููุช ุฃุชุญุฏุซ ูุน ุงููุซูุฑ ูู ุงูุฃุดุฎุงุต ุงูุฐูู ูุฏููู ููุณ ุงูุณุคุงู: <em>ููู ูููููู ููุน ุงููุณุชุฎุฏููู ูู ุงูููุงู ุจูุฑุงุก ูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู Groovyุ</em> </p><br><h2 id="kastomayzery-kompilyacii" style=";text-align:right;direction:rtl">  ุงููุฌูุนูู ุงูุชุฎุตูุต </h2><br><p style=";text-align:right;direction:rtl">  ูู ุฐูู ุงูููุช ุ ูุงู ูุฏู ุจุงููุนู ูุฑุงุฑู ุงูุฎุงุต ูููุช ุฃุนุฑู ุฃู ุงูุขุฎุฑูู ูุฏ ุทูุฑูุง ุดูุฆูุง ูุดุงุจููุง.  ูู ุงูููุงูุฉ ุ ุงูุชุฑุญ Guillaume Laforge ุฃู ุฃููู ุจุฅูุดุงุก ุขููุฉ ูู ููุงุฉ Groovy ูููุณุงุนุฏุฉ ูู ุญู ูุฐู ุงููุดููุงุช.  ุธูุฑ ูู Groovy 1.8.0 ููุฎุตุตุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฑุฌูุฉ</a> . </p><br><p style=";text-align:right;direction:rtl">  ุฃุฏูุงุช ุชุฎุตูุต ุงูุชุฌููุน ูู ูุฌููุนุฉ ูู ุงููุฆุงุช ุงูุชู ุชููู ุจุชุนุฏูู ุนูููุฉ ุงูุชุญููู ุงูุจุฑูุฌู ููุจุฑุงูุฌ ุงููุตูุฉ ูู Groovy.  ููููู ูุชุงุจุฉ ุงููุฎุตุต ุงูุฎุงุต ุจู ุ ูููู ููุงุฒู Groovy: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชูุฑุงุฏ ุฃุฏุงุฉ ุชุฎุตูุต ุชุถูู ุงููุงุฑุฏุงุช ุฅูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ุถููููุง ุญุชู ูุง ูุญุชุงุฌ ุงููุณุชุฎุฏููู ุฅูู ุฅุถุงูุฉ ุฃูุตุงู ุงูุงุณุชูุฑุงุฏ </li><li style=";text-align:right;direction:rtl">  ุชุญูููุงุช AST (ุดุฌุฑุฉ ุณูุงู ุงูููุฎุต) ุ ููุง ูุชูุญ ูู ุฅุถุงูุฉ ุชุญูููุงุช AST ูุจุงุดุฑุฉ ุฅูู ุงูุจุฑุงูุฌ ุงููุตูุฉ </li><li style=";text-align:right;direction:rtl">  ุชุฃููู ูุฎุตุต AST ุชูููุฏ ุจููุงุช ููุงุนุฏ ุงููุบุฉ ูุจูุงุก ุงูุฌููุฉ ููุบุฉ </li></ul><br><p style=";text-align:right;direction:rtl">  ุณุงุนุฏูู ููุฎุตุตุงุช ุชุญูููุงุช AST ูู ุญู ูุดููุฉ ุงูุญููุฉ ุงูุชู ูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>@ThreadInterrupt</code></a> ูุน ุชุญูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>@ThreadInterrupt</code></a> ุ ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SecureASTCustomizer</a> ูู ุงูุดูุก ุงูุฐู ููุณุงุก ูููู ุนูู ุงูุฃุฑุฌุญ ูู ุงูุบุงูุจูุฉ ุงูุนุธูู ูู ุงูุญุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุฃุนุชุฐุฑ ุนู ุฐูู.  ุซู ูู ุฃุณุชุทุน ุงูุชูุตู ุฅูู ุงุณู ุฃูุถู.  ุงูุฌุฒุก ุงูุฃูุซุฑ ุฃูููุฉ ูู ุงุณู "SecureASTCustomizer" ูู <strong>AST</strong> .  ูุงู ุงูุบุฑุถ ูู ูุฐู ุงูุขููุฉ ูู ุงูุญุฏ ูู ุงููุตูู ุฅูู ุจุนุถ ูุธุงุฆู AST.  ูููุฉ "ุขููุฉ" ูู ุงูุนููุงู ุบูุฑ ุถุฑูุฑูุฉ ุจุดูู ุนุงู ุ ูุณุฃุดุฑุญ ูู ุงูุณุจุจ.  ููุงู ุญุชู ูุฏููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููููู</a> ูุงูุงุฌูุชุดู ุงูุดููุฑุฉ ูู ุฌูููููุฒ ุ ุจุนููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Fatal Groovy SecureASTCustomizer"</a> .  ููู ุดูุก ููุชูุจ ุจุดูู ุตุญูุญ ุฌุฏุง ููุงู.  ูู ูุชู ุชุตููู SecureASTCustomizer ูู ุฃุฌู ุตูุฏูู ุงูุญูุงูุฉ.  ุชู ุฅูุดุงุคู ููุญุฏ ูู ุงููุบุฉ ูู ููุช ุงูุชุฑุฌูุฉ ุ ูููู ููุณ ุงูุชูููุฐ.  ุงูุขู ุฃุนุชูุฏ ุฃู ุฃูุถู ุงุณู ุณูููู <em>GrammarCustomizer</em> .  ูููู ุ ููุง ุชุนูููู ุจุงูุชุฃููุฏ ุ ููุงู ุซูุงุซ ุตุนูุจุงุช ูู ุนููู ุงูููุจููุชุฑ: ุฅุจุทุงู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุงุฎุชุฑุงุน ุงูุฃุณูุงุก ุ ูุฎุทุฃ ููู ูุญุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุชุฎูู ุฃูู ุชููุฑ ูู ุชุฎุตูุต AST ุงูุขูู ููุณููุฉ ูุถูุงู ุฃูุงู ุงูุจุฑูุงูุฌ ุงููุตู ุ ููููุชู ูู ููุน ุงููุณุชุฎุฏู ูู <code>System.exit</code> ูู ุงูุจุฑูุงูุฌ ุงููุตู.  ุชุดูุฑ ุงููุซุงุฆู ุฅูู ุฃูู ูููู ุญุธุฑ ุงูููุงููุงุช ูู ุฃุฌูุฒุฉ ุงูุงุณุชูุจุงู ุงูุฎุงุตุฉ ุนู ุทุฑูู ุฅูุดุงุก ููุงุฆู ุณูุฏุงุก ุฃู ุจูุถุงุก.  ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ููุฃูุงู ุ ูุฅููู ุฃูุตู ุฏุงุฆููุง ุจุงูููุงุฆู ุงูุจูุถุงุก ุงูุชู ุชุญุฏุฏ ุจุฏูุฉ ูุง ูู ูุณููุญ ุจู ุ ูููู ููุณ ููุงุฆู ุณูุฏุงุก ุชุญุธุฑ ุฃู ุดูุก.  ูุฃู ุงููุชุณูููู ูููุฑูู ุฏุงุฆููุง ูู ูุง ูุฏ ูุง ุชููุฑ ููู.  ุณุฃูุฏู ูุซุงูุง. </p><br><p style=";text-align:right;direction:rtl">  ูููุง ููู ููููุฉ ุฅุนุฏุงุฏ ูุดุบู ูุตูุต ุฑูู ุจุฏุงุฆู ุจุงุณุชุฎุฏุงู <code>SecureASTCustomizer</code> .  ุนูู ุงูุฑุบู ูู ุฃููู ุฃุณุชุทูุน ูุชุงุจุชูุง ูู Groovy ุ ุฅูุง ุฃููู ุฃุนุทูุช ุฃูุซูุฉ ูุชูููู Java ูุฌุนู ุงููุฑู ุจูู ุฑูุฒ ุงูุชูุงูู ูุงูุจุฑุงูุฌ ุงููุตูุฉ ุฃูุซุฑ ูุถูุญูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sandbox</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ CompilerConfiguration conf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CompilerConfiguration(); SecureASTCustomizer customizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecureASTCustomizer(); customizer.setReceiversBlackList(Arrays.asList(System.class.getName())); conf.addCompilationCustomizers(customizer); GroovyShell shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GroovyShell(conf); Object v = shell.evaluate(<span class="hljs-string"><span class="hljs-string">"System.exit(-1)"</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"Result = "</span></span> +v); } }</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุชูููู ุงููุชุฑุฌู </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุขููุฉ ูุฎุตุตุฉ AST </li><li style=";text-align:right;direction:rtl">  ุงูุฅุนูุงู ุนู ุฅุฏุฑุงุฌ ูุฆุฉ <code>System</code> ููุณุชูุจู ูููุงููุงุช ุงูุทุฑููุฉ </li><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ูุฎุตุต ูุชูููู ุงููุชุฑุฌู </li><li style=";text-align:right;direction:rtl">  ุฑุจุท ุงูุชูููู ูุน ุงูุจุฑูุงูุฌ ุงููุตู shell ุ ุฃู ูุญุงููุฉ ุฅูุดุงุก ุฑูู </li><li style=";text-align:right;direction:rtl">  ูู ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู "ุงูุณูุฆ" </li><li style=";text-align:right;direction:rtl">  ุนุฑุถ ูุชูุฌุฉ ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู </li></ol><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุชุดุบูู ูุฐู ุงููุฆุฉ ุ ูุณูุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชูููุฐ ุงูุจุฑูุงูุฌ ุงููุตู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">General error during canonicalization: Method calls not allowed on [java.lang.System] java.lang.SecurityException: Method calls not allowed on [java.lang.System]</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชู ุฅุตุฏุงุฑ ูุฐุง ุงูุงุณุชูุชุงุฌ ุจูุงุณุทุฉ ุชุทุจูู ูุฒูุฏ ุจูุฎุตุต AST ุขูู ุ ูุงูุฐู ูุง ูุณูุญ ุจุชูููุฐ ุฃุณุงููุจ ูุฆุฉ <code>System</code> .  ุงููุฌุงุญ!  ูุฐูู ูููุง ุจุญูุงูุฉ ุงูุณููุงุฑูู ูุฏููุง!  ููู ุงูุชุธุฑ ูุญุธุฉ ... </p><br><h2 id="secureastcustomizer-vzloman" style=";text-align:right;direction:rtl">  ุชู ุงุฎุชุฑุงู SecureASTCustomizer! </h2><br><p style=";text-align:right;direction:rtl">  ุญูุงูุฉ ุ ูููููุ  ูููู ูุงุฐุง ูู ูุนูุช ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">def c = System c.exit(-<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุชุดุบูู ุงูุจุฑูุงูุฌ ูุฑุฉ ุฃุฎุฑู ุ ูุณุชุฑู ุฃูู ูุชุนุทู <strong>ุจุฏูู</strong> ุฎุทุฃ <strong>ูุฏูู</strong> ุนุฑุถ ุงููุชูุฌุฉ ุนูู ุงูุดุงุดุฉ.  ุฑูุฒ ุฎุฑูุฌ ุงูุนูููุฉ ูู -1 ุ ููุง ูุนูู ุฃูู ุชู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูููุณุชุฎุฏู!  ูุงุฐุง ุญุฏุซ  ูู ููุช ุงูุชุฑุฌูุฉ ุ ูุชุนุฐุฑ ุนูู ุฃุฏุงุฉ ุชุฎุตูุต AST ุงูุขููุฉ ุฅุฏุฑุงู ุฃู <code>c.exit</code> ูู ุงุณุชุฏุนุงุก ูุทุฑููุฉ <code>System</code> ุญูุซ ุงููุจุฏุฃ ูุฃููุง ุชุนูู ุนูู ูุณุชูู AST!  ูุญูู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ ุ ููู ูุฐู ุงูุญุงูุฉ ุ ุงุณุชุฏุนุงุก ุงูุฃุณููุจ <code>c.exit(-1)</code> ุ ุซู ูุญุฏุฏ ุฌูุงุฒ ุงูุงุณุชูุจุงู ููุชุญูู ููุง ุฅุฐุง ูุงู <code>c.exit(-1)</code> ูู ุงููุงุฆูุฉ ุงูุจูุถุงุก (ุฃู ุงูุณูุฏุงุก).  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุงููุชููู <code>c</code> ุ ููุชู <strong>ุงูุฅุนูุงู ุนู</strong> ูุฐุง ุงููุชุบูุฑ <strong>ุนุจุฑ def</strong> ุ ููุฐุง ูู ููุณู ุงูุชุตุฑูุญ ุนูู <code>Object</code> ุ <code>Object</code> ุฃุฏุงุฉ ุชุฎุตูุต AST ุงูุขููุฉ ุฃู ููุน ุงููุชุบูุฑ <code>c</code> ูู <code>Object</code> ุ ูููุณ <code>System</code> ! </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ููุงู <strong>ุงูุนุฏูุฏ ูู</strong> ุงูุทุฑู ููุชุบูุจ ุนูู ุงูุชููููุงุช ุงููุฎุชููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุนูู ูุฎุตุต AST ุงูุขูู.  ุฅูููู ุจุนุถ ุงูุฃุดูุงุก ุงูุฑุงุฆุนุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">((Object)System).exit(-<span class="hljs-number"><span class="hljs-number">1</span></span>) Class.forName(<span class="hljs-string"><span class="hljs-string">'java.lang.System'</span></span>).exit(-<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-string"><span class="hljs-string">'java.lang.System'</span></span> as Class).exit(-<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> java.lang.System.<span class="hljs-function"><span class="hljs-function">exit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููููู ุฃู ูููู ููุงู <strong>ุงููุซูุฑ</strong> .  ุงูุทุจูุนุฉ ุงูุฏููุงููููุฉ ูู Groovy ุชุญูู ุฏูู ุงููุฏุฑุฉ ุนูู ุญู ูุฐู ุงููุดููุงุช ูู ููุช ุงูุชุฑุฌูุฉ.  ููุน ุฐูู ุ ููุฌุฏ ุญู.  ุฃุญุฏ ุงูุฎูุงุฑุงุช ูู ุงูุงุนุชูุงุฏ ุนูู ูุฏูุฑ ุฃูุงู JVM ุงูููุงุณู.  ููุน ุฐูู ุ ูุฐุง ูู ุงูุญู ุงูุซููู ูุงููุฒู ุงูุถุฎู ุนูู ุงูููุฑ ูููุธุงู ุจุฃูููู ุ ููุฐุง ูุนุงุฏู ุฅุทูุงู ูุฏูุน ูู ุงูุนุตุงููุฑ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ูุนูู ูู ุฌููุน ุงูุญุงูุงุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุช ุชุฑุบุจ ูู ุญุธุฑ ูุฑุงุกุฉ ุงููููุงุช ุ ูููู ูุง ุชูุดุฆ ... </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุงูููุฏ - ุจุงูุฃุญุฑู ูุฆูุจุฉ ูููุซูุฑูู ููุง - ุฃุฏู ุฅูู ุฅูุฌุงุฏ ุญู ูุนุชูุฏ ุนูู <strong>ุงูุดููุงุช ูู ููุช ุงูุชุดุบูู</strong> .  ูุฐุง ุงูููุน ูู ุงููุญุต ููุณ ูุฏูู ูุซู ูุฐู ุงููุดุงูู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฃูู ุณุชุนุฑู ููุน ุงููุณุชูุจู ุงููุนูู ููุฑุณุงูุฉ ูุจู ุงูุจุฏุก ูู ุงูุชุญูู ูู ุตุญุฉ ุงุณุชุฏุนุงุก ุงูุฃุณููุจ.  ุฐุงุช ุฃูููุฉ ุฎุงุตุฉ ูู ุงูุชุทุจููุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="">SecureScript</a> ูุฌูู ูุงูุช </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุงุฆุน Sandbox</a> ุจูุงุณุทุฉ Kosuke Kawaguchi </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุงุฆุน ุฑูู</a> ุจูุงุณุทุฉ ุณูููู ูุนุจุฏ </li></ul><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูุฅู ุฃูุง ูู ูุฐู ุงูุชุทุจููุงุช ููุซููุฉ ูุขููุฉ ุชูุงูุง.  ุนูู ุณุจูู ุงููุซุงู ุ ูุนุชูุฏ ุฅุตุฏุงุฑ Kosuke ุนูู ุงุฎุชุฑุงู ุงูุชุทุจูู ุงูุฏุงุฎูู ููููุน ุงุณุชุฏุนุงุก ุงูุชุฎุฒูู ุงููุคูุช.  ุงููุดููุฉ ูู ุฃูู ุบูุฑ ูุชูุงูู ูุน ุฅุตุฏุงุฑ invokedynamic ูู Groovy ุ ููู ุชููู ูุฐู ุงููุฆุงุช ุงูุฏุงุฎููุฉ ูู ุงูุฅุตุฏุงุฑุงุช ุงููุณุชูุจููุฉ ูู Groovy.  ูุณุฎุฉ ุณูููู ุ ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุชุนุชูุฏ ุนูู ุชุญูููุงุช AST ุ ูููููุง ุชุชุฑู ุงูุนุฏูุฏ ูู ุงูุซููุจ ุงููุญุชููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุชูุฌุฉ ูุฐูู ุ ูุฑุฑุช ุฃูุง ูุฃุตุฏูุงุฆู Corinne Crisch ู Fabrice Matrat ู Sebastian Blanc ุ ุฅูุดุงุก ุขููุฉ ุฌุฏูุฏุฉ ูุตูุงุฏูู ุงูุฑูู ูู ููุช ุงูุชุดุบูู ุ ูุงูุชู ูู ุชูุงุฌู ูุดููุงุช ูุซู ูุฐู ุงููุดุงุฑูุน.  ุจุฏุฃูุง ูู ุชูููุฐู ูู ูุงูุงุซูู ูู ููุณ ุ ููู ูุคุชูุฑ ุบุฑูุชุด ูู ุงูุนุงู ุงููุงุถู ูุฏููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฑูุฑุงู ุนูู</a> .  ุชุนุชูุฏ ูุฐู ุงูุขููุฉ ุนูู ุชุญูููุงุช AST ูุชุนูุฏ ูุชุงุจุฉ ุงูููุฏ ุจุดูู ุฃุณุงุณู ููุชุญูู ูุจู ูู ุงุณุชุฏุนุงุก ููุทุฑููุฉ ุ ููุญุงููุฉ ุงููุตูู ุฅูู ุญูู ุงููุตู ุ ูุฒูุงุฏุฉ ูุชุบูุฑ ุ ุชุนุจูุฑ ุซูุงุฆู ... ูุฐุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุทุจูู</a> ูุง ูุฒุงู ุบูุฑ ุฌุงูุฒ ุ ููู ูุชู ุฅูุฌุงุฒ ุงููุซูุฑ ูู ุงูุนูู ุนููู ุ ูุฐูู ููุง ุฃุฏุฑูุช ุฃู ูุดููุฉ ุงูุทุฑู ูุงููุนููุงุช ุงูุชู ุชู ุงุณุชุฏุนุงุคูุง ูู ุฎูุงู "ุถููู ูุฐุง" ูู ูุชู ุญููุง ุจุนุฏ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูุจูุงุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">xml { cars { // cars is a method call on an implicit this: "this".cars(...) car(make:'Renault', model: 'Clio') } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุชู ุงูุขู ุ ูุง ุฒูุช ูู ุฃุฌุฏ ุทุฑููุฉ ูุญู ูุฐู ุงููุดููุฉ ุจุณุจุจ ุจููุฉ ุจุฑูุชูููู ูุงุฆู ุงูุชุนุฑูู ูู Groovy ุ ูุงูุชู ุชุณุชูุฏ ุฅูู ุญูููุฉ ุฃู ุงููุชููู ูููู ุงุณุชุซูุงุกู ุนูุฏูุง ูุชุนุฐุฑ ุนููู ุงูุนุซูุฑ ุนูู ุงูุทุฑููุฉ ุ ูุจู ุงูุชุจุฏูู ุฅูู ูุณุชูุจู ุขุฎุฑ.  ุจุงุฎุชุตุงุฑ ุ ูุฐุง ูุนูู ุฃูู ูุง ููููู ูุนุฑูุฉ ููุน ุฌูุงุฒ ุงูุงุณุชูุจุงู ูุจู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ ุงููุนูู.  ูุฅุฐุง ูุฑุช ุงูููุงููุฉ ุ ููุงุช ุงูุฃูุงู ... </p><br><p style=";text-align:right;direction:rtl">  ูุญุชู ููุช ูุฑูุจ ุ ูู ููู ูุฏู ุญู ูุซุงูู ููุฐู ุงููุดููุฉ ููุญุงูุฉ ุงูุชู ูุณุชุฎุฏู ูููุง ุงูุจุฑูุงูุฌ ุงููุตู ุงููุงุจู ููุชูููุฐ ุงูุฎุตุงุฆุต ุงูุฏููุงููููุฉ ููุบุฉ.  ูููู ุงูุขู ุญุงู ุงูููุช ูุดุฑุญ ููู ููููู ุชุญุณูู ุงููููู ุจุดูู ูุจูุฑ ุฅุฐุง ููุช ูุณุชุนุฏูุง ููุชุถุญูุฉ ููููุงู ูู ุฏููุงููููุฉ ุงููุบุฉ. </p><br><h2 id="proverka-tipov" style=";text-align:right;direction:rtl">  ุงูุชุจ ุงูุชุญูู </h2><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุนูุฏ ุฅูู ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ูู SecureASTCustomizer: ุฅูู ูุนูู ูุน ุดุฌุฑุฉ ุจูุงุก ุฌููุฉ ูุฌุฑุฏุฉ ูููุณ ูุฏูู ูุนูููุงุช ุญูู ุฃููุงุน ุงูุฑุณุงุฆู ูุฃุฌูุฒุฉ ุงูุงุณุชูุจุงู ุงููุญุฏุฏุฉ.  ูููู ูุน Groovy 2 ุ ุฃุถุงู Groovy ุชุตููููุง ุ ููู Groovy 2.1 ุฃุถููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุญูุงุช ููุญุต ุงูููุน</a> . </p><br><p style=";text-align:right;direction:rtl">  ุชุนุฏ ุงูุฅูุชุฏุงุฏุงุช ููุญุต ุงูููุน ุฃูุฑูุง ููููุง ููุบุงูุฉ: ููู ุชุณูุญ ููุทูุฑ Groovy DSL ุจูุณุงุนุฏุฉ ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ุจุงุณุชูุชุงุฌ ุงููุชุงุจุฉ ุ ููุง ูุณูุญ ุฃูุถูุง ุจุฅูุดุงุก ุฃุฎุทุงุก ุงูุชุญููู ุงูุจุฑูุฌู ูู ุงูุญุงูุงุช ุงูุชู ูุง ุชุญุฏุซ ูููุง ุนุงุฏุฉู.  ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงูููุญูุงุช ุฏุงุฎูููุง ุจูุงุณุทุฉ Groovy ูุฏุนู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ุงูุซุงุจุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏ ุชูููุฐ ุงูุณูุงุช ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุฑู ูุงูุจ ุงูุนูุงูุงุช</a> . </p><br><p style=";text-align:right;direction:rtl">  ูุงุฐุง ูู ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ูุชุงุฆุฌ ุงููุญูู ุงููุบูู ุ ูููููุง ุงูุงุนุชูุงุฏ ุนูู ูุนูููุงุช ูู ุขููุฉ ุงูุชุญูู ูู ุงูููุนุ  ุฎุฐ ุงูููุฏ ุงูุฐู ุญุงูู ุฃุญุฏ ุงููุชุณูููู ูุชุงุจุชู: </p><br><p style=";text-align:right;direction:rtl"> <code>((Object)System).exit(-1)</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุชูุดูุท ุงุฎุชุจุงุฑุงุช ุงููุชุงุจุฉ ุ ููู ูุชู ุชุฌููุน ุงูุดูุฑุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">1 compilation error: [Static type checking] - Cannot find matching method java.lang.Object#exit(java.lang.Integer). Please check if the declared type is right and if the method exists.</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ูุฐุง ุงูุฑูุฒ ูู ูุนุฏ ูุฌูุน.  ููุงุฐุง ูู ุฃุฎุฐูุง ูุฐุง ุงูููุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">def c = System c.exit(-<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ุ ูุฌุชุงุฒ ุงุฎุชุจุงุฑ ุงูููุน ุ ููููููุง ุจุทุฑููุฉ ููุชู ุชูููุฐู ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>groovy</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@groovy</span></span>.transform.TypeChecked <span class="hljs-comment"><span class="hljs-comment">// or even @CompileStatic void foo() { def c = System c.exit(-1) } foo()</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุดู ูุฏูู ุงูููุน ุฃู ุทุฑููุฉ <code>exit</code> ุชุณูู ูู ูุฆุฉ <code>System</code> ูุฃููุง ุตุงูุญุฉ.  ูุฐุง ูู ูุณุงุนุฏูุง ููุง.  ููู ูุง ูุนุฑูู ูู ุฃูู ุฅุฐุง ูุฌุญ ูุฐุง ุงูุฑูุฒ ูู ุงูุชุญูู ูู ุงูููุน ุ ููุฐุง ูุนูู ุฃู ุงููุชุฑุฌู ูุชุนุฑู ุนูู ุงูููุงููุฉ ุฅูู ุงููุชููู ุจุงูููุน <code>System</code> .  ุจุดูู ุนุงู ุ ุชุชูุซู ุงูููุฑุฉ ูู ุญุธุฑ ููุงููุฉ ุฐุงุช ุงูุชุฏุงุฏ ููุญุต ุงูููุน. </p><br><h2 id="prostoe-rasshirenie-dlya-proverki-tipov" style=";text-align:right;direction:rtl">  ุชูุฏูุฏ ุจุณูุท ููุญุต ุงูููุน </h2><br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุฎูุถ ูู ูุถุน ุงูุญูุงูุฉ ูู ุงูุชูุงุตูู ุ ุฏุนููุง ูุญุงูู "ุชุฃููู" ูุตูุง ุจูุณุงุนุฏุฉ ููุญู ููุงุณู ููุญุต ุงููุชุงุจุฉ.  ูุณูู ุชุณุฌูู ูุฐุง ุงูุงูุชุฏุงุฏ: ููุท ูู ุจุชุนููู ุงููุนููุฉ <code>extensions</code> <code>@TypeChecked</code> ุงูุชูุถูุญู <code>@TypeChecked</code> (ุฃู <code>@CompileStatic</code> ุฅุฐุง ููุช ุชุณุชุฎุฏู <code>@CompileStatic</code> ุงูุจุฑูุฌู ุงูุซุงุจุช): </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@TypeChecked</span></span>(extensions=[<span class="hljs-string"><span class="hljs-string">'SecureExtension1.groovy'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ def c = System c.exit(-<span class="hljs-number"><span class="hljs-number">1</span></span>) } foo()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณุชุชู ุนูููุฉ ุงูุจุญุซ ุนู ุงูุฅุถุงูุงุช ูู classpath ุจุชูุณูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ (ููููู ุฅูุดุงุก ููุญูุงุช ุชู ุชุฌููุนูุง ูุณุจููุง ููุชุญูู ูู ุงูููุน ุ ููููุง ูู ูุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ูู ูุฐู ุงูููุงูุฉ): </p><br><p style=";text-align:right;direction:rtl"> <code>SecureExtension1.groovy</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">onMethodSelection { expr, methodNode -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (methodNode.declaringClass.name==<span class="hljs-string"><span class="hljs-string">'java.lang.System'</span></span>) { addStaticTypeError(<span class="hljs-string"><span class="hljs-string">"Method call is not allowed!"</span></span>, expr) } }</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุฎุชุงุฑ ุงููุฏูู ุทุฑููุฉ ููุงุชุตุงู </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ุงูุทุฑููุฉ ุชูุชูู ุฅูู <code>System</code> ุงููุตู </li><li style=";text-align:right;direction:rtl">  ุซู ุงุณูุญ ูููุฏูู ุจุฅูุดุงุก ุฎุทุฃ </li></ol><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูู ูุง ุชุญุชุงุฌู.  ุงูุขู ูู ุจุชุดุบูู ุงูููุฏ ูุฑุฉ ุฃุฎุฑู ูุณุชุฑู ุฎุทุฃู ูู ุงูุชุฑุฌูุฉ! </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">/home/cchampeau/tmp/securetest.groovy: 6: [Static type checking] - Method call is not allowed! @ line 6, column 3. c.exit(-1) ^ 1 error</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐู ุงููุฑุฉ ุ ูุจูุถู type checker ุ <code>c</code> ุงูุชุนุฑู ุนูู <code>c</code> ููุซูู ููุฆุฉ <code>System</code> ุ ููููููุง ููุน ุงูููุงููุฉ.  ูุฐุง ูุซุงู ุจุณูุท ููุบุงูุฉ ุ ููุง ููุถุญ ูู ูุง ูููู ุงูููุงู ุจู ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ ุชุฎุตูุต AST ุงูุขููุฉ ูู ุญูุซ ุงูุชูููู.  ูู ุงูุฅุถุงูุฉ ุงูุชู <strong>ูุชุจูุงูุง</strong> ุ ุชููู ุงูุดููุงุช ูุถููุฉ ุ ูููู ูุฏ ูููู ูู ุงูุฃูุถู ุฌุนููุง ูุงุจูุฉ ููุชุฎุตูุต.  ูุฐูู ุฏุนููุง ูุฌุนู ุงููุซุงู ุฃูุซุฑ ุชุนููุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุฑุถ ุฃู ุชุทุจููู ูุญุณุจ ููุงููุณ ูุนููุฉ ูููุณุชูุฏ ููุณูุญ ูููุณุชุฎุฏููู ุจุชุฎุตูุตูุง.  ูู ูุฐู ุงูุญุงูุฉ ุ DSL: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณูู ุชุนูู (ุนูู ุงูุฃูู) ูุชุบูุฑ <code>score</code> </li><li style=";text-align:right;direction:rtl">  ูุณูุญ ูููุณุชุฎุฏููู ุจุฅุฌุฑุงุก ุนูููุงุช ุฑูุงุถูุฉ (ุจูุง ูู ุฐูู ุงุณุชุฏุนุงุก ุฃุณุงููุจ <em>cos</em> ู <em>abs</em> ู ...) </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููุน ุฌููุน ุงูุฃุณุงููุจ ุงูุฃุฎุฑู </li></ul><br><p style=";text-align:right;direction:rtl">  ูููุฐุฌ ุงูุจุฑูุงูุฌ ุงููุตู ูููุณุชุฎุฏู: </p><br><p style=";text-align:right;direction:rtl"> <code>abs(cos(1+score))</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุฐุง DSL ุณูู ุงูุชูููู.  ูุฐุง ูู ุงูุจุฏูู ููุง ุญุฏุฏูุงู ุฃุนูุงู: </p><br><p style=";text-align:right;direction:rtl"> <code>Sandbox.java</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">CompilerConfiguration conf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CompilerConfiguration(); ImportCustomizer customizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImportCustomizer(); customizer.addStaticStars(<span class="hljs-string"><span class="hljs-string">"java.lang.Math"</span></span>); conf.addCompilationCustomizers(customizer); Binding binding = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Binding(); binding.setVariable(<span class="hljs-string"><span class="hljs-string">"score"</span></span>, <span class="hljs-number"><span class="hljs-number">2.0</span></span>d); GroovyShell shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GroovyShell(binding,conf); Double userScore = (Double) shell.evaluate(<span class="hljs-string"><span class="hljs-string">"abs(cos(1+score))"</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"userScore = "</span></span> + userScore);</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ุฃุฏุงุฉ ุชุฎุตูุต ุงูุงุณุชูุฑุงุฏ ุงูุชู ุณุชุถูู <code>import static java.lang.Math.*</code> ุฅูู ุฌููุน ุงูุจุฑุงูุฌ ุงููุตูุฉ </li><li style=";text-align:right;direction:rtl">  ุฌุนู ูุชุบูุฑ <code>score</code> ุงููุชุงุญุฉ ููุจุฑูุงูุฌ ุงููุตู </li><li style=";text-align:right;direction:rtl">  ุชูููุฐ ุงูุจุฑูุงูุฌ ุงููุตู </li></ol><br><p style=";text-align:right;direction:rtl">  <em>ููุงู ุทุฑู ูุชุฎุฒูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูุคูุชูุง ุจุฏูุงู ูู ุชุญููููุง ูุชุฌููุนูุง ูู ูู ูุฑุฉ.</em>  <em>ุงูุธุฑ ุงููุซุงุฆู ููุญุตูู ุนูู ุงูุชูุงุตูู.</em> </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุนูู ุงูุจุฑูุงูุฌ ุงููุตู ุงูุฎุงุต ุจูุง ุ ูููู ูุง ุดูุก ูููุน ุงููุชุณูู ูู ุฅุทูุงู ุชุนูููุงุช ุจุฑูุฌูุฉ ุถุงุฑุฉ.  ูุธุฑูุง ูุฃููุง ูุฎุทุท ูุงุณุชุฎุฏุงู ุงูุชุญูู ูู ุงูููุน ุ ุฃูุตู ุจุงุณุชุฎุฏุงู ุชุญููู <code>@CompileStatic</code> : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูู ููุดุท ุนูููุฉ ุชุฏููู ุงููุชุงุจุฉ ูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุณูููู ูุงุฏุฑูู ุนูู ุฅุฌุฑุงุก ุนูููุงุช ูุญุต ุฅุถุงููุฉ ุจูุถู ุงูุงูุชุฏุงุฏ ููุญุต ุงููุชุงุจุฉ </li><li style=";text-align:right;direction:rtl">  ุชุญุณูู ุฃุฏุงุก ุงูุจุฑูุงูุฌ ุงููุตู </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุงูุณูู ุฌุฏูุง ุฅุถุงูุฉ ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ <code>@CompileStatic</code> ุฅูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ุงูุฎุงุตุฉ ุจู.  ุชุญุชุงุฌ ููุท ุฅูู ุชุญุฏูุซ ุชูููู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">ASTTransformationCustomizer astcz = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ASTTransformationCustomizer(CompileStatic.class); conf.addCompilationCustomizers(astcz);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฅุฐุง ุญุงููุช ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูุฑุฉ ุฃุฎุฑู ุ ุณุชุฑู ุฎุทุฃ ูู ุงูุชุญููู ุงูุจุฑูุฌู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Script1.groovy: 1: [Static type checking] - The variable [score] is undeclared. @ line 1, column 11. abs(cos(1+score)) ^ Script1.groovy: 1: [Static type checking] - Cannot find matching method int#plus(java.lang.Object). Please check if the declared type is right and if the method exists. @ line 1, column 9. abs(cos(1+score)) ^ 2 errors</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุฐุง ุญุฏุซ  ุฅุฐุง ูุฑุฃุช ุงูุจุฑูุงูุฌ ุงููุตู ูู ูุฌูุฉ ูุธุฑ ุงููุชุฑุฌู ุ ูุตุจุญ ูุงุถุญูุง ุฃูู ูุง ูุนุฑู ุดูุฆูุง ุนู "ุงููุชูุฌุฉ" ุงููุชุบูุฑุฉ.  <strong>ูููู ุ</strong> ููุทูุฑ ุ ุชุนูู ุฃู ูุฐุง ูุชุบูุฑ <code>double</code> ุ ููู ุงููุชุฑุฌู ูุง ููููู ุฅุฎุฑุงุฌู.  ููุฐุง ุงูุบุฑุถ ุ ูุชู ุฅูุดุงุก ููุญูุงุช ููุชุญูู ูู ุงูููุน: ููููู ุฅุนุทุงุก ุงููุชุฑุฌู ูุนูููุงุช ุฅุถุงููุฉ ุ ูุณุชุนูู ุงูุชุฑุฌูุฉ ุจุดูู ุฌูุฏ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุญุชุงุฌ ุฅูู ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ูุชุบูุฑ <code>score</code> ูู ุงูููุน <code>double</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ููููู ุชุบููุฑ ุทุฑููุฉ <code>@CompileStatic</code> ุชุนููู ุชูุถูุญู <code>@CompileStatic</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">ASTTransformationCustomizer astcz = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ASTTransformationCustomizer( singletonMap(<span class="hljs-string"><span class="hljs-string">"extensions"</span></span>, singletonList(<span class="hljs-string"><span class="hljs-string">"SecureExtension2.groovy"</span></span>)), CompileStatic.class);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง "ูุญุงูู" ุงูููุฏ ุงููุดุฑูุญ ุจูุงุณุทุฉ <code>@CompileStatic(extensions=['SecureExtension2.groovy'])</code> .  ุงูุขู ุ ุจุงูุทุจุน ุ ูุญุชุงุฌ ุฅูู ูุชุงุจุฉ ููุญู ูุชุนุฑู ุนูู ูุชุบูุฑ <code>score</code> : </p><br><p style=";text-align:right;direction:rtl"> <code>SecureExtension2.groovy</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">unresolvedVariable { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>.name==<span class="hljs-string"><span class="hljs-string">'score'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> makeDynamic(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>, double_TYPE) } }</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ูุง ูููู ุชุญุฏูุฏ ูุฏูู ุงูููุน ุงููุชุบูุฑ </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุงุณู ุงููุชุบูุฑ ูู <code>score</code> </li><li style=";text-align:right;direction:rtl">  ุงุณูุญ ูููุชุฑุฌู ุจุชุนุฑูู ุงููุชุบูุฑ ุจุดูู ุญููู ุจููุน <code>double</code> </li></ol><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุนุซูุฑ ุนูู ูุตู ูุงูู ูููุญูุงุช DSL ููุญุต ุงูููุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ูุฐุง ุงููุณู ูู ุงููุซุงุฆู</a> ุ ูููู ููุงู ูุซุงู ุนูู ูุถุน ุงูุชุญููู ุงูุจุฑูุฌู ุงููุฏูุฌ: ูุง ูููู ูููุชุฑุฌู ุชุนุฑูู ูุชุบูุฑ <code>score</code> .  ุฃูุช ุ ููุทูุฑ DSL ุ <strong>ุชุนูู</strong> ุฃู ุงููุชุบูุฑ ูู ูู ุงููุงูุน ููุนู - <code>double</code> ุ ูุฐุง ูุฅู ุงูุฏุนูุฉ ุฅูู <code>makeDynamic</code> ููุง ูุชููู: "ุญุณููุง ุ ูุง ุชููู ุ ุฃุนุฑู ูุง ุฃููู ุจู ุ ูููู ุชุนุฑูู ูุฐุง ุงููุชุบูุฑ ุฏููุงูููููุง ุจููุน <code>double</code> ".  ูุฐุง ูู ุดุฆ! </p><br><h2 id="pervoe-zavershennoe-secure-rasshirenie" style=";text-align:right;direction:rtl">  ุงูุงูุชูุงุก ุฃููุง ุงูุชูุฏูุฏ "ุขููุฉ" </h2><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนููุง ูุถุน ูู ุฐูู ูุนุง.  ููุฏ ูุชุจูุง ููุญู ูุญุต ููุน ูุงุญุฏ ูููุน ุงูุงุชุตุงูุงุช ูุทุฑู ูุฆุฉ <code>System</code> ูู ุฌูุฉ ูุงูุขุฎุฑ ุงูุฐู ูุญุฏุฏ ูุชุบูุฑ <code>score</code> ูุงุญูุฉ ุฃุฎุฑู.  ูุฐูู ุ ุฅุฐุง ูุตููุงูู ุ ุณูุญุตู ุนูู ุฃูู ููุญู ูุงูู ููุญุต ุงูููุน: </p><br><p style=";text-align:right;direction:rtl"> <code>SecureExtension3.groovy</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// disallow calls on System onMethodSelection { expr, methodNode -&gt; if (methodNode.declaringClass.name=='java.lang.System') { addStaticTypeError("Method call is not allowed!", expr) } } // resolve the score variable unresolvedVariable { var -&gt; if (var.name=='score') { return makeDynamic(var, double_TYPE) } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุฐูุฑ ุฃู ุชููู ุจุชุญุฏูุซ ุงูุชูููู ูู ูุฆุฉ Java ูุงุณุชุฎุฏุงู ุงูููุญู ุงูุฌุฏูุฏ ููุญุต ุงูููุน: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">ASTTransformationCustomizer astcz = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ASTTransformationCustomizer( singletonMap(<span class="hljs-string"><span class="hljs-string">"extensions"</span></span>, singletonList(<span class="hljs-string"><span class="hljs-string">"SecureExtension3.groovy"</span></span>)), CompileStatic.class);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุจุชุดุบูู ุงูููุฏ ูุฑุฉ ุฃุฎุฑู - ูุง ูุฒุงู ูุนูู.  ุฌุฑุจ ูุฐุง ุงูุขู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">abs(cos(1+score)) System.exit(-1)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุชุนุทู ุชุฌููุน ุงูุจุฑูุงูุฌ ุงููุตู ูุน ูุฌูุฏ ุฎุทุฃ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Script1.groovy: 1: [Static type checking] - Method call is not allowed! @ line 1, column 19. abs(cos(1+score));System.exit(-1) ^ 1 error</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชูุงูููุง ุ ููุฏ ูุชุจุช ููุชู ููุญู ุงูุชุญูู ูู ุงูููุน ุงูุฃูู ุงูุฐู ูููุน ุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุถุงุฑุฉ! </p><br><h2 id="uluchshenie-konfiguracii-rasshireniya" style=";text-align:right;direction:rtl">  ุชุนุฒูุฒ ุงูุชูููู ุงูุชูุฏูุฏ </h2><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ูู ุดูุก ูุณูุฑ ุนูู ูุง ูุฑุงู ุ ูููููุง ุญุธุฑ ุงูููุงููุงุช ุฅูู ุฃุณุงููุจ ูุฆุฉ <code>System</code> ุ ูููู ูุจุฏู ุฃูู ุณูุชู ุงูุชุดุงู ุซุบุฑุงุช ุฃูููุฉ ุฌุฏูุฏุฉ ูู ููุช ูุฑูุจ ุ ูุณูุญุชุงุฌ ุฅูู ููุน ุจุฏุก ุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุถุงุฑุฉ.  ูุฐูู ุจุฏูุงู ูู ุชุซุจูุช ูู ุดูุก ูู ุงูููุญู ุ ุณูุญุงูู ุฌุนู ุงูุชุฏุงุฏูุง ุนุงููููุง ููุงุจู ููุชุฎุตูุต.  ูุฏ ูููู ูุฐุง ูู ุงูุฃูุซุฑ ุตุนูุจุฉ ุ ูุฃูู ูุง ุชูุฌุฏ ุทุฑููุฉ ูุจุงุดุฑุฉ ูุชูุฑูุฑ ุงูุณูุงู ุฅูู ููุญู ูุญุต ุงููุชุงุจุฉ.  ุชุณุชูุฏ ุงูููุฑุฉ ุ ุจุงูุชุงูู ุ ุฅูู ุงุณุชุฎุฏุงู ูุชุบูุฑ ูุญูู ููุคุดุฑ ุงูุชุฑุงุจุท (ุทุฑููุฉ ุงูููุญูู ุ ูุนู) ูุชูุฑูุฑ ุจูุงูุงุช ุงูุชูููู ุฅูู ูุฏูู ุงููุชุงุจุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุณูุฌุนู ูุงุฆูุฉ ุงููุชุบูุฑุงุช ูุงุจูุฉ ููุชุฎุตูุต.  ูุฐุง ูุง ุณูุจุฏู ุนููู ููุฏ Java: </p><br><p style=";text-align:right;direction:rtl"> <code>Sandbox.java</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sandbox</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String VAR_TYPES = <span class="hljs-string"><span class="hljs-string">"sandboxing.variable.types"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> ThreadLocal&lt;Map&lt;String, Object&gt;&gt; COMPILE_OPTIONS = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ThreadLocal&lt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ CompilerConfiguration conf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CompilerConfiguration(); ImportCustomizer customizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImportCustomizer(); customizer.addStaticStars(<span class="hljs-string"><span class="hljs-string">"java.lang.Math"</span></span>); ASTTransformationCustomizer astcz = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ASTTransformationCustomizer( singletonMap(<span class="hljs-string"><span class="hljs-string">"extensions"</span></span>, singletonList(<span class="hljs-string"><span class="hljs-string">"SecureExtension4.groovy"</span></span>)), CompileStatic.class); conf.addCompilationCustomizers(astcz); conf.addCompilationCustomizers(customizer); Binding binding = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Binding(); binding.setVariable(<span class="hljs-string"><span class="hljs-string">"score"</span></span>, <span class="hljs-number"><span class="hljs-number">2.0</span></span>d); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Map&lt;String,ClassNode&gt; variableTypes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, ClassNode&gt;(); variableTypes.put(<span class="hljs-string"><span class="hljs-string">"score"</span></span>, ClassHelper.double_TYPE); Map&lt;String,Object&gt; options = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, Object&gt;(); options.put(VAR_TYPES, variableTypes); COMPILE_OPTIONS.set(options); GroovyShell shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GroovyShell(binding, conf); Double userScore = (Double) shell.evaluate(<span class="hljs-string"><span class="hljs-string">"abs(cos(1+score));System.exit(-1)"</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"userScore = "</span></span> + userScore); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { COMPILE_OPTIONS.remove(); } } }</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>ThreadLocal</code> ,          </li><li style=";text-align:right;direction:rtl">    โ <code>SecureExtension4.groovy</code> </li><li style=";text-align:right;direction:rtl"> <code>variableTypes</code> โ   โ  โ  โ </li><li style=";text-align:right;direction:rtl">      <code>score</code> </li><li style=";text-align:right;direction:rtl"> <code>options</code> โ     </li><li style=";text-align:right;direction:rtl">   "variable types"     VAR_TYPES </li><li style=";text-align:right;direction:rtl">     thread local </li><li style=";text-align:right;direction:rtl"> ,    ,     thread local </li></ol><br><p style=";text-align:right;direction:rtl">          : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Sandbox.* def typesOfVariables = COMPILE_OPTIONS.get()[VAR_TYPES] unresolvedVariable { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typesOfVariables[<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>.name]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> makeDynamic(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>, typesOfVariables[<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>.name]) } }</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">        thread local </li><li style=";text-align:right;direction:rtl">      ,      , </li><li style=";text-align:right;direction:rtl">   type checker       </li></ol><br><p style=";text-align:right;direction:rtl">         thread local,    ,  type checker  . ,      <code>unresolvedVariable</code> ,    ,  ,    type checker,   .  ,     .   ! </p><br><p style=";text-align:right;direction:rtl">           .        ,       . </p><br><h2 id="konfiguraciya-belogo-spiska-metodov" style=";text-align:right;direction:rtl">     </h2><br><p style=";text-align:right;direction:rtl">    .   ,       .      ,         ,     . ,  <code>System.exit</code> ,   : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">java.lang.System#exit(int)</code> </pre> <br><p style=";text-align:right;direction:rtl"> ,     Java,    : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sandbox</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String WHITELIST_PATTERNS = <span class="hljs-string"><span class="hljs-string">"sandboxing.whitelist.patterns"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ... public static void main(String[] args) { // ... try { Map&lt;String,ClassNode&gt; variableTypes = new HashMap&lt;String, ClassNode&gt;(); variableTypes.put("score", ClassHelper.double_TYPE); Map&lt;String,Object&gt; options = new HashMap&lt;String, Object&gt;(); List&lt;String&gt; patterns = new ArrayList&lt;String&gt;(); patterns.add("java\\.lang\\.Math#"); options.put(VAR_TYPES, variableTypes); options.put(WHITELIST_PATTERNS, patterns); COMPILE_OPTIONS.set(options); GroovyShell shell = new GroovyShell(binding, conf); Double userScore = (Double) shell.evaluate("abs(cos(1+score));System.exit(-1)"); System.out.println("userScore = " + userScore); } finally { COMPILE_OPTIONS.remove(); } } }</span></span></code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">    </li><li style=";text-align:right;direction:rtl">    <code>java.lang.Math</code>   </li><li style=";text-align:right;direction:rtl">        </li></ol><br><p style=";text-align:right;direction:rtl">       : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.ClassNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.MethodNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.Parameter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.transform.stc.ExtensionMethodNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Sandbox.* <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prettyPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ClassNode node)</span></span></span><span class="hljs-function"> </span></span>{ node.isArray()?<span class="hljs-string"><span class="hljs-string">"${prettyPrint(node.componentType)}[]"</span></span>:node.toString(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) } <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toMethodDescriptor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodNode node)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ExtensionMethodNode) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> toMethodDescriptor(node.extensionMethodNode) } def sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder() sb.append(node.declaringClass.toString(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) sb.append(<span class="hljs-string"><span class="hljs-string">"#"</span></span>) sb.append(node.name) sb.append(<span class="hljs-string"><span class="hljs-string">'('</span></span>) sb.append(node.parameters.collect { Parameter it -&gt; prettyPrint(it.originType) }.join(<span class="hljs-string"><span class="hljs-string">','</span></span>)) sb.append(<span class="hljs-string"><span class="hljs-string">')'</span></span>) sb } def typesOfVariables = COMPILE_OPTIONS.get()[VAR_TYPES] def whiteList = COMPILE_OPTIONS.get()[WHITELIST_PATTERNS] onMethodSelection { expr, MethodNode methodNode -&gt; def descr = toMethodDescriptor(methodNode) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!whiteList.any { descr =~ it }) { addStaticTypeError(<span class="hljs-string"><span class="hljs-string">"You tried to call a method which is not allowed, what did you expect?: $descr"</span></span>, expr) } } unresolvedVariable { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typesOfVariables[<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>.name]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> makeDynamic(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>, typesOfVariables[<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>.name]) } }</code> </pre> <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">       <code>MethodNode</code> </li><li style=";text-align:right;direction:rtl">     thread local </li><li style=";text-align:right;direction:rtl">       </li><li style=";text-align:right;direction:rtl">        ,   </li></ol><br><p style=";text-align:right;direction:rtl">      ,    : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Script1.groovy: 1: [Static type checking] - You tried to call a method which is not allowed, what did you expect?: java.lang.System#exit(int) @ line 1, column 19. abs(cos(1+score));System.exit(-1) ^ 1 error</code> </pre> <br><p style=";text-align:right;direction:rtl"> ,  !        ,   <strong>  </strong> , <strong>  </strong>  .    ,      !     ,       ,       . ,   (  <code>foo.text</code> ,     <code>foo.getText()</code> ). </p><br><h2 id="sobiraem-vse-vmeste" style=";text-align:right;direction:rtl">    </h2><br><p style=";text-align:right;direction:rtl">     ,    type checker'    "property selection", ,   .      ,         ,  .         ,     ,       โ    .     . </p><br><p style=";text-align:right;direction:rtl"> <code>SandboxingTypeCheckingExtension.groovy</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.ClassCodeVisitorSupport <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.ClassHelper <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.ClassNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.MethodNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.Parameter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.ast.expr.PropertyExpression <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.control.SourceUnit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.transform.sc.StaticCompilationMetadataKeys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.transform.stc.ExtensionMethodNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.transform.stc.GroovyTypeCheckingExtensionSupport <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.groovy.transform.stc.StaticTypeCheckingSupport <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Sandbox.* <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SandboxingTypeCheckingExtension</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GroovyTypeCheckingExtensionSupport</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TypeCheckingDSL</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prettyPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ClassNode node)</span></span></span><span class="hljs-function"> </span></span>{ node.isArray()?<span class="hljs-string"><span class="hljs-string">"${prettyPrint(node.componentType)}[]"</span></span>:node.toString(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) } <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toMethodDescriptor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodNode node)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ExtensionMethodNode) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> toMethodDescriptor(node.extensionMethodNode) } def sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder() sb.append(node.declaringClass.toString(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) sb.append(<span class="hljs-string"><span class="hljs-string">"#"</span></span>) sb.append(node.name) sb.append(<span class="hljs-string"><span class="hljs-string">'('</span></span>) sb.append(node.parameters.collect { Parameter it -&gt; prettyPrint(it.originType) }.join(<span class="hljs-string"><span class="hljs-string">','</span></span>)) sb.append(<span class="hljs-string"><span class="hljs-string">')'</span></span>) sb } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-function">Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Fetch white list of regular expressions of authorized method calls def whiteList = COMPILE_OPTIONS.get()[WHITELIST_PATTERNS] def typesOfVariables = COMPILE_OPTIONS.get()[VAR_TYPES] onMethodSelection { expr, MethodNode methodNode -&gt; def descr = toMethodDescriptor(methodNode) if (!whiteList.any { descr =~ it }) { addStaticTypeError("You tried to call a method which is not allowed, what did you expect?: $descr", expr) } } unresolvedVariable { var -&gt; if (isDynamic(var) &amp;&amp; typesOfVariables[var.name]) { storeType(var, typesOfVariables[var.name]) handled = true } } // handling properties (like foo.text) is harder because the type checking extension // does not provide a specific hook for this. Harder, but not impossible! afterVisitMethod { methodNode -&gt; def visitor = new PropertyExpressionChecker(context.source, whiteList) visitor.visitMethod(methodNode) } } private class PropertyExpressionChecker extends ClassCodeVisitorSupport { private final SourceUnit unit private final List&lt;String&gt; whiteList PropertyExpressionChecker(final SourceUnit unit, final List&lt;String&gt; whiteList) { this.unit = unit this.whiteList = whiteList } @Override protected SourceUnit getSourceUnit() { unit } @Override void visitPropertyExpression(final PropertyExpression expression) { super.visitPropertyExpression(expression) ClassNode owner = expression.objectExpression.getNodeMetaData(StaticCompilationMetadataKeys.PROPERTY_OWNER) if (owner) { if (expression.spreadSafe &amp;&amp; StaticTypeCheckingSupport.implementsInterfaceOrIsSubclassOf(owner, classNodeFor(Collection))) { owner = typeCheckingVisitor.inferComponentType(owner, ClassHelper.int_TYPE) } def descr = "${prettyPrint(owner)}#${expression.propertyAsString}" if (!whiteList.any { descr =~ it }) { addStaticTypeError("Property is not allowed: $descr", expression) } } } } }```     sandbox',     assert' ,  ,     : ``Sandbox.java`` ```java public class Sandbox { public static final String WHITELIST_PATTERNS = "sandboxing.whitelist.patterns"; public static final String VAR_TYPES = "sandboxing.variable.types"; public static final ThreadLocal&lt;Map&lt;String, Object&gt;&gt; COMPILE_OPTIONS = new ThreadLocal&lt;Map&lt;String, Object&gt;&gt;(); public static void main(String[] args) { CompilerConfiguration conf = new CompilerConfiguration(); ImportCustomizer customizer = new ImportCustomizer(); customizer.addStaticStars("java.lang.Math"); ASTTransformationCustomizer astcz = new ASTTransformationCustomizer( singletonMap("extensions", singletonList("SandboxingTypeCheckingExtension.groovy")), CompileStatic.class); conf.addCompilationCustomizers(astcz); conf.addCompilationCustomizers(customizer); Binding binding = new Binding(); binding.setVariable("score", 2.0d); try { Map&lt;String, ClassNode&gt; variableTypes = new HashMap&lt;String, ClassNode&gt;(); variableTypes.put("score", ClassHelper.double_TYPE); Map&lt;String, Object&gt; options = new HashMap&lt;String, Object&gt;(); List&lt;String&gt; patterns = new ArrayList&lt;String&gt;(); // allow method calls on Math patterns.add("java\\.lang\\.Math#"); // allow constructors calls on File patterns.add("File#&lt;init&gt;"); // because we let the user call each/times/... patterns.add("org\\.codehaus\\.groovy\\.runtime\\.DefaultGroovyMethods"); options.put(VAR_TYPES, variableTypes); options.put(WHITELIST_PATTERNS, patterns); COMPILE_OPTIONS.set(options); GroovyShell shell = new GroovyShell(binding, conf); Object result; try { result = shell.evaluate("Eval.me('1')"); // error assert false; } catch (MultipleCompilationErrorsException e) { System.out.println("Successful sandboxing: "+e.getMessage()); } try { result = shell.evaluate("System.exit(-1)"); // error assert false; } catch (MultipleCompilationErrorsException e) { System.out.println("Successful sandboxing: "+e.getMessage()); } try { result = shell.evaluate("((Object)Eval).me('1')"); // error assert false; } catch (MultipleCompilationErrorsException e) { System.out.println("Successful sandboxing: "+e.getMessage()); } try { result = shell.evaluate("new File('/etc/passwd').getText()"); // getText is not allowed assert false; } catch (MultipleCompilationErrorsException e) { System.out.println("Successful sandboxing: "+e.getMessage()); } try { result = shell.evaluate("new File('/etc/passwd').text"); // getText is not allowed assert false; } catch (MultipleCompilationErrorsException e) { System.out.println("Successful sandboxing: "+e.getMessage()); } Double userScore = (Double) shell.evaluate("abs(cos(1+score))"); System.out.println("userScore = " + userScore); } finally { COMPILE_OPTIONS.remove(); } } }</span></span></code> </pre> <br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><p style=";text-align:right;direction:rtl">      Groovy       JVM.        ,      . ,    ,    ,      .  ,    Groovy,      sandboxing'          (,       ,   ). </p><br><p style=";text-align:right;direction:rtl">  ,            ,          .      ,            .  ,      ,        . </p><br><p style=";text-align:right;direction:rtl">    ,   sandboxing',   , โ  <strong></strong>  <code>SecureASTCustomizer</code> .    <strong> ,  </strong> ,       : secure AST customizer    ,      (,       ),              (   ,   ). </p><br><p style=";text-align:right;direction:rtl"> ,    : ,   , .   Groovy   .          Groovy,   ,  -      pull request,      -  ! <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar445114/">https://habr.com/ru/post/ar445114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar445104/index.html">ุชุงุฑูุฎ ููุฌุฒ ููุนูุงูุฉ ุงูุชุฌุงุฑูุฉ Klipsch ุงูุตูุช</a></li>
<li><a href="../ar445106/index.html">ุงููุงุฆุฏุฉ ุงููุณุชุฏูุฑุฉ: ุงูุชูููููุฌูุง ุงููุถุงูุฉ ูุจุฏูู ููุชุตููุน ุงูุชูููุฏู</a></li>
<li><a href="../ar445108/index.html">ููุณุช ูุงุญุฏุฉ ูุงูููู - ูุฎุชููุฉ ุจุดูู ุฃุณุงุณู ูุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู ESA ู ULA ุงููุดุงุฑูุน</a></li>
<li><a href="../ar445110/index.html">ููุจููุชุฑ ูุฒูุฏ ุจูุญุฑู ุฃูุฑุงุต ุทุฑุงุฒ Fallout</a></li>
<li><a href="../ar445112/index.html">ูุดู ุชุดุงุจู ููุงุท ุงูุถุนู ุนูู ุงูููุงูุน</a></li>
<li><a href="../ar445116/index.html">ุณูุงุญ ุงูุฌู ุงูุฃูุฑููู ูุนูู ุนูู ุทุงุฆุฑุฉ ุจุฏูู ุทูุงุฑ ุชุณูู ุณูุงูุจูุฑุบ</a></li>
<li><a href="../ar445118/index.html">ูู ุฏุฑุฏุดุฉ Telegram ุฎุงุตุฉ ุ ููููู ุญุฐู ุฃู ุฑุณุงุฆู - ุญุชู ุงูุบุฑุจุงุก (ุชูุช ุฅุถุงูุฉ ูุชูุฌุฉ ุงูุชุตููุช)</a></li>
<li><a href="../ar445120/index.html">Frontend Weekly Digest (18 - 24 ูุงุฑุณ 2019)</a></li>
<li><a href="../ar445122/index.html">ููุฎุต ุงูููุงุฏ ุงูุทุงุฒุฌุฉ ูู ุนุงูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุฃุณุจูุน ุงููุงุถู ุฑูู 357 (18 - 24 ูุงุฑุณ 2019)</a></li>
<li><a href="../ar445124/index.html">ุชุตูุจ ูุนุชุฏู ููุงูุฑูููุณ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>