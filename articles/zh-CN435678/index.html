<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏂🏿 ❄️ 🏿 不信任任务管理器中的内存信息 👨🏻‍🎤 💅🏼 😖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在使用Windows的多年中，我习惯了任务管理器。 从那里，我以不良行为杀死了数百个应用程序。 在那儿，他看着其中的人消耗资源。 在我开始使用具有数百GB内存的机器之前，应用程序都有相应的请求。 本文讨论了为什么任务管理器不能很好地跟踪内存以及作为回报使用什么。 首先，关于Windows中的内存分配...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>不信任任务管理器中的内存信息</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435678/">在使用Windows的多年中，我习惯了任务管理器。 从那里，我以不良行为杀死了数百个应用程序。 在那儿，他看着其中的人消耗资源。 在我开始使用具有数百GB内存的机器之前，应用程序都有相应的请求。 本文讨论了为什么任务管理器不能很好地跟踪内存以及作为回报使用什么。 首先，关于Windows中的内存分配机制。 <br><br>  tl; dr：任务管理器隐藏有关分页内存和进程虚拟空间的信息。 最好使用Sysinternals捆绑包中的Process Explorer。 <br><a name="habracut"></a><br><h1>  Windows分配 </h1><br> 启动新进程时，操作系统会为此进程分配一个连续的地址空间。 在32位系统上，此空间可以为4 GB，对于内核，通常为2 GB，其余空间用于进程。 本文将忽略核心内存的使用。 在64位系统上，进程保留的内存可以增长到高达64 TB。 当我们实际拥有8 GB的内存时，此过程将用几TB的内存做什么？ 首先，您需要了解什么是保留和传输的内存。 <br><br><h3> 保留和传输的内存 </h3><br> 并非这个巨大的地址空间的所有部分都是平等的。 实际上，物理RAM或磁盘都支持进程地址空间的某些部分（请参见下文）。 如果操作系统在尝试使用它时向您提供了该内存，则保留内存被视为已提交。 地址空间的其余部分（这是绝大多数）仍然可供保留。 就是说，并非总是OS可以为您提供此内存块供使用：例如，它可以在磁盘（交换文件）上进行复制，也可以不进行复制。 在C ++中，通过调用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VirtualAlloc</a>保留内存。 因此，传输的内存是OS中硬件受限的资源。 让我们看看。 <br><br><h3> 操作系统交换文件 </h3><br> 交换文件是一个好主意。 基本上，操作系统<i>了解到</i>您的应用程序并未特别使用内存的某些部分。 为什么要在上面花费实际的物理内存？ 相反，内核进程会将未使用的片段写入磁盘。 在他们再次转向他之前，他只会回到记忆中。 <br><br> 有关Windows中内存如何工作的更详细说明，我推荐Mark Russinovich的讲座<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“内存管理的秘密”</a> 。 <br><br><h1> 记忆追踪 </h1><br> 有很多值得观察和分析的地方。 与谁联系？ 当然，要任务管理器！ <br><br>  RAM内存通常称为工作集，而所有分配的内存通常称为专用字节。  DLL混淆了定义，因此暂时将其忽略。 换句话说： <br><br> <code>Private Bytes [ ] =   +  </code> <br> <br> 默认情况下，任务管理器准确显示任何进程的工作集： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f1/8af/5fa/3f18af5faae54d7c6f00cb0f770825e2.png"><br><br> 这就是我一直在看的号码。 我怎么知道在任务管理器中有关已传输内存的信息在“ <code>Commit Size</code>列中。 我在那里找不到有关虚拟内存的信息。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fb/d7a/b28/9fbd7ab28b18c6bc8ac62271626bd34f.png"><br>  <i><font color="gray">如果右键单击各列并选择相应的项目，则任务管理器允许您添加有关已传输内存的信息。</font></i> <br><br><h1> 有效内存指标 </h1><br> 幸运的是，还有许多其他资源可用于跟踪资源。  PerfMon（系统监视器）安装在每台Windows机器上，它提供有关每个进程和整个系统的非常详细的信息： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/276/f9e/c52/276f9ec52c95d9d47eee99b1de3832ac.png"><br><br> 有趣的是，系统监视器实际上可以检查和比较网络上两台或更多台计算机上的指标。 这是一个非常强大的工具，但是任务管理器显然更加用户友好。 我建议将<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Process Explorer</a>作为中间解决方案： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/346/814/bf1/346814bf12bcd1e9ce3e26d4bcc6f74d.png"><br><br>  oom！  Visual Studio，为什么仍处于32位模式（请注意其虚拟大小）？ 我的计算机上的峰值内存使用量仍然是最大内存使用量的89％。 稍后将派上用场。 <br><br> 另外：许多人指出了其他方便的工具，包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VMMap</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RAMMap</a> 。 <br><br><h1> 调试内存信息 </h1><br> 幸运的是，这些并不是不必要的操作系统琐事。 有关内存消耗的实际信息已经多次帮助我调试各种问题。 <br><br> 最重要的是找到分配的内存中<i>未触及的</i>部分。 交换数据也很重要：此内存已传输，但很少使用或根本没有使用。 <br><br> 即使有时使用内存，也必须了解这是一种昂贵的资源，因此您绝对不要走这条路。 内存泄漏将出现在这里。 <br><br> 由于这些原因，我之前曾听到过建议完全删除页面文件，并将分配的内存等同于工作集。 但是，这是一个双重想法。 然后，如果应用程序操作不正确，有时会徒劳地保留内存，则操作系统将无法转储内存。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN435678/">https://habr.com/ru/post/zh-CN435678/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN435664/index.html">Google搜索引擎欺骗</a></li>
<li><a href="../zh-CN435666/index.html">异步去同步：.NET中使用异步/等待的反模式</a></li>
<li><a href="../zh-CN435668/index.html">春天的另一部法律：人大代表提议允许警察使用地理位置来追踪儿童的位置</a></li>
<li><a href="../zh-CN435670/index.html">最高算法-按难度级别分配算法</a></li>
<li><a href="../zh-CN435672/index.html">如何进行商务智能再培训</a></li>
<li><a href="../zh-CN435680/index.html">AWS显示了开源中指</a></li>
<li><a href="../zh-CN435682/index.html">咖啡馆制造商咖啡打印机评论</a></li>
<li><a href="../zh-CN435684/index.html">橡树岭国家实验室解决了空间设备开发商的主要问题：: 238缺乏</a></li>
<li><a href="../zh-CN435686/index.html">Pavel Durov清算Telegram Messenger LLP</a></li>
<li><a href="../zh-CN435688/index.html">Flutter客户端服务器应用示例</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>