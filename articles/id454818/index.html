<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇 🤵🏿 🌱 Tantangan Rekko - bagaimana mengambil tempat kedua dalam kompetisi untuk menciptakan sistem rekomendasi 👵🏿 ➗ 😹</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Tim saya di Tinkoff sedang membangun sistem rekomendasi. Jika Anda senang dengan cashback bulanan Anda, maka ini adalah bisnis kami. Ka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tantangan Rekko - bagaimana mengambil tempat kedua dalam kompetisi untuk menciptakan sistem rekomendasi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/454818/"><p>  Halo semuanya.  Tim saya di Tinkoff sedang membangun sistem rekomendasi.  Jika Anda senang dengan cashback bulanan Anda, maka ini adalah bisnis kami.  Kami juga membangun sistem rekomendasi penawaran khusus dari mitra dan terlibat dalam koleksi Cerita individu dalam aplikasi Tinkoff.  Dan kami senang berpartisipasi dalam kompetisi pembelajaran mesin untuk menjaga diri kami dalam kondisi yang baik. </p><br><p>  Selama dua bulan, dari 18 Februari hingga 18 April, sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kompetisi diadakan</a> di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Boosters.pro</a> untuk membangun sistem rekomendasi data nyata dari salah satu bioskop online Rusia terbesar, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Okko</a> .  Penyelenggara bertujuan untuk meningkatkan sistem rekomendasi yang ada.  Saat ini, kompetisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tersedia dalam mode kotak pasir</a> , di mana Anda dapat menguji pendekatan Anda dan mengasah keterampilan Anda dalam membangun sistem rekomendasi. </p><br><p><img src="https://habrastorage.org/webt/lv/1c/rj/lv1crjkiorbmthzwkmprnoqdusa.png" alt="alt_text"></p><a name="habracut"></a><br><h1 id="opisanie-dannyh">  Deskripsi Data </h1><br><p>  Akses ke konten di Okko dilakukan melalui aplikasi di TV atau smartphone, atau melalui antarmuka web.  Konten dapat disewa®, dibeli (P) atau dilihat dengan berlangganan (S).  Penyelenggara kompetisi memberikan data tentang pandangan selama N hari (N&gt; 60), selain itu, informasi tentang peringkat dan penanda yang ditambahkan tersedia.  Perlu diingat satu detail penting, jika pengguna menonton satu film beberapa kali atau beberapa episode dari seri, maka hanya tanggal transaksi terakhir dan total waktu yang dihabiskan per unit konten akan direkam dalam tablet. </p><br><p><img src="https://habrastorage.org/webt/qy/w5/2z/qyw52zw89wafhju80zo73p3uxya.png" alt="alt_text"></p><br><p>  Sekitar 10 juta transaksi, 450 ribu peringkat dan 950 ribu fakta bookmark untuk 500 ribu pengguna disediakan. </p><br><p><img src="https://habrastorage.org/webt/nz/g6/_g/nzg6_gexjoxdvmsng8lkjcm9_m8.png" alt="alt_text"></p><br><p>  Sampel tidak hanya berisi pengguna aktif, tetapi juga pengguna yang telah menonton beberapa film selama periode tersebut. </p><br><p> Katalog Okko berisi tiga jenis konten: film (film), seri (seri) dan film seri (multipart_movie), total 10.200 objek.  Untuk setiap objek, satu set atribut dan atribut anonim (fitur_1, ..., feature_5) tersedia, berlangganan, sewa atau ketersediaan dan durasi pembelian. </p><br><p><img src="https://habrastorage.org/webt/ww/z3/wj/wwz3wjub5-tgvdrpjkinmi8ojgg.png" alt="alt_text"></p><br><h1 id="celevaya-peremennaya-i-metrika">  Variabel dan Metrik Target </h1><br><p>  Tugas yang diperlukan untuk memprediksi banyak konten yang akan dikonsumsi pengguna selama 60 hari ke depan.  Diyakini bahwa pengguna akan mengkonsumsi konten jika ia: </p><br><ul><li>  Beli atau sewa </li><li>  Tonton lebih dari separuh film dengan berlangganan </li><li>  Tonton lebih dari sepertiga dari seri ini dengan berlangganan </li></ul><br><p><img src="https://habrastorage.org/webt/hs/62/an/hs62anr4vai9g-7aivjqq8gfjek.png" alt="alt_text"></p><br><ul><li>  <strong>r_u (i)</strong> - apakah pengguna Anda mengkonsumsi konten yang diprediksi kepadanya di tempat saya (1 atau 0) </li><li>  <strong>n_u</strong> - jumlah elemen yang dikonsumsi pengguna selama periode pengujian </li><li>  <strong>U</strong> - banyak pengguna uji </li></ul><br><p>  Anda dapat mempelajari lebih lanjut tentang metrik untuk tugas peringkat dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pos</a> ini. </p><br><p>  Sebagian besar pengguna menonton film sampai akhir, sehingga pangsa kelas positif pada transaksi adalah 65%.  Kualitas algoritma dievaluasi menggunakan subset dari 50 ribu pengguna dari sampel yang disajikan. </p><br><h1 id="agregirovannyy-reyting">  Peringkat agregat </h1><br><p>  Keputusan kompetisi dimulai dengan agregasi semua interaksi pengguna dengan konten ke dalam skala peringkat tunggal.  Diasumsikan bahwa jika pengguna membeli konten, ini berarti bunga maksimum.  Film ini lebih pendek daripada seri, oleh karena itu untuk melihat seri secara keseluruhan, Anda perlu memberikan lebih banyak poin.  Akibatnya, peringkat agregat dibentuk sesuai dengan aturan berikut: </p><br><ul><li>  Pembagian film * 5 </li><li>  Acara TV Bagikan * 10 </li><li>  [Bookmarking film] * 0.5 </li><li>  [Bookmark seri] * 1.5 </li><li>  [Beli / sewa konten] * 15 </li><li>  Peringkat + 2 </li></ul><br><h1 id="model-pervogo-urovnya">  Model tingkat pertama </h1><br><p>  Panitia memberikan solusi dasar berdasarkan penyaringan kolaboratif dengan skala Tf-IDF.  Menambahkan semua jenis interaksi ke peringkat teragregasi, meningkatkan jumlah tetangga terdekat dari 20 menjadi 150 dan mengganti Tf-IDF dengan bobot BM25 tersingkir sekitar <strong>0,03</strong> pada LB (Papan Pemimpin). </p><br><p>  Terinspirasi oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">posisi tim yang mengambil tempat ke-3 di RecSys Challenge 2018</a> , saya memilih model <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LightFM</a> dengan kehilangan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">WARP</a> sebagai model base kedua.  LightFM dengan parameter hiper yang dipilih: learning_rate, no_components, item_alpha, user_alpha, max_sampled memberi <strong>0,033</strong> pada LB. </p><br><p><img src="https://habrastorage.org/webt/le/km/ak/lekmakeznlccijkuu24mnvqlcsm.png" alt="alt_text"></p><br><p>  Validasi model dilakukan tepat waktu: 80% pertama interaksi jatuh ke kereta, 20% sisanya ke validasi.  Untuk pengiriman pada LB, model dilatih pada seluruh dataset dengan parameter yang dipilih untuk validasi. </p><br><h1 id="blending-modeley">  Pencampuran Model </h1><br><p>  Pada tahap sebelumnya, ternyata membangun dua garis dasar yang kuat, apalagi rekomendasi mereka berpotongan rata-rata untuk 60 persen dari konten yang direkomendasikan.  Jika ada dua model yang kuat dan pada saat yang sama berkorelasi lemah, maka pencampuran mereka adalah langkah yang masuk akal. </p><br><p><img src="https://habrastorage.org/webt/2-/5x/ya/2-5xyaedg2u-tqzbjr80v-49j38.png" alt="alt_text"></p><br><p>  Dalam hal ini, skor model menjadi milik distribusi yang berbeda dan memiliki skala yang berbeda, sehingga diputuskan untuk menggunakan jumlah peringkat untuk menggabungkan kedua model.  Blending model menghasilkan <strong>0,0347</strong> pada LB. </p><br><p><img src="https://habrastorage.org/webt/b4/8e/m4/b48em4d9um22gvkdttdp8i-heco.png" alt="alt_text"></p><br><h1 id="model-vtorogo-urovnya">  Model tingkat kedua </h1><br><p>  Sistem rekomendasi sering menggunakan pendekatan dua tingkat untuk membangun model: pertama, kandidat teratas dipilih oleh model tingkat pertama yang sederhana, kemudian top yang dipilih diurutkan kembali oleh model yang lebih kompleks dengan penambahan sejumlah besar fitur. </p><br><p><img src="https://habrastorage.org/webt/e5/ll/db/e5lldbt4k4ncxq5uiqbk61l8doc.png" alt="alt_text"></p><br><p>  Dataset dibagi dalam waktu menjadi bagian pelatihan dan validasi.  Sejumlah rekomendasi dikumpulkan untuk bagian validasi untuk setiap pengguna, yang terdiri dari kombinasi top200 prediksi model tingkat pertama dengan pengecualian film yang sudah ditonton.  Selanjutnya, itu diperlukan untuk mengajarkan model untuk mengatur ulang hasil yang dihasilkan untuk setiap pengguna.  Masalahnya dirumuskan dalam hal klasifikasi biner.  Sepasang (pengguna, konten) milik kelas positif hanya jika pengguna mengkonsumsi konten selama periode validasi.  Sebagai model tingkat kedua, peningkatan gradien digunakan, yaitu paket LightGBM. </p><br><h2 id="priznaki">  Tanda </h2><br><p>  Model tingkat pertama untuk pasangan (pengguna, konten) mengevaluasi relevansi dalam bentuk kecepatan, pengurutan yang dalam urutan menurun Anda bisa mendapatkan peringkat.  Model dilatih pada tanda-tanda pangkat dan kecepatan, bersama dengan tanda-tanda dari katalog konten, pingsan <strong>0,0359</strong> pada LB. </p><br><p>  Dari bentuk distribusi fitur anonim pertama, disimpulkan bahwa ini adalah tanggal film muncul dalam katalog, oleh karena itu, model sangat dilatih ulang untuk fitur ini dengan skema validasi yang dipilih.  Menghapus karakteristik dari sampel memberikan peningkatan LB menjadi <strong>0,0367</strong> </p><br><p>  Model LightFM, selain untuk memprediksi relevansi konten untuk pengguna, mengembalikan dua vektor: bias item dan bias pengguna, yang berkorelasi dengan tingkat popularitas konten dan jumlah film yang dilihat oleh pengguna.  Menambahkan tanda menaikkan kecepatan pada LB menjadi <strong>0,0388</strong> . </p><br><p>  Anda dapat menetapkan peringkat untuk suatu pasangan (pengguna, konten) sebelum atau setelah menghapus film yang sudah ditonton.  Perubahan metode untuk yang terakhir memberikan peningkatan LB menjadi <strong>0,0395</strong> . </p><br><p><img src="https://habrastorage.org/webt/dm/ux/h_/dmuxh_6p9obkaumaeimtritdre0.png" alt="alt_text"></p><br><p>  Hampir tidak ada yang menonton bagian penting dari katalog film.  Konten yang ditonton oleh kurang dari 100 pengguna dihapus dari sampel untuk pelatihan model tingkat kedua, yang mengurangi katalog hingga setengahnya.  Penghapusan konten yang tidak populer membuat pemilihan dari model tingkat pertama lebih relevan dan hanya setelah itu vektor pengguna dari LightFM meningkatkan kecepatan validasi dan memberikan peningkatan pada LB menjadi <strong>0,0429</strong> . </p><br><p>  Selanjutnya, tanda ditambahkan - pengguna menambahkan bookmark ke buku, tetapi tidak melihat periode kereta, yang meningkatkan kecepatan pada LB menjadi <strong>0,0447</strong> .  Juga, tanda-tanda tentang tanggal transaksi pertama dan terakhir ditambahkan, mereka menaikkan <strong>kecepatan</strong> ke <strong>0,0457</strong> pada LB. </p><br><p><img src="https://habrastorage.org/webt/jy/4_/0v/jy4_0vcyt5ndutilvgqmbcivlkq.png" alt="alt_text"></p><br><p>  Kami akan menganggap model ini final.  Yang paling signifikan adalah tanda-tanda dari model tingkat pertama dan tanda-tanda anonim dari katalog konten. </p><br><p>  Fitur-fitur berikut tidak meningkat ke model akhir: </p><br><ul><li>  jumlah bookmark + pangsa konten yang dilihat dari bookmark - <strong>0,0453</strong> LB </li><li>  jumlah film yang dibeli <strong>0,0451</strong> LB </li></ul><br><p>  Tetapi ketika menyatu dengan model terakhir, mereka tersingkir <strong>0,0465</strong> pada LB.  Terinspirasi oleh hasil pencampuran, model-model berikut dilatih secara terpisah: </p><br><ul><li>  dengan fraksi yang berbeda dari sampel pelatihan untuk model tingkat pertama.  Perpecahan 90% / 10% memberikan peningkatan, berbeda dengan pemisahan 95% / 5% dan 70% / 30%. </li><li>  dengan metode agregasi peringkat yang dimodifikasi. </li><li>  dengan tambahan film yang tidak populer pada pelatihan yang ditetapkan untuk model tingkat kedua.  Untuk setiap unit konten, kompilasi 1000 pengguna dikompilasi. </li></ul><br><p>  Pencampuran terakhir dari 6 model memungkinkan untuk mencapai <strong>0,0469678</strong> pada LB, yang sesuai dengan tempat ke-5. </p><br><p><img src="https://habrastorage.org/webt/zu/tk/zm/zutkzmaxdgaatxyk5qddhdo5dda.png" alt="alt_text"></p><br><p>  Pada bagian pribadi, goncangan terjadi, yang melemparkan solusi ke tempat ke-2.  Saya pikir solusinya ternyata berkelanjutan berkat pencampuran sejumlah besar model. </p><br><p><img src="https://habrastorage.org/webt/rm/qo/8q/rmqo8ql3pgwas205pr5peg49hoy.png" alt="alt_text"></p><br><h1 id="ne-zashlo">  Tidak dimasukkan </h1><br><p>  Dalam proses penyelesaian kompetisi, banyak tanda-tanda yang muncul yang tampaknya masuk, tetapi sayangnya.  Tanda dan pendekatan yang paling tepercaya: </p><br><ul><li>  Atribut konten anonim.  Tidak diketahui secara pasti apa yang dikandungnya, tetapi semua peserta dalam kompetisi percaya bahwa mereka berisi informasi tentang aktor, sutradara, komposer ... Dalam keputusan saya, saya mencoba menambahkannya dalam beberapa format: populer sebagai karakter biner, mengeluarkan matriks konten atribut menggunakan LightFM dan BigARTM, dan kemudian tarik vektor dan menambahkannya ke model tingkat kedua. </li><li>  Vektor konten dari model LigthFM di model tingkat kedua. </li><li>  Atribut perangkat tempat pengguna melihat konten. </li><li>  Menurunkan berat konten populer untuk model tingkat kedua. </li><li>  Proporsi film / acara TV sehubungan dengan jumlah konten yang dilihat. </li><li>  Metrik peringkat dari CatBoost. </li></ul><br><h1 id="interesnye-fakty-o-sorevnovanii">  Fakta menarik tentang kompetisi </h1><br><ul><li>  Solusi Top1 ternyata lebih buruk daripada model produk okko 0,048 vs 0,062.  Harus diingat bahwa model produk sudah diluncurkan pada saat pengambilan sampel. </li><li>  Sekitar satu minggu setelah dimulainya kompetisi, dataset diubah, bagi mereka yang berpartisipasi sejak awal mereka menambahkan 30 kiriman, yang secara tak terduga terbakar setelah tim digabungkan. </li><li>  Validasi tidak selalu berkorelasi dengan LB, yang mengindikasikan kemungkinan guncangan. </li></ul><br><h1 id="kod-resheniya">  Kode keputusan </h1><br><p>  Solusinya tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> dalam bentuk dua jupyter-laptop: agregasi peringkat, model pelatihan tingkat pertama dan kedua. <br>  Solusi tempat ke-3 juga tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> . </p><br><h1 id="reshenie-organizatorov">  Keputusan penyelenggara </h1><br><p>  Alih-alih seribu kata, saya melampirkan fitur teratas dari penyelenggara. </p><br><p><img src="https://habrastorage.org/webt/xa/yg/gx/xayggxsl3bpargxaeinl8wgsbhy.jpeg" alt="alt_text"></p><br><p>  Selain itu, orang-orang dari Okko <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">merilis sebuah artikel</a> di mana mereka berbicara tentang tahap pengembangan mesin rekomendasi mereka. </p><br><p>  PS di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini Anda dapat melihat</a> kinerja di Data Fest 6 tentang solusi untuk masalah ini. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id454818/">https://habr.com/ru/post/id454818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id454804/index.html">Buat komponen Anda dengan template mikro</a></li>
<li><a href="../id454806/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 9. Dunia fisik switch. Bagian 1</a></li>
<li><a href="../id454808/index.html">Tentang pesawat ruang angkasa dan ruang angkasa. Cara membuat fitur dengan mengubah seluruh produk di sepanjang jalan</a></li>
<li><a href="../id454810/index.html">Udara segar di Mars: tekuk molekul CO2 dan dapatkan oksigen</a></li>
<li><a href="../id454816/index.html">Mengkonfigurasi bundel php-fpm + nginx di bawah WSL</a></li>
<li><a href="../id454820/index.html">Pencarian biru</a></li>
<li><a href="../id454824/index.html">Op-amp paling sederhana pada elemen diskrit</a></li>
<li><a href="../id454826/index.html">Kurangi cadangan sebesar 99,5% dengan hashget</a></li>
<li><a href="../id454828/index.html">Membuat gambar mosaik</a></li>
<li><a href="../id454830/index.html">3 Kualitas Utama untuk Manajer Produk yang Sukses: Alexander Belyaev</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>