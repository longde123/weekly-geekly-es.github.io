<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∞Ô∏è üî≠ üìª Arquitetura de servidor meta do Tacticool Mobile Online Shooter üõ†Ô∏è üé® üõ¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Outra conversa com o Pixonic DevGAMM Talks - desta vez de nossos colegas do PanzerDog. O engenheiro l√≠der de software da empresa Pavel Platto desmonto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arquitetura de servidor meta do Tacticool Mobile Online Shooter</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/426875/">  Outra conversa com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pixonic DevGAMM Talks</a> - desta vez de nossos colegas do PanzerDog.  O engenheiro l√≠der de software da empresa Pavel Platto desmontou o meta-servidor do jogo com uma arquitetura orientada a servi√ßos, informou quais solu√ß√µes e tecnologias foram escolhidas, o que e como elas foram dimensionadas e quais dificuldades tiveram que enfrentar.  O texto do relat√≥rio, slides e links para outros discursos do mitap, como sempre, sob o corte. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/JcuOHUzXXHw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  Primeiro, quero demonstrar um pequeno trailer do nosso jogo: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yIpGvbbMCn4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <br>  O relat√≥rio consistir√° em 3 partes.  No primeiro, falarei sobre quais tecnologias escolhemos e por que, no segundo - como o nosso meta-servidor est√° organizado, e no terceiro, sobre as v√°rias infra-estruturas de suporte que usamos e como implementamos a atualiza√ß√£o sem tempo de inatividade . <br><br><img src="https://habrastorage.org/webt/-s/fg/tz/-sfgtzhre4ij6b0n9-b_r0cako4.png"><br>  <i>Pilha tecnol√≥gica</i> <br><br>  O meta servidor est√° hospedado na Amazon e escrito em Elixir.  √â uma linguagem de programa√ß√£o funcional com um modelo de ator de computa√ß√£o.  Como n√£o temos Ops, os programadores est√£o envolvidos na opera√ß√£o e a maior parte da infraestrutura √© descrita como c√≥digo usando o HashiCorp Terraform. <br><br>  Atualmente, o Tacticool est√° em beta aberto, o meta servidor est√° em desenvolvimento h√° pouco mais de um ano e est√° em opera√ß√£o h√° quase um ano.  Vamos ver como tudo come√ßou. <br><br><img src="https://habrastorage.org/webt/zs/a0/fa/zsa0favmdahf0gdsnt0-goxhrnq.png"><br><br>  Quando entrei na empresa, j√° t√≠nhamos funcionalidades b√°sicas implementadas como um mon√≥lito em um mix C / C ++ e armazenamento PostageSQL.  Esta implementa√ß√£o teve alguns problemas. <br><br>  Em primeiro lugar, devido ao baixo n√≠vel de C, havia alguns bugs evasivos.  Por exemplo, para alguns jogadores, as partidas ficam travadas devido ao zeramento incorreto da matriz antes de sua reutiliza√ß√£o.  Obviamente, encontrar a rela√ß√£o entre esses dois eventos foi bastante dif√≠cil.  E como o estado de v√°rios encadeamentos foi universalmente modificado no c√≥digo, as condi√ß√µes de corrida n√£o deixaram de existir. <br><br>  O processamento paralelo de um grande n√∫mero de tarefas tamb√©m estava fora de quest√£o, porque o servidor iniciou no in√≠cio de cerca de 10 processos de trabalho, que foram bloqueados por consultas √† Amazon ou ao banco de dados.  E mesmo se esquecermos dessas solicita√ß√µes de bloqueio, o servi√ßo come√ßou a desmoronar em algumas centenas de conex√µes que n√£o realizavam nenhuma opera√ß√£o, exceto o ping.  Al√©m disso, o servi√ßo n√£o p√¥de ser dimensionado horizontalmente. <br><br>  Depois de algumas semanas procurando e corrigindo os bugs mais cr√≠ticos, decidimos que era mais f√°cil reescrever tudo do zero do que tentar corrigir todas as defici√™ncias da solu√ß√£o atual. <br><br>  E quando voc√™ come√ßa do zero, faz sentido tentar escolher um idioma que ajude a evitar alguns dos problemas anteriores.  Tivemos tr√™s candidatos: <br><br><ul><li>  C #; </li><li>  V√°; </li><li>  Elixir. </li></ul><br><img src="https://habrastorage.org/webt/_f/vt/q5/_fvtq51jwvlo2uuquqy-4vwsnhw.png"><br><br>  C # estava na lista de "conhecidos", como  o cliente e o servidor do jogo s√£o escritos no Unity, e a maior parte da experi√™ncia da equipe foi com essa linguagem de programa√ß√£o.  Go e Elixir foram considerados porque s√£o linguagens modernas e bastante populares criadas para o desenvolvimento de aplicativos de servidor. <br><br>  Os problemas da itera√ß√£o anterior nos ajudaram a determinar os crit√©rios para avaliar os candidatos. <br><br>  O primeiro crit√©rio foi a conveni√™ncia de trabalhar com opera√ß√µes ass√≠ncronas.  No C #, o trabalho conveniente com opera√ß√µes ass√≠ncronas n√£o apareceu na primeira tentativa.  Isso levou ao fato de termos um ‚Äúzool√≥gico‚Äù de solu√ß√µes que, na minha opini√£o, ainda est√£o um pouco de lado.  No Go e Elixir, esse problema foi levado em considera√ß√£o ao projetar essas linguagens, ambos usam threads leves (no Go s√£o goroutines, no Elixir s√£o processos).  Esses fluxos t√™m uma sobrecarga muito menor que os encadeamentos do sistema e, como podemos cri√°-los em dezenas e centenas de milhares, n√£o lamentamos bloque√°-los. <br><br>  O segundo crit√©rio foi a capacidade de trabalhar com processos competitivos.  O C # pronto para uso n√£o oferece nada al√©m de conjuntos de threads e mem√≥ria compartilhada, cujo acesso deve ser protegido usando v√°rias primitivas de sincroniza√ß√£o.  O Go possui um modelo menos propenso a erros na forma de goroutines e canais.  O Elixir, por outro lado, oferece um modelo de ator sem mem√≥ria compartilhada com mensagens.  A falta de mem√≥ria compartilhada tornou poss√≠vel implementar tecnologias √∫teis para um ambiente de execu√ß√£o competitivo em tempo de execu√ß√£o, como multitarefa de take-away honesta e coleta de lixo sem interrup√ß√µes no mundo. <br><br>  O terceiro crit√©rio foi a disponibilidade de ferramentas para trabalhar com tipos de dados imut√°veis.  Toda a minha experi√™ncia em desenvolvimento mostrou que uma parte bastante grande dos erros est√° associada a altera√ß√µes incorretas dos dados.  Uma solu√ß√£o para isso existe h√° muito tempo - tipos de dados imut√°veis.  Em C #, esses tipos de dados podem ser criados, mas ao custo de uma tonelada de clich√™.  No Go, isso n√£o √© poss√≠vel.  E no Elixir, todos os tipos de dados s√£o imut√°veis. <br><br>  E o √∫ltimo crit√©rio foi o n√∫mero de especialistas.  Aqui os resultados s√£o √≥bvios.  No final, optamos pelo Elixir. <br><br>  Com a escolha da hospedagem, tudo ficou muito mais simples.  J√° hospedamos servidores de jogos no Amazon GameLift. Al√©m disso, a Amazon oferece um grande n√∫mero de servi√ßos que nos permitiriam reduzir o tempo de desenvolvimento. <br><br><img src="https://habrastorage.org/webt/f2/zm/jn/f2zmjnyjejb3ffw0vhs69hvqjoi.png"><br><br>  N√≥s nos rendemos completamente √† nuvem e n√£o implantamos nenhuma solu√ß√£o de terceiros - bancos de dados, filas de mensagens - tudo isso √© gerenciado pela Amazon para n√≥s.  Na minha opini√£o, esta √© a √∫nica solu√ß√£o para uma equipe pequena que deseja desenvolver um jogo online, e n√£o a infraestrutura para ele. <br><br>  Descobrimos a escolha das tecnologias, vamos seguir como o servidor meta funciona. <br><br><img src="https://habrastorage.org/webt/q1/jy/m8/q1jym8itnftw6e3tqyvsbqh-uva.png"><br><br>  Em geral: os clientes se conectam ao balanceador de carga da Amazon por meio de conex√µes de soquete da web;  o balanceador dispersa essas conex√µes entre v√°rias inst√¢ncias de front-end, o front-end envia solicita√ß√µes de cliente para back-end.  Mas o front-end e o back-end se comunicam indiretamente, por meio de filas de mensagens.  H√° uma fila separada para cada tipo de mensagem, e o front-end, pelo tipo de mensagem, determina onde escrev√™-la, e os back-end escutam essas filas. <br><br>  Para que o back-end possa enviar uma resposta √† solicita√ß√£o ao cliente ou algum tipo de evento, cada front-end possui uma fila separada (especialmente alocada para ele).  E em cada solicita√ß√£o, o back-end recebe um identificador de front-end para determinar em qual fila a resposta deve ser gravada.  Se ele precisar enviar um evento, ele chamar√° o banco de dados para descobrir a qual inst√¢ncia de front-end o cliente est√° conectado. <br><br>  Com o esquema geral, vamos aos detalhes. <br><br><img src="https://habrastorage.org/webt/xe/rr/u-/xerru-5vn3tx-dwqbylflu18mrm.png"><br><br>  Primeiramente, falarei sobre alguns recursos da intera√ß√£o cliente-servidor.  Utilizamos nosso protocolo bin√°rio porque √© bastante eficiente e permite economizar tr√°fego.  Em segundo lugar, para quaisquer opera√ß√µes com uma conta que a altere, o servidor n√£o envia essas altera√ß√µes para o cliente, mas a vers√£o completa (atualizada) desta conta.  Isso √© um pouco menos eficiente, mas n√£o ocupa muito espa√ßo e simplifica bastante nossa vida no cliente e no servidor.  Al√©m disso, o front-end garante que o cliente n√£o execute mais de uma solicita√ß√£o por vez.  Isso permite capturar erros no cliente, por exemplo, quando ele alterna para outra tela antes de o jogador ver o resultado da opera√ß√£o anterior. <br><br>  Agora, um pouco sobre como o frontend est√° organizado. <br><br><img src="https://habrastorage.org/webt/te/-k/ff/te-kffgzvatzj_3tjwcus5lvpdk.png"><br><br>  Um front-end √© essencialmente um servidor Web que escuta conex√µes de soquete da Web.  Para cada sess√£o, dois processos s√£o criados.  O primeiro processo atende √† pr√≥pria conex√£o do soquete da Web e o segundo √© uma m√°quina de estado que descreve o estado atual do cliente.  Com base nesse estado, determina a validade das solicita√ß√µes do cliente.  Por exemplo, quase todas as solicita√ß√µes n√£o podem ser conclu√≠das at√© que a autoriza√ß√£o seja conclu√≠da.  Como n√£o h√° estado no frontend al√©m dessas sess√µes, √© muito f√°cil adicionar novas inst√¢ncias de frontend, mas √© um pouco mais dif√≠cil excluir as antigas.  Antes de desinstalar, voc√™ precisa permitir que todos os clientes concluam suas solicita√ß√µes atuais e solicite que eles se reconectem a outra inst√¢ncia. <br><br>  Agora, sobre a apar√™ncia do back-end.  No momento, ele consiste em cinco servi√ßos. <br><br><img src="https://habrastorage.org/webt/qh/cj/x4/qhcjx4ckmzg8lcqpriouhi8rnee.png"><br><br>  O primeiro trata de tudo relacionado a contas - desde compras de moeda no jogo at√© a conclus√£o de miss√µes.  O segundo trabalha com tudo relacionado a jogos - ele interage diretamente com o GameLift e os servidores de jogos.  O terceiro servi√ßo √© comprar dinheiro real.  O quarto e o quinto s√£o respons√°veis ‚Äã‚Äãpelas intera√ß√µes sociais - uma para os amigos e a outra para um jogo de festa. <br><br>  Cada um dos servi√ßos de back-end do ponto de vista da arquitetura parece absolutamente id√™ntico.  Eles s√£o um conjunto de pipelines, cada um dos quais processa um tipo de mensagem.  O pipeline consiste em dois elementos: produtor e consumidor. <br><br><img src="https://habrastorage.org/webt/ym/di/eh/ymdiehrcngon3im1my2d8nbbgsk.png"><br><br>  A √∫nica tarefa do produtor √© ler as mensagens da fila.  Portanto, √© implementado de uma forma completamente geral e, para cada pipeline, precisamos apenas indicar quantos produtores existem, de qual fila ler e quantos consumidores cada produtor atender√°.  O consumidor, por outro lado, √© implementado separadamente para cada pipeline e √© um m√≥dulo com a √∫nica fun√ß√£o obrigat√≥ria que aceita uma mensagem, faz todo o trabalho necess√°rio e retorna uma lista de mensagens que precisam ser enviadas a outros servi√ßos ao cliente ou ao servidor do jogo.  O produtor tamb√©m implementa a contrapress√£o, para que, com um aumento acentuado no n√∫mero de mensagens, n√£o haja sobrecarga, e solicite mensagens n√£o mais do que possui consumidores livres. <br><br>  Os servi√ßos de back-end n√£o cont√™m nenhum estado; portanto, √© f√°cil adicionar e remover inst√¢ncias antigas.  A √∫nica coisa a fazer antes de excluir √© pedir aos produtores que parem de ler novas mensagens e d√™ aos consumidores um tempo para concluir o processamento das mensagens ativas. <br><br>  Como acontece a intera√ß√£o com o GameLift?  O GameLift consiste em v√°rios componentes.  Entre os que usamos, esse √© um matchmaker FlexMatch, uma fila de posicionamento que determina em que regi√£o espec√≠fica ser√° realizada uma sess√£o de jogo com esses jogadores e as pr√≥prias frotas, que consistem em servidores de jogos. <br><br><img src="https://habrastorage.org/webt/c8/ge/5h/c8ge5huiowlmu5q7b9izd4sew4y.png"><br><br>  Como est√° indo essa intera√ß√£o?  Meta se comunica diretamente apenas com o casamenteiro, envia pedidos para encontrar a partida.  E ele notifica a meta de todos os eventos durante as partidas atrav√©s das mesmas filas de mensagens.  E assim que encontra um grupo adequado de jogadores para iniciar a partida, ele envia uma solicita√ß√£o para a fila de coloca√ß√£o, que por sua vez seleciona um servidor para eles. <br><br>  A intera√ß√£o da meta com o servidor do jogo √© extremamente simples.  O servidor do jogo precisa de informa√ß√µes sobre contas, bots e um mapa, e a meta envia todas essas informa√ß√µes para a fila criada especificamente para essa partida em uma √∫nica mensagem. <br><br><img src="https://habrastorage.org/webt/vv/zo/y5/vvzoy5ycub5em-qiovlo911pg0k.png"><br><br>  E o servidor do jogo, ap√≥s a ativa√ß√£o, come√ßa a ouvir essa fila e recebe todos os dados necess√°rios.  No final da partida, ele envia seus resultados para a fila geral que a meta est√° ouvindo. <br><br>  Agora vamos para a infraestrutura adicional que usamos. <br><br><img src="https://habrastorage.org/webt/l-/st/nu/l-stnuybsqrbk_be4fhlgrsdgpa.png"><br><br>  A implanta√ß√£o de servi√ßos √© bastante simples.  Todos eles trabalham em cont√™ineres de encaixe e usamos o Amazon ECS para orquestra√ß√£o.  √â muito mais simples que o Kubernetes, √© claro, menos sofisticado, mas executa as tarefas que precisamos dele.  A saber: servi√ßos de escala e lan√ßamentos cont√≠nuos, quando precisamos preencher algum tipo de corre√ß√£o de bug. <br><br>  E o √∫ltimo servi√ßo que tamb√©m usamos √© o AWS Fargate.  Isso evita que tenhamos que gerenciar de forma independente o cluster de m√°quinas nas quais nossos cont√™ineres docker s√£o executados. <br><br><img src="https://habrastorage.org/webt/q1/xl/8m/q1xl8mppdukmbjoezzm6pzlbl9k.png"><br><br>  Como armazenamento principal, usamos o DynamoDB.  Primeiro, escolhemos porque √© muito f√°cil de operar e dimensionar.  Tamb√©m usamos o Redis como armazenamento adicional por meio do servi√ßo gerenciado Amazon ElasiCache.  N√≥s o usamos para a tarefa de classifica√ß√£o global de jogadores e para armazenar informa√ß√µes b√°sicas da conta em cache em situa√ß√µes em que precisamos retornar dados de centenas de contas de jogos para o cliente imediatamente (por exemplo, na mesma tabela de classifica√ß√£o ou na lista de amigos). <br><br>  Para armazenar configura√ß√µes, mec√¢nica de meta-jogabilidade, descri√ß√µes de armas, her√≥is, etc.  usamos um arquivo JSON que anexamos √†s imagens dos servi√ßos que precisam dele.  Como √© muito mais f√°cil lan√ßar uma nova vers√£o do servi√ßo com dados atualizados (se algum bug foi descoberto) do que tomar uma decis√£o que atualizar√° dinamicamente esses dados de algum armazenamento externo em tempo de execu√ß√£o. <br><br>  Para registro e monitoramento, usamos muitos servi√ßos. <br><br><img src="https://habrastorage.org/webt/lh/ub/3u/lhub3urulc1urcn8omuxprcn0rg.png"><br><br>  Vamos come√ßar com o CloudWatch.  Este √© um servi√ßo de monitoramento no qual as m√©tricas de todos os servi√ßos da Amazon se agrupam.  Portanto, decidimos enviar as m√©tricas do nosso meta servidor para l√° tamb√©m.  E para o registro, usamos uma abordagem comum no cliente e no servidor do jogo e no meta servidor.  Enviamos todos os logs para o servi√ßo amaz√¥nico Kinesis Firehose, que por sua vez os transfere para Elasticseach e S3. <br><br>  No Elasticseach, armazenamos apenas dados relativamente recentes e, com a ajuda do Kibana, procuramos erros, resolvemos algumas das tarefas de an√°lise de jogos e constru√≠mos pain√©is operacionais, por exemplo, com um cronograma da CCU e o n√∫mero de novas instala√ß√µes.  O S3 cont√©m todos os dados hist√≥ricos e os usamos atrav√©s do servi√ßo Athena, que fornece uma interface SQL sobre os dados no S3. <br><br>  Agora um pouco sobre como usamos o Terraform. <br><br><img src="https://habrastorage.org/webt/o8/jj/-q/o8jj-qfa1hsyq1qposebwbof4dc.png"><br><br>  O Terraform √© uma ferramenta que permite descrever declarativamente a infraestrutura e, se houver alguma altera√ß√£o na descri√ß√£o, ela determina automaticamente as a√ß√µes que voc√™ precisa executar para trazer sua infraestrutura a uma apar√™ncia atualizada.  Assim, tendo uma descri√ß√£o √∫nica, obtemos um ambiente quase id√™ntico para prepara√ß√£o e produ√ß√£o.  Al√©m disso, esses ambientes s√£o completamente isolados, porque s√£o implantados em contas diferentes.  A √∫nica desvantagem significativa do Terraform para n√≥s √© o suporte incompleto do GameLift. <br><br>  Tamb√©m falarei sobre como implementamos a atualiza√ß√£o sem tempo de inatividade. <br><br><img src="https://habrastorage.org/webt/_l/ge/va/_lgevakn50wndn5tvfipi1_ujam.png"><br><br>  Quando lan√ßamos atualiza√ß√µes, criamos uma c√≥pia da maioria dos recursos: servi√ßos, filas de mensagens, alguns r√≥tulos no banco de dados.  E os jogadores que baixarem a nova vers√£o do jogo se conectar√£o a esse cluster atualizado.  Mas os jogadores que ainda n√£o atualizaram podem continuar jogando por algum tempo na vers√£o antiga do jogo, conectando-se ao cluster antigo. <br><br>  Como n√≥s o implementamos.  Primeiramente, usando o mecanismo de m√≥dulo no Terraform.  Alocamos um m√≥dulo no qual descrevemos todos os recursos com vers√£o.  E esses m√≥dulos podem ser importados v√°rias vezes, com par√¢metros diferentes.  Assim, para cada vers√£o, importamos este m√≥dulo, indicando o n√∫mero dessa vers√£o.  Al√©m disso, a aus√™ncia de um esquema no DynamoDB nos ajudou, o que possibilita realizar migra√ß√µes de dados n√£o durante a atualiza√ß√£o, mas adi√°-las para cada conta at√© que o propriet√°rio fa√ßa login na nova vers√£o do jogo.  E no balanceador, simplesmente indicamos para cada vers√£o da regra para que ela saiba para onde direcionar jogadores com vers√µes diferentes. <br><br>  Finalmente, algumas coisas que aprendemos.  Primeiro, a configura√ß√£o de toda a infraestrutura deve ser automatizada.  I.e.  montamos algumas coisas com as m√£os por um tempo, mas mais cedo ou mais tarde cometemos um erro nas configura√ß√µes, por causa das quais houve fakaps. <br><br><img src="https://habrastorage.org/webt/5i/3n/7f/5i3n7fuurk18kiak_krk6jy8w8s.png"><br><br>  E a √∫ltima coisa - voc√™ precisa ter uma r√©plica ou uma c√≥pia de backup para cada elemento da sua infraestrutura.  E se voc√™ n√£o fizer isso por algo, essa coisa em particular nos decepcionar√°. <br><br><h3>  Perguntas da plat√©ia </h3><br>  <b>- Mas n√£o se incomoda com o fato de o escalonamento autom√°tico poder ficar muito alto devido a algum tipo de erro e voc√™ receber√° muito dinheiro?</b> <br><br>  - Para dimensionamento autom√°tico, os limites ainda est√£o definidos.  N√£o definiremos um limite muito grande para n√£o cair em muito dinheiro.  Esta √© a principal solu√ß√£o + monitoramento.  Voc√™ pode definir alertas se algo estiver muito forte. <br><br>  <b>- Quais s√£o seus limites atuais?</b>  <b>Relativo √† infraestrutura atual como uma porcentagem.</b> <br><br>  - Agora, temos uma fase de teste beta aberto em 11 pa√≠ses, por isso n√£o √© uma CCU t√£o grande avaliar de alguma forma.  Agora, a infraestrutura est√° com excesso de provisionamento para o n√∫mero de pessoas que temos. <br><br>  <b>- E ainda n√£o h√° limites?</b> <br><br>  - Sim, apenas 10 a 100 vezes mais que a nossa UCC.  N√£o fa√ßa menos. <br><br>  <b>- Voc√™ disse que tem linhas entre a frente e o back-end - isso √© muito incomum.</b>  <b>Por que n√£o diretamente?</b> <br><br>  - Quer√≠amos que os servi√ßos sem estado implementassem facilmente o mecanismo de backup, para que o servi√ßo n√£o solicite mais mensagens do que possui manipuladores gratuitos.  Al√©m disso, por exemplo, quando um manipulador falha, a fila passa a mesma mensagem para outro manipulador - talvez seja bem-sucedida. <br><br>  <b>- A fila persiste de alguma forma?</b> <br><br>  Sim.  Este √© um servi√ßo SQS da Amaz√¥nia. <br><br>  <b>- Em rela√ß√£o √†s filas: quantos canais s√£o criados durante o jogo?</b>  <b>Voc√™ tem um certo n√∫mero de canais para cada partida?</b> <br><br>  - Cria relativamente pouco.  A maioria das filas, como filas de solicita√ß√£o, √© est√°tica.  H√° uma fila de pedidos de autoriza√ß√£o, h√° uma fila para o in√≠cio da partida.  Das filas criadas dinamicamente, s√≥ temos filas para cada front-end (ele cria mensagens de entrada para clientes na inicializa√ß√£o) e, para cada correspond√™ncia, criamos uma fila.  Nesse servi√ßo, n√£o custa quase nada, eles t√™m qualquer solicita√ß√£o cobrada da mesma maneira.  I.e.  qualquer solicita√ß√£o para o SQS (crie uma fila, leia algo dela) custa o mesmo e, ao mesmo tempo, n√£o exclu√≠mos essas filas para salvar, elas ser√£o exclu√≠das mais tarde.  E o fato de existirem n√£o nos custa nada. <br><br>  <b>- Nesta arquitetura, isso n√£o ser√° um limite para voc√™?</b> <br><br>  - n√£o. <br><br><h3>  Mais conversas com o Pixonic DevGAMM Talks </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando o Consul para dimensionar servi√ßos com estado</a> (Ivan Bubnov, DevOps no BIT.GAMES); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CICD: implanta√ß√£o cont√≠nua em sistemas de cluster distribu√≠dos sem tempo de inatividade</a> (Egor Panov, administrador de sistema Pixonic); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A pr√°tica de usar o modelo de ator na plataforma de back-end do jogo Quake Champions</a> (Roman Rogozin, desenvolvedor de back-end Saber Interactive); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como o ECS, o C # Job System e o SRP alteram a abordagem da arquitetura</a> (Valentin Simonov, engenheiro de campo da Unity); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Princ√≠pio do KISS em desenvolvimento</a> (Konstantin Gladyshev, programador l√≠der de jogos da 1C Game Studios); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">L√≥gica geral do jogo no cliente e no servidor</a> (Anton Grigoriev, Diretor T√©cnico Adjunto da Pixonic). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pepino na nuvem: usando scripts BDD para teste de estresse do produto</a> (Anton Kosyakin, gerente t√©cnico de produto da plataforma ALICE). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426875/">https://habr.com/ru/post/pt426875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426861/index.html">Uma nova ca√ßa √† mat√©ria escura acontece sob a montanha</a></li>
<li><a href="../pt426863/index.html">Dispon√≠vel sobre quaternions e seus benef√≠cios</a></li>
<li><a href="../pt426865/index.html">Um design de painel claro para um sofisticado sistema de gerenciamento de an√∫ncios</a></li>
<li><a href="../pt426869/index.html">Como conduzir efetivamente videoconfer√™ncias com clientes estrangeiros</a></li>
<li><a href="../pt426873/index.html">Controle autom√°tico usando acesso remoto ao registro do Windows</a></li>
<li><a href="../pt426879/index.html">Configurando um Sistema de Restri√ß√£o El√©trica para Projetos Utilizando Interfaces de Alta Velocidade</a></li>
<li><a href="../pt426881/index.html">Iniciando programas de desenvolvedor online</a></li>
<li><a href="../pt426889/index.html">Como participar de competi√ß√µes de aprendizado de m√°quina. Palestra em Yandex</a></li>
<li><a href="../pt426891/index.html">Minera√ß√£o de processos SAP ou como entender seus processos de neg√≥cios</a></li>
<li><a href="../pt426893/index.html">Como iniciar um aplicativo iOS atrav√©s do React Native</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>