<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ∏Ô∏è üìÄ ü¶ã Quatro sniffers javascript que prendem voc√™ em lojas on-line üë®üèæ‚Äçüç≥ üôÖüèª üåº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quase todos n√≥s usamos os servi√ßos de lojas on-line, o que significa que mais cedo ou mais tarde ele corre o risco de se tornar v√≠tima de sniffers Jav...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quatro sniffers javascript que prendem voc√™ em lojas on-line</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/451792/"><img src="https://habrastorage.org/webt/m2/18/ri/m218ribvsirj8bn0787eizy9oei.jpeg"><br><br>  Quase todos n√≥s usamos os servi√ßos de lojas on-line, o que significa que mais cedo ou mais tarde ele corre o risco de se tornar v√≠tima de sniffers JavaScript - um c√≥digo especial que os cibercriminosos injetam no site para roubar informa√ß√µes de cart√µes banc√°rios, endere√ßos, logins e senhas de usu√°rios. <br><br>  Quase 400.000 usu√°rios do site e aplicativo m√≥vel da companhia a√©rea British Airways, bem como visitantes do site brit√¢nico da gigante esportiva FILA e do distribuidor americano de ingressos Ticketmaster, j√° foram afetados por farejadores. <br><br>  Viktor Okorokov, analista do Threat Intelligence Group-IB, fala sobre como os sniffers s√£o incorporados no c√≥digo do site e roubam informa√ß√µes de cobran√ßa, bem como quais CRMs eles atacam. <a name="habracut"></a><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l_/b0/sa/l_b0sa5cjkma2zr779uhbfi5h8m.jpeg"></div><br><br><h2>  A Amea√ßa Fantasma </h2><br>  Descobriu-se que por muito tempo os farejadores de JS permaneceram fora da vista dos analistas de antiv√≠rus, e os bancos e sistemas de pagamento n√£o viram uma amea√ßa s√©ria neles.  E completamente em v√£o.  Os especialistas do Grupo-IB <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">analisaram</a> 2.440 lojas on-line infectadas cujos visitantes - cerca de 1,5 milh√£o de pessoas por dia - corriam risco de se comprometer.  Entre as v√≠timas est√£o n√£o apenas usu√°rios, mas tamb√©m lojas online, sistemas de pagamento e bancos que emitiram cart√µes comprometidos. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O relat√≥rio do</a> Group-IB foi o primeiro estudo do mercado darknet para sniffers, sua infraestrutura e formas de monetizar, trazendo aos seus criadores milh√µes de d√≥lares.  Identificamos 38 fam√≠lias de farejadores, das quais apenas 12 eram conhecidas anteriormente pelos pesquisadores. <br><br>  Vamos nos aprofundar nas quatro fam√≠lias de farejadores estudadas durante o estudo. <br><br><h2>  Fam√≠lia ReactGet </h2><br>  Os sniffers da fam√≠lia ReactGet s√£o usados ‚Äã‚Äãpara roubar dados de cart√µes banc√°rios em sites de lojas online.  Um farejador pode trabalhar com um grande n√∫mero de sistemas de pagamento diferentes usados ‚Äã‚Äãno site: um valor de par√¢metro corresponde a um sistema de pagamento, e vers√µes individuais do farejador detectado podem ser usadas para roubar credenciais, bem como para roubar dados de cart√£o banc√°rio de formas de pagamento de v√°rios sistemas de pagamento de uma s√≥ vez, como o chamado sniffer universal.  Verificou-se que, em alguns casos, os invasores realizam ataques de phishing contra administradores de lojas on-line, a fim de obter acesso ao painel administrativo do site. <br><br>  A campanha usando essa fam√≠lia de sniffers come√ßou em maio de 2017, sites sob o controle do CMS e as plataformas Magento, Bigcommerce, Shopify foram atacadas. <br><br><h3>  Como o ReactGet est√° incorporado no c√≥digo da loja online </h3><br>  Al√©m da implementa√ß√£o ‚Äúcl√°ssica‚Äù de um script por refer√™ncia, a fam√≠lia de sniffers ReactGet usa uma t√©cnica especial: usando o c√≥digo JavaScript, ele verifica se o endere√ßo atual em que o usu√°rio est√° localizado atende a certos crit√©rios.  O c√≥digo malicioso ser√° iniciado somente se o URL atual contiver o <b>checkout de</b> substring ou o <b>checkout</b> <b>posterior</b> , uma <b>p√°gina /</b> , <b>sa√≠da / uma p√°gina</b> , <b>caixa / uma</b> , <b>ckout / uma</b> .  Assim, o c√≥digo sniffer ser√° executado exatamente no momento em que o usu√°rio pagar pelas compras e inserir as informa√ß√µes de pagamento no formul√°rio do site. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kz/fz/lr/kzfzlrityshdouqlvh5ns14vlhm.png"></div><br>  Este farejador usa uma t√©cnica n√£o padr√£o.  O pagamento e os dados pessoais da v√≠tima s√£o coletados juntos, codificados usando <b>base64</b> e a sequ√™ncia resultante √© usada como par√¢metro para enviar uma solicita√ß√£o ao site do invasor.  Na maioria das vezes, o caminho para o port√£o simula um arquivo JavaScript, por exemplo, <b>resp.js</b> , <b>data.js</b> e assim por diante, mas tamb√©m <b>s√£o</b> usados ‚Äã‚Äãlinks para arquivos de imagem, <b>GIFs</b> e <b>JPGs</b> .  A peculiaridade √© que o sniffer cria um objeto de imagem com um tamanho de 1 por 1 pixel e usa o link obtido anteriormente como um par√¢metro <b>src</b> da imagem.  Ou seja, para o usu√°rio, essa solicita√ß√£o no tr√°fego parecer√° uma solicita√ß√£o de imagem regular.  Uma t√©cnica semelhante foi usada nos farejadores da fam√≠lia ImageID.  Al√©m disso, a t√©cnica de usar uma imagem de 1 por 1 pixel √© usada em muitos scripts de an√°lise online leg√≠timos, o que tamb√©m pode induzir o usu√°rio em erro. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jo/bf/xm/jobfxmbqsrjqolrvo84fkstgrhi.png"></div><br><h3>  An√°lise de vers√£o </h3><br>  Uma an√°lise dos dom√≠nios ativos usados ‚Äã‚Äãpelos operadores de farejadores ReactGet revelou muitas vers√µes diferentes da fam√≠lia de farejadores.  As vers√µes diferem na presen√ßa ou aus√™ncia de ofusca√ß√£o e, al√©m disso, cada sniffer √© projetado para um sistema de pagamento espec√≠fico que processa pagamentos com cart√£o banc√°rio em lojas online.  Depois de classificar o valor do par√¢metro correspondente ao n√∫mero da vers√£o, os especialistas do Grupo-IB obtiveram uma lista completa das varia√ß√µes dispon√≠veis do sniffer e, pelos nomes dos campos de formul√°rio que cada sniffer procura no c√≥digo da p√°gina, determinaram os sistemas de pagamento aos quais o sniffer se destina. <br><br><div class="spoiler">  <b class="spoiler_title">Lista de farejadores e seus sistemas de pagamento correspondentes</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  URL do sniffer <br></th><th width="200">  Sistema de pagamento <br></th></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.1</a> </td><td align="center">  Cardsards <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.6</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.7</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.1</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.3</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.5</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.6</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.7</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.3.0</a> </td><td align="center">  Stripe <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.2</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.4</a> </td><td align="center">  Linkpoint </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.5</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.8</a> </td><td align="center">  Datacash <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">asianfoodgracer.com/footer.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.5</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.7</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=2.0</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.4</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.6</a> <br></td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.7</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.8</a> </td><td align="center">  Chase Paymentech <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.91</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.92</a> </td><td align="center">  Psigate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.93</a> </td><td align="center">  Fonte cibern√©tica </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.95</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.97</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">geisseie.com/gs.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/age.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.6</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.7</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.0</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.2</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.5</a> </td><td align="center">  Fonte cibern√©tica <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.9</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.0</a> </td><td align="center">  Fonte cibern√©tica </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.7</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.9</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.2</a> </td><td align="center">  Primeiro gateway global de dados <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.5</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.4.0</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">maxstatics.com/site.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=funlove.com</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=qbedding.com</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=vseyewear.com</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.4</a> </td><td align="center">  Stripe </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.10</a> </td><td align="center">  Braintree <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.3</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.31</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.33</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.4</a> </td><td align="center">  Stripe </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.3</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.31</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.33</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/cnt.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/j.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.5</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.6</a> </td><td align="center">  Westpac payway <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.0</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.3</a> </td><td align="center">  Stripe <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.4</a> </td><td align="center">  Primeiro gateway global de dados <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.5</a> </td><td align="center">  Psigate </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.8</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.1</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.3</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.6</a> </td><td align="center">  Linkpoint <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.7</a> </td><td align="center">  Westpac payway <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.3</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.6</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.7</a> </td><td align="center">  EBizCharge <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.1.2</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.11</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.12</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.13</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.14</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.15</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.16</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.17</a> </td><td align="center">  Westpac payway <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.18</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.19</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.21</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.22</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.23</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.24</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.25</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.29</a> </td><td align="center">  Fonte cibern√©tica <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.4</a> </td><td align="center">  PayPal Payflow Pro <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.3</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.5</a> </td><td align="center">  Stripe <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.2</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.2</a> </td><td align="center">  Flint </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.5</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.51</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.8</a> </td><td align="center">  Stripe </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.9</a> </td><td align="center">  Zebra gorda <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.0</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.2</a> </td><td align="center">  Primeiro gateway global de dados <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.5</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.8</a> </td><td align="center">  QuickBooks Merchant Services <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.91</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.92</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.94</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.3.97</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.5</a> </td><td align="center">  Pagamento prudente </td></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">sydneysalonsupplies.com/gtm.js</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagsmediaget.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.2</a> </td><td align="center">  ANZ eGate </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.5</a> </td><td align="center">  Fonte cibern√©tica </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.7</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.8</a> </td><td align="center">  Pagamento prudente </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.9</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.0</a> </td><td align="center">  Fonte cibern√©tica </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.4</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.7</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.8</a> </td><td align="center">  Pagamento prudente <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.9</a> <br></td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.0</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.2</a> </td><td align="center">  Primeiro gateway global de dados <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.5</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr></tbody></table></div><br></div></div><br><h3>  Detector de senhas <br></h3><br>  Uma das vantagens dos farejadores de JavaScript que trabalham no lado do cliente do site √© a sua versatilidade: o c√≥digo malicioso incorporado no site pode roubar qualquer tipo de dados, sejam dados de pagamento ou nome de usu√°rio e senha de uma conta de usu√°rio.  Os especialistas do grupo-IB descobriram uma amostra de um sniffer pertencente √† fam√≠lia ReactGet, projetado para roubar endere√ßos de email e senhas dos usu√°rios do site. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7x/9c/x1/7x9cx1en90ze5etozgc6jmg5eh8.png"></div><br><h3>  Interse√ß√£o com ImageID Sniffer <br></h3><br>  Uma an√°lise de uma das lojas infectadas revelou que seu site foi infectado duas vezes: al√©m do c√≥digo malicioso da fam√≠lia de farejadores ReactGet, um c√≥digo de farejador da fam√≠lia ImageID foi detectado.  Essa interse√ß√£o pode indicar que os operadores por tr√°s do uso de ambos os farejadores usam t√©cnicas semelhantes para injetar c√≥digo malicioso. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8s/m0/ed/8sm0edvplxoguwsczm9ja3-g_ng.png"></div><br><h3>  Farejador universal <br></h3><br>  Uma an√°lise de um dos nomes de dom√≠nio relacionados √† infraestrutura do sniffer ReactGet revelou que o mesmo usu√°rio havia registrado outros tr√™s nomes de dom√≠nio.  Esses tr√™s dom√≠nios simulavam dom√≠nios de sites da vida real e eram usados ‚Äã‚Äãanteriormente para hospedar sniffers.  Ao analisar o c√≥digo de tr√™s sites leg√≠timos, um sniffer desconhecido foi descoberto e outras an√°lises mostraram que esta √© uma vers√£o aprimorada do sniffer ReactGet.  Todas as vers√µes rastreadas anteriormente dos sniffers dessa fam√≠lia visavam um sistema de pagamento √∫nico, ou seja, para cada sistema de pagamento era necess√°ria uma vers√£o especial do sniffer.  No entanto, nesse caso, uma vers√£o universal do sniffer foi descoberta, capaz de roubar informa√ß√µes de formul√°rios relacionados a 15 sistemas de pagamento diferentes e m√≥dulos de sites de com√©rcio eletr√¥nico para pagamentos online. <br><br>  Assim, no in√≠cio do trabalho, o farejador procurou os campos base do formul√°rio que continham as informa√ß√µes pessoais da v√≠tima: nome completo, endere√ßo f√≠sico, n√∫mero de telefone. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g_/py/vs/g_pyvsjovjp7p6x2vlqzaqho5ey.png"></div><br>  Em seguida, o farejador procurou mais de 15 prefixos diferentes correspondentes a diferentes sistemas e m√≥dulos de pagamento para pagamentos on-line. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ty/as/ddtyasulurz4un7owfvlv-3xepu.png"></div><br>  Al√©m disso, os dados pessoais e as informa√ß√µes de pagamento da v√≠tima foram coletados e enviados para o site controlado pelo atacante: nesse caso espec√≠fico, foram encontradas duas vers√µes do sniffer universal ReactGet, localizadas em dois sites invadidos.  No entanto, ambas as vers√µes enviaram os dados roubados para o mesmo site hackeado <b>zoobashop.com</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/mt/tb/eemttbv-vdn0ff9ncd3siqfzokq.png"></div><br>  Uma an√°lise dos prefixos usados ‚Äã‚Äãpelo farejador para procurar os campos que cont√™m as informa√ß√µes de pagamento da v√≠tima nos permitiu determinar que esse padr√£o do farejador se destinava aos seguintes sistemas de pagamento: <br><br><ul><li>  <b>Authorize.Net</b> </li><li>  <b>Verisign</b> </li><li>  <b>Primeiros dados</b> </li><li>  <b>USAePay</b> </li><li>  <b>Stripe</b> </li><li>  <b>Paypal</b> </li><li>  <b>ANZ eGate</b> </li><li>  <b>Braintree</b> </li><li>  <b>DataCash (MasterCard)</b> </li><li>  <b>Realex pagamentos</b> </li><li>  <b>Psigate</b> </li><li>  <b>Sistemas de pagamento Heartland</b> </li></ul><br><h3>  Quais ferramentas s√£o usadas para roubar informa√ß√µes de cobran√ßa? <br></h3><br>  A primeira ferramenta descoberta durante a an√°lise da infraestrutura do invasor √© usada para ofuscar scripts maliciosos respons√°veis ‚Äã‚Äãpor roubar cart√µes banc√°rios.  Um script bash foi descoberto em um dos hosts atacantes usando a CLI <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">javascript-obfuscator</a></b> para automatizar a ofusca√ß√£o do c√≥digo sniffer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5m/aw/lu/5mawlut23obt6lpoa3ed2luu8ss.png"></div><br>  A segunda ferramenta detectada foi projetada para gerar c√≥digo respons√°vel pelo carregamento do sniffer principal.  Essa ferramenta gera c√≥digo JavaScript que verifica se o usu√°rio est√° na p√°gina de pagamento, pesquisando no endere√ßo atual do usu√°rio as <b>caixas</b> , <b>carrinho</b> e assim por diante. Se o resultado for positivo, o c√≥digo carrega o sniffer principal do servidor do invasor.  Para ocultar atividades maliciosas, todas as linhas, incluindo as linhas de teste para determinar a p√°gina de pagamento, bem como um link para o sniffer, s√£o codificadas usando <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vn/ew/ym/vnewymbt1r6nc8n98roze5drnnk.png"></div><br><h3>  Ataques de phishing <br></h3><br>  Ao analisar a infraestrutura de rede dos atacantes, verificou-se que muitas vezes um grupo criminoso usa phishing para obter acesso ao painel administrativo da loja on-line de destino.  Os invasores registram um dom√≠nio visualmente semelhante ao dom√≠nio de uma loja e, em seguida, implantam um formul√°rio de login falso no painel de administra√ß√£o do Magento.  Se for bem-sucedido, os invasores ter√£o acesso ao painel de administra√ß√£o do CMS Magento, que permite editar os componentes do site e implementar um sniffer para roubar informa√ß√µes do cart√£o de cr√©dito. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yf/-a/lz/yf-alzxabbg_kij0vkaq5qcr9vs.png"></div><br><div class="spoiler">  <b class="spoiler_title">A infraestrutura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Dom√≠nio <br></th><th width="200">  Data da descoberta / apar√™ncia <br></th></tr><tr><td align="center">  mediapack.info </td><td align="center">  05/04/2017 <br></td></tr><tr><td align="center">  adsgetapi.com </td><td align="center">  15/06/2017 <br></td></tr><tr><td align="center">  simcounter.com </td><td align="center">  14/08/2017 </td></tr><tr><td align="center">  mageanalytics.com </td><td align="center">  22/12/2017 </td></tr><tr><td align="center">  maxstatics.com </td><td align="center">  16/01/2018 <br></td></tr><tr><td align="center">  reactjsapi.com </td><td align="center">  19/01/2018 </td></tr><tr><td align="center">  mxcounter.com </td><td align="center">  02/02/2018 </td></tr><tr><td align="center">  apitstatus.com </td><td align="center">  01/03/2018 <br></td></tr><tr><td align="center">  orderracker.com </td><td align="center">  20/04/2018 <br></td></tr><tr><td align="center">  tagstracking.com </td><td align="center">  25/06/2018 <br></td></tr><tr><td align="center">  adsapigate.com </td><td align="center">  12/07/2018 <br></td></tr><tr><td align="center">  trust-tracker.com </td><td align="center">  15/07/2018 <br></td></tr><tr><td align="center">  fbstatspartner.com </td><td align="center">  02/10/2018 <br></td></tr><tr><td align="center">  billgetstatus.com </td><td align="center">  12/12/2018 </td></tr><tr><td align="center">  aldenmlilhouse.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  balletbeautlful.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  bargalnjunkie.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  payselector.com </td><td align="center">  21.10.2018 <br></td></tr><tr><td align="center">  tagsmediaget.com </td><td align="center">  11/11/2018 <br></td></tr><tr><td align="center">  hs-payments.com </td><td align="center">  16/11/2018 <br></td></tr><tr><td align="center">  ordercheckpays.com </td><td align="center">  19/11/2018 <br></td></tr><tr><td align="center">  geisseie.com </td><td align="center">  24/11/2018 <br></td></tr><tr><td align="center">  gtmproc.com </td><td align="center">  29/11/2018 <br></td></tr><tr><td align="center">  livegetpay.com </td><td align="center">  18/12/2018 <br></td></tr><tr><td align="center">  sydneysalonsupplies.com </td><td align="center">  18/12/2018 <br></td></tr><tr><td align="center">  newrelicnet.com <br></td><td align="center">  19/12/2018 <br></td></tr><tr><td align="center">  nr-public.com </td><td align="center">  01/03/2019 </td></tr><tr><td align="center">  cloudodesc.com </td><td align="center">  01/04/2019 <br></td></tr><tr><td align="center">  ajaxstatic.com </td><td align="center">  11/01/2019 <br></td></tr><tr><td align="center">  livecheckpay.com </td><td align="center">  21/01/2019 <br></td></tr><tr><td align="center">  asianfoodgracer.com </td><td align="center">  25/01/2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Fam√≠lia G-analytics <br></h2><br>  Essa fam√≠lia de sniffers √© usada para roubar cart√µes de clientes de lojas online.  O primeiro nome de dom√≠nio usado pelo grupo foi registrado em abril de 2016, o que pode indicar o in√≠cio da atividade do grupo em meados de 2016. <br><br>  Na campanha atual, o grupo usa nomes de dom√≠nio que imitam servi√ßos da vida real, como Google Analytics e jQuery, mascarando atividades de sniffer com scripts leg√≠timos e semelhantes a nomes de dom√≠nio leg√≠timos.  O ataque foi executado em sites executando o CMS Magento. <br><br><h3>  Como o G-Analytics √© incorporado no c√≥digo da loja online <br></h3><br>  Uma caracter√≠stica distintiva dessa fam√≠lia √© o uso de v√°rios m√©todos de roubo das informa√ß√µes de pagamento do usu√°rio.  Al√©m da implementa√ß√£o cl√°ssica do c√≥digo JavaScript na parte do cliente do site, o grupo criminoso tamb√©m usou a t√©cnica de incorpora√ß√£o de c√≥digo na parte do servidor do site, ou seja, scripts PHP que processam a entrada do usu√°rio.  Essa t√©cnica √© perigosa, pois dificulta a pesquisa de c√≥digos maliciosos por pesquisadores de terceiros.  Os especialistas do grupo IB descobriram uma vers√£o de um sniffer incorporado ao c√≥digo PHP do site, usando o dom√≠nio <b>dittm.org</b> como porta. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ud/m_/dk/udm_dkzu4pw_4pbxhrstk0e9oo8.png"></div><br>  Uma vers√£o anterior do sniffer tamb√©m foi descoberta, que usa o mesmo dom√≠nio <b>dittm.org</b> para coletar dados roubados, mas essa vers√£o j√° foi projetada para instala√ß√£o no lado do cliente da loja online. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kr/0m/nh/kr0mnhgtjfxqs5lftvx53ofrm54.png"></div><br>  Mais tarde, o grupo mudou de t√°tica e come√ßou a prestar mais aten√ß√£o √† oculta√ß√£o de atividades e disfarces maliciosos. <br><br>  No in√≠cio de 2017, o grupo come√ßou a usar o dom√≠nio <b>jquery-js.com</b> , que se disfar√ßa de CDN para jQuery: quando <b>acessa</b> o site de intrusos, o usu√°rio √© redirecionado para o site leg√≠timo <b>jquery.com</b> . <br><br>  E em meados de 2018, o grupo adotou o nome de dom√≠nio <b>g-analytics.com</b> e come√ßou a mascarar as atividades do sniffer no servi√ßo leg√≠timo do Google Analytics. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rd/fj/mj/rdfjmj8foi7qtcv_fi_lix69a4u.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y3/xp/24/y3xp24ypsp9vloflbz5lbnrrfnk.png"></div><br><h3>  An√°lise de vers√£o <br></h3><br>  Durante a an√°lise dos dom√≠nios usados ‚Äã‚Äãpara armazenar o c√≥digo sniffer, verificou-se que o site possui um grande n√∫mero de vers√µes que diferem pela presen√ßa de ofusca√ß√£o, bem como a presen√ßa ou aus√™ncia de c√≥digo inacess√≠vel adicionado ao arquivo para distrair a aten√ß√£o e ocultar o c√≥digo malicioso. <br><br>  No total, seis vers√µes dos sniffers foram identificadas no <b>jquery-js.com</b> .  Esses sniffers enviam os dados roubados para o endere√ßo localizado no mesmo site que o sniffer: <b>hxxps: // jquery-js [.] Com / latest / jquery.min.js</b> : <br><br><ul><li>  <b>hxxps: // jquery-js [.] com / jquery.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.2.2.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.8.3.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.6.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.4.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.12.4.min.js</b> </li></ul><br>  O dom√≠nio <b>g-analytics.com</b> , usado pelo grupo em ataques desde meados de 2018, serve como reposit√≥rio para um n√∫mero maior de farejadores.  Um total de 16 vers√µes diferentes do sniffer foram descobertas.  Nesse caso, a porta para enviar os dados roubados foi disfar√ßada como um link para uma imagem <b>GIF</b> : <b>hxxp: // g-analytics [.] Com / __ utm.gif? V = 1 &amp; _v = j68 &amp; a = 98811130 &amp; t = pageview &amp; _s = 1 &amp; sd = 24 bits &amp; sr = 2560x1440 &amp; vp = 2145x371 &amp; je = 0 &amp; _u = AACAAEAB ~ &amp; jid = 1841704724 &amp; gjid = 877686936 &amp; cid</b> <b><br></b>  <b>= 1283183910.1527732071</b> : <br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.1 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.10 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.11 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.12 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.13 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.14 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.15 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.16 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.3 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.4 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.5 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.6 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.7 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.8 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.9 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / analytics.js</font></font></b> </li></ul><br><h3>    <br></h3><br>     ,       ,   .  ,  ,  ,  <b>google-analytics.cm</b>     ,    <b>cardz.vc</b> .  <b>cardz.vc</b>         Cardsurfs (Flysurfs),           AlphaBay      ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k6/l6/-w/k6l6-wxdifwkyfd-kq-3xicgsdq.png"></div><br>   <b>analytic.is</b> ,     ,   ,      ,  Group-IB  ,   Cookie-, , ,    .        <b>iozoz.com</b> ,        ,   2016 . ,            .      email- <b>kts241@gmail.com</b> ,        <b>cardz.su</b>  <b>cardz.vc</b> ,     Cardsurfs. <br><br>    ,   ,    G-Analytics        Cardsurfs      ,       ,    . <br><br><div class="spoiler">  <b class="spoiler_title">A infraestrutura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  <br></th><th width="200">  / <br></th></tr><tr><td align="center"> iozoz.com </td><td align="center"> 08.04.2016 </td></tr><tr><td align="center"> dittm.org </td><td align="center"> 10.09.2016 <br></td></tr><tr><td align="center"> jquery-js.com </td><td align="center"> 02.01.2017 </td></tr><tr><td align="center"> g-analytics.com </td><td align="center"> 31.05.2018 <br></td></tr><tr><td align="center"> google-analytics.is </td><td align="center"> 21.11.2018 <br></td></tr><tr><td align="center"> analytic.to </td><td align="center"> 04.12.2018 </td></tr><tr><td align="center"> google-analytics.to </td><td align="center"> 06.12.2018 <br></td></tr><tr><td align="center"> google-analytics.cm </td><td align="center"> 28.12.2018 <br></td></tr><tr><td align="center"> analytic.is </td><td align="center"> 28.12.2018 <br></td></tr><tr><td align="center"> googlc-analytics.cm </td><td align="center"> 17.01.2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Illum </h2><br> Illum ‚Äî  ,     -,    CMS Magento.    ,          ,       . <br><br>    ,     ,      , ,   ,        .        ,  ,  ,       2016 . <br><br><h3>  Illum    - </h3><br>          .      <b>cdn.illum[.]pw/records.php</b> ,       <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/ek/gs/m0ekgsjvued_xicxubpz6dprhag.png"></div><br>      ,    ‚Äî <b>records.nstatistics[.]com/records.php</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/zq/3d/yyzq3dtgunc6ansnwrk2eun4mjy.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> Willem de Groot,      ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> ,     CSU. <br><br><h3>    <br></h3><br>  Group-IB    ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/ze/i3/dmzei3jrukearwtcs-9ch_b2nue.png"></div><br>  ,    ,           Linux:  , Linux Privilege Escalation Check Script,    (Mike Czumak),     CVE-2009-1185. <br><br>     -    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>      <b>core_config_data</b>    CVE-2016-4010, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>    RCE    CMS Magento,       -. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j7/st/5r/j7st5ryg0ixjehutzjvneckqaw8.jpeg"></div><br>              ,         .      ,        ,       CMS      .  ,  <b>segapay_standart.js</b>  <b>segapay_onpage.js</b>     ,    Sage Pay. <br><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  </th><th width="200">   </th></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/visiondirect.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/topdierenshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/tiendalenovo.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/pro-bolt.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/plae.co.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/ottolenghi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/oldtimecandy.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/mylook.ee.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/luluandsky.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/julep.com.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/gymcompany.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/grotekadoshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/fushi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/fareastflora.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs_special/compuindia.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs/segapay_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs/segapay_onpage.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs/replace_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs/all_inputs.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/mjs/add_inputs_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/magento/payment_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/magento/payment_redirect.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/magento/payment_redcrypt.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sr.illum</a> [.]pw/magento/payment_forminsite.js </td><td align="center"> //paymentnow[.]tk/?payment= <br></td></tr></tbody></table></div><br></div></div><br>  <b>paymentnow[.]tk</b> ,      <b>payment_forminsite.js</b> ,    <b>subjectAltName</b>   ,    CloudFlare.  ,     <b>evil.js</b> .    ,        CVE-2016-4010,        footer    CMS Magento.        <b>request.requestnet[.]tk</b> ,    ,    <b>paymentnow[.]tk</b> . <br><br><h3>    <br></h3><br>          .        -    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/vz/9b/vdvz9bvo34cv-5sp86ost9kadvg.png"></div><br>    ‚Äî     PayPal,           . <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6o/rk/92/6ork92ddgqisrzpksczgd-gcwyu.png"></div><br><div class="spoiler">  <b class="spoiler_title">A infraestrutura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  <br></th><th width="200">  / </th></tr><tr><td align="center"> cdn.illum.pw </td><td align="center"> 27/11/2016 <br></td></tr><tr><td align="center"> records.nstatistics.com </td><td align="center"> 06/09/2018 <br></td></tr><tr><td align="center"> request.payrightnow.cf </td><td align="center"> 25/05/2018 <br></td></tr><tr><td align="center"> paymentnow.tk </td><td align="center"> 16/07/2017 <br></td></tr><tr><td align="center"> payment-line.tk </td><td align="center"> 01/03/2018 <br></td></tr><tr><td align="center"> paymentpal.cf </td><td align="center"> 04/09/2017 <br></td></tr><tr><td align="center"> requestnet.tk </td><td align="center"> 28/06/2017 <br></td></tr></tbody></table></div><br></div></div><br><h2>  CoffeMokko </h2><br>   CoffeMokko,       -,      2017 . ,        Group 1,   RiskIQ  2016 .       CMS,  Magento, OpenCart, WordPress, osCommerce, Shopify. <br><br><h3>  CoffeMokko    - </h3><br>         :      <b>src</b>  <b>js</b>   .          . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/pz/s8/wnpzs8nq8gwew8hgxkmhocu8nv0.png"></div><br>        ,     .   ,      ,        . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fh/pj/am/fhpjamaj2zikswysse44wophdxq.png"></div><br>          ,      :           ,    ,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ia/wz/qw/iawzqwyetk6kadgy3hjgcbhalgi.png"></div><br>           <b>/savePayment/index.php  /tr/index.php</b> . ,           ,     .            <b>base64</b> ,      : <br><br><ul><li>  ¬´e¬ª   ¬´:¬ª </li><li>  ¬´w¬ª   ¬´+¬ª </li><li>  ¬´o¬ª   ¬´%¬ª </li><li>  ¬´d¬ª   ¬´#¬ª </li><li>  ¬´a¬ª   ¬´-¬ª </li><li>  ¬´7¬ª   ¬´^¬ª </li><li>  ¬´h¬ª   ¬´_¬ª </li><li>  ¬´T¬ª   ¬´@¬ª </li><li>  ¬´0¬ª   ¬´/¬ª </li><li>  ¬´Y¬ª   ¬´*¬ª </li></ul><br>        <b>base64</b>   ,    . <br><br>     ,   : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iv/rw/jv/ivrwjvwtjyflx73jxnzyedtgqxw.png"></div><br><h3>   <br></h3><br>       ,      -.           TLD.       ,       . <br><br>      ,      jQuery ( <b>slickjs[.]org</b>  ,   <b>slick.js</b> ),   ( <b>sagecdn[.]org</b>  ,    Sage Pay). <br><br>     ,          ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/8p/mc/nc8pmckp6ig-wh6zqiflqsvvuv8.png"></div><br>    ,     <b>/js</b>  <b>/src</b> .      :       .        ,                . <br><br><h3>   <br></h3><br><h4>    <br></h4><br>  Em algumas amostras detectadas de sniffer dessa fam√≠lia, o c√≥digo foi ofuscado e continha os dados criptografados necess√°rios para o sniffer funcionar: em particular, o endere√ßo do sniffer gate, uma lista de campos da forma de pagamento e, em alguns casos, um c√≥digo falso da forma de pagamento.  No c√≥digo dentro da fun√ß√£o, os recursos foram criptografados usando o <b>XOR</b> usando a chave, que foi passada pelo argumento da mesma fun√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uu/io/h2/uuioh2egdec0k1wpsa4wxti_1qc.png"></div><br>  Ap√≥s descriptografar a sequ√™ncia com a chave correspondente, exclusiva para cada amostra, √© poss√≠vel obter uma sequ√™ncia contendo todas as linhas do c√≥digo sniffer atrav√©s do caractere delimitador. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yi/ma/ch/yimachmb5zfakdeqn-u4v-dwesc.png"></div><br><h4>  Segundo algoritmo de ofusca√ß√£o <br></h4><br>  Em amostras farejadoras posteriores dessa fam√≠lia, um mecanismo de ofusca√ß√£o diferente foi usado: nesse caso, os dados foram criptografados usando um algoritmo auto-escrito.  Uma sequ√™ncia contendo os dados criptografados necess√°rios para o sniffer funcionar foi passada como argumento para a fun√ß√£o de descriptografia. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/co/hs/bi/cohsbisd1wm4g_46sclbiq-wngc.png"></div><br>  Usando o console do navegador, voc√™ pode descriptografar os dados criptografados e obter uma matriz contendo recursos de sniffer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/zw/eh/a8zweh8fi_s1p6x-pgl6l7ugfei.png"></div><br><h3>  Liga√ß√£o aos primeiros ataques do MageCart <br></h3><br>  Uma an√°lise de um dos dom√≠nios usados ‚Äã‚Äãpelo grupo como uma porta para coletar os dados roubados revelou que o dom√≠nio possui uma infraestrutura de roubo de cart√£o de cr√©dito id√™ntica √† usada pelo Grupo 1, um dos primeiros grupos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descobertos</a> por especialistas do RiskIQ. <br><br>  Dois arquivos foram encontrados no host da fam√≠lia de sniffer CoffeMokko: <br><br><ul><li>  <b>mage.js</b> - arquivo que cont√©m o c√≥digo sniffer do Grupo 1 com o endere√ßo de porta <b>js-cdn.link</b> </li><li>  <b>mag.php</b> - Script PHP respons√°vel por coletar dados roubados por sniffer </li></ul><br><div class="spoiler">  <b class="spoiler_title">Conte√∫do do arquivo Mage.js</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/84/mx/99/84mx99wtkbnzni7faierof1lxbs.png"></div></div></div><br>  Tamb√©m foi constatado que os dom√≠nios mais antigos usados ‚Äã‚Äãpelo grupo por tr√°s da fam√≠lia de sniffer CoffeMokko foram registrados em 17 de maio de 2017: <br><br><ul><li>  <b>link-js [.] link</b> </li><li>  <b>link info-js [.]</b> </li><li>  <b>link track-js [.]</b> </li><li>  <b>link map-js [.]</b> </li><li>  <b>link smart-js [.]</b> </li></ul><br>  O formato desses nomes de dom√≠nio √© o mesmo que os nomes de dom√≠nio do Grupo 1 usados ‚Äã‚Äãnos ataques de 2016. <br><br>  Com base nos fatos descobertos, pode-se supor que exista uma conex√£o entre os operadores de farejadores CoffeMokko e o grupo criminoso do Grupo 1.  Presumivelmente, os operadores do CoffeMokko poderiam emprestar ferramentas e software para roubo de cart√µes de seus antecessores.  No entanto, √© mais prov√°vel que o grupo criminoso por tr√°s do uso da fam√≠lia de farejadores CoffeMokko seja a mesma pessoa que realizou os ataques como parte das atividades do Grupo 1. Ap√≥s a publica√ß√£o do primeiro relat√≥rio sobre as atividades do grupo criminoso, todos os seus nomes de dom√≠nio foram bloqueados e as ferramentas foram cuidadosamente estudadas e s√£o descritos.  O grupo foi for√ßado a fazer uma pausa, refinar suas ferramentas internas e reescrever o c√≥digo sniffer para continuar seus ataques e passar despercebido. <br><br><div class="spoiler">  <b class="spoiler_title">A infraestrutura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Dom√≠nio </th><th width="200">  Data da descoberta / apar√™ncia </th></tr><tr><td align="center">  link-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  info-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  track-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  map-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  smart-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  adorebeauty.org </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  security-payment.su </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  braincdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  sagecdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  slickjs.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  oakandfort.org </td><td align="center">  09/10/2017 </td></tr><tr><td align="center">  citywlnery.org </td><td align="center">  15/09/2017 </td></tr><tr><td align="center">  dobell.su </td><td align="center">  10/04/2017 </td></tr><tr><td align="center">  childsplayclothing.org </td><td align="center">  31/10/2017 </td></tr><tr><td align="center">  jewsondirect.com </td><td align="center">  11/05/2017 </td></tr><tr><td align="center">  shop-rnib.org </td><td align="center">  15/11/2017 </td></tr><tr><td align="center">  closetlondon.org </td><td align="center">  16/11/2017 </td></tr><tr><td align="center">  misshaus.org </td><td align="center">  28/11/2017 </td></tr><tr><td align="center">  battery-force.org </td><td align="center">  01/12/2017 </td></tr><tr><td align="center">  kik-vape.org </td><td align="center">  01/12/2017 </td></tr><tr><td align="center">  greatfurnituretradingco.org </td><td align="center">  02/12/2017 </td></tr><tr><td align="center">  etradesupply.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  replaceemyremote.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  all-about-sneakers.org </td><td align="center">  05/05/2017 </td></tr><tr><td align="center">  mage-checkout.org </td><td align="center">  05/05/2017 </td></tr><tr><td align="center">  nililotan.org </td><td align="center">  12/07/2017 </td></tr><tr><td align="center">  lamoodbighats.net </td><td align="center">  12/08/2017 </td></tr><tr><td align="center">  walletgear.org </td><td align="center">  10/12/2017 </td></tr><tr><td align="center">  dahlie.org </td><td align="center">  12/12/2017 </td></tr><tr><td align="center">  davidsfootwear.org </td><td align="center">  20/12/2017 </td></tr><tr><td align="center">  blackriverimaging.org </td><td align="center">  23/12/2017 </td></tr><tr><td align="center">  exrpesso.org </td><td align="center">  01/02/2018 </td></tr><tr><td align="center">  parks.su </td><td align="center">  09/09/2018 </td></tr><tr><td align="center">  pmtonline.su </td><td align="center">  01/12/2018 </td></tr><tr><td align="center">  ottocap.org </td><td align="center">  15/01/2018 </td></tr><tr><td align="center">  christohperward.org </td><td align="center">  27/01/2018 </td></tr><tr><td align="center">  coffetea.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  energycoffe.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  energytea.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  teacoffe.net </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  adaptivecss.org </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  coffemokko.com </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  londontea.net </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  ukcoffe.com </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  labbe.biz </td><td align="center">  20/03/2018 </td></tr><tr><td align="center">  batterynart.com </td><td align="center">  04/03/2018 </td></tr><tr><td align="center">  btosports.net </td><td align="center">  09/09/2018 </td></tr><tr><td align="center">  chicksaddlery.net </td><td align="center">  16/04/2018 </td></tr><tr><td align="center">  paypaypay.org </td><td align="center">  11/05/2018 </td></tr><tr><td align="center">  ar500arnor.com </td><td align="center">  26/05/2018 </td></tr><tr><td align="center">  authorizecdn.com </td><td align="center">  28/05/2018 </td></tr><tr><td align="center">  slickmin.com </td><td align="center">  28/05/2018 </td></tr><tr><td align="center">  bannerbuzz.info </td><td align="center">  03/06/2018 </td></tr><tr><td align="center">  kandypens.net </td><td align="center">  08/06/2018 </td></tr><tr><td align="center">  mylrendyphone.com </td><td align="center">  15/06/2018 </td></tr><tr><td align="center">  freshchat.info </td><td align="center">  01/01/2018 </td></tr><tr><td align="center">  3lift.org </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  abtasty.net </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  mechat.info </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zoplm.com </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zapaljs.com </td><td align="center">  02/09/2018 </td></tr><tr><td align="center">  foodandcot.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  freshdepor.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  swappastore.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  verywellfitnesse.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  elegrina.com </td><td align="center">  18/11/2018 </td></tr><tr><td align="center">  majsurplus.com </td><td align="center">  19/11/2018 </td></tr><tr><td align="center">  top5value.com </td><td align="center">  19/11/2018 </td></tr></tbody></table></div><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt451792/">https://habr.com/ru/post/pt451792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt451780/index.html">Auditoria em 60 minutos - verifique a resist√™ncia dos funcion√°rios a ataques de phishing atrav√©s do Sophos Phish Threat gratuitamente</a></li>
<li><a href="../pt451782/index.html">Subsistema Windows para Linux (WSL) vers√£o 2: como ser√°? (FAQ)</a></li>
<li><a href="../pt451784/index.html">Unidades h√≠bridas para armazenamento corporativo. Experi√™ncia com o Seagate EXOS</a></li>
<li><a href="../pt451786/index.html">Execute testes instrumentais no Firebase Test Lab. Parte 1: projeto iOS</a></li>
<li><a href="../pt451790/index.html">Os perigos da coleta de dados no jogo</a></li>
<li><a href="../pt451794/index.html">Pixels de recuo da textura</a></li>
<li><a href="../pt451796/index.html">Escrevendo uma extens√£o segura do navegador</a></li>
<li><a href="../pt451798/index.html">Migra√ß√£o de dados com mongoDB e Spring Boot</a></li>
<li><a href="../pt451800/index.html">Fazendo um modem de sonar simples</a></li>
<li><a href="../pt451802/index.html">Comunidade .Net do Raiffeisenbank convida para a UPD mitap Broadcast</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>