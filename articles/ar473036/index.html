<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฏ ๐ผ๐ฟ ๐ด๐ฟ Android Camera2 API ูู ุฅุจุฑูู ุงูุดุงู ุ ุงูุฌุฒุก 3. ุชุฑููุฒ ุงููุณุงุฆุท ูุฏูู ุงูููุฏูู ุนุจุฑ UDP ๐๐ป ๐ฐ ๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฐูู ุ ุงูุชุดููุง ููุนูุง ูุง ููููุฉ ุงูุชูุงุท ุงูุตูุฑ ูุชุณุฌูู ููุงุทุน ุงูููุฏูู ุจุงุณุชุฎุฏุงู Camera2 API. ูุจูู ููุท ููุนุฑูุฉ ููููุฉ ููู ุฏูู ุงูููุฏูู ูู ุฌูุงุฒ Android ุฅูู ุงููุณุชู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Android Camera2 API ูู ุฅุจุฑูู ุงูุดุงู ุ ุงูุฌุฒุก 3. ุชุฑููุฒ ุงููุณุงุฆุท ูุฏูู ุงูููุฏูู ุนุจุฑ UDP</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473036/" style=";text-align:right;direction:rtl"> ูุฐูู ุ ุงูุชุดููุง ููุนูุง ูุง ููููุฉ ุงูุชูุงุท ุงูุตูุฑ ูุชุณุฌูู ููุงุทุน ุงูููุฏูู ุจุงุณุชุฎุฏุงู Camera2 API.  ูุจูู ููุท ููุนุฑูุฉ ููููุฉ ููู ุฏูู ุงูููุฏูู ูู ุฌูุงุฒ Android ุฅูู ุงููุณุชูููู ุงูุฐูู ูุนุงููู ูู ุงูุฎุงุฑุฌ.  ุงููุฏู ุงูููุงุฆู ุ ููุง ููู ูุฑุงุฑูุง ูุชูุฑุงุฑูุง ุ ูู ุชูููุฑ ุงูุฑูุจูุชุงุช - ูุถุนูุง ูุงุชููุง ุฐูููุง ุนููู ุ ูุฅุฐุง ุฌุงุฒ ุงูุชุนุจูุฑ ุ ููู ุจุชุญููู ุงููุฑุฏ ุฅูู ุดุฎุต.  ุณูู ูุณุงุนุฏู ุจุฑูุงูุฌ ุชุฑููุฒ ุงููุณุงุฆุท ูู ูุฐุง.  ูุจุงูุทุจุน ุ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Camera2 ุงูุฌุฏูุฏุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/sa/tl/mf/satlmfdhbe-ow-gywoc5-tuxupe.jpeg"></div><br>  ูู ููุชู ุ ูู ูุถูู ุ ุชุญุช ุงููุท. <br><a name="habracut"></a><br>  ูููู ุงูุนุซูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง ุนูู</a> ุชูุงุตูู ุญูู ุงููุดุฑูุน ุงูุฑูุจูุชู ุ ูููู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุช ุงูุญุงูู</a> ุ ุณูููู ุงูููุฏูู ููู ูุจุงุดุฑุฉู (ุฃู ุจุงูุฃุญุฑู ุ ูู ูุงุชู ุฐูู ูุนูู ุจูุธุงู Android ูุชุตู ุจู) ุฅูู ุฌูุงุฒ ููุจููุชุฑ ุดุฎุตู ุฅููุชุฑููู. <br><br><h4 style=";text-align:right;direction:rtl">  ูุงุฐุง ูุญุชุงุฌ ููุฐุงุ </h4><br>  ูู ุฃุฌู ููู ุฏูู ููุฏูู ูู ุดุงุดุฉ ุงููุงุชู ุงูุฐูู ุฅูู ููุงู ุขุฎุฑ ุ ููุง ุชุนูู ุ ูุฌุจ ุฃููุงู ุชุญูููู (ุฏูู) ุฅูู ุชูุณูู ููุงุณุจ ุชููุตุช (ุณูููู ุญุฌูู ุณููููุง ุฌุฏูุง ุจุญูุซ ูุง ูููู ุฅุฑุณุงู ุงูุฅุทุงุฑ ุญุณุจ ุงูุฅุทุงุฑ) ุ ููุถุน ุทูุงุจุน ุฒูููุฉ (ุทูุงุจุน ุฒูููุฉ) ูุฅุฑุณุงููุง ูู ุดูู ุซูุงุฆู ุฅูู ุงููุณุชูู .  ูุงูุชู ุณูู ุชุคุฏู ุนูููุฉ ูู ุงูุชุดููุฑ ุงูุนูุณู. <br><br>  ูุฐู ูู ุงูุฃูุนุงู ุงูุณูุฏุงุก ุงูููุฎูุถุฉ ุงููุณุชูู ุงูุชู ุชุชุนุงูู ูุนูุง ูุฆุฉ Media Codec ููุฐ ุนุงู 2013 ุ ุจุฏุกูุง ูู ุชุงุฑูุฎ ุฅุตุฏุงุฑ Android 4.3. <br><br><img src="https://habrastorage.org/webt/ci/oz/xq/ciozxqlqwq8hecadsrkn0-8me6m.png"><br><br>  ุดูุก ุขุฎุฑ ูู ุฃู ุงูุงูุชุฑุงุจ ุงููุจูุฑ ูู ุชุดููุฑ ุงูููุฏูู ุ ุนูู ุนูุณ ุงูููู ุ ูู ููู ุจูุฐู ุงูุจุณุงุทุฉ.  ููุญุตูู ุนูู ุตูุฑุฉ ูู ุงููุงููุฑุง ุ ูุงู ูู ุงูุถุฑูุฑู ุงุณุชุฎุฏุงู ุฃุทูุงู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุดูุฑุฉ ุงูุบุงูุถุฉ</a> ุงูุชู ุ ููุง ูู ุงูุญุงู ูู ุชุนููุฐุงุช ุดุงูุงู Yakut ุ ูููู ุฃู ูุคุฏู ุนุฏู ุงูุฏูุฉ ุงููุญูุฏ ุฅูู ุชุนุทู ุงูุชุทุจูู ุจุงููุงูู.  ุฃุถู ุฅูู ุฐูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุณุงุจูุฉ ูููุงููุฑุง ุ ุญูุซ ุจุฏูุงู ูู ุนูููุงุช ูุนุงูุฏุฉ ุงูุงุชุตุงู ุงูุฌุงูุฒุฉ ุ ูุงู ุนููู ุฃู ุชูุชุจ ุงูุฃููุงู ุงููุชุฒุงููุฉ ุงููุฎุชููุฉ ุจููุณู ุ ููุฐุง ุงููุดุงุท ุ ููููู ุ ููุณ ูุถุนุงู ุงูููุจ. <br><br>  ูุงูุฃูู ูู ุฐูู ุ ุฃูุธุฑ ุฅูู <a href="">ูุฏููุฉ</a> ุงูุนูู ูู ุจุนูุฏ ุ ููุจุฏู ุฃู ูู ุดูุก ูุงุถุญ ุจุนุจุงุฑุงุช ุนุงูุฉ.  ุชุจุฏุฃ ูู ุงูููู ูู ุฃุฌุฒุงุก ุฅูู ูุดุฑูุนู - ููุณ ูู ุงููุงุถุญ ุณุจุจ ุณูุจู.  ููู ูู ุงููุณุชุญูู ุชุตุญูุญู ุ ูุฃูู ูู ุงูุตุนุจ ููู ุงูุชูุงุตูู. <br><br>  ูุนู ุ ููู ุงูุตูุจุฉ <s>ุฅููุงู</s> ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูู ุณูููุฉ.  ุจุงุฎุชุตุงุฑ ุ ููุถู <br><br>  ูุญุณู ุงูุญุธ ุ ุจุงููุณุจุฉ ูุจุทุฆ ุงูุจุทููู ุ ูุฏูู ุจูุงุฉ Google ุงูููููู ุงูุณุญุฑู ูู <b>Surface</b> ุ ูุงูุฐู ููููู ูู ุฎูุงูู ุชุฌูุจ ุงูุชูุงุตูู ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ.  ูู ุงูุตุนุจ ุจุงููุณุจุฉ ูู ูุฑุฌู ุนุงุฏู ุฃู ุฃููู ุจุฃู ุซูู ููุง ุงูุฐู ูุฎุณุฑู ุงููุทูุฑ ุ ูููู ุงูุขู ูููููุง ุฃู ูููู ุญุฑูููุง: "ุฃูุฏุฑููุฏ ุ ุฎุฐ ูุฐุง ุงูุณุทุญ ุงูุฐู ูุธูุฑ ุนููู ุงูููุฏูู ูู ุงููุงููุฑุง ููุง ูุบูุฑ ุดูุฆูุง ููุงู ุ ููุง ูู ุ ูุชู ุชุฑููุฒู ูุฅุฑุณุงู ุนูู ".  ูุงูุดูุก ุงูุฃูุซุฑ ูุฐููุฉ ูู ุฃูู ูุนูู.  ููุน Camera2 API ุงูุฌุฏูุฏ ุ ูุนุฑู ุงูุจุฑูุงูุฌ ููุณู ูุชู ูุชู ุฅุฑุณุงู ุงูุจูุงูุงุช ุ ููุฏ ุธูุฑุช ุนูููุงุช ุฑุฏ ุงุชุตุงู ุฌุฏูุฏุฉ! <br><br>  ุญุชู ุงูุขู ูุชุฑููุฒ ุงูููุฏูู - ุจุตู ููุท.  ูุงุฐุง ุณููุนู ุงูุขู. <br>  ูุฃุฎุฐ ุงูููุฏ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุงูุฃููู</a> ุ ููุงูุนุงุฏุฉ ุ ูููู ูู ุดูุก ููู ุจุงุณุชุซูุงุก ุงูุฃุฒุฑุงุฑ ูุชููุฆุฉ ุงููุงููุฑุง. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุจุฏุฃ ุจุงูุชุฎุทูุท ููุชุทุจูู.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>?&gt; &lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span> xmlns:app=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span> xmlns:tools=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/tools"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> tools:context=<span class="hljs-string"><span class="hljs-string">".MainActivity"</span></span>&gt; &lt;TextureView android:id=<span class="hljs-string"><span class="hljs-string">"@+id/textureView"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"356dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"410dp"</span></span> android:layout_marginTop=<span class="hljs-string"><span class="hljs-string">"32dp"</span></span> app:layout_constraintEnd_toEndOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintHorizontal_bias=<span class="hljs-string"><span class="hljs-string">"0.49"</span></span> app:layout_constraintStart_toStartOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintTop_toTopOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> /&gt; &lt;LinearLayout android:layout_width=<span class="hljs-string"><span class="hljs-string">"292dp"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"145dp"</span></span> android:layout_marginStart=<span class="hljs-string"><span class="hljs-string">"16dp"</span></span> android:orientation=<span class="hljs-string"><span class="hljs-string">"vertical"</span></span> app:layout_constraintBottom_toBottomOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintEnd_toEndOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintStart_toStartOf=<span class="hljs-string"><span class="hljs-string">"parent"</span></span> app:layout_constraintTop_toBottomOf=<span class="hljs-string"><span class="hljs-string">"@+id/textureView"</span></span> app:layout_constraintVertical_bias=<span class="hljs-string"><span class="hljs-string">"0.537"</span></span>&gt; &lt;Button android:id=<span class="hljs-string"><span class="hljs-string">"@+id/button1"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:text=<span class="hljs-string"><span class="hljs-string">"   "</span></span> /&gt; &lt;Button android:id=<span class="hljs-string"><span class="hljs-string">"@+id/button2"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:text=<span class="hljs-string"><span class="hljs-string">" "</span></span> /&gt; &lt;Button android:id=<span class="hljs-string"><span class="hljs-string">"@+id/button3"</span></span> android:layout_width=<span class="hljs-string"><span class="hljs-string">"match_parent"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:text=<span class="hljs-string"><span class="hljs-string">" "</span></span> /&gt; &lt;/LinearLayout&gt; &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</code> </pre> <br></div></div><br><h4 style=";text-align:right;direction:rtl">  ูููุชูู ูุน ุชุซุจูุช ุจุฑูุงูุฌ ุชุฑููุฒ ุงููุณุงุฆุท </h4><br>  ูู ุงูููุดูุฑ ุงูุฃุฎูุฑ ุ ุนุฑุถูุง ุงูุตูุฑุฉ ูู ุงููุงููุฑุง ุนูู ุงูุณุทุญ ููุชุจูุง ุงูููุฏูู ุจุงุณุชุฎุฏุงู MediaRecorder.  ููููุงู ุจุฐูู ุ ุญุฏุฏูุง ุจุจุณุงุทุฉ ููุง ุงููููููู ูู ูุงุฆูุฉ ุงูุณุทุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">(Arrays.asList(surface, mMediaRecorder.getSurface()).</code> </pre><br>  ููุง ููุณ ุงูุดูุก ุ ููุท ุจุฏูุงู ูู mMediaRecorder ูุญุฏุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">(Arrays.asList(surface, mEncoderSurface),</code> </pre><br>  ุงุชุถุญ ุ ุดูุก ูุซู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startCameraPreviewSession</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SurfaceTexture texture = mImageView.getSurfaceTexture(); texture.setDefaultBufferSize(<span class="hljs-number"><span class="hljs-number">320</span></span>, <span class="hljs-number"><span class="hljs-number">240</span></span>); surface = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Surface(texture); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW); mPreviewBuilder.addTarget(surface); mPreviewBuilder.addTarget(mEncoderSurface); mCameraDevice.createCaptureSession(Arrays.asList(surface, mEncoderSurface), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CameraCaptureSession.StateCallback() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onConfigured</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CameraCaptureSession session)</span></span></span><span class="hljs-function"> </span></span>{ mSession = session; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { mSession.setRepeatingRequest(mPreviewBuilder.build(), <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, mBackgroundHandler); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CameraAccessException e) { e.printStackTrace(); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onConfigureFailed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CameraCaptureSession session)</span></span></span><span class="hljs-function"> </span></span>{ } }, mBackgroundHandler); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CameraAccessException e) { e.printStackTrace(); } }</code> </pre><br>  ูุง ูู mEncoderSurfaceุ  ููุฐุง ูู ููุณ Surface ุงูุฐู ุณูุนูู ุจู ุจุฑูุงูุฌ ุชุฑููุฒ ุงููุณุงุฆุท.  ููุท ููุจุฏุก ุ ุชุญุชุงุฌ ุฅูู ุชููุฆุฉ ูู ููููุง ุจูุฐู ุงูุทุฑููุฉ ุชูุฑูุจูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUpMediaCodec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { mCodec = MediaCodec.createEncoderByType(<span class="hljs-string"><span class="hljs-string">"video/avc"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// H264  } catch (Exception e) { Log.i(LOG_TAG, "  "); } int width = 320; //   int height = 240; //   int colorFormat = MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface; //    int videoBitrate = 500000; //    bps (  ) int videoFramePerSecond = 20; // FPS int iframeInterval = 2; // I-Frame    MediaFormat format = MediaFormat.createVideoFormat("video/avc", width, height); format.setInteger(MediaFormat.KEY_COLOR_FORMAT, colorFormat); format.setInteger(MediaFormat.KEY_BIT_RATE, videoBitrate); format.setInteger(MediaFormat.KEY_FRAME_RATE, videoFramePerSecond); format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, iframeInterval); mCodec.configure(format, null, null, MediaCodec.CONFIGURE_FLAG_ENCODE); //     mEncoderSurface = mCodec.createInputSurface(); //  Surface  mCodec.setCallback(new EncoderCallback()); mCodec.start(); //   Log.i(LOG_TAG, " "); }</span></span></code> </pre><br>  ุงูุขู ูุจูู ุชุณุฌูู ุฑุฏ ุงุชุตุงู ูุงุญุฏ.  ุนูุฏูุง ูุดุนุฑ Media Codec ูุฌุฃุฉ ุฃู ุงูุจูุงูุงุช ุงูุชุงููุฉ ููุจุซ ุงูุฅุถุงูู ุฌุงูุฒุฉ ุ ูุณูู ูุฎุทุฑูุง ุจุฐูู ูู ุฎูุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EncoderCallback</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MediaCodec</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onInputBufferAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MediaCodec codec, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOutputBufferAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MediaCodec codec, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, MediaCodec.BufferInfo info)</span></span></span><span class="hljs-function"> </span></span>{ outPutByteBuffer = mCodec.getOutputBuffer(index); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] outDate = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[info.size]; outPutByteBuffer.get(outDate); Log.i(LOG_TAG, <span class="hljs-string"><span class="hljs-string">" outDate.length : "</span></span> + outDate.length); mCodec.releaseOutputBuffer(index, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MediaCodec codec, MediaCodec.CodecException e)</span></span></span><span class="hljs-function"> </span></span>{ Log.i(LOG_TAG, <span class="hljs-string"><span class="hljs-string">"Error: "</span></span> + e); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOutputFormatChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MediaCodec codec, MediaFormat format)</span></span></span><span class="hljs-function"> </span></span>{ Log.i(LOG_TAG, <span class="hljs-string"><span class="hljs-string">"encoder output format changed: "</span></span> + format); } }</code> </pre><br>  ูุฌููุนุฉ ุงูุจุงูุช outDate ูู ููุฒ ุญูููู.  ุฃูู ูุญุชูู ุนูู ูุทุน ุฌุงูุฒุฉ ูู ุฏูู ุงูููุฏูู H264 ุงููุดูุฑุฉ ูุงูุชู ูููููุง ุงูุขู ุงูููุงู ุจูู ูุง ูุฑูุฏ. <br><br>  ูุง ูู ... <br><br><img src="https://habrastorage.org/webt/lh/pe/kz/lhpekzdgk-z95gpos8493tdgdqi.png"><br><br>  ูุฏ ุชููู ุจุนุถ ุงููุทุน ูุจูุฑุฉ ุฌุฏูุง ุจุญูุซ ูุง ูููู ููููุง ุนุจุฑ ุงูุดุจูุฉ ุ ูููู ูุง ุดูุก ุ ุณูููู ุงููุธุงู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ุจูุทุนูุง ุจููุณู ูุฅุฑุณุงููุง ุฅูู ุงููุณุชูู. <br>  ูููู ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฎูููุง ููุบุงูุฉ ุ ูููููู ุฃู ุชูุฒูู ููุณู ุนู ุทุฑูู ุชุญุทูู ูุฐู ุงููุทุนุฉ <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count =<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> temp =outDate.length ; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> {<span class="hljs-comment"><span class="hljs-comment">//    byte[] ds; temp = temp-1024; if(temp&gt;=0) { ds = new byte[1024];} else { ds = new byte[temp+1024];} for(int i =0;i&lt;ds.length;i++) { ds[i]=outDate[i+1024*count]; } count=count+1; try { // Log.i(LOG_TAG, " outDate.length : " + ds.length); DatagramPacket packet = new DatagramPacket(ds, ds.length, address, port); udpSocket.send(packet); } catch (IOException e) { Log.i(LOG_TAG, "   UDP "); } } while (temp&gt;=0);</span></span></code> </pre><br><br>  ูููู ูู ุงูููุช ุงูุญุงูู ุ ูุญุชุงุฌ ุฅูู ุฃู ูุฑู ุจุดูู ูุจุงุดุฑ ุฃู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุงููุฎุฒู ุงููุคูุช ูู ูู ุงููุงูุน ุฏูู ููุฏูู H264.  ูุฐูู ุ ุฏุนูุง ูุฑุณููู ุฅูู ููู: <br><br>  ุณููุชุจ ูู ุงูุฅุนุฏุงุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUpMediaCodec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ File mFile = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), <span class="hljs-string"><span class="hljs-string">"test3.h264"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { outputStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BufferedOutputStream(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(mFile)); Log.i(<span class="hljs-string"><span class="hljs-string">"Encoder"</span></span>, <span class="hljs-string"><span class="hljs-string">"outputStream initialized"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { e.printStackTrace(); }</code> </pre><br>  ููู ุฑุฏ ุงูุงุชุตุงู ุญูุซ ููุฌุฏ ุงููุฎุฒู ุงููุคูุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { outputStream.write(outDate, <span class="hljs-number"><span class="hljs-number">0</span></span>, outDate.length);<span class="hljs-comment"><span class="hljs-comment">//     } catch (IOException e) { // TODO Auto-generated catch block e.printStackTrace(); }</span></span></code> </pre><br>  ุงูุชุญ ุงูุชุทุจูู ุ ุงุถุบุท ุนูู ุงูุฒุฑ: "ุงููุจ ุนูู ุงููุงููุฑุง ูุงูุจุซ".  ูุจุฏุฃ ุงูุชุณุฌูู ุชููุงุฆููุง.  ููุชุธุฑ ููููุง ูุงุถุบุท ุนูู ุฒุฑ ุงูุชููู. <br><br>  ุนุงุฏุฉู ูู ูุชู ููุฏ ุงูููู ุงููุญููุธ ุ ูุธุฑูุง ูุฃู ุงูุชูุณูู ููุณ MP4 ุ ูููู ุฅุฐุง ูุชุญุชู ุจุงุณุชุฎุฏุงู ูุดุบู VLC ุฃู ููุช ุจุชุญูููู ุนุจุฑ ุงูุฅูุชุฑูุช ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ONLINE CONVERT</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณูุชุฃูุฏ</a> ูู ุฃููุง ุนูู ุงููุณุงุฑ ุงูุตุญูุญ.  ุตุญูุญ ุฃู ุงูุตูุฑุฉ ุชูุน ุนูู ุฌุงูุจูุง ุ ููููุง ูุงุจูุฉ ููุชุซุจูุช. <br><br>  ุจุดูู ุนุงู ุ ููู ุญุฏุซ ูู ุงูุชุณุฌูู ุฃู ุงูุชุตููุฑ ุฃู ุงูุจุซ ุ ูู ุงูุฃูุถู ุ ุจุงูุทุจุน ุ ูุชุญ ุฌูุณุฉ ุฌุฏูุฏุฉ ูู ูู ูุฑุฉ ุ ูุฅุบูุงู ุงูุฌูุณุฉ ุงููุฏููุฉ.  ููุฐุง ูู ุ ุฃููุงู ุชุดุบูู ุงููุงููุฑุง ูุฅุทูุงู ูุนุงููุฉ ุนุงุฑูุฉ.  ุซู ุ ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุงูุชูุงุท ุตูุฑุฉ ุ ูุฃุบูู ุงููุนุงููุฉ ูุงูุชุญ ุงููุนุงููุฉ ุ ูููู ูุน ุชุซุจูุช Image Reader.  ุฅุฐุง ุชุญูููุง ุฅูู ุชุณุฌูู ุงูููุฏูู ุ ููู ุจุฅุบูุงู ุงูุฌูุณุฉ ุงูุญุงููุฉ ูุจุฏุก ุงูุฌูุณุฉ ูุน ุงููุนุงููุฉ ููุณุฌู ุงููุณุงุฆุท ุงููุฑูู ุจูุง.  ูู ุฃูุนู ูุฐุง ุ ุญุชู ูุง ุชุชุฃุซุฑ ุฑุคูุฉ ุงูุฑูุฒ ุ ูุชูุฑุฑ ููู ูููู ุฃูุซุฑ ููุงุกูุฉ ูููุณู. <br><br>  ูููุง ูู ุงูููุฏ ููู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">BasicMediaCodec</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.basicmediacodec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.annotation.RequiresApi; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.appcompat.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.core.content.ContextCompat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.Manifest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.pm.ActivityInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.pm.PackageManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.SurfaceTexture; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraAccessException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraCaptureSession; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraDevice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CaptureRequest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaCodec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaCodecInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaFormat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Environment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Handler; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.HandlerThread; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.StrictMode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.Surface; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.TextureView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.ByteBuffer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LOG_TAG = <span class="hljs-string"><span class="hljs-string">"myLogs"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Surface surface = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; CameraService[] myCameras = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CameraManager mCameraManager = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CAMERA1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button mButtonOpenCamera1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button mButtonStreamVideo = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button mButtonTStopStreamVideo = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> TextureView mImageView = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HandlerThread mBackgroundThread; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Handler mBackgroundHandler = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MediaCodec mCodec = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  Surface mEncoderSurface; // Surface      BufferedOutputStream outputStream; ByteBuffer outPutByteBuffer; private void startBackgroundThread() { mBackgroundThread = new HandlerThread("CameraBackground"); mBackgroundThread.start(); mBackgroundHandler = new Handler(mBackgroundThread.getLooper()); } private void stopBackgroundThread() { mBackgroundThread.quitSafely(); try { mBackgroundThread.join(); mBackgroundThread = null; mBackgroundHandler = null; } catch (InterruptedException e) { e.printStackTrace(); } } @RequiresApi(api = Build.VERSION_CODES.M) @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); setContentView(R.layout.activity_main); Log.d(LOG_TAG, " "); if (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED || (ContextCompat.checkSelfPermission(MainActivity.this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) ) { requestPermissions(new String[]{Manifest.permission.CAMERA, Manifest.permission.WRITE_EXTERNAL_STORAGE}, 1); } mButtonOpenCamera1 = findViewById(R.id.button1); mButtonStreamVideo = findViewById(R.id.button2); mButtonTStopStreamVideo = findViewById(R.id.button3); mImageView = findViewById(R.id.textureView); mButtonOpenCamera1.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { setUpMediaCodec();//    if (myCameras[CAMERA1] != null) {//   if (!myCameras[CAMERA1].isOpen()) myCameras[CAMERA1].openCamera(); } } }); mButtonStreamVideo.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { { //    } } }); mButtonTStopStreamVideo.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { if (mCodec != null) { Toast.makeText(MainActivity.this, "  ", Toast.LENGTH_SHORT).show(); myCameras[CAMERA1].stopStreamingVideo(); } } }); mCameraManager = (CameraManager) getSystemService(Context.CAMERA_SERVICE); try { //      myCameras = new CameraService[mCameraManager.getCameraIdList().length]; for (String cameraID : mCameraManager.getCameraIdList()) { Log.i(LOG_TAG, "cameraID: " + cameraID); int id = Integer.parseInt(cameraID); //     myCameras[id] = new CameraService(mCameraManager, cameraID); } } catch (CameraAccessException e) { Log.e(LOG_TAG, e.getMessage()); e.printStackTrace(); } } public class CameraService { private String mCameraID; private CameraDevice mCameraDevice = null; private CameraCaptureSession mSession; private CaptureRequest.Builder mPreviewBuilder; public CameraService(CameraManager cameraManager, String cameraID) { mCameraManager = cameraManager; mCameraID = cameraID; } private CameraDevice.StateCallback mCameraCallback = new CameraDevice.StateCallback() { @Override public void onOpened(CameraDevice camera) { mCameraDevice = camera; Log.i(LOG_TAG, "Open camera with id:" + mCameraDevice.getId()); startCameraPreviewSession(); } @Override public void onDisconnected(CameraDevice camera) { mCameraDevice.close(); Log.i(LOG_TAG, "disconnect camera with id:" + mCameraDevice.getId()); mCameraDevice = null; } @Override public void onError(CameraDevice camera, int error) { Log.i(LOG_TAG, "error! camera id:" + camera.getId() + " error:" + error); } }; private void startCameraPreviewSession() { SurfaceTexture texture = mImageView.getSurfaceTexture(); texture.setDefaultBufferSize(320, 240); surface = new Surface(texture); try { mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW); mPreviewBuilder.addTarget(surface); mPreviewBuilder.addTarget(mEncoderSurface); mCameraDevice.createCaptureSession(Arrays.asList(surface, mEncoderSurface), new CameraCaptureSession.StateCallback() { @Override public void onConfigured(CameraCaptureSession session) { mSession = session; try { mSession.setRepeatingRequest(mPreviewBuilder.build(), null, mBackgroundHandler); } catch (CameraAccessException e) { e.printStackTrace(); } } @Override public void onConfigureFailed(CameraCaptureSession session) { } }, mBackgroundHandler); } catch (CameraAccessException e) { e.printStackTrace(); } } public boolean isOpen() { if (mCameraDevice == null) { return false; } else { return true; } } public void openCamera() { try { if (checkSelfPermission(Manifest.permission.CAMERA) == PackageManager.PERMISSION_GRANTED) { mCameraManager.openCamera(mCameraID, mCameraCallback, mBackgroundHandler); } } catch (CameraAccessException e) { Log.i(LOG_TAG, e.getMessage()); } } public void closeCamera() { if (mCameraDevice != null) { mCameraDevice.close(); mCameraDevice = null; } } public void stopStreamingVideo() { if (mCameraDevice != null &amp; mCodec != null) { try { mSession.stopRepeating(); mSession.abortCaptures(); } catch (CameraAccessException e) { e.printStackTrace(); } mCodec.stop(); mCodec.release(); mEncoderSurface.release(); closeCamera(); } } } private void setUpMediaCodec() { File mFile = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM), "test3.h264"); try { outputStream = new BufferedOutputStream(new FileOutputStream(mFile)); Log.i("Encoder", "outputStream initialized"); } catch (Exception e) { e.printStackTrace(); } try { mCodec = MediaCodec.createEncoderByType("video/avc"); // H264  } catch (Exception e) { Log.i(LOG_TAG, "  "); } int width = 320; //   int height = 240; //   int colorFormat = MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface; //    int videoBitrate = 500000; //    bps (  ) int videoFramePerSecond = 20; // FPS int iframeInterval = 3; // I-Frame    MediaFormat format = MediaFormat.createVideoFormat("video/avc", width, height); format.setInteger(MediaFormat.KEY_COLOR_FORMAT, colorFormat); format.setInteger(MediaFormat.KEY_BIT_RATE, videoBitrate); format.setInteger(MediaFormat.KEY_FRAME_RATE, videoFramePerSecond); format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, iframeInterval); mCodec.configure(format, null, null, MediaCodec.CONFIGURE_FLAG_ENCODE); //     mEncoderSurface = mCodec.createInputSurface(); //  Surface  mCodec.setCallback(new EncoderCallback()); mCodec.start(); //   Log.i(LOG_TAG, " "); } private class EncoderCallback extends MediaCodec.Callback { @Override public void onInputBufferAvailable(MediaCodec codec, int index) { } @Override public void onOutputBufferAvailable(MediaCodec codec, int index, MediaCodec.BufferInfo info) { outPutByteBuffer = mCodec.getOutputBuffer(index); byte[] outDate = new byte[info.size]; outPutByteBuffer.get(outDate); try { Log.i(LOG_TAG, " outDate.length : " + outDate.length); outputStream.write(outDate, 0, outDate.length);//     } catch (IOException e) { // TODO Auto-generated catch block e.printStackTrace(); } mCodec.releaseOutputBuffer(index, false); } @Override public void onError(MediaCodec codec, MediaCodec.CodecException e) { Log.i(LOG_TAG, "Error: " + e); } @Override public void onOutputFormatChanged(MediaCodec codec, MediaFormat format) { Log.i(LOG_TAG, "encoder output format changed: " + format); } } @Override public void onPause() { if (myCameras[CAMERA1].isOpen()) { myCameras[CAMERA1].closeCamera(); } stopBackgroundThread(); super.onPause(); } @Override public void onResume() { super.onResume(); startBackgroundThread(); } }</span></span></code> </pre><br></div></div><br>  ููุง ุชูุณ ุงูุฃุฐููุงุช ูู ุงูุจูุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.CAMERA"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.INTERNET"</span></span>/&gt;</code> </pre><br>  ูุฐูู ุ ุชุฃูุฏูุง ูู ุฃู ุจุฑูุงูุฌ Media Codec ูุนูู.  ููู ุงุณุชุฎุฏุงูู ููุชุงุจุฉ ุงูููุฏูู ุฅูู ููู ูู ุจูุง ุฑูุญ.  ูููู ููุณุฌู ุงููุณุงุฆุท ุงูุชุนุงูู ูุน ูุฐู ุงููููุฉ ุจุดูู ุฃูุถู ุ ูุณูุถูู ุตูุชูุง.  ูุฐูู ุ ุณูุทุฑุญ ุฌุฒุก ุงูููู ูุฑุฉ ุฃุฎุฑู ููุถูู ูุชูุฉ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุจุซ ุงูููุฏูู ุฅูู ุงูุดุจูุฉ ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู udp.  ุฅููุง ุฃูุถูุง ุจุณูุทุฉ ุฌุฏูุง. <br><br>  ุฃููุงู ุ ูููุฆ ุฎุงุฏู UDP ุจุดูู ุนููู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> DatagramSocket udpSocket; String ip_address = <span class="hljs-string"><span class="hljs-string">"192.168.1.84"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      InetAddress address; int port = 40002; // ,      โฆโฆ.. try { udpSocket = new DatagramSocket(); Log.i(LOG_TAG, "  udp "); } catch ( SocketException e) { Log.i(LOG_TAG, "   udp "); } try { address = InetAddress.getByName(ip_address); Log.i(LOG_TAG, "  "); } catch (Exception e) {</span></span></code> </pre><br>  ููู ููุณ ุฑุฏ ุงูุงุชุตุงู ุ ุญูุซ ุฃุฑุณููุง ุจูุงูุงุช ุงูุงุณุชุนุฏุงุฏ ุฅูู ุงูุฏูู ููููู ุ ุณูุฑุณููุง ุงูุขู ูู ุดูู ูุฎุทุทุงุช ุจูุงูุงุช ุฅูู ุดุจูุชูุง ุงูููุฒููุฉ (ุขูู ุฃู ูููู ูุฏู ุงูุฌููุนุ) <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DatagramPacket packet = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DatagramPacket(outDate, outDate.length, address, port); udpSocket.send(packet); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.i(LOG_TAG, <span class="hljs-string"><span class="hljs-string">"   UDP "</span></span>); }</code> </pre><br><br>  ูู ูุฐุง ูู ุดูุกุ <br><br>  ูุจุฏู ุ ูููู ูุง.  ุณูู ุงูุชุทุจูู ุณุทุน ุนูุฏ ุจุฏุก ุงูุชุดุบูู.  ููุง ุชุฑู ุ ูุง ูุญุจ ุงููุธุงู ูู ุงูุฏูู ุงูุฑุฆูุณู ุฅุฑุณุงู ุฌููุน ุฃููุงุน ุญุฒู ูุฎุทุทุงุช ุงูุจูุงูุงุช.  ูููู ููุณ ููุงู ุณุจุจ ููููุน.  ุฃููุงู ุ ุนูู ุงูุฑุบู ูู ุฃููุง ูู ุงูุฎูุท ุงูุฑุฆูุณู ุ ูุง ุฒููุง ูุนูู ุจุดูู ุบูุฑ ูุชุฒุงูู ุ ุฃู ูุจุฏุก ุฑุฏ ุงูุงุชุตุงู.  ุซุงููุงู ุ ุฅุฑุณุงู ุญุฒู udp ูู ููุณ ุงูุนูููุฉ ุบูุฑ ุงููุชุฒุงููุฉ.  ุฅููุง ูุนูู ูุธุงู ุงูุชุดุบูู ููุท ุฃูู ุณูููู ูู ุงูุฌูุฏ ุฅุฑุณุงู ุญุฒูุฉ ุ ููููุง ูุนุชูุฏ ุนูููุง ุชูุงููุง ูู ูุฐุง ุงูุดุฃู.  ูุฐูู ุ ุญุชู ูุง ูููู Android ุจุงูุชูุฑุฏ ุ ุณูุถูู ุณุทุฑูู ูู ุจุฏุงูุฉ ุงูุจุฑูุงูุฌ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> StrictMode.ThreadPolicy policy = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StrictMode.ThreadPolicy.Builder().permitAll().build(); StrictMode.setThreadPolicy(policy);</code> </pre><br>  ุจุดูู ุนุงู ุ ุณููุชูู ุงูุจุฑูุงูุฌ ุงูุชุฌุฑูุจู <s>ุงูุฃููู</s> ุงูุตุบูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.basicmediacodec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.annotation.RequiresApi; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.appcompat.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.core.content.ContextCompat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.Manifest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.pm.ActivityInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.pm.PackageManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.SurfaceTexture; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraAccessException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraCaptureSession; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraDevice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CameraManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.camera2.CaptureRequest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaCodec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaCodecInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.media.MediaFormat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Handler; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.HandlerThread; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.StrictMode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.Surface; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.TextureView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.DatagramPacket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.DatagramSocket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.InetAddress; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.SocketException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.ByteBuffer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LOG_TAG = <span class="hljs-string"><span class="hljs-string">"myLogs"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Surface surface = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; CameraService[] myCameras = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CameraManager mCameraManager = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CAMERA1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button mButtonOpenCamera1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button mButtonStreamVideo = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button mButtonTStopStreamVideo = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> TextureView mImageView = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HandlerThread mBackgroundThread; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Handler mBackgroundHandler = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MediaCodec mCodec = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  Surface mEncoderSurface; // Surface      BufferedOutputStream outputStream; ByteBuffer outPutByteBuffer; DatagramSocket udpSocket; String ip_address = "192.168.1.84"; InetAddress address; int port = 40002; private void startBackgroundThread() { mBackgroundThread = new HandlerThread("CameraBackground"); mBackgroundThread.start(); mBackgroundHandler = new Handler(mBackgroundThread.getLooper()); } private void stopBackgroundThread() { mBackgroundThread.quitSafely(); try { mBackgroundThread.join(); mBackgroundThread = null; mBackgroundHandler = null; } catch (InterruptedException e) { e.printStackTrace(); } } @RequiresApi(api = Build.VERSION_CODES.M) @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build(); StrictMode.setThreadPolicy(policy); setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT); setContentView(R.layout.activity_main); Log.d(LOG_TAG, " "); if (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED || (ContextCompat.checkSelfPermission(MainActivity.this, Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) ) { requestPermissions(new String[]{Manifest.permission.CAMERA, Manifest.permission.WRITE_EXTERNAL_STORAGE}, 1); } mButtonOpenCamera1 = findViewById(R.id.button1); mButtonStreamVideo = findViewById(R.id.button2); mButtonTStopStreamVideo = findViewById(R.id.button3); mImageView = findViewById(R.id.textureView); mButtonOpenCamera1.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { setUpMediaCodec();//    if (myCameras[CAMERA1] != null) {//   if (!myCameras[CAMERA1].isOpen()) myCameras[CAMERA1].openCamera(); } } }); mButtonStreamVideo.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { { //    } } }); mButtonTStopStreamVideo.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { if (mCodec != null) { Toast.makeText(MainActivity.this, "  ", Toast.LENGTH_SHORT).show(); myCameras[CAMERA1].stopStreamingVideo(); } } }); try { udpSocket = new DatagramSocket(); Log.i(LOG_TAG, "  udp "); } catch ( SocketException e) { Log.i(LOG_TAG, "   udp "); } try { address = InetAddress.getByName(ip_address); Log.i(LOG_TAG, "  "); } catch (Exception e) { } mCameraManager = (CameraManager) getSystemService(Context.CAMERA_SERVICE); try { //      myCameras = new CameraService[mCameraManager.getCameraIdList().length]; for (String cameraID : mCameraManager.getCameraIdList()) { Log.i(LOG_TAG, "cameraID: " + cameraID); int id = Integer.parseInt(cameraID); //     myCameras[id] = new CameraService(mCameraManager, cameraID); } } catch (CameraAccessException e) { Log.e(LOG_TAG, e.getMessage()); e.printStackTrace(); } } public class CameraService { private String mCameraID; private CameraDevice mCameraDevice = null; private CameraCaptureSession mSession; private CaptureRequest.Builder mPreviewBuilder; public CameraService(CameraManager cameraManager, String cameraID) { mCameraManager = cameraManager; mCameraID = cameraID; } private CameraDevice.StateCallback mCameraCallback = new CameraDevice.StateCallback() { @Override public void onOpened(CameraDevice camera) { mCameraDevice = camera; Log.i(LOG_TAG, "Open camera with id:" + mCameraDevice.getId()); startCameraPreviewSession(); } @Override public void onDisconnected(CameraDevice camera) { mCameraDevice.close(); Log.i(LOG_TAG, "disconnect camera with id:" + mCameraDevice.getId()); mCameraDevice = null; } @Override public void onError(CameraDevice camera, int error) { Log.i(LOG_TAG, "error! camera id:" + camera.getId() + " error:" + error); } }; private void startCameraPreviewSession() { SurfaceTexture texture = mImageView.getSurfaceTexture(); texture.setDefaultBufferSize(320, 240); surface = new Surface(texture); try { mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW); mPreviewBuilder.addTarget(surface); mPreviewBuilder.addTarget(mEncoderSurface); mCameraDevice.createCaptureSession(Arrays.asList(surface, mEncoderSurface), new CameraCaptureSession.StateCallback() { @Override public void onConfigured(CameraCaptureSession session) { mSession = session; try { mSession.setRepeatingRequest(mPreviewBuilder.build(), null, mBackgroundHandler); } catch (CameraAccessException e) { e.printStackTrace(); } } @Override public void onConfigureFailed(CameraCaptureSession session) { } }, mBackgroundHandler); } catch (CameraAccessException e) { e.printStackTrace(); } } public boolean isOpen() { if (mCameraDevice == null) { return false; } else { return true; } } public void openCamera() { try { if (checkSelfPermission(Manifest.permission.CAMERA) == PackageManager.PERMISSION_GRANTED) { mCameraManager.openCamera(mCameraID, mCameraCallback, mBackgroundHandler); } } catch (CameraAccessException e) { Log.i(LOG_TAG, e.getMessage()); } } public void closeCamera() { if (mCameraDevice != null) { mCameraDevice.close(); mCameraDevice = null; } } public void stopStreamingVideo() { if (mCameraDevice != null &amp; mCodec != null) { try { mSession.stopRepeating(); mSession.abortCaptures(); } catch (CameraAccessException e) { e.printStackTrace(); } mCodec.stop(); mCodec.release(); mEncoderSurface.release(); closeCamera(); } } } private void setUpMediaCodec() { try { mCodec = MediaCodec.createEncoderByType("video/avc"); // H264  } catch (Exception e) { Log.i(LOG_TAG, "  "); } int width = 320; //   int height = 240; //   int colorFormat = MediaCodecInfo.CodecCapabilities.COLOR_FormatSurface; //    int videoBitrate = 500000; //    bps (  ) int videoFramePerSecond = 20; // FPS int iframeInterval = 3; // I-Frame    MediaFormat format = MediaFormat.createVideoFormat("video/avc", width, height); format.setInteger(MediaFormat.KEY_COLOR_FORMAT, colorFormat); format.setInteger(MediaFormat.KEY_BIT_RATE, videoBitrate); format.setInteger(MediaFormat.KEY_FRAME_RATE, videoFramePerSecond); format.setInteger(MediaFormat.KEY_I_FRAME_INTERVAL, iframeInterval); mCodec.configure(format, null, null, MediaCodec.CONFIGURE_FLAG_ENCODE); //     mEncoderSurface = mCodec.createInputSurface(); //  Surface  mCodec.setCallback(new EncoderCallback()); mCodec.start(); //   Log.i(LOG_TAG, " "); } private class EncoderCallback extends MediaCodec.Callback { @Override public void onInputBufferAvailable(MediaCodec codec, int index) { } @Override public void onOutputBufferAvailable(MediaCodec codec, int index, MediaCodec.BufferInfo info) { outPutByteBuffer = mCodec.getOutputBuffer(index); byte[] outDate = new byte[info.size]; outPutByteBuffer.get(outDate); try { DatagramPacket packet = new DatagramPacket(outDate, outDate.length, address, port); udpSocket.send(packet); } catch (IOException e) { Log.i(LOG_TAG, "   UDP "); } mCodec.releaseOutputBuffer(index, false); } @Override public void onError(MediaCodec codec, MediaCodec.CodecException e) { Log.i(LOG_TAG, "Error: " + e); } @Override public void onOutputFormatChanged(MediaCodec codec, MediaFormat format) { Log.i(LOG_TAG, "encoder output format changed: " + format); } } @Override public void onPause() { if (myCameras[CAMERA1].isOpen()) { myCameras[CAMERA1].closeCamera(); } stopBackgroundThread(); super.onPause(); } @Override public void onResume() { super.onResume(); startBackgroundThread(); } }</span></span></code> </pre><br>  ูุง ุฃุนุฑู ููู ููุนู ุงูุขุฎุฑูู ุ ููู ูู ููุงุญุธุชู Red Note 7 ุ ููููู ุญุชู ูุนุฑูุฉ ููููุฉ ุชูุฒูู ุงูููููุจุงูุช ุนูู ุงูุนููุงู ุงูุตุญูุญ <br><br><img src="https://habrastorage.org/webt/9x/3q/gz/9x3qgzrctdcevzw5ym5zi6imgq8.png"><br><br>  ูููุงู ุงููุซูุฑ ูู ูุขุฎุฐ udp ุ ููุฏุงุฑ ุนุฑุถ ุงููุทุงู ุงูุชุฑุฏุฏู ููุดุจูุฉ ูููู.  ุงูุดูุก ุงูุฑุฆูุณู ูู ุฃู ููุงู ุนูุงููู ุญูุซ.  ุณูููู ูุฏูู ุจุซ. <br><br><h4 style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนูุง ูุฐูุจ ููุจุญุซ ุนู ุงูุนููุงู ุงููุทููุจ ุนูู ุงูููุจููุชุฑ </h4><br>  ูุฌุจ ุฃู ุฃููู ุฃูู ููุณ ูู ุจุฑูุงูุฌ ููุจููุชุฑ ูุงุฏุฑ ุนูู ุงุณุชูุนุงุจ ููุถู ุฏูู ุงูููุฏูู H264 ุนุจุฑ ููุงุฉ UDP ูุงุญุฏุฉ ุฏูู ุฃู ูุนูููุงุช ุฅุถุงููุฉ.  ููู ุงูุจุนุถ ูุฏ.  ูุฐุง ุนูู ุณุจูู ุงููุซุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุบู</a> ุงููุณุงุฆุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">VLC</a> ุงููุดููุฑ ุฌุฏูุง.  ูุฐุง ุดูุก ุฑุงุฆุน ุ ุฅุฐุง ุจุฏุฃุช ูู ูุตู ุฅููุงููุงุชูุง ุ ูุญูููุง ุชุญุตู ุนูู ูุชุงุจ ูุงูู ูู ุงูููุงู.  ุจุงูุชุฃููุฏ ูุฏูู.  ุฅุฐุง ูู ููู ูุฐูู ุ ุถุนูุง ุนูู. <br><br>  ูุงุณุชูุงุฏุง ุฅูู ูุตู ุงูุฃูุงูุฑ ูุฐูู ุ ูููู ููุญุฒู udp ูุถู ูุฐุง ุงููุงุนุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">URL syntax: file:<span class="hljs-comment"><span class="hljs-comment">///path/file Plain media file http://host[:port]/file HTTP URL ftp://host[:port]/file FTP URL mms://host[:port]/file MMS URL screen:// Screen capture dvd://[device] DVD device vcd://[device] VCD device cdda://[device] Audio CD device udp://[[&lt;source address&gt;]@[&lt;bind address&gt;][:&lt;bind port&gt;]]</span></span></code> </pre><br>  ููู ูุฐู ุงูุนูุงููู ุงููุตุฏุฑ ูุนููุงู ุงูุฑุจุท ุ ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ููุณุช ููุงู ุญุงุฌุฉ.  ูุทููุจ ููุท ูููุฐ ุงูุงุณุชูุงุน. <br><br><img src="https://habrastorage.org/webt/7-/kw/pi/7-kwpik08ayqmgvd2rta1sqjtae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุน ุฐูู ุ ุจุงูุทุจุน ุ ูุฌุจ ุฃูุง ุชูุณู ุงูุณูุงุญ ููุฐุง ุงููููุฐ ุจุงูุงุณุชูุงุน (Malvar) </font></font><br><br><img src="https://habrastorage.org/webt/ix/9r/sj/ix9rsjovph-xzqgmosv_kgu-in4.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชุนูู ุฃู Windows ูุง ูุณูุญ ูู ุจุฅูุดุงุก ุดุงุดุฉ ุทุจุงุนุฉ ูู ุดุงุดุฉ ูุฑุงูุจุฉ ุงูููุงุฑุฏุ </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃู ููููู ุชุนุทูู ุฌุฏุงุฑ ุงูุญูุงูุฉ ุนูู ุงูุฅุทูุงู (ูุง ุฃูุตู ุจู) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ุ ุจุนุฏ ุงูุชุบูุจ ุนูู ูุฐู ุงูุฃุดูุงู ุ ูููู ุจุชุดุบูู ูุดุบู VLC ุจุนููุงููุง ูุงูุงุณุชูุชุงุน ุจุงูุดุงุดุฉ ุงููุงุฑุบุฉ. </font><font style="vertical-align: inherit;">ูุง ููุฌุฏ ููุฏูู</font></font><br><br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ุฐููุ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู ูุฐูู. </font><font style="vertical-align: inherit;">ุฑุจูุง ูุฏูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู VLC 3.08 Vetinariุ </font><font style="vertical-align: inherit;">ูุฐุง ูู ุดูุก ุ ูู ูุฐุง ุงูุฅุตุฏุงุฑ ูู UDP ุ ุชู ุฅููุงูู ุ ุนูุงูุฉ ุนูู ุฐูู ุ ูุงู ูู ุญุงูุฉ ุณูุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ูุฅู ููุทู ูุทูุฑู ุงููุงุนุจ ูุงุถุญ. </font><font style="vertical-align: inherit;">ูููู ูู ุงููุงุณ ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู ููุงุฉ udp ุงูุนุงุฑูุฉ ูู ุงูููุช ุงูุญุงุถุฑ ุจุณุจุจ:</font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">       .                 ,    .       . </li><li style=";text-align:right;direction:rtl">     </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ุ ุงูุฃุดุฎุงุต ุงูุนุงุฏููู ุ ุจุงูุทุจุน ุ ูุณุชุฎุฏููู ุจุฑูุชููููุงุช ุนุงููุฉ ุงููุณุชูู RTP ูุบูุฑูุง. ุฃู ุนูู ุงูุฃุตุงุจุน - ุชูุชุจ ุฎุงุฏููุง ูุณุชุฎุฏู udp (ููุณุฑุนุฉ) ุนูู ุฃู ุญุงู ุ ูููู ูู ููุณ ุงูููุช ูุชุจุงุฏู ูุนูููุงุช ุงูุชุญูู ูุน ุงูุนููู ุงูุฐู ูููู ุจุจุซ ุงูููุฏูู ุฅููู. ูุง ูู ุงููุทุงู ุงูุชุฑุฏุฏู ุ ูู ูู ุงูุถุฑูุฑู ุฒูุงุฏุฉ ุฃู ุชูููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุจูุงูุงุช ุ ูุง ูู ุชูุงุตูู ุงูุตูุฑุฉ ุงููุซูู ุงูุขู ุ ูููุฐุง ุฏูุงููู ููุง ุฅูู ุฐูู. ูุฑุฉ ุฃุฎุฑู ุ ููุงู ุญุงุฌุฉ ุฃูุถุง ุงูุตูุช ูู ุจุนุถ ุงูุฃุญูุงู. ููุญุชุงุฌ ุ ููุง ุชุนูููู ุ ุฅูู ุงูุชุฒุงูู ูุน ุงูููุฏูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุธุฑ ุ ูุงู ุนูู ุงููุงุนุจูู ูู Odnoklassniki </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฏูู ุจุฑูุชูููููู ูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุฌู ุงูุจุซ. ููู ููุงููู ุ ุจุทุจูุนุฉ ุงูุญุงู ุ ุฃูุซุฑ ุฃูููุฉ ุจูุซูุฑ - ูุฅุฑุณุงู ููุงุทุน ููุฏูู ูุน ุงููุทุท ูุนุดุฑุงุช ุงูููุงููู ูู ุฑุจุงุช ุงูุจููุช ูู ุฌููุน ุฃูุญุงุก ุงูุนุงูู. ููุงู ูู ุชุฏูุฑ ููุงุฉ UDP ูุงุญุฏุฉ.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุง ูุญุฒู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ููุชุงุจุฉ ุฎุงุฏู RTP ุนูู ูุธุงู Android. ุฑุจูุง ุ ููููู ุฃู ุชุฌุฏ ุญุชู ุฌุงูุฒุฉ ููุฌุงููุฉ ุ ูููู ุฏุนููุง ูุญุงูู ุนุฏู ุชุนููุฏ ุงูููุงูุงุช ูู ุงูููุช ุงูุญุงูู. ูุง ุนููู ุณูู ุงุณุชุฎุฏุงู ุฅุตุฏุงุฑ ูุดุบู VLC ุญูุซ ูุง ูุฒุงู ุชุฏูู ุงูุจุซ ุนุจุฑ ุจุฑูุชูููู ุงูุฅูุชุฑูุช ูุนูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ุ ูู ุจุงูุชูุฒูู ูู ููุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VLC 2.2.6 Umbrella</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Install ุจุฏูุงู ูู ุงููุฏูู ุฃู ุจุฌุงูุจู (ุฃู ุ VLC ุงูุฌุฏูุฏ) ุ ููุง ูุญูู ูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจุฏุฃ ููุฑู ุดุงุดุฉ ูุงุฑุบุฉ ูุฑุฉ ุฃุฎุฑู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฐุง ููู ูุฃููุง ูู ุงููุงุถุญ ุฃูู ูู ูุชู ุชูููู ุงุณุชุฎุฏุงู ุจุฑูุงูุฌ ุงูุชุฑููุฒ H264. ูุจุงูุชุงูู ุ ุณูููู ุจุฅููุงู VLC ุชุญุฏูุฏ ุจุฑูุงูุฌ ุงูุชุฑููุฒ ุชููุงุฆููุง ุฅุฐุง ูุงู ุนููู ุงูุชุนุงูู ูุน ุงูููู (ูู ุงูุฅุนุฏุงุฏุงุช ูู ุงูุจุฏุงูุฉ ุ ุชู ุชุญุฏูุฏ ุงูุชุญุฏูุฏ ุงูุชููุงุฆู). ููููู ูุฑููู ุฏูู ุจุงูุช ุนุจุฑ ููุงุฉ ูุงุญุฏุฉ ุ ูููุงู ุงูุนุดุฑุงุช ูู ุจุฑุงูุฌ ุงูุชุฑููุฒ ุงูุชู ูุฏุนููุง VLC. ููู ูููู ูุนุฑูุฉ ุฃู ูุงุญุฏ ูุชุทุจููุ</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ุ ูููู ุจุชุซุจูุช ุจุฑูุงูุฌ ุงูุชุฑููุฒ ุจุงูููุฉ. </font></font><br><br><img src="https://habrastorage.org/webt/jq/f5/er/jqf5ercz20oa2hxzlbeqmokqgbs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุขู ูุญู ูุณุชูุชุน ุจุจุซ ุงูููุฏูู "ุงููุจุงุดุฑ". </font><font style="vertical-align: inherit;">ุงูุดูุก ุงููุญูุฏ ูู ุฃูู ูุณุจุจ ูุง ูููู ูู ุฌุงูุจู ุ ูููู ูุฐุง ุชู ุฅุตูุงุญู ุจุงููุนู ุจุณูููุฉ ูู ุฅุนุฏุงุฏุงุช ูุดุบู ุงูููุฏูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููู ููุท ุจุฏุก ุชุดุบูู ุงููุงุนุจ ูู ุณุทุฑ ุงูุฃูุงูุฑ ุจุงุณุชุฎุฏุงู ูุฐุง ุงูููุชุงุญ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">C:\Program Files\VideoLAN\VLC\vlc udp:<span class="hljs-comment"><span class="hljs-comment">//@:40002 --demux h264 --video-filter=transform --transform-type=90</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุณูู ูู ููุณูุง ูุชุญูู. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/IbN9eh1uyv4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ูุนูู ูุชุฏูููู. </font><font style="vertical-align: inherit;">ูุจูู ููุท ูุฏูุฌู ูู ูุงูุฐุฉ JAVA ูุชุทุจูู ุงูุชุญูู ุงูุขูู. </font><font style="vertical-align: inherit;">ุณูุชุนุงูู ูุน ูุฐุง ูุฑูุจุง ุฌุฏุง ูู ุงูุฌุฒุก ุงูุฃุฎูุฑ.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar473036/">https://habr.com/ru/post/ar473036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar473016/index.html">ุฃุนูู ููุงุฐุฌ ุงูุฃุนูุงู ุงููุฑุจุญุฉ ููุฑููุจ ุงูุชู ุชููุฐูุง ุชุทุจููุงุช Uber ูุซู ุงูุชุงูุณู</a></li>
<li><a href="../ar473018/index.html">ูุตุงุฆุญ ูููุฑุดุญูู ูู ูุจุฑูุฌ ุฅุฌุฑุงุก ููุงุจูุงุช ุนูู Facebook</a></li>
<li><a href="../ar473024/index.html">ูุง ุชุญุชุงุฌ ููุนุฑูุชู ุญูู ุฅูุชุฑูุช ุงูุฃุดูุงุก: ุจุฑูุงูุฌ ุชุนูููู ุฃุณุงุณู</a></li>
<li><a href="../ar473030/index.html">ูุญุณุจ ุฑูุจูุชุงุช "ุงูุดุฑ" ุงููุญุชููุฉ ููููุนูุง ุนู ุทุฑูู IP</a></li>
<li><a href="../ar473032/index.html">"ุงูุฃูู ูู ุงุณุชุฑุงุชูุฌูุฉ ุณูุฆุฉ". SRE ููุซูุฉ ูู ููุณูู ุ 3-5 ูุจุฑุงูุฑ</a></li>
<li><a href="../ar473038/index.html">ููุฑุณ 8 ุจุช</a></li>
<li><a href="../ar473042/index.html">ุฅูุฌุงุจูุงุช ูุณูุจูุงุช ุฌุงูุบู</a></li>
<li><a href="../ar473044/index.html">ููููุฉ ุฅูุดุงุก ููุทุงุช ุดุงุดุฉ ูุนุงูุฉ ูุชุทุจูู ูุง ูู ูุชุฌุฑ ุงูุชุทุจููุงุช</a></li>
<li><a href="../ar473046/index.html">ุงูุฃููุงุฌ ูุงูุฑูุงุญ ูููุฉ ุงูุฅุฑุงุฏุฉ: ููู ูุณุงุนุฏ ุงูููุจููุชุฑ ุงูููุญู ุงููุนุฑุฉ ูู Dell ุงูุฑูุณ ุนูู ุงูููุฒ ุจุณุจุงู ุงูููุงุฑุจ ุงูุฏููู</a></li>
<li><a href="../ar473050/index.html">AMD ุชุฌุจุฑ ุดุฑูุฉ Intel ุนูู ุฎูุถ ุงูุฃุณุนุงุฑ ููุณ ููุท ุนูู ุงูุฌุฏูุฏ ุ ูููู ุฃูุถูุง ุนูู ุทุฑุงุฒุงุช ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุงููุฏููุฉ. ูุฐู ูู ุจุฏุงูุฉ ุญุฑุจ ุฃุณุนุงุฑ ุฃุฎุฑู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>