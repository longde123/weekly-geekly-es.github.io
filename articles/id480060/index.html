<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘´ğŸ¾ ğŸ‘¨ğŸ¿â€âœˆï¸ ğŸ¦… Klasifikasi P300 sederhana pada data terbuka ğŸ˜³ ğŸ‘­ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rekan saya Rafael Grigoryan eegdude baru-baru ini menulis sebuah artikel tentang mengapa manusia membutuhkan EEG dan fenomena signifikan apa yang dapa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Klasifikasi P300 sederhana pada data terbuka</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480060/"><p>  Rekan saya Rafael Grigoryan <a href="https://habr.com/ru/users/eegdude/" class="user_link">eegdude</a> <a href="https://m.habr.com/ru/post/479164/">baru-baru ini menulis</a> sebuah artikel tentang mengapa manusia membutuhkan EEG dan fenomena signifikan apa yang dapat dicatat di dalamnya.  Hari ini, sebagai kelanjutan dari topik antarmuka saraf, kami menggunakan salah satu kumpulan data terbuka yang direkam pada permainan menggunakan mekanika P300 untuk memvisualisasikan sinyal EEG, melihat struktur potensi yang disebut, membangun pengklasifikasi utama, mengevaluasi kualitas yang dengannya kita dapat memprediksi keberadaan potensi yang disebut tersebut. </p><br><p>  Biarkan saya mengingatkan Anda bahwa P300 disebut potensial (VP), respons spesifik otak yang terkait dengan pengambilan keputusan dan rangsangan yang membedakan (yang akan kita lihat di bawah).  Biasanya digunakan untuk membangun BCI modern. </p><br><p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png"></p><br><p>  Untuk melakukan klasifikasi EEG, Anda dapat menelepon teman, menulis game tentang Raccoons and Demons di VR, menuliskan reaksi Anda sendiri dan menulis artikel ilmiah (saya akan membicarakan ini lain waktu), tetapi untungnya, para ilmuwan dari seluruh dunia melakukan beberapa percobaan untuk kami dan tetap hanya mengunduh data. </p><br><p>  Analisis tentang bagaimana membangun antarmuka saraf pada P300 dengan kode langkah-demi-langkah dan visualisasi, serta tautan ke repositori dapat ditemukan di bawah kucing. </p><a name="habracut"></a><br><p>  Artikel ini hanya menunjukkan poin utama dari kode, versi direproduksi penuh di notebook jupyter <a href="https://gitlab.com/impulse-neiry_public/posts">untuk mencari di sini</a> </p><br><p>  Dari sudut pandang EEG, P300 hanya ledakan pada waktu tertentu di saluran tertentu.  Ada banyak cara untuk menyebutnya, misalnya, jika Anda berkonsentrasi pada satu objek, dan diaktifkan secara acak (perubahan bentuk, warna, kecerahan, atau melompat di suatu tempat).  Begini cara penerapannya di zaman kuno. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wKDimrzvwYA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Secara umum, skema ini adalah sebagai berikut: ada beberapa (biasanya dari 3 sampai 7) rangsangan dalam bidang penglihatan seseorang.  Seseorang memilih salah satu dari mereka dan fokus pada itu (cara yang baik adalah dengan menghitung jumlah aktivasi), kemudian setiap objek berkedip dalam urutan acak.  Mengetahui waktu aktivasi setiap stimulus, kita sekarang dapat melihat EEG berikutnya dan menentukan apakah ada puncak karakteristik di dalamnya (kita akan melihatnya dalam visualisasi di bawah).  Karena orang tersebut hanya berkonsentrasi pada satu rangsangan, maka puncaknya haruslah satu.  Jadi, dalam antarmuka saraf Anda ini, salah satu dari beberapa opsi dipilih (huruf untuk menulis, tindakan dalam permainan, dan Tuhan tahu apa lagi).  Jika ada lebih dari tujuh opsi, Anda bisa meletakkannya di kisi dan mengurangi tugas untuk memilih baris + kolom.  Ini adalah bagaimana ejaan P300 matriks klasik, ditunjukkan di atas. </p><br><p>  Dalam kasus dataset yang dipertimbangkan saat ini, bagian visual (dan juga namanya) dipinjam dari <a href="https://en.wikipedia.org/wiki/Space_Invaders">pembagi ruang</a> permainan yang terkenal.  Itu terlihat seperti ini </p><br><p><img src="https://habrastorage.org/webt/xg/yb/du/xgybdulftmr0dpr4muypl7avlro.png" alt="Gameplay pembagi otak"></p><br><p>  Faktanya, ini adalah ejaan yang sama, hanya huruf-huruf yang diganti oleh game alien. <br>  <a href="https://www.youtube.com/watch%3Fv%3Ds73l8ZfQcWw">Video proses permainan</a> dan <a href="https://arxiv.org/ftp/arxiv/papers/1905/1905.05182.pdf">laporan teknis</a> juga disimpan. </p><br><p>  Dengan satu atau lain cara, data yang dikumpulkan menggunakan game ini muncul di Internet dan kita dapat mengaksesnya.  Data terdiri dari 16 saluran EEG dan satu saluran acara, yang menunjukkan pada saat apa target (dibuat oleh pemain) dan insentif non-target diaktifkan, dan kami akan bekerja dengannya. </p><br><p> Sebagian besar kumpulan data untuk BCI direkam oleh neurofisiologis, dan ini adalah orang-orang yang tidak begitu peduli dengan kompatibilitas, sehingga format data sangat beragam: dari versi file <code>.mat</code> berbeda ke format "standar" <a href="https://en.wikipedia.org/wiki/General_Data_Format_for_Biomedical_Signals"><code>.gdf</code></a> dan <a href="https://en.wikipedia.org/wiki/General_Data_Format_for_Biomedical_Signals"><code>.gdf</code></a> . <br>  Hal terpenting yang perlu Anda ketahui tentang format ini adalah Anda tidak ingin menguraikannya atau bekerja secara langsung. <br>  Untungnya, sekelompok penggemar dari <a href="https://neurotechx.com/">NeuroTechX</a> menulis pengunduh untuk beberapa <a href="https://neurotechx.com/">set</a> data langsung di numpy. <br>  Bootloader ini adalah bagian dari proyek <a href="https://github.com/NeuroTechX/moabb/tree/master/moabb">moabb yang</a> mengklaim sebagai solusi universal untuk BCI. </p><br><h2 id="zagruzka-syrogo-dataseta">  Unduh dataset mentah </h2><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> moabb.datasets sampling_rate = <span class="hljs-number"><span class="hljs-number">512</span></span> m_dataset = moabb.datasets.bi2013a( NonAdaptive=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Adaptive=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Training=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, Online=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ) m_dataset.download() m_data = m_dataset.get_data()</code> </pre> <br><p>  Pada tahap ini, kami mendapat struktur <a href="https://mne.tools/stable/generated/mne.io.Raw.html">RawEDF</a> yang berisi catatan EEG.  Ini adalah struktur dari paket <a href="https://mne.tools/stable/index.html"><code>mne</code></a> , biolog biasanya menggunakannya untuk berinteraksi dengan sinyal: struktur ini memiliki metode built-in untuk menyaring, memvisualisasikan, menyimpan label, dan Anda tidak pernah tahu.  Tapi kita tidak akan pergi dengan cara ini sejak itu  antarmuka paket cenderung tidak stabil (versi saat ini adalah <code>0.19</code> , tetapi kami akan menggunakan <code>0.17</code> karena dataset tidak lagi dibaca oleh versi baru) dan didokumentasikan dengan buruk, melalui ini hasil kami mungkin menjadi tidak dapat diproduksi kembali. </p><br><p>  Apa yang kami ambil dari struktur yang dihasilkan adalah label saluran di <a href="https://en.wikipedia.org/wiki/10%25E2%2580%259320_system_(EEG)">sistem 10-20</a> .  Ini adalah pengaturan elektroda internasional di kepala seseorang, dibuat agar para ilmuwan dapat mengkorelasikan zona otak dan lokasi saluran EEG.  Di bawah ini adalah susunan elektroda dalam sistem 10-10 (berbeda dari 10-20 dengan dua kali kepadatan penandaan) dan saluran yang dicatat dalam dataset ini ditandai dengan warna merah. <br><img src="https://habrastorage.org/webt/j0/x0/uq/j0x0uq27-vjl277bgamcuuz3qpy.jpeg" alt="sistem 10-10"></p><br><pre> <code class="python hljs">print(m_data[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-string"><span class="hljs-string">'session_1'</span></span>][<span class="hljs-string"><span class="hljs-string">'run_1'</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># &lt;RawEDF | 1.gdf, n_channels x n_times : 17 x 159232 (311.0 sec), ~20.7 MB, data loaded&gt; channels = m_data[1]['session_1']['run_1'].ch_names[:-1] channels # ['FP1', 'FP2', 'F5', 'AFz', 'F6', 'T7', 'Cz', 'T8', 'P7', 'P3', 'Pz', 'P4', 'P8', 'O1', 'Oz', 'O2']</span></span></code> </pre><br><p>  Pertama, dari data yang diunduh untuk setiap subjek, kami mengalokasikan array EEG kontinu selama 16 detik dan semua label untuk interval ini (dalam data ini hanyalah saluran lain di mana awal peristiwa yang menarik bagi kami dicatat). </p><br><p>  Pada tahap ini, kami mempertahankan panjang maksimum EEG kontinu agar tidak menemui efek tepi selama penyaringan lebih lanjut. </p><br><pre> <code class="python hljs">raw_dataset = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, sessions <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(m_data.items()): eegs, markers = [], [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item, run <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(sessions[<span class="hljs-string"><span class="hljs-string">'session_1'</span></span>].items()): data = run.get_data() eegs.append(data[:<span class="hljs-number"><span class="hljs-number">-1</span></span>]) markers.append(data[<span class="hljs-number"><span class="hljs-number">-1</span></span>]) raw_dataset.append((eegs, markers))</code> </pre> <br><h2 id="filtraciya-i-razdelenie-na-epohi">  Penyaringan dan Pemisahan </h2><br><p>  Secara umum, untuk meninjau metode pra-pemrosesan dan klasifikasi EEG, saya dapat merekomendasikan <a href="https://iopscience.iop.org/article/10.1088/1741-2552/aab2f2/meta">ikhtisar yang sangat baik</a> dari master antarmuka neurocomputer.  Juga belum lama berselang ulasan yang lebih <a href="https://iopscience.iop.org/article/10.1088/1741-2552/ab0ab5">baru dari</a> tes jaringan saraf dirilis. </p><br><p>  Pra-pemrosesan minimum sinyal EEG untuk klasifikasi mencakup 3 langkah: </p><br><ul><li>  penipisan </li><li>  penyaringan </li><li>  scaling </li></ul><br><p>  Untuk mengimplementasikan langkah-langkah ini, kami akan menggunakan <code>sklearn</code> lama yang baik dan paradigma transformer dan jalur pipa sehingga preprocessing kami dapat dengan mudah diperluas. <br>  Kode transformer ditempatkan dalam file terpisah, di bawah ini kami akan menjelaskan beberapa detail. </p><br><p>  <strong>Penipisan</strong> </p><br><p>  Untuk beberapa alasan, dalam beberapa artikel dan contoh pemrosesan, saya bertemu dengan penurunan frekuensi sinyal dengan hanya membuang sampel dalam gaya <code>eeg = eeg[:, ::10]</code> .  Ini sepenuhnya salah (mengapa - lihat buku apa pun tentang pemrosesan sinyal).  Kami menggunakan <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.decimate.html"><code>  scipy</code></a> standar <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.decimate.html"><code>  scipy</code></a> . </p><br><p>  <strong>Penyaringan</strong> </p><br><p>  Di sini, kami juga mengandalkan filter <code>scipy</code> dengan memilih filter bandpass Butterworth 4-urutan dan menerapkannya di arah maju dan mundur ( <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.filtfilt.html"><code>filtfilt</code></a> ) untuk mempertahankan fase.  Frekuensi cutoff - dari 0,5 hingga 20 Hz, ini adalah rentang standar untuk tugas kami. </p><br><p>  <strong>Scaling</strong> </p><br><p>  Kami menggunakan <code>StandardScaler</code> per-saluran (kurangi rata-rata, bagi dengan deviasi standar), yang melihat semua sinyal dari sampel.  Bahkan, kebocoran data kecil diperkenalkan pada saat ini.  secara formal, scaler juga melihat data dari sampel uji, tetapi dengan volume data yang cukup besar, rerata dan deviasinya sama. <br>  Masturbasi dilakukan saluran demi saluran sehingga dalam dataset yang sama dimungkinkan untuk mengumpulkan data dari sensor yang berbeda yang memiliki urutan besarnya dan sifat yang berbeda (misalnya, <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25B0%25D0%25BA%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C_%25D0%25BA%25D0%25BE%25D0%25B6%25D0%25B8">skin-galvanic reaction (RAG)</a> ) </p><br><p>  Selain operasi di atas, dimungkinkan juga untuk membedakan artefak di EEG (berkedip, gerakan mengunyah, gerakan kepala), tetapi set data ini sudah sangat bersih, jadi mari kita biarkan sampai waktu berikutnya. </p><br><pre> <code class="python hljs">reload(transformers) decimation_factor = <span class="hljs-number"><span class="hljs-number">10</span></span> final_rate = sampling_rate // decimation_factor epoch_duration = <span class="hljs-number"><span class="hljs-number">0.9</span></span> <span class="hljs-comment"><span class="hljs-comment"># seconds epoch_count = int(epoch_duration * final_rate) eeg_pipe = make_pipeline( transformers.Decimator(decimation_factor), transformers.ButterFilter(sampling_rate // decimation_factor, 4, 0.5, 20), transformers.ChannellwiseScaler(StandardScaler()), ) markers_pipe = transformers.MarkersTransformer(labels_mapping, decimation_factor)</span></span></code> </pre> <br><p>  Selanjutnya, kami akan menerapkan pipa preprocessing ke data kami dan memotong sinyal EEG terus menerus menjadi zaman.  Kami akan menyebut periode waktu segera setelah aktivasi stimulus dengan durasi karakteristik 0,5-1 detik, dalam kasus kami durasinya adalah 900 ms, meskipun dapat dipersingkat. </p><br><p>  Dalam dataset kami ada 16 saluran EEG, setelah penipisan diterapkan, frekuensi akan turun menjadi 50 Hz, sehingga satu era akan dijelaskan oleh matriks <code>(16, 45)</code> - 900 ms pada 50 Hz adalah 45 sampel waktu. </p><br><p>  Tag dalam dataset ini hanya binari - mereka menandai target (disembunyikan oleh pemain, aktif, 1) dan sinyal non-target (kosong, 0). </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eegs, _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> raw_dataset: eeg_pipe.fit(eegs) dataset = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eegs, markers <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> raw_dataset: epochs = [] labels = [] filtered = eeg_pipe.transform(eegs) markups = markers_pipe.transform(markers) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> signal, markup <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(filtered, markups): epochs.extend([signal[:, start:(start + epoch_count)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> start <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> markup[:, <span class="hljs-number"><span class="hljs-number">0</span></span>]]) labels.extend(markup[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]) dataset.append((np.array(epochs), np.array(labels)))</code> </pre> <br><pre> <code class="python hljs">dataset[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>].shape, dataset[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>].shape <span class="hljs-comment"><span class="hljs-comment"># ((1308, 16, 45), (1308,))</span></span></code> </pre> <br><p>  Jadi kami mendapat <code>Pytorch</code> Pytorch-style di mana indeks pertama menghitung orang yang berbeda.  Dengan struktur ini, kami dapat melakukan validasi silang dalam data satu orang, dan menguji toleransi pengelompokan antara orang yang berbeda (yang disebut transfer learning, prediksi yang kurang kalibrasi).  Data satu orang terdiri dari berbagai era dan label kelas.  Jumlah era untuk setiap orang sedikit berbeda karena karakteristik rekaman. </p><br><h2 id="issledovanie-i-vizualizaciya-dannyh">  Penelitian dan visualisasi data </h2><br><p>  Pertama, lihat salah satu sinyal kontinu sebelum mengiris zaman. </p><br><p>  Terlepas dari kenyataan bahwa itu telah disaring, itu tidak menunjukkan aktivasi apa pun pada mata dan lebih mirip semacam kebisingan. </p><br><p><img src="https://habrastorage.org/webt/mb/xy/js/mbxyjsh7g4ch3an8smi2wtpujpw.png" alt="Sinyal EEG yang difilter dari satu kali permainan"></p><br><p>  Jika kita mempertimbangkan hanya satu target zaman dari dataset kita, maka kita akan melihat peningkatan karakteristik dalam interval 400-600 ms.  Ini adalah P300 potensial yang kami cari. </p><br><p><img src="https://habrastorage.org/webt/eu/v9/k-/euv9k-t6w0nss44m2fnvt_mrhxs.png" alt="p300 zaman"></p><br><p>  Secara total, dalam dataset kami ada sekitar 35 ribu zaman, yaitu aktivasi stimulus.  Setiap orang memiliki sekitar 1300 hingga 1750 (ini disebabkan oleh fakta bahwa seseorang menembak alien lebih cepat dan seseorang lebih lambat). </p><br><p>  Ada juga ketidakseimbangan yang terlihat di kelas: 1 sampai 5 yang mendukung rangsangan kosong.  kami memiliki 6 baris dan kolom dalam matriks dan hanya salah satunya yang menjadi target.  Nanti kita akan kembali ke ini ketika membahas metrik yang diperoleh. </p><br><p><img src="https://habrastorage.org/webt/ed/7n/jb/ed7njbim3sdcge3lpb-_ll8ucls.png" alt="keseimbangan kelas"></p><br><p>  Sekarang saatnya untuk melihat perbedaan antara sinyal target dan non-target </p><br><p><img src="https://habrastorage.org/webt/c5/tx/oa/c5txoadzfwl8qzg8t-29siuftnw.png" alt="dataset berarti respons"></p><br><p>  Pada grafik sebelah kiri, Anda dapat melihat bahwa sinyal rata-rata sangat bervariasi, dan keduanya memiliki respons non-spesifik di wilayah 180 ms, tetapi target satu jauh lebih banyak amplitudo, target juga memiliki punuk karakteristik dari 250 hingga 500 ms - ini adalah P300 yang terkenal kejam. </p><br><p>  Dengan perbedaan dalam sinyal, tugas kita mungkin tampak seperti hal sepele, tetapi jika kita menambahkan standar deviasi pada setiap titik pada grafik, kita akan melihat bahwa gambarnya tidak begitu cerah - sinyalnya cukup berisik.  Dan ini terlepas dari kenyataan bahwa rasio signal-to-noise untuk P300 dianggap salah satu yang tertinggi dalam neurofisiologi. </p><br><p>  (Sebenarnya, grafik ini tidak dibangun dengan cukup jujur, karena sinyal kosong dirata-rata lebih dari lima kali lebih banyak sampel yang berbeda, sehingga penyimpangan acak lebih tersendat, tetapi seperti yang dapat kita lihat dari dispersi dengan urutan yang sama, ini tidak banyak membantu) </p><br><p><img src="https://habrastorage.org/webt/7b/nw/hw/7bnwhwdx7xrbkvwgqiw9jc5um5g.png" alt="Respon orang berarti"></p><br><p>  Juga berguna untuk melihat sinyal rata-rata dari satu orang. </p><br><p>  Di sini komentar sebelumnya tentang rata-rata "tidak jujur" ditemukan - sinyal kosong terasa lebih amplitudo daripada dengan rata-rata atas semua.  Juga, puncak P300 dalam satu orang lebih tinggi karena kurang rata-rata. </p><br><p>  Penting untuk mencatat fitur lain dari sinyal satu orang - ia memiliki bentuk yang sedikit berbeda dari yang umum.  Variabilitas interpersonal dari reaksi neurofisiologis cukup tinggi, kita masih akan melihat pengaruh faktor ini dalam pekerjaan pengklasifikasi.  Namun, perbedaan intrapersonal (satu orang dalam suasana hati yang berbeda, tingkat stres, kelelahan) juga cukup besar. </p><br><p><img src="https://habrastorage.org/webt/jt/kj/sj/jtkjsjbgmym86-unjyshdxgtd80.png" alt="png"></p><br><p>  Selanjutnya, kita melihat sapuan sinyal saluran per saluran.  Sudut pandang di sini bertepatan dengan gambar di atas, yang menggambarkan posisi elektroda - hidung di atas, dll. </p><br><p>  Respons masing-masing bagian kepala berbeda.  Pada Fp1,2, dua puncak negatif sebelum puncak positif diucapkan.  Juga, di beberapa saluran ada dua puncak positif, dan di beberapa - satu atau sesuatu transisi antara. </p><br><p>  Saluran yang berbeda memiliki kepentingan yang berbeda untuk menentukan keberadaan P300, dapat diperkirakan menggunakan metode yang berbeda - menghitung informasi timbal balik (mutual information) atau metode add-delete (alias stepwise regression).  Penerapan metode ini akan kita hadapi di lain waktu. </p><br><p>  Perlu diingat bahwa kita mengukur perbedaan potensial antara elektroda dengan elektroda, yang berarti bahwa kita dapat membuat peta tegangan untuk seluruh head pada titik-titik waktu menggunakan perubahan tegangan pada titik-titik individual.  Jelas bahwa jika ada 16 elektroda, keakuratan kartu seperti itu meninggalkan banyak yang diinginkan, tetapi beberapa pemahaman harus dibentuk.  ( <code>mne</code> secara default mengharapkan untuk melihat microvolts, tetapi kami telah menerapkan penskalaan, sehingga nilai absolutnya tidak benar) </p><br><p><img src="https://habrastorage.org/webt/zq/2y/kz/zq2ykzbpc6oxqz2woyizwuswod4.png" alt="png"></p><br><p><img src="https://habrastorage.org/webt/l5/xn/iy/l5xniylmkybexkk6cym8dbhrmjq.png" alt="png"></p><br><h2 id="klassifikaciya">  Klasifikasi </h2><br><p>  Akhirnya, saatnya menerapkan metode pembelajaran mesin pada sampel kami. </p><br><p>  Beberapa yang dasar dipilih sebagai pengklasifikasi - log.  regresi, metode vektor dukungan (SVM), dan beberapa metode menggunakan analisis korelasi dari paket <a href="https://github.com/alexandrebarachant/pyRiemann"><code>pyriemann</code></a> (rincian masing-masing metode dapat ditemukan dalam dokumentasi), perlu dicatat bahwa metode ini dikembangkan secara khusus untuk aplikasi EEG dan dengan bantuan mereka <a href="https://www.kaggle.com/c/inria-bci-challenge/discussion/12819">beberapa</a> <a href="https://www.kaggle.com/c/grasp-and-lift-eeg-detection/discussion/16479">kompetisi</a> dimenangkan pada kaggle. </p><br><pre> <code class="python hljs">clfs = { <span class="hljs-string"><span class="hljs-string">'LR'</span></span>: ( make_pipeline(Vectorizer(), LogisticRegression()), {<span class="hljs-string"><span class="hljs-string">'logisticregression__C'</span></span>: np.exp(np.linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>))}, ), <span class="hljs-string"><span class="hljs-string">'LDA'</span></span>: ( make_pipeline(Vectorizer(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {}, ), <span class="hljs-string"><span class="hljs-string">'SVM'</span></span>: ( make_pipeline(Vectorizer(), SVC()), {<span class="hljs-string"><span class="hljs-string">'svc__C'</span></span>: np.exp(np.linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>))}, ), <span class="hljs-string"><span class="hljs-string">'CSP LDA'</span></span>: ( make_pipeline(CSP(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {<span class="hljs-string"><span class="hljs-string">'csp__n_components'</span></span>: (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>), <span class="hljs-string"><span class="hljs-string">'csp__cov_est'</span></span>: (<span class="hljs-string"><span class="hljs-string">'concat'</span></span>, <span class="hljs-string"><span class="hljs-string">'epoch'</span></span>)}, ), <span class="hljs-string"><span class="hljs-string">'Xdawn LDA'</span></span>: ( make_pipeline(Xdawn(<span class="hljs-number"><span class="hljs-number">2</span></span>, classes=[<span class="hljs-number"><span class="hljs-number">1</span></span>]), Vectorizer(), LDA(shrinkage=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'eigen'</span></span>)), {}, ), <span class="hljs-string"><span class="hljs-string">'ERPCov TS LR'</span></span>: ( make_pipeline(ERPCovariances(estimator=<span class="hljs-string"><span class="hljs-string">'oas'</span></span>), TangentSpace(), LogisticRegression()), {<span class="hljs-string"><span class="hljs-string">'erpcovariances__estimator'</span></span>: (<span class="hljs-string"><span class="hljs-string">'lwf'</span></span>, <span class="hljs-string"><span class="hljs-string">'oas'</span></span>)}, ), <span class="hljs-string"><span class="hljs-string">'ERPCov MDM'</span></span>: ( make_pipeline(ERPCovariances(), MDM()), {<span class="hljs-string"><span class="hljs-string">'erpcovariances__estimator'</span></span>: (<span class="hljs-string"><span class="hljs-string">'lwf'</span></span>, <span class="hljs-string"><span class="hljs-string">'oas'</span></span>)}, ), }</code> </pre> <br><p><img src="https://habrastorage.org/webt/3x/yb/qc/3xybqcusgidyxfs5lfcilxqn-gs.png" alt="catatan crossvalidate"></p><br><p>  Skema antarmuka saraf yang paling umum adalah "kalibrasi + kerja" yaitu  Pertama, perlu bahwa seseorang berkonsentrasi pada rangsangan yang ditunjukkan sebelumnya untuk beberapa waktu, dan hanya setelah itu kita memprediksi pilihannya.  Pendekatan ini jelas memiliki kerugian dari tahap awal yang membosankan. </p><br><p>  Untuk menilai kinerja metode kami dalam mode ini, kami akan melakukan validasi silang dalam era satu orang. <br>  Metrik akurasi dalam kasus ini tidak relevan karena ketidakseimbangan dataset (baseline adalah 5/6 ~ 83% di sini), jadi saya lebih suka melihat ketepatan-recall-f1 tiga. </p><br><p>  Untuk meninjau seluruh dataset, kami rata-rata hasil validasi silang tersebut di semua orang.  Secara umum, kinerja model terbaik cukup tinggi dibandingkan dengan apa yang kami <a href="https://impulse-neiry.com/">miliki</a> di <a href="https://impulse-neiry.com/">Neiry</a> dalam kondisi "lapangan" sebuah taman hiburan (saya ingat bahwa dataset ini direkam di laboratorium). </p><br><p>  Dalam dataset ini hanya ada label biner untuk data.  Secara umum, kita perlu memecahkan masalah multikelas dalam memilih salah satu rangsangan (omong-omong, itu seimbang karena setiap stimulus diaktifkan jumlah yang sama kali).  Untuk mengatasinya, jumlah aktivasi setiap stimulus biasanya ditetapkan (misalnya, masing-masing 6 stimuli dari 5 aktivasi) dan semua stimuli diaktifkan secara acak (30 kali), 30 zaman diperoleh dan probabilitas aktivasi ditambahkan untuk ditargetkan, setelah itu stimulus yang telah mencapai maksimum jumlahnya diakui sebagai target.  Kami akan mendemonstrasikan implementasi pendekatan ini pada posting mendatang pada dataset yang sesuai. </p><br><p><img src="https://habrastorage.org/webt/zx/-o/lm/zx-olmert9y5wdjpebgqa1dy8zm.png" alt="crossvalidate_dataset"></p><br><p>  Skema kedua disebut transfer learning - yaitu, transfer classifier antara orang-orang.  Faktanya adalah bahwa ketika kita melakukan kalibrasi, kita benar-benar berlatih kembali ke bentuk puncak dari satu orang, sehingga kita dapat memperkirakannya dengan baik dalam tes berikutnya.  Dengan tidak adanya kalibrasi, classifier pra-terlatih harus dapat mengisolasi konsep P300 tanpa mengetahui terlebih dahulu bentuk gelombang orang tertentu. </p><br><p>  Kami akan melakukan dua percobaan - kami akan melatih penggolong pada satu orang, dan kami akan memprediksi lima, dan kemudian kami akan meningkatkan sampel pelatihan menjadi 10 orang dan membandingkan hasilnya untuk memastikan bahwa model mampu meningkatkan kemampuan generalisasi mereka </p><br><p>  Pelatihan untuk 1 orang <br><img src="https://habrastorage.org/webt/fk/n5/5w/fkn55wh6yl7hfpjtjrqesq8gm8e.png" alt="transfer_validate_1"></p><br><p>  Pelatihan untuk 10 orang <br><img src="https://habrastorage.org/webt/in/ol/kq/inolkqy3-fezzcavmstah4vwhic.png" alt="transfer_valiidate_10"></p><br><p>  Jadi f1 naik dari 0,23 menjadi 0,4 untuk pengklasifikasi yang lebih baik (dalam kedua kasus itu adalah regresi log dengan regularisasi yang sama). </p><br><p>  Ini berarti bahwa kemampuan prediksi telah meningkat dari "tidak" menjadi "dapat diterima."  Berdasarkan pengalaman kami, dengan metrik tugas biner seperti itu, 5 aktivasi setiap stimulus cukup untuk mencapai keakuratan masalah multiclass sekitar 75%. </p><br><p>  Pada akhirnya, saya ingin mencatat bahwa metode di atas cukup primitif, yang dapat dilihat, misalnya, dengan tingkat tinggi regularisasi regresi log - saluran dalam data berkorelasi sangat kuat dan ada beberapa pendekatan untuk menyelesaikan fakta ini. </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Hari ini, kami menjadi lebih akrab dengan potensi yang ditimbulkan P300 dan membangun saluran pipa sederhana untuk antarmuka saraf.  Saya merekomendasikan mereka yang tertarik untuk membuka laptop sendiri (terletak di <a href="https://gitlab.com/impulse-neiry_public/posts">repositori</a> ) dan bereksperimen dengan opsi visualisasi dan pengklasifikasi. </p><br><p>  Memiliki pemahaman dasar tentang metode bekerja dengan sinyal EEG, kami akan dapat lebih jauh memeriksa topik ini - untuk menerapkan metode preprocessing canggih, serta jaringan saraf, untuk memecahkan masalah membangun antarmuka saraf.  Dilanjutkan ... </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id480060/">https://habr.com/ru/post/id480060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id480048/index.html">Demistifikasi Layanan .NET Core 3 Worker baru</a></li>
<li><a href="../id480050/index.html">Studi lapangan tentang konsep "Dokumentasi sebagai kode"</a></li>
<li><a href="../id480052/index.html">SEO vs. PPC - Apa yang lebih baik untuk bisnis Anda?</a></li>
<li><a href="../id480056/index.html">Aktivasi kamera tersembunyi oleh browser: Big Brother atau kesalahan perhitungan teknologi?</a></li>
<li><a href="../id480058/index.html">Bintang transformer di pohon Natal</a></li>
<li><a href="../id480062/index.html">10 sistem kontrol. Di mana lebih nyaman untuk berkomunikasi tentang tugas dan berbagi file?</a></li>
<li><a href="../id480064/index.html">Belajar kata-kata dikelompokkan secara tematis</a></li>
<li><a href="../id480068/index.html">[Perbarui] Orang-orang kami dipukuli, dan kami akan diam?</a></li>
<li><a href="../id480070/index.html">Bereaksi manfaat: Sebuah berkah untuk Bisnis?</a></li>
<li><a href="../id480072/index.html">Kubernetes: mengapa begitu penting untuk mengatur manajemen sumber daya sistem?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>