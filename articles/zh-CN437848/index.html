<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¹ â˜®ï¸ ğŸ‘¨ğŸ¾ æˆ‘ä»¬ä½¿ä¸ºå¾®æ§åˆ¶å™¨å¼€å‘é‡å‹è½¯ä»¶çš„è¿‡ç¨‹æ›´åŠ æ–¹ä¾¿ï¼ˆå¦ï¼‰ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ¼ ğŸ‘©â€ğŸ³ ğŸ§”ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç°åœ¨ï¼Œä»»ä½•äººéƒ½ä¸ä¼šå¯¹å…·æœ‰512 KBæˆ–æ›´å¤§çš„éæ˜“å¤±æ€§ï¼ˆé€šå¸¸æ˜¯é—ªå­˜ï¼‰å­˜å‚¨å™¨çš„å¾®æ§åˆ¶å™¨æ„Ÿåˆ°æƒŠè®¶ã€‚ å®ƒä»¬çš„æˆæœ¬æ­£åœ¨é€æ¸é™ä½ï¼Œè€Œå¯è®¿é—®æ€§å´åœ¨ä¸æ–­å¢é•¿ã€‚ å¦‚æ­¤å¤§é‡çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨çš„å­˜åœ¨ä½¿å¾—æœ‰å¯èƒ½ç¼–å†™å°±å ç”¨çš„å­˜å‚¨å™¨è€Œè¨€â€œç¹é‡â€çš„åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶é€šè¿‡ä½¿ç”¨æ¥è‡ªå„ç§æ ‡å‡†åº“çš„ç°æˆè§£å†³æ–¹æ¡ˆæ¥ä¿ƒè¿›ä»£ç çš„åç»­ç»´æŠ¤ã€‚ ç„¶è€Œï¼Œè¿™å¯¼...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬ä½¿ä¸ºå¾®æ§åˆ¶å™¨å¼€å‘é‡å‹è½¯ä»¶çš„è¿‡ç¨‹æ›´åŠ æ–¹ä¾¿ï¼ˆå¦ï¼‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437848/">ç°åœ¨ï¼Œä»»ä½•äººéƒ½ä¸ä¼šå¯¹å…·æœ‰512 KBæˆ–æ›´å¤§çš„éæ˜“å¤±æ€§ï¼ˆé€šå¸¸æ˜¯é—ªå­˜ï¼‰å­˜å‚¨å™¨çš„å¾®æ§åˆ¶å™¨æ„Ÿåˆ°æƒŠè®¶ã€‚ å®ƒä»¬çš„æˆæœ¬æ­£åœ¨é€æ¸é™ä½ï¼Œè€Œå¯è®¿é—®æ€§å´åœ¨ä¸æ–­å¢é•¿ã€‚ å¦‚æ­¤å¤§é‡çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨çš„å­˜åœ¨ä½¿å¾—æœ‰å¯èƒ½ç¼–å†™å°±å ç”¨çš„å­˜å‚¨å™¨è€Œè¨€â€œç¹é‡â€çš„åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶é€šè¿‡ä½¿ç”¨æ¥è‡ªå„ç§æ ‡å‡†åº“çš„ç°æˆè§£å†³æ–¹æ¡ˆæ¥ä¿ƒè¿›ä»£ç çš„åç»­ç»´æŠ¤ã€‚ ç„¶è€Œï¼Œè¿™å¯¼è‡´ç›®æ ‡è®¾å¤‡çš„å›ºä»¶æ–‡ä»¶é‡çš„å¢åŠ ï¼Œæ¯æ¬¡ä»¥æœ€å°çš„ä»£ç å˜åŒ–å°±éœ€è¦å°†å…¶å®Œå…¨é‡æ–°åŠ è½½åˆ°å¾®æ§åˆ¶å™¨çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨ä¸­ã€‚ <br><br> æœ¬æ–‡çš„ç›®çš„æ˜¯è®¨è®ºç”¨Cå’Œ/æˆ–C ++æ„å»ºé¡¹ç›®çš„æ–¹æ³•ï¼Œå…¶ä¸­åœ¨æ›´æ”¹æœ€ç»å¸¸è°ƒè¯•çš„ä»£ç æ®µçš„æƒ…å†µä¸‹ï¼Œä¸éœ€è¦é‡å†™å¤§å¤šæ•°é¡¹ç›®ã€‚ å¹¶è¯´æ˜ä¸ºä»€ä¹ˆè¿™ç§æ–¹æ³•å¹¶ä¸æ€»æ˜¯ä¸€ç§æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ <br><a name="habracut"></a><br><h2> è¯»è€…è¦æ±‚ </h2><br> åœ¨å™è¿°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å°†å‡å®šè¯»è€…ï¼š <br><br><ul><li> ä»–ç²¾é€šCå’ŒC ++ã€‚ </li><li> å…·æœ‰ä½¿ç”¨åŸºäºCortex-M3 / Cortex-M4å†…æ ¸çš„å¾®æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚stm32f4ç³»åˆ—ï¼‰çš„ç»éªŒï¼› </li><li> çŸ¥é“å¦‚ä½•ä»é¡¹ç›®æºæ„å»ºæœ€ç»ˆçš„ç¼çº«æ–‡ä»¶ï¼ˆelf / binï¼‰ï¼› </li><li> æƒ³è±¡ä¸€ä¸‹é“¾æ¥è„šæœ¬æ–‡ä»¶çš„ç”¨é€”ï¼› </li><li> å¯¹æ–‡æœ¬ï¼Œbssï¼Œæ•°æ®å’Œå…¶ä»–éƒ¨åˆ†æœ‰æ‰€äº†è§£ï¼› </li><li> ä¸ä»»ä½•linuxå‘è¡Œç‰ˆä¸€èµ·å·¥ä½œï¼› </li><li> æœ€å°‘æ‹¥æœ‰bashï¼› </li><li> åœ¨gccä¸Šå…·æœ‰Cortex-M3 / Cortex-M4å¤„ç†å™¨ï¼ˆå·¥å…·é“¾arm-none-eabiï¼‰çš„ä½“ç³»ç»“æ„çš„ç»éªŒï¼› </li><li> å…·æœ‰cmakeçš„åˆæ­¥æŠ€èƒ½ã€‚ </li></ul><br><h2> æ–¹æ³•çš„æœ¬è´¨ </h2><br> åœ¨é’ˆå¯¹å¾®æ§åˆ¶å™¨çš„â€œç»å…¸â€é¡¹ç›®ä¸­ï¼Œæ‰€æœ‰ä¸å¯å˜æ•°æ®ï¼ˆæ–‡æœ¬ï¼Œrodataæ®µï¼Œåˆå§‹æ•°æ®å€¼ç­‰ï¼‰é€šå¸¸ä»éæ˜“å¤±æ€§å­˜å‚¨å™¨çš„èµ·å§‹åœ°å€å¼€å§‹ï¼ˆè¿ç»­æ’åˆ—ï¼‰ï¼ˆå¯¹äºåŸºäºCortex-M3 / Cortex-M4å†…æ ¸çš„å¾®æ§åˆ¶å™¨è€Œè¨€ï¼‰-cåœ°å€0x08000000ï¼‰ã€‚ ä»¥ç®€åŒ–çš„å½¢å¼ï¼Œä½¿ç”¨C ++ç¼–å†™çš„åŸºäºCortex-M3 / Cortex-M4å†…æ ¸çš„å¾®æ§åˆ¶å™¨ç¨‹åºçš„éæ˜“å¤±æ€§å­˜å‚¨å™¨ä½¿ç”¨å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><img src="https://habrastorage.org/webt/hl/dw/jx/hldwjx8d-f6k7ogodnjthokeefc.png"><br><br> æ­¤ç±»é¡¹ç›®çš„mem.ldæ–‡ä»¶é€šå¸¸çœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><pre><code class="bash hljs">MEMORY { FLASH (rx) : ORIGIN = 0x08000000, LENGTH = 768K RAM (xrw) : ORIGIN = 0x20000000, LENGTH = 112K }</code> </pre> <br> åœ¨æ­¤ï¼Œæ‰€æœ‰éæ˜“å¤±æ€§å­˜å‚¨å™¨æ˜¯ä¸€ä¸ªåä¸ºâ€œ FLASHâ€çš„å•ä¸ªåˆ†åŒºï¼Œè€Œæ‰€æœ‰RAMæ˜¯ä¸€ä¸ªåä¸ºâ€œ RAMâ€çš„åˆ†åŒºã€‚ ä»¥è¿™ç§å½¢å¼ï¼Œå½“å…¶ä¸­ä¸€ä¸ªä»£ç æ®µæ›´æ”¹æ—¶ï¼Œå…¶ä½™æ‰€æœ‰ä»£ç æ®µéƒ½å¼€å§‹â€œç§»ä½â€ã€‚ ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæ‚¨å¯ä»¥å°†å›ºä»¶æ–‡ä»¶â€œæ‹†åˆ†â€ä¸ºä¸€äº›é€»è¾‘å—ã€‚ ä¾‹å¦‚ï¼Œå¦‚ä¸‹ï¼š <br><br><ul><li> ä¸­æ–­å‘é‡è¡¨ï¼› </li><li> è‡ªå·±çš„å›¾ä¹¦é¦†ï¼› </li><li> ç¬¬ä¸‰æ–¹åº“ï¼ˆä¸æ‰“ç®—æ›´æ”¹ï¼‰ï¼› </li><li> ç»å¸¸ä¿®æ”¹çš„ä»£ç ã€‚ </li></ul><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“æ›´æ”¹ä»£ç æ®µæ—¶ï¼Œåœ¨æœ€ç»ˆçš„binæ–‡ä»¶ä¸­ï¼Œä»…æ›´æ”¹ä»£ç å·²æ›´æ”¹çš„æ®µä»¥åŠä»¥æŸç§æ–¹å¼ä¸å…¶è¿æ¥çš„æ®µï¼ˆä¾‹å¦‚ï¼Œå¦‚æœå¤„ç†ç¨‹åºåœ¨æŸäº›ä½ç½®çš„ä¸­æ–­å‘é‡è¡¨ï¼‰ä»éƒ¨åˆ†ï¼‰ã€‚ <br><br> æœ¬è´¨ä¸Šè®²ï¼Œ <b>é™æ€åº“</b>æ˜¯æ·»åŠ åˆ°é¡¹ç›®ä¸­çš„ã€‚ <br><br> æ¥æ”¶åˆ°é¡¹ç›®æ–‡ä»¶çš„binåï¼Œå¯ä»¥å°†å…¶åˆ’åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œå¹¶åˆ†åˆ«åˆ·æ–°æ¯ä¸ªéƒ¨åˆ†ã€‚ å› æ­¤ï¼Œå°†ä»…ç¼åˆæ›´æ”¹çš„åŒºåŸŸã€‚ è¿™ä¹Ÿæ„å‘³ç€åœ¨è°ƒè¯•ä¹‹å‰ä¸éœ€è¦å›ºä»¶ï¼Œå› ä¸ºå‡å®šå¾®æ§åˆ¶å™¨å°†ç«‹å³å…·æœ‰å¾®æ§åˆ¶å™¨ä¸­çš„æœ€æ–°å›ºä»¶ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ç«‹å³å¼€å§‹è°ƒè¯•ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘å°†è¯¦ç»†æè¿°å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­å®ç°è¿™ä¸€ç‚¹ã€‚ è¿™ç§å†³å®šçš„åˆ©å¼Šå°†åœ¨æœ¬æ–‡çš„ç»“å°¾ç»™å‡ºã€‚ <br><br><h2> å®éªŒé¢†åŸŸ </h2><br> åœ¨å»ºè®®å·¥ä½œä¸­è¿›è¡Œä»»ä½•å½¢å¼çš„åˆ›æ–°ä¹‹å‰ï¼Œè¯·åœ¨æˆ‘çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®¶åº­é¡¹ç›®ä¸­</a>å°è¯•ä¸€ä¸‹ã€‚ ç”±äºå…¶è§„æ¨¡æ¥è¿‘å·¥ä½œä¸­æ—¥å¸¸é¡¹ç›®çš„è§„æ¨¡ï¼Œå› æ­¤æœ‰å¯èƒ½äº†è§£è¿™é¡¹åˆ›æ–°æ˜¯å¦å¯è¡Œä»¥åŠå®ƒæ‰€å¸¦æ¥çš„ç»†å¾®å·®åˆ«ã€‚ <br><br><h2> é¡¹ç›®è¯´æ˜ </h2><br> è¯¥é¡¹ç›®åŒ…å«ï¼š <br><br><ul><li> ä½¿ç”¨è™šæ‹Ÿè¡¨ï¼Œnew / deleteï¼ˆé€šè¿‡ä¸€å †FreeRTOSï¼‰ï¼Œshared_ptrï¼ˆå’Œå…¶ä»–æ™ºèƒ½æŒ‡é’ˆï¼‰ä»¥åŠå…¶ä»–æ ‡å‡†C ++ 14åº“çš„C ++ 14ä¸­ä¸»é¡¹ç›®çš„ä»£ç ï¼› </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FreeRTOS</a>ä½¿ç”¨çº¦6é¡¹ä»»åŠ¡æ¥ç»´æŠ¤ç¡¬ä»¶å¤–å›´åŸºç¡€è®¾æ–½ï¼Œå¹¶ä½¿ç”¨çº¦10é¡¹ä¸šåŠ¡é€»è¾‘ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MakiseGUI</a>å›¾å½¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åº“</a> ï¼Œå•å‡»å¤„ç†ï¼Œä½¿ç”¨fatï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FatFS</a> ï¼‰ç­‰ï¼‰ï¼› </li><li>  16ä¸ªå­˜å‚¨åº“ï¼Œå¸¦æœ‰è‡ªå·±çš„åº“ï¼Œç”¨äºä¸ä¸»æ¿ä¸Šçš„ç¡¬ä»¶å¤–å›´è®¾å¤‡è¿›è¡Œäº¤äº’ï¼Œç”¨äºç³»ç»Ÿè°ƒç”¨çš„å­˜æ ¹ç­‰ï¼› </li></ul><br> ä½¿ç”¨æ±‡ç¼–å‚æ•°-O0 -g3ï¼Œåœ¨å®Œå…¨å®ç°ä¸­çš„ä»£ç ï¼ˆæ”¯æŒunicodeï¼ŒCyrillicç­‰ï¼‰å¤§çº¦éœ€è¦700 KBã€‚ ä½†æ˜¯ï¼Œåœ¨å½“å‰é˜¶æ®µï¼Œå½“ç¡¬ä»¶å¤–å›´è®¾å¤‡ç¨³å®šå¹¶ä¸”ä»…éœ€è¦è°ƒè¯•ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œè¦æ›´æ”¹çš„ä»£ç é‡çº¦ä¸º20 KBã€‚ å› æ­¤ï¼Œä¹çœ‹ä¹‹ä¸‹ï¼Œå½“å‰çš„æ–¹æ³•ä¼¼ä¹æ˜¯è§£å†³è¯¥é—®é¢˜çš„ç†æƒ³è§£å†³æ–¹æ¡ˆï¼ˆå‡ºäºæŸç§åŸå› ï¼Œä¸è€ƒè™‘åœ¨è®¡ç®—æœºä¸Šè¿›è¡Œæ¨¡æ‹Ÿçš„é€‰é¡¹ï¼‰ã€‚ <br><br><h2> è¡ŒåŠ¨æ¸…å• </h2><br> è¦å®ç°ä¸Šè¿°æ–¹æ³•ï¼Œæ‚¨å°†éœ€è¦ï¼š <br><br><ul><li> å°†æ‰€æœ‰å­æ¨¡å—ç»„è£…ä¸ºé™æ€åº“ï¼ˆæœ¬æ–‡çš„åˆ†æé¡¹ç›®åˆ—è¡¨ä¸­æœªåŒ…å«æ­¤é¡¹ç›®çš„æè¿°ï¼‰ï¼› </li><li> é‡å†™mem.ld; </li><li> é‡å†™section.ldï¼› </li><li> å‘ä¸»é¡¹ç›®æ·»åŠ å®ç”¨ç¨‹åºï¼Œä»¥ä»æœ€ç»ˆbinæ–‡ä»¶ä¸­æå–èŠ‚ï¼› </li><li> å‘é¡¹ç›®æ·»åŠ å¯¹è„šæœ¬çš„è°ƒç”¨ï¼Œä»¥åœ¨æ›´æ–°å›ºä»¶æ–‡ä»¶æ—¶æ›´æ–°å¾®æ§åˆ¶å™¨çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨ã€‚ </li></ul><br><h2> é‡å†™mem.ld </h2><br> ç¬¬ä¸€æ­¥æ˜¯é’ˆå¯¹å½“å‰æ¦‚å¿µå®Œå–„â€œæ ‡å‡†â€mem.ldã€‚ åœ¨å®Œæˆæ—¶ï¼Œåº”è€ƒè™‘åˆ°éæ˜“å¤±æ€§å­˜å‚¨å™¨ç”±æ‰‡åŒºæ¸…é™¤ã€‚ è¯·åœ¨æ–‡æ¡£ä¸­é˜…è¯»æœ‰å…³ç‰¹å®šå¾®æ§åˆ¶å™¨ä¸­æ‰‡åŒºç»“æ„çš„æ›´å¤šä¿¡æ¯ï¼ˆå¯¹äºstm32å¾®æ§åˆ¶å™¨ï¼Œè¯·å‚é˜…å‚è€ƒæ‰‹å†Œï¼‰ã€‚ æ¯ä¸ªéƒ¨åˆ†è‡³å°‘å¯ä»¥å æ®ä¸€ä¸ªæ‰‡åŒºï¼ˆå¯ä»¥æ›´å¤šï¼‰ï¼Œå¦åˆ™ä¸€ä¸ªéƒ¨åˆ†å°†è¦†ç›–å¦ä¸€ä¸ªæ‰‡åŒºã€‚ <br><br> è¿˜åº”è¯¥è®°ä½ï¼Œå¦‚æœåº“ä½¿ç”¨å…¨å±€å˜é‡ï¼Œé‚£ä¹ˆå¯¹äºè¯¥åº“ï¼Œæ‚¨éœ€è¦åœ¨é“¾æ¥é˜¶æ®µåœ¨RAMä¸­ä¿ç•™ä¸€ä¸ªä½ç½®ã€‚ å¦åˆ™ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°ä¸æ„‰å¿«çš„é”™è¯¯ï¼Œè¿™äº›é”™è¯¯å°†éå¸¸éš¾ä»¥æ•è·ã€‚ ä¾‹å¦‚ï¼ŒFatFSåº“çš„ä»£ç å°†åœ¨ROM_EXTERNAL_LIBRARIESèŠ‚ä¸­ï¼Œä½†æ˜¯åœ¨æ„å»ºé˜¶æ®µå®ƒéœ€è¦4ä¸ªå­—èŠ‚çš„RAMã€‚ å› æ­¤ï¼Œæ‚¨éœ€è¦ç¡®ä¿RAMä¸­æœ‰ä¸€éƒ¨åˆ†ç”¨äºROM_EXTERNAL_LIBRARIESä¸­çš„ä»£ç å°†ä½¿ç”¨çš„å­—æ®µã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå®ƒæ˜¯RAM_EXTERNAL_LIBRARIESã€‚ <br><br> éæ˜“å¤±æ€§å­˜å‚¨å™¨çš„æœ€åä¸€èŠ‚å€¼å¾—ç‰¹åˆ«æ³¨æ„ã€‚ æ ¹æ®section.ldï¼ˆç¨åä¼šä»‹ç»ï¼‰ï¼Œä¹‹å‰æœªåˆ†è§£ä¸ºç›¸åº”éƒ¨åˆ†çš„æ‰€æœ‰å†…å®¹éƒ½å°†çº³å…¥å…¶ä¸­ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ¨å½“å‰é¡¹ç›®çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œmem.ldå°†å¦‚ä¸‹æ‰€ç¤ºã€‚</b> <div class="spoiler_text"><pre> <code class="bash hljs">/*    stm32f405rgt6   ChiptunePlayer-2.22-MainBoard-v2-Firmware. */ MEMORY { /*-----------------------------FLASH-------------------------------*/ /*  0-1  . */ ROM_BOOTLOADER (RX) : ORIGIN = 0x08000000, LENGTH = 32K /*  2     . */ ROM_SYSCFG_PAGE_1 (R) : ORIGIN = 0x08008000, LENGTH = 16K /*  3      . */ ROM_SYSCFG_PAGE_2 (R) : ORIGIN = 0x0800C000, LENGTH = 16K /*  4 . */ ROM_RESERVE (R) : ORIGIN = 0x08010000, LENGTH = 16K /*  5, 6, 7      (FATFS, FREERTOS...). */ ROM_EXTERNAL_LIBRARIES (RX) : ORIGIN = 0x08020000, LENGTH = 384K /*  8, 9      ( ,  ...). */ ROM_USER_LIBRARIES (RX) : ORIGIN = 0x08080000, LENGTH = 384K /*  5, 6      . */ ROM_MAIN_PROGRAMM (RX) : ORIGIN = 0x080E0000, LENGTH = 128K /*-----------------------------RAM---------------------------------*/ /*      RAM    . */ RAM_PAGE_1 (RW) : ORIGIN = 0x20000000, LENGTH = 112K RAM_PAGE_2 (RW) : ORIGIN = 0x2001C000, LENGTH = 16K /*           FATFS  FreeRTOS. */ RAM_EXTERNAL_LIBRARIES (RW) : ORIGIN = 0x20000000, LENGTH = 10K /*        . */ RAM_USER_LIBRARIES (RW) : ORIGIN = 0x20002800, LENGTH = 90K /*    RAM    . */ RAM_MAIN_PROGRAMM (RW) : ORIGIN = 0x20019000, LENGTH = 27K /*   RAM    .    FreeRTOS. */ RAM_MAIN_PROGRAMM_STACK (RW) : ORIGIN = 0x2001FC00, LENGTH = 1K }</code> </pre> </div></div><br><h2> é‡å†™section.ld </h2><br> å°†ç°æœ‰å­˜å‚¨å¡åˆ†ä¸ºå‡ éƒ¨åˆ†åï¼Œåº”è¯´æ˜è¦æ”¾ç½®çš„åˆ†åŒºã€‚ å¯¹äºæ¯ä¸ªåº“ï¼ˆå¦‚æœåº“ä¸­æœ‰ç›¸åº”çš„èŠ‚ï¼‰ï¼Œè¯·æŒ‡ç¤º.textï¼Œ.rodataï¼Œ.dataï¼Œ.bsså’Œå…¶ä»–èŠ‚çš„ä½ç½®ã€‚ å¯ä»¥ä½¿ç”¨objdumpæŸ¥çœ‹åº“ä¸­å¯ç”¨çš„èŠ‚åˆ—è¡¨ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºlibstdc ++ _ nano.aåº“ï¼Œæ‚¨éœ€è¦æŒ‡å®šæ”¾ç½®æ–‡æœ¬çš„ä½ç½®ï¼ŒARM.attributesï¼Œrodataï¼Œdataï¼Œbsså’ŒCOMMONèŠ‚ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ¨å½“å‰é¡¹ç›®çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œsection.ldå°†å¦‚ä¸‹æ‰€ç¤ºã€‚</b> <div class="spoiler_text"><pre> <code class="bash hljs">/*             RAM. */ __estack = ORIGIN(RAM_MAIN_PROGRAMM_STACK) + LENGTH(RAM_MAIN_PROGRAMM_STACK); /*   . */ __stack_size = LENGTH(RAM_MAIN_PROGRAMM_STACK); /*     Reset_Handler. */ ENTRY(Reset_Handler) /*  . */ SECTIONS { /*---------------------ROM  ------------------------*/ .section_bootloader : ALIGN(4) { /*     .             .          .o ,     .*/ . = ALIGN(4); KEEP(*(.user_code_isr_vector .user_code_isr_vector*)) . = ALIGN(4); } &gt;ROM_BOOTLOADER /*----------------ROM    -----------------*/ /* . */ .section_external_libraries_text : ALIGN(4) { /*  . */ . = ALIGN(4); *libstdc++_nano.a:*(.text .text*); . = ALIGN(4); *libgcc.a:*(.text .text*); . = ALIGN(4); *libg_nano.a:*(.text .text*); /*   */ . = ALIGN(4); *libSTM32F4_LOW_LEVEL_BY_ST.a:*(.text .text*); . = ALIGN(4); *libFATFS.a:*(.text .text*); . = ALIGN(4); *libFREERTOS.a:*(.text .text*); . = ALIGN(4); *libMAKISE_GUI.a:*(.text .text*); . = ALIGN(4); } &gt;ROM_EXTERNAL_LIBRARIES /* ,   */ .section_external_libraries_required_by_the_compiler : ALIGN(4) { /*  . */ . = ALIGN(4); *libgcc.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libstdc++_nano.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libg_nano.a:*(.ARM.attributes .ARM.attributes*); /*   */ . = ALIGN(4); *libSTM32F4_LOW_LEVEL_BY_ST.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libFATFS.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libFREERTOS.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libMAKISE_GUI.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); } &gt;ROM_EXTERNAL_LIBRARIES /*    . */ .section_external_libraries_rodata : ALIGN(4) { /*  . */ . = ALIGN(4); *libgcc.a:*(.rodata .rodata*); . = ALIGN(4); *libstdc++_nano.a:*(.rodata .rodata*); . = ALIGN(4); *libg_nano.a:*(.rodata .rodata*); /*   */ . = ALIGN(4); *libSTM32F4_LOW_LEVEL_BY_ST.a:*(.rodata .rodata*); . = ALIGN(4); *libFATFS.a:*(.rodata .rodata*); . = ALIGN(4); *libFREERTOS.a:*(.rodata .rodata*); . = ALIGN(4); *libMAKISE_GUI.a:*(.rodata .rodata*); . = ALIGN(4); } &gt;ROM_EXTERNAL_LIBRARIES /*----------------------- ---------------------*/ /* . */ .section_user_libraries_text : ALIGN(4) { . = ALIGN(4); *libUSER_FREERTOS_LEVEL.a:*(.text .text*); . = ALIGN(4); *libUSER_BSP_LEVEL.a:*(.text .text*); . = ALIGN(4); *libMC_INTERRUPT.a:*(.text .text*); . = ALIGN(4); *libMC_HARDWARE.a:*(.text .text*); . = ALIGN(4); *libPCB_HARDWARE.a:*(.text .text*); . = ALIGN(4); *libUSER_STARTUP.a:*(.text .text*); . = ALIGN(4); *libBUTTONS.a:*(.text .text*); . = ALIGN(4); *libCHIPTUNE.a:*(.text .text*); . = ALIGN(4); *libDIGITAL_POTENTIOMETER.a:*(.text .text*); . = ALIGN(4); *libLCD_DRIVER.a:*(.text .text*); . = ALIGN(4); *libMAKISE_GUI_ELEMENTS_BY_VADIMATORIK_ELEMENTS_BY_VADIMATORIK.a:*(.text .text*); . = ALIGN(4); *libMC_HARDWARE_INTERFACES_IMPLEMENTATION_FOR_STM32.a:*(.text .text*); . = ALIGN(4); *libMICROSD_LOW_LEVEL_DRIVER.a:*(.text .text*); . = ALIGN(4); *libSHIFT_REGISTER.a:*(.text .text*); . = ALIGN(4); *libWAVE_GENERATORS.a:*(.text .text*); . = ALIGN(4); *libRUN_TIME_LOGGER.a:*(.text .text*); . = ALIGN(4); } &gt;ROM_USER_LIBRARIES /* ,   */ .section_user_libraries_required_by_the_compiler : ALIGN(4) { . = ALIGN(4); *libUSER_FREERTOS_LEVEL.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libUSER_BSP_LEVEL.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libMC_INTERRUPT.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libMC_HARDWARE.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libPCB_HARDWARE.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libUSER_STARTUP.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libUSER_CODE.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libBUTTONS.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libCHIPTUNE.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libDIGITAL_POTENTIOMETER.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libLCD_DRIVER.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libMAKISE_GUI_ELEMENTS_BY_VADIMATORIK_ELEMENTS_BY_VADIMATORIK.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libMC_HARDWARE_INTERFACES_IMPLEMENTATION_FOR_STM32.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libMICROSD_LOW_LEVEL_DRIVER.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libSHIFT_REGISTER.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libWAVE_GENERATORS.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); *libRUN_TIME_LOGGER.a:*(.ARM.attributes .ARM.attributes*); . = ALIGN(4); } &gt;ROM_EXTERNAL_LIBRARIES /*    . */ .section_user_libraries_rodata : ALIGN(4) { . = ALIGN(4); *libUSER_FREERTOS_LEVEL.a:*(.rodata .rodata*); . = ALIGN(4); *libUSER_BSP_LEVEL.a:*(.rodata .rodata*); . = ALIGN(4); *libMC_INTERRUPT.a:*(.rodata .rodata*); . = ALIGN(4); *libMC_HARDWARE.a:*(.rodata .rodata*); . = ALIGN(4); *libPCB_HARDWARE.a:*(.rodata .rodata*); . = ALIGN(4); *libUSER_STARTUP.a:*(.rodata .rodata*); . = ALIGN(4); *libBUTTONS.a:*(.rodata .rodata*); . = ALIGN(4); *libCHIPTUNE.a:*(.rodata .rodata*); . = ALIGN(4); *libDIGITAL_POTENTIOMETER.a:*(.rodata .rodata*); . = ALIGN(4); *libLCD_DRIVER.a:*(.rodata .rodata*); . = ALIGN(4); *libMAKISE_GUI_ELEMENTS_BY_VADIMATORIK_ELEMENTS_BY_VADIMATORIK.a:*(.rodata .rodata*); . = ALIGN(4); *libMC_HARDWARE_INTERFACES_IMPLEMENTATION_FOR_STM32.a:*(.rodata .rodata*); . = ALIGN(4); *libMICROSD_LOW_LEVEL_DRIVER.a:*(.rodata .rodata*); . = ALIGN(4); *libSHIFT_REGISTER.a:*(.rodata .rodata*); . = ALIGN(4); *libWAVE_GENERATORS.a:*(.rodata .rodata*); . = ALIGN(4); *libRUN_TIME_LOGGER.a:*(.rodata .rodata*); . = ALIGN(4); } &gt;ROM_USER_LIBRARIES /*------------------------- ------------------------*/ /* . */ .section_user_code_text : ALIGN(4) { . = ALIGN(4); *(.text .text.*) . = ALIGN(4); } &gt;ROM_MAIN_PROGRAMM /* ,   */ .sections_user_code_required_by_the_compiler : ALIGN(4) { . = ALIGN(4); *(.glue_7 .glue_7*) /*  -  ARMv7 */ . = ALIGN(4); *(.glue_7t .glue_7t*) . = ALIGN(4); *(.vfp11_veneer .vfp11_veneer*) /*   . */ . = ALIGN(4); *(.v4_bx .v4_bx*) . = ALIGN(4); *(.iplt .iplt*) . = ALIGN(4); *(.rel.dyn .rel.dyn*) . = ALIGN(4); KEEP(*(.eh_frame .eh_frame*)) /*     CPP. */ . = ALIGN(4); *(.eh_framehdr .eh_framehdr*) . = ALIGN(4); *(.ARM.attributes .ARM.attributes.*) /*    ,  . */ . = ALIGN(4); *(vtable) /* C++ virtual tables */ PROVIDE_HIDDEN (__preinit_array_start = .); /*  ,   . */ . = ALIGN(4); KEEP(*(.preinit_array_sysinit .preinit_array_sysinit*)) . = ALIGN(4); KEEP(*(.preinit_array_platform .preinit_array_platform.*)) . = ALIGN(4); KEEP(*(.preinit_array .preinit_array.*)) PROVIDE_HIDDEN (__preinit_array_end = .); PROVIDE_HIDDEN (__init_array_start = .); /*    . */ . = ALIGN(4); KEEP(*(SORT(.init_array.*))) . = ALIGN(4); KEEP(*(.init_array)) . = ALIGN(4); PROVIDE_HIDDEN (__init_array_end = .); PROVIDE_HIDDEN (__fini_array_start = .); /*    . */ . = ALIGN(4); KEEP(*(SORT(.fini_array.*))) . = ALIGN(4); KEEP(*(.fini_array)) . = ALIGN(4); PROVIDE_HIDDEN (__fini_array_end = .); . = ALIGN(4); KEEP(*(.cfmconfig)) . = ALIGN(4); *(.after_vectors .after_vectors.*) . = ALIGN(4); } &gt;ROM_MAIN_PROGRAMM /*    . */ .section_user_code_rodata : ALIGN(4) { . = ALIGN(4); *(.rodata .rodata.*) . = ALIGN(4); } &gt;ROM_MAIN_PROGRAMM /*  stack trace. */ .ARM.exidx : { . = ALIGN(4); *(.ARM.extab* .gnu.linkonce.armextab.*) . = ALIGN(4); *(.ARM.exidx* .gnu.linkonce.armexidx.*) . = ALIGN(4); } &gt; ROM_MAIN_PROGRAMM /*-------------------------------RAM-----------------------------*/ /*    . */ .section_external_libraries_data : ALIGN(4) { . = ALIGN(4); __external_lib_data_start = . ; /*  . */ . = ALIGN(4); *libgcc.a:*(.data .data*); . = ALIGN(4); *libstdc++_nano.a:*(.data .data*); . = ALIGN(4); *libg_nano.a:*(.data .data*); /*   */ . = ALIGN(4); *libSTM32F4_LOW_LEVEL_BY_ST.a:*(.data .data*); . = ALIGN(4); *libFATFS.a:*(.data .data*); . = ALIGN(4); *libFREERTOS.a:*(.data .data*); . = ALIGN(4); *libMAKISE_GUI.a:*(.data .data*); . = ALIGN(4); __external_lib_data_end = . ; } &gt;RAM_EXTERNAL_LIBRARIES AT&gt; ROM_EXTERNAL_LIBRARIES /*       RAM */ .section_external_libraries_bss : ALIGN(4) { . = ALIGN(4); __external_lib_bss_start = .; /*  . */ . = ALIGN(4); *libgcc.a:*(.bss .bss*); . = ALIGN(4); *libstdc++_nano.a:*(.bss .bss*); . = ALIGN(4); *libg_nano.a:*(*COMMON); . = ALIGN(4); *libgcc.a:*(*COMMON); . = ALIGN(4); *libstdc++_nano.a:*(*COMMON); . = ALIGN(4); *libg_nano.a:*(*COMMON); /*   */ . = ALIGN(4); *libSTM32F4_LOW_LEVEL_BY_ST.a:*(.bss .bss*); . = ALIGN(4); *libFATFS.a:*(.bss .bss*); . = ALIGN(4); *libFREERTOS.a:*(.bss .bss*); . = ALIGN(4); *libMAKISE_GUI.a:*(.bss .bss*); . = ALIGN(4); *libSTM32F4_LOW_LEVEL_BY_ST.a:*(*COMMON); . = ALIGN(4); *libFATFS.a:*(*COMMON); . = ALIGN(4); *libFREERTOS.a:*(*COMMON); . = ALIGN(4); *libMAKISE_GUI.a:*(*COMMON); . = ALIGN(4); __external_lib_bss_end = .; } &gt;RAM_EXTERNAL_LIBRARIES /*    . */ .section_user_libraries_data : ALIGN(4) { . = ALIGN(4); __user_lib_data_start = . ; . = ALIGN(4); *libUSER_FREERTOS_LEVEL.a:*(.data .data*); . = ALIGN(4); *libUSER_BSP_LEVEL.a:*(.data .data*); . = ALIGN(4); *libMC_INTERRUPT.a:*(.data .data*); . = ALIGN(4); *libMC_HARDWARE.a:*(.data .data*); . = ALIGN(4); *libPCB_HARDWARE.a:*(.data .data*); . = ALIGN(4); *libUSER_STARTUP.a:*(.data .data*); . = ALIGN(4); *libBUTTONS.a:*(.data .data*); . = ALIGN(4); *libCHIPTUNE.a:*(.data .data*); . = ALIGN(4); *libDIGITAL_POTENTIOMETER.a:*(.data .data*); . = ALIGN(4); *libLCD_DRIVER.a:*(.data .data*); . = ALIGN(4); *libMAKISE_GUI_ELEMENTS_BY_VADIMATORIK_ELEMENTS_BY_VADIMATORIK.a:*(.data .data*); . = ALIGN(4); *libMC_HARDWARE_INTERFACES_IMPLEMENTATION_FOR_STM32.a:*(.data .data*); . = ALIGN(4); *libMICROSD_LOW_LEVEL_DRIVER.a:*(.data .data*); . = ALIGN(4); *libSHIFT_REGISTER.a:*(.data .data*); . = ALIGN(4); *libWAVE_GENERATORS.a:*(.data .data*); . = ALIGN(4); *libRUN_TIME_LOGGER.a:*(.data .data*); . = ALIGN(4); __user_lib_data_end = . ; } &gt;RAM_USER_LIBRARIES AT&gt; ROM_USER_LIBRARIES .section_user_libraries_bss : ALIGN(4) { . = ALIGN(4); __user_lib_bss_start = .; . = ALIGN(4); *libUSER_FREERTOS_LEVEL.a:*(.bss .bss*); . = ALIGN(4); *libUSER_BSP_LEVEL.a:*(.bss .bss*); . = ALIGN(4); *libMC_INTERRUPT.a:*(.bss .bss*); . = ALIGN(4); *libMC_HARDWARE.a:*(.bss .bss*); . = ALIGN(4); *libPCB_HARDWARE.a:*(.bss .bss*); . = ALIGN(4); *libUSER_CODE.a:*(.bss .bss*); . = ALIGN(4); *libBUTTONS.a:*(.bss .bss*); . = ALIGN(4); *libCHIPTUNE.a:*(.bss .bss*); . = ALIGN(4); *libDIGITAL_POTENTIOMETER.a:*(.bss .bss*); . = ALIGN(4); *libLCD_DRIVER.a:*(.bss .bss*); . = ALIGN(4); *libMAKISE_GUI_ELEMENTS_BY_VADIMATORIK_ELEMENTS_BY_VADIMATORIK.a:*(.bss .bss*); . = ALIGN(4); *libMC_HARDWARE_INTERFACES_IMPLEMENTATION_FOR_STM32.a:*(.bss .bss*); . = ALIGN(4); *libMICROSD_LOW_LEVEL_DRIVER.a:*(.bss .bss*); . = ALIGN(4); *libSHIFT_REGISTER.a:*(.bss .bss*); . = ALIGN(4); *libWAVE_GENERATORS.a:*(.bss .bss*); . = ALIGN(4); *libUSER_FREERTOS_LEVEL.a:*(.bss .bss*); . = ALIGN(4); *libRUN_TIME_LOGGER.a:*(.bss .bss*); . = ALIGN(4); *libUSER_BSP_LEVEL.a:*(*COMMON); . = ALIGN(4); *libMC_INTERRUPT.a:*(*COMMON); . = ALIGN(4); *libMC_HARDWARE.a:*(*COMMON); . = ALIGN(4); *libPCB_HARDWARE.a:*(*COMMON); . = ALIGN(4); *libUSER_CODE.a:*(*COMMON); . = ALIGN(4); *libBUTTONS.a:*(*COMMON); . = ALIGN(4); *libCHIPTUNE.a:*(*COMMON); . = ALIGN(4); *libDIGITAL_POTENTIOMETER.a:*(*COMMON); . = ALIGN(4); *libLCD_DRIVER.a:*(*COMMON); . = ALIGN(4); *libMAKISE_GUI_ELEMENTS_BY_VADIMATORIK_ELEMENTS_BY_VADIMATORIK.a:*(*COMMON); . = ALIGN(4); *libMC_HARDWARE_INTERFACES_IMPLEMENTATION_FOR_STM32.a:*(*COMMON); . = ALIGN(4); *libMICROSD_LOW_LEVEL_DRIVER.a:*(*COMMON); . = ALIGN(4); *libSHIFT_REGISTER.a:*(*COMMON); . = ALIGN(4); *libWAVE_GENERATORS.a:*(*COMMON); . = ALIGN(4); *libRUN_TIME_LOGGER.a:*(.COMMON*); . = ALIGN(4); __user_lib_bss_end = .; } &gt;RAM_USER_LIBRARIES /*    . */ .section_user_code_data : ALIGN(4) { . = ALIGN(4); __user_code_data_start = . ; . = ALIGN(4); *(.data .data.*) . = ALIGN(4); __user_code_data_end = . ; } &gt;RAM_MAIN_PROGRAMM AT&gt; ROM_MAIN_PROGRAMM .section_user_code_bss : ALIGN(4) { . = ALIGN(4); __bss_start__ = .; __user_code_bss_start = .; *(.bss .bss.*) *(COMMON) . = ALIGN(4); __bss_end__ = .; __user_code_bss_end = .; } &gt;RAM_MAIN_PROGRAMM __external_lib_data_in_rom_start = LOADADDR(.section_external_libraries_data); __user_lib_data_in_rom_start = LOADADDR(.section_user_libraries_data); __user_code_data_in_rom_start = LOADADDR(.section_user_code_data); /*------------------------- -----------------*/ /* Stabs debugging sections. */ .stab 0 : { *(.stab) } .stabstr 0 : { *(.stabstr) } .stab.excl 0 : { *(.stab.excl) } .stab.exclstr 0 : { *(.stab.exclstr) } .stab.index 0 : { *(.stab.index) } .stab.indexstr 0 : { *(.stab.indexstr) } .comment 0 : { *(.comment) } /* * DWARF debug sections. * Symbols <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the DWARF debugging sections are relative to the beginning * of the section so we begin them at 0. */ /* DWARF 1 */ .debug 0 : { *(.debug) } .line 0 : { *(.line) } /* GNU DWARF 1 extensions */ .debug_srcinfo 0 : { *(.debug_srcinfo) } .debug_sfnames 0 : { *(.debug_sfnames) } /* DWARF 1.1 and DWARF 2 */ .debug_aranges 0 : { *(.debug_aranges) } .debug_pubnames 0 : { *(.debug_pubnames) } /* DWARF 2 */ .debug_info 0 : { *(.debug_info .gnu.linkonce.wi.*) } .debug_abbrev 0 : { *(.debug_abbrev) } .debug_line 0 : { *(.debug_line) } .debug_frame 0 : { *(.debug_frame) } .debug_str 0 : { *(.debug_str) } .debug_loc 0 : { *(.debug_loc) } .debug_macinfo 0 : { *(.debug_macinfo) } /* SGI/MIPS DWARF 2 extensions */ .debug_weaknames 0 : { *(.debug_weaknames) } .debug_funcnames 0 : { *(.debug_funcnames) } .debug_typenames 0 : { *(.debug_typenames) } .debug_varnames 0 : { *(.debug_varnames) } .debug_macro 0 : { *(.debug_macro) } .debug_ranges 0 : { *(.debug_ranges) } }</code> </pre> </div></div><br><h2> åœ¨ä¸»é¡¹ç›®ä¸­æ·»åŠ å®ç”¨ç¨‹åºï¼Œä»¥ä»æœ€ç»ˆbinæ–‡ä»¶ä¸­æå–èŠ‚ </h2><br> ä¸å¹¸çš„æ˜¯ï¼Œæ— æ³•åœ¨objcopyæˆ–objdumpä¸­æ‰¾åˆ°ç”¨äºä»elfæ–‡ä»¶æå–ç‰¹å®šåœ°å€ä¹‹é—´çš„ä»£ç çš„æ ‡å¿—ã€‚ æœ‰ä¸€ä¸ª<b>--only-section</b>æ ‡å¿—ï¼Œä½†æ˜¯ï¼Œå®ƒæ²¡æœ‰è€ƒè™‘åˆ°åœ¨section.ldä¸­åˆ—å‡ºçš„æ‰€æœ‰å®ä½“å®ä½“ä¹‹åï¼Œè°ƒè¯•ä¿¡æ¯ä»æ”¾ç½®åœ¨éæ˜“å¤±æ€§å­˜å‚¨å™¨ä¸­çš„äº‹å®ã€‚ æ²¡æœ‰å®ƒï¼Œæœ€ç»ˆçš„å›ºä»¶ï¼ˆç”±å„ä¸ªéƒ¨ä»¶ç»„è£…è€Œæˆï¼‰å°†æ— æ³•å·¥ä½œï¼ˆå‡ºäºæ˜æ˜¾çš„åŸå› ï¼‰ã€‚ å› æ­¤ï¼Œæˆ‘å¿…é¡»ç¼–å†™ä¸€ä¸ªç®€å•çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®ç”¨ç¨‹åº</a> ï¼Œè¯¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®ç”¨ç¨‹åº</a>é‡‡ç”¨ä¸€ä¸ªå…¬å…±binæ–‡ä»¶å¹¶å°†æ‰€éœ€èŠ‚æå–åˆ°ç”¨äºæŒ‡å®šåœ°å€èŒƒå›´çš„å•ç‹¬æ–‡ä»¶ä¸­ã€‚ ä½†æ˜¯ï¼Œåœ¨è¿™é‡Œå‡ºç°ä»¥ä¸‹ç»†å¾®å·®åˆ«ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œobjcopyç”¨0å¡«å……èŠ‚ä¹‹é—´çš„ç©ºé—´ã€‚ ä½†æ˜¯ï¼Œé—ªå­˜ä¸­çš„ç©ºç™½ç©ºé—´ä¸º0xFFã€‚ è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æ ‡å¿—<b>--gap-fill = 0xff</b>ç»„æˆè¾“å‡ºbinæ–‡ä»¶ã€‚ <br><br><h2> åœ¨æ›´æ–°å›ºä»¶æ–‡ä»¶æ—¶ï¼Œå°†å¯¹è„šæœ¬çš„è°ƒç”¨æ·»åŠ åˆ°é¡¹ç›®ä¸­ä»¥æ›´æ–°å¾®æ§åˆ¶å™¨çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨ </h2><br> è¦è·Ÿè¸ªé¡¹ç›®ä¸­çš„æ›´æ”¹ï¼Œåœ¨æ¯æ¬¡é‡å»ºelfæ–‡ä»¶ä¹‹åï¼Œæ‚¨éœ€è¦è°ƒç”¨ä¸€ä¸ªéªŒè¯è„šæœ¬ï¼Œè¯¥è„šæœ¬å°†ä»elfæ–‡ä»¶ä¸­æå–æœ€ç»ˆçš„binæ–‡ä»¶ï¼Œæ¯”è¾ƒå…¶ä¸­æ‰€éœ€çš„éƒ¨åˆ†ï¼Œå°†å…¶ä¸å…ˆå‰æå–çš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå‘ç”Ÿä»»ä½•å·®å¼‚ï¼Œè¯·æ›´æ–°å¾®æ§åˆ¶å™¨å†…å­˜ä¸­çš„éƒ¨åˆ†ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ¯”è¾ƒè„šæœ¬ä»£ç </b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # # $1 -  .   ,    . # $2 -     elf . # $3 -      STM32. # echo "Old file name: $1" echo "New file name: $2" # ,     . flag_rewrite=0 #    ,         #  ,      (   #     ). #    ,   ,   -    #  ,     .  ,   . if [ -e $1 ] then #         . echo "Both files exist." #  md5   ,     . buf=$(md5sum $1 --binary) md5_old=${buf:0:32} #      md5   . #   32 . buf=$(md5sum $2 --binary) md5_new=${buf:0:32} echo "Started file comparison." if [ $md5_old == $md5_new ] then #     ,  . echo "The file has not been updated." echo "The new file will be deleted." rm $2 echo "Removed." else #   ,    . echo "The file has been modified." echo "Old will be replaced by new." mv $2 $1 echo "Replaced." flag_rewrite=1 #    . fi else #    . echo "Old file does not exist." echo "New will be renamed to old." mv $2 $1 #    . flag_rewrite=1 #    . echo "Renamed." fi #       ,     . if [ $flag_rewrite -eq 1 ] then echo "Started flashing." echo "CMD params: $3" $3 fi</span></span></code> </pre> <br></div></div><br>      cmake ,    : <br><div class="spoiler"> <b class="spoiler_title">Cmake  </b> <div class="spoiler_text"><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(write_sector SECTOR ADDR_BASE ADDR_START ADDR_END) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_command</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span> <span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf POST_BUILD <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${ARM_OBJCOPY}</span></span> --output-<span class="hljs-keyword"><span class="hljs-keyword">target</span></span>=binary --gap-fill=<span class="hljs-number"><span class="hljs-number">0</span></span>xff <span class="hljs-variable"><span class="hljs-variable">${PROJECT_BINARY_DIR}</span></span>/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf <span class="hljs-variable"><span class="hljs-variable">${PROJECT_BINARY_DIR}</span></span>/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>_all.bin COMMENT <span class="hljs-string"><span class="hljs-string">"Creating a binary file of the &lt;&lt;${SECTOR}&gt;&gt; sector"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${BIN_EXTRACTOR}</span></span> -p <span class="hljs-variable"><span class="hljs-variable">${PROJECT_BINARY_DIR}</span></span>/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>_all.bin -o <span class="hljs-variable"><span class="hljs-variable">${PROJECT_BINARY_DIR}</span></span>/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>_section_<span class="hljs-variable"><span class="hljs-variable">${SECTOR}</span></span>_new.bin -b <span class="hljs-variable"><span class="hljs-variable">${ADDR_BASE}</span></span> -s <span class="hljs-variable"><span class="hljs-variable">${ADDR_START}</span></span> -e <span class="hljs-variable"><span class="hljs-variable">${ADDR_END}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> cd <span class="hljs-variable"><span class="hljs-variable">${CMAKE_SOURCE_DIR}</span></span> &amp;&amp; ./cmp.sh <span class="hljs-variable"><span class="hljs-variable">${PROJECT_BINARY_DIR}</span></span>/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>_section_<span class="hljs-variable"><span class="hljs-variable">${SECTOR}</span></span>.bin <span class="hljs-variable"><span class="hljs-variable">${PROJECT_BINARY_DIR}</span></span>/<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>_section_<span class="hljs-variable"><span class="hljs-variable">${SECTOR}</span></span>_new.bin <span class="hljs-string"><span class="hljs-string">"${STM32PROG} -c port=${STM32PROG_PORT} freq=${STM32PROG_FREQ} -w ${PROJECT_BINARY_DIR}/${PROJECT_NAME}_section_${SECTOR}.bin ${ADDR_START}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endfunction</span></span>(write_sector)</code> </pre> </div></div><br>     stm32programmer. <br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (STM32PROG_USE <span class="hljs-keyword"><span class="hljs-keyword">STREQUAL</span></span> <span class="hljs-string"><span class="hljs-string">"ON"</span></span>) write_sector(<span class="hljs-string"><span class="hljs-string">"bootloader"</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_BOOTLOADER_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_BOOTLOADER_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_SYSCFG_PAGE_1_ADDRESS}</span></span>) write_sector(<span class="hljs-string"><span class="hljs-string">"external_libraries"</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_BOOTLOADER_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_EXTERNAL_LIB_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_USER_LIBRARIES_ADDRESS}</span></span>) write_sector(<span class="hljs-string"><span class="hljs-string">"user_libraries"</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_BOOTLOADER_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_USER_LIBRARIES_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_USER_CODE_ADDRESS}</span></span>) write_sector(<span class="hljs-string"><span class="hljs-string">"main_programm"</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_BOOTLOADER_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${SECTION_USER_CODE_ADDRESS}</span></span> <span class="hljs-variable"><span class="hljs-variable">${ADDR_END_FLASH}</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span> ()</code> </pre> </div></div><br><br><h2> ç»“è®º </h2><br>   : <br><br><ol><li>  95%    ,  ; </li></ol><br>   : <br><ol><li>     ,              (   stm32programmer-).   ,    ,       ; </li><li>  section.ld         -.         ,     GUI    ; </li><li>  ,     ,    ,         (  , )        :). </li></ol><br>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> .     CLion-,        bin . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN437848/">https://habr.com/ru/post/zh-CN437848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN437836/index.html">æ·±å…¥æµ…å‡º-é¢å‘ç¨‹åºå‘˜çš„MMOæ²™ç®±ä¸­çš„è™šæ‹ŸåŒ–</a></li>
<li><a href="../zh-CN437838/index.html">æœºå™¨å­¦ä¹ æŠ€æœ¯æœ‰æ—¶ä¼šåŠ é€Ÿæ‚£è€…é€‚åº”ä»¿ç”Ÿå‡ä½“çš„è¿‡ç¨‹</a></li>
<li><a href="../zh-CN437842/index.html">å¤§é‡‘åˆšçš„ç§˜å¯†æ•…äº‹ï¼šä»è¡—æœºåˆ°NES</a></li>
<li><a href="../zh-CN437844/index.html">é™æ€ä¸åŠ¨æ€ç±»å‹çš„æŒä¹…å†²çª-TypeScriptå°†æ— æµäºäº‹</a></li>
<li><a href="../zh-CN437846/index.html">bobaoskit-é™„ä»¶ï¼Œdnssdå’ŒWebSocket</a></li>
<li><a href="../zh-CN437850/index.html">è°åœ¨PCBå¸ƒå±€ä¸Šæœ€æœ‰æ•ˆï¼Ÿ</a></li>
<li><a href="../zh-CN437852/index.html">Shipastikçš„å†å²</a></li>
<li><a href="../zh-CN437858/index.html">Technopolisçš„â€œè®¾è®¡é«˜è´Ÿè½½ç³»ç»Ÿâ€è¯¾ç¨‹ï¼ˆ2018å¹´ç§‹å­£ï¼‰çš„å…¶ä»–è®²åº§</a></li>
<li><a href="../zh-CN437864/index.html">ç”¨äºåŸºäºçº¯SQLçš„WindowsæœåŠ¡å™¨çš„ç›‘è§†ç³»ç»Ÿï¼Œä»¥åŠæˆ‘å¦‚ä½•å°†å…¶ç§˜å¯†åœ°æ‹–å…¥ç”Ÿäº§ç¯å¢ƒ</a></li>
<li><a href="../zh-CN437868/index.html">å®‰å…¨å‘¨05ï¼šæ‰“å°æœºï¼Œç›¸æœºï¼Œ7zipå’Œé“å¾·è§„èŒƒ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>