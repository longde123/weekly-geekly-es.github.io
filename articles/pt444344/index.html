<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👩🏾 🧝🏻 💪🏿 10 etapas para um projeto Python bem-sucedido 🎃 👨‍🌾 🔁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O material, cuja tradução publicamos hoje, é dedicado a ferramentas que permitem equipar os projetos Python com ferramentas de formatação de código, t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>10 etapas para um projeto Python bem-sucedido</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/444344/">  O material, cuja tradução publicamos hoje, é dedicado a ferramentas que permitem equipar os projetos Python com ferramentas de formatação de código, teste, integração contínua e análise de dependência.  Isso ajuda a acelerar o processo de desenvolvimento, ajuda a melhorar a qualidade, uniformidade e segurança do código.  Supõe-se que o leitor deste material já tenha alguma experiência no desenvolvimento de Python e um projeto de Python com o qual ele, durante a leitura, experimentará.  Se você não possui um projeto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> pode aprender como preparar um ambiente de desenvolvimento e criar um pacote Python.  Os exemplos que serão dados aqui são preparados usando o macOS e o Python 3.7. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/nn/pf/ir/nnpfirpitm1blak2m4jfuludveo.jpeg"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Etapa 1. Instalando o Black</font> </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/00e/346/c01/00e346c01d193e87d70225c59cd191c3.png"></div><br>  O código do projeto deve seguir as convenções de estilo de código.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Black</a> é um pacote Python que formata automaticamente o código, trazendo sua aparência para o padrão <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PEP 8</a> .  O preto é um projeto relativamente novo, mas já ganhou mais de um milhão de downloads.  Seu uso rapidamente se tornou um sinal de bom gosto no desenvolvimento do Python.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> está o manual preto. <br><br>  Como editor de código, uso o Atom, então adicionei o pacote <code>Python-Black</code> ao Atom.  Você pode descobrir como instalá-lo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Depois de instalar este pacote, o Atom reformatará o código após salvar o arquivo. <br><br>  Enquanto falamos de Black - vamos equipar esta ferramenta com o ambiente de desenvolvimento daqueles que trabalham conosco no projeto.  Como resultado, todos que trabalham no projeto usarão as mesmas regras de formatação de código, caso contrário, suas solicitações de recebimento não serão aceitas. <br><br>  Inclua o <code>black==18.9b0</code> na primeira linha livre encontrada do arquivo <code>requirements_dev.txt</code> e execute o comando <code>install -r requirements_dev.txt</code> . <br><br>  Preto, por padrão, define o comprimento da linha de código para 88 caracteres.  Alguns guias de estilo, como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sphinx</a> , exigem um comprimento de string de 79 caracteres.  Nas configurações do pacote <code>Black-Atom</code> , você pode definir o comprimento de linha desejado. <br><br>  Agora que temos uma ferramenta que ajudará a economizar tempo na formatação do código, pensaremos em como acelerar e simplificar o envio de código para o PyPI. <br><br><h2>  <font color="#3AC1EF">Etapa 2. Criando o arquivo .pypirc</font> </h2><br>  Quando o fio é usado para enviar assemblies de aplicativos para TestPyPI e PyPI, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">você</a> deve inserir manualmente as informações de login.  Se você não está familiarizado com o barbante, dê uma olhada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste</a> material.  Agora vamos automatizar esse processo. <br><br>  O fio pode trabalhar com o arquivo <code>.pypirc</code> , que deve estar em nosso diretório pessoal.  Essa ferramenta, descarregando dados, usa um URL, nome de usuário e senha de um determinado arquivo. <br><br>  Portanto, crie um arquivo <code>.pypirc</code> no seu diretório pessoal: <br><br><pre> <code class="python hljs">touch ~/.pypirc</code> </pre> <br>  Adicione o seguinte texto a ele: <br><br><pre> <code class="python hljs">[distutils] index-servers =   pypi   testpypi [testpypi] repository: https://test.pypi.org/legacy username = your_username password = your_pypitest_password [pypi] username = your_username password = your_pypi_password</code> </pre> <br>  É claro que aqui você deve digitar seu nome de usuário e senha reais.  Além disso, verifique se esse arquivo está salvo no diretório inicial e não no diretório de trabalho atual.  Se você deseja proteger este arquivo de outros usuários, é possível, usando as ferramentas de linha de comando, configurar suas permissões: <br><br><pre> <code class="python hljs">chmod <span class="hljs-number"><span class="hljs-number">600</span></span> ~/.pypirc</code> </pre> <br>  Agora seu pacote pode ser carregado no TestPyPI usando o seguinte comando: <br><br><pre> <code class="python hljs">twine upload -r testpypi dist/*</code> </pre> <br>  No PyPI comum, você pode carregar pacotes como este: <br><br><pre> <code class="python hljs">twine upload dist/*</code> </pre> <br>  Depois de obter o arquivo <code>.pypirc</code> , você não precisa mais digitar manualmente seu nome de usuário e senha. <br><br>  Agora, vamos adicionar ferramentas de teste ao nosso ambiente de desenvolvimento que nos permitirão verificar a operação correta do pacote que estamos criando. <br><br><h2>  <font color="#3AC1EF">Etapa 3. Instale e configure o pytest</font> </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/561/860/645/561860645caff54bbde0e568e9d319ab.jpg"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Pytest</a> é a biblioteca mais popular e fácil de usar para testar código escrito em Python.  Neste exemplo, adicionaremos testes simples ao projeto.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Agora</a> , se você estiver interessado nos detalhes do pytest, um bom guia introdutório para esta ferramenta. <br><br>  Adicione os detalhes do pytest ao <code>requirements_dev.txt</code> : <br><br><pre> <code class="python hljs">pytest==<span class="hljs-number"><span class="hljs-number">4.3</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br>  Vamos instalar o pacote: <br><br><pre> <code class="python hljs">pip install requirements_dev.txt</code> </pre> <br>  Agora execute o seguinte comando, que permitirá ao pytest encontrar nosso pacote: <br><br><pre> <code class="python hljs">pip install -e .</code> </pre> <br>  Se você desativou seu ambiente de desenvolvimento virtual, precisará executar os dois comandos <code>pip</code> novamente para executar os testes. <br><br><h2>  <font color="#3AC1EF">Etapa 4. Criando testes</font> </h2><br>  Adicione a pasta de <code>test</code> ao diretório raiz do seu projeto.  Coloque o arquivo <code>test_your_package_name.py</code> nele.  Meu arquivo é chamado <code>test_notebookc.py</code> .  Se o nome do arquivo começar com <code>test_</code> , o pytest poderá detectar automaticamente esse arquivo. <br><br>  <code>test_notebookc.py</code> o seguinte teste ao arquivo <code>test_notebookc.py</code> , que visa verificar se a função exibe o nome correto.  Modifique este código para que os nomes de arquivo e função usados ​​correspondam aos seus e descreva seus próprios testes. <br><br><pre> <code class="python hljs"><span class="hljs-string"><span class="hljs-string">"""Tests for `notebookc` package."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> notebookc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> notebookc <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_convert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capsys)</span></span></span><span class="hljs-function">:</span></span>   <span class="hljs-string"><span class="hljs-string">"""Correct my_name argument prints"""</span></span>   notebookc.convert(<span class="hljs-string"><span class="hljs-string">"Jill"</span></span>)   captured = capsys.readouterr()   <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-string"><span class="hljs-string">"Jall"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> captured.out</code> </pre> <br>  O que está acontecendo aqui? <br><br>  Primeiro importamos nosso módulo aqui.  Em seguida, criamos uma função cujo nome é construído de acordo com o modelo <code>test_my_function_name</code> .  Essa convenção de nomenclatura de funções permite que outras pessoas que leem o código do seu projeto entendam rapidamente o que exatamente está sendo testado nos testes.  Além disso, isso é necessário para um pacote que ajuda a controlar a cobertura do código com testes, que discutiremos abaixo. <br><br>  Depois disso, chamamos a função ( <code>convert</code> ), passando o nome <code>Jill</code> como argumento.  Próximo - capture o que a função exibe.  Aqui vale a pena dizer que a função em questão é extremamente simples.  Ela usa o parâmetro <code>my_name</code> e faz o seguinte: <br><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">f"I'll convert a notebook for you some day, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{my_name}</span></span></span><span class="hljs-string">."</span></span>)</code> </pre> <br>  O Pytest verifica se <code>Jall</code> está <code>Jall</code> no que a função gera.  Essa linha não deve estar lá, pois passamos as funções <code>Jill</code> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> está a documentação do pytest, onde você pode encontrar informações sobre a interceptação de saída. <br><br>  Execute o teste digitando <code>pytest</code> no prompt de comando.  Este teste deve falhar.  As informações do erro são exibidas em vermelho. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/61c/cfb/1f6/61ccfb1f6cff485d9cd90f8f68f2d33c.png"></div><br>  <i><font color="#999999">Um erro foi detectado durante o teste.</font></i> <br><br>  Recomenda-se verificar se os testes estão corretos, descrevendo-os para que, sob certas condições, eles terminem com um erro.  Você não deve escrever testes que fornecem apenas mensagens verdes; caso contrário, pode acontecer que os testes não verifiquem o que foram escritos para verificar. <br><br>  Depois de garantir que o teste falhe, altere a instrução <code>Jall</code> para <code>Jill</code> e execute o teste novamente.  Agora deve ser concluído com sucesso. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c64/d72/bf5/c64d72bf51a42f3f209c00dc46e8ee52.png"></div><br>  <i><font color="#999999">Conclusão bem sucedida do teste.</font></i> <br><br>  Agora está tudo bem.  O teste permite garantir que, se alguém passar uma linha para nossa função, essa linha cairá no texto que essa função exibe. <br><br>  Você também pode escrever um teste que verifique a função de como ele lida com os dados passados ​​para ele.  Nomeadamente, se ele receber dados cujo tipo é diferente da sequência, ele deverá causar um erro de TypeError.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui estão</a> algumas coisas boas sobre exceções e manipulação de erros no Python. <br><br>  Quando criamos o teste anterior, escrevemos um código que leva à conclusão bem-sucedida do teste.  Isso é chamado de Desenvolvimento Orientado a Testes (TDD).  TDD é uma abordagem de programação comprovada que ajuda a escrever código com menos erros do que seria sem o TDD.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui está um</a> material TDD útil. <br><br>  Agora, como exercício, tente escrever um teste que verifique a função <code>convert()</code> para que, ao passar algo diferente da string, ela gere um erro e implemente os mecanismos apropriados para essa função.  Observe que números inteiros, listas e dicionários são convertidos em seqüências de caracteres. <br><br>  Depois que o pacote passou nos testes com sucesso, estamos prontos para tirar proveito do sistema de integração contínua. <br><br><h2>  <font color="#3AC1EF">Etapa 5. Registro no serviço Travis CI e sua configuração</font> </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36c/e18/b28/36ce18b28c14dd932d4194a7eb0031e6.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Travis CI</a> é um "serviço da Web distribuído para criação e teste de software".  Foi comprado recentemente pela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Idera</a> .  Existem outros sistemas de integração contínua, mas o Travis CI é uma ferramenta popular, de código aberto e bem documentada, por isso vamos usá-la. <br><br>  O Travis CI permite integrar no seu projeto apenas o código que passa nos testes e atende aos padrões.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> você pode ler mais sobre o Travis CI e aqui sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">integração</a> contínua. <br><br>  Crie uma conta em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://travis-ci.org/</a> .  Em seguida, clique no link <code>Review and add your authorized organizations</code> na página de perfil.  Você será solicitado a fornecer uma senha para acessar o GitHub.  Clique em <code>Grant</code> na seção de <code>Organization access</code> da <code>Organization access</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/65e/6bd/d52/65e6bdd52e958c8335c999e971eec8ec.png"></div><br>  <i><font color="#999999">Configurar uma conta Travis CI</font></i> <br><br>  Eu precisava sincronizar a conta para que as informações sobre <code>notebooktoall</code> e o repositório <code>notebookc</code> aparecessem na conta.  Normalmente, para o Travis CI trabalhar com código, leva cerca de um minuto.  Depois disso, você precisa ativar o repositório usando a opção mostrada na figura a seguir. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/444/046/54c/44404654c3d1a95209f1418e2b3ea543.png"></div><br>  <i><font color="#999999">Ativação de Repositório</font></i> <br><br>  Agora clique no botão <code>Settings</code> .  Aqui você precisa indicar se o Travis pode construir com base em solicitações pull ou ramificações enviadas ao repositório. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/361/1ed/b25/3611edb25ab1af3484db1d38b0eda38c.png"></div><br>  <i><font color="#999999">Configuração de construção do projeto</font></i> <br><br>  Agora é hora de configurar o projeto em que estamos trabalhando, o que permitirá que Travis construa o projeto para cada solicitação de recebimento. <br><br><h2>  <font color="#3AC1EF">Etapa 6. Criando o arquivo .travis.yml</font> </h2><br>  Na pasta raiz do projeto, crie um arquivo <code>.travis.yml</code> com o seguinte conteúdo: <br><br><pre> <code class="python hljs">dist: xenial language: python python: <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> install: - pip install -r requirements_dev.txt - pip install -e . script: - pytest</code> </pre> <br>  A <code>dist: xenial</code> necessária para dizer ao Travis para usar o Ubuntu Xenial 16.04 para organizar o ambiente virtual.  Para testar o código Python 3.7, é necessário o Ubuntu Xenial, detalhes sobre isso podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  A seção de <code>install</code> permite instalar pacotes usados ​​no desenvolvimento do projeto.  Comando <code>pip install -e .</code>  realiza a instalação do nosso pacote no ambiente virtual do Travis.  Depois disso, Travis, iniciando o pytest, poderá encontrar nosso pacote. <br><br><h2>  <font color="#3AC1EF">Etapa 7. Testando no Travis CI</font> </h2><br>  Confirme as alterações, envie-as ao GitHub, faça o PR.  Travis deve começar a trabalhar em segundos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/15a/32a/d3f/15a32ad3f0a601e6bf89c06932efc450.png"></div><br>  <i><font color="#999999">Travis no trabalho</font></i> <br><br>  É isso que Travis faz ao lidar com o projeto. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d4a/b80/9a6/d4ab809a68ef70b62ad28121b055fc12.png"></div><br>  <i><font color="#999999">Ações executadas por Travis durante o processamento do projeto</font></i> <br><br>  Se o PR não tiver êxito - Travis o denunciará.  Observe que, se a solicitação de recebimento não for bem-sucedida, você poderá enviar as alterações para a mesma filial e o Travis começará a funcionar automaticamente. <br><br>  Vá para a página do seu repositório no site do Travis e olhe por aí.  Aqui você encontra muitas coisas interessantes sobre montagens.  Provavelmente, no futuro, você se tornará um convidado frequente desta página ao tentar entender o que causou a falha na montagem. <br><br>  Se assumirmos que tudo correu bem, se a página contiver rótulos verdes, a verificação e montagem do projeto foram bem-sucedidas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a6/bd0/7c4/6a6bd07c4f0a9c82e87b9fd1a71b9b10.png"></div><br>  <i><font color="#999999">Montagem do projeto concluída com sucesso</font></i> <br><br>  Se não houver rótulos verdes ou vermelhos na página, abra o menu <code>More options</code> e selecione <code>Requests</code> .  Se você vir aqui mensagens de erro vermelhas, analise-as.  Se você <code>.travis.yml</code> mensagem de erro <code>Build config file is required</code> , significa que o Travis não pode encontrar o arquivo <code>.travis.yml</code> no repositório.  Corrija-o e o erro desaparecerá. <br><br>  Travis envia e-mails aos usuários nos casos em que a montagem do projeto não é bem-sucedida e nos casos em que é possível corrigi-lo. <br><br>  Lembre-se de que você pode enviar confirmações para abrir o PR e o Travis reiniciará automaticamente o processo de criação do projeto. <br><br>  Agora vamos analisar nosso projeto para cobrir o código com testes. <br><br><h2>  <font color="#3AC1EF">Etapa 8. Avaliando a cobertura do código com testes</font> </h2><br>  O relatório sobre a cobertura do código com testes permite descobrir qual parte do código do projeto, embora pequena, foi testada.  Para criar esses relatórios, usaremos o pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pytest-cov</a> . <br><br>  Adicione a seguinte linha ao arquivo <code>requirements_dev.txt</code> : <br><br><pre> <code class="python hljs">pytest-cov==<span class="hljs-number"><span class="hljs-number">2.6</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span></code> </pre> <br>  Execute o seguinte comando: <br><br><pre> <code class="python hljs">pytest --cov=my_project_name</code> </pre> <br>  No meu caso, após a <code>pytest --cov=notebookc</code> , o seguinte relatório foi exibido. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/83c/566/d29/83c566d2942cbafcedd03de799b0eacd.png"></div><br>  <i><font color="#999999">Relatório de Cobertura de Código</font></i> <br><br>  Como se viu, todo o código do projeto é fornecido com testes.  Esses indicadores são muito fáceis de serem alcançados se o projeto inteiro consistir em várias linhas de código. <br><br>  Agora, vamos falar sobre uma ferramenta que permite manter um histórico público do estado do projeto em termos de cobertura de seu código com testes. <br><br><h2>  <font color="#3AC1EF">Etapa 9. Usando Macacão</font> </h2><br>  O projeto Coveralls permite manter informações históricas sobre a cobertura de código com testes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c0/616/ecd/8c0616ecddd054d1adabf0532c75f69b.png"></div><br>  <i><font color="#999999">Macacão</font></i> <br><br>  Para aproveitar os recursos deste projeto, você precisa se registrar no site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://coveralls.io/</a> usando os dados da sua conta do GitHub.  Então você precisa conectar o repositório. <br><br>  No arquivo <code>requirements_dev.txt</code> , inclua a linha <code>coveralls==1.6.0</code> .  Este arquivo, a propósito, nesta fase do trabalho no projeto deve se parecer com o seguinte: <br><br><pre> <code class="python hljs">pip==<span class="hljs-number"><span class="hljs-number">19.0</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> wheel==<span class="hljs-number"><span class="hljs-number">0.33</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> twine==<span class="hljs-number"><span class="hljs-number">1.13</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> pytest==<span class="hljs-number"><span class="hljs-number">4.3</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> pytest-cov==<span class="hljs-number"><span class="hljs-number">2.6</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> coveralls==<span class="hljs-number"><span class="hljs-number">1.6</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br>  <code>.travis.yml</code> arquivo <code>.travis.yml</code> , trazendo-o para este formulário (no seu caso, o nome do seu projeto estará aqui): <br><br><pre> <code class="python hljs">dist: xenial language: python python: <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> install: — pip install -r requirements_dev.txt — pip install -e . script: — pytest --cov=my_package_name after_success: — coveralls</code> </pre> <br>  Agora, quando Travis criar o projeto, ele instalará os pacotes necessários, executará os testes e criará um relatório sobre a cobertura do código com os testes.  Em seguida, esse relatório será enviado ao serviço Coveralls. <br><br>  Confirme, envie o código ao GitHub e observe o que acontece.  Pode levar alguns minutos para o relatório de teste de cobertura de código entrar no Coveralls. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7eb/19d/967/7eb19d96768a592ef21b611ab69e3509.png"></div><br>  <i><font color="#999999">Processamento do projeto, relatório de cobertura do teste</font></i> <br><br>  Agora, entre as verificações de relações públicas, há também uma verificação realizada pelo Coveralls. <br><br>  Na página Macacões, você pode verificar se o projeto é 100% coberto em testes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24a/f45/762/24af45762ed1b6f80a4b558ab24fcef1.png"></div><br>  <i><font color="#999999">Informações sobre cobertura de teste</font></i> <br><br>  Agora vamos equipar nosso projeto com outra ferramenta útil. <br><br><h2>  <font color="#3AC1EF">Etapa 10. Trabalhando com PyUp</font> </h2><br>  O serviço PyUp.io permite que o desenvolvedor descubra se as dependências usadas por ele estão desatualizadas e se possuem vulnerabilidades.  Este serviço executa automaticamente solicitações pull destinadas a atualizar o pacote no GitHub.  Para tirar proveito dos recursos deste projeto, você precisa se registrar usando uma conta do GitHub, no site - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://pyup.io/</a> .  Ao adicionar um repositório, é recomendável definir os <code>Update Schedules</code> <code>every week</code> .  Com essa abordagem, se o seu projeto tiver muitas dependências, você não encontrará muitas solicitações pull. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8fe/4d5/14f/8fe4d514fe0efef8c8c0bea40451f4d3.png"></div><br>  <i><font color="#999999">Configurar atualizações</font></i> <br><br>  Aqui está a aparência das informações do pacote, algumas das quais estão desatualizadas, no site do PyUp.io. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/372/26a/e7a/37226ae7a12381601d7335b1ae935d17.png"></div><br>  <i><font color="#999999">Detalhes do pacote</font></i> <br><br>  Usando este serviço, você sempre saberá quando as versões mais recentes dos pacotes que você usar serão lançadas.  O conhecimento, como se costuma dizer, é metade da vitória.  E a segunda metade é, obviamente, solicitações de recebimento automáticas para atualizar dependências. <br><br><h2>  <font color="#3AC1EF">Sumário</font> </h2><br>  Neste artigo, você aprendeu como usar ferramentas como Black, pytest, Travis CI, Coveralls e PyUp ao desenvolver projetos Python.  Eles ajudam a controlar as dependências do projeto, formatar e testar o código, além de verificar e criar projetos.  Esperamos que você ache essas ferramentas úteis. <br><br>  <b>Caros leitores!</b>  Quais ferramentas você usa ao desenvolver projetos Python? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444344/">https://habr.com/ru/post/pt444344/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444332/index.html">Segurança da informação e catering: como os gerentes pensam sobre os produtos de TI</a></li>
<li><a href="../pt444336/index.html">Listas de captura rápidas: qual é a diferença entre links fracos, fortes e não proprietários?</a></li>
<li><a href="../pt444338/index.html">Encapsulamento em Python 3</a></li>
<li><a href="../pt444340/index.html">Recursos do uso do tipo de dados Symbol em JavaScript</a></li>
<li><a href="../pt444342/index.html">Desenvolvendo aplicativos JavaScript simples e modernos usando o Webpack e tecnologias avançadas da Web</a></li>
<li><a href="../pt444346/index.html">GraphQL e Golang</a></li>
<li><a href="../pt444348/index.html">Qual a diferença entre os componentes funcionais do React e os componentes baseados em classe?</a></li>
<li><a href="../pt444350/index.html">Por algum motivo, o MVP (produto mínimo viável) não inicia</a></li>
<li><a href="../pt444352/index.html">Kontur.Kampus: convidamos você para um campo de estudantes de desenvolvimento industrial gratuito perto de São Petersburgo</a></li>
<li><a href="../pt444356/index.html">Tutorial Reagir Parte 24: Segunda lição sobre formulários</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>