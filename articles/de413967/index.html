<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë© üòï üçß Animal Crossing Entwicklermodus Reverse Engineering üëâüèª üõÄ üßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Letzten Sommer habe ich mit dem Reverse Engineering von Animal Crossing f√ºr den GameCube begonnen. Ich wollte die M√∂glichkeit untersuchen, Mods f√ºr di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Animal Crossing Entwicklermodus Reverse Engineering</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413967/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b4d/fe4/7f0/b4dfe47f0139ba1af039decfb6274524.jpg" alt="Bestimmte des Codes auf einem echten GameCube"></div><br>  Letzten Sommer habe ich mit dem Reverse Engineering von Animal Crossing f√ºr den GameCube begonnen.  Ich wollte die M√∂glichkeit untersuchen, Mods f√ºr dieses Spiel zu erstellen.  Au√üerdem wollte ich den Prozess dokumentieren, um Tutorials f√ºr Leute zu erstellen, die sich f√ºr das Hacken von ROMs und Reverse Engineering interessieren.  In diesem Beitrag werde ich √ºber die Entwickler-Debugging-Funktionen sprechen, die im Spiel verblieben sind, und dar√ºber, wie ich Cheat-Combos entdeckt habe, mit denen sie freigeschaltet werden k√∂nnen. <br><a name="habracut"></a><br><h3>  new_Debug_mode </h3><br>  Als ich die verbleibenden Debugging-Symbole studierte, bemerkte ich die Namen der Funktionen und Variablen, die das Wort "Debug" enthielten, und entschied, dass es interessant w√§re zu sehen, ob noch Debugging-Funktionen im Spiel vorhanden waren.  Wenn es mir gelingt, die Debugging- oder Entwicklungsfunktionen zu aktivieren, hilft mir dies beim Erstellen von Mods. <br><br>  Die erste Funktion, die mir aufgefallen ist, war <code>new_Debug_mode</code> .  Es wird von der <code>entry</code> aufgerufen, die unmittelbar nach dem Ende des Nintendo-Logo-Bildschirms startet.  Sie platziert <code>0x1C94</code> die <code>0x1C94</code> und speichert einen Zeiger darauf. <br><br>  Nachdem der <code>entry</code> in der gehosteten Struktur mit dem Offset <code>0xD4</code> unmittelbar vor dem Aufruf von <code>mainproc</code> Wert 0 gesetzt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/63e/fbc/0af/63efbc0af9ebfb4eeb2c3b42feddcbed.png"></div><br>  Um zu sehen, was passiert, wenn der Wert nicht Null ist, habe ich den <code>li r0, 0</code> bei <code>80407C8C</code> gepatcht und durch <code>li r0, 1</code> .  Die <code>li r0, 0</code> des <code>li r0, 0</code> sind <code>38 00 00 00</code> wobei der zugewiesene Wert am Ende des Befehls steht, sodass ich die Bytes einfach durch <code>38 00 00 01</code> ersetzen und <code>li r0, 1</code> .  Als zuverl√§ssigere Methode zum Erstellen von Anweisungen k√∂nnen Sie so etwas wie <code>kstool</code> : <br><br> <code>$ kstool ppc32be "li 0, 1" <br> li 0, 1 = [ 38 00 00 01 ]</code> <br> <br>  Im Dolphin-Emulator kann dieser Patch angewendet werden, indem Sie in den Spieleigenschaften auf die Registerkarte "Patches" gehen und ihn wie folgt eingeben: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e65/ecb/706/e65ecb7061c9470c9a9b71c4aad8e506.png"></div><br>  Nach dem Zuweisen des Werts 1 wurde am unteren Bildschirmrand ein interessantes Diagramm angezeigt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/be5/cab/e1f/be5cabe1fe1df63d0534c092d49ca8f9.png"></div><br><br>  Es sah aus wie ein Leistungsindikator: Die kleinen Balken am unteren Bildschirmrand nahmen zu oder ab.  (Als ich mir sp√§ter die Namen der Funktionen ansah, die dieses Diagramm zeichnen, stellte ich fest, dass sie tats√§chlich Metriken f√ºr die CPU- und Speichernutzung anzeigen.) <br><br>  Es war gro√üartig, aber nicht besonders hilfreich.  Nachdem ich den Wert 1 zugewiesen hatte, wurde meine Stadt nicht mehr geladen, sodass hier nichts anderes getan werden konnte. <br><br><h3>  Zuru-Modus </h3><br>  Ich suchte erneut nach anderen Verweisen auf Debugging-Funktionen und stie√ü mehrmals auf etwas, das als ‚ÄûZuru-Modus‚Äú bezeichnet wurde.  Zweige von Codebl√∂cken mit Debugging-Funktionalit√§t √ºberpr√ºften h√§ufig die Variable <code>zurumode_flag</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/88e/4d4/63c/88e4d463c3ea3474d3b67e2cf8367ee2.png" alt="game_move_first Funktion"></div><br>  <code>zzz_LotsOfDebug</code> (der Name, den ich mir <code>game_move_first</code> habe) in der <code>game_move_first</code> gezeigten Funktion <code>zurumode_flag</code> nur aufgerufen, wenn <code>zurumode_flag</code> ungleich Null ist. <br><br>  Auf der Suche nach Funktionen, die diesem Wert zugeordnet sind, habe ich Folgendes gefunden: <br><br><ul><li> <code>zurumode_init</code> </li> <li> <code>zurumode_callback</code> </li> <li> <code>zurumode_update</code> </li> <li> <code>zurumode_cleanup</code> </li> </ul><br>  Auf den ersten Blick ist ihr Zweck mysteri√∂s, sie jonglieren mit Bits in den Offsets einer Variablen namens <code>osAppNMIBuffer</code> . <br><br>  So sah die Arbeit dieser Funktionen auf den ersten Blick aus: <br><br><h4>  zurumode_init </h4><br><ul><li>  Setzt <code>zurumode_flag</code> auf 0 </li><li>  √úberpr√ºft mehrere Bits in <code>osAppNMIBuffer</code> </li><li>  Speichert einen Zeiger auf die Funktion <code>zurumode_callback</code> in der <code>padmgr</code> Struktur </li><li>  <code>zurumode_update</code> </li></ul><br><h4>  zurumode_update </h4><br><ul><li>  √úberpr√ºft mehrere Bits in <code>osAppNMIBuffer</code> </li><li>  Abh√§ngig vom Wert dieser Bits wird <code>zurumode_flag</code> aktualisiert </li><li>  Druckt eine Formatzeichenfolge in die Betriebssystemkonsole. </li></ul><br>  Dies ist normalerweise n√ºtzlich, um dem Code einen Kontext zu geben, aber die Zeile enthielt viele nicht druckbare Zeichen.  Der einzige erkennbare Text war "zurumode_flag" und "% d". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/268/f99/093/268f99093e0f9dec2a19bfc22be95ac7.png" alt="Zeichenfolge im Zuru-Modus"></div><br>  Angenommen, es k√∂nnte sich um japanischen Text mit Multibyte-Zeichencodierung handeln, habe ich die Zeichenfolge durch das Codierungserkennungswerkzeug geleitet und festgestellt, dass die Zeichenfolge mit Shift-JIS codiert wurde.  In der √úbersetzung bedeutete die Zeile einfach "Der Wert von zurumode_flag hat sich von% d auf% d ge√§ndert."  Dies gibt uns nicht viele neue Informationen, aber jetzt wissen wir, dass Shift-JIS verwendet wird: In Bin√§rdateien und Zeilentabellen gibt es viel mehr Zeilen in dieser Codierung. <br><br><h4>  zurumode_callback </h4><br><ul><li>  <code>zerumode_check_keycheck</code> </li><li>  √úberpr√ºft mehrere Bits in <code>osAppNMIBuffer</code> </li><li>  Der <code>zurumode_flag</code> Wert wird <code>zurumode_flag</code> </li><li>  <code>zurumode_update</code> </li></ul><br>  <code>zerumode_check_keycheck</code> bis wir uns wegen einer anderen Schreibweise getroffen haben ... was ist das? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/49e/ca7/1fd/49eca71fdd3cefb01b01c578a93bbe72.png" alt="zerumode_check_keycheck"></div><br>  Eine riesige komplexe Funktion, die viel mehr an Bits mit unbenannten Werten arbeitet. <br><br>  Zu diesem Zeitpunkt habe ich mich entschlossen, einen Schritt zur√ºckzutreten und andere Debugging-Funktionen und -Variablen zu untersuchen, da ich mir nicht sicher war, wie wichtig der Zuru-Modus ist.  Au√üerdem habe ich nicht verstanden, was "Schl√ºssel√ºberpr√ºfung" hier bedeutet.  Ist es m√∂glich, dass dies ein kryptografischer Schl√ºssel ist? <br><br><h3>  Zur√ºck zum Debuggen </h3><br>  Ungef√§hr zu dieser Zeit bemerkte ich ein Problem beim Laden von Debugging-Symbolen in die IDA.  Die Datei <code>foresta.map</code> auf der Festplatte des Spiels enth√§lt viele Adressen und Namen von Funktionen und Variablen.  Zuerst habe ich nicht gesehen, dass die Adressen f√ºr jeden Abschnitt von vorne beginnen, deshalb habe ich ein einfaches Skript geschrieben, das einen Namenseintrag f√ºr jede Zeile der Datei hinzuf√ºgt. <br><br>  Ich habe neue IDA-Skripte geschrieben, um das Laden von Symboltabellen f√ºr verschiedene Abschnitte des Programms zu <code>.text</code> : <code>.text</code> , <code>.rodata</code> , <code>.data</code> und <code>.bss</code> .  Der <code>.text</code> Abschnitt enth√§lt alle Funktionen, daher habe ich ihn so gestaltet, dass das Skript diesmal beim <code>.text</code> des Namens die Funktionen an jeder Adresse automatisch erkennt. <br><br>  In den <code>m_debug.o</code> erstellte er nun ein Segment f√ºr jedes <code>m_debug.o</code> (z. B. <code>m_debug.o</code> , das als Code f√ºr etwas namens <code>m_debug</code> kompiliert werden <code>m_debug</code> ) und legte den Platz und die Namen f√ºr jedes Datenelement fest. <br><br>  Dies gab mir viel mehr Informationen, aber ich musste den Datentyp f√ºr jedes Datenelement manuell festlegen, da ich jedes Datenobjekt als einfaches Byte-Array definierte.  (R√ºckblickend verstehe ich, dass es besser w√§re anzunehmen, dass Fragmente von 4 Bytes 32-Bit-Ganzzahlen enthielten, da es viele und viele Adressen von Funktionen und Daten enthielt, die f√ºr die Erstellung von Querverweisen wichtig sind.) <br><br>  Beim Studium des neuen <code>.bss</code> Segments f√ºr <code>m_debug_mode.o</code> ich mehrere Variablen der Form <code>quest_draw_status</code> und <code>event_status</code> .  Dies ist interessant, weil ich wollte, dass n√ºtzliche Informationen, nicht nur ein Leistungsdiagramm, im Debug-Modus angezeigt werden.  Gl√ºcklicherweise gab es aus diesen Datens√§tzen Querverweise auf einen riesigen Code, der <code>debug_print_flg</code> √ºberpr√ºfte. <br><br>  Mit einem Debugger im Dolphin-Emulator habe ich einen Haltepunkt an der Stelle der Funktion festgelegt, an der <code>debug_print_flg</code> √ºberpr√ºft wurde (bei <code>8039816C</code> ), um zu verstehen, wie diese √úberpr√ºfung funktioniert.  Das Programm wurde jedoch nie an diesen Haltepunkt √ºbergeben. <br><br>  <code>game_debug_draw_last</code> wir <code>game_debug_draw_last</code> warum dies passiert: Diese Funktion wird von <code>game_debug_draw_last</code> .  Ratet mal, welcher Wert vor seinem bedingten Aufruf √ºberpr√ºft wird?  <code>zurumode_flag</code> !  Was zur H√∂lle ist los? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/257/048/964/257048964f9e8265670952e66868fc83.png" alt="zurumode_flag check"></div><br>  Ich habe einen Haltepunkt f√ºr diese Pr√ºfung festgelegt ( <code>80404E18</code> ) und es hat sofort funktioniert.  Der Wert von <code>zurumode_flag</code> war Null, sodass das Programm bei normaler Ausf√ºhrung den Aufruf dieser Funktion verpasst h√§tte.  Ich habe stattdessen eine NOP-Verzweigungsanweisung eingef√ºgt (durch eine Anweisung ersetzt, die nichts bewirkt), um zu √ºberpr√ºfen, was passiert, wenn die Funktion aufgerufen wird. <br><br>  Im Dolphin-Debugger k√∂nnen Sie dies tun, indem Sie das Spiel anhalten, mit der rechten Maustaste auf die Anweisungen klicken und "Nop einf√ºgen" ausw√§hlen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2e6/f00/8d1/2e6f008d1dcf1be707b1961e05df2e71.png" alt="Dolphin Debugger Nopping"></div><br>  Nichts ist passiert.  Dann √ºberpr√ºfte ich, was in der Funktion vor sich ging, und entdeckte ein anderes Verzweigungskonstrukt, das alles Interessante umging, was bei <code>803981a8</code> passierte.  Stattdessen habe ich auch NOP eingef√ºgt, und der Buchstabe ‚ÄûD‚Äú wurde in der oberen rechten Ecke des Bildschirms angezeigt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a18/9a0/816/a189a0816b08438ad5b85c09adaac57c.png" alt="Debug-Modus Buchstabe D."></div><br>  In dieser Funktion bei <code>8039816C</code> (ich habe sie <code>zzz_DebugDrawPrint</code> ) gibt es immer noch eine Menge interessanten Codes, der jedoch nicht aufgerufen wird.  Wenn Sie diese Funktion in Form eines Diagramms betrachten, sehen Sie, dass es eine Reihe von Verzweigungsoperatoren gibt, die Codebl√∂cke in der gesamten Funktion √ºberspringen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/236/131/4bb/2361314bbb4165b8e1c82386e8c50533.png" alt="Verzweigungen in zzz_DebugDrawPrint"></div><br>  Nachdem ich NOP anstelle mehrerer anderer Verzweigungskonstruktionen eingef√ºgt hatte, sah ich verschiedene interessante Dinge auf dem Bildschirm: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0db/c19/008/0dbc1900844131d0c3d7f507f2b61b63.png" alt="Weitere Debug-Inhalte werden gemeldet"></div><br>  Die n√§chste Frage war, wie diese Debugging-Funktion aktiviert werden kann, ohne den Code zu √§ndern. <br><br>  Au√üerdem tritt in einigen Verzweigungskonstrukten <code>zurumode_flag</code> in dieser Debug- <code>zurumode_flag</code> erneut auf.  Ich habe einen weiteren Patch hinzugef√ºgt, <code>zurumode_update</code> Flag in <code>zurumode_update</code> immer der Wert 2 zugewiesen wird, da es, wenn es nicht mit 0 verglichen wird, speziell mit dem Wert 2 verglichen wird. <br><br>  Nach dem Neustart des Spiels sah ich in der oberen rechten Ecke des Bildschirms eine solche Meldung "msg.  nein. " <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/97d/16e/a0b/97d16ea0b169c72dd86ab623e0e3f977.png" alt="Anzeige der nachrichtennummer"></div><br>  Die Nummer 687 ist die Datensatzkennung der zuletzt angezeigten Nachricht.  Ich habe es mit dem Table Viewer-Programm √ºberpr√ºft, das ich zu Beginn der Analyse geschrieben habe. Sie k√∂nnen es aber auch mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">String-Tabellen-Editor mit einer vollst√§ndigen GUI</a> √ºberpr√ºfen, die ich zum Hacken von ROMs geschrieben habe.  So sieht der Beitrag im Editor aus: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cad/e3f/378/cade3f3785a86e9bf335a144fe16a338.png" alt="Nachricht 687 im String-Tabellen-Editor"></div><br>  Zu diesem Zeitpunkt wurde klar, dass das Studium des Zuru-Modus nicht mehr weggenommen wurde - es steht in direktem Zusammenhang mit den Debugging-Funktionen des Spiels. <br><br><h3>  Zur√ºck zum Zuru-Modus </h3><br>  <code>zurumode_init</code> initialisiert verschiedene Dinge: <br><br><ul><li>  <code>0xC(padmgr_class)</code> der Wert der <code>zurumode_callback</code> Adresse <code>zurumode_callback</code> </li><li>  <code>0x10(padmgr_class)</code> der Adresswert von <code>padmgr_class</code> selbst <code>padmgr_class</code> </li><li>  <code>0x4(zuruKeyCheck)</code> der Wert des letzten Bits in dem von <code>0x3C(osAppNMIBuffer)</code> geladenen Wort <code>0x3C(osAppNMIBuffer)</code> . </li></ul><br>  Ich habe herausgefunden, was <code>padmgr</code> , eine Abk√ºrzung f√ºr "Gamepad Manager".  Dies bedeutet, dass m√∂glicherweise eine spezielle Kombination von Tasten (Schaltfl√§chen) auf dem Gamepad eingegeben werden kann, um den Zuru-Modus zu aktivieren, oder eine Art Debugging-Ger√§t oder eine Funktion der Entwicklerkonsole, mit der ein Signal zum Aktivieren gesendet werden kann. <br><br>  <code>zurumode_init</code> wird nur beim ersten Start des Spiels ausgef√ºhrt (wenn die Reset-Taste gedr√ºckt wird, funktioniert es nicht). <br><br>  Nachdem wir an der Adresse <code>8040efa4</code> einen Haltepunkt <code>8040efa4</code> , an dem der Wert <code>0x4(zuruKeyCheck)</code> zugewiesen ist <code>0x4(zuruKeyCheck)</code> , k√∂nnen wir sehen, dass beim Laden ohne Dr√ºcken von Tasten der Wert auf 0 gesetzt wird. Wenn Sie ihn durch 1 ersetzen, passiert etwas Interessantes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9dc/5f5/0fb/9dc5f50fbd68beb624745d0704a18383.png" alt="Titelbildschirm mit Zuru-Modus"></div><br>  Der Buchstabe ‚ÄûD‚Äú wird erneut in der oberen rechten Ecke angezeigt (diesmal gr√ºn, nicht gelb), und einige Montageinformationen werden ebenfalls angezeigt: <br><br> <code>[CopyDate: 02/08/01 00:16:48 ] <br> [Date: 02-07-31 12:52:00] <br> [Creator:SRD@SRD036J]</code> <br> <br>  Ein Patch, der zu Beginn immer <code>0x4(zuruKeyCheck)</code> auf 1 setzt, sieht folgenderma√üen aus: <br><br> <code>8040ef9c 38c00001</code> <br> <br>  Dies scheint der richtige Weg zu sein, um den Zuru-Modus zu initialisieren.  Danach k√∂nnen verschiedene Aktionen erforderlich sein, um die Anzeige bestimmter Debugging-Informationen zu erreichen.  Wenn Sie das Spiel starten, einen Spaziergang machen und mit einem Dorfbewohner sprechen, sehen wir keine der oben genannten Nachrichten (au√üer dem Buchstaben "D" in der Ecke). <br><br>  Die wahrscheinlichsten Verd√§chtigen sind <code>zurumode_update</code> und <code>zurumode_callback</code> . <br><br><h4>  zurumode_update </h4><br>  <code>zurumode_update</code> zuerst in <code>zurumode_init</code> und dann st√§ndig von <code>zurumode_callback</code> . <br><br>  Es √ºberpr√ºft erneut das letzte Bit <code>0x3C(osAppNMIBuffer)</code> und aktualisiert dann basierend auf diesem Wert <code>zurumode_flag</code> . <br><br>  Wenn das Bit Null ist, wird das Flag auf Null gesetzt. <br><br>  Wenn nicht, wird die folgende Anweisung ausgef√ºhrt, wobei der vollst√§ndige Wert <code>0x3c(osAppNMIBuffer)</code> <code>r5</code> : <br><br> <code>extrwi r3, r5, 1, 28</code> <br> <br>  Es extrahiert das 28. Bit aus <code>r5</code> und speichert es in <code>r3</code> . <br><br>  Dann wird 1 zum Ergebnis hinzugef√ºgt, dh das Endergebnis ist immer 1 oder 2. <br><br>  Dann wird <code>zurumode_flag</code> mit dem vorherigen Ergebnis verglichen, je nachdem, wie viele der 28. und letzten Bits auf <code>0x3c(osAppNMIBuffer)</code> : 0, 1 oder 2. <br><br>  Dieser Wert wird in <code>zurumode_flag</code> .  Wenn sich nichts √§ndert, wird die Funktion beendet und der aktuelle Flag-Wert zur√ºckgegeben.  Wenn sich der Wert √§ndert, wird eine viel komplexere Kette von Codebl√∂cken ausgef√ºhrt. <br><br>  Auf Japanisch wird eine Meldung angezeigt: Der gleiche ‚Äûzurumode_flag-Wert wurde von% d in% d ge√§ndert‚Äú, √ºber den wir oben gesprochen haben. <br><br>  Dann wird eine Reihe von Funktionen mit unterschiedlichen Argumenten aufgerufen, je nachdem, ob das Flag gleich Null geworden ist oder nicht.  Der Assembler-Code dieses Teils ist eint√∂nig, daher werde ich seinen Pseudocode zeigen: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (flag_changed_to_zero) { JC_JUTAssertion_changeDevice(<span class="hljs-number"><span class="hljs-number">2</span></span>) JC_JUTDbPrint_setVisible(JC_JUTDbPrint_getManager(), <span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BIT(nmiBuffer, <span class="hljs-number"><span class="hljs-number">25</span></span>) || BIT(nmiBuffer, <span class="hljs-number"><span class="hljs-number">31</span></span>)) { JC_JUTAssertion_changeDevice(<span class="hljs-number"><span class="hljs-number">3</span></span>) JC_JUTDbPrint_setVisible(JC_JUTDbPrint_getManager(), <span class="hljs-number"><span class="hljs-number">1</span></span>) }</code> </pre> <br>  Beachten Sie, dass wenn das Flag Null ist, das Argument 0 an JC_JUTDbPrint_setVisible √ºbergeben wird. <br><br>  Wenn das Flag ungleich Null ist und Bit 25 oder Bit 31 auf <code>0x3C(osAppNMIBuffer)</code> , wird <code>setVisible</code> an Argument 1 √ºbergeben. <br><br>  Dies ist der erste Schl√ºssel zum Aktivieren des Zuru-Modus: Das letzte Bit <code>0x3C(osAppNMIBuffer)</code> muss auf 1 gesetzt werden, um Debugging-Informationen anzuzeigen, und <code>zurumode_flag</code> Wert ungleich Null setzen. <br><br><h4>  zurumode_callback </h4><br>  <code>zurumode_callback</code> befindet sich bei <code>8040ee74</code> und wird wahrscheinlich von einer Funktion aufgerufen, die sich auf das Gamepad bezieht.  Nach dem Einf√ºgen eines Haltepunkts in den Dolphin-Debugger zeigt der Aufrufstapel an, dass er tats√§chlich von <code>padmgr_HandleRetraceMsg</code> . <br><br>  Eine ihrer ersten Aktionen war die Ausf√ºhrung von <code>zerucheck_key_check</code> .  Diese Funktion ist komplex, scheint jedoch im Allgemeinen darauf ausgelegt zu sein, den Wert von <code>zuruKeyCheck</code> zu lesen und zu aktualisieren.  Bevor ich zur Keycheck-Funktion √ºberging, habe ich mich entschlossen zu √ºberpr√ºfen, wie dieser Wert im Rest der R√ºckruffunktion verwendet wird. <br><br>  Dann wird erneut nach einigen Bits in <code>0x3c(osAppNMIBuffer)</code> .  Wenn Bit 26 gesetzt ist oder wenn Bit 25 gesetzt ist und <code>padmgr_isConnectedController(1)</code> einen Wert ungleich Null zur√ºckgibt, wird das letzte Bit in <code>0x3c(osAppNMIBuffer)</code> auf 1 gesetzt! <br><br>  Wenn keines dieser Bits gesetzt ist oder Bit 25 gesetzt ist, aber <code>padmgr_isConnectedController(1)</code> 0 zur√ºckgibt, pr√ºft die Funktion, ob das Byte an der Adresse <code>0x4(zuruKeyCheck)</code> gleich Null ist.  Wenn gleich, wird das letzte Bit im urspr√ºnglichen Wert zur√ºckgesetzt und in <code>0x3c(osAppNMIBuffer)</code> .  Wenn nicht, wird das letzte Bit immer noch auf 1 gesetzt. <br><br>  Im Pseudocode sieht es so aus: <br><br><pre> <code class="cpp hljs">x = osAppNMIBuffer[<span class="hljs-number"><span class="hljs-number">0x3c</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BIT(x, <span class="hljs-number"><span class="hljs-number">26</span></span>) || (BIT(x, <span class="hljs-number"><span class="hljs-number">25</span></span>) &amp;&amp; isConnectedController(<span class="hljs-number"><span class="hljs-number">1</span></span>)) || zuruKeyCheck[<span class="hljs-number"><span class="hljs-number">4</span></span>] != <span class="hljs-number"><span class="hljs-number">0</span></span>) { osAppNMIBuffer[<span class="hljs-number"><span class="hljs-number">0x3c</span></span>] = x | <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">// set last bit } else { osAppNMIBuffer[0x3c] = x &amp; ~1 // clear last bit }</span></span></code> </pre> <br>  Wenn danach Bit 26 nicht gesetzt ist, ruft die Funktion <code>zurumode_update</code> und wird beendet. <br><br>  Wenn das Bit gesetzt ist und <code>0x4(zuruKeyCheck)</code> ungleich Null ist, wird eine <code>0x4(zuruKeyCheck)</code> , in der Folgendes angezeigt wird: ‚ÄûZURU% d /% d‚Äú. <br><br><h4>  Um die Zwischensumme zusammenzufassen </h4><br>  Folgendes passiert: <br><br>  <code>padmgr_HandleRetraceMsg</code> ruft <code>zurumode_callback</code> .  Ich gehe davon aus, dass diese "Handle Retrace-Nachricht" bedeutet, dass einfach die Tastenanschl√§ge des Controllers gescannt werden.  Bei jedem Scan kann es zu einer Reihe unterschiedlicher R√ºckrufe kommen. <br><br>  Wenn <code>zurumode_callback</code> ausgef√ºhrt wird <code>zurumode_callback</code> werden die aktuellen Tastenanschl√§ge (Schaltfl√§chen) √ºberpr√ºft.  Es sieht so aus, als w√ºrde sie eine bestimmte Schaltfl√§che oder eine Kombination von Schaltfl√§chen √ºberpr√ºfen. <br><br>  Das letzte Bit im NMI-Puffer wird abh√§ngig von den spezifischen Bits in seinem aktuellen Wert sowie vom Wert eines der <code>zuruKeyCheck</code> Bytes ( <code>0x4(zuruKeyCheck)</code> ) <code>0x4(zuruKeyCheck)</code> . <br><br>  Dann wird <code>zurumode_update</code> und pr√ºft dieses Bit.  Wenn es 0 ist, wird das Zuru-Modus-Flag auf 0 gesetzt. Wenn es 1 ist, √§ndert sich das Modus-Flag auf 1 oder 2, je nachdem, ob Bit 28 gesetzt ist. <br><br>  <strong>Es gibt drei M√∂glichkeiten, den Zuru-Modus zu aktivieren:</strong> <br><br><ol><li>  Bit 26 wird auf <code>0x3C(osAppNMIBuffer)</code> </li><li>  Bit 25 ist auf <code>0x3C(osAppNMIBuffer)</code> und der Controller ist mit Port 2 verbunden </li><li>  <code>0x4(zuruKeyCheck)</code> nicht Null </li></ol><br><h4>  osAppNMIBuffer </h4><br>  Interessiert an der Bedeutung von <code>osAppNMIBuffer</code> suchte ich nach ‚ÄûNMI‚Äú und fand im Nintendo-Kontext Links zu ‚Äûnicht maskierbaren Interrupts‚Äú.  Es stellt sich heraus, dass der Name dieser Variablen in der Entwicklerdokumentation f√ºr Nintendo 64 vollst√§ndig erw√§hnt wird: <br><br><blockquote>  osAppNMIBuffer ist ein 64-Byte-Puffer, der bei einem Kaltstart gel√∂scht wird.  Wenn das System aufgrund von NMI neu gestartet wird, √§ndert sich der Status dieses Puffers nicht. </blockquote><br>  Tats√§chlich ist dies ein kleines St√ºck Speicher, das w√§hrend eines ‚Äûsanften‚Äú Neustarts (mit der Reset-Taste) gespeichert wird.  Das Spiel kann diesen Puffer verwenden, um alle Daten zu speichern, w√§hrend sich die Konsole im Netzwerk befindet.  Das urspr√ºngliche Animal Crossing wurde auf Nintendo 64 ver√∂ffentlicht, daher ist es logisch, dass im Code etwas √Ñhnliches h√§tte erscheinen m√ºssen. <br><br>  Wenn wir zur bin√§ren Datei <code>boot.dol</code> gehen (alles, was oben gezeigt wurde, war in <code>foresta.rel</code> ), dann hat seine <code>main</code> viele Links zu <code>osAppNMIBuffer</code> .  Ein kurzer Blick zeigt, dass es eine Reihe von √úberpr√ºfungen gibt, die dazu f√ºhren k√∂nnen, <code>0x3c(osAppNMIBuffer)</code> Werte verschiedener Bits <code>0x3c(osAppNMIBuffer)</code> mithilfe von ODER-Operationen festgelegt werden. <br><br>  Die folgenden ODER-Operandenwerte k√∂nnen interessant sein: <br><br><ul><li>  Bit 31: 0x01 </li><li>  Bit 30: 0x02 </li><li>  Bit 29: 0x04 </li><li>  Bit 28: 0x08 </li><li>  Bit 27: 0x10 </li><li>  Bit 26: 0x20 </li></ul><br>  Wir erinnern uns, dass die Bits 25, 26 und 28 besonders interessant sind: 25 und 26 bestimmen, ob der Zuru-Modus aktiviert ist, und Bit 28 bestimmt den Flag-Pegel (1 oder 2). <br>  Bit 31 ist ebenfalls interessant, aber es sieht so aus, als w√ºrde es sich abh√§ngig von den Werten der anderen √§ndern. <br><br><h5>  Bit 26 </h5><br>  Zun√§chst einmal: An der Adresse <code>800062e0</code> befindet sich ein Befehl <code>ori r0, r0, 0x20</code> mit einem Pufferwert von <code>0x3c</code> .  Es setzt Bit 26, das den Zuru-Modus immer einschaltet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5c/b3c/207/b5cb3c207a61dc20dd12e6724f25099b.png" alt="Bit 26 setzen"></div><br>  Damit das Bit gesetzt werden kann, muss das von <code>DVDGetCurrentDiskID</code> zur√ºckgegebene achte Byte <code>DVDGetCurrentDiskID</code> sein.  Diese Kennung befindet sich ganz am Anfang des Disk-Images des Spiels und wird unter <code>80000000</code> in den Speicher <code>80000000</code> .  In einer regul√§ren Einzelhandelsversion des Spiels sieht die ID folgenderma√üen aus: <br><br> <code>47 41 46 45 30 31 00 00 GAFE01..</code> <br> <br>  Wenn Sie das letzte Byte des Bezeichners durch einen <code>0x99</code> f√ºr <code>0x99</code> , erhalten Sie zu Beginn des Spiels das folgende Bild: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/da6/c58/c90/da6c58c90515fefb62ed8cf766ad8776.png" alt="Spielversions-ID 0x99"></div><br>  In der Betriebssystemkonsole wird Folgendes angezeigt: <br><br> <code>06:43:404 HW\EXI_DeviceIPL.cpp:339 N[OSREPORT]: ZURUMODE2 ENABLE <br> 08:00:288 HW\EXI_DeviceIPL.cpp:339 N[OSREPORT]: osAppNMIBuffer[15]=0x00000078</code> <br> <br>  Alle anderen Patches k√∂nnen entfernt werden. Danach wird der Buchstabe D erneut in der oberen rechten Ecke des Bildschirms angezeigt, es werden jedoch keine Debug-Meldungen mehr aktiviert. <br><br><h5>  Bit 25 </h5><br>  Bit 25 wird in Verbindung mit der √úberpr√ºfung von Controller-Port 2 verwendet. Was bewirkt, dass es eingeschaltet wird? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddf/d00/4a1/ddfd004a1488ec21842c90581ef177fc.png" alt="Bit 25 und 28"></div><br>  Es stellt sich heraus, dass er dieselbe Pr√ºfung wie f√ºr Bit 28 verwenden sollte: Die Version muss gr√∂√üer oder gleich <code>0x90</code> .  Wenn Bit 26 gesetzt ist (ID ist <code>0x99</code> ), werden auch diese beiden Bits gesetzt und der Zuru-Modus wird weiterhin aktiviert. <br><br>  Wenn sich die Version jedoch im Bereich von <code>0x90</code> bis <code>0x98</code> , wird der Zuru-Modus nicht sofort <code>0x98</code> .  Erinnern Sie sich an die in <code>zurumode_callback</code> durchgef√ºhrte <code>zurumode_callback</code> - der Modus wird nur aktiviert, wenn Bit 25 gesetzt ist <em>und</em> <code>padmgr_isConnectedController(1)</code> einen Wert ungleich Null zur√ºckgibt. <br><br>  Nachdem der Controller mit Port 2 verbunden ist (das Argument <code>isConnectedController</code> hat keine Indizierung), wird der Zuru-Modus aktiviert.  Der Buchstabe D und Informationen zur Baugruppe werden auf dem Startbildschirm angezeigt, und wir ... k√∂nnen die Anzeige des Debuggens mit den Tasten des zweiten Controllers steuern! <br><br>  Einige Schaltfl√§chen f√ºhren Aktionen aus, die nicht nur die Anzeige √§ndern, sondern beispielsweise auch die Geschwindigkeit des Spiels erh√∂hen. <br><br><h4>  zerucheck_key_check </h4><br>  Das letzte R√§tsel bleibt <code>0x4(zuruKeyCheck)</code> .  Es stellt sich heraus, dass dieser Wert mit einer riesigen komplexen Funktion aktualisiert wird, die ich oben gezeigt habe: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/49e/ca7/1fd/49eca71fdd3cefb01b01c578a93bbe72.png" alt="zerumode_check_keycheck"></div><br>  Mit dem Dolphin-Emulator-Debugger konnte ich feststellen, dass der von dieser Funktion √ºberpr√ºfte Wert ein Satz von Bits ist, die den Tastendr√ºcken auf dem zweiten Controller entsprechen. <br><br>  Die Verfolgung von <code>0x2(zuruKeyCheck)</code> wird in einem 16-Bit-Wert bei <code>0x2(zuruKeyCheck)</code> .  Wenn die Steuerung nicht angeschlossen ist, lautet der Wert <code>0x7638</code> . <br><br>  2 Bytes, die Flags der Controller-Tastendr√ºcke enthalten, werden heruntergeladen und dann am Anfang von <code>zerucheck_key_check</code> aktualisiert.  Der neue Wert wird mit dem Register <code>r4</code> Funktion <code>padmgr_HandleRetraceMsg</code> , wenn die R√ºckruffunktion <code>padmgr_HandleRetraceMsg</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f98/478/318/f984783181e592098f8beef9c22cef23.png" alt="Schl√ºsselpr√ºfung ende"></div><br>  Gegen Ende von <code>zerucheck_key_check</code> gibt es einen weiteren Ort, an dem <code>0x4(zuruKeyCheck)</code> aktualisiert wird <code>0x4(zuruKeyCheck)</code> .        ,       <code>r3</code> ,      <code>r3</code>    ,        . <br><br>   <code>8040ed88</code>  <code>r4</code>   <code>0x4(zuruKeyCheck)</code> .            XOR-  1.    ‚Äî    (    ‚Äî  )  0  1. (  0,   <br> XOR  1  1.   1,    0. .    XOR.) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/048/c32/eb1/048c32eb12dda64c878fa7b9f0bd7ddc.png" alt="Schl√ºsselpr√ºfung Ende"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fr√ºher, als ich die Werte im Speicher studierte, habe ich dieses Verhalten nicht bemerkt, aber ich werde versuchen, diese Anweisung im Debugger zu unterbrechen, um zu verstehen, was passiert. Der urspr√ºngliche Wert wird um geladen </font></font><code>8040ed7c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ohne Ber√ºhren der Controller-Tasten komme ich auf dem Startbildschirm nicht zu diesem Haltepunkt. Um in diesen Codeblock zu gelangen, </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss </font><font style="vertical-align: inherit;">der Wert </font></font><code>0xb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vor dem Verzweigungsbefehl vor dem Haltepunkt ( </font></font><code>8040ed74</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) gleich werden. Von den vielen verschiedenen Pfaden, die zu diesem Block f√ºhren, weist nur einer </font><font style="vertical-align: inherit;">an der Adresse </font><font style="vertical-align: inherit;">einen </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wert </font></font><code>0xb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">davor zu </font></font><code>8040ed68</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/04c/926/959/04c926959999b5f6facfc8920f6a212f.png" alt="R5 auf 0xb setzen"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beachten Sie, dass </font><font style="vertical-align: inherit;">der Wert unmittelbar davor </font><font style="vertical-align: inherit;">gleich sein muss </font><font style="vertical-align: inherit;">, um den Block zu erreichen, der den </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wert </font><font style="vertical-align: inherit;">zuweist </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn Sie den Bl√∂cken entlang der Kette bis zum Beginn der Funktion folgen, sehen Sie alle Einschr√§nkungen, die erforderlich sind, um diesen Block zu erreichen:</font></font><code>0xB</code><font style="vertical-align: inherit;"></font><code>r0</code><font style="vertical-align: inherit;"></font><code>0x1000</code><font style="vertical-align: inherit;"></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040ed74: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein</font></font><code>0xB</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040ed60: Wert </font></font><code>r0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein</font></font><code>0x1000</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040ebe8: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein</font></font><code>0xA</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040ebe4: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss kleiner sein</font></font><code>0x5B</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040eba4: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gr√∂√üer sein</font></font><code>0x7</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040eb94: Wert </font></font><code>r6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss 1 sein</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8040eb5c: Wert </font></font><code>r0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">darf nicht 0 sein</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8040eb74: Die Werte der Port 2-Tasten sollten sich √§ndern </font></font></li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/28e/2fa/9f3/28e2fa9f3d35b1c6146f816120dee72b.png" alt="Verfolgung des Codepfads"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier haben wir den Punkt erreicht, an dem die alten Schaltfl√§chenwerte geladen und die neuen Werte gespeichert werden. Dann kommen einige Operationen, die auf die neuen und alten Werte angewendet werden: </font><font style="vertical-align: inherit;">Die XOR-Operation markiert alle Bits, die sich zwischen den beiden Werten ge√§ndert haben. Dann maskiert die UND-Operation den neuen Eingang, um alle Bits zu setzen, die derzeit nicht auf den Zustand 0 gesetzt sind. Das Ergebnis </font><font style="vertical-align: inherit;">ist ein Satz neuer Bits (Tastendruck) im neuen Wert. Wenn es nicht leer ist, sind wir auf dem richtigen Weg. </font><font style="vertical-align: inherit;">Um </font><font style="vertical-align: inherit;">einen Unterschied </font><font style="vertical-align: inherit;">zu machen </font><font style="vertical-align: inherit;">, muss sich die vierte der 16-Bit-Tracking-Tasten √§ndern. Nachdem ich nach der XOR / AND-Operation einen Haltepunkt eingef√ºgt hatte, stellte ich fest, dass die START-Taste diesen Zustand ausl√∂st. </font><font style="vertical-align: inherit;">Die n√§chste Frage ist, wie man </font><font style="vertical-align: inherit;">es anf√§nglich gleich macht</font></font><br><br> <code>old_vals = old_vals XOR new_vals <br> old_vals = old_vals AND new_vals</code> <br> <br><font style="vertical-align: inherit;"></font><code>r0</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>r0</code><font style="vertical-align: inherit;"></font><code>0x1000</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>r5</code><font style="vertical-align: inherit;"></font><code>0xA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>r6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werden vom </font></font><code>0x0(zuruKeyCheck)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anfang der Schl√ºsseltestfunktion </font><font style="vertical-align: inherit;">geladen </font><font style="vertical-align: inherit;">und n√§her am Ende aktualisiert, wenn wir nicht in den Codeblock gelangen, der enth√§lt </font></font><code>0x4(zuruKeyCheck)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Davor gibt es mehrere Stellen, an denen der </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wert zugewiesen wird </font></font><code>0xA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><ul><li> <code>8040ed50</code> </li> <li> <code>8040ed00</code> </li> <li> <code>8040ed38</code> </li> </ul><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8040ed38 </font></font></h5><br><ul><li> <code>8040ed34</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Der Wert </font></font><code>r0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein </font></font><code>0x4000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Taste B </font><font style="vertical-align: inherit;">wird </font><font style="vertical-align: inherit;">gedr√ºckt)</font></font></li><li> <code>8040ebe0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein</font></font><code>0x5b</code> </li><li> <code>8040eba4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gr√∂√üer sein</font></font><code>0x7</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dann geht alles wie bisher ... </font></font></li></ul><br> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sollte mit beginnen </font></font><code>0x5b</code> <br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8040ed00 </font></font></h5><br><ul><li> <code>8040ecfc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein </font></font><code>0xC000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(A und B werden gedr√ºckt)</font></font></li><li> <code>8040ebf8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss&gt; = 9 sein</font></font></li><li> <code>8040ebf0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss kleiner als 10 sein</font></font></li><li> <code>8040ebe4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss kleiner sein</font></font><code>0x5b</code> </li><li> <code>8040eba4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sollte mehr sein</font></font><code>0x7</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dann geht alles wie bisher ... </font></font></li></ul><br> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sollte um 9 beginnen </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8040ed50 </font></font></h5><br><ul><li> <code>8040ed4c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gleich sein </font></font><code>0x8000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Taste A gedr√ºckt)</font></font></li><li> <code>8040ec04</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss kleiner sein</font></font><code>0x5d</code> </li><li> <code>8040ebe4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gr√∂√üer sein</font></font><code>0x5b</code> </li><li> <code>8040eba4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Wert </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muss gr√∂√üer sein</font></font><code>0x7</code> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dann geht alles wie bisher ... </font></font></li></ul><br> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sollte beginnen mit </font></font><code>0x5c</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es scheint, dass es zwischen den Tastenanschl√§gen eine Art Status gibt, nach dem Sie eine bestimmte Folge von Combos √ºber die Tasten eingeben m√ºssen, die mit dem Dr√ºcken von START enden. </font><font style="vertical-align: inherit;">Es sieht so aus, als ob A und / oder B direkt vor dem Start gehen sollten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie den Pfad des Codes verfolgen, der den </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wert auf 9 setzt, entsteht ein Muster: </font></font><code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Es ist ein zunehmender Wert, der entweder zunehmen kann, wenn ein </font></font><code>r0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geeigneter Wert gefunden wird, oder Null. </font><font style="vertical-align: inherit;">Die seltsamsten F√§lle, in denen dies kein Wert im Bereich von </font></font><code>0x0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bis ist</font></font><code>0xB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">treten auf, wenn Schritte mit mehreren Tasten verarbeitet werden, z. B. wenn A und B gleichzeitig gedr√ºckt werden. Eine Person, die versucht, diese Kombination einzugeben, kann normalerweise nicht beide Tasten gleichzeitig dr√ºcken, w√§hrend sie das Gamepad verfolgt. Sie m√ºssen also die gedr√ºckte Taste verarbeiten erster. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir untersuchen weiterhin verschiedene Codepfade:</font></font><br><br><ul><li> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nimmt den Wert 9 an, wenn an der Adresse RECHTS gedr√ºckt wird </font></font><code>8040ece8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li><li> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nimmt den Wert 8 an, wenn die rechte Taste C an der Adresse gedr√ºckt wird </font></font><code>8040eccc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li><li> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nimmt den Wert 7 an, wenn die linke Taste C an der Adresse gedr√ºckt wird </font></font><code>8040ecb0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li><li> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nimmt den Wert 6 an, wenn LEFT an der Adresse gedr√ºckt wird </font></font><code>8040ec98</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li><li> <code>r5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nimmt den Wert 5 an (und r6 nimmt den Wert 1 an), wenn an der Adresse DOWN gedr√ºckt wird </font></font><code>8040ec7c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li><li> <code>r5</code>   4,     C   <code>8040ec64</code> . </li><li> <code>r5</code>   3,     C   <code>8040ec48</code> . </li><li> <code>r5</code>   2,   UP   <code>8040ec30</code> . </li><li> <code>r5</code>   1 ( <code>r6</code>   1),   Z   <code>8040ec1c</code> . </li></ul><br>    : <br><br> Z, UP, C-DOWN, C-UP, DOWN, LEFT, C-LEFT, C-RIGHT, RIGHT, A+B, START <br><br>   Z    :       Z,      <code>0x2030</code> :         (   <code>0x10</code>  <code>0x20</code> ).  , UP/DOWN/LEFT/RIGHT ‚Äî   D-pad,    . <br><br><h4> - </h4><br>     : <br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Halten Sie die Sto√üstangen L + R gedr√ºckt und dr√ºcken Sie Z. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D-up </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-DOWN </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-up </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D-down </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D-links </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-links </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-RECHTS </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D-RECHTS </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A + B. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> STARTEN </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es funktioniert! </font><font style="vertical-align: inherit;">Schlie√üen Sie den Controller an den zweiten Port an und geben Sie den Code ein. Danach werden die Debug-Informationen angezeigt. </font><font style="vertical-align: inherit;">Danach k√∂nnen Sie die Tasten am zweiten (oder sogar dritten) Controller dr√ºcken, um verschiedene Aktionen auszuf√ºhren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Kombination funktioniert, ohne die Versionsnummer des Spiels zu patchen. </font><font style="vertical-align: inherit;">Es kann sogar in einer regul√§ren Einzelhandelsversion des Spiels ohne Cheat-Tools oder Konsolen-Mods verwendet werden. </font><font style="vertical-align: inherit;">Durch erneutes Eingeben von Combos wird der Zuru-Modus deaktiviert.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b4d/fe4/7f0/b4dfe47f0139ba1af039decfb6274524.jpg" alt="Verwenden des Codes auf einem echten GameCube"></div><br>  ¬´ZURU %d/%d¬ª  <code>zurumode_callback</code>      ,    ,  ID    <code>0x99</code> (,     -).   ‚Äî      ,  <code>r5</code> .    1,     ,    ,  <code>r6</code>   1. <br><br>    ,     ,     ,     . ,            ‚Äî       .   ,   - ,    . <br><br>  ,     Z ‚Äî      ,     ,    ,      .   <code>fault_callback_scroll</code>  ,          .       ,           NOP. ,           : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b06/755/a33/b06755a33e0b0b8b010b7cbff7a26594.png" alt="JUTConsole-M√ºllzeichen"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem ich dies alles getan hatte, stellte ich fest, dass das Aufrufen des Debug-Modus durch Patchen der </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versions- </font><font style="vertical-align: inherit;">ID </font></font><code>0x99</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bereits anderen Personen bekannt ist: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://tcrf.net/Animal_Crossing#Debug_Mode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">(Au√üerdem enth√§lt der Link gute Hinweise, die auf verschiedene Meldungen hinweisen und √ºber andere Dinge sprechen, die mit dem Controller in Port 3 ausgef√ºhrt werden k√∂nnen.) Soweit ich wei√ü, hat jedoch noch niemand die Cheat-Kombination ver√∂ffentlicht.</font></font><br><br>  Das ist alles<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es gibt andere Entwicklerfunktionen, die ich untersuchen m√∂chte, wie den Debug-Bildschirm der Karte und den NES-Emulator-Auswahlbildschirm und wie man sie ohne Verwendung von Patches aktiviert. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/258/eb3/445/258eb3445236357c201c343d6c8ae4ba.png" alt="Kartenauswahlbildschirm"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dar√ºber hinaus werde ich Artikel zum Reverse Engineering von Dialogsystemen, Ereignissen und Quests ver√∂ffentlichen, um Mods zu erstellen. </font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413967/">https://habr.com/ru/post/de413967/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413955/index.html">Kompletter Entwicklungszyklus des IoT-Ger√§ts zur Steuerung der Poolheizung auf dem ESP8266 in einer Arduino-Umgebung</a></li>
<li><a href="../de413957/index.html">Ein Beispiel f√ºr die Erstellung einer Echtzeit-Sportanwendung auf Node.js.</a></li>
<li><a href="../de413959/index.html">Kleinstes Docker-Image - Weniger als 1000 Byte</a></li>
<li><a href="../de413963/index.html">Mini CRM f√ºr kleine Unternehmen</a></li>
<li><a href="../de413965/index.html">Code√ºberpr√ºfung: Sie machen es falsch</a></li>
<li><a href="../de413969/index.html">Technopark Russky - innovative Entwicklung von Milliardenbudgets</a></li>
<li><a href="../de413971/index.html">10+ englischsprachige Nachrichtenmedien f√ºr Sprachlerner</a></li>
<li><a href="../de413973/index.html">Cavium ThunderX2-Evaluierung: Der Arm Server-Traum wird wahr (Teil 2)</a></li>
<li><a href="../de413977/index.html">Aufbau eines erweiterten Virenschutzsystems f√ºr ein kleines Unternehmen. Teil 3</a></li>
<li><a href="../de413979/index.html">Mitap "Wie leite ich Gilden und Gemeinschaften?" von Tutu.ru und AgileVerse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>