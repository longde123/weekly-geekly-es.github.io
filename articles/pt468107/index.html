<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💽 👴🏼 😘 Como criar um modelo com mais precisão do que transfermarkt e não prever ou o que afeta o custo das transferências acima de tudo 🙍🏽 🕢 👨🏼‍⚕️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tentarei dizer a você como é fácil obter resultados interessantes simplesmente aplicando uma abordagem completamente padrão do tutorial do curso de ap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como criar um modelo com mais precisão do que transfermarkt e não prever ou o que afeta o custo das transferências acima de tudo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468107/"><p>  Tentarei dizer a você como é fácil obter resultados interessantes simplesmente aplicando uma abordagem completamente padrão do tutorial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">do curso de aprendizado de máquina aos</a> dados que não são usados ​​no Deep Learning.  A essência do meu post é que cada um de nós pode fazer isso, basta olhar para o conjunto de informações que conhece bem.  Para isso, de fato, é muito mais importante simplesmente entender bem seus dados do que ser um especialista nas estruturas mais recentes das redes neurais.  Ou seja, na minha opinião, estamos nesse ponto de ouro no desenvolvimento da DL, quando, por um lado, já é uma ferramenta que pode ser usada sem a necessidade de um doutorado, e, por outro, ainda existem muitas áreas em que ninguém realmente o usou, se você olhar Um pouco além dos temas tradicionais. </p><br><p><img src="https://habrastorage.org/webt/id/tl/1d/idtl1dxx4ixh6ycstgzi8nsn8ks.jpeg"></p><a name="habracut"></a><br><p>  Lendo artigos e de passagem examinando como o aprendizado de máquina se desenvolve, você e eu podemos facilmente ter a sensação de que esse trem está passando.  De fato, se você faz os cursos mais famosos (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Andrew Ng</a> ) ou a maioria dos artigos sobre Habré da mesma excelente comunidade de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Open Data Science, você</a> rapidamente percebe que não há nada a fazer aqui a partir das profundezas da memória do instituto de conhecimento em matemática superior, bem, pelo menos alguns resultados sensatos (mesmo em exemplos de " <em>brinquedos</em> ") só podem ser alcançados após várias semanas de estudo da teoria de terry e de diferentes maneiras de sua implementação.  Mas muitas vezes você quer outra, deseja ter uma ferramenta que desempenhe sua função, que resolva uma certa classe de problemas, para que, aplicando-a em seu campo, obtenha o resultado.  De fato, em outras áreas tudo é exatamente o mesmo, se você, por exemplo, escreve um jogo e sua tarefa é garantir a transferência de informações do jogador para o servidor, não estuda a teoria dos gráficos, não descobre como otimizar a conectividade para que seus pacotes cheguem mais rapidamente - você pega a ferramenta (biblioteca, estrutura) que faz isso por você e se concentra no que é exclusivo para uma tarefa específica (por exemplo, que tipo de informação você precisa transferir para frente e para trás).  Por que isso não acontece com o aprendizado profundo? </p><br><p>  De fato, agora estamos à beira do tempo em que está se tornando <em>quase assim</em> .  E para mim, <em>quase achei essa</em> ferramenta - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">fast.ai.</a>  Uma biblioteca excelente e um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">curso ainda mais íngreme, cujo</a> princípio é apenas construído de cima para baixo: primeiro resolvendo problemas reais, geralmente no nível de precisão da previsão dos modelos de última geração, até a estrutura interna da biblioteca e a teoria por trás dela. </p><br><div class="spoiler">  <b class="spoiler_title">Claro, nem tudo é tão simples.</b> <div class="spoiler_text"><p>  Antecipando acusações de não profissionalismo e a superficialidade do meu conhecimento (o que, é claro, é mais verdadeiro do que não), quero fazer uma reserva imediatamente.  É necessário estudar a teoria, assistir a essas palestras fundamentais, lembrar o cálculo matricial, etc.?  Claro que sim.  E quanto mais você mergulhar no tópico, mais precisará dele e terá que se apegar às fontes principais.  Porém, quanto mais consciente a imersão, mais fácil será entender exatamente como esses fundamentos afetam o resultado.  O ponto principal do princípio de cima para baixo é precisamente que deve ser feito depois.  Depois de já ter escrito algo tangível, você pode mostrar aos seus amigos.  Depois de ter mergulhado o suficiente no tópico e ele o fascinou.  E a teoria do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">conhecimento</a> o ultrapassará, ela está sendo apresentada no exato momento em que será mais fácil correlacioná-la com o que você já fez.  Como uma explicação do porquê e como ele realmente funciona. </p><br><p>  Tenho mais certeza de que alguém se sente mais à vontade com a abordagem tradicional de baixo para cima.  E é bom que haja os dois lados, o principal é que nos encontramos no meio </p></div></div><br><p>  Com esse conhecimento, decidi aplicar a DL a um tópico no qual eu próprio me interessei há muito tempo e ver o que isso pode levar.  E, claro, a primeira coisa que me veio à mente foi o futebol.  E quando eu encontrei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">essas maravilhosas estatísticas de</a> transferência no kaggle, a escolha se tornou ainda mais óbvia. </p><br><p>  Um pouco sobre esses dados.  Eles contêm informações sobre quem e onde se mudou para o futebol europeu nos últimos 10 anos.  Há informações sobre clubes, estatísticas de jogadores, ligas em que participam, treinadores e agentes e muito mais (existem mais de cem campos diferentes no total).  Os dados são muito interessantes, mas é possível determinar quanto um jogador deve custar deles? </p><br><p><img src="https://habrastorage.org/webt/q9/n8/bb/q9n8bbmosrfwyf0bhzu7pio3o0u.jpeg"></p><br><p>  Se você pensar bem, o preço de um jogador depende de um grande número de fatores.  Ao mesmo tempo, é ótimo, <strong>e</strong> eu (se não a maioria) a parte deles é simplesmente não formalizável.  Como entender que o clube acaba de vender o jogador a um preço alto, precisa de um atacante e está pronto para pagar em excesso;  como entender que um novo treinador chegou e requer atualização da lista;  como entender que o zagueiro principal do clube notou o grand e começou a jogar sem entusiasmo, exigindo uma transferência?  Tudo isso afeta fundamentalmente a quantidade de uma transação, mas não é apresentada nos dados.  A partir disso, minhas expectativas iniciais sobre a precisão de tal previsão foram pequenas. </p><br><div class="spoiler">  <b class="spoiler_title">Eu sou um programador falso</b> <div class="spoiler_text"><p> Neste momento, é hora de inserir o aviso padrão de que não <code>#</code> um <code>#</code> , não ganho dinheiro com isso; portanto, meu código é terrível e provavelmente pode (e deve?) Ser reescrito muito melhor, mas como a tarefa era investigar a ideia e (não ?) Confirme a teoria, então o código é o que é :) </p></div></div><br><h4 id="model">  Modelo </h4><br><p>  Comecei excluindo transferências mais baratas que US $ 1 milhão, que são muito caóticas.  Depois, ele trouxe todos os dados para uma grande mesa com cem campos e meio, nos quais, para cada transferência, havia todas as informações disponíveis sobre ele (tanto sobre a transferência em si, sobre o jogador e suas estatísticas, quanto sobre os clubes participantes, ligas etc.) ) </p><br><p>  Vejamos as etapas de como eu criei o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">modelo</a> : </p><br><p>  Depois que concluímos todas as importações do Python e carregamos a tabela de transferência desnormalizada, a primeira coisa que precisamos determinar é quais dos campos que consideraremos como numéricos e quais são categóricos.  Este é um tópico muito interessante por si só, você pode falar sobre isso nos comentários, mas para economizar tempo, apenas descrevo a regra que uso: por padrão, considero todos os campos categóricos, exceto aqueles que são representados como números de ponto flutuante ou aqueles em que o número de valores diferentes é grande o suficiente. </p><br><p>  Nesse contexto, por exemplo, considero o ano da transferência categórico, embora esse seja inicialmente um número, porque o número de valores diferentes é pequeno aqui (10 - de 2008 a 2018).  Mas, por exemplo, o desempenho do jogador na última temporada (que é representado pelo número médio de gols por partida) é flutuante e pode ter quase qualquer valor, por isso considero numérico. </p><br><pre> <code class="python hljs">cat_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'season'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_year'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_month'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_day'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_till_deadline'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_months'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_years'</span></span>,<span class="hljs-string"><span class="hljs-string">'age'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_midseason'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_loan'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_end_of_loan'</span></span>, <span class="hljs-string"><span class="hljs-string">'nat_national_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_main'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_positions'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_nationality_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_nationality_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_place_of_birth_country_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_foot'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_height'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_player_agent'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_is_first_team'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_place'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_qualified_to'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_cup_winner'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_is_promoted'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_country'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_group'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_club_is_first_team'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_place'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_qualified_to'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_cup_winner'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_promoted'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_lg_country'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_group'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_position_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_2'</span></span>) cont_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'nat_months_from_debut'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_matches_played'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_goals_scored'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_pts_avg'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_pts_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_apps_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_minutes_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_cards_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_conc_gols_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'pop_log1p'</span></span>)</code> </pre> <br><p>  Depois de indicar explicitamente o que preveremos - o valor da transferência ( <code>fee</code> ), dividimos aleatoriamente nossos dados em 2 partes de 80% e 20%.  No primeiro deles, ensinaremos nossa rede neural, por outro - a verificar a precisão da previsão. </p><br><pre> <code class="python hljs">ln = len(df) valid_idx = np.random.choice(ln, int(ln*<span class="hljs-number"><span class="hljs-number">0.2</span></span>), replace=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><p>  No último estágio preparatório, precisamos fazer uma escolha de como mediremos a plausibilidade de nossas previsões.  Então, não escolhi a métrica mais padrão na parte local do universo - a mediana do erro percentual ( <code>MdAPE</code> ).  Ou, para simplificar, quantos por cento (o preço absoluto de uma transferência pode diferir em ordens de grandeza) provavelmente cometeremos um erro no preço de uma transferência tomada aleatoriamente.  Pareceu-me mais próximo do que exatamente a frase “precisão do sistema de previsão de transferência” significa para mim. </p><br><p>  Agora é hora de começar a aprender a rede. </p><br><pre> <code class="python hljs">data = (TabularList.from_df(df, path=path, cat_names=cat_vars, cont_names=cont_vars, procs=procs) .split_by_idx(valid_idx) .label_from_df(cols=dep_var, label_cls=FloatList, log=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) .databunch(bs=BS)) learn = tabular_learner(data, layers=layers, ps=layers_drop, emb_drop=emb_drop, y_range=y_range, metrics=exp_mmape, loss_func=MAELossFlat(), callback_fns=[CSVLogger]) learn.fit_one_cycle(cyc_len=cycles, max_lr=max_lr, wd=w_decay)</code> </pre> <br><h4 id="tochnost-predskazaniy">  Precisão de previsão </h4><br><p><img src="https://habrastorage.org/webt/-z/kl/zj/-zklzjwczjcogqhqq93hrxjcfc8.png"></p><br><p>  <code>Validation Error = 0.3492</code> significa que, após o treinamento em um novo <code>validation set</code> dados ( <code>validation set</code> , <code>validation set</code> ), o modelo em média (mediana) é 34% equivocado em relação ao preço real de transferência.  E conseguimos apenas como resultado de várias linhas de código retiradas do tutorial. </p><br><p>  34% de erro, é muito ou pouco?  Tudo é relativo.  A única fonte comparável, cujos dados podem ser tomados como uma " <em>previsão</em> " do valor da transferência, é, obviamente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">transfermarkt</a> .  Felizmente, existe um campo nos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">dados do kaggle</a> que mostra como este site classificou um jogador no momento da transferência, e isso pode ser comparado.  Note-se aqui que a transfermarkt nunca alegou que seu <code>market value</code> é o provável preço de transferência.  Pelo contrário, enfatizaram que é o " <em>valor honesto</em> " de um ou outro jogador.  E quanto dinheiro um clube em particular pagará por isso em uma situação específica é uma coisa muito individual e pode flutuar em uma direção ou outra dentro de limites muito amplos.  Mas é o melhor que temos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">vamos comparar</a> . </p><br><p><img src="https://habrastorage.org/webt/an/jz/4l/anjz4lvbdxlbqy5s26q8gd5_vig.png"></p><br><p>  Erro Transfermarkt - <strong>35%</strong> , nosso modelo - <strong>35%</strong> .  Muito estranho e, para ser sincero, muito desconfiado. <br>  Neste ponto, proponho pensar novamente.  Um site com uma enorme história, criado apenas para mostrar o `` valor '' dos jogadores, que depende do poder total do efeito multidão (deriva do valor das classificações de visitantes comuns e profissionais do mercado) e do conhecimento de especialistas, por um lado, e do modelo, que não sabe nada sobre futebol, não vê nada, exceto os dados que fornecemos (e fora desses dados no mundo real ainda existem muitas coisas que as pessoas com a transfermarkt levam em consideração), por outro lado, eles <strong>mostram o mesmo erro</strong> .  Além disso, nosso modelo também permite prever o preço do aluguel do jogador, que o <code>market value</code> , por razões óbvias, não mostra (levando em conta essas transações, o resultado da transfermarkt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">foi ainda pior</a> ). </p><br><p>  Honestamente, ainda acho que tenho algum tipo de erro aqui, tudo é bom demais para ser verdade.  Mas, no entanto, vamos além. </p><br><p>  Uma maneira fácil de se testar é tentar calcular as previsões de duas fontes (modelos e transfermarkt).  Se as previsões forem verdadeiramente independentes umas das outras e não houver erro irritante, o resultado deverá melhorar. </p><br><p><img src="https://habrastorage.org/webt/uu/f0/ut/uuf0uts7ak4xrbr95efffferqvu.png"></p><br><p>  De fato, a média das previsões reduz o erro de previsão para 32% (!).  Isso pode parecer um pouco, mas precisamos entender que estamos filtrando mais informações dos dados, que são tão compactados ao máximo. </p><br><p>  Mas o que faremos a seguir, na minha opinião, é ainda mais surpreendente e interessante, embora esteja além do escopo do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">tutorial fast.ai.</a> </p><br><h4 id="feature-importance">  Importância do recurso </h4><br><p>  As redes neurais, para não dizer que são completamente imerecidas, são frequentemente consideradas uma "caixa preta".  Sabemos quais dados podemos colocar lá, podemos obter as previsões do modelo, podemos até avaliar o quanto essas previsões são verdadeiras, em média.  Mas não podemos explicar por quais critérios o modelo "tomou" essa ou aquela decisão.  A estrutura interna da rede em si é tão complexa e, mais importante, não linear, que é impossível rastrear diretamente toda a cadeia de tomada de decisão e tirar conclusões significativas do mundo real a partir daí.  Mas realmente quero.  Eu gostaria de entender o que influencia o valor da transferência acima de tudo. </p><br><p>  Bem, não vamos subir dentro da rede.  Mas o que significa a importância de cada campo, vamos chamá-lo de <strong>Importância de Recursos</strong> (FI)?  Uma opção para entender 'importância' é calcular quanto as coisas piorarão se não tivermos esse campo.  E é exatamente isso que podemos medir.  Agora temos uma ferramenta que fornece previsões para qualquer conjunto de dados.  Portanto, se apenas calcularmos quanto o erro de previsão aumentará quando substituirmos dados aleatórios no campo, podemos estimar quanto ele (o campo) afeta o resultado final, o que significa o quanto é importante.  Para permanecer dentro da distribuição real dos dados, o campo será preenchido não apenas com números aleatórios, mas com valores misturados aleatoriamente (ou seja, apenas misturaremos a coluna, por exemplo, 'ano de transferência', na tabela original).  Por fidelidade, esse processo pode ser realizado várias vezes para cada campo, calculando a média do resultado.  Tudo é bem simples.  Agora vamos ver como isso dá o resultado: </p><br><p><img src="https://habrastorage.org/webt/ou/s8/4x/ous84xjkamb1mtigicrbsublki8.png"></p><br><p>  Meu intestino diz: 'Sim e não!' </p><br><p>  Por um lado, os campos que você espera ver estavam no topo: treinadores de equipe de onde e para onde <code>from_coach_name</code> jogador foi (de <code>from_coach_name</code> , para <code>to_coach_name</code> ), os próprios clubes que participaram da transferência ( <code>from_club_name</code> , <code>to_club_name</code> ), o agente do jogador ( <code>plr_player_agent</code> ), sua fama nas redes sociais ( <code>pop_log1p</code> ) etc.  Mas por outro lado ... Intuitivamente, não parece que os nomes dos treinadores devam ter mais peso no preço de transferência do que, por exemplo, os próprios clubes (sabemos bem que o Benfica condicional é capaz de vender seus jogadores caros).  A marca de um treinador influencia mais fortemente o preço do que a marca do clube?  A chegada do Mancini condicional força tanto o clube a pagar em excesso?  O que acontece quando os dados nos fornecem informações novas, um pouco contra-intuitivas, ou apenas um erro no modelo? </p><br><p>  Vamos acertar.  Com um olhar atento ao gráfico, o olho rapidamente se apega a uma coisa estranha.  Logo abaixo do centro, existem 2 campos de <code>trs_year</code> e <code>season</code> <code>trs_year</code> , eles representam o ano da transferência e a estação em que a transição será realizada (em geral, eles podem não coincidir, embora isso não ocorra com tanta frequência).  Em primeiro lugar, parece que eles devem ser mais altos, sabemos quanto os preços dos jogadores de futebol subiram nos últimos anos e, em segundo lugar, obviamente significam a mesma coisa.  O que fazer sobre isso?  Apenas resuma sua importância?  Não é o fato de que isso pode ser feito!  Mas o que definitivamente podemos fazer é aplicar a mesma abordagem (misturando valores) não separadamente nesses dois campos, mas como um grupo.  Ou seja, meça como o erro será alterado se houver valores aleatórios nessas 2 colunas de uma só vez.  Bem, desde que fazemos isso ao longo dos anos, precisamos ver se temos outros campos tão "conectados". </p><br><p>  Por exemplo, para um clube, temos vários parâmetros: o próprio clube ( <code>club_name</code> do clube), bem como um conjunto de informações sobre ele - de qual liga, país etc.  ( <code>club_is_first_team</code> , <code>clb_lg_name</code> , <code>clb_lg_country</code> , <code>clb_lg_group</code> ).  Somente em alguns casos, estamos interessados ​​em saber quanto isso afeta o preço, por exemplo, o país para o qual o jogador vai separadamente ( <code>clb_lg_country</code> ). Na maioria das vezes, é importante entendermos qual é o peso total do campo 'clube', que já está em um determinado país, liga etc. . </p><br><p>  Assim, podemos combinar todos os campos em grupos de acordo com o conteúdo semântico.  Isso nos ajudará apenas como conhecimento da área de assunto e senso comum, bem como a 'proximidade' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">calculada</a> dos recursos.  O último mostra apenas como os campos se correlacionam, ou seja, quanto é possível considerá-los como um único grupo. </p><br><p>  Aplicando essa abordagem, obtemos um gráfico ainda mais intuitivo da importância dos campos: </p><br><p><img src="https://habrastorage.org/webt/gu/mc/ma/gumcmafyqlu-ognduuxghf02xww.png"></p><br><p>  Lá vai você.  Exatamente o clube que o jogador mais compra afeta o valor da transferência, com uma margem muito boa.  Oi Man City, Barcelona, ​​Zenit e, por exemplo, o mesmo Benfica (afinal, " <em>influencia fortemente</em> " a mesma coisa sobre o fato de que alguns clubes, pelo contrário, conseguem comprar jogadores de qualidade mais baratos que o "mercado").  Parece-me que o mais interessante ao trabalhar com dados é que, quando obtidos, as conclusões são óbvias, por um lado (bem, eu duvidava que o comprador do clube tivesse a influência mais poderosa sobre o valor da transferência) e, por outro lado, é um pouco surpreendente (e os candidatos pela primeira vez). intuitivamente, o local poderia ser um pouco, e a separação do segundo não parecia tão significativa) </p><br><p>  Ainda há muitas coisas interessantes para descobrir.  Por exemplo, o nome do treinador de onde o jogador é comprado, do ponto de vista do modelo, ainda é mais importante que o clube ... Deixe a diferença ser bastante reduzida.  Uma explicação lógica para isso pode ser encontrada em princípio (embora às vezes possa ser encontrada para qualquer coisa).  Existem treinadores (Guardiola, Klopp, Benitez, Berdyev) que aderem a uma certa ideologia do jogo em clubes diferentes, o que melhor revela ou vice-versa torna determinadas posições no campo menos brilhantes e a visibilidade do jogador afeta muito seu preço.  Sobre clubes, por assim dizer, quase impossível.  E o fato de vermos treinadores que não se afastam radicalmente de seus princípios de jogo com muito mais frequência do que os clubes trocando de treinador, mas que permanecem dentro da mesma filosofia (por exemplo, de improviso, exceto que o Ajax vem à mente e o Barcelona é muito questionável), fala de que, talvez, certos gerentes revelem jogadores mais estáveis ​​que os clubes.  Embora aqui não me apegue fortemente à minha afirmação. </p><br><p>  Dos indicadores puramente estatísticos, o valor mais alto é simplesmente o tempo que um jogador passou em campo no ano passado em sua competição principal ( <code>stats_minutes_0</code> ).  Isso é bastante lógico, porque o quanto esse jogador foi o “principal” em seu clube na última temporada parece um indicador estatístico mais universal de seu sucesso do que outros - por exemplo, o número de gols marcados ou cartões recebidos. </p><br><p>  A popularidade do jogador ( <code>pop_log1p</code> ) fecha esse grupo dos 8 parâmetros mais importantes.  Vale lembrar que os dados que apresentamos nos últimos 10 anos.  Eu acho que a importância desse campo seria maior se estivéssemos considerando os últimos 5 anos, e para o valor médio da última década esse é um resultado completamente compreensível, especialmente se levarmos em conta a diferença do próximo lugar. </p><br><p>  Bem, a última coisa que gostaria de chamar a atenção é a importância do campo do agente ( <code>plr_player_agent</code> ).  Deixarei isso sem comentários, porque, se você pode quebrar as margens das cópias em disputas sobre a (des) necessidade de agentes, não há dúvida sobre o grau de sua influência no mercado de transferências moderno (embora o modelo sugira não superestimá-lo). </p><br><p><img src="https://habrastorage.org/webt/q2/al/i5/q2ali5al_krkgtsmdkn_mw5i6na.jpeg"></p><br><p>  A propósito, talvez a coisa mais interessante nesse método de análise seja sua acessibilidade: não é necessário criar <em>um</em> modelo “ <em>ideal</em> ” para obter informações sobre a importância dos parâmetros.  Em muitos casos, basta prever, no mínimo, que seja estatisticamente significativamente diferente de jogar uma moeda, e você <em>já</em> obtém resultados que geralmente contêm informações interessantes ou informam de que lado novo você pode ver os dados. </p><br><p>  Chegou a hora de terminar, para não aumentar o texto tão sobrecarregado.  Ao me despedir, gostaria de pedir novamente a todos os interessados ​​no tópico que experimentem (o melhor, na minha opinião, para iniciantes) o curso Deep Learning - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">fast.ai</a> e apliquem o conhecimento adquirido em 'seu campo de atuação', é provável que você seja o primeiro a chegar :) </p><br><p>  E, se você gostar, tentarei dominar a segunda parte do texto sobre minhas experiências nas quais o modelo usando uma ferramenta igualmente poderosa - <strong>Dependência Parcial</strong> dirá a você: qual cliente da agência é melhor para se tornar jogador de futebol, quais clubes têm a política de transferência mais eficaz, qual treinador aumenta melhor o custo dos jogadores (além dos candidatos óbvios, existem muitas 'marcas' não tão promovidas que claramente valem uma olhada mais de perto) e muito mais. </p><br><p>  Parte 2 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modelo de transferências de futebol: cavando mais fundo</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt468107/">https://habr.com/ru/post/pt468107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt468089/index.html">Redefinição baseada em edição: é possível na produção?</a></li>
<li><a href="../pt468091/index.html">O projeto de lei sobre a criação de um único banco de dados com os dados dos cidadãos adotados na Duma do Estado em primeira leitura</a></li>
<li><a href="../pt468093/index.html">Nitratos nos produtos: lojas suíças vs lojas russas vs casa de verão</a></li>
<li><a href="../pt468097/index.html">Microsoft Edge - XSS genérico</a></li>
<li><a href="../pt468099/index.html">C / C ++ de Python (CFFI, pybind11)</a></li>
<li><a href="../pt468109/index.html">Dizem que Samara é uma cidade de Javists, mas estamos conduzindo um mitap PHP lá</a></li>
<li><a href="../pt468111/index.html">PSD2 - chute para bancos</a></li>
<li><a href="../pt468117/index.html">Ethernet, FTP, Telnet, HTTP, Bluetooth - o básico da análise de tráfego. Resolvendo problemas em uma rede com r0ot-mi. Parte 1</a></li>
<li><a href="../pt468121/index.html">Como não me tornei programador aos 35 anos</a></li>
<li><a href="../pt468125/index.html">Animação em Assíntota</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>