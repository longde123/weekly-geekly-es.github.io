<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíΩ üë¥üèº üòò Como criar um modelo com mais precis√£o do que transfermarkt e n√£o prever ou o que afeta o custo das transfer√™ncias acima de tudo üôçüèΩ üï¢ üë®üèº‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tentarei dizer a voc√™ como √© f√°cil obter resultados interessantes simplesmente aplicando uma abordagem completamente padr√£o do tutorial do curso de ap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como criar um modelo com mais precis√£o do que transfermarkt e n√£o prever ou o que afeta o custo das transfer√™ncias acima de tudo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468107/"><p>  Tentarei dizer a voc√™ como √© f√°cil obter resultados interessantes simplesmente aplicando uma abordagem completamente padr√£o do tutorial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">do curso de aprendizado de m√°quina aos</a> dados que n√£o s√£o usados ‚Äã‚Äãno Deep Learning.  A ess√™ncia do meu post √© que cada um de n√≥s pode fazer isso, basta olhar para o conjunto de informa√ß√µes que conhece bem.  Para isso, de fato, √© muito mais importante simplesmente entender bem seus dados do que ser um especialista nas estruturas mais recentes das redes neurais.  Ou seja, na minha opini√£o, estamos nesse ponto de ouro no desenvolvimento da DL, quando, por um lado, j√° √© uma ferramenta que pode ser usada sem a necessidade de um doutorado, e, por outro, ainda existem muitas √°reas em que ningu√©m realmente o usou, se voc√™ olhar Um pouco al√©m dos temas tradicionais. </p><br><p><img src="https://habrastorage.org/webt/id/tl/1d/idtl1dxx4ixh6ycstgzi8nsn8ks.jpeg"></p><a name="habracut"></a><br><p>  Lendo artigos e de passagem examinando como o aprendizado de m√°quina se desenvolve, voc√™ e eu podemos facilmente ter a sensa√ß√£o de que esse trem est√° passando.  De fato, se voc√™ faz os cursos mais famosos (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Andrew Ng</a> ) ou a maioria dos artigos sobre Habr√© da mesma excelente comunidade de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Open Data Science, voc√™</a> rapidamente percebe que n√£o h√° nada a fazer aqui a partir das profundezas da mem√≥ria do instituto de conhecimento em matem√°tica superior, bem, pelo menos alguns resultados sensatos (mesmo em exemplos de " <em>brinquedos</em> ") s√≥ podem ser alcan√ßados ap√≥s v√°rias semanas de estudo da teoria de terry e de diferentes maneiras de sua implementa√ß√£o.  Mas muitas vezes voc√™ quer outra, deseja ter uma ferramenta que desempenhe sua fun√ß√£o, que resolva uma certa classe de problemas, para que, aplicando-a em seu campo, obtenha o resultado.  De fato, em outras √°reas tudo √© exatamente o mesmo, se voc√™, por exemplo, escreve um jogo e sua tarefa √© garantir a transfer√™ncia de informa√ß√µes do jogador para o servidor, n√£o estuda a teoria dos gr√°ficos, n√£o descobre como otimizar a conectividade para que seus pacotes cheguem mais rapidamente - voc√™ pega a ferramenta (biblioteca, estrutura) que faz isso por voc√™ e se concentra no que √© exclusivo para uma tarefa espec√≠fica (por exemplo, que tipo de informa√ß√£o voc√™ precisa transferir para frente e para tr√°s).  Por que isso n√£o acontece com o aprendizado profundo? </p><br><p>  De fato, agora estamos √† beira do tempo em que est√° se tornando <em>quase assim</em> .  E para mim, <em>quase achei essa</em> ferramenta - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">fast.ai.</a>  Uma biblioteca excelente e um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">curso ainda mais √≠ngreme, cujo</a> princ√≠pio √© apenas constru√≠do de cima para baixo: primeiro resolvendo problemas reais, geralmente no n√≠vel de precis√£o da previs√£o dos modelos de √∫ltima gera√ß√£o, at√© a estrutura interna da biblioteca e a teoria por tr√°s dela. </p><br><div class="spoiler">  <b class="spoiler_title">Claro, nem tudo √© t√£o simples.</b> <div class="spoiler_text"><p>  Antecipando acusa√ß√µes de n√£o profissionalismo e a superficialidade do meu conhecimento (o que, √© claro, √© mais verdadeiro do que n√£o), quero fazer uma reserva imediatamente.  √â necess√°rio estudar a teoria, assistir a essas palestras fundamentais, lembrar o c√°lculo matricial, etc.?  Claro que sim.  E quanto mais voc√™ mergulhar no t√≥pico, mais precisar√° dele e ter√° que se apegar √†s fontes principais.  Por√©m, quanto mais consciente a imers√£o, mais f√°cil ser√° entender exatamente como esses fundamentos afetam o resultado.  O ponto principal do princ√≠pio de cima para baixo √© precisamente que deve ser feito depois.  Depois de j√° ter escrito algo tang√≠vel, voc√™ pode mostrar aos seus amigos.  Depois de ter mergulhado o suficiente no t√≥pico e ele o fascinou.  E a teoria do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">conhecimento</a> o ultrapassar√°, ela est√° sendo apresentada no exato momento em que ser√° mais f√°cil correlacion√°-la com o que voc√™ j√° fez.  Como uma explica√ß√£o do porqu√™ e como ele realmente funciona. </p><br><p>  Tenho mais certeza de que algu√©m se sente mais √† vontade com a abordagem tradicional de baixo para cima.  E √© bom que haja os dois lados, o principal √© que nos encontramos no meio </p></div></div><br><p>  Com esse conhecimento, decidi aplicar a DL a um t√≥pico no qual eu pr√≥prio me interessei h√° muito tempo e ver o que isso pode levar.  E, claro, a primeira coisa que me veio √† mente foi o futebol.  E quando eu encontrei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">essas maravilhosas estat√≠sticas de</a> transfer√™ncia no kaggle, a escolha se tornou ainda mais √≥bvia. </p><br><p>  Um pouco sobre esses dados.  Eles cont√™m informa√ß√µes sobre quem e onde se mudou para o futebol europeu nos √∫ltimos 10 anos.  H√° informa√ß√µes sobre clubes, estat√≠sticas de jogadores, ligas em que participam, treinadores e agentes e muito mais (existem mais de cem campos diferentes no total).  Os dados s√£o muito interessantes, mas √© poss√≠vel determinar quanto um jogador deve custar deles? </p><br><p><img src="https://habrastorage.org/webt/q9/n8/bb/q9n8bbmosrfwyf0bhzu7pio3o0u.jpeg"></p><br><p>  Se voc√™ pensar bem, o pre√ßo de um jogador depende de um grande n√∫mero de fatores.  Ao mesmo tempo, √© √≥timo, <strong>e</strong> eu (se n√£o a maioria) a parte deles √© simplesmente n√£o formaliz√°vel.  Como entender que o clube acaba de vender o jogador a um pre√ßo alto, precisa de um atacante e est√° pronto para pagar em excesso;  como entender que um novo treinador chegou e requer atualiza√ß√£o da lista;  como entender que o zagueiro principal do clube notou o grand e come√ßou a jogar sem entusiasmo, exigindo uma transfer√™ncia?  Tudo isso afeta fundamentalmente a quantidade de uma transa√ß√£o, mas n√£o √© apresentada nos dados.  A partir disso, minhas expectativas iniciais sobre a precis√£o de tal previs√£o foram pequenas. </p><br><div class="spoiler">  <b class="spoiler_title">Eu sou um programador falso</b> <div class="spoiler_text"><p> Neste momento, √© hora de inserir o aviso padr√£o de que n√£o <code>#</code> um <code>#</code> , n√£o ganho dinheiro com isso; portanto, meu c√≥digo √© terr√≠vel e provavelmente pode (e deve?) Ser reescrito muito melhor, mas como a tarefa era investigar a ideia e (n√£o ?) Confirme a teoria, ent√£o o c√≥digo √© o que √© :) </p></div></div><br><h4 id="model">  Modelo </h4><br><p>  Comecei excluindo transfer√™ncias mais baratas que US $ 1 milh√£o, que s√£o muito ca√≥ticas.  Depois, ele trouxe todos os dados para uma grande mesa com cem campos e meio, nos quais, para cada transfer√™ncia, havia todas as informa√ß√µes dispon√≠veis sobre ele (tanto sobre a transfer√™ncia em si, sobre o jogador e suas estat√≠sticas, quanto sobre os clubes participantes, ligas etc.) ) </p><br><p>  Vejamos as etapas de como eu criei o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">modelo</a> : </p><br><p>  Depois que conclu√≠mos todas as importa√ß√µes do Python e carregamos a tabela de transfer√™ncia desnormalizada, a primeira coisa que precisamos determinar √© quais dos campos que consideraremos como num√©ricos e quais s√£o categ√≥ricos.  Este √© um t√≥pico muito interessante por si s√≥, voc√™ pode falar sobre isso nos coment√°rios, mas para economizar tempo, apenas descrevo a regra que uso: por padr√£o, considero todos os campos categ√≥ricos, exceto aqueles que s√£o representados como n√∫meros de ponto flutuante ou aqueles em que o n√∫mero de valores diferentes √© grande o suficiente. </p><br><p>  Nesse contexto, por exemplo, considero o ano da transfer√™ncia categ√≥rico, embora esse seja inicialmente um n√∫mero, porque o n√∫mero de valores diferentes √© pequeno aqui (10 - de 2008 a 2018).  Mas, por exemplo, o desempenho do jogador na √∫ltima temporada (que √© representado pelo n√∫mero m√©dio de gols por partida) √© flutuante e pode ter quase qualquer valor, por isso considero num√©rico. </p><br><pre> <code class="python hljs">cat_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'season'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_year'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_month'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_day'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_till_deadline'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_months'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_years'</span></span>,<span class="hljs-string"><span class="hljs-string">'age'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_midseason'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_loan'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_end_of_loan'</span></span>, <span class="hljs-string"><span class="hljs-string">'nat_national_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_main'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_positions'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_nationality_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_nationality_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_place_of_birth_country_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_foot'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_height'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_player_agent'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_is_first_team'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_place'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_qualified_to'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_cup_winner'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_is_promoted'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_country'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_group'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_club_is_first_team'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_place'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_qualified_to'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_cup_winner'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_promoted'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_lg_country'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_group'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_position_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_2'</span></span>) cont_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'nat_months_from_debut'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_matches_played'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_goals_scored'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_pts_avg'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_pts_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_apps_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_minutes_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_cards_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_conc_gols_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'pop_log1p'</span></span>)</code> </pre> <br><p>  Depois de indicar explicitamente o que preveremos - o valor da transfer√™ncia ( <code>fee</code> ), dividimos aleatoriamente nossos dados em 2 partes de 80% e 20%.  No primeiro deles, ensinaremos nossa rede neural, por outro - a verificar a precis√£o da previs√£o. </p><br><pre> <code class="python hljs">ln = len(df) valid_idx = np.random.choice(ln, int(ln*<span class="hljs-number"><span class="hljs-number">0.2</span></span>), replace=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><p>  No √∫ltimo est√°gio preparat√≥rio, precisamos fazer uma escolha de como mediremos a plausibilidade de nossas previs√µes.  Ent√£o, n√£o escolhi a m√©trica mais padr√£o na parte local do universo - a mediana do erro percentual ( <code>MdAPE</code> ).  Ou, para simplificar, quantos por cento (o pre√ßo absoluto de uma transfer√™ncia pode diferir em ordens de grandeza) provavelmente cometeremos um erro no pre√ßo de uma transfer√™ncia tomada aleatoriamente.  Pareceu-me mais pr√≥ximo do que exatamente a frase ‚Äúprecis√£o do sistema de previs√£o de transfer√™ncia‚Äù significa para mim. </p><br><p>  Agora √© hora de come√ßar a aprender a rede. </p><br><pre> <code class="python hljs">data = (TabularList.from_df(df, path=path, cat_names=cat_vars, cont_names=cont_vars, procs=procs) .split_by_idx(valid_idx) .label_from_df(cols=dep_var, label_cls=FloatList, log=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) .databunch(bs=BS)) learn = tabular_learner(data, layers=layers, ps=layers_drop, emb_drop=emb_drop, y_range=y_range, metrics=exp_mmape, loss_func=MAELossFlat(), callback_fns=[CSVLogger]) learn.fit_one_cycle(cyc_len=cycles, max_lr=max_lr, wd=w_decay)</code> </pre> <br><h4 id="tochnost-predskazaniy">  Precis√£o de previs√£o </h4><br><p><img src="https://habrastorage.org/webt/-z/kl/zj/-zklzjwczjcogqhqq93hrxjcfc8.png"></p><br><p>  <code>Validation Error = 0.3492</code> significa que, ap√≥s o treinamento em um novo <code>validation set</code> dados ( <code>validation set</code> , <code>validation set</code> ), o modelo em m√©dia (mediana) √© 34% equivocado em rela√ß√£o ao pre√ßo real de transfer√™ncia.  E conseguimos apenas como resultado de v√°rias linhas de c√≥digo retiradas do tutorial. </p><br><p>  34% de erro, √© muito ou pouco?  Tudo √© relativo.  A √∫nica fonte compar√°vel, cujos dados podem ser tomados como uma " <em>previs√£o</em> " do valor da transfer√™ncia, √©, obviamente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">transfermarkt</a> .  Felizmente, existe um campo nos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">dados do kaggle</a> que mostra como este site classificou um jogador no momento da transfer√™ncia, e isso pode ser comparado.  Note-se aqui que a transfermarkt nunca alegou que seu <code>market value</code> √© o prov√°vel pre√ßo de transfer√™ncia.  Pelo contr√°rio, enfatizaram que √© o " <em>valor honesto</em> " de um ou outro jogador.  E quanto dinheiro um clube em particular pagar√° por isso em uma situa√ß√£o espec√≠fica √© uma coisa muito individual e pode flutuar em uma dire√ß√£o ou outra dentro de limites muito amplos.  Mas √© o melhor que temos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">vamos comparar</a> . </p><br><p><img src="https://habrastorage.org/webt/an/jz/4l/anjz4lvbdxlbqy5s26q8gd5_vig.png"></p><br><p>  Erro Transfermarkt - <strong>35%</strong> , nosso modelo - <strong>35%</strong> .  Muito estranho e, para ser sincero, muito desconfiado. <br>  Neste ponto, proponho pensar novamente.  Um site com uma enorme hist√≥ria, criado apenas para mostrar o `` valor '' dos jogadores, que depende do poder total do efeito multid√£o (deriva do valor das classifica√ß√µes de visitantes comuns e profissionais do mercado) e do conhecimento de especialistas, por um lado, e do modelo, que n√£o sabe nada sobre futebol, n√£o v√™ nada, exceto os dados que fornecemos (e fora desses dados no mundo real ainda existem muitas coisas que as pessoas com a transfermarkt levam em considera√ß√£o), por outro lado, eles <strong>mostram o mesmo erro</strong> .  Al√©m disso, nosso modelo tamb√©m permite prever o pre√ßo do aluguel do jogador, que o <code>market value</code> , por raz√µes √≥bvias, n√£o mostra (levando em conta essas transa√ß√µes, o resultado da transfermarkt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">foi ainda pior</a> ). </p><br><p>  Honestamente, ainda acho que tenho algum tipo de erro aqui, tudo √© bom demais para ser verdade.  Mas, no entanto, vamos al√©m. </p><br><p>  Uma maneira f√°cil de se testar √© tentar calcular as previs√µes de duas fontes (modelos e transfermarkt).  Se as previs√µes forem verdadeiramente independentes umas das outras e n√£o houver erro irritante, o resultado dever√° melhorar. </p><br><p><img src="https://habrastorage.org/webt/uu/f0/ut/uuf0uts7ak4xrbr95efffferqvu.png"></p><br><p>  De fato, a m√©dia das previs√µes reduz o erro de previs√£o para 32% (!).  Isso pode parecer um pouco, mas precisamos entender que estamos filtrando mais informa√ß√µes dos dados, que s√£o t√£o compactados ao m√°ximo. </p><br><p>  Mas o que faremos a seguir, na minha opini√£o, √© ainda mais surpreendente e interessante, embora esteja al√©m do escopo do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">tutorial fast.ai.</a> </p><br><h4 id="feature-importance">  Import√¢ncia do recurso </h4><br><p>  As redes neurais, para n√£o dizer que s√£o completamente imerecidas, s√£o frequentemente consideradas uma "caixa preta".  Sabemos quais dados podemos colocar l√°, podemos obter as previs√µes do modelo, podemos at√© avaliar o quanto essas previs√µes s√£o verdadeiras, em m√©dia.  Mas n√£o podemos explicar por quais crit√©rios o modelo "tomou" essa ou aquela decis√£o.  A estrutura interna da rede em si √© t√£o complexa e, mais importante, n√£o linear, que √© imposs√≠vel rastrear diretamente toda a cadeia de tomada de decis√£o e tirar conclus√µes significativas do mundo real a partir da√≠.  Mas realmente quero.  Eu gostaria de entender o que influencia o valor da transfer√™ncia acima de tudo. </p><br><p>  Bem, n√£o vamos subir dentro da rede.  Mas o que significa a import√¢ncia de cada campo, vamos cham√°-lo de <strong>Import√¢ncia de Recursos</strong> (FI)?  Uma op√ß√£o para entender 'import√¢ncia' √© calcular quanto as coisas piorar√£o se n√£o tivermos esse campo.  E √© exatamente isso que podemos medir.  Agora temos uma ferramenta que fornece previs√µes para qualquer conjunto de dados.  Portanto, se apenas calcularmos quanto o erro de previs√£o aumentar√° quando substituirmos dados aleat√≥rios no campo, podemos estimar quanto ele (o campo) afeta o resultado final, o que significa o quanto √© importante.  Para permanecer dentro da distribui√ß√£o real dos dados, o campo ser√° preenchido n√£o apenas com n√∫meros aleat√≥rios, mas com valores misturados aleatoriamente (ou seja, apenas misturaremos a coluna, por exemplo, 'ano de transfer√™ncia', na tabela original).  Por fidelidade, esse processo pode ser realizado v√°rias vezes para cada campo, calculando a m√©dia do resultado.  Tudo √© bem simples.  Agora vamos ver como isso d√° o resultado: </p><br><p><img src="https://habrastorage.org/webt/ou/s8/4x/ous84xjkamb1mtigicrbsublki8.png"></p><br><p>  Meu intestino diz: 'Sim e n√£o!' </p><br><p>  Por um lado, os campos que voc√™ espera ver estavam no topo: treinadores de equipe de onde e para onde <code>from_coach_name</code> jogador foi (de <code>from_coach_name</code> , para <code>to_coach_name</code> ), os pr√≥prios clubes que participaram da transfer√™ncia ( <code>from_club_name</code> , <code>to_club_name</code> ), o agente do jogador ( <code>plr_player_agent</code> ), sua fama nas redes sociais ( <code>pop_log1p</code> ) etc.  Mas por outro lado ... Intuitivamente, n√£o parece que os nomes dos treinadores devam ter mais peso no pre√ßo de transfer√™ncia do que, por exemplo, os pr√≥prios clubes (sabemos bem que o Benfica condicional √© capaz de vender seus jogadores caros).  A marca de um treinador influencia mais fortemente o pre√ßo do que a marca do clube?  A chegada do Mancini condicional for√ßa tanto o clube a pagar em excesso?  O que acontece quando os dados nos fornecem informa√ß√µes novas, um pouco contra-intuitivas, ou apenas um erro no modelo? </p><br><p>  Vamos acertar.  Com um olhar atento ao gr√°fico, o olho rapidamente se apega a uma coisa estranha.  Logo abaixo do centro, existem 2 campos de <code>trs_year</code> e <code>season</code> <code>trs_year</code> , eles representam o ano da transfer√™ncia e a esta√ß√£o em que a transi√ß√£o ser√° realizada (em geral, eles podem n√£o coincidir, embora isso n√£o ocorra com tanta frequ√™ncia).  Em primeiro lugar, parece que eles devem ser mais altos, sabemos quanto os pre√ßos dos jogadores de futebol subiram nos √∫ltimos anos e, em segundo lugar, obviamente significam a mesma coisa.  O que fazer sobre isso?  Apenas resuma sua import√¢ncia?  N√£o √© o fato de que isso pode ser feito!  Mas o que definitivamente podemos fazer √© aplicar a mesma abordagem (misturando valores) n√£o separadamente nesses dois campos, mas como um grupo.  Ou seja, me√ßa como o erro ser√° alterado se houver valores aleat√≥rios nessas 2 colunas de uma s√≥ vez.  Bem, desde que fazemos isso ao longo dos anos, precisamos ver se temos outros campos t√£o "conectados". </p><br><p>  Por exemplo, para um clube, temos v√°rios par√¢metros: o pr√≥prio clube ( <code>club_name</code> do clube), bem como um conjunto de informa√ß√µes sobre ele - de qual liga, pa√≠s etc.  ( <code>club_is_first_team</code> , <code>clb_lg_name</code> , <code>clb_lg_country</code> , <code>clb_lg_group</code> ).  Somente em alguns casos, estamos interessados ‚Äã‚Äãem saber quanto isso afeta o pre√ßo, por exemplo, o pa√≠s para o qual o jogador vai separadamente ( <code>clb_lg_country</code> ). Na maioria das vezes, √© importante entendermos qual √© o peso total do campo 'clube', que j√° est√° em um determinado pa√≠s, liga etc. . </p><br><p>  Assim, podemos combinar todos os campos em grupos de acordo com o conte√∫do sem√¢ntico.  Isso nos ajudar√° apenas como conhecimento da √°rea de assunto e senso comum, bem como a 'proximidade' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">calculada</a> dos recursos.  O √∫ltimo mostra apenas como os campos se correlacionam, ou seja, quanto √© poss√≠vel consider√°-los como um √∫nico grupo. </p><br><p>  Aplicando essa abordagem, obtemos um gr√°fico ainda mais intuitivo da import√¢ncia dos campos: </p><br><p><img src="https://habrastorage.org/webt/gu/mc/ma/gumcmafyqlu-ognduuxghf02xww.png"></p><br><p>  L√° vai voc√™.  Exatamente o clube que o jogador mais compra afeta o valor da transfer√™ncia, com uma margem muito boa.  Oi Man City, Barcelona, ‚Äã‚ÄãZenit e, por exemplo, o mesmo Benfica (afinal, " <em>influencia fortemente</em> " a mesma coisa sobre o fato de que alguns clubes, pelo contr√°rio, conseguem comprar jogadores de qualidade mais baratos que o "mercado").  Parece-me que o mais interessante ao trabalhar com dados √© que, quando obtidos, as conclus√µes s√£o √≥bvias, por um lado (bem, eu duvidava que o comprador do clube tivesse a influ√™ncia mais poderosa sobre o valor da transfer√™ncia) e, por outro lado, √© um pouco surpreendente (e os candidatos pela primeira vez). intuitivamente, o local poderia ser um pouco, e a separa√ß√£o do segundo n√£o parecia t√£o significativa) </p><br><p>  Ainda h√° muitas coisas interessantes para descobrir.  Por exemplo, o nome do treinador de onde o jogador √© comprado, do ponto de vista do modelo, ainda √© mais importante que o clube ... Deixe a diferen√ßa ser bastante reduzida.  Uma explica√ß√£o l√≥gica para isso pode ser encontrada em princ√≠pio (embora √†s vezes possa ser encontrada para qualquer coisa).  Existem treinadores (Guardiola, Klopp, Benitez, Berdyev) que aderem a uma certa ideologia do jogo em clubes diferentes, o que melhor revela ou vice-versa torna determinadas posi√ß√µes no campo menos brilhantes e a visibilidade do jogador afeta muito seu pre√ßo.  Sobre clubes, por assim dizer, quase imposs√≠vel.  E o fato de vermos treinadores que n√£o se afastam radicalmente de seus princ√≠pios de jogo com muito mais frequ√™ncia do que os clubes trocando de treinador, mas que permanecem dentro da mesma filosofia (por exemplo, de improviso, exceto que o Ajax vem √† mente e o Barcelona √© muito question√°vel), fala de que, talvez, certos gerentes revelem jogadores mais est√°veis ‚Äã‚Äãque os clubes.  Embora aqui n√£o me apegue fortemente √† minha afirma√ß√£o. </p><br><p>  Dos indicadores puramente estat√≠sticos, o valor mais alto √© simplesmente o tempo que um jogador passou em campo no ano passado em sua competi√ß√£o principal ( <code>stats_minutes_0</code> ).  Isso √© bastante l√≥gico, porque o quanto esse jogador foi o ‚Äúprincipal‚Äù em seu clube na √∫ltima temporada parece um indicador estat√≠stico mais universal de seu sucesso do que outros - por exemplo, o n√∫mero de gols marcados ou cart√µes recebidos. </p><br><p>  A popularidade do jogador ( <code>pop_log1p</code> ) fecha esse grupo dos 8 par√¢metros mais importantes.  Vale lembrar que os dados que apresentamos nos √∫ltimos 10 anos.  Eu acho que a import√¢ncia desse campo seria maior se estiv√©ssemos considerando os √∫ltimos 5 anos, e para o valor m√©dio da √∫ltima d√©cada esse √© um resultado completamente compreens√≠vel, especialmente se levarmos em conta a diferen√ßa do pr√≥ximo lugar. </p><br><p>  Bem, a √∫ltima coisa que gostaria de chamar a aten√ß√£o √© a import√¢ncia do campo do agente ( <code>plr_player_agent</code> ).  Deixarei isso sem coment√°rios, porque, se voc√™ pode quebrar as margens das c√≥pias em disputas sobre a (des) necessidade de agentes, n√£o h√° d√∫vida sobre o grau de sua influ√™ncia no mercado de transfer√™ncias moderno (embora o modelo sugira n√£o superestim√°-lo). </p><br><p><img src="https://habrastorage.org/webt/q2/al/i5/q2ali5al_krkgtsmdkn_mw5i6na.jpeg"></p><br><p>  A prop√≥sito, talvez a coisa mais interessante nesse m√©todo de an√°lise seja sua acessibilidade: n√£o √© necess√°rio criar <em>um</em> modelo ‚Äú <em>ideal</em> ‚Äù para obter informa√ß√µes sobre a import√¢ncia dos par√¢metros.  Em muitos casos, basta prever, no m√≠nimo, que seja estatisticamente significativamente diferente de jogar uma moeda, e voc√™ <em>j√°</em> obt√©m resultados que geralmente cont√™m informa√ß√µes interessantes ou informam de que lado novo voc√™ pode ver os dados. </p><br><p>  Chegou a hora de terminar, para n√£o aumentar o texto t√£o sobrecarregado.  Ao me despedir, gostaria de pedir novamente a todos os interessados ‚Äã‚Äãno t√≥pico que experimentem (o melhor, na minha opini√£o, para iniciantes) o curso Deep Learning - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">fast.ai</a> e apliquem o conhecimento adquirido em 'seu campo de atua√ß√£o', √© prov√°vel que voc√™ seja o primeiro a chegar :) </p><br><p>  E, se voc√™ gostar, tentarei dominar a segunda parte do texto sobre minhas experi√™ncias nas quais o modelo usando uma ferramenta igualmente poderosa - <strong>Depend√™ncia Parcial</strong> dir√° a voc√™: qual cliente da ag√™ncia √© melhor para se tornar jogador de futebol, quais clubes t√™m a pol√≠tica de transfer√™ncia mais eficaz, qual treinador aumenta melhor o custo dos jogadores (al√©m dos candidatos √≥bvios, existem muitas 'marcas' n√£o t√£o promovidas que claramente valem uma olhada mais de perto) e muito mais. </p><br><p>  Parte 2 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modelo de transfer√™ncias de futebol: cavando mais fundo</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt468107/">https://habr.com/ru/post/pt468107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt468089/index.html">Redefini√ß√£o baseada em edi√ß√£o: √© poss√≠vel na produ√ß√£o?</a></li>
<li><a href="../pt468091/index.html">O projeto de lei sobre a cria√ß√£o de um √∫nico banco de dados com os dados dos cidad√£os adotados na Duma do Estado em primeira leitura</a></li>
<li><a href="../pt468093/index.html">Nitratos nos produtos: lojas su√≠√ßas vs lojas russas vs casa de ver√£o</a></li>
<li><a href="../pt468097/index.html">Microsoft Edge - XSS gen√©rico</a></li>
<li><a href="../pt468099/index.html">C / C ++ de Python (CFFI, pybind11)</a></li>
<li><a href="../pt468109/index.html">Dizem que Samara √© uma cidade de Javists, mas estamos conduzindo um mitap PHP l√°</a></li>
<li><a href="../pt468111/index.html">PSD2 - chute para bancos</a></li>
<li><a href="../pt468117/index.html">Ethernet, FTP, Telnet, HTTP, Bluetooth - o b√°sico da an√°lise de tr√°fego. Resolvendo problemas em uma rede com r0ot-mi. Parte 1</a></li>
<li><a href="../pt468121/index.html">Como n√£o me tornei programador aos 35 anos</a></li>
<li><a href="../pt468125/index.html">Anima√ß√£o em Ass√≠ntota</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>