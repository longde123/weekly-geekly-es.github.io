<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙆 👩‍🍳 💆🏽 Menemukan formula untuk transisi tanpa rasa sakit ke .Net Core 🕺🏿 ⚠️ 🙌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Untuk semuanya, 50 cangkir kopi sudah cukup. 


 Selain aturan praktis yang diuraikan di atas, kami menerbitkan catatan singkat tentang poin-poin yang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menemukan formula untuk transisi tanpa rasa sakit ke .Net Core</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/422441/"><p>  Untuk semuanya, 50 cangkir kopi sudah cukup. </p><br><p>  Selain aturan praktis yang diuraikan di atas, kami menerbitkan catatan singkat tentang poin-poin yang perlu diperhatikan agar tidak ada yang pecah dalam pertempuran dan dalam proses.  Catatan itu dibuat dalam pengejaran tentang rilis layanan seluler yang sepenuhnya bermigrasi ke .Net Core (awalnya ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> ).  Kami berhasil melakukan operasi ini tanpa disadari oleh pelanggan, hampir tanpa menghentikan proses pengembangan utama. </p><br><p>  Di bawah ini adalah rencana aksi yang sudah jadi, akan ada daftar tes yang sangat luas, gambar ini akan ada di sini untuk suasana hati: </p><br><p><img src="https://habrastorage.org/webt/pt/yp/6s/ptyp6szarkzymkgf34tz0ide3r8.jpeg"></p><a name="habracut"></a><br><h3 id="itak-po-shagam">  Jadi, dalam langkah-langkah: </h3><br><h4 id="1-zaplanirovat-dlinnyy-sprint-s-bolshimi-fichami-iili-regressom">  1. Rencanakan sprint panjang dengan fitur besar dan / atau regresi </h4><br><p>  Dengan penulisan ulang kode mendasar, layanan akan membutuhkan waktu untuk mendesak selama mungkin agar memiliki waktu untuk memperbaiki semua kelemahan pada lingkungan pengujian. </p><br><h4 id="2-v-akkurat-k-sprintu-perepisat-kod-na-net-core">  2. Pada sprint yang tepat untuk menulis ulang kode pada .Net Core </h4><br><p>  Mengapa penting untuk tidak memulai bisnis ini sebelumnya?  Karena Anda harus menarik dua cabang kode dengan .net baru dan lama, karena kapan pun burung yang mendesak dapat terbang atau Anda perlu melakukan demo fitur baru, dan kemudian Anda perlu melakukan perubahan pada cabang stabil lama.  Untuk mengalami keprihatinan minimal tentang hal ini, lebih baik mempersingkat momen kondisi transisi. </p><br><p>  Ngomong-ngomong, ketika bekerja dengan kode, kami dengan cepat sampai pada kesimpulan bahwa lebih baik menyimpan dua salinan repositori secara lokal.  Lebih mudah dan lebih nyaman daripada mengganti dua cabang besar. </p><br><ul><li>  Jika memungkinkan, tulis ulang antarmuka WCF di webapi dalam layanan yang digunakan </li></ul><br><p>  Implementasi .Net Core dari klien WCF masih jauh dari ideal.  Terlepas dari kenyataan bahwa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">luka</a> lama dalam beberapa cara diperbaiki, dalam versi baru Anda masih harus menggunakan solusi ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2</a> ). </p><br><blockquote>  Untuk cerita: di .Net Core 2.0, versi stabil WCF adalah 4.4.2 dari repositori myget.  Dia, misalnya, tidak memiliki masalah dengan batas waktu lebih awal </blockquote><p>  Di awal migrasi, kami menggunakan versi .Net Core 2.0.  Sementara itu, Microsoft telah merilis .Net Core 2.1.  Siapa yang tertarik untuk mengagumi keberhasilan orang-orang Redmond dalam mengoptimalkan platform, silakan baca apa kemajuan yang dibuat mesin pencari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bing</a> ketika meningkatkan ke versi baru (spoiler: latensi turun 34%!) </p><br><p>  Kami juga meningkatkan ke .Net Core 2.1 dan WCF 4.5.3.  Dan kami tidak lupa untuk menentukan di Dockerfile basis microsoft / dotnet image baru: 2.1-aspnetcore-runtime.  Apa yang mengejutkan ketika, alih-alih 1.4GB, mereka melihat ukuran gambar 0,5GB (kita berbicara tentang gambar Windows, jika tiba-tiba). </p><br><h4 id="3-zadeploit-na-test-i-demo">  3. Bersiap untuk tes dan demo </h4><br><p>  Kami memiliki dua lingkungan yang tersedia.  Kami meninggalkan demo dengan versi lama sebagai referensi.  Layanan baru dikerahkan ke lingkungan pengujian - dijalankan pada pengembang dan penguji. </p><br><p> Ada beberapa kebingungan karena fakta bahwa pengembang biasanya bekerja dengan tes, dan penguji terutama dengan demo.  Jika perlu untuk menyegarkan kembali layanan yang lama, situasinya persis kebalikan dari yang normal.  Karenanya, diskusi dan lembar contekan tentang di mana dan apa yang harus dicari berguna. </p><br><ul><li>  Konfigurasikan IIS </li></ul><br><p>  Untuk menjalankan layanan .Net Core di IIS, Anda harus menginstal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul</a> yang menyertai runtime. </p><br><p>  AppPool beralih ke CLR Runtime = Tidak Ada Kode yang Dikelola. </p><br><p>  Dalam solusi di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">web.config</a> standar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">,</a> penting untuk tidak lupa mengatur requestTimeout yang diinginkan dan menonaktifkan modul WebDAV, jika ada metode DELETE. </p><br><p>  Lebih lanjut, ada dua opsi untuk menerbitkan layanan di IIS: </p><br><ul><li>  Anda melakukan sinkronisasi MSDeploy - itu berarti Anda juga perlu beralih -enableRule: AppOffline </li><li>  Anda mempublikasikan file - itu artinya tepat sebelum publikasi Anda harus meletakkan file app_offline.htm di direktori layanan, dan setelah publikasi hapus </li></ul><br><p>  Baik itu, dan yang lain memungkinkan untuk menghentikan proses kerja dan untuk membuka file yang dapat dieksekusi.  Jika tidak, akan terjadi kesalahan bahwa file tidak tersedia untuk ditimpa. </p><br><blockquote>  Kami menolak logging melalui Nlog yang mendukung Serilog, dan kehilangan kompresi log otomatis - di Serilog tidak ada fitur seperti itu.  Dalam hal ini, Anda dapat disimpan menggunakan alat Windows biasa dan menginstal kompresi NTFS di properti direktori. </blockquote><br><h4 id="4-protestirovat">  4. Tes </h4><br><p>  Berikut adalah daftar periksa paling menyusut untuk tempat-tempat yang paling rapuh: </p><br><ul><li>  periksa kembalinya kode status Permintaan buruk, Tidak Sah, Tidak diubah, Tidak ditemukan - semua yang dapat diberikan API </li><li>  periksa permintaan login untuk semua kode status </li><li>  membuat diagram ketergantungan eksternal;  sebagai aturan, semua informasi yang diperlukan ada di pengaturan aplikasi <br><ul><li>  usir metode yang memengaruhi pekerjaan mereka </li><li>  periksa pencatatan permintaan eksternal </li></ul></li><li>  periksa fungsi pengaturan untuk parameter pengaturan aplikasi;  coba ubah mereka menjadi panas </li><li>  periksa caching http untuk kode status positif dan negatif <br><ul><li>  Header ETag </li><li>  kontrol cache header </li></ul></li><li>  periksa permintaan lama dan batas waktu </li><li>  periksa permintaan dengan jawaban kosong </li><li>  periksa metode DELETE (WebDAV dinonaktifkan atau tidak) </li><li>  periksa pekerjaan dengan konten mentah <br><ul><li>  unggah dan unduh satu / beberapa file </li><li>  unggah file dengan ukuran di atas batas </li><li>  tata letak header Content-Disposition </li></ul></li><li>  periksa semua tajuk lainnya;  menempatkan semuanya dalam kode cukup mudah </li><li> periksa eksekusi kode kondisional ketika berpindah lingkungan <code>if (env.IsDevelopment())</code> </li><li>  periksa putuskan sambungan dari klien dan server </li><li>  bandingkan dengan standar swagger.json - akan membantu mendeteksi perbedaan dalam bidang yang ditransmisikan <br><blockquote>  Aplikasi seluler kami menggunakan generator kode untuk bekerja dengan API berdasarkan deskripsi swagger.json, jadi penting bahwa perbedaan dari deskripsi asli minimal.  Dalam versi terbaru dari Swashbuckle.AspNetCore, antarmuka dan swagger.json yang dihasilkan telah banyak berubah.  Saya harus memutar kembali ke versi lusuh Swashbuckle.AspNetCore 1.2.0 dan menambahkan beberapa filter. <br></blockquote></li></ul><br><h4 id="5-zadeploit-na-boy-popivaya-kofeek">  5. Pelana untuk berkelahi sambil minum kopi </h4><br><p>  Dalam kasus kami, lingkungan tempur terdiri dari dua node: aktif dan pasif. <br>  Agar peralihan ke layanan baru terjadi tanpa disadari, kami menggandakan kumpulan dan situs pada setiap node, dan menulis skrip untuk mengalihkan ikatan antara yang lama dan situs yang baru. </p><br><p>  Jadi, jika terjadi keadaan darurat, kami dapat dengan cepat beralih ke versi yang lama. </p><br><p>  Selanjutnya, setelah penyebaran ke pertempuran, dalam waktu seminggu kami menjadi yakin akan kelayakan layanan dan menyalakan lampu hijau untuk rilis aplikasi mobile.  Kehidupan di proyek dengan aman kembali ke program sebelumnya. </p><br><h3 id="promezhutochnyy-itog">  Subtotal </h3><br><p>  Sekarang layanan kami sepenuhnya siap untuk menumbuhkan wadah buruh pelabuhan untuk pengiriman ke cluster.  Kami siap untuk ditempatkan di Kubernetes dan Service Fabric. </p><br><p>  Sekarang persiapan sedang dilakukan untuk penyajian infrastruktur baru kepada pelanggan.  Kami akan menceritakan tentang pencapaian kami di seri berikutnya, jaga terus denyut nadi Anda;) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id422441/">https://habr.com/ru/post/id422441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id422431/index.html">Peri Jepang menunjukkan pemicu master-slave dalam manga baru pada elektronik digital</a></li>
<li><a href="../id422433/index.html">Panel surya dan jalan aspal. Simbiosis teknologi</a></li>
<li><a href="../id422435/index.html">Timer - Mulai</a></li>
<li><a href="../id422437/index.html">Game pengalaman pengguna dan kecepatan situs web dan aplikasi</a></li>
<li><a href="../id422439/index.html">Pertarungan dengan Yandex: bagaimana saya menghabiskan lebih dari setahun untuk membawa situs ke puncak</a></li>
<li><a href="../id422443/index.html">Timer Tepat Corona SDK</a></li>
<li><a href="../id422445/index.html">Implementasi BottomAppBar. Bagian 3: Perilaku untuk Android</a></li>
<li><a href="../id422447/index.html">bytes.Buffer in Go: optimasi yang tidak berfungsi</a></li>
<li><a href="../id422449/index.html">Senator versus Amazon: apa yang telah dilakukan toko online</a></li>
<li><a href="../id422451/index.html">Untuk mendengarkan tentang pemasaran game dan tentang tempat penulis skenario di industri game pada 26 September di VShBI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>