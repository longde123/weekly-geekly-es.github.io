<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚öïÔ∏è üë®üèΩ‚Äç‚öñÔ∏è üöΩ Composants fonctionnels avec React Hooks. Pourquoi c'est mieux? üëµüèΩ üêÇ üå©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque React.js 16.8 a √©t√© publi√©, nous avons eu l'occasion d'utiliser React Hooks. Les crochets nous permettent d'√©crire des composants enti√®rement ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Composants fonctionnels avec React Hooks. Pourquoi c'est mieux?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443500/"><p>  Lorsque React.js 16.8 a √©t√© publi√©, nous avons eu l'occasion d'utiliser React Hooks.  Les crochets nous permettent d'√©crire des composants enti√®rement fonctionnels √† l'aide de fonctions.  Nous pouvons utiliser toutes les fonctionnalit√©s de React.js et le faire de mani√®re plus pratique. </p><br><p>  Beaucoup de gens ne sont pas d'accord avec la conception de Hooks.  Dans cet article, je voudrais parler de certains avantages importants que React Hooks vous offre et pourquoi nous devons √©crire avec Hooks. </p><br><p>  Je ne parlerai pas de l'utilisation des crochets.  Ce n'est pas tr√®s important pour les exemples.  Si vous souhaitez lire quelque chose sur ce sujet, vous pouvez utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la documentation officielle</a> .  De plus, si ce sujet vous int√©resse, je vous en dirai plus sur Hooks. </p><a name="habracut"></a><br><h2 id="hooks-allow-us-to-reuse-our-code-easily">  Les crochets nous permettent de r√©utiliser facilement notre code </h2><br><p>  Imaginons un composant rendant une forme simple.  Cela peut √™tre quelque chose qui nous montre quelques entr√©es et nous permet de changer ses valeurs. </p><br><p>  Avec la notation de classe, il y aura quelque chose comme ceci: </p><br><pre><code class="plaintext hljs">class Form extends React.Component { state = { // Fields values fields: {}, }; render() { return ( &lt;form&gt; {/* Inputs render */} &lt;/form&gt; ); }; }</code> </pre> <br><p>  Imaginons maintenant que nous voulons enregistrer automatiquement nos valeurs de champs dans un backend chaque fois qu'elles changent.  Je sugg√®re de sauter la d√©finition des fonctions externes comme <code>shallowEqual</code> et <code>shallowEqual</code> . </p><br><pre> <code class="plaintext hljs">class Form extends React.Component { constructor(props) { super(props); this.saveToDraft = debounce(500, this.saveToDraft); }; state = { // Fields values fields: {}, // Draft saving meta draft: { isSaving: false, lastSaved: null, }, }; saveToDraft = (data) =&gt; { if (this.state.isSaving) { return; } this.setState({ isSaving: true, }); makeSomeAPICall().then(() =&gt; { this.setState({ isSaving: false, lastSaved: new Date(), }) }); } componentDidUpdate(prevProps, prevState) { if (!shallowEqual(prevState.fields, this.state.fields)) { this.saveToDraft(this.state.fields); } } render() { return ( &lt;form&gt; {/* Draft saving meta render */} {/* Inputs render */} &lt;/form&gt; ); }; }</code> </pre> <br><p>  Le m√™me composant avec des crochets: </p><br><pre> <code class="plaintext hljs">const Form = () =&gt; { // Our state const [fields, setFields] = useState({}); const [draftIsSaving, setDraftIsSaving] = useState(false); const [draftLastSaved, setDraftLastSaved] = useState(false); useEffect(() =&gt; { const id = setTimeout(() =&gt; { if (draftIsSaving) { return; } setDraftIsSaving(true); makeSomeAPICall().then(() =&gt; { setDraftIsSaving(false); setDraftLastSaved(new Date()); }); }, 500); return () =&gt; clearTimeout(id); }, [fields]); return ( &lt;form&gt; {/* Draft saving meta render */} {/* Inputs render */} &lt;/form&gt; ); }</code> </pre> <br><p>  Comme nous le voyons, il n'y a pas de grande diff√©rence ici.  Nous avons remplac√© <code>this.state</code> par le crochet <code>useState</code> et enregistr√© le brouillon dans le crochet <code>useEffect</code> maintenant. </p><br><p>  La diff√©rence que je veux montrer ici est (il y a aussi d'autres diff√©rences, mais je vais me concentrer sur celle-ci): nous pouvons facilement extraire ce code de notre composant et l'utiliser ailleurs: </p><br><pre> <code class="plaintext hljs">// useDraft hook can be used in any other component const useDraft = (fields) =&gt; { const [draftIsSaving, setDraftIsSaving] = useState(false); const [draftLastSaved, setDraftLastSaved] = useState(false); useEffect(() =&gt; { const id = setTimeout(() =&gt; { if (draftIsSaving) { return; } setDraftIsSaving(true); makeSomeAPICall().then(() =&gt; { setDraftIsSaving(false); setDraftLastSaved(new Date()); }); }, 500); return () =&gt; clearTimeout(id); }, [fields]); return [draftIsSaving, draftLastSaved]; } const Form = () =&gt; { // Our state const [fields, setFields] = useState({}); const [draftIsSaving, draftLastSaved] = useDraft(fields); return ( &lt;form&gt; {/* Draft saving meta render */} {/* Inputs render */} &lt;/form&gt; ); }</code> </pre> <br><p>  Et nous pouvons utiliser le crochet <code>useDraft</code> dans d'autres composants!  C'est, bien s√ªr, un exemple tr√®s simple, mais la r√©utilisation de code est assez importante pour cela et l'exemple montre √† quel point c'est facile avec Hooks. </p><br><h2 id="hooks-allow-us-to-write-component-in-more-intuitive-way">  Les crochets nous permettent d'√©crire des composants de mani√®re plus intuitive </h2><br><p>  Imaginons un rendu de composant de classe, par exemple, un √©cran de discussion, une liste de discussions et un formulaire de message.  Comme √ßa: </p><br><pre> <code class="plaintext hljs">class ChatApp extends React.Component { state = { currentChat: null, }; handleSubmit = (messageData) =&gt; { makeSomeAPICall(SEND_URL, messageData) .then(() =&gt; { alert(`Message is sent to chat ${this.state.currentChat}`); }); }; render() { return ( &lt;Fragment&gt; &lt;ChatsList changeChat={currentChat =&gt; { this.setState({ currentChat }); }} /&gt; &lt;CurrentChat id={currentChat} /&gt; &lt;MessageForm onSubmit={this.handleSubmit} /&gt; &lt;/Fragment&gt; ); }; }</code> </pre> <br><p>  Imaginez ensuite notre utilisateur utilisant ce composant de chat: </p><br><ul><li>  Ils ouvrent le chat 1 </li><li>  Ils envoient un message (imaginons un r√©seau lent) </li><li>  Ils ouvrent le chat 2 </li><li>  Ils voient une alerte concernant leur message: <br><ul><li>  "Le message est envoy√© au chat 2" </li></ul></li></ul><br><p>  Mais ils ont envoy√© un message au deuxi√®me chat, comment cela s'est-il pass√©?  C'est parce que la m√©thode de classe fonctionne avec la valeur actuelle, pas la valeur que nous avions lorsque nous commencions une demande de message.  Ce n'est pas grave avec des composants simples comme celui-ci, mais cela peut √™tre une source de bugs dans des syst√®mes plus complexes. </p><br><p>  En revanche, les composants fonctionnels agissent d'une autre mani√®re: </p><br><pre> <code class="plaintext hljs">const ChatApp = () =&gt; { const [currentChat, setCurrentChat] = useState(null); const handleSubmit = useCallback( (messageData) =&gt; { makeSomeAPICall(SEND_URL, messageData) .then(() =&gt; { alert(`Message is sent to chat ${currentChat}`); }); }, [currentChat] ); render() { return ( &lt;Fragment&gt; &lt;ChatsList changeChat={setCurrentChat} /&gt; &lt;CurrentChat id={currentChat} /&gt; &lt;MessageForm onSubmit={handleSubmit} /&gt; &lt;/Fragment&gt; ); }; }</code> </pre> <br><p>  Imaginons notre utilisateur: </p><br><ul><li>  Ils ouvrent le chat 1 </li><li>  Ils envoient un message (imaginons un r√©seau lent) </li><li>  Ils ouvrent le chat 2 </li><li>  Ils voient une alerte concernant leur message: <br><ul><li>  "Le message est envoy√© au chat 1" </li></ul></li></ul><br><p>  Eh bien, qu'est-ce qui a chang√©?  Maintenant, nous travaillons avec une valeur, captur√©e au moment du rendu.  Nous cr√©ons un nouveau <code>handleSubmit</code> chaque fois que <code>currentChat</code> change.  Cela nous permet d'oublier les changements futurs et d'y penser <strong>maintenant</strong> . </p><br><p>  <em>Chaque composant rend la capture de tout ce qu'il utilise</em> . </p><br><h2 id="hooks-make-components-lifecycle-gone">  Les crochets font dispara√Ætre le cycle de vie des composants </h2><br><p>  Cette raison recoupe fortement la pr√©c√©dente.  React est une biblioth√®que d'interface utilisateur d√©clarative.  La d√©clarativit√© rend la cr√©ation et le traitement de l'interface utilisateur beaucoup plus faciles.  Cela nous permet d'oublier les changements imp√©ratifs du DOM. </p><br><p>  M√™me ainsi, lorsque nous utilisons des classes, nous sommes confront√©s au cycle de vie des composants.  Cela ressemble √† ceci: </p><br><ul><li>  Montage </li><li>  Mise √† jour (chaque fois que l' <code>state</code> ou les <code>props</code> changent) </li><li>  D√©montage </li></ul><br><p>  Cela semble pratique mais je l'ai convaincu uniquement √† cause de nos habitudes.  Ce n'est pas comme React. </p><br><p>  Au lieu de cela, les composants fonctionnels nous permettent d'√©crire le code des composants et d'oublier le cycle de vie.  Nous ne pensons qu'√† la <em>synchronisation</em> .  Nous √©crivons la fonction rend notre interface utilisateur √† partir des accessoires d'entr√©e et de l'√©tat int√©rieur. </p><br><p>  Au d√©but, le crochet <code>useEffect</code> semble remplacer le <code>componentDidMount</code> , le <code>componentDidUpdate</code> et d'autres m√©thodes de cycle de vie.  Mais ce n'est pas comme √ßa.  Lorsque nous utilisons <code>useEffect</code> nous avons dit √† React: "H√©, faites ceci apr√®s avoir rendu mon composant". </p><br><p>  Voici un bon exemple du grand <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article sur useEffect</a> : </p><br><ul><li>  <strong>R√©agissez:</strong> donnez-moi l'interface utilisateur lorsque l'√©tat est <code>0</code> . </li><li>  <strong>Votre composant:</strong> <br><ul><li>  Voici le r√©sultat du rendu: <code>&lt;p&gt;You clicked 0 times&lt;/p&gt;</code> . </li><li>  N'oubliez pas non plus d'ex√©cuter cet effet une fois que vous avez termin√©: <code>() =&gt; { document.title = 'You clicked 0 times' }</code> . </li></ul></li><li>  <strong>R√©agissez:</strong> Bien s√ªr.  Mise √† jour de l'interface utilisateur.  H√© navigateur, j'ajoute des trucs au DOM. </li><li>  <strong>Navigateur:</strong> Cool, je l'ai peint √† l'√©cran. </li><li>  <strong>R√©agissez:</strong> OK, je vais maintenant ex√©cuter l'effet que vous m'avez donn√©. <br><ul><li>  Running <code>() =&gt; { document.title = 'You clicked 0 times' }</code> . </li></ul></li></ul><br><p>  C'est beaucoup plus d√©claratif, n'est-ce pas? </p><br><h2 id="in-closing">  En conclusion </h2><br><p>  React Hooks nous permet de nous d√©barrasser de quelques probl√®mes et de faciliter le d√©veloppement.  Nous avons juste besoin de changer notre mod√®le mental.  Le composant fonctionnel est en fait une fonction de l'interface utilisateur des accessoires.  Ils d√©crivent comment tout cela doit √™tre √† tout moment et nous aident √† oublier les changements. </p><br><p>  Eh bien, nous devons apprendre √† l'utiliser, mais bon, avez-vous √©crit correctement les composants d'une classe la premi√®re fois? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr443500/">https://habr.com/ru/post/fr443500/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr443486/index.html">ReLEx SMILE: Comment ne pas se tromper de pr√©visions</a></li>
<li><a href="../fr443490/index.html">Pourquoi suis-je en train de r√©duire mon travail sur Debian</a></li>
<li><a href="../fr443492/index.html">Un jeu pour les amoureux et les experts sur Linux</a></li>
<li><a href="../fr443494/index.html">Guide: Comment lancer un produit SaaS sur AppSumo - Succ√®s et quelques erreurs</a></li>
<li><a href="../fr443498/index.html">Flightradar24 - comment √ßa marche? Partie 2, Protocole ADS-B</a></li>
<li><a href="../fr443502/index.html">Pourquoi il y a exactement 4 ans, la NASA a tir√© sur le ciel nocturne de Cap Canaveral avec la fus√©e Atlas V?</a></li>
<li><a href="../fr443504/index.html">Le World Wide Web a trente ans - que va-t-il lui arriver ensuite?</a></li>
<li><a href="../fr443506/index.html">Analyseur simple pour YouTube dans Google Tables</a></li>
<li><a href="../fr443508/index.html">Jeux de soci√©t√© √©ducatifs pour les programmeurs</a></li>
<li><a href="../fr443510/index.html">Ordinateur portable Compaq Armada 7700 - en tant que d√©veloppement de la gamme Compaq LTE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>