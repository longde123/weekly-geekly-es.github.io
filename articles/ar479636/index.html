<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ธ ๐ ๐ฝ ูููุฉ ุงูููุงุญุฉ ุงูุฎุงุตุฉ. ุฃูุถู ูู ุฑูุณุ โฑ๏ธ ๐ผ๐ฝ ๐ง๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฐู ูู ุงูููุงูุฉ ุงูุซุงููุฉ ููุฑูู setUP ุญูู ุชุฌุฑุจุชูุง ูู ุฅูุดุงุก ุฑูุจูุชุงุช ูุณุชููุฉ ููุณุงุจูุงุช Eurobot Open ูุงุณุชุฎุฏุงู ROS ููุฐุง ุงูุบุฑุถ. 

 ุงูููุงูุฉ ุงูุฃููู ุนู ุงููููุงูููุง ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูููุฉ ุงูููุงุญุฉ ุงูุฎุงุตุฉ. ุฃูุถู ูู ุฑูุณุ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479636/" style=";text-align:right;direction:rtl"> ูุฐู ูู ุงูููุงูุฉ ุงูุซุงููุฉ ููุฑูู setUP ุญูู ุชุฌุฑุจุชูุง ูู ุฅูุดุงุก ุฑูุจูุชุงุช ูุณุชููุฉ ููุณุงุจูุงุช Eurobot Open ูุงุณุชุฎุฏุงู ROS ููุฐุง ุงูุบุฑุถ. <br><br>  <a href="https://habr.com/ru/post/478836/">ุงูููุงูุฉ ุงูุฃููู ุนู ุงููููุงูููุง ูุงูููุฏุณุฉ ุงูุนุงูุฉ ููุฑูุจูุชุงุช.</a> <br><br>  ุชูุชูู ุงูุฑูุจูุชุงุช ุฅูู ุฃุฑุถ ูุณุชููุฉ ูุชูุนุฑู ูุนุธู ุงูุนูุจุงุช ููุฏููุง ุ ููุน ุฐูู ุ ูููู ูููุนุงุฑุถูู ุงูุฎุจูุซูู ูุญุงููุฉ ุณุฑูุฉ ููุงุฑุฏูุง (ููุฑูุฏ ุฃุญูุงููุง ุชูุงูู ุจุถุน ุนุดุฑุงุช ูู ุงูููุงุท ุงูุฅุถุงููุฉ) ุ ุจูููุง ูุฑูุฏ ุงูููุงุฏุฉ ุฅูู ุงูููุทุฉ ุงููุทููุจุฉ ุจุฃุณุฑุน ูุง ูููู ูุนุฏู ููุณ ุงูุนูุจุงุช.  ูู ูุงููุฑุง ุฎุงุฑุฌูุฉ ูู ุงูููุฏุงู ุ ูุญุตู ุนูู ุจูุงูุงุช ุญูู ูููุน ุงูุนุฏู ููุนุฑู ุฃูู ูู ุงูุขู.  ููุน ุฐูู ุ ูุง ูููู ูุนุฑูุฉ ููููู - ูุฌุจ ุฃู ุชููู ูุงุฏุฑูุง ุนูู ุงุณุชุฎุฏุงู ูุฐู ุงููุนูููุงุช. <br><br>  ุณูุญุงูู ุงูููู ุงูููุงุฏุฉ ูู ุงูููุทุฉ "ุฃ" ุฅูู ุงูููุทุฉ "ุจ" ุฏูู ุงูุณูุฑ ุนูู ุฐูู ูุทุฉ ุณูุทุช ูุงุฆูุฉ ุนูู ุงูุญูู.  ุนูู ูุฌู ุงูุฎุตูุต ุ ุณูุดุฑุญ ููู ูุจูู ุทุฑูููุง ููุชุญูู ูู ุณุฑุนุฉ ุงูุฑูุจูุช ุ ูุถูุงู ุนู ููููุฉ ุจุฏุก ุชุดุบูู ูู ุดูุก ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจูุง. <br><br><img src="https://habrastorage.org/webt/om/x0/a6/omx0a6wfefbht9c1pialld-9vqy.png"><br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ูุญุงููุฉ ุงูุญุตูู ุนูู ุงููููู ูู ุงูุฏูุงุก </h3><br>  ุนูุฏ ุญู ูุฐู ุงููุดููุฉ ุ ููููู ุฃู ุชุฃุฎุฐ ููุงุฏ ุฌุงูุฒุฉ ููุชูุจุฉ ุจูุงุณุทุฉ ูุญุชุฑููู ุ ููู ูููู ููุงู ุนุฐุงุจ ููุง ุงุฎุชุฑุงุน ูู "ุงูุฏุฑุงุฌุฉ" ุงูุชุงููุฉ.  ุงุณุชุฎุฏููุง ููุตุฉ ูุชุนุฏุฏุฉ ุงูุงุณุชุฎุฏุงูุงุช ุ ูุฐูู ุนูู ุงูุฑุบู ูู ูุฌูุฏ ูุญุงููุฉ ูุงุณุชุฎุฏุงู ุฌูุงุฒ ุฅุณุชูุงุก ูุญูู ุฌุงูุฒ ูู ุดุฑูุฉ ROS ุ ูุนุฏุฉ ุฃุณุจุงุจ ูุฌุฏูุง ุฃู ูุฐุง ุงูุฃูุฑ ุบูุฑ ูุงุนุฏ.  ููููู ุฃุฏูุงู ูุนุฑูุฉ ุนุฏุฏ ุงูุฃุดูุงุก ุงูุชู ูุญุชุงุฌ ุฅูููุง ูุตูู ุทุงุฆุฑุฉ ุดุฑุงุนูุฉ ููุงุณูุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class TrajectoryPlanner * @brief Computes control velocities for a robot given a costmap, a plan, and the robot's position in the world. */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TrajectoryPlanner</span></span></span><span class="hljs-class">{</span></span> <span class="hljs-keyword"><span class="hljs-keyword">friend</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TrajectoryPlannerTest</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">//Need this for gtest to work public: /** * @brief Constructs a trajectory controller * @param world_model The WorldModel the trajectory controller uses to check for collisions * @param costmap A reference to the Costmap the controller should use * @param footprint_spec A polygon representing the footprint of the robot. (Must be convex) * @param inscribed_radius The radius of the inscribed circle of the robot * @param circumscribed_radius The radius of the circumscribed circle of the robot * @param acc_lim_x The acceleration limit of the robot in the x direction * @param acc_lim_y The acceleration limit of the robot in the y direction * @param acc_lim_theta The acceleration limit of the robot in the theta direction * @param sim_time The number of seconds to "roll-out" each trajectory * @param sim_granularity The distance between simulation points should be small enough that the robot doesn't hit things * @param vx_samples The number of trajectories to sample in the x dimension * @param vtheta_samples The number of trajectories to sample in the theta dimension * @param pdist_scale A scaling factor for how close the robot should stay to the path * @param gdist_scale A scaling factor for how aggresively the robot should pursue a local goal * @param occdist_scale A scaling factor for how much the robot should prefer to stay away from obstacles * @param heading_lookahead How far the robot should look ahead of itself when differentiating between different rotational velocities * @param oscillation_reset_dist The distance the robot must travel before it can explore rotational velocities that were unsuccessful in the past * @param escape_reset_dist The distance the robot must travel before it can exit escape mode * @param escape_reset_theta The distance the robot must rotate before it can exit escape mode * @param holonomic_robot Set this to true if the robot being controlled can take y velocities and false otherwise * @param max_vel_x The maximum x velocity the controller will explore * @param min_vel_x The minimum x velocity the controller will explore * @param max_vel_th The maximum rotational velocity the controller will explore * @param min_vel_th The minimum rotational velocity the controller will explore * @param min_in_place_vel_th The absolute value of the minimum in-place rotational velocity the controller will explore * @param backup_vel The velocity to use while backing up * @param dwa Set this to true to use the Dynamic Window Approach, false to use acceleration limits * @param heading_scoring Set this to true to score trajectories based on the robot's heading after 1 timestep * @param heading_scoring_timestep How far to look ahead in time when we score heading based trajectories * @param meter_scoring adapt parameters to costmap resolution * @param simple_attractor Set this to true to allow simple attraction to a goal point instead of intelligent cost propagation * @param y_vels A vector of the y velocities the controller will explore * @param angular_sim_granularity The distance between simulation points for angular velocity should be small enough that the robot doesn't hit things */ TrajectoryPlanner(WorldModel&amp; world_model, const costmap_2d::Costmap2D&amp; costmap, std::vector&lt;geometry_msgs::Point&gt; footprint_spec, double acc_lim_x = 1.0, double acc_lim_y = 1.0, double acc_lim_theta = 1.0, double sim_time = 1.0, double sim_granularity = 0.025, int vx_samples = 20, int vtheta_samples = 20, double pdist_scale = 0.6, double gdist_scale = 0.8, double occdist_scale = 0.2, double heading_lookahead = 0.325, double oscillation_reset_dist = 0.05, double escape_reset_dist = 0.10, double escape_reset_theta = M_PI_2, bool holonomic_robot = true, double max_vel_x = 0.5, double min_vel_x = 0.1, double max_vel_th = 1.0, double min_vel_th = -1.0, double min_in_place_vel_th = 0.4, double backup_vel = -0.1, bool dwa = false, bool heading_scoring = false, double heading_scoring_timestep = 0.1, bool meter_scoring = true, bool simple_attractor = false, std::vector&lt;double&gt; y_vels = std::vector&lt;double&gt;(0), double stop_time_buffer = 0.2, double sim_period = 0.1, double angular_sim_granularity = 0.025);</span></span></code> </pre> <br>  <i>ูุฐุง ูุซุงู ุนูู ุชููุฆุฉ ูุนููุงุช ุชูุธูู ุงูุณุฑุนุงุช ูุงููุณุงุฑ ููู.</i> <br><br>  ูุนููุงุช ูููุฉ ูุฅุฌุฑุงุก ุนูููุฉ ุญุณุงุจูุฉ ูุงููุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุนููุฉ world_model. </li><li style=";text-align:right;direction:rtl">  ูุนููุฉ ุฎุฑูุทุฉ ุงูุชูููุฉ: ุฑุงุจุท ูุฎุฑูุทุฉ ุชุญุชูู ุนูู ุนูุงุฆู ุ ุจุงูุฅุถุงูุฉ ุฅูู "ุงูุชุฏุงุฏูุง ุงูุธุงูุฑู" ุ ูุน ูุฑุงุนุงุฉ ุงูุชุตุงุฏู ุงููุญุชูู. </li></ol><br>  ูู ูุฒุงูุง ุงูููุฏุณ ุงูููุงุณู ุ ููููู ุชุณููุท ุงูุถูุก ุนูู ุชูุงูุฑ ุงููุซุงุฆู ูุงููุฏุฑุฉ ุนูู ุงูุนุซูุฑ ุนูู ุงููุนูููุงุช ูู ุงูููุชุฏูุงุช.  <a href="https://github.com/ros-planning/navigation" rel="nofollow">ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุนูู ุงููููุน ุงูุฑุณูู ูุน ุงููุซุงุฆู</a> <br><br>  ูู ุงูููู ุฃู ูุฐูุฑ ุฃู ุญุฒู ROS ูุงูุช ููุชูุจุฉ ููููุตุงุช ุฐุงุช ุงูุนุฌูุชูู ุ ููู ุธู Omni ุชู ุชุญุณูููุง ูู ุฎูุงู ุฒูุงุฏุฉ ุฒุงููุฉ ุงูุฏูุฑุงู ุงููุชุงุญุฉ ุนูุฏ ุชุญุฑูู ูุง ูุตู ุฅูู 360 ุฏุฑุฌุฉ ุ ููู ุจุงูุชุฃููุฏ ุนูุงุฒ. <br><br>  ุจุนุฏ ุชุญููู ุงููุดุฑูุน ุ ุฃุฏุฑููุง ุฃูู ุณูููู ููุงู ุตุนูุจุฉ ูู ุงูุฏุฑุงุณุฉ ูุงูุชูููู ุ ููุฐูู ููุงู ุงูุนุฏูุฏ ูู ุงูุฑูุงุฆู ุงูุซูููุฉ ุงูุชู ูุง ูุญุชุงุฌ ุฅูููุง.  ูุฏ ูุจุฏู ุฐูู ุ ููููู ุ ููููุง ุงุณุชุฎุฏููุง Odroid xu4 (ุงููุนุงูุฌ ุงูุฐู ูุงู ูุง ูุฒุงู ุนูู Samsung s5) ุ ููุงูุช ูุชุงุฆุฌ ุงูุฃุฏุงุก ูุญุจุทุฉ ุ ููุณุงุญุฉ ูุดูุก ุฃูุซุฑ ููุฉ (ูุชูุช ุงูุนููู 4 ููุนุงูุฌ jetson nano ูุฏุฎูุงู ุจุดูู ุฌุงูุจู ุจุงูููุงุฑูุฉ ูุน ูุนู) ูุง.  ุงุถุทุฑุฑุช ุฅูู ุงูุชุฎูู ุนู ุงูููุฏุณ ุงูููุงุณู ููุญุงููุฉ ุฅูุดุงุก ูุฎุทุท ุนุงููู ุ ูุฎุทุท ูุญูู ูููุธู ูุณุงุฑ ุฃููุณูุง <br><br><img src="https://habrastorage.org/webt/ij/qe/es/ijqeesrak1vuhjqfr1ij6exr4_a.jpeg"><br><br><h3 style=";text-align:right;direction:rtl">  ูุณูู ุนุงููู ุ ูุฎุทุท ูุญูู ุ ููุธู ูุณุงุฑ ูุฌููุน ุงููู </h3><br>  ููุงู ุญุงุฌุฉ ุฅูู ุงูุทุงุฆุฑุงุช ุงูุดุฑุงุนูุฉ ุงูุนุงูููุฉ ูุงููุญููุฉ ููุญุตูู ุนูู ุงูุงุชุฌุงูุงุช ุฅูู ุงููุฌูุฉ.  ููุงุฐุง ุงูุงููุตุงู ุถุฑูุฑูุ  ููุงุฐุง ูุง ููููู ููุท ุฃุฎุฐ <a href="https://ru.wikipedia.org/wiki/A*" rel="nofollow">A *</a> ูุฑููุจูุงุ  ููุงุนุฏุฉ ุนุงูุฉ ุ ูููู ูููุฎุทุท ุงูุดุงูู ุ ุนูุฏ ุฅูุดุงุก ูุณุงุฑ ุ ุงุณุชุฎุฏุงู ุงูุฎุฑูุทุฉ ุจุฃููููุง ูู ุนููู ุ ูุฐูู ูุฌุจ ุฃู ุชููู ุงูุฎูุงุฑุฒููุฉ ุจุฃุณุฑุน ูุง ูููู ุ ุญุชู ูุน ุจุนุถ ุงูุชุจุณูุท.  ูุชุฎููู ูุฐู ุงูุชุจุณูุท ุ ูุณุชุฎุฏููู ุฃูุถูุง ุงููุฎุทุท ุงููุญูู ุ ุงูุฐู ูุญุงูู ุ ุจูุงุกู ุนูู ูุชูุฌุฉ ุงููุฎุทุท ุงูุนุงููู (ุฃู ูุฌุฑุฏ ููุทูุฉ ูุญุฏูุฏุฉ ุญูู ุงูุฑูุจูุช) ุ ูุฑุงุนุงุฉ ุฌููุน ุงููุฑูู ุงูุฏูููุฉ. <br><br>  ุจุนุฏ ุฃู ุฃูุดุฃูุง ุงููุณุงุฑ ุ ูุนุฑู ุฃูู ูุฌุจ ุฃู ูุฐูุจ ุงูุฑูุจูุช ุ ููู ููู ูููู ุฅุฎุจุงุฑู ุจูุฐุงุ  ููููุงู ุจุฐูู ุ ููุงู ููุธู ุงููุณุงุฑ.  ูููู ุจุญุณุงุจ ุงูุณุฑุนุฉ ูุงูุณุฑุนุฉ ุงูุชู ูุชุญุฑู ูููุง ุงูุฑูุจูุช ูู ุงูููุช ุงูุญุงูู ุญุชู ูุง ููุญุฑู ุนู ุงููุณุงุฑ.  ูู ููุงุญ ูุซูุฑุฉ ุ ูุฐู ุงูุญุฒูุฉ ูู ุงููุณุคููุฉ ุนู ูุฏู ุณุฑุนุฉ ูุฌูููุฉ ุณูู ูุฐูุจ ุงูุฑูุจูุช. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ูุฐู ุงูููุงูุงุช ุงูุซูุงุซุฉ ุ ููุงู ุฎุงุฏู ุฎุฑุงุฆุท - ุฑุงุจุน ุ ูุณูุญ ูู ุจูุนุงูุฌุฉ ุญุงูุฉ ุงูุนุงูู ุจุณูููุฉ.  ุฅูู ูุญุฏุฏ ููููุฉ ูุตููุง ููุฎุฑูุทุฉ ุ ููุง ูู ุงูุฅููุงููุงุช ุงููุชููุฑุฉ ูุฏููุง ุนูุฏ ุงูุนูู ูุน ุงูุฎุฑูุทุฉ ุ ููู ููุงุญ ูุซูุฑุฉ ุ ุชุญุฏูุฏ ุณุฑุนุฉ ุงูุทุงุฆุฑุงุช ุงูุดุฑุงุนูุฉ. <br><br>  ูุจู ุงููุชุงุจุนุฉ ูุน ูุตู ููุฏุณ ุงูุชููู ุ ุณูููู ูู ุงูุฌูุฏ ุชุญุฏูุฏ ุฃุณุจุงุจ ุงุฎุชูุงุฑ cost_map ูุฎุงุฏู ุฎุฑุงุฆุท.  ุจุดูู ุนุงู ุ ุฌุฑุจูุง ุฎูุงุฑุงุช ูุฎุชููุฉ ููุนุงูุฌ ุงูุฎุฑุงุฆุท: <a href="http://wiki.ros.org/grid_map" rel="nofollow">Occupancy_grid</a> ู <a href="https://github.com/stonier/cost_map" rel="nofollow">Grid_map</a> ู <a href="https://github.com/stonier/cost_map" rel="nofollow">Cost_map</a> ุ ููููุง <a href="https://github.com/stonier/cost_map" rel="nofollow">ุงุณุชูุฑูุง</a> ุนูู ุงูุฃุฎูุฑ. <br><br>  ุงูุฃุณุจุงุจ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุชูุงุนู ุจุดูู ูุฑูุญ ูุน ุงูุฎุฑูุทุฉ. </li><li style=";text-align:right;direction:rtl">  ููุงู ุงูุนุฏูุฏ ูู ุงูุชูุฑุงุฑุงุช ุงูุชู ูุญุชุงุฌูุง ูู ุฃุดูุงู ูุฎุชููุฉ (ุฏุงุฆุฑูุฉ ุ ุฎุทูุฉ ุ ูุณุชุทููุฉ ุ ุฅูุฎ). </li><li style=";text-align:right;direction:rtl">  ููููู ุชุฎุฒูู ุทุจูุงุช ุฎุฑูุทุฉ ูุชุนุฏุฏุฉ ุจูุนููุงุช ูุฎุชููุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฏุงุฑุฉ ุฐุงูุฑุฉ ุฌูุฏุฉ. </li><li style=";text-align:right;direction:rtl">  ูุงูุฃูู ูู ุฐูู ุ ุงูุณุฑุนุฉ.  ุชุนูู ุฎุฑูุทุฉ ุงูุดุจูุฉ ุจููุน ูุฒุฏูุฌ ูุจุณุจุจ ูุฐุง ุ ูุฅููุง ุฃุจุทุฃ ุนุฏุฉ ูุฑุงุช ูู ุฎูุงุฏู ุงูุฎุฑุงุฆุท ุงูุชู ุชุณุชุฎุฏู int8 ููุนูู. </li></ol><br>  ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ุดุจูุฉ ุงูุฅุดุบุงู ุชุนูู ุฃูุถูุง ูุน int8 ุ ุฅูุง ุฃููุง ูุง ูููู ุฃู ุชูุชุฎุฑ ุจููุณ ูุงุจููุฉ ุงูุงุณุชุฎุฏุงู ุ ูุฐูู ุงุถุทุฑุฑุช ุฅูู ุงูุชุฎูู ุนููุง. <br><br>  ูู ุงูุฎุฑูุทุฉ ุ ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุฃูู ุชูุฌุฏ ุงูููุงุทู ุงูุญุฑุฉ ูุงูุฎุทูุฑุฉ ุงูุชู ูุง ุชูุงูู.  ููู ูุงุฆู ููุฌูุฏ ูู ุงูุญูู ุ ูููููุง ุถุจุท ุญูู ุงูุชุถุฎู - ููู ุงููููุฉ ุงูุชู ุชุญุฏุฏ ุ ุญุณุจ ุงููุณุงูุฉ ุฅูู ุงููุงุฆู ุ ููุงุฐูุฉ ุงูุฎููุฉ.  ุงูุชุถุฎู ูู ุฐูู ุงููุท ุ ูู ุงูุณูู ุนุฏู ููุงุญุธุชู ุ ูููู ุจุนุฏ ุฐูู ุณุชูุฏู ุนููู ููุชุฑุฉ ุทูููุฉ ุฌุฏูุง.  ูููู ุจุชุฎุทูุท ุฑูุจูุชุงุช ุงูุนุฏู ููุถูู ููุทูุฉ ุฎุทุฑ ูุง ูุฃุฎุฐูุง ุณูู ุงููุฎุทุท ุงููุญูู ูู ุงูุงุนุชุจุงุฑ.  ูุฎุทุท ุนุงููู ูุชุฌุงูู ุฌููุน ุงูููุงุท ุ ุฅุฐุง ูู ุชูู ุนูุจุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  ูุฎุทุท ุนุงููู </h4><br>  ุฃูู ูุง ูุชุจูู ูู ุงูููุงุญุฉ ูู ุงููุฎุทุท ุงูุนุงููู.  ูุนุชูุฏ ุนูู ุฎูุงุฑุฒููุฉ theta *.  ุจุงุฎุชุตุงุฑ ุ ูุฐุง ูู <a href="https://ru.wikipedia.org/wiki/A*" rel="nofollow">A *</a> ุงููุนุฏูุฉ ุ ุญูุซ ูุชู ุงูุชุฑููุฒ ุนูู ุงูุนุซูุฑ ุนูู ุงูุนูุฏุฉ ุงูุฃุตู ุ ูุงูุชู ูููู ุงููุตูู ุฅูููุง ูุจุงุดุฑุฉ ุ ุฃู  ูุง ุชูุฌุฏ ุนูุจุงุช ุฃูุงููุง.  ูุฐุง ูุณูุญ ููุง ุจุจูุงุก ูุณุงุฑุงุช ูุฑูุญุฉ ูุณูุณุฉ ุชุณุชุฎุฏู ูู ุงููุฎุทุท ุงููุญูู. <br><br><img src="https://habrastorage.org/webt/it/qs/e4/itqse4uuumbbzu8rxws07gapbn8.png"><br>  <i>ููุงุฑูุฉ ุจูู A * ู theta *</i> <br><br>  ุจุงููุณุจุฉ ูููุฎุทุท ุงูุนุงู ุ ูุฏููุง ููู ุจู ูุนููุงุช (params / path_planner.yaml) ูุตู ููุถูุนุงุช ุงูุฎุฑูุทุฉ ูููุงุถูุนูุง ูุน ูููุน ุฌููุน ุงูุฑูุจูุชุงุช (ูุฌููุน ุงูุฑูุจูุชุงุช ุงูุฃุฑุจุนุฉ ูู ุงูุญูู ุ ุญูุซ "null" ูู ุงูููุถูุน ุงูุฐู ูุญุชูู ุนูู ุจูุงูุงุช ุญูู ุงูุฑูุจูุช ุงูุญุงูู). <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta"># small robot debug param list robot_id: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"small"</span></span></span><span class="hljs-meta"> ########################### # cost_map_server params ## ########################### cost_map_server/big_robot_size: 0.45 cost_map_server/little_robot_size: 0.45 cost_map_server/cube_size: 0.11 cost_map_server/inscribed_radius: 0.3 cost_map_server/inflation_radius: 0.3 cost_map_server/inflation_exponential_rate: 0.6 cost_map_server/big_robot1: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/aruco/big_robot"</span></span></span><span class="hljs-meta"> cost_map_server/big_robot2: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/aruco/enemy_robot1"</span></span></span><span class="hljs-meta"> cost_map_server/small_robot1: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"null"</span></span></span><span class="hljs-meta"> cost_map_server/small_robot2: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/aruco/enemy_robot2"</span></span></span><span class="hljs-meta"> cost_map_server/collision: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"collision"</span></span></span><span class="hljs-meta"> cost_map_server/image_resource_name: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"$(find cost_map_server)/param/image_resource.yaml"</span></span></span><span class="hljs-meta"> cost_map_server/min_diff_points: 0.01 ########################### ### path_planner params ### ########################### global_planner/path_layer: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"inflation_layer"</span></span></span><span class="hljs-meta"> global_planner/path_force_layer: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"obstacle_inflation_layer"</span></span></span><span class="hljs-meta"> global_planner/frame_id: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"map"</span></span></span><span class="hljs-meta"> global_planner/current_position: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"real_corr"</span></span></span><span class="hljs-meta"> global_planner/path_filter_epsilon: 0</span></span></code> </pre> <br>  ููุง ูุดูุฑ ุฅูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงุญุฏุฉ ูู ุงูุฎูุงุฑุฒููุงุช ุงูุชู ููููู ุงุฎุชูุงุฑ ุจูุงุก ูุณุงุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุฃุณูุงุก ุงูุทุจูุงุช ุงูุชู ุณูุจูู ุนูููุง ุงูุทุฑูู ููุณู ุ </li><li style=";text-align:right;direction:rtl">  ููุถูุน ุญูู ูููููุง ุ ุญูุซ ูุชู ุฅุตุฏุงุฑ ุงูุจูุงูุงุช ุงูุชู ุชูุช ุชุตููุชูุง (ูู ุญุงูุชูุง ุ ูู ูุฒูุฌ ูู ุจูุงูุงุช ุงููููุน ูู ุงููุงููุฑุง ูููุงุณ ุงููุณุงูุงุช). </li></ol><br>  ูุชู ุชูููุฒ ุฎูุงุฑุฒููุฉ ุงูุจุญุซ ุนู ุงููุณุงุฑ ููุณูุง - Theta Star - ูู ููู ูููุตู (src / global_planner.cpp) ูุชูููุฑ ุงูุฑุงุญุฉ ูุฅุถุงูุฉ ุฎูุงุฑุฒููุงุช ุฌุฏูุฏุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cost_so_far[<span class="hljs-number"><span class="hljs-number">300</span></span>][<span class="hljs-number"><span class="hljs-number">200</span></span>]; PriorityPoint neighbors[<span class="hljs-number"><span class="hljs-number">8</span></span>]; PriorityPoint current; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> come_from[<span class="hljs-number"><span class="hljs-number">300</span></span>][<span class="hljs-number"><span class="hljs-number">200</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makePath_ThetaStar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;cost_map::Index&gt; &amp;path, PriorityPoint start, PriorityPoint goal, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> layer, cost_map::CostMap &amp;cost_map, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> grid_cost, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> only_cost)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::priority_queue&lt;PriorityPoint, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;PriorityPoint&gt;, myCompare&gt; openSet; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> max_x = cost_map.getSize()[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> max_y = cost_map.getSize()[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::fill_n(*cost_so_far, max_x * max_y, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::numeric_limits&lt;<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt;::max()); cost_so_far[start.x][start.y] = <span class="hljs-number"><span class="hljs-number">0</span></span>; come_from[start.x][start.y][<span class="hljs-number"><span class="hljs-number">0</span></span>] = start.x; come_from[start.x][start.y][<span class="hljs-number"><span class="hljs-number">1</span></span>] = start.y; openSet.push(start); grid_cost=<span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!openSet.empty()) { current = openSet.top(); openSet.pop(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (current == goal) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } current.GetNeighbors(neighbors); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> current_cost = cost_so_far[current.x][current.y]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> parent_carent[<span class="hljs-number"><span class="hljs-number">2</span></span>] ={come_from[current.x][current.y][<span class="hljs-number"><span class="hljs-number">0</span></span>], come_from[current.x][current.y][<span class="hljs-number"><span class="hljs-number">1</span></span>]}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!neighbors[i].OnMap(max_x, max_y)) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> onLine = lineOfSight(parent_carent[<span class="hljs-number"><span class="hljs-number">0</span></span>], parent_carent[<span class="hljs-number"><span class="hljs-number">1</span></span>], neighbors[i].x, neighbors[i].y, cost_map, layer, grid_cost + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (onLine) { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> new_cost = cost_so_far[parent_carent[<span class="hljs-number"><span class="hljs-number">0</span></span>]][parent_carent[<span class="hljs-number"><span class="hljs-number">1</span></span>]] + HeuristicEvclid(parent_carent, neighbors[i], grid_cost*<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (new_cost &lt; cost_so_far[neighbors[i].x][neighbors[i].y]) { cost_so_far[neighbors[i].x][neighbors[i].y] = new_cost; neighbors[i].priority = HeuristicEvclid(neighbors[i], goal, grid_cost*<span class="hljs-number"><span class="hljs-number">10</span></span>) + new_cost; openSet.push(neighbors[i]); come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number"><span class="hljs-number">0</span></span>] = parent_carent[<span class="hljs-number"><span class="hljs-number">0</span></span>]; come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number"><span class="hljs-number">1</span></span>] = parent_carent[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> neighbor_price = cost_map.at(layer, cost_map::Index({neighbors[i].x, neighbors[i].y})) + neighbors[i].priority; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> new_cost = current_cost + neighbor_price; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (new_cost &lt; cost_so_far[neighbors[i].x][neighbors[i].y]) { cost_so_far[neighbors[i].x][neighbors[i].y] = new_cost; neighbors[i].priority =HeuristicEvclid(neighbors[i], goal, grid_cost*<span class="hljs-number"><span class="hljs-number">10</span></span>) + new_cost; openSet.push(neighbors[i]); come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number"><span class="hljs-number">0</span></span>] = current.x; come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number"><span class="hljs-number">1</span></span>] = current.y; } } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (only_cost) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cost_so_far[current.x][current.y]; } path.clear(); PriorityPoint temp_point; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current != start) { path.push_back({current.x, current.y}); temp_point.x = come_from[current.x][current.y][<span class="hljs-number"><span class="hljs-number">0</span></span>]; temp_point.y = come_from[current.x][current.y][<span class="hljs-number"><span class="hljs-number">1</span></span>]; current = temp_point; } path.push_back({current.x, current.y}); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br>  ูุชู ุฃูุถูุง ุชุฎุตูุต ุฎูุงุฑุฒููุฉ ูุฅุฒุงูุฉ ุงูููุงุท ุงูุฅุถุงููุฉ ุนูู ูุณุงุฑ RamerDouglasPeucker ูููู ูููุตู. <br>  ูุฒูู ุงูููุงุท ูู ุงููุณุงุฑ ุฅุฐุง ูุงู ุฎุงุฑุฌ ูุณุงูุฉ ูุนููุฉ ูู ุงูุฎุท ุงูุฐู ูุตู ุจูู ููุทุชูู ูุชุฌุงูุฑุชูู. <br><br><img src="https://habrastorage.org/webt/en/_9/dw/en_9dw6khdarxbyf7gvrhpqg7b4.jpeg"><br><br><h4 style=";text-align:right;direction:rtl">  ูุฎุทุท ูุญูู </h4><br>  ุงูู ูุนูู ุจุงููุณุจุฉ ููุง ุนูู ุฃุณุงุณ ุงููุณุจ ุงูุชุฏุฑุฌ ูู ูุฌุงู ูุญุชูู.  ููุฏุฎูุงุช ุ ุงููุณุงุฑ ูู ุงููุฎุทุท ุงูุนุงููู.  ููุน ุฐูู ุ ูุฐุง ููุณ ูู ูุง ูู ูุงุฏุฑ.  ูู local_planner ุ ููุงู ุฎุฏูุงุช ุฏุงุฎููุฉ ูุงุฎุชูุงุฑ ูุถุน ุจูุงุก ุงููุณุงุฑ.  ููุงู ุฅุฌูุงูู ูุถุนูู ููุชุดุบูู: ูุถุน ููุงุท ุงูุชุญูู ุนูู ุทูู ุงูุชุฏุฑุฌ ุงููููู ุ ุจุงุณุชุฎุฏุงู ุชูุฑูุฑุงุช ูุชุนุฏุฏุฉ ุนูู ุงูุฎุฑูุทุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุถุน ุงูุชุญูู ุ ุญูุซ ูุญุณุจ ุงูุฒูุงุฏุฉ ุนูู ุงูููุฑ ูู ุฅุญุฏุงุซูุชูู ููููู ุงูููุทุฉ ุฅูู ุญุงูุฉ ุงูููุทูุฉ ุงูุขููุฉ.  ุฅุฐุง ุณูุทุช ุงูููุทุฉ ูู ุนุฏุฉ ููุงุทู ูู ูุฐุง ุงููุจูู ุ ูุฅููุง ููุชูู ุฅูู ุฃูุงูู ุชูุงุทุนูุง ุ ูุฃูู ููุงู ุงูุฃูุซุฑ ุฃูุงููุง. <br><br>  ูููู ูุถุน ุงูุชุดุบูู ููุง ููู: ุฅุฐุง ูู ุชูู ููุงู ุนูุจุฉ ูู ุงููุณุงุฑ ูู ุงูุชูุฑุงุฑ ุงูุณุงุจู ุ ูุณููุทุน ุงููุณุงุฑ ูู 2 ุณู ุ ุซู ูุบูุฑู ุนูู ุทูู ุงูุชุฏุฑุฌ ุงููููู ุ ูุฅูุง ูุฅููุง ูุณุชุฎุฏู ูุถุน ุงููุฎุทุท ุงููุญูู ุงูุซุงูู ููุนูููุฉ. <br><br>  ุงูุฎูุงุฑ ุงูุซุงูู ุฎููู ุงููุฒู ุชูุงููุง ุ ูุซู ุงููุฎุทุท ุงูุนุงู ุ ูุง ูููู ุจุชุญููู ุงููุนุงูุฌ ูุซูุฑูุง.  ุงุณุชุฎุฏููุง ุงูุนุฏูุฏ ูู ุฅุตุฏุงุฑุงุช ูุฐู ุงูุฎูุงุฑุฒููุฉ ููุนุงูุฌุงุช ูุฎุชููุฉ ูุน ุงูุฎุฑูุทุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุญุงูููุง ูุชุงุจุฉ ุฑุณู ุจูุงูู ุชูุฌุฏ ููู ุงูููู ูู 10 ุณู ููุชู ุฅุฒุงุญุชูุง ุจุญุฏ ุฃูุตู 4 ุณู ุ ูุจุนุฏ ุฐูู ุชู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุฏููุณุชุฑุง ุนูู ุงูุฑุณู ุงูุจูุงูู ุงูุฐู ุชู ุงูุญุตูู ุนููู ููุนุซูุฑ ุนูู ุฃุตุบุฑ ูุณุงูุฉ.  ุชุณุชุฎุฏู ููุทุฉ ุงูููุงูุฉ ูู ูุฐู ุงูุญุงูุฉ ุฃูุฑุจ ููุทุฉ ุฅุฒุงุญุฉ.  ููู ูุซู ูุฐู ุงูุฎูุงุฑุฒููุฉ ูุงูุช ุฃูุซุฑ ููุงุกูุฉ ูููุฎุทุท ุงูุนุงููู ููุฑุฑูุง ุงูุชุฎูู ุนู ูุฐุง ุงูุชูููุฐ. <br><br>  ููุฏ ุญุงูููุง ุฃูุถูุง ุงุณุชุฎุฏุงู ุจูุงุก ุงููุณุงุฑ ูู ููุทุฉ ุงูุตูุฑ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงููุณุจ ุงูุชุฏุฑุฌ.  ูุงูุช ูุฐู ุงูุทุฑููุฉ ุงูุฃููู ุงูุชู ูุฑุฑูุง ุงููุชุงุจุฉ.  ุงุชุถุญ ุฃู ูุฐุง ุงูุฌูุงุฒ ุบูุฑ ูุนุงู ูู ุงูุฐุงูุฑุฉ (ููุฏ ุงุญุชู ุฃูุซุฑ ูู 400 ููุบุงุจุงูุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงูุฎุงูุตุฉ ุ ูุฃูู ุงุณุชุฎุฏู ุฎุฑูุทุฉ ุชูููุฉ ูุน ูู ุชูุฑูุฑุฉ) ูุจุทูุฆุฉ.  ุชู ุฅููุงู ุงูุชุญูู ูู ุงูุชุฑุฏุฏ ุจุณุจุจ ุถุนู ุงูุชุญุณูู ููุงูุช ุงูุณุฑุนุฉ ุฃูู ูู 30 ูุฑุฉ ูู ุงูุซุงููุฉ ุ ููู ูุง ูู ููุงุณุจูุง. <br><br>  ูุชูุฌุฉ ูุฐูู ุ ูุฑุฑูุง ุงุณุชุฎุฏุงู ุงููุณุจ ุงูุชุฏุฑุฌ ูู ุญูู ูุญุชูู ุงุณุชูุงุฏูุง ุฅูู ูุณุงุฑ ุงููุฎุทุท ุงูุนุงููู.  ููุฏ ุงุชุถุญ ุฃูู ุฎูุงุฑุฒููุฉ ุฎูููุฉ ุงููุฒู ูุจุณูุทุฉ ูุณุจููุง ุ ูุงูุชู ุชูุงุณุจูุง ุชูุงููุง ูู ุญูุซ ุฌูุฏุฉ ุงููุณุงุฑ ูููุช ุงูุนูู ููููุฉ ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงููุณุชุฎุฏูุฉ ูู ููุทูุฉ 100-150 ููุบุงุจุงูุช ุ ููู ุฃูู ุจุนุฏุฉ ูุฑุงุช ููุง ูุงูุช ุนููู ูู ุงูุชูุฑุงุฑุงุช ุงูุฃููู ูู ุงูุชุทููุฑ. <br><br><img src="https://habrastorage.org/webt/sg/oq/mo/sgoqmogivjs8elhylt74oqjqrdw.png"><br>  <i>ูุซุงู ุนูู ูุณุงุฑ ููุงุจูู ุงููุณูู ุงููุญูู</i> <br><br>  ุนูู ุนูุณ global_planner ุ ูุฅู ุงููุนููุงุช ูู local_planner ุตุบูุฑุฉ ููุบุงูุฉ ุ ููุฑุฌุน ุฐูู ุฅูู ุจุณุงุทุชูุง ุ ูุฃู ุฌููุน ุงูููุงู ุงูุฃูุซุฑ ุฃูููุฉ ุชููู ูู global_planner: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">grid_map_server/big_robot1 : <span class="hljs-number"><span class="hljs-number">0.4</span></span> grid_map_server/big_robot2 : <span class="hljs-number"><span class="hljs-number">0.4</span></span> grid_map_server/small_robot1 : <span class="hljs-number"><span class="hljs-number">0.4</span></span> grid_map_server/small_robot2 : <span class="hljs-number"><span class="hljs-number">0.4</span></span> local_planner/radius : <span class="hljs-number"><span class="hljs-number">0.15</span></span> global_planner/frame_id : <span class="hljs-string"><span class="hljs-string">"map"</span></span></code> </pre> <br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุจุชูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุตู ูุทุฑ ุงูููุงุทู ุงูุขููุฉ ููู ูู ุงูุฑูุจูุชุงุช. </li><li style=";text-align:right;direction:rtl">  ุฅุฒุงุญุฉ ุงููุณุงุฑ ุงูุฃูุตู ุจูุงุณุทุฉ ุงููุณูู ุงููุญูู. </li><li style=";text-align:right;direction:rtl">  ุงุณู ุทุจูุฉ ุงูุฎุฑูุทุฉ ุงูุชู ูุนูู ูุนูุง. </li></ul><br>  ูู ูุตู ูููุตู ุชู ุชุฎุตูุต ุฌููุน ุงููุธุงุฆู ุงูุฃูุซุฑ ุฃูููุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุฅูู ุงูููุงุฑ ูุชูุฑุฑ ูููุณุงุฑ ุ ูุฅูุดุงุก ุทุงุฆุฑุฉ ุดุฑุงุนูุฉ ูุจูุงุฉ ุงูุชุฑุงุถูุฉ ููุฏูุฑุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Planner</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Planner(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> inflation_radius_, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> frame_id_) { inflation_radius = inflation_radius_; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">300</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">200</span></span>; j++) our_map[i][j] = <span class="hljs-number"><span class="hljs-number">3000.0</span></span>; } OurPath-&gt;poses.resize(<span class="hljs-number"><span class="hljs-number">50</span></span>); geometry_msgs::Pose pose; pose.position.x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; pose.position.y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">50</span></span>; i++) { OurPath-&gt;poses[i].pose = pose; } frame_id = frame_id_; } <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~Planner() { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdatePath</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; ros::Publisher move_pub; ros::Publisher BigEnemyPub; ros::Publisher LittleEnemyPub; ros::Publisher local_path_publisher; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: <span class="hljs-comment"><span class="hljs-comment">// virtual double Calculate_Path_Len(); nav_msgs::Path* recursive_path(nav_msgs::Path *path, std::pair&lt;double, double&gt; start, std::pair&lt;double, double&gt; end, double epsilon, int &amp;index) { if (CalcDistance(start, end) &lt; (epsilon) || path-&gt;poses.size() &gt; 200) return path; double start_x = (start.first + end.first) / 2.0; double start_y = (start.second + end.second) / 2.0; index = find_out(path, start); geometry_msgs::PoseStamped pose; pose.pose.position.x = start_x; pose.pose.position.y = start_y; path-&gt;poses.insert(path-&gt;poses.begin() + index, pose); recursive_path(path, start, std::pair&lt;double, double&gt;{start_x, start_y}, epsilon, index); recursive_path(path, std::pair&lt;double, double&gt;{start_x, start_y}, end, epsilon, index); } int find_out(nav_msgs::Path *path, pair_double point) { int index = 0; for (int i = 0; i &lt; path-&gt;poses.size(); i++) if (path-&gt;poses[i].pose.position.x == point.first &amp;&amp; path-&gt;poses[i].pose.position.y == point.second) return ++i; return index; } void add_in_path(nav_msgs::Path* Path, geometry_msgs::PoseStamped pose, int&amp; Index) { Path-&gt;poses[Index % max_size] = pose; Index++; } double inflation_radius; double our_map[300][200]; int max_size = 49; std::string frame_id; nav_msgs::Path *path = new nav_msgs::Path; nav_msgs::Path *OurPath = new nav_msgs::Path; };</span></span></code> </pre> <br>  ุชูุช ุชูุงุฑุซ ูุฆุฉ LocalPlanning ููู ุ ุญูุซ ููุฌุฏ ููุจ ุงูุทุงุฆุฑุฉ ุงูุดุฑุงุนูุฉ ุจุงููุงูู ุ ุฃู ุชุญููู ุงูููุงุท ุฅูู ุญุงูุฉ ุงูููุทูุฉ ุงูุขููุฉ ูุชุญุฏูุฏ ูุง ูุฌุจ ูุนูู ุจุงููุณุงุฑ ุนูู ูุฌู ุงูุชุญุฏูุฏ. <br><br>  ูุชู ุชูููุฒ ูู ุงููุธุงุฆู ุงูุฃุฎุฑู ูู ููู ูููุตู fichi.hpp ุ ููุณุจ ูุชุฏุฑุฌ ูู potential_field.hpp.  ููุฌุฏ ุฃุฏูุงู ููุทุฉ ูู ูุฐุง ุงูููู ุ ูุงูุชู ุชูุธูุฑ ูุธุงุฆู ุฅูุดุงุก ุญูู ูุญุชูู ุนูู ุฎุฑูุทุฉ cost_map: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CalcAttractivePotential</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(grid_map::Index index, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> goalx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> goaly)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">pow</span></span>(index[<span class="hljs-number"><span class="hljs-number">0</span></span>] - goalx, <span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-built_in"><span class="hljs-built_in">pow</span></span>(index[<span class="hljs-number"><span class="hljs-number">1</span></span>] - goaly, <span class="hljs-number"><span class="hljs-number">2</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CalcPotential</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> startx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> starty, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> goalx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> goaly, cost_map::CostMap &amp;cost_map, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (&amp;our_map)[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">300</span></span></span></span><span class="hljs-function"><span class="hljs-params">][</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">200</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Use some magic for normalisation of Field double max_distance = (CalcAttractivePotential(grid_map::Index(startx, starty), goalx, goaly) + 15); if (max_distance == 0.0) { max_distance = 0.01; } for (cost_map::CircleIterator iterator(cost_map, grid_map::Position(startx / 100.0, starty / 100.0), max_distance / 100.); !iterator.isPastEnd(); ++iterator) { try { grid_map::Index index(*iterator); double uf; uf = cost_map.at("obstacle_inflation_layer", *iterator); // if we on free podouble - field is more less then if it not free podouble if ( uf &gt;= 10) { uf = 3000.0; // CP - is const variable } else uf += CalcAttractivePotential(index, goalx, goaly)/max_distance * 256; our_map[299-index(0)][199-index(1)] = uf; } catch(std::exception&amp; e) { ROS_INFO("Exception! %s", e.what() ); } } }</span></span></code> </pre> <br><h4 style=";text-align:right;direction:rtl">  ููุธู ุงููุณุงุฑ </h4><br>  ุฃุฎูุฑูุง ูููุณ ุขุฎุฑูุง ุ ููุธู ุงููุณุงุฑ.  ููู ูุณุคูู ุนู ุชุญููู ูุณุงุฑ ุงููุฎุทุท ุงููุญูู ุฅูู ูุณุงุฑ ููุนุทู ุงูุณุฑุนุฉ ููุฎุทูุฉ ุงูุญุงููุฉ. <br><br>  ุงูุฅุตุฏุงุฑ ุงูุฃูู ุ ุงูุฐู ุงุณุชุฎุฏููุงู ูู ููุงุฆู Eurobot 2018 ุ ุนุจุงุฑุฉ ุนู ูุฒูุฌ ูู ูุญุฏุฉ ุงูุชุญูู ูู ุงูุชุณุงุฑุน ูููุงุจุญ ุงููุฑุงูู ุ ุญูุซ ูุชู ุถุจุท ูุงูู ุงูุญุฑูุฉ ุฅูู ุงูููุทุฉ ุงูุชุงููุฉ ุนูู ุงูุทุฑูู ุ ุจุงููุณุจุฉ ุฅูู ุงููุณุงูุฉ ุฅูู ููุทุฉ ุงูููุงูุฉ. <br><br>  ูุญุฏุฉ ุงูุชุญูู PID ุ ุจุงุฎุชุตุงุฑ ุ ูู ูุฌููุน ุงูุญุงูุงุช ุงูุซูุงุซ ูููุธุงู ุงูุชู ุชุณุงุนุฏ ูู ุฅุตูุงุญ ุงูุฃุฎุทุงุก ูุงูุฃุฎุทุงุก ุงูุชู ุชุญุฏุซ ูู ุจุนุถ ุงูุฃุญูุงู. <br><br>  ุชู ุชุญุฏูุฏ ูุฐู ุงููุธุงุฆู ุจุดูู ุชุฌุฑูุจู ูุชุนุชูุฏ ุนูู ุงููุณุงูุฉ ุฅูู ููุทุฉ ุงูููุงูุฉ ูู ุงููุณุงุฑ (ูููู ุฃู ุชููู ูู ุงูุฏุฑุฌุฉ ุงูุซุงููุฉ ุฃู ุงูููุนุจุฉ ุฃู ุงูุนูุณูุฉ ุ ูููู ุจุนุฏ ุฐูู ุงุณุชูุฑูุง ุนูู ุงูุฏุฑุฌุฉ ุงูุซุงููุฉ).  ููุฏ ูุฌุญ ุฐูู ุ ูููู ุงูุดูุก ุงููุญูุฏ ุงูุฐู ูู ููุงุณุจูุง ูู ุฃู ุงูุฑูุจูุช ูู ูุชููู ูู ุงููุฑุงูู ูู ุงูููุช ุงูููุงุณุจ ุจุณุฑุนุฉ ุชููู 0.7 ูุชุฑ ูู ุงูุซุงููุฉ.  ูุฐูู ุ ุนูุฏูุง ุญุงู ุงูููุช ุ ูุฑุฑูุง ุฅุนุงุฏุฉ ุจูุงุก ุงูุฎูุงุฑุฒููุฉ ุจุฃููููุง. <br><br>  ุงูุชูุฑุงุฑ ุงูุฃูู ูู ุงูุทุฑูู ุฅูู ุงููุณุงุฑ ุงูุฌุฏูุฏ ูุงู ุงุณุชุจุฏุงู ุงููุชุฌู ุงูุฐู ููุง ุจุตุฏุฏู.  ุงูุขู ูุงู ูุฌููุน ูุงููุงุช ุงูุซูุงุซุฉ ุงูุชุงููุฉ ูุน ูุนุงููุงุช ูุฎุชููุฉ.  ุงูุชูุฑุงุฑ ุงูุซุงูู ูุงู ููุชุจ ุงูุญุฏ ุงูุฃุฏูู ูู ุงููุฒุฉ.  ุจุงุฎุชุตุงุฑ ุ ูุฐุง ุจูุงุก ูุชุนุฏุฏ ุงูุญุฏูุฏ ูู ุงูุฏุฑุฌุฉ ุงูุฎุงูุณุฉ ุ ุญูุซ ุชุนุชูุฏ ุฅุญุฏุงุซูุงุช x ู y ุนูู ููุช ุงููุตูู ุฅูู ูู ููุทุฉ. <br><br><img src="https://habrastorage.org/webt/ho/mw/hd/homwhdagbnkgdlrigettcc6yook.png"><br>  <i>ููุถุญ ุงูุดูู ุฑุณู ุจูุงูู ูุฃุญุฏ ุงูุฅุญุฏุงุซูุงุช ููุงุจู ุงูููุช ุ ููุฐูู ุงูุณุฑุนุฉ ุนูู ุทูู ูุฐุง ุงูุฅุญุฏุงุซู</i> <br><br>  ูุฐุง ุงูููุน ูู ููุธู ุงููุณุงุฑ ููุงุณุจูุง ุฃูุซุฑ ุ ูุฃูู ูุชุทูุจ ูุนุงูุฌุฉ ุฃูู ูุน ุงุฎุชูุงุฑ ูุนุงููุงุช ูุฎุชููุฉ ุ ูุฃู ุฌููุน ุงููุนุงููุงุช ูู ุงูููู ูู ูุซูุฑ ุงูุญุฏูุฏ ุ ูุงูุชู ุชู ุญุณุงุจูุง ุนูู ุฃุณุงุณ ููุช ุงููุตูู ูุงูุณุฑุนุฉ ุงูุญุงููุฉ ูุงูุชุณุงุฑุน ูุณุฑุนุฉ ุงูุฅุฎุฑุงุฌ ูุงูุชุณุงุฑุน. <br><br>  ูุงูุช ูุชูุฌุฉ ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงููุณุงุฑ ุฃููุง ุชูููุง ูู ูุถุงุนูุฉ ูุชูุณุท โโุณุฑุนุฉ ุงูุฑูุจูุช. <br><br>  ููุง ูู ุงูุญุงูุชูู ุงูุณุงุจูุชูู ุ ูุชู ุชุณููุท ุงูุถูุก ุนูู ุฌููุน ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ ูู ููู ูููุตู ูุณูููุฉ ุงูุชูุงุนู.  ูุฐู ุงููุฑุฉ ุ ุชููู ูุฆุฉ PlannerTrajectory ูุณุคููุฉ ุนู ุฅูุดุงุก ูุณุงุฑ ูุนุชูุฏ ุนูู MinimumJerk <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> velocity; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> acceleration; State(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> v_, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> a_) : velocity(v_), acceleration(a_) {} State() { velocity = <span class="hljs-number"><span class="hljs-number">0</span></span>; acceleration = <span class="hljs-number"><span class="hljs-number">0</span></span>; } }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlannerTrajectory</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: nav_msgs::Path global_path; cost_map::CostMap *costmap_ptr; geometry_msgs::PoseStamped Goal_pred; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt; trajectory_x; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>&gt; trajectory_y; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> average_velocity = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Defualt or get from param // double max_velocity = 100; double coef_x[6]; double coef_y[6]; int frequency = 30; // Defualt or get from param // int index; public: PlannerTrajectory(cost_map::CostMap *costmap_, const int &amp;frequency_, const double &amp;max_velocity_, const double &amp;average_velocity_) { average_velocity = average_velocity;; max_velocity = max_velocity_; costmap_ptr = costmap_; frequency = frequency_; Goal_pred.pose.position.x = 0.0; Goal_pred.pose.position.y = 0.0; }</span></span></code> </pre> <br>  <i>ุชุธูุฑ ุงูุตูุฑุฉ ุฌููุน ุงููุชุบูุฑุงุช ุงููุนููุฉ ุงูุชู ูุณุชุฎุฏููุง.</i> <br><br>  ูุชู ุชูููุฒ ูู ุดูุก ุขุฎุฑ ูู ููู ุขุฎุฑ (include / trajectory_regulator.h): ุชููู ููุงุท ูู ุงูููุถูุนุงุช ุ ูุชุญุฏูุฏ ูุง ุฅุฐุง ููุช ุชุฑูุฏ ุงูุงูุชูุงู ุฅูู ุงูููุทุฉ ุงูุชุงููุฉ (ุฅุฐุง ูุงูุช ูู ุนูุจุฉ ุ ููู ูุฐูุจ) ูุงููุฒูุฏ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุงุฌุฑ ุฅูู ROS ููููุฏูู </h3><br>  ุญุชู ุงูุนุงู ุงููุงุถู ุ ุงุณุชุฎุฏููุง ุงูุฅุตุฏุงุฑ lte ูู ROS - ROS ุงูุญุฑููุฉ.  ููุฏ ูุงู ููุงุณุจูุง ููุง ุนููููุง ุ ููู ุฏุนูู ูุตู ุฅูู ููุงูุชู ูู ุงูุนุงู ุงูููุจู ุ ูุงูุนุฏูุฏ ูู ุงูุญุฒู ุงูุชู ูุญุชุงุฌูุง ุจุฏุฃุช ูู ุงูุฎุฑูุฌ ุญุตุฑููุง ูู ROS Melodic.  ุซู ุงุชุถุญ ุฃู costmap_server ุงุณุชุฎุฏููุงูุง ููุณุช ุชุญุช Melodic. <br><br>  ุญุฏุซุช ูุดููุฉ ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ุงูุจุทุงูุงุช. <br><br>  ููุฏ ุงุฎุชุฑูุง ุฎุฑูุทุฉ ุงูุดุจูุฉ ุ ูุธุฑูุง ูุฃู ุงูููุฏุณ ูุชุดุงุจู ุ ูููู ุจุฏุงูุฉ ุงูุฎุฑูุทุฉ ูู ููุงู ูุฎุชูู ุ ูููู ุงูุฎุฑูุทุฉ ููุณูุง ุชุฎุชูู ูู 0 ุฅูู 1. ููุฏ ุฃุตุจุญุช ูุฐู ูุดููุฉ ูุจูุฑุฉ ูู ููุฏุณ ุงูุชููู ุจุฃูููู.  ุฅุฐุง ุชู ูู ููุช ุณุงุจู ุชุดุบูู ุงููุฎุทุท ุงูุนุงููู 50 ูุฑุฉ ูู ุงูุซุงููุฉ (ูุงูุช ููุงู ูููุฏ ุนูู ุงูุชุฑุฏุฏ ุ ูุจุงูุชุงูู ูู ูุชู ุงุณุชุฎุฏุงู ุงููุนุงูุฌ ุฃูุซุฑ ูู ุงููุงุฒู ุ ุญุชู ูู ูุตู ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ) ุ ููุฏ ููุฏ ุงูุขู ุงูุทุฑูู ูู ุซุงููุชูู ูุงุนุชุจุฑู ุณูุฆูุง: ููุฏ ุชู ุชุญููู ููุงุฉ ูุงุญุฏุฉ ุชูุงููุง.  ูู ุบุถูู ุซุงููุชูู ุ ูุงู ุจุฅููุงู ุงูุฑูุจูุช ุนุจูุฑ ุงูุฎุฑูุทุฉ ุจุงููุงูู.  ูุฐุง ูู ููุงุณุจูุง ุ ููุญุงููุงุช ููุงุฒุงุฉ ูุฐู ุงูุนูููุฉ ุงูุชูุช ุจุงููุดู ุ ูุฃูู ูู ูุนุฏ ููุงู ุฃุฏุงุก ููุดุงุฑูุน ุฃุฎุฑู (ูุน ูุฑุงุนุงุฉ ุชูุงููู ุงูููุงุฒุงุฉ). <br><br>  ูุฑุฑูุง ุชุบููุฑ ุงูููุฏุณ ูุฑุฉ ุฃุฎุฑู ุ ูุงูุชุฎูู ุนู ุฎุฑูุทุฉ ุงูุดุจูุฉ ูุตุงูุญ ุดุจูุฉ ุงูุฅุดุบุงู.  ุธูุฑุช ูุดููุฉ ุฌุฏูุฏุฉ - ุนุฏู ุงููุฏุฑุฉ ุนูู ุชุฎุฒูู ุนุฏุฉ ุฅุตุฏุงุฑุงุช ูู ุงูุฎุฑุงุฆุท ูู ููุณ ุงูููุช (ุนูู ุณุจูู ุงููุซุงู ุ ูุงููุฉ ุ ูุน ูู ุงูุนูุจุงุช ุ ูุฎุฑูุทุฉ ุซุงุจุชุฉ ุ ูุน ุนูุจุงุช ุฏููุงููููุฉ ููุท).  ุฃูุฏ ุฃู ุฃููู ุจุชุบููุฑ ูุตู ุงูููุฏ ุงูุฐู ูู ููู ููุซูููุง ุจู ุจุดูู ุฎุงุต.  ูุฐูู ุ ูุฑุฑูุง ุงูุจุญุซ ุนู ุญููู ุจุฏููุฉ ููุฐู ุงููุดููุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  ุฎุงุฏู ุฎุฑูุทุฉ ุงูุชูููุฉ </h4><br>  ุจุนุฏ ุจุญุซ ุทููู ุ ูุฌุฏูุง ุฎุฑุงุฆุท ุดููุฉ costmap_serverr: <a href="" rel="nofollow">https://github.com/lelongg/cost_map.git</a> - ูููุฏุฉ ููุบุงูุฉ ููุธุงู ุงูุดููุฉ ูุฏููุง. <br><br><img src="https://habrastorage.org/webt/27/rb/oh/27rbohj3kefxprwtjqrg4mwtqjc.png"><br><br>  ูุงูุขู ุ ุจุฏูุงู ูู ุฎุฏูุฉ ุฎุฑูุทุฉ ุงูุดุจูุฉ ููุท ุ ููุชุณููู ุ ูุฌุญูุง ูู ุญุณุงุจ ุงููููุน ุงููุญุชูู ููุนุฏู ุจูุงุกู ุนูู ุงูุชูุจุค ุจููุชุฑ Kalman. <br><br><img src="https://habrastorage.org/webt/ni/pm/nz/nipmnzvhcrqdje1cu8glf9quude.png"><br><br>  ุฃุญุฏ ุฃูู ุงูุฃุดูุงุก ูุฎุงุฏู ุงูุฎุฑุงุฆุท ูู ููู ุงูุฎุฑูุทุฉ ุ ูุงูุฐู ููุณุชุฎุฏู ูุฅูุดุงุก ุฃููู ูุฌููุน ุงูุทุจูุงุช ุ ูุงูุชู ูุชู ุชุญุฏูุซูุง ูุงุญููุง ููุท.  ุฅููุง ุตูุฑุฉ ุซูุงุฆูุฉ ุจุงุจูุง ููู ุบูููุง ุ ุญูุซ ูููู ุงูุฃุณูุฏ ุนูุจุฉ ูุงูุฃุจูุถ ููุทูุฉ ุญุฑุฉ. <br><br><img src="https://habrastorage.org/webt/2b/l5/rg/2bl5rgpuecb7he51heslqpvcazm.png"><br><br>  ููุฌุฏ ุฃูุถูุง ููู ุฅุนุฏุงุฏุงุช ูุชูููู cost_map_server.  ุฃูู ูุญุชูู ุนูู ููุงุถูุน ูุน ููุงุท ุงูุนุฏู ุ ูููุทูุฉ ุงูุชุถุฎู ูุญุฌู ุงููุฑุจุน ุ ูุงูุชู ูููู ุฃู ุชุณุชุฎุฏู ุฃูุถุง ููุถุน ููุทูุฉ ุงูุนุฏู ุงูุฎุทุฑุฉ ุนูู ุงูุฎุฑูุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">########################### # cost_map_server params ## ########################### cost_map_server/big_robot_size: <span class="hljs-number"><span class="hljs-number">0.4</span></span> cost_map_server/little_robot_size: <span class="hljs-number"><span class="hljs-number">0.4</span></span> cost_map_server/cube_size: <span class="hljs-number"><span class="hljs-number">0.11</span></span> cost_map_server/inscribed_radius: <span class="hljs-number"><span class="hljs-number">0.25</span></span> cost_map_server/inflation_radius: <span class="hljs-number"><span class="hljs-number">0.25</span></span> cost_map_server/inflation_exponential_rate: <span class="hljs-number"><span class="hljs-number">0.6</span></span> cost_map_server/big_robot1: <span class="hljs-string"><span class="hljs-string">"/aruco/robot1"</span></span> cost_map_server/big_robot2: <span class="hljs-string"><span class="hljs-string">"/aruco/robot2"</span></span> cost_map_server/small_robot1: <span class="hljs-string"><span class="hljs-string">"/aruco/robot3"</span></span> cost_map_server/small_robot2: <span class="hljs-string"><span class="hljs-string">"/aruco/robot4"</span></span> cost_map_server/collision: <span class="hljs-string"><span class="hljs-string">"collision"</span></span> cost_map_server/image_resource_name: <span class="hljs-string"><span class="hljs-string">"$(find cost_map_server)/param/image_resource.yaml"</span></span> cost_map_server/min_diff_points: <span class="hljs-number"><span class="hljs-number">0.01</span></span></code> </pre> <br>  ูุชู ูุดุฑ ุฌููุน ุงูุทุจูุงุช ููุท ุฅุฐุง ุงุดุชุฑู ุดุฎุต ูุง ูููุง: <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PublishChanges</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ nav_msgs::OccupancyGrid msg; cost_map_msgs::CostMap cost_map_msg; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obstacle_inflation_publisher.getNumSubscribers() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { cost_map::toOccupancyGrid(costmap, <span class="hljs-string"><span class="hljs-string">"obstacle_layer"</span></span>, msg); obstacle_inflation_publisher.publish(msg); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inflation_publisher.getNumSubscribers() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { cost_map::toOccupancyGrid(costmap, <span class="hljs-string"><span class="hljs-string">"inflation_layer"</span></span>, msg); inflation_publisher.publish(msg); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cost_map_publisher.getNumSubscribers() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { cost_map::toMessage(costmap, cost_map_msg); cost_map_publisher.publish(cost_map_msg); } }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุชุดุบูู ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู </h3><br>  ูุจุฏุก ุงูููุฏุณ ุจุงููุงูู ุ ูุฌุจ ุนููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุถุน ุฑูุณ </li><li style=";text-align:right;direction:rtl">  cost_map_server cost_map_server_alone.launch - ูุจุฏุก ุงูุฎุฑูุทุฉ </li><li style=";text-align:right;direction:rtl">  roslaunch global_planner global_planner.launch - ุฅุทูุงู ุงููุณูู ุงูุนุงููู ูุน ุงููุนููุงุช </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rosparam load $ (find local_planner) /param/param.yaml </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rosrun local_planner local_planning </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rosrun trajectory_regulator </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rosrun global_planner ุงููุญุฑู </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rosrun rviz </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุถุงูุฉ ุชุถุฎู </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุขู ุฃุฑุณู ุฑุณุงูุฉ ุฅูู ุงูููุถูุน / gp / ุงููุฏู ุ ูุฑุณู ุงูุฑูุจูุช ุฅูู ุงูููุทุฉ ุงููุทููุจุฉ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุฌุฉ ูุฅุทูุงู ุฌููุน ุงูุนูุงุตุฑ ุ ุณูููู ูุฏูู ูุญุงูุงุฉ ุฌุงูุฒุฉ ูุฅุทูุงู ูุฌููุนุชูุง ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู. </font></font><a href="https://github.com/lelongg/cost_map" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดููุฉ ุงููุงุฒูุฉ</font></font></a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/iRY5WHgAFns" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุจุฏุงูุฉ ุ ุงุญุชุฌูุง ุฅูู ูุธุงู ุงูููุงุญุฉ ุงูุฐู ุณูุณุงุนุฏูุง ุนูู ููุงุฏุฉ ุงูุฑูุจูุช ุจุดูู ุฌููู ูุณุฑูุน ูุจุฏูุฉ ุนูู ุนุฌูุงุช ูุชุนุฏุฏุฉ ุงูุงุณุชุฎุฏุงูุงุช. </font><font style="vertical-align: inherit;">ุฃุซูุงุก ุงูุงุณุชุนุฏุงุฏ ูููุณุงุจูุฉ ุ ูู ุชูุฌุฑุญ ูุทุฉ ูุงุญุฏุฉ ุ ูุงูุฑูุจูุช ูุณูู. </font><font style="vertical-align: inherit;">ูุชูุฌุฉ ูุฐูู ุ ูุฏููุง ูุฌููุนุฉ ุชููู ุฎูููุฉ ุงููุฒู ูููุณุงุจูุงุช ุงูููุงุซูุฉ ูู eurobot ุ ูุงูุชู ูุญู ุฑุงุถูู ุชูุงููุง ุนููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ููุง ุ ูุฐู ุงูููุฏุณ ุฃูุถู ูู ุงููุนูุงุฑ ุ ููู ... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram: t.me/SetUpSber </font><a href="https://github.com/ristle/EUrobotNavigation" rel="nofollow"><font style="vertical-align: inherit;">ูุณุชูุฏุน ูู</font></a><font style="vertical-align: inherit;"> ุฅุจุฏุงุนุงุชูุง</font></font><br> <a href="https://github.com/ristle/EUrobotNavigation" rel="nofollow"><font style="vertical-align: inherit;"></font></a> <br><br><img src="https://habrastorage.org/webt/98/gl/4m/98gl4mdibk20qgavmhzkbdppu4w.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar479636/">https://habr.com/ru/post/ar479636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar479602/index.html">ูุง ูู ุงูุฌูููู ุงููุงูู ูููุงุฐุง ูู ูุทููุจ</a></li>
<li><a href="../ar479618/index.html">Postgres Pro Standard 12.1 Release</a></li>
<li><a href="../ar479620/index.html">ุนูุณ ุงูููุทู</a></li>
<li><a href="../ar479622/index.html">ููู ูุนูู ุงููููุฐุฌ ุงูุฃููู ูููุนุงููุงุช ูุฌูููุฉ ุงููุตุฏุฑ ุนูู blockchain Waves</a></li>
<li><a href="../ar479624/index.html">Postgres Professional gendar Oleg Bartunov ูุฎุจุฑ Faride Roslovets ุนู PostgreSQL ูุงูุฃุนูุงู ูู ุฑูุณูุง</a></li>
<li><a href="../ar479642/index.html">ููู ุฃุฏุช ุงููุฑุงุฑุงุช ุงูุบุจูุฉ ุนูุฏ ุชุตููู ุทุงุฆุฑุฉ ุงูุญุฑุจ ุงูุนุงูููุฉ ุงูุซุงููุฉ ุฅูู ุฅูุดุงุก ูุงููุชูุด</a></li>
<li><a href="../ar479644/index.html">ูููุงุช ุจุณูุทุฉ ุนู ุงูุจุฑูุงูุฌ</a></li>
<li><a href="../ar479646/index.html">ูุตูุญุฉ ุณูุฆุฉ ุฃู ุฃุณุจุงุจ ูููุงุตูุฉ ุชุนูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุจุนุฏ ุงููุฑุญูุฉ ุงููุชูุณุทุฉ</a></li>
<li><a href="../ar479650/index.html">ุฃุนูู 12 ุงูุฑุณูู ุงูุจูุงููุฉ ุฏููุงููููุฉ ุชูููููุฌูุง ุงููุนูููุงุช ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู</a></li>
<li><a href="../ar479654/index.html">ูููุฏ Django vue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>