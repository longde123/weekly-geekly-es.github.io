<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõéÔ∏è üëéüèø üöù L'√©quipe d'OC √† la rescousse üë∏üèª üë¥üèª üë®üèæ‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si vous √™tes sp√©cial dans OpenShift, il est peu probable que ce message vous r√©v√®le beaucoup. Mais si vous commencez tout juste √† le ma√Ætriser, cela v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'√©quipe d'OC √† la rescousse</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redhatrussia/blog/418437/">  Si vous √™tes sp√©cial dans OpenShift, il est peu probable que ce message vous r√©v√®le beaucoup.  Mais si vous commencez tout juste √† le ma√Ætriser, cela vous fera √©conomiser beaucoup de temps et de nerfs.  Nous avons demand√© √† Jorge Tudela Gonz√°lez de Riancho, consultant cloud au bureau espagnol de Red Hat, d'√©crire quelques astuces de vie pour l'utilitaire <b>oc</b> . <br><br><img src="https://habrastorage.org/webt/zh/kf/gi/zhkfgilrrxy812dtaohqdmq2yp4.jpeg" width="100%"><br><br>  C'est une √©quipe sympa, elle est bien pens√©e, elle est puissante, elle est flexible et, comme vous le verrez, elle a de nombreuses fonctionnalit√©s cach√©es qui valent la peine d'√™tre essay√©es. <br><a name="habracut"></a><br><h3>  1. Tout d'abord: le d√©bogage </h3><br>  Lorsque je ne sais pas ce qui se passe ou que j'obtiens un message d'erreur incompr√©hensible, j'utilise toujours l'indicateur <b>--loglevell</b> , qui permet de se <b>connecter</b> √† stderr.  Selon la valeur de cet indicateur, vous pouvez voir les appels curl API Rest, le contenu des r√©ponses API Rest ou des informations encore plus d√©taill√©es. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/ar/vh/a8arvhttnjslfgroilh4yokkhfy.png"></div><br><br> <code>$ oc --loglevel 7 get pod <br> ... <br> I0216 21:24:12.027793 973 cached_discovery.go:72] returning cached discovery info from /home/jtudelag/.kube/192.168.42.77_8443/v1/serverresources.json <br> I0216 21:24:12.028046 973 round_trippers.go:383] GET https://192.168.42.77:8443/api/v1/namespaces/myproject/pods <br> I0216 21:24:12.028052 973 round_trippers.go:390] Request Headers: <br> I0216 21:24:12.028057 973 round_trippers.go:393] Accept: application/json <br> I0216 21:24:12.028061 973 round_trippers.go:393] User-Agent: oc/v1.7.6+a08f5eeb62 (linux/amd64) kubernetes/c84beff <br> I0216 21:24:12.053230 973 round_trippers.go:408] Response Status: 200 OK in 25 milliseconds <br> I0216 21:24:12.055143 973 cached_discovery.go:119] returning cached discovery info from /home/jtudelag/.kube/192.168.42.77_8443/servergroups.json <br> I0216 21:24:12.055228 973 cached_discovery.go:72] returning cached discovery info from /home/jtudelag/.kube/192.168.42.77_8443/authentication.k8s.io/v1/serverresources.json <br> I0216 21:24:12.055288 973 cached_discovery.go:72] <br> ... <br></code> <br>  Par exemple, loglevel 9 est tr√®s pratique lorsque vous corrigez un objet OCP, car il vous permet de voir le correctif lui-m√™me (le contenu de la demande d'API). <br><br>  Si, par exemple, un patch change le nom du service en ¬´app: hello-jorge¬ª, il ressemblera √† ceci: <br><br> <code>$ oc --loglevel 9 edit svc hello-openshift <br> ... <br> I0216 21:33:15.786463 1389 request.go:994] Request Body: {"metadata":{"labels":{"app":"hello-jorge"}}} <br> I0216 21:33:15.786590 1389 round_trippers.go:386] curl -k -v -XPATCH -H "Accept: application/json" -H "Content-Type: application/strategic-merge-patch+json" -H "User-Agent: oc/v1.7.6+a08f5eeb62 (linux/amd64) kubernetes/c84beff" https://192.168.42.77:8443/api/v1/namespaces/myproject/services/hello-openshift <br> I0216 21:33:15.797185 1389 round_trippers.go:405] PATCH https://192.168.42.77:8443/api/v1/namespaces/myproject/services/hello-openshift 200 OK in 10 milliseconds <br> ... <br></code> <br>  <b>Remarque</b>  En p√©riode de d√©sespoir, au lieu d'un neuf, vous pouvez conduire plusieurs √† la fois.  La sortie de la commande <b>oc</b> ne changera pas √† partir de cela, mais cela peut vous sembler mieux. <br><br> <code>$ oc --loglevel 9999 get pod <br></code> <br><h3>  2. su - </h3><br>  Oui, vous avez bien compris.  La commande <b>oc</b> peut √™tre ex√©cut√©e au nom d'un autre utilisateur ou, en utilisant le langage OCP, utiliser l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">emprunt d'identit√©</a> .  Bien s√ªr, avec les droits appropri√©s.  Et pour cela, il suffit d'utiliser le drapeau <b>--as</b> . <br><br>  Par exemple: <br><br> <code>#     jorge <br> $ oc --as=jorge get pods <br></code> <br>  L'emprunt d'identit√© fonctionne non seulement pour les utilisateurs, mais aussi pour les groupes: <br><br> <code>#     developers <br> $ oc --as-group=developers get pods <br></code> <br>  L'emprunt d'identit√© est utile dans divers cas.  Par exemple, lorsque vous devez v√©rifier si l'utilisateur peut effectuer l'une ou l'autre action, ou voir ce que lui <b>envoie la</b> commande <b>oc</b> .  L'emprunt d'identit√© contribue √©galement beaucoup √† la confusion avec les r√¥les et les autorisations. <br><br><h3>  3. Whoami </h3><br>  L'√©quipe <b>oc whoami</b> est probablement famili√®re √† tout le monde.  Surtout le drapeau <b>-t</b> , qui vous permet d'obtenir le jeton de m√©dia pour l'utilisateur / session en cours.  Mais que se passe-t-il si vous avez un jeton, mais que vous n'en √™tes pas le propri√©taire? <br><br>  Dans ce cas, vous pouvez vous connecter √† OpenShift √† l'aide de ce jeton, puis ex√©cuter la <b>commande oc whoami</b> .  Bien, attendez, vous pouvez imm√©diatement trouver le nom du propri√©taire en passant simplement le jeton √† la <b>commande oc whoami comme</b> troisi√®me argument sans aucun indicateur. <br><br>  Voir: <br> <code>#   <br> $ token=$(oc whoami -t) <br> <br> #     <br> $ oc whoami $token <br> jorge <br></code> <br><h3>  4. oc debug </h3><br>  Comme vous le savez, un shell peut √™tre ex√©cut√© directement dans un pod en cours d'ex√©cution.  Parfois, il est utile de faire une copie compl√®te de la configuration du pod en cours d'ex√©cution et de d√©panner le shell.  Il s'agit de la m√©thode dite par d√©faut. <br><br>  Jetez maintenant un ≈ìil √† ce que les options de <b>d√©bogage oc</b> vous permettent de faire: vous pouvez ex√©cuter le conteneur en tant que root ou tout autre utilisateur;  vous pouvez l'ex√©cuter sur le n≈ìud s√©lectionn√© ou vous pouvez l'ex√©cuter non pas un shell, mais une autre commande. <br><br>  Dans ce cas, vous devez sp√©cifier le bon DC, par exemple: <br> <code>#  shell  pod' dc/jorge <br> $ oc debug dc/jorge <br> <br> #   ,   root <br> $ oc debug --as-root=true dc/jorge <br></code> <br><h3>  5. oc expliquer </h3><br>  Les objets OpenShift / Kubernetes ont parfois un grand nombre de champs.  Lorsque vous recherchez des exemples de d√©finitions pour de tels objets, vous devez souvent vous tourner vers la documentation d'OCP ou d'autres sources principales.  Cependant, vous pouvez √©galement utiliser la commande <b>oc expliquer</b> . <br><br>  Cette commande affiche la documentation sur les ressources et leurs champs, ce qui est tr√®s utile lors de la d√©claration de nouveaux objets OCP ou dans les cas o√π vous n'avez pas acc√®s √† la documentation OCP officielle. <br><br>  Par exemple, voici comment obtenir la documentation du pod et une description des champs d'affinit√©: <br><br><pre> # obtenir de l'aide sur le pod
 $ oc expliquer pod
 DESCRIPTION:
 Pod est une collection de conteneurs pouvant s'ex√©cuter sur un h√¥te.  Cette ressource est cr√©√©e par les clients et planifi√©e sur les h√¥tes.

 CHAMPS:
   m√©tadonn√©es &lt;Objet&gt;
     M√©tadonn√©es de l'objet standard.  Plus d'infos:
     http://releases.k8s.io/HEAD/docs/devel/api-conventions.md#metadata

   spec &lt;Objet&gt;
     Sp√©cification du comportement souhait√© du pod.  Plus d'infos:
     http://releases.k8s.io/HEAD/docs/devel/api-conventions.md#spec-and-status

   statut &lt;Objet&gt;
     Dernier √©tat observ√© de la gousse.  Ces donn√©es peuvent ne pas √™tre √† jour.
     Peupl√© par le syst√®me.  Lecture seule.  Plus d'infos:
     http://releases.k8s.io/HEAD/docs/devel/api-conventions.md#spec-and-status

   apiVersion &lt;cha√Æne&gt;
     APIVersion d√©finit le sch√©ma versionn√© de cette repr√©sentation d'un
     objet.  Les serveurs doivent convertir les sch√©mas reconnus vers la derni√®re version interne
     et peut rejeter des valeurs non reconnues.  Plus d'infos:
     http://releases.k8s.io/HEAD/docs/devel/api-conventions.md#resources

   genre &lt;cha√Æne&gt;
     Kind est une valeur de cha√Æne repr√©sentant la ressource REST de cet objet
     repr√©sente.  Les serveurs peuvent d√©duire cela du point final soumis par le client
     demande.  Ne peut √™tre mis √† jour.  Dans CamelCase.  Plus d'infos:
     http://releases.k8s.io/HEAD/docs/devel/api-conventions.md#types-kinds

 # obtenir la description du champ d'affinit√©
 $ oc explique pod.spec.affinity
 RESSOURCE: affinit√© &lt;Objet&gt;

 DESCRIPTION:
     Si sp√©cifi√©, les contraintes de planification du pod

    L'affinit√© est un groupe de r√®gles de planification d'affinit√©.

 CHAMPS:
   nodeAffinity &lt;Object&gt;
     D√©crit les r√®gles de planification d'affinit√© de n≈ìud pour le pod.

   podAffinity &lt;Object&gt;
     D√©crit les r√®gles de programmation d'affinit√© des pods (par exemple, colocaliser ce pod dans le
     m√™me noeud, zone, etc.  comme certains autres pods).

   podAntiAffinity &lt;Objet&gt;
     D√©crit les r√®gles de planification anti-affinit√© des pods (par exemple, √©vitez de placer ce pod
     dans le m√™me n≈ìud, zone, etc.  comme certains autres pods).
</pre><br><h3>  6. Oubliez grep, awk, cut, etc. </h3><br>  Une autre fonctionnalit√© int√©ressante de la commande <b>oc</b> est les fonctions de formatage de sortie int√©gr√©es.  <b>Tout le monde</b> conna√Æt les <b>options</b> <b>-o json</b> ou <b>-o yaml</b> , mais le drapeau <b>-o</b> a de nombreuses autres options. <br><br>  Les plus puissants sont probablement <b>go-template</b> et <b>jsonpath</b> : <br><br> <code>json|yaml|wide|name|custom-columns=...|custom-columns-file=...|go-template=...|go-template-file=...|jsonpath=...|jsonpath-file=... <br></code> <br>  Supposons que vous souhaitiez savoir quel service est fourni par une route sp√©cifique (la route du registre des dockers): <br><br> <code>#  ,  ,       my-docker-registry.example.com <br> $ oc get routes -o=go-template='{{range .items}}{{if eq .spec.host "my-docker-registry.example.com"}}{{.metadata.name}}{{end}}{{end}}' <br> docker-registry <br></code> <br>  Ou, disons que vous devez conna√Ætre la strat√©gie de d√©ploiement du routeur dc router: <br><br> <code>#     <br> $ oc get dc router -o=go-template='{{ .spec.strategy.type }}' <br> Rolling <br></code> <br>  Comme vous pouvez le voir, <b>oc</b> est une √©quipe incroyable.  Cela vaut vraiment la peine de jouer avec, car c'est l'une des choses les plus cool d'OpenShift. <br><br>  Si vous souhaitez en savoir plus sur les fonctionnalit√©s int√©ressantes d'OpenShift, nous vous recommandons de consulter notre blog des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©veloppeurs Red Hat</a> - vous y trouverez non seulement des articles de nos d√©veloppeurs sur presque tous les sujets, mais √©galement un √©norme catalogue de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">litt√©rature gratuite</a> .  Et vous pouvez rafra√Æchir notre article sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fa√ßon de d√©ployer Minishift sur votre ordinateur portable et de commencer √† vivre</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418437/">https://habr.com/ru/post/fr418437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418423/index.html">Maison intelligente: une nouvelle dimension de confort et la recherche de l'excellence. Premi√®re partie</a></li>
<li><a href="../fr418427/index.html">Indexation mobile d'abord. Comment et pourquoi le graphique des liens va-t-il changer?</a></li>
<li><a href="../fr418429/index.html">Mon exp√©rience professionnelle pour le r√¥le de coach agile en Europe, deuxi√®me partie</a></li>
<li><a href="../fr418431/index.html">Probl√®mes imaginaires - la racine des mauvais logiciels</a></li>
<li><a href="../fr418433/index.html">4 ao√ªt Peter. La premi√®re qu√™te de v√©lo pour les programmeurs</a></li>
<li><a href="../fr418439/index.html">Notions de base sur les applications Web progressives</a></li>
<li><a href="../fr418441/index.html">Bases de l'√©l√©vation de privil√®ges Windows</a></li>
<li><a href="../fr418443/index.html">GObject: encapsulation, instanciation, introspection</a></li>
<li><a href="../fr418445/index.html">Django Channels - la r√©ponse au web moderne</a></li>
<li><a href="../fr418447/index.html">Pourquoi Moscow Python Conf est maintenant ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>