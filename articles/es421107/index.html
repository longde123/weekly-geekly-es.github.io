<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßíüèº üë≤ üåó Desmontamos y vemos certificados calificados usando Python / Tkinter üõÄüèª üíõ ü§©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los certificados calificados se convirtieron r√°pidamente en una parte integral de la vida cotidiana. Y cada vez m√°s personas quieren ver a esta "besti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desmontamos y vemos certificados calificados usando Python / Tkinter</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421107/"><img src="https://habrastorage.org/webt/nc/op/59/ncop592ddqui_ckgkjas77-ccuq.png" align="left">  Los certificados calificados se convirtieron r√°pidamente en una parte integral de la vida cotidiana.  Y cada vez m√°s personas quieren ver a esta "bestia" desde adentro.  Esto es por un lado.  Por otro lado, se est√°n desarrollando m√°s y m√°s aplicaciones en las que se utiliza la informaci√≥n de estos certificados.  Y estos no son solo atributos del TIN o BIN del propietario o editor del certificado.  Esta puede ser informaci√≥n sobre qu√© proveedor criptogr√°fico fue utilizado por el titular del certificado (atributo subjectSignTool) para generar una clave privada o sobre la base de qu√© certificado significa que se cre√≥ un centro de certificaci√≥n (CA) que emiti√≥ un certificado.  Y si escribe un programa que analizar√° los certificados emitidos, puede recopilar estad√≠sticas interesantes sobre qu√© herramientas de protecci√≥n de la informaci√≥n criptogr√°fica son utilizadas por los titulares de certificados y sobre la base de qu√© fondos (aunque menos interesantes) certificados (o no certificados) CA se implementan (atributo issuerSignTools): <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/iy/l7/-z/iyl7-zghkwsdmk4zfzx9fa1azma.png"><br><br>  En los espacios abiertos de Habr, ya se hizo un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">intento</a> exitoso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de</a> desarmar un certificado calificado.  Desafortunadamente, el an√°lisis solo se refer√≠a a la recepci√≥n de los atributos TIN, PSRN y SNILS que forman parte del DN de nombre distinguido.  Aunque, ¬øpor qu√© lamentablemente?  El autor ten√≠a un problema espec√≠fico y se resolvi√≥.  Queremos acceder a los atributos de un certificado calificado a trav√©s de Python y ofrecer una utilidad gr√°fica para verlos. <br><br>  Para acceder a los atributos del certificado, utilizaremos el paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fsb795</a> .  El paquete est√° disponible tanto para Pytho2 como para Python3, tanto para Linux como para Windows.  Para instalarlo, simplemente ejecute el comando tradicional: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># python -m pip install fsb795 Collecting fsb795 Requirement already satisfied: pyasn1-modules&gt;=0.2.2 in /usr/lib/python2.7/site-packages (from fsb795) (0.2.2) Collecting pyasn1&gt;=0.4.4 (from fsb795) Using cached https://files.pythonhosted.org/packages/d1/a1/7790cc85db38daa874f6a2e6308131b9953feb1367f2ae2d1123bb93a9f5/pyasn1-0.4.4-py2.py3-none-any.whl Requirement already satisfied: six in /usr/lib/python2.7/site-packages (from fsb795) (1.11.0) Installing collected packages: pyasn1, fsb795 Successfully installed fsb795-1.5.2 pyasn1-0.4.4 [root@localhost GCryptGOST]#</span></span></code> </pre> <br>  El paquete fsb795 requiere los paquetes pyasn1 y pyasn1-modules.  Por lo tanto, si no est√°n instalados, se intentar√° instalarlos. <br><br>  Para python3, este comando se ve as√≠: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># python -m pip install fsb795 ... #</span></span></code> </pre> <br>  Tambi√©n puede descargar los paquetes de instalaci√≥n <a href="">python3</a> y <a href="">python2</a> e <a href="">instalarlos</a> localmente. <br>  El nombre del paquete, por analog√≠a con los m√≥dulos del paquete pyasn1-modules, por ejemplo, rfc2459, etc., indica que est√° dise√±ado para trabajar con certificados que cumplan con los requisitos de la Orden del Servicio Federal de Seguridad de la Federaci√≥n de Rusia del 27 de diciembre de 2011 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">No. 795</a> ‚ÄúEn aprobaci√≥n requisitos para la forma de un certificado calificado ... ". <br><br>  El acceso al certificado en el paquete fsb795 se implementa a trav√©s de la clase Certificado: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import os, sys import pyasn1 import binascii import six from pyasn1_modules import rfc2459, pem from pyasn1.codec.der import decoder from datetime import datetime, timedelta class Certificate: #  cert_full = '' cert = '' pyver = '' formatCert = '' def __init__ (self,fileorstr): #     if not os.path.exists(fileorstr): #  ,  ,     #    PEM- strcert = fileorstr.strip('\n') if (strcert[0:27] != '-----BEGIN CERTIFICATE-----'): return idx, substrate = pem.readPemBlocksFromFile(six.StringIO( strcert), ('-----BEGIN CERTIFICATE-----', '-----END CERTIFICATE-----') ) self.pyver = sys.version[0] try: self.cert_full, rest = decoder.decode(substrate, asn1Spec=rfc2459.Certificate()) self.cert = self.cert_full["tbsCertificate"] self.formatCert = 'PEM' except: self.pyver = '' self.formatCert = '' return #   #  self.pyver   python self.pyver = sys.version[0] filename = fileorstr if (self.pyver == '2'): if sys.platform != "win32": filename = filename.encode("UTF-8") else: filename = filename.encode("CP1251") #  DER file1 = open(filename, "rb") substrate = file1.read() if (self.pyver == '2'): b0 = ord(substrate[0]) b1 = ord(substrate[1]) else: b0 = substrate[0] b1 = substrate[1] #  PEM/DER,   0x30,       127  if (b0 == 48 and b1 &gt; 128) : self.formatCert = 'DER' else: self.formatCert = 'PEM' file1 = open(filename, "r") idx, substrate = pem.readPemBlocksFromFile( file1, ('-----BEGIN CERTIFICATE-----', '-----END CERTIFICATE-----') ) file1.close() try: self.cert_full, rest = decoder.decode(substrate, asn1Spec=rfc2459.Certificate()) self.cert = self.cert_full["tbsCertificate"] except: self.pyver = '' self.formatCert = '' #       def subjectSignTool(self): . . . #,     if __name__ == "__main__": . . .</span></span></code> </pre> <br>  Para crear una instancia de un objeto para un certificado espec√≠fico, es suficiente ejecutar la siguiente declaraci√≥n: <br><br><pre> <code class="bash hljs">$ python Python 2.7.15 (default, May 23 2018, 14:20:56) [GCC 5.4.0] on linux Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> or <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;import fsb795 &gt;&gt;tek_cert = fsb795.Certificate(&lt;/  &gt;) &gt;&gt;</code> </pre><br>  Como par√°metro, al crear una instancia de la clase, se especifica un certificado, que puede estar en un archivo PEM o DER o ser una cadena en formato PEM. <br><br>  Despu√©s de la creaci√≥n, cada instancia tiene cuatro atributos: pyver, formatCert, cert_full y cert. <br>  Usando el atributo pyver, puede verificar c√≥mo fue el an√°lisis del certificado.  Si pyver es igual a una cadena vac√≠a, entonces el archivo o cadena no contiene un certificado.  De lo contrario, el atributo pyver contiene la versi√≥n del lenguaje python: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>c1=fsb795.Certificate(<span class="hljs-string"><span class="hljs-string">'     '</span></span>) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c1.pyver == <span class="hljs-string"><span class="hljs-string">''</span></span>): ... <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'   '</span></span>) ...     &gt;&gt;&gt; c2 = fsb795.Certificate(<span class="hljs-string"><span class="hljs-string">'/home/a513/cert_nss.der'</span></span>) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c2.pyver != <span class="hljs-string"><span class="hljs-string">""</span></span>): ... print(c2.pyver) ... <span class="hljs-number"><span class="hljs-number">2</span></span> &gt;&gt;&gt; print(c2.formatCert) DER &gt;&gt;&gt;</code> </pre> <br>  El atributo formatCert, al crear con √©xito una instancia de la clase Certificado, contiene el tipo de formato de archivo / cadena del certificado.  Puede ser PEM o DER.  Por qu√© se necesita este atributo se aclarar√° a continuaci√≥n. <br><br>  El paquete fsb795 se cre√≥ con el paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pyasn1</a> .  Entonces, dos atributos permanecieron sin examinar.  El atributo cert almacena el certificado tbs, listo para usar con el paquete pyasn1.  Otro atributo cert_full almacena el certificado descodificado completo con respecto a rfc2459.  Mostramos c√≥mo obtener el algoritmo de clave p√∫blica con el atributo cert y el paquete pyasn1 conectado: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>pubkey = c2.cert[<span class="hljs-string"><span class="hljs-string">'subjectPublicKeyInfo'</span></span>] &gt;&gt;&gt; ff = pubkey[<span class="hljs-string"><span class="hljs-string">'algorithm'</span></span>] &gt;&gt;&gt; ff1 = ff[<span class="hljs-string"><span class="hljs-string">'algorithm'</span></span>] &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (ff1) <span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> &gt;&gt;&gt;</code> </pre> <br>  Al final, ser√° posible evaluar las capacidades del paquete fsb795 para obtener informaci√≥n sobre la clave p√∫blica de un certificado calificado. <br><br>  Cuando se crea con √©xito una instancia de la clase Certificado, tenemos a nuestra disposici√≥n m√©todos que facilitan la obtenci√≥n de los datos necesarios del certificado.  Toda la informaci√≥n sobre la clave p√∫blica se puede obtener de la siguiente manera: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>c3 = fsb795.Certificate(<span class="hljs-string"><span class="hljs-string">'cert.der'</span></span>) &gt;&gt;&gt; key_info=c3.publicKey() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> opt <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> key_info.keys(): ... val = str(key_info[opt]) ... <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (opt + <span class="hljs-string"><span class="hljs-string">'='</span></span> + val) ... curve=<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> hash=<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.30</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> valuepk=<span class="hljs-number"><span class="hljs-number">5</span></span>b785f86f0dd5316ba37c8440e398e83f2ec0c34478f90da9c0c8046d341ff66f9044cd00a0e25530 acefd51e6be852dbecacbaabc55e807be8e1f861658bd58 algo=<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.643</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> &gt;&gt;&gt;</code> </pre><br>  Actualmente, la clase Certificado contiene los siguientes m√©todos: <br><br><ul><li>  subjectSignTool (): devuelve una cadena con el nombre del titular del certificado de protecci√≥n de informaci√≥n criptogr√°fica </li><li>  issuerSignTool (): devuelve una lista de cuatro elementos con herramientas criptogr√°ficas de informaci√≥n del emisor del certificado; </li><li>  classUser (): devuelve una cadena con los oids de las clases de seguridad del certificado de protecci√≥n de informaci√≥n criptogr√°fica del titular del certificado, separados por los caracteres ";;"; </li><li>  issuerCert () - devuelve un diccionario con campos y valores del nombre distintivo DN del emisor del certificado y un n√∫mero que identifica el certificado (2 - entidad legal); </li><li>  subjectCert () - devuelve un diccionario con los campos y valores del nombre distinguido DN del titular del certificado y un n√∫mero que identifica el certificado (2 - entidad legal); </li><li>  publicKey (): devuelve un diccionario que contiene el valor clave ('valuepk') y los par√°metros clave ('curva' y 'hash'); </li><li>  signatureCert: devuelve dos valores: el algoritmo de firma y el valor de firma; </li><li>  validityCert: devuelve un diccionario con dos claves 'not_after' y 'not_before'; </li><li>  keyUsage (): devuelve una lista de √°mbitos clave; </li><li>  serialNumber (): devuelve el n√∫mero de serie del certificado en forma decimal; </li><li>  prettyPrint (): devuelve una cadena con una 'impresi√≥n' del certificado en t√©rminos de pyasn1 (self.cert_full.prettyPrint ()). </li></ul><br>  El spoiler contiene un ejemplo de prueba que demuestra claramente el trabajo de estos m√©todos. <br><br><div class="spoiler">  <b class="spoiler_title">Prueba test795.py para probar el paquete fsb795</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fsb795 certpem = <span class="hljs-string"><span class="hljs-string">""" -----BEGIN CERTIFICATE----- MIIG3DCCBougAwIBAgIKE8/KkAAAAAAC4zAIBgYqhQMCAgMwggFKMR4wHAYJKoZI hvcNAQkBFg9kaXRAbWluc3Z5YXoucnUxCzAJBgNVBAYTAlJVMRwwGgYDVQQIDBM3 NyDQsy4g0JzQvtGB0LrQstCwMRUwEwYDVQQHDAzQnNC+0YHQutCy0LAxPzA9BgNV BAkMNjEyNTM3NSDQsy4g0JzQvtGB0LrQstCwLCDRg9C7LiDQotCy0LXRgNGB0LrQ sNGPLCDQtC4gNzEsMCoGA1UECgwj0JzQuNC90LrQvtC80YHQstGP0LfRjCDQoNC+ 0YHRgdC40LgxGDAWBgUqhQNkARINMTA0NzcwMjAyNjcwMTEaMBgGCCqFAwOBAwEB EgwwMDc3MTA0NzQzNzUxQTA/BgNVBAMMONCT0L7Qu9C+0LLQvdC+0Lkg0YPQtNC+ 0YHRgtC+0LLQtdGA0Y/RjtGJ0LjQuSDRhtC10L3RgtGAMB4XDTE4MDcwOTE1MjYy NFoXDTI3MDcwOTE1MjYyNFowggFVMR4wHAYJKoZIhvcNAQkBFg9jb250YWN0QGVr ZXkucnUxITAfBgNVBAMMGNCe0J7QniDCq9CV0LrQtdC5INCj0KbCuzEwMC4GA1UE Cwwn0KPQtNC+0YHRgtC+0LLQtdGA0Y/RjtGJ0LjQuSDRhtC10L3RgtGAMSEwHwYD VQQKDBjQntCe0J4gwqvQldC60LXQuSDQo9CmwrsxCzAJBgNVBAYTAlJVMRgwFgYD VQQIDA83NyDQnNC+0YHQutCy0LAxRDBCBgNVBAkMO9Cj0JvQmNCm0JAg0JjQm9Cs 0JjQndCa0JAsINCULjQsINCQ0J3QotCgIDMg0K3Qojsg0J/QntCcLjk0MRgwFgYD VQQHDA/Qsy7QnNC+0YHQutCy0LAxGDAWBgUqhQNkARINMTE0Nzc0NjcxNDYzMTEa MBgGCCqFAwOBAwEBEgwwMDc3MTA5NjQzNDgwYzAcBgYqhQMCAhMwEgYHKoUDAgIk AAYHKoUDAgIeAQNDAARAW3hfhvDdUxa6N8hEDjmOg/LsDDRHj5DanAyARtNB/2b5 BEzQCg4lUwrO/VHmvoUtvsrLqrxV6Ae+jh+GFli9WKOCA0AwggM8MBIGA1UdEwEB /wQIMAYBAf8CAQAwHQYDVR0OBBYEFMQYnG5GfYRnj2ehEQ5tv8Fso/qBMAsGA1Ud DwQEAwIBRjAdBgNVHSAEFjAUMAgGBiqFA2RxATAIBgYqhQNkcQIwKAYFKoUDZG8E Hwwd0KHQmtCX0JggwqvQm9CY0KDQodCh0JstQ1NQwrswggGLBgNVHSMEggGCMIIB foAUi5g7iRhR6O+cAni46sjUILJVyV2hggFSpIIBTjCCAUoxHjAcBgkqhkiG9w0B CQEWD2RpdEBtaW5zdnlhei5ydTELMAkGA1UEBhMCUlUxHDAaBgNVBAgMEzc3INCz LiDQnNC+0YHQutCy0LAxFTATBgNVBAcMDNCc0L7RgdC60LLQsDE/MD0GA1UECQw2 MTI1Mzc1INCzLiDQnNC+0YHQutCy0LAsINGD0LsuINCi0LLQtdGA0YHQutCw0Y8s INC0LiA3MSwwKgYDVQQKDCPQnNC40L3QutC+0LzRgdCy0Y/Qt9GMINCg0L7RgdGB 0LjQuDEYMBYGBSqFA2QBEg0xMDQ3NzAyMDI2NzAxMRowGAYIKoUDA4EDAQESDDAw NzcxMDQ3NDM3NTFBMD8GA1UEAww40JPQvtC70L7QstC90L7QuSDRg9C00L7RgdGC 0L7QstC10YDRj9GO0YnQuNC5INGG0LXQvdGC0YCCEDRoHkDLQe8zqaC3yHaSmikw WQYDVR0fBFIwUDAmoCSgIoYgaHR0cDovL3Jvc3RlbGVjb20ucnUvY2RwL2d1Yy5j cmwwJqAkoCKGIGh0dHA6Ly9yZWVzdHItcGtpLnJ1L2NkcC9ndWMuY3JsMIHGBgUq hQNkcASBvDCBuQwj0J/QkNCa0JwgwqvQmtGA0LjQv9GC0L7Qn9GA0L4gSFNNwrsM INCf0JDQmiDCq9CT0L7Qu9C+0LLQvdC+0Lkg0KPQpsK7DDbQl9Cw0LrQu9GO0YfQ tdC90LjQtSDihJYgMTQ5LzMvMi8yLTk5OSDQvtGCIDA1LjA3LjIwMTIMONCX0LDQ utC70Y7Rh9C10L3QuNC1IOKEliAxNDkvNy8xLzQvMi02MDMg0L7RgiAwNi4wNy4y MDEyMAgGBiqFAwICAwNBALvjFGhdFE9llvlvKeQmZmkI5J+yO2jFWTh8nXPjIpiL OutUew2hIZv15pJ1QM/VgRO3BTBGDOoIrq8LvgC+3kA= -----END CERTIFICATE----- """</span></span> <span class="hljs-comment"><span class="hljs-comment">#c1 = fsb795.Certificate('OOO_VOLGA.der') #c1 = fsb795.Certificate('cert.der') c1 = fsb795.Certificate(certpem) if (c1.pyver == ''): print('Context for certificate not create') exit(-1) print('=================formatCert================================') print(c1.formatCert) res = c1.subjectSignTool() print('=================subjectSignTool================================') print (res) print('=================issuerSignTool================================') res1 = c1.issuerSignTool() print (res1[0]) print (res1[1]) print (res1[2]) print (res1[3]) print('=================prettyPrint================================') res2 = c1.prettyPrint() #print(res2) print('=================classUser================================') res3 = c1.classUser() print (res3) print('=================issuerCert================================') iss, vlad_is = c1.issuerCert() print ('vlad_is=' + str(vlad_is)) for key in iss.keys(): print (key + '=' + iss[key]) print('=================subjectCert================================') sub, vlad_sub = c1.subjectCert() print ('vlad_sub=' + str(vlad_sub)) for key in sub.keys(): print (key + '=' + sub[key]) print('================publicKey=================================') key_info = c1.publicKey() print(key_info['curve']) print(key_info['hash']) print(key_info['valuepk']) print('================serialNumber=================================') print(c1.serialNumber()) print('================validityCert=================================') valid = c1.validityCert() print(valid['not_after']) print(valid['not_before']) print('================signatureCert=================================') algosign, value = c1.signatureCert() print(algosign) print(value) print('================KeyUsage=================================') ku = c1.KeyUsage() for key in ku: print (key) # print(ku) print('================END=================================')</span></span></code> </pre><br></div></div><br>  Para ejecutar un ejemplo de prueba, simplemente ejecute el comando: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$python</span></span> test795.py</code> </pre> <br>  Con el paquete fsb795 a su disposici√≥n, era natural escribir en python una utilidad gr√°fica aut√≥noma e independiente de la plataforma para ver los certificados calificados.  El paquete Tkinter se utiliz√≥ como soporte gr√°fico: <br><br><img src="https://habrastorage.org/webt/wb/sw/m8/wbswm8thi6y0edcmxs2osp8uw2q.png"><br><br>  La utilidad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">viewCertFL63</a> tiene tres pesta√±as.  La pesta√±a Acerca del certificado, entre otras cosas, muestra la hora actual.  Volveremos a ello a continuaci√≥n.  Para seleccionar un certificado, simplemente haga clic en el bot√≥n "Seleccionar": <br><br><img src="https://habrastorage.org/webt/w_/qe/s6/w_qes6wmp_rwam1prr8-lvmam7s.png"><br><br>  Preste atenci√≥n al bot√≥n (aquellos que trabajan en Windows no ver√°n este bot√≥n), le permite ocultar los llamados archivos / directorios invisibles (ocultos).  Para que aparezca este bot√≥n, simplemente ejecute los siguientes comandos: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sys.platform != <span class="hljs-string"><span class="hljs-string">"win32"</span></span>: root.tk.call(<span class="hljs-string"><span class="hljs-string">'set'</span></span>, <span class="hljs-string"><span class="hljs-string">'::tk::dialog::file::showHiddenBtn'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>) root.tk.call(<span class="hljs-string"><span class="hljs-string">'set'</span></span>, <span class="hljs-string"><span class="hljs-string">'::tk::dialog::file::showHiddenVar'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>)</code> </pre><br>  Un bot√≥n muy √∫til.  Entonces, despu√©s de elegir un certificado, la pesta√±a "Acerca del certificado" tomar√° la forma: <br><br><img src="https://habrastorage.org/webt/sn/x4/cc/snx4ccjle-z5atjx-4ffg-gvb_u.png"><br><br><img src="https://habrastorage.org/webt/sj/6x/9h/sj6x9hwsr5dr1xqahzigdvitst8.gif" align="left">  Lo que es notable aqu√≠ es que si el certificado caduca mientras se ve el certificado, la impresi√≥n en el icono en la esquina superior izquierda se dividir√° en dos mitades.  Todos pueden estar convencidos de esto, reorganizando el reloj de la computadora con un a√±o de anticipaci√≥n. <br>  En la pesta√±a "Detalles", puede ver en detalle las caracter√≠sticas del atributo seleccionado de un certificado calificado: <br><br><img src="https://habrastorage.org/webt/jc/va/4j/jcva4j74wlkzzbqb34rdjb-etuc.png"><br><br>  Y finalmente, la tercera pesta√±a es "Texto".  Esta pesta√±a muestra el contenido de todo el certificado: <br><br><img src="https://habrastorage.org/webt/6z/z5/xz/6zz5xzinnpyy_qm7s5uheeqbsyu.png"><br><br>  Para ver el certificado, puede usar no solo Python (el bot√≥n "Python"), sino tambi√©n las utilidades openssl y pp de Network Serurity Services (NSS).  Si alguien no tiene estas utilidades, entonces la primera puede obtenerse recolectando openssl con soporte para la criptograf√≠a rusa.  Cuando se usa la utilidad pp, la salida del certificado se ve as√≠: <br><br><img src="https://habrastorage.org/webt/pa/bf/cn/pabfcn24oeu0katqhkdgbp_ryzg.png"><br><br>  Anteriormente, mencionamos el atributo formatCert de la clase Certificate del paquete fsb795.  Por lo tanto, necesitamos el valor de este atributo para indicar el formato del archivo con el certificado cuando se ejecuta esta o aquella utilidad.  Por ejemplo, invocar la utilidad pp con el formato de archivo PEM se ve as√≠: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$pp</span></span> ‚Äìtc ‚Äìu ‚Äìa ‚Äìi &lt; &gt;</code> </pre> <br>  La opci√≥n -a indica el formato del archivo PEM.  Para el formato DER, no se especifica. <br>  El par√°metro "‚Äìinform" para openssl se configura de la misma manera. <br>  El bot√≥n Utilidad se usa para indicar la ruta a las utilidades openssl o pp. <br>  Las distribuciones de utilidades ViewCertFL63 se encuentran <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br>  Las distribuciones se crearon utilizando el paquete pyinstaller: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$python</span></span> pyinstaller.py --noconsole -F viewCertFL63.py</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es421107/">https://habr.com/ru/post/es421107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es421097/index.html">Composici√≥n de UIViewControllers y navegaci√≥n entre ellos (y no solo)</a></li>
<li><a href="../es421099/index.html">¬øEs dif√≠cil concentrarse? Quiz√°s no es tu culpa</a></li>
<li><a href="../es421101/index.html">"Calendario de prueba" para agosto. Leer un libro</a></li>
<li><a href="../es421103/index.html">Primer vistazo al Mavic 2: vuela m√°s largo, m√°s tranquilo, m√°s r√°pido</a></li>
<li><a href="../es421105/index.html">Situaci√≥n: Spotify hace tratos directos con m√∫sicos; las etiquetas no est√°n contentas</a></li>
<li><a href="../es421109/index.html">(Actualizado) Intel proh√≠be publicar puntos de referencia para actualizaciones de microc√≥digo</a></li>
<li><a href="../es421111/index.html">Sistema de dise√±o en Figma. Una mirada a la interfaz a trav√©s de los componentes.</a></li>
<li><a href="../es421113/index.html">Presentamos DJI Mavic 2 Pro / Zoom</a></li>
<li><a href="../es421115/index.html">Contexto en una aplicaci√≥n de Android</a></li>
<li><a href="../es421119/index.html">Rastrillo submarino Desarrollo de SmartTV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>