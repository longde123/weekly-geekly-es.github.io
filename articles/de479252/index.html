<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî≥ ü§Ωüèº üëá Listenverst√§ndnis vs Karte ü§∞üèª üßúüèº üêú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. Oft stellt sich bei der Arbeit mit Sequenzen die Frage nach deren Entstehung. Es scheint gewohnt zu sein, List Inclusion (List Comprehensi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Listenverst√§ndnis vs Karte</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479252/">  Hallo Habr.  Oft stellt sich bei der Arbeit mit Sequenzen die Frage nach deren Entstehung.  Es scheint gewohnt zu sein, <b>List Inclusion (List Comprehension) zu verwenden</b> , und in B√ºchern wird auf die obligatorische Verwendung der integrierten <b>Kartenfunktion</b> hingewiesen. <br><br>  In diesem Artikel werden diese Ans√§tze zum Arbeiten mit Sequenzen betrachtet, die Leistung verglichen und auch ermittelt, in welchen Situationen welcher Ansatz besser ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fm/mq/0t/fmmq0tuqp1pioiebhgdvwtwi4w4.jpeg" alt="Bild"></div><a name="habracut"></a><br><h2>  Listenverst√§ndnis </h2><br>  Die Aufnahme von Listen ist ein in Python integrierter Mechanismus zur Listenerstellung.  Er hat nur eine Aufgabe - eine Liste zu erstellen.  Listeneinschluss erstellt eine Liste aus einem beliebigen iterierbaren Typ, wobei die eingehenden Werte transformiert (gefiltert) werden. <br><br>  Ein Beispiel f√ºr einen einfachen Listeneinschluss zum Generieren einer Liste von Quadraten mit Zahlen von 0 bis 9: <br><br><pre><code class="python hljs">squares = [x*x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>)]</code> </pre> <br>  Ergebnis: <br><br><pre> <code class="python hljs">[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">36</span></span>, <span class="hljs-number"><span class="hljs-number">49</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">81</span></span>]</code> </pre><br><h2>  Karte </h2><br>  map ist eine Funktion, die in die Sprache eingebaut ist.  Es akzeptiert eine Funktion als ersten Parameter und ein iterierbares Objekt als zweiten.  Gibt einen Generator (Python 3.x) oder eine Liste (Python 2.x) zur√ºck.  Ich werde Python 3 w√§hlen. <br><br>  Ein Beispiel f√ºr den Aufruf der Kartenfunktion zum Generieren einer Liste von Quadraten mit Zahlen von 0 bis 9: <br><br><pre> <code class="python hljs">squares = list(map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x*x, range(<span class="hljs-number"><span class="hljs-number">10</span></span>)))</code> </pre><br>  Ergebnis: <br><br><pre> <code class="python hljs">[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">36</span></span>, <span class="hljs-number"><span class="hljs-number">49</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">81</span></span>]</code> </pre><br><h2>  Leistungsvergleich </h2><br><h3>  Bauen ohne Funktionen </h3><br>  Als Experiment betrachten wir die Quadrate von Zahlen aus dem Intervall von 0 bis 9.999.999: <br><br><pre> <code class="python hljs">python -m timeit -r <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-string"><span class="hljs-string">"[x*x for x in range(10000000)]"</span></span> python -m timeit -r <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-string"><span class="hljs-string">"list(map(lambda x: x*x, range(10000000)))"</span></span></code> </pre><br>  Ergebnisse: <br><br><pre> <code class="python hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> loop, best of <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">833</span></span> msec per loop <span class="hljs-number"><span class="hljs-number">1</span></span> loop, best of <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1.22</span></span> sec per loop</code> </pre><br>  Wie Sie sehen, arbeitet die <b>Listenerfassungsmethode</b> etwa 32% schneller.  Demontiert ist es nicht m√∂glich, vollst√§ndige Antworten zu erhalten, da die Kartenfunktion ‚Äûdie Details ihrer Arbeit zu verbergen scheint‚Äú.  Dies liegt aber h√∂chstwahrscheinlich am st√§ndigen Aufruf der Lambda-Funktion, innerhalb derer bereits quadratische Berechnungen durchgef√ºhrt werden.  Im Falle von List Comprehension m√ºssen wir nur das Quadrat berechnen. <br><br><h3>  Bauen mit Features </h3><br>  Zum Vergleich betrachten wir auch die Quadrate der Zahlen, aber die Berechnungen befinden sich nun in der Funktion: <br><br><pre> <code class="python hljs">python -m timeit -r <span class="hljs-number"><span class="hljs-number">10</span></span> -s <span class="hljs-string"><span class="hljs-string">"def pow2(x): return x*x"</span></span> <span class="hljs-string"><span class="hljs-string">"[pow2(x) for x in range(10000000)]"</span></span> python -m timeit -r <span class="hljs-number"><span class="hljs-number">10</span></span> -s <span class="hljs-string"><span class="hljs-string">"def pow2(x): return x*x"</span></span> <span class="hljs-string"><span class="hljs-string">"list(map(pow2, range(10000000)))"</span></span></code> </pre><br>  Ergebnisse: <br><br><pre> <code class="python hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> loop, best of <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1.41</span></span> sec per loop <span class="hljs-number"><span class="hljs-number">1</span></span> loop, best of <span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-number"><span class="hljs-number">1.21</span></span> sec per loop</code> </pre><br>  Diesmal ist die Situation umgekehrt.  Die <b>Kartenmethode</b> war 14% schneller.  In diesem Beispiel befinden sich beide Methoden in derselben Situation.  Beide m√ºssen eine Funktion aufrufen, um das Quadrat zu berechnen.  Die internen Optimierungen der Kartenfunktion erm√∂glichen es jedoch, bessere Ergebnisse anzuzeigen. <br><br><h2>  Was soll man w√§hlen? </h2><br>  Nachfolgend finden Sie die Regel zur Auswahl der richtigen Methode: <br><br><img src="https://habrastorage.org/webt/th/pz/8s/thpz8sci_vw5z29wlhlkxiyfdu0.jpeg" alt="Bild"><br><br>  Es kann Ausnahmen von dieser Regel geben, aber in den meisten F√§llen hilft es Ihnen, die richtige Wahl zu treffen! <br><br><h2>  ist map "sicherer"? </h2><br>  Warum fordern viele die Verwendung von <b>Karten</b> .  Tatsache ist, dass die Karte in einigen F√§llen tats√§chlich sicherer ist als das Listenverst√§ndnis. <br><br>  Zum Beispiel: <br><br><pre> <code class="python hljs">symbols = [<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>] values = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> symbols: print(x) squared = [x*x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> values] <span class="hljs-comment"><span class="hljs-comment">#  . "x"   "for"  print(x)</span></span></code> </pre><br>  Die Ausgabe des Programms sieht wie folgt aus: <br><br><pre> <code class="python hljs">a <span class="hljs-number"><span class="hljs-number">3</span></span> b <span class="hljs-number"><span class="hljs-number">3</span></span> c <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre><br>  Schreiben Sie nun den gleichen Code mit <b>map</b> : <br><br><pre> <code class="python hljs">symbols = [<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>] values = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> symbols: print(x) squared = map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x*x, values) <span class="hljs-comment"><span class="hljs-comment">#  ,     print(x)</span></span></code> </pre><br>  Fazit: <br><br><pre> <code class="python hljs">a a b b c c</code> </pre><br>  Die meisten Beobachter konnten bereits anhand der Syntax von <b>map</b> feststellen, dass dies Python 2 ist. Tats√§chlich gab es im zweiten Python ein √§hnliches Problem beim √úberschreiben von Variablen.  In Python 3 wurde dieses Problem jedoch behoben und ist nicht mehr relevant. <br><br>  Die oben beschriebenen Beispiele zeigen die gleichen Ergebnisse.  Es mag auch den Anschein haben, dass dies ein dummer Fehler ist, und Sie werden niemals einen solchen Fehler machen. Dies kann jedoch passieren, wenn Sie einfach einen Codeblock mit einer inneren Schleife von einem anderen Block √ºbertragen.  Solch ein Fehler kann viel Zeit und Nerven kosten, um ihn zu beheben. <br><br><h2>  Fazit </h2><br>  Ein Vergleich ergab, dass jede der Methoden in ihrer Situation gut ist. <br><br><ul><li>  Wenn Sie nicht alle berechneten Werte auf einmal ben√∂tigen (oder sie √ºberhaupt nicht ben√∂tigen), sollten Sie sich f√ºr die <b>Karte entscheiden</b> .  Daher fordern Sie nach Bedarf einen Teil der Daten vom Generator an, w√§hrend Sie viel Speicherplatz sparen (Python 3. In Python 2 ist dies nicht sinnvoll, da map eine Liste zur√ºckgibt). </li><li>  Wenn Sie alle Werte auf einmal berechnen m√ºssen und die Berechnungen ohne Verwendung von Funktionen durchgef√ºhrt werden k√∂nnen, sollten Sie eine Auswahl in Richtung <b>List Comprehension</b> treffen.  Wie die Ergebnisse von Experimenten zeigen, hat es einen signifikanten Leistungsvorteil. </li></ul><br>  PS: Wenn ich etwas verpasst habe, diskutiere ich es gerne mit Ihnen in den Kommentaren. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479252/">https://habr.com/ru/post/de479252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479242/index.html">Wir stellen Yandex.Station fertig, um YouTube anzuschauen</a></li>
<li><a href="../de479244/index.html">Pr√§fixbaum mit Bitmap-Indizes</a></li>
<li><a href="../de479246/index.html">11 Richtungen f√ºr das Wachstum und die berufliche Entwicklung eines Programmierers</a></li>
<li><a href="../de479248/index.html">Mitap ‚ÄûKubernetes in Aktion!‚Äú - echte Erfahrung beim Aufbau skalierbarer Systeme</a></li>
<li><a href="../de479250/index.html">Wie ich gelernt habe, mit Mikrocontrollern zu arbeiten - eine Anf√§ngererfahrung</a></li>
<li><a href="../de479256/index.html">Nach dem Astrotracker an zwei Abenden - Meine Erfahrung</a></li>
<li><a href="../de479258/index.html">IGF 2019. F√§llt das Internet auseinander?</a></li>
<li><a href="../de479262/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 392 (2. - 8. Dezember 2019)</a></li>
<li><a href="../de479264/index.html">Die Farbe des Mondes und der Sonne aus dem All in Bezug auf RGB und Farbtemperatur</a></li>
<li><a href="../de479266/index.html">Analyse der CPU-Auslastung einzelner JavaScript-Komponenten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>