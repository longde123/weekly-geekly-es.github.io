<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîä üåù üöé JavaScript robusto: perseguindo um mito ‚õΩÔ∏è üêó ‚õπÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O JavaScript √© freq√ºentemente chamado de ‚Äúlinguagem mais popular‚Äù, mas parece que ningu√©m fala do desenvolvimento de JS como ‚Äúo mais seguro‚Äù, e o n√∫me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScript robusto: perseguindo um mito</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/439612/">  O JavaScript √© freq√ºentemente chamado de ‚Äúlinguagem mais popular‚Äù, mas parece que ningu√©m fala do desenvolvimento de JS como ‚Äúo mais seguro‚Äù, e o n√∫mero de problemas ocultos no ecossistema √© grande.  Como contorn√°-los de forma eficaz? <br><br><img src="https://habrastorage.org/webt/pu/ak/kc/puakkce57lpd32kkdbinlj8ydoy.jpeg"><br><br>  <b>Ilya Klimov</b> pensou nisso quando o erro foi muito caro (literalmente) - e, eventualmente, fez uma apresenta√ß√£o no HolyJS.  E como as cr√≠ticas do p√∫blico foram excelentes, preparamos agora uma vers√£o em texto deste relat√≥rio para Habr.  Sob o corte - texto e v√≠deo. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/o9zh5EHrpQA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Ol√° pessoal.  Meu nome √© Ilya Klimov, sou de Kharkov, Ucr√¢nia.  Eu tenho minha pr√≥pria empresa pequena, de at√© dez pessoas, terceirizada.  Fazemos tudo pelo que o dinheiro √© pago ... no sentido, programamos em JavaScript em todos os setores.  Hoje, falando sobre JavaScript confi√°vel, quero compartilhar minhas melhores pr√°ticas em algum lugar durante o ano passado, pois esse t√≥pico come√ßou a me incomodar muito e com seriedade. <br><br>  Quem trabalha com terceiriza√ß√£o entender√° o conte√∫do do seguinte slide: <br><br><img src="https://habrastorage.org/webt/ku/mi/7u/kumi7ucbxrai_oqdxwhwtqj84jk.png"><br><br>  Tudo o que falaremos, √© claro, n√£o tem nada a ver com a realidade.  Como se costuma dizer em South Park, todos os personagens s√£o mimados e miseravelmente.  Naturalmente, os locais onde h√° suspeita de viola√ß√£o da NDA foram acordados com representantes de clientes. <br><br>  Nada afetou meus pensamentos sobre confiabilidade e afins como base da minha pr√≥pria empresa.  Quando voc√™ inicia sua pr√≥pria empresa, de repente acontece que voc√™ pode ser um programador muito legal, pode ter caras muito legais, mas √†s vezes coisas incr√≠veis acontecem, algumas imposs√≠veis e completamente loucas. <br><br>  Eu tenho um projeto educacional Ninja JavaScript.  √Äs vezes eu fa√ßo promessas.  √Äs vezes eu at√© os sigo.  Prometi em 2017, como parte de um projeto educacional, gravar um v√≠deo sobre o Kubernetes.  Percebi que havia feito essa promessa e seria bom cumpri-la, 31 de dezembro.  E sentei-me para gravar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui est√° o resultado</a> ). <br><br>  Como gosto de gravar v√≠deos o mais pr√≥ximo poss√≠vel da realidade, aproveitei exemplos de um projeto real.  Como resultado, no cluster de demonstra√ß√£o, implantei algo que recebia pedidos reais da produ√ß√£o real e os colocava em um banco de dados Kubernetes separado no meu cluster de demonstra√ß√£o. <br><br>  Desde 31 de dezembro, parte dos pedidos desapareceu.  Baixa para a sazonalidade: todo mundo foi beber ch√°.  Quando o cliente acordou entre 12 e 13 de janeiro, o custo total do v√≠deo foi de cerca de US $ 500.000. Ainda n√£o tive uma produ√ß√£o t√£o cara. <br><br><img src="https://habrastorage.org/webt/lx/dd/rt/lxddrthxihl5_vzoqeadrnlrf60.png"><br><br>  Exemplo n√∫mero dois: outro cluster Kubernetes.  Ecossistema de nova moda Infraestrutura como c√≥digo: tudo o que pode ser descrito por c√≥digo e configura√ß√µes, o Kubernetes se contrai programaticamente a partir de shells JavaScript e assim por diante.  Legal, todo mundo gosta.  Uma pequena altera√ß√£o no procedimento de implanta√ß√£o e chega um momento em que voc√™ precisa implantar um novo cluster.  Surge a seguinte situa√ß√£o: <br><br><pre><code class="plaintext hljs">const config = { // ‚Ä¶ mysql: process.env.MYSQL_URI || 'mysql://localhost:3306/foo' // ... }</code> </pre> <br>  Muitos de voc√™s provavelmente tamb√©m t√™m essa linha de c√≥digo em suas configura√ß√µes.  Ou seja, pegamos a configura√ß√£o da vari√°vel mysql ou pegamos o banco de dados local. <br><br>  Por causa de um erro de digita√ß√£o no sistema de implanta√ß√£o, verificou-se que o sistema foi novamente configurado como produ√ß√£o, mas o banco de dados MySQL usou um banco de dados de teste - local, que era para testes.  Dessa vez, menos dinheiro foi gasto - apenas US $ 300.000. Felizmente, essa n√£o era minha empresa, mas o lugar em que eu trabalhava como consultor engajado. <br><br><img src="https://habrastorage.org/webt/iv/r3/v8/ivr3v8a9frcey26kfj4czqpd4um.png"><br><br>  Voc√™ pode pensar que tudo isso n√£o lhe interessa como front-end, porque eu falei sobre o DevOps (a prop√≥sito, admiro o nome da confer√™ncia do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DevOops</a> , ela descreve a ess√™ncia perfeitamente).  Mas vou falar sobre outra situa√ß√£o. <br><br>  Existe um sistema que controla epidemias veterin√°rias na Eti√≥pia, desenvolvido sob os ausp√≠cios da ONU.  Ele cont√©m um dos elementos da interface quando eles chegam a uma pessoa e ele insere manualmente as coordenadas: quando e onde houve surtos de uma determinada doen√ßa. <br><br>  H√° um surto de alguma febre aftosa regular (n√£o sou forte em doen√ßas de vacas) e, com pressa, o operador pressiona acidentalmente o bot√£o ‚Äúadicionar‚Äù duas vezes, deixando os campos vazios.  Como temos JavaScript, e JavaScript e tipos s√£o muito bons, os campos vazios de latitude e longitude levam alegremente a zero coordenadas. <br><br>  N√£o, n√£o enviamos o m√©dico para o oceano, mas tudo foi calculado anteriormente do ponto de vista do agrupamento para exibi√ß√£o no mapa, cria√ß√£o de relat√≥rios, an√°lises e an√°lise da localiza√ß√£o de pessoas no back-end.  Estamos tentando unir os pontos de foco. <br><br>  Como resultado, o sistema fica paralisado durante o dia, porque o back-end est√° tentando calcular o cluster com a inclus√£o desse ponto, todos os dados se tornam irrelevantes, pedidos completamente irrespons√°veis ‚Äã‚Äãda s√©rie "drive 400 kilometros" chegam aos m√©dicos.  400 quil√¥metros na Eti√≥pia √© um prazer duvidoso. <br><br>  A estimativa de perda total √© de cerca de um milh√£o de d√≥lares.  No relat√≥rio sobre essa situa√ß√£o, estava escrito "Fomos v√≠timas de um conjunto infeliz de circunst√¢ncias".  Mas sabemos que o ponto √© JavaScript! <br><br><img src="https://habrastorage.org/webt/95/kt/wn/95ktwn6hubs5azwja9vopnkwydc.png"><br><br>  E o √∫ltimo exemplo.  Infelizmente, embora essa hist√≥ria tenha sido h√° muito tempo, ainda n√£o sei o nome da empresa.  Mas esta √© uma empresa que possui sua pr√≥pria companhia a√©rea, seus pr√≥prios hot√©is e assim por diante.  Ela trabalha de maneira muito interativa com as empresas, ou seja, fornece a elas uma interface separada para reservar ingressos e assim por diante. <br><br>  Uma vez ocorrido um acidente absurdo, chega um pedido de reserva de ingressos de Nova York a Los Angeles no valor de 999.999 pe√ßas.  O sistema da empresa comprou alegremente todos os voos de sua pr√≥pria companhia a√©rea, descobriu que n√£o havia assentos suficientes e enviou os dados ao sistema internacional de reservas para compensar a escassez.  O sistema internacional de reservas, ao receber um pedido de aproximadamente 950.000 bilhetes, desconectou esta companhia a√©rea do seu sistema. <br><br>  Como o desligamento √© um evento fora do comum, o problema foi resolvido em sete minutos.  No entanto, nesses sete minutos, o custo das multas a serem pagas era de apenas US $ 100.000. <br><br><img src="https://habrastorage.org/webt/my/_b/eg/my_beg6zrauwag69rbbangiojgw.png"><br><br>  Felizmente, tudo isso aconteceu em mais de um ano.  Mas esses casos me fizeram pensar em quest√µes de confiabilidade e fazer duas perguntas russas originais: quem √© o culpado e o que fazer sobre isso? <br><br><h2>  Por que isso acontece: a juventude do ecossistema </h2><br>  Se voc√™ analisar muitas hist√≥rias, descobrir√° que h√° mais hist√≥rias sobre problemas semelhantes com JavaScript do que com outra linguagem de programa√ß√£o.  Esta n√£o √© minha impress√£o subjetiva, mas os resultados da an√°lise inteligente de not√≠cias no Hacker News.  Por um lado, essa √© uma fonte hipster e subjetiva, mas, por outro lado, √© bastante dif√≠cil encontrar qualquer fonte sadia por fakap no campo de programa√ß√£o. <br><br>  Al√©m disso, h√° um ano, realizei uma competi√ß√£o na qual tive que resolver problemas algor√≠tmicos todos os dias.  Desde que eu estava entediado, eu os resolvi em JavaScript usando programa√ß√£o funcional.  Eu escrevi uma fun√ß√£o completamente pura e, no Chrome atual, funcionou corretamente 1197 vezes e 3 vezes produziu um resultado diferente.  Foi apenas um pequeno erro no otimizador TurboFan, que acabou de entrar no Chrome principal. <br><br>  Obviamente, foi corrigido, mas voc√™ entende: isso significa, por exemplo, que se seus testes de unidade passaram uma vez, isso n√£o significa que eles funcionem no sistema.  Ou seja, executamos o c√≥digo cerca de 1197 vezes, ent√£o o otimizador veio e disse: ‚ÄúUau!  Recurso quente!  Vamos otimizar ".  E no processo de otimiza√ß√£o levou ao resultado errado. <br><br>  Em outras palavras, podemos chamar a juventude do ecossistema de uma das primeiras raz√µes pelas quais isso acontece.  O JavaScript √© uma ind√∫stria relativamente jovem, precisamente no campo de programa√ß√£o s√©ria, nos casos em que milh√µes giram, onde o custo de um erro √© medido de cinco a seis caracteres. <br><br>  Durante muito tempo, o JavaScript foi percebido como um brinquedo.  Por isso (n√£o porque n√£o levamos a s√©rio), ainda temos problemas com a falta de ferramentas. <br><br>  Portanto, para lidar com esse motivo, que √© o princ√≠pio fundamental de tudo o que falarei hoje, tentei formular as regras de confiabilidade que poderia impor em minha empresa ou transferir como consultor para outras pessoas.  Como diz o ditado, "a regra n√∫mero um n√£o √© falar sobre confiabilidade".  Mas mais a s√©rio, ent√£o ... <br><br><h2>  Regra de confiabilidade n¬∫ 1: tudo o que pode ser automatizado deve ser automatizado </h2><br>  Incluindo, a prop√≥sito, e verifica√ß√£o ortogr√°fica: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text">  Regra de confiabilidade n¬∫ 1: tudo o que pode ser automatizado deve ser automatizado </div></div><br>  Tudo come√ßa com as coisas mais simples.  Parece que todo mundo est√° escrevendo Prettier h√° muito tempo.  Mas somente em 2018, tudo o que usamos, bom e sonoro, aprendemos a trabalhar com o git add -p quando adicionamos parcialmente arquivos ao reposit√≥rio git, e queremos formatar o c√≥digo de maneira agrad√°vel, digamos, antes de envi√°-lo ao reposit√≥rio principal.  O bem conhecido utilit√°rio realinstaged, que permite verificar apenas os arquivos que foram alterados, tem exatamente o mesmo problema. <br><br><img src="https://habrastorage.org/webt/w4/oh/q_/w4ohq_h-hjm5l_hna1d616e86ne.png"><br><br>  Continuando a jogar Captain Evidence: ESLint.  N√£o vou perguntar quem o usa aqui, porque n√£o faz sentido para todo o p√∫blico levantar as m√£os (bem, espero que sim e n√£o quero me decepcionar).  √â melhor levantar as m√£os que possuem suas pr√≥prias regras escritas personalizadas no ESLint. <br><br>  Essas regras s√£o uma das maneiras muito poderosas de automatizar a bagun√ßa que acontece em projetos em que as pessoas escrevem no n√≠vel j√∫nior e afins. <br><br>  Todos n√≥s queremos um certo n√≠vel de isolamento, mas mais cedo ou mais tarde surge uma situa√ß√£o: ‚ÄúVeja, esse ajudante Vasya vendeu em algum lugar do diret√≥rio do seu componente muito pr√≥ximo.  Eu n√£o vou tirar isso em comum, ent√£o eu vou.  A palavra m√°gica √© "mais tarde".  Isso leva ao fato de que n√£o depend√™ncias verticais come√ßam a aparecer no projeto (quando os elementos superiores conectam os inferiores, os inferiores nunca sobem atr√°s dos superiores), mas o componente A depende do componente B, que est√° em um ramo completamente diferente.  Como resultado, o componente A n√£o √© t√£o facilmente transportado para outros componentes. <br><br>  A prop√≥sito, eu expresso meu respeito ao Alfa-Bank, eles t√™m uma biblioteca de componentes muito bem e muito bem escrita no React, √© um prazer us√°-lo precisamente em termos de design da qualidade do c√≥digo. <br><br>  A regra banal do ESLint, que monitora de onde voc√™ importa entidades, permite aumentar significativamente a qualidade do c√≥digo e salvar o modelo mental durante a revis√£o do c√≥digo. <br><br>  Eu j√° sou do ponto de vista do mundo do front-end.  Recentemente, na regi√£o de Kharkov, uma empresa grande e s√©ria da PricewaterhouseCoopers concluiu um estudo, e a idade m√©dia do fornecedor front-end √© de 24 a 25 anos.  J√° √© dif√≠cil para mim pensar sobre tudo isso. Quero me concentrar na l√≥gica de neg√≥cios durante uma revis√£o de solicita√ß√£o de recebimento.  Portanto, tenho o prazer de escrever regras ESLint para n√£o pensar em tais coisas. <br><br>  Parece que voc√™ pode ajustar as regras usuais para isso, mas a realidade geralmente perturba muito mais, porque acontece que alguns seletores Redux s√£o necess√°rios no componente de rea√ß√£o (infelizmente, ainda est√° vivo).  E esses seletores est√£o em algum lugar de uma hierarquia completamente diferente, ent√£o "../../../ ..". <br><br>  Ou, pior ainda, o alias do webpack, que quebra cerca de 20% de outras ferramentas, porque nem todo mundo entende como trabalhar com ela.  Por exemplo, meu amado Flow. <br><br>  Portanto, na pr√≥xima vez em que voc√™ quiser rosnar em um j√∫nior (e o programador tiver um passatempo favorito), pense se voc√™ pode automatizar isso de alguma forma para n√£o cometer erros no futuro.  Em um mundo ideal, √© claro, voc√™ escrever√° instru√ß√µes que ningu√©m ler√° de qualquer maneira.  Aqui est√£o os palestrantes do HolyJS - especialistas talentosos com grande experi√™ncia, mas quando foi proposto elaborar instru√ß√µes para os palestrantes em um com√≠cio interno, eles disseram "sim, eles n√£o o ler√£o".  E estas s√£o as pessoas para dar um exemplo! <br><br>  O √∫ltimo do banalismo, e seguir em frente.  Essas s√£o as ferramentas para executar ganchos pr√©-confirma√ß√£o.  Usamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">husky</a> , e eu n√£o pude deixar de inserir esta linda foto husky, mas voc√™ pode usar outra coisa. <br><br><img src="https://habrastorage.org/webt/ko/88/la/ko88la3d2ueau_frtyqrgaxxwia.jpeg"><br><br>  Se voc√™ acha que tudo isso √© muito simples - como se costuma dizer, segure minha cerveja, em breve descobriremos que tudo √© mais complicado do que voc√™ pensa.  Mais alguns pontos: <br><br><h2>  Digita√ß√£o </h2><br>  Se voc√™ n√£o est√° escrevendo TypeScript, pode pensar nisso.  N√£o gosto do TypeScript, tradicionalmente fluxo de alto fluxo, mas falaremos sobre isso mais tarde, mas aqui do est√°gio promoverei a solu√ß√£o mainstream com nojo. <br><br>  Porque  O comit√™ de programa do TC39 recentemente teve uma discuss√£o muito grande sobre onde o idioma geralmente vai.  Uma conclus√£o muito engra√ßada a que chegaram: no TC39, h√° sempre um ‚Äúcisne, c√¢ncer e l√∫cio‚Äù que arrasta a l√≠ngua em dire√ß√µes diferentes, mas h√° uma coisa que todo mundo quer e sempre √© o desempenho. <br><br>  O TC39 informalmente, em uma discuss√£o interna, divulgou este discurso: "N√≥s sempre criaremos o JavaScript para que ele permane√ßa produtivo, e aqueles que n√£o gostam dele usar√£o algum tipo de linguagem que se compila no JavaScript". <br><br>  O TypeScript √© uma boa alternativa ao ecossistema adulto.  N√£o posso deixar de mencionar meu amor pelo GraphQL.  √â realmente bom, infelizmente, ningu√©m permitir√° que seja implementado em um grande n√∫mero de projetos existentes, onde j√° temos que trabalhar. <br><br><img src="https://habrastorage.org/webt/nd/rw/6w/ndrw6w8uthgi8ypqykbofmf7ez4.png"><br><br>  J√° havia relat√≥rios sobre o GraphQL na confer√™ncia, portanto, h√° apenas um golpe especificamente para a quest√£o da confiabilidade: se voc√™ usar, digamos, o Express GraphQL, a cada vez, al√©m de um resolvedor espec√≠fico, poder√° suspender certos validadores que permitem aumentar os requisitos de valor em compara√ß√£o com tipos padr√£o de GraphQL. <br><br>  Por exemplo, gostaria que o valor da transfer√™ncia entre dois representantes de alguns bancos fosse positivo.  Porque o mais tardar ontem, o pop-up do meu banco na Internet anunciou com alegria que eu tinha -2 mensagens n√£o lidas do banco.  E √© como um banco l√≠der no meu pa√≠s. <br><br>  Quanto a esses validadores, que imp√µem rigor adicional: us√°-los √© uma boa e s√≥lida ideia, apenas n√£o os use conforme sugerido, digamos, pelo GraphQL.  Voc√™ se v√™ muito apegado ao GraphQL como plataforma.  Ao mesmo tempo, a valida√ß√£o que voc√™ faz √© necess√°ria em dois locais ao mesmo tempo: no front-end antes de enviar e receber dados e no back-end. <br><br>  Eu regularmente tenho que explicar ao cliente por que pegamos o JavaScript e n√£o a linguagem X como back-end. Al√©m disso, a linguagem X geralmente √© algum tipo de PHP, e n√£o o Go bonito e similares.  Eu tenho que explicar que somos capazes de reutilizar o c√≥digo da forma mais eficiente poss√≠vel, inclusive entre o cliente e o back-end, devido ao fato de que eles foram escritos na mesma linguagem de programa√ß√£o.  Infelizmente, como mostra a pr√°tica, muitas vezes essa tese permanece apenas uma frase na confer√™ncia e n√£o encontra personifica√ß√£o na vida real. <br><br><h2>  Contratos </h2><br>  Eu j√° falei sobre a juventude do ecossistema.  A programa√ß√£o de contratos existe h√° mais de 25 anos como uma abordagem prim√°ria.  Se voc√™ escreve no TypeScript, fa√ßa io-ts, se voc√™ escrever no Flow, como eu, fa√ßa o contrato digitado e obter√° uma coisa muito importante: a capacidade de descrever contratos de tempo de execu√ß√£o dos quais derivar tipos est√°ticos. <br><br><img src="https://habrastorage.org/webt/jl/fg/bj/jlfgbj0bbassazt6sztrtulh4qq.png"><br><br>  N√£o h√° pior para um programador do que ter mais de uma fonte de verdade.  Conhe√ßo pessoas que perderam quantias de cinco d√≠gitos em d√≥lares simplesmente porque seu tipo √© descrito em uma linguagem com digita√ß√£o est√°tica (eles usaram TypeScript - bem, √© claro, isso √© apenas uma coincid√™ncia) e o tipo de tempo de execu√ß√£o (parece ter usado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tcomb</a> ) ligeiramente diferente. <br><br>  Portanto, o erro n√£o foi detectado em tempo de compila√ß√£o, simplesmente porque por que verific√°-lo?  N√£o houve testes de unidade para isso, porque fomos verificados por um tipificador est√°tico.  N√£o faz sentido testar coisas que foram verificadas pela camada abaixo, todos se lembram da hierarquia de testes. <br><br>  Devido ao fato de a sincroniza√ß√£o entre esses dois contratos ter sido interrompida ao longo do tempo, um dia uma transfer√™ncia incorreta foi feita para o endere√ßo que foi para o endere√ßo errado.  Como era uma criptomoeda, √© imposs√≠vel reverter uma transa√ß√£o um pouco mais do que em princ√≠pio.  Ningu√©m vai bifurcar o ar por sua causa novamente.  Portanto, contratos e intera√ß√µes na programa√ß√£o de contratos s√£o as primeiras coisas que voc√™ deve come√ßar a fazer amanh√£. <br><br><h2>  Por que isso acontece: isolamento </h2><br>  O pr√≥ximo problema √© o isolamento.  √â multifacetado e multifacetado.  Quando eu trabalhava para uma empresa de hot√©is e viagens a√©reas, eles tinham um aplicativo no Angular 1. Isso foi h√° muito tempo, ent√£o √© desculp√°vel.  Uma equipe de 80 pessoas trabalhou nesta aplica√ß√£o.  Tudo foi coberto em testes.  estava tudo bem at√© que um belo dia eu fiz meu recurso, n√£o o congelei e descobri que havia quebrado, durante os testes, lugares absolutamente incr√≠veis no sistema em que nem sequer toquei. <br><br>  Acabou que tenho problemas com a criatividade.  Aconteceu que eu acidentalmente chamei o servi√ßo exatamente o mesmo que outro servi√ßo existente no sistema.  Como era Angular 1, e o sistema de servi√ßo n√£o foi estritamente digitado, mas digitado estritamente foi digitado, Angular calmamente come√ßou a deslizar meu servi√ßo em lugares completamente diferentes e, ironicamente, dois m√©todos de nomea√ß√£o coincidiram. <br><br>  Obviamente, isso n√£o foi uma coincid√™ncia: voc√™ entende que, se dois servi√ßos s√£o nomeados da mesma forma, √© prov√°vel que eles fa√ßam a mesma coisa, mais ou menos.  Era um servi√ßo relacionado ao c√°lculo de descontos.  Apenas um m√≥dulo estava ocupado calculando descontos para clientes corporativos, e o segundo m√≥dulo com meu nome estava relacionado ao c√°lculo de descontos em a√ß√µes. <br><br>  Obviamente, quando o aplicativo √© serrado por 80 pessoas, isso significa que √© grande.  A divis√£o de c√≥digo foi implementada no aplicativo, e isso significa que a sequ√™ncia de conex√£o dos m√≥dulos dependia diretamente da viagem do usu√°rio no site.  Para torn√°-lo ainda mais interessante, aconteceu que nem um √∫nico teste de ponta a ponta que testou o comportamento e a passagem do usu√°rio pelo site, ou seja, um cen√°rio de neg√≥cios espec√≠fico, detectou esse erro.  Porque parece que ningu√©m precisar√° entrar em contato com os dois m√≥dulos de desconto ao mesmo tempo.  √â verdade que isso paralisou completamente o trabalho dos administradores do site, mas com quem isso n√£o acontece. <br><br>  O problema do isolamento √© muito bem ilustrado pelo logotipo de um dos projetos que resolve parcialmente esse problema.  Aqui √© Lerna. <br><br><img src="https://habrastorage.org/webt/jz/nn/op/jznnopsczu0lbelfdl7o7py3hdu.png"><br><br>  O Lerna √© uma excelente ferramenta para gerenciar v√°rios pacotes npm em um reposit√≥rio.  Quando voc√™ tem um martelo nas m√£os, tudo se torna suspeito como um prego.  Quando voc√™ tem um sistema unix com a filosofia certa, tudo se torna suspeito como um arquivo.  Todo mundo sabe que em sistemas unix tudo √© um arquivo.  Existem sistemas nos quais ele √© levado ao mais alto grau (eu quase disse "ao ponto do absurdo"), como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Plano 9</a> . <br><br>  Conhe√ßo organiza√ß√µes que, tendo sintonizado para garantir a confiabilidade de um aplicativo gigante, tiveram uma id√©ia simples: tudo √© um pacote. <br><br><img src="https://habrastorage.org/webt/kj/xn/wb/kjxnwb2hkwnuqpxrpfjwmjysdde.png"><br><br>  Quando voc√™ remove algum elemento da funcionalidade, seja um componente ou qualquer outra coisa, em um pacote separado, voc√™ fornece automaticamente uma camada de isolamento.  S√≥ porque voc√™ normalmente n√£o pode alcan√ßar outro de um pacote.  E tamb√©m porque o sistema de trabalhar com pacotes coletados em um √∫nico reposit√≥rio via npm-link ou Yarn Workspaces √© t√£o terr√≠vel e imprevis√≠vel em termos de organiza√ß√£o interna, que voc√™ nem pode recorrer a um hack e conectar algum tipo de arquivo atrav√©s de "node_modules something", simplesmente porque pessoas diferentes t√™m tudo isso em uma estrutura diferente.  Isso depende especialmente da vers√£o do Yarn.  L√°, em uma das vers√µes, eles silenciosamente mudaram completamente o mecanismo de como o Yarn Workspaces organiza o trabalho com pacotes. <br><br>  O segundo exemplo de isolamento para mostrar que o problema √© multifacetado √© o pacote que estou tentando usar em qualquer lugar agora - isso √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">viciado em cls</a> .  Voc√™ pode estar ciente de outro pacote que implementa a mesma coisa - isto √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">continuation-local-storage</a> .  Resolve um problema muito importante que, por exemplo, n√£o √© enfrentado, por exemplo, pelos desenvolvedores em PHP. <br><br>  √â sobre isolar cada solicita√ß√£o espec√≠fica.  Em PHP, temos, em m√©dia, em um hospital, todos os pedidos s√£o isolados, interagindo entre eles apenas se voc√™ n√£o usar nenhuma pervers√£o como a Mem√≥ria Compartilhada, n√£o podemos, tudo est√° bem, pac√≠fico, bonito.  Em ess√™ncia, cls-hooked adiciona a mesma coisa, permitindo que voc√™ crie contextos de execu√ß√£o, coloque vari√°veis ‚Äã‚Äãlocais nelas e, o mais importante, destrua automaticamente esses contextos para que eles n√£o continuem consumindo sua mem√≥ria. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esse cls-hooked √© baseado em async_hooks, que no node.js ainda est√£o em status experimental, mas eu conhe√ßo uma ou duas empresas que os usam em produ√ß√£o bastante severa e s√£o felizes. </font><font style="vertical-align: inherit;">H√° uma ligeira queda no desempenho, mas a capacidade de coletar lixo automaticamente n√£o tem pre√ßo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando come√ßamos a falar sobre problemas de isolamento, sobre como colocar coisas diferentes em diferentes m√≥dulos de n√≥s.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Regra de confiabilidade n¬∫ 2: c√≥digo incorreto e ‚Äúerrado‚Äù deve parecer errado </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Com o primeiro crit√©rio que deduzi para mim, h√° dez anos n√£o teria concordado. </font><font style="vertical-align: inherit;">Porque voc√™ diria que o JavaScript √© uma linguagem din√¢mica e me priva de toda a beleza e expressividade da linguagem. </font><font style="vertical-align: inherit;">Este √© um teste grep.</font></font><br><br>  O que √© isso    vim.  ,      -     Language Server,     -  ‚Äî ,  , grep. ,    ,    .  grep-  ,             grep.  ,   ,  . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sequelize</a> .    ORM    .      user.getProjects().   ,    getProjects?    . <br><br><img src="https://habrastorage.org/webt/6l/fd/lr/6lfdlr9jixqedmscjsbh-0oow9k.png"><br><br>  ,         Sequelize,    ,       hasMany, belongsToMany.      ,     ,     ,          .      ,       . <br><br>      code review,       ,       .        .   ‚Äî     ,        . <br><br>       ,      : ¬´merge request  20  ‚Äî 30 , merge request  5000  ‚Äî looks good to me¬ª.   ,   . <br><br>     JavaScript Ninja  , , ,    junior-,          .    ¬´    react  redux¬ª,   8000  , 10 000 ¬ª    ,    ,    ¬´  ¬ª.  ,   ,   ¬´  ¬ª,    ,   merge request      . <br><br> ,  ,   merge request ,        ,      Linux.    ,      ,   -.       ,       git.  ,        .      ,  ,       .       . <br><br>        -    .       .    -     ,          ,   -                 . <br><br>  ,   .   Microsoft Surface     Linux,      .       ,                ,   .         -     . <br><br><h2>   :  </h2><br><img src="https://habrastorage.org/webt/5j/ll/p6/5jllp6invsz_lu02znea6kcsutu.png"><br><br>     ¬´   ¬ª,   ¬´  ¬ª.  ,          React.        React, Fiber ‚Äî  . <br><br>  ,  Fiber         (      OCaml)  JavaScript,       .    ,          .   ,   ‚Äî   ,    proposal,      JavaScript. Scheduler ‚Äî  proposal stage 0. <br><br>    ,  React  ,    -  .     , :  ,    DOM.       ‚Äî   .   ,    . <br><br><img src="https://habrastorage.org/webt/ow/x8/sg/owx8sgozgwsoqtfq7xwu9sfj0cs.png"><br><br>     ‚Äî Vue.js.     Vue?  ,    .    Vue,    ,  , . <br><br>    Vue       React. ,    Vue,      ,    React. <br><br>    . Vue  ,   state,  ,   state  ,           .   ,       . Vue      . <br><br>   .    ,   ,    Web Components  c  ,     ,           .    : ,    pop-up,   ,    ,      - .    ‚Äî . <br><br>  Vue     ‚Äî scoped slots.  ,        - .    scoped slot ‚Äî    ,      .         .  React        Render Proper: , .  Vue        ,         -. <br><br>        -,     Vue   .    Vue : ,   child-,   ,  scoped slots,  forceUpdate.    , child  .        . <br><br>  React         .   , , shouldComponentUpdate(),    .  Vue     ,    ,    , ,    .       .     Vue.   , -   . <br><br><img src="https://habrastorage.org/webt/9s/rz/j8/9srzj89ltostquesk9tsfal2lhu.png"><br><br>   ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Jest</a> .     Facebook.              JavaScript: , , .     .      ,   . <br><br>   ,        ECMAScript 2015  .      ,       if,    require. Require   ,   . ,  ,    ,         . Jest    Babel   Require    . <br><br>            NGS-  Node,   proposal,     .        JavaScript    :   Require,   .    .    ,  Jest c NGS- ,       ,      .        ,   . <br><br>  ,        ,       -  .  ,     Inversion of Control   - Dependency Injection-. <br><br><h2> IoC/DI </h2><br> ,   ,       . Angular     IoC/DI.  React   ‚Ä¶ , ,  React  Vue?    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dan.church</a> ,   evan.church  . <br><br>  ,  ,    React      Dependency Injection,      -       .   Vue    inject  provide.            . <br><br>   ,      ,   .  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NestJS</a> .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">InversifyJS</a> .      TypeScript, , ,        JavaScript.      ,       . <br><br><img src="https://habrastorage.org/webt/h1/vv/vo/h1vvvodkm_2eaql6jpp3gvkucom.png"><br><br>   Typescript,    Inversify.    ,    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">inject</a> (TYPES.Weapon) katana: Weapon.   ,     ,    TYPES.Weapon   Weapon?  ‚Äî . <br><br>  ,     ,     ,  TypeScript ( Flow     )     ,    inject   dependency injection   runtime,       . <br><br>   ¬´ ¬ª?     Weapon   ,    , TypeScript   ,       .    TypeScript   ,    first-class citizen  JavaScript,    .      ,  ,   runtime         ,   katana    Weapon.   . <br><br>  - C++,    ,   ,  RTTI: run-time type information,        ,   .  C#  Java  reflection,     .  TypeScript,      ¬´    ¬ª, ,        RTTI. <br><br>   .   .  Vue  Vue 3  TypeScript,  ,   Vue    TypeScript ,    Microsoft: ¬´ ,      TypeScript,   ?¬ª ,    Vue, :      props,     this. ,    props   ,   this,   .   TypeScript      ,  . . <br><br>  Microsoft ,     :   Vue  ,   Angular,       .      ,     TypeScript.   React,       ,   . <br><br>    ,    .   ,      Dart,   mirrors,  ,  Flutter.     mirrors,  ,            ,          . <br><br>        Inversify,   Babel-,    ,    ,  ,   runtime-,  ,    . <br><br>     :          .     .   ,      ,   ,    .       ,  V8       . <br><br> V8     ,         .  ,   ,     V8,      ,   ,   .      ,    V8  ,      TypeScript. <br><br>          .   ,    ,     . <br><br><h2>   #3:     ¬´¬ª ,  ¬´¬ª </h2><br>      ¬´¬ª  ¬´¬ª ,   , ¬´¬ª ‚Äî  ,   .        ,       Vue,       . -  , -  props'    . <br><br>     .   typed-css-modules?    :   CSS,     CSS Modules,        . <br><br><img src="https://habrastorage.org/webt/18/h9/fq/18h9fqupckf_zd2eiolcp5hp2iq.png"><br><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">typed-css-modules</a> ,      ,     css-,    . <br><br>       12    ,   CSS-     , .   11  12       undefined,   CSS- ,    ,         ,   ,   undefined, . <br><br><img src="https://habrastorage.org/webt/ye/6z/ce/ye6zceducqaloagkziotyb0imj8.png"><br><br> Yeoman   ,         ,           ,       .      ,    ,   .       Angular CLI,   Blueprints (,     Angular,      GDG SPB  ,   ,     ). <br><br><br><img src="https://habrastorage.org/webt/tw/jg/do/twjgdowdxvmve9mg3atzsjybwyu.png"><br><br>        Anguar   ,     ,   .                  . <br><br>   ,  ¬´¬ª   ,  ¬´¬ª ‚Äî  ,  .   ,  ¬´¬ª    ‚Äî  .       , ,   ,      ,  ,         ,       . <br><br>  ,     ‚Äî  .      junior',      ,      , ,        . ,  , React-       . <br><br>      , ,         ,      - ESLInt,  - ,    ,       . <br><br>    ,   ,   .     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NestJS</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sails.js</a> . <br><br><img src="https://habrastorage.org/webt/nf/2i/lb/nf2ilb8j60ed9k2dcamrhrplpfo.png"><br><br>  ,     ,      ,    ,  ,     -  -.      Sails    ORM,    . Waterline ‚Äî   ,   .    ,     Sails.js    .    blueprint ,         .     ,  ,      . <br><br><img src="https://habrastorage.org/webt/nt/ub/pg/ntubpgyvn13wei3p33cghdvswn0.png"><br><br>       Nest,     ‚Äî    ,     .    Dependency Injection,     ,      middleweight   . <br><br>        .  ,    ,     ,  ,     ,     : ¬´    -     ?¬ª <br><br>     Angular,  ‚Äî ,           ,       dependency injection,   ,   . <br><br>    - Vue (,       ),  ,      Vue   .        Vue,      -    ,    ‚Äî  Nest.  ,   ,   ,   ,  TypeScript. <br><br><img src="https://habrastorage.org/webt/ea/ua/3b/eaua3b85i-gqubkacbxmnezw1li.png"><br><br><h2>  :  </h2><br>    ,      JavaScript.        ,   ,    ,  ,       ,      . <br><br>  ‚Äî  ,        ,    ,    ,   ,    : -   .      -  ,     ‚Äî   . <br><br><img src="https://habrastorage.org/webt/tj/xo/lb/tjxolbyxbbbo3wkoc1uatgymvum.png"><br><br>   Grafana,   ,     ‚Äî  .   ,     -     ,    .       speech recognition API  Microsoft,   ,   ,    20  .    , ,   ,     -. <br><br><img src="https://habrastorage.org/webt/x9/ei/qi/x9eiqij5bshqlbginz5mhljvvs8.png"><br><br>   : CI/CD.   GitLab,    ,    .   GitLab,   ,   JavaScript-friendly environment    ,   ,       . <br><br>      . ,       ,         ‚Ä¶  ,  -. <br><br><img src="https://habrastorage.org/webt/mh/em/4t/mhem4twe6k_mqbnbzr56yak2cjw.png"><br><br> Blue/Green deployment:     -    ,   ,      .     , ,     ! <br><br><h2>      </h2><br><ul><li>  JavaScript  ,       ,    .      , ,        ,    JavaScript     GitHub.   ‚Äî   , ,  ,    . </li><li>   JavaScript   ,      (    ,     ).      ¬´  ,   ¬ª.          ,    .   DI     ,  ¬´    ?¬ª </li><li>           ,     .  TypeScript, Flow,    Rizen ‚Äî    ,      runtime exception,     ,   . <br><br>    ,   ‚Äî      -,           . </li></ul><br><blockquote>       HolyJS,  :    HolyJS  <b>24-25   </b> .   ‚Äî ,   ( MobX)    (   Chrome DevTools).      ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439612/">https://habr.com/ru/post/pt439612/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439602/index.html">√âtica no espa√ßo digital - as regras b√°sicas das rela√ß√µes digitais internacionais</a></li>
<li><a href="../pt439604/index.html">Como o c√≥digo de barras √© organizado?</a></li>
<li><a href="../pt439606/index.html">Produ√ß√£o piloto de eletr√¥nicos por um pre√ßo m√≠nimo</a></li>
<li><a href="../pt439608/index.html">Religi√£o moderna: o que as pessoas d√£o ao Google, Facebook, Amazon e Apple?</a></li>
<li><a href="../pt439610/index.html">Como no meu ve√≠culo el√©trico Chevrolet Bolt, na garantia, dois m√≥dulos de bateria foram substitu√≠dos e o terceiro sob monitoramento</a></li>
<li><a href="../pt439614/index.html">Como distinguir um reparo bom de um reparo ruim, ou como no SRG criamos uma biblioteca Java multiencadeada a partir do analisador Tomit</a></li>
<li><a href="../pt439616/index.html">O resumo de projetos de TI interessantes no Kickstarter No. 7</a></li>
<li><a href="../pt439618/index.html">PHP para iniciantes. Conex√£o de arquivo</a></li>
<li><a href="../pt439620/index.html">Compreendendo a assincronia em JavaScript [Tradu√ß√£o de Sukhjinder Arora]</a></li>
<li><a href="../pt439624/index.html">Por que armazenar dados em √≥rbita</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>