<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤲🏿 🚲 🧛🏽 CMake und C ++ - Brüder für immer 🗻 👨‍🍳 🗾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Während des Entwicklungsprozesses ändere ich gerne Compiler, Build-Modi, Abhängigkeitsversionen, führe statische Analysen durch, messe die Leistung, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CMake und C ++ - Brüder für immer</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461817/"><p><img src="https://habrastorage.org/webt/ac/a0/8-/aca08-xhl_t033obcrcqgxpmksk.png" alt="Freundschaft für immer"></p><br><p>  Während des Entwicklungsprozesses ändere ich gerne Compiler, Build-Modi, Abhängigkeitsversionen, führe statische Analysen durch, messe die Leistung, sammle Deckung, generiere Dokumentation usw.  Und ich liebe CMake wirklich, weil ich damit alles machen kann, was ich will. </p><br><p>  Viele schimpfen mit CMake und oft zu Recht, aber wenn Sie schauen, ist nicht alles so schlecht, und in letzter Zeit ist es <strong>sehr gut</strong> und die Richtung der Entwicklung ist ziemlich positiv. </p><br><p>  In diesem Artikel möchte ich erläutern, wie einfach es ist, eine C ++ - Headerbibliothek im CMake-System zu organisieren, um die folgenden Funktionen zu erhalten: </p><br><ol><li>  Versammlung; </li><li>  Autostart-Tests; </li><li>  Messung der Codeabdeckung; </li><li>  Installation; </li><li>  Automatische Dokumentation </li><li>  Online-Sandbox-Generierung; </li><li>  Statische Analyse </li></ol><br><blockquote>  Wer die Profis und S-Marken bereits versteht, kann einfach <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Projektvorlage herunterladen</a> und verwenden. </blockquote><a name="habracut"></a><br><a name="contents"></a><br><h2>  Inhalt </h2><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt von innen nach außen</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektstruktur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Haupt-CMake-Datei (./CMakeLists.txt)</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektinformationen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektoptionen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kompilierungsoptionen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptziel</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tests</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Dokumentation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Online Sandbox</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript für Tests (test / CMakeLists.txt)</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Testen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abdeckung</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript zur Dokumentation (doc / CMakeLists.txt)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript für eine Online-Sandbox (online / CMakeLists.txt)</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt draußen</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Montage</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Generation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Montage</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Optionen</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MYLIB_COVERAGE</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MYLIB_TESTING</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MYLIB_DOXYGEN_LANGUAGE</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Montageziele</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Default</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mylib-Unit-Tests</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">überprüfen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abdeckung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">doc</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zauberstabbox</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiele</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Werkzeuge</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Statische Analyse</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nachwort</a> </li></ol><br><a name="project-from-the-inside"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt von innen nach außen</a> </h2><br><a name="project-structure"></a><br><h3 id="struktura-proektacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektstruktur</a> </h3><br><pre><code class="plaintext hljs">. ├── CMakeLists.txt ├── README.en.md ├── README.md ├── doc │  ├── CMakeLists.txt │  └── Doxyfile.in ├── include │  └── mylib │  └── myfeature.hpp ├── online │  ├── CMakeLists.txt │  ├── mylib-example.cpp │  └── wandbox.py └── test ├── CMakeLists.txt ├── mylib │  └── myfeature.cpp └── test_main.cpp</code> </pre> <br><p>  Wir werden hauptsächlich darüber sprechen, wie CMake-Skripte organisiert werden, damit sie detailliert analysiert werden.  Jeder kann den Rest der Dateien direkt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf der Projektvorlagenseite sehen</a> . </p><br><a name="cmakeliststxt"></a><br><h3 id="glavnyy-cmake-fayl-cmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Haupt-CMake-Datei (./CMakeLists.txt)</a> </h3><br><a name="project-information"></a><br><h4 id="informaciya-o-proektecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektinformationen</a> </h4><br><p>  Zunächst müssen Sie die richtige Version des CMake-Systems anfordern.  CMake entwickelt sich weiter, Teamsignaturen, Verhalten unter verschiedenen Bedingungen ändern sich.  Damit CMake sofort versteht, was wir von ihm wollen, müssen wir unsere Anforderungen an ihn sofort festlegen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">cmake_minimum_required</span></span>(VERSION <span class="hljs-number"><span class="hljs-number">3.13</span></span>)</code> </pre> <br><p>  Dann bestimmen wir unser Projekt, seinen Namen, seine Version, die verwendeten Sprachen usw. (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code> project</code></a> ). </p><br><p>  In diesem Fall geben wir die <code>CXX</code> Sprache ( <code>CXX</code> C ++) an, damit CMake den C-Sprach-Compiler nicht belastet und nicht sucht (standardmäßig sind in CMake zwei Sprachen enthalten: C und C ++). </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">project</span></span>(Mylib VERSION <span class="hljs-number"><span class="hljs-number">1.0</span></span> LANGUAGES CXX)</code> </pre> <br><p>  Hier können Sie sofort prüfen, ob unser Projekt als Teilprojekt in einem anderen Projekt enthalten ist.  Dies wird in Zukunft sehr hilfreich sein. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">get_directory_property</span></span>(IS_SUBPROJECT PARENT_DIRECTORY)</code> </pre> <br><a name="project-options"></a><br><h4 id="opcii-proektacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektoptionen</a> </h4><br><p>  Wir bieten zwei Möglichkeiten. </p><br><p>  Die erste Option - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_TESTING</code></a> - zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_TESTING</code></a> .  Dies kann erforderlich sein, wenn wir sicher sind, dass bei den Tests alles in Ordnung ist, und wir beispielsweise nur unser Projekt installieren oder verpacken möchten.  Oder unser Projekt ist als Teilprojekt enthalten - in diesem Fall ist der Benutzer unseres Projekts nicht daran interessiert, unsere Tests durchzuführen.  Sie testen die von Ihnen verwendeten Abhängigkeiten nicht? </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">option</span></span>(MYLIB_TESTING <span class="hljs-string"><span class="hljs-string">"  "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>)</code> </pre> <br><p>  Darüber hinaus werden wir eine separate Option <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_COVERAGE</code></a> zum Messen der Codeabdeckung mit Tests <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_COVERAGE</code></a> sind jedoch zusätzliche Tools erforderlich, sodass Sie diese explizit aktivieren müssen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">option</span></span>(MYLIB_COVERAGE <span class="hljs-string"><span class="hljs-string">"    "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>)</code> </pre> <br><a name="compile-options"></a><br><h4 id="opcii-kompilyaciicontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kompilierungsoptionen</a> </h4><br><p>  Natürlich sind wir coole Plus-Programmierer, daher möchten wir vom Compiler ein Höchstmaß an Diagnose der Kompilierungszeit.  Keine einzige Maus wird durchrutschen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_compile_options</span></span>( -Werror -Wall -Wextra -Wpedantic -Wcast-align -Wcast-qual -Wconversion -Wctor-dtor-privacy -Wenum-compare -Wfloat-<span class="hljs-keyword"><span class="hljs-keyword">equal</span></span> -Wnon-virtual-dtor -Wold-style-cast -Woverloaded-virtual -Wredundant-decls -Wsign-conversion -Wsign-promo )</code> </pre> <br><p>  Wir werden auch Erweiterungen deaktivieren, um den C ++ - Sprachstandard vollständig zu erfüllen.  Standardmäßig sind sie in CMake enthalten. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> CMAKE_CXX_EXTENSIONS) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMAKE_CXX_EXTENSIONS <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="main-target"></a><br><h4 id="osnovnaya-celcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptziel</a> </h4><br><p>  Unsere Bibliothek besteht nur aus Header-Dateien, was bedeutet, dass wir keinen Auspuff in Form von statischen oder dynamischen Bibliotheken haben.  Um unsere Bibliothek im Freien nutzen zu können, müssen Sie sie installieren, im System finden und mit Ihrem Projekt verbinden können, und gleichzeitig dieselben Header sowie möglicherweise einige zusätzliche Eigenschaften. </p><br><p>  Zu diesem Zweck erstellen wir eine Schnittstellenbibliothek. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_library</span></span>(mylib INTERFACE)</code> </pre> <br><p>  Binden Sie die Header an unsere Front-End-Bibliothek. </p><br><p>  Die moderne, modische und jugendliche Verwendung von CMake impliziert, dass Header, Eigenschaften usw.  durch einen einzigen Zweck übertragen.  Es reicht also aus, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>target_link_libraries(target PRIVATE dependency)</code></a> zu sagen, und alle Header, die dem <code>dependency</code> sind, sind für Quellen verfügbar, die zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>target_link_libraries(target PRIVATE dependency)</code></a> gehören.  Und es sind keine <code>[target_]include_directories</code> erforderlich.  Dies wird unten beim Parsen des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CMake-Skripts für Komponententests</a> demonstriert. </p><br><p>  Es lohnt sich auch, auf die sogenannten zu achten  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>-: $&lt;...&gt;</code></a> . </p><br><p>  Dieser Befehl ordnet die benötigten Header unserer Front-End-Bibliothek zu. Wenn unsere Bibliothek mit einem Ziel innerhalb derselben CMake-Hierarchie verbunden ist, werden Header aus dem Verzeichnis <code>${CMAKE_CURRENT_SOURCE_DIR}/include</code> damit verknüpft, und wenn unsere Da die Bibliothek auf dem System installiert und mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>find_package</code></a> mit einem anderen Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>find_package</code></a> , werden Header aus dem <code>include</code> Verzeichnis relativ zum Installationsverzeichnis zugeordnet. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_include_directories</span></span>(mylib INTERFACE $&lt;BUILD_INTERFACE:<span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_SOURCE_DIR}</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>&gt; $&lt;INSTALL_INTERFACE:<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>&gt; )</code> </pre> <br><p>  Stellen Sie den Sprachstandard ein.  Natürlich das allerletzte.  Gleichzeitig nehmen wir den Standard nicht nur auf, sondern verteilen ihn auch an diejenigen, die unsere Bibliothek nutzen werden.  Dies wird dadurch erreicht, dass die set-Eigenschaft die Kategorie <code>INTERFACE</code> (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Befehl target_compile_features</a> ). </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_compile_features</span></span>(mylib INTERFACE cxx_std_17)</code> </pre> <br><p>  Wir erstellen einen Alias ​​für unsere Bibliothek.  Außerdem wird er sich für die Schönheit in einem speziellen "Namespace" befinden.  Dies ist nützlich, wenn verschiedene Module in unserer Bibliothek angezeigt werden und wir sie unabhängig voneinander verbinden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wie zum Beispiel in Boost</a> . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_library</span></span>(Mylib::mylib ALIAS mylib)</code> </pre> <br><a name="installation"></a><br><h4 id="ustanovkacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installation</a> </h4><br><p>  Installation unserer Header im System.  Hier ist alles einfach.  Wir sagen, dass sich der Ordner mit allen Headern im <code>include</code> Verzeichnis relativ zum Installationsort befinden sollte. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(DIRECTORY <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/mylib DESTINATION <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>)</code> </pre> <br><p>  Als Nächstes informieren wir das Build-System darüber, dass wir den <code>find_package(Mylib)</code> in Projekten von <code>Mylib::mylib</code> und das Ziel <code>Mylib::mylib</code> . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(TARGETS mylib <span class="hljs-keyword"><span class="hljs-keyword">EXPORT</span></span> MylibConfig) <span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">EXPORT</span></span> MylibConfig NAMESPACE Mylib:: DESTINATION share/Mylib/cmake)</code> </pre> <br><p>  Der nächste Zauber sollte wie folgt verstanden werden.  Wenn wir <code>find_package(Mylib 1.2.3 REQUIRED)</code> in einem Drittanbieterprojekt <code>find_package(Mylib 1.2.3 REQUIRED)</code> und in diesem Fall die reale Version der installierten Bibliothek nicht mit Version <code>1.2.3</code> kompatibel ist, generiert CMake automatisch einen Fehler.  Das heißt, Sie müssen Versionen nicht manuell überwachen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(CMakePackageConfigHelpers) write_basic_package_version_file(<span class="hljs-string"><span class="hljs-string">"${PROJECT_BINARY_DIR}/MylibConfigVersion.cmake"</span></span> VERSION <span class="hljs-variable"><span class="hljs-variable">${PROJECT_VERSION}</span></span> COMPATIBILITY AnyNewerVersion ) <span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(FILES <span class="hljs-string"><span class="hljs-string">"${PROJECT_BINARY_DIR}/MylibConfigVersion.cmake"</span></span> DESTINATION share/Mylib/cmake)</code> </pre> <br><a name="tests"></a><br><h4 id="testycontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tests</a> </h4><br><p>  Wenn die Tests mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">entsprechenden Option</a> explizit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>add_subdirectory</code></a> oder wenn unser Projekt ein Teilprojekt ist, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>add_subdirectory</code></a> mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>add_subdirectory</code></a> mit einem anderen CMake-Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>add_subdirectory</code></a> , werden wir in der Hierarchie nicht weiter gehen, und das Skript, das die Befehle zum Generieren und Ausführen der Tests beschreibt, wird einfach nicht gestartet . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> MYLIB_TESTING) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"  Mylib "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(IS_SUBPROJECT) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"Mylib     "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="documentation"></a><br><h4 id="dokumentaciyacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Dokumentation</a> </h4><br><p>  Auch bei einem Teilprojekt wird keine Dokumentation erstellt. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> IS_SUBPROJECT) <span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(doc) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="online-sandbox"></a><br><h4 id="onlayn-pesochnicacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Online Sandbox</a> </h4><br><p>  In ähnlicher Weise verfügt das Teilprojekt auch nicht über Online-Sandboxen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> IS_SUBPROJECT) <span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(online) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="testcmakeliststxt"></a><br><h3 id="skript-dlya-testov-testcmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript für Tests (test / CMakeLists.txt)</a> </h3><br><a name="testing"></a><br><h4 id="testirovaniecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Testen</a> </h4><br><p>  Zunächst finden wir das Paket mit dem gewünschten Testframework (ersetzen Sie es durch Ihr Lieblingspaket). </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_package</span></span>(doctest <span class="hljs-number"><span class="hljs-number">2.3</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> REQUIRED)</code> </pre> <br><p>  Wir erstellen unsere ausführbare Datei mit Tests.  Normalerweise füge ich nur die Datei hinzu, in der sich die <code>main</code> direkt in der ausführbaren Binärdatei befindet. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(mylib-unit-tests test_main.cpp)</code> </pre> <br><p>  Und die Dateien, die die Tests selbst beschreiben, werden später hinzugefügt.  Dies ist jedoch nicht erforderlich. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_sources</span></span>(mylib-unit-tests PRIVATE mylib/myfeature.cpp)</code> </pre> <br><p>  Wir verbinden Abhängigkeiten.  Bitte beachten Sie, dass wir nur <code>target_include_directories</code> benötigten CMake-Ziele mit unserer Binärdatei <code>target_include_directories</code> und den Befehl <code>target_include_directories</code> nicht aufgerufen <code>target_include_directories</code> .  Die Header aus dem <code>Mylib::mylib</code> und aus unserer <code>Mylib::mylib</code> sowie die Build-Parameter (in unserem Fall der C ++ - Sprachstandard) wurden zusammen mit diesen Zielen <code>Mylib::mylib</code> . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_link_libraries</span></span>(mylib-unit-tests PRIVATE Mylib::mylib doctest::doctest )</code> </pre> <br><p>  Erstellen Sie schließlich ein fiktives Ziel, dessen "Assembly" dem Ausführen von Tests entspricht, und fügen Sie dieses Ziel der Standardassembly hinzu (das <code>ALL</code> Attribut ist dafür verantwortlich).  Dies bedeutet, dass die Assembly standardmäßig den Start von Tests initiiert, dh wir werden nie vergessen, sie auszuführen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(check ALL <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> mylib-unit-tests)</code> </pre> <br><a name="code-coverage"></a><br><h4 id="pokrytiecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abdeckung</a> </h4><br><p>  Als Nächstes aktivieren wir die Messung der Codeabdeckung, wenn die entsprechende Option angegeben ist.  Ich werde nicht auf Details eingehen, da sie sich mehr auf das Tool zur Messung der Abdeckung als auf CMake beziehen.  Es ist nur wichtig zu beachten, dass basierend auf den Ergebnissen ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>coverage</code></a> erstellt wird, mit dem es bequem ist, mit der Messung der Abdeckung zu beginnen. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_program</span></span>(GCOVR_EXECUTABLE gcovr) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(MYLIB_COVERAGE <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> GCOVR_EXECUTABLE) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"    "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">target_compile_options</span></span>(mylib-unit-tests PRIVATE --coverage) <span class="hljs-keyword"><span class="hljs-keyword">target_link_libraries</span></span>(mylib-unit-tests PRIVATE gcov) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(coverage <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${GCOVR_EXECUTABLE}</span></span> --root=<span class="hljs-variable"><span class="hljs-variable">${PROJECT_SOURCE_DIR}</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/ --object-directory=<span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_BINARY_DIR}</span></span> DEPENDS check ) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(MYLIB_COVERAGE <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> GCOVR_EXECUTABLE) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(MYLIB_COVERAGE <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(WARNING <span class="hljs-string"><span class="hljs-string">"       gcovr"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="doccmakeliststxt"></a><br><h3 id="skript-dlya-dokumentacii-doccmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript zur Dokumentation (doc / CMakeLists.txt)</a> </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Doxygen gefunden</a> . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_package</span></span>(Doxygen)</code> </pre> <br><p>  Als nächstes prüfen wir, ob der Benutzer die Sprachvariable festgelegt hat.  Wenn ja, dann nicht anfassen, wenn nicht, dann Russisch nehmen.  Konfigurieren Sie dann die Doxygen-Systemdateien.  Alle erforderlichen Variablen, einschließlich der Sprache, werden während des Konfigurationsprozesses abgerufen (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code> configure_file</code></a> ). </p><br><p>  Anschließend erstellen wir das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>doc</code></a> , mit dem die Erstellung der Dokumentation gestartet wird.  Da die Erstellung von Dokumentationen nicht den größten Bedarf im Entwicklungsprozess darstellt, wird das Ziel standardmäßig nicht aktiviert und muss explizit gestartet werden. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Doxygen_FOUND) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> MYLIB_DOXYGEN_LANGUAGE) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(MYLIB_DOXYGEN_LANGUAGE Russian) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"Doxygen documentation will be generated in ${MYLIB_DOXYGEN_LANGUAGE}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">configure_file</span></span>(Doxyfile.in Doxyfile) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(doc <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${DOXYGEN_EXECUTABLE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_BINARY_DIR}</span></span>/Doxyfile) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span> ()</code> </pre> <br><a name="onlinecmakeliststxt"></a><br><h3 id="skript-dlya-onlayn-pesochnicy-onlinecmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript für eine Online-Sandbox (online / CMakeLists.txt)</a> </h3><br><p>  Hier finden wir den dritten Python und erstellen ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>wandbox</code></a> Ziel, das eine Anforderung generiert, die mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wandbox-</a> Service-API <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">übereinstimmt</a> , und diese sendet.  Als Antwort kommt ein Link zur fertigen Sandbox. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_program</span></span>(PYTHON3_EXECUTABLE python3) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(PYTHON3_EXECUTABLE) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(WANDBOX_URL <span class="hljs-string"><span class="hljs-string">"https://wandbox.org/api/compile.json"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(wandbox <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${PYTHON3_EXECUTABLE}</span></span> wandbox.py mylib-example.cpp <span class="hljs-string"><span class="hljs-string">"${PROJECT_SOURCE_DIR}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> | curl -H <span class="hljs-string"><span class="hljs-string">"Content-type: application/json"</span></span> -d @- <span class="hljs-variable"><span class="hljs-variable">${WANDBOX_URL}</span></span> WORKING_DIRECTORY <span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_SOURCE_DIR}</span></span> DEPENDS mylib-unit-tests ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(WARNING <span class="hljs-string"><span class="hljs-string">"  -    python 3- "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="project-from-the-outside"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt draußen</a> </h2><br><p>  Überlegen Sie nun, wie Sie alles verwenden sollen. </p><br><a name="build"></a><br><h3 id="sborkacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Montage</a> </h3><br><p>  Die Montage dieses Projekts besteht wie jedes andere Projekt auf dem CMake-Montagesystem aus zwei Schritten: </p><br><a name="generate"></a><br><h4 id="generaciyacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Generation</a> </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// [ ...]</code> </pre> <br><blockquote>  Wenn der obige Befehl aufgrund der alten Version von CMake nicht funktioniert hat, lassen Sie <code>-S</code> : <br><pre> <code class="plaintext hljs">cmake // -B /// [ ...]</code> </pre> <br></blockquote><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mehr zu Optionen</a> . </p><br><a name="project-build"></a><br><h4 id="sborka-proektacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektmontage</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// [--target target]</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lesen Sie mehr über Montageziele</a> . </p><br><a name="options"></a><br><h3 id="opciicontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Optionen</a> </h3><br><a name="MYLIB_COVERAGE"></a><br><h4 id="mylib_coveragecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MYLIB_COVERAGE</a> </h4><br><pre> <code class="plaintext hljs">cmake -S ... -B ... -DMYLIB_COVERAGE=ON [  ...]</code> </pre> <br><p>  Enthält ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>coverage</code></a> , mit dem Sie die Codeabdeckung mit Tests messen können. </p><br><a name="MYLIB_TESTING"></a><br><h4 id="mylib_testingcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MYLIB_TESTING</a> </h4><br><pre> <code class="plaintext hljs">cmake -S ... -B ... -DMYLIB_TESTING=OFF [  ...]</code> </pre> <br><p>  Bietet die Möglichkeit, die Einheitentestbaugruppe und das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>check</code></a> auszuschalten.  Infolgedessen wird die Messung der Codeabdeckung durch Tests <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_COVERAGE</code></a> (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_COVERAGE</code></a> ). </p><br><p>  Außerdem wird das Testen automatisch deaktiviert, wenn das Projekt mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>add_subdirectory</code></a> als Unterprojekt mit einem anderen Projekt verbunden ist. </p><br><a name="MYLIB_DOXYGEN_LANGUAGE"></a><br><h4 id="mylib_doxygen_languagecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MYLIB_DOXYGEN_LANGUAGE</a> </h4><br><pre> <code class="plaintext hljs">cmake -S ... -B ... -DMYLIB_DOXYGEN_LANGUAGE=English [  ...]</code> </pre> <br><p>  Schaltet die vom Dokumentziel generierte Dokumentationssprache auf die angegebene Sprache um.  Eine Liste der verfügbaren Sprachen finden Sie auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Website</a> des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Doxygen-Systems</a> . </p><br><p>  Standardmäßig ist Russisch aktiviert. </p><br><a name="build-targets"></a><br><h3 id="sborochnye-celicontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Montageziele</a> </h3><br><a name="default-target"></a><br><h4 id="po-umolchaniyucontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Default</a> </h4><br><pre> <code class="plaintext hljs">cmake --build path/to/build/directory cmake --build path/to/build/directory --target all</code> </pre> <br><p>  Wenn das Ziel nicht angegeben ist (was dem Gesamtziel entspricht), sammelt es alles, was möglich ist, und ruft auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>check</code></a> auf. </p><br><a name="mylib-unit-tests"></a><br><h4 id="mylib-unit-testscontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mylib-Unit-Tests</a> </h4><br><pre> <code class="plaintext hljs">cmake --build path/to/build/directory --target mylib-unit-tests</code> </pre> <br><p>  Kompiliert Unit-Tests.  Standardmäßig aktiviert. </p><br><a name="check"></a><br><h4 id="checkcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">überprüfen</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target check</code> </pre> <br><p>  Läuft gesammelte (sammelt, wenn noch nicht) Unit-Tests.  Standardmäßig aktiviert. </p><br><p>  Siehe auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>mylib-unit-tests</code></a> . </p><br><a name="coverage"></a><br><h4 id="coveragecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abdeckung</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target coverage</code> </pre> <br><p>  Analysiert laufende (wird ausgeführt, falls noch nicht) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Komponententests</a> , um den Code mit Tests mit dem Programm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gcovr abzudecken</a> . </p><br><p>  Der Auspuff der Beschichtung sieht ungefähr so ​​aus: </p><br><pre> <code class="plaintext hljs">------------------------------------------------------------------------------ GCC Code Coverage Report Directory: /path/to/cmakecpptemplate/include/ ------------------------------------------------------------------------------ File Lines Exec Cover Missing ------------------------------------------------------------------------------ mylib/myfeature.hpp 2 2 100% ------------------------------------------------------------------------------ TOTAL 2 2 100% ------------------------------------------------------------------------------</code> </pre> <br><p>  Das Ziel ist nur verfügbar, wenn <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_COVERAGE</code></a> . </p><br><p>  Siehe auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>check</code></a> . </p><br><a name="doc"></a><br><h4 id="doccontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">doc</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target doc</code> </pre> <br><p>  Startet die Generierung der Codedokumentation mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Doxygen-</a> System. </p><br><a name="wandbox"></a><br><h4 id="wandboxcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zauberstabbox</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target wandbox</code> </pre> <br><p>  Die Antwort des Dienstes sieht ungefähr so ​​aus: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"permlink"</span></span> : <span class="hljs-string"><span class="hljs-string">"QElvxuMzHgL9fqci"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"https://wandbox.org/permlink/QElvxuMzHgL9fqci"</span></span> }</code> </pre> <br><p>  Verwenden Sie dazu den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wandbox-</a> Dienst.  Ich weiß nicht, über welche Gummiserver sie verfügen, aber ich denke, dass diese Gelegenheit nicht missbraucht werden sollte. </p><br><a name="examples"></a><br><h3 id="primerycontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiele</a> </h3><br><h4 id="sborka-proekta-v-otladochnom-rezhime-s-zamerom-pokrytiya">  Projektassemblierung im Debug-Modus mit Abdeckungsmessung </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Debug -DMYLIB_COVERAGE=ON cmake --build /// --target coverage --parallel 16</code> </pre> <br><h4 id="ustanovka-proekta-bez-predvaritelnoy-sborki-i-testirovaniya">  Projektinstallation ohne Vormontage und Prüfung </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DMYLIB_TESTING=OFF -DCMAKE_INSTALL_PREFIX=/// cmake --build /// --target install</code> </pre> <br><h4 id="sborka-v-vypusknom-rezhime-zadannym-kompilyatorom">  Vom angegebenen Compiler im Release-Modus erstellen </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_COMPILER=g++-8 -DCMAKE_PREFIX_PATH=///// cmake --build /// --parallel 4</code> </pre> <br><h4 id="generirovanie-dokumentacii-na-angliyskom">  Englische Dokumentationserstellung </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Release -DMYLIB_DOXYGEN_LANGUAGE=English cmake --build /// --target doc</code> </pre> <br><a name="tools"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Werkzeuge</a> </h2><br><ol><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CMake</a> 3.13 </p><br><p>  Tatsächlich ist CMake 3.13 nur erforderlich, um einige der in dieser Hilfe beschriebenen Konsolenbefehle auszuführen.  Aus syntaktischer Sicht von CMake-Skripten ist Version 3.8 ausreichend, wenn die Generierung auf andere Weise aufgerufen wird. </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Doctest-Testbibliothek</a> </p><br><p>  Das Testen kann deaktiviert werden (siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code> MYLIB_TESTING</code></a> ). </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sauerstoff</a> </p><br><p>  Um die Sprache zu wechseln, in der die Dokumentation generiert wird, wird die Option <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>MYLIB_DOXYGEN_LANGUAGE</code></a> . </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python 3</a> Interpreter </p><br><p>  Automatische Generierung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Online-Sandboxen</a> . </p><br></li></ol><br><a name="static-analysis"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Statische Analyse</a> </h2><br><p>  Mit CMake und einigen guten Tools können Sie statische Analysen mit minimalen Körperbewegungen durchführen. </p><br><h4 id="cppcheck">  Cppcheck </h4><br><p>  CMake bietet integrierte Unterstützung für das statische Analysetool <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cppcheck</a> . </p><br><p>  Verwenden Sie dazu die Option <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>CMAKE_CXX_CPPCHECK</code></a> : </p><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Debug -DCMAKE_CXX_CPPCHECK="cppcheck;--enable=all;-I///include"</code> </pre> <br><p>  Danach wird die statische Analyse jedes Mal während der Kompilierung und Neukompilierung der Quellen automatisch gestartet.  Sie müssen nichts extra tun. </p><br><h4 id="clang">  Clang </h4><br><p>  Mit dem wunderbaren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>scan-build</code></a> Tool können Sie statische Analysen auch in zwei Schritten ausführen: </p><br><pre> <code class="plaintext hljs">scan-build cmake -S // -B /// -DCMAKE_BUILD_TYPE=Debug scan-build cmake --build ///</code> </pre> <br><p>  Im Gegensatz zu Cppcheck müssen Sie hier die Assembly jedes Mal durch <code>scan-build</code> ausführen. </p><br><a name="afterword"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nachwort</a> </h2><br><p>  CMake ist ein sehr leistungsfähiges und flexibles System, mit dem Sie Funktionen für jeden Geschmack und jede Farbe implementieren können.  Und obwohl die Syntax manchmal zu wünschen übrig lässt, ist der Teufel immer noch nicht so schrecklich, wie er gemalt wird.  Verwenden Sie das CMake-Build-System zum Wohle der Gesellschaft und der Gesundheit. </p><br><hr><br><p>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektvorlage herunterladen</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461817/">https://habr.com/ru/post/de461817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461803/index.html">Datenversionskontrolle (DVC): Datenversionierung und Experimentierreproduzierbarkeit</a></li>
<li><a href="../de461805/index.html">Monte-Carlo-Integrationsanwendung beim Rendern</a></li>
<li><a href="../de461807/index.html">Wie Pod-Prioritäten bei Kubernetes zu Ausfallzeiten bei Grafana Labs führten</a></li>
<li><a href="../de461813/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 470 (17.07.2019 - 22.07.2019)</a></li>
<li><a href="../de461815/index.html">Eine Revolution im Design von Computer-Netzteilen vor einem halben Jahrhundert</a></li>
<li><a href="../de461819/index.html">Warum einfaches Website-Design wissenschaftlich besser ist</a></li>
<li><a href="../de461821/index.html">Neue Immuntherapie entfernte alle Tumoren bei einer Frau mit metastasiertem Brustkrebs</a></li>
<li><a href="../de461823/index.html">Erweiterte vier Regeln für das Software-Design</a></li>
<li><a href="../de461827/index.html">Entwicklung hybrider PHP / Go-Anwendungen mit RoadRunner</a></li>
<li><a href="../de461829/index.html">TCP vs UDP oder die Zukunft der Netzwerkprotokolle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>