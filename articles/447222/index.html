<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíØ üëá üëê B√∫squeda de Linux. Felicitaciones a los ganadores y hablamos sobre la resoluci√≥n de problemas. üë©üèø‚Äçüè´ üïõ üîâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El 25 de marzo, abrimos el registro para Linux Quest , este es un juego para fan√°ticos y expertos en el sistema operativo Linux. Algunas estad√≠sticas:...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>B√∫squeda de Linux. Felicitaciones a los ganadores y hablamos sobre la resoluci√≥n de problemas.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/447222/"><img src="https://habrastorage.org/webt/1h/zh/nd/1hzhnd4vk8qks_p2sjyylz-kpy4.png"><br><br>  El 25 de marzo, abrimos el registro para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Linux Quest</a> , este es un juego para fan√°ticos y expertos en el sistema operativo Linux.  Algunas estad√≠sticas: 1117 personas se registraron para el juego, 317 de ellas encontraron al menos una clave, 241 completaron con √©xito la tarea de la primera etapa, 123 - la segunda y 70 pasaron la tercera etapa.  ¬°Hoy nuestro juego ha llegado a su fin, y felicitamos a nuestros ganadores! <br><a name="habracut"></a><br><ul><li>  <b>El primer lugar fue ocupado por Alexander Teldekov.</b> <br>  Alexander se dijo a s√≠ mismo que √©l es el administrador de sistemas m√°s t√≠pico.  Vive en Volgogrado, administra varios sistemas similares a Unix durante veinte a√±os.  Gestionado para trabajar en proveedores de Internet, banco, integrador de sistemas.  Ahora trabaja de forma remota en una peque√±a empresa, se dedica a la infraestructura de la nube para un gran cliente extranjero.  Le gusta leer, escuchar m√∫sica.  Sobre el juego, Alexander dijo que le gustaba el juego en su conjunto, le encantan esas tareas.  En una de las compa√±√≠as en la entrevista que estaba haciendo algo como Hackerrank, fue interesante. </li><li>  <b>Segundo lugar - Roman Suslov.</b> <br>  Una novela de Mosc√∫.  El tiene 37 a√±os.  Trabaja como ingeniero de Linux / Unix en Jet Infosystems.  Para el trabajo, tengo que administrar y solucionar problemas de sistemas Linux / Unix + SAN.  Los intereses son muy diferentes: sistemas Linux, programaci√≥n, ingenier√≠a inversa, seguridad de la informaci√≥n, Arduino.  Sobre el juego, Roman not√≥ que generalmente le gustaba el juego.  ‚ÄúFlexion√© un poco mi giro y me distraje de la vida cotidiana gris del trabajo diario.  :) Quisiera m√°s tareas, de lo contrario no tuve tiempo de probar c√≥mo el juego ya hab√≠a terminado ". </li><li>  <b>El tercero es alex3d.</b> <br>  Alex vive en Mosc√∫, se dedica al desarrollo de software.  "Gracias por el concurso, fue interesante comprobar tu habilidad de google-fu". </li></ul><br>  Tambi√©n en el ranking de los 10 mejores jugadores: <br><br><ul><li>  Yevgeniy saldayev </li><li>  Markel Mokhnachevsky </li><li>  Konstantin Konosov </li><li>  Pavel Sergeev </li><li>  Vladimir Bovaev </li><li>  Ivan Bubnov </li><li>  Klets Pavlo </li></ul><br>  Entendemos que hay muchas opciones para resolver todos nuestros problemas, una de las posibles soluciones se describe a continuaci√≥n. <br><br><h3>  1. La primera etapa </h3><br>  Lo llamamos "¬øEst√° seguro del administrador?", Porque la tarea era bastante simple: arreglar un servicio de l√°mpara caliente. <br><br><h4>  1.1.  Hechos interesantes: </h4><br>  Dos jugadores encontraron la primera clave en los primeros 15 minutos del juego, y en la primera hora tuvimos tres l√≠deres que hicieron frente a la tarea. <br><br><h4>  1.2.  Tarea </h4><br>  Usted fue a trabajar para una empresa donde durante mucho tiempo no hubo un especialista de TI competente.  Antes de comenzar a limpiar, debe resolver un problema candente que bloquea el trabajo de la oficina. <br><br>  Una se√±ora de la limpieza trape√≥ el cable de alimentaci√≥n al gabinete del servidor.  Se restableci√≥ la energ√≠a, pero un sitio web muy importante a√∫n no funciona.  El sitio web es importante porque la empresa no est√° muy preocupada por la seguridad de la informaci√≥n, y en la p√°gina principal de este se puede encontrar la contrase√±a del administrador de la computadora del CEO en texto claro. <br><br>  El otro d√≠a, se cambi√≥ la contrase√±a, pero todos olvidaron la nueva, el director no puede trabajar.  Se rumorea que hab√≠a claves en esta m√°quina que podr√≠an ayudarnos a descifrar la copia de seguridad de los documentos contables. <br><br>  ¬°Todos esperan una soluci√≥n r√°pida al problema! <br><br><h4>  1.3.  Soluci√≥n </h4><br>  1. En primer lugar, debe cambiar la contrase√±a de root en la m√°quina virtual para poder acceder a ella.  Al inicio, notamos que este es el Servidor Ubuntu 16.04. <br><br>  Para restablecer la contrase√±a de root, reiniciamos la m√°quina, al inicio, cuando se muestra el men√∫ de grub, vaya a la edici√≥n del elemento de Ubuntu con el bot√≥n "e".  Editamos la l√≠nea de Linux, agregamos <code>init=/bin/bash</code> al final.  Cargamos a trav√©s de Ctrl + x, obtenemos bash.  Vuelva a montar la ra√≠z con rw, cambie la contrase√±a: <br><br><pre> <code class="bash hljs">$ mount -o remount,rw /dev/mapper/ubuntu--vg-root $ passwd</code> </pre> <br>  No te olvides de la sincronizaci√≥n, reinicia. <br><br>  2. La condici√≥n dice que el servidor web no funciona para nosotros, buscamos: <br><br><pre> <code class="bash hljs">$ curl localhost Not Found The requested URL / was not found on this server. Apache/2.4.18</code> </pre> <br>  Es decir, de hecho, Apache se est√° ejecutando, pero responde con el c√≥digo 404. Observamos la configuraci√≥n: <br><br><pre> <code class="bash hljs">$ vim /etc/apache2/sites-enabled/000-default.conf</code> </pre> <br>  Tambi√©n hay una clave: StevenPaulSteveJobs. <br><br>  Verificamos la ruta <code>/usr/share/WordPress</code> ; esto no es as√≠, pero hay <code>/usr/share/wordpress</code> .  Corregimos la configuraci√≥n y reiniciamos el Apache. <br><br><pre> <code class="bash hljs">$ systemctl restart apache2</code> </pre> <br>  3. Intentamos nuevamente, obtenemos un error: <br><br><pre> <code class="bash hljs">Warning: mysqli_real_connect(): (HY000/2002): Connection refused <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /usr/share/wordpress/wp-includes/wp-db.php on line 1488</code> </pre> <br>  La base de datos no se est√° ejecutando? <br><br><pre> <code class="bash hljs">$ systemctl status mysql Active: active (running)</code> </pre> <br>  Cual es el problema  Es necesario entender.  Para hacer esto, necesita acceder a MySQL, c√≥mo hacerlo se describe en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> .  Uno de los puntos en la documentaci√≥n recomienda que escribamos la opci√≥n <code>skip-grant-tables</code> en <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code> .  Aqu√≠ tambi√©n est√° la clave: AugustaAdaKingByron. <br><br>  Arreglamos los derechos del usuario <code>'wp'@'localhost'</code> .  Iniciamos MySQL, lo hacemos accesible a trav√©s de la red, comentando la opci√≥n de <code>skip-networking</code> en la configuraci√≥n. <br><br>  4. Despu√©s de las acciones tomadas, se inicia el servidor web, pero el sitio a√∫n no funciona, ya que <br><br><pre> <code class="bash hljs">Warning: require_once(/usr/share/wordpress/wp-content/themes/twentysixteen/footer.php): failed to open stream: Permission denied <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /usr/share/wordpress/wp-includes/template.php on line 562</code> </pre> <br>  Corregimos los derechos del archivo. <br><br><pre> <code class="bash hljs">$ chmod 644 /usr/share/wordpress/wp-content/themes/twentysixteen/footer.php</code> </pre><br>  Actualizamos la p√°gina, vamos al sitio y encontramos la clave: ¬°BjarneStroustrup!  Encontramos las tres claves, nuestro director puede trabajar, desciframos los archivos de contabilidad.  Todos est√°n contentos y usted tiene mucho trabajo por delante para establecer la infraestructura, las copias de seguridad y la seguridad en la empresa. <br><br><h3>  2. La segunda etapa </h3><br>  Era necesario resolver el problema de recopilar an√°lisis.  Todo el mundo ama la anal√≠tica: qui√©n, d√≥nde y en qu√© cantidades van.  Se nos ocurri√≥ un caso que todos los ingenieros en la vida pueden encontrar de una forma u otra. <br><br><h4>  2.1.  Hechos interesantes </h4><br>  Uno de nuestros jugadores ingres√≥ la clave correcta en los primeros 10 minutos del juego, y en la primera hora obtuvimos un l√≠der que hizo frente a la tarea. <br><br><h4>  2.2.  Tarea </h4><br>  Usted fue a trabajar para la empresa, los gerentes se le acercaron y le pidieron que buscara a qui√©n se le enviaron cartas desde √Åfrica.  Debe construir las 21 principales direcciones de destinatarios en ellas.  Las primeras letras de las direcciones de los destinatarios son la clave.  Una cosa: el servidor de correo a trav√©s del cual se enviaron las cartas no se carga.  ¬°Todos esperan una soluci√≥n r√°pida al problema! <br><br><h4>  2.3.  Soluci√≥n </h4><br>  1. El servidor no se carga debido a la partici√≥n de intercambio inexistente en fstab, en el arranque el sistema intenta montarlo y se bloquea.  ¬øC√≥mo arrancar? <br><br>  Descargue la imagen, descargamos CentOS 7, arranque desde el Live CD / DVD (Soluci√≥n de problemas -&gt; Rescate), monte el sistema, edite <code>/etc/fstab</code> .  Aqu√≠ encontramos la primera clave: GottfriedWilhelm11646Leibniz! <br><br>  Crea un intercambio: <br><br><pre> <code class="bash hljs">$ lvcreate -n swap centos -L 256M $ sync &amp;&amp; reboot</code> </pre> <br>  2. Como siempre, no hay contrase√±a, debe cambiar la contrase√±a de root en la m√°quina virtual.  Ya hicimos esto en la primera tarea.  Cambiamos y vamos con √©xito al servidor, pero inmediatamente se reinicia.  El servidor est√° sobrecargado a una velocidad tal que ni siquiera tiene tiempo para mirar todos los registros con cuidado.  ¬øC√≥mo entender lo que est√° pasando? <br><br>  Nuevamente arrancamos desde livecd, estudiamos cuidadosamente los registros del sistema y, por si acaso, miramos en coronas, debido a esa frecuencia.  All√≠ encontramos el problema y la segunda clave es Alan1912MathisonTuring! <br><br>  Es necesario eliminar o comentar la l√≠nea <code>echo b &gt; /proc/sysrq-trigger</code> en <code>/etc/crontab</code> . <br><br>  3. Despu√©s de eso, el servidor se inici√≥ y puede completar la tarea de los administradores: "¬øCu√°les son las direcciones de √Åfrica?"  Esta informaci√≥n est√° generalmente disponible al p√∫blico.  Puede encontrar esta informaci√≥n en Internet usando las frases "direcci√≥n ip africa", "base de datos geoip".  Para resolver el problema, puede usar bases de distribuci√≥n de direcciones disponibles libremente (geoip).  Utilizamos la base de datos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MaxMind GeoLite2</a> , disponible bajo la licencia Creative Commons Attribution-ShareAlike 4.0, como referencia. <br><br>  Tratemos de resolver nuestro problema usando solo las utilidades del sistema Linux, pero en general se puede resolver de muchas maneras: usando utilidades de filtrado de texto y usando scripts en varios lenguajes de programaci√≥n. <br><br>  Para empezar, solo obtenemos los pares "remitente IP - destinatario" del registro de correo <code>/var/log/maillog</code> (construyamos una tabla de destinatarios de correo electr√≥nico - remitente IP).  Esto se puede hacer con el siguiente comando: <br><br><pre> <code class="bash hljs">$ cat /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/maillog | fgrep -e <span class="hljs-string"><span class="hljs-string">' connect from'</span></span> -e <span class="hljs-string"><span class="hljs-string">'status=sent'</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/[]&lt;&gt;[]/ /g'</span></span> | awk <span class="hljs-string"><span class="hljs-string">'/connect from/ {ip=$11} /status=sent/ {print $10" "ip}'</span></span> &gt; log1.txt</code> </pre> <br>  Y antes de continuar con la compilaci√≥n de la base de datos de direcciones africanas, miramos las principales direcciones IP de los remitentes. <br><br><pre> <code class="bash hljs">$ cat log1.txt | cut -d<span class="hljs-string"><span class="hljs-string">' '</span></span> -f1 | sort | uniq -c | sort -r | head -n 40 5206 L2JhbjAbM67GA99jg@mail.ru 4165 iHKTBkegOQa6fIALq@mail.ru 3739 nHkcBl7BdgXxijSYD7@mail.ru 3405 SMAzPJAzbl9vp4hAXo@mail.ru 3346 xILz6d7P@mail.ru</code> </pre><br>  Entre todos, los primeros tres destinatarios de la parte superior se distinguen claramente por el n√∫mero de letras.  Si selecciona las direcciones IP de los remitentes que se enviaron a las direcciones de este top 3, puede ver el claro predominio de ciertas redes: <br><br><pre> <code class="bash hljs">$ cat log1.txt | fgrep <span class="hljs-string"><span class="hljs-string">'L2JhbjAbM67GA99jg@mail.ru'</span></span> | cut -d<span class="hljs-string"><span class="hljs-string">' '</span></span> -f2 | sort | cut -d<span class="hljs-string"><span class="hljs-string">'.'</span></span> -f1 | uniq -c | sort -r | head 831 105 806 41 782 197 664 196 542 154 503 102 266 156 165 45 150 160 108 165</code> </pre> <br>  La mayor√≠a de las redes 105/8, 41/8, 196 / 8,197 / 8 son asignadas por AFRINIC, uno de los cinco registradores regionales de Internet que distribuyen recursos de Internet.  AFRINIC distribuye espacios de direcciones en √Åfrica.  Y 41/8 se refiere a AFRINIC por completo. <br><br><pre> <code class="bash hljs">https://www.nic.ru/whois/?searchWord=105.0.0.0 https://www.nic.ru/whois/?searchWord=41.0.0.0</code> </pre><br>  Por lo tanto, la respuesta al problema, de hecho, est√° en el registro mismo. <br><br><pre> <code class="bash hljs">$ cat log1.txt | fgrep -e <span class="hljs-string"><span class="hljs-string">'105.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'41.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'196.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'197.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'154.'</span></span> -e <span class="hljs-string"><span class="hljs-string">'102.'</span></span> | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span> | sort | uniq -c | sort -r | head -n 21 4209 L2JhbjAbM67GA99jg@mail.ru 3313 iHKTBkegOQa6fIALq@mail.ru 2704 nHkcBl7BdgXxijSYD7@mail.ru 2215 uvRbp1O@mail.ru 1774 sPmMsmmFiV@mail.ru 1448 BtG3aHgQgCKuze2AKuRH@mail.ru 1233 eQpuuQ2uQdbwRL3@mail.ru 958 nJT5dpaBZ@mail.ru 862 ef4WbQiB@mail.ru 762 dQCqKL6eVminFfH7wLA@mail.ru 632 ifq6Rd1HxuCQOdO9@mail.ru 539 cFwm2ssypMmx1sA7@mail.ru 531 twtTnr4G@mail.ru 431 TSrczgYASrR11Hs3qCi@mail.ru 380 o3r3exc3OL@mail.ru 357 rzmjr2VAHK@mail.ru 348 vnPr6YjJ3ndw@mail.ru 312 anOjFXrwOtLP2Rl1Vcz6@mail.ru 289 dvny5zHmRW8fiT@mail.ru 282 sgg9jPxFDYvzw8Kr@mail.ru 274 tKSevzA7GntJ@mail.ru</code> </pre> <br>  En este punto, obtenemos la cadena "LinuxBenedictTorvadst". <br><br>  La clave correcta es LinusBenedictTorvalds. <br><br>  La cadena resultante contiene un error tipogr√°fico en relaci√≥n con la clave correcta en 3 caracteres extremos.  Esto se debe al hecho de que las redes que hemos elegido no est√°n completamente asignadas a los pa√≠ses africanos y a c√≥mo los correos electr√≥nicos se distribuyen por direcciones IP en nuestro registro. <br><br>  Con una aclaraci√≥n suficiente de las redes m√°s grandes asignadas a pa√≠ses africanos, puede obtener la respuesta exacta: <br><br><pre> <code class="bash hljs">$ cat log1.txt | fgrep -e<span class="hljs-string"><span class="hljs-string">' '</span></span>105.{30..255}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>41. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>196.{64..47}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>196.{248..132}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>197.{160..31}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>154.{127..255}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>102.{70..255}. -e<span class="hljs-string"><span class="hljs-string">' '</span></span>156.{155..255}. | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span> | sort | uniq -c | sort -r | head -n 21 3350 L2JhbjAbM67GA99jg@mail.ru 2662 iHKTBkegOQa6fIALq@mail.ru 2105 nHkcBl7BdgXxijSYD7@mail.ru 1724 uvRbp1O@mail.ru 1376 sPmMsmmFiV@mail.ru 1092 BtG3aHgQgCKuze2AKuRH@mail.ru 849 eQpuuQ2uQdbwRL3@mail.ru 712 nJT5dpaBZ@mail.ru 584 ef4WbQiB@mail.ru 463 dQCqKL6eVminFfH7wLA@mail.ru 365 ifq6Rd1HxuCQOdO9@mail.ru 269 cFwm2ssypMmx1sA7@mail.ru 225 twtTnr4G@mail.ru 168 TSrczgYASrR11Hs3qCi@mail.ru 142 o3r3exc3OL@mail.ru 111 rzmjr2VAHK@mail.ru 96 vnPr6YjJ3ndw@mail.ru 78 anOjFXrwOtLP2Rl1Vcz6@mail.ru 56 lHzWiB7ExvRtSbAcU9@mail.ru 56 dvny5zHmRW8fiT@mail.ru 40 sgg9jPxFDYvzw8Kr@mail.ru</code> </pre> <br>  El problema tambi√©n se puede resolver de otra manera. <br>  Descargue MaxMind, descomprima y los siguientes tres equipos tambi√©n resuelven nuestro problema. <br><br><pre> <code class="bash hljs">$ cat GeoLite2-Country-Locations-ru.csv | grep <span class="hljs-string"><span class="hljs-string">""</span></span> | cut -d<span class="hljs-string"><span class="hljs-string">','</span></span> -f1 &gt; africaIds.txt $ grep -Ff africaIds.txt GeoLite2-Country-Blocks-IPv4.csv | cut -d<span class="hljs-string"><span class="hljs-string">','</span></span> -f1 &gt; africaNetworks.txt $ grepcidr -f africaNetworks.txt log1.txt | cut -d<span class="hljs-string"><span class="hljs-string">' '</span></span> -f1 | sort | uniq -c | sort -r | head -n21</code> </pre><br>  De una forma u otra, eventualmente contamos las estad√≠sticas, ¬°y los gerentes obtuvieron los datos que necesitaban para trabajar! <br><br><h3>  3. La tercera etapa </h3><br>  La tercera etapa es algo similar a la primera: tambi√©n debe reparar el servicio de la l√°mpara caliente, pero es m√°s dif√≠cil que en la primera tarea. <br><br><h4>  3.1.  Hechos interesantes </h4><br>  En los primeros 15 minutos, tres jugadores encontraron la primera clave, 2 horas 20 minutos despu√©s del inicio de la etapa, nuestro ganador complet√≥ la tarea. <br><br><h4>  3.2.  Tarea </h4><br>  Usted fue a trabajar en una compa√±√≠a donde todos los documentos de la compa√±√≠a se almacenan en el servidor Wiki interno.  El a√±o pasado, un ingeniero orden√≥ 3 discos nuevos para el servidor adem√°s de uno existente, argumentando que para la tolerancia a fallas del sistema es necesario colocar discos en algunos arreglos.  Desafortunadamente, unas semanas despu√©s de su instalaci√≥n, el ingeniero se fue a descansar a la India y no regres√≥. <br><br>  Durante varios a√±os, el servidor funcion√≥ sin fallas, pero hace un par de d√≠as la red de la compa√±√≠a fue pirateada.  De acuerdo con las instrucciones, los oficiales de seguridad retiraron los discos del servidor y se los enviaron.  Durante el transporte, un disco se perdi√≥ irremediablemente. <br><br>  Necesita restaurar la wiki, en primer lugar, el contenido de las p√°ginas wiki es de inter√©s.  Un texto que estaba en una de las p√°ginas de este wiki es una contrase√±a de un servidor 1C y se necesita con urgencia para desbloquearlo. <br><br>  Adem√°s, en alg√∫n lugar de las p√°ginas wiki o en otro lugar hab√≠a contrase√±as del servidor de registro y del servidor de videovigilancia, que tambi√©n son deseables para recuperar, sin ellas es imposible investigar el incidente.  ¬°Como siempre, se espera de una soluci√≥n operativa al problema! <br><br><h4>  3.3.  Soluci√≥n </h4><br>  1. Intentamos arrancar a su vez desde las unidades que tenemos y en todas partes recibimos el mismo mensaje: <br><br><pre> <code class="bash hljs">No bootable medium found! System halted</code> </pre><br>  Es necesario arrancar desde algo.  Nuevamente rescata el arranque desde un Live CD / DVD (Soluci√≥n de problemas -&gt; Rescate).  Al arrancar, intentamos encontrar la partici√≥n de arranque, no la encontramos, nos metemos en el shell.  Estamos tratando de aprender qu√© y c√≥mo con los discos.  Se sabe que hay tres de ellos.  Hay m√°s herramientas para esto en la s√©ptima versi√≥n de CentOS, donde hay <code>lsblk</code> <code>blkid</code> o <code>lsblk</code> que nos muestran toda la informaci√≥n sobre los discos. <br><br>  C√≥mo y qu√© hacer: <br><br><pre> <code class="bash hljs">$ ls /dev/sd*</code> </pre> <br>  Est√° claro de inmediato que <br><br><pre> <code class="bash hljs">/dev/sdb1 - ext4 /dev/sdb2 -  lvm /dev/sda1  /dev/sdc1 -   /dev/sda2  /dev/sdc2 -        </code> </pre> <br>  Monte sdb1, est√° claro que esta es la partici√≥n de arranque de CentOS 6. <br><br><pre> <code class="bash hljs">$ mkdir /mnt/sdb1 &amp;&amp; mount /dev/sdb1 /mnt/sdb1</code> </pre> <br>  Obviamente, vamos a la secci√≥n de grub y encontramos la primera clave all√≠: James191955Gosling en un archivo inusual. <br><br>  2. Estudiamos pvs y lvs, mientras trabajamos con LVM.  Vemos que debe haber 2 vol√∫menes f√≠sicos, uno no est√° ubicado y jura por el l√≠quido perdido.  Vemos que deber√≠a haber 2 vol√∫menes l√≥gicamente: ra√≠z e intercambio, mientras que la ra√≠z se pierde parcialmente (el atributo P del volumen).  Mount no funciona, pero lo siento.  Realmente lo necesitamos. <br><br>  Hay 2 discos m√°s, m√≠relos, monte y monte: <br><br><pre> <code class="bash hljs">$ mdadm --examine --verbose --scan $ mdadm --assemble --verbose --scan $ mkdir /mnt/md127 &amp;&amp; mount /dev/md127 /mnt/md127</code> </pre> <br>  Miramos, est√° claro que esta es la partici√≥n de arranque de CentOS 6 y una toma de lo que ya est√° en <code>/dev/sdb1</code> , ¬°y aqu√≠ nuevamente la misma clave es James191955Gosling! <br><br>  Vemos c√≥mo <code>/dev/md127</code> . <br><br><pre> <code class="bash hljs">$ mdadm --detail /dev/md127</code> </pre><br>  Vemos que ten√≠a que ensamblarse a partir de 4 discos, ensamblados a partir de dos <code>/dev/sda1</code> y <code>/dev/sdc1</code> , deber√≠an ser los n√∫meros 2 y 4 en el sistema.  Suponemos que tambi√©n puede crear una matriz desde <code>/dev/sda2</code> y <code>/dev/sdc2</code> .  No est√° claro por qu√© no hay metadatos en ellos, pero esto est√° en la conciencia del administrador, que est√° en alg√∫n lugar de Goa.  Asumimos que deber√≠a haber RAID10, aunque hay opciones.  Recopilamos: <br><br><pre> <code class="bash hljs">$ mdadm --create --verbose /dev/md0 --assume-clean --level=10 --raid-devices=4 missing /dev/sda2 missing /dev/sdc2</code> </pre><br>  Nos fijamos en blkid, pvs, lvs.  Descubrimos que recolectamos un volumen f√≠sico, que anteriormente no ten√≠amos. <br><br>  Inmediatamente arreglamos lvroot, lo montamos, pero primero activamos VG: <br><br><pre> <code class="bash hljs">$ vgchange -ay $ mkdir /mnt/lvroot &amp;&amp; mount /dev/mapper/vg_c6m1-lv_root /mnt/lvroot</code> </pre><br>  Y todo est√° all√≠, incluida la clave DennisBMacAlistairCRitchie, en el directorio de inicio ra√≠z, <code>/root/sweet</code> . <br><br>  3. Sin embargo, estamos tratando de revivir nuestro servidor para que se inicie normalmente.  Todo el volumen l√≥gico c de nuestro <code>/dev/md0</code> (donde tenemos todo) se arrastra a <code>/dev/sdb2</code> , donde inicialmente trabaj√≥ todo el servidor. <br><br><pre> <code class="bash hljs">$ pvmove /dev/md0 /dev/sdb2 $ vgreduce vg_c6m1 /dev/md0</code> </pre> <br>  Apagamos el servidor, eliminamos 1 y 3 discos, dejamos el segundo, arrancamos desde el Live CD / DVD en Rescue.  Encontramos la secci√≥n de arranque, restauramos el gestor de arranque en grub: <br><br><pre> <code class="bash hljs">root (hd0,0) setup (hd0)</code> </pre><br>  Cortamos el disco de arranque y arrancamos con √©xito, pero el sitio no funciona. <br><br>  4. Hay dos opciones para iniciar el sitio: configurar Apache desde cero o usar nginx ya configurado de antemano con php-fpm: <br><br><pre> <code class="bash hljs">$ /etc/init.d/nginx start $ /etc/init.d/php-fpm start</code> </pre><br>  Finalmente, necesitas iniciar MySQL: <br><br><pre> <code class="bash hljs">$ /etc/init.d/mysqld start</code> </pre> <br>  No se inicia y la soluci√≥n se encuentra en <code>/var/log/mysql</code> .  Tan pronto como resuelva el problema con MySQL, el sitio funcionar√°, la p√°gina principal tendr√° una clave: RichardGCCMatthewGNUStallman.  Ahora tenemos acceso a 1C, y los empleados podr√°n recibir un pago.  Y como siempre, tiene mucho trabajo por delante para construir infraestructura y seguridad en la empresa. <br><br>  Tambi√©n podemos compartir una vez m√°s una lista de libros que nos ayudaron a nosotros y a nuestros participantes a prepararse para el juego: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">linux.mail.ru/books</a> . <br><br>  ¬°Gracias por estar con nosotros!  ¬°Sigue los anuncios de los pr√≥ximos juegos! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447222/">https://habr.com/ru/post/447222/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447210/index.html">@Pythonetc compilaci√≥n marzo de 2019</a></li>
<li><a href="../447212/index.html">Consejos y trucos de mi canal de Telegram @pythonetc, marzo de 2019</a></li>
<li><a href="../447214/index.html">C√≥mo mejorar el dise√±o del juego con estrategias √≥ptimas</a></li>
<li><a href="../447218/index.html">An√°lisis de JPoint 2019</a></li>
<li><a href="../447220/index.html">Conceptos b√°sicos del motor de JavaScript: formularios generales y almacenamiento en cach√© en l√≠nea. Parte 2</a></li>
<li><a href="../447226/index.html">Entrevista con el divulgador de la ciencia, jefe de la √∫nica escuela privada de astronom√≠a en Rusia, Pavel Skripnichenko.</a></li>
<li><a href="../447232/index.html">Experiencia personal C√≥mo conectamos la telefon√≠a internacional: comparaci√≥n de 6 intercambios virtuales</a></li>
<li><a href="../447234/index.html">C√≥mo escribir programas polim√≥rficos usando Arrow</a></li>
<li><a href="../447236/index.html">Crear una granja de dispositivos Android con Open STF</a></li>
<li><a href="../447240/index.html">Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>