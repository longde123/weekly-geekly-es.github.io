<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üó≥Ô∏è üçø üïäÔ∏è Plugin isom√©trique pour Unity3D üö¶ üë¥üèª üíù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="C'est une histoire sur la fa√ßon d'√©crire un plugin pour Unity Asset Store , de tenter de r√©soudre les probl√®mes isom√©triques bien connus dans les jeux...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Plugin isom√©trique pour Unity3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436372/"><img src="https://habrastorage.org/files/032/000/6f4/0320006f472344e782f536c293e3099d.png"><br><p>  C'est une histoire sur la fa√ßon d'√©crire un plugin pour <strong>Unity Asset Store</strong> , de tenter de r√©soudre les probl√®mes isom√©triques bien connus dans les jeux, et de gagner un peu d'argent de caf√© √† partir de cela, et aussi de comprendre √† quel point l'√©diteur Unity est extensible.  Images, code, graphiques et pens√©es √† l'int√©rieur. </p><a name="habracut"></a><br><h2 id="prologue">  Prologue </h2><br><p> Donc, c'√©tait une nuit quand j'ai d√©couvert que je n'avais pratiquement rien √† faire.  L'ann√©e √† venir n'√©tait pas vraiment prometteuse dans ma vie professionnelle (contrairement √† celle personnelle, cependant, mais c'est une toute autre histoire).  Quoi qu'il en soit, j'ai eu cette id√©e d'√©crire quelque chose d'amusant pour le bon vieux temps, qui serait assez personnel, quelque chose par moi-m√™me, mais qui a quand m√™me un petit avantage commercial (j'aime juste ce sentiment chaleureux quand votre projet est int√©ressant pour quelqu'un d'autre, sauf pour votre employeur).  Et tout cela est all√© de pair avec le fait que j'attendais depuis longtemps de v√©rifier les possibilit√©s d'extension de l'√©diteur Unity et de voir s'il y a du bon dans sa plate-forme pour vendre les propres extensions du moteur. </p><br><p>  J'ai consacr√© une journ√©e √† l'√©tude du Asset Store: maquettes, scripts, int√©grations avec diff√©rents services.  Et d'abord, il semblait que tout avait d√©j√† √©t√© √©crit et int√©gr√©, ayant m√™me un certain nombre d'options de diff√©rents niveaux de qualit√© et de d√©tail, tout autant que les prix et le support.  Donc, tout de suite, je l'ai r√©duit √†: </p><br><ul><li>  code uniquement (apr√®s tout, je suis programmeur) </li><li>  2D uniquement (car j'adore la 2D et ils viennent de proposer un support pr√™t √† l'emploi correct pour Unity) </li></ul><br><p>  Et puis je me suis souvenu du nombre de cactus que j'ai mang√©s et du nombre de souris mortes lorsque nous faisions un jeu isom√©trique auparavant.  Vous ne croirez pas combien de temps nous avons tu√© sur la recherche de solutions viables et combien de copies nous avons cass√©es en essayant de trier cette isom√©trie et de la dessiner.  Alors, luttant pour garder mes mains immobiles, j'ai cherch√© par diff√©rents mots cl√©s et pas tellement de mots cl√©s et je n'ai rien trouv√© sauf un √©norme tas d'art isom√©trique, jusqu'√† ce que je d√©cide finalement de faire un plugin isom√©trique √† partir de z√©ro. </p><br><h2 id="setting-the-goals">  Fixer les objectifs </h2><br><p>  Le premier dont j'avais besoin √©tait de d√©crire bri√®vement les probl√®mes que ce plugin √©tait cens√© r√©soudre et quelle utilisation le d√©veloppeur de jeux isom√©triques en ferait.  Ainsi, les probl√®mes d'isom√©trie sont les suivants: </p><br><ul><li>  trier les objets par √©loignement afin de les dessiner correctement </li><li>  extension pour la cr√©ation, le positionnement et le d√©placement d'objets isom√©triques dans l'√©diteur </li></ul><br><p>  Ainsi, avec les principaux objectifs formul√©s pour la premi√®re version, je me suis fix√© un d√©lai de 2-3 jours pour la premi√®re version provisoire.  Cela ne pouvait donc pas √™tre diff√©r√©, voyez-vous, car l'enthousiasme est une chose fragile et si vous n'avez pas quelque chose de pr√™t dans les premiers jours, il y a de grandes chances que vous le ruiniez.  Et les vacances du Nouvel An ne sont pas aussi longues que cela puisse para√Ætre, m√™me en Russie, et je voulais sortir la premi√®re version dans un d√©lai d'environ dix jours. </p><br><h2 id="sorting">  Tri </h2><br><p>  Pour faire court, l'isom√©trie est une tentative faite par les sprites 2D pour ressembler √† des mod√®les 3D.  Cela se traduit bien s√ªr par des dizaines de probl√®mes.  Le principal est que les sprites doivent √™tre tri√©s dans l'ordre dans lequel ils devaient √™tre dessin√©s pour √©viter les probl√®mes de chevauchement mutuel. </p><br><img src="https://habrastorage.org/files/60f/22b/db9/60f22bdb9ed3434888232416258f4b37.png"><br><blockquote>  <em>Sur la capture d'√©cran, vous pouvez voir comment c'est le sprite vert qui est dessin√© en premier (2,1), puis le bleu va (1,1)</em> </blockquote><br><img src="https://habrastorage.org/files/9ba/a39/c6c/9baa39c6cd3b4584a57bbf1be169c050.png"><br><blockquote>  <em>La capture d'√©cran montre le tri incorrect lorsque le sprite bleu est dessin√© en premier</em> </blockquote><p>  Dans ce cas simple, le tri ne sera pas un tel probl√®me, et il y aura des options, par exemple: </p><br><ul><li>  tri par position de Y sur l'√©cran, qui est * <em>(isoX + isoY)</em> 0,5 + isoZ ** </li><li>  dessin √† partir de la cellule de grille isom√©trique la plus √©loign√©e de gauche √† droite, de haut en bas <strong>[(3,3), (2,3), (3,2), (1,3), (2,2), (3, 1), ...]</strong> </li><li>  et tout un tas d'autres fa√ßons int√©ressantes et pas vraiment int√©ressantes </li></ul><br><p>  Ils sont tous assez bons, rapides et fonctionnent, mais uniquement dans le cas de tels objets ou colonnes unicellulaires √©tendus dans la direction isoZ :) Apr√®s tout, j'√©tais int√©ress√© par une solution plus courante qui fonctionnerait pour les objets √©tendus dans la direction d'une coordonn√©e, ou m√™me les "cl√¥tures" qui n'ont absolument aucune largeur, mais qui s'√©tendent dans le m√™me sens que la hauteur n√©cessaire. </p><br><img src="https://habrastorage.org/files/396/376/23d/39637623d1c147478ef0223501a0d240.png"><br><blockquote>  <em>La capture d'√©cran montre la bonne fa√ßon de trier les objets √©tendus <strong>3x1</strong> et <strong>1x3</strong> avec des "cl√¥tures" mesurant <strong>3x0</strong> et <strong>0x3</strong></em> </blockquote><p>  Et c'est l√† que nos probl√®mes commencent et nous mettent en place o√π nous devons d√©cider de la voie √† suivre: </p><br><ul><li><p>  diviser les objets "multicellulaires" en objets "unicellulaires", c'est-√†-dire les couper verticalement puis trier les bandes √©merg√©es </p><br></li><li><p>  penser √† la nouvelle m√©thode de tri, plus compliqu√©e et int√©ressante </p><br></li></ul><br><p>  J'ai choisi la deuxi√®me option, n'ayant aucune envie particuli√®re d'entrer dans le traitement d√©licat de chaque objet, dans la d√©coupe (m√™me automatique), et l'approche particuli√®re de la logique.  Pour m√©moire, ils ont utilis√© la premi√®re voie dans quelques jeux c√©l√®bres comme <strong>Fallout 1</strong> et <strong>Fallout 2</strong> .  Vous pouvez r√©ellement voir ces bandes si vous entrez dans les donn√©es des jeux. </p><br><p>  Ainsi, la deuxi√®me option n'implique aucun crit√®re de tri.  Cela signifie qu'il n'y a pas de valeur pr√©-calcul√©e permettant de trier les objets.  Si vous ne me croyez pas (et je suppose que beaucoup de gens qui n'ont jamais travaill√© avec l'isom√©trie ne le font pas), prenez un morceau de papier et dessinez de petits objets mesurant comme <strong>2x8</strong> et, par exemple, <strong>2x2</strong> .  Si vous parvenez √† trouver une valeur pour calculer sa profondeur et son tri, ajoutez simplement un objet <strong>8x2</strong> et essayez de les trier dans des positions diff√©rentes les unes par rapport aux autres. </p><br><p>  Donc, il n'y a pas une telle valeur, mais nous pouvons toujours utiliser des d√©pendances entre elles (grosso modo, lesquelles se chevauchent qui) pour le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tri topologique</a> .  Nous pouvons calculer les d√©pendances des objets en utilisant des projections de coordonn√©es isom√©triques sur l'axe isom√©trique. </p><br><img src="https://habrastorage.org/files/db0/1cd/835/db01cd8359494b35aaee399e197c972e.png"><br><blockquote>  <em>La capture d'√©cran montre le cube bleu d√©pendant du rouge</em> </blockquote><br><img src="https://habrastorage.org/files/eb3/af1/0d0/eb3af10d0cf04c6ba48a481a0b039f3c.png"><br><blockquote>  <em>La capture d'√©cran montre le cube vert d√©pendant du bleu</em> </blockquote><p>  Un pseudocode pour la d√©termination des d√©pendances pour deux axes (le m√™me fonctionne avec l'axe Z): </p><br><pre><code class="plaintext hljs">bool IsIsoObjectsDepends(IsoObject obj_a, IsoObject obj_b) { var obj_a_max_size = obj_a.position + obj_a.size; return obj_b.position.x &lt; obj_a_max_size.x &amp;&amp; obj_b.position.y &lt; obj_a_max_size.y; }</code> </pre> <br><p>  Avec une telle approche, nous construisons des d√©pendances entre tous les objets, en les passant r√©cursivement et en marquant la coordonn√©e Z d'affichage.  La m√©thode est assez universelle et, surtout, elle fonctionne.  Vous pouvez lire la description d√©taill√©e de cet algorithme, par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Ils utilisent √©galement ce type d'approche dans la biblioth√®que isom√©trique flash populaire ( <a href="">as3isolib</a> ). </p><br><p>  Et tout √©tait tout simplement g√©nial, sauf que la complexit√© temporelle de cette approche est <strong>O (N ^ 2)</strong> car nous devons comparer chaque objet √† tous les autres afin de cr√©er les d√©pendances.  J'ai laiss√© l'optimisation pour les versions ult√©rieures, apr√®s avoir ajout√© uniquement un nouveau tri paresseux afin que rien ne soit tri√© jusqu'√† ce que quelque chose bouge.  Nous allons donc parler d'optimisation un peu plus tard. </p><br><h2 id="editor-extension">  Extension de l'√©diteur </h2><br><p>  D√©sormais, j'avais les objectifs suivants: </p><br><ul><li>  le tri des objets devait fonctionner dans l'√©diteur (pas seulement dans un jeu) </li><li>  il devait y avoir un autre type de Gizmos-Arrow (fl√®ches pour d√©placer des objets) </li><li>  facultativement, il y aurait un alignement avec des tuiles lorsque l'objet est d√©plac√© </li><li>  les tailles de tuiles seraient appliqu√©es et d√©finies automatiquement dans l'inspecteur du monde isom√©trique </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les</a> objets <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AABB</a> sont dessin√©s selon leurs tailles isom√©triques </li><li>  sortie de coordonn√©es isom√©triques dans l'inspecteur d'objets, en changeant ce que nous changerions la position de l'objet dans le monde du jeu </li></ul><br><p>  Et tous ces objectifs ont √©t√© atteints.  Unity permet vraiment d'√©tendre consid√©rablement son √©diteur.  Vous pouvez ajouter de nouveaux onglets, fen√™tres, boutons, nouveaux champs dans l'inspecteur d'objets.  Si vous le souhaitez, vous pouvez m√™me cr√©er un inspecteur personnalis√© pour un composant du type exact dont vous avez besoin.  Vous pouvez √©galement g√©n√©rer des informations suppl√©mentaires dans la fen√™tre de l'√©diteur (dans mon cas, sur les objets AABB) et remplacer √©galement les gizmos de d√©placement standard des objets.  Le probl√®me du tri √† l'int√©rieur de l'√©diteur a √©t√© r√©solu via cette balise magique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ExecuteInEditMode</a> , qui permet d'ex√©cuter des composants de l'objet en mode √©diteur, c'est-√†-dire de la m√™me mani√®re que dans un jeu. </p><br><p>  Tout cela a √©t√© fait, bien s√ªr, non sans difficult√©s et astuces de toutes sortes, mais il n'y avait pas de probl√®me unique sur lequel j'avais pass√© plus de quelques heures (Google, les forums et les communaut√©s m'ont certainement aid√© √† r√©soudre tous les probl√®mes (qui n‚Äôont pas √©t√© mentionn√©s dans la documentation). </p><br><img src="https://habrastorage.org/files/df6/ae0/2ae/df6ae02aec294ca28d9a6ffcf1b81382.png"><br><blockquote>  <em>La capture d'√©cran montre mes gadgets pour les objets en mouvement dans le monde isom√©trique</em> </blockquote><br><h2 id="release">  Rel√¢chez </h2><br><p>  J'ai donc pr√©par√© la premi√®re version, j'ai fait la capture d'√©cran.  J'ai m√™me dessin√© une ic√¥ne et √©crit une description.  Il est temps.  J'ai donc fix√© un prix nominal de 5 $, t√©l√©charg√© le plugin dans le magasin et attendu qu'il soit approuv√© par Unity.  Je n'ai pas beaucoup r√©fl√©chi au prix, car je ne voulais pas encore vraiment gagner beaucoup d'argent.  Mon but √©tait de savoir s'il y avait une demande g√©n√©rale et si c'√©tait le cas, je voudrais l'estimer.  Je voulais aussi aider les d√©veloppeurs de jeux isom√©triques qui se sont en quelque sorte retrouv√©s absolument priv√©s d'opportunit√©s et d'ajouts. </p><br><p>  En 5 jours assez douloureux (j'ai pass√© √† peu pr√®s le m√™me temps √† √©crire la premi√®re version, mais je savais ce que je faisais, sans plus me demander et sans trop r√©fl√©chir, ce qui m'a donn√© une vitesse plus √©lev√©e par rapport aux gens qui venaient juste de commencer √† travailler avec l'isom√©trie) J'ai re√ßu une r√©ponse d'Unity disant que le plugin √©tait approuv√© et que je pouvais d√©j√† le voir dans le magasin, tout comme ses ventes nulles (jusqu'√† pr√©sent).  Il s'est enregistr√© sur le forum local, a int√©gr√© Google Analytics dans la page du plugin dans le magasin et s'est pr√©par√© √† attendre que l'herbe pousse. </p><br><p>  Il n'a pas fallu beaucoup de temps avant les premi√®res ventes, tout comme les retours sur le forum et la boutique.  Pour les jours restants du 12 janvier, des exemplaires de mon plugin ont √©t√© vendus, que j'ai consid√©r√©s comme un signe d'int√©r√™t public et que j'ai d√©cid√© de continuer. </p><br><h2 id="optimization">  Optimisation </h2><br><p>  Donc, j'√©tais m√©content de deux choses: </p><br><ul><li>  Complexit√© temporelle du tri - O (N ^ 2) </li><li>  Probl√®mes avec la r√©cup√©ration de place et les performances g√©n√©rales </li></ul><br><h3 id="algorithm">  Algorithme </h3><br><p>  Ayant 100 objets et O (N ^ 2) j'avais 10 000 it√©rations √† faire juste pour trouver des d√©pendances, et aussi je devrais les passer tous et marquer l'affichage Z pour le tri.  Il aurait d√ª y avoir une solution pour cela.  J'ai donc essay√© un grand nombre d'options, je n'ai pas pu dormir en pensant √† ce probl√®me.  Quoi qu'il en soit, je ne vais pas vous parler de toutes les m√©thodes que j'ai essay√©es, mais je vais d√©crire celle que j'ai trouv√©e la meilleure jusqu'√† pr√©sent. </p><br><p>  Tout d'abord, bien s√ªr, nous ne trions que les objets visibles.  Ce que cela signifie, c'est que nous devons constamment savoir ce qui est dans notre tir.  S'il y a un nouvel objet, nous devons l'ajouter dans le processus de tri, et si l'un des anciens est parti - ignorez-le.  D√©sormais, Unity ne permet pas de d√©terminer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bo√Æte englobante de</a> l'objet avec ses enfants dans l'arborescence de la sc√®ne.  Passer sur les enfants (√† chaque fois, d'ailleurs, car ils peuvent √™tre ajout√©s et supprim√©s) ne fonctionnerait pas - trop lent.  Nous ne pouvons pas non plus utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OnBecameVisible</a> et d'autres √©v√©nements car ceux-ci ne fonctionnent que pour les objets parents.  Mais nous pouvons obtenir tous les composants <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Renderer</a> de l'objet n√©cessaire et de ses enfants.  Bien s√ªr, cela ne semble pas √™tre notre meilleure option, mais je n'ai pas pu trouver un autre moyen, m√™me universel et acceptable par les performances. </p><br><pre> <code class="plaintext hljs">List&lt;Renderer&gt; _tmpRenderers = new List&lt;Renderer&gt;(); bool IsIsoObjectVisible(IsoObject iso_object) { iso_object.GetComponentsInChildren&lt;Renderer&gt;(_tmpRenderers); for ( var i = 0; i &lt; _tmpRenderers.Count; ++i ) { if ( _tmpRenderers[i].isVisible ) { return true; } } return false; }</code> </pre> <br><p>  <em>Il y a une petite astuce d'utiliser la fonction <strong>GetComponentsInChildren</strong> qui permet d'obtenir des composants sans allocations dans le tampon n√©cessaire, contrairement √† un autre qui retourne un nouveau tableau de composants</em> </p><br><p>  Deuxi√®mement, je devais encore faire quelque chose pour <strong>O (N ^ 2)</strong> .  J'ai essay√© un certain nombre de techniques de fractionnement d'espace avant de m'arr√™ter sur une simple grille bidimensionnelle dans l'espace d'affichage o√π je projette mes objets isom√©triques.  Chacun de ces secteurs contient une liste d'objets isom√©triques qui le traversent.  Donc, l'id√©e est simple: si les projections des objets ne sont pas crois√©es, il ne sert √† rien de cr√©er des d√©pendances entre les objets.  Ensuite, nous passons sur tous les objets visibles et cr√©ons des d√©pendances uniquement dans les secteurs o√π cela est n√©cessaire, r√©duisant ainsi la complexit√© temporelle de l'algorithme et augmentant les performances.  Nous calculons la taille de chaque secteur en moyenne entre les tailles de tous les objets.  J'ai trouv√© le r√©sultat plus que satisfaisant. </p><br><h3 id="general-performance">  Performance g√©n√©rale </h3><br><p>  Bien s√ªr, je pourrais √©crire un article s√©par√© √† ce sujet ... D'accord, essayons de faire ce court.  Tout d'abord, nous encaissons les composants (nous utilisons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GetComponent</a> pour les trouver, ce qui n'est pas rapide).  Je recommande √† tout le monde d'√™tre vigilant lorsque vous travaillez avec tout ce qui a √† voir avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Update</a> .  Vous devez toujours garder √† l'esprit que cela se produit pour chaque image, vous devez donc √™tre tr√®s prudent. N'oubliez pas non plus toutes les fonctionnalit√©s int√©ressantes comme l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">op√©rateur == personnalis√©</a> .  Il y a beaucoup de choses √† garder √† l'esprit, mais √† la fin, vous apprenez √† conna√Ætre chacune d'entre elles dans le profileur int√©gr√©.  Il est beaucoup plus facile de les m√©moriser et de les utiliser :) </p><br><p>  Vous comprenez √©galement vraiment la douleur du ramasse-miettes.  Besoin de performances sup√©rieures?  Ensuite, oubliez tout ce qui peut allouer de la m√©moire, qui en <strong>C #</strong> (en particulier dans l'ancien compilateur <strong>Mono</strong> ) peut √™tre fait par n'importe quoi, allant de <strong>foreach</strong> (!) Aux lambdas √©mergents, sans parler de <strong>LINQ</strong> qui vous est d√©sormais interdit m√™me dans les cas les plus simples.  En fin de compte, au lieu de <strong>C #</strong> avec son sucre syntaxique, vous obtenez un semblant de <strong>C</strong> avec des capacit√©s ridicules. </p><br><p>  Ici, je vais donner quelques liens sur le sujet que vous pourriez trouver utile: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Part1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Part2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Part3</a> . </p><br><h3 id="results">  R√©sultats </h3><br><p>  Je n'ai jamais connu personne utilisant cette technique d'optimisation auparavant, donc j'√©tais particuli√®rement heureux de voir les r√©sultats.  Et si dans les premi√®res versions il fallait litt√©ralement 50 objets en mouvement pour que le jeu le transforme en diaporama, maintenant cela fonctionne plut√¥t bien m√™me s'il y a 800 objets dans un cadre: tout tourne √† vitesse maximale et re-trie juste pour 3-6 ms ce qui est tr√®s bon pour ce nombre d'objets en isom√©trie.  De plus, apr√®s l'initialisation, il n'a presque pas allou√© de m√©moire pour une trame :) </p><br><h2 id="further-opportunities">  D'autres opportunit√©s </h2><br><p>  Apr√®s avoir lu les commentaires et les suggestions, j'ai ajout√© quelques fonctionnalit√©s dans les versions pr√©c√©dentes. </p><br><h3 id="2d3d-mixture">  M√©lange 2D / 3D </h3><br><p>  M√©langer 2D et 3D dans des jeux isom√©triques est une opportunit√© int√©ressante permettant de minimiser le dessin de diff√©rentes options de mouvement et de rotation (par exemple, des mod√®les 3D de personnages anim√©s).  Ce n'est pas vraiment difficile √† faire, mais n√©cessite une int√©gration dans le syst√®me de tri.  Il vous suffit d'obtenir une <strong>bo√Æte englobante</strong> du mod√®le avec tous ses enfants, puis de d√©placer le mod√®le le long de l'affichage Z de la largeur de la bo√Æte. </p><br><pre> <code class="plaintext hljs">Bounds IsoObject3DBounds(IsoObject iso_object) { var bounds = new Bounds(); iso_object.GetComponentsInChildren&lt;Renderer&gt;(_tmpRenderers); if ( _tmpRenderers.Count &gt; 0 ) { bounds = _tmpRenderers[0].bounds; for ( var i = 1; i &lt; _tmpRenderers.Count; ++i ) { bounds.Encapsulate(_tmpRenderers[i].bounds); } } return bounds; }</code> </pre> <br><p>  <em>c'est un exemple de la fa√ßon dont vous pouvez obtenir la <strong>bo√Æte englobante</strong> du mod√®le avec tous ses enfants</em> </p><br><img src="https://habrastorage.org/files/837/b52/c02/837b52c025b6485c95ede6c77a5b4ed3.gif"><br><blockquote>  <em>et voil√† √† quoi √ßa ressemble quand c'est fait</em> </blockquote><br><h3 id="custom-isometric-settings">  Param√®tres isom√©triques personnalis√©s </h3><br><p>  C'est relativement simple.  On m'a demand√© de permettre de r√©gler l'angle isom√©trique, le rapport hauteur / largeur, la hauteur des carreaux.  Apr√®s avoir souffert de douleurs li√©es aux math√©matiques, vous obtenez quelque chose comme ceci: </p><br><img src="https://habrastorage.org/files/02b/f56/35e/02bf5635e5df46778915d43caf2bd846.gif"><br><br><h3 id="physics">  La physique </h3><br><p>  Et ici, cela devient plus int√©ressant.  √âtant donn√© que l'isom√©trie simule le monde 3D, la physique est √©galement cens√©e √™tre tridimensionnelle, avec la hauteur et tout.  J'ai trouv√© ce tour fascinant.  Je reproduis tous les composants de la physique, tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rigidbody</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Collider</a> et ainsi de suite, pour le monde isom√©trique.  Selon ces descriptions et configurations, je fais la copie du monde physique tridimensionnel invisible en utilisant le moteur lui-m√™me et <strong>PhysX</strong> int√©gr√©.  Apr√®s cela, je prends les donn√©es de simulation calcul√©es et j'obtiens ces bacl en dupliquant des composants pour le monde isom√©trique.  Ensuite, je fais de m√™me pour simuler des √©v√©nements de d√©clenchement et de d√©clenchement. </p><br><img src="https://habrastorage.org/files/56c/c0b/199/56cc0b19987043bbb94baa257879b224.gif"><br><blockquote>  <em>La d√©mo physique du jeu d'outils GIF</em> </blockquote><br><h2 id="epilogue-and-conclusions">  √âpilogue et conclusions </h2><br><p>  Apr√®s avoir mis en ≈ìuvre toutes les suggestions du forum, j'ai d√©cid√© d'augmenter le prix jusqu'√† 40 dollars, donc cela ne ressemblerait pas √† un autre plugin bon march√© avec cinq lignes de code :) Je serai tr√®s heureux de r√©pondre aux questions et √©coutez vos conseils.  Comme c'est la premi√®re fois que j'√©cris quelque chose sur Habr, j'accueille toutes sortes de critiques, merci!  Et maintenant, quelque chose que j'√©conomisais pour la fin, les statistiques des ventes du mois: </p><br><table border="1" width="200"><tbody><tr><th>  Mois </th><th>  5 $ </th><th>  40 $ </th></tr><tr><td>  Janvier </td><td>  12 </td><td>  0 </td></tr><tr><td>  Fevrier </td><td>  22 </td><td>  0 </td></tr><tr><td>  Mars </td><td>  17 </td><td>  0 </td></tr><tr><td>  Avril </td><td>  9 </td><td>  0 </td></tr><tr><td>  Mai </td><td>  9 </td><td>  0 </td></tr><tr><td>  Juin </td><td>  9 </td><td>  0 </td></tr><tr><td>  Juillet </td><td>  7 </td><td>  4 </td></tr><tr><td>  Ao√ªt </td><td>  0 </td><td>  4 </td></tr><tr><td>  Septembre </td><td>  0 </td><td>  5 </td></tr></tbody></table><br><p>  Lien vers la page Unity Asset Store: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">jeu d'outils isom√©trique 2.5D</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436372/">https://habr.com/ru/post/fr436372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436356/index.html">[Int√©ressant de derri√®re la colline] Comment arr√™ter la d√©pendance technologique?</a></li>
<li><a href="../fr436358/index.html">Pourquoi les d√©veloppeurs seniors enseignent-ils aux √©tudiants</a></li>
<li><a href="../fr436360/index.html">Je dois aller vite: construire pour la vitesse dans iOS. Partie 1</a></li>
<li><a href="../fr436364/index.html">Liveprof vous montrera quand et pourquoi les performances de votre application PHP ont chang√©</a></li>
<li><a href="../fr436370/index.html">Infrastructure √† cl√© publique Cha√Æne de certificats racine X509 v.3</a></li>
<li><a href="../fr436374/index.html">Tendances de conception UI et UX 2019</a></li>
<li><a href="../fr436376/index.html">Pr√©sentation du robot tout-terrain EZ-Robot Roli Rover</a></li>
<li><a href="../fr436378/index.html">bobaos.pub - KNX TP / UART, Raspberry Pi et Redis</a></li>
<li><a href="../fr436380/index.html">D√©marrage rapide en impression 3D: imprimantes √©conomiques pour d√©butants ou technologie grand public</a></li>
<li><a href="../fr436382/index.html">Antiquit√©s: dix ans d'√©volution de l'ordinateur portable avec le ThinkPad X301</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>