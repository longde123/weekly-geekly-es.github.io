<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖐🏽 🐙 🤝 Sistem Monitoring untuk server Windows pada SQL murni, dan bagaimana saya secara diam-diam menyeretnya ke dalam Produksi 🧝🏽 👩🏿‍🚒 🔖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dahulu di galaksi jauh, jauh sekali ada perusahaan tumbuh dari startup menjadi sesuatu yang jauh lebih besar, tetapi untuk sementara waktu departemen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistem Monitoring untuk server Windows pada SQL murni, dan bagaimana saya secara diam-diam menyeretnya ke dalam Produksi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437864/"> Dahulu di galaksi jauh, jauh sekali ada perusahaan tumbuh dari startup menjadi sesuatu yang jauh lebih besar, tetapi untuk sementara waktu departemen TI masih kompak dan sangat efisien.  Perusahaan itu di-host <i>pada</i> ratusan server Windows virtual awal, dan tentu saja server ini dimonitor.  Bahkan sebelum saya bergabung dengan perusahaan, NetIQ telah dipilih sebagai solusi pemantauan. <br><br>  Salah satu tugas baru saya adalah mendukung NetIQ.  Orang itu, yang pernah bekerja dengan NetIQ sebelumnya, mengatakan banyak tentang pengalamannya dengan NetIQ, sayangnya, jika saya mencoba untuk menaruhnya di sini, itu hanya akan menjadi garis panjang karakter '****'.  Segera saya menyadari mengapa.  Steve Jobs mungkin berputar di kuburnya melihat antarmuka seperti ini: <br><br><img src="https://habrastorage.org/webt/wv/cq/kj/wvcqkjtunh0raiwt14rvhpbn-pw.png" alt="gambar"><br><a name="habracut"></a><br>  Di satu baris logika kotak centang positif ( <i>naikkan acara</i> ), di baris berikutnya negatif ( <i>Jangan naikkan acara</i> ).  Jadi bagaimana ' <i>Naikkan acara hanya jika aku</i> bekerja'?  Saya tidak tahu. <br><br>  Namun, ada hal yang jauh lebih buruk tentang NetIQ: agen pengawasannya sangat rapuh.  Jauh lebih rentan daripada Windows itu sendiri.  Memori rendah?  Agen sedang down.  CPU 100%?  Agen tidak responsif.  0 byte gratis tersisa di disk drive?  Nah, untuk mengirim pesan peringatan, agen harus terlebih dahulu menyimpannya ke file di disk ... Jadi ya, Anda tidak mendapatkan peringatan apa pun dalam kasus itu. <br><br>  Namun, “jangan memperbaiki apa yang tidak rusak”, dan entah bagaimana, kami hidup dengannya sampai perusahaan kami dibeli oleh perusahaan yang jauh lebih besar.  Ketika sebuah perusahaan besar membeli yang kecil, yang kecil menghilang sebagai tetesan air di laut.  Namun, dalam kasus kami, kami (dari perspektif TI) tidak jauh lebih kecil dari TI perusahaan yang lebih besar, dan sudah jelas sejak awal bahwa merger akan sangat rumit.  Begitu rumit sehingga untuk sementara waktu kami ditinggalkan sendirian sebagai departemen independen dan semua proses bisnis dan TI dijaga tetap sama - persis di bawah payung nama baru.  Itu mengingatkan saya tentang momen, ketika <b>THE RING</b> berbaring di lava tetapi belum mulai mencair. <br><br><img src="https://habrastorage.org/webt/qf/--/cy/qf--cyd5ehkjz_5zjhmogmwekcw.jpeg" alt="gambar"><br><br>  Sementara itu, saya telah memutakhirkan NetIQ dari versi 7 ke 8, dan kemudian ke versi 9. Saat itulah semua masalah kami mulai.  Kami menggunakan NetIQ untuk memantau hanya beberapa hal mendasar: ketersediaan server, memori, CPU, ruang disk dan yang paling penting bagi kami - status layanan yang dikembangkan di rumah.  Ketika jenis startup layanan rumahan diatur ke "Otomatis" maka itu harus selalu berjalan (jika tidak kami anggap crash).  Seharusnya tidak ada kasus seperti ini: <br><br><img src="https://habrastorage.org/webt/45/fz/1h/45fz1ho3t3mxx6ka8yjlhg-_yjs.jpeg" alt="gambar"><br><br>  Jadi, NetIQ berhenti memantau status layanan.  Setelah satu minggu percobaan dan satu minggu lagi panggilan dengan dukungan NetIQ, kami telah belajar bahwa " <i>itu bukan bug, itu fitur</i> " dan peringatan dipicu hanya ketika proses keluar dengan kode keluar tertentu.  Dan layanan kami macet dengan kode APAPUN. <br><br>  Pada saat itu sudah terlambat untuk mundur.  Seperti yang Anda pahami, segera setelah kami menemukan bahwa infrastruktur penting kami tidak dimonitor, kami segera ... eh ... tidak melakukan apa-apa.  Karena pada saat itu proses "peleburan" perusahaan kami menjadi lebih besar mencapai fase aktif, dan terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/cq/y3/zk/cqy3zk1iyhts4aijbhx0umtxab8.jpeg" alt="gambar"><br><br>  Saya mendengar suara guntur dari jauh di atas, dan sepertinya para dewa di Olympus menentukan nasib dunia, sementara saya mencoba mengalihkan perhatian mereka dengan masalah teknis kecil saya.  Pada saat yang sama, saya tidak bisa tidur mengetahui bahwa sistem pemantauan kami setengah buta. <br><br>  Setelah saya menyadari bahwa tidak ada yang perlu ditunggu, saya memutuskan untuk membuat solusi cepat dan kotor - pemindai layanan kecil yang harus memeriksa semua server untuk memeriksa layanan dan mengirim email untuk layanan yang turun, persis seperti versi lama dari NetIQ melakukannya.  Anda mungkin berpikir bahwa skrip PowerShell adalah cara terbaik untuk melakukannya tetapi ... Jika semua yang Anda miliki adalah palu, semuanya terlihat seperti paku.  Jika Anda adalah seorang DBA yang bekerja dengan SQL sejak versi 6.0 maka ... Ini adalah kutipan singkat dari kode, sehingga Anda dapat memahami apa yang saya bicarakan: <br><br><img src="https://habrastorage.org/webt/zt/bb/3h/ztbb3hzjroe6t_bzlsj1atrulbi.png" alt="gambar"><br><br>  Saya hanya perlu beberapa jam untuk menulis solusi pertama.  Selama beberapa hari berikutnya saya menambahkan audit, parameter dan hal-hal mewah lainnya.  Setelah saya memeriksa apa yang bisa dilakukan perintah WMIC, saya tidak bisa berhenti.  Saya tidak ingat persis apa yang terjadi selama 2 minggu ke depan - semuanya agak buram, tetapi ketika saya bangun dari semua fitur NetIQ diimplementasikan menggunakan SQL murni. <br><br>  Saya tidak hanya menyalin fungsionalitas NetIQ "sebagaimana adanya", saya telah mengimplementasikan semua yang saya impikan.  Dalam peringatan email LOWDISK Anda juga mendapatkan PDF yang dilampirkan dengan bagan pertumbuhan penggunaan disk sehingga Anda dapat langsung memahami apakah pertumbuhannya asli atau ada yang salah.  Memori rendah - dan Anda tidak hanya mendapatkan bagan, tetapi juga distribusi memori berdasarkan proses, plus untuk w3wp.exe Anda mendapatkan nama kumpulan ditambahkan.  Saya juga menerapkan pengingat cerdas dengan perlindungan banjir dan banyak hal mewah lainnya.  BTW, daftar server virtual ditarik secara otomatis dari repositori VMware.  Hanya dengan melihat subjek lansiran di klien seluler, Anda dapat langsung mengatakan apa yang sedang terjadi - bahkan tanpa membuka email: <br><br><img src="https://habrastorage.org/webt/ps/cq/fk/pscqfkh5qb23_oujl6zyjmeexzy.png" alt="gambar"><br><br>  Pengembang modern terbiasa membuat level abstraksi sampai batas yang membahayakan kemampuan mereka untuk menulis kode sederhana yang mudah.  Mereka tidak dapat membuat sistem pemantauan tanpa mengatakan: "Oke, jadi untuk server apa pun kita dapat menjalankan serangkaian skrip dengan aturan dari repositori ... Seberapa fleksibel ...".  Tetapi pemantauan beberapa hal mendasar seperti Memori, CPU, disk, status layanan adalah unik.  Dengan menerapkan verifikasi kondisi-kondisi dasar ini dengan tingkat abstraksi mereka berakhir dengan kode yang bekerja sama buruknya untuk semua kasus.  Ini adalah contoh dari sistem SCOM.  Saya yakin itu diterapkan persis oleh spesifikasi: <br><br><img src="https://habrastorage.org/webt/wm/3m/ut/wm3mutentcltlmpobwyjutqm0me.png" alt="gambar"><br><br>  Tetapi keuntungan utama dari sistem baru adalah bahwa tidak ada agen sama sekali.  Tidak ada agen - tidak ada yang dipasang, tidak ada yang rusak.  Sistem itu sederhana dan dapat diandalkan sebagai hummer. <br><br>  Beberapa bulan berikutnya saya datang untuk bekerja dan menghabiskan satu atau dua jam mengerjakan kreasi baru saya - secara perlahan, tanpa tenggat waktu dan ETA, hampir tidak meninggalkan hutang teknis.  Setelah beberapa saat aku memaksakan diriku untuk berhenti. <br><br>  NetIQ masih dalam produksi, tetapi orang-orang pasti lebih suka peringatan dari sistem baru, lebih dapat diandalkan dan informatif.  Berangsur-angsur saya memindahkan semua "pelanggan" yang waspada ke sistem yang baru, namun menjaga sistem yang lama tetap hidup.  Sementara itu, proses "peleburan" perusahaan lama kami menjadi yang lebih besar telah mencapai tahap akhir: <br><br><img src="https://habrastorage.org/webt/8j/sy/da/8jsydazfbheft25w9ugymimk_hi.jpeg" alt="gambar"><br><br>  Semuanya berakhir.  Saya bahkan terkejut bahwa saya memiliki kesempatan untuk bermain dengan hal-hal seperti itu di perusahaan birokrasi besar.  Setelah satu bulan persiapan, saya diberitahu bahwa " <i>ok, dalam seminggu kami mematikan NetIQ dan pindah ke SCOM sebagai standar perusahaan</i> ".  Saya menutup NetIQ (harus saya akui, saya sangat membencinya sehingga itu adalah salah satu momen paling membahagiakan dalam karir saya) dan mulai menunggu kedatangan SCOM.  Tapi tidak ada.  Tidak ada sejak seminggu, dan sebulan, dan bahkan seperempat. <br><br>  Kami mendapat SCOM hanya setelah 6 bulan penuh - seseorang telah lupa tentang biaya lisensi untuk sejumlah besar server yang kami miliki.  Dalam 6 bulan ini banyak departemen menjadi sangat tergantung pada sistem baru, yang menyimpan tidak hanya peringatan tetapi juga metrik kinerja dan inventaris sehingga tidak mungkin untuk mematikannya.  Itu menjadi sistem cadangan kedua.  Untuk para auditor ada SCOM, untuk hal-hal yang benar-benar berguna - ada kreasi saya. <br><br>  Dari waktu ke waktu, manajer di berbagai tingkatan hierarki melangkahi peringatan sistem itu dan bertanya - apa itu?  Baru-baru ini saya telah menjelaskan keseluruhan cerita di balik produk ini.  Mereka tertawa dan membiarkan sistem itu hidup, dan bagi saya itu adalah kesempatan untuk menulis kode seperti ketika saya masih mahasiswa - dibimbing bukan oleh spesifikasi tetapi berdasarkan pada pemahaman saya sendiri, seperti hobi.  Itu sangat menyenangkan. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel dalam bahasa Rusia</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id437864/">https://habr.com/ru/post/id437864/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id437846/index.html">bobaoskit - aksesoris, dnssd dan WebSocket</a></li>
<li><a href="../id437848/index.html">Kami membuat proses pengembangan perangkat lunak berat untuk mikrokontroler menjadi lebih mudah (tidak)</a></li>
<li><a href="../id437850/index.html">Siapa yang paling efektif dalam tata letak PCB?</a></li>
<li><a href="../id437852/index.html">Sejarah Shipastik</a></li>
<li><a href="../id437858/index.html">Kuliah tambahan dari kursus "Merancang Sistem Sangat Dimuat" (musim gugur 2018) di Technopolis</a></li>
<li><a href="../id437868/index.html">Minggu Keamanan 05: Printer, Kamera, 7zip, dan Etika</a></li>
<li><a href="../id437870/index.html">Bagaimana Resident Evil 2 berantakan, tetapi mampu menjadi hit terbesar Capcom</a></li>
<li><a href="../id437872/index.html">Pembuat sepatu tanpa sepatu bot. Bagaimana siswa menulis email phishing</a></li>
<li><a href="../id437876/index.html">"Clouds": apa kelebihan dibandingkan server perusahaan</a></li>
<li><a href="../id437878/index.html">Tren keamanan siber dari BI.ZONE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>