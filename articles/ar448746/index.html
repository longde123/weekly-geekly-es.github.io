<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ค๐ป ๐จ๐ฝโ๐พ ๐๐ผ ุงูููุงุฑุณ ูู PostgreSQL - 7 (GIN) ๐ ๐๐ผ ๐ถ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ุชุนุฑููุง ุจุงููุนู ุนูู ูุญุฑู ููุฑุณุฉ PostgreSQL ููุงุฌูุฉ ุทุฑู ุงููุตูู ููุงูุดูุง ููุงุฑุณ ุงูุชุฌุฒุฆุฉ ุ B-tree ุ ููุฐูู ููุงุฑุณ GiST ู SP-GiST . ูุณุชุญุชูู ูุฐู ุงูููุงูุฉ ุนูู ูุค...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูููุงุฑุณ ูู PostgreSQL - 7 (GIN)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/448746/" style=";text-align:right;direction:rtl">  ููุฏ ุชุนุฑููุง ุจุงููุนู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุฑู ููุฑุณุฉ</a> PostgreSQL ููุงุฌูุฉ ุทุฑู ุงููุตูู ููุงูุดูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฑุณ ุงูุชุฌุฒุฆุฉ</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">B-tree</a> ุ ููุฐูู ููุงุฑุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GiST</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SP-GiST</a> .  ูุณุชุญุชูู ูุฐู ุงูููุงูุฉ ุนูู ูุคุดุฑ GIN. <br><br><h1 style=";text-align:right;direction:rtl">  GIN </h1><br>  <em>"ุงูุฌูุ .. ุงูุฌู ุ ุนูู ูุง ูุจุฏู ุ ูุซู ูุฐุง ุงูุฎููุฑ ุงูุฃูุฑูููุ .."</em> <em><br></em>  <em>"ุฃูุง ูุณุช ุดุฑุงุจูุง ุ ูุง ููุฏ ูุถููู!"</em>  <em>ูุฑุฉ ุฃุฎุฑู ุงูุฏูุนุช ุงูุฑุฌู ุงูุนุฌูุฒ ุ ูุฑุฉ ุฃุฎุฑู ุฃุฏุฑู ููุณู ูุฃุฎุฐ ููุณู ูุฑุฉ ุฃุฎุฑู ูู ูุชูุงูู ุงููุฏ.</em>  <em>"ุฃูุง ูุณุช ุดุฑุงุจูุง ุ ููู ุฑูุญูุง ูููุฉ ูุบูุฑ ูุชุญูุณุฉ ุ ููุง ููุฌุฏ ูุซู ูุฐุง ุงูุณุญุฑ ูู ุงูุนุงูู ุงูุฐู ูู ุฃุชููู ูู ูุนูู".</em> <br>  - ูุงุฒุงุฑ ูุงุฌูู ุ "ุฎูุชุงุจุงุฎ ุงููุฏููุฉ". <br><br>  <em>ูุฑูุฒ Gin ููุคุดุฑ ููููุจ ูุนูู ูููุจุบู ุงุนุชุจุงุฑู ุฌูููุง ูููุณ ุดุฑุงุจูุง.</em> <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุฃ</a> <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุงูููููู ุงูุนุงู </h2><br>  GIN ูู ุงูููุฑุณ ุงูููููุจ ุงููุนูู ุงููุฎุชุตุฑ.  ูุฐุง ูู ูุง ูุณูู <em>ููุฑุณ ููููุจ</em> .  ุฅูู ูุชุนุงูู ูุน ุฃููุงุน ุงูุจูุงูุงุช ุงูุชู ููููุง ููุณุช ุฐุฑูุฉ ุ ูููููุง ุชุชุฃูู ูู ุนูุงุตุฑ.  ุณูู ูุณูู ูุฐู ุงูุฃููุงุน ุงููุฑูุจุฉ.  ููุฐู ููุณุช ุงูููู ุงูุชู ูุชู ููุฑุณุชูุง ุ ูููู ุงูุนูุงุตุฑ ุงููุฑุฏูุฉ ุ  ูู ุนูุตุฑ ูุดูุฑ ุฅูู ุงูููู ุงูุชู ูุญุฏุซ ูููุง. <br><br>  ูุงูููุงุณ ุงูุฌูุฏ ููุฐู ุงูุทุฑููุฉ ูู ุงูููุฑุณ ูู ููุงูุฉ ุงููุชุงุจ ุ ูุงูุฐู ูููุฑ ููู ุตูุญุฉ ูุงุฆูุฉ ุจุงูุตูุญุงุช ุงูุชู ูุญุฏุซ ูููุง ูุฐุง ุงููุตุทูุญ.  ูุฌุจ ุฃู ุชุถูู ุทุฑููุฉ ุงููุตูู ุงูุจุญุซ ุงูุณุฑูุน ููุนูุงุตุฑ ุงููููุฑุณุฉ ุ ุชูุงููุง ูุซู ุงูููุฑุณ ูู ูุชุงุจ.  ูุฐูู ุ ูุชู ุชุฎุฒูู ูุฐู ุงูุนูุงุตุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุฌุฑุฉ B</a> ูุฃูููุฉ (ูุชู ุงุณุชุฎุฏุงู ุชุทุจูู ูุฎุชูู ูุฃุจุณุท ูุฐูู ุ ูููู ูุง ููู ูู ูุฐู ุงูุญุงูุฉ).  ุชุฑุชุจุท ูุฌููุนุฉ ูุฑุชุจุฉ ูู ุงููุฑุงุฌุน ุฅูู ุตููู ุงูุฌุฏูู ุงูุชู ุชุญุชูู ุนูู ููู ูุฑูุจุฉ ูุน ุงูุนูุตุฑ ุจูู ุนูุตุฑ.  ูุนุฏ ุงูุชุฑุชูุจ ุฃูุฑูุง ุถุฑูุฑููุง ูุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช (ูุง ูุนูู ุชุฑุชูุจ ุงููุฑุฒ ุงูุฎุงุต ุจุงูุฃุฑูุงู ุงูููุงุณูุฉ ููุฃุฑูุงู ุงููุซูุฑ) ุ ููููู ููู ุจุงููุณุจุฉ ูููููู ุงูุฏุงุฎูู ููููุฑุณ. <br><br>  ูุง ูุชู ุญุฐู ุงูุนูุงุตุฑ ูู ููุฑุณ GIN.  ูููุชุฑุถ ุฃู ุงูููู ุงูุชู ุชุญุชูู ุนูู ุนูุงุตุฑ ูููู ุฃู ุชุฎุชูู ุฃู ุชูุดุฃ ุฃู ุชุฎุชูู ุ ููู ูุฌููุนุฉ ุงูุนูุงุตุฑ ุงูุชู ุชุชููู ูููุง ุชููู ูุณุชูุฑุฉ ุฅูู ุญุฏ ูุง.  ูุฐุง ุงูุญู ูุจุณุท ุงูุฎูุงุฑุฒููุงุช ุจุดูู ูุจูุฑ ููุนูู ุงููุชุฒุงูู ูุนุฏุฉ ุนูููุงุช ูุน ุงูููุฑุณ. <br><br>  ุฅุฐุง ูุงูุช ูุงุฆูุฉ TIDs ุตุบูุฑุฉ ุฌุฏูุง ุ ููููู ุฃู ุชูุณุฌู ูุน ููุณ ุงูุตูุญุฉ ูุซู ุงูุนูุตุฑ (ูุชุณูู "ูุงุฆูุฉ ุงููุดุฑ").  ูููู ุฅุฐุง ูุงูุช ุงููุงุฆูุฉ ูุจูุฑุฉ ุ ูุซูุฉ ุญุงุฌุฉ ุฅูู ุจููุฉ ุจูุงูุงุช ุฃูุซุฑ ููุงุกุฉ ุ ููุญู ุจุงููุนู ุนูู ุฏุฑุงูุฉ ุจูุง - ุฅููุง ุดุฌุฑุฉ B ูุฑุฉ ุฃุฎุฑู.  ุชูุน ูุฐู ุงูุดุฌุฑุฉ ุนูู ุตูุญุงุช ุจูุงูุงุช ูููุตูุฉ (ูุชุณูู "ุดุฌุฑุฉ ุงููุดุฑ"). <br><br>  ูุฐูู ุ ูุชููู ููุฑุณ GIN ูู ุดุฌุฑุฉ B ูู ุงูุนูุงุตุฑ ุ ูุชุฑุชุจุท ุงูุฃุดุฌุงุฑ B ุฃู ุงูููุงุฆู ุงููุณุทุญุฉ ูู TIDs ุจุตููู ุฃูุฑุงู ุชูู ุงูุดุฌุฑุฉ B. <br><br>  ุชูุงููุง ูุซู ููุงุฑุณ GiST ู SP-GiST ุ ุงูุชู ุชูุช ููุงูุดุชูุง ุณุงุจููุง ุ ูููุฑ GIN ูุทูุฑ ุชุทุจููุงุช ูุน ูุงุฌูุฉ ูุฏุนู ุงูุนูููุงุช ุงููุฎุชููุฉ ุนุจุฑ ุฃููุงุน ุงูุจูุงูุงุช ุงููุฑูุจุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุงููุต ุงููุงูู </h2><br>  ูุฌุงู ุงูุชุทุจูู ุงูุฑุฆูุณู ูุทุฑููุฉ GIN ูู ุชุณุฑูุน ุงูุจุญุซ ุนู ุงููุต ุงููุงูู ุ ูุจุงูุชุงูู ุ ูู ุงููุนููู ุฃู ูุชู ุงุณุชุฎุฏุงูู ููุซุงู ูู ููุงูุดุฉ ุฃูุซุฑ ุชูุตููุงู ููุฐุง ุงูููุฑุณ. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฏูุช ุงูููุงูุฉ ุงููุชุนููุฉ ุจู GiST</a> ุจุงููุนู ููุฏูุฉ ุตุบูุฑุฉ ููุจุญุซ ุนู ุงููุต ุงููุงูู ุ ูุฐูู ุฏุนููุง ููุชูู ูุจุงุดุฑุฉ ุฅูู ุงูููุทุฉ ุฏูู ุชูุฑุงุฑ.  ูู ุงููุงุถุญ ุฃู ุงูููู ุงููุฑูุจุฉ ูู ูุฐู ุงูุญุงูุฉ ูู <em>ูุณุชูุฏุงุช</em> ุ ูุนูุงุตุฑ ูุฐู ุงููุณุชูุฏุงุช <em>ูุนุฌู</em> . <br><br>  ุฏุนูุง ููุธุฑ ูู ุงููุซุงู ูู ุงูููุงู ุงููุชุนูู ุจู GiST: <br><br><pre style=";text-align:right;direction:rtl"><code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> ts(doc <span class="hljs-type"><span class="hljs-type">text</span></span>, doc_tsv <span class="hljs-type"><span class="hljs-type">tsvector</span></span>); postgres=# <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> ts(doc) <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-string"><span class="hljs-string">'Can a sheet slitter slit sheets?'</span></span>), (<span class="hljs-string"><span class="hljs-string">'How many sheets could a sheet slitter slit?'</span></span>), (<span class="hljs-string"><span class="hljs-string">'I slit a sheet, a sheet I slit.'</span></span>), (<span class="hljs-string"><span class="hljs-string">'Upon a slitted sheet I sit.'</span></span>), (<span class="hljs-string"><span class="hljs-string">'Whoever slit the sheets is a good sheet slitter.'</span></span>), (<span class="hljs-string"><span class="hljs-string">'I am a sheet slitter.'</span></span>), (<span class="hljs-string"><span class="hljs-string">'I slit sheets.'</span></span>), (<span class="hljs-string"><span class="hljs-string">'I am the sleekest sheet slitter that ever slit sheets.'</span></span>), (<span class="hljs-string"><span class="hljs-string">'She slits the sheet she sits on.'</span></span>); postgres=# <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> doc_tsv = to_tsvector(doc); postgres=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(doc_tsv);</code> </pre> <br>  ูุธูุฑ ุงููููู ุงููุญุชูู ููุฐุง ุงูููุฑุณ ูู ุงูุดูู: <br><br><img src="https://habrastorage.org/webt/lc/nh/m-/lcnhm-vqquxgvzpklv8kemu6z-a.png"><br><br>  ุจุฎูุงู ุฌููุน ุงูุฃุดูุงู ุงูุณุงุจูุฉ ุ ูุชู ุงูุฅุดุงุฑุฉ ุฅูู ุงููุฑุงุฌุน ุฅูู ุตููู ุงูุฌุฏูู (TID) ุจููู ุฑูููุฉ ุนูู ุฎูููุฉ ูุธููุฉ (ุฑูู ุงูุตูุญุฉ ูููุถุนูุง ุนูู ุงูุตูุญุฉ) ุจุฏูุงู ูู ุงูุฃุณูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> ctid, left(doc,<span class="hljs-number"><span class="hljs-number">20</span></span>), doc_tsv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | left | doc_tsv -------+----------------------+--------------------------------------------------------- (0,1) | Can a sheet slitter | 'sheet':3,6 'slit':5 'slitter':4 (0,2) | How many sheets coul | 'could':4 'mani':2 'sheet':3,6 'slit':8 'slitter':7 (0,3) | I slit a sheet, a sh | 'sheet':4,6 'slit':2,8 (1,1) | Upon a slitted sheet | 'sheet':4 'sit':6 'slit':3 'upon':1 (1,2) | Whoever slit the she | 'good':7 'sheet':4,8 'slit':2 'slitter':9 'whoever':1 (1,3) | I am a sheet slitter | 'sheet':4 'slitter':5 (2,1) | I slit sheets. | 'sheet':3 'slit':2 (2,2) | I am the sleekest sh | 'ever':8 'sheet':5,10 'sleekest':4 'slit':9 'slitter':6 (2,3) | She slits the sheet | 'sheet':4 'sit':6 'slit':2 (9 rows)</code> </pre><br>  ูู ูุฐุง ุงููุซุงู ุงููุถุงุฑุจู ุ ุชุชูุงูู ูุงุฆูุฉ TIDs ูุน ุงูุตูุญุงุช ุงูุนุงุฏูุฉ ูุฌููุน ุงููุนุฌูุงุช ุ ููู "sheet" ู "slit" ู "slitter".  ุญุฏุซุช ูุฐู ุงููุนุฌูุงุช ูู ุงูุนุฏูุฏ ูู ุงููุณุชูุฏุงุช ุ ูุชู ูุถุน ููุงุฆู TID ุงูุฎุงุตุฉ ุจูู ูู ุฃุดุฌุงุฑ B ุงููุฑุฏูุฉ. <br><br>  ุจุงูููุงุณุจุฉ ุ ููู ูููููุง ูุนุฑูุฉ ุนุฏุฏ ุงููุซุงุฆู ุงูุชู ุชุญุชูู ุนูู ูุงููุณุ  ุจุงููุณุจุฉ ูุทุงููุฉ ุตุบูุฑุฉ ุ ุณุชุนูู ุชูููุฉ "ูุจุงุดุฑุฉ" ุ ููุง ูู ููุถุญ ุฃุฏูุงู ุ ูููู ุณูู ูุชุนูู ุฃูุซุฑ ูุง ูุฌุจ ูุนูู ุจุฌุฏุงูู ุฃูุจุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> (unnest(doc_tsv)).lexeme, count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> lexeme | count ----------+------- sheet | 9 slit | 8 slitter | 5 sit | 2 upon | 1 mani | 1 whoever | 1 sleekest | 1 good | 1 could | 1 ever | 1 (11 rows)</code> </pre><br>  ูุงุญุธ ุฃูุถูุง ุฃูู ุจุฎูุงู ุดุฌุฑุฉ B ุงูุนุงุฏูุฉ ุ ูุชู ุฑุจุท ุตูุญุงุช ููุฑุณ GIN ุจูุงุฆูุฉ ุฃุญุงุฏูุฉ ุงูุงุชุฌุงู ุจุฏูุงู ูู ูุงุฆูุฉ ุซูุงุฆูุฉ ุงูุงุชุฌุงู.  ูุฐุง ูููู ูุฃู ุงุฌุชูุงุฒ ุดุฌุฑุฉ ุชุชู ุจุทุฑููุฉ ูุงุญุฏุฉ ููุท. <br><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู ุงุณุชูุณุงุฑ </h3><br>  ููู ุณูุชู ุชูููุฐ ุงูุงุณุชุนูุงู ุงูุชุงูู ุนูู ุณุจูู ุงููุซุงู ูุฏููุงุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> doc <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> doc_tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'many &amp; slitter'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN --------------------------------------------------------------------- Bitmap Heap Scan on ts Recheck Cond: (doc_tsv @@ to_tsquery('many &amp; slitter'::text)) -&gt; Bitmap Index Scan on ts_doc_tsv_idx Index Cond: (doc_tsv @@ to_tsquery('many &amp; slitter'::text)) (4 rows)</code> </pre><br>  ูุชู ุงุณุชุฎุฑุงุฌ lexemes ุงููุฑุฏูุฉ (ููุงุชูุญ ุงูุจุญุซ) ูู ุงูุงุณุชุนูุงู ุฃููุงู: "mani" ู "slitter".  ูุชู ุฐูู ุนู ุทุฑูู ูุธููุฉ API ูุชุฎุตุตุฉ ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ููุน ุงูุจูุงูุงุช ูุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุชู ุชุญุฏุฏูุง ูุฆุฉ ุงููุดุบู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> amop.amopopr::<span class="hljs-type"><span class="hljs-type">regoperator</span></span>, amop.amopstrategy <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pg_opclass opc, pg_opfamily opf, pg_am am, pg_amop amop <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> opc.opcname = <span class="hljs-string"><span class="hljs-string">'tsvector_ops'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> opf.oid = opc.opcfamily <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> am.oid = opf.opfmethod <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> amop.amopfamily = opc.opcfamily <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> am.amname = <span class="hljs-string"><span class="hljs-string">'gin'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> amop.amoplefttype = opc.opcintype;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> amopopr | amopstrategy -----------------------+-------------- @@(tsvector,tsquery) | 1 matching search query @@@(tsvector,tsquery) | 2 synonym for @@ (for backward compatibility) (2 rows)</code> </pre><br>  ูู B-tree of lexemes ุ ุณูุฌุฏ ุจุนุฏ ุฐูู ููุง ุงูููุชุงุญูู ููุณุชุนุฑุถ ููุงุฆู ุฌุงูุฒุฉ ูู TIDs.  ูุญุตู ุนูู: <br><br>  ู "ูุงูู" - (0ุ2). <br>  ุนู "ุงููุดูู" - (0ุ1) ุ (0ุ2) ุ (1ุ2) ุ (1ุ3) ุ (2ุ2). <br><br><img src="https://habrastorage.org/webt/mg/qc/do/mgqcdou-xlhsztvkxii5qluc5rq.png"><br><br>  ุฃุฎูุฑูุง ุ ููู TID ุชู ุงูุนุซูุฑ ุนูููุง ุ ุชุณูู ูุธููุฉ ุชูุงุณู API ุ ูุงูุชู ูุฌุจ ุฃู ุชุญุฏุฏ ุฃู ูู ุงูุตููู ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุชุทุงุจู ุงุณุชุนูุงู ุงูุจุญุซ.  ูุธุฑูุง ูุฃู lexemes ูู ุทูุจ ุงูุจุญุซ ูุฏููุง ููุถู ุฅูู Boolean "ู" ุ ูุฅู ุงูุตู ุงููุญูุฏ ุงูุฐู ูุชู ุฅุฑุฌุงุนู ูู (0ุ2): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> | | | consistency | | | function TID | mani | slitter | slit &amp; slitter -------+------+---------+---------------- (0,1) | f | T | f (0,2) | T | T | T (1,2) | f | T | f (1,3) | f | T | f (2,2) | f | T | f</code> </pre><br>  ูุงููุชูุฌุฉ ูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> doc <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> doc_tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'many &amp; slitter'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> doc --------------------------------------------- How many sheets could a sheet slitter slit? (1 row)</code> </pre><br>  ุฅุฐุง ูุงุฑูุง ูุฐุง ุงูููุฌ ูุน ุงูููุฌ ุงูุฐู ุชูุช ููุงูุดุชู ุจุงููุนู ูู GiST ุ ูุฅู ููุฒุฉ GIN ููุจุญุซ ุนู ุงููุต ุงููุงูู ุชุจุฏู ูุงุถุญุฉ.  ูููู ููุงู ูุง ูู ุฃูุซุฑ ููุง ุชุฑุงู ุงูุนูู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุณุฃูุฉ ุงูุชุญุฏูุซ ุงูุจุทูุก </h3><br>  ุงูุดูุก ูู ุฃู ุฅุฏุฎุงู ุงูุจูุงูุงุช ุฃู ุชุญุฏูุซูุง ูู ููุฑุณ GIN ุจุทูุก ุฌุฏูุง.  ูุญุชูู ูู ูุณุชูุฏ ุนุงุฏุฉู ุนูู ุงูุนุฏูุฏ ูู ุงููุนุฌู ุงููุทููุจ ููุฑุณุชู.  ูุฐูู ุ ุนูุฏ ุฅุถุงูุฉ ูุณุชูุฏ ูุงุญุฏ ููุท ุฃู ุชุญุฏูุซู ุ ูุชุนูู ุนูููุง ุชุญุฏูุซ ุดุฌุฑุฉ ุงูููุฑุณ ุจุดูู ูุจูุฑ. <br><br>  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุฅุฐุง ุชู ุชุญุฏูุซ ุนุฏุฉ ูุณุชูุฏุงุช ูู ููุช ูุงุญุฏ ุ ููุฏ ุชููู ุจุนุถ ูุนุฌููุง ููุง ูู ุ ูุณูููู ุฅุฌูุงูู ุญุฌู ุงูุนูู ุฃุตุบุฑ ูู ุนูุฏ ุชุญุฏูุซ ุงููุณุชูุฏุงุช ูุงุญุฏูุง ุชูู ุงูุขุฎุฑ. <br><br>  ูุญุชูู ููุฑุณ GIN ุนูู ูุนููุฉ ุชุฎุฒูู "fastupdate" ุ ูุงูุชู ูููููุง ุชุญุฏูุฏูุง ุฃุซูุงุก ุฅูุดุงุก ุงูููุฑุณ ูุชุญุฏูุซู ูุงุญููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(doc_tsv) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> (fastupdate = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre><br>  ุนูุฏ ุชุดุบูู ูุฐู ุงููุนููุฉ ุ ุณูุชู ุชุฌููุน ุงูุชุญุฏูุซุงุช ูู ูุงุฆูุฉ ูููุตูุฉ ุบูุฑ ูุฑุชุจุฉ (ุนูู ุงูุตูุญุงุช ุงููุชุตูุฉ ุงููุฑุฏูุฉ).  ุนูุฏูุง ุชุตุจุญ ูุฐู ุงููุงุฆูุฉ ูุจูุฑุฉ ุจูุง ูููู ุฃู ุฃุซูุงุก ุงูุชูุธูู ุ ูุชู ุฅุฌุฑุงุก ูุงูุฉ ุงูุชุญุฏูุซุงุช ุงููุชุฑุงููุฉ ุนูู ุงูููุฑ ูู ุงูููุฑุณ.  ูุชู ุชุญุฏูุฏ ุงููุงุฆูุฉ ุงูุชู ูุฌุจ ุงุนุชุจุงุฑูุง "ูุจูุฑุฉ ุจูุง ูููู" ุจูุงุณุทุฉ ูุนููุฉ ุงูุชูููู "gin_pending_list_limit" ุฃู ุจูุงุณุทุฉ ูุนููุฉ ุชุฎุฒูู ุงูุงุณู ููุณู ุงูููุฑุณ. <br><br>  ูููู ูุฐุง ุงูููุฌ ูู ุนููุจ: ุฃููุงู ุ ูุชู ุฅุจุทุงุก ุงูุจุญุซ (ูุธุฑูุง ูุฃู ุงููุงุฆูุฉ ุบูุฑ ุงููุฑุชุจุฉ ุชุญุชุงุฌ ุฅูู ุงูุจุญุซ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุดุฌุฑุฉ) ุ ูุซุงููุง ุ ูุฏ ูุณุชุบุฑู ุงูุชุญุฏูุซ ุงูุชุงูู ููุชูุง ุบูุฑ ูุชููุน ูู ุญุงูุฉ ุชุฌุงูุฒ ูุงุฆูุฉ ุบูุฑ ูุฑุชุจุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุจุญุซ ุนู ุชุทุงุจู ุฌุฒุฆู </h3><br>  ูููููุง ุงุณุชุฎุฏุงู ุงูุชุทุงุจู ุงูุฌุฒุฆู ูู ุงูุจุญุซ ุนู ุงููุต ุงููุงูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุถุน ูู ุงูุงุนุชุจุงุฑ ุงูุงุณุชุนูุงู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">gin=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> doc <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> doc_tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'slit:*'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> doc -------------------------------------------------------- Can a sheet slitter slit sheets? How many sheets could a sheet slitter slit? I slit a sheet, a sheet I slit. Upon a slitted sheet I sit. Whoever slit the sheets is a good sheet slitter. I am a sheet slitter. I slit sheets. I am the sleekest sheet slitter that ever slit sheets. She slits the sheet she sits on. (9 rows)</code> </pre><br>  ุณูุนุซุฑ ูุฐุง ุงูุงุณุชุนูุงู ุนูู ูุณุชูุฏุงุช ุชุญุชูู ุนูู ูุนุฌู ุชุจุฏุฃ ูู "ุดู".  ูู ูุฐุง ุงููุซุงู ุ ุชููู ูุซู ูุฐู ุงููุชู "ุดู" ู "ุดู". <br><br>  ุจุงูุชุฃููุฏ ุณูู ูุนูู ุงูุงุณุชุนูุงู ุนูู ุฃู ุญุงู ุ ุญุชู ุจุฏูู ุงูููุงุฑุณ ุ ููู GIN ูุณูุญ ุฃูุถูุง ุจุชุณุฑูุน ุงูุจุญุซ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> doc <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> doc_tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'slit:*'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN ------------------------------------------------------------- Bitmap Heap Scan on ts Recheck Cond: (doc_tsv @@ to_tsquery('slit:*'::text)) -&gt; Bitmap Index Scan on ts_doc_tsv_idx Index Cond: (doc_tsv @@ to_tsquery('slit:*'::text)) (4 rows)</code> </pre><br>  ููุง ูุชู ุงูุจุญุซ ุนู ุฌููุน lexemes ุงูุชู ููุง ุงูุจุงุฏุฆุฉ ุงููุญุฏุฏุฉ ูู ุงุณุชุนูุงู ุงูุจุญุซ ูู ุงูุดุฌุฑุฉ ูููุถู ุฅูููุง Boolean "ุฃู". <br><br><h3 style=";text-align:right;direction:rtl">  lexemes ูุชูุฑุฑุฉ ููุงุฏุฑุฉ </h3><br>  ููุดุงูุฏุฉ ููููุฉ ุนูู ุงูููุฑุณุฉ ุนูู ุงูุจูุงูุงุช ุงูุญูุฉ ุ ุฏุนูุง ูุฃุฎุฐ ุฃุฑุดูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู "pgsql-hackers" ุ ูุงูุฐู ุงุณุชุฎุฏููุงู ุจุงููุนู ุฃุซูุงุก ููุงูุดุฉ GiST.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุชูู ูุฐุง ุงูุฅุตุฏุงุฑ ูู ุงูุฃุฑุดูู</a> ุนูู 356125 ุฑุณุงูุฉ ุจูุง ุชุงุฑูุฎ ุงูุฅุฑุณุงู ูุงูููุถูุน ูุงููุคูู ูุงููุต. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> tsv <span class="hljs-type"><span class="hljs-type">tsvector</span></span>; fts=# <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> tsv = to_tsvector(body_plain);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">NOTICE: word is too long to be indexed DETAIL: Words longer than 2047 characters are ignored. ... UPDATE 356125</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(tsv);</code> </pre><br>  ุฏุนูุง ูููุฑ ูู lexeme ุงูุฐู ูุญุฏุซ ูู ุงูุนุฏูุฏ ูู ุงููุซุงุฆู.  ุณูู ููุดู ุงูุงุณุชุนูุงู ุจุงุณุชุฎุฏุงู "unnest" ูู ุงูุนูู ุนูู ูุซู ูุฐุง ุงูุญุฌู ุงููุจูุฑ ูู ุงูุจูุงูุงุช ุ ูุงูุชูููุฉ ุงูุตุญูุญุฉ ูู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ "ts_stat" ุ ูุงูุชู ุชููุฑ ุงููุนูููุงุช ุญูู lexemes ุ ูุนุฏุฏ ุงููุณุชูุฏุงุช ุงูุชู ุญุฏุซุช ูููุง ุ ูุฅุฌูุงูู ุนุฏุฏ ุงูุชูุฑุงุฑุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> word, ndoc <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts_stat(<span class="hljs-string"><span class="hljs-string">'select tsv from mail_messages'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> ndoc <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> word | ndoc -------+-------- re | 322141 wrote | 231174 use | 176917 (3 rows)</code> </pre><br>  ุฏุนูุง ูุฎุชุงุฑ "ูุชุจ". <br><br>  ูุณูู ูุฃุฎุฐ ุจุนุถ ุงููููุงุช ุงููุงุฏุฑุฉ ุจุงููุณุจุฉ ููุจุฑูุฏ ุงูุฅููุชุฑููู ูููุทูุฑูู ุ ุนูู ุณุจูู ุงููุซุงู ุ "ูุดู": <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> word, ndoc <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ts_stat(<span class="hljs-string"><span class="hljs-string">'select tsv from mail_messages'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> word = <span class="hljs-string"><span class="hljs-string">'tattoo'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> word | ndoc --------+------ tattoo | 2 (1 row)</code> </pre><br>  ูู ููุงู ุฃู ูุณุชูุฏุงุช ุชุญุฏุซ ูููุง ููุง ุงููุบุชููุ  ูุจุฏู ุฃู ููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'wrote &amp; tattoo'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 1 (1 row)</code> </pre><br>  ูุทุฑุญ ุณุคุงู ุญูู ููููุฉ ุฅุฌุฑุงุก ูุฐุง ุงูุงุณุชุนูุงู.  ุฅุฐุง ุญุตููุง ุนูู ููุงุฆู TID ูููุง ุงููุบุชูู ุ ููุง ูู ููุตูู ุฃุนูุงู ุ ููู ุงููุงุถุญ ุฃู ุงูุจุญุซ ุณูููู ุบูุฑ ูุนุงู: ุณูุชุนูู ุนูููุง ุงููุฑูุฑ ุจุฃูุซุฑ ูู 200 ุฃูู ูููุฉ ุ ุณูุชู ุชุฑู ูุงุญุฏุฉ ูููุง ููุท.  ูุญุณู ุงูุญุธ ุ ุจุงุณุชุฎุฏุงู ุฅุญุตุงุฆูุงุช ุงููุฎุทุท ุ ุชููู ุงูุฎูุงุฑุฒููุฉ ุฃู "ุงููููุณู" ุงูููุชูุจ ูุญุฏุซ ุจุดูู ูุชูุฑุฑ ุ ูู ุญูู ุฃู "ุงููุดู" ูุญุฏุซ ุจุดูู ูุชูุฑุฑ.  ูุฐูู ุ ูุชู ุฅุฌุฑุงุก ุงูุจุญุซ ูู lexeme ูุงุฏุฑูุง ุ ุซู ูุชู ุงูุชุญูู ูู ุงููุซููุชูู ุงููุณุชุฑุฏุชูู ุจุญุซูุง ุนู ุญุฏูุซ "lexeme" ุงูููุชูุจ.  ููุฐุง ูุงุถุญ ูู ุงูุงุณุชุนูุงู ุงูุฐู ูุชู ุชูููุฐู ุจุณุฑุนุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# \<span class="hljs-keyword"><span class="hljs-keyword">timing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'wrote &amp; tattoo'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 1 (1 row) Time: 0,959 ms</code> </pre><br>  ูุณุชุบุฑู ุงูุจุญุซ ุนู "ูุชุจ" ูุญุฏู ููุชูุง ุฃุทูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'wrote'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count -------- 231174 (1 row) Time: 2875,543 ms (00:02,876)</code> </pre><br>  ูุฐุง ุงูุชุญุณูู ุจุงูุชุฃููุฏ ูุง ูุนูู ููุท ูุน ุงุซููู ูู ุงูููุงููุณ ุ ูููู ูู ุงูุญุงูุงุช ุงูุฃูุซุฑ ุชุนููุฏูุง ุฃูุถูุง. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุญุฏ ูู ูุชูุฌุฉ ุงูุงุณุชุนูุงู </h3><br>  ุฅุญุฏู ููุฒุงุช ุทุฑููุฉ ุงููุตูู ุฅูู GIN ูู ุฃู ุงููุชูุฌุฉ ุชูุฑุฌุน ุฏุงุฆููุง ูุตูุฑุฉ ููุทูุฉ: ูุง ูููู ููุฐู ุงูุทุฑููุฉ ุฅุฑุฌุงุน ุงููุชูุฌุฉ TID ุจูุงุณุทุฉ TID.  ููุฐุง ุงูุณุจุจ ุ ุชุณุชุฎุฏู ุฌููุน ุฎุทุท ุงูุงุณุชุนูุงู ูู ูุฐู ุงูููุงูุฉ ุงููุณุญ ุงูููุทู. <br><br>  ูุฐูู ุ ูุนุฏ ุงูุญุฏ ูู ูุชุงุฆุฌ ูุณุญ ุงูููุฑุณ ุจุงุณุชุฎุฏุงู ุฌููุฉ LIMIT ุบูุฑ ูุนุงู.  ุงูุชุจู ุฅูู ุงูุชูููุฉ ุงููุชููุนุฉ ููุนูููุฉ (ุญูู "ุงูุชูููุฉ" ูู ุนูุฏุฉ "ุงูุญุฏ"): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'wrote'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN ----------------------------------------------------------------------------------------- Limit (cost=1283.61..1285.13 rows=1) -&gt; Bitmap Heap Scan on mail_messages (cost=1283.61..209975.49 rows=137207) Recheck Cond: (tsv @@ to_tsquery('wrote'::text)) -&gt; Bitmap Index Scan on mail_messages_tsv_idx (cost=0.00..1249.30 rows=137207) Index Cond: (tsv @@ to_tsquery('wrote'::text)) (5 rows)</code> </pre><br>  ุชูุฏุฑ ุงูุชูููุฉ ุจู 1285.13 ุ ููู ุฃูุจุฑ ููููุงู ูู ุชูููุฉ ุจูุงุก ุงูุตูุฑุฉ ุงูููุทูุฉ ุจุฃููููุง 1249.30 (ุญูู "ุงูุชูููุฉ" ูู ุนูุฏุฉ ูุณุญ ุตูุฑุฉ ููุทูุฉ). <br><br>  ูุฐูู ุ ูุญุชูู ุงูููุฑุณ ุนูู ูุฏุฑุฉ ุฎุงุตุฉ ููุญุฏ ูู ุนุฏุฏ ุงููุชุงุฆุฌ.  ูุชู ุชุญุฏูุฏ ูููุฉ ุงูุนุชุจุฉ ูู ูุนููุฉ ุงูุชูููู "gin_fuzzy_search_limit" ูุชุณุงูู ุงูุตูุฑ ุงูุชุฑุงุถููุง (ูุง ูุชู ุชุญุฏูุฏ ุฃู ูููุฏ).  ูููู ูููููุง ุชุนููู ูููุฉ ุงูุนุชุจุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> gin_fuzzy_search_limit = <span class="hljs-number"><span class="hljs-number">1000</span></span>; fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'wrote'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 5746 (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> gin_fuzzy_search_limit = <span class="hljs-number"><span class="hljs-number">10000</span></span>; fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> tsv @@ to_tsquery(<span class="hljs-string"><span class="hljs-string">'wrote'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 14726 (1 row)</code> </pre><br>  ููุง ูุฑู ุ ูุฎุชูู ุนุฏุฏ ุงูุตููู ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ุงูุงุณุชุนูุงู ุนู ููู ูุนููุงุช ูุฎุชููุฉ (ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ุงููุตูู ุฅูู ุงูููุฑุณ).  ุงูููุฏ ููุณ ุตุงุฑููุง: ูููู ุฅุฑุฌุงุน ุนุฏุฏ ุฃูุจุฑ ูู ุงูุตููู ุงููุญุฏุฏุฉ ุ ููุง ูุจุฑุฑ ุงูุฌุฒุก "ุงูุบุงูุถ" ูู ุงุณู ุงููุนููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชูุซูู ุงููุถุบูุท </h3><br>  ูู ุจูู ุงูุจููุฉ ุ ููุงุฑุณ GIN ุฌูุฏุฉ ุจูุถู ุถุบุทูุง.  ุฃููุงู ุ ุฅุฐุง ุญุฏุซ ููุณ ุงููุนุฌู ูู ุนุฏุฉ ูุณุชูุฏุงุช (ููุฐู ูู ุงูุญุงูุฉ ุนุงุฏุฉู) ุ ูุณูุชู ุชุฎุฒูููุง ูู ุงูููุฑุณ ูุฑุฉ ูุงุญุฏุฉ ููุท.  ุซุงููุงู ุ ูุชู ุชุฎุฒูู TID ูู ุงูููุฑุณ ุจุทุฑููุฉ ูุฑุชุจุฉ ุ ููุฐุง ูุชูุญ ููุง ุงุณุชุฎุฏุงู ุถุบุท ุจุณูุท: ูุชู ุชุฎุฒูู ูู TID ุงูุชุงูู ูู ุงููุงุฆูุฉ ูู ุงููุงูุน ุงุฎุชูุงููุง ุนู ุงูุณุงุจู.  ูุฐุง ุนุงุฏุฉ ูุง ูููู ุนุฏุฏูุง ุตุบูุฑูุง ุ ููู ูุง ูุชุทูุจ ุนุฏุฏูุง ุฃูู ูู ูุญุฏุงุช ุงูุจุช ุงูุชู ุชุญุชูู ุนูู TID ูุงูู ุจุณุชุฉ ุจุงูุช. <br><br>  ููุญุตูู ุนูู ููุฑุฉ ุนู ุงูุญุฌู ุ ุฏุนูุง ูุจูู ุดุฌุฑุฉ B ูู ูุต ุงูุฑุณุงุฆู.  ููู ุงูููุงุฑูุฉ ุงูุนุงุฏูุฉ ูู ุชุญุฏุซ ุจุงูุชุฃููุฏ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชู ุจูุงุก GIN ุนูู ููุน ุจูุงูุงุช ูุฎุชูู ("tsvector" ุจุฏูุงู ูู "text") ุ ููู ุฃุตุบุฑ ุ </li><li style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ูุฌุจ ุชูุตูุฑ ุญุฌู ุฑุณุงุฆู B-tree ุฅูู ุญูุงูู ูููู ุจุงูุช. </li></ul><br>  ููุน ุฐูู ุ ูุฅููุง ููุงุตู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> mail_messages_btree <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> mail_messages(substring(body_plain <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">2048</span></span>));</code> </pre><br>  ุณูููู ุจุจูุงุก ูุคุดุฑ GiST ุฃูุถูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> mail_messages_gist <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> mail_messages <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gist(tsv);</code> </pre><br>  ุญุฌู ุงูููุงุฑุณ ุนูุฏ "ูุฑุงุบ ูุงูู": <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> pg_size_pretty(pg_relation_size(<span class="hljs-string"><span class="hljs-string">'mail_messages_tsv_idx'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> gin, pg_size_pretty(pg_relation_size(<span class="hljs-string"><span class="hljs-string">'mail_messages_gist'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> gist, pg_size_pretty(pg_relation_size(<span class="hljs-string"><span class="hljs-string">'mail_messages_btree'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> btree;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> gin | gist | btree --------+--------+-------- 179 MB | 125 MB | 546 MB (1 row)</code> </pre><br>  ูุธุฑูุง ูุถุบุท ุงูุชูุซูู ุ ูููููุง ูุญุงููุฉ ุงุณุชุฎุฏุงู ููุฑุณ GIN ุฃุซูุงุก ุงูุชุฑุญูู ูู Oracle ูุจุฏูู ูููุงุฑุณ ุงูุตูุฑุฉ ุงูููุทูุฉ (ุฏูู ุงูุฎูุถ ูู ุงูุชูุงุตูู ุ ุฃูุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุฌุนูุง ุฅูู ููุดูุฑ Lewis</a> ูุนููู ูุถูููุฉ).  ููุงุนุฏุฉ ุนุงูุฉ ุ ูุชู ุงุณุชุฎุฏุงู ููุงุฑุณ ุงูุตูุฑ ุงูููุทูุฉ ููุญููู ุงูุชู ุชุญุชูู ุนูู ุนุฏุฏ ูููู ูู ุงูููู ุงููุฑูุฏุฉ ุ ููู ุฃูุฑ ููุชุงุฒ ุฃูุถูุง ุจุงููุณุจุฉ ุฅูู GIN.  ูููุง ูู ููุถุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุงูููุงูุฉ ุงูุฃููู</a> ุ ูููู ูู PostgreSQL ุฅูุดุงุก ุตูุฑุฉ ููุทูุฉ ุจูุงุกู ุนูู ุฃู ููุฑุณ ุ ุจูุง ูู ุฐูู GIN ุ ุฃุซูุงุก ุงูุทูุฑุงู. <br><br><h3 style=";text-align:right;direction:rtl">  GiST ุฃู ุงูุฌูุ </h3><br>  ุจุงููุณุจุฉ ุฅูู ุงูุนุฏูุฏ ูู ุฃููุงุน ุงูุจูุงูุงุช ุ ุชุชููุฑ ูุฆุงุช ุงููุดุบููู ููู ูู GiST ู GIN ุ ููุง ูุซูุฑ ุณุคุงููุง ุญูู ุงูููุฑุณ ุงูุฐู ูุฌุจ ุงุณุชุฎุฏุงูู.  ุฑุจูุง ุ ูููููุง ุจุงููุนู ุชูุฏูู ุจุนุถ ุงูุงุณุชูุชุงุฌุงุช. <br><br>  ูููุงุนุฏุฉ ุนุงูุฉ ุ ูุชููู GIN ุนูู GiST ูู ุงูุฏูุฉ ูุณุฑุนุฉ ุงูุจุญุซ.  ุฅุฐุง ูู ูุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ุจุดูู ูุชูุฑุฑ ููุงูุช ููุงู ุญุงุฌุฉ ุฅูู ุจุญุซ ุณุฑูุน ุ ูุณูููู GIN ุนูู ุงูุฃุฑุฌุญ ุฎูุงุฑูุง. <br><br>  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุฅุฐุง ุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ุจุดูู ููุซู ุ ููุฏ ูุจุฏู ุฃู ุงูุชูุงููู ุงูุนุงูุฉ ูุชุญุฏูุซ GIN ูุจูุฑุฉ ููุบุงูุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชุนูู ุนูููุง ููุงุฑูุฉ ุงูุฎูุงุฑูู ูุงุฎุชูุงุฑ ุงูุฎูุงุฑ ุงูุฐู ุชุชูุงุฒู ุฎุตุงุฆุตู ุจุดูู ุฃูุถู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุตูููุงุช </h2><br>  ูุซุงู ุขุฎุฑ ูุงุณุชุฎุฏุงู GIN ูู ููุฑุณุฉ ุงููุตูููุงุช.  ูู ูุฐู ุงูุญุงูุฉ ุ ุชุฏุฎู ุนูุงุตุฑ ุงูุตููู ูู ุงูููุฑุณ ุ ูุงูุฐู ูุณูุญ ุจุชุณุฑูุน ุนุฏุฏ ูู ุงูุนูููุงุช ุนูู ุงููุตูููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> amop.amopopr::<span class="hljs-type"><span class="hljs-type">regoperator</span></span>, amop.amopstrategy <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pg_opclass opc, pg_opfamily opf, pg_am am, pg_amop amop <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> opc.opcname = <span class="hljs-string"><span class="hljs-string">'array_ops'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> opf.oid = opc.opcfamily <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> am.oid = opf.opfmethod <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> amop.amopfamily = opc.opcfamily <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> am.amname = <span class="hljs-string"><span class="hljs-string">'gin'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> amop.amoplefttype = opc.opcintype;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> amopopr | amopstrategy -----------------------+-------------- &amp;&amp;(anyarray,anyarray) | 1 intersection @&gt;(anyarray,anyarray) | 2 contains array &lt;@(anyarray,anyarray) | 3 contained in array =(anyarray,anyarray) | 4 equality (4 rows)</code> </pre><br>  ุชุญุชูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ ุงูุฎุงุตุฉ</a> ุจูุง ุนูู ุทุฑููุฉ "ุทุฑู" ุชุชุถูู ูุนูููุงุช ุนู ุงูุฑุญูุงุช ุงูุฌููุฉ.  ูู ุจูู ุงูุจููุฉ ุ ูุญุชูู ูุฐุง ุงูุนุฑุถ ุนูู ุนููุฏ "days_of_week" - ูุฌููุนุฉ ูู ุฃูุงู ุงูุฃุณุจูุน ุนูุฏูุง ุชุชู ุงูุฑุญูุงุช ุงูุฌููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุชุบุงุฏุฑ ุฑุญูุฉ ูู ููููููู ุฅูู ุบููููุฏุฒูู ูููู ุงูุซูุงุซุงุก ูุงูุฎููุณ ูุงูุฃุญุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> departure_airport_name, arrival_airport_name, days_of_week <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> flight_no = <span class="hljs-string"><span class="hljs-string">'PG0049'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> departure_airport_name | arrival_airport_name | days_of_week ------------------------+----------------------+-------------- Vnukovo | Gelendzhik | {2,4,7} (1 row)</code> </pre><br>  ูุจูุงุก ุงูููุฑุณ ุ ุฏุนูุง "ูุฌุณุฏ" ุงูุนุฑุถ ูู ุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes; demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(days_of_week);</code> </pre><br><br>  ุงูุขู ูููููุง ุงุณุชุฎุฏุงู ุงูููุฑุณ ููุชุนุฑู ุนูู ุฌููุน ุงูุฑุญูุงุช ุงูุชู ุชุบุงุฏุฑ ูููู ุงูุซูุงุซุงุก ูุงูุฎููุณ ูุงูุฃุญุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> days_of_week = <span class="hljs-keyword"><span class="hljs-keyword">ARRAY</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>];</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN ----------------------------------------------------------- Bitmap Heap Scan on routes_t Recheck Cond: (days_of_week = '{2,4,7}'::integer[]) -&gt; Bitmap Index Scan on routes_t_days_of_week_idx Index Cond: (days_of_week = '{2,4,7}'::integer[]) (4 rows)</code> </pre><br>  ูุจุฏู ุฃู ููุงู ุณุชุฉ ูููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> flight_no, departure_airport_name, arrival_airport_name, days_of_week <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> days_of_week = <span class="hljs-keyword"><span class="hljs-keyword">ARRAY</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>];</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> flight_no | departure_airport_name | arrival_airport_name | days_of_week -----------+------------------------+----------------------+-------------- PG0005 | Domodedovo | Pskov | {2,4,7} PG0049 | Vnukovo | Gelendzhik | {2,4,7} PG0113 | Naryan-Mar | Domodedovo | {2,4,7} PG0249 | Domodedovo | Gelendzhik | {2,4,7} PG0449 | Stavropol | Vnukovo | {2,4,7} PG0540 | Barnaul | Vnukovo | {2,4,7} (6 rows)</code> </pre><br>  ููู ูุชู ุชูููุฐ ูุฐุง ุงูุงุณุชุนูุงูุ  ุจุงูุถุจุท ุจููุณ ุงูุทุฑููุฉ ุงูููุถุญุฉ ุฃุนูุงู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงูุตููู {2ุ4ุ7} ุ ุงูุฐู ููุนุจ ุฏูุฑ ุงุณุชุนูุงู ุงูุจุญุซ ููุง ุ ูุชู ุงุณุชุฎุฑุงุฌ ุงูุนูุงุตุฑ (ูููุงุช ุงูุจุญุซ ุงูุฑุฆูุณูุฉ).  ูู ุงููุงุถุญ ุฃู ูุฐู ูู ููู "2" ู "4" ู "7". <br></li><li style=";text-align:right;direction:rtl">  ูู ุดุฌุฑุฉ ุงูุนูุงุตุฑ ุ ูุชู ุงูุนุซูุฑ ุนูู ุงูููุงุชูุญ ุงููุณุชุฎุฑุฌุฉ ุ ููุชู ุชุญุฏูุฏ ูุงุฆูุฉ TID ููู ูููุง. <br></li><li style=";text-align:right;direction:rtl">  ูู ุจูู ุฌููุน TID ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุ ุชุญุฏุฏ ูุธููุฉ ุงูุชูุงุณู ุชูู ุงูุชู ุชุทุงุจู ุงููุดุบู ูู ุงูุงุณุชุนูุงู.  ุจุงููุณุจุฉ ุฅูู <code>=</code> ุนุงูู ุงูุชุดุบูู ุ ุชุชุทุงุจู ูุน TID ููุท ุชูู ุงูุชู ุญุฏุซุช ูู ุฌููุน ุงูููุงุฆู ุงูุซูุงุซ (ุจูุนูู ุขุฎุฑ ุ ูุฌุจ ุฃู ูุญุชูู ุงูุตููู ุงูุฃููู ุนูู ุฌููุน ุงูุนูุงุตุฑ).  ููู ูุฐุง ูุง ูููู: ููุฒู ุฃูุถูุง ุฃูุง ูุญุชูู ุงูุตููู ุนูู ุฃู ููู ุฃุฎุฑู ุ ููุง ูููููุง ุงูุชุญูู ูู ูุฐุง ุงูุดุฑุท ูุน ุงูููุฑุณ.  ูุฐูู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ุชุทูุจ ุทุฑููุฉ ุงููุตูู ูู ูุญุฑู ุงูููุฑุณุฉ ุฅุนุงุฏุฉ ูุญุต ุฌููุน TID ุงูุชู ุชู ุฅุฑุฌุงุนูุง ูุน ุงูุฌุฏูู. <br></li></ol><br>  ููู ุงููุซูุฑ ููุงูุชูุงู ุ ุฃู ููุงู ุงุณุชุฑุงุชูุฌูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ "ูุถููุฉ ูู ุตููู") ูุง ูููููุง ุงูุชุญูู ูู ุฃู ุดูุก ููุฌุจ ุฅุนุงุฏุฉ ุงูุชุญูู ูู ุฌููุน TID ุงูููุฌูุฏุฉ ูู ุงูุฌุฏูู. <br><br>  ูููู ูุงุฐุง ููุนู ุฅุฐุง ููุง ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุงูุฑุญูุงุช ุงูุฌููุฉ ุงูุชู ุชุบุงุฏุฑ ูู ููุณูู ุฃูุงู ุงูุซูุงุซุงุก ูุงูุฎููุณ ูุงูุฃุญุฏุ  ูู ูุฏุนู ุงูููุฑุณ ุงูุญุงูุฉ ุงูุฅุถุงููุฉ ุ ูุงูุชู ุณุชุฏุฎู ูู ุนููุฏ "ุงูุชุตููุฉ". <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> days_of_week = <span class="hljs-keyword"><span class="hljs-keyword">ARRAY</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> departure_city = <span class="hljs-string"><span class="hljs-string">'Moscow'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN ----------------------------------------------------------- Bitmap Heap Scan on routes_t Recheck Cond: (days_of_week = '{2,4,7}'::integer[]) Filter: (departure_city = 'Moscow'::text) -&gt; Bitmap Index Scan on routes_t_days_of_week_idx Index Cond: (days_of_week = '{2,4,7}'::integer[]) (5 rows)</code> </pre><br>  ูุฐุง ุนูู ูุง ูุฑุงู (ูุญุฏุฏ ุงูููุฑุณ ุณุชุฉ ุตููู ููุท ุนูู ุฃู ุญุงู) ุ ูููู ูู ุงูุญุงูุงุช ุงูุชู ูุฒูุฏ ูููุง ุงูุดุฑุท ุงูุฅุถุงูู ูู ุงููุฏุฑุฉ ุงูุงูุชูุงุฆูุฉ ุ ูููู ูู ุงููุทููุจ ุงูุญุตูู ุนูู ูุซู ูุฐุง ุงูุฏุนู.  ููุน ุฐูู ุ ูุง ูููููุง ููุท ุฅูุดุงุก ุงูููุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(days_of_week,departure_city);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">ERROR: data type text has no default operator class for access method "gin" HINT: You must specify an operator class for the index or define a default operator class for the data type.</code> </pre><br>  ูููู ุงูุชูุฏูุฏ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">btree_gin</a> " ุณูุณุงุนุฏ ุ ุญูุซ ูุถูู ูุฆุงุช ูุดุบูู GIN ุงูุชู ุชุญุงูู ุนูู ุดุฌุฑุฉ B ุงูุนุงุฏูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extension</span></span> btree_gin; demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(days_of_week,departure_city); demo=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_t <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> days_of_week = <span class="hljs-keyword"><span class="hljs-keyword">ARRAY</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> departure_city = <span class="hljs-string"><span class="hljs-string">'Moscow'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN --------------------------------------------------------------------- Bitmap Heap Scan on routes_t Recheck Cond: ((days_of_week = '{2,4,7}'::integer[]) AND (departure_city = 'Moscow'::text)) -&gt; Bitmap Index Scan on routes_t_days_of_week_departure_city_idx Index Cond: ((days_of_week = '{2,4,7}'::integer[]) AND (departure_city = 'Moscow'::text)) (4 rows)</code> </pre><br><h2 style=";text-align:right;direction:rtl">  JSONB </h2><br>  ุฃุญุฏ ุงูุฃูุซูุฉ ุงูุฃุฎุฑู ูููุน ุงูุจูุงูุงุช ุงููุฑูุจ ุงูุฐู ูุญุชูู ุนูู ุฏุนู GIN ูุถูู ูู JSON.  ููุนูู ูุน ููู JSON ุ ูุชู ุชุนุฑูู ุนุฏุฏ ูู ุงูุนูุงูู ูุงููุธุงุฆู ูู ุงูููุช ุงูุญุงูู ุ ููููู ุชุณุฑูุน ุจุนุถูุง ุจุงุณุชุฎุฏุงู ููุงุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">postgres=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> opc.opcname, amop.amopopr::<span class="hljs-type"><span class="hljs-type">regoperator</span></span>, amop.amopstrategy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> str <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pg_opclass opc, pg_opfamily opf, pg_am am, pg_amop amop <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> opc.opcname <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'jsonb_ops'</span></span>,<span class="hljs-string"><span class="hljs-string">'jsonb_path_ops'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> opf.oid = opc.opcfamily <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> am.oid = opf.opfmethod <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> amop.amopfamily = opc.opcfamily <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> am.amname = <span class="hljs-string"><span class="hljs-string">'gin'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> amop.amoplefttype = opc.opcintype;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> opcname | amopopr | str ----------------+------------------+----- jsonb_ops | ?(jsonb,text) | 9 top-level key exists jsonb_ops | ?|(jsonb,text[]) | 10 some top-level key exists jsonb_ops | ?&amp;(jsonb,text[]) | 11 all top-level keys exist jsonb_ops | @&gt;(jsonb,jsonb) | 7 JSON value is at top level jsonb_path_ops | @&gt;(jsonb,jsonb) | 7 (5 rows)</code> </pre><br>  ููุง ูุฑู ุ ุชุชููุฑ ูุฆุชุงู ูู ุนูุงูู ุงูุชุดุบูู: "jsonb_ops" ู "jsonb_path_ops". <br><br>  ูุชู ุงุณุชุฎุฏุงู ูุฆุฉ ุงููุดุบู ุงูุฃููู "jsonb_ops" ุงูุชุฑุงุถููุง.  ุฌููุน ุงูููุงุชูุญ ูุงูููู ูุนูุงุตุฑ ุงูุตููู ุชุตู ุฅูู ุงูููุฑุณ ูุนูุงุตุฑ ูู ูุซููุฉ JSON ุงูุฃูููุฉ.  ุชุชู ุฅุถุงูุฉ ุณูุฉ ุฅูู ูู ุนูุตุฑ ูู ูุฐู ุงูุนูุงุตุฑ ุ ููุง ูุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงู ูุฐุง ุงูุนูุตุฑ ููุชุงุญูุง (ููุฐุง ุถุฑูุฑู ูุงุณุชุฑุงุชูุฌูุงุช "ููุฌูุฏุฉ" ุ ูุงูุชู ุชููุฒ ุจูู ุงูููุงุชูุญ ูุงูููู). <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ุฏุนููุง ููุซู ุจุถุนุฉ ุตููู ูู "ุงูุชูุฌููุงุช" ูู JSON ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> routes_jsonb <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> to_jsonb(t) route <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> departure_airport_name, arrival_airport_name, days_of_week <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> flight_no <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> ) t; demo=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> ctid, jsonb_pretty(route) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_jsonb;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | jsonb_pretty -------+------------------------------------------------- (0,1) | { + | "days_of_week": [ + | 1 + | ], + | "arrival_airport_name": "Surgut", + | "departure_airport_name": "Ust-Ilimsk" + | } (0,2) | { + | "days_of_week": [ + | 2 + | ], + | "arrival_airport_name": "Ust-Ilimsk", + | "departure_airport_name": "Surgut" + | } (0,3) | { + | "days_of_week": [ + | 1, + | 4 + | ], + | "arrival_airport_name": "Sochi", + | "departure_airport_name": "Ivanovo-Yuzhnyi"+ | } (0,4) | { + | "days_of_week": [ + | 2, + | 5 + | ], + | "arrival_airport_name": "Ivanovo-Yuzhnyi", + | "departure_airport_name": "Sochi" + | } (4 rows)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> routes_jsonb <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> gin(route);</code> </pre><br><br>  ูุฏ ูุจุฏู ุงูููุฑุณ ููุง ููู: <br><br><img src="https://habrastorage.org/webt/oo/yi/x3/ooyix34gx7mrpiwdcol3a3ewnwu.png"><br><br>  ุงูุขู ุ ูุฏ ูุชู ุฅุฌุฑุงุก ุงุณุชุนูุงู ูุซู ูุฐุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุงุณุชุฎุฏุงู ุงูููุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">costs</span></span> <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> jsonb_pretty(route) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_jsonb <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> route @&gt; <span class="hljs-string"><span class="hljs-string">'{"days_of_week": [5]}'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> QUERY PLAN --------------------------------------------------------------- Bitmap Heap Scan on routes_jsonb Recheck Cond: (route @&gt; '{"days_of_week": [5]}'::jsonb) -&gt; Bitmap Index Scan on routes_jsonb_route_idx Index Cond: (route @&gt; '{"days_of_week": [5]}'::jsonb) (4 rows)</code> </pre><br>  ุจุฏุกูุง ูู ุฌุฐุฑ ูุณุชูุฏ JSON ุ ูุชุญูู ุนุงูู ุงูุชุดุบูู <code>@&gt;</code> ูุง ุฅุฐุง ูุงู ุงููุณุงุฑ ุงููุญุฏุฏ ( <code>"days_of_week": [5]</code> ) ูุญุฏุซ.  ููุง ุณูุนูุฏ ุงูุงุณุชุนูุงู ุตู ูุงุญุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">demo=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> jsonb_pretty(route) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> routes_jsonb <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> route @&gt; <span class="hljs-string"><span class="hljs-string">'{"days_of_week": [5]}'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> jsonb_pretty ------------------------------------------------ { + "days_of_week": [ + 2, + 5 + ], + "arrival_airport_name": "Ivanovo-Yuzhnyi",+ "departure_airport_name": "Sochi" + } (1 row)</code> </pre><br>  ูุชู ุชูููุฐ ุงูุงุณุชุนูุงู ุนูู ุงููุญู ุงูุชุงูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงุณุชุนูุงู ุงูุจุญุซ ( <code>"days_of_week": [5]</code> ) ูุชู ุงุณุชุฎุฑุงุฌ ุงูุนูุงุตุฑ (ููุงุชูุญ ุงูุจุญุซ): "days_of_week" ู "5". <br></li><li style=";text-align:right;direction:rtl">  ูู ุดุฌุฑุฉ ุงูุนูุงุตุฑ ุ ุชู ุงูุนุซูุฑ ุนูู ุงูููุงุชูุญ ุงููุณุชุฎุฑุฌุฉ ุ ูููู ูููู ุชุญุฏูุฏ ูุงุฆูุฉ TID: ูู ุฃุฌู "5" - (0.4) ุ ู "days_of_week" - (0ุ1) ุ (0ุ2) ) ุ (0.3) ุ (0.4). <br></li><li style=";text-align:right;direction:rtl">  ูู ุจูู ุฌููุน TID ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุ ุชุญุฏุฏ ูุธููุฉ ุงูุชูุงุณู ุชูู ุงูุชู ุชุทุงุจู ุงููุดุบู ูู ุงูุงุณุชุนูุงู.  ุจุงููุณุจุฉ ุฅูู ุนุงูู ุงูุชุดุบูู <code>@&gt;</code> ุ ูู ุชุนูู ุงููุณุชูุฏุงุช ุงูุชู ูุง ุชุญุชูู ุนูู ุฌููุน ุนูุงุตุฑ ุงุณุชุนูุงู ุงูุจุญุซ ุจุดูู ูุคูุฏ ุ ูุฐุง ุชุจูู ููุท (0ุ4).  ููููุง ูุง ุฒููุง ุจุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ูุญุต TID ูููุณุงุฑ ูุน ุงูุฌุฏูู ูุฃูู ุบูุฑ ูุงุถุญ ูู ุงูููุฑุณ ุจุงูุชุฑุชูุจ ุงูุฐู ุชุญุฏุซ ุจู ุงูุนูุงุตุฑ ุงูููุฌูุฏุฉ ูู ูุซููุฉ JSON. <br></li></ol><br>  ูุงูุชุดุงู ุงููุฒูุฏ ูู ุงูุชูุงุตูู ุนู ุงููุดุบููู ุงูุขุฎุฑูู ุ ููููู ูุฑุงุกุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> . <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุนูููุงุช ุงูุชูููุฏูุฉ ููุชุนุงูู ูุน JSON ุ ูุฅู ุงูุชุฏุงุฏ "jsquery" ูุชุงุญ ููุฐ ูุชุฑุฉ ุทูููุฉ ุ ูุงูุฐู ูุญุฏุฏ ูุบุฉ ุงูุงุณุชุนูุงู ุฐุงุช ุงูุฅููุงูุงุช ุงูุฃูุซุฑ ุซุฑุงุกู (ูุจุงูุชุฃููุฏ ุ ุจุฏุนู ูู ููุงุฑุณ GIN).  ุฅูู ุฌุงูุจ ุฐูู ุ ูู ุนุงู 2016 ุ ุชู ุฅุตุฏุงุฑ ูุนูุงุฑ SQL ุฌุฏูุฏ ุ ูุงูุฐู ูุญุฏุฏ ูุฌููุนุฉ ุงูุนูููุงุช ุงูุฎุงุตุฉ ุจู ููุบุฉ ุงูุงุณุชุนูุงู "ูุณุงุฑ SQL / JSON".  ุชู ุชูููุฐ ูุฐุง ุงููุนูุงุฑ ุจุงููุนู ุ ููุนุชูุฏ ุฃูู ุณูุธูุฑ ูู PostgreSQL 11. <br><br><blockquote style=";text-align:right;direction:rtl">  ุชู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุงูุชุฒุงู</a> ุจุชุตุญูุญ ูุณุงุฑ SQL / JSON ุฃุฎูุฑูุง ูู PostgreSQL 12 ุ ุจูููุง ูุง ุชุฒุงู ุงููุทุน ุงูุฃุฎุฑู ูู ุงูุทุฑูู.  ูุฃูู ุฃู ูุฑู ุงูููุฒุฉ ุงููุทุจูุฉ ุจุงููุงูู ูู PostgreSQL 13. <br></blockquote><br><h2 style=";text-align:right;direction:rtl">  ุงูุฏุงุฎููุฉ </h2><br>  ูููููุง ุงูุจุญุซ ุฏุงุฎู ููุฑุณ GIN ุจุงุณุชุฎุฏุงู ููุญู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pageinspect</a> ". <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extension</span></span> pageinspect;</code> </pre><br>  ุงููุนูููุงุช ุงููุงุฑุฏุฉ ูู ุตูุญุฉ ุงูุชุนุฑูู ุชุนุฑุถ ุฅุญุตุงุฆูุงุช ุนุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> gin_metapage_info(get_raw_page(<span class="hljs-string"><span class="hljs-string">'mail_messages_tsv_idx'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-[ RECORD 1 ]----+----------- pending_head | 4294967295 pending_tail | 4294967295 tail_free_size | 0 n_pending_pages | 0 n_pending_tuples | 0 n_total_pages | 22968 n_entry_pages | 13751 n_data_pages | 9216 n_entries | 1423598 version | 2</code> </pre><br>  ุชููุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจููุฉ ุงูุตูุญุฉ</a> ูุณุงุญุฉ ุฎุงุตุฉ ุญูุซ ุชุฎุฒู ุทุฑู ุงููุตูู ูุนูููุงุชูู ุ  ูุฐุง ุงููุฌุงู ูู "ูุจููุฉ" ููุจุฑุงูุฌ ุงูุนุงุฏูุฉ ูุซู ุงููุฑุงุบ.  ุชุนุฑุถ ูุธููุฉ "Gin_page_opaque_info" ูุฐู ุงูุจูุงูุงุช ูู GIN.  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุงูุชุนุฑู ุนูู ูุฌููุนุฉ ุตูุญุงุช ุงูููุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> flags, count(*) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">22967</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> g(id), <span class="hljs-comment"><span class="hljs-comment">-- n_total_pages gin_page_opaque_info(get_raw_page('mail_messages_tsv_idx',g.id)) group by flags;</span></span></code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> flags | count ------------------------+------- {meta} | 1 meta page {} | 133 internal page of element B-tree {leaf} | 13618 leaf page of element B-tree {data} | 1497 internal page of TID B-tree {data,leaf,compressed} | 7719 leaf page of TID B-tree (5 rows)</code> </pre><br>  ุชููุฑ ูุธููุฉ "Gin_leafpage_items" ูุนูููุงุช ุนู TIDs ุงููุฎุฒูุฉ ูู ุงูุตูุญุงุช {data ุ ูุฑูุฉ ุ ูุถุบูุทุฉ}: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">fts=# <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> gin_leafpage_items(get_raw_page(<span class="hljs-string"><span class="hljs-string">'mail_messages_tsv_idx'</span></span>,<span class="hljs-number"><span class="hljs-number">2672</span></span>));</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-[ RECORD 1 ]--------------------------------------------------------------------- first_tid | (239,44) nbytes | 248 tids | {"(239,44)","(239,47)","(239,48)","(239,50)","(239,52)","(240,3)",... -[ RECORD 2 ]--------------------------------------------------------------------- first_tid | (247,40) nbytes | 248 tids | {"(247,40)","(247,41)","(247,44)","(247,45)","(247,46)","(248,2)",... ...</code> </pre><br>  ูุงุญุธ ููุง ุฃู ุตูุญุงุช ุชุฑู TIDs ุชุญุชูู ูุนูููุง ุนูู ููุงุฆู ูุถุบูุทุฉ ุตุบูุฑุฉ ูู ุงููุคุดุฑุงุช ุฅูู ุตููู ุงูุฌุฏูู ุจุฏูุงู ูู ุงููุคุดุฑุงุช ุงููุฑุฏูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุฎุตุงุฆุต </h2><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฎุตุงุฆุต ุทุฑููุฉ ุงููุตูู ุฅูู GIN ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชู ุชูุฏูู</a> ุงูุงุณุชุนูุงูุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงููุนู</a> ). <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> amname | name | pg_indexam_has_property --------+---------------+------------------------- gin | can_order | f gin | can_unique | f gin | can_multi_col | t gin | can_exclude | f</code> </pre><br>  ููู ุงููุซูุฑ ููุงูุชูุงู ุ ูุฏุนู GIN ุฅูุดุงุก ููุงุฑุณ ูุชุนุฏุฏุฉ ุงูุฃุนูุฏุฉ.  ููุน ุฐูู ุ ุจุฎูุงู ุดุฌุฑุฉ B ุงูุนุงุฏูุฉ ุ ุจุฏูุงู ูู ุงูููุงุชูุญ ุงููุฑูุจุฉ ุ ุณูุธู ููุฑุณ ุงูุฃุนูุฏุฉ ุงููุชุนุฏุฏุฉ ูุฎุฒู ุงูุนูุงุตุฑ ุงููุฑุฏูุฉ ุ ูุณูุชู ุงูุฅุดุงุฑุฉ ุฅูู ุฑูู ุงูุนููุฏ ููู ุนูุตุฑ. <br><br>  ุชุชููุฑ ุฎุตุงุฆุต ุทุจูุฉ ุงูููุฑุณ ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> name | pg_index_has_property ---------------+----------------------- clusterable | f index_scan | f bitmap_scan | t backward_scan | f</code> </pre><br>  ูุงุญุธ ุฃู ุฅุฑุฌุงุน ุงููุชุงุฆุฌ TID ุจูุงุณุทุฉ TID (ูุณุญ ุงูููุฑุณ) ุบูุฑ ูุนุชูุฏ ุ  ุงููุณุญ ุงูููุทู ุงููุญูุฏ ูู ูููู. <br><br>  ุงููุญุต ุงูุฎููู ุบูุฑ ูุฏุนูู ุฃูุถูุง: ูุฐู ุงูููุฒุฉ ุถุฑูุฑูุฉ ูููุฑุณุฉ ุงูููุฑุณ ููุท ุ ูููู ููุณ ูููุญุต ุงูููุทู. <br><br>  ููููุง ููู ุฎุตุงุฆุต ุทุจูุฉ ุงูุนููุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> name | pg_index_column_has_property --------------------+------------------------------ asc | f desc | f nulls_first | f nulls_last | f orderable | f distance_orderable | f returnable | f search_array | f search_nulls | f</code> </pre><br>  ูุง ููุฌุฏ ุดูุก ูุชุงุญ ููุง: ูุง ููุฌุฏ ูุฑุฒ (ููู ุฃูุฑ ูุงุถุญ) ุ ูุง ูุงุฆุฏุฉ ูู ุงูููุฑุณ ูุบุทุงุก (ุญูุซ ุฃู ุงููุณุชูุฏ ููุณู ุบูุฑ ูุฎุฒูู ูู ุงูููุฑุณ) ุ ูุง ูุชู ูุนุงูุฌุฉ NULLs (ูุฃูู ูุง ูุนูู ูุนูุงุตุฑ ุงูููุน ุงููุฑูุจ) . <br><br><h2 style=";text-align:right;direction:rtl">  ุฃููุงุน ุงูุจูุงูุงุช ุงูุฃุฎุฑู </h2><br>  ุชุชููุฑ ุจุนุถ ุงูุฅุถุงูุงุช ุงูุฅุถุงููุฉ ุงูุชู ุชุถูู ุฏุนููุง ูู GIN ูุจุนุถ ุฃููุงุน ุงูุจูุงูุงุช. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชููููุง</a> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pg_trgm</a> " ูู ุชุญุฏูุฏ "ุชุดุงุจู" ุงููููุงุช ูู ุฎูุงู ููุงุฑูุฉ ุนุฏุฏ ูุชูุงููุงุช ุงูุญุฑูู ุงูุซูุงุซุฉ ุงููุชุณุงููุฉ (ุซูุงุซูุฉ) ุงููุชุงุญุฉ.  ุชุชู ุฅุถุงูุฉ ูุฆุชู ุนุงูููู ุ "gist_trgm_ops" ู "gin_trgm_ops" ุ ุงููุฐูู ูุฏุนูุงู ุงูุนุฏูุฏ ูู ุงูุนูุงูู ุ ุจูุง ูู ุฐูู ุงูููุงุฑูุฉ ุนู ุทุฑูู LIKE ูุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ.  ูููููุง ุงุณุชุฎุฏุงู ูุฐุง ุงูุงูุชุฏุงุฏ ูุน ุงูุจุญุซ ุนู ุงููุต ุงููุงูู ูุงูุชุฑุงุญ ุฎูุงุฑุงุช ุงููููุงุช ูุฅุตูุงุญ ุงูุฃุฎุทุงุก ุงููุทุจุนูุฉ. <br></li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">hstore</a> " ุชููุฐ "ุงููููุฉ ุงูุฑุฆูุณูุฉ" ุงูุชุฎุฒูู.  ุจุงููุณุจุฉ ูููุน ุงูุจูุงูุงุช ูุฐุง ุ ุชุชููุฑ ูุฆุงุช ุงููุดุบููู ูุทุฑู ุงููุตูู ุงููุฎุชููุฉ ุ ุจูุง ูู ุฐูู GIN.  ููุน ุฐูู ุ ูุน ุฅุฏุฎุงู ููุน ุงูุจูุงูุงุช "jsonb" ุ ูุง ุชูุฌุฏ ุฃุณุจุงุจ ุฎุงุตุฉ ูุงุณุชุฎุฏุงู "hstore". <br></li><li style=";text-align:right;direction:rtl">  ุชุนูู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">intarray</a> " ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุณูุน</a> ูุธุงุฆู ุงูุตูุงุฆู ุงูุตุญูุญุฉ.  ูุชุถูู ุฏุนู ุงูููุฑุณ GiST ุ ููุฐูู GIN (ูุฆุฉ ุงููุดุบู "gin__int_ops"). <br></li></ul><br>  ููุฏ ุณุจู ุฐูุฑ ูุฐูู ุงูุงูุชุฏุงุฏูู ุฃุนูุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุถูู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">btree_gin</a> " ุฏุนู GIN ูุฃููุงุน ุงูุจูุงูุงุช ุงูููุชุธูุฉ ูู ุฃุฌู ุงุณุชุฎุฏุงููุง ูู ููุฑุณ ูุชุนุฏุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุนูุฏุฉ</a> ุฅูู ุฌุงูุจ ุงูุฃููุงุน ุงููุฑูุจุฉ. <br></li><li style=";text-align:right;direction:rtl">  ูุนุฑูู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">jsquery</a> " ูุบุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุณุชุนูุงู</a> JSON ููุฆุฉ ูุดุบู ูุฏุนู ุงูููุฑุณ ููุฐู ุงููุบุฉ.  ูุง ูุชู ุชุถููู ูุฐุง ุงูุงูุชุฏุงุฏ ูู ุชุณููู PostgreSQL ููุงุณู. <br></li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุฃ ุนูู</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar448746/">https://habr.com/ru/post/ar448746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar448732/index.html">ูุชู ุงูููุฑูุฉุ ุงูุนูู ุนูููุง</a></li>
<li><a href="../ar448738/index.html">ุงูุฐู ูุตุทุงุฏ ุงูุดุฑูุงุช ุงููุงุดุฆุฉุ</a></li>
<li><a href="../ar448740/index.html">ูุณุชูุน ุฅูู ููุณููู SID (ุงูุนููุฏ 64) ูู ุฎูุงู OPL3 ุนูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงูุญุฏูุซุฉ</a></li>
<li><a href="../ar448742/index.html">ุตูุฏูู Pandora: ูููู ุจุชุญููู ุงุณุชุบูุงู ูุดููุฉ ุนุฏู ุญุตุงูุฉ WinRAR ุจุงุณุชุฎุฏุงู ูุซุงู ูุธููุฉ NeoQUEST-2019</a></li>
<li><a href="../ar448744/index.html">ููููุฉ ููู ูุชุบูุฑ ูู ุฌุฒุก ุฅูู ูุดุงุท ูู Androidุ</a></li>
<li><a href="../ar448750/index.html">ุญูู ุถุนู ูุงุญุฏ ููุณุช ูุฐูู</a></li>
<li><a href="../ar448754/index.html">ูู ูู ุงูุฐู ูู ุงููุตุฏุฑ ุงูููุชูุญ: ุงูุณูุฑ ุงูุฐุงุชูุฉ ุงููููุณ</a></li>
<li><a href="../ar448758/index.html">ุณุงุนุฉ ุฐููุฉ ูุน BASIC ุนูู 6502 ุงููุงุฏูุฉ</a></li>
<li><a href="../ar448760/index.html">ุงูุชูููุฉ ูู ุงูุณุญุงุจุฉ ุ ูุฃูู ุงููุนูููุงุช ูุงูุจูุงูุงุช ุงูุดุฎุตูุฉ: ูุถู ูููุฑุงุกุฉ ูู ุนุทูุฉ ููุงูุฉ ุงูุฃุณุจูุน ูู 1cloud</a></li>
<li><a href="../ar448762/index.html">ุฃุนูุงู ุดุบุจ ุนูู ุจููุงุจุง. ุงููุณุชุฎุฏููู ุงูุฐูุงุจ ุนูู ูุทุงู ูุงุณุน ุฅูู ุฑุฏูุช</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>