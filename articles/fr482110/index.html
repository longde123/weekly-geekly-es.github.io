<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💛 🧑🏿‍🤝‍🧑🏿 🚻 Linux fonctionne sur ma carte de visite 👨🏼‍🎤 ™️ 👦🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Traduction d'un article du blog de l' ingénieur George Hilliard 

  
 Cliquable 

 Je suis ingénieur en systèmes embarqués. Dans mon temps libre, je c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Linux fonctionne sur ma carte de visite</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482110/"> <i>Traduction d'un article du <a href="https://www.thirtythreeforty.net/">blog de l'</a> ingénieur George Hilliard</i> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/953/2a8/ddc/9532a8ddcfcc8709783f40fd9c588eeb.jpg"></a> <br>  <i>Cliquable</i> <br><br>  Je suis ingénieur en systèmes embarqués.  Dans mon temps libre, je cherche souvent ce qui peut être utilisé dans la conception de futurs systèmes, ou quelque chose de la catégorie de mes intérêts. <br><br>  Un de ces domaines est celui des ordinateurs bon marché qui peuvent prendre en charge Linux, et moins cher sera le mieux.  Par conséquent, je me suis enterré dans un trou de lapin profond de processeurs peu connus. <br><br>  J'ai pensé: "Ces processeurs sont si bon marché qu'ils peuvent pratiquement être distribués gratuitement."  Et après un certain temps, l'idée m'est venue de créer une carte nue pour Linux sous forme de carte de visite. <br><a name="habracut"></a><br>  Dès que j'y ai pensé, j'ai décidé que ce serait très cool à faire.  J'ai déjà <a href="https://hackaday.com/2017/10/04/literally-flashy-business-cards/">vu</a> <a href="https://hackaday.com/2018/05/11/stylish-business-card-with-a-stylophone-built-in/">des</a> <a href="https://hackaday.com/2014/06/17/designing-the-second-version-of-my-business-card/">cartes de visite</a> <a href="https://hackaday.com/2018/05/11/stylish-business-card-with-a-stylophone-built-in/">électroniques</a> auparavant, et elles avaient diverses fonctionnalités intéressantes, telles que l'émulation de cartes flash, des voyants clignotants ou même le transfert de données sans fil.  Cependant, je n'ai pas vu de cartes de visite avec support Linux. <br><br>  Je m'en suis donc fait un. <br><br>  Ceci est une version complète du produit.  Un ordinateur minimum à part entière sur ARM, qui exécute ma version spéciale de Linux, créée à l'aide de Buildroot. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6fd/e4a/608/6fde4a6082ee3747bc571f7b9394047b.jpg"><br><br>  Dans le coin, elle a un port USB.  Si vous le connectez à un ordinateur, il se charge en environ 6 secondes et il peut être vu comme une carte flash et un port série virtuel, à travers lequel vous pouvez entrer dans le shell de la carte.  Sur le lecteur flash se trouve un fichier README, une copie de mon CV et certaines de mes photos.  Il y a plusieurs jeux dans le shell, des classiques d'Unix comme fortune et rogue, une petite version du jeu 2048 et l'interpréteur MicroPython. <br><br>  Tout cela se fait avec une toute petite puce flash de 8 Mo.  Le chargeur de démarrage tient dans 256 Ko, le noyau prend 1,6 Mo et l'ensemble du système de fichiers racine - 2,4 Mo.  Par conséquent, il reste beaucoup d'espace pour un lecteur flash virtuel.  Il a également un répertoire personnel accessible en écriture - si quelqu'un fait quelque chose qu'il veut enregistrer.  Ceci est également stocké sur une puce flash. <br><br>  L'ensemble de l'appareil coûte moins de 3 $.  C'est assez bon marché pour être distribué.  Si vous avez reçu un tel appareil de ma part, cela signifie que j'essaie très probablement de vous impressionner. <br><br><h2>  Conception et assemblage </h2><br>  J'ai tout conçu et assemblé moi-même.  C'est mon travail, et j'aime ça, et la plupart des difficultés ont consisté à trouver suffisamment de pièces bon marché pour un tel passe-temps. <br><br>  Le choix d'un processeur a été la décision la plus importante qui a affecté le coût et la faisabilité du projet.  Après des recherches actives, j'ai choisi le F1C100s, un processeur Allwinner relativement peu connu, à coût optimisé (c'est-à-dire sacrément bon marché).  Dans un cas, sont à la fois RAM et CPU.  J'ai acheté des processeurs sur Taobao.  Tous les autres composants achetés au LCSC. <br><br>  J'ai commandé des planches à JLC.  Pour 8 $, j'ai fait 10 copies.  Leur qualité est impressionnante, surtout pour le prix;  Pas aussi bien rangé que OSHPark, mais il a toujours l'air bien. <br><br>  J'ai fait le premier lot noir mat.  Ils étaient beaux, mais étaient très facilement souillés. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/750/9d9/d7c/7509d9d7c24c3ba3c6d7d9214c0f0878.jpg"><br><br>  Il y a eu quelques problèmes avec le premier lot.  Premièrement, le connecteur USB n'était pas assez long pour s'insérer correctement dans les ports USB.  Deuxièmement, les traces de flash n'ont pas été faites correctement, mais j'ai contourné cela en pliant les contacts. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f6a/d88/294/f6ad8829440e6f1b942292b45ab6841b.jpg"><br><br>  Après avoir tout vérifié au travail, j'ai commandé un nouveau lot de planches;  Vous pouvez voir une photo de l'un d'eux au début de l'article. <br><br>  En raison de la petite taille de tous ces petits composants, j'ai décidé de recourir à la soudure par refusion à l'aide d'un <a href="https://www.thirtythreeforty.net/posts/2019/08/t962-reflow-profile-calculator/">poêle bon marché</a> .  J'ai accès à un cutter laser, j'ai donc coupé un pochoir à souder à partir d'un film pour une plastifieuse dessus.  Le pochoir s'est plutôt bien passé.  Les trous pour les contacts du processeur d'un diamètre de 0,2 mm nécessitaient un soin particulier pour une fabrication de haute qualité - il était extrêmement important de bien focaliser le laser et de sélectionner sa puissance. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/91e/4bf/55d/91e4bf55dd1c86a241be05998ca1b2fd.jpg"><br>  <i>D'autres planches sont bonnes pour tenir la planche lors de l'application de la pâte.</i> <br><br>  J'ai appliqué de la pâte à souder et arrangé les composants manuellement.  Je me suis assuré que le plomb n'était utilisé nulle part dans le processus - toutes les cartes, composants et pâtes sont <a href="https://ru.wikipedia.org/wiki/Restriction_of_Hazardous_Substances_Directive">conformes à RoHS</a> - afin que je ne sois pas tourmenté par la conscience lorsque je les distribue aux gens. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/419/00d/a63/41900da63d71dd54c47c8325e4bfeead.jpg"><br>  <i>J'ai manqué un peu avec ce lot, mais la pâte à souder pardonne les erreurs, et tout s'est bien passé</i> <br><br>  Chaque composant a pris environ 10 secondes pour se positionner, j'ai donc essayé de minimiser leur nombre.  Plus de détails sur la conception d'une carte peuvent être trouvés dans <a href="https://www.thirtythreeforty.net/posts/2019/12/designing-my-linux-business-card/">mon</a> autre <a href="https://www.thirtythreeforty.net/posts/2019/12/designing-my-linux-business-card/">article détaillé</a> . <br><br><h2>  Liste des matériaux et coût </h2><br>  J'ai respecté un budget strict.  Et la carte de visite s'est avérée comme elle était destinée - cela ne me dérange pas de la donner!  Bien sûr, je ne le donnerai à personne et à tout le monde, car du temps est consacré à la production de chaque copie, et mon temps n'est pas pris en compte dans le coût d'une carte de visite (c'est un peu gratuit). <br><br><div class="scrollable-table"><table><tbody><tr><th>  Composant </th><th>  Prix </th></tr><tr><td>  F1C100s </td><td>  1,42 $ </td></tr><tr><td>  PCB </td><td>  0,80 $ </td></tr><tr><td>  Flash de 8 Mo </td><td>  0,17 $ </td></tr><tr><td>  Tous les autres composants </td><td>  0,49 $ </td></tr><tr><td>  <b>Total</b> </td><td>  2,88 $ </td></tr></tbody></table></div><br><br>  Naturellement, il y a encore des dépenses difficiles à calculer, comme la livraison (puisqu'elle a été répartie entre des composants destinés à plusieurs projets).  Cependant, pour une carte avec prise en charge Linux, c'est certainement assez bon marché.  De plus, cette ventilation donne une bonne idée du coût de fabrication des appareils du segment de prix le plus bas: vous pouvez être sûr que cela coûte encore moins cher aux entreprises que moi! <br><br><h2>  Les possibilités </h2><br>  Que dire?  La carte charge Linux très fortement recadré en 6 secondes.  En raison du facteur de forme et du coût, la carte ne dispose pas d'E / S, d'une prise en charge réseau ou d'une quantité importante de stockage pour lancer des programmes lourds.  Néanmoins, j'ai réussi à insérer un tas de choses intéressantes dans l'image du firmware. <br><br><h2>  USB </h2><br>  Avec l'USB, vous pourriez trouver beaucoup de choses intéressantes, mais j'ai choisi l'option la plus simple, de sorte qu'avec une forte probabilité, les gens travailleraient s'ils décidaient d'essayer ma carte de visite.  Linux permet à la carte de se comporter comme un «périphérique» avec prise en charge du <a href="https://linux-sunxi.org/USB_Gadget">Gadget Framework</a> .  J'ai pris quelques pilotes de projets précédents qui comprenaient ce processeur, j'ai donc accès à toutes les fonctionnalités du framework de gadget USB.  J'ai décidé d'émuler un lecteur flash pré-généré et de donner accès au shell via un port série virtuel. <br><br><h2>  Coquille </h2><br>  Après vous être connecté en tant que root, vous pouvez exécuter les programmes suivants sur la console série: <br><ul><li>  voleur: un jeu d'aventure de donjon Unix classique; </li><li>  2048: jeu simple en 2048 en mode console; </li><li>  fortune: la conclusion de divers dictons pathétiques.  J'ai décidé de ne pas inclure ici toute la base de devis pour laisser de la place à d'autres fonctions; </li><li>  <a href="https://micropython.org/">micropython</a> : un très petit interpréteur Python. </li></ul><br><br><h2>  Émulation de lecteur flash </h2><br>  Au moment de la compilation, les outils de génération génèrent une petite image FAT32 et l'ajoutent comme l'une des partitions UBI.  Le sous-système de gadget Linux présente son PC comme un périphérique de stockage. <br><br>  Si vous souhaitez voir ce qui apparaît sur le lecteur flash, la façon la plus simple de le faire est de vous familiariser avec la <a href="https://github.com/thirtythreeforty/businesscard-linux/tree/master/package/businesscard-flashdrive/files">source</a> .  Il y a aussi quelques photos et mon CV. <br><br><h2>  Les ressources </h2><br><h3>  Code source </h3><br>  Mon arborescence Buildroot est téléchargée sur GitHub - <a href="https://github.com/thirtythreeforty/businesscard-linux">trentethreeforty / businesscard-linux</a> .  Il existe un code pour générer une image flash NOR, qui est défini à l'aide du mode de téléchargement USB du processeur.  Il contient également toutes les définitions de packages pour les jeux et autres programmes que j'ai insérés dans Buildroot après leur fonctionnement.  Si vous souhaitez utiliser les F1C100 dans votre projet, ce sera un excellent point de départ (n'hésitez pas <a href="https://www.thirtythreeforty.net/about/">à me poser des questions</a> ). <br>  J'ai utilisé le <a href="https://github.com/Icenowy/linux/tree/f1c100s">projet</a> Linux v4.9 <a href="https://github.com/Icenowy/linux/tree/f1c100s">magnifiquement exécuté</a> pour F1C100s par Icenowy, en le refaisant un peu.  La v5.2 presque standard fonctionne sur ma carte.  Elle se trouve sur GitHub - <a href="">trente</a> - <a href="">troisforty / linux</a> . <br>  Je pense qu'aujourd'hui j'ai le meilleur port U-Boot pour F1C100 au monde, et il est partiellement basé sur le travail d'Icenowy (de manière inattendue, faire fonctionner U-Boot comme il se doit s'est avéré être une tâche très désagréable).  Vous pouvez également prendre GitHub - <a href="">trente</a> - <a href="">troisforty / u-boot</a> . <br><br><h3>  Documentation pour F1C100s </h3><br>  J'ai trouvé la documentation plutôt rare des F1C100, et je la poste ici: <br><ul><li>  <a href="https://www.thirtythreeforty.net/media/F1C100s_Datasheet_V1.0.pdf">Fiche technique Allwinner F1C100s</a> - informations générales et brochage. </li><li>  <a href="https://www.thirtythreeforty.net/media/Allwinner_F1C600_User_Manual_V1.0.pdf">Allwinner F1C600 Reference Manual</a> - définitions de registre pour le F1C600, qui est en fait le même F1C100, mais renommé avec le support Linux déclaré (ha!). </li><li>  J'ai activement emprunté les informations du circuit à <a href="http://dl.sipeed.com/LICHEE/Nano/">Lichee Nano de Sipeed</a> - la carte de développement que j'ai utilisée pour configurer le logiciel. </li></ul><br><br>  Pour les curieux, je télécharge le <a href="https://www.thirtythreeforty.net/posts/2019/12/my-business-card-runs-linux/businesscard.pdf">plan de mon projet</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d56/59a/549/d5659a549dd475471b3309f2efb66a0a.svg"><br><br><h2>  Conclusion </h2><br>  J'ai appris beaucoup de choses pendant le développement de ce projet - c'est mon premier projet, où j'ai utilisé un four de brasage par refusion.  J'ai également appris à trouver des ressources pour des composants avec une documentation médiocre. <br><br>  J'ai utilisé mon expérience avec Linux embarqué et mon expérience dans le développement de cartes.  Le projet n'est pas sans défauts, mais il montre bien toutes mes compétences. <br><br>  Pour ceux qui s'intéressent aux détails du travail avec Linux embarqué, je suggère de lire ma série d'articles à ce sujet: <a href="https://www.thirtythreeforty.net/posts/2019/08/mastering-embedded-linux-part-1-concepts/">Maîtriser Linux embarqué</a> .  Là, je parle en détail de la façon de créer des logiciels et du matériel à partir de zéro pour des systèmes Linux minuscules et bon marché, similaires à ma carte de visite. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482110/">https://habr.com/ru/post/fr482110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482100/index.html">Technologie AMP dans les e-mails: avantages, inconvénients et utilisations possibles</a></li>
<li><a href="../fr482102/index.html">Habr Q&A 2019: résultats de l'année</a></li>
<li><a href="../fr482104/index.html">Comment gérer les habitudes des personnes programmées</a></li>
<li><a href="../fr482106/index.html">Habr Freelance 2019: résultats de l'année</a></li>
<li><a href="../fr482108/index.html">Intelligence silencieuse. Méthode d'identification des vulnérabilités WEB potentielles</a></li>
<li><a href="../fr482114/index.html">Envoyer des e-mails en utilisant asyncio et aiohttp à partir d'une application Django</a></li>
<li><a href="../fr482126/index.html">Chronique de Keras pour TensorFlow</a></li>
<li><a href="../fr482128/index.html">gReebok détecté. Dermatovénologue lui-même</a></li>
<li><a href="../fr482130/index.html">Attribution à grande échelle de droits aux utilisateurs de domaine de différentes forêts</a></li>
<li><a href="../fr482132/index.html">La copie de Tesla Cybertruck a été repérée à Moscou. Il s'agit d'un ... LADA russe Samara personnalisé</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>