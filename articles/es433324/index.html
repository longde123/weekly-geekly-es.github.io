<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè° ü§úüèæ üìÜ Recolectando el paquete de sue√±os con Webpack ü•Ç üë©üèΩ‚Äçüéì ü§≥üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las aplicaciones JS, los sitios y otros recursos se est√°n volviendo m√°s complejos y las herramientas de construcci√≥n son la realidad del desarrollo we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Recolectando el paquete de sue√±os con Webpack</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/433324/">  Las aplicaciones JS, los sitios y otros recursos se est√°n volviendo m√°s complejos y las herramientas de construcci√≥n son la realidad del desarrollo web.  Los paquetes ayudan a empacar, compilar y organizar bibliotecas.  Webpack es una de las herramientas de c√≥digo abierto potentes y flexibles que se pueden personalizar perfectamente para crear la aplicaci√≥n cliente. <br><br>  Maxim Sosnov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">crazymax11</a> ) - Frontend Lead en N1.RU introdujo Webpack en varios proyectos grandes que anteriormente ten√≠an su propia construcci√≥n personalizada, y contribuy√≥ con varios proyectos.  Maxim sabe c√≥mo construir un paquete so√±ado con Webpack, hacerlo r√°pidamente y configurarlo para que la configuraci√≥n permanezca limpia, mantenida y modular. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4ClK_0fxsVM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  La interpretaci√≥n es diferente del informe: es una versi√≥n muy mejorada de los enlaces de perfil.  A lo largo de la transcripci√≥n, los huevos de Pascua est√°n dispersos en art√≠culos, complementos, minificadores, opciones, transpiladores y pruebas de las palabras del hablante, enlaces a los que simplemente no se pueden poner en un discurso.  Si recoge todo, se abre el nivel de bonificaci√≥n en Webpack :-) <br><a name="habracut"></a><br><h2>  Integraci√≥n de webpack en un proyecto t√≠pico </h2><br>  Por lo general, el procedimiento de implementaci√≥n es el siguiente: el desarrollador en alg√∫n lugar lee un art√≠culo sobre Webpack, decide conectarlo, comienza a compilarlo, de alguna manera funciona, todo comienza y durante alg√∫n tiempo funciona webpack-config: durante seis meses, un a√±o, dos.  A nivel local, todo est√° bien: el sol, el arco iris y las mariposas.  Y luego vienen los usuarios reales: <br><br>  <em>- Desde dispositivos m√≥viles su sitio no se carga.</em> <em><br></em>  <em>- Todo funciona para nosotros.</em>  <em>A nivel local, todo est√° bien!</em> <br><br>  Por si acaso, el desarrollador analiza todo y ve que para dispositivos m√≥viles el <strong>paquete pesa 7 MB y tarda 30 segundos en cargarse</strong> .  Esto no se adapta a nadie y el desarrollador comienza a buscar c√≥mo resolver el problema: puede conectar el cargador o encontrar un complemento m√°gico que resuelva todos los problemas.  Milagrosamente, se encuentra dicho complemento.  Nuestro desarrollador va a webpack-config, intenta instalar, pero la l√≠nea de c√≥digo interfiere: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (process.env.NODE_ENV === <span class="hljs-string"><span class="hljs-string">'production'</span></span>) { config.module.rules[<span class="hljs-number"><span class="hljs-number">7</span></span>].options.magic = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  La l√≠nea se traduce de la siguiente manera: "Si la configuraci√≥n se est√° ensamblando para producci√≥n, entonces tome la s√©ptima regla y coloque la opci√≥n <code>magic = true</code> ".  El desarrollador no sabe qu√© hacer con esto y c√≥mo resolverlo.  Esta es una situaci√≥n en la que necesitas un paquete de sue√±os. <br><br><h2>  ¬øC√≥mo recoger un paquete de sue√±os? </h2><br>  Primero, definamos qu√© es.  En primer lugar, el paquete de sue√±os tiene dos caracter√≠sticas principales: <br><br><ul><li>  <strong>Pesa un poco</strong>  Cuanto menos peso, m√°s r√°pido obtendr√° el usuario una aplicaci√≥n que funcione.  No desea que su sitio se abra durante 15 segundos. </li><li>  El usuario <strong>descarga solo lo que necesita</strong> descargar para mostrar la p√°gina actual del sitio, ¬°y no un byte m√°s! </li></ul><br>  Y para reducir el tama√±o del paquete, primero debe evaluar su tama√±o. <br><br><h3>  Calificar el tama√±o del paquete </h3><br>  La soluci√≥n m√°s popular es el complemento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WebpackBundleAnalyzer</a> .  Recopila estad√≠sticas de compilaci√≥n de aplicaciones y presenta una p√°gina interactiva donde puede ver la ubicaci√≥n y el peso de cada m√≥dulo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27a/803/6b9/27a8036b994a09b7371c567b6df6cd82.png" alt="imagen"><br><br>  Si esto no es suficiente, puede crear un <strong>gr√°fico de dependencia</strong> utilizando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otro complemento</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c3/900/24a/7c390024a9d902ca99e3d00c0d8081b3.png" alt="imagen"><br><br>  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un gr√°fico circular</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/350/14a/ec4/35014aec45623d06972bca310b3f8edf.png" alt="imagen"><br><br>  Si esto no es suficiente, y desea vender Webpack a los vendedores, entonces puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">construir un universo entero</a> donde cada punto es un m√≥dulo, como una estrella en el Universo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45b/a6e/2d2/45ba6e2d2daff144c69df2a43e8ef53a.png" alt="imagen"><br><br>  Existen muchas herramientas que eval√∫an el tama√±o del paquete y lo supervisan.  Hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una opci√≥n en la configuraci√≥n de Webpack</a> que bloquea el ensamblaje si el paquete pesa demasiado, por ejemplo.  Existe un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">complemento duplicado-paquete-corrector-paquete-web-plugin</a> que le impedir√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">construir un</a> paquete si tiene paquetes de 2 npm de diferentes versiones, por ejemplo, Lodash 4.15 y Lodash 4.14. <br><br><h3>  C√≥mo reducir el paquete </h3><br><ul><li>  Lo m√°s obvio es conectar <strong>UglifyJS</strong> para que minimice JavaScript. </li><li>  Utilice <strong>cargadores y complementos especiales</strong> que comprimen y optimizan un recurso espec√≠fico.  Por ejemplo, <strong>css-nano</strong> para css o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SVGO</a> , que optimiza SVG. </li><li>  Comprima todos los archivos directamente en Webpack a trav√©s de los complementos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gzip / brotli</a> . </li><li>  Otras herramientas </li></ul><br>  Ahora entenderemos c√≥mo arrojar el exceso del paquete. <br><br><h3>  Tirar el exceso </h3><br>  Considere esto en un ejemplo popular con <strong>moment.js</strong> : <code>import moment from 'moment'</code> .  Si toma una aplicaci√≥n vac√≠a, importe moment.js y <strong>ReactDOM</strong> en ella, y luego la pase a trav√©s de <strong>WebpackBundleAnalyzer</strong> , ver√° la siguiente imagen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/105/e0f/833/105e0f8334a83c529077c693fda3d3de.png" alt="imagen"><br><br>  Resulta que cuando agrega un d√≠a, una hora a una fecha, o simplemente desea poner el enlace "en 15 minutos" usando moment.js, ¬°conecta un <strong>c√≥digo de 230 Kbytes</strong> completo!  ¬øPor qu√© sucede esto y c√≥mo se resuelve? <br><br><h4>  Carga regional en este momento </h4><br>  Hay una funci√≥n en moment.js que establece las configuraciones regionales: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setLocale</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">locale</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> localePath = <span class="hljs-string"><span class="hljs-string">'locale/'</span></span> + locale + <span class="hljs-string"><span class="hljs-string">'.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._currentLocale = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(localePath); }</code> </pre><br>  Se puede ver en el c√≥digo que la configuraci√≥n regional se carga a lo largo de la ruta din√°mica, es decir,  calculado en tiempo de ejecuci√≥n.  Webpack act√∫a de manera inteligente e intenta asegurarse de que su paquete no se bloquee durante la ejecuci√≥n del c√≥digo: encuentra todas las configuraciones regionales posibles en el proyecto y las agrupa.  Por lo tanto, la aplicaci√≥n pesa mucho. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a03/4cc/b3f/a034ccb3fc36dd03b916b0bc28acb057.png" alt="imagen"><br><br>  La soluci√≥n es muy simple: tomamos un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">complemento est√°ndar</a> de Webpack y le decimos: "Si ves que alguien quiere descargar muchas configuraciones regionales, porque no pueden determinar cu√°l, ¬°toma la rusa!" <br><br><img src="https://habrastorage.org/getpro/habr/post_images/587/fe6/e38/587fe6e38333e8b482fed615e3c00ee1.png" alt="imagen"><br><br>  Webpack solo tomar√° ruso, y WebpackBundleAnalyzer mostrar√° 54 Kb, que ya es 200 Kb m√°s f√°cil. <br><br><h3>  Eliminaci√≥n de c√≥digo muerto </h3><br>  La siguiente optimizaci√≥n que nos interesa es la <strong>eliminaci√≥n del c√≥digo muerto</strong> .  Considere el siguiente c√≥digo. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cond = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cond) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; someFunction(<span class="hljs-number"><span class="hljs-number">42</span></span>);</code> </pre><br>  La mayor√≠a de las l√≠neas de este c√≥digo no son necesarias en el paquete final: el bloque con la condici√≥n no se ejecutar√°, la funci√≥n despu√©s del retorno tambi√©n.  Todo lo que necesitas para salir es <code>return true</code> .  Esto es exactamente lo que es la eliminaci√≥n del c√≥digo muerto: la herramienta de compilaci√≥n detecta el c√≥digo que no se puede ejecutar y lo corta.  Hay una buena caracter√≠stica que UglifyJS puede hacer esto. <br><br>  Ahora pasemos a la eliminaci√≥n de c√≥digo muerto m√°s avanzada: <strong>m√©todo de sacudida de √°rbol</strong> . <br><br><h3>  Sacudida del √°rbol </h3><br>  Digamos que tenemos una aplicaci√≥n que usa <strong>Lodash</strong> .  Dudo mucho que alguien est√© usando todo el Lodash.  Lo m√°s probable es que <strong>se</strong> <strong>exploten</strong> varias funciones como <strong>get</strong> , <strong>IsEmpty</strong> , <strong>unionBy</strong> o similares. <br><br>  Cuando hacemos sacudidas de √°rbol, queremos que Webpack ‚Äúagite‚Äù los m√≥dulos innecesarios y los deseche, y solo tenemos los necesarios.  Esto es sacudir el √°rbol. <br><br><h4>  C√≥mo funciona la sacudida de √°rboles en Webpack </h4><br>  Digamos que tienes un c√≥digo como este: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { a } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./a.js'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(a);</code> </pre><br>  El c√≥digo es muy simple: desde alg√∫n m√≥dulo, importe la variable a y env√≠ela.  Pero hay dos variables en este m√≥dulo: <strong>a</strong> y <strong>b</strong> .  No necesitamos la variable <b>b</b> , y queremos eliminarla. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre><br>  Cuando llega Webpack, convierte el c√≥digo de importaci√≥n en esto: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(d[<span class="hljs-string"><span class="hljs-string">"a"</span></span>]);</code> </pre><br>  Nuestra <code>import</code> convirti√≥ en <code>require</code> , pero <code>console.log</code> no <code>console.log</code> cambiado. <br><br>  La dependencia de Webpack se convierte al siguiente c√≥digo: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports[<span class="hljs-string"><span class="hljs-string">"a¬´] = a; /* unused harmony export b */ var b = 4;</span></span></code> </pre><br><br>  Webpack dej√≥ la exportaci√≥n de la variable <b>a</b> , y elimin√≥ la exportaci√≥n de la variable <b>b</b> , pero dej√≥ la variable en s√≠, marc√°ndola con un comentario especial.  En el c√≥digo convertido, la variable <b>b</b> no se usa y UglifyJS puede eliminarla. <br><br><blockquote>  La sacudida del √°rbol de Webpack solo funciona si tienes alg√∫n tipo de minificador de c√≥digo, como UglifyJS o <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">babel-minify</a></b> . </blockquote><br>  Consideremos casos m√°s interesantes, cuando la sacudida del √°rbol no funciona. <br><br><h4>  Cuando el movimiento de los √°rboles no funciona </h4><br>  Caso No. 1. Usted escribe el c√≥digo: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports.a = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports.b = <span class="hljs-number"><span class="hljs-number">4</span></span>;</code> </pre><br>  Ejecute el c√≥digo a trav√©s de Webpack, y sigue siendo el mismo.  Esto se debe a que el agrupador organiza la sacudida del √°rbol solo si usa m√≥dulos ES6.  Si usa m√≥dulos CommonJS, la sacudida de √°rbol no funcionar√°. <br><br>  Caso No. 2. Usted escribe c√≥digo con m√≥dulos ES6 y exportaciones con nombre. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre><br>  Si su c√≥digo se ejecuta a trav√©s de Babel y no configur√≥ la opci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√≥dulos en falso</a> , entonces Babel traer√° sus m√≥dulos a CommonJS y Webpack nuevamente no podr√° ejecutar Tree Shaking, porque solo funciona con m√≥dulos ES6. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports.a = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports.b = <span class="hljs-number"><span class="hljs-number">4</span></span>;</code> </pre><br>  En consecuencia, debemos asegurarnos de que nadie en nuestro plan de ensamblaje transforme los m√≥dulos ES6. <br><br>  Caso No. 3. Supongamos que tenemos una clase tan in√∫til que no hace nada: <code>export class ShakeMe {}</code> .  Adem√°s, todav√≠a no lo usamos.  Cuando Webpack pasa por importaci√≥n y exportaci√≥n, Babel convertir√° la clase en una funci√≥n, y el agrupador notar√° que la funci√≥n no se utiliza: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* unused harmony e[port b */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ShakeMe = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShakeMe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ babelHelpers.classCallCheck(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ShakeMe); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ShakeMe; }();</code> </pre><br>  Parece que todo deber√≠a estar bien, pero si miramos m√°s de cerca, veremos que dentro de esta funci√≥n hay una variable global <code>babelHelpers</code> , desde la que se llama a alguna funci√≥n.  Este es un <b>efecto secundario</b> : UglifyJS ve que se est√° llamando a alguna funci√≥n global y no cortar√° el c√≥digo, porque teme que algo se rompa. <br><br>  Cuando escribes clases y las ejecutas a trav√©s de Babel, nunca se cortan.  ¬øC√≥mo se soluciona esto?  Hay un hack estandarizado: agregue un comentario <code>/*#__PURE__*/</code> antes de la funci√≥n: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* unused harmony export b */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ShakeMe = <span class="hljs-comment"><span class="hljs-comment">/*#__PURE__*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShakeMe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ babelHelpers.classCallCheck(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ShakeMe); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ShakeMe; }();</code> </pre><br>  Entonces UglifyJS creer√° en la palabra que la siguiente funci√≥n es pura.  Afortunadamente, <b><a href="">Babel 7</a></b> est√° haciendo esto ahora, y en Babel 6, nada se ha eliminado hasta ahora. <br><br><blockquote>  Regla: si tienes un efecto secundario en alguna parte, UglifyJS no har√° nada. </blockquote><br>  Para resumir: <br><br><ul><li>  <b>La sacudida de √°rboles no funciona para la mayor√≠a de las bibliotecas de npm</b> , porque todas son de CommonJS y est√°n construidas por el antiguo Babel. </li><li>  Lo m√°s probable es que <b>Tree Shaking funcione adecuadamente para aquellas bibliotecas que ya est√°n preparadas para esto</b> , por ejemplo, Lodash-es, Date-fns y su c√≥digo o bibliotecas. </li><li>  UglifyJS est√° involucrado en la asamblea. </li><li>  M√≥dulos ES6 usados. </li><li>  Sin efectos secundarios. </li></ul><br>  Descubrimos c√≥mo reducir el peso del paquete y ahora vamos a ense√±arle a cargar solo la funcionalidad necesaria. <br><br><h3>  Solo cargamos la funcionalidad necesaria </h3><br>  Dividimos esta parte en dos.  En la primera parte, <b>solo se carga el c√≥digo que requiere el usuario</b> : si el usuario visita la p√°gina principal de su sitio, no carga las p√°ginas de la cuenta personal.  En el segundo, los <b>cambios en el c√≥digo conducen a la recarga de recursos m√°s peque√±a posible</b> . <br><br><h4>  Solo cargamos el c√≥digo necesario </h4><br>  Considere la estructura de una aplicaci√≥n imaginaria.  Tiene: <br><br><ul><li>  Punto de entrada - APP. </li><li>  Tres p√°ginas: inicio, b√∫squeda y tarjeta. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/872/142/14e/87214214e5fc6514a1a72cb20f6be4b2.png" alt="imagen"><br><br>  El primer problema que queremos resolver es <b>emitir un c√≥digo com√∫n</b> .  Denotemos el c√≥digo rojo como el c√≥digo com√∫n para todas las p√°ginas, el c√≠rculo verde para la p√°gina principal y la p√°gina de b√∫squeda.  Las cifras restantes no son particularmente importantes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/854/ec8/80f/854ec880feff7813d267ca834209db71.png" alt="imagen"><br><br>  Cuando el usuario realiza la b√∫squeda desde la p√°gina principal, volver√° a cargar el cuadro y el c√≠rculo por segunda vez, aunque ya los tiene.  Idealmente, nos gustar√≠a ver algo como esto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b75/290/36d/b7529036de4cf6923a279666d00ca297.png" alt="imagen"><br><br>  Es bueno que Webpack 4 ya tenga un complemento incorporado que lo haga por nosotros: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SplitChunksPlugin</a> .  El complemento extrae el c√≥digo de la aplicaci√≥n o el c√≥digo de los m√≥dulos de nodo, que es utilizado por varios fragmentos en un fragmento separado, al tiempo que garantiza que el fragmento con el c√≥digo com√∫n tendr√° m√°s de 30 Kb, y para cargar la p√°gina no necesita descargar m√°s de 5 fragmentos.  La estrategia es √≥ptima: cargar fragmentos demasiado peque√±os no es rentable, y cargar demasiados fragmentos es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=http://engineering.khanacademy.org/posts/js-packaging-">largo y no es tan eficiente</a> como descargar menos fragmentos incluso en http2.  Para repetir este comportamiento en 2 o 3 versiones de Webpack, tuve que escribir 20-30 l√≠neas con caracter√≠sticas no documentadas.  Ahora esto se est√° resolviendo en una l√≠nea. <br><br><h4>  Para llevar CSS </h4><br>  Ser√≠a genial si a√∫n elimin√°ramos el CSS para cada fragmento en un archivo separado.  Hay una soluci√≥n lista para esto: <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mini-Css-Extract-Plugin</a></b> .  El complemento apareci√≥ solo en Webpack 4, y antes no hab√≠a soluciones adecuadas para tal tarea: solo hacks, dolor y piernas cortadas.  El complemento <b>elimina CSS de fragmentos asincr√≥nicos</b> y fue creado <b>espec√≠ficamente para esta tarea</b> , que se realiza perfectamente. <br><br><h4>  Recarga de recursos m√≠nima posible </h4><br>  Descubriremos c√≥mo asegurarnos de que, al lanzar, por ejemplo, un nuevo bloque de promoci√≥n en la p√°gina principal, el usuario <b>vuelva a cargar la parte m√°s peque√±a posible del c√≥digo</b> . <br><br>  Si tuvi√©ramos versiones, todo estar√≠a bien.  Aqu√≠ tenemos la p√°gina principal de la versi√≥n N, y despu√©s del lanzamiento del bloque promocional - versi√≥n N + 1.  Webpack proporciona un mecanismo similar desde el primer momento utilizando hashing.  Despu√©s de que Webpack recopila todos los activos, en este caso app.js, calcular√° su hash de contenido y lo agregar√° al nombre del archivo para obtener la aplicaci√≥n. [Hash] .js.  Esta es la <b>versi√≥n</b> que necesitamos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd1/3f2/1a9/fd13f21a9daeddd3a1af9083b8134257.png" alt="imagen"><br><br>  Veamos c√≥mo funciona.  Active los hash, realice cambios en la p√°gina principal y vea si el c√≥digo de la p√°gina principal realmente ha cambiado. Veremos que dos archivos han cambiado: main y app.js. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a2/bc0/b44/2a2bc0b447b7baf927ac729e28ace633.png" alt="imagen"><br><br>  ¬øPor qu√© sucedi√≥ esto, porque es il√≥gico?  Para entender por qu√©, echemos un <b>vistazo a app.js.</b>  Consta de tres partes: <br><br><ul><li>  c√≥digo de aplicaci√≥n </li><li>  tiempo de ejecuci√≥n de paquete web; </li><li>  enlaces a fragmentos asincr√≥nicos. </li></ul><br>  Cuando cambiamos el c√≥digo en main, su contenido y hash cambian, lo que significa que el <b>enlace</b> tambi√©n cambia en la aplicaci√≥n.  La aplicaci√≥n en s√≠ tambi√©n cambiar√° y debe reiniciarse.  La soluci√≥n a este problema es <b>dividir</b> app.js en dos fragmentos: c√≥digo de aplicaci√≥n y tiempo de ejecuci√≥n de paquete web y enlaces a fragmentos asincr√≥nicos.  Webpack 4 hace todo por nosotros con una opci√≥n <b>runtimeChunk</b> , que pesa muy poco, menos de 2 KB en gzip.  Reiniciarlo para el usuario es pr√°cticamente in√∫til.  RuntimeChunk est√° habilitado con solo una opci√≥n: <br><br><pre> <code class="javascript hljs">optimization: { <span class="hljs-attr"><span class="hljs-attr">runtimeChunk</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre><br>  En Webpack 3 y 2, escribir√≠amos 5-6 l√≠neas, en lugar de una.  Esto no es mucho m√°s, pero sigue siendo un inconveniente innecesario. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6e4/125/5d8/6e41255d837ac2a5c4bb8a6e9b74f686.png" alt="imagen"><br><br>  ¬°Todo es genial, aprendimos a hacer enlaces y tiempo de ejecuci√≥n!  Vamos a escribir un nuevo m√≥dulo en main, liberarlo y - ¬°op!  - ahora, en general, todo se reinicia. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc7/8f6/a5f/cc78f6a5f6ffcd8b2da956d5463fefc8.png" alt="imagen"><br><br>  Por qu√©  Veamos c√≥mo funcionan los m√≥dulos en webpack. <br><br><h4>  M√≥dulos de paquete web </h4><br>  Supongamos que hay un c√≥digo en el que agrega los m√≥dulos <b>a</b> , <b>b</b> , <b>d</b> y <b>e</b> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'b'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> d <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'d'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'e'</span></span>;</code> </pre><br>  Webpack convierte las importaciones a require: <b>a</b> , <b>b</b> , <b>dye</b> <b>se</b> reemplazan por require (0), require (1), require (2) y require (3). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>);</code> </pre><br>  Imagine una imagen que ocurre con mucha frecuencia: escribe un nuevo m√≥dulo c <code>import c from 'c';</code>  y pegarlo en alg√∫n lugar en el medio: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'b'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'c'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> d <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'d'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'e'</span></span>;</code> </pre><br>  Cuando Webpack procesa todo, convierte la importaci√≥n del nuevo m√≥dulo en require (2): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>);</code> </pre><br>  Los m√≥dulos <b>dye</b> , que eran 2 y 3, recibir√°n los n√∫meros 3 y 4, la nueva identificaci√≥n.  De esto se deduce una conclusi√≥n simple: usar n√∫meros de serie como id es un poco tonto, pero Webpack lo hace. <br><br><blockquote>  No use el n√∫mero de serie como identificaci√≥n √∫nica </blockquote><br>  Para solucionar el problema, hay una soluci√≥n <b>Webpack incorporada</b> : <b>HashedModuleIdsPlugin</b> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.HashedModuleIdsPlugin({ <span class="hljs-attr"><span class="hljs-attr">hashFunction</span></span>: <span class="hljs-string"><span class="hljs-string">'md4‚Ä≤, hashDigest:'</span></span>base64‚Ä≤, <span class="hljs-attr"><span class="hljs-attr">hashDigestLength</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, }),</code> </pre><br>  Este complemento utiliza 4 caracteres de <b>hash md4 en</b> lugar de la identificaci√≥n digital de la ruta absoluta al archivo.  Con √©l, nuestro requerimiento se convertir√° en estos: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'YmRl'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'N2Fl'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'OWE4‚Ä≤); var d = require('</span></span>NWQz<span class="hljs-string"><span class="hljs-string">'); var e = require('</span></span>YWVj<span class="hljs-string"><span class="hljs-string">');</span></span></code> </pre><br>  En lugar de n√∫meros, aparecieron letras.  Por supuesto, hay un problema oculto: esta es una <b>colisi√≥n de hashes</b> .  Nos topamos con √©l una vez y podemos aconsejarle que use 8 caracteres en lugar de 4. Una vez configurados los hashes correctamente, todo funcionar√° de la manera que originalmente quer√≠amos. <br><br>  Ahora sabemos c√≥mo recolectar paquetes de sue√±os. <br><br><ul><li>  <b>Minify</b> </li><li>  <b>Usar divisi√≥n de c√≥digo</b> . </li><li>  <b>Configurar hashes</b> . </li></ul><br>  Aprendimos a recolectar, y ahora trabajaremos en velocidad. <br><br><h2>  ¬øC√≥mo armar un paquete de sue√±os <b>r√°pidamente</b> ? </h2><br>  En nuestro N1.RU, la aplicaci√≥n m√°s grande consta de 10,000 m√≥dulos, y sin optimizaciones, toma 28 minutos.  ¬°Pudimos acelerar el montaje a dos minutos!  ¬øC√≥mo hicimos eso?  Hay 3 formas de acelerar cualquier c√°lculo, y las tres son aplicables a Webpack. <br><br><h3>  Paralelizaci√≥n de ensamblajes </h3><br>  Lo primero que hicimos fue <b>paralelizar la asamblea</b> .  Para esto tenemos: <br><br><ul><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HappyPackPlugin</a></b> , que envuelve sus cargadores en otros cargadores, y toma todos los c√°lculos que se envuelven en procesos separados.  Esto permite, por ejemplo, paralelizar Babel y node-sass. </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cargador de hilos</a></b> .  Realiza aproximadamente lo mismo que HappyPackPlugin, solo usa no procesos, sino grupo de subprocesos.  Cambiar a un hilo separado es una operaci√≥n costosa, √∫sela con cuidado y solo si desea envolver operaciones pesadas y que requieren muchos recursos, como babel o node-sass.  Para cargar json, por ejemplo, no es necesaria la paralelizaci√≥n, ya que se carga r√°pidamente. </li><li>  Es muy probable que los complementos y cargadores que usa ya tengan <b>herramientas de paralelizaci√≥n integradas,</b> solo tiene que buscar.  Por ejemplo, esta opci√≥n est√° en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">UglifyJS</a> . </li></ul><br><h3>  Resultados de compilaci√≥n de cach√© </h3><br>  <b>El almacenamiento en cach√© de los resultados del ensamblaje</b> es la forma m√°s eficiente de acelerar el ensamblaje de Webpack. <br><br>  La primera soluci√≥n que tenemos es <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el cargador de cach√©</a></b> .  Este es un cargador que se introduce en una cadena de cargadores y guarda el resultado de crear un archivo espec√≠fico para una cadena espec√≠fica de cargadores en el sistema de archivos.  En el siguiente ensamblaje del paquete, si este archivo est√° en el sistema de archivos y ya se ha procesado con esta cadena, el cargador de cach√© tomar√° los resultados y no llamar√° a los cargadores que est√°n detr√°s de ellos, por ejemplo, Babel-loader o node-sass. <br><br>  El gr√°fico muestra el tiempo de montaje.  Barra azul: 100% de tiempo de compilaci√≥n, sin cargador de cach√©, y con ella: 7% m√°s lento.  Esto se debe a que el cargador de cach√© pasa m√°s tiempo guardando cach√©s en el sistema de archivos.  Ya en la segunda asamblea, recibimos una ganancia tangible: la asamblea fue 2 veces m√°s r√°pida. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bc/e73/210/6bce732104fda8263464528d91d1a8a1.png" alt="imagen"><br><br>  La segunda soluci√≥n es m√°s <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sofisticada</a></b> : <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HardSourcePlugin</a></b> .  La principal diferencia: el cargador de cach√© es solo un cargador que puede operar solo en una cadena de cargadores con c√≥digo o archivos, y HardSourcePlugin tiene acceso casi completo al ecosistema Webpack, puede operar con otros complementos y cargadores, y extiende el ecosistema para el almacenamiento en cach√© un poco.  El gr√°fico anterior muestra que en el primer lanzamiento, el tiempo de construcci√≥n aument√≥ en un 37%, pero en el segundo lanzamiento con todos los cach√©s, aceleramos 5 veces. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb6/acf/d36/cb6acfd36adbaaadffd68af19889f960.png" alt="imagen"><br><br>  La mejor parte es que puedes usar ambas soluciones juntas, que es lo que hacemos en N1.RU.  Tenga cuidado, porque hay problemas con los cach√©s, de los que hablar√© m√°s adelante. <br><br>  Los complementos / cargadores que ya usa pueden tener <b>mecanismos de almacenamiento en cach√© integrados</b> .  Por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">babel-loader tiene un</a> sistema de almacenamiento en cach√© muy eficiente, pero por alguna raz√≥n est√° desactivado de forma predeterminada.  La misma funcionalidad se encuentra en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">incre√≠ble cargador de script de tipo</a> .  El complemento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">UglifyJS</a> tambi√©n tiene almacenamiento en cach√©, que funciona muy bien.  Nos aceler√≥ por varios minutos. <br><br>  Y ahora los problemas. <br><br><h4>  Problemas de almacenamiento en cach√© </h4><br><ul><li>  Es posible que el cach√© <b>no se valide correctamente</b> . </li><li>  Las soluciones aplicadas pueden <b>no funcionar con complementos conectados, cargadores, su c√≥digo o entre s√≠</b> .  En este sentido, el cargador de cach√© es una soluci√≥n simple y sin problemas.  Pero con HardSourcePlugin debes ser m√°s cuidadoso. </li><li>  <b>Es dif√≠cil debutar si todo est√° roto</b> .  Cuando el almacenamiento en cach√© no funciona correctamente y se produce un error incomprensible, ser√° muy dif√≠cil descubrir cu√°l es el problema. </li></ul><br><h3>  ¬øC√≥mo ahorrar en producci√≥n? </h3><br>  La √∫ltima forma de acelerar un proceso es no hacer ninguna parte del proceso.  Pensemos en c√≥mo puede ahorrar en producci√≥n.  ¬øQu√© no podemos hacer?  La respuesta es breve: ¬° <b>no podemos hacer nada</b> !  No tenemos derecho a rechazar algo en producci√≥n, pero podemos ahorrar mucho en desarrollo. <br><br>  En qu√© ahorrar: <br><br><ul><li>  <b>No recopile el mapa fuente</b> hasta que los necesitemos. </li><li>  <b>Utilice el cargador de estilo en</b> lugar de un esquema genial con eliminaci√≥n y procesamiento de CSS a trav√©s de cargadores de CSS.  El cargador de estilo en s√≠ mismo es muy r√°pido, porque toma la l√≠nea css y la inserta en una funci√≥n que inserta esa l√≠nea en la etiqueta de estilo. </li><li>  <b>Puede dejar en la lista del navegador solo el navegador que usa espec√≠ficamente; lo m√°s probable es que este sea el √∫ltimo Chrome</b> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Esto se acelerar√° mucho</a> . </li><li>  <b>Abandone completamente cualquier optimizaci√≥n de recursos</b> : desde UglifyJS, css-nano, gzip / brotli. </li></ul><br><blockquote>  La aceleraci√≥n de compilaci√≥n es paralelizaci√≥n, almacenamiento en cach√© y rechazo de c√°lculos.  Siguiendo estos tres simples pasos, puede acelerar mucho. </blockquote><br><h2>  ¬øC√≥mo configurar webpack? </h2><br>  Descubrimos c√≥mo ensamblar un paquete de sue√±os y c√≥mo ensamblarlo r√°pidamente, y ahora descubriremos c√≥mo configurar Webpack para que no nos peguemos un tiro en la pierna cada vez que cambie la configuraci√≥n. <br><br><h3>  Evoluci√≥n de la configuraci√≥n en el proyecto. </h3><br>  Una ruta t√≠pica de webpack-config en un proyecto comienza con una configuraci√≥n <b>simple</b> .  Al principio solo inserta Webpack, Babel-loader, sass-loader y todo est√° bien.  Luego, inesperadamente, aparecen algunas <b>condiciones en process.env</b> e inserta las condiciones.  Uno, segundo, tercero, m√°s y m√°s, hasta que se agregue una condici√≥n con una opci√≥n "m√°gica".  Entiende que todo ya est√° bastante mal, y es mejor simplemente <b>duplicar las configuraciones</b> para desarrollo y producci√≥n, y hacer correcciones dos veces.  Todo ser√° m√°s claro.  Si tuvo un pensamiento: "¬øHay algo mal aqu√≠?", Entonces el √∫nico consejo pr√°ctico es <b>mantener la configuraci√≥n en orden</b> .  Te dir√© c√≥mo lo hacemos. <br><br><h3>  Mantenga la configuraci√≥n en orden </h3><br>  Usamos el paquete <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">webpack-merge</a></b> .  Este es un paquete npm creado para combinar varias configuraciones en una sola.  Si no se siente c√≥modo con la estrategia de fusi√≥n predeterminada, puede personalizarla. <br><br><h3>     </h3><br>    4  : <br><br><ul><li> Loaders. </li><li> Plugins. </li><li> Presets. </li><li> Parts. </li></ul><br>    . <br><br><h4> Plugin/Loader </h4><br>  ,        ,       API,  ,      . <br><br>  Se parece a esto: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  JSdoc * @param {Object} options * @see    */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createPlugin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Plugin(options); };</code> </pre><br>  ,   ,   ,   .    ,       url-loader  : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * url-loader    file-loader.        * * @example * -   some-image.png.     url-loader,  url-loader    * 1.    ,  url-loader    base64  * 2. , url-loader    outputPath + name     ,     . *    some-image.png,     outputPath/images/some-image.12345678hash.png,  url-loader  * publicPath/images/some-image.12345678hash.png * * @param {string} prefix    * @param {number} limit    ,    * @return {Object} loader   * @see https://www.npmjs.com/package/url-loader */</span></span></code> </pre><br>     ,   ,  , ,    ,   ,     .  ,  ,   ,  ,   url-loader.    : <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">urlLoader</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prefix = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'assets'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, limit = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100</span></span></span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'url-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { limit, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${prefix}</span></span></span><span class="hljs-string">/[name].[hash].[ext]`</span></span> } }; };</code> </pre><br>         .    ,   Loader         . <br><br><h4> Preset </h4><br>    webpack.     ,      ,    ,   webpack,    .    ‚Äî  ,  ,    scss-: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.scss$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [cssLoader, postCssLoader, scssLoader] }</code> </pre><br>     . <br><br><h4> Part </h4><br>  ‚Äî  ,      .        ,       ,   .  ,       : <br><br><pre> <code class="javascript hljs">entry: { <span class="hljs-attr"><span class="hljs-attr">app</span></span>: <span class="hljs-string"><span class="hljs-string">'./src/Frontend/app.js'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'/static/cabinet/app/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">path</span></span>: path.resolve(<span class="hljs-string"><span class="hljs-string">'www/static/app'</span></span>) },</code> </pre><br>     : <br><br><ul><li> <b> </b> ,   ,   , json,     , , splitChunks. </li><li> <b>  dev</b> ,  ,    js/css     </li><li> <b>Part</b> ,   output, publicPath, entry-point    , ,    source map. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/7ee/20f/fa6/7ee20ffa6f453c35f11d92e3583d8caf.png" alt="imagen"><br><br> <b>Webpack-merge</b>     .          ,     .  webpack-merge     3-7 ,    Babel-loader,            .    ,   . <br><br><h3>   </h3><br>  Para resumir. <b>  </b> ,    . <b> </b> ,   webpack       ‚Äî     . <b>  </b> ,  . <br><br>   ,    ! <br><br><blockquote>   ‚Äî     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Frontend Conf</a> . ,    ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> ,           ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Frontend Conf ++</a>  . <br><br>    -      ?    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">FrontenConf ++</a> ,   27  28   . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>  27 ,   15          .     ‚Äî ! </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433324/">https://habr.com/ru/post/es433324/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433308/index.html">Transferencia de la configuraci√≥n de PBX al servicio 3CX PBX Express</a></li>
<li><a href="../es433316/index.html">Resumen del dise√±o: incorporaci√≥n, retroalimentaci√≥n, b√∫squeda de ideas y toma de decisiones.</a></li>
<li><a href="../es433318/index.html">garbage.collect ()</a></li>
<li><a href="../es433320/index.html">Dise√±o de cuadr√≠cula como base de dise√±os modernos</a></li>
<li><a href="../es433322/index.html">API JSON: trabajamos de acuerdo con las especificaciones</a></li>
<li><a href="../es433326/index.html">Calidad del c√≥digo</a></li>
<li><a href="../es433328/index.html">Mejor perder un d√≠a</a></li>
<li><a href="../es433330/index.html">Resuelve crucigramas japoneses con SAT Solver</a></li>
<li><a href="../es433332/index.html">Soporte de Python en Azure Functions</a></li>
<li><a href="../es433334/index.html">Comportamientos XAML para WPF ahora es de c√≥digo abierto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>