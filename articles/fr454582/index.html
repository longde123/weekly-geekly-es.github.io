<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöº ‚ÜïÔ∏è üôÖüèª La longueur du tableau doit-elle √™tre stock√©e dans une variable locale en C #? üç¶ üöµüèø ‚ô•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je remarque que les gens utilisent souvent des constructions comme celle-ci: 



var length = array.Length; for (int i = 0; i < length; i++) { //do sm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La longueur du tableau doit-elle √™tre stock√©e dans une variable locale en C #?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454582/">  Je remarque que les gens utilisent souvent des constructions comme celle-ci: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = array.Length; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) {    <span class="hljs-comment"><span class="hljs-comment">//do smth }</span></span></code> </pre> <br>  Ils pensent qu'avoir un appel √† Array.Length √† chaque it√©ration fera que CLR prendra plus de temps pour ex√©cuter le code.  Pour l'√©viter, ils stockent la valeur de longueur dans une variable locale. <br>  Voyons (une fois pour toutes!) Si c'est une chose viable ou utiliser une variable temporaire est une perte de temps. <br><a name="habracut"></a><br>  Pour commencer, examinons ces m√©thodes C #: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithoutVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; array.Length; i++) {       sum += array[i];   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = array.Length;   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) {       sum += array[i];   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; }</code> </pre> <br>  Voici √† quoi il ressemble apr√®s avoir √©t√© trait√© par le compilateur JIT (pour .NET Framework 4.7.2 sous LegacyJIT-x86): <br><div class="scrollable-table"><table><tbody><tr><td>  SansVariable () <br>  <font color="#666666">; int sum = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#46aa03">edi</font> <br>  <font color="#666666">; int i = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#666666">; int [] localRefToArray = this.array;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int arrayLength = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; if (arrayLength == 0) renvoie la somme;</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#46aa03">ecx</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#666666">; int arrayLength2 = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; if (i&gt; = arrayLength2)</font> <br>  <font color="#666666">;</font>  <font color="#666666">lever une nouvelle IndexOutOfRangeException ();</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  <font color="#00007f">jae</font> 056e2d31 <br>  <font color="#666666">; sum + = localRefToArray [i];</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#46aa03">esi</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  <font color="#666666">; i ++;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">esi</font> <br>  <font color="#666666">; if (i &lt;arrayLength) goto loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jg</font> <br>  <font color="#666666">; somme de retour;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">edi</font> </td><td>  WithVariable () <br>  <font color="#666666">; int sum = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#666666">; int [] localRefToArray = this.array;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int arrayLength = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int i = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  <font color="#666666">; if (arrayLength == 0) renvoie la somme;</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">edi</font> <font color="#46aa03">edi</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#666666">; int arrayLength2 = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; if (i&gt; = arrayLength2)</font> <br>  <font color="#666666">;</font>  <font color="#666666">lever une nouvelle IndexOutOfRangeException ();</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">ecx</font> <br>  <font color="#00007f">jae</font> 05902d31 <br>  <font color="#666666">; sum + = localRefToArray [i];</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#46aa03">eax</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  <font color="#666666">; i ++;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">eax</font> <br>  <font color="#666666">; if (i &lt;arrayLength) goto loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">eax</font> <font color="#46aa03">edi</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jl</font> <br>  <font color="#666666">; somme de retour;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> </td></tr></tbody></table></div><br><div class="spoiler">  <b class="spoiler_title">Comparaison √† Meld:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gc/4s/mi/gc4smi2gsptfuyqiuwyizrv2q80.png"><br></div></div><br>  Il est trivial de remarquer qu'ils ont exactement le m√™me nombre d'instructions assembleur - 15. M√™me la logique de ces instructions est presque la m√™me.  Il y a une l√©g√®re diff√©rence dans l'ordre d'initialisation des variables et des comparaisons sur la poursuite du cycle.  On peut noter que dans les deux cas la longueur du tableau est enregistr√©e deux fois avant le cycle: <br><br><ul><li>  Pour v√©rifier 0 (arrayLength) <br></li><li>  Dans la variable temporaire pour v√©rifier la condition du cycle (arrayLength2). <br></li></ul><br>  Il s'av√®re que les deux m√©thodes se compileront dans le m√™me code exact, mais la premi√®re est √©crite plus rapidement, m√™me s'il n'y a aucun avantage en termes de temps d'ex√©cution. <br>  Le code assembleur ci-dessus m'a amen√© √† quelques r√©flexions et j'ai d√©cid√© de v√©rifier quelques m√©thodes suppl√©mentaires: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithoutVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; array.Length; i++) {       sum += array[i] + array.Length;   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = array.Length;   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) {       sum += array[i] + length;   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; }</code> </pre> <br>  L'√©l√©ment actuel et la longueur du tableau sont ajout√©s, mais dans le premier cas, la longueur du tableau est demand√©e √† chaque fois, et dans le second cas, elle est enregistr√©e une fois dans une variable locale.  Regardons le code assembleur de ces m√©thodes: <br><div class="scrollable-table"><table><tbody><tr><td>  SansVariable () <br>  <font color="#00007f">int</font> sum = <font color="#ff0000">0</font> <font color="#666666">;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#46aa03">edi</font> <br>  <font color="#00007f">int</font> i = <font color="#ff0000">0</font> <font color="#666666">;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#00007f">int</font> <font color="#009900">[</font> <font color="#009900">]</font> localRefToArray = this <font color="#339933">.</font>  tableau <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#00007f">int</font> arrayLength = localRefToArray <font color="#339933">.</font>  Longueur <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ebx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  if <font color="#009900">(</font> arrayLength == <font color="#ff0000">0</font> <font color="#009900">)</font> renvoie la somme <font color="#666666">;</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">ebx</font> <font color="#339933">,</font> <font color="#46aa03">ebx</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#00007f">int</font> arrayLength2 = localRefToArray <font color="#339933">.</font>  Longueur <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  if <font color="#009900">(</font> i&gt; = arrayLength2 <font color="#009900">)</font> <br>  lever une nouvelle IndexOutOfRangeException <font color="#009900">(</font> <font color="#009900">)</font> <font color="#666666">;</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">esi</font> <font color="#46aa03">ecx</font> <br>  <font color="#00007f">jae</font> 05562d39 <br>  <font color="#00007f">int</font> t = tableau <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#46aa03">esi</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  t <font color="#339933">+</font> = somme <font color="#666666">;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">edi</font> <br>  t <font color="#339933">+</font> = arrayLength <font color="#666666">;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">ebx</font> <br>  somme = t <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  i <font color="#339933">++</font> <font color="#666666">;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">esi</font> <br>  si <font color="#009900">(</font> i &lt;arrayLength <font color="#009900">)</font> goto <font color="#00007f">loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">ebx</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jg</font> <br>  somme de retour <font color="#666666">;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">edi</font> <br></td><td>  WithVariable () <br>  <font color="#00007f">int</font> sum = <font color="#ff0000">0</font> <font color="#666666">;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#00007f">int</font> <font color="#009900">[</font> <font color="#009900">]</font> localRefToArray = this <font color="#339933">.</font>  tableau <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#00007f">int</font> arrayLength = localRefToArray <font color="#339933">.</font>  Longueur <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ebx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#00007f">int</font> i = <font color="#ff0000">0</font> <font color="#666666">;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#46aa03">ecx</font> <br>  if <font color="#009900">(</font> arrayLength == <font color="#ff0000">0</font> <font color="#009900">)</font> <font color="#009900">(</font> return sum <font color="#666666">;)</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">ebx</font> <font color="#339933">,</font> <font color="#46aa03">ebx</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#00007f">int</font> arrayLength2 = localRefToArray <font color="#339933">.</font>  Longueur <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  if <font color="#009900">(</font> i&gt; = arrayLength2 <font color="#009900">)</font> <br>  lever une nouvelle IndexOutOfRangeException <font color="#009900">(</font> <font color="#009900">)</font> <font color="#666666">;</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">ecx</font> <font color="#46aa03">edi</font> <br>  <font color="#00007f">jae</font> 04b12d39 <br>  <font color="#00007f">int</font> t = tableau <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#46aa03">ecx</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  t <font color="#339933">+</font> = somme <font color="#666666">;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  t <font color="#339933">+</font> = arrayLength <font color="#666666">;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">ebx</font> <br>  somme = t <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  i <font color="#339933">++</font> <font color="#666666">;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">ecx</font> <br>  si <font color="#009900">(</font> i &lt;arrayLength <font color="#009900">)</font> goto <font color="#00007f">loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#46aa03">ebx</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jl</font> <br>  somme de retour <font color="#666666">;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br></td></tr></tbody></table></div><br><div class="spoiler">  <b class="spoiler_title">Comparaison √† Meld:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/co/8z/ix/co8zixjrk_p7fexmgmyhs1xfqqa.png"><br></div></div><br>  Encore une fois, le nombre d'instructions est le m√™me, ainsi que (presque) les instructions elles-m√™mes.  La seule diff√©rence est l'ordre d'initialisation des variables et la condition de contr√¥le pour la poursuite du cycle.  Vous pouvez noter que dans le calcul de la somme, seule la premi√®re longueur du tableau est prise en compte.  Il est √©vident que ceci: <br><blockquote>  <font color="#00007f">int</font> arrayLength2 = localRefToArray <font color="#339933">.</font>  Longueur <font color="#666666">;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  si <font color="#009900">(</font> i&gt; = arrayLength2 <font color="#009900">),</font> lancez new IndexOutOfRangeException <font color="#009900">(</font> <font color="#009900">)</font> <font color="#666666">;</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">ecx</font> <font color="#46aa03">edi</font> <br>  <font color="#00007f">jae</font> 04b12d39 </blockquote><br>  dans les quatre m√©thodes est une v√©rification des limites du tableau en ligne et elle est ex√©cut√©e pour chaque √©l√©ment du tableau. <br><br>  Nous pouvons d√©j√† faire la premi√®re conclusion: utiliser une variable suppl√©mentaire pour essayer d'acc√©l√©rer le cycle est une perte de temps, car le compilateur le fera quand m√™me pour vous.  La seule raison de stocker un tableau de longueur dans une variable est de rendre le code plus lisible. <br><br>  <i>ForEach</i> est une autre situation enti√®rement.  Consid√©rez les trois m√©thodes suivantes: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachWithoutLength</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) {       sum += i;   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachWithLengthWithoutLocalVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) {       sum += i + array.Length;   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachWithLengthWithLocalVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = array.Length;   <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) {       sum += i + length;   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum; }</code> </pre> <br>  Et voici le code apr√®s JIT: <br><br><div class="spoiler">  <b class="spoiler_title">ForEachWithoutLength ()</b> <div class="spoiler_text">  <font color="#666666">; int sum = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#666666">; int [] localRefToArray = this.array;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int i = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#46aa03">edx</font> <br>  <font color="#666666">; int arrayLength = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; if (arrayLength == 0) goto exit;</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">edi</font> <font color="#46aa03">edi</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#666666">; int t = tableau [i];</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#46aa03">edx</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  <font color="#666666">; somme + = i;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  <font color="#666666">; i ++;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">edx</font> <br>  <font color="#666666">; if (i &lt;arrayLength) goto loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">edi</font> <font color="#46aa03">edx</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jg</font> <br>  <font color="#666666">; somme de retour;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> </div></div><br><div class="spoiler">  <b class="spoiler_title">ForEachWithLengthWithoutLocalVariable ()</b> <div class="spoiler_text">  <font color="#666666">; int sum = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#666666">; int [] localRefToArray = this.array;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int i = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#46aa03">edx</font> <br>  <font color="#666666">; int arrayLength = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; if (arrayLength == 0) goto exit</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">edi</font> <font color="#46aa03">edi</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#666666">; int t = tableau [i];</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#46aa03">edx</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  <font color="#666666">; somme + = i;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  <font color="#666666">; sum + = localRefToArray.Length;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; i ++;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">edx</font> <br>  <font color="#666666">; if (i &lt;arrayLength) goto loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">edi</font> <font color="#46aa03">edx</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jg</font> <br>  <font color="#666666">; somme de retour;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> </div></div><br><div class="spoiler">  <b class="spoiler_title">ForEachWithLengthWithLocalVariable ()</b> <div class="spoiler_text">  <font color="#666666">; int sum = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> <br>  <font color="#666666">; int [] localRefToArray = this.array;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">ecx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int length = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">ebx</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; int i = 0;</font> <br>  <font color="#00007f">xor</font> <font color="#46aa03">ecx</font> <font color="#339933">,</font> <font color="#46aa03">ecx</font> <br>  <font color="#666666">; int arrayLength = localRefToArray.Length;</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">edi</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#ff0000">4</font> <font color="#009900">]</font> <br>  <font color="#666666">; if (arrayLength == 0) goto exit;</font> <br>  <font color="#00007f">test</font> <font color="#46aa03">edi</font> <font color="#46aa03">edi</font> <br>  sortie <font color="#00007f">jle</font> <br>  <font color="#666666">; int t = tableau [i];</font> <br>  <font color="#00007f">boucle</font> <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#0000ff">dword</font> ptr <font color="#009900">[</font> <font color="#46aa03">edx</font> <font color="#339933">+</font> <font color="#46aa03">ecx</font> <font color="#339933">*</font> <font color="#ff0000">4</font> <font color="#339933">+</font> <font color="#ff0000">8</font> <font color="#009900">]</font> <br>  <font color="#666666">; somme + = i;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">eax</font> <br>  <font color="#666666">; somme + = longueur;</font> <br>  <font color="#00007f">ajouter</font> <font color="#46aa03">esi</font> <font color="#339933">,</font> <font color="#46aa03">ebx</font> <br>  <font color="#666666">; i ++;</font> <br>  <font color="#00007f">inc</font> <font color="#46aa03">ecx</font> <br>  <font color="#666666">; if (i &lt;arrayLength) goto loop</font> <br>  <font color="#00007f">cmp</font> <font color="#46aa03">edi</font> <font color="#46aa03">ecx</font> <br>  <font color="#00007f">boucle</font> <font color="#00007f">jg</font> <br>  <font color="#666666">; somme de retour;</font> <br>  sortie <font color="#339933">:</font> <br>  <font color="#00007f">mov</font> <font color="#46aa03">eax</font> <font color="#339933">,</font> <font color="#46aa03">esi</font> </div></div><br>  La premi√®re chose qui me vient √† l'esprit est qu'il faut moins d'instructions d'assembleur que <i>pour le</i> cycle (par exemple, pour la sommation d'√©l√©ments simples, il a fallu 12 instructions pour <i>foreach</i> , mais 15 pour <i>for</i> ). <br><div class="spoiler">  <b class="spoiler_title">Comparaison</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mw/ga/qy/mwgaqykzztnhwmztdcg4ns5thwa.png"><br></div></div><br>  Dans l'ensemble, voici les r√©sultats du <i>test de</i> r√©f√©rence <i>vs vs foreach</i> pour les matrices √† 1 million d'√©l√©ments: <br><pre> <code class="cs hljs">sum+=array[i];</code> </pre><div class="scrollable-table"><table><tbody><tr><td>  La m√©thode <br></td><td>  ItemsCount <br></td><td>  Moyenne <br></td><td>  Erreur <br></td><td>  Stddev <br></td><td>  M√©diane <br></td><td>  Ratio <br></td><td>  RatioSD <br></td></tr><tr><td>  Foreach <br></td><td>  1 000 000 <br></td><td>  1,401 ms <br></td><td>  0,2691 ms <br></td><td>  0,7935 ms <br></td><td>  1,694 ms <br></td><td>  1,00 <br></td><td>  0,00 <br></td></tr><tr><td>  Pour <br></td><td>  1 000 000 <br></td><td>  1,586 ms <br></td><td>  0,3204 ms <br></td><td>  0,9447 ms <br></td><td>  1,740 ms <br></td><td>  1,23 <br></td><td>  0,65 <br></td></tr></tbody></table></div>  Et pour <br><pre> <code class="cs hljs">sum+=array[i] + array.Length;</code> </pre><div class="scrollable-table"><table><tbody><tr><td>  La m√©thode <br></td><td>  ItemsCount <br></td><td>  Moyenne <br></td><td>  Erreur <br></td><td>  Stddev <br></td><td>  M√©diane <br></td><td>  Ratio <br></td><td>  RatioSD <br></td></tr><tr><td>  Foreach <br></td><td>  1 000 000 <br></td><td>  1,703 ms <br></td><td>  0,3010 ms <br></td><td>  0,8874 ms <br></td><td>  1,726 ms <br></td><td>  1,00 <br></td><td>  0,00 <br></td></tr><tr><td>  Pour <br></td><td>  1 000 000 <br></td><td>  1,715 ms <br></td><td>  0,2859 ms <br></td><td>  0,8430 ms <br></td><td>  1,956 ms <br></td><td>  1.13 <br></td><td>  0,56 <br></td></tr></tbody></table></div><br>  <i>ForEach</i> parcourt le tableau beaucoup plus rapidement que <i>pour</i> .  Pourquoi?  Pour le savoir, nous devons comparer le code apr√®s JIT: <br><br><div class="spoiler">  <b class="spoiler_title">Comparaison des trois options foreach</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ae/wx/5s/aewx5szyufp55plv9zsq2wznplq.png"><br></div></div><br>  Regardons ForEachWithoutLength.  La longueur du tableau n'est demand√©e qu'une seule fois et il n'y a aucune v√©rification des limites du tableau.  Cela se produit car le cycle ForEach restreint d'abord la modification de la collection √† l'int√©rieur du cycle, et le second ne sortira jamais de la collection.  Pour cette raison, JIT peut se permettre de supprimer les limites du tableau de contr√¥le. <br><br>  Examinons maintenant attentivement ForEachWithLengthWIthoutLocalVariable.  Il n'y a qu'une seule partie √©trange, o√π la somme + + longueur arrive non pas √† la longueur de tableau de variables locales pr√©c√©demment enregistr√©e, mais √† une nouvelle que l'application demande √† la m√©moire √† chaque fois.  Cela signifie qu'il y aura N + 1 demandes de m√©moire pour la longueur du tableau, o√π N est une longueur du tableau. <br><br>  Et maintenant, nous arrivons √† ForEachWithLengthWithLocalVariable.  Le code y est exactement le m√™me que dans l'exemple pr√©c√©dent, √† l'exception de la gestion de la longueur du tableau.  Le compilateur a de nouveau g√©n√©r√© une variable locale arrayLength qui est utilis√©e pour v√©rifier si le tableau est vide, mais le compilateur a quand m√™me honn√™tement enregistr√© notre longueur de variable locale indiqu√©e, et c'est ce qui est utilis√© dans la somme √† l'int√©rieur du cycle.  Il s'av√®re que cette m√©thode ne demande la longueur du tableau √† la m√©moire que deux fois.  La diff√©rence est tr√®s difficile √† remarquer dans le monde r√©el. <br><br>  Dans tous les cas, le code assembleur s'est av√©r√© si simple car les m√©thodes elles-m√™mes sont simples.  Si les m√©thodes avaient plus de param√®tres, cela devrait fonctionner avec la pile, les variables pourraient obtenir des magasins en dehors des registres, il y aurait eu plus de v√©rifications, mais la logique principale resterait la m√™me: l'introduction d'une variable locale pour la longueur du tableau n'est que utile pour rendre le code plus lisible.  Il s'est √©galement av√©r√© que <i>Foreach</i> parcourt souvent le r√©seau plus rapidement que <i>For</i> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454582/">https://habr.com/ru/post/fr454582/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454568/index.html">Mozilla a qualifi√© la ¬´mauvaise¬ª distribution de packages Web sign√©e num√©riquement par Google</a></li>
<li><a href="../fr454570/index.html">Recr√©er un ancien jeu DOS en C ++ 17</a></li>
<li><a href="../fr454574/index.html">Apprentissage automatique en microfinance: construire un mod√®le de notation pour les clients avec un historique de cr√©dit vide</a></li>
<li><a href="../fr454576/index.html">Les auteurs de GandCrab cessent de travailler: ils pr√©tendent en avoir assez vol√©</a></li>
<li><a href="../fr454578/index.html">Comment connecter la galerie PhotoSwipe dans la vue Web Android</a></li>
<li><a href="../fr454584/index.html">√âcole de d√©veloppement d'interface: analyse des t√¢ches pour Minsk et un nouvel ensemble √† Moscou</a></li>
<li><a href="../fr454586/index.html">R√©solution de mots crois√©s japonais avec PÃ∂yÃ∂tÃ∂hÃ∂oÃ∂Ã∂nÃ∂ Rust et WebAssembly</a></li>
<li><a href="../fr454588/index.html">Gazprom Neft vous invite √† visiter: GPN Data Science Meetup</a></li>
<li><a href="../fr454590/index.html">Zimbra Collaboration Suite et Mobile Control avec ABQ</a></li>
<li><a href="../fr454592/index.html">WAF √† travers les yeux des pirates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>