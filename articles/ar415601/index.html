<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¶ â™‰ï¸ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ¾ Ù…Ø¬Ù…ÙˆØ¹Ø© Kubernetes HA Ù…Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. Ø£Ù… Ø£Ù† Ù‡Ù†Ø§Ùƒ Ø­ÙŠØ§Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ø§Ù…Ù„ Ù…ÙŠÙ†Ø§Ø¡ØŸ ğŸ² ğŸš‚ ğŸ‘©ğŸ¾â€ğŸš’</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ù†Ø´Ø± kubernetes HA Ù…Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ© 



 Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ± Ø¹Ø²ÙŠØ²ÙŠ Ù‡Ø¨Ø±! ÙÙŠ 24 Ù…Ø§ÙŠÙˆ 2018 ØŒ ØªÙ… Ù†Ø´Ø± Ù…Ù‚Ø§Ù„ Ø¨Ø¹Ù†ÙˆØ§Ù† Kubernetes Containerd Integration Goes GA Ø¹Ù„Ù‰ Ù…Ø¯ÙˆÙ†Ø© Kuber...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ù…Ø¬Ù…ÙˆØ¹Ø© Kubernetes HA Ù…Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ©. Ø£Ù… Ø£Ù† Ù‡Ù†Ø§Ùƒ Ø­ÙŠØ§Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ø§Ù…Ù„ Ù…ÙŠÙ†Ø§Ø¡ØŸ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415601/" style=";text-align:right;direction:rtl"><h1 id="razvertyvaenie-kubernetes-ha-s-containerd" style=";text-align:right;direction:rtl">  Ù†Ø´Ø± kubernetes HA Ù…Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ© </h1><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/0p/w3/7g/0pw37gyankmz9a8s2gcshvto_ek.png"><br>  Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ± Ø¹Ø²ÙŠØ²ÙŠ Ù‡Ø¨Ø±!  ÙÙŠ 24 Ù…Ø§ÙŠÙˆ 2018 ØŒ ØªÙ… Ù†Ø´Ø± Ù…Ù‚Ø§Ù„ Ø¨Ø¹Ù†ÙˆØ§Ù† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kubernetes Containerd Integration Goes GA</a> Ø¹Ù„Ù‰ Ù…Ø¯ÙˆÙ†Ø© Kubernetes Ø§Ù„Ø±Ø³Ù…ÙŠØ© ØŒ ÙˆØ§Ù„ØªÙŠ ØªÙ†Øµ Ø¹Ù„Ù‰ Ø£Ù† ØªÙƒØ§Ù…Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ù…Ø¹ Kubernetes Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ù†ØªØ§Ø¬.  Ø£ÙŠØ¶Ø§ ØŒ Ù†Ø´Ø± Ø±Ø¬Ø§Ù„ Ù…Ù† Ø´Ø±ÙƒØ© Flant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªØ±Ø¬Ù…Ø© Ù„Ù„Ù…Ù‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø±ÙˆØ³ÙŠØ© Ø¹Ù„Ù‰</a> Ù…Ø¯ÙˆÙ†ØªÙ‡Ù… ØŒ Ù…Ø¶ÙŠÙÙŠÙ† Ø§Ù„Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„ØªÙˆØ¶ÙŠØ­ Ø¹Ù† Ø£Ù†ÙØ³Ù‡Ù….  Ø¨Ø¹Ø¯ Ù‚Ø±Ø§Ø¡Ø© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¹Ù„Ù‰ github</a> ØŒ Ù‚Ø±Ø±Øª ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø¹Ù„Ù‰ "Ø¨Ø´Ø±ØªÙŠ". </p><br><p style=";text-align:right;direction:rtl">  Ø´Ø±ÙƒØªÙ†Ø§ Ù„Ø¯ÙŠÙ‡Ø§ Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ÙÙŠ Ù…Ø±Ø­Ù„Ø© "Ù„Ø§ ØªØ²Ø§Ù„ Ø¨Ø¹ÙŠØ¯Ø© Ø¬Ø¯Ø§ Ø¹Ù† Ø§Ù„Ø¥Ù†ØªØ§Ø¬".  Ù„Ø°Ù„Ùƒ Ø³ÙŠØµØ¨Ø­ÙˆÙ† ØªØ¬Ø±ÙŠØ¨ÙŠÙ†Ø§ Ø›  Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù‡Ù… ØŒ Ù‚Ø±Ø±Ù†Ø§ Ù…Ø­Ø§ÙˆÙ„Ø© Ù†Ø´Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© ØªØ¬Ø§ÙˆØ² Ø§Ù„ÙØ´Ù„ Ù…Ù† Kubernetes Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙˆÙ…Ø¹Ø±ÙØ© Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø­ÙŠØ§Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ø§Ù…Ù„ Ø¥Ø±Ø³Ø§Ø¡. </p><br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ÙƒÙ†Øª Ù…Ù‡ØªÙ…Ù‹Ø§ Ø¨Ø±Ø¤ÙŠØ© ÙƒÙŠÙ ÙØ¹Ù„Ù†Ø§ Ø°Ù„Ùƒ ÙˆÙ…Ø§ Ø¬Ø§Ø¡ Ø¨Ù‡ ØŒ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù‚Ø·. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  <b>Ø§Ù„ÙˆØµÙ Ø§Ù„ØªØ®Ø·ÙŠØ·ÙŠ ÙˆØ§Ù„Ù†Ø´Ø±</b> <br><img src="https://habrastorage.org/webt/db/xm/pn/dbxmpnpsth-psiiyn_ittkfkc4a.png"></p><br><p style=";text-align:right;direction:rtl">  Ø¹Ù†Ø¯ Ù†Ø´Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© ØŒ ÙƒØ§Ù„Ù…Ø¹ØªØ§Ø¯ ØŒ (ÙƒØªØ¨Øª Ø¹Ù† Ù‡Ø°Ø§ ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù…Ù‚Ø§Ù„ Ø³Ø§Ø¨Ù‚</a> </p><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">keepalived - ØªØ·Ø¨ÙŠÙ‚Ø§Øª VRRP (Virtual Router Redundancy Protocol) Ù„Ù†Ø¸Ø§Ù… Linux</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ØªÙ‚ÙˆÙ… Keepalived Ø¨Ø¥Ù†Ø´Ø§Ø¡ IP Ø§ÙØªØ±Ø§Ø¶ÙŠ (VIRTIP) ÙˆØ§Ù„Ø°ÙŠ "ÙŠØ´ÙŠØ±" (ÙŠÙ†Ø´Ø¦ ÙˆØ§Ø¬Ù‡Ø© ÙØ±Ø¹ÙŠØ©) Ø¥Ù„Ù‰ IP Ø§Ù„Ø®Ø§Øµ Ø¨Ø£Ø­Ø¯ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø© Ø§Ù„Ø«Ù„Ø§Ø«Ø©.  ÙŠØ±Ø§Ù‚Ø¨ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø®ÙÙŠ Ø§Ù„Ø°ÙŠ ÙŠØªÙ… Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù‡ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø§ÙƒÙŠÙ†Ø© ØŒ ÙˆÙÙŠ Ø­Ø§Ù„Ø© Ø­Ø¯ÙˆØ« Ø¹Ø·Ù„ ØŒ ÙŠØ³ØªØ«Ù†ÙŠ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„ÙØ§Ø´Ù„ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®ÙˆØ§Ø¯Ù… Ø§Ù„Ù†Ø´Ø·Ø© Ø¹Ù† Ø·Ø±ÙŠÙ‚ ØªØ­ÙˆÙŠÙ„ VIRTIP Ø¥Ù„Ù‰ IP Ø§Ù„Ø®Ø§Øµ Ø¨Ø®Ø§Ø¯Ù… Ø¢Ø®Ø± ØŒ ÙˆÙÙ‚Ù‹Ø§ "Ù„Ù„ÙˆØ²Ù†" Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¹Ù†Ø¯ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù‡ Ø¹Ù„Ù‰ ÙƒÙ„ Ø®Ø§Ø¯Ù…. </div></div><br><p style=";text-align:right;direction:rtl">  ØªØªÙˆØ§ØµÙ„ Ø´ÙŠØ§Ø·ÙŠÙ† Keepalived Ø¹Ø¨Ø± VRRP ØŒ ÙˆØªØ±Ø³Ù„ Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø¹Ø¶Ù‡Ø§ Ø§Ù„Ø¨Ø¹Ø¶ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† 224.0.0.18. </p><br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ù„Ù… ÙŠÙ‚Ù… Ø§Ù„Ø¬Ø§Ø± Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙ‡ ØŒ ÙØ¹Ù†Ø¯Ù‡Ø§ ÙŠØ¹ØªØ¨Ø± Ù…ÙŠØªØ§Ù‹.  Ø¨Ù…Ø¬Ø±Ø¯ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ù…Ø¹Ø·Ù„ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ© ØŒ ÙŠØ¹ÙˆØ¯ ÙƒÙ„ Ø´ÙŠØ¡ Ø¥Ù„Ù‰ Ù…ÙƒØ§Ù†Ù‡ </p><br><p style=";text-align:right;direction:rtl">  Ù†Ù‚ÙˆÙ… Ø¨ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø®Ø§Ø¯Ù… API Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯ kubernetes Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø­Ùˆ Ø§Ù„ØªØ§Ù„ÙŠ. </p><br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ØŒ Ù‚Ù… Ø¨ØªÙƒÙˆÙŠÙ† kube-proxy ØŒ Ù‚Ù… Ø¨ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù†ÙØ° Ù…Ù† 6443 Ø¥Ù„Ù‰ 16443 (Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø£Ø¯Ù†Ø§Ù‡).  Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ù† Ø§Ù„Ø£Ø³Ø§ØªØ°Ø© ØŒ ÙŠØªÙ… Ù†Ø´Ø± nginx ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ù…Ø«Ø§Ø¨Ø© Ù…ÙˆØ§Ø²Ù† ØªØ­Ù…ÙŠÙ„ ØŒ ÙˆÙŠØ³ØªÙ…Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 16443 ÙˆÙŠÙ‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ Ø§Ù„Ù…Ù†Ø¨Ø¹ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø© Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 6443 (Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø£Ø¯Ù†Ø§Ù‡). </p><br><p style=";text-align:right;direction:rtl">  Ø­Ù‚Ù‚ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ³Ø§Ù…Ø­ Ù…Ø¹ Ø§Ù„Ø®Ø·Ø£ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Keepalived ØŒ ÙˆÙƒØ°Ù„Ùƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… nginx ØŒ ÙˆØªÙ… ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø®ÙˆØ§Ø¯Ù… API Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª. <br></p><br><p style=";text-align:right;direction:rtl">  ÙÙŠ Ù…Ù‚Ø§Ù„ Ø³Ø§Ø¨Ù‚ ØŒ ÙˆØµÙØª Ù†Ø´Ø± nginx Ùˆ etcd ÙÙŠ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡.  ÙˆÙ„ÙƒÙ† ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© ØŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙ†Ø§ Ø¹Ø§Ù…Ù„ Ø¥Ø±Ø³Ø§Ø¡ ØŒ Ù„Ø°Ù„Ùƒ Ø³ÙŠØ¹Ù…Ù„ nginx Ùˆ etcd Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ masternodes. </p><br><p style=";text-align:right;direction:rtl">  Ù…Ù† Ø§Ù„Ù†Ø§Ø­ÙŠØ© Ø§Ù„Ù†Ø¸Ø±ÙŠØ© ØŒ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ù†Ø´Ø± nginx Ùˆ etcd Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§ÙˆÙŠØ© ØŒ ÙˆÙ„ÙƒÙ† ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ ØŒ ÙØ¥Ù† Ù‡Ø°Ø§ Ø§Ù„Ù†Ù‡Ø¬ Ø³ÙŠØ¹Ù‚Ø¯ Ø§Ù„ØªØ´Ø®ÙŠØµ ØŒ Ù„Ø°Ù„Ùƒ Ù‚Ø±Ø±Ù†Ø§ Ø¹Ø¯Ù… ØªØ¬Ø±Ø¨ØªÙ‡ ÙˆØªØ´ØºÙŠÙ„Ù‡ Ù…Ø­Ù„ÙŠÙ‹Ø§. </p><br><p style=";text-align:right;direction:rtl">  <b>ÙˆØµÙ Ø®ÙˆØ§Ø¯Ù… Ù„Ù„Ù†Ø´Ø±:</b> </p><br><table style=";text-align:right;direction:rtl"><thead><tr><th>  Ø§Ù„Ø§Ø³Ù… </th><th>  IP </th><th>  Ø§Ù„Ø®Ø¯Ù…Ø§Øª </th></tr></thead><tbody><tr><td>  VIRTIP </td><td>  172.26.133.160 </td><td>  ------ </td></tr><tr><td>  kube-master01 </td><td>  172.26.133.161 </td><td>  kubeadm ØŒ kubelet ØŒ kubectl ØŒ etcd ØŒ containerd ØŒ nginx ØŒ keepalived </td></tr><tr><td>  ÙƒÙˆØ¨ÙŠ Ù…Ø§Ø³ØªØ± 02 </td><td>  172.26.133.162 </td><td>  kubeadm ØŒ kubelet ØŒ kubectl ØŒ etcd ØŒ containerd ØŒ nginx ØŒ keepalived </td></tr><tr><td>  ÙƒÙˆØ¨ÙŠ Ù…Ø§Ø³ØªØ± 03 </td><td>  172.26.133.163 </td><td>  kubeadm ØŒ kubelet ØŒ kubectl ØŒ etcd ØŒ containerd ØŒ nginx ØŒ keepalived </td></tr><tr><td>  kube-node01 </td><td>  172.26.133.164 </td><td>  kubeadm ØŒ kubelet ØŒ kubectl ØŒ Ø§Ù„Ø­Ø§ÙˆÙŠØ© </td></tr><tr><td>  Ø¹Ù‚Ø¯Ø© ÙƒÙˆØ¨ÙŠ 02 </td><td>  172.26.133.165 </td><td>  kubeadm ØŒ kubelet ØŒ kubectl ØŒ Ø§Ù„Ø­Ø§ÙˆÙŠØ© </td></tr><tr><td>  Ø¹Ù‚Ø¯Ø© ÙƒÙˆØ¨ÙŠ 03 </td><td>  172.26.133.166 </td><td>  kubeadm ØŒ kubelet ØŒ kubectl ØŒ Ø§Ù„Ø­Ø§ÙˆÙŠØ© </td></tr></tbody></table><br><p style=";text-align:right;direction:rtl">  <b>Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª kubeadm Ùˆ kubelet Ùˆ kubectl ÙˆØ§Ù„Ø­Ø²Ù… Ø°Ø§Øª Ø§Ù„ØµÙ„Ø©</b> </p><br><p style=";text-align:right;direction:rtl">  ØªØ¹Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ù…Ù† Ø§Ù„Ø¬Ø°Ø± </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">sudo -i</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt-get update &amp;&amp; apt-get install -y apt-transport-https curl curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.list deb http://apt.kubernetes.io/ kubernetes-xenial main EOF apt-get update apt-get install -y kubelet kubeadm kubectl unzip tar apt-transport-https btrfs-tools libseccomp2 socat util-linux mc vim keepalived</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªØ«Ø¨ÙŠØª conteinerd</b> <br><img src="https://habrastorage.org/webt/ul/nw/vg/ulnwvgeblmt74ivcsnsz2tuxcfa.png"></p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> / wget https://storage.googleapis.com/cri-containerd-release/cri-containerd-1.1.0-rc.0.linux-amd64.tar.gz tar -xvf cri-containerd-1.1.0-rc.0.linux-amd64.tar.gz</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªÙƒÙˆÙŠÙ† ØªÙƒÙˆÙŠÙ†Ø§Øª Ø§Ù„Ø­Ø§ÙˆÙŠØ©</b> </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkdir -p /etc/containerd nano /etc/containerd/config.toml</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ù: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">[plugins.cri] enable_tls_streaming = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø¨Ø¯Ø£ conteinerd Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† ÙƒÙ„ Ø´ÙŠØ¡ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ±Ø§Ù… </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> containerd systemctl start containerd systemctl status containerd â— containerd.service - containerd container runtime Loaded: loaded (/etc/systemd/system/containerd.service; disabled; vendor preset: enabled) Active: active (running) since Mon 2018-06-25 12:32:01 MSK; 7s ago Docs: https://containerd.io Process: 10725 ExecStartPre=/sbin/modprobe overlay (code=exited, status=0/SUCCESS) Main PID: 10730 (containerd) Tasks: 15 (<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span>: 4915) Memory: 14.9M CPU: 375ms CGroup: /system.slice/containerd.service â””â”€10730 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/containerd Jun 25 12:32:01 hb-master02 containerd[10730]: time=<span class="hljs-string"><span class="hljs-string">"2018-06-25T12:32:01+03:00"</span></span> level=info msg=<span class="hljs-string"><span class="hljs-string">"Get image filesystem path "</span></span>/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs<span class="hljs-string"><span class="hljs-string">""</span></span> Jun 25 12:32:01 hb-master02 containerd[10730]: time=<span class="hljs-string"><span class="hljs-string">"2018-06-25T12:32:01+03:00"</span></span> level=error msg=<span class="hljs-string"><span class="hljs-string">"Failed to load cni during init, please check CRI plugin status before setting up network for pods"</span></span> error=<span class="hljs-string"><span class="hljs-string">"cni con Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>loading plugin <span class="hljs-string"><span class="hljs-string">"io.containerd.grpc.v1.introspection"</span></span>...<span class="hljs-string"><span class="hljs-string">" type=io.containerd.grpc.v1 Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>Start subscribing containerd event<span class="hljs-string"><span class="hljs-string">" Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>Start recovering state<span class="hljs-string"><span class="hljs-string">" Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg=serving... address="</span></span>/run/containerd/containerd.sock<span class="hljs-string"><span class="hljs-string">" Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>containerd successfully booted <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.308755s<span class="hljs-string"><span class="hljs-string">" Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>Start event monitor<span class="hljs-string"><span class="hljs-string">" Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>Start snapshots syncer<span class="hljs-string"><span class="hljs-string">" Jun 25 12:32:01 hb-master02 containerd[10730]: time="</span></span>2018-06-25T12:32:01+03:00<span class="hljs-string"><span class="hljs-string">" level=info msg="</span></span>Start streaming server<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªØ«Ø¨ÙŠØª ÙˆØªØ´ØºÙŠÙ„ ÙˆÙ…Ø§ Ø¥Ù„Ù‰ Ø°Ù„Ùƒ</b> </p><br><p style=";text-align:right;direction:rtl">  Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø© ØŒ Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨ØªØ«Ø¨ÙŠØª Ø¥ØµØ¯Ø§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© kubernetes 1.10.  Ø¨Ø¹Ø¯ ÙŠÙˆÙ…ÙŠÙ† ÙÙ‚Ø· ØŒ Ø¹Ù†Ø¯ ÙƒØªØ§Ø¨Ø© Ù…Ù‚Ø§Ù„ ØŒ ØªÙ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.11. Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.11 ØŒ ÙÙ‚Ù… Ø¨ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ± ETCD_VERSION = "v3.2.17" ØŒ Ø¥Ø°Ø§ ÙƒØ§Ù† 1.10 Ø«Ù… ETCD_VERSION = "v3.1.12". </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> ETCD_VERSION=<span class="hljs-string"><span class="hljs-string">"v3.1.12"</span></span> curl -sSL https://github.com/coreos/etcd/releases/download/<span class="hljs-variable"><span class="hljs-variable">${ETCD_VERSION}</span></span>/etcd-<span class="hljs-variable"><span class="hljs-variable">${ETCD_VERSION}</span></span>-linux-amd64.tar.gz | tar -xzv --strip-components=1 -C /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø³Ø® Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª Ù…Ù† gitahab. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/rjeka/k8s-containerd.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> k8s-containerd</code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙÙŠ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ†. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vim create-config.sh</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ÙˆØµÙ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ù„Ù create-config.sh</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # local machine ip address export K8SHA_IPLOCAL=172.26.133.161 # local machine etcd name, options: etcd1, etcd2, etcd3 export K8SHA_ETCDNAME=kube-master01 # local machine keepalived state config, options: MASTER, BACKUP. One keepalived cluster only one MASTER, other's are BACKUP export K8SHA_KA_STATE=MASTER # local machine keepalived priority config, options: 102, 101,100 MASTER must 102 export K8SHA_KA_PRIO=102 # local machine keepalived network interface name config, for example: eth0 export K8SHA_KA_INTF=ens18 ####################################### # all masters settings below must be same ####################################### # master keepalived virtual ip address export K8SHA_IPVIRTUAL=172.26.133.160 # master01 ip address export K8SHA_IP1=172.26.133.161 # master02 ip address export K8SHA_IP2=172.26.133.162 # master03 ip address export K8SHA_IP3=172.26.133.163 # master01 hostname export K8SHA_HOSTNAME1=kube-master01 # master02 hostname export K8SHA_HOSTNAME2=kube-master02 # master03 hostname export K8SHA_HOSTNAME3=kube-master03 # keepalived auth_pass config, all masters must be same export K8SHA_KA_AUTH=56cf8dd754c90194d1600c483e10abfr #etcd tocken: export ETCD_TOKEN=9489bf67bdfe1b3ae077d6fd9e7efefd # kubernetes cluster token, you can use 'kubeadm token generate' to get a new one export K8SHA_TOKEN=535tdi.utzk5hf75b04ht8l # kubernetes CIDR pod subnet, if CIDR pod subnet is "10.244.0.0/16" please set to "10.244.0.0\\/16" export K8SHA_CIDR=10.244.0.0\\/16</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø­Ù„ÙŠ Ù„ÙƒÙ„ Ø¹Ù‚Ø¯Ø© (ÙƒÙ„ Ø¹Ù‚Ø¯Ø© Ù„Ù‡Ø§ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø§) <br>  <b>K8SHA_IPLOCAL</b> - Ø¹Ù†ÙˆØ§Ù† IP Ù„Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠ Ø¹Ù„ÙŠÙ‡Ø§ <br>  <b>K8SHA_ETCDNAME</b> - Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø­Ù„ÙŠ ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© ETCD <br>  <b>K8SHA_KA_STATE</b> - Ø¯ÙˆØ± ÙÙŠ <b>Keepalived</b> .  Ø¹Ù‚Ø¯Ø© Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ø­Ø¯Ø© ØŒ ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ø£Ø®Ø±Ù‰. <br>  <b>K8SHA_KA_PRIO</b> - Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© <b>Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©</b> ØŒ Ù„Ø¯Ù‰ Ø§Ù„Ù…Ø§Ø¬Ø³ØªÙŠØ± 102 <b>Ù„Ù„Ø£Ø±Ù‚Ø§Ù…</b> Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© 101 ØŒ 100. Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ³Ù‚Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø°Ùˆ Ø§Ù„Ø±Ù‚Ù… 102 ØŒ ØªØ£Ø®Ø° Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø¨Ø±Ù‚Ù… 101 Ù…ÙƒØ§Ù†Ù‡Ø§ ÙˆÙ‡ÙƒØ°Ø§. <br>  <b>K8SHA_KA_INTF</b> - ÙˆØ§Ø¬Ù‡Ø© Ø´Ø¨ÙƒØ© <b>Ù…Ø­ÙÙˆØ¸Ø©</b> .  Ø³ÙŠØªÙ… Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ø¥Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªÙŠ ÙŠØªÙ… Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù‡Ø§. </p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø¬Ù…ÙŠØ¹ Ù…Ø§Ø³ØªØ±Ù†ÙˆØ¯Ø³ Ù‡ÙŠ Ù†ÙØ³Ù‡Ø§: </p><br><p style=";text-align:right;direction:rtl">  <b>K8SHA_IPVIRTUAL</b> = 172.26.133.160 - IP Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠ Ù„Ù„ÙƒØªÙ„Ø©. <br>  <b>K8SHA_IP1 ... K8SHA_IP3 -</b> Ø¹Ù†Ø§ÙˆÙŠÙ† <b>IP</b> Ù„Ù„Ø³Ø§Ø¯Ø© <br>  <b>K8SHA_HOSTNAME1 ... K8SHA_HOSTNAME3</b> - Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø¶ÙŠÙÙŠÙ† Ù„Ù„Ù…Ø§Ø³ØªØ±Ù†ÙˆØ¯Ø².  Ù†Ù‚Ø·Ø© Ù…Ù‡Ù…Ø© ØŒ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø³ØªÙˆÙ„Ø¯ kubeadm Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª. <br>  <b>K8SHA_KA_AUTH</b> - ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± <b>Ù„Ø­ÙØ¸Ù‡Ø§</b> .  ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ <br>  <b>K8SHA_TOKEN</b> - Ø±Ù…Ø² Ø§Ù„ÙƒØªÙ„Ø©.  ÙŠÙ…ÙƒÙ† Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ø± <b>Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø² Ù…Ù…ÙŠØ² kubeadm</b> <br>  <b>K8SHA_CIDR</b> - Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„ÙØ±Ø¹ÙŠØ© <b>Ù„Ù„Ù…Ø¯Ø§Ø®Ù†</b> .  ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØ§Ù†ÙŠÙ„Ø§ Ø­ØªÙ‰ CIDR 0.244.0.0/16.  ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø© - ÙÙŠ Ø§Ù„ØªÙƒÙˆÙŠÙ† ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† K8SHA_CIDR = 10.244.0.0 \ / 16 </p></div></div><br><p style=";text-align:right;direction:rtl">  Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠ Ø§Ù„Ø°ÙŠ Ø³ÙŠÙ‚ÙˆÙ… Ø¨ØªÙƒÙˆÙŠÙ† nginx Ùˆ keepalived Ùˆ etcd Ùˆ kubeadmin </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">./create-config.sh</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø¨Ø¯Ø£ Ø¥Ù„Ø®. </p><br>  ÙˆÙ…Ø§ Ø¥Ù„Ù‰ Ø°Ù„Ùƒ Ø±ÙØ¹Øª Ø¨Ø¯ÙˆÙ† TLS.  Ø¥Ø°Ø§ ÙƒÙ†Øª Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ tls ØŒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙØ³ÙŠØªÙ…</a> ÙƒØªØ§Ø¨ØªÙ‡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ«Ø§Ø¦Ù‚ kubernetes Ø§Ù„Ø±Ø³Ù…ÙŠØ©</a> ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø´Ù‡Ø§Ø¯Ø§Øª Ù„Ù€ etcd. <br><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl daemon-reload &amp;&amp; systemctl start etcd &amp;&amp; systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> etcd</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø© </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">etcdctl cluster-health member ad059013ec46f37 is healthy: got healthy result from http://192.168.5.49:2379 member 4d63136c9a3226a1 is healthy: got healthy result from http://192.168.4.169:2379 member d61978cb3555071e is healthy: got healthy result from http://192.168.4.170:2379 cluster is healthy etcdctl member list ad059013ec46f37: name=hb-master03 peerURLs=http://192.168.5.48:2380 clientURLs=http://192.168.5.49:2379,http://192.168.5.49:4001 isLeader=<span class="hljs-literal"><span class="hljs-literal">false</span></span> 4d63136c9a3226a1: name=hb-master01 peerURLs=http://192.168.4.169:2380 clientURLs=http://192.168.4.169:2379,http://192.168.4.169:4001 isLeader=<span class="hljs-literal"><span class="hljs-literal">true</span></span> d61978cb3555071e: name=hb-master02 peerURLs=http://192.168.4.170:2380 clientURLs=http://192.168.4.170:2379,http://192.168.4.170:4001 isLeader=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ÙƒØ§Ù† ÙƒÙ„ Ø´ÙŠØ¡ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ±Ø§Ù… ØŒ ÙØ§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©. </p><br><p style=";text-align:right;direction:rtl">  <b>ØªÙƒÙˆÙŠÙ† kubeadmin</b> <br>  Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.11 Ù…Ù† kubeadm ØŒ ÙÙŠÙ…ÙƒÙ†Ùƒ ØªØ®Ø·ÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ© <br>  Ù„ÙƒÙŠ ØªØ¨Ø¯Ø£ kybernetes ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ù„ÙŠØ³ Ù…Ø¹ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ ØŒ ÙˆÙ„ÙƒÙ† Ù…Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ØŒ Ù‚Ù… Ø¨ØªÙƒÙˆÙŠÙ† kubeadmin config </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vim /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ [Ø§Ù„Ø®Ø¯Ù…Ø©] Ø£Ø¶Ù Ø®Ø·Ù‹Ø§ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØªÙ„Ø© </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Environment=<span class="hljs-string"><span class="hljs-string">"KUBELET_EXTRA_ARGS=--runtime-cgroups=/system.slice/containerd.service --container-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock"</span></span></code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ùˆ Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙƒÙ…Ø§ ÙŠÙ„ÙŠ:</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[Service] Environment="KUBELET_EXTRA_ARGS=--runtime-cgroups=/system.slice/containerd.service --container-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock" Environment="KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf" Environment="KUBELET_SYSTEM_PODS_ARGS=--pod-manifest-path=/etc/kubernetes/manifests --allow-privileged=true" Environment="KUBELET_NETWORK_ARGS=--network-plugin=cni --cni-conf-dir=/etc/cni/net.d --cni-bin-dir=/opt/cni/bin" Environment="KUBELET_DNS_ARGS=--cluster-dns=10.96.0.10 --cluster-domain=cluster.local" Environment="KUBELET_AUTHZ_ARGS=--authorization-mode=Webhook --client-ca-file=/etc/kubernetes/pki/ca.crt" Environment="KUBELET_CADVISOR_ARGS=--cadvisor-port=0" Environment="KUBELET_CERTIFICATE_ARGS=--rotate-certificates=true --cert-dir=/var/lib/kubelet/pki" ExecStart= ExecStart=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_SYSTEM_PODS_ARGS $KUBELET_NETWORK_ARGS $KUBELET_DNS_ARGS $KUBELET_AUTHZ_ARGS $KUBELET_CADVISOR_ARGS $KUBELET_CERTIFICATE_ARGS $KUBELET_EXTRA_ARGS</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.11 ÙˆØªØ±ÙŠØ¯ ØªØ¬Ø±Ø¨Ø© CoreDNS Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† kube-dns ÙˆØ§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ ØŒ Ù‚Ù… Ø¨Ø¥Ù„ØºØ§Ø¡ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„ÙƒØªÙ„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ† kubeadm-init.yaml: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">feature-gates: DynamicKubeletConfig: <span class="hljs-literal"><span class="hljs-literal">true</span></span> CoreDNS: <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ kubelet </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">systemctl daemon-reload &amp;&amp; systemctl restart kubelet</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø£ÙˆÙ„</b> </p><br><p style=";text-align:right;direction:rtl">  Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ kubeadm ØŒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Keepalived ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„ØªÙ‡Ø§ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl restart keepalived.service systemctl status keepalived.service â— keepalived.service - Keepalive Daemon (LVS and VRRP) Loaded: loaded (/lib/systemd/system/keepalived.service; enabled; vendor preset: enabled) Active: active (running) since Wed 2018-06-27 10:40:03 MSK; 1min 44s ago Process: 4589 ExecStart=/usr/sbin/keepalived <span class="hljs-variable"><span class="hljs-variable">$DAEMON_ARGS</span></span> (code=exited, status=0/SUCCESS) Main PID: 4590 (keepalived) Tasks: 7 (<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span>: 4915) Memory: 15.3M CPU: 968ms CGroup: /system.slice/keepalived.service â”œâ”€4590 /usr/sbin/keepalived â”œâ”€4591 /usr/sbin/keepalived â”œâ”€4593 /usr/sbin/keepalived â”œâ”€5222 /usr/sbin/keepalived â”œâ”€5223 sh -c /etc/keepalived/check_apiserver.sh â”œâ”€5224 /bin/bash /etc/keepalived/check_apiserver.sh â””â”€5231 sleep 5</code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø£ØµÙˆØ§Øª VIRTIP </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ping -c 4 172.26.133.160 PING 172.26.133.160 (172.26.133.160) 56(84) bytes of data. 64 bytes from 172.26.133.160: icmp_seq=1 ttl=64 time=0.030 ms 64 bytes from 172.26.133.160: icmp_seq=2 ttl=64 time=0.050 ms 64 bytes from 172.26.133.160: icmp_seq=3 ttl=64 time=0.050 ms 64 bytes from 172.26.133.160: icmp_seq=4 ttl=64 time=0.056 ms --- 172.26.133.160 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3069ms rtt min/avg/max/mdev = 0.030/0.046/0.056/0.012 ms</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ kubeadmin.  ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø®Ø· - skip-preflight-check.  Ø³ØªÙØ´Ù„ Kubeadmin Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø§Ù…Ù„ Ø¥Ø±Ø³Ø§Ø¡ ÙˆØ¨Ø¯ÙˆÙ† ØªØ®Ø·ÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ø¹ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubeadm init --config=kubeadm-init.yaml --skip-preflight-checks</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø¹Ù…Ù„ kubeadm ØŒ Ø§Ø­ÙØ¸ Ø§Ù„Ø®Ø· Ø§Ù„Ø°ÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡.  Ø³ØªÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø­Ø§Ø¬Ø© Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù‚Ø¯ Ø§Ù„Ø¹Ù…Ù„ ÙÙŠ Ø§Ù„ÙƒØªÙ„Ø©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubeadm join 172.26.133.160:6443 --token XXXXXXXXXXXXXXXXXXXXXXXXX --discovery-token-ca-cert-hash sha256:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ ÙˆØ¶Ø­ Ù…ÙƒØ§Ù† ØªØ®Ø²ÙŠÙ† Ù…Ù„Ù admin.conf <br>  Ø¥Ø°Ø§ Ø¹Ù…Ù„Ù†Ø§ ÙƒØ¬Ø°Ø± Ø«Ù…: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vim ~/.bashrc <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> KUBECONFIG=/etc/kubernetes/admin.conf <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.bashrc</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø³ÙŠØ· ØŒ Ø§ØªØ¨Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªÙŠ ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkdir -p <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/.kube sudo cp -i /etc/kubernetes/admin.conf <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/.kube/config sudo chown $(id -u):$(id -g) <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/.kube/config</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø£Ø¶Ù Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø£Ø®Ø±Ù‰ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØªÙ„Ø©.  Ù„Ù„Ù‚ÙŠØ§Ù… Ø¨Ø°Ù„Ùƒ ØŒ Ø§Ù†Ø³Ø® Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ù† kube-master01 Ø¥Ù„Ù‰ kube-master02 Ùˆ kube-master03 Ø¥Ù„Ù‰ Ø§Ù„Ø¯Ù„ÙŠÙ„ / etc / kubernetes /.  Ù„Ù„Ù‚ÙŠØ§Ù… Ø¨Ø°Ù„Ùƒ ØŒ Ù‚Ù…Øª Ø¨ØªÙƒÙˆÙŠÙ† ÙˆØµÙˆÙ„ ssh Ù„Ù„Ø¬Ø°Ø± ØŒ ÙˆØ¨Ø¹Ø¯ Ù†Ø³Ø® Ø§Ù„Ù…Ù„ÙØ§Øª ØŒ Ø£Ø¹Ø¯Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø±Ø© Ø£Ø®Ø±Ù‰. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">scp -r /etc/kubernetes/pki 172.26.133.162:/etc/kubernetes/ scp -r /etc/kubernetes/pki 172.26.133.163:/etc/kubernetes/</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø³Ø® Ø¥Ù„Ù‰ kube-master02 Ùˆ kube-master03 ØŒ Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubeadm init --config=kubeadm-init.yaml --skip-preflight-checks</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª CIDR Ø§Ù„ÙØ§Ù†ÙŠÙ„Ø§</b> </p><br><p style=";text-align:right;direction:rtl">  Ø¹Ù„Ù‰ kube-master01 ØªÙ†ÙÙŠØ° </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/v0.10.0/Documentation/kube-flannel.yml</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† flanel ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ«Ø§Ø¦Ù‚ kubernetes</a> . </p><br><p style=";text-align:right;direction:rtl">  Ù†Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">watch -n1 kubectl get pods --all-namespaces -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE kube-system kube-apiserver-kube-master01 1/1 Running 0 17m 172.26.133.161 kube-master01 kube-system kube-apiserver-kube-master02 1/1 Running 0 6m 172.26.133.162 kube-master02 kube-system kube-apiserver-kube-master03 1/1 Running 0 6m 172.26.133.163 kube-master03 kube-system kube-controller-manager-kube-master01 1/1 Running 0 17m 172.26.133.161 kube-master01 kube-system kube-controller-manager-kube-master02 1/1 Running 0 6m 172.26.133.162 kube-master02 kube-system kube-controller-manager-kube-master03 1/1 Running 0 6m 172.26.133.163 kube-master03 kube-system kube-dns-86f4d74b45-8c24s 3/3 Running 0 17m 10.244.2.2 kube-master03 kube-system kube-flannel-ds-4h4w7 1/1 Running 0 2m 172.26.133.163 kube-master03 kube-system kube-flannel-ds-kf5mj 1/1 Running 0 2m 172.26.133.162 kube-master02 kube-system kube-flannel-ds-q6k4z 1/1 Running 0 2m 172.26.133.161 kube-master01 kube-system kube-proxy-9cjtp 1/1 Running 0 6m 172.26.133.163 kube-master03 kube-system kube-proxy-9sqk2 1/1 Running 0 17m 172.26.133.161 kube-master01 kube-system kube-proxy-jg2pt 1/1 Running 0 6m 172.26.133.162 kube-master02 kube-system kube-scheduler-kube-master01 1/1 Running 0 18m 172.26.133.161 kube-master01 kube-system kube-scheduler-kube-master02 1/1 Running 0 6m 172.26.133.162 kube-master02 kube-system kube-scheduler-kube-master03 1/1 Running 0 6m 172.26.133.163 kube-master03</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>Ù†Ø­Ù† Ù†ØµÙ†Ø¹ Ù†Ø³Ø®Ø© Ø·Ø¨Ù‚ Ø§Ù„Ø£ØµÙ„ Ù…Ù† Ù†Ø¸Ø§Ù… Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª kube Ø¥Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø§ØªØ°Ø© Ø§Ù„Ø«Ù„Ø§Ø«Ø©</b> </p><br><p style=";text-align:right;direction:rtl">  Ø¹Ù„Ù‰ kube-master01 ØªÙ†ÙÙŠØ° </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl scale --replicas=3 -n kube-system deployment/kube-dns</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªØ«Ø¨ÙŠØª ÙˆØªÙƒÙˆÙŠÙ† nginx</b> </p><br><p style=";text-align:right;direction:rtl">  ÙÙŠ ÙƒÙ„ Ø¹Ù‚Ø¯Ø© Ø±Ø¦ÙŠØ³ÙŠØ© ØŒ Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª nginx ÙƒÙ…ÙˆØ§Ø²Ù† Ù„Ù€ Kubernetes API <br>  Ù„Ø¯ÙŠ ÙƒÙ„ Ø¢Ù„Ø§Øª Ø§Ù„ÙƒØªÙ„Ø© Ø¹Ù„Ù‰ Ø¯ÙŠØ¨ÙŠØ§Ù†.  Ù…Ù† Ø­Ø²Ù… nginx ØŒ Ù„Ø§ ØªØ¯Ø¹Ù… ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯ÙÙ‚ ØŒ Ù„Ø°Ø§ Ø£Ø¶Ù Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª nginx ÙˆÙ‚Ù… Ø¨ØªØ«Ø¨ÙŠØªÙ‡Ø§ Ù…Ù† Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª nginx`a.  Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ù†Ø¸Ø§Ù… ØªØ´ØºÙŠÙ„ Ù…Ø®ØªÙ„Ù ØŒ ÙØ±Ø§Ø¬Ø¹ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ«Ø§Ø¦Ù‚ nginx</a> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">wget https://nginx.org/keys/nginx_signing.key sudo apt-key add nginx_signing.key <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -e <span class="hljs-string"><span class="hljs-string">"\n#nginx\n\ deb http://nginx.org/packages/debian/ stretch nginx\n\ deb-src http://nginx.org/packages/debian/ stretch nginx"</span></span> &gt;&gt; /etc/apt/sources.list apt-get update &amp;&amp; apt-get install nginx -y</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ ØªÙƒÙˆÙŠÙ† nginx (Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‚Ø¯ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨Ø§Ù„ÙØ¹Ù„) </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">./create-config.sh</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">nginx.conf</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  nginx Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø› <br>  Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¹Ù…Ø§Ù„ </p><br><p style=";text-align:right;direction:rtl">  error_log /var/log/nginx/error.log ØªØ­Ø°ÙŠØ± Ø› <br>  pid /var/run/nginx.pid Ø› </p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø£Ø­Ø¯Ø§Ø« { <br>  Ø§Ù„Ø¹Ù…Ø§Ù„_ÙˆØµÙ„Ø§Øª 1024 Ø› <br>  }} </p><br><p style=";text-align:right;direction:rtl">  http { <br>  ØªØ´Ù…Ù„ /etc/nginx/mime.types Ø› <br>  ØªØ·Ø¨ÙŠÙ‚ default_type / Ø¯ÙÙ‚ Ø«Ù…Ø§Ù†ÙŠ Ø¨ØªØ§Øª Ø› </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">log_format main '$remote_addr - $remote_user [$time_local] "$request" ' '$status $body_bytes_sent "$http_referer" ' '"$http_user_agent" "$http_x_forwarded_for"'; access_log /var/log/nginx/access.log main; sendfile on; #tcp_nopush on; keepalive_timeout 65; #gzip on; include /etc/nginx/conf.d/*.conf;</code> </pre> <br><p style=";text-align:right;direction:rtl">  }} </p><br><p style=";text-align:right;direction:rtl">  ØªÙŠØ§Ø± { <br>  apiserver Ø§Ù„Ù…Ù†Ø¨Ø¹ { <br>  Ø§Ù„Ø®Ø§Ø¯Ù… 172.26.133.161:6443 Ø§Ù„ÙˆØ²Ù† = 5 max_fails = 3 fail_timeout = 30s Ø› <br>  Ø§Ù„Ø®Ø§Ø¯Ù… 172.26.133.162:6443 Ø§Ù„ÙˆØ²Ù† = 5 max_fails = 3 fail_timeout = 30s Ø› <br>  Ø§Ù„Ø®Ø§Ø¯Ù… 172.26.133.163:6443 Ø§Ù„ÙˆØ²Ù† = 5 max_fails = 3 fail_timeout = 30s Ø› </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">} server { listen 16443; proxy_connect_timeout 1s; proxy_timeout 3s; proxy_pass apiserver; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  }} </p></div></div><br><p style=";text-align:right;direction:rtl">  Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† ÙƒÙ„ Ø´ÙŠØ¡ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠØ±Ø§Ù… ÙˆÙ†Ø·Ø¨Ù‚ Ø§Ù„ØªÙƒÙˆÙŠÙ† </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">nginx -t nginx: the configuration file /etc/nginx/nginx.conf syntax is ok nginx: configuration file /etc/nginx/nginx.conf <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> is successful systemctl restart nginx systemctl status nginx â— nginx.service - nginx - high performance web server Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled) Active: active (running) since Thu 2018-06-28 08:48:09 MSK; 22s ago Docs: http://nginx.org/en/docs/ Process: 22132 ExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf (code=exited, status=0/SUCCESS) Main PID: 22133 (nginx) Tasks: 2 (<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span>: 4915) Memory: 1.6M CPU: 7ms CGroup: /system.slice/nginx.service â”œâ”€22133 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf â””â”€22134 nginx: worker process</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙˆØ§Ø²Ù† </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">curl -k https://172.26.133.161:16443 | wc -l % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 233 100 233 0 0 12348 0 --:--:-- --:--:-- --:--:-- 12944</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªÙƒÙˆÙŠÙ† ÙˆÙƒÙŠÙ„ kube Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…ÙˆØ§Ø²Ù†</b> </p><br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù…ÙˆØ§Ø²Ù† ØŒ Ù‚Ù… Ø¨ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ù†ÙØ° ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª kubernetes. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl edit -n kube-system configmap/kube-proxy</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù‚Ù… Ø¨ØªØºÙŠÙŠØ± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù… Ø¥Ù„Ù‰ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://172.26.133.160:16443</a> <br>  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙƒÙˆÙŠÙ† ÙˆÙƒÙŠÙ„ kube Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ù†ÙØ° Ø§Ù„Ø¬Ø¯ÙŠØ¯ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl get pods --all-namespaces -o wide | grep proxy kube-system kube-proxy-9cjtp 1/1 Running 1 22h 172.26.133.163 kube-master03 kube-system kube-proxy-9sqk2 1/1 Running 1 22h 172.26.133.161 kube-master01 kube-system kube-proxy-jg2pt 1/1 Running 4 22h 172.26.133.162 kube-</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø±ÙˆÙ† ØŒ Ø¨Ø¹Ø¯ Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ ØŒ ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¦Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl delete pod -n kube-system kube-proxy-XXX ```bash    .      ```bash kubectl get pods --all-namespaces -o wide | grep proxy kube-system kube-proxy-hqrsw 1/1 Running 0 33s 172.26.133.161 kube-master01 kube-system kube-proxy-kzvw5 1/1 Running 0 47s 172.26.133.163 kube-master03 kube-system kube-proxy-zzkz5 1/1 Running 0 7s 172.26.133.162 kube-master02</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>Ø¥Ø¶Ø§ÙØ© Ø¹Ù‚Ø¯ Ø§Ù„Ø¹Ù…Ù„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØªÙ„Ø©</b> </p><br><p style=";text-align:right;direction:rtl">  ÙÙŠ ÙƒÙ„ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø°Ø±ÙŠØ© ØŒ Ù‚Ù… Ø¨ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø°ÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© kubeadm </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubeadm join 172.26.133.160:6443 --token XXXXXXXXXXXXXXXXXXXXXXXXX --discovery-token-ca-cert-hash sha256:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX --cri-socket /run/containerd/containerd.sock --skip-preflight-checks</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø®Ø· "Ù…ÙÙ‚ÙˆØ¯Ù‹Ø§" ØŒ ÙØ£Ù†Øª Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø· Ø¬Ø¯ÙŠØ¯ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubeadm token generate kubeadm token create &lt;generated-token&gt; --<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>-join-command --ttl=0</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø­ÙˆÙ„ Ø¹Ù‚Ø¯ Ø§Ù„Ø¹Ù…Ù„ ÙÙŠ Ù…Ù„ÙØ§Øª /etc/kubernetes/bootstrap-kubelet.conf Ùˆ /etc/kubernetes/kubelet.conf <br>  Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ù…ØªØºÙŠØ±Ø© Ù„Ø¯ÙŠÙ†Ø§ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vim /etc/kubernetes/bootstrap-kubelet.conf server: https://172.26.133.60:16443 vim /etc/kubernetes/kubelet.conf server: https://172.26.133.60:16443</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ùˆ kubernetes </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl restart containerd kubelet</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>ØªØ±ÙƒÙŠØ¨ Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</b> </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù…ØªÙŠØ§Ø²Ø§Øª Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl apply -f kube-dashboard/dashboard-adminUser.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…Ù…ÙŠØ² Ù„Ù„Ø¯Ø®ÙˆÙ„: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªÙƒÙˆÙŠÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø¹Ø¨Ø± NodePort Ø¹Ù„Ù‰ VIRTIP </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl -n kube-system edit service kubernetes-dashboard</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø³ØªØ¨Ø¯Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù†ÙˆØ¹: ClusterIP Ø¨Ø§Ù„Ù†ÙˆØ¹: NodePort ÙˆÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ù…Ù†ÙØ°: Ø£Ø¶Ù Ù‚ÙŠÙ…Ø© nodePort: 30000 (Ø£Ùˆ Ø§Ù„Ù…Ù†ÙØ° ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ 30000 Ø¥Ù„Ù‰ 32000 Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø© Ø¹Ù„ÙŠÙ‡): </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fn/ql/kr/fnqlkren3ltk88xzi8fqwi4vbxa.png"></p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ù„ÙˆØ­Ø© Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https: // VIRTIP: 30000</a> </p><br><p style=";text-align:right;direction:rtl">  <b>Ù‡ÙŠØ¨Ø³ØªØ±</b> </p><br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª Heapster ØŒ ÙˆÙ‡ÙŠ Ø£Ø¯Ø§Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ù‚Ø§ÙŠÙŠØ³ Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„ÙƒØªÙ„Ø©. </p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„ØªØ«Ø¨ÙŠØª: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/kubernetes/heapster.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> heapster kubectl create -f deploy/kube-config/influxdb/ kubectl create -f deploy/kube-config/rbac/heapster-rbac.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  <b>Ø§Ù„Ø§Ø³ØªÙ†ØªØ§Ø¬Ø§Øª</b> </p><br><p style=";text-align:right;direction:rtl">  Ù„Ù… Ø£Ù„Ø§Ø­Ø¸ Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ Ø®Ø§ØµØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ©.  Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø®Ù„Ù„ ØºÙŠØ± Ù…ÙÙ‡ÙˆÙ… Ù…Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¯ Ø¨Ø¹Ø¯ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§Ù†ØªØ´Ø§Ø±.  ÙŠØ¹ØªÙ‚Ø¯ Kubernetes Ø£Ù†Ù‡ ØªÙ… Ø­Ø°Ù ØªØ­Øª ØŒ ÙˆÙ„ÙƒÙ† Ø£ØµØ¨Ø­ ØªØ­Øª "ØºÙŠØ¨ÙˆØ¨Ø©" ØºØ±ÙŠØ¨Ø©. Ø¨Ù‚ÙŠØª Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù‚Ø¯Ø© ØŒ ÙˆÙ„ÙƒÙ† ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ù…ØªØ¯. </p><br><p style=";text-align:right;direction:rtl">  Ø£Ø¹ØªÙ‚Ø¯ Ø£Ù† Containerd Ø£ÙƒØ«Ø± ØªÙˆØ¬Ù‡Ø§Ù‹ ÙƒÙˆÙ‚Øª ØªØ´ØºÙŠÙ„ Ù„Ù„Ø­Ø§ÙˆÙŠØ§Øª Ù„Ù€ kubernetes.  Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¬Ø­ ØŒ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ØŒ ÙƒØ¨ÙŠØ¦Ø© Ù„Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙÙŠ Kubernetes ØŒ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† ÙˆØ§Ù„Ø¶Ø±ÙˆØ±ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ¦Ø§Øª Ù…Ø®ØªÙ„ÙØ© Ø³ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ù‡Ø§ Ù„Ù…Ù‡Ø§Ù… ÙˆÙ…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø®ØªÙ„ÙØ© ØŒ Ø¥Ù„Ø®. </p><br><p style=";text-align:right;direction:rtl">  ÙŠØªØ·ÙˆØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ø³Ø±Ø¹Ø© ÙƒØ¨ÙŠØ±Ø©.  Ø¨Ø¯Ø£Øª Alibaba Cloud ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… conatinerd Ø¨Ù†Ø´Ø§Ø· ÙˆØªØ¤ÙƒØ¯ Ø£Ù†Ù‡Ø§ Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª. </p><br><p style=";text-align:right;direction:rtl">  ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ† ØŒ ÙØ¥Ù† ØªÙƒØ§Ù…Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙÙŠ Ù…Ù†ØµØ© Google Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ© Kubernetes ÙŠØ¹Ø§Ø¯Ù„ Ø§Ù„Ø¢Ù† ØªÙƒØ§Ù…Ù„ Docker. </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù…Ø«Ø§Ù„ Ø¬ÙŠØ¯ Ù„Ø£Ø¯Ø§Ø© ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… crictl</a> .  Ø³Ø£Ø¹Ø·ÙŠÙƒ Ø£ÙŠØ¶Ù‹Ø§ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù…Ø«Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kubectl describe nodes | grep "Container Runtime Version:"</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gr/_l/of/gr_lofuou-20jmqzb800qdi5yny.png"></p><br><p style=";text-align:right;direction:rtl">  ØªÙØªÙ‚Ø± Docker CLI Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù€ Kubernetes ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ pod ÙˆÙ…Ø³Ø§Ø­Ø© Ø§Ù„Ø§Ø³Ù… ØŒ Ø¨ÙŠÙ†Ù…Ø§ ÙŠØ¯Ø¹Ù… crictl Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">crictl pods</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kr/im/hl/krimhlcrmwcaxysx3wgd9mjtvuo.png"></p><br><p style=";text-align:right;direction:rtl">  ÙˆØ¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø± ØŒ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø¥Ù„Ù‚Ø§Ø¡ Ù†Ø¸Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø¹ØªØ§Ø¯ ØŒ Ù…Ø«Ù„ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">crictl ps</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/zo/2m/ez/zo2mezfxjgohjpu8f35n-nazf74.png"></p><br><p style=";text-align:right;direction:rtl">  ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø£Ù† Ù†Ø±Ù‰ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù‚Ø¯Ø© </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">crictl images</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/mw/u6/tu/mwu6tunxz4re5yrr0h-ajq-_3xs.png"></p><br><p style=";text-align:right;direction:rtl">  ÙƒÙ…Ø§ Ø§ØªØ¶Ø­ Ø£Ù† Ø§Ù„Ø­ÙŠØ§Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ø§Ù…Ù„ Ù…ÙŠÙ†Ø§Ø¡ Ù‡ÙŠ :) </p><br><p style=";text-align:right;direction:rtl">  Ù…Ù† Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù„Ø£ÙˆØ§Ù†Ù‡ Ø§Ù„Ø­Ø¯ÙŠØ« Ø¹Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆÙ…ÙˆØ§Ø·Ù† Ø§Ù„Ø®Ù„Ù„ ØŒ ØªØ¹Ù…Ù„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø¹Ù†Ø§ Ù„Ù…Ø¯Ø© Ø£Ø³Ø¨ÙˆØ¹ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§.  ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ù‚Ø±ÙŠØ¨ Ø³ÙŠØªÙ… Ù†Ù‚Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„ÙŠÙ‡ ØŒ ÙˆÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ ØŒ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¬Ø­ Ù…ÙˆÙ‚Ù Ø¯ÙŠÙ Ù„Ø£Ø­Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹.  Ù‡Ù†Ø§Ùƒ ÙÙƒØ±Ø© Ø¹Ù† Ù‡Ø°Ø§ Ù„ÙƒØªØ§Ø¨Ø© Ø³Ù„Ø³Ù„Ø© Ù…Ù† Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØºØ·ÙŠ Ø¹Ù…Ù„ÙŠØ§Øª DevOps ØŒ Ù…Ø«Ù„: Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© ØŒ ÙˆØ¥Ø¹Ø¯Ø§Ø¯ ÙˆØ­Ø¯Ø© ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆÙ†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ø¹Ù‚Ø¯ Ø¹Ù†Ù‚ÙˆØ¯ÙŠØ© Ù…Ù†ÙØµÙ„Ø© ØŒ ÙˆØ£ØªÙ…ØªØ© ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± ØŒ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙˆØ± Ø¨Ø­Ø«Ù‹Ø§ Ø¹Ù† Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù ØŒ ÙˆØ§Ù„Ù†Ø´Ø± ØŒ Ø¥Ù„Ø®.  ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø«Ù†Ø§Ø¡ ØŒ Ø³Ù†Ù†Ø¸Ø± ÙÙŠ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø¹Ù…Ù„ ØŒ ÙˆÙ†Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆÙ†Ø·ÙˆØ± Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©. </p><br><p style=";text-align:right;direction:rtl">  Ø£ÙŠØ¶Ù‹Ø§ ØŒ Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù†Ø´Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© ØªØ¬Ø§ÙˆØ² Ø§Ù„ÙØ´Ù„ Ù…Ø¹ Ø¹Ø§Ù…Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ø¡ ØŒ Ù…Ø§ Ø¹Ù„ÙŠÙƒ Ø³ÙˆÙ‰ ØªØ«Ø¨ÙŠØª Ø¹Ø§Ù…Ù„ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ø¥Ø±Ø³Ø§Ø¡</a> ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø© Ù…Ù† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ«Ø§Ø¦Ù‚ Kubernetes Ø§Ù„Ø±Ø³Ù…ÙŠØ©</a> ÙˆØªØ®Ø·ÙŠ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙˆØªÙƒÙˆÙŠÙ† ØªÙ‡ÙŠØ¦Ø© kubeadm. </p><br><p style=";text-align:right;direction:rtl">  Ø£Ùˆ ÙŠÙ…ÙƒÙ†Ùƒ ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙˆØ§Ù„Ø±Ø³Ùˆ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ù…Ø¶ÙŠÙ ØŒ ÙˆÙƒÙ…Ø§ ÙŠØ¤ÙƒØ¯ Ø§Ù„Ù…Ø·ÙˆØ±ÙˆÙ† ØŒ Ø³ÙŠØ¹Ù…Ù„ÙˆÙ† Ù…Ø¹Ù‹Ø§ Ø¨Ø´ÙƒÙ„ Ù…Ø«Ø§Ù„ÙŠ.  Ø¥Ù† Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ù‡ÙŠ Ø¨ÙŠØ¦Ø© Ø¥Ø·Ù„Ø§Ù‚ Ø­Ø§ÙˆÙŠØ§Øª konbernetes ØŒ ÙˆØ§Ù„Ù…Ø±Ø³Ù‰ ÙŠØ´Ø¨Ù‡ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…ÙŠÙ†Ø§Ø¡ ØªÙ…Ø§Ù…Ù‹Ø§))) </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/qj/f2/r2/qjf2r2vn_j4odysnyxytokycz9u.png"><br></p><br>  ÙŠØ­ØªÙˆÙŠ Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø¹Ù„Ù‰ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¯Ù„ÙŠÙ„ ØªØ´ØºÙŠÙ„ ØºÙŠØ± Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡</a> Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø£Ø­Ø§Ø¯ÙŠØ© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬.  ÙˆÙ„ÙƒÙ† ÙƒØ§Ù† Ø§Ù„Ø£Ù…Ø± Ø£ÙƒØ«Ø± Ø¥Ø«Ø§Ø±Ø© Ù„Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„ÙŠ Ø£Ù† "Ø£Ø±ÙØ¹" Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨ÙŠØ¯ÙŠ Ù„ÙƒÙŠ Ø£ÙÙ‡Ù… Ø¨Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØµÙŠÙ„ ØªÙƒÙˆÙŠÙ† ÙƒÙ„ Ù…ÙƒÙˆÙ† ÙˆÙÙ‡Ù… ÙƒÙŠÙÙŠØ© Ø¹Ù…Ù„Ù‡ Ø¹Ù…Ù„ÙŠÙ‹Ø§. <br><p style=";text-align:right;direction:rtl">  Ø±Ø¨Ù…Ø§ ÙÙŠ ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø£ÙŠØ§Ù… Ø³ØªØµÙ„ ÙŠØ¯ÙŠ ØŒ ÙˆØ³Ø£ÙƒØªØ¨ ÙƒØªØ§Ø¨ Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ø®Ø§Øµ Ø¨ÙŠ Ù„Ù†Ø´Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø¹ HA ØŒ Ø­ÙŠØ« Ù‚Ù…Øª Ø®Ù„Ø§Ù„ Ø§Ù„Ø£Ø´Ù‡Ø± Ø§Ù„Ø³ØªØ© Ø§Ù„Ù…Ø§Ø¶ÙŠØ© Ø¨Ù†Ø´Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ø«Ù†ÙŠ Ø¹Ø´Ø± Ù…Ù†Ù‡Ø§ ØŒ ÙˆØ±Ø¨Ù…Ø§ Ø­Ø§Ù† Ø§Ù„ÙˆÙ‚Øª Ù„Ø£ØªÙ…ØªØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©. </p><br><p style=";text-align:right;direction:rtl">  Ø£ÙŠØ¶Ø§ ØŒ Ø£Ø«Ù†Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ ØŒ ØªÙ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù†Ø³Ø®Ø© kubernetes 1.11.  ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªÙ‚Ø±Ø£</a> Ø¹Ù† Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙÙŠ Ù…Ø¯ÙˆÙ†Ø© Flant</a> Ø£Ùˆ ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù…Ø¯ÙˆÙ†Ø© kubernetes Ø§Ù„Ø±Ø³Ù…ÙŠØ©</a> .  Ù‚Ù…Ù†Ø§ Ø¨ØªØ­Ø¯ÙŠØ« Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.11 ÙˆØ§Ø³ØªØ¨Ø¯Ù„Ù†Ø§ kube-dns Ø¨Ù€ CoreDNS.  Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø°Ù„Ùƒ ØŒ Ù‚Ù…Ù†Ø§ Ø¨ØªØ¶Ù…ÙŠÙ† ÙˆØ¸ÙŠÙØ© DynamicKubeletConfig Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù…ÙƒØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ù„Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª. </p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªÙƒØ§Ù…Ù„ Kubernetes Containerd ÙŠØ°Ù‡Ø¨ GA</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªÙƒØ§Ù…Ù„ Ø­Ø§ÙˆÙŠØ© Kubernetes Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Docker Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¥Ù†ØªØ§Ø¬</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¬ÙŠØ«Ø¨ Ø§Ù„Ø­Ø§ÙˆÙŠØ©</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªÙˆØ«ÙŠÙ‚ Kubernetes</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆØ«Ø§Ø¦Ù‚ NGINX</a> </li></ul><br><p style=";text-align:right;direction:rtl">  Ø´ÙƒØ±Ø§ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© Ø­ØªÙ‰ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©. </p><br><p style=";text-align:right;direction:rtl">  Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø£Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ kubernetes ØŒ Ø®Ø§ØµØ©Ù‹ Ø­ÙˆÙ„ Ø§Ù„Ø¹Ù†Ø§Ù‚ÙŠØ¯ Ø§Ù„ØªÙŠ ØªØ¹Ù…Ù„ ÙÙŠ Ø¸Ø±ÙˆÙ Ø­Ù‚ÙŠÙ‚ÙŠØ© ØŒ Ù†Ø§Ø¯Ø±Ø© Ø¬Ø¯Ù‹Ø§ ÙÙŠ RuNet ØŒ ÙØ¥Ù† Ù…Ø¤Ø´Ø±Ø§Øª Ø¹Ø¯Ù… Ø§Ù„Ø¯Ù‚Ø© Ù…ÙˆØ¶Ø¹ ØªØ±Ø­ÙŠØ¨ ØŒ ÙˆÙƒØ°Ù„Ùƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¹Ù„Ù‰ Ù…Ø®Ø·Ø· Ù†Ø´Ø± Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¹Ø§Ù….  Ø³Ø£Ø­Ø§ÙˆÙ„ Ø£Ø®Ø°Ù‡Ø§ ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± ÙˆØ¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØµØ­ÙŠØ­Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©.  ÙˆØ£Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø§Ø¦Ù… Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ØŒ Ø¹Ù„Ù‰ githab ÙˆÙÙŠ Ø£ÙŠ Ø´Ø¨ÙƒØ§Øª Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ. </p><br><p style=";text-align:right;direction:rtl">  Ù…Ø¹ Ø®Ø§Ù„Øµ Ø§Ù„ØªÙ‚Ø¯ÙŠØ± ØŒ ÙŠÙˆØ¬ÙŠÙ†. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar415601/">https://habr.com/ru/post/ar415601/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar415591/index.html">Ø£Ø¨Ù„ Ù…Ù‡Ù†Ø¯Ø³ÙŠ ÙØ® Ù…Ø§Ùƒ Ø¨ÙˆÙƒ Ø¨Ø±Ùˆ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ÙØ®</a></li>
<li><a href="../ar415593/index.html">Ø¨Ø¹Ø¯ 6 Ø³Ù†ÙˆØ§Øª ØŒ Ù†Ø³Ø®Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‚Ø±Øµ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠ Hiren's BootCD</a></li>
<li><a href="../ar415595/index.html">Ø·Ø±Ù‚ Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù„Ø¹Ø§Ø¨ SLOT ÙƒÙ…Ø«Ø§Ù„: Ø§Ù„Ø¬Ø²Ø¡ 1</a></li>
<li><a href="../ar415597/index.html">Postfix - amavisd-new Ø¨Ø¯ÙˆÙ† Ù…Ø¶ÙŠÙ Ù…Ø­Ù„ÙŠ Ø£Ùˆ Ø®Ø§Ø¯Ù… Ø¨Ø±ÙŠØ¯ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</a></li>
<li><a href="../ar415599/index.html">ØªØ±ÙŠØ¯ Ø§Ù„Ù‡Ù†Ø¯ Ø£ÙŠØ¶Ù‹Ø§ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙŠÙ„ÙŠÙˆÙ… -3</a></li>
<li><a href="../ar415605/index.html">ÙƒÙŠÙ Ø­ÙØ¸Ù†Ø§ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Exadata</a></li>
<li><a href="../ar415611/index.html">PKI: Ù…ÙƒØªØ¨Ø§Øª GCrypt Ùˆ KSBA ÙƒØ¨Ø¯ÙŠÙ„ Ù„Ù€ OpenSSL Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø±ÙˆØ³ÙŠ. Ø§Ø³ØªÙ…Ø±Ø§Ø±</a></li>
<li><a href="../ar415613/index.html">Ù„Ù…Ø§Ø°Ø§ Ù„Ø§ ØªØ´ØªØ±ÙŠ Ø«Ø±ÙŠØ§Øª LED</a></li>
<li><a href="../ar415615/index.html">Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ù† Ø®Ù„Ø§Ù„ API ÙÙŠ iOS Ø¹Ù„Ù‰ Swift 3. Part 2</a></li>
<li><a href="../ar415617/index.html">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© InternetPCools FPC ÙÙŠ Ø¯Ù„ÙÙŠ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>