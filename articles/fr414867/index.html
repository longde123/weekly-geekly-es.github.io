<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüîß üòí üôÖüèº ThinkingHome.Migrator - migration versionn√©e du sch√©ma de base de donn√©es sur la plate-forme .NET Core üë©üèΩ‚ÄçüöÄ üèáüèΩ ü§ü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Aujourd'hui, j'ai publi√© une nouvelle version de ThinkingHome.Migrator - un outil pour la migration versionn√©e d'un sch√©ma de base de donn√©es ve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ThinkingHome.Migrator - migration versionn√©e du sch√©ma de base de donn√©es sur la plate-forme .NET Core</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414867/"><p>  Salut  Aujourd'hui, j'ai publi√© une nouvelle version de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ThinkingHome.Migrator</a> - un outil pour la migration versionn√©e d'un sch√©ma de base de donn√©es vers la plate-forme .NET Core. <br><img src="https://habrastorage.org/webt/yi/xf/gf/yixfgf4_v0d3mrkmwa7nqbv2v_m.jpeg"></p><br><p>  Packages <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publi√©s dans NuGet</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation d√©taill√©e</a> √©crite.  Vous pouvez d√©j√† utiliser le nouveau migrateur, et je vais vous dire comment il est apparu, pourquoi il a la version 3.0.0 (bien que ce soit la premi√®re version) et pourquoi il est n√©cessaire quand il y a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">EF Migrations</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FluentMigrator</a> . </p><a name="habracut"></a><br><h2 id="kak-vsyo-nachinalos">  Comment tout a commenc√© </h2><br><p> Il y a 9 ans, en 2009, j'ai travaill√© en tant que d√©veloppeur ASP.NET.  Lorsque nous avons publi√© notre projet, une personne sp√©ciale est rest√©e debout tard et, en m√™me temps, mettant √† jour les fichiers sur le serveur, a ex√©cut√© des scripts SQL avec ses mains pour mettre √† jour les bases de donn√©es dans le prod.  Nous avons recherch√© un outil qui le ferait automatiquement et avons trouv√© le projet <a href="">Migrator.NET</a> . </p><br><p>  Le migrant a propos√© une nouvelle id√©e pour l'√©poque: d√©finir les modifications de la base de donn√©es sous la forme de migrations.  Chaque migration contient une petite partie des modifications et poss√®de un num√©ro de version dans lequel la base de donn√©es ira une fois termin√©e.  Le migrant lui-m√™me a gard√© une trace des versions et a effectu√© les migrations n√©cessaires dans l'ordre n√©cessaire.  Le fait que le migrateur ait permis de d√©finir des changements inverses pour chaque migration √©tait particuli√®rement cool.  Il √©tait possible de d√©finir la version en dessous de la version actuelle lorsque le migrant a d√©marr√©, et il ram√®nerait automatiquement la base de donn√©es vers cette version, effectuant les migrations n√©cessaires dans l'ordre inverse. </p><br><pre><code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">Migration(1)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AddAddressTable</span></span> : <span class="hljs-title"><span class="hljs-title">Migration</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Up</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Database.AddTable(<span class="hljs-string"><span class="hljs-string">"Address"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column(<span class="hljs-string"><span class="hljs-string">"id"</span></span>, DbType.Int32, ColumnProperty.PrimaryKey), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column(<span class="hljs-string"><span class="hljs-string">"street"</span></span>, DbType.String, <span class="hljs-number"><span class="hljs-number">50</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Column(<span class="hljs-string"><span class="hljs-string">"city"</span></span>, DbType.String, <span class="hljs-number"><span class="hljs-number">50</span></span>) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Down</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Database.RemoveTable(<span class="hljs-string"><span class="hljs-string">"Address"</span></span>); } }</code> </pre> <br><p>  Il y avait beaucoup d'erreurs dans ce migrant.  Il ne savait pas comment travailler avec des sch√©mas de base de donn√©es autres que le sch√©ma par d√©faut.  Dans certains cas, il a g√©n√©r√© des requ√™tes SQL incorrectes et si vous sp√©cifiez un num√©ro de version inexistant, il tombe dans une boucle infinie.  En cons√©quence, mes coll√®gues et moi avons bifurqu√© le projet et corrig√© des bugs l√†-bas. </p><br><p>  GitHub.com avec ses fourchettes et demandes de pull n'√©tait pas l√† alors (le code du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">migrant</a> √©tait sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code.google.com</a> ).  Par cons√©quent, nous n'avons surtout pas pris la peine de nous assurer que nos modifications reviennent dans le projet d'origine - nous venons de scier notre copie et de l'utiliser nous-m√™mes.  Au fil du temps, nous avons r√©√©crit la majeure partie du projet et je suis devenu son principal responsable.  J'ai ensuite post√© le code de notre migrateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur google code</a> et √©crit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article sur Habr</a> .  Il y avait donc ECM7.Migrator. </p><br><p>  Lors des travaux sur le migrateur, nous l'avons presque enti√®rement r√©√©crit.  En m√™me temps, ils ont un peu simplifi√© l'API et couvert tout avec des tests automatiques.  Personnellement, j'ai vraiment appr√©ci√© d'utiliser ce qui s'est pass√©.  Contrairement au migrateur d'origine, il y avait un sentiment de fiabilit√© et il n'y avait aucun sentiment qu'une magie √©trange se produisait. </p><br><p>  Il s'est av√©r√© que non seulement j'aimais notre migrateur.  Pour autant que je sache, il a √©t√© utilis√© dans des entreprises assez importantes.  Je connais ABBYY, BARS Group et concert.ru.  Si vous tapez dans la requ√™te de recherche "migrateur ecm7", vous pouvez voir dans les r√©sultats des articles √† ce sujet, des mentions dans le CV, des descriptions d'utilisation dans le travail √©tudiant.  Parfois, je recevais des lettres d'√©trangers avec des questions ou des mots de gratitude. </p><br><p>  Apr√®s 2012, le projet ne s'est presque pas d√©velopp√©.  Ses capacit√©s actuelles couvraient toutes les t√¢ches que j'avais et je ne voyais pas la n√©cessit√© de terminer quelque chose. </p><br><h2 id="thinkinghomemigrator">  ThinkingHome.Migrator </h2><br><p>  L'ann√©e derni√®re, j'ai commenc√© √† travailler sur un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet</a> sur .NET Core.  L√†, il √©tait n√©cessaire de permettre la connexion des plugins, et les plugins devraient pouvoir cr√©er la structure de base de donn√©es n√©cessaire pour y stocker leurs donn√©es.  C'est exactement une telle t√¢che, pour laquelle un migrant est bien adapt√©. </p><br><h3 id="ef-migrations">  Migrations EF </h3><br><p>  J'ai utilis√© Entity Framework Core pour travailler avec la base de donn√©es, donc la premi√®re chose que j'ai essay√©e a √©t√© EF Migrations.  Malheureusement, j'ai d√ª abandonner presque imm√©diatement l'id√©e de les utiliser. </p><br><p>  Les migrations Entity Framework font glisser un tas de d√©pendances dans le projet et au d√©marrage, elles font de la magie sp√©ciale.  Un pas √† gauche / un pas √† droite - vous rencontrez des restrictions.  Par exemple, les migrations de Entity Framework pour une raison quelconque doivent n√©cessairement se faire dans le m√™me assembly avec <code>DbContext</code> .  Cela signifie qu'il ne sera pas possible de stocker les migrations √† l'int√©rieur des plugins. </p><br><h3 id="fluentmigrator">  Fluentmigrator </h3><br><p>  Quand il est devenu clair que EF Migrations ne convenait pas, j'ai cherch√© une solution dans google et trouv√© plusieurs migrateurs open source.  Le plus avanc√© d'entre eux, √† en juger par le nombre de t√©l√©chargements sur NuGet et d'√©toiles sur GitHub, s'est av√©r√© √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FluentMigrator</a> .  La FM est tr√®s bonne!  Il en sait beaucoup et poss√®de une API tr√®s pratique.  Au d√©but, j'ai d√©cid√© que c'√©tait ce dont j'avais besoin, mais plus tard, plusieurs probl√®mes ont √©t√© d√©couverts. </p><br><p>  Le principal probl√®me est que FluentMigrator ne sait pas prendre en compte plusieurs s√©quences de versions au sein d'une m√™me base de donn√©es.  Comme je l'ai √©crit ci-dessus, j'avais besoin d'utiliser un migrateur dans une application modulaire.  Il est n√©cessaire que les modules (plugins) puissent √™tre install√©s et mis √† jour ind√©pendamment les uns des autres.  FluentMigrator poss√®de une num√©rotation de version de bout en bout.  Pour cette raison, il est impossible d'ex√©cuter / d'annuler la migration d'un plugin de la base de donn√©es sans affecter la structure de la base de donn√©es des plugins restants. </p><br><p>  J'ai essay√© d'organiser le comportement souhait√© √† l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">balises</a> , mais ce n'est √©galement pas tout √† fait ce dont vous avez besoin.  FluentMigrator ne stocke pas les informations de balise pour les migrations termin√©es.  De plus, les balises sont li√©es aux migrations, pas aux assemblys.  C'est tr√®s √©trange, √©tant donn√© que le point d'entr√©e pour la migration est exactement l'assemblage.  En principe, il √©tait probablement possible de faire des versions parall√®les de cette mani√®re, mais vous devez √©crire un wrapper assez compliqu√© sur le migrateur. </p><br><h3 id="portirovat-ecm7migrator-na-net-core">  Portez ECM7.Migrator vers .NET Core </h3><br><p>  Au d√©but, cette option n'√©tait m√™me pas envisag√©e.  √Ä cette √©poque, la version actuelle de .NET Core √©tait 1.1 et son API √©tait mal compatible avec le .NET Framework, dans lequel ECM7.Migrator fonctionnait.  J'√©tais s√ªr que le porter sur .NET Core serait difficile et prendrait du temps.  Quand il n'y avait pas d'options pour ¬´prendre le fini¬ª, j'ai d√©cid√© de l'essayer.  La t√¢che a √©t√© plus facile que ce √† quoi je m'attendais.  √âtonnamment, cela a fonctionn√© presque imm√©diatement.  Seules des modifications mineures ont √©t√© requises.  La logique du migrateur ayant √©t√© couverte par des tests, tous les endroits qui se sont cass√©s √©taient imm√©diatement visibles et je les ai rapidement r√©par√©s. </p><br><p>  Maintenant, j'ai port√© des adaptateurs pour seulement quatre SGBD: MS SQL Server, PostgreSQL, MySQL, SQLite.  Je n'ai pas port√© d'adaptateurs pour Oracle (car il n'y a toujours pas de client stable pour .NET Core), MS SQL Server CE (car il ne fonctionne que sous Windows et je n'ai pas de place pour l'ex√©cuter) et Firebird (car il pas tr√®s populaire, port plus tard).  En principe, si vous devez cr√©er des fournisseurs pour ces SGBD ou d'autres - c'est assez simple. </p><br><p>  Le code source du nouveau migrateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est sur GitHub</a> .  Configuration du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lancement des tests pour chaque SGBD</a> dans Travis CI.  Un utilitaire de ligne de commande ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">.NET Core Global Tool</a> ) a √©t√© √©crit et peut √™tre facilement <a href="">install√© √† partir de NuGet</a> .  La documentation est √©crite - j'ai essay√© tr√®s fort d'√©crire en d√©tail et clairement et, semble-t-il, cela s'est produit.  Vous pouvez prendre et utiliser! </p><br><h3 id="nemnogo-pro-nazvanie">  Un peu sur le nom ... </h3><br><p>  Le nouveau migrateur n'a pas de compatibilit√© descendante avec l'ancien.  Ils travaillent sur diff√©rentes plates-formes et ils ont une API diff√©rente.  Par cons√©quent, le projet est publi√© sous un nom diff√©rent. </p><br><p>  Le nom a √©t√© choisi par le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ThinkingHome</a> , pour lequel j'ai port√© un migrateur.  En fait, ECM7.Migrator est √©galement nomm√© pour le projet sur lequel je travaillais √† ce moment-l√†. </p><br><p>  Peut-√™tre valait-il mieux choisir un nom neutre, mais je ne pensais pas avoir de bonnes options.  Si vous le savez - √©crivez dans les commentaires.  Il n'est pas trop tard pour tout renommer. </p><br><p>  Le num√©ro de version indiqu√© 3.0.0, car  le nouveau migrateur est une continuation logique de l'ancien. </p><br><h2 id="bystryy-start">  D√©marrage rapide </h2><br><p>  Essayons donc d'utiliser un migrateur. </p><br><p>  Toutes les modifications de la base de donn√©es sont enregistr√©es dans le code de migration - classes √©crites dans un langage de programmation (par exemple, en C #).  Les classes de migration h√©ritent de la classe de base <code>Migration</code> du package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ThinkingHome.Migrator.Framework</a> .  Dans ceux-ci, vous devez remplacer les m√©thodes de la classe de base: <code>Apply</code> (appliquer les modifications) et <code>Revert</code> (annuler les modifications).  √Ä l'int√©rieur de ces m√©thodes, le d√©veloppeur, √† l'aide d'une <a href="">API sp√©ciale,</a> d√©crit les actions qui doivent √™tre effectu√©es sur la base de donn√©es. </p><br><p>  De plus, la classe de migration doit √™tre marqu√©e avec l'attribut <code>[Migration]</code> et indiquer la version dans laquelle la base de donn√©es ira apr√®s ces modifications. </p><br><h3 id="primer-migracii">  Exemple de migration </h3><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ThinkingHome.Migrator.Framework; [Migration(<span class="hljs-number"><span class="hljs-number">12</span></span>)] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MyTestMigration : Migration { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-type"><span class="hljs-type">void</span></span> Apply() { //  :   <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>.AddTable("CustomerAddress", <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Column</span></span>("customerId", DbType.Int32, ColumnProperty.PrimaryKey), <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Column</span></span>("addressId", DbType.Int32, ColumnProperty.PrimaryKey)); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-type"><span class="hljs-type">void</span></span> Revert() { //  :   <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>.RemoveTable("CustomerAddress"); //     ,  //  Revert    } }</code> </pre> <br><h3 id="kak-zapustit">  Comment courir </h3><br><p>  Les migrations sont compil√©es dans un fichier .dll.  Apr√®s cela, vous pouvez effectuer des modifications de base de donn√©es √† l'aide de l'utilitaire de console <code>migrate-database</code> .  Pour commencer, installez-le √† <a href="">partir de NuGet</a> . </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">dotnet</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">tool</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">install</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-g</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">thinkinghome</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.migrator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.cli</span></span></code> </pre> <br><p>  Ex√©cutez <code>migrate-database</code> , en sp√©cifiant le type de SGBD requis, la cha√Æne de connexion et le chemin d'acc√®s au fichier .dll avec les migrations. </p><br><pre> <code class="hljs pgsql">migrate-<span class="hljs-keyword"><span class="hljs-keyword">database</span></span> postgres "host=localhost;port=5432;database=migrations;" /<span class="hljs-type"><span class="hljs-type">path</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>/migrations.dll</code> </pre> <br><h3 id="zapuskaem-cherez-api">  Parcourez l'API </h3><br><p>  Vous pouvez effectuer des migrations via l'API √† partir de votre propre application.  Par exemple, vous pouvez √©crire une application qui, lorsqu'elle est lanc√©e, cr√©e elle-m√™me la structure de base de donn√©es souhait√©e. </p><br><p>  Pour ce faire, connectez le package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ThinkingHome.Migrator</a> de NuGet et le package avec le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fournisseur de transformation pour le SGBD requis</a> √† votre projet.  Apr√®s cela, cr√©ez une instance de la classe <code>ThinkingHome.Migrator.Migrator</code> et appelez sa m√©thode <code>Migrate</code> , en passant la version requise de la base de donn√©es en tant que param√®tre. </p><br><pre> <code class="hljs powershell">var version = <span class="hljs-literal"><span class="hljs-literal">-1</span></span>; //  <span class="hljs-literal"><span class="hljs-literal">-1</span></span>     var provider = <span class="hljs-string"><span class="hljs-string">"postgres"</span></span>; var connectionString = <span class="hljs-string"><span class="hljs-string">"host=localhost;port=5432;database=migrations;"</span></span>; var assembly = Assembly.LoadFrom(<span class="hljs-string"><span class="hljs-string">"/path/to/migrations.dll"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (var migrator = new Migrator(provider, connectionString, <span class="hljs-keyword"><span class="hljs-keyword">assembly</span></span>)) { migrator.Migrate(version); }</code> </pre> <br><p>  √Ä propos, vous pouvez comparer avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'</a> exemple de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lancement</a> FluentMigrator. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  J'ai essay√© de cr√©er un outil simple sans d√©pendances et sans magie complexe.  Cela semble avoir tr√®s bien fonctionn√©.  Le projet n'a pas √©t√© grossier depuis longtemps, tout est couvert de tests, il y a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une documentation d√©taill√©e</a> en russe.  Si vous utilisez .NET Core 2.1, essayez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouveau migrateur</a> .  Vous l'aimerez probablement aussi. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414867/">https://habr.com/ru/post/fr414867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414855/index.html">Une s√©lection de nouveaux livres sur Python pour tous ceux qui sont sur le point de l'apprendre</a></li>
<li><a href="../fr414857/index.html">Entretien avec Ilya Stenkov, fondatrice du march√© de la cryptographie</a></li>
<li><a href="../fr414859/index.html">Comment utiliser une cam√©ra USB avec ROS sur un Raspberry Pi ou BeagleBone Blue - pour diffuser des vid√©os sur un grand ordinateur</a></li>
<li><a href="../fr414861/index.html">Mod√©lisation de tunnel - Version 1.0</a></li>
<li><a href="../fr414865/index.html">iMaterialist Furniture Challenge ou 50 nuances de chaises</a></li>
<li><a href="../fr414869/index.html">Cadres en voie de disparition</a></li>
<li><a href="../fr414871/index.html">La temp√™te de poussi√®re sur Mars a atteint l'√©chelle plan√©taire, m√™me la curiosit√© est affect√©e</a></li>
<li><a href="../fr414873/index.html">IDisposable - que votre maman n'a pas parl√© de lib√©rer des ressources. Partie 1</a></li>
<li><a href="../fr414875/index.html">L'int√©gration Kubernetes Container remplace Docker pr√™t pour la production</a></li>
<li><a href="../fr414877/index.html">Un objectif inhabituel pour un appareil photo ordinaire ou comment arr√™ter de penser √† la mise au point</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>