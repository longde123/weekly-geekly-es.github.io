<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶â üòõ üê≤ C√≥mo crear un modelo con mayor precisi√≥n que transfermarkt y no predecir o qu√© afecta el costo de las transferencias sobre todo üßíüèΩ üë©üèø‚Äçü§ù‚Äçüë©üèΩ üîÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tratar√© de decirle lo f√°cil que es obtener resultados interesantes simplemente aplicando un enfoque completamente est√°ndar del tutorial del curso de a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo crear un modelo con mayor precisi√≥n que transfermarkt y no predecir o qu√© afecta el costo de las transferencias sobre todo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468107/"><p>  Tratar√© de decirle lo f√°cil que es obtener resultados interesantes simplemente aplicando un enfoque completamente est√°ndar del tutorial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">del curso de aprendizaje autom√°tico a los</a> datos que no se utilizan en Deep Learning.  La esencia de mi publicaci√≥n es que podemos ser cada uno de nosotros, solo necesita mirar la variedad de informaci√≥n que conoce bien.  Para hacer esto, de hecho, es mucho m√°s importante simplemente comprender bien sus datos que ser un experto en las √∫ltimas estructuras de redes neuronales.  Es decir, en mi opini√≥n, estamos en ese punto de oro en el desarrollo de DL, cuando por un lado ya es una herramienta que se puede usar sin la necesidad de ser un doctorado, y por otro todav√≠a hay muchas √°reas en las que nadie realmente lo us√≥, si se mira Un poco m√°s all√° de los temas tradicionales. </p><br><p><img src="https://habrastorage.org/webt/id/tl/1d/idtl1dxx4ixh6ycstgzi8nsn8ks.jpeg"></p><a name="habracut"></a><br><p>  Al leer art√≠culos y de paso viendo c√≥mo se desarrolla el aprendizaje autom√°tico, usted y yo podemos sentir f√°cilmente que este tren est√° pasando.  De hecho, si toma los cursos m√°s famosos (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Andrew Ng</a> ) o la mayor√≠a de los art√≠culos sobre Habr√© de la misma excelente comunidad de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Open Data Science,</a> r√°pidamente se dar√° cuenta de que no hay nada que hacer aqu√≠ desde la memoria profunda del conocimiento del instituto en matem√°ticas superiores, bueno, al menos algunos Los resultados correctos (incluso en ejemplos de " <em>juguetes</em> ") se pueden lograr solo despu√©s de varias semanas de estudiar la teor√≠a de Terry y diferentes formas de su implementaci√≥n.  Pero a menudo quiere otro, quiere tener una herramienta que realice su funci√≥n, que resuelva una cierta clase de problemas, de modo que, al aplicarlo en su campo, obtenga el resultado.  De hecho, en otras √°reas todo es exactamente as√≠, si usted, por ejemplo, escribe un juego y su tarea es garantizar la transferencia de informaci√≥n del jugador al servidor, entonces no estudia la teor√≠a de los gr√°ficos, no descubre c√≥mo optimizar la conectividad para que sus paquetes lleguen m√°s r√°pido: toma la herramienta (biblioteca, marco) que hace esto por usted y se enfoca en lo que es exclusivo de una tarea en particular (por ejemplo, qu√© tipo de informaci√≥n necesita transferir de un lado a otro).  ¬øPor qu√© esto no es as√≠ para el aprendizaje profundo? </p><br><p>  De hecho, ahora estamos al borde del tiempo en que se est√° volviendo <em>casi as√≠</em> .  Y para m√≠, <em>casi encontr√© esa</em> herramienta oh - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">fast.ai.</a>  Una biblioteca excelente y un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">curso a√∫n m√°s pronunciado,</a> cuyo principio completo se construye "de arriba hacia abajo": primero resolver problemas reales, a menudo en el nivel de precisi√≥n de la predicci√≥n de los modelos de estado del arte, hasta la estructura interna de la biblioteca y la teor√≠a detr√°s de ella. </p><br><div class="spoiler">  <b class="spoiler_title">Por supuesto, no todo es tan simple.</b> <div class="spoiler_text"><p>  Anticipando las acusaciones de falta de profesionalismo y la superficialidad de mi conocimiento (que, por supuesto, es m√°s cierto que no), quiero hacer una reserva de inmediato.  ¬øEs necesario estudiar la teor√≠a, ver esas conferencias fundamentales, recordar el c√°lculo de la matriz, etc.?  Por supuesto que lo es.  Y cuanto m√°s profundice en el tema, m√°s lo necesitar√° y tendr√° que aferrarse a las fuentes principales.  Pero cuanto m√°s consciente sea la inmersi√≥n, m√°s f√°cil ser√° comprender exactamente c√≥mo estos fundamentos afectan el resultado.  El punto principal del principio de arriba hacia abajo es precisamente que debe hacerse despu√©s.  Despu√©s de que ya hayas escrito algo tangible que puedes mostrar a tus amigos.  Despu√©s de que te hayas sumergido lo suficiente en el tema y te haya fascinado.  Y la teor√≠a en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">conocimiento</a> lo superar√°, solo se presenta en el momento en que ser√° m√°s f√°cil para usted correlacionarlo con lo que ya ha hecho.  Como una explicaci√≥n de por qu√© y c√≥mo funciona realmente. </p><br><p>  Estoy m√°s que seguro de que alguien se siente m√°s c√≥modo con el enfoque tradicional de abajo hacia arriba.  Y es bueno que haya dos maneras, lo principal es que nos encontremos en el medio </p></div></div><br><p>  Con tal conjunto de conocimiento, decid√≠ aplicar DL a un tema que yo mismo hab√≠a estado interesado durante mucho tiempo y ver a qu√© puede conducir.  Y, por supuesto, lo primero que me vino a la mente fue el f√∫tbol.  Y cuando encontr√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">estas maravillosas estad√≠sticas de</a> transferencia en kaggle, la elecci√≥n se hizo a√∫n m√°s obvia. </p><br><p>  Un poco sobre estos datos.  Contienen informaci√≥n sobre qui√©n y d√≥nde se mud√≥ al f√∫tbol europeo en los √∫ltimos 10 a√±os.  Hay informaci√≥n sobre clubes, estad√≠sticas de jugadores, ligas en las que participan, entrenadores y agentes, y mucho m√°s (hay m√°s de cien campos diferentes en total).  Los datos son muy interesantes, pero ¬øes posible determinar cu√°nto deber√≠a costar un jugador? </p><br><p><img src="https://habrastorage.org/webt/q9/n8/bb/q9n8bbmosrfwyf0bhzu7pio3o0u.jpeg"></p><br><p>  Si lo piensas bien, el precio de un jugador depende de una gran cantidad de factores.  Al mismo tiempo, es genial, <strong>y</strong> yo (si no la mayor√≠a) su parte es simplemente no formalizable.  C√≥mo entender que el club acaba de vender al jugador a un precio alto, necesita un atacante y est√° listo para pagar de m√°s;  c√≥mo entender que un nuevo entrenador ha venido y requiere actualizar la lista;  ¬øC√≥mo entender que el defensor principal del club se dio cuenta del grandioso y comenz√≥ a jugar a medias, exigiendo una transferencia?  Todo esto afecta fundamentalmente el monto de una transacci√≥n, pero no se presenta en los datos.  A partir de eso, mis expectativas iniciales sobre la precisi√≥n de tal pron√≥stico fueron peque√±as. </p><br><div class="spoiler">  <b class="spoiler_title">Soy un programador falso</b> <div class="spoiler_text"><p> En este punto, es hora de insertar el descargo de responsabilidad est√°ndar de que <code>#</code> un <code>#</code> , no gano dinero con esto, por lo que mi c√≥digo es terrible, y lo m√°s probable es que pueda (y deber√≠a) reescribirse mucho mejor, pero dado que la tarea era investigar la idea y (no ?) Confirme la teor√≠a, entonces el c√≥digo es lo que es :) </p></div></div><br><h4 id="model">  Modelo </h4><br><p>  Comenc√© excluyendo transferencias m√°s baratas que $ 1 mill√≥n, que son demasiado ca√≥ticas.  Luego reuni√≥ todos los datos en una gran tabla con un campo y medio, en el que para cada transferencia hab√≠a toda la informaci√≥n disponible sobre √©l (tanto sobre la transferencia en s√≠, el jugador y sus estad√≠sticas, como sobre los clubes que participan en ella, ligas, etc. ) </p><br><p>  Veamos los pasos de c√≥mo cre√© el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">modelo</a> : </p><br><p>  Despu√©s de completar todas las importaciones de Python y cargar la tabla de transferencia desnormalizada, lo primero que debemos determinar es cu√°l de los campos consideraremos num√©ricos y cu√°les son categ√≥ricos.  Este es un tema muy interesante en s√≠ mismo, puede hablar sobre √©l en los comentarios, pero para ahorrar tiempo, solo describo la regla que uso: por defecto, considero todos los campos categ√≥ricos, excepto aquellos que est√°n representados como n√∫meros de punto flotante o aquellos donde el n√∫mero de valores diferentes es lo suficientemente grande. </p><br><p>  En este contexto, por ejemplo, considero el a√±o de transferencia categ√≥rico, aunque inicialmente es un n√∫mero, porque el n√∫mero de valores diferentes es peque√±o aqu√≠ (10 - de 2008 a 2018).  Pero, por ejemplo, el rendimiento del jugador en la √∫ltima temporada (que est√° representado por el n√∫mero promedio de sus goles por partido) es flotante y puede tomar casi cualquier valor, por lo que lo considero num√©rico. </p><br><pre> <code class="python hljs">cat_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'season'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_year'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_month'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_day'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_till_deadline'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_months'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_years'</span></span>,<span class="hljs-string"><span class="hljs-string">'age'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_midseason'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_loan'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_end_of_loan'</span></span>, <span class="hljs-string"><span class="hljs-string">'nat_national_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_main'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_positions'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_nationality_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_nationality_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_place_of_birth_country_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_foot'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_height'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_player_agent'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_is_first_team'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_place'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_qualified_to'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_cup_winner'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_is_promoted'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_country'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_group'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_club_is_first_team'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_place'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_qualified_to'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_cup_winner'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_promoted'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_lg_country'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_group'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_position_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_2'</span></span>) cont_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'nat_months_from_debut'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_matches_played'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_goals_scored'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_pts_avg'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_pts_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_apps_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_minutes_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_cards_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_conc_gols_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'pop_log1p'</span></span>)</code> </pre> <br><p>  Luego, despu√©s de indicar expl√≠citamente lo que predeciremos: la cantidad de transferencia ( <code>fee</code> ), dividimos aleatoriamente nuestros datos en 2 partes de 80% y 20%.  En el primero de ellos, ense√±aremos a nuestra red neuronal, por el otro, a verificar la precisi√≥n de la predicci√≥n. </p><br><pre> <code class="python hljs">ln = len(df) valid_idx = np.random.choice(ln, int(ln*<span class="hljs-number"><span class="hljs-number">0.2</span></span>), replace=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><p>  En la √∫ltima etapa preparatoria, debemos elegir c√≥mo mediremos la plausibilidad de nuestras predicciones.  Luego eleg√≠ no la m√©trica m√°s est√°ndar en la parte local del universo: la mediana del porcentaje de error ( <code>MdAPE</code> ).  O, para decirlo de manera m√°s simple, ¬øcu√°nto porcentaje (el precio absoluto de una transferencia puede diferir en √≥rdenes de magnitud) probablemente cometer√° un error en el precio de una transferencia tomada al azar.  Me pareci√≥ lo m√°s cercano a lo que significa para m√≠ exactamente la frase "precisi√≥n del sistema de predicci√≥n de transferencia". </p><br><p>  Ahora es el momento, de hecho, de comenzar a aprender la red. </p><br><pre> <code class="python hljs">data = (TabularList.from_df(df, path=path, cat_names=cat_vars, cont_names=cont_vars, procs=procs) .split_by_idx(valid_idx) .label_from_df(cols=dep_var, label_cls=FloatList, log=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) .databunch(bs=BS)) learn = tabular_learner(data, layers=layers, ps=layers_drop, emb_drop=emb_drop, y_range=y_range, metrics=exp_mmape, loss_func=MAELossFlat(), callback_fns=[CSVLogger]) learn.fit_one_cycle(cyc_len=cycles, max_lr=max_lr, wd=w_decay)</code> </pre> <br><h4 id="tochnost-predskazaniy">  Precisi√≥n de la predicci√≥n </h4><br><p><img src="https://habrastorage.org/webt/-z/kl/zj/-zklzjwczjcogqhqq93hrxjcfc8.png"></p><br><p>  <code>Validation Error = 0.3492</code> significa que despu√©s de entrenar en un nuevo <code>validation set</code> datos ( <code>validation set</code> , <code>validation set</code> ), el modelo en promedio (mediana) est√° 34% equivocado en relaci√≥n con el precio de transferencia real.  Y lo obtuvimos solo como resultado de varias l√≠neas de c√≥digo tomadas del tutorial. </p><br><p>  34% de error, ¬øes mucho o poco?  Todo es relativo  La √∫nica fuente comparable, cuyos datos pueden tomarse como una " <em>predicci√≥n</em> " del monto de la transferencia, es, por supuesto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">transfermarkt</a> .  Afortunadamente, hay un campo en los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">datos de kaggle</a> que muestra c√≥mo este sitio calific√≥ a un jugador en el momento de la transferencia, y esto se puede comparar.  Cabe se√±alar aqu√≠ que transfermarkt nunca afirm√≥ que su <code>market value</code> sea ‚Äã‚Äãel precio de transferencia probable.  Por el contrario, enfatizaron que es m√°s bien el " <em>valor honesto</em> " de uno u otro jugador.  Y cu√°nto dinero pagar√° un club en particular en una situaci√≥n particular es algo muy individual y puede fluctuar en una direcci√≥n u otra dentro de l√≠mites muy amplios.  Pero esto es lo mejor que tenemos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">comparemos</a> . </p><br><p><img src="https://habrastorage.org/webt/an/jz/4l/anjz4lvbdxlbqy5s26q8gd5_vig.png"></p><br><p>  Error de transferencia de marca - <strong>35%</strong> , nuestro modelo - <strong>35%</strong> .  Muy extra√±o y, para ser sincero, muy sospechoso. <br>  En este punto, me propongo pensar de nuevo.  Un sitio con una gran historia, creado solo para mostrar el 'valor' de los jugadores, que se basa en el poder total del efecto multitud (deriva el valor de las calificaciones tanto de los visitantes ordinarios como de los profesionales del mercado) y el conocimiento de los expertos, por un lado, y el modelo, que no sabe nada sobre f√∫tbol, ‚Äã‚Äãno ve nada excepto los datos que le dimos (y fuera de estos datos en el mundo real todav√≠a hay muchas cosas que las personas con transferencia tienen en cuenta), por otro lado, <strong>muestran el mismo error</strong> .  Adem√°s, nuestro modelo tambi√©n permite predecir el precio de alquiler del jugador, que el <code>market value</code> , por razones obvias, no muestra (teniendo en cuenta tales transacciones, el resultado de transfermarkt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">fue a√∫n peor</a> ). </p><br><p>  Honestamente, sigo pensando que tengo alg√∫n tipo de error aqu√≠, todo es demasiado bueno para ser verdad.  Pero, sin embargo, vamos m√°s all√°. </p><br><p>  Una manera f√°cil de probarse es tratar de promediar las predicciones de 2 fuentes (modelos y transfermarkt).  Si las predicciones son verdaderamente independientes entre s√≠ y no hay un error molesto, entonces el resultado deber√≠a mejorar. </p><br><p><img src="https://habrastorage.org/webt/uu/f0/ut/uuf0uts7ak4xrbr95efffferqvu.png"></p><br><p>  De hecho, promediar las previsiones reduce el error de predicci√≥n al 32% (!).  Esto puede parecer un poco, pero debemos entender que estamos filtrando m√°s informaci√≥n de los datos, que est√°n tan exprimidos al m√°ximo. </p><br><p>  Pero lo que haremos a continuaci√≥n, en mi opini√≥n, es a√∫n m√°s sorprendente e interesante, aunque est√° m√°s all√° del alcance del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">tutorial fast.ai.</a> </p><br><h4 id="feature-importance">  Importancia de la caracter√≠stica </h4><br><p>  Las redes neuronales, por no decir que es completamente inmerecida, a menudo se consideran una "caja negra".  Sabemos qu√© datos podemos poner all√≠, podemos obtener las predicciones del modelo, incluso podemos evaluar cu√°nto son en promedio sus predicciones.  Pero no podemos explicar con qu√© criterios el modelo "tom√≥" esta o aquella decisi√≥n.  La estructura interna de la red en s√≠ es tan compleja y, lo que es m√°s importante, no lineal, que es imposible rastrear directamente toda la cadena de toma de decisiones y sacar conclusiones significativas del mundo real a partir de ah√≠.  Pero realmente quiero hacerlo.  Me gustar√≠a entender qu√© es lo que m√°s influye en el monto de la transferencia. </p><br><p>  Bueno, no subiremos dentro de la red.  Pero, ¬øqu√© significa la importancia de cada campo, llam√©mosla <strong>Importancia de</strong> funciones (FI)?  Una opci√≥n para entender la "importancia" es calcular cu√°nto empeorar√°n las cosas si no tuvi√©ramos este campo.  Y esto es precisamente lo que podemos medir.  Ahora tenemos una herramienta que proporciona predicciones sobre cualquier conjunto de datos.  Entonces, si solo calculamos cu√°nto aumentar√° el error de predicci√≥n cuando sustituimos datos aleatorios en el campo, entonces podemos estimar cu√°nto afecta (el campo) al resultado final, lo que significa lo importante que es.  Para permanecer dentro de la distribuci√≥n real de los datos, el campo se rellenar√° no solo con n√∫meros aleatorios, sino tambi√©n con valores mezclados al azar (es decir, solo mezclaremos la columna, por ejemplo, 'a√±o de transferencia', en la tabla original).  Para fidelidad, este proceso puede llevarse a cabo varias veces para cada campo promediando el resultado.  Todo es bastante simple.  Ahora veamos qu√© tan cuerdo da el resultado: </p><br><p><img src="https://habrastorage.org/webt/ou/s8/4x/ous84xjkamb1mtigicrbsublki8.png"></p><br><p>  Mi instinto dice: "¬°S√≠ y no!" </p><br><p>  Por un lado, los campos que espera ver all√≠ estaban en la parte superior: entrenadores del equipo desde d√≥nde y d√≥nde <code>from_coach_name</code> jugador ( <code>from_coach_name</code> , <code>to_coach_name</code> ), los clubes mismos que participaron en la transferencia ( <code>from_club_name</code> , <code>to_club_name</code> ), el agente del jugador ( <code>plr_player_agent</code> ), su fama en las redes sociales ( <code>pop_log1p</code> ) etc.  Pero, por otro lado ... Intuitivamente, no parece que los nombres de los entrenadores tengan m√°s peso en el precio de transferencia que, por ejemplo, los clubes mismos (sabemos bien que el Benfica condicional puede vender a sus jugadores caros).  Es la marca de un entrenador m√°s influyente en el precio que la marca del club.  ¬øLa llegada del condicional Mancini obliga al club a pagar de m√°s?  ¬øCu√°l es el caso cuando los datos nos dan informaci√≥n nueva, ligeramente contraintuitiva, o simplemente un error en el modelo? </p><br><p>  Vamos a hacerlo bien.  Al observar de cerca el gr√°fico, el ojo se aferra r√°pidamente a algo extra√±o.  Justo debajo del centro hay 2 campos <code>trs_year</code> y de <code>season</code> <code>trs_year</code> , representan el a√±o de la transferencia y la temporada en la que se realizar√° la transici√≥n (en general, pueden no coincidir, aunque esto no sucede con tanta frecuencia).  En primer lugar, parece que deber√≠an ser m√°s altos, sabemos cu√°nto han subido los precios de los jugadores de f√∫tbol en los √∫ltimos a√±os y, en segundo lugar, obviamente significan lo mismo.  ¬øQu√© hacer al respecto?  ¬øSolo resumir su importancia?  ¬°No es el hecho de que esto se pueda hacer!  Pero lo que definitivamente podemos hacer es aplicar el mismo enfoque (mezclar valores) no por separado a estos dos campos, sino como un grupo.  Es decir, mida c√≥mo cambiar√° el error si hay valores aleatorios en estas 2 columnas a la vez.  Bueno, como hemos estado haciendo esto a lo largo de los a√±os, necesitamos ver si tenemos otros campos que est√©n tan 'conectados'. </p><br><p>  Por ejemplo, para un club, tenemos varios par√°metros: el propio club ( <code>club_name</code> ), as√≠ como un conjunto de informaci√≥n sobre el mismo, de qu√© liga, pa√≠s, etc.  ( <code>club_is_first_team</code> , <code>clb_lg_name</code> , <code>clb_lg_country</code> , <code>clb_lg_group</code> ).  Solo en algunos casos estamos interesados ‚Äã‚Äãen saber cu√°nto afecta el precio, por ejemplo, el pa√≠s al que va el jugador por separado ( <code>clb_lg_country</code> ), lo m√°s frecuente es que comprendamos cu√°l es el peso total del campo 'club', que ya est√° en un determinado pa√≠s, liga, etc. . </p><br><p>  Por lo tanto, podemos combinar todos los campos en grupos de acuerdo con el contenido sem√°ntico.  Esto nos ayudar√° como un simple conocimiento del √°rea tem√°tica y el sentido com√∫n, as√≠ como la "proximidad" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">calculada</a> de las caracter√≠sticas.  El √∫ltimo solo muestra c√≥mo los campos se correlacionan entre s√≠, es decir, cu√°nto es posible considerarlos como un solo grupo. </p><br><p>  Aplicando este enfoque, obtenemos un gr√°fico a√∫n m√°s intuitivo de la importancia de los campos: </p><br><p><img src="https://habrastorage.org/webt/gu/mc/ma/gumcmafyqlu-ognduuxghf02xww.png"></p><br><p>  Ah√≠ tienes.  Exactamente qu√© palo compra m√°s el jugador afecta el monto de la transferencia, con un margen muy bueno.  Hi Man City, Barcelona, ‚Äã‚ÄãZenit y, por ejemplo, el mismo Benfica (despu√©s de todo, " <em>influye mucho</em> ", tambi√©n es el hecho de que algunos clubes, por el contrario, pueden comprar jugadores de calidad m√°s baratos que el "mercado").  Me parece que lo m√°s interesante al trabajar con datos es que, cuando se obtienen, las conclusiones son obvias, por un lado (bueno, dud√© de que el comprador del club tuviera la influencia m√°s poderosa sobre el monto de la transferencia), y por otro lado, es un poco sorprendente (y los candidatos para el primero el lugar, intuitivamente, podr√≠a ser algo, y la separaci√≥n del segundo no parec√≠a tan significativa) </p><br><p>  Todav√≠a hay muchas cosas interesantes por descubrir.  Por ejemplo, el nombre del entrenador desde donde se compra al jugador, desde el punto de vista del modelo, es a√∫n m√°s importante que el club ... Deje que la diferencia se reduzca considerablemente.  En principio, se puede encontrar una explicaci√≥n l√≥gica para esto (aunque a veces se puede encontrar para cualquier cosa).  Hay entrenadores (Guardiola, Klopp, Ben√≠tez, Berdyev) que se adhieren a una determinada ideolog√≠a del juego en diferentes clubes, lo que revela mejor o viceversa hace que ciertas posiciones en el campo sean menos brillantes, y la visibilidad del jugador afecta en gran medida su precio.  Sobre clubes, por as√≠ decirlo, casi imposible.  Y el hecho de que vemos a entrenadores que no se apartan radicalmente de sus principios del juego con mucha m√°s frecuencia que los clubes que cambian de entrenador, sino que permanecen dentro de la misma filosof√≠a (por ejemplo, de improviso, excepto que Ajax viene a la mente y Barcelona es muy cuestionable), habla de que, tal vez, ciertos gerentes revelan jugadores m√°s estables que los clubes.  Aunque aqu√≠ no me aferrar√≠a fuertemente a mi declaraci√≥n. </p><br><p>  De los indicadores puramente estad√≠sticos, la cantidad m√°s alta es simplemente la cantidad de tiempo que un jugador pas√≥ en el campo el a√±o pasado en su competencia principal ( <code>stats_minutes_0</code> ).  Esto es simplemente bastante l√≥gico, porque cu√°nto este jugador fue el "principal" en su club la temporada pasada parece un indicador estad√≠stico m√°s universal de su √©xito que otros, por ejemplo, el n√∫mero de goles marcados o tarjetas recibidas. </p><br><p>  La popularidad del jugador ( <code>pop_log1p</code> ) cierra este grupo de 8 par√°metros m√°s importantes.  Vale la pena recordar que los datos que hemos presentado durante los √∫ltimos 10 a√±os.  Creo que la importancia de este campo ser√≠a mayor si estuvi√©ramos considerando los √∫ltimos 5 a√±os, y para el valor promedio durante la √∫ltima d√©cada, este es un resultado completamente comprensible, especialmente si tenemos en cuenta la brecha del pr√≥ximo lugar. </p><br><p>  Bueno, lo √∫ltimo que me gustar√≠a llamar la atenci√≥n es la importancia del campo agente ( <code>plr_player_agent</code> ).  Dejar√© esto sin comentarios, porque si puedes romper los m√°rgenes de las copias en disputas sobre la (falta) necesidad de agentes, entonces no hay duda sobre el grado de su influencia en el mercado moderno de transferencias (aunque el modelo sugiere no sobreestimarlo). </p><br><p><img src="https://habrastorage.org/webt/q2/al/i5/q2ali5al_krkgtsmdkn_mw5i6na.jpeg"></p><br><p>  Por cierto, quiz√°s lo m√°s interesante de este m√©todo de an√°lisis es su accesibilidad: no es necesario crear <em>un</em> modelo " <em>ideal</em> " para obtener informaci√≥n sobre la importancia de los par√°metros.  En muchos casos, es suficiente que, al menos, simplemente prediga, es estad√≠sticamente significativamente diferente de lanzar una moneda, y <em>ya</em> obtendr√° resultados que a menudo contienen ideas interesantes o le dicen desde qu√© lado nuevo puede mirar los datos. </p><br><p>  Entonces es hora de redondear, para no aumentar el texto tan sobrecargado.  Al despedirme, me gustar√≠a instar una vez m√°s a todos los interesados ‚Äã‚Äãen el tema a que prueben (lo mejor, en mi opini√≥n, para principiantes) el curso de Aprendizaje profundo - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">fast.ai</a> y apliquen los conocimientos adquiridos en 'su campo de especializaci√≥n', es probable que sea el primero all√≠ :) </p><br><p>  Y si te gusta, tratar√© de dominar la segunda parte del texto sobre mis experimentos en los que el modelo usando una herramienta igualmente poderosa: la <strong>dependencia parcial</strong> te dir√°: qu√© cliente de la agencia es mejor para convertirse en jugador de f√∫tbol, ‚Äã‚Äãqu√© clubes tienen la pol√≠tica de transferencia m√°s efectiva, qu√© entrenador aumenta mejor el costo de los jugadores (adem√°s de los candidatos obvios, hay muchas 'marcas' no tan promocionadas que claramente merecen una mirada m√°s cercana) y mucho m√°s. </p><br><p>  Parte 2 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modelo de transferencias de f√∫tbol: cavando m√°s profundo</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/468107/">https://habr.com/ru/post/468107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../468089/index.html">Redefinici√≥n basada en la edici√≥n: ¬øes posible en la producci√≥n?</a></li>
<li><a href="../468091/index.html">El proyecto de ley sobre la creaci√≥n de una base de datos √∫nica con los datos de los ciudadanos adoptados en la Duma del Estado en la primera lectura</a></li>
<li><a href="../468093/index.html">Nitratos en productos: tiendas suizas vs tiendas rusas vs caba√±a de verano</a></li>
<li><a href="../468097/index.html">Microsoft Edge - XSS gen√©rico</a></li>
<li><a href="../468099/index.html">C / C ++ de Python (CFFI, pybind11)</a></li>
<li><a href="../468109/index.html">Dicen que Samara es una ciudad de Javists, pero estamos conduciendo all√≠ un mitap PHP</a></li>
<li><a href="../468111/index.html">PSD2 - patada para bancos</a></li>
<li><a href="../468117/index.html">Ethernet, FTP, Telnet, HTTP, Bluetooth: los conceptos b√°sicos del an√°lisis de tr√°fico. Resolver problemas en una red con r0ot-mi. Parte 1</a></li>
<li><a href="../468121/index.html">C√≥mo no me convert√≠ en programador a los 35 a√±os</a></li>
<li><a href="../468125/index.html">Animaci√≥n en as√≠ntota</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>