<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤üèæ üêá üò¶ Remo√ß√£o de ru√≠do de alta frequ√™ncia dos sinais dos sensores de vibra√ß√£o durante o diagn√≥stico de vibra√ß√£o dos rolamentos üïπÔ∏è ü§ûüèæ üë®‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foto tirada da publica√ß√£o 

 1. Introdu√ß√£o 
 Uma das tarefas mais prementes do processamento de sinal digital √© a tarefa de limpar o sinal do ru√≠do. Q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Remo√ß√£o de ru√≠do de alta frequ√™ncia dos sinais dos sensores de vibra√ß√£o durante o diagn√≥stico de vibra√ß√£o dos rolamentos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459922/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/zj/kb/59zjkb8gnd_phkp1allrzocs6by.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Foto tirada da publica√ß√£o</a> <br><br><h3>  1. Introdu√ß√£o </h3><br>  Uma das tarefas mais prementes do processamento de sinal digital √© a tarefa de limpar o sinal do ru√≠do.  Qualquer sinal pr√°tico cont√©m n√£o apenas informa√ß√µes √∫teis, mas tamb√©m tra√ßos de alguns efeitos estranhos de interfer√™ncia ou ru√≠do.  Al√©m disso, durante o diagn√≥stico de vibra√ß√£o, os sinais dos sensores de vibra√ß√£o possuem um espectro de frequ√™ncia n√£o estacion√°rio, o que complica a tarefa de filtragem. <br><br>  Existem muitas maneiras diferentes de remover o ru√≠do de alta frequ√™ncia de um sinal.  Por exemplo, a biblioteca Scipy cont√©m filtros baseados em v√°rios m√©todos de filtragem: Kalman;  suavizando o sinal calculando a m√©dia ao longo do eixo do tempo e outros. <br><br>  No entanto, a vantagem do m√©todo de transformada de wavelet discreta (DWT) √© a variedade de formas de wavelet.  Voc√™ pode selecionar uma wavelet, que ter√° uma forma caracter√≠stica dos fen√¥menos esperados.  Por exemplo, voc√™ pode selecionar um sinal em uma determinada faixa de frequ√™ncia, cuja forma √© respons√°vel pela apar√™ncia de um defeito. <br><br>  <b>O objetivo desta publica√ß√£o</b> √© analisar m√©todos de filtragem de sinais de sensores de vibra√ß√£o usando convers√£o de sinal DWT, filtro Kalman e o m√©todo da m√©dia m√≥vel. <br><br><h3>  Dados de origem para an√°lise </h3><br>  Na publica√ß√£o, a opera√ß√£o de filtros com base em v√°rios m√©todos de filtragem ser√° analisada usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um conjunto de dados da NASA</a> .  Dados obtidos na plataforma experimental PRONOSTIA: <br><br><img src="https://habrastorage.org/webt/yt/bz/9l/ytbz9lrxw2h8roaaokvclm7qqgc.png"><br><br>  O kit cont√©m dados sobre os sinais do sensor de vibra√ß√£o para desgaste de v√°rios tipos de rolamentos.  A finalidade das pastas com os arquivos de sinal √© apresentada na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tabela</a> : <br><br><img src="https://habrastorage.org/webt/2w/ap/wr/2wapwr4x6xe5r-a2y2_nwc_oski.png"><br><br>  O monitoramento da condi√ß√£o dos rolamentos √© fornecido pelos sinais dos sensores de vibra√ß√£o (aceler√¥metros horizontais e verticais), for√ßa e temperatura. <br><br><img src="https://habrastorage.org/webt/wl/o1/a0/wlo1a0i6430fko-l5lijoa5tu4c.png"><br><br>  Sinais recebidos para tr√™s cargas diferentes: <br><br><ul><li>  Primeiras condi√ß√µes de trabalho: 1800 rpm e 4000 N; </li><li>  Segunda condi√ß√£o de trabalho: 1650 rpm e 4200 N; </li><li>  Terceiras condi√ß√µes de opera√ß√£o: 1500 rpm e 5000 N. </li></ul><br><a name="habracut"></a><br>  Para essas condi√ß√µes, usando a convers√£o cont√≠nua de sinal de wavelet, constru√≠mos os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escalogramas de pot√™ncia espectro</a> para os dados do conjunto de testes - um arquivo (para um tipo de rolamento) das pastas: ['Test_set / Bearing1_3 / acc_00001.csv', 'Test_set / Bearing2_3 / acc_00001. csv ',' Test_set / Bearing3_3 / acc_00001.csv '] (consulte a tabela 1). <br><br><div class="spoiler">  <b class="spoiler_title">Listagem do Scaleogram</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt filename_n = [<span class="hljs-string"><span class="hljs-string">'Test_set/Bearing1_3/acc_00001.csv'</span></span>, <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span>, <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing3_3/acc_00001.csv'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> filename <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> filename_n: df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values wavelet = <span class="hljs-string"><span class="hljs-string">'cmor1-0.5'</span></span> ax = scg.cws(signal, scales=arange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>), wavelet=wavelet, figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), cmap=<span class="hljs-string"><span class="hljs-string">"jet"</span></span>, cbar=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">' '</span></span>, xlabel=<span class="hljs-string"><span class="hljs-string">" "</span></span>, yscale=<span class="hljs-string"><span class="hljs-string">"log"</span></span>, title=<span class="hljs-string"><span class="hljs-string">'-  %s \n( )'</span></span>%filename) show()</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/zb/k4/v7/zbk4v74jffmfkopfqkhecmjjelu.png"><br><img src="https://habrastorage.org/webt/hz/nh/nh/hznhnhcpyg3thjqs4deu4dleq0s.png"><br><img src="https://habrastorage.org/webt/n2/ii/jv/n2iijvml8h0tq-bq38rcabkz8ny.png"><br><br>  Segue-se dos escalogramas fornecidos que os momentos de aumento da pot√™ncia do espectro aparecem mais cedo no tempo e demonstram a frequ√™ncia das condi√ß√µes de opera√ß√£o: 1650 rpm e 4200 N, o que indica degrada√ß√£o acelerada dos mancais nessa faixa de frequ√™ncia pela for√ßa reduzida.  Usaremos esse sinal ('Test_set / Bearing2_3 / acc_00001.csv') para analisar os m√©todos de remo√ß√£o de ru√≠do. <br><br><h3>  Desconstru√ß√£o de sinais usando DWT </h3><br>  Na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">publica√ß√£o,</a> vimos como um banco de filtros √© implementado no DWT que pode desconstruir um sinal em suas sub-bandas de frequ√™ncia.  Os coeficientes de aproxima√ß√£o (cA) representam a parte de baixa frequ√™ncia do sinal (filtro de m√©dia).  Os coeficientes de detalhe (cD) representam a por√ß√£o de alta frequ√™ncia do sinal.  A seguir, examinaremos como o DWT pode ser usado para desconstruir um sinal em suas sub-bandas de frequ√™ncia e restaurar o sinal original. <br><br>  Existem duas maneiras de resolver o problema de desconstru√ß√£o de sinal usando as ferramentas PyWavelets: <br><br>  A primeira maneira √© aplicar pywt.dwt () ao sinal para extrair os coeficientes de aproxima√ß√£o e detalhe (cA1, cD1).  Ent√£o, para restaurar o sinal, usaremos pywt.idwt (): <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values (cA1, cD1) = pywt .dwt (signal, <span class="hljs-string"><span class="hljs-string">'db2'</span></span>, <span class="hljs-string"><span class="hljs-string">'smooth'</span></span>) r_signal = pywt.idwt (cA1, cD1, <span class="hljs-string"><span class="hljs-string">'db2'</span></span>, <span class="hljs-string"><span class="hljs-string">'smooth'</span></span>) fig, ax =subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(signal, <span class="hljs-string"><span class="hljs-string">'b'</span></span>,label=<span class="hljs-string"><span class="hljs-string">' '</span></span>) ax.plot(r_signal, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'  '</span></span>, linestyle=<span class="hljs-string"><span class="hljs-string">'--'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper left'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_title(<span class="hljs-string"><span class="hljs-string">'   ( pywt.dwt()) \n   ( pywt.idwt()) '</span></span>) show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/iv/fm/pi/ivfmpiij21temoybrrrdqkflkxw.png"><br><br>  A segunda maneira de aplicar a fun√ß√£o pywt.wavedec () ao sinal √© restaurar todos os coeficientes de aproxima√ß√£o e detalhe para um determinado n√≠vel.  Esta fun√ß√£o recebe o sinal e o n√≠vel de entrada como entrada e retorna um conjunto de coeficientes de aproxima√ß√£o (n-√©simo n√≠vel) e n conjuntos de coeficientes de detalhes (de 1 a n-√©simo n√≠vel).  Para desconstru√ß√£o, aplique pywt.waverec (): <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing3_3/acc_00026.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values coeffs = pywt.wavedec(signal, <span class="hljs-string"><span class="hljs-string">'db2'</span></span>, level=<span class="hljs-number"><span class="hljs-number">8</span></span>) r_signal = pywt.waverec(coeffs, <span class="hljs-string"><span class="hljs-string">'db2'</span></span>) fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(signal, <span class="hljs-string"><span class="hljs-string">'b'</span></span>,label=<span class="hljs-string"><span class="hljs-string">' '</span></span>) ax.plot(r_signal, <span class="hljs-string"><span class="hljs-string">'r '</span></span>,label= <span class="hljs-string"><span class="hljs-string">' '</span></span>, linestyle=<span class="hljs-string"><span class="hljs-string">'--'</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper left'</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_title(<span class="hljs-string"><span class="hljs-string">'    - level.\n   ( pywt.wavedec()) '</span></span>) show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/qq/ao/bn/qqaobnxdnlkrjllymvd3aqxti44.png"><br>  A segunda maneira de desconstruir e restaurar o sinal √© mais conveniente, pois permite definir imediatamente o n√≠vel desejado de desconstru√ß√£o. <br><br><h3>  Remo√ß√£o de ru√≠do de alta frequ√™ncia, eliminando alguns dos coeficientes de detalhes durante a desconstru√ß√£o do sinal </h3><br>  Restauraremos o sinal excluindo alguns dos coeficientes de detalhes.  Como os coeficientes de detalhe representam a parte de alta frequ√™ncia do sinal, simplesmente filtramos essa parte do espectro de frequ√™ncias.  Se houver ru√≠do de alta frequ√™ncia no sinal, essa √© uma maneira de filtr√°-lo. <br><br>  Na biblioteca PyWavelets, isso pode ser feito usando a fun√ß√£o de processamento de limite pywt.threshol (): <br><br>  pywt.threshold (dados, valor, modo = 'soft', substituto = 0) ¬∂ <br>  <b>data:</b> array_like <br>  <i>Dados num√©ricos.</i> <br>  <b>valor:</b> escalar <br>  <i>Valor limite.</i> <br>  <b>mode:</b> {'suave', 'r√≠gido', 'garrote', 'maior', 'menos'} <br>  <i>Define o tipo de limite que ser√° aplicado √† entrada.</i>  <i>O padr√£o √© 'soft'.</i> <br>  <b>substituto:</b> flutuador, opcional <br>  <i>Valor da substitui√ß√£o (padr√£o: 0).</i> <br>  <b>sa√≠da:</b> matriz <br>  <i>Matriz de limite.</i> <br><br>  A aplica√ß√£o da fun√ß√£o de processamento de limite para um determinado valor de limite √© melhor considerada usando o seguinte exemplo: <br><br><pre> <code class="python hljs">&gt;&gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt &gt;&gt;&gt; data =linspace(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>) &gt;&gt;&gt; data array([<span class="hljs-number"><span class="hljs-number">1.</span></span> , <span class="hljs-number"><span class="hljs-number">1.5</span></span>, <span class="hljs-number"><span class="hljs-number">2.</span></span> , <span class="hljs-number"><span class="hljs-number">2.5</span></span>, <span class="hljs-number"><span class="hljs-number">3.</span></span> , <span class="hljs-number"><span class="hljs-number">3.5</span></span>, <span class="hljs-number"><span class="hljs-number">4.</span></span> ]) &gt;&gt;&gt; pywt.threshold(data, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>) array([<span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">1.</span></span> , <span class="hljs-number"><span class="hljs-number">1.5</span></span>, <span class="hljs-number"><span class="hljs-number">2.</span></span> ]) &gt;&gt;&gt; pywt.threshold(data, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>) array([<span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">2.</span></span> , <span class="hljs-number"><span class="hljs-number">2.5</span></span>, <span class="hljs-number"><span class="hljs-number">3.</span></span> , <span class="hljs-number"><span class="hljs-number">3.5</span></span>, <span class="hljs-number"><span class="hljs-number">4.</span></span> ]) &gt;&gt;&gt; pywt.threshold(data, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'garrote'</span></span>) array([<span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">0.</span></span> , <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.9</span></span>,<span class="hljs-number"><span class="hljs-number">1.66666667</span></span>, <span class="hljs-number"><span class="hljs-number">2.35714286</span></span>, <span class="hljs-number"><span class="hljs-number">3.</span></span>])</code> </pre><br>  Plotamos o gr√°fico da fun√ß√£o de limite usando a seguinte listagem: <br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt s = linspace(<span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) s_soft = pywt.threshold(s, value=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'soft'</span></span>) s_hard = pywt.threshold(s, value=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'hard'</span></span>) s_garrote = pywt.threshold(s, value=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'garrote'</span></span>) figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) plot(s, s_soft) plot(s, s_hard) plot(s, s_garrote) legend([<span class="hljs-string"><span class="hljs-string">'soft (0.5)'</span></span>, <span class="hljs-string"><span class="hljs-string">'hard (0.5)'</span></span>, <span class="hljs-string"><span class="hljs-string">'non-neg. garrote (0.5)'</span></span>]) xlabel(<span class="hljs-string"><span class="hljs-string">'   '</span></span>) ylabel(<span class="hljs-string"><span class="hljs-string">'  '</span></span>) show()</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/gd/lp/oo/gdlpoowyfgb1iv0kd-wm1vpb8vg.png"><br><br>  O gr√°fico mostra que o limiar de Garott n√£o negativo √© intermedi√°rio entre o limiar suave e r√≠gido.  √â necess√°rio um par de limites que definam a largura da regi√£o de transi√ß√£o. <br><br><h3>  A influ√™ncia da fun√ß√£o de limiar nas caracter√≠sticas do filtro </h3><br>  Como se segue no gr√°fico acima, apenas duas fun√ß√µes de limite 'soft' e 'garrote' s√£o adequadas para que, para estudar sua influ√™ncia nas caracter√≠sticas do filtro, anotemos a listagem: <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values v=<span class="hljs-string"><span class="hljs-string">'bior4.4'</span></span> thres=[<span class="hljs-string"><span class="hljs-string">'soft'</span></span> ,<span class="hljs-string"><span class="hljs-string">'garrote'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> thres: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lowpassfilter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(signal, thresh, wavelet=v)</span></span></span><span class="hljs-function">:</span></span> thresh = thresh*nanmax(signal) coeff = pywt.wavedec(signal, wavelet, level=<span class="hljs-number"><span class="hljs-number">8</span></span>,mode=<span class="hljs-string"><span class="hljs-string">"per"</span></span> ) coeff[<span class="hljs-number"><span class="hljs-number">1</span></span>:] = (pywt.threshold(i, value=thresh, mode=w ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> coeff[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) reconstructed_signal = pywt.waverec(coeff, wavelet, mode=<span class="hljs-string"><span class="hljs-string">"per"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reconstructed_signal fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(signal, color=<span class="hljs-string"><span class="hljs-string">"b"</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, label=<span class="hljs-string"><span class="hljs-string">' '</span></span>) rec = lowpassfilter(signal, <span class="hljs-number"><span class="hljs-number">0.4</span></span>) ax.plot(rec, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'DWT  '</span></span>, linewidth=<span class="hljs-number"><span class="hljs-number">2</span></span>) ax.legend() ax.set_title(<span class="hljs-string"><span class="hljs-string">'      :%s\n   :%s'</span></span>%(v,w), fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) show()</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/yx/th/g8/yxthg8ew_lkh-koeq6bnfvw6tla.png"><br><img src="https://habrastorage.org/webt/8q/nn/35/8qnn353spuea5_mtc6jb_t1tmty.png"><br><br>  Como se segue nos gr√°ficos, a fun√ß√£o soft oferece melhor suaviza√ß√£o do que a fun√ß√£o 'garrote', portanto, usaremos a fun√ß√£o soft no futuro. <br><br><h3>  A influ√™ncia do limiar de detalhes nas caracter√≠sticas do filtro </h3><br>  Para o tipo de filtro em considera√ß√£o, o limiar para alterar os coeficientes de detalhes √© uma caracter√≠stica importante; portanto, estudamos seu efeito usando a seguinte listagem: <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values v=<span class="hljs-string"><span class="hljs-string">'bior4.4'</span></span> thres=[<span class="hljs-number"><span class="hljs-number">0.1</span></span>,<span class="hljs-number"><span class="hljs-number">0.4</span></span>,<span class="hljs-number"><span class="hljs-number">0.6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> thres: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lowpassfilter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(signal, thresh, wavelet=v)</span></span></span><span class="hljs-function">:</span></span> thresh = thresh*nanmax(signal) coeff = pywt.wavedec(signal, wavelet, level=<span class="hljs-number"><span class="hljs-number">8</span></span>,mode=<span class="hljs-string"><span class="hljs-string">"per"</span></span> ) coeff[<span class="hljs-number"><span class="hljs-number">1</span></span>:] = (pywt.threshold(i, value=thresh, mode=<span class="hljs-string"><span class="hljs-string">'soft'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> coeff[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) reconstructed_signal = pywt.waverec(coeff, wavelet, mode=<span class="hljs-string"><span class="hljs-string">"per"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reconstructed_signal fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(signal, color=<span class="hljs-string"><span class="hljs-string">"b"</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, label=<span class="hljs-string"><span class="hljs-string">' '</span></span>) rec = lowpassfilter(signal,w) ax.plot(rec, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'DWT  '</span></span>, linewidth=<span class="hljs-number"><span class="hljs-number">2</span></span>) ax.legend() ax.set_title(<span class="hljs-string"><span class="hljs-string">'      :%s\n    %s'</span></span>%(v,w), fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/nu/vp/te/nuvptehfyqvcheixzbsqac506ci.png"><br><img src="https://habrastorage.org/webt/2o/vg/nn/2ovgnnncwq4b4yc0odhhj_bteae.png"><br><img src="https://habrastorage.org/webt/sk/ep/_r/skep_rwbarrrdfhmnxbobzlxiyc.png"><br><br>  Como segue nos gr√°ficos obtidos, o limite do n√≠vel de detalhe afeta a escala das partes rastreadas.  Com um aumento no limiar, a wavelet subtrai o ru√≠do de um n√≠vel cada vez maior at√© que ocorra um aumento excessivo da escala de detalhes e a transforma√ß√£o come√ßa a distorcer a forma do sinal original.Para o nosso sinal, o limiar n√£o deve ser maior que 0,63. <br><br><h3>  O efeito da wavelet nas caracter√≠sticas do filtro </h3><br>  A biblioteca PyWavelets possui um n√∫mero suficiente de wavelets para convers√£o de DWT, que podem ser obtidas assim: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt &gt;&gt;&gt; print(pywt.wavelist(kind= <span class="hljs-string"><span class="hljs-string">'discrete'</span></span>)) [<span class="hljs-string"><span class="hljs-string">'bior1.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior1.3'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior1.5'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior2.2'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior2.4'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior2.6'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior2.8'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior3.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior3.3'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior3.5'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior3.7'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior3.9'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior4.4'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior5.5'</span></span>, <span class="hljs-string"><span class="hljs-string">'bior6.8'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif1'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif2'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif3'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif4'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif5'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif6'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif7'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif8'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif9'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif10'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif11'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif12'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif13'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif14'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif15'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif16'</span></span>, <span class="hljs-string"><span class="hljs-string">'coif17'</span></span>, <span class="hljs-string"><span class="hljs-string">'db1'</span></span>, <span class="hljs-string"><span class="hljs-string">'db2'</span></span>, <span class="hljs-string"><span class="hljs-string">'db3'</span></span>, <span class="hljs-string"><span class="hljs-string">'db4'</span></span>, <span class="hljs-string"><span class="hljs-string">'db5'</span></span>, <span class="hljs-string"><span class="hljs-string">'db6'</span></span>, <span class="hljs-string"><span class="hljs-string">'db7'</span></span>, <span class="hljs-string"><span class="hljs-string">'db8'</span></span>, <span class="hljs-string"><span class="hljs-string">'db9'</span></span>, <span class="hljs-string"><span class="hljs-string">'db10'</span></span>, <span class="hljs-string"><span class="hljs-string">'db11'</span></span>, <span class="hljs-string"><span class="hljs-string">'db12'</span></span>, <span class="hljs-string"><span class="hljs-string">'db13'</span></span>, <span class="hljs-string"><span class="hljs-string">'db14'</span></span>, <span class="hljs-string"><span class="hljs-string">'db15'</span></span>, <span class="hljs-string"><span class="hljs-string">'db16'</span></span>, <span class="hljs-string"><span class="hljs-string">'db17'</span></span>, <span class="hljs-string"><span class="hljs-string">'db18'</span></span>, <span class="hljs-string"><span class="hljs-string">'db19'</span></span>, <span class="hljs-string"><span class="hljs-string">'db20'</span></span>, <span class="hljs-string"><span class="hljs-string">'db21'</span></span>, <span class="hljs-string"><span class="hljs-string">'db22'</span></span>, <span class="hljs-string"><span class="hljs-string">'db23'</span></span>, <span class="hljs-string"><span class="hljs-string">'db24'</span></span>, <span class="hljs-string"><span class="hljs-string">'db25'</span></span>, <span class="hljs-string"><span class="hljs-string">'db26'</span></span>, <span class="hljs-string"><span class="hljs-string">'db27'</span></span>, <span class="hljs-string"><span class="hljs-string">'db28'</span></span>, <span class="hljs-string"><span class="hljs-string">'db29'</span></span>, <span class="hljs-string"><span class="hljs-string">'db30'</span></span>, <span class="hljs-string"><span class="hljs-string">'db31'</span></span>, <span class="hljs-string"><span class="hljs-string">'db32'</span></span>, <span class="hljs-string"><span class="hljs-string">'db33'</span></span>, <span class="hljs-string"><span class="hljs-string">'db34'</span></span>, <span class="hljs-string"><span class="hljs-string">'db35'</span></span>, <span class="hljs-string"><span class="hljs-string">'db36'</span></span>, <span class="hljs-string"><span class="hljs-string">'db37'</span></span>, <span class="hljs-string"><span class="hljs-string">'db38'</span></span>, <span class="hljs-string"><span class="hljs-string">'dmey'</span></span>, <span class="hljs-string"><span class="hljs-string">'haar'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio1.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio1.3'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio1.5'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio2.2'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio2.4'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio2.6'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio2.8'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio3.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio3.3'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio3.5'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio3.7'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio3.9'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio4.4'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio5.5'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbio6.8'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym2'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym3'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym4'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym5'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym6'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym7'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym8'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym9'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym10'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym11'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym12'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym13'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym14'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym15'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym16'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym17'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym18'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym19'</span></span>, <span class="hljs-string"><span class="hljs-string">'sym20'</span></span>]</code> </pre> <br>  A influ√™ncia da wavelet na caracter√≠stica do filtro depende de sua fun√ß√£o primitiva.  Para demonstrar essa depend√™ncia, selecionamos duas wavelets da fam√≠lia Dobeshi - db1 e db38, e consideramos as seguintes fam√≠lias: <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* db_wavelets = [<span class="hljs-string"><span class="hljs-string">'db1'</span></span>, <span class="hljs-string"><span class="hljs-string">'db38'</span></span>] fig, axarr = subplots(ncols=<span class="hljs-number"><span class="hljs-number">2</span></span>, nrows=<span class="hljs-number"><span class="hljs-number">5</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>)) fig.suptitle(<span class="hljs-string"><span class="hljs-string">'  : db1,db38'</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col_no, waveletname <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(db_wavelets): wavelet = pywt.Wavelet(waveletname) no_moments = wavelet.vanishing_moments_psi family_name = wavelet.family_name <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> row_no, level <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)): wavelet_function, scaling_function, x_values = wavelet.wavefun(level = level) axarr[row_no, col_no].set_title(<span class="hljs-string"><span class="hljs-string">"{} : {}.   : {}. :: {} "</span></span>.format( waveletname, level, no_moments, len(x_values)), loc=<span class="hljs-string"><span class="hljs-string">'left'</span></span>) axarr[row_no, col_no].plot(x_values, wavelet_function, <span class="hljs-string"><span class="hljs-string">'b--'</span></span>) axarr[row_no, col_no].set_yticks([]) axarr[row_no, col_no].set_yticklabels([]) tight_layout() subplots_adjust(top=<span class="hljs-number"><span class="hljs-number">0.9</span></span>) show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/fs/0m/sq/fs0msqniw-dcixmdhfbrxrwpwfg.png"><br><br>  Na primeira coluna, vemos wavelets de Daubeshi de primeira ordem (db1), na segunda coluna da trig√©sima oitava ordem (db38).  Assim, o db1 tem um momento de extin√ß√£o e o db38 tem 38 momentos de extin√ß√£o.  O n√∫mero de momentos de desaparecimento est√° relacionado √† ordem de aproxima√ß√£o e √† suavidade da wavelet.  Se uma wavelet tem P pontos de desaparecimento, ela pode se aproximar de polin√¥mios de grau P - 1. <br><br>  Wavelets mais suaves criam uma aproxima√ß√£o de sinal mais suave e vice-versa - as wavelets "curtas" rastreiam melhor os picos da fun√ß√£o aproximada.  Ao escolher uma wavelet, tamb√©m podemos indicar qual deve ser o n√≠vel de decomposi√ß√£o.  Por padr√£o, o PyWavelets seleciona o n√≠vel m√°ximo de decomposi√ß√£o poss√≠vel para o sinal de entrada.  O n√≠vel m√°ximo de decomposi√ß√£o depende do comprimento do sinal de entrada e da wavelet: <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) data = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values w=[<span class="hljs-string"><span class="hljs-string">'db1'</span></span>, <span class="hljs-string"><span class="hljs-string">'db38'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> w: n_level=pywt.dwt_max_level(len(data),v) print(<span class="hljs-string"><span class="hljs-string">'  %s   : %s '</span></span> %(v,n_level))</code> </pre> <br></div></div><br>  Para wavelet db1, n√≠vel m√°ximo de decomposi√ß√£o: 11 <br>  Para wavelet db38, n√≠vel m√°ximo de decomposi√ß√£o: 5 <br><br>  Para os valores obtidos dos n√≠veis m√°ximos de decomposi√ß√£o de wavelets, consideramos a opera√ß√£o do filtro para remover ru√≠dos de alta frequ√™ncia: <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values discrete_wavelets =[(<span class="hljs-string"><span class="hljs-string">'db38'</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>),(<span class="hljs-string"><span class="hljs-string">'db1'</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> discrete_wavelets: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lowpassfilter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(signal, thresh = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.63</span></span></span></span><span class="hljs-function"><span class="hljs-params">, wavelet=v[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span><span class="hljs-function">:</span></span> thresh = thresh*nanmax(signal) coeff = pywt.wavedec(signal, wavelet, mode=<span class="hljs-string"><span class="hljs-string">"per"</span></span> ) coeff[<span class="hljs-number"><span class="hljs-number">1</span></span>:] = (pywt.threshold(i, value=thresh, mode=<span class="hljs-string"><span class="hljs-string">'soft'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> coeff[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) reconstructed_signal = pywt.waverec(coeff, wavelet, mode=<span class="hljs-string"><span class="hljs-string">"per"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reconstructed_signal wavelet = pywt.DiscreteContinuousWavelet(v[<span class="hljs-number"><span class="hljs-number">0</span></span>]) phi, psi, x = wavelet.wavefun(level=v[<span class="hljs-number"><span class="hljs-number">1</span></span>]) fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.set_title(<span class="hljs-string"><span class="hljs-string">"   : %s,level=%s"</span></span>%(v[<span class="hljs-number"><span class="hljs-number">0</span></span>],v[<span class="hljs-number"><span class="hljs-number">1</span></span>]), fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.plot(x,phi,linewidth=<span class="hljs-number"><span class="hljs-number">2</span></span>) fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(signal, color=<span class="hljs-string"><span class="hljs-string">"b"</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, label=<span class="hljs-string"><span class="hljs-string">'   '</span></span>) rec = lowpassfilter(signal, <span class="hljs-number"><span class="hljs-number">0.4</span></span>) ax.plot(rec, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'DWT  '</span></span>, linewidth=<span class="hljs-number"><span class="hljs-number">2</span></span>) ax.legend() ax.set_title(<span class="hljs-string"><span class="hljs-string">'   \n   :%s,level=%s'</span></span>%(v[<span class="hljs-number"><span class="hljs-number">0</span></span>],v[<span class="hljs-number"><span class="hljs-number">1</span></span>]),fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) wavelet = <span class="hljs-string"><span class="hljs-string">'cmor1-0.5'</span></span> ax = ax = scg.cws(rec, scales=arange(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">128</span></span>), wavelet=wavelet,figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), cmap=<span class="hljs-string"><span class="hljs-string">"jet"</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">' '</span></span>, xlabel=<span class="hljs-string"><span class="hljs-string">" "</span></span>, yscale=<span class="hljs-string"><span class="hljs-string">"log"</span></span>, title=<span class="hljs-string"><span class="hljs-string">'CWT  \n(   DWT  )'</span></span>) show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/ox/ye/ly/oxyelyqw4xi75vxu8sgn57jy2ek.png"><br><img src="https://habrastorage.org/webt/iv/-s/sy/iv-ssyb2yau4ym95tk7ks37hddo.png"><br><img src="https://habrastorage.org/webt/1f/vm/4t/1fvm4trkcng-igaafvxppvadkvo.png"><br><img src="https://habrastorage.org/webt/w1/zm/ls/w1zmlsmgqnlnbj2ww5v6nijdmyo.png"><br><img src="https://habrastorage.org/webt/js/wc/l3/jswcl3-b_tcy_cth70tlktwc6ka.png"><br><img src="https://habrastorage.org/webt/z8/c-/83/z8c-83mpmq8p5ewenjbkudpjh5s.png"><br><br>  Segue-se das formas de onda citadas dos sinais na sa√≠da do filtro que, para a wavelet db38, o pico de pot√™ncia do espectro √© seguido por regi√µes localizadas, para a wavelet db1 essas regi√µes desaparecem.  Deve-se notar que, por exemplo, a wavelet db38 pode se aproximar de um sinal de polin√¥mio de grau 37.  Isso estende a classifica√ß√£o dos sinais, por exemplo, para identificar falhas no equipamento pelos sinais dos sensores de vibra√ß√£o. <br><br>  <b>Como o sinal ap√≥s o filtro com a wavelet de Daubechies forma uma s√©rie temporal usando os coeficientes de aproxima√ß√£o e decomposi√ß√£o como caracter√≠sticas das s√©ries, pode-se determinar o grau de proximidade dessas s√©ries, o que simplifica bastante sua pesquisa e classifica√ß√£o</b> <br><br><h3>  Filtro Kalman para remover ru√≠dos de alta frequ√™ncia </h3><br>  O filtro Kalman √© amplamente utilizado para filtrar ru√≠dos em v√°rios sistemas din√¢micos.  Considere um sistema din√¢mico com um vetor de estado x. <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">x</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">F</span><span class="MJXp-mtext" id="MJXp-Span-5">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">x</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">w</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">Q</span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.421ex" height="2.66ex" viewBox="0 -832 8792.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-46" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="2906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="3339" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="3863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="4348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="4710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2B" x="5504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-77" x="6505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-28" x="7222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-51" x="7611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-29" x="8403" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> x = F \ cdot x + w (Q) </script><br><br>  onde F √© a matriz de transi√ß√£o <br>  w (Q) √© um processo aleat√≥rio (ru√≠do) com zero expectativa matem√°tica e uma matriz de covari√¢ncia Q. <br><br>  Observaremos as transi√ß√µes de estado do sistema com um erro de medi√ß√£o conhecido a cada momento.  A remo√ß√£o do ru√≠do usando o m√©todo Kalman consiste em duas etapas - extrapola√ß√£o e corre√ß√£o, √© assim. <br><br>  Defina os par√¢metros do sistema: <br><br>  Matriz Q da covari√¢ncia do ru√≠do (covari√¢ncia do ru√≠do do processo). <br>  H √© a matriz de observa√ß√£o (medi√ß√£o). <br>  R - covari√¢ncia do ru√≠do de observa√ß√£o (covari√¢ncia do ru√≠do de medi√ß√£o). <br>  P = Q √© o valor inicial da matriz de covari√¢ncia para o vetor de estado. <br>  z (t) √© o estado observado do sistema. <br>  x = z (0) √© o valor inicial da avalia√ß√£o do estado do sistema. <br><br>  Para cada observa√ß√£o z, calcularemos o estado filtrado x <br>  e para isso, executamos as seguintes etapas. <br><br>  ‚Ä¢ passo 1: extrapola√ß√£o <br>  1. extrapola√ß√£o (previs√£o) do estado do sistema <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">x</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">F</span><span class="MJXp-mtext" id="MJXp-Span-20">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.269ex" height="2.057ex" viewBox="0 -780.1 5282.6 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-46" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="2906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="3339" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="3863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="4348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="4710" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> x = F \ cdot x </script><br>  2. calcular a matriz de covari√¢ncia para o vetor de estado extrapolado <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">F</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">F</span><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">P</span><span class="MJXp-mtext" id="MJXp-Span-36">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">t</span><span class="MJXp-msubsup" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-43" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.749ex" height="2.78ex" viewBox="0 -935.7 11086.5 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-46" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="1027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-46" x="2083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="3083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="3516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="4525" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-50" x="4887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="5888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="6322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="6845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="7331" y="0"></use><g transform="translate(7692,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-54" x="1104" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2B" x="9294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-51" x="10295" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> F = F \ cdot P \ cdot F ^ {T} + Q </script><br><br>  ‚Ä¢ passo 2: corre√ß√£o <br>  1. calcular o vetor de erro, o desvio da observa√ß√£o do estado esperado <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">y</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">z</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">H</span><span class="MJXp-mtext" id="MJXp-Span-53">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.346ex" height="2.419ex" viewBox="0 -780.1 7038 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-7A" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2212" x="2522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-48" x="3523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="4661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="5095" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="5618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="6104" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="6465" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> y = z-H \ cdot x </script><br>  2. calcular a matriz de covari√¢ncia para o vetor de desvio (vetor de erro) <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">S</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">H</span><span class="MJXp-mtext" id="MJXp-Span-63">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">P</span><span class="MJXp-mtext" id="MJXp-Span-69">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">t</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-76" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.045ex" height="2.539ex" viewBox="0 -935.7 11213.8 1093.4" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-48" x="1979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="3118" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="3551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="4075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="4560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-50" x="4922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="5923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="6357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="6880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="7366" y="0"></use><g transform="translate(7727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-54" x="1280" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2B" x="9453" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-52" x="10454" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> S = H \ cdot P \ cdot H ^ {T} + R </script><br>  3. calcular os ganhos de Kalman <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">K</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">P</span><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">H</span><span class="MJXp-mtext" id="MJXp-Span-90">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">t</span><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">H</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-97" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">T</span></span></span><span class="MJXp-mtext" id="MJXp-Span-99">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">t</span><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-106" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-107">‚àí</span><span class="MJXp-mn" id="MJXp-Span-108">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.632ex" height="2.419ex" viewBox="0 -935.7 13188.9 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="1167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-50" x="2223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="3225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="3658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="4182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="4667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-48" x="5029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="6167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="6601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="7124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="7610" y="0"></use><g transform="translate(7971,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-54" x="1280" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="9725" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="10158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="10682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="11167" y="0"></use><g transform="translate(11529,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-53" x="0" y="0"></use><g transform="translate(655,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-31" x="778" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> K = P \ cdot H \ cdot H ^ {T} \ cdot S ^ {- 1} </script><br>  4. corre√ß√£o da estimativa do vetor de estado <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">x</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">x</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">K</span><span class="MJXp-mtext" id="MJXp-Span-115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.59ex" height="2.419ex" viewBox="0 -780.1 7143 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-78" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2B" x="2701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-4B" x="3702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="4841" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="5275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="5798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="6284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-79" x="6645" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> x = x + K \ cdot y </script><br>  5. corrigimos a matriz de covari√¢ncia para estimar o vetor de estado do sistema <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">P</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">I</span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">K</span><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">H</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.082ex" height="2.66ex" viewBox="0 -832 11229.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-28" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-49" x="2475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2212" x="3201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-4B" x="4202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="5342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="5775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="6299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="6784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-48" x="7146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-29" x="8034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="8674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="9107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="9631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="10116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-50" x="10478" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> P = (I-K \ cdot H) \ cdot P </script><br><br><div class="spoiler">  <b class="spoiler_title">Listagem para a implementa√ß√£o do algoritmo</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kalman_filter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( z, F = eye</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">, #     </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(transitionMatrix)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Q = eye</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">*</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3e-3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, #   </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(processNoiseCov)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> H = eye</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">, #   </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(measurement)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> R = eye</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">*</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3e-1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> #    </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(measurementNoiseCov)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span><span class="hljs-function">:</span></span> n = z.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   #m = z.shape[1] #   x = z[0,:].transpose() #      P = Q #       r = [ x ] #  for i in range(1,n): # : x = F.dot( x ) #  ()   P = F.dot(P).dot( F.transpose() ) + Q #       # : y = z[i] - H.dot(x) #  ,      ()  S = H.dot(P).dot(H.transpose()) + R #      ( ) K = P.dot(H.transpose()).dot(linalg.inv(S)) #     x = x + K.dot(y) #     P = ( eye(z.shape[1]) - K.dot(H) ).dot(P) #       r.append( x.transpose()) return array(r) filename = 'Test_set/Bearing2_3/acc_00001.csv' df = pd.read_csv(filename, header=None) signal = df[4].values N= signal .shape[0] #   # 2 dimensions y0 =linspace(0.0,2500.0,N) y1 =signal d = array(list(zip(y0,y1))) dn = dr = kalman_filter(dn) fig, ax = subplots(figsize=(8,4)) ax.plot( d[:,0], d[:,1],'b', label=' ' ) ax.plot( r[:,0], r[:,1],'r', label='kalman' ) ax.legend(loc='upper left') ax.set_title('       \n (  )', fontsize=12) ax.set_ylabel(' ', fontsize=12) ax.set_xlabel('', fontsize=12) show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/zp/ql/ln/zpqllnxdxf-fgpt2gyhxg4xekwm.png"><br><br>  Para o modelo din√¢mico fornecido, voc√™ pode usar a biblioteca pyKalman: <br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pykalman <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KalmanFilter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) signal = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values measurements =signal kf = KalmanFilter(transition_matrices=[<span class="hljs-number"><span class="hljs-number">1</span></span>] ,<span class="hljs-comment"><span class="hljs-comment"># A      t  t+1 observation_matrices=[1],# C   initial_state_mean=measurements[0],#   initial_state_covariance=[1],#    observation_covariance=[1],# R    transition_covariance= 0.01) # Q     state_means, state_covariances = kf.filter(measurements)# ,   state_means=[w[0] for w in state_means] state_std = sqrt(state_covariances[:,0]) fig, ax = subplots(figsize=(8,4)) ax.plot(measurements ,'b', label=' ') ax.plot(state_means ,'r', label='kalman- ') ax.legend() ax.set_title('      \n ( pyKalman)', fontsize=14) ax.set_ylabel(' ', fontsize=12) ax.set_xlabel('', fontsize=12) wavelet = 'cmor1-0.5' ax = ax = scg.cws(signal, scales=arange(1,40), wavelet=wavelet, figsize=(8, 4),cmap="jet", ylabel=' ', xlabel=" ", yscale="log", title='CWT    \n( )') ax = ax = scg.cws(state_means, scales=arange(1,40), wavelet=wavelet, figsize=(8, 4), cmap="jet", ylabel=' ', xlabel=" ", yscale="log", title='CWT     \n(  )') show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/z8/uh/p-/z8uhp-7gzngp1uzvix5bxhjadd0.png"><br><img src="https://habrastorage.org/webt/ti/qd/gy/tiqdgyoia3_ilxnbcqq8pmwoyi8.png"><br><img src="https://habrastorage.org/webt/ws/ws/il/wswsilmi0tqwgrtwp-ezkdkdvy4.png"><br><br>  O filtro Kalman remove bem o ru√≠do de alta frequ√™ncia, no entanto, n√£o permite alterar a forma do sinal de sa√≠da. <br><br><h3>  M√©todo de m√©dia m√≥vel </h3><br>  Ao determinar a dire√ß√£o principal das mudan√ßas em uma sequ√™ncia fortemente oscilante, surge o problema de suaviz√°-la usando o m√©todo da m√©dia m√≥vel.  Podem ser as leituras do sensor de n√≠vel de combust√≠vel no carro ou, como no nosso caso, os dados dos sensores de alta frequ√™ncia com rela√ß√£o √† degrada√ß√£o acelerada dos rolamentos.  O problema pode ser considerado como a restaura√ß√£o de alguma sequ√™ncia r na qual o ru√≠do foi sobreposto. <br><br>  M√©dia M√≥vel Simples para curto - SMA (M√©dia M√≥vel Simples).  Para calcular o valor atual do filtro <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.848ex" height="1.817ex" viewBox="0 -520.7 795.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-69" x="638" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> r_ {i} </script>  apenas calculamos a m√©dia dos n elementos anteriores da sequ√™ncia, para que o filtro comece a trabalhar com o elemento da sequ√™ncia n. <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-msubsup" id="MJXp-Span-147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-149" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">c</span><span class="MJXp-mrow" id="MJXp-Span-157"><span class="MJXp-mn" id="MJXp-Span-158">1</span></span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">n</span></span><span class="MJXp-mtext" id="MJXp-Span-161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">t</span><span class="MJXp-mtext" id="MJXp-Span-166">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">u</span><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">j</span><span class="MJXp-mo" id="MJXp-Span-173">=</span><span class="MJXp-mn" id="MJXp-Span-174">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-179" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-180">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">i</span><span class="MJXp-mo" id="MJXp-Span-182">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">j</span><span class="MJXp-mo" id="MJXp-Span-184">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">i</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="36.919ex" height="3.021ex" viewBox="0 -780.1 15895.5 1300.8" role="img" focusable="false" style="vertical-align: -1.209ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-69" x="638" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="1073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-66" x="2379" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-72" x="2930" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-61" x="3381" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="3911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-31" x="4344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6E" x="4845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-63" x="5695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-64" x="6129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6F" x="6652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-74" x="7138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-73" x="7749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-75" x="8219" y="0"></use><g transform="translate(8791,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6E" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-31" x="1191" y="0"></use></g></g><g transform="translate(10966,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-69" x="389" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-2212" x="734" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6A" x="1513" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-29" x="1926" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3B" x="13170" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-69" x="13615" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMAIN-3E" x="14238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459922/&amp;usg=ALkJrhh0SJ0O0igAOOVPYT0mT0LRRzN0rQ#MJMATHI-6E" x="15294" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> r_ {i} = \ frac {1} {n} \ cdot \ sum_ {j = 1} ^ {n} e _ {(i-j)}; i> n </script><br><br><div class="spoiler">  <b class="spoiler_title">Listagem</b> <div class="spoiler_text"><pre> <code class="python hljs">&lt;source lang=<span class="hljs-string"><span class="hljs-string">"python"</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ave_values</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xvalues, yvalues, n = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">6</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> signal_length = len(xvalues) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> signal_length % n == <span class="hljs-number"><span class="hljs-number">0</span></span>: padding_length = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: padding_length = n - signal_length//n % n xarr = array(xvalues) yarr = array(yvalues) xarr.resize(signal_length//n, n) yarr.resize(signal_length//n, n) xarr_reshaped = xarr.reshape((<span class="hljs-number"><span class="hljs-number">-1</span></span>,n)) yarr_reshaped = yarr.reshape((<span class="hljs-number"><span class="hljs-number">-1</span></span>,n)) x_ave = xarr_reshaped[:,<span class="hljs-number"><span class="hljs-number">0</span></span>] y_ave = nanmean(yarr_reshaped, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x_ave, y_ave <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_signal_plus_average</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(time, signal, average_over = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) time_ave, signal_ave = get_ave_values(time, signal, average_over) ax.plot(time_ave, signal_ave,<span class="hljs-string"><span class="hljs-string">"b"</span></span>, label = <span class="hljs-string"><span class="hljs-string">'   (n={})'</span></span>.format(<span class="hljs-number"><span class="hljs-number">5</span></span>)) ax.set_xlim([time[<span class="hljs-number"><span class="hljs-number">0</span></span>], time[<span class="hljs-number"><span class="hljs-number">-1</span></span>]]) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.set_title(<span class="hljs-string"><span class="hljs-string">'     SMA'</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">12</span></span>) ax.legend() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> signal_ave filename = <span class="hljs-string"><span class="hljs-string">'Test_set/Bearing2_3/acc_00001.csv'</span></span> df = pd.read_csv(filename, header=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) df_nino = df[<span class="hljs-number"><span class="hljs-number">4</span></span>].values N = df_nino.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] time = arange(<span class="hljs-number"><span class="hljs-number">0</span></span>, N) signal = df_nino signal_ave=plot_signal_plus_average(time, signal) wavelet = <span class="hljs-string"><span class="hljs-string">'cmor1-0.5'</span></span> ax = ax = scg.cws(signal, scales=arange(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>), wavelet=wavelet, figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>),cmap=<span class="hljs-string"><span class="hljs-string">"jet"</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">' '</span></span>, xlabel=<span class="hljs-string"><span class="hljs-string">" "</span></span>, yscale=<span class="hljs-string"><span class="hljs-string">"log"</span></span>, title=<span class="hljs-string"><span class="hljs-string">'CWT  %s \n(     )'</span></span>%filename) ax = ax = scg.cws(signal_ave, scales=arange(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>), wavelet=wavelet, figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), cmap=<span class="hljs-string"><span class="hljs-string">"jet"</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">' '</span></span>, xlabel=<span class="hljs-string"><span class="hljs-string">" "</span></span>, yscale=<span class="hljs-string"><span class="hljs-string">"log"</span></span>, title=<span class="hljs-string"><span class="hljs-string">'CWT  %s \n(    )'</span></span>%filename) show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/dj/r1/jy/djr1jyeyltohdhpij257vpmsk0u.png"><br><img src="https://habrastorage.org/webt/hd/4n/dy/hd4ndykwienlrz68dnh4ijw7l-8.png"><br><img src="https://habrastorage.org/webt/0n/xd/d4/0nxdd44imz5dmgwlvpfmbpf8o2i.png"><br><br>  Como se segue no escalograma, o m√©todo SMA limpa mal o sinal do ru√≠do de alta frequ√™ncia e <br>  como mencionado acima √© usado para suavizar. <br><br><h3>  Conclus√µes: </h3><br><ol><li>  Usando o m√≥dulo de escalograma, foram obtidos escalogramas de wavelets CWT de tr√™s sinais de sensor de vibra√ß√£o de teste para diferentes condi√ß√µes de teste para rolamentos do mesmo tipo.  De acordo com os dados do escalograma, um sinal com sinais claramente expressos de degrada√ß√£o tardia foi selecionado.  Este sinal foi usado para demonstrar a opera√ß√£o dos filtros em todos os exemplos dados. </li><li>  Os m√©todos da biblioteca PyWavelets para desconstru√ß√£o de DWT e restaura√ß√£o do sinal do sensor de vibra√ß√£o usando os m√≥dulos pywt.dwt (), pywt.idwt () e o m√≥dulo pywt.wavedec () para um determinado n√≠vel de wavelet s√£o considerados. </li><li>  Os exemplos mostram os recursos de aplicativo do m√≥dulo pywt.threshol () para filtrar os coeficientes de refinamento DWT, respons√°veis ‚Äã‚Äãpela parte de alta frequ√™ncia do espectro usando fun√ß√µes de limite para um determinado valor de limite. </li><li>  S√£o considerados os efeitos da wavelet antiderivada DWT na forma de um sinal limpo de ru√≠do. </li><li>  √â obtido um modelo de filtro Kalman para um meio din√¢mico; o modelo √© testado no sinal de teste do sensor de vibra√ß√£o.  O gr√°fico de remo√ß√£o de ru√≠do √© igual ao obtido usando o m√≥dulo pyKalman.  A natureza do gr√°fico coincide com o escalograma. </li><li>          . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt459922/">https://habr.com/ru/post/pt459922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt459902/index.html">Mapa interativo das regi√µes russas para iniciantes. Erros que cometi e que voc√™ n√£o deve cometer</a></li>
<li><a href="../pt459906/index.html">Tic Tac Toe, parte 3: Desfazer / Refazer com armazenamento de comando</a></li>
<li><a href="../pt459910/index.html">Situa√ß√£o: as empresas n√£o t√™m pressa em desenvolver servi√ßos para assistentes de voz - quais s√£o os riscos</a></li>
<li><a href="../pt459914/index.html">SQL Index Manager - uma ferramenta gratuita para desfragmentar e manter √≠ndices</a></li>
<li><a href="../pt459918/index.html">Solu√ß√£o de problemas com pwnable.kr 03 - bof. Estouro de buffer na pilha</a></li>
<li><a href="../pt459924/index.html">Ciclo de teste de rea√ß√£o completa. Relat√≥rio Auto.ru</a></li>
<li><a href="../pt459928/index.html">Caminho do aluno para o desenvolvimento de aplicativos para dispositivos m√≥veis</a></li>
<li><a href="../pt459930/index.html">Automa√ß√£o de importa√ß√£o Python</a></li>
<li><a href="../pt459934/index.html">O resumo de materiais interessantes para o desenvolvedor m√≥vel 306 (de 8 a 14 de julho)</a></li>
<li><a href="../pt459936/index.html">Mais 9 truques para trabalhar com o Visual Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>