<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèöÔ∏è üíÖüèæ üîµ Wie wir Daten zu Werbekampagnen von Online-Plattformen gesammelt haben (der dornige Weg zum Produkt) ü§¥ üç£ üëáüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es scheint, dass der Bereich der Online-Werbung so technologisch und automatisiert wie m√∂glich sein sollte. In der Tat arbeiten dort Giganten und Expe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie wir Daten zu Werbekampagnen von Online-Plattformen gesammelt haben (der dornige Weg zum Produkt)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dentsuaegisnetworkrussia/blog/469625/">  Es scheint, dass der Bereich der Online-Werbung so technologisch und automatisiert wie m√∂glich sein sollte.  In der Tat arbeiten dort Giganten und Experten auf ihrem Gebiet wie Yandex, Mail.Ru, Google und Facebook.  Aber wie sich herausstellte, gibt es keine Grenzen f√ºr die Perfektion und es gibt immer etwas zu automatisieren. <br><br><img src="https://habrastorage.org/webt/gg/cq/j3/ggcqj3ws0e1dpcxixrkjdez28ry.png" alt="Bild"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><i>Quelle</i></a> <br><br>  Die Kommunikationsgruppe <b>Dentsu Aegis Network Russia</b> ist der gr√∂√üte Anbieter auf dem digitalen Werbemarkt und investiert aktiv in Technologie, um ihre Gesch√§ftsprozesse zu optimieren und zu automatisieren.  Eines der ungel√∂sten Probleme des Online-Werbemarktes war die Erfassung von Statistiken zu Werbekampagnen auf verschiedenen Online-Sites.  Die L√∂sung f√ºr dieses Problem f√ºhrte letztendlich zur Entwicklung des <b>D1.Digital-</b> Produkts (als DiVan gelesen), √ºber dessen Entwicklung wir sprechen m√∂chten. <br><a name="habracut"></a><br><h3>  Warum? </h3><br>  1. Zum Zeitpunkt des Projektstarts gab es kein einziges fertiges Produkt auf dem Markt, das die Aufgabe der Automatisierung der Erfassung von Statistiken zu Werbekampagnen l√∂ste.  <i>Dies bedeutet, dass niemand au√üer uns unsere Bed√ºrfnisse schlie√üen wird.</i> <br><br>  Dienste wie Improvado, Roistat, Supermetrics, SegmentStream bieten die Integration in Websites, soziale Netzwerke und Google Analitycs sowie die M√∂glichkeit, analytische Dashboards f√ºr die bequeme Analyse und Steuerung von Werbekampagnen zu erstellen.  Bevor wir mit der Entwicklung unseres Produkts begannen, haben wir versucht, einige dieser Systeme in unserer Arbeit zu verwenden, um Daten von Websites zu sammeln, aber leider konnten sie unsere Probleme nicht l√∂sen. <br><br>  Das Hauptproblem bestand darin, dass die getesteten Produkte aus Datenquellen abgesto√üen wurden, Statistiken von Platzierungen in Abschnitten nach Websites angezeigt wurden und keine Aggregation von Statistiken zu Werbekampagnen zulie√ü.  Dieser Ansatz erm√∂glichte es nicht, Statistiken von verschiedenen Standorten an einem Ort anzuzeigen und den Status der Kampagne als Ganzes zu analysieren. <br><br>  Ein weiterer Faktor war, dass die Produkte in der Anfangsphase auf den westlichen Markt ausgerichtet waren und die Integration mit russischen Standorten nicht unterst√ºtzten.  Und f√ºr die Sites, mit denen die Integration implementiert wurde, wurden nicht immer alle erforderlichen Metriken mit ausreichenden Details hochgeladen, und die Integration war nicht immer bequem und transparent, insbesondere wenn etwas abgerufen werden musste, das sich nicht in der Systemschnittstelle befand. <br>  Im Allgemeinen haben wir beschlossen, uns nicht an Produkte von Drittanbietern anzupassen, sondern haben begonnen, unsere eigenen ... <br><br>  2. Der Online-Werbemarkt w√§chst von Jahr zu Jahr und √ºbertraf 2018 traditionell den gr√∂√üten TV-Werbemarkt in Bezug auf das Werbebudget.  <i>Es gibt also eine Skala</i> . <br><br>  3. Im Gegensatz zum TV-Werbemarkt, auf dem der Verkauf von kommerzieller Werbung monopolisiert ist, arbeitet die Masse der einzelnen Eigent√ºmer von Werbemitteln unterschiedlicher Gr√∂√üe mit ihren Werbeb√ºros im Internet.  Da die Werbekampagne in der Regel auf mehreren Websites gleichzeitig ausgef√ºhrt wird, m√ºssen zum Sammeln des Status der Werbekampagne Berichte von allen Websites gesammelt und zu einem gro√üen Bericht zusammengefasst werden, der das gesamte Bild zeigt.  <i>Es besteht also Optimierungspotential.</i> <br><br>  4. Es schien uns, dass die Eigent√ºmer von Werbeinventar im Internet bereits √ºber eine Infrastruktur zum Sammeln und Anzeigen von Statistiken in Werbeb√ºros verf√ºgten und eine API f√ºr diese Daten bereitstellen konnten.  <i>Es gibt also eine technische Machbarkeit.</i>  Wir werden gleich sagen, dass es nicht so einfach war. <br><br>  Im Allgemeinen waren uns alle Voraussetzungen f√ºr die Umsetzung des Projekts klar, und wir liefen, um das Projekt umzusetzen ... <br><br><h3>  Gro√üartiger Plan </h3><br>  Zun√§chst formulierten wir eine Vision eines idealen Systems: <br><br><ul><li>  Es sollte automatisch Werbekampagnen aus dem 1C-Unternehmenssystem mit ihren Namen, Zeitr√§umen, Budgets und Platzierungen auf verschiedenen Plattformen laden. </li><li>  F√ºr jede Platzierung innerhalb der Werbekampagne sollten alle m√∂glichen Statistiken von den Websites, auf denen die Platzierung durchgef√ºhrt wird, automatisch heruntergeladen werden, z. B. die Anzahl der Impressionen, Klicks, Ansichten usw. </li><li>  Einige Werbekampagnen werden von Dritten durch sogenannte Adserving-Systeme wie Adriver, Weborama, DCM usw. √ºberwacht.  In Russland gibt es auch einen industriellen Internet-Z√§hler - Mediascope.  Nach unserer Vorstellung sollten die Daten der unabh√§ngigen und industriellen √úberwachung auch automatisch in die entsprechenden Werbekampagnen hochgeladen werden. </li><li>  Die meisten Werbekampagnen im Internet zielen auf bestimmte gezielte Aktionen (Kaufen, Anrufen, Aufzeichnen f√ºr eine Probefahrt usw.) ab, die mithilfe von Google Analytics verfolgt werden, und Statistiken, die ebenfalls wichtig f√ºr das Verst√§ndnis des Kampagnenstatus sind und in unser Tool hochgeladen werden sollten . </li></ul><br><h3>  Der erste Pfannkuchen ist klumpig </h3><br>  In Anbetracht unseres Engagements f√ºr flexible Prinzipien der Softwareentwicklung (agil, alles in allem) haben wir uns entschlossen, zuerst MVP zu entwickeln und dann iterativ auf das angestrebte Ziel hinzuarbeiten. <br>  Wir haben uns entschlossen, MVP auf Basis unseres Produkts <b>DANBo (Dentsu Aegis Network Board) zu erstellen</b> , einer Webanwendung mit allgemeinen Informationen zu den Werbekampagnen unserer Kunden. <br><br>  F√ºr MVP wurde das Projekt hinsichtlich der Implementierung maximal vereinfacht.  Wir haben eine begrenzte Liste von Websites f√ºr die Integration ausgew√§hlt.  Dies waren die Hauptplattformen wie Yandex.Direct, Yandex.Display, RB.Mail, MyTarget, AdWords, DBM, VK, FB und die Haupt-Adserving-Systeme Adriver und Weborama. <br><br>  F√ºr den Zugriff auf Statistiken zu den Websites √ºber die API haben wir ein einzelnes Konto verwendet.  Der Kundengruppenmanager, der die automatische Erfassung von Statistiken zur Werbekampagne nutzen wollte, musste zun√§chst den Zugriff auf die erforderlichen Werbekampagnen auf den Websites an das Plattformkonto delegieren. <br><br>  Ferner musste der Benutzer des <b>DANBo-</b> Systems eine Datei eines bestimmten Formats in das Excel-System hochladen, in der alle Informationen √ºber die Platzierung (Werbekampagne, Website, Format, Platzierungszeitraum, geplante Indikatoren, Budget usw.) und die Kennungen der entsprechenden Werbekampagnen auf den Websites geschrieben wurden und Z√§hler in Adserving-Systemen. <br><br>  Es sah ehrlich gesagt erschreckend aus: <br><br><img src="https://habrastorage.org/webt/ie/kc/sd/iekcsdiz6k8fltryf2ydfgi-f14.png" alt="Bild"><br><br>  Die heruntergeladenen Daten wurden in der Datenbank gespeichert, und dann sammelten einzelne Dienste Kampagnenkennungen von ihnen von den Websites und luden Statistiken √ºber sie herunter. <br><br>  F√ºr jede Site wurde ein separater Windows-Dienst geschrieben, der einmal t√§glich unter einem Dienstkonto in der API der Site abgelegt und Statistiken zu den angegebenen Kampagnen-IDs heruntergeladen wurde.  Dasselbe geschah mit Adserving-Systemen. <br><br>  Die heruntergeladenen Daten wurden auf der Benutzeroberfl√§che in Form eines kleinen selbstgeschriebenen Dashboards angezeigt: <br><br><img src="https://habrastorage.org/webt/8n/xy/bl/8nxyblj7gcdigcrczqpryslhoue.png" alt="Bild"><br><br>  Unerwartet f√ºr uns verdiente MVP und begann, aktuelle Statistiken √ºber Werbekampagnen im Internet herunterzuladen.  Wir haben das System auf mehreren Clients implementiert, aber als wir versuchten, es zu skalieren, stie√üen wir auf ernsthafte Probleme: <br><br><ul><li>  Das Hauptproblem war die m√ºhsame Vorbereitung der Daten zum Laden in das System.  Au√üerdem mussten die Platzierungsdaten vor dem Herunterladen auf ein streng festes Format reduziert werden.  In der Datei zum Laden mussten die Kennungen von Entit√§ten von verschiedenen Standorten registriert werden.  Wir sind mit der Tatsache konfrontiert, dass es f√ºr technisch nicht geschulte Benutzer sehr schwierig ist zu erkl√§ren, wo diese Kennungen auf der Website zu finden sind und wo sie in die Datei aufgenommen werden sollen.  Angesichts der Anzahl der Mitarbeiter in den Abteilungen, die Kampagnen auf den Standorten durchf√ºhren, und des Umsatzes f√ºhrte dies zu einer enormen Unterst√ºtzung auf unserer Seite, die kategorisch nicht zu uns passte. </li><li>  Ein weiteres Problem bestand darin, dass nicht alle Werbeplattformen √ºber Mechanismen verf√ºgten, um den Zugriff auf Werbekampagnen auf andere Konten zu delegieren.  Aber selbst wenn der Delegierungsmechanismus verf√ºgbar war, waren nicht alle Werbetreibenden bereit, Drittanbieter-Kontozugriff auf ihre Kampagnen zu gew√§hren. </li><li>  Ein wichtiger Faktor war die Emp√∂rung, die dazu f√ºhrte, dass Benutzer alle geplanten Indikatoren und Platzierungsdetails, die sie bereits zu unserem 1C-Buchhaltungssystem beitragen, erneut in <b>DANBo eingeben sollten</b> . </li></ul><br>  Dies brachte uns auf die Idee, dass die Hauptinformationsquelle √ºber den Standort unser 1C-System sein sollte, in dem alle Daten genau und p√ºnktlich eingegeben werden (der Punkt ist, dass basierend auf den 1C-Daten Konten gebildet werden, daher ist die korrekte Eingabe der Daten in 1C f√ºr alle in KPI).  So erschien ein neues Systemkonzept ... <br><br><h3>  Konzept </h3><br>  Als erstes haben wir beschlossen, das System zur Erfassung von Statistiken √ºber Werbekampagnen im Internet in ein separates Produkt zu unterteilen - <b>D1.Digital</b> . <br><br>  In dem neuen Konzept haben wir beschlossen, Informationen zu Werbekampagnen und darin enthaltenen Placements von 1C in <b>D1.Digital</b> zu <b>laden</b> und dann Statistiken von Websites und von AdServing-Systemen auf diese Placements zu ziehen.  Dies sollte das Leben der Benutzer erheblich vereinfachen (und wie √ºblich den Entwicklern Arbeit hinzuf√ºgen) und den Support reduzieren. <br><br>  Das erste Problem, auf das wir stie√üen, war organisatorischer Natur und hing mit der Tatsache zusammen, dass wir keinen Schl√ºssel oder kein Attribut finden konnten, anhand dessen wir Entit√§ten aus verschiedenen Systemen mit Kampagnen und Placements von 1C vergleichen konnten.  Tatsache ist, dass der Prozess in unserem Unternehmen so gestaltet ist, dass Werbekampagnen von verschiedenen Personen (Mediaplayer, Kauf usw.) in unterschiedliche Systeme eingegeben werden. <br><br>  Um dieses Problem zu l√∂sen, mussten wir einen eindeutigen Hash-Schl√ºssel, DANBoID, erfinden, der Entit√§ten in verschiedenen Systemen miteinander verbindet und der in den geladenen Datens√§tzen recht einfach und eindeutig identifiziert werden kann.  Diese Kennung wird im internen 1C-System f√ºr jede einzelne Platzierung generiert und in Kampagnen, Platzierungen und Z√§hler an allen Standorten und in allen AdServing-Systemen verwendet.  Die Implementierung der Praxis, DANBoID an allen Placements anzubringen, hat einige Zeit gedauert, aber wir haben es geschafft :) <br><br>  Dann haben wir festgestellt, dass nicht alle Websites √ºber eine API f√ºr die automatische Erfassung von Statistiken verf√ºgen und selbst diejenigen mit einer API nicht alle erforderlichen Daten zur√ºckgeben. <br><br>  Zu diesem Zeitpunkt haben wir beschlossen, die Liste der zu integrierenden Websites erheblich zu reduzieren und uns auf die Hauptwebsites zu konzentrieren, die an der √ºberwiegenden Mehrheit der Werbekampagnen beteiligt sind.  Diese Liste enth√§lt alle gr√∂√üten Akteure auf dem Werbemarkt (Google, Yandex, Mail.ru), soziale Netzwerke (VK, Facebook, Twitter), die wichtigsten AdServing- und Analysesysteme (DCM, Adriver, Weborama, Google Analytics) und andere Plattformen. <br><br>  Der Gro√üteil der von uns ausgew√§hlten Websites verf√ºgte √ºber eine API, die uns die erforderlichen Metriken lieferte.  In den F√§llen, in denen die API nicht vorhanden war oder nicht √ºber die erforderlichen Daten verf√ºgte, verwendeten wir Berichte, die t√§glich per Gesch√§ftspost eingingen, um die Daten herunterzuladen (in einigen Systemen ist es m√∂glich, solche Berichte zu konfigurieren, in anderen stimmten sie der Entwicklung solcher Berichte f√ºr uns zu). <br><br>  Bei der Analyse von Daten von verschiedenen Standorten haben wir festgestellt, dass die Hierarchie der Entit√§ten in verschiedenen Systemen nicht gleich ist.  Dar√ºber hinaus m√ºssen Informationen aus verschiedenen Systemen unterschiedlich detailliert geladen werden. <br><br>  Um dieses Problem zu l√∂sen, wurde das SubDANBoID-Konzept entwickelt.  Die Idee von SubDANBoID ist recht einfach. Wir kennzeichnen das Hauptaugenmerk der Kampagne auf der Site mit der generierten DANBoID. Wir laden alle verschachtelten Entit√§ten mit eindeutigen Kennungen der Site hoch und bilden die SubDANBoID gem√§√ü dem DANBoID-Prinzip + Kennung der verschachtelten Entit√§t der ersten Ebene + Kennung der verschachtelten Entit√§t der zweiten Ebene Werbekampagnen in verschiedenen Systemen und laden Sie detaillierte Statistiken dar√ºber hoch. <br><br>  Wir mussten auch das Problem des Zugriffs auf Kampagnen an verschiedenen Standorten l√∂sen.  Wie oben beschrieben, ist der Mechanismus zum Delegieren des Zugriffs auf die Kampagne an ein separates technisches Konto nicht immer anwendbar.  Daher mussten wir eine Infrastruktur f√ºr die automatische Autorisierung durch OAuth unter Verwendung von Token und Aktualisierungsmechanismen f√ºr diese Token entwickeln. <br><br>  Weiter im Artikel werden wir versuchen, die Architektur der L√∂sung und die technischen Details der Implementierung detaillierter zu beschreiben. <br><br><h3>  L√∂sungsarchitektur 1.0 </h3><br>  Als wir mit der Implementierung eines neuen Produkts begannen, war uns klar, dass es sofort notwendig war, die M√∂glichkeit zum Verbinden neuer Standorte vorzusehen, und beschlossen daher, den Weg der Microservice-Architektur zu beschreiten. <br><br>  Bei der Gestaltung der Architektur haben wir separate Service-Konnektoren f√ºr alle externen Systeme ausgew√§hlt - 1C, Werbeplattformen und Adserving-Systeme. <br>  Die Hauptidee ist, dass alle Konnektoren zu den Sites dieselbe API haben und Adapter sind, die die Site-APIs zu unserer praktischen Oberfl√§che bringen. <br><br>  Im Zentrum unseres Produkts steht eine Webanwendung, bei der es sich um einen Monolithen handelt, der so konzipiert ist, dass er leicht in Services zerlegt werden kann.  Diese Anwendung ist daf√ºr verantwortlich, heruntergeladene Daten zu verarbeiten, Statistiken von verschiedenen Systemen zu vergleichen und sie den Benutzern des Systems zu pr√§sentieren. <br><br>  Um Konnektoren mit einer Webanwendung zu kommunizieren, mussten wir einen zus√§tzlichen Dienst erstellen, den wir Connector Proxy nannten.  Es f√ºhrt die Funktionen von Service Discovery und Task Scheduler aus.  Dieser Dienst f√ºhrt jede Nacht Datenerfassungsaufgaben f√ºr jeden Connector aus.  Das Schreiben einer Service-Schicht war einfacher als das Verbinden eines Nachrichtenbrokers, und f√ºr uns war es wichtig, das Ergebnis so schnell wie m√∂glich zu erhalten. <br><br>  Aus Gr√ºnden der Einfachheit und Geschwindigkeit der Entwicklung haben wir au√üerdem beschlossen, dass alle Dienste eine Web-API sind.  Dies erm√∂glichte es, schnell einen Proof-of-Concept zusammenzustellen und zu √ºberpr√ºfen, ob das gesamte Design funktionierte. <br><br><img src="https://habrastorage.org/webt/eb/_s/ui/eb_suixgwtg5u5e35t01dzqhuqw.png" alt="Bild"><br><br>  Eine separate, ziemlich schwierige Aufgabe bestand darin, den Zugriff zum Sammeln von Daten aus verschiedenen Schr√§nken einzurichten, die, wie wir beschlossen hatten, von den Benutzern √ºber eine Weboberfl√§che ausgef√ºhrt werden sollten.  Es besteht aus zwei separaten Schritten: Zuerst f√ºgt der Benutzer √ºber OAuth ein Token hinzu, um auf das Konto zuzugreifen, und richtet dann die Datenerfassung f√ºr den Client von einem bestimmten Konto aus ein.  Das Abrufen eines Tokens √ºber OAuth ist erforderlich, da es, wie bereits geschrieben, nicht immer m√∂glich ist, den Zugriff auf das gew√ºnschte Kabinett auf der Site zu delegieren. <br><br>  Um einen universellen Mechanismus f√ºr die Auswahl eines Schranks aus Sites zu erstellen, mussten wir der Connectors-API eine Methode hinzuf√ºgen, mit der das JSON-Schema gerendert wird, das mithilfe einer modifizierten JSONEditor-Komponente in das Formular gerendert wird.  So konnten Benutzer die Konten ausw√§hlen, von denen Daten heruntergeladen werden sollen. <br><br>  Um die auf den Websites geltenden Anforderungslimits einzuhalten, kombinieren wir die Anforderung von Einstellungen innerhalb desselben Tokens, k√∂nnen jedoch verschiedene Token parallel verarbeiten. <br><br>  Wir haben MongoDB als Repository f√ºr herunterladbare Daten sowohl f√ºr eine Webanwendung als auch f√ºr Konnektoren ausgew√§hlt, sodass wir uns in den ersten Entwicklungsphasen, wenn sich das Anwendungsmodell nach einem Tag √§ndert, nicht viel um die Datenstruktur k√ºmmern mussten. <br><br>  Bald stellten wir fest, dass nicht alle Daten gut in MongoDB passen und beispielsweise t√§gliche Statistiken bequemer in einer relationalen Datenbank zu speichern sind.  Daher haben wir f√ºr Konnektoren, deren Datenstruktur besser f√ºr eine relationale Datenbank geeignet ist, begonnen, PostgreSQL oder MS SQL Server als Speicher zu verwenden. <br><br>  Die ausgew√§hlte Architektur und Technologie erm√∂glichte es uns, das Produkt D1.Digital relativ schnell zu entwickeln und auf den Markt zu bringen.  In den zwei Jahren der Produktentwicklung haben wir 23 Site-Konnektoren entwickelt, wertvolle Erfahrungen mit APIs von Drittanbietern gesammelt, gelernt, wie die Fallstricke verschiedener Sites mit jeweils eigenen Sites umgangen werden k√∂nnen, zur Entwicklung der API mindestens 3 Sites beigetragen, automatisch Informationen zu fast 15.000 Kampagnen heruntergeladen und In mehr als 80.000 Placements haben wir viele R√ºckmeldungen von Benutzern zum Produkt gesammelt und es geschafft, den Hauptprozess des Produkts basierend auf diesen R√ºckmeldungen mehrmals zu √§ndern. <br><br><h3>  L√∂sungsarchitektur 2.0 </h3><br>  Seit Beginn der Entwicklung von <b>D1.Digital sind</b> zwei Jahre vergangen.  Die stetig zunehmende Belastung des Systems und das Aufkommen immer neuer Datenquellen zeigten allm√§hlich Probleme in der bestehenden L√∂sungsarchitektur. <br><br>  Das erste Problem h√§ngt mit der Datenmenge zusammen, die von den Websites heruntergeladen wurde.  Wir waren mit der Tatsache konfrontiert, dass das Sammeln und Aktualisieren aller erforderlichen Daten von den gr√∂√üten Standorten zu lange dauerte.  Das Sammeln von Daten auf dem AdRiver-Adserving-System, mit dem wir Statistiken f√ºr die meisten Placements verfolgen, dauert beispielsweise etwa 12 Stunden. <br><br>  Um dieses Problem zu l√∂sen, haben wir begonnen, alle Arten von Berichten zum Herunterladen von Daten von den Websites zu verwenden. Wir versuchen, deren APIs zusammen mit den Websites so zu entwickeln, dass ihre Geschwindigkeit unseren Anforderungen entspricht, und das Laden von Daten so weit wie m√∂glich zu parallelisieren. <br><br>  Ein weiteres Problem ist die Verarbeitung heruntergeladener Daten.  Mit der Einf√ºhrung neuer Statistiken zur Platzierung wird nun ein mehrstufiger Prozess zur Neuberechnung von Metriken gestartet, der das Laden von Rohdaten, das Berechnen aggregierter Metriken f√ºr jede Site, das Vergleichen von Daten aus verschiedenen Quellen und das Berechnen von zusammenfassenden Metriken f√ºr die Kampagne umfasst.  Dies f√ºhrt zu einer hohen Belastung der Webanwendung, die alle Berechnungen durchf√ºhrt.  W√§hrend des Nachz√§hlens verbraucht die Anwendung mehrmals den gesamten Speicher auf dem Server, etwa 10 bis 15 GB, was sich am nachteiligsten auf die Arbeit des Benutzers mit dem System auswirkt. <br><br>  Die identifizierten Probleme und gro√üartigen Pl√§ne f√ºr die Weiterentwicklung des Produkts f√ºhrten dazu, dass die Anwendungsarchitektur √ºberarbeitet werden musste. <br><br>  Wir haben mit Steckverbindern begonnen. <br>  Wir haben festgestellt, dass alle Konnektoren nach demselben Modell arbeiten. Deshalb haben wir einen Pipeline-F√∂rderer gebaut, in dem Sie zum Erstellen des Konnektors nur die Logik der Schritte programmieren mussten. Der Rest war universell.  Wenn ein Konnektor verbessert werden muss, werden wir ihn sofort auf ein neues Framework √ºbertragen, w√§hrend der Konnektor fertiggestellt wird. <br><br>  Parallel dazu haben wir begonnen, Konnektoren in Docker und Kubernetes zu platzieren. <br>  Wir hatten vor, lange Zeit auf Kubernetes umzusteigen, experimentierten mit CI / CD-Einstellungen, begannen jedoch erst, als ein Connector aufgrund eines Fehlers mehr als 20 GB Speicher auf dem Server verbrauchte und den Rest der Prozesse fast zum Erliegen brachte.  W√§hrend der Untersuchung wurde der Konnektor in den Kubernetes-Cluster verschoben, wo er schlie√ülich auch dann blieb, wenn der Fehler behoben wurde. <br><br>  Sehr schnell stellten wir fest, dass Kubernetes praktisch war, und in sechs Monaten haben wir 7 Connectors und Connectors Proxy in den Produktionscluster verschoben, die die meisten Ressourcen verbrauchen. <br><br>  Im Anschluss an die Konnektoren haben wir beschlossen, die Architektur der restlichen Anwendung zu √§ndern. <br>  Das Hauptproblem bestand darin, dass die Daten von Konnektoren zu Proxys in gro√üen B√ºndeln stammen und dann auf DANBoID schlagen und zur Verarbeitung an eine zentrale Webanwendung √ºbertragen werden.  Aufgrund der gro√üen Anzahl von Neuberechnungen von Metriken tritt eine gro√üe Belastung f√ºr die Anwendung auf. <br><br>              ,   ,   web ,    ,  ,  -    . <br><br>        2.0. <br><br>        ,   Web API   RabbitMQ   MassTransit     .       Connectors Proxy,    Connectors Hub.   ,             ,       . <br><br>   web             ,                  .             . <br><br>           Kubernetes,         . <br><br><img src="https://habrastorage.org/webt/lx/3j/tw/lx3jtwply2iyyms99xajwhtnsie.png" alt="Bild"><br><br><h3>    </h3><br> Proof-of-concept  2.0  <b>D1.Digital</b>          .    ‚Äî   20    , ,    ,     ,      . <br><br>   ,              API,    . <br><br>        ,           ,      adserving . <br><br>     ,      web ,    Kubernetes.     ,     ,     . <br><br>          ,     MongoDB.        SQL-,     ,      ,      ,     . <br><br>  ,  ,   :) <br><br> <i>  R&amp;D Dentsu Aegis Network Russia:   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">shmiigaa</a> ),   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">hitexx</a> )</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de469625/">https://habr.com/ru/post/de469625/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de469613/index.html">√úber das nationale Datenmanagementsystem</a></li>
<li><a href="../de469615/index.html">Hochpr√§zise Zeit: Arbeiten mit Sekundenbruchteilen in MySQL und PHP</a></li>
<li><a href="../de469617/index.html">Zerst√∂ren Sie Amerikas Monopol in der EDA. Innopolis macht den ersten Schritt</a></li>
<li><a href="../de469619/index.html">Recherche: Wenn der K√§ufer versteht, dass er mit dem Chat-Bot spricht, findet der Kauf √ºberhaupt nicht statt</a></li>
<li><a href="../de469623/index.html">GitLab 12.3 mit Webanwendungs-Firewall und Leistungsanalyse</a></li>
<li><a href="../de469629/index.html">Friedliches Atom ist nicht in jedem Haus: unerwartete Optionen f√ºr Radionuklid-Energiequellen</a></li>
<li><a href="../de469631/index.html">Beschleunigung in Figma. Ben√∂tigen Sie mehr Plugins</a></li>
<li><a href="../de469633/index.html">Wir erstellen einen Datensatz zur Erkennung von Z√§hlern auf Yandex.Tolok</a></li>
<li><a href="../de469635/index.html">So funktionieren Geldtransfers von Karte zu Karte</a></li>
<li><a href="../de469637/index.html">In den 90ern entwickelte Rapper MC Hammer das Spiel, aber heute kann U This nicht anfassen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>