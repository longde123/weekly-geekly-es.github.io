<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõï üßëüèæ üôçüèæ API REST de Magento 2 utilizando un m√≥dulo simple como ejemplo ‚õπüèª üíë üêÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬°Os doy la bienvenida, queridos habravitas! Como he estado desarrollando en la plataforma de comercio electr√≥nico de Magento desde 2013, habiendo reun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>API REST de Magento 2 utilizando un m√≥dulo simple como ejemplo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413463/">  ¬°Os doy la bienvenida, queridos habravitas!  Como he estado desarrollando en la plataforma de comercio electr√≥nico de Magento desde 2013, habiendo reunido valor y creyendo que en esta √°rea me puedo llamar, al menos, un desarrollador confiable, decid√≠ escribir mi primer art√≠culo en el centro sobre este sistema.  Y comenzar√© con la implementaci√≥n de la API REST en Magento 2. Aqu√≠, de forma inmediata, hay una funcionalidad para procesar solicitudes y tratar√© de demostrarlo usando un ejemplo de un m√≥dulo simple.  Este art√≠culo est√° m√°s dirigido a aquellos que ya han trabajado con Magenta.  Entonces, ¬øa qui√©n le interesa, por favor, debajo del gato? <br><a name="habracut"></a><br><h4>  Empate </h4><br>  Mi imaginaci√≥n es muy mala, as√≠ que se me ocurri√≥ el siguiente ejemplo: imagina que necesitamos implementar un blog, solo los usuarios del panel de administraci√≥n pueden escribir art√≠culos.  De vez en cuando, alg√∫n CRM nos llama y carga estos art√≠culos para s√≠ mismo (por qu√© no est√° claro, pero as√≠ es como justificaremos el uso de la API REST).  Para simplificar el m√≥dulo, omit√≠ espec√≠ficamente la implementaci√≥n de mostrar art√≠culos en la interfaz y en el panel de administraci√≥n (puede implementarlo usted mismo, le recomiendo un buen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> sobre cuadr√≠culas).  Solo la funcionalidad de procesamiento de consultas se ver√° afectada aqu√≠. <br><br><h4>  Desarrollo de la acci√≥n </h4><br>  Primero, cree la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estructura del</a> m√≥dulo, llam√©moslo <i>AlexPoletaev_Blog</i> (la falta de imaginaci√≥n no ha desaparecido).  Colocamos el m√≥dulo en el directorio de la <i>aplicaci√≥n / c√≥digo</i> . <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / etc / module.xml</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:noNamespaceSchemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:magento:framework:Module/etc/module.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev_Blog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">setup_version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0.0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Registration.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> \Magento\Framework\Component\ComponentRegistrar::register( \Magento\Framework\Component\ComponentRegistrar::MODULE, <span class="hljs-string"><span class="hljs-string">'AlexPoletaev_Blog'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span> );</code> </pre><br></div></div><br>  Estos dos archivos son los m√≠nimos necesarios para el m√≥dulo. <br><br>  Si todo se hace en Feng Shui, entonces necesitamos crear contratos de servicio (qu√© es dentro del Magenta y c√≥mo funciona, puede leer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ), lo que haremos: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Api / Data / PostInterface.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Interface PostInterface * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Api\Data * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@api</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**#@+ * Constants * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ID = <span class="hljs-string"><span class="hljs-string">'id'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AUTHOR_ID = <span class="hljs-string"><span class="hljs-string">'author_id'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TITLE = <span class="hljs-string"><span class="hljs-string">'title'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CONTENT = <span class="hljs-string"><span class="hljs-string">'content'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CREATED_AT = <span class="hljs-string"><span class="hljs-string">'created_at'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UPDATED_AT = <span class="hljs-string"><span class="hljs-string">'updated_at'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/**#@-*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> int */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> int */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuthorId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $authorId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAuthorId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($authorId)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $title * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $title)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $content * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $content)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCreatedAt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $createdAt * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setCreatedAt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $createdAt)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUpdatedAt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $updatedAt * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUpdatedAt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $updatedAt)</span></span></span></span>; }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Api / PostRepositoryInterface.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">SearchCriteriaInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Interface PostRepositoryInterface * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Api * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@api</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostRepositoryInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \Magento\Framework\Api\SearchCriteriaInterface $searchCriteria * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostSearchResultInterface */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SearchCriteriaInterface $searchCriteria)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface $post * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">save</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PostInterface $post)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface $post * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> bool */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PostInterface $post)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> bool */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id)</span></span></span></span>; }</code> </pre><br></div></div><br>  Analicemos estas dos interfaces con m√°s detalle.  La interfaz <i>PostInterface</i> muestra una tabla con art√≠culos de nuestro blog.  Crea una tabla a continuaci√≥n.  Cada columna de la base de datos debe tener su propio getter y setter en esta interfaz, descubriremos por qu√© esto es importante m√°s adelante.  La interfaz <i>PostRepositoryInterface</i> proporciona un conjunto est√°ndar de m√©todos para interactuar con la base de datos y almacenar entidades cargadas en la memoria cach√©.  Se utilizan los mismos m√©todos para la API.  Otra nota importante, se <b>requiere</b> la presencia de PHPDocs correctos en estas interfaces, ya que Magenta, al procesar una solicitud REST, utiliza la reflexi√≥n para determinar los par√°metros de entrada y los valores de retorno en los m√©todos. <br><br>  Usando el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">script de instalaci√≥n,</a> cree una tabla donde se almacenar√°n las publicaciones del blog: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Setup / InstallSchema.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Setup</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostResource</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">DB</span></span>\<span class="hljs-title"><span class="hljs-title">Adapter</span></span>\<span class="hljs-title"><span class="hljs-title">AdapterInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">DB</span></span>\<span class="hljs-title"><span class="hljs-title">Ddl</span></span>\<span class="hljs-title"><span class="hljs-title">Table</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Setup</span></span>\<span class="hljs-title"><span class="hljs-title">InstallSchemaInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Setup</span></span>\<span class="hljs-title"><span class="hljs-title">ModuleContextInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Setup</span></span>\<span class="hljs-title"><span class="hljs-title">SchemaSetupInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Security</span></span>\<span class="hljs-title"><span class="hljs-title">Setup</span></span>\<span class="hljs-title"><span class="hljs-title">InstallSchema</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">SecurityInstallSchema</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class InstallSchema * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Setup */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InstallSchema</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InstallSchemaInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Installs DB schema for a module * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> SchemaSetupInterface $setup * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> ModuleContextInterface $context * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">install</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SchemaSetupInterface $setup, ModuleContextInterface $context)</span></span></span><span class="hljs-function"> </span></span>{ $setup-&gt;startSetup(); $table = $setup-&gt;getConnection() -&gt;newTable( $setup-&gt;getTable(PostResource::TABLE_NAME) ) -&gt;addColumn( PostInterface::ID, Table::TYPE_INTEGER, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, [<span class="hljs-string"><span class="hljs-string">'identity'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'nullable'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'primary'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>], <span class="hljs-string"><span class="hljs-string">'Post ID'</span></span> ) -&gt;addColumn( PostInterface::AUTHOR_ID, Table::TYPE_INTEGER, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, [<span class="hljs-string"><span class="hljs-string">'unsigned'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'nullable'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,], <span class="hljs-string"><span class="hljs-string">'Author ID'</span></span> ) -&gt;addColumn( PostInterface::TITLE, Table::TYPE_TEXT, <span class="hljs-number"><span class="hljs-number">255</span></span>, [], <span class="hljs-string"><span class="hljs-string">'Title'</span></span> ) -&gt;addColumn( PostInterface::CONTENT, Table::TYPE_TEXT, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, [], <span class="hljs-string"><span class="hljs-string">'Content'</span></span> ) -&gt;addColumn( <span class="hljs-string"><span class="hljs-string">'created_at'</span></span>, Table::TYPE_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, [<span class="hljs-string"><span class="hljs-string">'nullable'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span> =&gt; Table::TIMESTAMP_INIT], <span class="hljs-string"><span class="hljs-string">'Creation Time'</span></span> ) -&gt;addColumn( <span class="hljs-string"><span class="hljs-string">'updated_at'</span></span>, Table::TYPE_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, [<span class="hljs-string"><span class="hljs-string">'nullable'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span> =&gt; Table::TIMESTAMP_INIT_UPDATE], <span class="hljs-string"><span class="hljs-string">'Update Time'</span></span> ) -&gt;addForeignKey( $setup-&gt;getFkName( PostResource::TABLE_NAME, PostInterface::AUTHOR_ID, SecurityInstallSchema::ADMIN_USER_DB_TABLE_NAME, <span class="hljs-string"><span class="hljs-string">'user_id'</span></span> ), PostInterface::AUTHOR_ID, $setup-&gt;getTable(SecurityInstallSchema::ADMIN_USER_DB_TABLE_NAME), <span class="hljs-string"><span class="hljs-string">'user_id'</span></span>, Table::ACTION_SET_NULL ) -&gt;addIndex( $setup-&gt;getIdxName( PostResource::TABLE_NAME, [PostInterface::AUTHOR_ID], AdapterInterface::INDEX_TYPE_INDEX ), [PostInterface::AUTHOR_ID], [<span class="hljs-string"><span class="hljs-string">'type'</span></span> =&gt; AdapterInterface::INDEX_TYPE_INDEX] ) -&gt;setComment(<span class="hljs-string"><span class="hljs-string">'Posts'</span></span>) ; $setup-&gt;getConnection()-&gt;createTable($table); $setup-&gt;endSetup(); } }</code> </pre><br></div></div><br>  La tabla tendr√° las siguientes columnas (no lo olvide, tenemos todo lo m√°s simple posible): <br><br><ul><li>  id: incremento autom√°tico </li><li>  author_id: identificador de usuario administrador (clave externa en el campo user_id de la tabla admin_user) </li><li>  t√≠tulo - t√≠tulo </li><li>  contenido - texto del art√≠culo </li><li>  created_at - fecha de creaci√≥n </li><li>  updated_at - editar fecha </li></ul><br>  Ahora necesita crear un conjunto est√°ndar de clases de <i>modelo</i> magenta, <i>modelo de</i> <i>recursos</i> y <i>colecci√≥n</i> .  Por qu√© no pintar√© estas clases, este tema es extenso y va m√°s all√° del alcance de este art√≠culo, quienes est√°n interesados ‚Äã‚Äãpueden buscar en Google por su cuenta.  En pocas palabras, estas clases son necesarias para manipular entidades (art√≠culos) de la base de datos.  Le aconsejo que lea sobre los patrones del Modelo de Dominio, el Repositorio y la Capa de Servicio. <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Model / Post.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostResource</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractModel</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class Post * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Model */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Post</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractModel</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $_idFieldName = PostInterface::ID; <span class="hljs-comment"><span class="hljs-comment">//@codingStandardsIgnoreLine /** * @inheritdoc */ protected function _construct() //@codingStandardsIgnoreLine { $this-&gt;_init(PostResource::class); } /** * @return int */ public function getAuthorId() { return $this-&gt;getData(PostInterface::AUTHOR_ID); } /** * @param int $authorId * @return $this */ public function setAuthorId($authorId) { $this-&gt;setData(PostInterface::AUTHOR_ID, $authorId); return $this; } /** * @return string */ public function getTitle() { return $this-&gt;getData(PostInterface::TITLE); } /** * @param string $title * @return $this */ public function setTitle(string $title) { $this-&gt;setData(PostInterface::TITLE, $title); return $this; } /** * @return string */ public function getContent() { return $this-&gt;getData(PostInterface::CONTENT); } /** * @param string $content * @return $this */ public function setContent(string $content) { $this-&gt;setData(PostInterface::CONTENT, $content); return $this; } /** * @return string */ public function getCreatedAt() { return $this-&gt;getData(PostInterface::CREATED_AT); } /** * @param string $createdAt * @return $this */ public function setCreatedAt(string $createdAt) { $this-&gt;setData(PostInterface::CREATED_AT, $createdAt); return $this; } /** * @return string */ public function getUpdatedAt() { return $this-&gt;getData(PostInterface::UPDATED_AT); } /** * @param string $updatedAt * @return $this */ public function setUpdatedAt(string $updatedAt) { $this-&gt;setData(PostInterface::UPDATED_AT, $updatedAt); return $this; } }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Model / ResourceModel / Post.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Db</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractDb</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class Post * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Model\ResourceModel */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Post</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractDb</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TABLE_NAME = <span class="hljs-string"><span class="hljs-string">'alex_poletaev_blog_post'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Resource initialization * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> //@</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">codingStandardsIgnoreLine</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_init(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::TABLE_NAME, PostInterface::ID); } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Model / ResourceModel / Post / Collection.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostResource</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Db</span></span>\<span class="hljs-title"><span class="hljs-title">Collection</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractCollection</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class Collection * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Model\ResourceModel\Post */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Collection</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractCollection</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> //@</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">codingStandardsIgnoreLine</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_init(Post::class, PostResource::class); } }</code> </pre><br></div></div><br>  Un lector atento notar√° que nuestro modelo implementa la interfaz creada previamente y todos sus captadores y establecedores. <br><br>  Al mismo tiempo, implementamos el repositorio y sus m√©todos: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Model / PostRepository.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostSearchResultInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">PostSearchResultInterfaceFactory</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">PostRepositoryInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostResource</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span>\<span class="hljs-title"><span class="hljs-title">Collection</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostCollection</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span>\<span class="hljs-title"><span class="hljs-title">CollectionFactory</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostCollectionFactory</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">PostFactory</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">SearchCriteriaInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Exception</span></span>\<span class="hljs-title"><span class="hljs-title">NoSuchEntityException</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Exception</span></span>\<span class="hljs-title"><span class="hljs-title">StateException</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class PostRepository * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Model */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostRepositoryInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> array */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $registry = []; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostResource */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $postResource; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostFactory */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $postFactory; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostCollectionFactory */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $postCollectionFactory; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostSearchResultInterfaceFactory */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $postSearchResultFactory; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> PostResource $postResource * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> PostFactory $postFactory * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> PostCollectionFactory $postCollectionFactory * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> PostSearchResultInterfaceFactory $postSearchResultFactory */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PostResource $postResource, PostFactory $postFactory, PostCollectionFactory $postCollectionFactory, PostSearchResultInterfaceFactory $postSearchResultFactory )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postResource = $postResource; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postFactory = $postFactory; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postCollectionFactory = $postCollectionFactory; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postSearchResultFactory = $postSearchResultFactory; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> PostInterface * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> NoSuchEntityException */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!array_key_exists($id, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;registry)) { $post = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postFactory-&gt;create(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postResource-&gt;load($post, $id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$post-&gt;getId()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NoSuchEntityException(__(<span class="hljs-string"><span class="hljs-string">'Requested post does not exist'</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;registry[$id] = $post; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;registry[$id]; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \Magento\Framework\Api\SearchCriteriaInterface $searchCriteria * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostSearchResultInterface */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SearchCriteriaInterface $searchCriteria)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostCollection $collection */</span></span> $collection = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postCollectionFactory-&gt;create(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($searchCriteria-&gt;getFilterGroups() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $filterGroup) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($filterGroup-&gt;getFilters() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $filter) { $condition = $filter-&gt;getConditionType() ? $filter-&gt;getConditionType() : <span class="hljs-string"><span class="hljs-string">'eq'</span></span>; $collection-&gt;addFieldToFilter($filter-&gt;getField(), [$condition =&gt; $filter-&gt;getValue()]); } } <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostSearchResultInterface $searchResult */</span></span> $searchResult = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postSearchResultFactory-&gt;create(); $searchResult-&gt;setSearchCriteria($searchCriteria); $searchResult-&gt;setItems($collection-&gt;getItems()); $searchResult-&gt;setTotalCount($collection-&gt;getSize()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $searchResult; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface $post * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> PostInterface * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> StateException */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">save</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PostInterface $post)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> Post $post */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postResource-&gt;save($post); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;registry[$post-&gt;getId()] = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;get($post-&gt;getId()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (\<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $exception) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StateException(__(<span class="hljs-string"><span class="hljs-string">'Unable to save post #%1'</span></span>, $post-&gt;getId())); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;registry[$post-&gt;getId()]; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface $post * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> bool * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> StateException */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PostInterface $post)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> Post $post */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postResource-&gt;delete($post); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;registry[$post-&gt;getId()]); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (\<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StateException(__(<span class="hljs-string"><span class="hljs-string">'Unable to remove post #%1'</span></span>, $post-&gt;getId())); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> bool */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;delete(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;get($id)); } }</code> </pre><br></div></div><br>  El m√©todo <code>\AlexPoletaev\Blog\Model\PostRepository::getList()</code> deber√≠a devolver datos de cierto formato, por lo que tambi√©n necesitaremos esta interfaz: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Api / Data / PostSearchResultInterface.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">SearchResultsInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Interface PostSearchResultInterface * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Api\Data */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostSearchResultInterface</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchResultsInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface[] */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItems</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> \AlexPoletaev\Blog\Api\Data\PostInterface[] $items * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> $this */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setItems</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $items)</span></span></span></span>; }</code> </pre><br></div></div><br>  Para facilitar la prueba de nuestro m√≥dulo, crearemos dos scripts de consola que agregar√°n y eliminar√°n datos de prueba de la tabla: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Console / Command / DeploySampleDataCommand.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">PostRepositoryInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">PostFactory</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">User</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>\<span class="hljs-title"><span class="hljs-title">Data</span></span>\<span class="hljs-title"><span class="hljs-title">UserInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">User</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">User</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Input</span></span>\<span class="hljs-title"><span class="hljs-title">InputArgument</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Input</span></span>\<span class="hljs-title"><span class="hljs-title">InputInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Output</span></span>\<span class="hljs-title"><span class="hljs-title">OutputInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class DeploySampleDataCommand * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Console\Command */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeploySampleDataCommand</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**#@+ * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ARGUMENT_USERNAME = <span class="hljs-string"><span class="hljs-string">'username'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ARGUMENT_NUMBER_OF_RECORDS = <span class="hljs-string"><span class="hljs-string">'number_of_records'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/**#@-*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostFactory */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $postFactory; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> PostRepositoryInterface */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $postRepository; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> UserInterface */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $user; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> PostFactory $postFactory * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> PostRepositoryInterface $postRepository * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> UserInterface $user */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PostFactory $postFactory, PostRepositoryInterface $postRepository, UserInterface $user )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::__construct(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postFactory = $postFactory; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postRepository = $postRepository; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;user = $user; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;setName(<span class="hljs-string"><span class="hljs-string">'alex_poletaev:blog:deploy_sample_data'</span></span>) -&gt;setDescription(<span class="hljs-string"><span class="hljs-string">'Blog: deploy sample data'</span></span>) -&gt;setDefinition([ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputArgument( <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ARGUMENT_USERNAME, InputArgument::REQUIRED, <span class="hljs-string"><span class="hljs-string">'Username'</span></span> ), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputArgument( <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ARGUMENT_NUMBER_OF_RECORDS, InputArgument::OPTIONAL, <span class="hljs-string"><span class="hljs-string">'Number of test records'</span></span> ), ]) ; <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::configure(); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputInterface $input, OutputInterface $output)</span></span></span><span class="hljs-function"> </span></span>{ $username = $input-&gt;getArgument(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ARGUMENT_USERNAME); <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> User $user */</span></span> $user = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;user-&gt;loadByUsername($username); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$user-&gt;getId() &amp;&amp; $output-&gt;getVerbosity() &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { $output-&gt;writeln(<span class="hljs-string"><span class="hljs-string">'&lt;error&gt;User is not found&lt;/error&gt;'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } $records = $input-&gt;getArgument(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ARGUMENT_NUMBER_OF_RECORDS) ?: <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">1</span></span>; $i &lt;= (int)$records; $i++) { <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> Post $post */</span></span> $post = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postFactory-&gt;create(); $post-&gt;setAuthorId($user-&gt;getId()); $post-&gt;setTitle(<span class="hljs-string"><span class="hljs-string">'test title '</span></span> . $i); $post-&gt;setContent(<span class="hljs-string"><span class="hljs-string">'test content '</span></span> . $i); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;postRepository-&gt;save($post); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($output-&gt;getVerbosity() &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { $output-&gt;writeln(<span class="hljs-string"><span class="hljs-string">'&lt;info&gt;Post with the ID #'</span></span> . $post-&gt;getId() . <span class="hljs-string"><span class="hljs-string">' has been created.&lt;/info&gt;'</span></span>); } } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / Console / Command / RemoveSampleDataCommand.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AlexPoletaev</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceModel</span></span>\<span class="hljs-title"><span class="hljs-title">Post</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">PostResource</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Magento</span></span>\<span class="hljs-title"><span class="hljs-title">Framework</span></span>\<span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">ResourceConnection</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>\<span class="hljs-title"><span class="hljs-title">Command</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Input</span></span>\<span class="hljs-title"><span class="hljs-title">InputInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Console</span></span>\<span class="hljs-title"><span class="hljs-title">Output</span></span>\<span class="hljs-title"><span class="hljs-title">OutputInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class RemoveSampleDataCommand * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> AlexPoletaev\Blog\Console\Command */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RemoveSampleDataCommand</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> ResourceConnection */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $resourceConnection; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> ResourceConnection $resourceConnection */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ResourceConnection $resourceConnection )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::__construct(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resourceConnection = $resourceConnection; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;setName(<span class="hljs-string"><span class="hljs-string">'alex_poletaev:blog:remove_sample_data'</span></span>) -&gt;setDescription(<span class="hljs-string"><span class="hljs-string">'Blog: remove sample data'</span></span>) ; <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::configure(); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputInterface $input, OutputInterface $output)</span></span></span><span class="hljs-function"> </span></span>{ $connection = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resourceConnection-&gt;getConnection(); $connection-&gt;truncateTable($connection-&gt;getTableName(PostResource::TABLE_NAME)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($output-&gt;getVerbosity() &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { $output-&gt;writeln(<span class="hljs-string"><span class="hljs-string">'&lt;info&gt;Sample data has been successfully removed.&lt;/info&gt;'</span></span>); } } }</code> </pre><br></div></div><br>  La caracter√≠stica principal de Magento 2 es el uso generalizado de su propia implementaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dependency Injection</a> .  Para que Magenta sepa a qu√© interfaz corresponde la implementaci√≥n, debemos especificar estas dependencias en el archivo di.xml.  Al mismo tiempo, registraremos los scripts de consola reci√©n creados en este archivo: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / etc / di.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:noNamespaceSchemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:magento:framework:ObjectManager/etc/config.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">preference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\Data\PostInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Model\Post"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">preference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\PostRepositoryInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Model\PostRepository"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">preference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\Data\PostSearchResultInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Api\SearchResults"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Magento\Framework\Console\CommandList"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commands"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"array"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"deploy_sample_data"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>AlexPoletaev\Blog\Console\Command\DeploySampleDataCommand<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"remove_sample_data"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"object"</span></span></span><span class="hljs-tag">&gt;</span></span>AlexPoletaev\Blog\Console\Command\RemoveSampleDataCommand<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Ahora registre las rutas para la API REST, esto se hace en el archivo webapi.xml: <br><br><div class="spoiler">  <b class="spoiler_title">AlexPoletaev / Blog / etc / webapi.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">routes</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:noNamespaceSchemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:magento:module:Magento_Webapi:etc/webapi.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/V1/blog/posts"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"POST"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\PostRepositoryInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"save"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anonymous"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/V1/blog/posts/:id"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DELETE"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\PostRepositoryInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"deleteById"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anonymous"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/V1/blog/posts/:id"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GET"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\PostRepositoryInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"get"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anonymous"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/V1/blog/posts"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GET"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AlexPoletaev\Blog\Api\PostRepositoryInterface"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"getList"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anonymous"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">route</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">routes</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Aqu√≠ le decimos a Magente qu√© interfaz y qu√© m√©todo de esta interfaz usar al solicitar una URL espec√≠fica y con un m√©todo http espec√≠fico (POST, GET, etc.).  Adem√°s, para simplificar, se utiliza un recurso <code>anonymous</code> , que permite que cualquiera pueda acceder a nuestra API; de lo contrario, debe configurar los derechos de acceso (ACL). <br><br><h4>  Climax </h4><br>  Todos los pasos posteriores suponen que tiene habilitado el modo desarrollador.  Esto evita manipulaciones innecesarias con el despliegue de estad√≠sticas de contenido y compilaci√≥n DI. <br><br>  Registre nuestro nuevo m√≥dulo, ejecute el comando: <code>php bin/magento setup:upgrade</code> . <br><br>  Compruebe que se haya <i>creado</i> una nueva tabla <i>alex_poletaev_blog_post</i> . <br><br>  A continuaci√≥n, cargue los datos de prueba con nuestro script personalizado: <br><br><pre> <code class="hljs pgsql">php bin/magento -v alex_poletaev:blog:deploy_sample_data <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span></code> </pre> <br>  El par√°metro <i>admin</i> en este script es el <i>nombre</i> de <i>usuario</i> de la tabla <i>admin_user</i> (puede ser diferente para usted), en una palabra, el usuario del panel de administraci√≥n, que se escribir√° en la columna author_id. <br><br>  Ahora puedes comenzar a probar.  Para las pruebas, utilic√© Magento 2.2.4, dominio <code>http://m224ce.local/</code> . <br><br>  Una forma de probar la API REST es abrir <code>http://m224ce.local/swagger</code> y usar la funcionalidad swagger, pero recuerde que el m√©todo <code>getList</code> no funciona correctamente all√≠.  Tambi√©n prob√© todos los m√©todos con curl, ejemplos: <br><br>  Obtenga un art√≠culo con <i>id = 2</i> <br><br><pre> <code class="hljs powershell">curl <span class="hljs-literal"><span class="hljs-literal">-X</span></span> GET <span class="hljs-literal"><span class="hljs-literal">-H</span></span> <span class="hljs-string"><span class="hljs-string">"Accept: application/json"</span></span> <span class="hljs-string"><span class="hljs-string">"http://m224ce.local/rest/all/V1/blog/posts/2"</span></span></code> </pre> <br>  La respuesta es: <br><br><pre> <code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-attr"><span class="hljs-attr">"author_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">"test title 2"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"content"</span></span>:<span class="hljs-string"><span class="hljs-string">"test content 2"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"created_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"updated_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>}</code> </pre> <br>  Obtenga una lista de art√≠culos con <i>author_id = 2</i> <br><br><pre> <code class="hljs markdown">curl -g -X GET -H "Accept: application/json" "http://m224ce.local/rest/all/V1/blog/posts?searchCriteria[<span class="hljs-string"><span class="hljs-string">filterGroups</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>][<span class="hljs-string"><span class="hljs-string">filters</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>][<span class="hljs-string"><span class="hljs-string">field</span></span>]=author_id&amp;searchCriteria[<span class="hljs-string"><span class="hljs-string">filterGroups</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>][<span class="hljs-string"><span class="hljs-string">filters</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>][<span class="hljs-string"><span class="hljs-string">value</span></span>]=1&amp;searchCriteria[<span class="hljs-string"><span class="hljs-string">filterGroups</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>][<span class="hljs-string"><span class="hljs-string">filters</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">0</span></span>][<span class="hljs-string"><span class="hljs-string">conditionType</span></span>]=eq"</code> </pre> <br>  La respuesta es: <br><br><pre> <code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"items"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"author_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">"test title 1"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"content"</span></span>:<span class="hljs-string"><span class="hljs-string">"test content 1"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"created_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"updated_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-attr"><span class="hljs-attr">"author_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">"test title 2"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"content"</span></span>:<span class="hljs-string"><span class="hljs-string">"test content 2"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"created_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"updated_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-attr"><span class="hljs-attr">"author_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">"test title 3"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"content"</span></span>:<span class="hljs-string"><span class="hljs-string">"test content 3"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"created_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"updated_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:35:54"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"search_criteria"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"filter_groups"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"filters"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"field"</span></span>:<span class="hljs-string"><span class="hljs-string">"author_id"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"value"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"condition_type"</span></span>:<span class="hljs-string"><span class="hljs-string">"eq"</span></span>}]}]},<span class="hljs-attr"><span class="hljs-attr">"total_count"</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>}</code> </pre> <br>  Eliminar art√≠culo con <i>id = 3</i> <br><br><pre> <code class="hljs powershell">curl <span class="hljs-literal"><span class="hljs-literal">-X</span></span> DELETE <span class="hljs-literal"><span class="hljs-literal">-H</span></span> <span class="hljs-string"><span class="hljs-string">"Accept: application/json"</span></span> <span class="hljs-string"><span class="hljs-string">"http://m224ce.local/rest/all/V1/blog/posts/3"</span></span></code> </pre> <br>  La respuesta es: <br><br><pre> <code class="hljs objectivec"><span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Guarda el nuevo art√≠culo <br><br><pre> <code class="hljs swift">curl -<span class="hljs-type"><span class="hljs-type">X</span></span> <span class="hljs-type"><span class="hljs-type">POST</span></span> -<span class="hljs-type"><span class="hljs-type">H</span></span> <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> -<span class="hljs-type"><span class="hljs-type">H</span></span> <span class="hljs-string"><span class="hljs-string">"Accept: application/json"</span></span> -d '{<span class="hljs-string"><span class="hljs-string">"post"</span></span>: {<span class="hljs-string"><span class="hljs-string">"author_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"test title 4"</span></span>, <span class="hljs-string"><span class="hljs-string">"content"</span></span>: <span class="hljs-string"><span class="hljs-string">"test content 4"</span></span>}}' <span class="hljs-string"><span class="hljs-string">"http://m224ce.local/rest/all/V1/blog/posts"</span></span></code> </pre> <br>  La respuesta es: <br><br><pre> <code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-attr"><span class="hljs-attr">"author_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">"test title 4"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"content"</span></span>:<span class="hljs-string"><span class="hljs-string">"test content 4"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"created_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:44:24"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"updated_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-06 21:44:24"</span></span>}</code> </pre> <br>  Tenga en cuenta que para una solicitud con el m√©todo http POST, debe pasar la clave de <i>publicaci√≥n</i> , que en realidad corresponde al par√°metro de entrada ($ post) para el m√©todo <br><br><pre> <code class="hljs tex"><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AlexPoletaev</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blog</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Api</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PostRepositoryInterface</span></span></span></span>::save()</code> </pre> <br><h4>  Denouement </h4><br>  Para aquellos que est√©n interesados ‚Äã‚Äãen lo que sucede durante la solicitud y c√≥mo lo procesa Magenta, a continuaci√≥n les dar√© algunos enlaces a m√©todos con mis comentarios.  Si algo no funciona, entonces estos m√©todos deben cargarse primero. <br><br>  El controlador responsable de procesar la solicitud. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Webapi \ Controller \ Rest :: dispatch ()</a> <br><br>  Siguiente llamado <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Webapi \ Controller \ Rest :: processApiRequest ()</a> <br><br>  Muchos otros m√©todos se denominan dentro de <code>processApiRequest</code> , pero el siguiente m√°s importante <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Webapi \ Controller \ Rest \ InputParamsResolver :: resolve ()</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Webapi \ Controller \ Rest \ Router :: match ()</a> : se determina una ruta espec√≠fica (dentro, a trav√©s del <code>\Magento\Webapi\Model\Rest\Config::getRestRoutes()</code> , todas las rutas adecuadas se extraen de la solicitud de la solicitud).  El objeto de ruta contiene todos los datos necesarios para procesar la solicitud: clase, m√©todo, derechos de acceso, etc. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Framework \ Webapi \ ServiceInputProcessor :: process ()</a> <br>  - usa <code>\Magento\Framework\Reflection\MethodsMap::getMethodParams()</code> , donde los par√°metros del m√©todo se extraen mediante la reflexi√≥n <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Framework \ Webapi \ ServiceInputProcessor :: convertValue ()</a> - varias opciones para convertir una matriz en un DataObject o en una matriz desde un DataObject <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Framework \ Webapi \ ServiceInputProcessor :: _ createFromArray ()</a> - conversi√≥n directa, donde a trav√©s de la reflexi√≥n se verifica la presencia de captadores y establecedores (recuerde, dije anteriormente que volveremos a ellos?) Y que tienen un alcance p√∫blico.  A continuaci√≥n, el objeto se llena de datos a trav√©s de los colocadores. <br><br>  Al final, en el m√©todo <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">\ Magento \ Webapi \ Controller \ Rest :: processApiRequest ()</a> , a trav√©s de <code>call_user_func_array</code> m√©todo del objeto del repositorio. <br><br><h4>  Ep√≠logo </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Repositorio de m√≥dulos de Github</a> <br><br>  Hay dos formas de instalar: <br><br>  1) V√≠a compositor.  Para hacer esto, agregue el siguiente objeto a la matriz de <code>repositories</code> en el archivo composer.json <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"git"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://github.com/alexpoletaev/magento2-blog-demo"</span></span> }</code> </pre><br>  Luego escriba el siguiente comando en la terminal: <br><br><pre> <code class="hljs powershell">composer require alexpoletaev/magento2<span class="hljs-literal"><span class="hljs-literal">-blog</span></span><span class="hljs-literal"><span class="hljs-literal">-demo</span></span>:dev<span class="hljs-literal"><span class="hljs-literal">-master</span></span></code> </pre> <br>  2) Descargue los archivos del m√≥dulo y c√≥pielos manualmente en el directorio <code>app/code/AlexPoletaev/Blog</code> <br><br>  Independientemente del m√©todo que elija, al final debe ejecutar la actualizaci√≥n: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">php</span></span> bin/magento setup:upgrade</code> </pre> <br>  Espero que este art√≠culo sea √∫til para alguien.  Si tiene alg√∫n comentario, sugerencia o pregunta, bienvenido a comentar.  Gracias por su atencion </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413463/">https://habr.com/ru/post/es413463/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413451/index.html">De estudiante a pasantes y desarrolladores: mi experiencia de pasant√≠a</a></li>
<li><a href="../es413455/index.html">Trabajar con Veeam Availability Console: configurar los servicios de respaldo administrado</a></li>
<li><a href="../es413457/index.html">Virgin Orbit - Nuevo jugador del mercado de refuerzo suborbita</a></li>
<li><a href="../es413459/index.html">El talento de un reclutador de TI: ¬øen qu√© se diferencian los creadores de los artesanos?</a></li>
<li><a href="../es413461/index.html">ReactOS se volvi√≥ autosuficiente en el a√±o de su 21 aniversario</a></li>
<li><a href="../es413465/index.html">AMD anuncia Threadripper 2 de 32 n√∫cleos</a></li>
<li><a href="../es413467/index.html">Copia de seguridad de datos r√°pida y confiable en la nube</a></li>
<li><a href="../es413469/index.html">Una prueba de memoria que mata computadoras port√°tiles es casi una historia de detectives</a></li>
<li><a href="../es413471/index.html">Viernes Mini Tomy Fancy Toy Retrospectiva</a></li>
<li><a href="../es413473/index.html">Desarrollo de un interruptor t√°ctil Z-Wave en la bater√≠a con botones luminosos.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>