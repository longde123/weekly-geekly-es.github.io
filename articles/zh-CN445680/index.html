<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👭 🤜🏿 ☸️ Git 3的新功能：闭包 🍡 ✂️ 🛌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Git是一种流行的版本控制系统。 在Git中，一个或几个文件的原子更改称为提交，并且几个连续的提交被合并到一个分支中。 分支用于实现新的想法（功能）。 







 碰巧这种想法是死胡同，而开发人员却选择了错误的方式，因此他需要回滚到原始版本。 他应该忘记新的分支，切换到主要的dev或maste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Git 3的新功能：闭包</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445680/"><p>  Git是一种流行的版本控制系统。 在Git中，一个或几个文件的原子更改称为提交，并且几个连续的提交被合并到一个分支中。 分支用于实现新的想法（功能）。 </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa5/222/85a/aa522285a7fd7fd5f8c597050956d878.svg"></div><p></p><br><p> 碰巧这种想法是死胡同，而开发人员却选择了错误的方式，因此他需要回滚到原始版本。 他应该忘记新的分支，切换到主要的<strong>dev</strong>或<strong>master</strong>分支，然后继续工作。 在这种情况下，“接穗”将永远挂起，并希望将其卸下。 但是，如何删除历史记录的一部分？ 该分支显示了辛勤工作的程序员的努力，即使徒劳。 因此，向老板汇报将更容易，因为结果也是不成功的！ </p><br><p> 我很高兴Git开发人员将引入一个新命令来关闭第三版中的此类“无家可归”分支。 当前版本是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2.21.0</a> 。 </p><br><p> 如何使用此命令，它有什么好处，IT公司怎么看？ 本文回答了这些问题和其他问题。 </p><a name="habracut"></a><br><h2 id="description"> 内容描述 </h2><br><p>现在可以关闭先前提交之一的失败分支。 下图中的闭合弧为黄色。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/831/c59/f42/831c59f42a1c28e9316781e918ab5ad2.svg"></div><br><br><p>提交<code>4</code>是不成功功能的最后一个。 它在提交<code>1</code>时关闭，然后我们返回到主服务器，然后转到另一条路径（提交<code>5</code> ）。 </p><br><p> 您还可以关闭对自身的提交，从而创建<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">循环</a> ： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e2/d3b/c7f/6e2d3bc7f118f60d4e3a05762bda92ea.svg"></div><br><br><p> 您可以关闭任何提交的分支-Git很聪明，它可以计算差异并正确合并所有内容： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/61f/1e3/7e1/61f1e37e1861b8307f715fd3b003fa2c.svg"></div><br><br><h2 id="how-to-use"> 使用方法 </h2><br><p>  <code>merge</code>命令不包括闭包的功能，因为在第一种情况下分支将被<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">快速转发</a> ，而在第二种情况下将不执行任何操作（ <code>git already up to date</code> ）。 </p><br><p> 为了不改变旧的行为，开发人员决定引入一个闭包命令： </p><br><pre> <code class="plaintext hljs">git closure -s $source_commit -d $dest_commit -m $message</code> </pre> <br><p> 第一个参数<code>-s $source_commit</code>设置要从其扩展循环的提交的哈希，第二个参数（可选） <code>-d $dest_commit</code>设置将关闭循环的提交。 如果不存在，则关闭发生在当前的检出分支中。  <code>-m $message</code>参数设置关闭消息，例如<code>failed feature, revert to origin</code> 。 但是，-- <code>--allow-empty-message</code>选项也可用，它允许提交而没有消息。 默认情况下，Git仅允许一对提交关闭。 要绕过此限制，可以使用<code>--allow-multiple-closures</code>选项。 </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0d4/735/680/0d4735680312484fdb0f59ee1bf3ec56.svg"></div><br><p> 执行命令后，Git计算更改，并在最后一次提交中显示一个double diff：从基础分支和闭合分支开始。 在一般情况下，它是一个n维差异，也就是说，可以有任意多个闭包。  Closure-commit与merge-commit类似，唯一的区别是它包含多条消息，而不是一条。 </p><br><p> 不幸的是，现有的Git GUI没有对闭包的良好支持。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitExtensions</a>预览版显示合并曲线，而不是优美的弧线。 看一下新字段，例如<code>Closure message</code>和<code>Closure diff</code> ： </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w0/pn/ny/w0pnny3xyxyhdhr1pk9h8i03whk.png"></div><br><p> 值得注意的是， <code>closure</code>命令总是会更改历史记录（因为现在Git是成熟的时间机器！），所以现在可以仅使用<code>--force</code>选项或安全的<code>--force-with-lease</code>来推送分支。 <code>--force-with-lease</code>选项。 </p><br><p>  Rebase也可用于循环分支，尽管重新计算提交的逻辑很复杂。 </p><br><p>  <code>auto</code>选项还允许自动关闭所有旧分支。 在这种情况下，关闭提交是启动分支的提交。 使用Git IDE插件，可以定期运行闭包。 在GitExtensions中，有一个类似的插件<strong>删除过时的分支</strong> 。 </p><br><h2 id="what-it-companies-think">  IT公司的想法 </h2><br><p> 大型IT公司：Google，Facebook，Apple，DeepMind，Positive Technologies，尤其是Microsoft，正迫切等待关闭，因为现在可以规范分支机构（包括未合并分支机构）的生命周期。 </p><br><p> 微软的最高经理之一迈克尔·里希特（Michael Richter） <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">写道</a> ： </p><br><blockquote> 当然，Git的新功能将减轻开源开发世界（不仅是）的混乱。 我们的存储库中有很多“悬挂”分支。 例如，在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">vscode中，</a>我们有200多个，在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TypeScript中，则</a>有300多个！ 这个问题不仅是我们的。 闭包不仅可以改善组织结构，而且还可以跟踪程序员的推理，有时甚至对同事来说都是完全无法理解的：)闭包使我想起了电影《回到未来》，那里的角色穿越了过去和未来。 我喜欢这部电影，看了好几次。 而且我想我会更喜欢Git，因为如果使用此功能:) </blockquote><br><h2 id="note"> 注意事项 </h2><br><p> 如果较早的提交图是有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">向无环图</a> （DAG），则闭包可以将其扩展为通用有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">向图</a> 。 使用Git，您可以描述状态为提交的正则表达式，并且字母是所有消息的集合。 但这是中心“异常编程”的主题，因此超出了本文的范围。 但是，如果您觉得这很有趣，请查看有关如何在Git中存储家谱的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> 。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN445680/">https://habr.com/ru/post/zh-CN445680/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN445670/index.html">在Rust中重写Firefox组件的后果</a></li>
<li><a href="../zh-CN445672/index.html">在量子化学方面的Muon催化。 第二部分：电子与 介子化学键</a></li>
<li><a href="../zh-CN445674/index.html">PVS-Studio for Java上路了。 下一站是Elasticsearch</a></li>
<li><a href="../zh-CN445676/index.html">Git 3的新功能：闭包</a></li>
<li><a href="../zh-CN445678/index.html">4. Check Point入门R80.20。 安装和初始化</a></li>
<li><a href="../zh-CN445682/index.html">PVS-Studio for Java已发送到路径。 下一站是Elasticsearch</a></li>
<li><a href="../zh-CN445684/index.html">单体vs模块化UPS</a></li>
<li><a href="../zh-CN445686/index.html">2019年旧PDA（Cybiko Xtreme）的应用程序开发</a></li>
<li><a href="../zh-CN445692/index.html">用于创建Web VR应用程序的PlayCanvas功能概述</a></li>
<li><a href="../zh-CN445696/index.html">如何创建可以到达我们所在地的机器人</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>