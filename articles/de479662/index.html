<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💖 👩🏿‍💼 🍓 Wie Yandex künstliche Intelligenz lehrte, Fehler in den Nachrichten zu finden 👏🏻 ☂️ 🐷</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir sprechen oft über Technologien und Bibliotheken, die in Yandex entstanden und entstanden sind. Tatsächlich wenden wir zumindest Lösungen von Dritt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie Yandex künstliche Intelligenz lehrte, Fehler in den Nachrichten zu finden</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/479662/">  Wir sprechen oft über Technologien und Bibliotheken, die in Yandex entstanden und entstanden sind.  Tatsächlich wenden wir zumindest Lösungen von Drittanbietern an und entwickeln diese. <br><br>  Heute werde ich der Habr-Gemeinde von einem solchen Beispiel erzählen.  Sie erfahren, warum wir dem neuronalen Netz von BERT das Auffinden von Tippfehlern in Nachrichtenüberschriften beigebracht haben und nicht das vorgefertigte Modell verwendet haben, warum Sie BERT nicht auf mehreren Grafikkarten ausführen können und wie wir die Schlüsselfunktion dieser Technologie - den Aufmerksamkeitsmechanismus - verwendet haben. <br><br><img src="https://habrastorage.org/webt/tt/hg/e0/tthge0hf0fug6jmwdhad_x-kjbg.png"><br><br><a name="habracut"></a><h2>  Herausforderung </h2><br>  Yandex.News ist ein Dienst, der Nachrichten von Veröffentlichungen sammelt, die mit uns verbunden sind.  Dies sind nicht nur die meistgelesenen und zitierten Mediennachrichten auf der Hauptseite, sondern auch <a href="https://yandex.ru/sport">thematische</a> Abschnitte oder sogar persönliche Auswahlen aus allen Veröffentlichungen.  In jedem Fall sind dies Tausende von Websites und Millionen von Überschriften, aus denen die Maschine alle paar Minuten eine Auswahl treffen muss. <br><br>  Es ist die Maschine, weil wir nie in das Bild des Tages eingreifen: Wir fügen dort keine Nachrichten manuell hinzu, wir entfernen sie nicht von dort (egal wie sehr wir es möchten), wir bearbeiten die Überschriften nicht.  Um dies wurde bereits viele Exemplare gebrochen.  Ein vollständig algorithmischer Ansatz hat sowohl Vor- als auch Nachteile.  Etwas, das wir mit Technologie verbessern können, etwas, das wir nicht können.  Auch wenn die Überschriften Rechtschreibfehler oder Tippfehler enthalten, werden diese nicht korrigiert.  Wir haben den Schlagzeilen die Favoriten der Veröffentlichungen hinzugefügt, damit klar ist, woher die Nachrichten kommen.  Dies hat teilweise geholfen, aber wir haben uns nicht mit den Fehlern abgefunden und begannen, nach einer Möglichkeit zu suchen, sie zu beseitigen, ohne Änderungen am Text vorzunehmen. <br><br>  Wenn es nicht möglich ist, den Fehler zu beheben, können Sie das Gerät so trainieren, dass es Header findet, die aufgrund von Fehlern nicht für die Oberseite geeignet sind.  Darüber hinaus hat sich Yandex seit dem Zeitpunkt, als der Name noch nicht erfunden wurde, auf die russische Morphologie spezialisiert.  Es scheint, dass wir ein neuronales Netzwerk nehmen - und der Punkt liegt im Hut. <br><br><h2>  Die Werkzeuge </h2><br>  Yandex verfügt über die <a href="https://yandex.ru/dev/speller/">Speller-</a> Technologie zum Auffinden und Beheben von Fehlern.  Dank der <a href="https://habr.com/ru/company/yandex/blog/333522/">CatBoost-Bibliothek für</a> maschinelles Lernen <a href="https://habr.com/ru/company/yandex/blog/333522/">kann</a> Speller nicht <a href="https://habr.com/ru/company/yandex/blog/333522/">wiedererkennbare</a> Wörter entschlüsseln („Adjektive“ → „Klassenkameraden“) und den Kontext bei der Suche nach Tippfehlern berücksichtigen („Musik verpassen“ → „Musik herunterladen“).  Es mag scheinen, dass Speller für unsere Aufgabe ideal ist, aber nein. <br><br>  Der Rechtschreibfehler (intern als Suchwächter bezeichnet) wurde bereits auf Architekturebene geschärft, um eine völlig andere Aufgabe zu lösen: Benutzern dabei zu helfen, das richtige Anforderungsformular wiederherzustellen.  Bei der Suche ist es nicht so wichtig, ob die Groß- / Kleinschreibung richtig ausgewählt ist, ein Großbuchstabe oder ein Komma angehängt ist.  Dort ist es für die Suchanfrage "Haminguel" wichtiger zu erraten, dass die Person Hemingway im Sinn hatte. <br><br>  Fehler in den Schlagzeilen werden von relativ erfahrenen Leuten gemacht, von denen es unwahrscheinlich ist, dass sie Haminguel schreiben.  Aber falsche Zustimmungen („der Flug wurde verschoben“), fehlende Wörter („der junge Mann hat das Auto ausprobiert“) und zusätzliche Großbuchstaben („Präsident der Bank“) sind an der Tagesordnung.  Schließlich gibt es einen formal korrekten Satz "Ich repariere die Gorki-Straße in Pskow", an den sich ein normaler Vormund nicht klammern wird (naja, was ist, wenn dies ein Versprechen des Autors ist?), Aber dies ist offensichtlich eine verdorbene Schlagzeile.  Außerdem galt es in den Nachrichten nicht wie in der Suche: Tippfehler und Fehler nicht zu korrigieren, sondern zu erkennen. <br><br>  Wir hatten andere Optionen, zum Beispiel Modelle, die auf DSSM basierten (wenn interessant, sprachen wir in einem Beitrag über <a href="https://habr.com/ru/company/yandex/blog/314222/">den Palekh-Algorithmus</a> kurz über diesen Ansatz), aber sie hatten auch Einschränkungen.  Beispielsweise wurde die Wortreihenfolge nicht perfekt berücksichtigt. <br><br>  Im Allgemeinen waren vorgefertigte Werkzeuge entweder nicht für unsere Aufgabe geeignet oder nur begrenzt verfügbar.  Sie müssen also Ihr eigenes Modell erstellen - um Ihr Modell zu trainieren.  Dies war ein guter Grund, mit der BERT-Technologie zu arbeiten, die den Entwicklern ab 2018 zur Verfügung stand und beeindruckende Ergebnisse zeigte. <br><br><h2>  Wir stellen vor: BERT </h2><br>  Das Hauptproblem der modernen Verarbeitung natürlicher Sprache (NLP) besteht darin, genügend Beispiele zu finden, die von Personen zum Trainieren eines neuronalen Netzwerks gekennzeichnet wurden.  Wenn Sie Qualitätswachstum benötigen, sollte die Trainingsstichprobe sehr groß sein - Millionen und Milliarden von Beispielen.  Gleichzeitig gibt es in NLP viele Aufgaben, die alle unterschiedlich sind.  Das Sammeln von Daten in ähnlichen Mengen für jede Aufgabe ist langwierig, teuer und oft unmöglich.  Auch für die größten Unternehmen der Welt. <br><br>  Es gibt jedoch eine Möglichkeit, dieses Problem zu umgehen - mit Hilfe eines Trainings in zwei Schritten.  Zunächst wird dem neuronalen Netz eine Sprachstruktur für eine lange und teure Zeit auf einer riesigen Menge von Milliarden von Wörtern beigebracht (dies ist ein Vortraining).  Dann wird das Netzwerk für eine bestimmte Aufgabe schnell und kostengünstig verdreht - zum Beispiel, um Überprüfungen in gute und schlechte zu unterteilen (dies ist eine Feinabstimmung).  Genug von etwa zehntausend in <a href="https://habr.com/ru/company/yandex/blog/305956/">Tolok</a> markierten <a href="https://habr.com/ru/company/yandex/blog/305956/">Exemplaren</a> . <br><br>  Die BERT-Technologie (Bidirectional Encoder Representations from Transformers) basiert auf dieser Idee.  Die Idee selbst ist nicht neu und wurde bereits angewendet, aber es gibt einen signifikanten Unterschied.  Transformer ist eine solche neuronale Netzwerkarchitektur, mit der Sie den gesamten Kontext auf einmal berücksichtigen können, einschließlich des anderen Satzendes und des Partizip-Umsatzes irgendwo in der Mitte.  Und das ist der Unterschied zu früheren modischen Architekturen, die den Kontext berücksichtigten.  Ein neuronales LSTM-Netzwerk hat zum Beispiel bestenfalls eine Kontextlänge von zehn Wörtern und hier sind es alle 200. <br><br>  Auf <a href="https://github.com/google-research/bert">GitHub</a> sind TensorFlow-Quellcode und sogar ein vorgefertigtes Universalmodell in 102 Sprachen verfügbar, von Russisch bis Volapyuk.  Nehmen Sie anscheinend die Lösung aus dem Karton - und erhalten Sie sofort das Ergebnis.  Aber nein <br><br>  Es stellte sich heraus, dass das Universalmodell in russischen Texten eine deutlich geringere Qualität aufwies als das englische Modell und Rekorde in englischen Texten brach (was, wie Sie sehen, logisch ist).  In russischen Texten verlor sie gegen unsere internen Modelle auf DSSM. <br><br>  Okay, Sie können sich vorerziehen - zum Glück hat Yandex genug russische Texte und Erfahrung im maschinellen Lernen.  Aber es gibt eine Nuance.  Das Lernen dauert ein Jahr! <br><br>  Fakt ist, dass BERT auf Google-Tensor-Prozessoren (TPUs) ausgelegt ist und daher sofort mit nur einer Grafikkarte (GPU) verwendet werden kann.  Und es ist unmöglich, die Stirn mit einem <a href="https://github.com/horovod">Horovod</a> zu parallelisieren: Das Übertragen von 400 Megabyte Daten von Karte zu Karte bei jedem Schritt ist sehr kostspielig, Parallelisierung wird sinnlos.  Was zu tun ist? <br><br><h2>  Optimierung </h2><br>  Sie begannen, nach Ideen und Lösungen zu suchen, die die Angelegenheit erheblich beschleunigen könnten.  Zuallererst haben wir festgestellt, dass jede Zahl in unserem Modell 32 Bit Speicher belegt (das Standard-Float für Zahlen im Computer).  Es scheint klein zu sein, aber wenn Sie 100 Millionen Gewichte haben, dann ist dies kritisch.  Wir brauchten nicht überall eine solche Genauigkeit, deshalb haben wir beschlossen, die Zahlen teilweise in das 16-Bit-Format umzuwandeln (dies wird als gemischtes Präzisionstraining bezeichnet). <br><br>  Dabei haben wir mit Hilfe vieler Dateien und Krücken die XLA-Kompilierung unter Berufung auf das damals noch rohe NVIDIA- <a href="https://github.com/google-research/bert/pull/255">Commit</a> geschraubt.  Dank dessen konnten unsere NVIDIA Tesla V100-Karten (von denen ein kleiner Server als Apartment in einem billigen Viertel von Moskau dient) ihr Potenzial dank der 16-Bit-Arithmetik auf Tensor Cores voll ausspielen. <br><br>  Wir haben uns nur für russischsprachige Schlagzeilen interessiert, aber das mehrsprachige Modell, das wir zugrunde gelegt haben, wurde in Hunderten von Sprachen trainiert, einschließlich eines künstlichen Volapuks.  Wörter aller in den Vektorraum übersetzten Sprachen wurden im Modell gespeichert.  Außerdem können Sie sie nicht nehmen und einfach von dort entfernen - ich musste schwitzen, um das Wörterbuch zu verkleinern. <br><br>  Und noch eine Sache.  Wenn Sie Wissenschaftler sind und sich Ihr Computer unter dem Tisch befindet, können Sie dort alles für jede bestimmte Aufgabe neu konfigurieren.  In einer realen Computing-Cloud, in der Tausende von Maschinen auf die gleiche Weise konfiguriert sind, ist es beispielsweise problematisch, den Kernel für jede neue TensorFlow-Funktion neu zu erstellen.  Aus diesem Grund haben wir viel Mühe darauf verwendet, solche Versionen von Paketen zu sammeln, die für alle neuen Chips geeignet sind und die keine radikale Aktualisierung und Neukonfiguration von Grafikkarten in der Cloud erfordern. <br><br>  Im Allgemeinen drückte alle Säfte, wo immer sie konnten.  Und wir haben es geschafft.  Das Jahr wurde zu einer Woche. <br><br><h2>  Schulung </h2><br>  Das Erstellen des richtigen Datensatzes ist normalerweise der schwierigste Teil der Arbeit.  Zunächst lernten wir den Klassifikator anhand von drei Millionen mit Tolokern gekennzeichneten Überschriften.  Es scheint viel zu sein, aber nur 30.000 - mit Tippfehlern.  Wo gibt es weitere Beispiele? <br><br>  Wir haben uns entschieden, welche Überschriften die Medien selbst korrigieren.  Es gibt mehr als 2 Millionen solcher in der Geschichte von Yandex.News.  Bingo!  Obwohl es zu früh war, sich zu freuen. <br><br>  Es stellte sich heraus, dass die Medien sehr oft die Schlagzeilen wiederholen, nicht aufgrund von Fehlern.  Neue Details wurden bekannt - und der Herausgeber ersetzte einen korrekten Wortlaut durch einen anderen.  Aus diesem Grund haben wir uns auf Korrekturen mit einem Unterschied zwischen den Versionen von bis zu drei Buchstaben beschränkt (obwohl es hier immer noch einige Geräusche gab: Es wurde „zwei gefunden“ - es wurde „drei gefunden“).  Also haben wir eine Million Tippfehler gemacht.  Wir haben zuerst diese große Auswahl mit Rauschen und dann eine kleine Tolkermarkierung ohne Rauschen untersucht. <br><br><h2>  Qualität </h2><br>  Bei solchen Aufgaben ist es üblich, Genauigkeit und Vollständigkeit zu messen.  In unserem Fall ist Genauigkeit das Verhältnis der korrekten Urteile zu allen Urteilen über einen Fehler in der Kopfzeile.  Vollständigkeit - der Anteil der Fehlerköpfe, den wir unter allen Fehlerköpfen abgefangen haben.  Sowohl das als auch ein anderer in der idealen Welt sollten sich um 100% bemühen.  Bei maschinellen Lernaufgaben neigen diese Indikatoren jedoch zu Konflikten.  Das heißt, je mehr wir die Genauigkeit verdrehen, desto mehr sinkt die Vollständigkeit.  Umgekehrt. <br><br>  In unserem vorherigen Ansatz basierend auf DSSM haben wir bereits eine Genauigkeit von 95% erreicht (d. H. 5% falsch positive Urteile).  Dies ist bereits ein ziemlich hoher Indikator.  Aus diesem Grund haben wir uns entschlossen, das gleiche Maß an Genauigkeit beizubehalten und zu prüfen, wie sich die Vollständigkeit mit dem neuen Modell ändert.  Und sie sprang von 21 auf 78%.  Und es ist definitiv ein Erfolg. <br><br>  Hier wäre es möglich, dem ein Ende zu setzen, aber ich erinnere mich an das Versprechen, über Aufmerksamkeit zu sprechen. <br><br><h2>  Neuronales Netz mit Filzstift </h2><br>  Es ist allgemein anerkannt, dass ein neuronales Netzwerk eine solche Black Box ist.  Wir geben etwas an den Eingang und geben etwas an den Ausgang.  Warum und wie ist ein Rätsel. <br><br>  Diese Einschränkung soll interpretierte neuronale Netze umgehen.  BERT ist einer von ihnen.  Ihre Interpretierbarkeit liegt im Aufmerksamkeitsmechanismus.  Grob gesagt wiederholen wir in jeder Schicht des neuronalen Netzwerks dieselbe Technik: Wir betrachten die benachbarten Wörter mit unterschiedlicher „Aufmerksamkeit“ und berücksichtigen die Interaktion mit ihnen.  Wenn ein neuronales Netzwerk beispielsweise das Pronomen "er" verarbeitet, "schaut" es genau auf das Nomen, auf das sich "er" bezieht. <br><br>  Das Bild unten zeigt in verschiedenen Rottönen, auf welche Wörter der Token „schaut“, wodurch Informationen über den gesamten Titel für die letzte Klassifizierungsebene gesammelt werden.  Wenn ein Tippfehler im Wort - Aufmerksamkeit es hervorhebt, wenn die Wörter inkonsistent sind - dann beide (und möglicherweise abhängig von ihnen). <br><br><img src="https://habrastorage.org/webt/tt/hg/e0/tthge0hf0fug6jmwdhad_x-kjbg.png"><br><br>  An dieser Stelle kann man übrigens das volle Potenzial der neuronalen Netze erkennen.  Zu keinem Zeitpunkt des Trainings weiß unser Modell genau, wo sich der Tippfehler im Beispiel befindet: Es weiß nur, dass der gesamte Titel falsch ist.  Und dennoch erfährt sie, dass „eine Schule für 1224 Plätze“ aufgrund einer inkonsistenten Ziffer falsch geschrieben ist, und hebt die Zahl 4 besonders hervor. <br><br>  Wir hörten nicht bei Tippfehlern auf und wandten einen neuen Ansatz an, um nicht nur nach Fehlern zu suchen, sondern auch veraltete Header zu identifizieren.  Aber das ist eine ganz andere Geschichte, mit der wir hoffen, in naher Zukunft nach Habr zurückzukehren. <br><br><h2>  Nützliche Links für diejenigen, die sich mit dem Thema beschäftigen möchten </h2><br><ul><li>  <a href="https://github.com/google-research/bert">TensorFlow-Code und vorgefertigte Modelle für BERT</a> </li><li>  <a href="https://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html">Open Sourcing BERT: Modernes Pre-Training für die Verarbeitung natürlicher Sprachen</a> </li><li>  <a href="https://timdettmers.com/2018/10/17/tpus-vs-gpus-for-transformers-bert/">TPUs vs GPUs für Transformatoren (BERT)</a> </li><li>  <a href="http://jalammar.github.io/illustrated-transformer/">Der abgebildete Transformator</a> </li><li>  <a href="https://news.developer.nvidia.com/nvidia-achieves-4x-speedup-on-bert-neural-network/">NVIDIA erzielt 4-fache Geschwindigkeit im BERT Neural Network</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479662/">https://habr.com/ru/post/de479662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479646/index.html">Schlechte Ratschläge oder Gründe, um nach der Mittelstufe weiter Englisch zu lernen</a></li>
<li><a href="../de479650/index.html">Top 12 der interessantesten dynamischen IT-Infografiken</a></li>
<li><a href="../de479654/index.html">Django Vue Generator</a></li>
<li><a href="../de479656/index.html">PostgreSQL Antipatterns: Statistiken rund um den Kopf</a></li>
<li><a href="../de479660/index.html">3. Malware-Analyse mit Check Point Forensics. Sandstrahl-Handy</a></li>
<li><a href="../de479664/index.html">So funktionieren verwaltete Kubernetes und verwaltetes OpenShift in der IBM Cloud. Teil 1 - Architektur und Sicherheit</a></li>
<li><a href="../de479666/index.html">Golang: Worauf verlässt sich ein Go-Spezialist in einem Meer von IT-Spezialitäten?</a></li>
<li><a href="../de479668/index.html">QA für Anfänger: Wie teste ich eine Rakete oder ein Flugzeug?</a></li>
<li><a href="../de479672/index.html">KANN schnüffeln</a></li>
<li><a href="../de479676/index.html">ExtJS 7 und Spring Boot 2. Wie erstelle ich ein SPA, das mit Ihrer API und externen ReactJS-Plugins interagiert?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>