<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÇ üõ¢Ô∏è üå®Ô∏è Hola mundo de Bytecode para JVM üéª üç∞ üëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Compilamos un programa simple que muestra "Hello World" y recorremos su estructura 


 No creo que el art√≠culo sea lo suficientemente informativo para...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hola mundo de Bytecode para JVM</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480550/"><p>  Compilamos un programa simple que muestra "Hello World" y recorremos su estructura </p><br><p>  No creo que el art√≠culo sea lo suficientemente informativo para aquellos que no saben superficialmente c√≥mo se ve el bytecode y c√≥mo funciona la JVM (por ejemplo, al menos las instrucciones m√°s simples (conocimiento sobre su existencia)). </p><br><p> De hecho, no es tan dif√≠cil.  Es suficiente usar la herramienta <code>javap</code> del JDK y considerar el c√≥digo desmontado. </p><br><p>  Y comenzaremos a analizar la estructura del bytecode para la JVM </p><a name="habracut"></a><br><p>  Un libro muy √∫til para esto fue la especificaci√≥n JVM oficial: la especificaci√≥n de m√°quina virtual Java en Oracle </p><br><p>  Para comenzar, cree un programa simple: </p><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String ... args)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"Hello World"</span></span>); } }</code> </pre><br><p>  <code>javac Main.java</code> con el equipo <code>javac Main.java</code> y de hecho desarme </p><br><pre> <code class="plaintext hljs"> javap -c -v Main</code> </pre> <br><p>  <em>Main.class</em> </p><br><pre> <code class="plaintext hljs">Classfile /C:/Users/Arthur/playground/java/jvm/Main.class Last modified 26.10.2019; size 413 bytes MD5 checksum 6449121a3bb611fee394e4f322401ee1 Compiled from "Main.java" public class Main minor version: 0 major version: 52 flags: ACC_PUBLIC, ACC_SUPER Constant pool: #1 = Methodref #6.#15 // java/lang/Object."&lt;init&gt;":()V #2 = Fieldref #16.#17 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #18 // Hello World #4 = Methodref #19.#20 // java/io/PrintStream.println:(Ljava/lang/String;)V #5 = Class #21 // Main #6 = Class #22 // java/lang/Object #7 = Utf8 &lt;init&gt; #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 main #12 = Utf8 ([Ljava/lang/String;)V #13 = Utf8 SourceFile #14 = Utf8 Main.java #15 = NameAndType #7:#8 // "&lt;init&gt;":()V #16 = Class #23 // java/lang/System #17 = NameAndType #24:#25 // out:Ljava/io/PrintStream; #18 = Utf8 Hello World #19 = Class #26 // java/io/PrintStream #20 = NameAndType #27:#28 // println:(Ljava/lang/String;)V #21 = Utf8 Main #22 = Utf8 java/lang/Object #23 = Utf8 java/lang/System #24 = Utf8 out #25 = Utf8 Ljava/io/PrintStream; #26 = Utf8 java/io/PrintStream #27 = Utf8 println #28 = Utf8 (Ljava/lang/String;)V { public Main(); descriptor: ()V flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 0: aload_0 1: invokespecial #1 // Method java/lang/Object."&lt;init&gt;":()V 4: return LineNumberTable: line 1: 0 public static void main(java.lang.String...); descriptor: ([Ljava/lang/String;)V flags: ACC_PUBLIC, ACC_STATIC, ACC_VARARGS Code: stack=2, locals=1, args_size=1 0: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 3: ldc #3 // String Hello World 5: invokevirtual #4// Method java/io/PrintStream.println:(Ljava/lang/String;)V 8: return LineNumberTable: line 4: 0 line 5: 8 } SourceFile: "Main.java"</code> </pre><br><p>  Esta es solo una representaci√≥n de c√≥digo de bytes que es m√°s f√°cil de ver para una persona que el c√≥digo de bytes original, pero se ve diferente: </p><br><pre> <code class="plaintext hljs"> cafe babe 0000 0034 001d 0a00 0600 0f09 0010 0011 0800 120a 0013 0014 0700 1507 0016 0100 063c 696e 6974 3e01 0003 2829 5601 0004 436f 6465 0100 0f4c 696e 654e 756d 6265 7254 6162 6c65 0100 046d 6169 6e01 0016 285b 4c6a 6176 612f 6c61 6e67 2f53 7472 696e 673b 2956 0100 0a53 6f75 7263 6546 696c 6501 0009 4d61 696e 2e6a 6176 610c 0007 0008 0700 170c 0018 0019 0100 0b48 656c 6c6f 2057 6f72 6c64 0700 1a0c 001b 001c 0100 044d 6169 6e01 0010 6a61 7661 2f6c 616e 672f 4f62 6a65 6374 0100 106a 6176 612f 6c61 6e67 2f53 7973 7465 6d01 0003 6f75 7401 0015 4c6a 6176 612f 696f 2f50 7269 6e74 5374 7265 616d 3b01 0013 6a61 7661 2f69 6f2f 5072 696e 7453 7472 6561 6d01 0007 7072 696e 746c 6e01 0015 284c 6a61 7661 2f6c 616e 672f 5374 7269 6e67 3b29 5600 2100 0500 0600 0000 0000 0200 0100 0700 0800 0100 0900 0000 1d00 0100 0100 0000 052a b700 01b1 0000 0001 000a 0000 0006 0001 0000 0001 0089 000b 000c 0001 0009 0000 0025 0002 0001 0000 0009 b200 0212 03b6 0004 b100 0000 0100 0a00 0000 0a00 0200 0000 0400 0800 0500 0100 0d00 0000 0200 0e</code> </pre> <br><p>  (Puede abrir su archivo <code>.class</code> trav√©s de Sublime Text que indica File-&gt; Save with Encoding -&gt; Hexademical) </p><br><p>  Trabajaremos con este c√≥digo. </p><br><p>  Pero primero, necesitamos formatearlo para no confundirnos donde est√°, y el bytecode, de hecho, tiene una estructura muy r√≠gida: </p><br><pre> <code class="plaintext hljs"> ClassFile { u4 magic; u2 minor_version; u2 major_version; u2 constant_pool_count; cp_info constant_pool[constant_pool_count-1]; u2 access_flags; u2 this_class; u2 super_class; u2 interfaces_count; u2 interfaces[interfaces_count]; u2 fields_count; field_info fields[fields_count]; u2 methods_count; method_info methods[methods_count]; u2 attributes_count; attribute_info attributes[attributes_count]; }</code> </pre> <br><p>  Puede encontrarlo en la especificaci√≥n JVM <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.1 La estructura de ClassFile</a> </p><br><p>  Aqu√≠ todo es simple: la dimensi√≥n en bytes se indica a la izquierda y la descripci√≥n a la derecha. </p><br><p>  Analizaremos el bytecode en hexadecimal, donde cada d√≠gito toma 4 bits y, por lo tanto, para dos bytes - 4 d√≠gitos y para cuatro bytes - 8 d√≠gitos. </p><br><p>  <strong>magia</strong> </p><br><p>  La magia es un valor que identifica el formato de nuestra clase.  Es igual a <code>0xCAFEBABE</code> , que tiene su propia <a href="https://en.wikipedia.org/wiki/Java_class_file">historia de creaci√≥n</a> . </p><br><p>  <strong>menor_versi√≥n, mayor_versi√≥n</strong> </p><br><p>  Estas son versiones de su archivo de <code>class</code> .  Si llamamos <code>major_version</code> M y <code>minor_version</code> m, obtenemos la versi√≥n de nuestro archivo de <code>class</code> como <code>Mm</code> </p><br><p>  Ahora dar√© ejemplos de nuestro programa "Hello World" de inmediato para ver c√≥mo se usan: </p><br><pre> <code class="plaintext hljs"> cafe babe -- magic 0000 -- minor_version 0034 -- major_version</code> </pre> <br><p>  Podemos verlo en el c√≥digo desmontado, pero ya en el sistema de n√∫meros decimales: </p><br><pre> <code class="plaintext hljs"> ... public class Main minor version: 0 major version: 52 flags: ACC_PUBLIC, ...</code> </pre> <br><p>  <strong>constant_pool_count</strong> </p><br><p>  El n√∫mero de variables en el grupo constante se indica aqu√≠.  Al mismo tiempo, si decide escribir c√≥digo en bytecode puro, entonces definitivamente necesita monitorear su valor, porque si especifica el valor incorrecto, todo el programa se ir√° al infierno (¬°verificado!). </p><br><p>  Adem√°s, no olvide que debe escribir all√≠ el <code>___ + 1</code> de_variables_ en el <code>___ + 1</code> </p><br><p>  Total que obtenemos: </p><br><pre> <code class="plaintext hljs"> cafe babe -- magic 0000 0034 -- version 001d -- constant_pool_count</code> </pre> <br><p>  <strong>constant_pool []</strong> </p><br><p>  Cada tipo de variable en el grupo constante tiene su propia estructura: </p><br><pre> <code class="plaintext hljs"> cp_info { u1 tag; u1 info[]; }</code> </pre> <br><p>  Aqu√≠ todo debe hacerse secuencialmente.  Primero leemos la <code>tag</code> para averiguar el tipo de la variable y por el tipo de esta variable miramos qu√© estructura tiene su valor posterior <code>info[]</code> </p><br><p>  Se puede encontrar una tabla con etiquetas en la <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Tabla 4.3</a> Especificaci√≥n de <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">etiquetas de agrupaci√≥n constante</a> . </p><br><p>  En realidad, aqu√≠ est√° la tableta: </p><br><div class="scrollable-table"><table><thead><tr><th>  Tipo constante </th><th>  Valor </th></tr></thead><tbody><tr><td> <code>CONSTANT_Class</code> </td> <td>  7 7 </td></tr><tr><td> <code>CONSTANT_Fieldref</code> </td> <td>  9 9 </td></tr><tr><td> <code>CONSTANT_Methodref</code> </td> <td>  10 </td></tr><tr><td> <code>CONSTANT_InterfaceMethodref</code> </td> <td>  11 </td></tr><tr><td> <code>CONSTANT_String</code> </td> <td>  8 </td></tr><tr><td> <code>CONSTANT_Integer</code> </td> <td>  3 </td></tr><tr><td> <code>CONSTANT_Float</code> </td> <td>  4 4 </td></tr><tr><td> <code>CONSTANT_Long</code> </td> <td>  5 5 </td></tr><tr><td> <code>CONSTANT_Double</code> </td> <td>  6 6 </td></tr><tr><td> <code>CONSTANT_NameAndType</code> </td> <td>  12 </td></tr><tr><td> <code>CONSTANT_Utf8</code> </td> <td>  1 </td></tr><tr><td> <code>CONSTANT_MethodHandle</code> </td> <td>  15 </td></tr><tr><td> <code>CONSTANT_MethodType</code> </td> <td>  16 </td></tr><tr><td> <code>CONSTANT_InvokeDynamic</code> </td> <td>  18 a√±os </td></tr></tbody></table></div><br><p>  Como se mencion√≥ anteriormente, cada tipo de constante tiene su propia estructura. </p><br><p>  Aqu√≠, por ejemplo, est√° la estructura <code>CONSTANT_Class</code> : </p><br><pre> <code class="plaintext hljs"> CONSTANT_Class_info { u1 tag; u2 name_index; }</code> </pre> <br><p>  Estructura de campo y m√©todo: </p><br><pre> <code class="plaintext hljs"> CONSTANT_Fieldref_info { u1 tag; u2 class_index; u2 name_and_type_index; } CONSTANT_Methodref_info { u1 tag; u2 class_index; u2 name_and_type_index; }</code> </pre> <br><p>  Es importante se√±alar aqu√≠ que diferentes estructuras pueden tener diferentes longitudes. </p><br><p>  Considere parte de nuestro c√≥digo: </p><br><pre> <code class="plaintext hljs"> cafe babe 0000 0034 001d -- constant_pool_count 0a00 0600 0f09 0010 0011 0800 12 ...</code> </pre> <br><p>  Entonces, miramos la estructura de la constante y descubrimos que el primer byte est√° reservado para el tipo de constante.  Aqu√≠ vemos <code>0a</code> (10) y, por lo tanto, es <code>CONSTANT_Methodref</code> </p><br><p>  Nos fijamos en su estructura: </p><br><pre> <code class="plaintext hljs"> CONSTANT_Methodref_info { u1 tag; u2 class_index; u2 name_and_type_index; }</code> </pre> <br><p>  Despu√©s de un byte para la etiqueta, necesitamos 4 bytes m√°s para <code>class_index</code> y <code>name_and_type_index</code> </p><br><pre> <code class="plaintext hljs"> cafe babe 0000 0034 001d -- constant_pool_count 0a 0006 000f -- CONSTANT_Methodref 0900 1000 1108 0012 ...</code> </pre> <br><p>  Bueno, encontramos uno de los valores del grupo constante.  Adelante  Miramos, <code>09</code> - significa el tipo <code>CONSTANT_Fieldref</code> </p><br><p>  Obtenemos: </p><br><pre> <code class="plaintext hljs"> cafe babe 0000 0034 001d -- constant_pool_count 0a 0006 000f -- CONSTANT_Methodref 09 0010 0011 -- CONSTANT_Fieldref 08 0012 ...</code> </pre> <br><p>  Puede pensar que la mayor√≠a de los tipos tienen la misma forma, pero este no es el caso. <br>  Por ejemplo, una estructura del siguiente tipo se parece a <code>CONSTANT_String</code> : </p><br><pre> <code class="plaintext hljs"> CONSTANT_String_info { u1 tag; u2 string_index; }</code> </pre> <br><p>  Todas estas estructuras se pueden encontrar en el <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.4 The Constant Pool.</a> </p><br><p>  Ahora veamos qu√© significan los tipos de <code>info</code> interna. </p><br><p>  Los m√©todos que se encuentran dentro del patr√≥n <code>*_index</code> generalmente contienen la direcci√≥n de la tabla de pool constante.  Por ejemplo, <code>class_index</code> para un valor de tipo <code>CONSTANT_Class_info</code> y <code>string_index</code> para un <code>string_index</code> <code>CONSTANT_Utf8_info</code> </p><br><p>  Podemos ver esto en el c√≥digo desmontado: </p><br><pre> <code class="plaintext hljs"> #1 = Methodref #6.#15 // java/lang/Object."&lt;init&gt;":()V #2 = Fieldref #16.#17 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #18</code> </pre> <br><pre> <code class="plaintext hljs"> 0a 0006 000f -- CONSTANT_Methodref 09 0010 0011 -- CONSTANT_Fieldref 08 0012 -- CONSTANT_String</code> </pre> <br><p>  Tambi√©n puede resaltar la representaci√≥n de n√∫meros y cadenas. </p><br><p>  Puede leer sobre la representaci√≥n de n√∫meros a partir del cap√≠tulo <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">4.4.4</a> , pero por ahora analizaremos solo las l√≠neas, ya que los n√∫meros a√∫n no est√°n incluidos en el programa Hello World </p><br><p>  En realidad, as√≠ es como aparece la l√≠nea: </p><br><pre> <code class="plaintext hljs"> CONSTANT_Utf8_info { u1 tag; u2 length; u1 bytes[length]; }</code> </pre> <br><p>  Por ejemplo, nuestro Hello World: </p><br><pre> <code class="plaintext hljs"> 01 -- tag 000b -- length 48 65 6c 6c 6f 20 57 6f 72 6c 64 -- bytes[length] // H ello W orld</code> </pre> <br><p>  Analizando todo el grupo de constantes de bytecode, obtenemos: </p><br><div class="spoiler">  <b class="spoiler_title">Todo el grupo de constantes</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> -- [Constant Pool] -- methodref 0a 0006 000f -- fieldref 09 0010 0011 -- string 08 0012 -- methodref 0a 0013 0014 -- Class 07 0015 -- Class 07 0016 -- Utf8 01 0006 3c 69 6e 69 74 3e -- Utf8 01 0003 28 29 56 -- Utf8 01 0004 43 6f 64 65 -- Utf8 01 000f 4c 69 6e 65 4e 75 6d 62 65 72 54 61 62 6c 65 -- Utf8 01 0004 6d 61 69 6e -- Utf8 01 0016 28 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 56 -- Utf8 01 000a 53 6f 75 72 63 65 46 69 6c 65 -- Utf8 01 0009 4d 61 69 6e 2e 6a 61 76 61 -- NameAndType 0c 0007 0008 -- Class 07 0017 -- NameAndType 0c 0018 0019 -- Utf8 01 000b 48 65 6c 6c 6f 20 57 6f 72 6c 64 -- Class 07 001a -- NameAndType 0c 001b 001c -- Utf8 01 0004 4d 61 69 6e -- Utf8 01 0010 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 -- Utf8 01 0010 6a 61 76 61 2f 6c 61 6e 67 2f 53 79 73 74 65 6d -- Utf8 01 0003 6f 75 74 -- Utf8 01 0015 4c 6a 61 76 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d 3b -- Utf8 01 0013 6a 61 76 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d -- Utf8 01 0007 70 72 69 6e 74 6c 6e -- Utf8 01 0015 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 29 56 -- [Constant Pool END]</code> </pre> </div></div><br><p>  Adem√°s, podemos compararlo con el c√≥digo desmontado: </p><br><pre> <code class="plaintext hljs"> Constant pool: #1 = Methodref #6.#15 // java/lang/Object."&lt;init&gt;":()V #2 = Fieldref #16.#17 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #18 // Hello World #4 = Methodref #19.#20 // java/io/PrintStream.println:(Ljava/lang/String;)V #5 = Class #21 // Main #6 = Class #22 // java/lang/Object #7 = Utf8 &lt;init&gt; #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 main #12 = Utf8 ([Ljava/lang/String;)V #13 = Utf8 SourceFile #14 = Utf8 Main.java #15 = NameAndType #7:#8 // "&lt;init&gt;":()V #16 = Class #23 // java/lang/System #17 = NameAndType #24:#25 // out:Ljava/io/PrintStream; #18 = Utf8 Hello World #19 = Class #26 // java/io/PrintStream #20 = NameAndType #27:#28 // println:(Ljava/lang/String;)V #21 = Utf8 Main #22 = Utf8 java/lang/Object #23 = Utf8 java/lang/System #24 = Utf8 out #25 = Utf8 Ljava/io/PrintStream; #26 = Utf8 java/io/PrintStream #27 = Utf8 println #28 = Utf8 (Ljava/lang/String;)V</code> </pre> <br><p>  Por lo tanto, verificando que todo coincida, porque de hecho <code>javap</code> simplemente procesa este c√≥digo de bytes y nos lo muestra en forma formateada. </p><br><p>  El grupo constante es necesario para obtener instrucciones.  Por ejemplo: </p><br><pre> <code class="plaintext hljs"> public Main(); descriptor: ()V flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 0: aload_0 1: invokespecial #1 //    1    4: return</code> </pre> <br><p>  Para obtener m√°s informaci√≥n sobre todos los tipos en el grupo constante, consulte el <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.4 El Grupo Constante.</a> </p><br><p>  Yendo m√°s all√° en la estructura <em>ClassFile</em> </p><br><p>  <strong>banderas de acceso</strong> </p><br><p>  Esta es una m√°scara de bits para las propiedades del modificador. </p><br><div class="scrollable-table"><table><thead><tr><th>  Nombre de la bandera </th><th>  Valor </th><th>  Interpretaci√≥n </th></tr></thead><tbody><tr><td> <code>ACC_PUBLIC</code> </td> <td>  0x0001 </td><td>  Declarado <code>public</code> ;  Se puede acceder desde fuera de su paquete. </td></tr><tr><td> <code>ACC_FINAL</code> </td> <td>  0x0010 </td><td>  Declarado <code>final</code> ;  No se permiten subclases. </td></tr><tr><td> <code>ACC_SUPER</code> </td> <td>  0x0020 </td><td>  Trate los m√©todos de superclase especialmente cuando sea invocado por la instrucci√≥n especial <em>invok</em> . </td></tr><tr><td> <code>ACC_INTERFACE</code> </td> <td>  0x0200 </td><td>  Es una interfaz, no una clase. </td></tr><tr><td> <code>ACC_ABSTRACT</code> </td> <td>  0x0400 </td><td>  <code>abstract</code> declarado;  No debe ser instanciado. </td></tr><tr><td> <code>ACC_SYNTHETIC</code> </td> <td>  0x1000 </td><td>  Declarado sint√©tico;  no presente en el c√≥digo fuente. </td></tr><tr><td> <code>ACC_ANNOTATION</code> </td> <td>  0x2000 </td><td>  Declarado como un tipo de anotaci√≥n. </td></tr><tr><td> <code>ACC_ENUM</code> </td> <td>  0x4000 </td><td>  Declarado como un tipo de <code>enum</code> . </td></tr></tbody></table></div><br><p>  <strong>esta_clase</strong> </p><br><p>  Debe contener una direcci√≥n en <code>this</code> clase.  En nuestro caso, se encuentra en la direcci√≥n 5: </p><br><pre> <code class="plaintext hljs"> Constant pool: #1 = Methodref #6.#15 // java/lang/Object."&lt;init&gt;":()V #2 = Fieldref #16.#17 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #18 // Hello World #4 = Methodref #19.#20 // java/io/PrintStream.println:(Ljava/lang/String;)V #5 = Class #21 // Main #6 = Class #22 // java/lang/Object ...</code> </pre> <br><p>  Cabe se√±alar que la estructura de esta variable debe cumplir con <code>CONSTANT_Class_info</code> </p><br><p>  <strong>superclase</strong> </p><br><p>  Direcci√≥n del antepasado de la clase.  En nuestro caso, el valor est√° en la direcci√≥n <code>#6</code> .  Bueno, tambi√©n se requiere la estructura de valor <code>CONSTANT_Class_info</code> </p><br><p>  Los nombres de estas clases se definen en la estructura de la constante <code>CONSTANT_Utf8_info</code> .  Si miramos las celdas <code>#21</code> y <code>#22</code> , veremos: </p><br><pre> <code class="plaintext hljs"> ... #21 = Utf8 Main #22 = Utf8 java/lang/Object ...</code> </pre> <br><p>  Es decir, en estas celdas se indica <code>name_index</code> de la estructura: </p><br><pre> <code class="plaintext hljs"> CONSTANT_Class_info { u1 tag; u2 name_index; }</code> </pre> <br><p>  <strong>interfaces_count, fields_count</strong> </p><br><p>  No est√°n en nuestro programa, por lo que sus valores ser√°n iguales a 0000, y simplemente no habr√° valores posteriores de los <code>fields[]</code> , <code>interfaces[]</code> . </p><br><p>  Leer m√°s <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">4.1 La estructura de ClassFile</a> </p><br><p>  <strong>m√©todos_cuenta</strong> </p><br><p>  N√∫mero de m√©todos  Aunque en el c√≥digo vemos un m√©todo en la clase, en realidad hay dos de ellos.  Adem√°s del m√©todo <code>main</code> , tambi√©n hay un constructor predeterminado.  Por lo tanto, su n√∫mero es dos, en nuestro caso. </p><br><p>  <strong>m√©todos []</strong> </p><br><p>  Cada elemento debe cumplir con la estructura <code>method_info</code> descrita en el <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.6 M√©todos</a> </p><br><pre> <code class="plaintext hljs"> method_info { u2 access_flags; u2 name_index; u2 descriptor_index; u2 attributes_count; attribute_info attributes[attributes_count]; }</code> </pre> <br><p>  En nuestro c√≥digo de bytes (formateado, con comentarios) se ve as√≠: </p><br><pre> <code class="plaintext hljs"> -- [methods] -- public Main(); 0001 --access_flags 0007 -- name_index 0008 -- descriptor_index 0001 -- attributes_count -- attribute_info 0009 -- attribute_name_index (Code) 0000 001d - attribute_length 0001 -- max_stack 0001 -- max_locals 0000 0005 -- code_length 2a b7 00 01 b1 -- code[] 0000 -- exception_table_length 0001 -- attributes_count; 000a -- attribute_name_index 0000 0006 -- attribute_length 00 01 00 00 00 01 -- public static void main(java.lang.String...); 0089 --access_flags 000b -- name_index 000c -- descriptor_index 0001 -- attributes_count -- attribute_info 0009 -- attribute_name_index (Code) 0000 0025 -- attribute_length 0002 -- max_stack 0001 -- max_locals 0000 0009 -- code_length b2 00 02 12 03 b6 00 04 b1 -- code[] 0000 -- exception_table_length 0001 -- attributes_count 000a -- attribute_name_index 0000 000a -- attribute_length 00 02 00 00 00 04 00 08 00 05 -- [methods END]</code> </pre> <br><p>  Analicemos la estructura de los m√©todos con m√°s detalle: </p><br><p>  <strong>banderas de acceso</strong> </p><br><p>  Modificador de m√°scara.  <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Tabla 4.5 Acceso al m√©todo e indicadores de propiedad</a> </p><br><div class="scrollable-table"><table><thead><tr><th>  Nombre de la bandera </th><th>  Valor </th><th>  Interpretaci√≥n </th></tr></thead><tbody><tr><td> <code>ACC_PUBLIC</code> </td> <td>  0x0001 </td><td>  Declarado <code>public</code> ;  Se puede acceder desde fuera de su paquete. </td></tr><tr><td> <code>ACC_PRIVATE</code> </td> <td>  0x0002 </td><td>  Declarado <code>private</code> ;  accesible solo dentro de la clase definitoria. </td></tr><tr><td> <code>ACC_PROTECTED</code> </td> <td>  0x0004 </td><td>  Declarado <code>protected</code> ;  Se puede acceder dentro de las subclases. </td></tr><tr><td> <code>ACC_STATIC</code> </td> <td>  0x0008 </td><td>  Declarado <code>static</code> . </td></tr><tr><td> <code>ACC_FINAL</code> </td> <td>  0x0010 </td><td>  Declarado <code>final</code> ;  no debe ser anulado ( <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-5.html">¬ß5.4.5</a> ). </td></tr><tr><td> <code>ACC_SYNCHRONIZED</code> </td> <td>  0x0020 </td><td>  Declarado <code>synchronized</code> ;  la invocaci√≥n est√° envuelta por un uso de monitor. </td></tr><tr><td> <code>ACC_BRIDGE</code> </td> <td>  0x0040 </td><td>  Un m√©todo de puente, generado por el compilador. </td></tr><tr><td> <code>ACC_VARARGS</code> </td> <td>  0x0080 </td><td>  Declarado con n√∫mero variable de argumentos. </td></tr><tr><td> <code>ACC_NATIVE</code> </td> <td>  0x0100 </td><td>  Declarado <code>native</code> ;  implementado en un lenguaje que no sea Java. </td></tr><tr><td> <code>ACC_ABSTRACT</code> </td> <td>  0x0400 </td><td>  <code>abstract</code> declarado;  no se proporciona implementaci√≥n </td></tr><tr><td> <code>ACC_STRICT</code> </td> <td>  0x0800 </td><td>  Declarado <code>strictfp</code> ;  el modo de punto flotante es estrictamente FP. </td></tr><tr><td> <code>ACC_SYNTHETIC</code> </td> <td>  0x1000 </td><td>  Declarado sint√©tico;  no presente en el c√≥digo fuente. </td></tr></tbody></table></div><br><p>  Como podemos ver en el bytecode, en el m√©todo <code>public Main();</code>  (constructor) es la m√°scara <code>0001</code> , que significa <code>ACC_PUBLIC</code> . </p><br><p>  Ahora intentemos ensamblar el m√©todo <code>main</code> nosotros mismos.  Aqu√≠ est√° lo que tiene: </p><br><ul><li>  public - ACC_PUBLIC - 0x0001 </li><li>  est√°tica - ACC_STATIC - 0x0008 </li><li>  Cadena ... args - ACC_VARARGS - 0x0080 </li></ul><br><p>  Recopilamos la m√°scara: 0x0001 + 0x0008 + 0x0080 = <code>0x0089</code> .  Entonces tenemos <code>access_flag</code> </p><br><blockquote>  Por cierto, ACC_VARARGS es opcional aqu√≠, en el sentido de que si <br>  us√≥ String [] args en lugar de String ... args, entonces esta bandera no ser√≠a </blockquote><p>  <strong>index_nombre</strong> </p><br><p>  Direcci√≥n del nombre del m√©todo ( <code>CONSTANT_Utf8_info</code> ) en el grupo constante.  Es importante tener en cuenta aqu√≠ que el nombre del constructor no es Main, sino <code>&lt;init&gt;</code> , ubicado en la celda # 7. </p><br><p>  Obtenga m√°s informaci√≥n sobre <code>&lt;init&gt;</code> y <code>&lt;clinit&gt;</code> en el <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html">Cap√≠tulo 2.9 M√©todos especiales</a> </p><br><p>  <strong>√≠ndice_descriptor</strong> </p><br><p>  En t√©rminos generales, esta es una direcci√≥n que apunta a un identificador de m√©todo.  Este descriptor contiene el tipo del valor de retorno y el tipo de su firma. </p><br><p>  Adem√°s, la JVM usa abreviaturas interpretadas: </p><br><div class="scrollable-table"><table><thead><tr><th>  Car√°cter <em>BaseType</em> </th><th>  Tipo </th><th>  Interpretaci√≥n </th></tr></thead><tbody><tr><td> <code>B</code> </td> <td> <code>byte</code> </td> <td>  byte firmado </td></tr><tr><td> <code>C</code> </td> <td> <code>char</code> </td> <td>  Punto de c√≥digo de caracteres Unicode en el plano multiling√ºe b√°sico, codificado con UTF-16 </td></tr><tr><td> <code>D</code> </td> <td> <code>double</code> </td> <td>  valor de coma flotante de doble precisi√≥n </td></tr><tr><td> <code>F</code> </td> <td> <code>float</code> </td> <td>  valor de coma flotante de precisi√≥n simple </td></tr><tr><td> <code>I</code> </td> <td> <code>int</code> </td> <td>  entero </td></tr><tr><td> <code>J</code> </td> <td> <code>long</code> </td> <td>  entero largo </td></tr><tr><td>  <code>L</code> <em>ClassName</em> <code>;</code> </td><td> <code>reference</code> </td> <td>  una instancia de clase <em>ClassName</em> </td></tr><tr><td> <code>S</code> </td> <td> <code>short</code> </td> <td>  corto firmado </td></tr><tr><td> <code>Z</code> </td> <td> <code>boolean</code> </td> <td>  <code>true</code> o <code>false</code> </td></tr><tr><td> <code>[</code> </td> <td> <code>reference</code> </td> <td>  una dimensi√≥n de matriz </td></tr></tbody></table></div><br><p>  En general, se ve as√≠: </p><br><pre> <code class="plaintext hljs"> ( ParameterDescriptor* ) ReturnDescriptor</code> </pre> <br><p>  Por ejemplo, el siguiente m√©todo: </p><br><pre> <code class="plaintext hljs"> Object method(int i, double d, Thread t) {..}</code> </pre> <br><p>  Puede ser representado como </p><br><pre> <code class="plaintext hljs"> (IDLjava/lang/Thread;)Ljava/lang/Object</code> </pre> <br><p>  En realidad, <code>I</code> <code>int</code> , <code>D</code> es <code>double</code> y <code>Ljava/lang/Thread;</code>  <code>Thread</code> clase de la biblioteca est√°ndar <code>java.lang</code> . </p><br><p>  A continuaci√≥n, hay atributos que tambi√©n tienen su propia estructura. </p><br><p>  Pero primero, como siempre, su cuenta de <code>attributes_count</code> </p><br><p>  Luego, los atributos mismos con la estructura descrita en el <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.7 Atributos</a> </p><br><pre> <code class="plaintext hljs"> attribute_info { u2 attribute_name_index; u4 attribute_length; u1 info[attribute_length]; }</code> </pre> <br><p>  <strong>nombre_atributo_index</strong> </p><br><p>  Especifica un nombre de atributo.  En nuestro caso, ambos m√©todos tienen un <code>Code</code> .  Atributos es un gran tema separado en el que incluso puede crear sus propios atributos por especificaci√≥n.  Pero por ahora, deber√≠amos saber que <code>attribute_name_index</code> solo apunta a la direcci√≥n en el grupo constante con la estructura <code>CONSTANT_Utf8_info</code> </p><br><p>  <strong>longitud_atributo</strong> </p><br><p>  Contiene la longitud del atributo, sin incluir <code>attribute_name_index</code> y <code>attribute_length</code> </p><br><p>  <strong>informacion</strong> </p><br><p>  A continuaci√≥n, usaremos la estructura de <code>Code</code> , porque en el valor de <code>attribute_name_index</code> se√±alamos el valor en el conjunto de constantes de <code>Code</code> . </p><br><p>  Leer m√°s: <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.7.3 El Atributo del C√≥digo</a> </p><br><p>  Aqu√≠ est√° su estructura: </p><br><pre> <code class="plaintext hljs"> Code_attribute { u2 attribute_name_index; u4 attribute_length; u2 max_stack; u2 max_locals; u4 code_length; u1 code[code_length]; u2 exception_table_length; { u2 start_pc; u2 end_pc; u2 handler_pc; u2 catch_type; } exception_table[exception_table_length]; u2 attributes_count; attribute_info attributes[attributes_count]; }</code> </pre> <br><p>  <strong>max_stack</strong> </p><br><p>  Me parece que el nombre de este atributo puede ser enga√±oso debido al prefijo max.  De hecho, este es el tama√±o m√≠nimo de pila necesario para completar la operaci√≥n.  Bueno, este nombre toma l√≥gica, para decir el tama√±o m√°ximo de pila que se alcanzar√° durante la operaci√≥n. </p><br><p>  En pocas palabras, la JVM asignar√° espacio para la pila de operandos.  All√≠ puede especificar un valor que sea m√°s grande de lo necesario, pero definir un valor en este atributo menos de lo necesario dar√° como resultado un error. </p><br><p>  Sobre el tema de la pila, puede leer " <a href="https%253A%252F%252Fwww.tune-it.ru%252Fweb%252Fbleizard%252Fblog%253Fp_p_id%253Dcom_liferay_blogs_web_portlet_BlogsPortlet%2526p_p_lifecycle%253D0%2526p_p_state%253Dnormal%2526p_p_mode%253Dview%2526_com_liferay_blogs_web_portlet_BlogsPortlet_cur%253D2%2526_com_liferay_blogs_web_portlet_BlogsPortlet_delta%253D10%2526p_r_p_resetCur%253Dfalse">En la pila y el mont√≥n en el contexto del mundo Java</a> " o en " <a href="http://blog.jamesdbloom.com/JVMInternals.html">Elementos internos de JVM</a> " </p><br><p>  <strong>max_locals</strong> </p><br><p>  Tama√±o m√°ximo de variables locales. </p><br><p>  Puede familiarizarse con las variables locales, ya sea en <a href="https://jrebel.com/rebellabs/rebel-labs-report-mastering-java-bytecode-at-the-core-of-the-jvm/">Mastering Java Bytecode en el n√∫cleo de la JVM</a> o en las mismas <a href="http://blog.jamesdbloom.com/JVMInternals.html">partes internas de JVM</a> </p><br><p>  <strong>longitud_c√≥digo</strong> </p><br><p>  El tama√±o del c√≥digo que se ejecutar√° dentro del m√©todo. </p><br><p>  <strong>c√≥digo []</strong> </p><br><p>  Cada c√≥digo apunta a alguna instrucci√≥n.  La tabla de correlaci√≥n de <code>optcode</code> y comandos con mnem√≥nicos se puede encontrar en Wikipedia: <a href="https://en.wikipedia.org/wiki/Java_bytecode_instruction_listings">listados de instrucciones de bytecode de Java</a> o en la especificaci√≥n al final del libro. </p><br><p>  Por ejemplo, tome nuestro constructor: </p><br><pre> <code class="plaintext hljs"> -- public Main(); 0001 --access_flags 0007 -- name_index 0008 -- descriptor_index 0001 -- attributes_count -- attribute_info 0009 -- attribute_name_index (Code) 0000 001d - attribute_length 00 01 -- max_stack 00 01 -- max_locals 00 00 00 05 -- code_length 2a b7 00 01 b1 -- code[] 0000 -- exception_table_length 0001 -- attributes_count; 00 0a -- attribute_name_index 0000 0006 -- attribute_length 00 01 00 00 00 01</code> </pre> <br><p>  Aqu√≠ podemos encontrar nuestro c√≥digo: </p><br><pre> <code class="plaintext hljs"> 2a b7 00 01 b1</code> </pre> <br><p>  Buscamos comandos en la tabla y comparamos: </p><br><pre> <code class="plaintext hljs"> 2a - aload_0 b7 0001 - invokespecial #1 b1 - return</code> </pre> <br><p>  Tambi√©n se pueden encontrar descripciones de estos comandos aqu√≠: <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.10.1.9.</a>  <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Instrucciones de verificaci√≥n de tipo</a> </p><br><p>  <strong>excepci√≥n_tabla_length</strong> </p><br><p>  Especifica el n√∫mero de elementos en la tabla_excepci√≥n.  No tenemos ganchos de excepci√≥n, por lo que no lo analizaremos.  Pero tambi√©n puede leer el <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html">Cap√≠tulo 4.7.3 El Atributo del C√≥digo</a> </p><br><p>  <strong>tabla_excepci√≥n []</strong> </p><br><p>  Tiene la siguiente estructura: </p><br><pre> <code class="plaintext hljs"> { u2 start_pc; u2 end_pc; u2 handler_pc; u2 catch_type; }</code> </pre> <br><p>  Para simplificar, debe especificar el principio, el final ( <code>start_pc</code> , <code>end_pc</code> ) del c√≥digo que <code>handler_pc</code> y el <code>catch_type</code> excepci√≥n <code>catch_type</code> </p><br><p>  <strong>cuenta_atributos</strong> </p><br><p>  N√∫mero de atributos en el <code>Code</code> </p><br><p>  <strong>atributos []</strong> </p><br><p>  Los atributos suelen ser utilizados por analizadores o depuradores. </p><br><hr><br><h3 id="sredstva-dlya-raboty-s-bayt-kodom">  Herramientas de Bytecode </h3><br><p>  Este no es el tema relacionado con este art√≠culo, pero a√∫n est√° indirectamente relacionado con √©l. </p><br><p>  Hay muchas herramientas para trabajar con bytecode.  Aqu√≠ me gustar√≠a revisar la <a href="https://commons.apache.org/proper/commons-bcel/">Byte Code Engineering Library</a> (BCEL) de Apache Commons. </p><br><p>  Para empezar, us√°ndolo podemos obtener algunos atributos de bytecode: </p><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">// read file from resources/complied/ClassA.class InputStream inputStream = ClassParserExample.class.getResourceAsStream("/compiled/ClassA.class"); if (inputStream == null) throw new FileNotFoundException(); ClassParser parser = new ClassParser(inputStream, "ClassA.class"); JavaClass clazz = parser.parse(); final String HEX_BYTECODE = getHex(clazz.getBytes()); System.out.println("Hex bytecode: "); System.out.println(HEX_BYTECODE); System.out.println(); final String MINOR_VER = getHex(clazz.getMinor()); final String MAJOR_VER = getHex(clazz.getMajor()); final String CONSTANT_POOL = getHex(clazz.getConstantPool().getConstantPool()); final String ACCESS_FLAGS = getHex(clazz.getAccessFlags()); final String THIS_CLASS = getHex(clazz.getClassName().getBytes()); final String SUPER_CLASS = getHex(clazz.getSuperClass().getBytes()); final String INTERFACES = getHex(clazz.getInterfaces()); final String FIELDS = getHex(clazz.getFields()); final String METHODS = getHex(clazz.getMethods()); final String ATTRIBUTES = getHex(clazz.getAttributes());</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Listado de c√≥digo completo</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">import org.apache.bcel.classfile.*; import org.apache.commons.codec.binary.Hex; import java.io.*; public class ClassParserExample { public static void main(String... args) throws IOException, ClassNotFoundException { // read file from resources/complied/ClassA.class InputStream inputStream = ClassParserExample.class.getResourceAsStream("/compiled/ClassA.class"); if (inputStream == null) throw new FileNotFoundException(); ClassParser parser = new ClassParser(inputStream, "ClassA.class"); JavaClass clazz = parser.parse(); final String HEX_BYTECODE = getHex(clazz.getBytes()); System.out.println("Hex bytecode: "); System.out.println(HEX_BYTECODE); System.out.println(); final String MINOR_VER = getHex(clazz.getMinor()); final String MAJOR_VER = getHex(clazz.getMajor()); final String CONSTANT_POOL = getHex(clazz.getConstantPool().getConstantPool()); final String ACCESS_FLAGS = getHex(clazz.getAccessFlags()); final String THIS_CLASS = getHex(clazz.getClassName().getBytes()); final String SUPER_CLASS = getHex(clazz.getSuperClass().getBytes()); final String INTERFACES = getHex(clazz.getInterfaces()); final String FIELDS = getHex(clazz.getFields()); final String METHODS = getHex(clazz.getMethods()); final String ATTRIBUTES = getHex(clazz.getAttributes()); System.out.println( "minor: " + MINOR_VER ); // 0 System.out.println( "major: " + MAJOR_VER ); // 34 System.out.println( "constant pool: " + CONSTANT_POOL); // not correctly System.out.println( "access flags: " + ACCESS_FLAGS ); // 21 System.out.println( "this class: " + THIS_CLASS ); System.out.println( "super class: " + SUPER_CLASS ); // Object System.out.println( "interfaces: " + INTERFACES ); // &lt;empty&gt; System.out.println( "fields: " + FIELDS ); // &lt;empty&gt; System.out.println( "methods: " + METHODS ); // one method: psvm hello world System.out.println( "attributes: " + ATTRIBUTES ); // 536f7572636546696c65 - I think it's instructions for Java tools } private static String getHex(byte[] bytes){ return Hex.encodeHexString(bytes); } private static String getHex(int intNum){ return Integer.toHexString(intNum); } private static String getHex(Constant[] constants){ if (constants == null) return null; StringBuilder sb = new StringBuilder(); for (Constant c : constants){ if (c == null) continue; sb.append(getHex(c.getTag())).append(" "); } return sb.toString(); } private static String getHex(JavaClass[] clazzes){ if (clazzes == null) return null; StringBuilder sb = new StringBuilder(); for (JavaClass c : clazzes){ sb.append(getHex(c.getClassName().getBytes())).append(" "); } return sb.toString(); } private static String getHex(Field[] fields){ if (fields == null) return null; StringBuilder sb = new StringBuilder(); for (Field c : fields){ sb.append(getHex(c.getName().getBytes())).append(" "); } return sb.toString(); } private static String getHex(Method[] methods){ if (methods == null) return null; StringBuilder sb = new StringBuilder(); for (Method c : methods){ sb.append(getHex(c.getName().getBytes())).append(" "); } return sb.toString(); } private static String getHex(Attribute[] attributes){ if (attributes == null) return null; StringBuilder sb = new StringBuilder(); for (Attribute c : attributes){ sb.append(getHex(c.getName().getBytes())).append(" "); } return sb.toString(); } } /* Class A: public class ClassA { public static void main(String[] args) { System.out.println("Hello world"); } } */ /* Class A bytecode: cafe babe 0000 0034 0022 0a00 0600 1409 0015 0016 0800 170a 0018 0019 0700 1a07 001b 0100 063c 696e 6974 3e01 0003 2829 5601 0004 436f 6465 0100 0f4c 696e 654e 756d 6265 7254 6162 6c65 0100 124c 6f63 616c 5661 7269 6162 6c65 5461 626c 6501 0004 7468 6973 0100 1d4c 636f 6d2f 6170 706c 6f69 6478 7878 2f70 6172 7365 2f43 6c61 7373 413b 0100 046d 6169 6e01 0016 285b 4c6a 6176 612f 6c61 6e67 2f53 7472 696e 673b 2956 0100 0461 7267 7301 0013 5b4c 6a61 7661 2f6c 616e 672f 5374 7269 6e67 3b01 000a 536f 7572 6365 4669 6c65 0100 0b43 6c61 7373 412e 6a61 7661 0c00 0700 0807 001c 0c00 1d00 1e01 000b 4865 6c6c 6f20 776f 726c 6407 001f 0c00 2000 2101 001b 636f 6d2f 6170 706c 6f69 6478 7878 2f70 6172 7365 2f43 6c61 7373 4101 0010 6a61 7661 2f6c 616e 672f 4f62 6a65 6374 0100 106a 6176 612f 6c61 6e67 2f53 7973 7465 6d01 0003 6f75 7401 0015 4c6a 6176 612f 696f 2f50 7269 6e74 5374 7265 616d 3b01 0013 6a61 7661 2f69 6f2f 5072 696e 7453 7472 6561 6d01 0007 7072 696e 746c 6e01 0015 284c 6a61 7661 2f6c 616e 672f 5374 7269 6e67 3b29 5600 2100 0500 0600 0000 0000 0200 0100 0700 0800 0100 0900 0000 2f00 0100 0100 0000 052a b700 01b1 0000 0002 000a 0000 0006 0001 0000 0006 000b 0000 000c 0001 0000 0005 000c 000d 0000 0009 000e 000f 0001 0009 0000 0037 0002 0001 0000 0009 b200 0212 03b6 0004 b100 0000 0200 0a00 0000 0a00 0200 0000 0800 0800 0900 0b00 0000 0c00 0100 0000 0900 1000 1100 0000 0100 1200 0000 0200 13 */ /* Assembled code: Classfile /C:/java/BCEL/src/main/resources/compiled/ClassA.class Last modified 08.12.2019; size 563 bytes MD5 checksum bcd0198f6764a1dc2f3967fef701452e Compiled from "ClassA.java" public class com.apploidxxx.parse.ClassA minor version: 0 major version: 52 flags: ACC_PUBLIC, ACC_SUPER Constant pool: #1 = Methodref #6.#20 // java/lang/Object."&lt;init&gt;":()V #2 = Fieldref #21.#22 // java/lang/System.out:Ljava/io/PrintStream; #3 = String #23 // Hello world #4 = Methodref #24.#25 // java/io/PrintStream.println:(Ljava/lang/String;)V #5 = Class #26 // com/apploidxxx/parse/ClassA #6 = Class #27 // java/lang/Object #7 = Utf8 &lt;init&gt; #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 LocalVariableTable #12 = Utf8 this #13 = Utf8 Lcom/apploidxxx/parse/ClassA; #14 = Utf8 main #15 = Utf8 ([Ljava/lang/String;)V #16 = Utf8 args #17 = Utf8 [Ljava/lang/String; #18 = Utf8 SourceFile #19 = Utf8 ClassA.java #20 = NameAndType #7:#8 // "&lt;init&gt;":()V #21 = Class #28 // java/lang/System #22 = NameAndType #29:#30 // out:Ljava/io/PrintStream; #23 = Utf8 Hello world #24 = Class #31 // java/io/PrintStream #25 = NameAndType #32:#33 // println:(Ljava/lang/String;)V #26 = Utf8 com/apploidxxx/parse/ClassA #27 = Utf8 java/lang/Object #28 = Utf8 java/lang/System #29 = Utf8 out #30 = Utf8 Ljava/io/PrintStream; #31 = Utf8 java/io/PrintStream #32 = Utf8 println #33 = Utf8 (Ljava/lang/String;)V { public com.apploidxxx.parse.ClassA(); descriptor: ()V flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 0: aload_0 1: invokespecial #1 // Method java/lang/Object."&lt;init&gt;":()V 4: return LineNumberTable: line 6: 0 LocalVariableTable: Start Length Slot Name Signature 0 5 0 this Lcom/apploidxxx/parse/ClassA; public static void main(java.lang.String[]); descriptor: ([Ljava/lang/String;)V flags: ACC_PUBLIC, ACC_STATIC Code: stack=2, locals=1, args_size=1 0: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 3: ldc #3 // String Hello world 5: invokevirtual #4 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 8: return LineNumberTable: line 8: 0 line 9: 8 LocalVariableTable: Start Length Slot Name Signature 0 9 0 args [Ljava/lang/String; } SourceFile: "ClassA.java */</code> </pre> </div></div><br><p>     ,    (,  Jasmin) -. </p><br><p>      <a href="https://github.com/AppLoidx/JVM-research"> </a>   <a href="https://github.com/apache/commons-bcel/tree/master/src/examples"> </a> </p><br><p> ,     <strong>Jasmin</strong> .   ,   ,     ,         JVM  -. </p><br><p>         : </p><br><div class="spoiler"> <b class="spoiler_title">Hello World</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">.bytecode 52.0 .source Main.j .class public Main .super java/lang/Object .method public static main([Ljava/lang/String;)V .limit stack 2 .limit locals 2 getstatic java/lang/System/out Ljava/io/PrintStream; ldc "Hello world!" invokevirtual java/io/PrintStream.println(Ljava/lang/String;)V return .end method</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">; ClassCreating.j .bytecode 52.0 .source ClassCreating.java .class public ClassCreating .super java/lang/Object .method public &lt;init&gt;()V .limit stack 1 .limit locals 1 .line 1 0: aload_0 1: invokespecial java/lang/Object/&lt;init&gt;()V 4: return .end method .method public static main([Ljava/lang/String;)V ; Flag ACC_VARARGS set, see JVM spec .limit stack 2 .limit locals 3 .line 3 0: new java/lang/String 3: dup 4: invokespecial java/lang/String/&lt;init&gt;()V 7: astore_1 .line 4 8: new ClassCreating 11: dup 12: invokespecial ClassCreating/&lt;init&gt;()V 15: astore_2 .line 5 16: aload_2 17: invokevirtual ClassCreating/sayHello()V .line 6 20: return .end method .method public sayHello()V .limit stack 2 .limit locals 1 .line 9 0: getstatic java/lang/System/out Ljava/io/PrintStream; 3: ldc "Hello, User!" 5: invokevirtual java/io/PrintStream/println(Ljava/lang/String;)V .line 10 8: return .end method</code> </pre> </div></div><br><hr><br><p>       Hello World </p><br><p>  -       : <a href="https://gist.github.com/AppLoidx/7173d7277dd73025ae06377a7cc75ed0">gist.github</a> </p><br><p>          . </p><br><p>  <strong>Literatura usada</strong> </p><br><ul><li> The Java Virtual Machine Specification ‚Äî <a href="https://docs.oracle.com/javase/specs/jvms/se8/jvms8.pdf">docs.oracle</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/480550/">https://habr.com/ru/post/480550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../480532/index.html">EDA desde un √°ngulo diferente</a></li>
<li><a href="../480534/index.html">16 consejos de desarrollo para Android en Kotlin. Parte 2</a></li>
<li><a href="../480540/index.html">Lanzamiento de Umbraco 8.4: CMS es a√∫n m√°s conveniente</a></li>
<li><a href="../480542/index.html">Conciencia de seguridad para adultos: c√≥mo cerrar una vulnerabilidad de phishing</a></li>
<li><a href="../480544/index.html">5 secretos ocultos en Java</a></li>
<li><a href="../480552/index.html">Firefox lucha por el futuro de la web</a></li>
<li><a href="../480554/index.html">El futuro de la computaci√≥n en la nube de Sun que nunca lleg√≥</a></li>
<li><a href="../480556/index.html">NGINX: Verificaci√≥n de la comunidad rusa de TI</a></li>
<li><a href="../480560/index.html">ICD parte rob√≥tica de las funciones en el departamento de operaciones</a></li>
<li><a href="../480564/index.html">API REST en Java sin marcos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>