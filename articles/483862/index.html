<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üññ üñêüèΩ üßú Funciones virtuales en microcontroladores: el lado oscuro üïå üç∞ üõ†Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬øEs familiar la situaci√≥n cuando el lugar en el flash se ha agotado y necesita empujar lo no comestible, sacrificando algo que necesita? Probemos en c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Funciones virtuales en microcontroladores: el lado oscuro</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483862/"> ¬øEs familiar la situaci√≥n cuando el lugar en el flash se ha agotado y necesita empujar lo no comestible, sacrificando algo que necesita?  Probemos en cambio sacrificar innecesariamente, se esconde en lugares bastante inesperados. <br><a name="habracut"></a><br>  Quer√≠a hacer un servidor telnet para controlar varios equipos en el popular y econ√≥mico m√≥dulo WIZnet W5500.  Todo lo que se necesita para esto es parte de la biblioteca est√°ndar de Arduino, el resultado se puede encontrar <a href="https://github.com/olegv142/TelNetSrv" rel="nofollow">aqu√≠</a> .  Pero esto no se trata de √©l.  Lo primero que realmente me sorprendi√≥ fue que este c√≥digo de funcionalidad simple ocupaba m√°s de la mitad del flash ATmega328P.  Por supuesto, hay una gran cantidad de c√≥digo en la biblioteca de Ethernet, pero no se usa todo, el compilador debe desechar el c√≥digo no utilizado del firmware ensamblado.  Comprueba si esto es as√≠. <br><br>  Vamos al directorio donde se lleva a cabo el ensamblado: la ruta hacia √©l se puede ver en los mensajes de compilaci√≥n y objdump -t &lt;elf firmware file&gt; para obtener la tabla de caracteres.  Vemos en √©l muchas funciones relacionadas con Ethernet, incluidas aquellas cuya necesidad no es obvia, por ejemplo, funciones para trabajar con UDP.  Es decir, parece que no se eliminaron funciones innecesarias.  Cual es el problema <br><br>  La respuesta puede parecer inesperada: todo es la herencia de clases que implementan Ethernet desde clases base con muchas funciones virtuales.  El compilador considera que una funci√≥n (o m√©todo de clase) se usa cuando hay enlaces a ella en otros lugares del c√≥digo.  Pero para crear dicho enlace, no es necesario llamar a la funci√≥n.  Es suficiente para guardar su direcci√≥n.  Incluso si no lo hacemos expl√≠citamente, C ++ lo hace por nosotros colocando un puntero a una funci√≥n en la tabla de funciones virtuales.  Incluso si nunca usamos esta funci√≥n virtual, estar√° presente en el firmware.  Si una funci√≥n se define en la clase base como puramente virtual (sin implementaci√≥n), entonces no tenemos m√°s opciones que implementarla, incluso si no la necesitamos, aumentando as√≠ el tama√±o del c√≥digo de firmware. <br><br>  Verificamos la exactitud de nuestra hip√≥tesis.  Tome la biblioteca Ethernet del github, por ejemplo <a href="https://github.com/PaulStoffregen/Ethernet" rel="nofollow">aqu√≠</a> , para no tocar el est√°ndar y modif√≠quelo.  Eliminamos la herencia y hacemos funciones virtuales simplemente por m√©todos.  C√≥mo hacerlo con cuidado, de forma reversible, puedes ver <a href="https://github.com/olegv142/Ethernet/commit/17c11b60ce73a0465d5a4474e41e4998a3883424" rel="nofollow">aqu√≠</a> .  Resultado: el tama√±o del c√≥digo disminuy√≥ en 4460 bytes, m√°s de una cuarta parte del tama√±o original. <br><br>  Por supuesto, la herencia y las funciones virtuales son √∫tiles.  Sin embargo, crear una clase base con funciones virtuales puras solo para definir una interfaz para implementaciones posteriores no siempre est√° justificado.  Primero debe asegurarse de que realmente usar√° esta interfaz con objetos de diferentes tipos, o la funcionalidad implementada en la clase base (como en la clase Print) le ser√° √∫til. </div></div><p>Source: <a href="https://habr.com/ru/post/483862/">https://habr.com/ru/post/483862/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483842/index.html">La historia de la creaci√≥n de una nube dom√©stica. Parte 5. Actualizaci√≥n 2019 - PHP 7.2, MariaDB 10.4 y Nextcloud 17</a></li>
<li><a href="../483844/index.html">An√°lisis de documentos reglamentarios sobre protecci√≥n de la informaci√≥n en el sector financiero y crediticio ruso</a></li>
<li><a href="../483846/index.html">Gesti√≥n alternativa de ventanas en Linux</a></li>
<li><a href="../483850/index.html">Ning√∫n dios quema ollas</a></li>
<li><a href="../483860/index.html">WHD Global 2012: el verdadero valor de los dominios baratos</a></li>
<li><a href="../483864/index.html">M√°s r√°pido que C ++; m√°s lento que php</a></li>
<li><a href="../483874/index.html">La publicaci√≥n del c√≥digo VVVVVV mostr√≥ cu√°n groseros son los juegos dentro</a></li>
<li><a href="../483876/index.html">La cultura corporativa roja es el principal problema de los negocios rusos (Parte 1)</a></li>
<li><a href="../483878/index.html">C√≥mo hablar sobre los principales componentes de Android en 15 minutos.</a></li>
<li><a href="../483880/index.html">¬øEn qu√© se diferencia la programaci√≥n actual de la programaci√≥n hace 20 a√±os?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>