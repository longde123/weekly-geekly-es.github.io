<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßïüèø ‚ôéÔ∏è ‚úäüèª Dezentrales Open Source-Partnerprogramm in der Waves-Blockchain üëåüèº üç∫ ü§í</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ein dezentrales Partnerprogramm f√ºr die Waves-Blockchain, das im Rahmen des Waves Labs-Stipendiums des Bettex-Teams implementiert wurde. 

 Die Post i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dezentrales Open Source-Partnerprogramm in der Waves-Blockchain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459590/">  Ein dezentrales Partnerprogramm f√ºr die Waves-Blockchain, das im Rahmen des Waves Labs-Stipendiums des Bettex-Teams implementiert wurde. <br><br><div class="spoiler">  <b class="spoiler_title">Die Post ist keine Werbung</b> <div class="spoiler_text">  !  Das Programm ist Open Source, seine Nutzung und Verbreitung ist kostenlos.  Die Anwendung des Programms stimuliert die Entwicklung von dApp-Anwendungen und f√∂rdert insgesamt die Dezentralisierung, was f√ºr jeden Webbenutzer von Vorteil ist. <br></div></div><br><img src="https://habrastorage.org/webt/hn/xm/xk/hnxmxkdtj1phll6cwjyceneyczg.jpeg" alt="Bild"><br><a name="habracut"></a><br>  Von dApp f√ºr Partnerprogramme eingef√ºhrt, ist eine Vorlage f√ºr Projekte, die Partner als Teil ihrer Funktionalit√§t enthalten.  Der Code kann als Vorlage zum Kopieren, als Bibliothek oder als Ideen f√ºr die technische Implementierung verwendet werden. <br><br>  In Bezug auf die Funktionalit√§t ist dies ein regul√§res Affiliate-System, das die Registrierung mit der Angabe eines Empfehlers, der mehrstufigen Ansammlung von Belohnungen f√ºr Empfehlungen und der Motivation f√ºr die Registrierung im System (Cashback) implementiert.  Das System ist eine ‚Äûreine‚Äú dApp, dh die Webanwendung interagiert direkt mit der Blockchain ohne Backend, Datenbank usw. <br><br>  Es werden Techniken verwendet, die auch in vielen anderen Projekten n√ºtzlich sein k√∂nnen: <br><br><ul><li>  Anrufen eines Smart-Kontos auf Kredit mit sofortiger R√ºckzahlung (zum Zeitpunkt des Anrufs befinden sich keine Token auf dem Konto, um den Anruf zu bezahlen, aber sie werden dort als Ergebnis des Anrufs angezeigt). </li><li>  PoW-Captcha - Schutz gegen hochfrequentes automatisiertes Aufrufen von Smart-Account-Funktionen - ein Analogon zu Captcha, jedoch durch Nachweis des Einsatzes von Rechenressourcen. </li><li>  Anforderung von Datenschl√ºsseln per Vorlage. </li></ul><br>  Die Anwendung besteht aus: <br><br><ul><li>  Smart-Account-Code in der Spracheritt4dapps (der standardm√§√üig mit dem Haupt-Smart-Account zusammengef√ºhrt wird, f√ºr den Sie die Affiliate-Funktionalit√§t implementieren m√ºssen); </li><li>  js-Wrapper, die die Abstraktionsebene √ºber die WAVES NODE REST-API implementieren; </li><li>  Code im vuejs-Framework, ein Beispiel f√ºr die Verwendung der Bibliothek und des RIDE-Codes. </li></ul><br>  Wir beschreiben alle diese Funktionen. <br><br>  <b>Rufen Sie das Smart-Konto mit sofortiger R√ºckzahlung auf Kredit an</b> <br><br>  InvokeScript-Aufrufe erfordern eine Geb√ºhr vom Konto, das die Transaktion initiiert.  Dies ist kein Problem, wenn Sie ein Projekt f√ºr Blockchain-Freaks durchf√ºhren, die einige WAVES-Token auf ihrem Konto haben. Wenn das Produkt jedoch auf eine weit verbreitete Verwendung ausgerichtet ist, wird dies zu einem ernsthaften Problem.  Schlie√ülich muss sich der Benutzer um den Kauf von WAVES-Token (oder eines anderen geeigneten Verm√∂genswerts, mit dem Sie f√ºr Transaktionen bezahlen k√∂nnen) k√ºmmern, wodurch sich die bereits erhebliche Schwelle f√ºr die Eingabe des Projekts erh√∂ht.  Wir k√∂nnen Verm√∂genswerte an Benutzer verteilen, wodurch wir f√ºr Transaktionen bezahlen und dem Risiko ihres Missbrauchs ausgesetzt sind, wenn automatisierte Systeme erstellt werden, um fl√ºssige Verm√∂genswerte aus unserem System abzupumpen. <br><br>  Es w√§re sehr praktisch, wenn es m√∂glich w√§re, einen InvokeScript-Aufruf ‚Äûauf Kosten des Empf√§ngers‚Äú (des Smart-Kontos, auf dem das Skript installiert ist) zu t√§tigen, und eine solche M√∂glichkeit besteht, obwohl nicht auf offensichtliche Weise. <br><br>  Wenn Sie ScriptTransfer in InvokeScript an die Adresse des Anrufers ausf√ºhren, wodurch die f√ºr die Geb√ºhr ausgegebenen Token kompensiert werden, ist ein solcher Anruf erfolgreich, selbst wenn zum Zeitpunkt des Anrufs keine Verm√∂genswerte auf dem anrufenden Konto vorhanden waren.  Dies ist m√∂glich, weil nach dem Aufruf einer Transaktion und nicht davor eine ausreichende Anzahl von Token gepr√ºft wird, so dass Transaktionen auf Kredit von ihrer sofortigen R√ºckzahlung abh√§ngig gemacht werden k√∂nnen. <br><br>  <i>ScriptTransfer (i.caller, i.fee, unit)</i> <br><br>  Der folgende Code erstattet die Geb√ºhr, die auf Kosten des Smart-Kontos ausgegeben wurde.  Um sich vor Missbrauch dieser Funktion zu sch√ºtzen, m√ºssen Sie √ºberpr√ºfen, ob der Anrufer eine Geb√ºhr f√ºr das richtige Asset und innerhalb angemessener Grenzen ausgibt: <br><br><pre><code class="plaintext hljs">func checkFee(i:Invocation) = { if i.fee &gt; maxFee then throw(‚Äúunreasonable large fee‚Äù) else if i.feeAssetId != unit then throw(‚Äúfee must be in WAVES‚Äù) else true }</code> </pre> <br>  Der Schutz vor b√∂swilliger und sinnloser Geldverschwendung erfordert auch den Schutz vor automatischen Anrufen (PoW-Captcha). <br><br>  <b>PoW-Captcha</b> <br><br>  Die Idee des Captcha zum Nachweis der Arbeit ist nicht neu und wurde bereits in verschiedenen Projekten umgesetzt, einschlie√ülich solcher, die auf der Basis von WAVES umgesetzt wurden.  Die Idee ist, dass der Anrufer f√ºr die Aktion, die die Ressourcen unseres Projekts verschwendet, auch seine eigenen Ressourcen ausgeben muss, was den Angriff auf die Ressourcenverarmung ziemlich teuer macht.  F√ºr eine sehr einfache und kosteng√ºnstige √úberpr√ºfung, ob der Absender der Transaktion die PoW-Aufgabe gel√∂st hat, wird die Transaktions-ID √ºberpr√ºft: <br><br>  <i>Wenn take (toBase58String (i.transactionId), 3)! = "123", dann werfen Sie ("Proof of Work Failed")</i> <br><br>  Um eine Transaktion durchzuf√ºhren, muss der Anrufer solche Parameter so ausw√§hlen, dass sein Base58-Code (ID) bei 123 beginnt, was einem Durchschnitt von einigen zehn Sekunden Prozessorzeit entspricht und f√ºr unsere Aufgabe im Allgemeinen angemessen ist.  Wenn ein einfacheres oder komplexeres PoW erforderlich ist, kann die Aufgabe auf offensichtliche Weise leicht verfeinert werden. <br><br>  <b>Anforderung von Datenschl√ºsseln per Vorlage</b> <br><br>  Um Blockchain als Datenbank zu verwenden, ist es wichtig, √ºber API-Tools zum Abfragen der Datenbank als Schl√ºsselwertvorlagen zu verf√ºgen.  Ein solches Toolkit wurde Anfang Juli 2019 als Parameter " <i>√úbereinstimmungen"</i> f√ºr die REST-API-Anforderung <i>/ Adressen / Daten "√úbereinstimmungen = regul√§rer Ausdruck" angezeigt</i> .  Wenn wir nicht einen Schl√ºssel und nicht alle Schl√ºssel gleichzeitig aus einer Webanwendung abrufen m√ºssen, sondern nur eine Gruppe, k√∂nnen wir eine Auswahl anhand des Schl√ºsselnamens treffen.  In diesem Projekt werden Auszahlungstransaktionen beispielsweise als codiert <br><br><pre> <code class="plaintext hljs">withdraw_${userAddress}_${txid}</code> </pre> <br>  Hiermit k√∂nnen Sie eine Liste der Transaktionen zum Abheben von Geldern f√ºr eine bestimmte Adresse gem√§√ü der Vorlage abrufen: <br><br><pre> <code class="plaintext hljs">?matches=withdraw_${userAddress}_.*</code> </pre> <br>  Jetzt analysieren wir die Komponenten der schl√ºsselfertigen L√∂sung. <br><br>  <b>Vuejs Code</b> <br><br>  Der Code ist eine funktionierende Demo in der N√§he eines realen Projekts.  Es implementiert die Anmeldung √ºber Waves Keeper und arbeitet mit der Bibliothek "partneriate.js" zusammen, mit deren Hilfe der Benutzer im System registriert, Transaktionsdaten abgefragt und verdientes Geld auf das Konto des Benutzers abgebucht werden kann. <br><br><img src="https://habrastorage.org/webt/ug/dv/e6/ugdve6bg3kaamx7flsyzkaubxma.jpeg" alt="Bild"><br><br>  <b>RIDE Code</b> <br><br>  Es besteht aus Register-, Fonds- und Auszahlungsfunktionen. <br><br>  Die Registerfunktion registriert sich beim Benutzersystem.  Es hat zwei Parameter: Referer (Referrer-Adresse) und den Salt-Parameter, der nicht im Funktionscode verwendet wird, der zur Auswahl der Transaktions-ID ben√∂tigt wird (PoW-Captcha-Task). <br><br>  Die Funktion (wie auch die anderen Funktionen aus diesem Projekt) verwendet die Ausleihtechnik. Das Ergebnis der Funktion ist die Finanzierung einer Geb√ºhr f√ºr den Aufruf dieser Funktion.  Dank dieser Entscheidung kann der Benutzer, der gerade die Brieftasche erstellt hat, sofort mit dem System arbeiten und muss sich nicht √ºber das Problem des Kaufs oder Empfangs eines Verm√∂genswerts wundern, mit dem Sie eine Transaktionsgeb√ºhr zahlen k√∂nnen. <br><br>  Das Ergebnis der Registrierungsfunktion sind zwei Eintr√§ge: <br><br><pre> <code class="plaintext hljs">${owner)_referer = referer ${referer}_referral_${owner} = owner</code> </pre> <br>  Dies erm√∂glicht eine direkte und umgekehrte Suche (Verweis dieses Benutzers und alle Verweise dieses Benutzers). <br><br>  Die Fondsfunktion ist eher eine Vorlage f√ºr die Entwicklung realer Funktionen.  In der dargestellten Form werden alle durch die Transaktion √ºberwiesenen Betr√§ge auf die Konten der √úberweiser 1, 2, 3, auf das Cashback-Konto und das √Ñnderungskonto verteilt (alles, was bei der Verteilung auf die vorherigen Konten √ºbrig bleibt, f√§llt hierher). <br><br>  Cashback ist ein Mittel, um den Endbenutzer zur Teilnahme am √úberweisungssystem anzuregen.  Der Benutzer kann den vom System gezahlten Teil der Provision in Form eines "Cashbacks" auf die gleiche Weise wie die Belohnungen f√ºr Empfehlungen abheben. <br><br>  Bei Verwendung des √úberweisungssystems sollte die Fondsfunktion ge√§ndert werden, die in die Hauptlogik des Smart-Kontos integriert ist, auf dem das System arbeiten wird.  Wenn beispielsweise die Empfehlungsgeb√ºhr f√ºr die get√§tigte Wette gezahlt wird, sollte die Fondsfunktion in die Logik integriert werden, in der die Wette abgeschlossen wird (oder eine andere gezielte Aktion ausgef√ºhrt wird, f√ºr die die Geb√ºhr gezahlt wird).  Diese Funktion codiert drei Ebenen von Empfehlungsbelohnungen.  Wenn Sie mehr oder weniger Ebenen ausf√ºhren m√ºssen, wird dies auch im Code korrigiert.  Der Prozentsatz der Verg√ºtung wird durch die Konstanten der Stufen 1 bis 3 festgelegt. Im Code wird er als <i>Betrag * Stufe / 1000 betrachtet</i> , dh der Wert 1 entspricht 0,1% (dies kann auch im Code ge√§ndert werden). <br><br>  Der Funktionsaufruf √§ndert den Kontostand und erstellt Eintr√§ge zum Anmelden im Formular: <br><br><pre> <code class="1c hljs">fund_address_txid = address:owner:inc:level:timestamp <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  timestamp ( )     func getTimestamp() = { let block = extract(blockInfoByHeight(height)) toString(block.timestamp) }</code> </pre> <br>  Das hei√üt, die Transaktionszeit ist die Zeit des Blocks, in dem sie sich befindet.  Dies ist zuverl√§ssiger als die Verwendung eines Zeitstempels aus der Transaktion selbst, zumal von Callable aus nicht darauf zugegriffen werden kann. <br>  Die Auszahlungsfunktion zeigt alle auf dem Benutzerkonto angesammelten Pr√§mien an.  Erstellt Eintr√§ge f√ºr Protokollierungszwecke: <br><br><pre> <code class="plaintext hljs"># withdraw log: withdraw_user_txid=amount:timestamp</code> </pre> <br>  <b>App</b> <br><br>  Der Hauptteil der Anwendung ist die Bibliothek "iate.js ", die eine Br√ºcke zwischen den Partnerdatenmodellen und der WAVES NODE REST-API darstellt.  Implementiert eine vom Framework unabh√§ngige Abstraktionsebene (jede kann verwendet werden).  Aktive Funktionen (registrieren, zur√ºckziehen) setzen voraus, dass Waves Keeper im System installiert ist, die Bibliothek selbst √ºberpr√ºft dies nicht. <br><br>  Implementiert Methoden: <br><br><pre> <code class="plaintext hljs">fetchReferralTransactions fetchWithdrawTransactions fetchMyBalance fetchReferrals fetchReferer withdraw register</code> </pre> <br>  Die Funktionalit√§t der Methoden ergibt sich aus den Namen, den Parametern und den zur√ºckgegebenen Daten, die im Code beschrieben sind.  Die Registerfunktion erfordert zus√§tzliche Kommentare - sie startet den Transaktions-ID-√úbereinstimmungszyklus so, dass er bei 123 beginnt - dies ist das oben beschriebene PoW-Captcha, das vor Massenregistrierungen sch√ºtzt.  Die Funktion findet die Transaktion mit der gew√ºnschten ID und signiert sie dann √ºber Waves Keeper. <br><br>  Das DEX-Partnerprogramm ist auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub.com</a> verf√ºgbar. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459590/">https://habr.com/ru/post/de459590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459580/index.html">Virtuelle Telefonsysteme</a></li>
<li><a href="../de459582/index.html">√úberblick: Wie kaufe ich Aktien amerikanischer Unternehmen aus Russland?</a></li>
<li><a href="../de459584/index.html">Ich habe einen gro√üartigen Programmierer namens Steve Wozniak gefunden</a></li>
<li><a href="../de459586/index.html">Garden v0.10.0: Ihr Laptop ben√∂tigt keine Kubernetes</a></li>
<li><a href="../de459588/index.html">Stimmen Sie nicht zu, das zu entwickeln, was Sie nicht verstehen</a></li>
<li><a href="../de459592/index.html">Drei Zeitmanagement-Tipps f√ºr diejenigen, die alles versucht haben.</a></li>
<li><a href="../de459594/index.html">Lesen Sie zwischen den Noten: Daten√ºbertragungssystem in der Musik</a></li>
<li><a href="../de459596/index.html">iOS Digest Nr. 9 (28. Juni - 11. Juli)</a></li>
<li><a href="../de459598/index.html">H√§ufig gestellte Fragen zu SELinux (FAQ)</a></li>
<li><a href="../de459602/index.html">Wir binden den Lua-Interpreter in das Projekt f√ºr den Mikrocontroller (stm32) ein.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>