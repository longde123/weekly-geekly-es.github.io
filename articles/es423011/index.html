<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèΩ üóÑÔ∏è üå§Ô∏è Gesti√≥n de microservicios con Kubernetes e Istio üèπ üññüèø ü§∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Una breve historia sobre las ventajas y desventajas de los microservicios, el concepto de Service Mesh y las herramientas de Google que le permiten ej...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gesti√≥n de microservicios con Kubernetes e Istio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/423011/">  Una breve historia sobre las ventajas y desventajas de los microservicios, el concepto de Service Mesh y las herramientas de Google que le permiten ejecutar aplicaciones de microservicios sin obstruir su cabeza con configuraciones interminables de pol√≠ticas, accesos y certificados y encontrar r√°pidamente errores ocultos no en el c√≥digo, sino en la l√≥gica del microservicio. <br><br><img src="https://habrastorage.org/webt/os/ta/tg/ostatgvg9ytjgcicnno567t2x_q.jpeg"><br><br>  El art√≠culo se basa en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe de Craig Box</a> en nuestra conferencia DevOops 2017 del a√±o pasado. El video y la traducci√≥n del informe est√°n recortados. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/RnBXQpo6Mjs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Craig Box (Craig Box, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Twitter</a> ): DevRel de Google a cargo de microservicios y herramientas Kubernetes e Istio.  Su historia actual trata sobre la gesti√≥n de microservicios en estas plataformas. <br><br>  Comencemos con un concepto relativamente nuevo llamado Service Mesh.  Este t√©rmino se utiliza para describir la red de microservicios interactivos que componen la aplicaci√≥n. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/91b/eb1/7c6/91beb17c6f784bdf2b8d433b44512285.jpg"><br><br>  En un nivel alto, vemos la red como una tuber√≠a que simplemente mueve bits.  No queremos preocuparnos por ellos o, por ejemplo, por las direcciones MAC en las aplicaciones, pero nos esforzamos por pensar en los servicios y conexiones que necesitan.  Si observa desde el punto de vista de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OSI</a> , entonces tenemos una red de tercer nivel (con funciones para determinar la ruta y el direccionamiento l√≥gico), pero queremos pensar en t√©rminos de la s√©ptima (con la funci√≥n de acceso a servicios de red). <br><br>  ¬øC√≥mo deber√≠a ser una red real de s√©ptimo nivel?  Tal vez queremos ver algo as√≠ como un rastro de tr√°fico en torno a servicios problem√°ticos.  Para que pueda conectarse al servicio, y al mismo tiempo, el nivel del modelo se elev√≥ desde el tercer nivel.  Queremos tener una idea de lo que est√° sucediendo en el cl√∫ster, encontrar dependencias no deseadas, descubrir las causas ra√≠z de las fallas.  Tambi√©n debemos evitar sobrecargas innecesarias, por ejemplo, conectarse con una latencia alta o conectarse a servidores con una memoria cach√© fr√≠a o no totalmente calentada. <br><br>  Debemos asegurarnos de que el tr√°fico entre servicios est√© protegido contra ataques triviales.  Se requiere autenticaci√≥n mutua de TLS, pero sin incorporar los m√≥dulos apropiados en cada aplicaci√≥n que escribimos.  Es importante poder controlar lo que rodea nuestras aplicaciones no solo a nivel de conexi√≥n, sino tambi√©n a un nivel superior. <br><br>  Service Mesh es una capa que nos permite resolver los problemas anteriores en un entorno de microservicio. <br><br><h2>  Monolito y microservicios: pros y contras </h2><br>  Pero primero nos preguntamos, ¬øpor qu√© deber√≠amos resolver estos problemas?  ¬øC√≥mo hicimos el desarrollo de software antes?  Ten√≠amos una aplicaci√≥n que se parec√≠a a esto, como un monolito. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c6/385/111/8c63851119c38df240c57cf399a8c344.jpg"><br><br>  Es genial: todo el c√≥digo est√° a la vista.  ¬øPor qu√© no seguir usando este enfoque? <br>  S√≠, porque el monolito tiene sus propios problemas.  La principal dificultad es que si queremos reconstruir esta aplicaci√≥n, debemos volver a implementar cada m√≥dulo, incluso si nada ha cambiado.  Nos vemos obligados a crear una aplicaci√≥n en el mismo idioma o en idiomas compatibles, incluso si diferentes equipos trabajan en ello.  De hecho, las partes individuales no se pueden probar independientemente una de la otra.  Es hora de cambiarlo, es hora de microservicios. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d19/ccb/fd5/d19ccbfd59552751e2171ba6b89ac9bc.jpg"><br><br>  Entonces, dividimos el monolito en partes.  Puede notar que en este ejemplo eliminamos algunas de las dependencias innecesarias y dejamos de usar los m√©todos internos llamados desde otros m√≥dulos.  Creamos servicios a partir de los modelos que se usaron anteriormente, creando abstracciones en los casos en que necesitamos mantener el estado.  Por ejemplo, cada servicio debe tener un estado independiente para que cuando acceda a √©l, no tenga que preocuparse por lo que sucede en el resto de nuestro entorno. <br><br>  Cual es el resultado? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cd2/4da/729/cd24da7292ffd1e23eb4e56ca2842c5f.jpg"><br><br>  Dejamos el mundo de las aplicaciones gigantes para obtener lo que realmente se ve genial.  Aceleramos el desarrollo, dejamos de usar m√©todos internos, creamos servicios y ahora podemos escalarlos de forma independiente, hacer que el servicio sea m√°s grande sin tener que consolidar todo lo dem√°s.  Pero, ¬øcu√°l es el precio del cambio que hemos perdido? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b4/234/b49/2b4234b49b4dcb5f79840391ee0f5a36.jpg"><br><br>  Tuvimos llamadas confiables dentro de las aplicaciones porque simplemente llamaste a una funci√≥n o m√≥dulo.  Reemplazamos la llamada de confianza dentro del m√≥dulo con una llamada de procedimiento remoto poco confiable.  Pero el servicio del otro lado no siempre est√° disponible. <br><br>  Est√°bamos a salvo, usando el mismo proceso dentro de la misma m√°quina.  Ahora nos estamos conectando a servicios que pueden estar en diferentes m√°quinas y en una red no confiable. <br><br>  En el nuevo enfoque en la red, es posible la presencia de otros usuarios que intentan conectarse a los servicios.  Los retrasos aumentaron y, al mismo tiempo, disminuyeron sus capacidades de medici√≥n.  Ahora tenemos conexiones paso a paso en todos los servicios que crean una llamada de m√≥dulo, y ya no podemos simplemente mirar la aplicaci√≥n en el depurador y descubrir exactamente qu√© caus√≥ la falla.  Y este problema necesita ser resuelto de alguna manera.  Obviamente, necesitamos un nuevo conjunto de herramientas. <br><br><h2>  Que se puede hacer </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/fd0/857/5a9/fd08575a99e8a4f4baf64d916eef077b.jpg"><br><br>  Hay varias opciones  Podemos tomar nuestra aplicaci√≥n y decir que si <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RPC</a> no funciona la primera vez, debe intentarlo nuevamente, y luego una y otra vez.  Espere un poco e intente nuevamente o agregue Jitter.  Tambi√©n podemos agregar rastreos de entrada - salida para decir que la llamada comenz√≥ y termin√≥, lo que para m√≠ es equivalente a la depuraci√≥n.  Puede agregar infraestructura para proporcionar autenticaci√≥n de conexiones y ense√±ar a todas nuestras aplicaciones c√≥mo trabajar con el cifrado TLS.  Tendremos que asumir la carga del contenido de los equipos individuales y tener en cuenta constantemente los diversos problemas que pueden surgir en las bibliotecas SSL. <br><br>  Mantener la coherencia en m√∫ltiples plataformas es una tarea desagradecida.  Me gustar√≠a que el espacio entre las aplicaciones sea razonable, para que exista la posibilidad de realizar un seguimiento.  Tambi√©n necesitamos la capacidad de cambiar configuraciones en tiempo de ejecuci√≥n para no recompilar o reiniciar aplicaciones para la migraci√≥n.  Esta lista de deseos e implementa Service Mesh. <br><br><h2>  Isstio </h2><br>  Habla sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Istio</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc8/cdf/0fe/fc8cdf0fe52823fcd092a2dd8de2aeb6.jpg"><br><br>  Istio es un marco completo para conectar, administrar y monitorear la arquitectura de microservicios.  Istio est√° dise√±ado para funcionar sobre Kubernetes.  √âl mismo no implementa el software y no le importa que est√© disponible en las m√°quinas que utilizamos para este prop√≥sito con contenedores en Kubernetes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ddb/e05/1e8/ddbe051e8e8f90273b1bd686d1f5c90e.jpg"><br><br>  En la figura, vemos tres secciones diferentes de las m√°quinas y bloques que conforman nuestros microservicios.  Tenemos una forma de agruparlos usando los mecanismos proporcionados por Kubernetes.  Podemos apuntar y decir que un grupo espec√≠fico que puede tener una escala autom√°tica adjunta a un servicio web o puede tener otros m√©todos de implementaci√≥n contendr√° nuestro servicio web.  En este caso, no necesitamos pensar en m√°quinas, operamos en t√©rminos del nivel de acceso a los servicios de red. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/966/45b/f3c/96645bf3c0ff9d2104622a84edcafeeb.png"><br><br>  Esta situaci√≥n se puede representar en forma de diagrama.  Considere un ejemplo cuando tenemos un mecanismo que procesa algunas im√°genes.  El usuario de la izquierda es el tr√°fico que nos llega en el microservicio. <br><br>  Para aceptar el pago del usuario, tenemos un microservicio de pago separado que llama a una API externa que se encuentra fuera del cl√∫ster. <br><br>  Para procesar el inicio de sesi√≥n del usuario, proporcionamos un microservicio de autenticaci√≥n y tiene estados almacenados nuevamente fuera de nuestro cl√∫ster en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">base de datos de Cloud SQL</a> . <br><br>  ¬øQu√© hace Istio?  Istio mejora Kubernetes.  Lo instala utilizando una funci√≥n alfa en Kubernetes llamada Initializer.  Cuando implemente el software, kubernetes lo notar√° y preguntar√° si queremos cambiar y agregar√° otro contenedor dentro de cada kubernetes.  Este contenedor manejar√° rutas y enrutamiento, tenga en cuenta todos los cambios de la aplicaci√≥n. <br><br>  As√≠ se ve el circuito con Istio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/398/f41/c6d/398f41c6dcbe3e0dea4741e71204d7bd.jpg"><br><br>  Tenemos m√°quinas externas que proporcionan proxies entrantes y salientes para el tr√°fico en un servicio en particular.  Podemos descargar las funciones de las que ya hemos hablado.  No necesitamos ense√±arle a la aplicaci√≥n c√≥mo realizar telemetr√≠a o rastreo usando TLS.  Pero podemos agregar otras cosas adentro: interrupci√≥n autom√°tica, l√≠mite de velocidad, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">liberaci√≥n de canario</a> . <br><br>  Todo el tr√°fico pasar√° ahora a trav√©s de servidores proxy en m√°quinas externas, y no directamente a los servicios.  Kubernetes hace todo en la misma direcci√≥n IP.  Podremos interceptar el tr√°fico que ir√≠a a los servicios frontales o finales. <br><br>  El proxy externo que usa Istio se llama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Envoy</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a00/3ed/04f/a003ed04fc566d4f27b1e5df70e3ae21.jpg"><br><br>  Envoy es en realidad m√°s viejo que Istio, fue desarrollado en Lyft.  Lleva m√°s de un a√±o trabajando en producci√≥n, lanzando toda la infraestructura de microservicios.  Elegimos Envoy para el proyecto Istio en colaboraci√≥n con la comunidad.  Por lo tanto, Google, IBM y LYFT son las tres compa√±√≠as que a√∫n est√°n trabajando en ello. <br><br>  Envoy est√° escrito en C ++ 11. Ha estado en producci√≥n durante m√°s de 18 meses antes de convertirse en un proyecto de c√≥digo abierto.  No tomar√° muchos recursos cuando lo conecte a sus servicios. <br><br>  Aqu√≠ hay algunas cosas que Envoy puede hacer.  Esta es la creaci√≥n de un servidor proxy para HTTP, que incluye HTTP / 2 y protocolos basados ‚Äã‚Äãen √©l, como gRPC.  Tambi√©n puede reenviar a otros protocolos a nivel binario.  Envoy controla su zona de infraestructura para que pueda hacer que su parte sea aut√≥noma.  Puede manejar una gran cantidad de conexiones de red con reintentos y espera.  Puede establecer un cierto n√∫mero de intentos para conectarse al servidor antes de detener la llamada y transmitir informaci√≥n a sus servidores que el servicio no responde. <br><br>  No debe preocuparse por volver a cargar la aplicaci√≥n para agregarle configuraci√≥n.  Simplemente con√©ctese a √©l utilizando una API muy similar a kubernetes y cambie la configuraci√≥n en tiempo de ejecuci√≥n. <br><br>  El equipo de Istio ha hecho una gran contribuci√≥n a la plataforma UpStream Envoy.  Por ejemplo, una alerta de error de inyecci√≥n.  Hicimos posible ver c√≥mo se comporta la aplicaci√≥n en caso de exceder el n√∫mero de solicitudes para el objeto que fall√≥.  Y tambi√©n implement√≥ las funciones de visualizaci√≥n gr√°fica y separaci√≥n de tr√°fico para manejar casos cuando se utiliza la implementaci√≥n canaria. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/068/0e1/351/0680e13511f2d5dc5eeac4bada02c05c.jpg"><br><br>  La figura muestra c√≥mo se ve la arquitectura del sistema Istio.  Tomaremos solo dos microservicios que se mencionaron anteriormente.  Finalmente, en el diagrama, todo es muy similar a una red definida por software.  Desde el servidor proxy Envoy, que implementamos con las aplicaciones, el tr√°fico se transfiere mediante tablas IP en el espacio de nombres.  El panel de control es responsable de administrar la consola, pero no procesa el tr√°fico en s√≠. <br>  Tenemos tres componentes.  Pilot, que crea la configuraci√≥n, observa las reglas que se pueden cambiar usando la API para el panel de control de Istio y luego actualiza Envoy para que se comporte como un servicio de descubrimiento de cl√∫ster.  Istio-Auth sirve como autoridad de certificaci√≥n y transmite certificados TLS a los servidores proxy.  La aplicaci√≥n no requiere SSL, se pueden conectar a trav√©s de HTTP y los servidores proxy se encargar√°n de todo esto por usted. <br><br>  Mixer procesa solicitudes para garantizar que cumpla con la pol√≠tica de seguridad y luego transmite informaci√≥n de telemetr√≠a.  Sin realizar ning√∫n cambio en la aplicaci√≥n, podemos ver todo lo que sucede dentro de nuestro cl√∫ster. <br><br><h2>  Beneficios de Istio </h2><br>  Entonces, hablemos con m√°s detalle sobre las cinco cosas que obtendremos de Istio.  En primer lugar, considere <b>la gesti√≥n del tr√°fico</b> .  Podemos separar el control del tr√°fico de la escala de la infraestructura, por lo que antes podr√≠amos hacer algo as√≠ como 20 instancias de la aplicaci√≥n y 19 de ellas estar√°n en la versi√≥n anterior, y una en la nueva, es decir, el 5% del tr√°fico estar√° en la nueva versi√≥n.  Con Istio, podemos implementar cualquier cantidad de instancias que necesitemos, y al mismo tiempo indicar qu√© porcentaje de tr√°fico debe enviarse a las nuevas versiones.  Una simple regla de separaci√≥n. <br><br>  Todo se puede programar sobre la marcha utilizando reglas.  Envoy se actualizar√° peri√≥dicamente a medida que cambie la configuraci√≥n, y esto no dar√° lugar a interrupciones del servicio.  Dado que trabajamos en el nivel de acceso a los servicios de red, podemos ver los paquetes y, en este caso, existe la oportunidad de ingresar al agente de usuario, que se encuentra en el tercer nivel de la red. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/810/1a1/7d5/8101a17d596613c7cc6871ce0f7d238a.png"><br><br>  Por ejemplo, podemos decir que cualquier tr√°fico del iPhone sigue una regla diferente, y vamos a dirigir una cierta fracci√≥n del tr√°fico a la nueva versi√≥n, que queremos probar para un dispositivo espec√≠fico.  El microservicio de llamadas internas puede determinar a qu√© versi√≥n espec√≠fica necesita conectarse y puede transferirlo a otra versi√≥n, por ejemplo, 2.0. <br><br>  La segunda ventaja es la <b>transparencia</b> .  Cuando tiene una vista dentro del cl√∫ster, puede comprender c√≥mo est√° hecho.  No necesitamos crear herramientas para m√©tricas en el proceso de desarrollo.  Las m√©tricas ya est√°n en cada componente. <br><br>  Algunos creen que es suficiente mantener un registro de registro para el monitoreo.  Pero, de hecho, todo lo que necesitamos es tener un conjunto de indicadores tan universal que se pueda alimentar a cualquier servicio de monitoreo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/099/627/ab5/099627ab5e7b0615bb2e3725ce118160.jpg"><br><br>  As√≠ es como se ve la barra de herramientas Istio creada usando el servicio Prometheus.  Recuerde implementarlo dentro del cl√∫ster. <br><br>  En el ejemplo, la captura de pantalla muestra una serie de par√°metros supervisados ‚Äã‚Äãespec√≠ficos para todo el cl√∫ster.  Se pueden deducir cosas m√°s interesantes, por ejemplo, qu√© porcentaje de aplicaciones da m√°s de 500 errores, lo que implica una falla.  El tiempo de respuesta se agrega en todas las instancias de servicio de llamada y respuesta dentro del cl√∫ster; esta funcionalidad no requiere configuraci√≥n.  Istio sabe qu√© admite Prometheus y sabe qu√© servicios est√°n disponibles en su cl√∫ster, por lo que Istio-Mixer puede enviar m√©tricas a Prometheus sin ninguna configuraci√≥n adicional. <br>  Veamos como funciona.  Si llama a un servicio espec√≠fico, el servicio proxy env√≠a informaci√≥n sobre esta llamada a Mixer, que captura par√°metros tales como el tiempo de espera para la respuesta, el estado del c√≥digo y la IP.  Los normaliza y los env√≠a a cualquier servidor que haya configurado.  Especialmente para mostrar los indicadores principales, existe el servicio Prometheus y los adaptadores FLUX DB, pero tambi√©n puede escribir su propio adaptador y mostrar datos en cualquier formato para cualquier otra aplicaci√≥n.  Y no tiene que cambiar nada en la infraestructura si desea agregar una nueva m√©trica. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/477/8cf/7ea/4778cf7ea5f78c0d8dca61aaaf7756c5.jpg"><br><br>  Si desea realizar una investigaci√≥n m√°s profunda, use el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sistema de</a> rastreo distribuido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Zipkin</a> .  La informaci√≥n sobre todas las llamadas enrutadas a trav√©s del Istio-Mixer se puede enviar a Zipkin.  All√≠ ver√° toda la cadena de llamadas de microservicio al responder al usuario y encontrar√° f√°cilmente un servicio que est√° retrasando el tiempo de procesamiento. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c0/820/3e5/1c08203e54bc8fc2cb3a0f6da427e497.jpg"><br><br>  A nivel de aplicaci√≥n, hay poca necesidad de preocuparse por crear una traza.  Envoy pasa toda la informaci√≥n necesaria al Mezclador, que lo env√≠a a la traza, por ejemplo, a Zipkin, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">traza de stackdriver</a> de Google o cualquier otra aplicaci√≥n de usuario. <br><br>  Hablemos de <b>tolerancia a fallos y eficiencia</b> . <br><img src="https://habrastorage.org/getpro/habr/post_images/da4/c03/b1b/da4c03b1b08ebbc652e332c680b79599.jpg"><br><br>  Los tiempos de espera entre llamadas de servicio son necesarios para probar el estado de, en primer lugar, los equilibradores de carga.  Introducimos errores en esta conexi√≥n y vemos qu√© sucede.  Considera un ejemplo.  Supongamos que hay una conexi√≥n entre el servicio A y el servicio B. Esperamos una respuesta del servicio de video durante 100 milisegundos y damos solo 3 intentos si no se recibe el resultado.  En esencia, lo vamos a tomar por 300 milisegundos antes de que informe un intento de conexi√≥n fallido. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c8/858/101/2c885810146ca5a44c88b42b2b1552c5.jpg"><br><br>  Adem√°s, por ejemplo, nuestro servicio de pel√≠culas deber√≠a analizar la calificaci√≥n de la pel√≠cula a trav√©s de otro microservicio.  La calificaci√≥n tiene un tiempo de espera de 200 milisegundos y se dan dos intentos de llamada.  Llamar a un servicio de video puede hacer que espere 400 milisegundos si la calificaci√≥n de estrellas est√° fuera de su alcance.  Pero, recordamos, despu√©s de 300 ms, el servicio de pel√≠culas informar√° que est√° inactivo, y nunca sabremos la verdadera causa de la falla.  Usar tiempos de espera y probar lo que sucede en estos casos es una excelente manera de encontrar todo tipo de errores inteligentes en su arquitectura de microservicios. <br><br>  Veamos ahora qu√© hay con eficiencia.  El equilibrador de kubernetes act√∫a solo al nivel de la cuarta capa.  Inventamos un constructor de entrada para el equilibrio de carga desde la segunda capa hasta la s√©ptima.  Istio se implementa como un equilibrador para la capa de red con acceso a los servicios de red. <br><br>  Realizamos la descarga de TLS, por lo que utilizamos SSL moderno y bien dopado en Envoy, para que no tenga que preocuparse por las vulnerabilidades. <br><br>  Otra ventaja de Istio es la <b>seguridad</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/902/a1d/fcc/902a1dfcc83b7bbb4bc3d49463c5682b.jpg"><br><br>  ¬øCu√°les son las caracter√≠sticas b√°sicas de seguridad en Istio?  El servicio Istio-Auth funciona en varias direcciones.  Utiliza un marco p√∫blico y un conjunto de est√°ndares de autenticaci√≥n para los servicios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SPIFFE</a> .  Si hablamos de flujo de tr√°fico, entonces tenemos una autoridad de certificaci√≥n Istio que emite certificados para las cuentas de servicio que ejecutamos dentro del cl√∫ster.  Estos certificados cumplen con el est√°ndar SPIFFE y son distribuidos por Envoy utilizando el mecanismo de seguridad kubernetes.  Envoy utiliza claves para la autenticaci√≥n TLS bidireccional.  Por lo tanto, las aplicaciones de fondo reciben identificadores en funci√≥n de los cuales ya es posible organizar una pol√≠tica. <br><br>  Istio mantiene certificados ra√≠z por s√≠ mismo para que no se preocupe por las fechas de revocaci√≥n y vencimiento.  El sistema responder√° a la escala autom√°tica, por lo que al introducir una nueva entidad, obtendr√° un nuevo certificado.  Sin ajustes manuales.  No necesita configurar un firewall.  Los usuarios utilizar√°n pol√≠ticas de red y kubernetes para implementar firewalls entre contenedores. <br><br>  Finalmente, la <b>aplicaci√≥n de pol√≠ticas</b> .  Mixer es un punto de integraci√≥n con backends de infraestructura que puede expandir con Service Mesh.  Los servicios pueden moverse f√°cilmente dentro de un cl√∫ster, implementarse en m√∫ltiples entornos, en la nube o localmente.  Todo est√° dise√±ado para el control operativo de las llamadas que pasan por Envoy.       ,      ,     . ,    -   20    .    20 ,   . <br><br>        , , ,    , ICL      .       ,  ,  ,   ,    . , Mixer      ,   .            . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/202/d7a/975/202d7a975db3a50477ac367ea4d6f1e4.jpg"><br><br>     ,      Istio?       .        .         ,         .     ,    . <br><br><h2>     Istio </h2><br> Istio    kubernetes,    ,    ,    1.7  .  -  kubernetes.    Google Container Engine Alpha clusters.    ,                 . <br><br>   Istio ‚Äî        github.      0.2.   0.1          kubernetes.   0.2          kubernetes.        ,     .    Envoy      ,    .   Istio    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cloud Foundry</a> . <br><br>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> .        Google Container Engine  1.8   -,   Istio ‚Äî     . <br><br><blockquote>     ,  14    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DevOops 2018</a> ():       ,         . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es423011/">https://habr.com/ru/post/es423011/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422997/index.html">El libro "PHP moderno"</a></li>
<li><a href="../es422999/index.html">Crea tu propio conjunto de datos alien√≠genas</a></li>
<li><a href="../es423005/index.html">C√≥mo Yandex.Zen, el complemento de almacenamiento en cach√© de WordPress y el alojamiento aumentaron mi presi√≥n</a></li>
<li><a href="../es423007/index.html">"Malyavki, pero bien": c√≥mo llevamos a los estudiantes a practicar</a></li>
<li><a href="../es423009/index.html">Diagn√≥stico SENS. Biomarcadores de glicaci√≥n proteica</a></li>
<li><a href="../es423013/index.html">C√≥mo organizar tus dependencias en una aplicaci√≥n Vue</a></li>
<li><a href="../es423015/index.html">Git: errores comunes y c√≥mo solucionarlos</a></li>
<li><a href="../es423017/index.html">Bobbiniki: diez grabadoras de cintas de culto - cuenta y muestra</a></li>
<li><a href="../es423021/index.html">Hackathon en l√≠nea por Naviaddress</a></li>
<li><a href="../es423023/index.html">¬øPor qu√© los desarrolladores necesitan ense√±anza?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>