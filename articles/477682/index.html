<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚ÄçüöÄ üíï ‚ùóÔ∏è Servicios heredados en su infraestructura üë®‚Äçüç≥ üöÅ üë©üèΩ‚Äçü§ù‚Äçüë®üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Mi nombre es Pasha Chernyak, soy un desarrollador l√≠der en QIWI y hoy quiero hablar sobre lo inevitable. Sobre el legado. 

 Comencemos con la pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Servicios heredados en su infraestructura</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/qiwi/blog/477682/"> Hola  Mi nombre es Pasha Chernyak, soy un desarrollador l√≠der en QIWI y hoy quiero hablar sobre lo inevitable.  Sobre el legado. <br><br>  Comencemos con la pregunta: ¬øqu√© es un servicio heredado?  ¬øEs un servicio heredado un servicio que el desarrollador no ha tocado durante una semana / mes / a√±o?  ¬øO es un servicio escrito por un programador menos experimentado, por ejemplo, espec√≠ficamente por usted, pero hace un a√±o?  Y ahora eres m√°s genial y m√°s experimentado.  O, despu√©s de todo, ¬øes un servicio Legacy un servicio que usted decide no volver a comprometer y est√° preparando lentamente un reemplazo para √©l?  En cualquier caso, dejar este servicio desatendido y no actualizarlo es una bomba de tiempo que puede explotar m√°s tarde. <br><br> <a href="https://habr.com/ru/company/qiwi/blog/477682/"><img src="https://habrastorage.org/webt/p9/ln/rt/p9lnrt-etdgnk1bd6mkfrcsxoxk.jpeg"></a> <br><br>  Antes de pasar a c√≥mo trabajamos con nuestros servicios Legacy en QIWI, le dir√© c√≥mo ponemos las cosas en orden con los servicios de Wallet.  Desde hace dos a√±os soy responsable de su desempe√±o.  Si hay alg√∫n problema, siempre me llaman primero.  Por lo general, no tengo la audacia de llamar a otra persona a las 11 p.m., as√≠ que tuve que sentarme y comprender todos los servicios de nuestro dominio. <br><br>  Pero a m√≠, como a cualquier persona, me gusta dormir por la noche, as√≠ que trat√© de lidiar con la operaci√≥n: "Chicos, ¬øpor qu√© me llaman?"  A lo que recibi√≥ una respuesta bastante concisa de la forma "¬øQui√©n m√°s?"  Porque estoy reparando servicios, y los chicos simplemente no saben a qui√©n llamar. <br><br>  Por lo tanto, en una de las retrospectivas del equipo de back-end de Wallet, decidimos que necesitamos compilar una placa en la que est√° escrita una lista de nuestros servicios, microservicios y monolitos de la billetera, y los responsables de ellos.  Las tabletas son generalmente √∫tiles, en un grado razonable. <br><a name="habracut"></a><br>  Adem√°s de la informaci√≥n sobre qui√©n es responsable de qu√©, hubo respuestas a las preguntas: qui√©n es el propietario del servicio, qui√©n es responsable de su desarrollo, de la arquitectura y del ciclo de vida.  Las personas responsables de este servicio son personas que pueden repararlo si sucede algo.  El propietario del servicio tiene derecho a dejar +2 en los compromisos, los responsables tambi√©n deben estar presentes en la revisi√≥n antes de que este servicio asuma el nuevo compromiso. <br><br>  A medida que pasaba el tiempo, comenzaron a aplicarse nuevas pr√°cticas, por ejemplo, la migraci√≥n a Kubernetes, todo tipo de checkstyle, spotbugs, ktlint, la presencia de registros en kiban, servicios de detecci√≥n autom√°tica en lugar de especificar direcciones directamente y otras cosas √∫tiles.  Y en todas partes nuestra mesa nos permiti√≥ mantener la relevancia de nuestros servicios.  Para nosotros, esta es una lista de verificaci√≥n que dice que este servicio sabe c√≥mo hacerlo, pero a√∫n no lo ha hecho. Pero fuimos m√°s all√°, al darnos cuenta de que carecemos de informaci√≥n sobre nuestros servicios, por lo que hacemos un seguimiento de d√≥nde se encuentran los c√≥digos fuente del servicio. , donde se inician las tareas de ensamblaje en TeamCity, c√≥mo se implementan, d√≥nde se almacenan los c√≥digos fuente de las pruebas de end2end, fotos de los arreglos sobre arquitectura, sobre las decisiones tomadas.  Idealmente, quer√≠a que toda esta informaci√≥n estuviera en alg√∫n lugar y estuviera a mano cuando fuera necesario.  Por lo tanto, nuestra placa se ha convertido en un punto de partida para encontrar informaci√≥n. <br><br>  Pero QIWI, si bien conserva el esp√≠ritu de una startup, es una gran empresa.  Ya tenemos 12 a√±os y los equipos est√°n cambiando: la gente se va, la gente viene, se est√°n formando nuevos equipos.  Y encontramos en nuestro dominio varios servicios que heredamos.  Algo ocurri√≥ con los desarrolladores de otros equipos, algo relacionado indirectamente con Wallet, por lo que el servicio ahora est√° en equilibrio.  Tratar con qu√© y c√≥mo funciona, ¬øpor qu√©?  El servicio funciona, y tenemos caracter√≠sticas del producto que deben ser eliminadas. <br><br><h2>  Como sucede </h2><br>  Pero en alg√∫n momento, encontramos que el servicio deja de cumplir su funci√≥n, algo se ha roto: ¬øqu√© se debe hacer en esta situaci√≥n?  El servicio simplemente dej√≥ de funcionar.  Absolutamente  Y aprendimos sobre esto, primero, por casualidad, y segundo, seis meses despu√©s.  Sucede  Lo √∫nico que sab√≠amos era en qu√© m√°quinas virtuales se despleg√≥ el servicio, d√≥nde se encuentran sus fuentes y eso es todo.  Hacemos clon de git y nos sumergimos en los pensamientos de la persona que escribi√≥ esto hace varios a√±os, pero ¬øqu√© vemos?  No hay Spring Boot familiar para nosotros, aunque estamos acostumbrados a todo, tenemos una pila completa y todo eso.  Tal vez hay un marco de primavera?  Pero no <br><br>  El tipo que escribi√≥ todo esto fue duro y escribi√≥ todo en Java puro.  No existen herramientas familiares para el desarrollador, y surge la idea: debemos reescribir todo esto.  Tambi√©n tenemos microservicios, y en cada tostadora escuchamos los familiares "¬°Chicos, microservicios son lo que necesitan!".  Si de repente algo est√° mal, con calma aprender√°s cualquier idioma y todo estar√° bien. <br><br>  La cuesti√≥n es que ahora no tenemos un cliente responsable de este servicio.  ¬øCu√°les fueron sus requisitos comerciales, qu√© debe hacer este servicio en general?  Y el servicio est√° estrechamente integrado en sus procesos comerciales. <br><br>  Ahora d√≠game, ¬øqu√© tan f√°cil es reescribir un servicio sin conocer sus requisitos comerciales?  El servicio no est√° claro c√≥mo se registra; se desconoce si hay m√©tricas.  Lo que son, si los hay, es a√∫n m√°s desconocido.  Y mientras est√° en el servicio, una gran cantidad de clases de l√≥gica empresarial oscura.  Algo est√° incluido en alg√∫n tipo de base de datos, sobre el cual todav√≠a no sabemos nada. <br><br><h2>  Por donde empezar </h2><br>  Desde lo m√°s l√≥gico - con la disponibilidad de pruebas.  Al menos se escribe all√≠ alg√∫n tipo de l√≥gica y se pueden sacar conclusiones sobre lo que est√° sucediendo.  Ahora TDD est√° de moda, pero vemos que hace 5 a√±os todo era casi igual que ahora: casi no hay pruebas unitarias y no nos dicen absolutamente nada.  Bueno, excepto tal vez alg√∫n tipo de verificaci√≥n de c√≥mo se firma alg√∫n xml con alg√∫n tipo de certificado personalizado. <br><br>  No pod√≠amos entender nada por el c√≥digo, y enviamos una mirada para ver qu√© era la m√°quina virtual all√≠.  Abrimos los registros del servicio, encontramos un error de cliente http en ellos, un certificado autofirmado que fue cosido a los recursos de la aplicaci√≥n, sin escr√∫pulos.  Contactamos a nuestros analistas, nos pidieron un nuevo certificado, nos lo emitieron y el servicio funciona nuevamente.  Eso parece ser todo.  O no?  A√∫n as√≠, el servicio funciona, realiza alguna funci√≥n que nuestro negocio necesita.  Tenemos algunos est√°ndares de desarrollo de aplicaciones que probablemente tenga.  Por ejemplo, no almacene los registros en el nodo en la carpeta, sino que los almacene en alg√∫n tipo de almacenamiento, como un el√°stico, m√≠relos en el kiban.  Puedes recordar las m√©tricas doradas.  Es decir, la carga en el servicio, la cantidad de solicitudes para el servicio, si est√° vivo o no, c√≥mo funciona su HealthCheck.  Como m√≠nimo, estas m√©tricas lo ayudar√°n a descubrir cu√°ndo se puede desmantelar y olvidar como un mal sue√±o con la conciencia tranquila. <br><br><h2>  Que hacer </h2><br>  Por lo tanto, agregamos un servicio tan antiguo a la tableta, y luego buscamos voluntarios entre los desarrolladores que se encargar√°n del servicio y lo pondr√°n en orden: escribir√°n al menos alguna informaci√≥n sobre el servicio, agregar√°n enlaces a paneles en graphan, a tareas de ensamblaje, y comprender√°n c√≥mo Implemente la aplicaci√≥n, no cargue archivos usando ftp con sus manos. <br><br>  Lo principal es cu√°nto costar√° todo este voluntariado √∫til.  Un sprint para un desarrollador m√°s o menos experimentado, por ejemplo, durante una deuda t√©cnica del 20%.  ¬øY cu√°nto tiempo se tard√≥ en comprender toda la l√≥gica profundamente arraigada de comunicarse con un determinado sistema de estado y llevarlo a tecnolog√≠as m√°s nuevas?  No puedo responder por esto, tal vez un mes, o tal vez dos equipos de trabajo.  Esto lo digo desde la experiencia de integraci√≥n en el momento actual con alg√∫n servicio nuevo. <br><br>  Al mismo tiempo, no hay escape de valor comercial.  Absolutamente  Tomar el servicio de soporte y pasar un poco de tiempo es normal.  Pero despu√©s de nuestros bailes est√°ndar con el servicio, lo agregamos a la tabla, agregamos informaci√≥n al respecto y, tal vez, alg√∫n d√≠a lo reescribiremos.  Pero ahora cumple con nuestros est√°ndares de servicio. <br><br>  Como resultado, me gustar√≠a traer a un plan qu√© hacer con los servicios de Legacy. <br><br>  <b>Reescribir el legado desde cero es una mala idea</b> <br>  En serio, ni siquiera tienes que pensarlo.  Est√° claro que nos gustar√≠a, y se ven algunas ventajas, pero generalmente esto no es necesario para nadie, incluido usted. <br><br>  <b>Libro de referencia</b> <br>  Excava los c√≥digos fuente de tus aplicaciones, crea un directorio que indique qu√© y d√≥nde se encuentra y c√≥mo funciona, ingresa la descripci√≥n del proyecto all√≠ (readme.md condicional) para comprender r√°pidamente d√≥nde est√°n los registros y las m√©tricas.  Un desarrollador que se ocupar√° de esto despu√©s de que solo diga gracias. <br><br>  <b>Comprender el dominio</b> <br>  Si posee un dominio, trate de mantener su pulso.  Suena cursi, s√≠, pero no todos se aseguran de que los servicios est√©n en una sola clave.  Pero trabajar en un est√°ndar es en realidad significativamente m√°s f√°cil. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/477682/">https://habr.com/ru/post/477682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../477670/index.html">Lo que da la automatizaci√≥n de prueba</a></li>
<li><a href="../477672/index.html">Derechos y obligaciones de los miembros del equipo: aspectos legales y culturales.</a></li>
<li><a href="../477674/index.html">¬øAI significa amor?</a></li>
<li><a href="../477678/index.html">Perspectivas para la televisi√≥n digital en Rusia</a></li>
<li><a href="../477680/index.html">Nuestras manos no son para aburrirnos: restaurar el cluster Rook en K8</a></li>
<li><a href="../477684/index.html">Angular: el mejor compa√±ero de construcci√≥n para aplicaciones interactivas</a></li>
<li><a href="../477686/index.html">Nuestro en la Conferencia AI Journey</a></li>
<li><a href="../477688/index.html">Resumen de eventos de TI de diciembre</a></li>
<li><a href="../477692/index.html">Experiencia usando ZGC y Shenandoah GC en producci√≥n</a></li>
<li><a href="../477694/index.html">JavaScript no necesita ser reemplazado por nada; otros idiomas tambi√©n enfrentar√°n los mismos problemas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>