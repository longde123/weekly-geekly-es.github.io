<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö´ üë©‚Äçüöí ü§´ Les rapports les plus rapides dans l'ouest sauvage. Et une poign√©e de bugs en plus ... üë®üèΩ‚Äçü§ù‚Äçüë®üèª üòã üöµüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Non seulement Microsoft a r√©cemment publi√© le code open source de ses propres projets, mais d'autres soci√©t√©s suivent √©galement cette tendance. Pour n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Les rapports les plus rapides dans l'ouest sauvage. Et une poign√©e de bugs en plus ...</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/431370/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e31/a8a/e21/e31a8ae21e6997c220a18cf2ac49b67b.png" alt="Image 3"></div><br>  Non seulement Microsoft a r√©cemment publi√© le code open source de ses propres projets, mais d'autres soci√©t√©s suivent √©galement cette tendance.  Pour nous, les d√©veloppeurs de PVS-Studio, c'est un excellent moyen de tester √† nouveau l'analyseur, de voir les choses int√©ressantes qu'il peut trouver et d'en informer les auteurs du projet.  Aujourd'hui, nous regardons √† l'int√©rieur du projet Fast Reports. <br><a name="habracut"></a><br><h2>  Qu'est-ce qui a √©t√© v√©rifi√©? </h2><br>  FastReport est un g√©n√©rateur de rapports d√©velopp√© par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fast Reports</a> .  √âcrit en C # et compatible avec .NET Standard 2.0+.  Le code source du projet a √©t√© r√©cemment <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publi√© sur GitHub</a> , o√π il a √©t√© t√©l√©charg√© pour une analyse plus approfondie. <br><br>  Les rapports prennent en charge l'utilisation de texte, d'images, de lignes, de formes, de diagrammes, de tableaux, de codes √† barres, etc. Ils peuvent √™tre d'une seule page et de plusieurs pages, comprenant notamment, en plus des donn√©es, une couverture et une page arri√®re.  Les sources de donn√©es peuvent √™tre XML, CSV, Json, MS SQL, MySql, Oracle, Postgres, MongoDB, Couchbase, RavenDB, SQLite. <br><br>  Il existe diff√©rentes fa√ßons de cr√©er des mod√®les de rapport: √† partir du code;  en tant que fichier xml;  en utilisant un concepteur en ligne ou FastReport Designer Community Edition. <br><br>  Si n√©cessaire, les biblioth√®ques peuvent √™tre t√©l√©charg√©es en tant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">que packages NuGet</a> . <br><br>  Vous pouvez en savoir plus sur les fonctionnalit√©s du produit sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page GitHub du projet</a> . <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/8c1/5d8/102/8c15d8102287436e600f08f4362d5970.png" alt="Image 8"></p><br>  Il n'y a eu aucun probl√®me avec l'assemblage du projet - je l'ai assembl√© √† partir de Visual Studio 2017, d'o√π il a ensuite √©t√© v√©rifi√© par le plugin PVS-Studio. <br><br>  PVS-Studio est un analyseur statique qui recherche les erreurs dans le code C, C ++, C #, Java.  Lors de l'analyse du code C #, vous pouvez utiliser l'analyseur Visual Studio IDE √† l'aide du plug-in PVS-Studio, ou vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v√©rifier les projets √† partir de la ligne de commande</a> , pour laquelle l'utilitaire de ligne de commande PVS-Studio_Cmd.exe est utilis√©.  Si vous le souhaitez, vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">configurer l'analyse sur le serveur de g√©n√©ration</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">raccorder les r√©sultats de l'analyse √† SonarQube</a> . <br><br>  Voyons ce qui √©tait int√©ressant cette fois. <br><br>  Puisque le projet est petit, vous ne devez pas compter sur beaucoup de fautes de frappe et d'endroits suspects.  Regardons ce qui a √©t√© trouv√© et essayons m√™me de reproduire quelque chose en pratique. <br><br><h2>  Lunettes et plus </h2><br>  Rencontr√© la m√©thode suivante: <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_value == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.String; }</code> </pre> <br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3108</a> Il n'est pas recommand√© de renvoyer 'null' √† partir de la m√©thode 'ToSting ()'.  Variant.cs 1519 <br><br>  Oui, renvoyer <i>null √†</i> partir d'une m√©thode <i>ToString ()</i> substitu√©e n'est pas une erreur en soi, mais c'est quand m√™me un mauvais style.  Cela est indiqu√©, entre autres, dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation de Microsoft</a> : <i>Votre remplacement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i>ToString ()</i></a> ne doit pas retourner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i>Empty</i></a> ou une cha√Æne nulle</i> .  Les d√©veloppeurs qui n'attendent pas de retour <i>nul</i> comme valeur de retour de <i>ToString ()</i> peuvent √™tre d√©sagr√©ablement surpris lorsqu'une <i>ArgumentNullException est</i> lev√©e lors de l'ex√©cution du code ci-dessous (√† condition que la m√©thode d'extension soit appel√©e pour <i>IEnumerable &lt;T&gt;</i> ). <br><br><pre> <code class="cs hljs">Variant varObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Variant(); varObj.ToString().Contains(character);</code> </pre> <br>  Vous pouvez trouver √† redire au fait que l'exemple est synth√©tique, mais l'essence de cela ne change pas. <br><br>  De plus, ce code est comment√© comme suit: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Returns </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="String"/&gt;</span></span></span><span class="hljs-comment"> property unless the value on the right </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> is null. If the value on the right is null, returns "". </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;returns&gt;</span></span></span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/returns&gt;</span></span></span></span></code> </pre> <br>  Oups  Au lieu de "" retourne <i>null</i> . <br><br>  Continuons. <br><br>  Il existe une classe <i>FastString</i> dans la <i>biblioth√®que</i> .  Description: <i>Alternative rapide de StringBuilder</i> .  En fait, cette classe contient un champ de type <i>StringBuilder</i> .  Les constructeurs de la classe <i>FastString</i> appellent la m√©thode <i>Init</i> , qui initialise le champ correspondant. <br><br>  Le code de l'un des constructeurs: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FastString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Init(initCapacity); }</code> </pre> <br>  Et le code de la m√©thode <i>Init</i> : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> iniCapacity</span></span></span><span class="hljs-function">)</span></span> { sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(iniCapacity); <span class="hljs-comment"><span class="hljs-comment">//chars = new char[iniCapacity]; //capacity = iniCapacity; }</span></span></code> </pre> <br>  Si vous le souhaitez, vous pouvez acc√©der au champ <i>sb</i> via la propri√©t√© <i>StringBuilder</i> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> StringBuilder StringBuilder { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb; } }</code> </pre> <br>  Au total, <i>FastString</i> a 3 constructeurs: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FastString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FastString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> iniCapacity</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FastString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> initValue</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br>  J'ai d√©j√† montr√© au corps du premier designer qu'ils font les deux suppositions restantes, je pense, n'est pas non plus difficile.  Et maintenant, attention.  Devinez ce que le code suivant produira: <br><br><pre> <code class="cs hljs">FastString fs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FastString(<span class="hljs-number"><span class="hljs-number">256</span></span>); Console.WriteLine(fs.StringBuilder.Capacity);</code> </pre> <br>  Attention, la r√©ponse: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b5c/e6f/c54/b5ce6fc542490a9d10c0d7596d5b354c.png" alt="Image 2"></p><br>  De fa√ßon inattendue?  Regardons le corps du constructeur correspondant: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FastString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> iniCapacity</span></span></span><span class="hljs-function">)</span></span> { Init(initCapacity); }</code> </pre> <br>  Les lecteurs r√©guliers de nos articles devraient d√©j√† avoir un ≈ìil pour trouver un probl√®me ici.  L'analyseur oculaire (parfum, logique, appelez-le comme vous voulez) est d√©finitivement engourdi, et il a trouv√© un probl√®me: le param√®tre de constructeur V3117 'iniCapacity' n'est pas utilis√©.  FastString.cs 434 <br><br>  Quelle co√Øncidence si le code de classe contient un champ constant <i>initCapacity</i> , qui est pass√© en argument √† la m√©thode <i>Init</i> au lieu du param√®tre constructeur <i>iniCapacity</i> ... <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> initCapacity = <span class="hljs-number"><span class="hljs-number">32</span></span>;</code> </pre> <br>  Lorsque vous utilisez des noms similaires, vous devez √™tre tr√®s, tr√®s prudent.  Partout o√π des erreurs ont √©t√© commises concernant l'utilisation de noms similaires - projets en C, C ++, C #, Java - il y avait des fautes de ce type partout ... <br><br>  Soit dit en passant, sur les fautes de frappe. <br><br>  Faisons l'exemple simple suivant et voyons comment cela fonctionne: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { TextObject textObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextObject(); textObj.ParagraphFormat = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Ok"</span></span>); }</code> </pre> <br>  Comme vous l'avez peut-√™tre devin√©, la sortie sera diff√©rente de la cha√Æne ¬´Ok¬ª :) <br><br>  Lequel?  Ainsi, par exemple: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/658/a69/551/658a6955138c038413502033c79ebbbe.png" alt="Image 1"></p><br>  Le probl√®me r√©side dans la propri√©t√© <i>ParagraphFormat</i> et dans l'utilisation de noms similaires: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ParagraphFormat ParagraphFormat { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> paragraphFormat; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { ParagraphFormat = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3110</a> Possible r√©cursion infinie √† l'int√©rieur de la propri√©t√© 'ParagraphFormat'.  TextObject.cs 281 <br><br>  La propri√©t√© <i>ParagraphFormat</i> est un wrapper sur le champ <i>paragraphFormat</i> .  De plus, son accesseur de propri√©t√© get est orthographi√© correctement, mais l'accesseur de propri√©t√© set contient une faute de frappe: au lieu du champ, l'enregistrement se produit dans la m√™me propri√©t√©, ce qui provoque une r√©cursivit√©.  Encore une fois, une erreur li√©e √† des noms similaires. <br><br>  Consid√©rez l'extrait de code suivant. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Run </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Split</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> availableWidth, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Run secondPart</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (r.Width &gt; availableWidth) { List&lt;CharWithIndex&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;CharWithIndex&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = point; i &lt; size; i++) list.Add(chars[i]); secondPart = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RunText(renderer, word, style, list, left + r.Width, charIndex); list.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; point; i++) list.Add(chars[i]); r = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RunText(renderer, word, style, list, left, charIndex); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { List&lt;CharWithIndex&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;CharWithIndex&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = point; i &lt; size; i++) list.Add(chars[i]); secondPart = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RunText(renderer, word, style, list, left + r.Width, charIndex); list.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; point; i++) list.Add(chars[i]); r = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RunText(renderer, word, style, list, left, charIndex); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r; } .... }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3004</a> L' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instruction</a> 'then' est √©quivalente √† l'instruction 'else'.  HtmlTextRenderer.cs 2092 <br><br>  Un petit copier-coller, et maintenant, quelle que soit la valeur de l'expression <i>r.Width&gt; availableWidth</i> , les m√™mes actions seront effectu√©es.  Supprimez l' <i>instruction if</i> ou modifiez la logique dans l'une des branches. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExpression</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">FindTextArgs args, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> skipStrings</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (args.StartIndex &lt; args.Text.Length) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!FindMatchingBrackets(args, skipStrings)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> args.FoundText; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }</code> </pre> <br>  <b>Avertissement de l'analyseur</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3020</a> Un ¬´retour¬ª inconditionnel dans une boucle.  CodeUtils.cs 262 <br><br>  En raison de l' <i>instruction de retour</i> inconditionnelle <i>,</i> pas plus d'une it√©ration sera ex√©cut√©e pour la boucle ci-dessus.  Peut-√™tre que ce code est sorti apr√®s refactoring, ou peut-√™tre que c'est juste une fa√ßon inhabituelle de faire ce qui pourrait √™tre fait sans boucle. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindBarItem</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> c</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; tabelle_cb.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == tabelle_cb[i].c) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPattern</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> result = tabelle_cb[FindBarItem(<span class="hljs-string"><span class="hljs-string">"A"</span></span>)].data + <span class="hljs-string"><span class="hljs-string">"0"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> text) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> idx = FindBarItem(c.ToString()); result += tabelle_cb[idx].data + <span class="hljs-string"><span class="hljs-string">"0"</span></span>; } result += tabelle_cb[FindBarItem(<span class="hljs-string"><span class="hljs-string">"B"</span></span>)].data; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3106</a> Valeur d'index n√©gative possible.  La valeur de l'indice 'idx' pourrait atteindre -1.  BarcodeCodabar.cs 70 <br><br>  Code potentiellement dangereux.  La m√©thode <i>FindBarItem</i> peut renvoyer <i>-1</i> si elle ne trouve pas l'√©l√©ment pass√© en tant que param√®tre.  Dans le code appelant (m√©thode <i>GetPattern</i> ), cette valeur est √©crite dans la variable <i>idx</i> et est utilis√©e comme index du tableau <i>tabelle_cb</i> sans v√©rification pr√©alable.  Lors de l'acc√®s √† l'index <i>-1, une</i> exception de type <i>IndexOutOfRangeException</i> sera <i>lev√©e</i> . <br><br>  Continuons. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Finish</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (saveStreams) { FinishSaveStreams(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (singlePage) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (saveStreams) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fileIndex = GeneratedFiles.IndexOf(singlePageFileName); DoPageEnd(generatedStreams[fileIndex]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... } .... } .... } .... }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> Expression 'saveStreams' est toujours faux.  HTMLExport.cs 849 <br><br>  Le code ci-dessus avec l'obtention de la valeur <i>fileIndex</i> et l'appel de la m√©thode <i>DoPageEnd</i> ne <i>sera</i> jamais ex√©cut√©, car le r√©sultat de la deuxi√®me expression <i>saveStreams</i> dans le code sera toujours <i>faux</i> . <br><br>  Des plus int√©ressants, c'est peut-√™tre tout (vous ne vous attendiez pas √† un article dans l'esprit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de l'analyse Mono</a> ?).  Il y avait d'autres avertissements de l'analyseur, mais ils ne me semblaient pas assez int√©ressants pour les inclure dans l'article (une partie reste toujours en coulisses). <br><br>  Conna√Ætre la conception serait utile pour leur analyse, donc id√©alement, les auteurs devraient examiner ces avertissements par eux-m√™mes.  Ce sont des avertissements tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3083</a> (un appel potentiellement dangereux aux gestionnaires d'√©v√©nements), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3022</a> (la condition est toujours vraie / fausse (dans ce cas, souvent en raison de m√©thodes qui renvoient une seule valeur)), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3072</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V3073</a> (travaillant avec <i>IDisposable</i> ) et autres. <br><br>  Si tout cela n'est pas pertinent, vous pouvez: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©sactiver les diagnostics</a> si le motif d√©tect√© par celui-ci est pr√©cis√©ment correct sur le projet; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">marquer les avertissements comme de fausses alarmes</a> s'il n'y en a pas beaucoup; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ajoutez des avertissements √† la base de donn√©es de suppression</a> si vous ne souhaitez pas ins√©rer de commentaires dans le code.  Mais alors l'acc√®s √† la base de suppression sera n√©cessaire pour tous ceux qui travaillent avec l'analyseur. </li></ul><br><h2>  Conclusion </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f9f/6c9/11d/f9f6c911df453cc009855322f4c9632f.png" alt="Image 4"></p><br>  Malgr√© le fait que l'article √©tait court, j'ai √©t√© ravi de ¬´toucher¬ª les avertissements de l'analyseur avec mes mains - pour voir comment ce que jure l'analyseur se manifeste dans la pratique. <br><br>  Je souhaite aux auteurs du projet de r√©ussir, de corriger les probl√®mes d√©couverts, et je veux saluer un pas vers la communaut√© open-source! <br><br>  Je conseille aux autres d'essayer l'analyseur sur votre code et de voir ce que vous pouvez trouver int√©ressant. <br><br>  Meilleurs v≈ìux! <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Sergey Vasiliev.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les rapports les plus rapides du Far West - et une poign√©e de bugs ...</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr431370/">https://habr.com/ru/post/fr431370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr431348/index.html">Anycubic Photon: un mini-aper√ßu d'une imprimante 3D photopolym√®re peu co√ªteuse</a></li>
<li><a href="../fr431350/index.html">Plans de d√©veloppement du processeur √©lectronique Ba√Økal</a></li>
<li><a href="../fr431354/index.html">Le premier codec vid√©o d'apprentissage automatique a consid√©rablement surpass√© tous les codecs existants, y compris H.265 et VP9</a></li>
<li><a href="../fr431360/index.html">Expliquez la porte d√©rob√©e dans le flux d'√©v√©nements</a></li>
<li><a href="../fr431362/index.html">Comment un designer peut-il se d√©barrasser de la routine et garder son int√©r√™t pour son travail?</a></li>
<li><a href="../fr431372/index.html">Interruptions √† partir de p√©riph√©riques externes dans un syst√®me x86. Partie 2. Options de d√©marrage du noyau Linux</a></li>
<li><a href="../fr431374/index.html">Jugement dernier: analyse des indicateurs financiers du jeu en acc√®s anticip√©</a></li>
<li><a href="../fr431376/index.html">Migration des donn√©es dans l'entreprise sanglante: quoi analyser pour ne pas submerger le projet</a></li>
<li><a href="../fr431378/index.html">Toute la v√©rit√© sur RTOS. Article # 23. Files d'attente: introduction et services de base</a></li>
<li><a href="../fr431380/index.html">Mitap Netologiya et Skyeng √† propos des comp√©tences g√©n√©rales ¬´Ce qu'un d√©veloppeur doit savoir, sauf le code¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>