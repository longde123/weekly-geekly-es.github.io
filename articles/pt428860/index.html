<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôã üõéÔ∏è üö¥üèº Confer√™ncia DEFCON 17. Ria dos seus v√≠rus! Parte 2 ‚úåüèæ üõåüèº üë©üèæ‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Confer√™ncia DEFCON 17. Ria dos seus v√≠rus! Parte 1 

 Em seguida, voc√™ pode carreg√°-lo no IDA e ver que tudo na tabela de endere√ßos importados parece ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Confer√™ncia DEFCON 17. Ria dos seus v√≠rus! Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/428860/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Confer√™ncia DEFCON 17. Ria dos seus v√≠rus!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> <br><br>  Em seguida, voc√™ pode carreg√°-lo no IDA e ver que tudo na tabela de endere√ßos importados parece bem, e podemos seguir os links cruzados para definir o ponteiro para o arquivo desejado.  Portanto, chegamos ao local exato do c√≥digo de criptografia dependente. <br><br><img src="https://habrastorage.org/webt/ja/31/xh/ja31xhgboctds-lmvejfwiycixc.jpeg"><br><br>  Assim, com apenas alguns comandos para despejar mem√≥ria, encontramos o local onde o Coreflood se escondia.  Desmontamos, recuperamos e inserimos o cabe√ßalho PE sem o ter, e obtivemos uma tabela de endere√ßos totalmente restaurada em menos de 20 segundos. <br><br>  A pr√≥xima hist√≥ria se chama "Querida, desculpe incomod√°-lo novamente. Estou comovido pela Internet!"  Esta hist√≥ria nos diz que o gerador de IP com defeito Conficker.B varre apenas parte da Internet.  Aqui voltamos novamente √† fun√ß√£o rand.  Uma parte importante dessa fun√ß√£o √© a √∫ltima instru√ß√£o que marquei com uma seta verde - ela executa qualquer valor final no EAX com um valor de 7FFF.  Se voc√™ n√£o conhece os princ√≠pios de montagem e n√£o sabe o que essas instru√ß√µes podem fazer, ent√£o aqui est√° uma pequena demonstra√ß√£o sobre isso. <br><br><img src="https://habrastorage.org/webt/a8/dh/lj/a8dhljmvnb6hrmu1hrhyosfityw.jpeg"><a name="habracut"></a><br><br>  Movemos o valor m√°ximo que o EAX pode conter para esse registro e executamos a instru√ß√£o final.  Voc√™ pode ver que "corta" a metade superior do valor e subtrai 7FFF, que √© convertido para 32767 no sistema decimal.Parentemente, os autores n√£o perceberam que essa restri√ß√£o que executa o Windows n√£o retorna ao n√∫mero inteiro o tamanho desejado .  Ele o "corta" para que o valor n√£o exceda 7FFF, para que um byte de 7F nunca seja maior que esse valor de 7F, ou seja, nunca ser√° igual a 80 ou algo assim. <br><br>  No lado esquerdo do slide, que chamei de "M√©todo vicioso", voc√™ v√™ o c√≥digo Conficker.B.  Isso mostra uma chamada para rand que inicia o primeiro octeto do endere√ßo IP, que deve ser verificado ap√≥s o retorno do rand.  A seguinte chamada do sistema rand inicia o terceiro e o quarto octetos do endere√ßo IP, mas, devido ao exposto acima, dois desses octetos nunca ser√£o maiores que 7F.  Assim, a maior parte da Internet n√£o poder√° ser verificada porque o Conficker.B usa esse algoritmo. <br><br>  No lado direito do slide est√° a parte do c√≥digo-fonte que mostra o montador.  √â dif√≠cil ler na tela, mas este exemplo est√° dispon√≠vel ao p√∫blico e voc√™ pode l√™-lo online, se estiver interessado. <br><br><img src="https://habrastorage.org/webt/5u/oj/tb/5uojtbhnvqiisohatadjziviyw8.jpeg"><br><br>  Um link para esta ferramenta est√° localizado na parte inferior do pr√≥ximo slide, intitulado "Simula√ß√£o do m√©todo vicioso".  Voc√™ tamb√©m pode ver que o endere√ßo IP √© gerado com PRNG, mas n√£o verificado. <br><br><img src="https://habrastorage.org/webt/7f/bd/vf/7fbdvfj000swmtbqwf7sdddjz3o.jpeg"><br><br>  Quero agradecer muito a Brandon Enright, que fez a programa√ß√£o no pr√≥ximo slide.  Esse gr√°fico √© chamado de "curva de Hilbert" e agora aumentarei a imagem para que voc√™ possa ver melhor na tela.  A cor azul no gr√°fico indica o intervalo de endere√ßos IP que n√£o est√£o dispon√≠veis para varredura pelo Conficker.B usando esse algoritmo vicioso.  A cor vermelha escura indica o que pode ser digitalizado.  Voc√™ percebe que a maioria das partes do gr√°fico n√£o √© vermelha escura, mas roxa, e n√£o ver√° por que isso acontece at√© aumentar o ret√¢ngulo correspondente. <br><br><img src="https://habrastorage.org/webt/h0/-y/ar/h0-yarvdaqxrhr0a078wmwxmj-c.jpeg"><br><br>  Mesmo nesse ret√¢ngulo ampliado, em cada bloco / 16, voc√™ v√™ muitos fragmentos azuis que se tornam vermelho escuro em roxo.  Essas s√£o as partes dos endere√ßos que o Conficker.B n√£o pode digitalizar. <br><br><img src="https://habrastorage.org/webt/jv/z0/gb/jvz0gbqxngvlelc8vzavmvgmulk.jpeg"><br><br>  Isso √© bastante interessante porque muitas pessoas t√™m certeza de que o Conficker.B criou "grandes mentes".  Talvez seja, mas essas mentes n√£o estavam cientes das limita√ß√µes existentes no Windows rand (). <br><br>  <b>Matthew Richard:</b> voltando √†queles caras que, como eu disse, n√£o gerenciam muito bem seus v√≠rus, ent√£o no cibercrime isso √© semelhante ao prov√©rbio ‚Äúhumano para humano lobo‚Äù, ent√£o esses caras n√£o s√£o respeitados em seus c√≠rculos. <br><br>  Vamos falar sobre as ferramentas de hackers Neosploit, que "pegaram" todo mundo.  Podemos dizer que o lema de seus desenvolvedores era "Obrigado pelo dinheiro, agora √© hora de correr".  O Neosploit √© um kit de ferramentas para organizar ataques na Web, para que os caras do cibercrime o comprem e o configurem contra os do servidor, invadam o servidor, cortam o servidor, baixam c√≥digos etc. <br><br><img src="https://habrastorage.org/webt/ri/s1/bf/ris1bfmqjh1vrnr2a7hohfm13hg.jpeg"><br><br>  Os criadores do Neosploit fizeram um bom investimento vendendo sua ferramenta, mas n√£o permitindo que ela fosse alterada, modificada ou usada em partes.  A terceira vers√£o deste kit de ferramentas foi lan√ßada em abril de 2008 e a maioria das explora√ß√µes exclusivas √© escrita em C; portanto, n√£o √© PHP ou algum tipo de aplicativo da Web de baixa qualidade.  Os clientes receberam uma distribui√ß√£o bin√°ria com um conjunto de explora√ß√µes CGI. <br><br>  O Neosploit possui recursos que impedem os clientes de dividir ou aparar explora√ß√µes.  Para fazer isso, todas as explora√ß√µes foram apresentadas em formato bin√°rio, criptografado usando o XOR.  Os criadores fizeram isso para que ningu√©m pudesse cortar, colar e criar seu pr√≥prio conjunto de explora√ß√µes com base no Neosploit.  Existem 40-50-60 tipos diferentes de ataques na Web, que s√£o baseados em c√≥digos roubados e copiados inseridos em suas pr√≥prias explora√ß√µes; portanto, o pessoal do Neosploit √© um pouco mais inteligente ao criptografar suas explora√ß√µes por dentro.  Na captura de tela, voc√™ v√™ que eles t√™m um arquivo com a chave neosploit.key, portanto, este √© um software totalmente licenciado. <br><br><img src="https://habrastorage.org/webt/fn/uj/zq/fnujzqvxmuxcczupacqnibg2udq.jpeg"><br><br>  N√£o tenho d√∫vidas de que eles tinham um monte de bons clientes que ganharam muito dinheiro com isso.  Seus clientes mais famosos eram Torpig.  Acho que voc√™ j√° ouviu falar do rootkit Mebroot, com o qual eles comprometeram os sistemas a criar uma rede botnet.  Mas os criadores do Neosploit tinham muitos outros clientes.  Em maio de 2008, eles lan√ßaram uma nova melhoria - a 3¬™ vers√£o de seu kit de ferramentas.  Os clientes foram solicitados a pagar antecipadamente o pacote de explora√ß√£o com todas as atualiza√ß√µes subsequentes por US $ 1000.  Mais tarde, falarei sobre isso com mais detalhes, pois agora notarei que eles realmente se preocuparam com os piratas e tentaram proteger seu produto deles o m√°ximo poss√≠vel, por isso foi definitivamente muito divertido. <br><br><img src="https://habrastorage.org/webt/ri/o0/gq/rio0gq0dwfkuxt4cvuiu8agdafs.jpeg"><br><br>  At√© a m√≠dia escreveu que essas fa√ßanhas est√£o por toda parte.  Ent√£o, √© claro, tentaremos desmontar o c√≥digo e mostrar como o Neosploit funciona. <br><br>  A primeira coisa engra√ßada que eles fizeram, depois de promoverem intensamente esse conjunto de explora√ß√µes de abril a julho, foi o apoio de 20 de julho de 2008. A explica√ß√£o que eles simplesmente postaram em seu site disse o seguinte: ‚ÄúInfelizmente Suporte adicional ao produto n√£o √© vi√°vel.  Pedimos desculpas pelo inconveniente, mas neg√≥cios s√£o neg√≥cios, e o tempo gasto no projeto n√£o se justificou.  Nos √∫ltimos meses, tentamos ao m√°ximo satisfazer os requisitos do cliente, mas um dia o suporte deveria ter cessado.  Estamos com voc√™ h√° um ano e meio e esperamos que este n√£o seja o pior momento para o seu neg√≥cio.  Agora n√£o estaremos perto de voc√™, mas, no entanto, desejamos que sua empresa flores√ßa por muito tempo. ‚Äù  Em geral, recebemos o seu dinheiro, voc√™ pagou pela assinatura, portanto seja saud√°vel! <br><br>  No entanto, eles simplesmente brincaram e, em agosto de 2008, retornaram e lan√ßaram uma vers√£o completamente nova 3.1, que eles forneceram a seus principais clientes, indicando que todos os outros clientes receber√£o uma atualiza√ß√£o depois de pagarem por isso.  Esta atualiza√ß√£o incluiu v√°rias novas explora√ß√µes para Adobe PDF, Shockwave Flash e Quicktime para Firefox. <br><br>  Ent√£o eles decidiram novamente ser s√©rios e anunciaram que estavam realmente parando de lan√ßar atualiza√ß√µes, para que todos que fizessem uma assinatura pr√©-paga estragassem tudo. <br><br>  Ent√£o, vamos ao Neosploit, este kit muito legal para organizar ataques na Web.  Como seus desenvolvedores lutaram contra piratas e roubaram explora√ß√µes que podiam ser copiadas e coladas nos kits de outras pessoas, eles pegaram cada explora√ß√£o e a colocaram em um arquivo CGI, codificando de tal maneira que era muito dif√≠cil tir√°-la de l√°.  Os bin√°rios de explora√ß√£o C eram ligeiramente diferentes dos scripts PHP. <br><br><img src="https://habrastorage.org/webt/ng/sh/fy/ngshfybrz6rq6bop8mraqqh2zzo.jpeg"><br><br>  No blog Neosploit, foi postada a frase de Dancho Danchev de que "qualquer um pode criar uma nova explora√ß√£o", mas √© bastante dif√≠cil.  Decidi descobrir o qu√£o dif√≠cil era e comecei a desmontar uma das fa√ßanhas. <br><br>  Cada explora√ß√£o foi armazenada em forma criptografada usando uma chave XOR de 3 bytes.  Para cada solicita√ß√£o recebida, a explora√ß√£o era descriptografada e fornecida ao usu√°rio para o trabalho, e esse ciclo era repetido constantemente. <br><br><img src="https://habrastorage.org/webt/ej/xa/xr/ejxaxrxb3favuqswsknbhqvzqxk.jpeg"><br><br>  Portanto, mesmo que voc√™ possa percorrer a mem√≥ria e remover o despejo de mem√≥ria, ainda √© bastante dif√≠cil e obter todas as explora√ß√µes, mesmo assim, esses buffers s√£o limpos sempre. <br><br>  Felizmente, se voc√™ pode copiar e colar essas explora√ß√µes no programa que precisa, pode encontrar a resposta.  Para isso, √© usada uma ferramenta de descriptografia muito poderosa - o script IDA.  Com ele, voc√™ pode comentar ou despejar uma √°rea de mem√≥ria espec√≠fica, atualizar explora√ß√µes, pode ser √∫til para trabalhar com malware que usa sequ√™ncias complicadas por xor, base64 etc.  Escrevi um script IDE com o qual tentei desmontar um despejo de mem√≥ria capturado de uma explora√ß√£o criptografada. <br><br><img src="https://habrastorage.org/webt/ph/lh/04/phlh04jr_lkm9h6ammkwchmc5fs.jpeg"><br><br>  Ele percorre todos os objetos criptografados, pesquisa todas as chamadas para as fun√ß√µes de descriptografia, captura os objetos criptografados, descriptografa-os usando o XOR e remove o despejo.  Essa √© uma maneira, mas acho que voc√™ poderia escrever seu pr√≥prio script, um aplicativo que faz o mesmo.  Se voc√™ sabe como adicionar novas explora√ß√µes ao Neosploit, pode fazer algo nessa dire√ß√£o e, √© claro, assim que remover o despejo, voc√™ reconhecer√° todo o texto simples, poder√° "separ√°-lo" da instrumenta√ß√£o e revend√™-lo.  Os novos caras que desenvolviam as fa√ßanhas simplesmente desistiram porque algu√©m ganhava muito dinheiro sem cuidar de seus clientes. <br><br>  Se algu√©m ouviu o grande fil√≥sofo do hip-hop Biggie Smalls, do Notorius BIG, ent√£o ele conhece sua m√∫sica chamada Dez mandamentos do crack, "Os dez mandamentos do crack", que cont√©m grande sabedoria.  Se voc√™ √© um traficante de drogas, siga o 4 mandamento: "Nunca se sente por conta pr√≥pria que voc√™ empurra".  Provavelmente, o cara que eu chamei de Peeper e que distribuiu seu pr√≥prio c√≥digo malicioso nunca ouviu essa m√∫sica porque testou seu produto em si mesmo. <br><br>  Seu ataque foi o seguinte.  Ele enviou e-mails, disfar√ßados de v√°rias ag√™ncias governamentais e dirigiu-se √†s pessoas com o nome: "Querido, algu√©m apresentou uma queixa contra sua empresa na Federal Trade Commission, ent√£o clique aqui para baixar um documento que descreve a ess√™ncia em detalhes" . <br><br><img src="https://habrastorage.org/webt/pd/3e/jk/pd3ejkz0sqnukrbmaqwfa7dpcnc.jpeg"><br><br>  Em seguida, o usu√°rio seguiu o link e tentou fazer o download deste documento, e realmente era um documento do Word no formato .doc.  No entanto, havia um recurso muito complicado.  Voc√™ teve a oportunidade de simplesmente arrastar e soltar arquivos execut√°veis ‚Äã‚Äãde um documento do Word e renome√°-los, mas quando tentou fazer o download do arquivo, a mensagem ‚ÄúMicrosoft Word detectou um problema e o documento n√£o p√¥de ser baixado.  Por favor, clique duas vezes no √≠cone do documento para continuar. "  Ideia impressionante! <br><br><img src="https://habrastorage.org/webt/ej/5h/dq/ej5hdqstxn-ym3rh6ymrgjgdimo.jpeg"><br><br>  Naturalmente, as pessoas clicaram, clicaram 6 vezes para receber esta mensagem infectada, ent√£o esse cara teve v√°rias v√≠timas.  Gostei da mensagem: "Eles tentaram me enganar, bl√° bl√° bl√°". <br><br>  A pr√≥xima coisa que descobrimos ao rastrear esse cara foram os diret√≥rios abertos do Drop Directory, onde ele descartou as informa√ß√µes que recebeu. <br><br><img src="https://habrastorage.org/webt/-y/cf/f-/-ycff-c-idisj5uxijtbakrzvdu.jpeg"><br><br>  Talvez ele n√£o tivesse suas pr√≥prias ferramentas para gerenci√°-los, ou pensava que os diret√≥rios abertos s√£o uma coisa boa, mas os diret√≥rios abertos s√£o ruins se voc√™ armazenar muitas informa√ß√µes recebidas de pessoas diferentes.  Qualquer servidor que ele configurasse para o site de "desembarque" tinha um diret√≥rio aberto, e voc√™ poderia simplesmente entrar l√° e ver as listas de todas as v√≠timas e cada uma individualmente. <br><br>  De certa forma, ele era um bom desenvolvedor porque escreveu c√≥digo de qualidade.  Mas sua desvantagem foi que, ao endere√ßar seu c√≥digo para um servidor ativo, ele usou seu endere√ßo IP real e voc√™ n√£o vai durar muito tempo usando essas coisas. <br><br><img src="https://habrastorage.org/webt/zz/jc/rq/zzjcrqpcs9r8e3bc-271cp3vroi.jpeg"><br><br>  Ent√£o, na verdade, ele tinha um modem DSL padr√£o que entrou em contato com a Ucr√¢nia, testou todo o seu c√≥digo e malware, que tem uma boa fun√ß√£o chamada "siga-me" ou "siga-o".  Esse cara estava ocupado roubando informa√ß√µes banc√°rias, mas √†s vezes ele s√≥ queria assistir suas v√≠timas para ver o que estavam fazendo, por isso o chamamos de Peeper, ou "Observador".  Ele n√£o estava satisfeito com a funcionalidade simples de seu software, ele come√ßou a se monitorar.  Parece um pouco estranho, como se voc√™ abrisse as janelas de acesso remoto VNC no seu pr√≥prio computador e as contornasse, obtendo imagens cada vez menores.  De fato, ele fez isso muitas vezes, em muitos servidores "de desembarque", de fato, foi muito, muito estranho.  Assim, olhando atrav√©s desses servidores "de desembarque", pode-se dizer: "Oh, veja, esta √© uma imagem em que ele est√° se observando, se observando, quem est√° se observando". <br><br><img src="https://habrastorage.org/webt/tu/v1/6v/tuv16vk5cws25lqpqr0lymirwto.jpeg"><br><br>  "Minha luz, espelho, diga-me, quem √© o mais doce do mundo"? <br><br>  Acima de tudo, gostei do que ele fez por si mesmo.  Ele usou esse recurso Siga-me no processo de desenvolvimento de c√≥digo.  De fato, ele escreveu o c√≥digo, observando-se, enviando tudo isso de volta ao servidor de comando e controle.  Assim, ele possibilitou que os policiais invadissem a porta dos fundos, deitassem o rosto no ch√£o e confiscassem seu computador.  Em resumo, nada ajuda a se livrar de voc√™ como a imagem de uma √°rvore de origem anexada ao seu endere√ßo IP. <br><br><img src="https://habrastorage.org/webt/q0/ic/f9/q0icf9sq3191sbbcj2jk27t5eiw.jpeg"><br><br>  O √∫ltimo malware que iremos analisar certamente interessar√° as pessoas familiarizadas com o Internet Explorer 7. Mas n√£o se preocupe, a Microsoft diz que tudo est√° sob controle, confie nelas! <br><br><img src="https://habrastorage.org/webt/dw/7r/2f/dw7r2f9zbestlmksm14of1q72dc.jpeg"><br><br>  Portanto, a Microsoft teve um grande problema com o Internet Explorer 6, devido ao fato de ser muito f√°cil roubar senhas salvas deste navegador.  Normalmente voc√™ vai ao site, eles perguntam se voc√™ deseja salvar a senha, um formul√°rio especial √© chamado, voc√™ responde "sim" e √© salvo no registro.  O problema com o IE 6 era que, se voc√™ efetuar login como usu√°rio, precisar√° fazer apenas uma chamada do sistema CryptUnprotectData () para descriptografar essas senhas que realmente n√£o t√™m prote√ß√£o. <br><br>  Portanto, o malware em execu√ß√£o com privil√©gios de usu√°rio l√™ essas senhas livremente e as envia ao invasor.  Portanto, no IE 7, eles instalaram um excelente "patch" - as senhas foram criptografadas com uma chave de 128 bits.  Realmente n√£o √© uma solu√ß√£o quebr√°vel! <br>  Se voc√™ olhar mais fundo, poder√° ver o hash dispon√≠vel no site, explicarei isso um pouco mais tarde, no qual h√° um arquivo bin√°rio contendo o nome de usu√°rio e a senha.  Quero citar outro grande fil√≥sofo, John Travolta, do filme Swordfish.  Minha passagem favorita √© quando ele fica sentado e explica: "Esse c√≥digo √© t√£o bom que nem eu consigo decifr√°-lo".  Acho que ele tinha em mente a criptografia de 512 bits e ele, o melhor criptografador do mundo, por que foi contratado, diz que nem ele pode faz√™-lo. <br><br>  Ent√£o aqui est√° o que a Microsoft fez.  Eles criptografam a senha, para a qual geram uma chave de 128 bits com base no hash MD5 do site para o qual salvam essa senha.  Isso parece bastante razo√°vel; portanto, se voc√™ acessar <a href="">www.bank.com/login.sp</a> , eles usar√£o esta linha, deixar√£o todas as letras em min√∫sculas, depois as codificar√£o em caracteres grandes e usar√£o o algoritmo MD5, transformando essa linha em uma chave que ser√° usado para criptografar a senha no registro para o nome de usu√°rio. <br><br>  Ent√£o, quando voc√™ visita este site para o qual existe uma senha salva, eles fazem o oposto: o IE normaliza a URL, transcodifica a string e verifica o registro para verificar se existem valores armazenados para voc√™.  Em detalhes, acontece assim: <br><br><ul><li>  leia o hash do registro para cada URL em index.dat; </li><li>  URL √© convertido para min√∫sculas; </li><li>  Os par√¢metros GET s√£o reduzidos; </li><li>  URL √© convertido em caracteres grandes; </li><li>  se o hash do valor da URL for igual a qualquer valor no registro, os dados ser√£o descriptografados usando esta URL. </li></ul><br>  Isso parece bastante razo√°vel, mas se voc√™ pensar bem, h√° um pequeno problema.  De fato, h√° muito pouca entropia, e o hacker pode lidar facilmente com isso.  Isso n√£o √© muito mais complicado do que a criptografia de senha no IE 6. <br><br>  Hackear √© bem simples.  Para salvar a senha, o usu√°rio deve visitar o site, que pode ser facilmente encontrado em index.dat ou na se√ß√£o de chave de registro ‚ÄúTypedURLS‚Äù.  Se considerarmos apenas os Estados Unidos, existem cerca de 15.000 sites de bancos e cooperativas de cr√©dito, e voc√™ pode encontr√°-los facilmente.  Voc√™ conhece os sites para os quais deseja encontrar senhas e cada um desses sites tem p√°ginas de login, portanto, √© f√°cil reunir uma cole√ß√£o inteira de chaves.  Como voc√™ pode ver, a prote√ß√£o aqui √© claramente insuficiente. <br><br>  √â claro que, se voc√™ √© um cara mau, provavelmente conhece muitos sites que precisam de senhas: Facebook, Myspace ou Twitter ou outros com uma p√°gina de login, para que possa descobrir esses sites.  Voc√™ pode usar o servi√ßo Alexa, que mant√©m uma lista dos sites mais populares, coletando estat√≠sticas sobre o tr√°fego.  As chaves s√£o realmente f√°ceis de descriptografar, voc√™ pode fazer algo como uma ‚ÄúTabela Arco-√çris‚Äù com base nessas fontes comuns e, em seguida, voc√™ ter√° todas as chaves para descriptografar senhas. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para os bandidos, √© bem simples, ent√£o a moral da hist√≥ria com o IE 7 √© a seguinte: n√£o √© t√£o boa quanto seus desenvolvedores est√£o tentando garantir. </font></font><br><br>      ?  , .       .       ,  Mozilla Firefox,  ,           .      ,      ,     ,   ¬´Remember My password¬ª.         .      Firefox  IE 7    ,          ,       ,   ,      . <br><br>  ,    ,        ,      . <br><br>       Laqma.   ,       ,     .     -  ,      ,  ,          command and control. <br><br><img src="https://habrastorage.org/webt/ri/uf/c3/riufc3cranwrsexq9e-h98otht4.jpeg"><br><br>     ,     .        ,     ,   PHP -,          PHP    ,    ‚Äì    . <br><br>         . <br><br> <b> :</b> ,    ,    ,    .           ,    .     Laqma,   .  ,              ,  Laqma   ,        .      ,       SSDT,                IDA  - . <br>  ,         Volatility,     .       ,  Laqma,     SSDT ,     ,   .         SSDT,   ,     SSDT,       SSDT. <br><br><img src="https://habrastorage.org/webt/w3/n1/df/w3n1df_7w3g1g1oma3ab8gp-lca.jpeg"><br><br>          TOS,         win32k,         ,      .     SSDT           ,      ,     TOS   win32k. <br><br>     ,   ,     ,  , drv, .sys,              .   ,   .   ,  SSDT    .               . <br><br><img src="https://habrastorage.org/webt/9z/q7/ye/9zq7yepu35kywoygfintms0bq6k.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esse processo √© um pouco automatizado usando o plug-in SSDT. </font><font style="vertical-align: inherit;">Voc√™ v√™ como o BSOD piscou na tela; ele funcionou no programa de linha de comando da IDA. </font><font style="vertical-align: inherit;">Como resultado do processamento autom√°tico, um BID √© criado, isso √© um pouco mais de automa√ß√£o, como resultado das fun√ß√µes do BID correspondentes √†s fun√ß√µes SSDT "conectadas". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assim, com um pequeno passo, aprendemos quais fun√ß√µes do SSDT estavam associadas ao dump que possui o m√≥dulo do BID criado e fomos capazes de nome√°-los para saber exatamente onde procurar no BID quando inicio a engenharia reversa. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que voc√™ tenha se divertido!</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OeG4KBWB-EY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usu√°rios da Habr em um an√°logo exclusivo de servidores b√°sicos que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD de 1Gbps at√© dezembro de gra√ßa</b> quando pagar por um per√≠odo de seis meses, voc√™ pode fazer o pedido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente n√≥s temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt428860/">https://habr.com/ru/post/pt428860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt428850/index.html">Gerenciamento de desenvolvimento em um grande projeto</a></li>
<li><a href="../pt428852/index.html">Transmiss√£o aberta do sal√£o principal HighLoad ++ 2018</a></li>
<li><a href="../pt428854/index.html">Como cortar a luz em um pequeno data center: uma maneira barata de implantar emerg√™ncias</a></li>
<li><a href="../pt428856/index.html">Um truque maravilhoso para tornar um mantenedor de projeto de c√≥digo aberto por dia</a></li>
<li><a href="../pt428858/index.html">Confer√™ncia DEFCON 17. Ria dos seus v√≠rus! Parte 1</a></li>
<li><a href="../pt428864/index.html">Vamos tornar a web √≥tima novamente</a></li>
<li><a href="../pt428866/index.html">7 princ√≠pios de design, atitude em rela√ß√£o √†s tend√™ncias de design, portf√≥lio de designers UX, ...</a></li>
<li><a href="../pt428868/index.html">JARs de v√°rias vers√µes - Ruim ou Bom?</a></li>
<li><a href="../pt428870/index.html">Mrr: FRP total para reagir</a></li>
<li><a href="../pt428872/index.html">A hist√≥ria de um olho e 20 opera√ß√µes (n√£o lidas para impress√£o) ou ele queria ser um piloto, mas ele n√£o era permitido no c√©u</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>