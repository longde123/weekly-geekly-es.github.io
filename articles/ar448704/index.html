<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐จ๏ธ ๐ฆ ุฃุณุฑุฉ ุงูุฃูู: ุนุงูู ุงููููุงุก ๐ ๐ ๐คซ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุญุงููุงุช ููุต ุงูุงุชูุงู ูู ุชูููุฉ ุญุงููุงุช ุงูุฃูุซุฑ ุดุนุจูุฉ. ูู ุงูุจุฏุงูุฉ ุ ุชู ุงุณุชุฎุฏุงูู ุจุดูู ุฃุณุงุณู ูุจูุฆุงุช ุงูุชุทููุฑ ูุงูุงุฎุชุจุงุฑ ุ ูุจูุฑูุฑ ุงูููุช ุชุญููุช ุฅูู ุงูุฅูุชุงุฌ. ุจุฏุฃุช ุญ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฃุณุฑุฉ ุงูุฃูู: ุนุงูู ุงููููุงุก</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acribia/blog/448704/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/8w/2q/ga/8w2qgad0hpcszydr-apdn1uib-8.png"><br><br>  ุญุงููุงุช ููุต ุงูุงุชูุงู ูู ุชูููุฉ ุญุงููุงุช ุงูุฃูุซุฑ ุดุนุจูุฉ.  ูู ุงูุจุฏุงูุฉ ุ ุชู ุงุณุชุฎุฏุงูู ุจุดูู ุฃุณุงุณู ูุจูุฆุงุช ุงูุชุทููุฑ ูุงูุงุฎุชุจุงุฑ ุ ูุจูุฑูุฑ ุงูููุช ุชุญููุช ุฅูู ุงูุฅูุชุงุฌ.  ุจุฏุฃุช ุญุงููุงุช ุงูุฅุฑุณุงุก ูู ุงูุชูุงุซุฑ ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ ุ ูุซู ุงููุทุฑ ุจุนุฏ ุงููุทุฑ ุ ูููู ููุฉ ูู ุฃููุฆู ุงูุฐูู ูุณุชุฎุฏููู ูุฐู ุงูุชูููููุฌูุง ููุฑูุง ูู ููููุฉ ูุดุฑ ุญุงููุงุช ุงูุฅุฑุณุงุก ุจุฃูุงู. <br><br>  ุงุณุชูุงุฏูุง ุฅูู <a href="">OWASP</a> ุ ูููุง ุจุฅุนุฏุงุฏ ูุงุฆูุฉ ูู ุงูููุงุนุฏ ุ ูุงูุชู ุณูุคุฏู ุชูููุฐูุง ุฅูู ุญูุงูุฉ ุจูุฆุชู ุจุดูู ูุจูุฑ ุ ููู ูุจูู ุนูู ุญุงููุงุช Docker. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุนุฏุฉ 0 </h3><h4 style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุญุชูู ุงูุฌูุงุฒ ุงููุถูู ู Docker ุนูู ูุงูุฉ ุงูุชุญุฏูุซุงุช ุงูุญุงููุฉ. </h4><br>  ููุญูุงูุฉ ูู ุงูุซุบุฑุงุช ุงูุฃูููุฉ ุงููุนุฑููุฉ ุงูุชู ุชุคุฏู ุฅูู ุงููุฑูุจ ูู ุจูุฆุฉ ุงูุญุงููุฉ ุฅูู ุงููุธุงู ุงููุถูู ุ ูุงูุชู ุชุคุฏู ุนุงุฏุฉู ุฅูู ุชุตุนูุฏ ุงูุงูุชูุงุฒุงุช ุนูู ุงููุธุงู ุงููุถูู ุ ูุนุฏ ุชุซุจูุช ุฌููุน ุชุตุญูุญุงุช ูุธุงู ุงูุชุดุบูู ุงููุถูู ู Docker Engine ู Docker Machine ูู ุบุงูุฉ ุงูุฃูููุฉ. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุณุชุฎุฏู ุงูุญุงููุงุช (ุนูู ุนูุณ ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ) ุงูููุงุฉ ุจุงูุงูุชุฑุงู ูุน ุงููุถูู ุ ุจุญูุซ ูุชู ุชูููุฐ ุงูููุงุฉ ุงููุณุชุบูุฉ ุงูุชู ุชุนูู ุฏุงุฎู ุงูุญุงููุฉ ูุจุงุดุฑุฉ ูู ุงูููุงุฉ ุงููุถููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุบูุงู ุชุตุนูุฏ ุงูุชูุงุฒ kernel (ูุซู Dirty COW) ุงูุฐู ูุนูู ุฏุงุฎู ุญุงููุฉ ูุนุฒููุฉ ุฌูุฏูุง ุณูุคุฏู ุฅูู ุงููุตูู ุฅูู ุงูุฌุฐุฑ ุนูู ุงููุถูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุนุฏุฉ 1 </h3><h4 style=";text-align:right;direction:rtl">  ูุง ุชุณูุญ ุจุงููุตูู ุฅูู ููุจุณ ุจุฑูุงูุฌ Docker ุงูุฎูู </h4><br>  ุชุณุชุฎุฏู ุฎุฏูุฉ Docker (ุงูุฎูู) ูุฃุฎุฐ UNIX /var/run/docker.sock ูุงุชุตุงูุงุช API ุงููุงุฑุฏุฉ.  <b>ูุฌุจ ุฃู ูููู ูุงูู ูุฐุง ุงูููุฑุฏ ูู ุงููุณุชุฎุฏู ุงูุฌุฐุฑ.</b>  ููุง ุทุฑููุฉ ุฃุฎุฑู.  ุชุบููุฑ ุญููู ุงููุตูู ุฅูู ูุฐุง ุงูููุจุณ ููุงูุฆ ุจุดูู ุฃุณุงุณู ููุญ ุญู ุงููุตูู ุฅูู ุงููุธุงู ุงููุถูู. <br><br>  ุฃูุถูุง ุ ูุฌุจ ุฃูุง ุชุชุนุซุฑ ุนูู ููุจุณ /var/run/docker.sock ูุน ุงูุญุงููุงุช ุ ุญูุซ ููููู ุงูุงุณุชุบูุงุก ุนููุง ุ ูุฃูู ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุคุฏู ุงูุฅุฎูุงู ุจุงูุฎุฏูุฉ ูู ุงูุญุงููุฉ ุฅูู ุงูุชุญูู ุงููุงูู ูู ุงููุธุงู ุงููุถูู.  ุฅุฐุง ูุงู ูุฏูู ุญุงููุงุช ุชุณุชุฎุฏู ุดูุฆูุง ููุฐุง: <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">-v /var/run/docker.sock://var/run/docker.sock</code> </pre> <br>  ุฃู ูุฑุณู ุงูุณูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">volumes: - <span class="hljs-string"><span class="hljs-string">"/var/run/docker.sock:/var/run/docker.sock"</span></span></code> </pre> <br>  ุญุงุฌุฉ ููุญุฉ ูุชุบููุฑ ูุฐุง. <br><br>  ูุงูุฃุฎูุฑ - ูุง ุชุณูุน <b>ุฃุจุฏูุง - ูุง</b> ุชุณุชุฎุฏู ูุฃุฎุฐ ุชูุตูู Docker TCP ุฏูู ุงููููู ุงููุทูู ุงูุฐู ุชุญุชุงุฌู ุ ูุง ุณููุง ุฏูู ุงุณุชุฎุฏุงู ุทุฑู ุญูุงูุฉ ุฅุถุงููุฉ (ุนูู ุงูุฃูู ุฅุฐู).  ุจุดูู ุงูุชุฑุงุถู ุ ููุชุญ ููุจุณ Docker TCP ูููุฐูุง ุนูู ุงููุงุฌูุฉ ุงูุฎุงุฑุฌูุฉ 0.0.0.0:2375 (2376 ุ ูู ุญุงูุฉ HTTPs) ููุณูุญ ุจุงูุชุญูู ุงููุงูู ูู ุงูุญุงููุงุช ุ ููุนู ูุธุงู ุงููุถูู ุงููุญุชูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 2 </h3><h4 style=";text-align:right;direction:rtl">  ุชูููู ูุณุชุฎุฏู ุบูุฑ ูุญุธูุธ ุฏุงุฎู ุงูุญุงููุฉ </h4><br>  ุฅู ุชูููู ุญุงููุฉ ูุงุณุชุฎุฏุงู ูุณุชุฎุฏู ุบูุฑ ูุญุชูู ูู ุฃูุถู ุทุฑููุฉ ูุชุฌูุจ ูุฌูู ุชุตุนูุฏ ุงูุงูุชูุงุฒ.  ูููู ุงูููุงู ุจุฐูู ุจุทุฑู ูุฎุชููุฉ: <br><br>  1. ุจุงุณุชุฎุฏุงู ุฎูุงุฑ "-u" ุงูุฎุงุต ุจุฃูุฑ "ุนุงูู ุงูุชุดุบูู": <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">docker run -u 4000 alpine</code> </pre> <br>  2. ุฃุซูุงุก ุจูุงุก ุงูุตูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">FROM alpine RUN groupadd -r myuser &amp;&amp; useradd -r -g myuser myuser &lt;      root-, ,  &gt; USER myuser</code> </pre> <br>  3. ุชูููู ุงูุฏุนู ูู "ูุณุงุญุฉ ุงุณู ุงููุณุชุฎุฏู" (ุจูุฆุฉ ุงููุณุชุฎุฏู) ูู Docker daemon: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">--userns-remap=default</code> </pre> <br>  ุงูุฑุฃ ุงููุฒูุฏ ุนู ูุฐุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> . <br><br>  ูู Kubernetes ุ ูุชู ุชูููู ุงูุฃุฎูุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณูุงู ุงูุฃูุงู</a> ุนุจุฑ ุฎูุงุฑ runAsNonRoot: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kind: ... apiVersion: ... metadata: name: ... spec: ... containers: - name: ... image: .... securityContext: ... runAsNonRoot: <span class="hljs-literal"><span class="hljs-literal">true</span></span> ...</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 3 </h3><h4 style=";text-align:right;direction:rtl">  ุงูุญุฏ ูู ูุฏุฑุงุช ุงูุญุงููุฉ </h4><br>  ุนูู ูุธุงู Linux ุ ุจุฏุกูุง ูู kernel 2.2 ุ ููุงู ุทุฑููุฉ ููุชุญูู ูู ุฅููุงููุงุช ุงูุนูููุงุช ุงููููุฒุฉ ุงููุณูุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Linux Kernel Capabilities</a> (ููุญุตูู ุนูู ุงูุชูุงุตูู ุ ุงูุธุฑ ุงูุฑุงุจุท). <br><br>  ูุณุชุฎุฏู ุนุงูู ุงููููุงุก ูุฌููุนุฉ ูุญุฏุฏุฉ ูุณุจููุง ูู ููุฒุงุช kernel ูุฐู ุงูุชุฑุงุถููุง.  ููุชูุญ ูู ุชุบููุฑ ูุฐู ุงููุฌููุนุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุงูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">--<span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>-drop โ     --<span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>-add โ    </code> </pre> <br>  ุฃูุถู ุฅุนุฏุงุฏ ุฃูุงู ูู ุฃููุงู ุชุนุทูู ูุงูุฉ ุงูููุฒุงุช (--cap-drop all) ุ ุซู ุชูุตูู ุงูููุฒุงุช ุงูุถุฑูุฑูุฉ ููุท.  ุนูู ุณุจูู ุงููุซุงู ุ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">docker run --<span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>-drop all --<span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>-add CHOWN alpine</code> </pre> <br>  ูุงูุฃูู (!): ุชุฌูุจ ุชุดุบูู ุงูุญุงููุงุช ุจุงูุนูู ุงููููุฒ !!! <br><br>  ูู Kubernetes ุ ูุชู ุชูููู ููุฏ Linux Kernel Capabilities ูู ุณูุงู ุงูุฃูุงู ุนุจุฑ ุฎูุงุฑ ุงูุฅููุงููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kind: ... apiVersion: ... metadata: name: ... spec: ... containers: - name: ... image: .... securityContext: ... capabilities: drop: - all add: - CHOWN ...</code> </pre><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 4 </h3><h4 style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ุนูุงูุฉ ุนุฏู ุงูุงูุชูุงุฒุงุช ุงูุฌุฏูุฏุฉ </h4><br>  ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุญุงููุฉ ุ ูู ุงููููุฏ ุงุณุชุฎุฏุงู ุนูุงูุฉ --security-opt = ุนุฏู ุงูุงูุชูุงุฒุงุช ุงูุฌุฏูุฏุฉ ุงูุชู ุชููุน ุชุตุนูุฏ ุงูุงูุชูุงุฒ ุฏุงุฎู ุงูุญุงููุฉ. <br><br>  ูู Kubernetes ุ ูุชู ุชูููู ููุฏ Linux Kernel Capabilities ูู ุณูุงู ุงูุฃูุงู ุนุจุฑ ุฎูุงุฑ allowPrivilegeEscalation: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kind: ... apiVersion: ... metadata: name: ... spec: ... containers: - name: ... image: .... securityContext: ... allowPrivilegeEscalation: <span class="hljs-literal"><span class="hljs-literal">false</span></span> ...</code> </pre><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 5 </h3><h4 style=";text-align:right;direction:rtl">  ูู ุจุฅููุงู ุงูุงุชุตุงู ุจูู ุงูุญุงููุงุช </h4><br>  ุจุดูู ุงูุชุฑุงุถู ุ ูุชู ุชูููู ุงูุงุชุตุงู ุจูู ุงูุญุงููุงุช ูู Docker ุ ููุง ูุนูู ุฃูู ูููู ูุฌููุน ุงูุญุงููุงุช ุงูุชูุงุตู ูุน ุจุนุถูุง ุงูุจุนุถ (ุจุงุณุชุฎุฏุงู ุดุจูุฉ docker0).  ูููู ุชุนุทูู ูุฐู ุงูููุฒุฉ ุนู ุทุฑูู ุชุดุบูู ุฎุฏูุฉ Docker ุจุนูุงูุฉ โicc = false. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 6 </h3><h4 style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู Linux Security Modules (ูุญุฏุฉ ุฃูุงู Linux - seccomp ู AppArmor ู SELinux) </h4><br>  ุจุดูู ุงูุชุฑุงุถู ุ ูุณุชุฎุฏู Docker ุจุงููุนู ูููุงุช ุชุนุฑูู ููุญุฏุงุช ุฃูุงู Linux.  ูุฐูู ุ <b>ูุง ุชูู ุฃุจุฏูุง ุจุชุนุทูู ูููุงุช ุชุนุฑูู ุงูุฃูุงู!</b>  ุงูุญุฏ ุงูุฃูุตู ุงูุฐู ูููู ุงูููุงู ุจู ูุนูู ูู ุชุดุฏูุฏ ุงูููุงุนุฏ. <br><br>  ููู ุงูุชุนุฑูู ุงูุงูุชุฑุงุถู ู seccomp ูุชุงุญ <a href="">ููุง</a> . <br><br>  ูุณุชุฎุฏู Docker ุฃูุถูุง AppArmor ููุญูุงูุฉ ุ ููููู Docker Engine ููุณู ุจุฅูุดุงุก ููู ุชุนุฑูู ุงูุชุฑุงุถู ูู AppArmor ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุญุงููุฉ.  ุจูุนูู ุขุฎุฑ ุ ุจุฏูุงู ูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">$ docker run --rm -it hello-world</code> </pre> <br>  ูุจุฏุฃ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">$ docker run --rm -it --security-opt apparmor=docker-default hello-world</code> </pre> <br>  ุชููุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู</a> ุฃูุถูุง ูุซุงููุง ูููู ุชุนุฑูู AppArmor ูู nginx ุ ููู ุฃูุฑ ูููู ุชูุงููุง (ุถุฑูุฑู!) ูุงุณุชุฎุฏุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#include &lt;tunables/global&gt; profile docker-nginx flags=(attach_disconnected,mediate_deleted) { #include &lt;abstractions/base&gt; network inet tcp, network inet udp, network inet icmp, deny network raw, deny network packet, file, umount, deny /bin/** wl, deny /boot/** wl, deny /dev/** wl, deny /etc/** wl, deny /home/** wl, deny /lib/** wl, deny /lib64/** wl, deny /media/** wl, deny /mnt/** wl, deny /opt/** wl, deny /proc/** wl, deny /root/** wl, deny /sbin/** wl, deny /srv/** wl, deny /tmp/** wl, deny /sys/** wl, deny /usr/** wl, audit /** w, /var/run/nginx.pid w, /usr/sbin/nginx ix, deny /bin/dash mrwklx, deny /bin/sh mrwklx, deny /usr/bin/top mrwklx, capability chown, capability dac_override, capability setuid, capability setgid, capability net_bind_service, deny @{PROC}/* w, # deny write for all files directly in /proc (not in a subdir) # deny write to files not in /proc/&lt;number&gt;/** or /proc/sys/** deny @{PROC}/{[^1-9],[^1-9][^0-9],[^1-9s][^0-9y][^0-9s],[^1-9][^0-9][^0-9][^0-9]*}/** w, deny @{PROC}/sys/[^k]** w, # deny /proc/sys except /proc/sys/k* (effectively /proc/sys/kernel) deny @{PROC}/sys/kernel/{?,??,[^s][^h][^m]**} w, # deny everything except shm* in /proc/sys/kernel/ deny @{PROC}/sysrq-trigger rwklx, deny @{PROC}/mem rwklx, deny @{PROC}/kmem rwklx, deny @{PROC}/kcore rwklx, deny mount, deny /sys/[^f]*/** wklx, deny /sys/f[^s]*/** wklx, deny /sys/fs/[^c]*/** wklx, deny /sys/fs/c[^g]*/** wklx, deny /sys/fs/cg[^r]*/** wklx, deny /sys/firmware/** rwklx, deny /sys/kernel/security/** rwklx, }</span></span></code> </pre><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 7 </h3><h4 style=";text-align:right;direction:rtl">  ุงูุญุฏ ูู ููุงุฑุฏ ุงูุญุงููุฉ </h4><br>  ูุฐู ุงููุงุนุฏุฉ ุจุณูุทุฉ ููุบุงูุฉ: ูู ุฃุฌู ููุน ุงูุญุงููุงุช ูู ุงูุชูุงู ุฌููุน ููุงุฑุฏ ุงูุฎุงุฏู ุฃุซูุงุก ูุฌูู DoS / DDoS ุงูุชุงูู ุ ูููููุง ุชุนููู ุญุฏูุฏ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ููู ุญุงููุฉ ุนูู ุญุฏุฉ.  ููููู ุงูุญุฏ: ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ. <br><br>  ูุฐูู ุฏุนููุง ูุฐูุจ ุจุงูุชุฑุชูุจ. <br><br>  <b><u>ุงูุฐุงูุฑุฉ</u></b> <br><br>  <b>ุงูุฎูุงุฑ -m ุฃู - ุงูุฐุงูุฑุฉ</b> <br><br>  ุงูุญุฏ ุงูุฃูุตู ูููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงูุฐู ูููู ุฃู ุชุณุชุฎุฏูู ุงูุญุงููุฉ.  ุงูุญุฏ ุงูุฃุฏูู ูููููุฉ ูู 4 ุฃูุชุงุฑ (4 ููุฌุงุจุงูุช). <br><br>  <b>ุงูุฎูุงุฑ - ุงูุฐุงูุฑุฉ ุงููุจุงุฏูุฉ</b> <br><br>  ุงูุฎูุงุฑ ูุชูููู ูุจุงุฏูุฉ (ููู ุงููุจุงุฏูุฉ).  ุชูููู ุงููุงูุฑุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช --memory-swap&gt; 0 ุ ููุฌุจ ุฃูุถูุง ุชุนููู ุนูุงูุฉ ุงูุฐุงูุฑุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ููุธูุฑ ูุจุงุฏูุฉ ุงูุฐุงูุฑุฉ ููุฏุงุฑ ุฅุฌูุงูู ุงูุฐุงูุฑุฉ ุงููุชููุฑุฉ ููุญุงููุฉ ูุน ุงููุจุงุฏูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุซุงู ุฃุจุณุท.  ุฅุฐุง ูุงู --memory = "300m" ุ ู --memory-swap = "1g" ุ ููููู ููุญุงููุฉ ุงุณุชุฎุฏุงู 300 ููุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ ู 700 ููุฌุงุจุงูุช ูู ุงูููุงูุถุฉ (1g - 300m). </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู --memory-swap = 0 ุ ูุณูุชู ุชุฌุงูู ุงูุฅุนุฏุงุฏ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุชู ุถุจุท --memory-swap ุนูู ููุณ ูููุฉ --memory ุ ููู ูููู ููุญุงููุฉ ููุงูุถุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ - ูุจุงุฏูุฉ ุงูุฐุงูุฑุฉ ุ ูููู - ุชู ุชุญุฏูุฏ ุงูุฐุงูุฑุฉ ุ ูุฅู ุนุฏุฏ ุงููุจุงุฏูุฉ ูุณุงูู ุถุนู ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุญุฏุฏุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูู ูุชู ุชุนููู --memory = "300m" ุ ู --memory-swap ุ ูุณุชุณุชุฎุฏู ุงูุญุงููุฉ 300 ููุฌุงุจุงูุช ูู ุงูุฐุงูุฑุฉ ู 600 ููุฌุงุจุงูุช ูู ุงูููุงูุถุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช --memory-swap = -1 ุ ูุณุชุณุชุฎุฏู ุงูุญุงููุฉ ุฌููุน ุงููุจุงุฏูุงุช ุงูููููุฉ ุนูู ุงููุธุงู ุงููุถูู. </li></ul><br>  <b>ููุงุญุธุฉ ูููุถููุฉ:</b> ุงูุฃุฏุงุฉ ุงููุฌุงููุฉ ุงูุชู ูุชู ุฅุทูุงููุง ุฏุงุฎู ุงูุญุงููุฉ ูุง ุชูุธูุฑ ุงููููุฉ ุงูุญููููุฉ ููุชุจุงุฏู ุงููุชุงุญ ููุญุงููุฉ ุ ูููู ุนุฏุฏ ูุจุงุฏูุฉ ุงููุถูู. <br><br>  <b>ุงูุฎูุงุฑ - ุฃู-ูุชู-ุชุนุทูู</b> <br><br>  ูุณูุญ ูู ุจุชูููู ุฃู ุชุนุทูู ุงููุงุชู OOM (ููุงุฏ ุงูุฐุงูุฑุฉ). <br><br>  ุชุญุฐูุฑ!  ูุง ููููู ุฅููุงู ุชุดุบูู OOM Killer ุฅูุง ูู ุฎูุงู ูุฌููุนุฉ ุงูุฎูุงุฑ --memory ุ ูุฅูุง ููุฏ ูุญุฏุซ ุฃูู ูุน ููุงุฏ ุงูุฐุงูุฑุฉ ุฏุงุฎู ุงูุญุงููุฉ ุ ุณุชุจุฏุฃ ุงูููุงุฉ ูู ูุชู ุนูููุงุช ุงููุธุงู ุงููุถูู. <br><br>  ุฎูุงุฑุงุช ุชูููู ุฅุฏุงุฑุฉ ุงูุฐุงูุฑุฉ ุงูุฃุฎุฑู ุ ูุซู - ุงูุฐุงูุฑุฉ ุงูุชุจุงุฏููุฉ ุ ู - ุงูุฐุงูุฑุฉ ุงูุงุญุชูุงุทูุฉ ุ ู - ุฐุงูุฑุฉ kernel ุ ูู ุฃูุซุฑ ูุถุจุท ุฃุฏุงุก ุงูุญุงููุฉ. <br><br>  <b><u>ูุนุงูุฌ</u></b> <br><br>  <b>ุงูุฎูุงุฑ - ูุณุฎุฉ</b> <br><br>  ูุญุฏุฏ ุงูุฎูุงุฑ ููุฏุงุฑ ููุงุฑุฏ ุงููุนุงูุฌ ุงููุชุงุญุฉ ุงูุชู ูููู ุฃู ุชุณุชุฎุฏููุง ุงูุญุงููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ูุฏููุง ูุถูู ุจู ูุญุฏุชุงู ูู ูุญุฏุงุช ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ููููุง ุจุชุนููู - cpus = "1.5" ุ ูุฅู ุงูุญุงููุฉ ูุถูููุฉ ูุงุณุชุฎุฏุงู ูุนุงูุฌ ูุงุญุฏ ููุตู. <br><br>  <b>ุงูุฎูุงุฑ - cpuset-cpus</b> <br><br>  ูุชูููู ุงุณุชุฎุฏุงู ุงูููู ุฃู ูุญุฏุงุช ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุงููุญุฏุฏุฉ.  ูููู ุชุญุฏูุฏ ุงููููุฉ ุจุงุณุชุฎุฏุงู ูุงุตูุฉ ุฃู ูุงุตูุฉ.  ูู ุงูุญุงูุฉ ุงูุฃููู ุ ุณูุชู ุงูุฅุดุงุฑุฉ ุฅูู ูุทุงู ุงูููู ุงููุณููุญ ุจูุง ุ ูู ุงูููู ุงููุญุฏุฏุฉ ุงูุซุงููุฉ. <br><br>  <b><u>ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ</u></b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">--restart=on-failure:&lt;number_of_restarts&gt;</code> </pre> <br>  ูุญุฏุฏ ูุฐุง ุงูุฅุนุฏุงุฏ ุนุฏุฏ ูุฑุงุช ูุญุงููุฉ Docker ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ ูู ุญุงูุฉ ุชุนุทููุง ุจุดูู ุบูุฑ ูุชููุน.  ุชุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏุงุฏ ุฅุฐุง ุชุบูุฑุช ุญุงูุฉ ุงูุญุงููุฉ ุฅูู ุงูุชุดุบูู. <br><br>  ููุตู ุจุชุนููู ุฑูู ููุฌุจ ุตุบูุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ 5 ุ ูุงูุฐู ุณูุชุฌูุจ ุฅุนุงุฏุฉ ุชุดุบูู ูุง ููุงูุฉ ููุง ูู ุฎุฏูุฉ ุบูุฑ ุนุงููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 8 </h3><h4 style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ุฃูุธูุฉ ุงููููุงุช ูููุฑุงุกุฉ ููุท ููุญุฏุฉ ุงูุชุฎุฒูู </h4><br>  ุฅุฐุง ูุงู ูุฌุจ ุฃูุง ุชูุชุจ ุงูุญุงููุฉ ุฃู ุดูุก ูู ููุงู ูุง ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู ูุธุงู ุงููููุงุช ูููุฑุงุกุฉ ููุท ูุฏุฑ ุงูุฅููุงู.  ูุฐุง ุณูู ูุนูุฏ ุฅูู ุญุฏ ูุจูุฑ ุญูุงุฉ ูุชุณูู ูุญุชูู. <br><br>  ูุซุงู ูุจุฏุก ุญุงููุฉ ูุน ูุธุงู ุงููููุงุช ูููุฑุงุกุฉ ููุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">docker run --<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>-only alpine</code> </pre> <br>  ูุซุงู ุนูู ุชูุตูู ูุญุฏุฉ ุงูุชุฎุฒูู ูู ูุถุน ุงููุฑุงุกุฉ ููุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">docker run -v volume-name:/path/<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>/container:ro alpine</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุงููุงุฏุฉ 9 </h3><h4 style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ุฃุฏูุงุช ุชุญููู ุฃูุงู ุงูุญุงููุฉ </h4><br>  ูุฌุจ ุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช ูุงูุชุดุงู ุงูุญุงููุงุช ุฐุงุช ุงูุซุบุฑุงุช ุงูุฃูููุฉ ุงููุนุฑููุฉ.  ูุง ููุฌุฏ ุงููุซูุฑ ูููู ุญุชู ุงูุขู ุ ููููู: <br><br>  โข ูุฌุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุฑ.</a> </li></ul><br>  โข ุชุฌุงุฑู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Snyk</a> (ููุงู ูุณุฎุฉ ูุฌุงููุฉ) ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุณุงุฉ</a> (ููุงู ูุณุฎุฉ ูุฌุงููุฉ) ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">JFrog XRay</a> ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงููุณ</a> . </li></ul><br>  ูุจุงููุณุจุฉ ุฅูู Kubernetes ุ ููุงู ุฃุฏูุงุช ูุงูุชุดุงู ุฃุฎุทุงุก ุงูุชูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">kubeaudit</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">kubesec.io</a> ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุจู ููุงุนุฏ ุงูุจุฏูุงุก</a> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar448704/">https://habr.com/ru/post/ar448704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar448694/index.html">ูุตุฉ ููู ูู ูุตู ุฅูู ุงูุชููุฒููู</a></li>
<li><a href="../ar448696/index.html">Webinar Group-IB "ูุธุฑุฉ ุฌุฏูุฏุฉ ุนูู ุชูุฏูุฏ ุงูุตูุฏ: ุชูููุงุช ุงูุชุดุงู ุงูุจููุฉ ุงูุชุญุชูุฉ ูููุฌูู"</a></li>
<li><a href="../ar448698/index.html">ุงูุณุญุจ ุงูุณูุงุฏูุฉ</a></li>
<li><a href="../ar448700/index.html">DjangoCon Europe 2019. ูู ูุงุช ุงูููุฑ ุงูุฎุงุต ุจูุ</a></li>
<li><a href="../ar448702/index.html">ุชุณุงุฑุน MicroPython</a></li>
<li><a href="../ar448706/index.html">ุงุฑุชูุนุช ุฃุณูู Zoom Technologies ุจูุณุจุฉ 47ุ000ูช ุจุนุฏ ุจุฏุก ุชุดุบูู ุงูุงูุชุชุงุจ Zoom. ุงุดุชุฑู ุงูุนุฏูุฏ ูู ุงููุณุชุซูุฑูู ููู ุนู ุทุฑูู ุงูุฎุทุฃ.</a></li>
<li><a href="../ar448708/index.html">ุนูุฏูุง ูุง ูุณุงุนุฏ ุงูุชุดููุฑ: ุชุญุฏุซ ุนู ุงููุตูู ุงููุนูู ุฅูู ุงูุฌูุงุฒ</a></li>
<li><a href="../ar448710/index.html">ูู ุจู ุฅุณ ูุงุณุชุนุงุฏุฉ ุงูููุฑุจุงุก: ููููุฉ ุนุจูุฑ ุงููููุฐ ูุน ุซุนุจุงูุ</a></li>
<li><a href="../ar448712/index.html">ููุทู "ุงูุทูุจ - ุงูุงุณุชุฌุงุจุฉ" ุงูุฑุณูู ูู ุชุนูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ: ููุงุฆุฏ ุงููุจุฑูุฌูู</a></li>
<li><a href="../ar448714/index.html">ุณูุงู - ุณูุฉ ูุธููุฉ ุบูุฑ ุฑุณููุฉ ูุฅุตุฏุงุฑ ุณุทุญ ุงูููุชุจ ูู Windows ู Linux ู MacOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>