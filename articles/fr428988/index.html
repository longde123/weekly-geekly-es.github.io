<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòú üßëüèΩ‚Äçü§ù‚Äçüßëüèº üßôüèª Conseils nature - Veilleuse nuageuse üö± üßùüèø üë®‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, communaut√©! 

 Je pr√©sente ma propre mise en ≈ìuvre d'une lampe de nuit sous forme de nuage. L'id√©e principale est de faire une veilleuse avec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conseils nature - Veilleuse nuageuse</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428988/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/mr/66/st/mr66stql1kimlmtxmkt2ycjyfue.jpeg" alt="image" width="75%"></div><br><br>  Bonjour, communaut√©! <br><br>  Je pr√©sente ma propre mise en ≈ìuvre d'une lampe de nuit sous forme de nuage.  L'id√©e principale est de faire une veilleuse avec des simulations de processus naturels et une sorte d'interactivit√©.  La nature est le meilleur inspirateur! <br><br>  Bas√© sur le microcontr√¥leur bon march√© ATmega8-16PU.  Le code est √©crit en C sans Arduino et impl√©mente plusieurs effets d'√©clairage avec contr√¥le depuis l'√©clairage g√©n√©ral de l'espace et avec contr√¥le sonore. <br><br>  D√©tails et photos - plus ... <br><a name="habracut"></a><br><h3>  D√©tails √©lectroniques </h3><br>  Le circuit, en plus du microcontr√¥leur, dispose de 6 LED unicolores, une LED RGB, un capteur de lumi√®re (photor√©sistance) et un microphone avec un amplificateur et un filtre RF. <br><br>  Pour modifier en douceur la luminosit√© des LED, <abbr title="Modulation de largeur d'impulsion">PWM est</abbr> utilis√©.  La fr√©quence PWM est de 244 Hz √† 64 niveaux, il arrive que certaines personnes la voient.  Il est impossible d'augmenter la fr√©quence - vous avez encore besoin de temps processeur pour fonctionner.  Par cons√©quent, pour lisser les impulsions PWM, un circuit r√©p√©teur √† transistor avec un condensateur de lissage est utilis√©.  Le transistor est pris avec un grand gain pour augmenter la r√©sistance d'entr√©e et r√©duire la capacit√© requise.  En cons√©quence, 1 microfarad √©tait suffisant, les impulsions ont √©t√© liss√©es presque compl√®tement.  Les avantages sont moins chers que le DAC et ont un courant de sortie important.  L'inconv√©nient de ce sch√©ma est la d√©pendance non lin√©aire de la luminosit√© au niveau PWM √† de faibles niveaux (jusqu'√† 15%). <br><br><div class="spoiler">  <b class="spoiler_title">Circuit Micro-Cap 9</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9h/jx/m-/9hjxm-paag2rkjz7osorqlr_8ke.png" alt="image"><br>  <i>Sch√©ma de lissage PWM.</i>  <i>4 diodes environ = 1 LED blanche selon la caract√©ristique I-V</i> <br><br><img src="https://habrastorage.org/webt/af/6f/g4/af6fg4lbpq8fxaenzaepivxw-ps.png" alt="image"><br>  <i>Graphique du courant et de la tension sur la LED √† 56% PWM.</i> <br></div></div><br>  Un microphone √† √©lectret miniature √† travers un amplificateur sur deux transistors avec extraction d'impulsions (filtre passe-haut) est connect√© √† l'entr√©e discr√®te du MK, capte en toute confiance des sons aigus - applaudissements. <br><br>  Il a dessin√© et √©tal√© la planche dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DipTrace</a> , l'a fait LUT, les d√©tails sont principalement smd.  La gravure a √©t√© r√©alis√©e dans le ¬´tueur de chlorure ferrique¬ª: peroxyde d'hydrog√®ne + sel + acide citrique, il s'est av√©r√© la premi√®re fois, je le recommande.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toutes les voies amateurs sont √©crites ici.</a> <br><br><img src="https://habrastorage.org/webt/6g/m-/05/6gm-05vizzaj1ew1l63b-b6kh5o.jpeg" alt="image"><br>  <i>Les frais de LUT</i> <br><br>  J'ai fait le pouvoir via un connecteur USB, qui vous permet de vous connecter √† n'importe quel port USB.  Consommation maximale 78 mA. <br><br>  Dans les versions pr√©c√©dentes, le c√¢ble avait un micro bouton pour r√©gler les modes, mais il a ensuite √©t√© retir√©, car il ne pouvait pas √™tre atteint si le nuage √©tait sous le plafond. <br><br>  Il n'y a pas de connexion USB, le MK n'a pas d'USB, et il semble que ce ne soit pas n√©cessaire dans le produit fini.  Pour le d√©bogage, j'ai utilis√© le contr√¥leur UART, le code impl√©mente un √©change avec un ordinateur, mais l√† c'est b√©b√™te <s>√©crit sur le genou</s> . <br><br><img src="https://habrastorage.org/webt/7u/fy/h5/7ufyh5cpydbcvzj50ojtwibyeik.jpeg" width="75%"><br>  <i>En cours de soudure</i> <br><br>  La LUT, le soudage, l'√©criture d'un programme, les tests et modifications, l'ajustement des minuteries et des coefficients ont pris 3 semaines. <br><br><img src="https://habrastorage.org/webt/zk/t8/g9/zkt8g9wjyn7ujuyihfg32mn-bc0.jpeg" alt="image"><br>  <i>Vue g√©n√©rale</i> <br><br>  En cons√©quence, il a r√©alis√© 3 modes d'effets de lueur et d'√©clairage.  J'ai essay√© de la rendre plus int√©ressante qu'une lampe √† lave, mais je ne suis pas non plus devenue une musique de couleur disco avec des sifflets de poing. <br><br><h3>  Modes: </h3><br>  <b>La principale</b> est une lampe de nuit en forme de nuage.  Diff√©rentes parties du nuage changent la luminosit√© de mani√®re al√©atoire, la p√©riode de changement est √©galement al√©atoire (4 ... 25 sec), le type de changement est un lissage exponentiel de la t√¢che (je peux vous en dire plus dans les commentaires).  Il ressemble √† un tout, avec une fraction de l'imagination, comme des d√©bordements de lumi√®re dans un vrai nuage lorsqu'il recouvre le Soleil.  Le niveau de luminosit√© maximum d√©pend du niveau d'√©clairage selon le programme.  J'ai choisi diff√©rentes d√©pendances, il y avait une option avec le choix des d√©pendances sur le bouton, mais je me suis content√© de celle-ci seule. <br><br><img src="https://habrastorage.org/webt/hw/hp/xo/hwhpxotfo5gyf9njb_64kkvdtps.png" alt="image"><br>  <i>Le graphique de la d√©pendance de la luminosit√© du nuage de l'√©clairage ext√©rieur.</i> <br><br>  √âtant donn√© que le nuage ne brille presque pas pendant l'obscurit√© ext√©rieure (nuit) et qu'une lumi√®re vive √† court terme peut √™tre n√©cessaire (par exemple, pour se lever la nuit), j'ai cr√©√© le sous-mode Bright Cloud.  Il s'allume avec deux applaudissements, ici et utilise un microphone, car les boutons sont g√©n√©ralement hors de port√©e.  Le nuage brille √† pleine luminosit√© pendant une minute, √©galement avec d√©bordement, puis revient en douceur au mode cloud principal en fonction de l'√©clairage. <br><br><img src="https://habrastorage.org/webt/cg/ha/dx/cghadxfnhu9zgmk0x-u3rx9xsp8.gif" alt="image"><br>  <i>Mode cloud, premiers √©chantillons.</i>  <i>Vid√©o acc√©l√©r√©e 5 fois</i> <br><br>  <b>Orage</b> - s'allume avec une forte diminution de la lumi√®re ambiante (mais pas avant l'obscurit√© compl√®te, afin de ne pas toucher les yeux dans l'obscurit√©) ou trois pops.  Les LED al√©atoires clignotent (de 1 √† 4x), avec une pause al√©atoire entre les flashs.  Je me suis un peu embrouill√© et j'ai fait des ¬´√©clairs¬ª de foudre dans le nuage lorsque les LED clignotent le long de la cha√Æne de temps.  Il ressemble √©galement √† un orage.  En raison du r√©gime orageux, un compromis de filtrage PWM a d√ª √™tre trouv√© pour que les flashs soient nets (77 ms).  La dur√©e de l '¬´orage¬ª d√©pend de la lumi√®re ambiante - le plus sombre, le plus long, de 4 √† 12 flashs. <br><br>  <b>Dawn</b> - s'allume avec une forte augmentation de la lumi√®re ambiante.  Le mode le plus difficile √† mettre en place, obtenir ¬´un changement naturel des couleurs du soleil √† l'aube dans une brume l√©g√®re¬ª n'a pas √©t√© facile.  Il √©tait n√©cessaire d'√©quilibrer manuellement la LED RVB √† presque tous les niveaux PWM et de s√©lectionner les d√©pendances.  Mais au final, j'ai re√ßu une formule d'interpolation plus ou moins.  L'aube dure 40 secondes, puis passe en mode normal. <br><br><img src="https://habrastorage.org/webt/c_/fl/6b/c_fl6baslbfbbxsagw5bpnou39c.jpeg" alt="image" width="75%"><br>  <i>Aube</i> <br><br>  Electronique et logiciels pour les personnes int√©ress√©es: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Archiver avec la source</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sch√©ma en pdf</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Disposition de la carte, un c√¥t√©</a> <br><br><h3>  Constructif </h3><br>  La conception du cloud est assez simple, je suis en sintepuha (un oreiller 40x40 cm), la planche est situ√©e √† l'int√©rieur sur les suspensions de fils.  Les LED sont dispos√©es aussi uniform√©ment que possible en volume, eh bien, la LED RGB est en bas et le capteur photo est en haut. <br><br><img src="https://habrastorage.org/webt/n8/yf/qm/n8yfqmg3dbmhm9oqpelqvnt4xxa.jpeg" width="75%"><br>  <i>En cours de fuzzing</i> <br><br>  Il y a eu des difficult√©s √† fixer le synthech, car il est recouvert de silicone pour √©viter l'agglutination.  La partie inf√©rieure du nuage est soutenue par des bandes √©troites de ruban adh√©sif sur le cadre m√©tallique. <br><br>  Questions, commentaires, suggestions √©crivent dans les commentaires. <br><br>  Bon temps! <br><br><img src="https://habrastorage.org/webt/k2/jp/ia/k2jpiamrczanxcsod6-l-rh-nmi.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428988/">https://habr.com/ru/post/fr428988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428976/index.html">Colline de fourmis ou forteresse? Je construis une maison pour le prix d'un appartement. Partie 2: Chauffage</a></li>
<li><a href="../fr428980/index.html">Broker JavaScript hors ligne</a></li>
<li><a href="../fr428982/index.html">Comment √©crire D sur ARM</a></li>
<li><a href="../fr428984/index.html">Julia et portraits de phases de syst√®mes dynamiques</a></li>
<li><a href="../fr428986/index.html">Conf√©rence ThinkJava n ¬∞ 8 √† Kharkov</a></li>
<li><a href="../fr428990/index.html">Exemples de configuration d'UIViewControllers utilisant RouteComposer</a></li>
<li><a href="../fr428992/index.html">Contournement s√©lectif des verrous sur les routeurs avec le firmware Padavan et Keenetic OS</a></li>
<li><a href="../fr428994/index.html">Mise en r√©seau sous Android avec Corutin et Retrofit</a></li>
<li><a href="../fr428996/index.html">Club de Santa Clauses anonymes 2018-2019 sur Habrahabr</a></li>
<li><a href="../fr428998/index.html">Comment utiliser la nouvelle fonctionnalit√© Profiler exp√©rimentale dans React</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>