<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé± üíü üèê Gef√§hrliche Treiber von Drittanbietern auf Ihrem System oder LOLDrivers ‚úçüèΩ üßñüèø ü§¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wussten Sie, dass ein v√∂llig legitimer Treiber einem Angreifer die M√∂glichkeit geben kann, sich f√ºr lange Zeit in Ihrem System zu registrieren und auc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gef√§hrliche Treiber von Drittanbietern auf Ihrem System oder LOLDrivers</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468691/"><p><img src="https://habrastorage.org/webt/jo/vj/6b/jovj6bremrnesqprdgan6fibwqu.jpeg"></p><br><p>  Wussten Sie, dass ein v√∂llig legitimer Treiber einem Angreifer die M√∂glichkeit geben kann, sich f√ºr lange Zeit in Ihrem System zu registrieren und auch nach einer Neuinstallation im System zu bleiben?  Oder verwandeln Sie Ihren Computer in einen Stein?  Beispielsweise sind einige harmlose, scheinbar vertrauensw√ºrdige (signierte) Treiber √ºbrigens Werkzeuge zum √úberschreiben des BIOS.  Nach einem solchen Angriff wird nur der Programmierer speichern. </p><br><p>  In Windows gibt es vertrauensw√ºrdige <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anwendungen / Skripte / Bibliotheken</a> mit zus√§tzlichen <del>  interessant </del>  gef√§hrliche Funktionen wie das Ausf√ºhren von beliebigem Code, das Herunterladen von Dateien, das Umgehen der Benutzerkontensteuerung usw.  Wenn eine solche zus√§tzliche Funktionalit√§t in einer Kernelkomponente gefunden wird, wird sie noch interessanter. </p><a name="habracut"></a><br><p>  Ab Windows Vista x64 gilt die DSE-Richtlinie (Driver Signature Enforcement). Alle Treiber auf Kernelebene m√ºssen signiert sein.  Wenn ein Angreifer (mit Benutzer- / Administratorrechten) nach dem Eindringen in das System die maximale Zugriffsebene erhalten m√∂chte (Kernel-Rootkit / Bootkit / SMM-Rootkit / BIOS-Rootkit installieren), muss er die Signaturanforderungen f√ºr den Treiber irgendwie umgehen.  Die M√∂glichkeit, bestimmte Funktionen oder Anweisungen im Kernelmodus im Kernelmodus aufzurufen, kann einem Angreifer ein Tool bieten, mit dem er Berechtigungen erh√∂hen, Informationen offenlegen oder einen Denial-of-Service verursachen kann.  Wir bezeichnen diese Funktionalit√§t als Doppelfunktionalit√§t (in einigen F√§llen kann dies als Sicherheitsl√ºcke oder Hintert√ºr bezeichnet werden, die Diskussion √ºber die korrekte Definition geht jedoch √ºber den Rahmen dieses Artikels hinaus). </p><br><h2 id="sposoby-obhoda-dse">  <strong>DSE-Problemumgehungen</strong> </h2><br><p>  Schauen wir uns an, welche Optionen ein Angreifer im Allgemeinen hat, um DSE zu umgehen (Sie m√ºssen irgendwie in ring0 eindringen).  In der folgenden Tabelle sind die M√∂glichkeiten zur Umgehung von DSE mit ihren Vor- und Nachteilen zusammengefasst (f√ºr den Angreifer und die Sicherheitskr√§fte zur Kenntnis zu nehmen).  Es ist erw√§hnenswert, dass diese Informationen f√ºr Windows x64 gelten, beginnend mit Vista. </p><br><div class="scrollable-table"><table><thead><tr><th>  Weg </th><th>  Die Vorteile </th><th>  Nachteile </th></tr></thead><tbody><tr><td>  Festlegen der Startkonfigurationsdaten (Testmodus) </td><td>  Einfachheit </td><td><ul><li>  Es funktioniert nicht f√ºr alle Anwendungen. </li><li>  Auf dem Desktop wird ein Wasserzeichen angezeigt </li><li>  Neustart erforderlich </li></ul></td></tr><tr><td>  Verwenden eines kompromittierten privaten Schl√ºssels </td><td>  M√∂glichkeit, einen beliebigen Treiber zu installieren </td><td><ul><li>  Wenn ein Leck festgestellt wird, wird das Zertifikat zur Zertifikatsperrliste (Certificate Revocation List, CRL) hinzugef√ºgt. </li></ul></td></tr><tr><td>  Verwenden von Sicherheitsl√ºcken bei der Implementierung der DSE-Steuerung </td><td>  Wird von Windows-Antiviren- und Sicherheitssystemen nicht erkannt </td><td><ul><li>  Schwierigkeiten beim Auffinden solcher Schwachstellen </li><li>  Betriebssystemversion abh√§ngig </li></ul></td></tr><tr><td>  √Ñnderung der Treiberpr√ºfmechanismen (bootmgr, winload.exe, winresume.exe, ci.dll) </td><td>  M√∂glichkeit, jeden Treiber ohne OC-Pr√ºfungen zu installieren </td><td><ul><li>  √Ñnderungskomplexit√§t </li><li>  Ben√∂tigt eine M√∂glichkeit, den sicheren Start zu umgehen (falls aktiviert) </li><li>  Neustart erforderlich </li><li>  Betriebssystemversion abh√§ngig </li><li>  Andere Dateisteuerelemente </li></ul></td></tr><tr><td>  Verwenden eines signierten Treibers mit Sicherheitsanf√§lligkeit </td><td>  Schwierigkeit bei der Erkennung von Angriffen </td><td><ul><li>  Schwierigkeiten beim Auffinden solcher Schwachstellen </li><li>  Erkennungssicherheitssperre </li></ul></td></tr><tr><td>  Verwenden eines signierten Treibers mit Dual-Purpose-Funktionalit√§t </td><td>  Wird von Windows-Antiviren- und Sicherheitssystemen nicht erkannt </td><td><ul><li>  Die Komplexit√§t der Suche (nach einem Angreifer) eines Treibers mit der erforderlichen Doppelfunktionalit√§t </li></ul></td></tr></tbody></table></div><br><p>  Wie Sie der Tabelle entnehmen k√∂nnen, ist ein signierter Treiber mit Dual-Purpose-Funktionalit√§t die attraktivste M√∂glichkeit, DSE f√ºr einen Angreifer zu umgehen. </p><br><h2 id="opasnaya-funkcionalnost-ili-funkcionalnost-dvoynogo-naznacheniya">  <strong>Gef√§hrliche oder doppelte Funktionalit√§t</strong> </h2><br><p>  Schauen wir uns Beispiele f√ºr b√∂swillige Funktionen an, die ein Angreifer in Gegenwart eines Treibers mit gef√§hrlichen Funktionen f√ºr zwei Zwecke zeigt. </p><br><ul><li>  Eskalation von Berechtigungen auf Administratorebene / SYSTEM.  Physischer Lese- / Schreibspeicher erforderlich.  Dieser Angriff kann beispielsweise mit dem ASMMAP-Treiber von ASUS ausgef√ºhrt werden.  Lesen Sie dazu den physischen Speicher und suchen Sie die EPROCESS-Struktur (sie ist ein Element einer verkn√ºpften Liste). Durchsuchen Sie dann die Liste nach dem Prozess, dessen Berechtigungsstufe wir erh√∂hen m√∂chten, sowie nach einem bekannten Prozess mit der SYSTEM-Ebene (z. B. lsass, wininit).  Kopieren Sie dann den Wert des Token-Felds der Systemprozessstruktur in die Struktur des Zielprozesses.  Eine detailliertere Beschreibung des Angriffs finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </li><li>  SMEP deaktivieren.  Dazu m√ºssen Sie in das Steuerregister cr4 schreiben (genauer gesagt, setzen Sie das 20. Bit zur√ºck).  Beispielsweise deaktiviert der bandainamcoonline.sys-Treiber nicht nur SMEP, sondern f√ºhrt auch Code entsprechend dem vom Benutzer √ºbergebenen Zeiger hilfreich aus.  F√ºr Interessierte gibt es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Artikel</a> mit einer detaillierten Beschreibung des Fahrers. </li><li><p>  Ausf√ºhrung von beliebigem Code im Kernelmodus.  Physischer Lese- / Schreibspeicher und MSR erforderlich.  Die Bedeutung besteht darin, die Adresse (in einem der MSRs), zu der beim T√§tigen eines Systemaufrufs √ºbergegangen wird, durch die Adresse des Speicherorts des Codes des Angreifers zu ersetzen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier</a> finden Sie weitere Informationen dazu.  PatchGuard wird auf dem Weg st√∂ren, aber Sie k√∂nnen es herausfinden, wenn Sie m√∂chten. </p><br><blockquote>  Da sowohl der Treiber als auch PatchGuard in Ring 0 ausgef√ºhrt werden, hindert nichts den Treiber daran, PatchGuard-√úberpr√ºfungen zu deaktivieren (bis nat√ºrlich Microsoft Intel h√∂rt und mit zwei Schutzringen √ºber das Modell hinausgeht).  Die Kernel-Entwickler von Microsoft sind sich dieser Tatsache bewusst und f√ºhren verschiedene Aktionen aus, um den Speicherort dieses Codes zu verbergen, seine Aktionen und die verwendeten internen Strukturen zu verschleiern.  Mit anderen Worten, da Sie nicht daran gehindert werden k√∂nnen, den PatchGuard-Code zu √§ndern, versuchen sie ihr Bestes, ihn auszublenden. <br><br>  - <em>Blunden B. Das Rootkit-Arsenal: Flucht und Ausweichen in den dunklen Ecken des Systems.</em> </blockquote><br><div class="spoiler">  <b class="spoiler_title">Das Original</b> <div class="spoiler_text"><blockquote>  Angesichts der Tatsache, dass sowohl Treibercode als auch PatchGuard-Code in Ring 0 ausgef√ºhrt werden, hindert nichts ein KMD daran, PatchGuard-√úberpr√ºfungen zu deaktivieren (es sei denn, Microsoft nimmt einen Hinweis von Intel und geht √ºber ein Zwei-Ring-Berechtigungsmodell hinaus).  Die Kernel-Ingenieure von Microsoft sind sich dieser Tatsache sehr bewusst und f√ºhren alle Arten von Programmierakrobatik durch, um zu verschleiern, wo sich der Code befindet, was er tut und welche internen Datenstrukturen er manipuliert.  Mit anderen Worten, sie k√∂nnen Sie nicht davon abhalten, PatchGuard-Code zu √§ndern, also werden sie h√∂llisch versuchen, ihn zu verbergen. <br><br>  - <em>Blunden B. Das Rootkit-Arsenal: Flucht und Ausweichen in den dunklen Ecken des Systems.</em> </blockquote><br></div></div><br></li></ul><br><ul><li>  BIOS-Eintrag.  Ein Beispiel in freier Wildbahn ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lojax</a> .  Angreifer nahmen das bekannte RwDrv.sys und verwendeten es f√ºr ihre schmutzigen Zwecke: Sie lasen das BIOS, modifizierten es und schrieben es zur√ºck.  Eine Neuinstallation von Windows hilft hier nicht weiter, da sich der Schadcode in der Firmware von SPI-Flash befindet.  Wenn das √úberschreiben des BIOS nicht erfolgreich ist (oder speziell √ºberschrieben wurde), ist dies ebenfalls unangenehm.  In jedem Fall m√ºssen Sie dem Programmierer nachfahren, um die l√§stigen Folgen zu beheben. </li><li>  Rufen Sie den SMI-Handler auf.  Erstens sind nicht alle BIOSs im ring0-Modus gleicherma√üen schutzlos gegen Code: Es gibt verschiedene Mechanismen f√ºr den Lese- / Schreibschutz. Daher kann es vorkommen, dass Sie tiefer gehen m√ºssen - in den SMM-Modus (den privilegiertesten).  Eine M√∂glichkeit, vom Kernel-Modus dorthin zu gelangen, besteht darin, den SMI-Handler zu ziehen (h√§ufig gibt es gef√§hrdete unter ihnen).  Um den SMI-Handler aufzurufen, m√ºssen Sie in der Lage sein, auf den E / A-Port zu schreiben. Dies ist nur mit ring0-Berechtigungen m√∂glich.  Das hei√üt, ein Treiber, der in E / A-Ports schreiben kann, kann einen anf√§lligen SMI-Handler erkennen, mit dem ein Angreifer Code im SMM-Modus ausf√ºhren kann.  In diesem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel verwendet der</a> Autor den Treiber RwDrv.sys. </li><li>  Informationen zum System.  Lesen des Kernelspeichers (durch Lesen des physischen Speichers), Lesen des BIOS, Informationen zu Systemeinstellungen, angeschlossenen Ger√§ten und aktivierten / deaktivierten Schutzmechanismen (durch Lesen von MSR, Steuerregistern, Zugriff auf Eingabe- / Ausgabeports) In einigen F√§llen kann ein bekannter Hypervisor erkannt werden ( wie VirtualBox <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√ºber MSR</a> ).  F√ºr diese Aufgabe ist meistens sogar ein Treiber geeignet, der nur lesen kann, nicht unbedingt schreiben muss.  Beispielsweise eignet sich RamCaptureDriver64.sys von Belkasoft zum Lesen des physischen Speichers. </li></ul><br><p>  Wenn wir verschiedene Artikel und Hinweise zu CVE analysieren, k√∂nnen wir eine Klassifizierung als potenziell gef√§hrlich beim Zugriff auf Ring3-Funktionen in den Treibern unterscheiden.  In der folgenden Tabelle sind die gef√§hrlichen Funktionen und Informationsquellen aufgef√ºhrt. </p><br><div class="scrollable-table"><table><thead><tr><th>  Identifizierte gef√§hrliche Funktionen </th><th>  Informationsquellen zu Sicherheitspraktiken </th></tr></thead><tbody><tr><td>  MSR-Register lesen / schreiben </td><td>  CVE-2018-10711, CVE-2018-18535, CVE-2018-19323, CVE-2007-5633, CVE-2007-5761 </td></tr><tr><td>  Lese- / Schreib-E / A-Ports </td><td>  CVE-2018-10712, CVE-2018-18536, CVE-2018-19322 </td></tr><tr><td>  Physischer Speicher lesen / schreiben </td><td>  CVE-2018-16712, CVE-2018-10710, CVE-2017-15302, CVE-2017-15303, CVE-2018-19321 </td></tr><tr><td>  Steuerregister lesen / schreiben </td><td>  CVE-2018-10709, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eset - Windows-Nutzung im Jahr 2016</a> </td></tr><tr><td>  Zugriff auf Leistungs- / Taktz√§hler </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Leif Uhsadel, Andy Georges und Ingrid Verbauwhed - Nutzung von Hardware-Leistungsindikatoren</a> </td></tr><tr><td>  Lese- / Schreibflagregister </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wojtczuk R., Rutkowska J. Nach dem wei√üen Kaninchen: Software-Angriffe gegen Intel VT-d-Technologie</a> </td></tr><tr><td>  Cache-Zugriffsanweisungen </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erkennung von Cache-basierten Seitenkanalangriffen durch Intel Cache Monitoring-Technologie und Hardware-Leistungsindikatoren</a> </td></tr></tbody></table></div><br><p>  Und dies ist nicht die ganze Liste m√∂glicher gef√§hrlicher Funktionen.  Sie k√∂nnen auch √ºber das Lesen / Schreiben des virtuellen Kernelspeichers, das Lesen / Schreiben von MMIO, den Zugriff auf PCI-Ger√§te usw. sprechen. </p><br><p>  Die ersten drei Funktionen sind sowohl von gr√∂√ütem Interesse als auch von gr√∂√üter Gefahr (und am wahrscheinlichsten, einen Treiber mit solchen Funktionen zu finden): Lesen / Schreiben von MSR-Registern, Lesen / Schreiben von E / A-Ports, Lesen / Schreiben von physischem Speicher.  Mithilfe von Steuerregistern k√∂nnen Sie einige Schutzmechanismen umgehen. Durch Schreiben in das Flag-Register k√∂nnen Sie Lese- / Schreib-Ein- / Ausgabeports in Ring3 aktivieren (dies wird √ºbrigens in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem</a> Artikel √ºber Habr erw√§hnt), den Erfolg von Angriffen auf Kan√§le von Drittanbietern (durch Zugriff auf den Cache, √úberwachung von Z√§hlern) Leistung / Zyklen) ist h√∂chstwahrscheinlich unwahrscheinlich. </p><br><p>  W√§hrend der Erstellung dieses Materials auf der DEFCON 27-Konferenz in Las Vegas stellten die Forscher Jesse Michael und Mickey Shkatov die Arbeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚Äû</a> Verlassen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie den Kernel, wenn Sie nicht fahren k√∂nnen‚Äú vor</a> , in der auch dieses Problem behandelt wird. Wir empfehlen Ihnen, dieses Material zu studieren, um das Bild zu vervollst√§ndigen.  Die Szenarien f√ºr die Verwendung solcher Treiber sind sehr einfach und klar, und es werden Beispiele f√ºr Codeabschnitte vorgestellt, die f√ºr die kritischsten Funktionen verantwortlich sind.  Und bietet auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code</a> zum Arbeiten und Finden √§hnlicher Treiber. </p><br><p>  Generell ist anzumerken, dass sich dieses Thema seit langem mit Sicherheitsforschern befasst.  Bereits 2018 schrieb der Forscher Alexander Matrosov in seinem Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Was macht Betriebssystemtreiber f√ºr das BIOS gef√§hrlich?"</a>  hat diese Frage aufgeworfen und gezeigt, wie einfach es ist, das BIOS zu nutzen. </p><br><h2 id="drayvery-s-funkciyami-dvoynogo-naznacheniya">  <strong>Doppelfunktionstreiber</strong> </h2><br><p>  Nachfolgend sind die bekanntesten Vertreter von Fahrern mit Doppelfunktionen aufgef√ºhrt. </p><br><ul><li><p>  RwDrv.sys ist ein sehr beliebter Treiber (wird mit dem Dienstprogramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RWeverything geliefert</a> ).  Liest und schreibt physischen Speicher, E / A-Ports, MSR- und Steuerregister.  Es wurde wiederholt in verschiedenen PoCs und dann im zuvor erw√§hnten Lojax-Rootkit verwendet.  Eine <a href="">Schnittstelle ist daf√ºr</a> in C ++ geschrieben und wird auch in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chipsec verwendet</a> . </p><br></li><li><p>  cpuz / gpuz </p><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="561208359383097346"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p>  Liest und schreibt physischen Speicher, Ports und MSR.  Es gibt mehrere PoC-Dienstprogramme, die es verwenden ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ). </p><br></li><li><p>  pcdsrvc_x64 - Treiber von Dell, f√ºr weitere Informationen kontaktieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesen</a> Beitrag.  Erm√∂glicht das Lesen / Schreiben von physischem Speicher in E / A-Ports. </p><br></li><li><p>  AsIO64.sys <br><img src="https://habrastorage.org/webt/nt/lv/kt/ntlvkt0qhmrs_otokd_exel9bqw.png" alt="Bild"><br>  Es bietet die M√∂glichkeit, physischen Speicher und E / A-Ports zu lesen / schreiben und verf√ºgt √ºber eine praktische DLL zum Ausf√ºhren dieser Anforderungen. </p><br></li><li><p>  Asmmap64.sys ist ein weiterer Treiber von ASUS, mit dem Sie physischen Speicher, E / A-Ports und MSR lesen / schreiben k√∂nnen.  F√ºr einen Angreifer w√§re dies besonders angenehm, da der Zugriff auf den Treiber von einem normalen Benutzer ohne Administratorrechte erfolgen kann.  Neugierige k√∂nnen sich an die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> wenden. </p><br></li><li><p>  ntiolib_x64.sys / winio64.sys - Treiber von MSI, die im zuvor genannten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> ausf√ºhrlich beschrieben werden.  Mit ntiolib_x64.sys k√∂nnen Sie physischen Speicher, E / A-Ports und MSR lesen / schreiben. Winio64.sys bietet alle diese Funktionen au√üer MSR. </p><br></li></ul><br><p>  Normalerweise werden die beschriebenen gef√§hrlichen Funktionen als Sicherheitsl√ºcken erkannt, wenn der Treiber f√ºr den Benutzer ohne Administratorrechte zug√§nglich ist (falsche ACL) oder wenn er die direkte Ausf√ºhrung von beliebigem Code erm√∂glicht (wie in bandainamcoonline.sys).  In anderen F√§llen handelt es sich nur um Funktionen. Da der Benutzer √ºber Administratorrechte verf√ºgt, kann er alle Treiberfunktionen verwenden. Dies ist die Norm. </p><br><p>  Wenn Sie glauben, dass es nicht mehr als ein Dutzend solcher Treiber gibt, irren Sie sich sehr.  Sie k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diese Auswahl</a> interessanter Treiber sehen.  Diese Liste enth√§lt Treiber von ASUS, AVAST, Razer, LG, American Megatrends und anderen bekannten Unternehmen.  Es gibt also viele davon, Sie m√ºssen nur suchen.  Sie stellen also eine echte Bedrohung dar. </p><br><p>  Diese Bedrohung wird auch von Microsoft-Mitarbeitern verstanden.  Und sie werden f√ºr Informationen √ºber solche Fahrer dankbar sein;) <br><img src="https://habrastorage.org/webt/ch/cd/pt/chcdptm1b5s848omknbcd0sr-im.png" alt="Bild"></p><br><h2 id="rekomendacii">  <strong>Empfehlungen</strong> </h2><br><p>  F√ºr Benutzer: </p><br><ul><li>  Sie sollten nicht unn√∂tig unter dem Administratorkonto sitzen und die Benutzerkontensteuerung deaktivieren (obwohl es nicht schwierig ist, sie zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">umgehen</a> ). </li><li>  Sie k√∂nnen den Detektor installieren, der versucht, Treiber zu installieren (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ). </li><li>  Wenn Dienstprogramme mit solchen Treibern verwendet werden m√ºssen (Diagnose, Aktualisierung des BIOS usw.), entfernen Sie die Treiber nach der Verwendung. </li><li>  Richten Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Device Guard ein</a> (wenn Sie ein gl√ºcklicher Besitzer von Windows 10 sind).  Mit dieser Technologie k√∂nnen Sie Ihre eigene Code-Integrit√§tsrichtlinie erstellen und wei√üe Listen mit Programmen und Zertifikaten hinzuf√ºgen.  F√ºgen Sie der Richtlinie beispielsweise die Anforderung hinzu, dass jeder Kernelmodustreiber eine Microsoft WHQL-Signatur haben muss.  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem</a> Beitrag k√∂nnen Sie sich besser mit dem Einstellen von Device Guard f√ºr diesen Zweck vertraut machen. </li></ul><br><p>  Hersteller sind besser dran, solche Treiber nicht zu unterschreiben.  Wenn der Benutzer das BIOS aktualisieren, das System auf Schwachstellen (Hallo, Chipsec) √ºberpr√ºfen, die Leistung messen oder andere Manipulationen durchf√ºhren muss, die die Installation solcher Treiber erfordern, kann er sehr gut in den Testmodus wechseln, all dies tun und dann beenden.  Die Benutzerfreundlichkeit wird dann sinken, aber die Sicherheit wird zunehmen. </p><br><h2 id="vyvody">  <strong>Schlussfolgerungen</strong> </h2><br><p>  Wenn etwas signiert ist, k√∂nnen Sie ihm trotzdem nicht vertrauen.  Erstens k√∂nnen Sie so etwas signieren, und zweitens kann ein Angreifer diesen signierten nutzen (selbst wenn er von einem vertrauensw√ºrdigen Hersteller stammt). </p><br><p>  Spezialisten f√ºr Informationssicherheit sollten Situationen, in denen ein Angreifer einen Fahrer mit gef√§hrlichen Funktionen ben√∂tigt, um einen Angriff auszuf√ºhren, nicht von den Bedrohungsmodellen ausschlie√üen.  Es gibt genug solche Treiber, das ist ganz einfach.  Wenn der Angriff nicht mit einem Pop-Treiber wie RwEverything ausgef√ºhrt wird, sondern mit einem weniger bekannten, ist es noch schwieriger, ihn zu erkennen.  Sie m√ºssen also auf der Hut sein, solche Dinge √ºberwachen und nicht jedem Treiber erlauben, das System zu starten. </p><br><p>  Verfasser: Elizaveta Khomenko </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468691/">https://habr.com/ru/post/de468691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468677/index.html">Die Ank√ºndigung des Smartphones Xiaomi Mi Mix Alpha</a></li>
<li><a href="../de468679/index.html">Das ABC der Sicherheit in Kubernetes: Authentifizierung, Autorisierung, Pr√ºfung</a></li>
<li><a href="../de468683/index.html">Theorie und Praxis der Standardisierung von Docker-Diensten</a></li>
<li><a href="../de468687/index.html">Wir analysieren die neuen Initiativen der Zentralbank zur Regulierung des Aktienmarktes: 3 Investorengruppen, Einschr√§nkungen f√ºr Anf√§nger</a></li>
<li><a href="../de468689/index.html">Registrierung Ihres IT-Gesch√§fts in Singapur: Was soll ich tun?</a></li>
<li><a href="../de468693/index.html">Wie Automatisierung Walmart-Mitarbeiter zerst√∂rt</a></li>
<li><a href="../de468695/index.html">Mein erster Hack: Eine Site, auf der Sie ein beliebiges Benutzerkennwort festlegen k√∂nnen</a></li>
<li><a href="../de468697/index.html">DB & DWH MeetUp # 5 bei der Raiffeisenbank</a></li>
<li><a href="../de468703/index.html">Wie kann ein Programmierer noch mehr verdienen?</a></li>
<li><a href="../de468705/index.html">Videoanruf im Browser auf PeerJS. Schnellstart</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>