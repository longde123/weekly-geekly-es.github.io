<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî° üèôÔ∏è üêú Nouvelle infrastructure informatique pour le centre de donn√©es de la poste russe üåë üçî ‚úñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je suis s√ªr que tous les lecteurs de Habr ont command√© au moins une fois des marchandises dans des magasins en ligne √† l'√©tranger, puis sont all√©s rec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nouvelle infrastructure informatique pour le centre de donn√©es de la poste russe</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/484090/">  Je suis s√ªr que tous les lecteurs de Habr ont command√© au moins une fois des marchandises dans des magasins en ligne √† l'√©tranger, puis sont all√©s recevoir des colis √† la poste russe.  Pouvez-vous imaginer l'ampleur de cette t√¢che du point de vue de l'organisation logistique?  Multipliez le nombre de clients par le nombre de leurs achats, imaginez une carte de notre vaste pays, et il y a plus de 40000 bureaux de poste dessus ... Au fait, en 2018, la poste russe a trait√© 345 millions de colis internationaux. <br><br>  Dans cet article, nous vous expliquerons les probl√®mes rencontr√©s par Mail et comment ils ont √©t√© r√©solus par l'√©quipe LANIT-Integration, cr√©ant une nouvelle infrastructure informatique pour les centres de donn√©es. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/243/aa0/cd2/243aa0cd2d1d9e1286ab8290ba80f7a9.jpg"></div>  <i>L'un des centres logistiques modernes de la poste russe</i> <br><a name="habracut"></a><br><h2>  Avant le projet </h2><br>  En raison de la forte augmentation du nombre de colis provenant de magasins √† l'√©tranger en Chine, en Europe occidentale et en Am√©rique du Nord, la charge sur les installations logistiques de la poste russe a augment√©.  Par cons√©quent, des centres logistiques de nouvelle g√©n√©ration ont √©t√© construits qui utilisent des machines de tri de grande capacit√©.  Ils n√©cessitent le support de l'infrastructure informatique. <br><br>  L'infrastructure du centre de donn√©es √©tait obsol√®te et ne fournissait pas les performances et la fiabilit√© n√©cessaires au fonctionnement des syst√®mes d'information d'entreprise.  De plus, la poste russe a connu un manque de puissance de calcul pour lancer de nouveaux services. <br><br><h2>  Les centres de donn√©es clients et leurs probl√®mes </h2><br>  Les centres de donn√©es de la poste russe desservent plus de 40 000 objets et 85 d√©partements territoriaux.  Il existe des dizaines de services commerciaux 24h / 24 dans les centres de donn√©es, y compris des services de commerce √©lectronique. <br><br>  Aujourd'hui encore, l'entreprise utilise des syst√®mes de stockage, d'analyse et de traitement des m√©gadonn√©es.  Pour de tels syst√®mes, l'utilisation de l'intelligence artificielle et des algorithmes d'apprentissage automatique joue un r√¥le important.  Aujourd'hui, l'un des cas les plus importants pour l'entreprise est d'optimiser la gestion des flux logistiques et d'acc√©l√©rer le service client dans les bureaux de poste. <br><br>  Avant le d√©but du projet de modernisation, il y avait environ 3 000 machines virtuelles dans les centres de donn√©es principaux et de sauvegarde, la quantit√© d'informations stock√©es d√©passait 2 p√©taoctets.  Les centres de donn√©es avaient une structure d'acheminement du trafic complexe associ√©e √† la s√©paration en diff√©rents segments en fonction des niveaux de s√©curit√©. <br><br>  Avec le d√©veloppement d'applications et l'introduction de nouveaux services, la bande passante existante des √©quipements de r√©seau dans les centres de donn√©es est devenue insuffisante.  La transition vers des interfaces avec de nouvelles vitesses √©tait n√©cessaire: 10 Gbit / s, au lieu de 1 Gbit / s √† l'acc√®s et 40 Gbit / s au niveau du c≈ìur, avec une redondance compl√®te des √©quipements et des canaux de communication. <br><br>  Le d√©partement de la s√©curit√© de l'information a re√ßu une demande de division de l'infrastructure en segments avec un haut niveau de s√©curit√© de l'information pour le trafic et les applications (PN - R√©seau priv√© et DMZ - Zone d√©militaris√©e).  Le trafic passait par les pare-feu (UIT), ce qui n'√©tait pas n√©cessaire pour filtrer.  VRF sur les commutateurs n'a pas √©t√© utilis√© pour un tel trafic.  Les r√®gles de l'UIT n'√©taient pas optimales (des dizaines de milliers de r√®gles dans chaque centre de donn√©es). <br><br>  La migration transparente des machines virtuelles (VM) entre les centres de donn√©es avec la pr√©servation de l'adresse IP et le chemin optimal du trafic entre les segments, y compris le r√©seau de donn√©es d'entreprise (KSPD), √©tait impossible. <br><br>  Pour la sauvegarde, MSTP a √©t√© utilis√©, certains ports ont √©t√© bloqu√©s (redondance d'UC).  Le noyau et les commutateurs d'acc√®s n'ont pas √©t√© combin√©s en un cluster de basculement, l'agr√©gation d'interface (LAG) n'a pas √©t√© utilis√©e. <br><br>  Avec l'av√®nement du troisi√®me centre de donn√©es, une nouvelle architecture et configuration des √©quipements √©taient n√©cessaires pour faire fonctionner l'anneau entre les centres de donn√©es (EVPN a √©t√© propos√©). <br><br>  Il n'y avait pas de concept unique pour le d√©veloppement des centres de donn√©es, document√© sous forme de projet et convenu avec tous les services du client.  La documentation actuelle pour l'exploitation du r√©seau √©tait incompl√®te et obsol√®te. <br><br><h3>  Attentes des clients </h3><br>  L'√©quipe de projet avait les t√¢ches suivantes: <br><br><ul><li>  pr√©parer l'architecture et le concept de d√©veloppement pour la construction de l'infrastructure r√©seau et serveur du troisi√®me centre de donn√©es; </li><li>  effectuer un audit op√©rationnel du r√©seau client existant; </li><li>  √©tendre la capacit√© du c≈ìur de r√©seau de plus de 1 500 ports Ethernet √† 10/40 Gbit / s dans chaque centre de donn√©es (4 500 ports au total); </li><li>  assurer le fonctionnement de l'anneau entre les trois centres de donn√©es avec la possibilit√© d'augmenter la vitesse jusqu'√† 80 Gb / s dans chacun des segments afin de combiner les ressources informatiques du client de diff√©rents centres de donn√©es en un seul syst√®me informatique; </li><li>  fournir une double r√©serve de 100% de tous les √©l√©ments du r√©seau pour atteindre le temps de disponibilit√© cible au niveau de 99,995%; </li><li>  minimiser les retards de trafic entre les machines virtuelles pour acc√©l√©rer les applications m√©tier; </li><li>  collecter des statistiques, effectuer des analyses et effectuer ensuite l'optimisation des r√®gles de filtrage du trafic dans les centres de donn√©es (il y avait initialement environ 80 000 r√®gles); </li><li>  D√©veloppez une architecture cibl√©e pour migrer en toute transparence les applications m√©tier critiques des clients vers l'un des trois centres de donn√©es. </li></ul><br>  Ainsi, nous avions quelque chose √† travailler. <br><br><h2>  √âquipement </h2><br>  Arr√™tons-nous plus en d√©tail sur les √©quipements que nous avons utilis√©s dans le projet. <br><br>  <b>Pare-feu (NGWF) USG9560:</b> <br><br><ul><li>  division en VSYS; </li><li>  jusqu'√† 720 Gbps; </li><li>  jusqu'√† 720 millions de sessions simultan√©es; </li><li>  8 emplacements. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36e/523/355/36e5233550f276b92525d264c8c79ebc.png"></div><br>  <b>Routeur NE40E-X8:</b> <br><br><ul><li>  jusqu'√† 7,08 Tbit / s de capacit√© de commutation; </li><li>  jusqu'√† 2 880 Mpps de performances de transmission; </li><li>  8 emplacements pour cartes de ligne (LPU); </li><li>  jusqu'√† 10 millions de routes BGP IPv4 par MPU; </li><li>  jusqu'√† 1500 000 routes IPv4 OSPF par MPU; </li><li>  jusqu'√† 3000K - IPv4 FIB (d√©pend de LPU). </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f74/581/f63/f74581f63475eb267481b2ecfbedf56d.png" width="500"></div><br>  <b>Commutateurs de la s√©rie CE12800:</b> <br><br><ul><li>  Virtualisation des p√©riph√©riques: VS (virtualisation 1:16), syst√®me de commutation de cluster (CSS), Super Virtual Fabric (SVF); </li><li>  Virtualisation de r√©seau: M-LAG, TRILL, pontage VXLAN et VXLAN, QinQ dans VXLAN, EVN (Ethernet Virtual Network); </li><li>  √Ä partir de VRP V2, le support EVPN est inclus. </li><li>  M-LAG - un analogue de vPC (Virtual Port Channel) chez Cisco Nexus; </li><li>  Protocole Virtual Spanning Tree (VSTP) - Compatible avec Cisco PVST. </li></ul><br>  <b>CE12804</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/038/32b/bd6/03832bbd638493fe604e0cd2df180a26.png" width="500"></div><br>  <b>CE12808</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ab/54b/f91/4ab54bf91ecef2a5607645c805adb69b.png" width="500"></div><br><h3>  Logiciels </h3><br>  Dans le projet, nous avons utilis√©: <br><br><ul><li>  convertisseur des fichiers de configuration des pare-feu d'autres fournisseurs au format de commande pour le nouvel √©quipement; </li><li>  des scripts propri√©taires pour optimiser et convertir les configurations de pare-feu. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ae/e32/aa1/5aee32aa1a46b56acb725054085288b6.png"></div>  <i>Apparence du convertisseur pour convertir les fichiers de configuration</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c05/fb0/3ea/c05fb03ea25d97c4239d18a78a7c4abd.png"></div>  <i>Le sch√©ma d'organisation de la communication entre le datacenter (EVPN VXLAN)</i> <br><br><h2>  Nuances de configuration de l'√©quipement </h2><br>  <b>CE12808</b> <br><br><ul><li>  EVPN (standard) au lieu d'EVN (propri√©taire de Huawei) pour la communication entre les centres de donn√©es: <br><br>  ‚óã L2 au-dessus de L3 en utilisant iBGP dans le plan de contr√¥le; <br>  ‚óã la formation MAC et son annonce via la famille iBGP EVPN (routes MAC, type 2); <br>  ‚óã construction automatique de tunnels VXLAN pour le trafic unicast diffus√© / inconnu (routes de multidiffusion inclusives, type 3). </li><li>  Deux modes de division sur VS: <br><br>  ‚óã bas√© sur les ports (port en mode port) ou bas√© sur ASIC (groupe en mode port, carte de port du p√©riph√©rique d'affichage); <br>  ‚óã L'interface de dimension divis√©e de port 40GE fonctionne UNIQUEMENT dans Admin VS (ind√©pendamment du mode de port). </li></ul><br>  <b>USG9560</b> <br><br><ul><li>  la possibilit√© de se diviser en VSYS, </li><li>  le routage dynamique est impossible entre VSYS et la fuite de route! </li></ul><br>  <b>CE12804</b> <br><br>  All Active GW (VRRP Master / Master / Master) avec filtrage MAC VRRP entre les centres de donn√©es <br><br> <code>acl number 4000 <br> rule 5 deny source-mac 0000-5e00-0100 ffff-ffff-ff00 <br> rule 10 deny destination-mac 0000-5e00-0100 ffff-ffff-ff00 <br> rule 15 permit <br> <br> interface Eth-Trunk1 <br> traffic-filter acl 4000 outbound</code> <br> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a5/ae3/2d8/4a5ae32d8dde225760aafa5e2695a9c6.png"></div>  <i>Sch√©ma d'interaction des ressources entre les centres de donn√©es (VXLAN EVPN et All Active GW)</i> <br><br><h2>  D√©fis du projet </h2><br>  La principale difficult√© r√©sidait dans la n√©cessit√© de r√©server les applications existantes √† l'aide d'une infrastructure informatique.  Le client avait plus de 100 applications diff√©rentes, dont certaines ont √©t√© √©crites il y a pr√®s de 10 ans.  Par exemple, si pour Yandex vous pouvez facilement √©teindre plusieurs centaines de machines virtuelles sans nuire aux utilisateurs finaux, alors dans Russian Post, cette approche n√©cessiterait le d√©veloppement d'un certain nombre d'applications √† partir de z√©ro et des changements dans l'architecture des syst√®mes d'information d'entreprise.  Nous avons r√©solu les probl√®mes survenant dans le processus de migration et d'optimisation au stade d'un audit conjoint de l'infrastructure informatique.  Toutes les nouvelles technologies de r√©seau pour l'entreprise (comme EVPN) ont √©t√© pr√©test√©es en laboratoire. <br><br><h2>  R√©sum√© du projet </h2><br>  L'√©quipe de projet comprenait des sp√©cialistes de <a href="https://itlanit.ru/">LANIT-Integration</a> , le client et ses partenaires dans le fonctionnement de l'infrastructure informatique.  Des √©quipes d'assistance d√©di√©es de fournisseurs (Check Point et Huawei) ont √©galement √©t√© constitu√©es.  Le projet a dur√© deux ans.  Voici ce qui a √©t√© fait pendant cette p√©riode. <br><br><ul><li>  Une strat√©gie pour le d√©veloppement d'un r√©seau de centres de donn√©es, d'un r√©seau de donn√©es d'entreprise (KSPD) et d'un anneau entre les centres de donn√©es a √©t√© √©labor√©e et convenue avec tous les services clients. </li><li>  La disponibilit√© des services a augment√©.  Cela a √©t√© not√© par l'activit√© du client et a conduit √† une croissance du trafic encore plus importante en raison de l'introduction de nouveaux services. </li><li>  Plus de 40 000 r√®gles ont √©t√© migr√©es et optimis√©es de FWSM / ASA vers USG 9560. Diff√©rents contextes ASA sur UGG 9560 sont combin√©s en une seule politique de s√©curit√©. </li><li>  Le d√©bit du port du centre de donn√©es est pass√© de 1G √† 10 / 40G gr√¢ce √† l'utilisation de CE12800 / CE6850.  Cela a √©limin√© la congestion de l'interface et la perte de paquets. <br></li><li>  Les routeurs de classe op√©rateur NE40E-X8 ont enti√®rement couvert les besoins du centre de donn√©es du client et de KSPD en tenant compte du d√©veloppement commercial futur. </li><li>  Huit nouvelles demandes de fonctionnalit√©s ont √©t√© demand√©es pour USG 9560. Parmi celles-ci, sept ont d√©j√† √©t√© impl√©ment√©es et sont incluses dans la version actuelle de VRP.  1 FR - en vente chez R&amp;D Huawei.  Il s'agit d'un cluster de huit ch√¢ssis avec la possibilit√© de configurer les fonctionnalit√©s n√©cessaires pour synchroniser la configuration sans synchroniser les sessions.  Il est n√©cessaire si le retard de circulation vers l'un des centres de donn√©es est trop important (Adler - Moscou 1300 km sur l'autoroute principale et 2800 km sur l'autoroute de secours). </li></ul><br>  Le projet n'a pas d'analogues par rapport √† d'autres soci√©t√©s postales russes. <br><br>  La modernisation de l'infrastructure r√©seau du centre de donn√©es a ouvert de nouvelles opportunit√©s pour l'entreprise de d√©velopper des services num√©riques. <br><br><ul><li>  Fournir un compte personnel et une application mobile pour les particuliers et les personnes morales. </li><li>  Int√©gration avec les magasins √©lectroniques pour fournir des services de livraison de marchandises. </li><li>  Ex√©cution - stockage de marchandises, formation et livraison de commandes de magasins √©lectroniques. </li><li>  Extension des points de livraison des commandes, notamment via les r√©seaux d'affiliation. </li><li>  Flux de travail juridiquement significatif avec les contreparties.  Cela vous permettra d'abandonner le transfert lent et co√ªteux de documents papier. </li><li>  Acceptation des lettres recommand√©es sous forme √©lectronique avec livraison √† la fois sous forme √©lectronique et sur papier (avec le cachet des envois aussi proche que possible du destinataire final).  Service de lettres recommand√©es √©lectroniques sur le portail des services publics. </li><li>  Plateforme de fourniture de services de t√©l√©m√©decine. </li><li>  R√©ception et livraison simplifi√©es du courrier recommand√© √† l'aide d'une simple signature √©lectronique. </li><li>  Num√©risation du r√©seau postal. </li><li>  Traitement des services en libre-service (terminaux et bureaux de poste). </li><li>  Cr√©ation d'une plateforme num√©rique pour la gestion d'un service de messagerie et d'une nouvelle application mobile pour les clients du service de messagerie. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Venez chez nous pour travailler!</b> <div class="spoiler_text"><ul><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-154.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2020-01-28%26utm_campaign%3Ddsi">Ing√©nieur Infrastructure Corporate</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-171.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2020-01-28%26utm_campaign%3Ddsi">Ing√©nieur Lead Linux / DevOps</a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr484090/">https://habr.com/ru/post/fr484090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr484070/index.html">Comment nous avons √©crit un syst√®me antifraude √† quatre mains et trois t√™tes</a></li>
<li><a href="../fr484072/index.html">5. Mise en route de Fortinet v6.0. NAT</a></li>
<li><a href="../fr484076/index.html">O√π stocker les crypto-monnaies: taxation des crypto-monnaies dans diff√©rents pays</a></li>
<li><a href="../fr484084/index.html">1C-Bitrix et une tentative de l'introduire</a></li>
<li><a href="../fr484088/index.html">D√©fil√© de mots de passe (analyse d'environ 5 milliards de mots de passe de fuites)</a></li>
<li><a href="../fr484092/index.html">Princes et nobles un peu habill√©s</a></li>
<li><a href="../fr484094/index.html">Cr√©ez un jeu de tir zombie √† la troisi√®me personne avec DOTS</a></li>
<li><a href="../fr484096/index.html">La bataille des deux Yakozun, ou Cassandra vs HBase. Exp√©rience de l'√©quipe Sberbank</a></li>
<li><a href="../fr484100/index.html">Utilisation de l'interface dans le SDK Google Maps pour Android</a></li>
<li><a href="../fr484102/index.html">PHP vs Python vs Ruby on Rails: comparaison d√©taill√©e</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>