<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐ป ๐๐ฟ ๐ฅ ุจูุซูู ุถุฏ. Scala ูู Apache Spark - ุนูุงูุฉ ูุฑุฌุนูุฉ ูุชููุนุฉ ุจูุชูุฌุฉ ุบูุฑ ูุชููุนุฉ ๐ง ๐จ๐ฟโ๐จ ๐จ๐ฟโ๐คโ๐จ๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฑุจูุง ูููู Apache Spark ุงูููู ูู ุงููุธุงู ุงูุฃุณุงุณู ุงูุฃูุซุฑ ุดุนุจูุฉ ูุชุญููู ุงูุจูุงูุงุช ุฐุงุช ุงูุญุฌู ุงููุจูุฑ. ูุชู ุชูุฏูู ูุณุงููุฉ ูุจูุฑุฉ ูู ุดุนุจูุชูุง ูู ุฎูุงู ุฅููุงููุฉ ุงุณุชุฎุฏุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจูุซูู ุถุฏ. Scala ูู Apache Spark - ุนูุงูุฉ ูุฑุฌุนูุฉ ูุชููุนุฉ ุจูุชูุฌุฉ ุบูุฑ ูุชููุนุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/443324/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uk/hc/yv/ukhcyvudckoey9ttm1libhqkyv8.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ุฑุจูุง ูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Apache Spark</a> ุงูููู ูู ุงููุธุงู ุงูุฃุณุงุณู ุงูุฃูุซุฑ ุดุนุจูุฉ ูุชุญููู ุงูุจูุงูุงุช ุฐุงุช ุงูุญุฌู ุงููุจูุฑ.  ูุชู ุชูุฏูู ูุณุงููุฉ ูุจูุฑุฉ ูู ุดุนุจูุชูุง ูู ุฎูุงู ุฅููุงููุฉ ุงุณุชุฎุฏุงูู ูู ุชุญุช ุจูุซูู.  ูู ุงูููุช ููุณู ุ ููุงูู ุงูุฌููุน ุนูู ุฃู ุฃุฏุงุก Python ู Scala / Java ูุดุจูุงู ุ ูู ุฅุทุงุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ุงูููุงุณูุฉ ุ ูููู ูุง ุชูุฌุฏ ูุฌูุฉ ูุธุฑ ูุงุญุฏุฉ ูููุง ูุชุนูู ุจุงููุธุงุฆู ุงููุนุฑูุฉ ูู ูุจู ุงููุณุชุฎุฏู (ุงููุธููุฉ ุงููุญุฏุฏุฉ ูู ูุจู ุงููุณุชุฎุฏู ุ UDF).  ุฏุนูุง ูุญุงูู ูุนุฑูุฉ ููููุฉ ุฒูุงุฏุฉ ุงูุชูุงููู ุงูุนุงูุฉ ูู ูุฐู ุงูุญุงูุฉ ุ ูุฐูู ุจุงุณุชุฎุฏุงู ูุซุงู ูููุฉ ุงูุชุญูู ูู ุญู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SNA Hackathon 2019</a> . </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูุฌุฒุก ูู ุงููุณุงุจูุฉ ุ ูุญู ุงููุดุงุฑููู ูุดููุฉ ูุฑุฒ ููุฌุฒ ุงูุฃุฎุจุงุฑ ูุดุจูุฉ ุงุฌุชูุงุนูุฉ ูุชุญููู ุงูุญููู ูู ุดูู ูุฌููุนุฉ ูู ุงูููุงุฆู ุงููุตููุฉ.  ููุชุญูู ูู ุฌูุฏุฉ ุงูุญู ุงูุฐู ุชู ุงูุญุตูู ุนููู ุ ุฃููุงู ุ ููู ูู ุงูููุงุฆู ุงููุญููุฉ ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชู</a> ุญุณุงุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ROC AUC</a> ุ ุซู ูุชู ุนุฑุถ ูุชูุณุท โโุงููููุฉ.  ูุฑุฌู ููุงุญุธุฉ ุฃูู ุชุญุชุงุฌ ุฅูู ุญุณุงุจ ูุง ROC AUC ูุดุชุฑู ูุงุญุฏ ุ ูููู ุญุณุงุจ ุดุฎุตู ููู ูุณุชุฎุฏู - ูุง ููุฌุฏ ุชุตููู ุฌุงูุฒ ูุญู ูุฐู ุงููุดููุฉ ุ ูุฐูู ุณูููู ุนููู ูุชุงุจุฉ ูุธููุฉ ูุชุฎุตุตุฉ.  ุณุจุจ ูุฌูู ูููุงุฑูุฉ ุงูููุฌูู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ. </p><br><p style=";text-align:right;direction:rtl"> ูููุตุฉ ููุงุฑูุฉ ุ ุณูู ูุณุชุฎุฏู ุญุงููุฉ ุณุญุงุจูุฉ ูุน ุฃุฑุจุนุฉ ููู ูุฅุทูุงู Spark ูู ุงููุถุน ุงููุญูู ุ ูุณูุนูู ูุนูุง ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Apache Zeppelin</a> .  ูููุงุฑูุฉ ุงููุธููุฉ ุ ุณูุธูุฑ ููุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑูุฒ</a> ูู PySpark ู Scala Spark.  [ููุง] ููุจุฏุฃ ุจุชุญููู ุงูุจูุงูุงุช. </p><br><pre style=";text-align:right;direction:rtl"><code class="python hljs">data = sqlContext.read.csv(<span class="hljs-string"><span class="hljs-string">"sna2019/modelCappedSubmit"</span></span>) trueData = sqlContext.read.csv(<span class="hljs-string"><span class="hljs-string">"sna2019/collabGt"</span></span>) toValidate = data.withColumnRenamed(<span class="hljs-string"><span class="hljs-string">"_c1"</span></span>, <span class="hljs-string"><span class="hljs-string">"submit"</span></span>) \ .join(trueData.withColumnRenamed(<span class="hljs-string"><span class="hljs-string">"_c1"</span></span>, <span class="hljs-string"><span class="hljs-string">"real"</span></span>), <span class="hljs-string"><span class="hljs-string">"_c0"</span></span>) \ .withColumnRenamed(<span class="hljs-string"><span class="hljs-string">"_c0"</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>) \ .repartition(<span class="hljs-number"><span class="hljs-number">4</span></span>).cache() toValidate.count()</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> data = sqlContext.read.csv(<span class="hljs-string"><span class="hljs-string">"sna2019/modelCappedSubmit"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> trueData = sqlContext.read.csv(<span class="hljs-string"><span class="hljs-string">"sna2019/collabGt"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> toValidate = data.withColumnRenamed(<span class="hljs-string"><span class="hljs-string">"_c1"</span></span>, <span class="hljs-string"><span class="hljs-string">"submit"</span></span>) .join(trueData.withColumnRenamed(<span class="hljs-string"><span class="hljs-string">"_c1"</span></span>, <span class="hljs-string"><span class="hljs-string">"real"</span></span>), <span class="hljs-string"><span class="hljs-string">"_c0"</span></span>) .withColumnRenamed(<span class="hljs-string"><span class="hljs-string">"_c0"</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>) .repartition(<span class="hljs-number"><span class="hljs-number">4</span></span>).cache() toValidate.count()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูููุงุณูุฉ ุ ุชููู ุงููููุฉ ุงููุงููุฉ ุชูุฑูุจูุง ููุดูุฑุฉ ุฌุฏูุฑุฉ ุจุงูููุงุญุธุฉ ุ ุญุชู ุงููููุฉ ุงูุฑุฆูุณูุฉ <code>val</code> .  ููุช ุงูุชุดุบูู ูุง ูุฎุชูู ูุซูุฑุง.  ุงูุขู ุฏุนููุง ูุญุงูู ุชุญุฏูุฏ UDF ุงูุชู ูุญุชุงุฌูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">parse = sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"parse"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: [int(s.strip()) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> x[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">-1</span></span>].split(<span class="hljs-string"><span class="hljs-string">","</span></span>)], ArrayType(IntegerType())) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(submit, real)</span></span></span><span class="hljs-function">:</span></span> trueSet = set(real) scores = [<span class="hljs-number"><span class="hljs-number">1.0</span></span> / (i + <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i,x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(submit)] labels = [<span class="hljs-number"><span class="hljs-number">1.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> trueSet <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> submit] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(roc_auc_score(labels, scores)) auc_udf = sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"auc"</span></span>, auc, DoubleType())</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> parse = sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"parse"</span></span>, (x : <span class="hljs-type"><span class="hljs-type">String</span></span>) =&gt; x.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>,x.size - <span class="hljs-number"><span class="hljs-number">1</span></span>).split(<span class="hljs-string"><span class="hljs-string">","</span></span>).map(_.trim.toInt)) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AucAccumulator</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">height: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-class"><span class="hljs-params">, area: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-class"><span class="hljs-params">, negatives: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">val</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auc_udf</span></span></span><span class="hljs-class"> </span></span>= sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"auc"</span></span>, (byScore: <span class="hljs-type"><span class="hljs-type">Seq</span></span>[<span class="hljs-type"><span class="hljs-type">Int</span></span>], gt: <span class="hljs-type"><span class="hljs-type">Seq</span></span>[<span class="hljs-type"><span class="hljs-type">Int</span></span>]) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> byLabel = gt.toSet <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> accumulator = byScore.foldLeft(<span class="hljs-type"><span class="hljs-type">AucAccumulator</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))((accumulated, current) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (byLabel.contains(current)) { accumulated.copy(height = accumulated.height + <span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { accumulated.copy(area = accumulated.area + accumulated.height, negatives = accumulated.negatives + <span class="hljs-number"><span class="hljs-number">1</span></span>) } }) (accumulator.area).toDouble / (accumulator.negatives * accumulator.height) })</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุชูููุฐ ูุธููุฉ ูุญุฏุฏุฉ ุ ูู ุงููุงุถุญ ุฃู Python ุชููู ุฃูุซุฑ ุฅูุฌุงุฒูุง ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุนุฒู</a> ุฐูู ุจุดูู ุฃุณุงุณู ุฅูู ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู ูุธููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">scikit-Learn</a> ุงููุถููุฉ.  ููุน ุฐูู ุ ููุงู ูุญุธุงุช ุบูุฑ ุณุงุฑุฉ - ูุฌุจ ุนููู ุชุญุฏูุฏ ููุน ุงููููุฉ ุงููุฑุฌุนุฉ ุจุดูู ุตุฑูุญ ุ ูู ุญูู ูุชู ุชุญุฏูุฏูุง ูู Scala ุชููุงุฆููุง.  ุฏุนูุง ูููุฐ ุงูุนูููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">toValidate.select(auc_udf(parse(<span class="hljs-string"><span class="hljs-string">"submit"</span></span>), parse(<span class="hljs-string"><span class="hljs-string">"real"</span></span>))).groupBy().avg().show()</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">toValidate.select(auc_udf(parse($<span class="hljs-string"><span class="hljs-string">"submit"</span></span>), parse($<span class="hljs-string"><span class="hljs-string">"real"</span></span>))).groupBy().avg().show()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุจุฏู ุงูุฑูุฒ ูุชุทุงุจููุง ุชูุฑูุจูุง ุ ูููู ุงููุชุงุฆุฌ ุบูุฑ ูุดุฌุนุฉ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vc/jw/y_/vcjwy_zwvfbkb_jlw6mimlogdwi.png"></p><br><p style=";text-align:right;direction:rtl">  ุชู ุชูููุฐ PySpark ููุฏุฉ ุฏูููุฉ ููุตู ุจุฏูุงู ูู ุซุงููุชูู ุนูู Scala ุ ุฃู ุฃู <strong>Python ุฃุตุจุญ 45 ูุฑุฉ ุฃุจุทุฃ</strong> .  ุฃุซูุงุก ุงูุชุดุบูู ุ ููุธูุฑ ุฃุนูู 4 ุนูููุงุช ุจูุซูู ูุดุทุฉ ุชุนูู ุจูุงูู ุทุงูุชูุง ุ ููุฐุง ูุดูุฑ ุฅูู ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู ุงููุชุฑุฌู ุงูุนุงููู</a> ูุง ูุฎูู ูุดุงูู ููุง.  ูููู!  ุฑุจูุง ุชููู ุงููุดููุฉ ูู ุงูุชุทุจูู ุงูุฏุงุฎูู ูุจุฑูุงูุฌ scikit-learn - ุฏุนููุง ูุญุงูู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุฑูุฒ Python ุญุฑูููุง ุ ุฏูู ุงููุฌูุก ุฅูู ุงูููุชุจุงุช ุงูููุงุณูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(submit, real)</span></span></span><span class="hljs-function">:</span></span> trueSet = set(real) height = <span class="hljs-number"><span class="hljs-number">0</span></span> area = <span class="hljs-number"><span class="hljs-number">0</span></span> negatives = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> candidate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> submit: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> candidate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> trueSet: height = height + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: area = area + height negatives = negatives + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(area) / (negatives * height) auc_udf_modified = sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"auc_modified"</span></span>, auc, DoubleType()) toValidate.select(auc_udf_modified(parse(<span class="hljs-string"><span class="hljs-string">"submit"</span></span>), parse(<span class="hljs-string"><span class="hljs-string">"real"</span></span>))).groupBy().avg().show()</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cx/o2/io/cxo2ioxdl18a6djwsmgr6dravhy.png"></p><br><p style=";text-align:right;direction:rtl">  ุงูุชุฌุฑุจุฉ ุชุธูุฑ ูุชุงุฆุฌ ูุซูุฑุฉ ููุงูุชูุงู.  ูู ูุงุญูุฉ ุ ูุน ูุฐุง ุงูููุฌ ุ ูุงูุช ุงูุฅูุชุงุฌูุฉ ูุณุชููุฉ ุ ูููู ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุงุฎุชูุช ุงููุงููููุฉ.  ูุฏ ุชุดูุฑ ุงููุชุงุฆุฌ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุฅูู ุฃูู ุนูุฏ ุงูุนูู ูู Python ุจุงุณุชุฎุฏุงู ูุญุฏุงุช C ++ ุฅุถุงููุฉ ุ ุชุธูุฑ ุงููููุงุช ุงูุนุงูุฉ ุงููุงูุฉ ููุชุจุฏูู ุจูู ุงูุณูุงูุงุช.  ุจุงูุทุจุน ุ ููุงู ุญูู ููุงุซู ุนูุฏ ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">JNI</a> ูู Java / Scala ุ ููููู ูู ุฃุถุทุฑ ุฅูู ุงูุชุนุงูู ูุน ุฃูุซูุฉ ุชุฏููุฑ 45 ูุฑุฉ ุนูุฏ ุงุณุชุฎุฏุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ููุญุตูู ุนูู ุชุญููู ุฃูุซุฑ ุชูุตูููุง ุ ุณูููู ุจุฅุฌุฑุงุก ุชุฌุฑุจุชูู ุฅุถุงููุชูู: ุงุณุชุฎุฏุงู Python ุฎุงูุต ุจุฏูู Spark ูููุงุณ ุงููุณุงููุฉ ูู ุงุณุชุฏุนุงุก ุงูุญุฒูุฉ ุ ููุน ุฒูุงุฏุฉ ุญุฌู ุงูุจูุงูุงุช ูู Spark ูุฅุทูุงุก ุงููููุงุช ุงูุนุงูุฉ ูุงูุญุตูู ุนูู ููุงุฑูุฉ ุฃูุซุฑ ุฏูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [int(s.strip()) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> x[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">-1</span></span>].split(<span class="hljs-string"><span class="hljs-string">","</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(submit, real)</span></span></span><span class="hljs-function">:</span></span> trueSet = set(real) height = <span class="hljs-number"><span class="hljs-number">0</span></span> area = <span class="hljs-number"><span class="hljs-number">0</span></span> negatives = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> candidate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> submit: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> candidate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> trueSet: height = height + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: area = area + height negatives = negatives + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(area) / (negatives * height) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sklearn_auc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(submit, real)</span></span></span><span class="hljs-function">:</span></span> trueSet = set(real) scores = [<span class="hljs-number"><span class="hljs-number">1.0</span></span> / (i + <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i,x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(submit)] labels = [<span class="hljs-number"><span class="hljs-number">1.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> trueSet <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> submit] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> float(roc_auc_score(labels, scores))</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/bk/ul/m1/bkulm1xarplv2-f4ilyg5dtxixw.png"></p><br><p style=";text-align:right;direction:rtl">  ุฃูุฏุช ุงูุชุฌุฑุจุฉ ูุน Python ู Pandas ุงููุญููุฉ ุงูุชุฑุงุถ ูุฌูุฏ ุญูู ูุจูุฑ ุนูุฏ ุงุณุชุฎุฏุงู ุญุฒู ุฅุถุงููุฉ - ุนูุฏ ุงุณุชุฎุฏุงู scikit-learning ุ ุชูุฎูุถ ุงูุณุฑุนุฉ ุจุฃูุซุฑ ูู 20 ูุฑุฉ.  ููุน ุฐูู ุ 20 ููุณ 45 - ุฏุนููุง ูุญุงูู "ุชุถุฎูู" ุงูุจูุงูุงุช ูููุงุฑูุฉ ุฃุฏุงุก Spark ูุฑุฉ ุฃุฎุฑู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">k4 = toValidate.union(toValidate) k8 = k4.union(k4) m1 = k8.union(k8) m2 = m1.union(m1) m4 = m2.union(m2).repartition(<span class="hljs-number"><span class="hljs-number">4</span></span>).cache() m4.count()</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/zp/sf/po/zpsfpoabev7w3_xjcn0vqobwqf4.png"></p><br><p style=";text-align:right;direction:rtl">  ุชูุธูุฑ ุงูููุงุฑูุฉ ุงูุฌุฏูุฏุฉ ููุฒุฉ ุงูุณุฑุนุฉ ูุชุทุจูู Scala ุนูู Python ุจูุณุจุฉ 7-8 ูุฑุงุช - 7 ุซูุงูู ููุงุจู 55. ุฃุฎูุฑูุง ุ ุฏุนููุง ูุฌุฑุจ "ุงูุฃุณุฑุน ูู Python" - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">numpy</a> ูุญุณุงุจ ูุฌููุน ุงูุตููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy numpy_sum = sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"numpy_sum"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: float(numpy.sum(x)), DoubleType())</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> my_sum = sqlContext.udf.register(<span class="hljs-string"><span class="hljs-string">"my_sum"</span></span>, (x: <span class="hljs-type"><span class="hljs-type">Seq</span></span>[<span class="hljs-type"><span class="hljs-type">Int</span></span>]) =&gt; x.map(_.toDouble).sum)</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/og/tr/gx/ogtrgx-kkuzx4kmkh4pd5cbyd-k.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฑุฉ ุฃุฎุฑู ุชุจุงุทุค ูุจูุฑ - 5 ุซูุงู ูู ุณูุงูุง ููุงุจู 80 ุซุงููุฉ ูู ุจูุซูู.  ุจุฅูุฌุงุฒ ุ ูููููุง ุงุณุชุฎูุงุต ุงููุชุงุฆุฌ ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจูููุง ุชุนูู PySpark ูู ุฅุทุงุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูููุงุณูุฉ ุ ูููู ุฃู ุชููู ูุงุจูุฉ ููููุงุฑูุฉ ุจุณุฑุนุฉ ูู Scala. </li><li style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุธูุฑ ููุทู ูุญุฏุฏ ูู ุดูู ูุธุงุฆู ูุญุฏุฏุฉ ูู ูุจู ุงููุณุชุฎุฏู ุ ูุฅู ุฃุฏุงุก PySpark ูุชูุงูุต ุจุดูู ููุญูุธ.  ูุน ูุฌูุฏ ูุนูููุงุช ูุงููุฉ ุ ุนูุฏูุง ูุชุฌุงูุฒ ููุช ูุนุงูุฌุฉ ูุชูุฉ ุงูุจูุงูุงุช ุนุฏุฉ ุซูุงูู ุ ูููู ุชูููุฐ Python 5-10 ุฃุจุทุฃ ุจุณุจุจ ุงูุญุงุฌุฉ ุฅูู ููู ุงูุจูุงูุงุช ุจูู ุงูุนูููุงุช ููุฏุฑ ุงูููุงุฑุฏ ุนูุฏ ุชูุณูุฑ Python. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุธูุฑ ุงุณุชุฎุฏุงู ูุธุงุฆู ุฅุถุงููุฉ ุชู ุชูููุฐูุง ูู ูุญุฏุงุช C ++ ุ ูุณุชุธูุฑ ุชูุงููู ููุงููุฉ ุฅุถุงููุฉ ุ ููุฒูุฏ ุงููุฑู ุจูู Python ู Scala ูุง ุจูู 10 ุฅูู 50 ูุฑุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ุนูู ุงูุฑุบู ูู ูู ุณุญุฑ ุจูุซูู ุ ูุฅู ุงุณุชุฎุฏุงูู ูุน ุณุจุงุฑู ูุง ูุจุฏู ุฏุงุฆููุง ูุจุฑุฑูุง.  ุฅุฐุง ูู ููู ููุงู ุงููุซูุฑ ูู ุงูุจูุงูุงุช ูุฌุนู Python ุฐุงุช ุฃูููุฉ ูุจูุฑุฉ ุ ูุนููู ุงูุชูููุฑ ูููุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ุฅูู Spark ููุงุ  ุฅุฐุง ูุงู ููุงู ุงููุซูุฑ ูู ุงูุจูุงูุงุช ุ ููู ุงููุนุงูุฌุฉ ุชุญุฏุซ ูู ุฅุทุงุฑ Spark SQL API ุงูููุงุณู ุ ููู Python ูุทููุจุฉ ููุงุ </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ููุงู ุงููุซูุฑ ูู ุงูุจูุงูุงุช ูุบุงูุจูุง ูุง ูุชุนูู ุนููู ุงูุชุนุงูู ูุน ุงูููุงู ุงูุชู ุชุชุฌุงูุฒ ุญุฏูุฏ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช SQL ุ ูุนูุฏุฆุฐู ูู ุฃุฌู ุงูููุงู ุจููุณ ุงูููุฏุงุฑ ูู ุงูุนูู ุนูุฏ ุงุณุชุฎุฏุงู PySpark ุ ุณูููู ุนููู ุฒูุงุฏุฉ ุงููุชูุฉ ูู ุจุนุถ ุงูุฃุญูุงู.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ุฅูู Odnoklassniki ุ ูุฅู ุชูููุฉ ุงููููุงุช ุงูุฑุฃุณูุงููุฉ ููุฌููุนุฉ Spark ุณุชุฑุชูุน ุจูุฆุงุช ุงูููุงููู ูู ุงูุฑูุจู.  ูุฅุฐุง ุญุงููุช ุงูุงุณุชูุงุฏุฉ ูู ุงููุฏุฑุงุช ุงููุชูุฏูุฉ ูููุชุจุงุช ุจุงูุซ ูููุธู ุงูุฅูููููุฌูุฉ ุ ุฃู ุฃู ุฎุทุฑ ุงูุชุจุงุทุค ูุง ูููู ูู ุจุนุถ ุงูุฃุญูุงู ูุญุณุจ ุ ุจู ูู ุฃูุฑ ุถุฎู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุญุตูู ุนูู ุจุนุถ ุงูุชุณุงุฑุน ุจุงุณุชุฎุฏุงู ุงููุธููุฉ ุงูุฌุฏูุฏุฉ ูุณุจููุง ูููุธุงุฆู ุงููุชุฌูุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุง ูุชู ุชุบุฐูุฉ ุตู ูุงุญุฏ ูุฅุฏุฎุงู UDF ุ ูููู ุญุฒูุฉ ูู ุนุฏุฉ ุตููู ูู ุดูู Dataframe Pandas.  ููุน ุฐูู ุ ูุฅู ุชุทููุฑ ูุฐู ุงููุธููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ููุชูู ุจุนุฏ</a> ุ ูุญุชู ูู ูุฐู ุงูุญุงูุฉ ุณูููู ุงููุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุจูุฑูุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ุณูููู ุงูุจุฏูู ูู ุงูุญูุงุธ ุนูู ูุฑูู ูุงุณุน ูู ูููุฏุณู ุงูุจูุงูุงุช ุ ูุงุฏุฑูุง ุนูู ุชูุจูุฉ ุงุญุชูุงุฌุงุช ุนููุงุก ุงูุจูุงูุงุช ุจุณุฑุนุฉ ูุน ูุธุงุฆู ุฅุถุงููุฉ.  ุฃู ูุชุบูุฑ ููุณู ูู ุนุงูู Scala ุ ูุฃูู ููุณ ุจุงูุฃูุฑ ุงูุตุนุจ: ุชูุฌุฏ ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ุงูุถุฑูุฑูุฉ ุจุงููุนู ุ ุชุธูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฑุงูุฌ ุงูุชุฏุฑูุจ</a> ุงูุชู ุชุชุฌุงูุฒ PySpark. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar443324/">https://habr.com/ru/post/ar443324/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar443314/index.html">ูุง ูู ุงูุญุจุ [ุชุฑุฌูุฉ ุงูููุงู]</a></li>
<li><a href="../ar443316/index.html">ReactJS ุงุฎุชุจุงุฑ: ูุฏู ุนูู ุญูุฑุฉ ุงูุฃุฑูุจ</a></li>
<li><a href="../ar443318/index.html">ูุชุงุจุฉ ูุญูู wasm ูู Ghidra. ุงูุฌุฒุก 1: ุจูุงู ุงููุดููุฉ ูุฅุนุฏุงุฏ ุงูุจูุฆุฉ</a></li>
<li><a href="../ar443320/index.html">ูุธุงู ุฅุฏุงุฑุฉ ุงููุซุงุฆู ุงูุฅููุชุฑูููุฉ "Vizier"</a></li>
<li><a href="../ar443322/index.html">ุฅุตุฏุงุฑ GitLab 11.8 ูุน SAST ูู JavaScript ู GitLab Pages ูููุฌููุนุงุช ุงููุฑุนูุฉ ูุชุชุจุน ุงูุฃุฎุทุงุก</a></li>
<li><a href="../ar443326/index.html">ุจูุซูู ูุงุฑุฏูููู. ุจุณูุทุฉ ูุณุฑูุนุฉ ูุฌูููุฉ</a></li>
<li><a href="../ar443330/index.html">ุฃุณุจูุน ุงูุฃูู 11: RSA 2019 ููุณุชูุจู ุฃูุซุฑ ุฅุดุฑุงูุง</a></li>
<li><a href="../ar443332/index.html">ุฑูุจูุช ุงููุทุจุฎ</a></li>
<li><a href="../ar443334/index.html">ุงููุฌู ุงูุฃุตูุฑ</a></li>
<li><a href="../ar443336/index.html">ุงูุนูู ูุน ุงููุงููุฑุง ูู ุงูุฑูุฑูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>