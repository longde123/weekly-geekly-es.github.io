<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👫 🦃 🚙 Comment créer un modèle plus précisément que transfermarkt et ne pas prédire ou ce qui affecte le coût des transferts par-dessus tout 🙌 👨🏿‍🎓 🧚🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je vais essayer de vous dire à quel point il est facile d'obtenir des résultats intéressants en appliquant simplement une approche complètement standa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment créer un modèle plus précisément que transfermarkt et ne pas prédire ou ce qui affecte le coût des transferts par-dessus tout</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468107/"><p>  Je vais essayer de vous dire à quel point il est facile d'obtenir des résultats intéressants en appliquant simplement une approche complètement standard du tutoriel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">du</a> cours <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">de machine learning aux</a> données qui ne sont pas les plus utilisées en Deep Learning.  L'essence de mon article est qu'il peut s'agir de chacun de nous, il vous suffit de regarder l'ensemble des informations que vous connaissez bien.  Pour cela, en effet, il est beaucoup plus important de bien comprendre vos données que d'être un expert des dernières structures de réseaux de neurones.  C'est, à mon avis, que nous sommes à ce point d'or dans le développement du DL, quand d'un côté c'est déjà un outil qui peut être utilisé sans avoir besoin d'être un doctorant, et de l'autre il y a encore beaucoup de domaines où personne ne l'a vraiment utilisé, si vous regardez Un peu plus loin que les thèmes traditionnels. </p><br><p><img src="https://habrastorage.org/webt/id/tl/1d/idtl1dxx4ixh6ycstgzi8nsn8ks.jpeg"></p><a name="habracut"></a><br><p>  En lisant des articles et en passant en regardant comment le machine learning se développe, vous et moi pouvons facilement avoir l'impression que ce train passe.  En effet, si vous suivez les cours les plus connus (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Andrew Ng</a> ) ou la plupart des articles sur Habré de la même excellente communauté d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Open Data Science, vous vous</a> rendez très vite compte que sans creuser les profondeurs de la mémoire du savoir universitaire en mathématiques supérieures il n'y a rien à faire, enfin, du moins certains des résultats raisonnables (même dans des exemples de « <em>jouets</em> ») ne peuvent être obtenus qu'après plusieurs semaines d'étude de la théorie de l'éponge et des différentes manières de la mettre en œuvre.  Mais souvent, vous en voulez un autre, vous voulez avoir un outil qui remplit sa fonction, qui résout une certaine classe de problèmes, de sorte que, en l'appliquant dans votre domaine, obtenez le résultat.  En effet, dans d'autres domaines, tout est exactement le cas, si vous, par exemple, écrivez un jeu et que votre tâche est d'assurer le transfert d'informations d'un joueur vers un serveur, alors vous n'étudiez pas la théorie des graphes, ne savez pas comment optimiser la connectivité pour que vos paquets atteignent plus rapidement - vous prenez un outil (bibliothèque, framework) qui le fait pour vous et se concentre sur ce qui est unique à une tâche particulière (par exemple, quel type d'informations vous devez transférer dans les deux sens).  Pourquoi n'en est-il pas ainsi pour l'apprentissage en profondeur? </p><br><p>  En fait, nous sommes maintenant au bord du temps où cela devient <em>presque comme ça</em> .  Et pour moi, j'ai <em>presque trouvé cet</em> outil oh - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">fast.ai.</a>  Une excellente bibliothèque et un cours <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">encore plus raide, dont le</a> principe entier est juste construit de haut en bas: d'abord résoudre des problèmes réels, souvent au niveau de la précision de la prédiction des modèles State Of The Art, jusqu'à la structure interne de la bibliothèque et la théorie qui la sous-tend. </p><br><div class="spoiler">  <b class="spoiler_title">Bien sûr, tout n'est pas si simple.</b> <div class="spoiler_text"><p>  Anticipant les accusations de manque de professionnalisme et la superficialité de mes connaissances (ce qui, bien sûr, est plus vrai qu'improbable), je veux faire une réserve tout de suite.  Faut-il étudier la théorie, regarder ces conférences très fondamentales, se souvenir du calcul matriciel, etc.?  Bien sûr que oui.  Et plus vous approfondissez le sujet, plus vous en aurez besoin et vous devrez vous accrocher aux sources primaires.  Mais plus l'immersion sera consciente, plus il sera facile de comprendre exactement comment ces principes fondamentaux affectent le résultat.  Tout l'intérêt du principe descendant est précisément qu'il doit être fait après.  Après avoir écrit quelque chose de tangible que vous pouvez montrer à vos amis.  Après vous être plongé suffisamment dans le sujet et cela vous a fasciné.  Et la théorie du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">savoir</a> vous dépassera, elle est juste présentée au moment même où il sera plus facile pour vous de la corréler avec ce que vous avez déjà fait.  Pour expliquer pourquoi et comment cela fonctionne réellement. </p><br><p>  Je suis plus que sûr que quelqu'un est plus à l'aise avec l'approche ascendante traditionnelle.  Et c'est bien qu'il y ait les deux façons, l'essentiel est que nous nous rencontrions au milieu </p></div></div><br><p>  Avec un tel ensemble de connaissances, j'ai décidé d'appliquer DL à un sujet qui m'intéresse depuis longtemps et de voir à quoi cela peut conduire.  Et, bien sûr, la première chose qui m'est venue à l'esprit était le football.  Et quand j'ai trouvé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ces merveilleuses statistiques de</a> transfert sur kaggle, le choix est devenu d'autant plus évident. </p><br><p>  Un peu sur ces données.  Ils contiennent des informations sur qui et où a évolué vers le football européen au cours des 10 dernières années.  Il y a des informations sur les clubs, les statistiques des joueurs, les ligues auxquelles ils participent, les entraîneurs et les agents, et bien plus encore (il y a plus d'une centaine de domaines différents au total).  Les données sont très intéressantes, mais est-il possible de déterminer combien un joueur devrait en coûter? </p><br><p><img src="https://habrastorage.org/webt/q9/n8/bb/q9n8bbmosrfwyf0bhzu7pio3o0u.jpeg"></p><br><p>  Si vous y réfléchissez, le prix d'un joueur dépend d'un grand nombre de facteurs.  En même temps, c'est super, <strong>et</strong> moi (sinon la plupart) leur part est tout simplement non formalisable.  Comment comprendre que le club vient de vendre le joueur à un prix élevé, a besoin d'un attaquant et est tout à fait prêt à payer trop cher pour lui;  comment comprendre qu'un nouvel entraîneur est venu et nécessite la mise à jour de la liste;  comment comprendre que le principal défenseur du club a remarqué le grand et qu'il a commencé à jouer sans enthousiasme, exigeant un transfert?  Tout cela affecte fondamentalement le montant d'une transaction, mais n'est pas présenté dans les données.  De là, mes attentes initiales quant à l'exactitude d'une telle prévision étaient faibles. </p><br><div class="spoiler">  <b class="spoiler_title">Je suis un faux programmeur</b> <div class="spoiler_text"><p> À ce stade, il est temps d'insérer la clause de non-responsabilité standard que <code>#</code> ne <code>#</code> pas un <code>#</code> , je ne gagne pas d'argent avec cela, donc mon code est terrible, et il est très probable qu'il puisse (et devrait?) Être réécrit beaucoup mieux, mais puisque la tâche consistait à enquêter sur l'idée et (pas ?) Confirmez la théorie, alors le code est ce qu'il est :) </p></div></div><br><h4 id="model">  Modèle </h4><br><p>  J'ai commencé par exclure les transferts de moins d'un million de dollars, qui sont trop chaotiques.  Il a ensuite rassemblé toutes les données dans un grand tableau avec cent et demi champs, dans lequel, pour chaque transfert, il y avait toutes les informations disponibles à son sujet (à la fois sur le transfert lui-même, le joueur et ses statistiques, ainsi que sur les clubs qui y participent, les ligues, etc.). ) </p><br><p>  Regardons les étapes de la création du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">modèle</a> : </p><br><p>  Après avoir terminé toutes les importations Python et chargé la table de transfert dénormalisée, la première chose que nous devons déterminer est lequel des champs nous considérons comme numériques et lesquels sont catégoriques.  C'est un sujet très intéressant en soi, vous pouvez en parler dans les commentaires, mais pour gagner du temps, je décris simplement la règle que j'utilise: par défaut, je considère tous les champs catégoriques, à l'exception de ceux qui sont représentés par des nombres à virgule flottante ou ceux où le nombre de valeurs différentes est suffisamment grand. </p><br><p>  Dans ce contexte, par exemple, je considère l'année de transfert comme catégorique, bien qu'il s'agisse initialement d'un nombre, car le nombre de valeurs différentes est faible ici (10 - de 2008 à 2018).  Mais, par exemple, la performance du joueur la saison dernière (qui est représentée par le nombre moyen de ses buts par match) est un flottant et peut prendre presque n'importe quelle valeur, donc je la considère comme numérique. </p><br><pre> <code class="python hljs">cat_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'season'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_year'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_month'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_day'</span></span>,<span class="hljs-string"><span class="hljs-string">'trs_till_deadline'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_months'</span></span>, <span class="hljs-string"><span class="hljs-string">'contract_left_years'</span></span>,<span class="hljs-string"><span class="hljs-string">'age'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_midseason'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_loan'</span></span>,<span class="hljs-string"><span class="hljs-string">'is_end_of_loan'</span></span>, <span class="hljs-string"><span class="hljs-string">'nat_national_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_main'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_positions'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_nationality_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_other_nationality_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_place_of_birth_country_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_foot'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_height'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_player_agent'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_club_is_first_team'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_place'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_qualified_to'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_is_cup_winner'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_is_promoted'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_country'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_lg_group'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_club_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_club_is_first_team'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_place'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_qualified_to'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_is_champion'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_cup_winner'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_is_promoted'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_name'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_lg_country'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_clb_lg_group'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_coach_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'to_sport_dir_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_position_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_position_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_name_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_leag_grp_2'</span></span>) cont_vars_tpl = (<span class="hljs-string"><span class="hljs-string">'nat_months_from_debut'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_matches_played'</span></span>,<span class="hljs-string"><span class="hljs-string">'nat_goals_scored'</span></span>,<span class="hljs-string"><span class="hljs-string">'from_clb_pts_avg'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_pts_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'to_clb_goals_diff_avg'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'plr_apps_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'plr_apps_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_0'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_minutes_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_0'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_conc_gols_1'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_cards_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_1'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_made_goals_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'stats_conc_gols_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_cards_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_minutes_2'</span></span>,<span class="hljs-string"><span class="hljs-string">'stats_team_points_2'</span></span>, <span class="hljs-string"><span class="hljs-string">'pop_log1p'</span></span>)</code> </pre> <br><p>  Ensuite, après avoir indiqué explicitement ce que nous prévoyons - le montant du transfert ( <code>fee</code> ), nous divisons au hasard nos données en 2 parties de 80% et 20%.  Sur le premier d'entre eux, nous enseignerons à notre réseau de neurones, sur l'autre - pour vérifier l'exactitude de la prédiction. </p><br><pre> <code class="python hljs">ln = len(df) valid_idx = np.random.choice(ln, int(ln*<span class="hljs-number"><span class="hljs-number">0.2</span></span>), replace=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><p>  Lors de la dernière étape préparatoire, nous devons choisir comment mesurer la plausibilité de nos prévisions.  Ensuite, je n'ai pas choisi la métrique la plus standard dans la partie locale de l'univers - la médiane du pourcentage d'erreur ( <code>MdAPE</code> ).  Ou, plus simplement, combien de pour cent (le prix absolu d'un transfert peut différer par ordre de grandeur), nous ferons probablement une erreur dans le prix d'un transfert pris au hasard.  Il m'a semblé le plus proche de ce que signifie exactement l'expression «précision du système de prédiction de transfert». </p><br><p>  Il est maintenant temps, en fait, de commencer à apprendre le réseau. </p><br><pre> <code class="python hljs">data = (TabularList.from_df(df, path=path, cat_names=cat_vars, cont_names=cont_vars, procs=procs) .split_by_idx(valid_idx) .label_from_df(cols=dep_var, label_cls=FloatList, log=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) .databunch(bs=BS)) learn = tabular_learner(data, layers=layers, ps=layers_drop, emb_drop=emb_drop, y_range=y_range, metrics=exp_mmape, loss_func=MAELossFlat(), callback_fns=[CSVLogger]) learn.fit_one_cycle(cyc_len=cycles, max_lr=max_lr, wd=w_decay)</code> </pre> <br><h4 id="tochnost-predskazaniy">  Précision de prédiction </h4><br><p><img src="https://habrastorage.org/webt/-z/kl/zj/-zklzjwczjcogqhqq93hrxjcfc8.png"></p><br><p>  <code>Validation Error = 0.3492</code> signifie qu'après une formation sur un nouvel <code>validation set</code> données ( <code>validation set</code> , <code>validation set</code> ), le modèle en moyenne (médiane) se trompe de 34% par rapport au prix de transfert réel.  Et nous l'avons obtenu uniquement à la suite de plusieurs lignes de code tirées du didacticiel. </p><br><p>  Erreur 34%, est-ce beaucoup ou un peu?  Tout est relatif.  La seule source comparable, dont les données peuvent être considérées comme une « <em>prédiction</em> » du montant du transfert, est bien entendu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">transfermarkt</a> .  Heureusement, il y a un champ dans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">données de kaggle</a> qui montre comment ce site a évalué un joueur au moment du transfert, et cela peut être comparé.  Il convient de noter ici que transfermarkt n'a jamais prétendu que sa <code>market value</code> était le prix de transfert probable.  Au contraire, ils ont souligné qu'il s'agit plutôt de la « <em>valeur honnête</em> » de l'un ou l'autre joueur.  Et combien d'argent un club particulier paiera pour cela dans une situation particulière est une chose très individuelle et peut fluctuer dans un sens ou dans un autre dans des limites très larges.  Mais c'est le meilleur que nous ayons, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">comparons</a> . </p><br><p><img src="https://habrastorage.org/webt/an/jz/4l/anjz4lvbdxlbqy5s26q8gd5_vig.png"></p><br><p>  Erreur de Transfermarkt - <strong>35%</strong> , notre modèle - <strong>35%</strong> .  Très étrange et, pour être honnête, très méfiant. <br>  À ce stade, je propose de réfléchir à nouveau.  Un site avec une histoire énorme, créé juste pour montrer la `` valeur '' des joueurs, qui repose sur la pleine puissance de l'effet de foule (il tire la valeur des évaluations des visiteurs ordinaires et des professionnels du marché) et la connaissance des experts d'une part, et le modèle, qui ne sait rien du football, ne voit rien à part les données que nous lui avons fournies (et en dehors de ces données dans le monde réel, il y a encore beaucoup de choses que les gens avec transfermarkt prennent en compte), d'autre part, ils <strong>montrent la même erreur</strong> .  De plus, notre modèle permet également de prévoir le prix de location du joueur, ce que la <code>market value</code> , pour des raisons évidentes, ne montre pas (compte tenu de ces transactions, le résultat de transfermarkt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">était encore pire</a> ). </p><br><p>  Honnêtement, je pense toujours que j'ai une sorte d'erreur ici, tout est trop beau pour être vrai.  Mais, néanmoins, allons plus loin. </p><br><p>  Un moyen facile de vous tester est d'essayer de faire la moyenne des prédictions à partir de 2 sources (modèles et transfermarkt).  Si les prédictions sont vraiment indépendantes les unes des autres et qu'il n'y a pas d'erreur gênante, alors le résultat devrait s'améliorer. </p><br><p><img src="https://habrastorage.org/webt/uu/f0/ut/uuf0uts7ak4xrbr95efffferqvu.png"></p><br><p>  En effet, la moyenne des prévisions réduit l'erreur de prédiction à 32% (!).  Cela peut sembler un peu, mais nous devons comprendre que nous filtrons un peu plus d'informations à partir des données, qui sont si serrées au maximum. </p><br><p>  Mais ce que nous ferons ensuite, à mon avis, est encore plus surprenant et intéressant, bien qu'il dépasse le cadre du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">tutoriel fast.ai.</a> </p><br><h4 id="feature-importance">  Importance des fonctionnalités </h4><br><p>  Les réseaux de neurones, pour ne pas dire qu'ils ne sont absolument pas mérités, sont souvent considérés comme une «boîte noire».  Nous savons quelles données nous pouvons y mettre, nous pouvons obtenir les prédictions du modèle, nous pouvons même évaluer dans quelle mesure ses prédictions sont vraies en moyenne.  Mais nous ne pouvons pas expliquer par quels critères le modèle a «pris» telle ou telle décision.  La structure interne du réseau lui-même est si complexe, et surtout, non linéaire, qu'il est impossible de retracer directement toute la chaîne de prise de décision et d'en tirer des conclusions significatives du monde réel.  Mais je veux vraiment.  J'aimerais comprendre ce qui influence le plus le montant du transfert. </p><br><p>  Eh bien, nous ne monterons pas à l'intérieur du réseau.  Mais que signifie l'importance de chaque champ, appelons-le <strong>Feature Importance</strong> (FI)?  Une option pour comprendre l '«importance» consiste à calculer combien les choses vont empirer si nous n'avions pas ce champ.  Et c'est précisément ce que nous pouvons mesurer.  Nous avons maintenant un outil qui fournit des prévisions sur n'importe quel ensemble de données.  Donc, si nous calculons simplement combien l'erreur de prédiction augmentera lorsque nous substituerons des données aléatoires sur le terrain, alors nous pouvons simplement estimer dans quelle mesure (le champ) affecte le résultat final, ce qui signifie à quel point elle est importante.  Pour rester dans la distribution réelle des données, le champ sera rempli non seulement avec des nombres aléatoires, mais avec des valeurs mélangées de manière aléatoire (c'est-à-dire que nous mélangerons simplement la colonne, par exemple, `` année de transfert '', dans le tableau d'origine).  Pour la fidélité, ce processus peut être effectué plusieurs fois pour chaque champ en faisant la moyenne du résultat.  Tout est assez simple.  Voyons maintenant à quel point cela donne le résultat: </p><br><p><img src="https://habrastorage.org/webt/ou/s8/4x/ous84xjkamb1mtigicrbsublki8.png"></p><br><p>  Mon instinct dit: "Oui et non!" </p><br><p>  D'un côté, les champs que vous vous attendez à voir étaient en haut: les entraîneurs d'équipe d'où et où <code>from_coach_name</code> allé <code>from_coach_name</code> joueur ( <code>from_coach_name</code> , <code>to_coach_name</code> ), les clubs eux-mêmes qui ont participé au transfert ( <code>from_club_name</code> , <code>to_club_name</code> ), l'agent du joueur ( <code>plr_player_agent</code> ), sa renommée dans les réseaux sociaux ( <code>pop_log1p</code> ) etc.  Mais d'un autre côté ... Intuitivement, il ne semble pas que les noms des entraîneurs devraient avoir plus de poids dans le prix de transfert que, par exemple, les clubs eux-mêmes (nous savons bien que le Benfica conditionnel est capable de vendre ses joueurs à un prix élevé).  La marque d'un entraîneur influence-t-elle plus fortement le prix que la marque du club?  L'arrivée du conditionnel Mancini oblige-t-elle tellement le club à surpayer?  Qu'est-ce que c'est, le cas quand les données nous donnent de nouvelles informations, légèrement contre-intuitives, ou juste une erreur dans le modèle? </p><br><p>  Faisons les choses correctement.  En regardant de près le graphique, l'œil s'accroche rapidement à une chose étrange.  Juste en dessous du centre, il y a 2 champs très <code>trs_year</code> et <code>season</code> <code>trs_year</code> , ils représentent l'année du transfert et la saison au cours de laquelle la transition sera effectuée (en général, ils peuvent ne pas coïncider, bien que cela ne se produise pas si souvent).  Premièrement, il semble qu'ils devraient être plus élevés, nous savons combien les prix pour les joueurs de football ont augmenté ces dernières années, et deuxièmement, ils signifient évidemment la même chose.  Que faire à ce sujet?  Résumez simplement leur importance?  Pas le fait que cela puisse être fait!  Mais ce que nous pouvons certainement faire, c'est appliquer la même approche (mélanger les valeurs) non pas séparément à ces deux domaines, mais en groupe.  Autrement dit, mesurez comment l'erreur va changer s'il y a des valeurs aléatoires dans ces 2 colonnes à la fois.  Eh bien, puisque nous l'avons fait au fil des ans, nous devons voir si nous avons d'autres domaines qui sont tout aussi «connectés». </p><br><p>  Par exemple, pour un club, nous avons plusieurs paramètres: le club lui-même ( <code>club_name</code> ), ainsi qu'un ensemble d'informations à ce sujet - de quelle ligue, pays, etc.  ( <code>club_is_first_team</code> , <code>clb_lg_name</code> , <code>clb_lg_country</code> , <code>clb_lg_group</code> ).  Ce n'est que dans certains cas que nous voulons savoir dans quelle mesure cela affecte le prix, par exemple, le pays dans <code>clb_lg_country</code> le joueur se rend séparément ( <code>clb_lg_country</code> ), le plus souvent, il est important pour nous de comprendre quel est le poids total du champ `` club '', qui est déjà dans un certain pays, une ligue, etc. . </p><br><p>  Ainsi, nous pouvons combiner tous les champs en groupes en fonction du contenu sémantique.  Cela nous aidera tout simplement à connaître le domaine et le bon sens, ainsi que la «proximité» <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">calculée</a> des fonctionnalités.  Ce dernier montre simplement comment les champs sont en corrélation les uns avec les autres, c'est-à-dire dans quelle mesure il est possible de les considérer comme un seul groupe. </p><br><p>  En appliquant cette approche, nous obtenons un graphique encore plus intuitif de l'importance des champs: </p><br><p><img src="https://habrastorage.org/webt/gu/mc/ma/gumcmafyqlu-ognduuxghf02xww.png"></p><br><p>  Voilà.  Exactement quel club le joueur achète le plus affecte le montant du transfert, avec une très bonne marge.  Hi Man City, Barcelone, Zenit et, par exemple, le même Benfica (après tout, « <em>influence fortement</em> » la même chose sur le fait que certains clubs, au contraire, peuvent acheter des joueurs de qualité moins cher que le «marché»).  Il me semble que la chose la plus intéressante dans le travail avec les données est que lorsqu'elles sont obtenues, les conclusions sont évidentes d'une part (enfin, je doutais que l'acheteur du club ait eu la plus grande influence sur le montant du transfert), et d'autre part, c'est un peu surprenant (et les candidats pour le premier le lieu, intuitivement, pourrait être quelque peu, et la séparation du second ne semblait pas si importante) </p><br><p>  Il y a encore beaucoup de choses intéressantes à découvrir.  Par exemple, le nom de l'entraîneur d'où le joueur est acheté, du point de vue du modèle, est encore plus important que le club ... Que la différence soit considérablement réduite.  Une explication logique à cela peut être trouvée en principe (bien que parfois elle puisse être trouvée pour n'importe quoi).  Il y a des entraîneurs (Guardiola, Klopp, Benitez, Berdyev) qui adhèrent à une certaine idéologie du jeu dans différents clubs, ce qui révèle mieux ou vice versa rend certaines positions sur le terrain moins lumineuses, et la visibilité du joueur affecte considérablement son prix.  À propos des clubs, pour ainsi dire, presque impossible.  Et le fait que nous voyons des entraîneurs qui ne s'écartent pas radicalement de leurs principes du jeu beaucoup plus souvent que les clubs changent d'entraîneurs, mais en restant dans la même philosophie (par exemple, désinvolte, sauf que l'Ajax vient à l'esprit, et Barcelone est très discutable), parle de que, peut-être, certains managers révèlent des joueurs plus stables que les clubs.  Bien qu'ici, je ne tiendrais pas fermement à ma déclaration. </p><br><p>  Parmi les indicateurs purement statistiques, le montant le plus élevé est simplement le temps passé par un joueur sur le terrain l'année dernière dans sa compétition principale ( <code>stats_minutes_0</code> ).  C'est juste, tout à fait logique, car combien ce joueur était le «principal» dans son club la saison dernière semble être un indicateur statistique plus universel de son succès que d'autres - par exemple, le nombre de buts marqués ou de cartes reçues. </p><br><p>  La popularité du joueur ( <code>pop_log1p</code> ) ferme ce groupe de 8 paramètres les plus importants.  Il convient de rappeler que les données que nous avons présentées au cours des 10 dernières années.  Je pense que l'importance de ce domaine serait plus élevée si nous considérions les 5 dernières années, et pour la valeur moyenne au cours de la dernière décennie, c'est un résultat tout à fait compréhensible, surtout compte tenu de l'écart par rapport à la prochaine place. </p><br><p>  Eh bien, la dernière chose sur laquelle je voudrais attirer l'attention est l'importance du champ agent ( <code>plr_player_agent</code> ).  Je laisserai cela sans commentaire, car si vous pouvez casser les marges de copies dans les litiges concernant le (in) besoin d'agents, alors il n'y a aucun doute sur le degré de leur influence sur le marché des transferts moderne (bien que le modèle suggère de ne pas le surestimer). </p><br><p><img src="https://habrastorage.org/webt/q2/al/i5/q2ali5al_krkgtsmdkn_mw5i6na.jpeg"></p><br><p>  Soit dit en passant, ce qui est peut-être le plus intéressant dans cette méthode d'analyse est son accessibilité: il n'est pas nécessaire de créer <em>un</em> modèle « <em>idéal</em> » pour obtenir des informations sur l'importance des paramètres.  Dans de nombreux cas, il suffit que cela prédit tout au moins, soit statistiquement significativement différent de lancer une pièce, et vous obtiendrez <em>déjà des</em> résultats qui contiennent souvent des informations intéressantes ou vous indiquent de quel côté vous pouvez consulter les données. </p><br><p>  Ensuite, il est temps d'arrondir, afin de ne pas augmenter le texte si surchargé.  En quittant, je voudrais encore une fois inviter tous ceux qui sont intéressés par le sujet à essayer (le meilleur, à mon avis, pour les débutants) le cours de Deep Learning - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">fast.ai</a> et à appliquer les connaissances acquises dans `` votre domaine d'expertise '', il est probable que vous serez le premier là-bas :) </p><br><p>  Et si vous l'aimez, je vais essayer de maîtriser la deuxième partie du texte sur mes expériences dans lesquelles le modèle utilisant un outil tout aussi puissant - <strong>Dépendance partielle</strong> vous dira: quel client de l'agence est le mieux pour devenir joueur de football, quels clubs ont la politique de transfert la plus efficace, quel entraîneur augmente le mieux le coût des joueurs (en plus des candidats évidents, il existe de nombreuses «marques» peu promues qui valent clairement le détour) et bien plus encore. </p><br><p>  Partie 2 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Modèle de transferts de soccer: creuser plus profondément</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468107/">https://habr.com/ru/post/fr468107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468089/index.html">Redéfinition basée sur l'édition: est-il possible en production?</a></li>
<li><a href="../fr468091/index.html">Le projet de loi sur la création d'une base de données unique avec les données des citoyens adopté à la Douma d'Etat en première lecture</a></li>
<li><a href="../fr468093/index.html">Nitrates dans les produits: magasins suisses vs magasins russes vs chalet d'été</a></li>
<li><a href="../fr468097/index.html">Microsoft Edge - XSS générique</a></li>
<li><a href="../fr468099/index.html">C / C ++ de Python (CFFI, pybind11)</a></li>
<li><a href="../fr468109/index.html">Ils disent que Samara est une ville de Javists, mais nous y conduisons un mitap PHP</a></li>
<li><a href="../fr468111/index.html">PSD2 - coup de pied pour les banques</a></li>
<li><a href="../fr468117/index.html">Ethernet, FTP, Telnet, HTTP, Bluetooth - les bases de l'analyse du trafic. Résolution de problèmes sur un réseau avec r0ot-mi. partie 1</a></li>
<li><a href="../fr468121/index.html">Comment je ne suis pas devenu programmeur à 35 ans</a></li>
<li><a href="../fr468125/index.html">Animation dans Asymptote</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>