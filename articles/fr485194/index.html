<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèª‚Äçü§ù‚Äçüßëüèª üï∑Ô∏è üè° Arborescence des segments: rapide et facile üë©üèæ‚Äçü§ù‚Äçüë®üèª ‚úñÔ∏è üòö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√Ä la veille du prochain lancement du cours Algorithms for Developers, nous avons organis√© une le√ßon ouverte . Nous avons parl√© de l'id√©e bien connue d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arborescence des segments: rapide et facile</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/485194/"> <i>√Ä la veille du prochain lancement du <a href="https://otus.pw/yFoX/">cours Algorithms for Developers,</a> nous avons organis√© <a href="https://otus.pw/yFoX/">une le√ßon ouverte</a> .</i>  <i>Nous avons parl√© de l'id√©e bien connue d'un arbre de segments, discut√© de la fa√ßon de le construire, de le mettre √† jour et rapidement <code>O(log n)</code> calculer la somme des nombres de n'importe quel segment d'un tableau donn√©.</i>  <i>L'algorithme est tr√®s simple et √©conomique: vous avez besoin de m√©moire <code>O(n)</code> .</i>  <i>Pour consolider le mat√©riau, ils ont r√©solu le probl√®me des olympiades.</i> <br><br><img src="https://habrastorage.org/webt/fo/p6/54/fop654wv18dcuqqcotigwu5ewji.jpeg"><br><hr><br>  Le webinaire a √©t√© dirig√© par un programmeur et enseignant exp√©riment√©, ainsi que par le responsable du cours "Algorithmes pour les d√©veloppeurs" <a href="https://otus.pw/pieR/">Evgeny Volosatov</a> . <a name="habracut"></a><br><br><h3>  Le dicton </h3><br>  L'arbre de segments est une structure de donn√©es qui permet √† un algorithme simple et logarithmiquement rapide de trouver la somme des √©l√©ments d'un tableau sur un segment donn√©. <br><br>  Par exemple, imaginez que vous devez trouver la somme des nombres suivants: <br><br><img src="https://habrastorage.org/webt/fn/lv/ni/fnlvniiqc457d4l5ywrjrhd8j5o.png"><br><br>  De plus, nous devons non seulement calculer la somme des nombres de la s√©quence sp√©cifi√©e (la somme des √©l√©ments d'un certain tableau), mais <b>aussi rapidement</b> que <b>possible pour trouver la somme de toute s√©quence de ces nombres</b> .  Autrement dit, nous pouvons demander un intervalle (segment) et donner la r√©ponse le plus rapidement possible, quelle est la somme des nombres de cet intervalle: <br><br><img src="https://habrastorage.org/webt/cu/om/vi/cuomviqi_bvqgbhnazokqrmsbmy.png"><br><br>  Qu'est-ce que cela signifie rapidement?  Cela signifie <b>plus rapidement que si nous additionnions simplement les chiffres</b> .  Apr√®s tout, il peut y avoir des millions et des milliards de chiffres ... <br><br>  C'est le d√©sir de trouver rapidement la somme des √©l√©ments cons√©cutifs qui est devenu la motivation de notre webinaire.  De plus, nous parlons non seulement de la somme, mais aussi d'autres t√¢ches, par exemple, le calcul de toute fonction associative.  Ainsi, nous parlons d'op√©rations dont l'ex√©cution ne d√©pend pas de l'ordre de calcul. <br><br>  Revenons √† notre ligne: <br><br><img src="https://habrastorage.org/webt/fn/lv/ni/fnlvniiqc457d4l5ywrjrhd8j5o.png"><br><br>  √âvidemment, si nous voulons trouver le r√©sultat rapidement, nous devons calculer certains montants √† l'avance.  La premi√®re chose qui me vient √† l'esprit est le pliage par deux: <br><br><img src="https://habrastorage.org/webt/ud/oq/tl/udoqtlw0ym7de8nhrqdopsaebcg.png"><br><br>  Maintenant, si vous avez besoin de trouver la somme des nombres, nous pouvons le faire presque instantan√©ment.  Par exemple, pour trouver la somme du segment mentionn√© ci-dessus, il suffira d'ajouter 13 √† 9. Tout est √©l√©mentaire: pour trouver la <b>somme de quatre nombres,</b> nous en avons ajout√© <b>seulement deux</b> . <br><br>  Nous compliquons la t√¢che: <br><br><img src="https://habrastorage.org/webt/be/cg/bf/becgbfbuhk3jfdunnzzxdcjxtha.png"><br><br>  Pour trouver la somme de ce segment, nous devons additionner les √©l√©ments qui, d'une mani√®re ou d'une autre, couvrent notre segment: <br><br><img src="https://habrastorage.org/webt/14/22/mk/1422mk7bnint8ldnumlxday9axs.png"><br><br>  Bien s√ªr, 3 + 13 + 19 = 35. Notez que pour trouver la <b>somme des sept nombres</b> , nous en avons ajout√© <b>seulement trois</b> .  Si le segment √©tait compos√© de mille √©l√©ments, il suffirait d'ajouter en moyenne 10 √©l√©ments, puisque nous avons une complexit√© logarithmique avec un logarithme en base 2. Et c'est rapide! <br><br><h3>  Arbre binaire complet </h3><br>  Un arbre binaire complet est un arbre dont chaque √©l√©ment a exactement deux enfants. <br><br>  Pour travailler avec un arbre binaire complet, vous pouvez et devez utiliser une structure de donn√©es telle qu'un tableau.  <b>La num√©rotation de ce tableau est pratique √† partir d'un</b> .  Nous num√©rotons chaque √©l√©ment de l'arbre binaire avec des nombres naturels de 1 √† 2 <sup>n</sup> -1: <br><br><img src="https://habrastorage.org/webt/sk/kk/ec/skkkecryziahrhokilreofurql4.png"><br><br>  Toute la beaut√© de l'approche est qu'il est tr√®s facile de calculer le nombre d'enfants et de parents. <br>  La formule pour calculer "l'enfant gauche": <i>i * 2</i> , la "droite": <i>i * 2 + 1</i> . <br><br><img src="https://habrastorage.org/webt/yk/g4/ri/ykg4rio8c3trd8xnxqom8nzyr2o.png"><br><br>  Par exemple, nous calculons le nombre d'enfants dans le cinqui√®me √©l√©ment: <br><br><ol><li>  5 x 2 = <b>10</b> ; </li><li>  5 x 2 + 1 = <b>11</b> . </li></ol><br><br>  Et comment passer de ¬´l'enfant¬ª au ¬´parent¬ª?  Nous utilisons la <b>division enti√®re</b> <i>i / 2</i> <br><br>  Ok, et comment d√©terminer si l'enfant est √† gauche ou √† droite?  La r√©ponse est la suivante: les <b>enfants de gauche ont des nombres pairs, les enfants de droite ont des nombres impairs</b> . <br><br>  Rappelez-vous ces points. <br><br>  Revenant √† notre exemple d'arbre binaire, nous nous demandons, comment pouvons-nous le construire?  Regardez, nous avons d'abord un tableau de nombres: <br><br><img src="https://habrastorage.org/webt/u1/mg/nm/u1mgnmf90-a9x8widngxvftscns.png"><br><br>  Pour cela, vous devez construire un arbre binaire.  Quelle quantit√© de m√©moire est n√©cessaire pour stocker l'arbre binaire, au fond duquel se trouvent ces √©l√©ments? <br><br>  La r√©ponse √† cette question est <i>2n</i> si <i>n</i> est une puissance de deux. <br><br>  Nous allons plus loin, car deux autres questions se posent √† nous: <br><br><ol><li>  √† partir de quel √©l√©ment avez-vous besoin de placer les num√©ros sources dans un tableau d'un arbre binaire complet? </li><li>  √† partir de quel √©l√©ment et dans quelle direction allons-nous commencer √† remplir notre arbre de quantit√©s pr√©-calcul√©es? </li></ol><br><br><img src="https://habrastorage.org/webt/2p/7w/ud/2p7wudvrlqpvlwxyxiphho1zs3q.png"><br><br>  La r√©ponse √† la premi√®re question est assez simple: nous avons 8 √©l√©ments, au total il y aura 16 √©l√©ments dans le tableau, ce qui signifie que le premier √©l√©ment sera num√©rot√© 16 - 8 = 8. Et nous commencerons √† construire de gauche √† droite et de bas en haut, √† partir de l'√©l√©ment 7, additionner des valeurs chez les enfants, comme ceci: <br><br><img src="https://habrastorage.org/webt/ec/_4/d9/ec_4d9sy7dtb41tgrr2fhgbkmf8.png"><br><br>  Ensuite, vous devez d√©terminer comment trouver la somme du segment souhait√©.  Revenons √† notre premier exemple, num√©rotons les √©l√©ments et d√©finissons un segment, et nous d√©signons le premier √©l√©ment du segment √† ajouter par la lettre L, et le dernier par R: <br><br><img src="https://habrastorage.org/webt/w8/wc/1f/w8wc1fkemnpucy4ih5n1pl9rdom.png"><br><br>  Il faut maintenant introduire un concept de plus pour que l'algorithme des actions soit clair.  Nous parlons du concept des √©l√©ments fondamentaux et de leurs segments fondamentaux correspondants.  L'√©l√©ment fondamental est tout √©l√©ment de l'ensemble du tableau, et le segment fondamental lui correspond, c'est-√†-dire les √©l√©ments du tableau initial qui sont ses enfants / petits-enfants imm√©diats.  Pour l'√©l√©ment fondamental avec le num√©ro 4 ¬´5¬ª, le segment fondamental sera de 8 √† 9 √©l√©ment: [¬´2¬ª;  ¬´3¬ª]: <br><br><img src="https://habrastorage.org/webt/ia/ot/mw/iaotmwpt4cvxbhhsyr5rwbgt_1a.png"><br><br>  Quant √† l'√©l√©ment fondamental avec le nombre 10 - ¬´7¬ª (nous l'avons d√©sign√© L), il co√Øncide avec son segment fondamental.  Est-il possible d'√©largir ce segment fondamental sans d√©passer LR?  Dans notre cas, vous le pouvez.  La r√®gle pour la bordure gauche est la suivante: s'il s'agit d'un enfant gauche, alors le segment fondamental peut √™tre d√©velopp√©, le nouvel √©l√©ment fondamental sera le parent de l'actuel.  Autrement dit, nous pouvons √©crire ce qui suit dans le programme: <br><br><img src="https://habrastorage.org/webt/dy/j0/pg/dyj0pgxwjnqnmqawzxl5zjoahwg.png"><br><br>  Passons maintenant √† l'√©l√©ment droit R. C'est un √©l√©ment fondamental et un enfant gauche, donc nous ne pouvons plus √©tendre la zone (nous allons d√©passer le segment).  Nous pouvons donc ajouter cet √©l√©ment √† la r√©ponse: <br><br><img src="https://habrastorage.org/webt/c9/ng/fi/c9ngfima1u2vx-f-rqc8etaupxo.png"><br><br>  Ensuite, vous avez besoin de l'√©l√©ment gauche pour vous d√©placer vers la droite et de la droite vers la gauche.  Pour l'√©l√©ment gauche d'index L = 10, l'index suivant est 5, car il ira au parent.  Mais il ira d'abord vers la droite, puis vers le haut: <br><br><img src="https://habrastorage.org/webt/jd/qu/ll/jdqulls8rhnw5jvpbl-qhqlj1wm.png"><br><br>  Ainsi, la valeur de L est pass√©e √† un niveau sup√©rieur et un peu √† droite.  Comment R diminuera-t-il?  En utilisant la formule (R - 1) / 2. <br><br><img src="https://habrastorage.org/webt/ea/-b/s9/ea-bs9_886die9apr0myvvimrpw.png"><br><br>  Voici un tel algorithme.  Quant aux valeurs suivantes des variables L et R, elles seront d√©plac√©es comme suit: <br><br><img src="https://habrastorage.org/webt/qq/rn/t_/qqrnt_9szc_kwfmv5gcy_tbfyi4.png"><br><br>  S'il n'y a pas 8 √©l√©ments dans l'arbre, mais un nombre incommode, disons 12, nous devrons ajouter l'arbre (l'arbre binaire doit √™tre complet) √† 16. <br>  La formule de calcul du nombre d'√©l√©ments (toute la partie du logarithme est prise): <br><br><img src="https://habrastorage.org/webt/pt/3d/fs/pt3dfscq0ucdhkasro7lva2prrw.png"><br><br>  Maintenant, nous calculons la fonction associative de trouver le <b>minimum</b> .  Voici notre arbre et coup√©: <br><br><img src="https://habrastorage.org/webt/3c/kb/bw/3ckbbwikljcpgynr1jx40mgpciy.png"><br><br>  Combien de fois pensez-vous que l'√©l√©ment 5 sera impliqu√© dans notre fonction - une ou deux?  Bien s√ªr, un, mais comment cela est-il v√©rifi√© dans l'algorithme?  En fait, cet √©l√©ment est soit un fils gauche ou un fils droit, ce qui signifie que l'action sera effectu√©e pour L ou R. <br><br><img src="https://habrastorage.org/webt/9m/a3/nh/9ma3nh-iiidctwxe1dpbmr1nkaa.png"><br>  + <br><br>  Consid√©rez maintenant l'op√©ration de modification.  Supposons qu'un √©l√©ment ait chang√©, par exemple, au lieu de 7, 0 est entr√©. Pour que notre arborescence de segments reste en √©tat de fonctionnement, nous devons mettre √† jour tous les parents, et nous devons aller tout en haut. <br><br><img src="https://habrastorage.org/webt/sx/zu/su/sxzusu9zgp6okgpwrw0qwiwon7a.png"><br><br><h3>  Solution du probl√®me des olympiades </h3><br>  L'une des exigences de ces t√¢ches est que tout fonctionne rapidement.  Nous avons donc la condition suivante: <br><br><img src="https://habrastorage.org/webt/wc/u8/hn/wcu8hnmpigtcnmf8cppibgjdaiw.png"><br><br>  Nous allons le r√©soudre en utilisant la connaissance de l'arbre des segments.  En cons√©quence, nous obtenons le code C # suivant: <br><br><img src="https://habrastorage.org/webt/nu/_b/ja/nu_bjam45qtkqid1umwdm95tu2s.png"><br><br>  Nous l'envoyons pour v√©rification, nous voyons que la <a href="https://codeforces.com/gym/100249">d√©cision a √©t√© prise et est compl√®te</a> , ce qui signifie que notre algorithme fonctionne. <br><br><img src="https://habrastorage.org/webt/5m/dn/ip/5mdnipfigoae-93thzd2w_hftam.png"><br><br>  C'est tout, si vous voulez plus de d√©tails, <a href="https://otus.pw/yFoX/">regardez l'int√©gralit√© de la vid√©o</a> .  Vous pouvez √©galement lire √† loisir les articles d‚Äôauteurs suivants de notre professeur <a href="https://otus.pw/pieR/">Evgeny Volosatov</a> sur Habr√©: <br><br>  - <a href="https://habr.com/ru/company/otus/blog/472040/">√âquilibrage des arbres rouge-noir - Trois cas</a> ; <br>  - <a href="https://habr.com/ru/company/otus/blog/476510/">Le cheval se d√©place sur des mors.</a>  <a href="https://habr.com/ru/company/otus/blog/476510/">Bitboard d'√©checs</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr485194/">https://habr.com/ru/post/fr485194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr485180/index.html">Avons-nous besoin d'un lac de donn√©es? Que faire de l'entrep√¥t de donn√©es?</a></li>
<li><a href="../fr485182/index.html">Sennheiser en 2020 - casque sans fil mis √† jour pour l'anniversaire</a></li>
<li><a href="../fr485184/index.html">R√©sultats du sondage par onglets</a></li>
<li><a href="../fr485186/index.html">D√©marrage d'un billion de dollars ou naissance des entreprises les plus prosp√®res de Valley</a></li>
<li><a href="../fr485190/index.html">Andrew Eun "Passion pour l'apprentissage automatique." Traduction des chapitres 47 √† 58</a></li>
<li><a href="../fr485196/index.html">AvitoTech On Tour: rendez-vous et rendez-vous frontend √† Kazan</a></li>
<li><a href="../fr485198/index.html">Une autre fa√ßon de mesurer les performances des m√©thodes d'application .NET</a></li>
<li><a href="../fr485200/index.html">D√©sordre au d√©part: post-mortem sur la vitesse de lancement d'une application iOS</a></li>
<li><a href="../fr485202/index.html">Syst√®me de suppression</a></li>
<li><a href="../fr485204/index.html">Retour en haut: pourquoi la capitalisation d'Amazon d√©passera bient√¥t encore 1 billion de dollars</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>